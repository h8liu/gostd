<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2436386">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2436441">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2436495">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2436546">//&nbsp;Package&nbsp;time&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;measuring&nbsp;and&nbsp;displaying&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2436620">//</span><br>
<span class="lineno"></span><span class="comment" id="2436623">//&nbsp;The&nbsp;calendrical&nbsp;calculations&nbsp;always&nbsp;assume&nbsp;a&nbsp;Gregorian&nbsp;calendar.</span><br>
<span class="lineno"></span><span class="keyword" id="2436691">package</span>&nbsp;<span class="ident" id="2436699">time</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2436705">import</span>&nbsp;<span class="string" id="2436712">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2436722">//&nbsp;A&nbsp;Time&nbsp;represents&nbsp;an&nbsp;instant&nbsp;in&nbsp;time&nbsp;with&nbsp;nanosecond&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="2436789">//</span><br>
<span class="lineno"></span><span class="comment" id="2436792">//&nbsp;Programs&nbsp;using&nbsp;times&nbsp;should&nbsp;typically&nbsp;store&nbsp;and&nbsp;pass&nbsp;them&nbsp;as&nbsp;values,</span><br>
<span class="lineno">15</span><span class="comment" id="2436864">//&nbsp;not&nbsp;pointers.&nbsp;&nbsp;That&nbsp;is,&nbsp;time&nbsp;variables&nbsp;and&nbsp;struct&nbsp;fields&nbsp;should&nbsp;be&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2436937">//&nbsp;type&nbsp;time.Time,&nbsp;not&nbsp;*time.Time.&nbsp;&nbsp;A&nbsp;Time&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2437001">//&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="2437040">//</span><br>
<span class="lineno"></span><span class="comment" id="2437043">//&nbsp;Time&nbsp;instants&nbsp;can&nbsp;be&nbsp;compared&nbsp;using&nbsp;the&nbsp;Before,&nbsp;After,&nbsp;and&nbsp;Equal&nbsp;methods.</span><br>
<span class="lineno">20</span><span class="comment" id="2437120">//&nbsp;The&nbsp;Sub&nbsp;method&nbsp;subtracts&nbsp;two&nbsp;instants,&nbsp;producing&nbsp;a&nbsp;Duration.</span><br>
<span class="lineno"></span><span class="comment" id="2437184">//&nbsp;The&nbsp;Add&nbsp;method&nbsp;adds&nbsp;a&nbsp;Time&nbsp;and&nbsp;a&nbsp;Duration,&nbsp;producing&nbsp;a&nbsp;Time.</span><br>
<span class="lineno"></span><span class="comment" id="2437248">//</span><br>
<span class="lineno"></span><span class="comment" id="2437251">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;Time&nbsp;is&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2437328">//&nbsp;As&nbsp;this&nbsp;time&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;come&nbsp;up&nbsp;in&nbsp;practice,&nbsp;the&nbsp;IsZero&nbsp;method&nbsp;gives</span><br>
<span class="lineno">25</span><span class="comment" id="2437404">//&nbsp;a&nbsp;simple&nbsp;way&nbsp;of&nbsp;detecting&nbsp;a&nbsp;time&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;initialized&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment" id="2437482">//</span><br>
<span class="lineno"></span><span class="comment" id="2437485">//&nbsp;Each&nbsp;Time&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;Location,&nbsp;consulted&nbsp;when&nbsp;computing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2437562">//&nbsp;presentation&nbsp;form&nbsp;of&nbsp;the&nbsp;time,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;Format,&nbsp;Hour,&nbsp;and&nbsp;Year&nbsp;methods.</span><br>
<span class="lineno"></span><span class="comment" id="2437643">//&nbsp;The&nbsp;methods&nbsp;Local,&nbsp;UTC,&nbsp;and&nbsp;In&nbsp;return&nbsp;a&nbsp;Time&nbsp;with&nbsp;a&nbsp;specific&nbsp;location.</span><br>
<span class="lineno">30</span><span class="comment" id="2437717">//&nbsp;Changing&nbsp;the&nbsp;location&nbsp;in&nbsp;this&nbsp;way&nbsp;changes&nbsp;only&nbsp;the&nbsp;presentation;&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2437797">//&nbsp;change&nbsp;the&nbsp;instant&nbsp;in&nbsp;time&nbsp;being&nbsp;denoted&nbsp;and&nbsp;therefore&nbsp;does&nbsp;not&nbsp;affect&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2437875">//&nbsp;computations&nbsp;described&nbsp;in&nbsp;earlier&nbsp;paragraphs.</span><br>
<span class="lineno"></span><span class="comment" id="2437924">//</span><br>
<span class="lineno"></span><span class="comment" id="2437927">//&nbsp;Note&nbsp;that&nbsp;the&nbsp;Go&nbsp;==&nbsp;operator&nbsp;compares&nbsp;not&nbsp;just&nbsp;the&nbsp;time&nbsp;instant&nbsp;but&nbsp;also&nbsp;the</span><br>
<span class="lineno">35</span><span class="comment" id="2438007">//&nbsp;Location.&nbsp;Therefore,&nbsp;Time&nbsp;values&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;as&nbsp;map&nbsp;or&nbsp;database&nbsp;keys</span><br>
<span class="lineno"></span><span class="comment" id="2438086">//&nbsp;without&nbsp;first&nbsp;guaranteeing&nbsp;that&nbsp;the&nbsp;identical&nbsp;Location&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2438165">//&nbsp;values,&nbsp;which&nbsp;can&nbsp;be&nbsp;achieved&nbsp;through&nbsp;use&nbsp;of&nbsp;the&nbsp;UTC&nbsp;or&nbsp;Local&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2438238">//</span><br>
<span class="lineno"></span><span class="keyword" id="2438241">type</span>&nbsp;<span class="ident" id="2438246">Time</span>&nbsp;<span class="keyword" id="2438251">struct</span>&nbsp;<span class="op" id="2438258">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438261">//&nbsp;sec&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed&nbsp;since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438311">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438347">sec</span>&nbsp;<span class="ident" id="2438351">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438359">//&nbsp;nsec&nbsp;specifies&nbsp;a&nbsp;non-negative&nbsp;nanosecond</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438404">//&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;named&nbsp;by&nbsp;Seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438451">//&nbsp;It&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438495">nsec</span>&nbsp;<span class="builtintype" id="2438500">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438508">//&nbsp;loc&nbsp;specifies&nbsp;the&nbsp;Location&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438562">//&nbsp;determine&nbsp;the&nbsp;minute,&nbsp;hour,&nbsp;month,&nbsp;day,&nbsp;and&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438615">//&nbsp;that&nbsp;correspond&nbsp;to&nbsp;this&nbsp;Time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438649">//&nbsp;Only&nbsp;the&nbsp;zero&nbsp;Time&nbsp;has&nbsp;a&nbsp;nil&nbsp;Location.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438692">//&nbsp;In&nbsp;that&nbsp;case&nbsp;it&nbsp;is&nbsp;interpreted&nbsp;to&nbsp;mean&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438740">loc</span>&nbsp;<span class="op" id="2438744">*</span><span class="ident" id="2438745">Location</span><br>
<span class="lineno">55</span><span class="op" id="2438754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2438757">//&nbsp;After&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;after&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2438813">func</span>&nbsp;<span class="op" id="2438818">(</span><span class="ident" id="2438819">t</span>&nbsp;<span class="ident" id="2438821">Time</span><span class="op" id="2438825">)</span>&nbsp;<span class="ident" id="2438827">After</span><span class="op" id="2438832">(</span><span class="ident" id="2438833">u</span>&nbsp;<span class="ident" id="2438835">Time</span><span class="op" id="2438839">)</span>&nbsp;<span class="builtintype" id="2438841">bool</span>&nbsp;<span class="op" id="2438846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438849">return</span>&nbsp;<span class="ident" id="2438856">t</span><span class="op" id="2438857">.</span><span class="ident" id="2438858">sec</span>&nbsp;<span class="op" id="2438862">&gt;</span>&nbsp;<span class="ident" id="2438864">u</span><span class="op" id="2438865">.</span><span class="ident" id="2438866">sec</span>&nbsp;<span class="op" id="2438870">||</span>&nbsp;<span class="ident" id="2438873">t</span><span class="op" id="2438874">.</span><span class="ident" id="2438875">sec</span>&nbsp;<span class="op" id="2438879">==</span>&nbsp;<span class="ident" id="2438882">u</span><span class="op" id="2438883">.</span><span class="ident" id="2438884">sec</span>&nbsp;<span class="op" id="2438888">&amp;&amp;</span>&nbsp;<span class="ident" id="2438891">t</span><span class="op" id="2438892">.</span><span class="ident" id="2438893">nsec</span>&nbsp;<span class="op" id="2438898">&gt;</span>&nbsp;<span class="ident" id="2438900">u</span><span class="op" id="2438901">.</span><span class="ident" id="2438902">nsec</span><br>
<span class="lineno">60</span><span class="op" id="2438907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2438910">//&nbsp;Before&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;before&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2438968">func</span>&nbsp;<span class="op" id="2438973">(</span><span class="ident" id="2438974">t</span>&nbsp;<span class="ident" id="2438976">Time</span><span class="op" id="2438980">)</span>&nbsp;<span class="ident" id="2438982">Before</span><span class="op" id="2438988">(</span><span class="ident" id="2438989">u</span>&nbsp;<span class="ident" id="2438991">Time</span><span class="op" id="2438995">)</span>&nbsp;<span class="builtintype" id="2438997">bool</span>&nbsp;<span class="op" id="2439002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439005">return</span>&nbsp;<span class="ident" id="2439012">t</span><span class="op" id="2439013">.</span><span class="ident" id="2439014">sec</span>&nbsp;<span class="op" id="2439018">&lt;</span>&nbsp;<span class="ident" id="2439020">u</span><span class="op" id="2439021">.</span><span class="ident" id="2439022">sec</span>&nbsp;<span class="op" id="2439026">||</span>&nbsp;<span class="ident" id="2439029">t</span><span class="op" id="2439030">.</span><span class="ident" id="2439031">sec</span>&nbsp;<span class="op" id="2439035">==</span>&nbsp;<span class="ident" id="2439038">u</span><span class="op" id="2439039">.</span><span class="ident" id="2439040">sec</span>&nbsp;<span class="op" id="2439044">&amp;&amp;</span>&nbsp;<span class="ident" id="2439047">t</span><span class="op" id="2439048">.</span><span class="ident" id="2439049">nsec</span>&nbsp;<span class="op" id="2439054">&lt;</span>&nbsp;<span class="ident" id="2439056">u</span><span class="op" id="2439057">.</span><span class="ident" id="2439058">nsec</span><br>
<span class="lineno">65</span><span class="op" id="2439063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2439066">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;t&nbsp;and&nbsp;u&nbsp;represent&nbsp;the&nbsp;same&nbsp;time&nbsp;instant.</span><br>
<span class="lineno"></span><span class="comment" id="2439132">//&nbsp;Two&nbsp;times&nbsp;can&nbsp;be&nbsp;equal&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;different&nbsp;locations.</span><br>
<span class="lineno"></span><span class="comment" id="2439199">//&nbsp;For&nbsp;example,&nbsp;6:00&nbsp;+0200&nbsp;CEST&nbsp;and&nbsp;4:00&nbsp;UTC&nbsp;are&nbsp;Equal.</span><br>
<span class="lineno">70</span><span class="comment" id="2439255">//&nbsp;This&nbsp;comparison&nbsp;is&nbsp;different&nbsp;from&nbsp;using&nbsp;t&nbsp;==&nbsp;u,&nbsp;which&nbsp;also&nbsp;compares</span><br>
<span class="lineno"></span><span class="comment" id="2439326">//&nbsp;the&nbsp;locations.</span><br>
<span class="lineno"></span><span class="keyword" id="2439344">func</span>&nbsp;<span class="op" id="2439349">(</span><span class="ident" id="2439350">t</span>&nbsp;<span class="ident" id="2439352">Time</span><span class="op" id="2439356">)</span>&nbsp;<span class="ident" id="2439358">Equal</span><span class="op" id="2439363">(</span><span class="ident" id="2439364">u</span>&nbsp;<span class="ident" id="2439366">Time</span><span class="op" id="2439370">)</span>&nbsp;<span class="builtintype" id="2439372">bool</span>&nbsp;<span class="op" id="2439377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439380">return</span>&nbsp;<span class="ident" id="2439387">t</span><span class="op" id="2439388">.</span><span class="ident" id="2439389">sec</span>&nbsp;<span class="op" id="2439393">==</span>&nbsp;<span class="ident" id="2439396">u</span><span class="op" id="2439397">.</span><span class="ident" id="2439398">sec</span>&nbsp;<span class="op" id="2439402">&amp;&amp;</span>&nbsp;<span class="ident" id="2439405">t</span><span class="op" id="2439406">.</span><span class="ident" id="2439407">nsec</span>&nbsp;<span class="op" id="2439412">==</span>&nbsp;<span class="ident" id="2439415">u</span><span class="op" id="2439416">.</span><span class="ident" id="2439417">nsec</span><br>
<span class="lineno"></span><span class="op" id="2439422">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2439425">//&nbsp;A&nbsp;Month&nbsp;specifies&nbsp;a&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;(January&nbsp;=&nbsp;1,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2439486">type</span>&nbsp;<span class="ident" id="2439491">Month</span>&nbsp;<span class="builtintype" id="2439497">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2439502">const</span>&nbsp;<span class="op" id="2439508">(</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439511">January</span>&nbsp;<span class="ident" id="2439519">Month</span>&nbsp;<span class="op" id="2439525">=</span>&nbsp;<span class="num" id="2439527">1</span>&nbsp;<span class="op" id="2439529">+</span>&nbsp;<span class="ident" id="2439531">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439537">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439547">March</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439554">April</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439561">May</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439566">June</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439572">July</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439578">August</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439586">September</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439597">October</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439606">November</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439616">December</span><br>
<span class="lineno"></span><span class="op" id="2439625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2439628">var</span>&nbsp;<span class="ident" id="2439632">months</span>&nbsp;<span class="op" id="2439639">=</span>&nbsp;<span class="op" id="2439641">[</span><span class="op" id="2439642">...</span><span class="op" id="2439645">]</span><span class="builtintype" id="2439646">string</span><span class="op" id="2439652">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439655">&#34;January&#34;</span><span class="op" id="2439664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439667">&#34;February&#34;</span><span class="op" id="2439677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439680">&#34;March&#34;</span><span class="op" id="2439687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439690">&#34;April&#34;</span><span class="op" id="2439697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439700">&#34;May&#34;</span><span class="op" id="2439705">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439708">&#34;June&#34;</span><span class="op" id="2439714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439717">&#34;July&#34;</span><span class="op" id="2439723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439726">&#34;August&#34;</span><span class="op" id="2439734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439737">&#34;September&#34;</span><span class="op" id="2439748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439751">&#34;October&#34;</span><span class="op" id="2439760">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439763">&#34;November&#34;</span><span class="op" id="2439773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2439776">&#34;December&#34;</span><span class="op" id="2439786">,</span><br>
<span class="lineno"></span><span class="op" id="2439788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2439791">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;month&nbsp;(&#34;January&#34;,&nbsp;&#34;February&#34;,&nbsp;...).</span><br>
<span class="lineno">110</span><span class="keyword" id="2439869">func</span>&nbsp;<span class="op" id="2439874">(</span><span class="ident" id="2439875">m</span>&nbsp;<span class="ident" id="2439877">Month</span><span class="op" id="2439882">)</span>&nbsp;<span class="ident" id="2439884">String</span><span class="op" id="2439890">(</span><span class="op" id="2439891">)</span>&nbsp;<span class="builtintype" id="2439893">string</span>&nbsp;<span class="op" id="2439900">{</span>&nbsp;<span class="keyword" id="2439902">return</span>&nbsp;<span class="ident" id="2439909">months</span><span class="op" id="2439915">[</span><span class="ident" id="2439916">m</span><span class="op" id="2439917">-</span><span class="num" id="2439918">1</span><span class="op" id="2439919">]</span>&nbsp;<span class="op" id="2439921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2439924">//&nbsp;A&nbsp;Weekday&nbsp;specifies&nbsp;a&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;(Sunday&nbsp;=&nbsp;0,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2439984">type</span>&nbsp;<span class="ident" id="2439989">Weekday</span>&nbsp;<span class="builtintype" id="2439997">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2440002">const</span>&nbsp;<span class="op" id="2440008">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440011">Sunday</span>&nbsp;<span class="ident" id="2440018">Weekday</span>&nbsp;<span class="op" id="2440026">=</span>&nbsp;<span class="ident" id="2440028">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440034">Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440042">Tuesday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440051">Wednesday</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440062">Thursday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440072">Friday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440080">Saturday</span><br>
<span class="lineno"></span><span class="op" id="2440089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2440092">var</span>&nbsp;<span class="ident" id="2440096">days</span>&nbsp;<span class="op" id="2440101">=</span>&nbsp;<span class="op" id="2440103">[</span><span class="op" id="2440104">...</span><span class="op" id="2440107">]</span><span class="builtintype" id="2440108">string</span><span class="op" id="2440114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440117">&#34;Sunday&#34;</span><span class="op" id="2440125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440128">&#34;Monday&#34;</span><span class="op" id="2440136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440139">&#34;Tuesday&#34;</span><span class="op" id="2440148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440151">&#34;Wednesday&#34;</span><span class="op" id="2440162">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440165">&#34;Thursday&#34;</span><span class="op" id="2440175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440178">&#34;Friday&#34;</span><span class="op" id="2440186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2440189">&#34;Saturday&#34;</span><span class="op" id="2440199">,</span><br>
<span class="lineno"></span><span class="op" id="2440201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2440204">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;day&nbsp;(&#34;Sunday&#34;,&nbsp;&#34;Monday&#34;,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2440277">func</span>&nbsp;<span class="op" id="2440282">(</span><span class="ident" id="2440283">d</span>&nbsp;<span class="ident" id="2440285">Weekday</span><span class="op" id="2440292">)</span>&nbsp;<span class="ident" id="2440294">String</span><span class="op" id="2440300">(</span><span class="op" id="2440301">)</span>&nbsp;<span class="builtintype" id="2440303">string</span>&nbsp;<span class="op" id="2440310">{</span>&nbsp;<span class="keyword" id="2440312">return</span>&nbsp;<span class="ident" id="2440319">days</span><span class="op" id="2440323">[</span><span class="ident" id="2440324">d</span><span class="op" id="2440325">]</span>&nbsp;<span class="op" id="2440327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2440330">//&nbsp;Computations&nbsp;on&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2440355">//</span><br>
<span class="lineno">140</span><span class="comment" id="2440358">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Time&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2440404">//&nbsp;&nbsp;&nbsp;&nbspJanuary&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC</span><br>
<span class="lineno"></span><span class="comment" id="2440449">//&nbsp;which&nbsp;(1)&nbsp;looks&nbsp;like&nbsp;a&nbsp;zero,&nbsp;or&nbsp;as&nbsp;close&nbsp;as&nbsp;you&nbsp;can&nbsp;get&nbsp;in&nbsp;a&nbsp;date</span><br>
<span class="lineno"></span><span class="comment" id="2440518">//&nbsp;(1-1-1&nbsp;00:00:00&nbsp;UTC),&nbsp;(2)&nbsp;is&nbsp;unlikely&nbsp;enough&nbsp;to&nbsp;arise&nbsp;in&nbsp;practice&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2440590">//&nbsp;be&nbsp;a&nbsp;suitable&nbsp;&#34;not&nbsp;set&#34;&nbsp;sentinel,&nbsp;unlike&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;and&nbsp;(3)&nbsp;has&nbsp;a</span><br>
<span class="lineno">145</span><span class="comment" id="2440660">//&nbsp;non-negative&nbsp;year&nbsp;even&nbsp;in&nbsp;time&nbsp;zones&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;unlike&nbsp;1-1-0</span><br>
<span class="lineno"></span><span class="comment" id="2440726">//&nbsp;00:00:00&nbsp;UTC,&nbsp;which&nbsp;would&nbsp;be&nbsp;12-31-(-1)&nbsp;19:00:00&nbsp;in&nbsp;New&nbsp;York.</span><br>
<span class="lineno"></span><span class="comment" id="2440791">//</span><br>
<span class="lineno"></span><span class="comment" id="2440794">//&nbsp;The&nbsp;zero&nbsp;Time&nbsp;value&nbsp;does&nbsp;not&nbsp;force&nbsp;a&nbsp;specific&nbsp;epoch&nbsp;for&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2440862">//&nbsp;representation.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;use&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;internally,&nbsp;we</span><br>
<span class="lineno">150</span><span class="comment" id="2440932">//&nbsp;could&nbsp;define&nbsp;that&nbsp;to&nbsp;distinguish&nbsp;a&nbsp;zero&nbsp;value&nbsp;from&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2441003">//&nbsp;time&nbsp;would&nbsp;be&nbsp;represented&nbsp;by&nbsp;sec=-1,&nbsp;nsec=1e9.&nbsp;&nbsp;However,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2441071">//&nbsp;suggest&nbsp;a&nbsp;representation,&nbsp;namely&nbsp;using&nbsp;1-1-1&nbsp;00:00:00&nbsp;UTC&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2441139">//&nbsp;epoch,&nbsp;and&nbsp;that&#39;s&nbsp;what&nbsp;we&nbsp;do.</span><br>
<span class="lineno"></span><span class="comment" id="2441172">//</span><br>
<span class="lineno">155</span><span class="comment" id="2441175">//&nbsp;The&nbsp;Add&nbsp;and&nbsp;Sub&nbsp;computations&nbsp;are&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;choice&nbsp;of&nbsp;epoch.</span><br>
<span class="lineno"></span><span class="comment" id="2441245">//</span><br>
<span class="lineno"></span><span class="comment" id="2441248">//&nbsp;The&nbsp;presentation&nbsp;computations&nbsp;-&nbsp;year,&nbsp;month,&nbsp;minute,&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2441320">//&nbsp;rely&nbsp;heavily&nbsp;on&nbsp;division&nbsp;and&nbsp;modulus&nbsp;by&nbsp;positive&nbsp;constants.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span><span class="comment" id="2441388">//&nbsp;calendrical&nbsp;calculations&nbsp;we&nbsp;want&nbsp;these&nbsp;divisions&nbsp;to&nbsp;round&nbsp;down,&nbsp;even</span><br>
<span class="lineno">160</span><span class="comment" id="2441460">//&nbsp;for&nbsp;negative&nbsp;values,&nbsp;so&nbsp;that&nbsp;the&nbsp;remainder&nbsp;is&nbsp;always&nbsp;positive,&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2441530">//&nbsp;Go&#39;s&nbsp;division&nbsp;(like&nbsp;most&nbsp;hardware&nbsp;division&nbsp;instructions)&nbsp;rounds&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2441600">//&nbsp;zero.&nbsp;&nbsp;We&nbsp;can&nbsp;still&nbsp;do&nbsp;those&nbsp;computations&nbsp;and&nbsp;then&nbsp;adjust&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="2441672">//&nbsp;for&nbsp;a&nbsp;negative&nbsp;numerator,&nbsp;but&nbsp;it&#39;s&nbsp;annoying&nbsp;to&nbsp;write&nbsp;the&nbsp;adjustment</span><br>
<span class="lineno"></span><span class="comment" id="2441743">//&nbsp;over&nbsp;and&nbsp;over.&nbsp;&nbsp;Instead,&nbsp;we&nbsp;can&nbsp;change&nbsp;to&nbsp;a&nbsp;different&nbsp;epoch&nbsp;so&nbsp;long</span><br>
<span class="lineno">165</span><span class="comment" id="2441814">//&nbsp;ago&nbsp;that&nbsp;all&nbsp;the&nbsp;times&nbsp;we&nbsp;care&nbsp;about&nbsp;will&nbsp;be&nbsp;positive,&nbsp;and&nbsp;then&nbsp;round</span><br>
<span class="lineno"></span><span class="comment" id="2441887">//&nbsp;to&nbsp;zero&nbsp;and&nbsp;round&nbsp;down&nbsp;coincide.&nbsp;&nbsp;These&nbsp;presentation&nbsp;routines&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2441960">//&nbsp;have&nbsp;to&nbsp;add&nbsp;the&nbsp;zone&nbsp;offset,&nbsp;so&nbsp;adding&nbsp;the&nbsp;translation&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2442025">//&nbsp;alternate&nbsp;epoch&nbsp;is&nbsp;cheap.&nbsp;&nbsp;For&nbsp;example,&nbsp;having&nbsp;a&nbsp;non-negative&nbsp;time&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2442097">//&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">170</span><span class="comment" id="2442124">//</span><br>
<span class="lineno"></span><span class="comment" id="2442127">//&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2442143">//</span><br>
<span class="lineno"></span><span class="comment" id="2442146">//&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2442160">//</span><br>
<span class="lineno">175</span><span class="comment" id="2442163">//&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2442179">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="2442195">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;+=&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2442209">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="2442214">//</span><br>
<span class="lineno">180</span><span class="comment" id="2442217">//&nbsp;everywhere.</span><br>
<span class="lineno"></span><span class="comment" id="2442232">//</span><br>
<span class="lineno"></span><span class="comment" id="2442235">//&nbsp;The&nbsp;calendar&nbsp;runs&nbsp;on&nbsp;an&nbsp;exact&nbsp;400&nbsp;year&nbsp;cycle:&nbsp;a&nbsp;400-year&nbsp;calendar</span><br>
<span class="lineno"></span><span class="comment" id="2442304">//&nbsp;printed&nbsp;for&nbsp;1970-2469&nbsp;will&nbsp;apply&nbsp;as&nbsp;well&nbsp;to&nbsp;2470-2869.&nbsp;&nbsp;Even&nbsp;the&nbsp;days</span><br>
<span class="lineno"></span><span class="comment" id="2442377">//&nbsp;of&nbsp;the&nbsp;week&nbsp;match&nbsp;up.&nbsp;&nbsp;It&nbsp;simplifies&nbsp;the&nbsp;computations&nbsp;to&nbsp;choose&nbsp;the</span><br>
<span class="lineno">185</span><span class="comment" id="2442448">//&nbsp;cycle&nbsp;boundaries&nbsp;so&nbsp;that&nbsp;the&nbsp;exceptional&nbsp;years&nbsp;are&nbsp;always&nbsp;delayed&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2442520">//&nbsp;long&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&nbsp;means&nbsp;choosing&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2442592">//&nbsp;that&nbsp;the&nbsp;first&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;4th&nbsp;year,&nbsp;the&nbsp;first&nbsp;missed&nbsp;leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2442664">//&nbsp;is&nbsp;the&nbsp;100th&nbsp;year,&nbsp;and&nbsp;the&nbsp;missed&nbsp;missed&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;400th&nbsp;year.</span><br>
<span class="lineno"></span><span class="comment" id="2442737">//&nbsp;So&nbsp;we&#39;d&nbsp;prefer&nbsp;instead&nbsp;to&nbsp;print&nbsp;a&nbsp;calendar&nbsp;for&nbsp;2001-2400&nbsp;and&nbsp;reuse&nbsp;it</span><br>
<span class="lineno">190</span><span class="comment" id="2442810">//&nbsp;for&nbsp;2401-2800.</span><br>
<span class="lineno"></span><span class="comment" id="2442828">//</span><br>
<span class="lineno"></span><span class="comment" id="2442831">//&nbsp;Finally,&nbsp;it&#39;s&nbsp;convenient&nbsp;if&nbsp;the&nbsp;delta&nbsp;between&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2442899">//&nbsp;long-ago&nbsp;epoch&nbsp;is&nbsp;representable&nbsp;by&nbsp;an&nbsp;int64&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2442956">//</span><br>
<span class="lineno">195</span><span class="comment" id="2442959">//&nbsp;These&nbsp;three&nbsp;considerations—choose&nbsp;an&nbsp;epoch&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2443034">//&nbsp;uses&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;that&nbsp;is&nbsp;no&nbsp;more&nbsp;than&nbsp;2⁶³&nbsp;seconds</span><br>
<span class="lineno"></span><span class="comment" id="2443109">//&nbsp;earlier&nbsp;than&nbsp;1970—bring&nbsp;us&nbsp;to&nbsp;the&nbsp;year&nbsp;-292277022399.&nbsp;&nbsp;We&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2443181">//&nbsp;this&nbsp;year&nbsp;as&nbsp;the&nbsp;absolute&nbsp;zero&nbsp;year,&nbsp;and&nbsp;to&nbsp;times&nbsp;measured&nbsp;as&nbsp;a&nbsp;uint64</span><br>
<span class="lineno"></span><span class="comment" id="2443255">//&nbsp;seconds&nbsp;since&nbsp;this&nbsp;year&nbsp;as&nbsp;absolute&nbsp;times.</span><br>
<span class="lineno">200</span><span class="comment" id="2443301">//</span><br>
<span class="lineno"></span><span class="comment" id="2443304">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1—the&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2443380">//&nbsp;used&nbsp;for&nbsp;Time&#39;s&nbsp;sec&nbsp;field—are&nbsp;called&nbsp;internal&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2443438">//</span><br>
<span class="lineno"></span><span class="comment" id="2443441">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1970&nbsp;are&nbsp;called&nbsp;Unix</span><br>
<span class="lineno">205</span><span class="comment" id="2443515">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2443525">//</span><br>
<span class="lineno"></span><span class="comment" id="2443528">//&nbsp;It&nbsp;is&nbsp;tempting&nbsp;to&nbsp;just&nbsp;use&nbsp;the&nbsp;year&nbsp;1&nbsp;as&nbsp;the&nbsp;absolute&nbsp;epoch,&nbsp;defining</span><br>
<span class="lineno"></span><span class="comment" id="2443601">//&nbsp;that&nbsp;the&nbsp;routines&nbsp;are&nbsp;only&nbsp;valid&nbsp;for&nbsp;years&nbsp;&gt;=&nbsp;1.&nbsp;&nbsp;However,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2443667">//&nbsp;routines&nbsp;would&nbsp;then&nbsp;be&nbsp;invalid&nbsp;when&nbsp;displaying&nbsp;the&nbsp;epoch&nbsp;in&nbsp;time&nbsp;zones</span><br>
<span class="lineno">210</span><span class="comment" id="2443741">//&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;since&nbsp;it&nbsp;is&nbsp;year&nbsp;0.&nbsp;&nbsp;It&nbsp;doesn&#39;t&nbsp;seem&nbsp;tenable&nbsp;to&nbsp;say&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2443814">//&nbsp;printing&nbsp;the&nbsp;zero&nbsp;time&nbsp;correctly&nbsp;isn&#39;t&nbsp;supported&nbsp;in&nbsp;half&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2443883">//&nbsp;zones.&nbsp;&nbsp;By&nbsp;comparison,&nbsp;it&#39;s&nbsp;reasonable&nbsp;to&nbsp;mishandle&nbsp;some&nbsp;times&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2443952">//&nbsp;the&nbsp;year&nbsp;-292277022399.</span><br>
<span class="lineno"></span><span class="comment" id="2443979">//</span><br>
<span class="lineno">215</span><span class="comment" id="2443982">//&nbsp;All&nbsp;this&nbsp;is&nbsp;opaque&nbsp;to&nbsp;clients&nbsp;of&nbsp;the&nbsp;API&nbsp;and&nbsp;can&nbsp;be&nbsp;changed&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2444050">//&nbsp;better&nbsp;implementation&nbsp;presents&nbsp;itself.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2444093">const</span>&nbsp;<span class="op" id="2444099">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444102">//&nbsp;The&nbsp;unsigned&nbsp;zero&nbsp;year&nbsp;for&nbsp;internal&nbsp;calculations.</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444156">//&nbsp;Must&nbsp;be&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;times&nbsp;before&nbsp;it&nbsp;will&nbsp;not&nbsp;compute&nbsp;correctly,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444227">//&nbsp;but&nbsp;otherwise&nbsp;can&nbsp;be&nbsp;changed&nbsp;at&nbsp;will.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444269">absoluteZeroYear</span>&nbsp;<span class="op" id="2444286">=</span>&nbsp;<span class="op" id="2444288">-</span><span class="num" id="2444289">292277022399</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444304">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Time.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444335">//&nbsp;Assumed&nbsp;by&nbsp;the&nbsp;unixToInternal&nbsp;computation&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444388">internalYear</span>&nbsp;<span class="op" id="2444401">=</span>&nbsp;<span class="num" id="2444403">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444407">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Unix&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444443">unixYear</span>&nbsp;<span class="op" id="2444452">=</span>&nbsp;<span class="num" id="2444454">1970</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2444461">//&nbsp;Offsets&nbsp;to&nbsp;convert&nbsp;between&nbsp;internal&nbsp;and&nbsp;absolute&nbsp;or&nbsp;Unix&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444529">absoluteToInternal</span>&nbsp;<span class="ident" id="2444548">int64</span>&nbsp;<span class="op" id="2444554">=</span>&nbsp;<span class="op" id="2444556">(</span><span class="ident" id="2444557">absoluteZeroYear</span>&nbsp;<span class="op" id="2444574">-</span>&nbsp;<span class="ident" id="2444576">internalYear</span><span class="op" id="2444588">)</span>&nbsp;<span class="op" id="2444590">*</span>&nbsp;<span class="num" id="2444592">365.2425</span>&nbsp;<span class="op" id="2444601">*</span>&nbsp;<span class="ident" id="2444603">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444618">internalToAbsolute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2444643">=</span>&nbsp;<span class="op" id="2444645">-</span><span class="ident" id="2444646">absoluteToInternal</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444667">unixToInternal</span>&nbsp;<span class="ident" id="2444682">int64</span>&nbsp;<span class="op" id="2444688">=</span>&nbsp;<span class="op" id="2444690">(</span><span class="num" id="2444691">1969</span><span class="op" id="2444695">*</span><span class="num" id="2444696">365</span>&nbsp;<span class="op" id="2444700">+</span>&nbsp;<span class="num" id="2444702">1969</span><span class="op" id="2444706">/</span><span class="num" id="2444707">4</span>&nbsp;<span class="op" id="2444709">-</span>&nbsp;<span class="num" id="2444711">1969</span><span class="op" id="2444715">/</span><span class="num" id="2444716">100</span>&nbsp;<span class="op" id="2444720">+</span>&nbsp;<span class="num" id="2444722">1969</span><span class="op" id="2444726">/</span><span class="num" id="2444727">400</span><span class="op" id="2444730">)</span>&nbsp;<span class="op" id="2444732">*</span>&nbsp;<span class="ident" id="2444734">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2444749">internalToUnix</span>&nbsp;<span class="ident" id="2444764">int64</span>&nbsp;<span class="op" id="2444770">=</span>&nbsp;<span class="op" id="2444772">-</span><span class="ident" id="2444773">unixToInternal</span><br>
<span class="lineno"></span><span class="op" id="2444788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2444791">//&nbsp;IsZero&nbsp;reports&nbsp;whether&nbsp;t&nbsp;represents&nbsp;the&nbsp;zero&nbsp;time&nbsp;instant,</span><br>
<span class="lineno">240</span><span class="comment" id="2444853">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2444889">func</span>&nbsp;<span class="op" id="2444894">(</span><span class="ident" id="2444895">t</span>&nbsp;<span class="ident" id="2444897">Time</span><span class="op" id="2444901">)</span>&nbsp;<span class="ident" id="2444903">IsZero</span><span class="op" id="2444909">(</span><span class="op" id="2444910">)</span>&nbsp;<span class="builtintype" id="2444912">bool</span>&nbsp;<span class="op" id="2444917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2444920">return</span>&nbsp;<span class="ident" id="2444927">t</span><span class="op" id="2444928">.</span><span class="ident" id="2444929">sec</span>&nbsp;<span class="op" id="2444933">==</span>&nbsp;<span class="num" id="2444936">0</span>&nbsp;<span class="op" id="2444938">&amp;&amp;</span>&nbsp;<span class="ident" id="2444941">t</span><span class="op" id="2444942">.</span><span class="ident" id="2444943">nsec</span>&nbsp;<span class="op" id="2444948">==</span>&nbsp;<span class="num" id="2444951">0</span><br>
<span class="lineno"></span><span class="op" id="2444953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2444956">//&nbsp;abs&nbsp;returns&nbsp;the&nbsp;time&nbsp;t&nbsp;as&nbsp;an&nbsp;absolute&nbsp;time,&nbsp;adjusted&nbsp;by&nbsp;the&nbsp;zone&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2445032">//&nbsp;It&nbsp;is&nbsp;called&nbsp;when&nbsp;computing&nbsp;a&nbsp;presentation&nbsp;property&nbsp;like&nbsp;Month&nbsp;or&nbsp;Hour.</span><br>
<span class="lineno"></span><span class="keyword" id="2445107">func</span>&nbsp;<span class="op" id="2445112">(</span><span class="ident" id="2445113">t</span>&nbsp;<span class="ident" id="2445115">Time</span><span class="op" id="2445119">)</span>&nbsp;<span class="ident" id="2445121">abs</span><span class="op" id="2445124">(</span><span class="op" id="2445125">)</span>&nbsp;<span class="ident" id="2445127">uint64</span>&nbsp;<span class="op" id="2445134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445137">l</span>&nbsp;<span class="op" id="2445139">:=</span>&nbsp;<span class="ident" id="2445142">t</span><span class="op" id="2445143">.</span><span class="ident" id="2445144">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2445149">//&nbsp;Avoid&nbsp;function&nbsp;calls&nbsp;when&nbsp;possible.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445189">if</span>&nbsp;<span class="ident" id="2445192">l</span>&nbsp;<span class="op" id="2445194">==</span>&nbsp;<span class="ident" id="2445197">nil</span>&nbsp;<span class="op" id="2445201">||</span>&nbsp;<span class="ident" id="2445204">l</span>&nbsp;<span class="op" id="2445206">==</span>&nbsp;<span class="op" id="2445209">&amp;</span><span class="ident" id="2445210">localLoc</span>&nbsp;<span class="op" id="2445219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445223">l</span>&nbsp;<span class="op" id="2445225">=</span>&nbsp;<span class="ident" id="2445227">l</span><span class="op" id="2445228">.</span><span class="ident" id="2445229">get</span><span class="op" id="2445232">(</span><span class="op" id="2445233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445239">sec</span>&nbsp;<span class="op" id="2445243">:=</span>&nbsp;<span class="ident" id="2445246">t</span><span class="op" id="2445247">.</span><span class="ident" id="2445248">sec</span>&nbsp;<span class="op" id="2445252">+</span>&nbsp;<span class="ident" id="2445254">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445270">if</span>&nbsp;<span class="ident" id="2445273">l</span>&nbsp;<span class="op" id="2445275">!=</span>&nbsp;<span class="op" id="2445278">&amp;</span><span class="ident" id="2445279">utcLoc</span>&nbsp;<span class="op" id="2445286">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445290">if</span>&nbsp;<span class="ident" id="2445293">l</span><span class="op" id="2445294">.</span><span class="ident" id="2445295">cacheZone</span>&nbsp;<span class="op" id="2445305">!=</span>&nbsp;<span class="ident" id="2445308">nil</span>&nbsp;<span class="op" id="2445312">&amp;&amp;</span>&nbsp;<span class="ident" id="2445315">l</span><span class="op" id="2445316">.</span><span class="ident" id="2445317">cacheStart</span>&nbsp;<span class="op" id="2445328">&lt;=</span>&nbsp;<span class="ident" id="2445331">sec</span>&nbsp;<span class="op" id="2445335">&amp;&amp;</span>&nbsp;<span class="ident" id="2445338">sec</span>&nbsp;<span class="op" id="2445342">&lt;</span>&nbsp;<span class="ident" id="2445344">l</span><span class="op" id="2445345">.</span><span class="ident" id="2445346">cacheEnd</span>&nbsp;<span class="op" id="2445355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445360">sec</span>&nbsp;<span class="op" id="2445364">+=</span>&nbsp;<span class="ident" id="2445367">int64</span><span class="op" id="2445372">(</span><span class="ident" id="2445373">l</span><span class="op" id="2445374">.</span><span class="ident" id="2445375">cacheZone</span><span class="op" id="2445384">.</span><span class="ident" id="2445385">offset</span><span class="op" id="2445391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445395">}</span>&nbsp;<span class="keyword" id="2445397">else</span>&nbsp;<span class="op" id="2445402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445407">_</span><span class="op" id="2445408">,</span>&nbsp;<span class="ident" id="2445410">offset</span><span class="op" id="2445416">,</span>&nbsp;<span class="ident" id="2445418">_</span><span class="op" id="2445419">,</span>&nbsp;<span class="ident" id="2445421">_</span><span class="op" id="2445422">,</span>&nbsp;<span class="ident" id="2445424">_</span>&nbsp;<span class="op" id="2445426">:=</span>&nbsp;<span class="ident" id="2445429">l</span><span class="op" id="2445430">.</span><span class="ident" id="2445431">lookup</span><span class="op" id="2445437">(</span><span class="ident" id="2445438">sec</span><span class="op" id="2445441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445446">sec</span>&nbsp;<span class="op" id="2445450">+=</span>&nbsp;<span class="ident" id="2445453">int64</span><span class="op" id="2445458">(</span><span class="ident" id="2445459">offset</span><span class="op" id="2445465">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445475">return</span>&nbsp;<span class="ident" id="2445482">uint64</span><span class="op" id="2445488">(</span><span class="ident" id="2445489">sec</span>&nbsp;<span class="op" id="2445493">+</span>&nbsp;<span class="op" id="2445495">(</span><span class="ident" id="2445496">unixToInternal</span>&nbsp;<span class="op" id="2445511">+</span>&nbsp;<span class="ident" id="2445513">internalToAbsolute</span><span class="op" id="2445531">)</span><span class="op" id="2445532">)</span><br>
<span class="lineno"></span><span class="op" id="2445534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2445537">//&nbsp;locabs&nbsp;is&nbsp;a&nbsp;combination&nbsp;of&nbsp;the&nbsp;Zone&nbsp;and&nbsp;abs&nbsp;methods,</span><br>
<span class="lineno"></span><span class="comment" id="2445593">//&nbsp;extracting&nbsp;both&nbsp;return&nbsp;values&nbsp;from&nbsp;a&nbsp;single&nbsp;zone&nbsp;lookup.</span><br>
<span class="lineno"></span><span class="keyword" id="2445653">func</span>&nbsp;<span class="op" id="2445658">(</span><span class="ident" id="2445659">t</span>&nbsp;<span class="ident" id="2445661">Time</span><span class="op" id="2445665">)</span>&nbsp;<span class="ident" id="2445667">locabs</span><span class="op" id="2445673">(</span><span class="op" id="2445674">)</span>&nbsp;<span class="op" id="2445676">(</span><span class="ident" id="2445677">name</span>&nbsp;<span class="builtintype" id="2445682">string</span><span class="op" id="2445688">,</span>&nbsp;<span class="ident" id="2445690">offset</span>&nbsp;<span class="builtintype" id="2445697">int</span><span class="op" id="2445700">,</span>&nbsp;<span class="ident" id="2445702">abs</span>&nbsp;<span class="ident" id="2445706">uint64</span><span class="op" id="2445712">)</span>&nbsp;<span class="op" id="2445714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445717">l</span>&nbsp;<span class="op" id="2445719">:=</span>&nbsp;<span class="ident" id="2445722">t</span><span class="op" id="2445723">.</span><span class="ident" id="2445724">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445729">if</span>&nbsp;<span class="ident" id="2445732">l</span>&nbsp;<span class="op" id="2445734">==</span>&nbsp;<span class="ident" id="2445737">nil</span>&nbsp;<span class="op" id="2445741">||</span>&nbsp;<span class="ident" id="2445744">l</span>&nbsp;<span class="op" id="2445746">==</span>&nbsp;<span class="op" id="2445749">&amp;</span><span class="ident" id="2445750">localLoc</span>&nbsp;<span class="op" id="2445759">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445763">l</span>&nbsp;<span class="op" id="2445765">=</span>&nbsp;<span class="ident" id="2445767">l</span><span class="op" id="2445768">.</span><span class="ident" id="2445769">get</span><span class="op" id="2445772">(</span><span class="op" id="2445773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2445776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2445779">//&nbsp;Avoid&nbsp;function&nbsp;call&nbsp;if&nbsp;we&nbsp;hit&nbsp;the&nbsp;local&nbsp;time&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445835">sec</span>&nbsp;<span class="op" id="2445839">:=</span>&nbsp;<span class="ident" id="2445842">t</span><span class="op" id="2445843">.</span><span class="ident" id="2445844">sec</span>&nbsp;<span class="op" id="2445848">+</span>&nbsp;<span class="ident" id="2445850">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445866">if</span>&nbsp;<span class="ident" id="2445869">l</span>&nbsp;<span class="op" id="2445871">!=</span>&nbsp;<span class="op" id="2445874">&amp;</span><span class="ident" id="2445875">utcLoc</span>&nbsp;<span class="op" id="2445882">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2445886">if</span>&nbsp;<span class="ident" id="2445889">l</span><span class="op" id="2445890">.</span><span class="ident" id="2445891">cacheZone</span>&nbsp;<span class="op" id="2445901">!=</span>&nbsp;<span class="ident" id="2445904">nil</span>&nbsp;<span class="op" id="2445908">&amp;&amp;</span>&nbsp;<span class="ident" id="2445911">l</span><span class="op" id="2445912">.</span><span class="ident" id="2445913">cacheStart</span>&nbsp;<span class="op" id="2445924">&lt;=</span>&nbsp;<span class="ident" id="2445927">sec</span>&nbsp;<span class="op" id="2445931">&amp;&amp;</span>&nbsp;<span class="ident" id="2445934">sec</span>&nbsp;<span class="op" id="2445938">&lt;</span>&nbsp;<span class="ident" id="2445940">l</span><span class="op" id="2445941">.</span><span class="ident" id="2445942">cacheEnd</span>&nbsp;<span class="op" id="2445951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445956">name</span>&nbsp;<span class="op" id="2445961">=</span>&nbsp;<span class="ident" id="2445963">l</span><span class="op" id="2445964">.</span><span class="ident" id="2445965">cacheZone</span><span class="op" id="2445974">.</span><span class="ident" id="2445975">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2445983">offset</span>&nbsp;<span class="op" id="2445990">=</span>&nbsp;<span class="ident" id="2445992">l</span><span class="op" id="2445993">.</span><span class="ident" id="2445994">cacheZone</span><span class="op" id="2446003">.</span><span class="ident" id="2446004">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446013">}</span>&nbsp;<span class="keyword" id="2446015">else</span>&nbsp;<span class="op" id="2446020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446025">name</span><span class="op" id="2446029">,</span>&nbsp;<span class="ident" id="2446031">offset</span><span class="op" id="2446037">,</span>&nbsp;<span class="ident" id="2446039">_</span><span class="op" id="2446040">,</span>&nbsp;<span class="ident" id="2446042">_</span><span class="op" id="2446043">,</span>&nbsp;<span class="ident" id="2446045">_</span>&nbsp;<span class="op" id="2446047">=</span>&nbsp;<span class="ident" id="2446049">l</span><span class="op" id="2446050">.</span><span class="ident" id="2446051">lookup</span><span class="op" id="2446057">(</span><span class="ident" id="2446058">sec</span><span class="op" id="2446061">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446069">sec</span>&nbsp;<span class="op" id="2446073">+=</span>&nbsp;<span class="ident" id="2446076">int64</span><span class="op" id="2446081">(</span><span class="ident" id="2446082">offset</span><span class="op" id="2446088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446091">}</span>&nbsp;<span class="keyword" id="2446093">else</span>&nbsp;<span class="op" id="2446098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446102">name</span>&nbsp;<span class="op" id="2446107">=</span>&nbsp;<span class="string" id="2446109">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2446116">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446119">abs</span>&nbsp;<span class="op" id="2446123">=</span>&nbsp;<span class="ident" id="2446125">uint64</span><span class="op" id="2446131">(</span><span class="ident" id="2446132">sec</span>&nbsp;<span class="op" id="2446136">+</span>&nbsp;<span class="op" id="2446138">(</span><span class="ident" id="2446139">unixToInternal</span>&nbsp;<span class="op" id="2446154">+</span>&nbsp;<span class="ident" id="2446156">internalToAbsolute</span><span class="op" id="2446174">)</span><span class="op" id="2446175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446178">return</span><br>
<span class="lineno"></span><span class="op" id="2446185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2446188">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno">290</span><span class="keyword" id="2446248">func</span>&nbsp;<span class="op" id="2446253">(</span><span class="ident" id="2446254">t</span>&nbsp;<span class="ident" id="2446256">Time</span><span class="op" id="2446260">)</span>&nbsp;<span class="ident" id="2446262">Date</span><span class="op" id="2446266">(</span><span class="op" id="2446267">)</span>&nbsp;<span class="op" id="2446269">(</span><span class="ident" id="2446270">year</span>&nbsp;<span class="builtintype" id="2446275">int</span><span class="op" id="2446278">,</span>&nbsp;<span class="ident" id="2446280">month</span>&nbsp;<span class="ident" id="2446286">Month</span><span class="op" id="2446291">,</span>&nbsp;<span class="ident" id="2446293">day</span>&nbsp;<span class="builtintype" id="2446297">int</span><span class="op" id="2446300">)</span>&nbsp;<span class="op" id="2446302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446305">year</span><span class="op" id="2446309">,</span>&nbsp;<span class="ident" id="2446311">month</span><span class="op" id="2446316">,</span>&nbsp;<span class="ident" id="2446318">day</span><span class="op" id="2446321">,</span>&nbsp;<span class="ident" id="2446323">_</span>&nbsp;<span class="op" id="2446325">=</span>&nbsp;<span class="ident" id="2446327">t</span><span class="op" id="2446328">.</span><span class="ident" id="2446329">date</span><span class="op" id="2446333">(</span><span class="builtintype" id="2446334">true</span><span class="op" id="2446338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446341">return</span><br>
<span class="lineno"></span><span class="op" id="2446348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="2446351">//&nbsp;Year&nbsp;returns&nbsp;the&nbsp;year&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2446395">func</span>&nbsp;<span class="op" id="2446400">(</span><span class="ident" id="2446401">t</span>&nbsp;<span class="ident" id="2446403">Time</span><span class="op" id="2446407">)</span>&nbsp;<span class="ident" id="2446409">Year</span><span class="op" id="2446413">(</span><span class="op" id="2446414">)</span>&nbsp;<span class="builtintype" id="2446416">int</span>&nbsp;<span class="op" id="2446420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446423">year</span><span class="op" id="2446427">,</span>&nbsp;<span class="ident" id="2446429">_</span><span class="op" id="2446430">,</span>&nbsp;<span class="ident" id="2446432">_</span><span class="op" id="2446433">,</span>&nbsp;<span class="ident" id="2446435">_</span>&nbsp;<span class="op" id="2446437">:=</span>&nbsp;<span class="ident" id="2446440">t</span><span class="op" id="2446441">.</span><span class="ident" id="2446442">date</span><span class="op" id="2446446">(</span><span class="builtintype" id="2446447">false</span><span class="op" id="2446452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446455">return</span>&nbsp;<span class="ident" id="2446462">year</span><br>
<span class="lineno"></span><span class="op" id="2446467">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2446470">//&nbsp;Month&nbsp;returns&nbsp;the&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2446525">func</span>&nbsp;<span class="op" id="2446530">(</span><span class="ident" id="2446531">t</span>&nbsp;<span class="ident" id="2446533">Time</span><span class="op" id="2446537">)</span>&nbsp;<span class="ident" id="2446539">Month</span><span class="op" id="2446544">(</span><span class="op" id="2446545">)</span>&nbsp;<span class="ident" id="2446547">Month</span>&nbsp;<span class="op" id="2446553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446556">_</span><span class="op" id="2446557">,</span>&nbsp;<span class="ident" id="2446559">month</span><span class="op" id="2446564">,</span>&nbsp;<span class="ident" id="2446566">_</span><span class="op" id="2446567">,</span>&nbsp;<span class="ident" id="2446569">_</span>&nbsp;<span class="op" id="2446571">:=</span>&nbsp;<span class="ident" id="2446574">t</span><span class="op" id="2446575">.</span><span class="ident" id="2446576">date</span><span class="op" id="2446580">(</span><span class="builtintype" id="2446581">true</span><span class="op" id="2446585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446588">return</span>&nbsp;<span class="ident" id="2446595">month</span><br>
<span class="lineno">305</span><span class="op" id="2446601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2446604">//&nbsp;Day&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2446656">func</span>&nbsp;<span class="op" id="2446661">(</span><span class="ident" id="2446662">t</span>&nbsp;<span class="ident" id="2446664">Time</span><span class="op" id="2446668">)</span>&nbsp;<span class="ident" id="2446670">Day</span><span class="op" id="2446673">(</span><span class="op" id="2446674">)</span>&nbsp;<span class="builtintype" id="2446676">int</span>&nbsp;<span class="op" id="2446680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2446683">_</span><span class="op" id="2446684">,</span>&nbsp;<span class="ident" id="2446686">_</span><span class="op" id="2446687">,</span>&nbsp;<span class="ident" id="2446689">day</span><span class="op" id="2446692">,</span>&nbsp;<span class="ident" id="2446694">_</span>&nbsp;<span class="op" id="2446696">:=</span>&nbsp;<span class="ident" id="2446699">t</span><span class="op" id="2446700">.</span><span class="ident" id="2446701">date</span><span class="op" id="2446705">(</span><span class="builtintype" id="2446706">true</span><span class="op" id="2446710">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446713">return</span>&nbsp;<span class="ident" id="2446720">day</span><br>
<span class="lineno"></span><span class="op" id="2446724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2446727">//&nbsp;Weekday&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2446782">func</span>&nbsp;<span class="op" id="2446787">(</span><span class="ident" id="2446788">t</span>&nbsp;<span class="ident" id="2446790">Time</span><span class="op" id="2446794">)</span>&nbsp;<span class="ident" id="2446796">Weekday</span><span class="op" id="2446803">(</span><span class="op" id="2446804">)</span>&nbsp;<span class="ident" id="2446806">Weekday</span>&nbsp;<span class="op" id="2446814">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2446817">return</span>&nbsp;<span class="ident" id="2446824">absWeekday</span><span class="op" id="2446834">(</span><span class="ident" id="2446835">t</span><span class="op" id="2446836">.</span><span class="ident" id="2446837">abs</span><span class="op" id="2446840">(</span><span class="op" id="2446841">)</span><span class="op" id="2446842">)</span><br>
<span class="lineno"></span><span class="op" id="2446844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2446847">//&nbsp;absWeekday&nbsp;is&nbsp;like&nbsp;Weekday&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2446911">func</span>&nbsp;<span class="ident" id="2446916">absWeekday</span><span class="op" id="2446926">(</span><span class="ident" id="2446927">abs</span>&nbsp;<span class="ident" id="2446931">uint64</span><span class="op" id="2446937">)</span>&nbsp;<span class="ident" id="2446939">Weekday</span>&nbsp;<span class="op" id="2446947">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2446950">//&nbsp;January&nbsp;1&nbsp;of&nbsp;the&nbsp;absolute&nbsp;year,&nbsp;like&nbsp;January&nbsp;1&nbsp;of&nbsp;2001,&nbsp;was&nbsp;a&nbsp;Monday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447024">sec</span>&nbsp;<span class="op" id="2447028">:=</span>&nbsp;<span class="op" id="2447031">(</span><span class="ident" id="2447032">abs</span>&nbsp;<span class="op" id="2447036">+</span>&nbsp;<span class="ident" id="2447038">uint64</span><span class="op" id="2447044">(</span><span class="ident" id="2447045">Monday</span><span class="op" id="2447051">)</span><span class="op" id="2447052">*</span><span class="ident" id="2447053">secondsPerDay</span><span class="op" id="2447066">)</span>&nbsp;<span class="op" id="2447068">%</span>&nbsp;<span class="ident" id="2447070">secondsPerWeek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447086">return</span>&nbsp;<span class="ident" id="2447093">Weekday</span><span class="op" id="2447100">(</span><span class="builtintype" id="2447101">int</span><span class="op" id="2447104">(</span><span class="ident" id="2447105">sec</span><span class="op" id="2447108">)</span>&nbsp;<span class="op" id="2447110">/</span>&nbsp;<span class="ident" id="2447112">secondsPerDay</span><span class="op" id="2447125">)</span><br>
<span class="lineno"></span><span class="op" id="2447127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="comment" id="2447130">//&nbsp;ISOWeek&nbsp;returns&nbsp;the&nbsp;ISO&nbsp;8601&nbsp;year&nbsp;and&nbsp;week&nbsp;number&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="2447202">//&nbsp;Week&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;53.&nbsp;Jan&nbsp;01&nbsp;to&nbsp;Jan&nbsp;03&nbsp;of&nbsp;year&nbsp;n&nbsp;might&nbsp;belong&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2447274">//&nbsp;week&nbsp;52&nbsp;or&nbsp;53&nbsp;of&nbsp;year&nbsp;n-1,&nbsp;and&nbsp;Dec&nbsp;29&nbsp;to&nbsp;Dec&nbsp;31&nbsp;might&nbsp;belong&nbsp;to&nbsp;week&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2447348">//&nbsp;of&nbsp;year&nbsp;n+1.</span><br>
<span class="lineno"></span><span class="keyword" id="2447364">func</span>&nbsp;<span class="op" id="2447369">(</span><span class="ident" id="2447370">t</span>&nbsp;<span class="ident" id="2447372">Time</span><span class="op" id="2447376">)</span>&nbsp;<span class="ident" id="2447378">ISOWeek</span><span class="op" id="2447385">(</span><span class="op" id="2447386">)</span>&nbsp;<span class="op" id="2447388">(</span><span class="ident" id="2447389">year</span><span class="op" id="2447393">,</span>&nbsp;<span class="ident" id="2447395">week</span>&nbsp;<span class="builtintype" id="2447400">int</span><span class="op" id="2447403">)</span>&nbsp;<span class="op" id="2447405">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447408">year</span><span class="op" id="2447412">,</span>&nbsp;<span class="ident" id="2447414">month</span><span class="op" id="2447419">,</span>&nbsp;<span class="ident" id="2447421">day</span><span class="op" id="2447424">,</span>&nbsp;<span class="ident" id="2447426">yday</span>&nbsp;<span class="op" id="2447431">:=</span>&nbsp;<span class="ident" id="2447434">t</span><span class="op" id="2447435">.</span><span class="ident" id="2447436">date</span><span class="op" id="2447440">(</span><span class="builtintype" id="2447441">true</span><span class="op" id="2447445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447448">wday</span>&nbsp;<span class="op" id="2447453">:=</span>&nbsp;<span class="builtintype" id="2447456">int</span><span class="op" id="2447459">(</span><span class="ident" id="2447460">t</span><span class="op" id="2447461">.</span><span class="ident" id="2447462">Weekday</span><span class="op" id="2447469">(</span><span class="op" id="2447470">)</span><span class="op" id="2447471">+</span><span class="num" id="2447472">6</span><span class="op" id="2447473">)</span>&nbsp;<span class="op" id="2447475">%</span>&nbsp;<span class="num" id="2447477">7</span>&nbsp;<span class="comment" id="2447479">//&nbsp;weekday&nbsp;but&nbsp;Monday&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2447507">const</span>&nbsp;<span class="op" id="2447513">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447517">Mon</span>&nbsp;<span class="builtintype" id="2447521">int</span>&nbsp;<span class="op" id="2447525">=</span>&nbsp;<span class="ident" id="2447527">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447534">Tue</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447540">Wed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447546">Thu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447552">Fri</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447558">Sat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447564">Sun</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2447569">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447573">//&nbsp;Calculate&nbsp;week&nbsp;as&nbsp;number&nbsp;of&nbsp;Mondays&nbsp;in&nbsp;year&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447627">//&nbsp;and&nbsp;including&nbsp;today,&nbsp;plus&nbsp;1&nbsp;because&nbsp;the&nbsp;first&nbsp;week&nbsp;is&nbsp;week&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447693">//&nbsp;Putting&nbsp;the&nbsp;+&nbsp;1&nbsp;inside&nbsp;the&nbsp;numerator&nbsp;as&nbsp;a&nbsp;+&nbsp;7&nbsp;keeps&nbsp;the</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447753">//&nbsp;numerator&nbsp;from&nbsp;being&nbsp;negative,&nbsp;which&nbsp;would&nbsp;cause&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447812">//&nbsp;round&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2447835">week</span>&nbsp;<span class="op" id="2447840">=</span>&nbsp;<span class="op" id="2447842">(</span><span class="ident" id="2447843">yday</span>&nbsp;<span class="op" id="2447848">-</span>&nbsp;<span class="ident" id="2447850">wday</span>&nbsp;<span class="op" id="2447855">+</span>&nbsp;<span class="num" id="2447857">7</span><span class="op" id="2447858">)</span>&nbsp;<span class="op" id="2447860">/</span>&nbsp;<span class="num" id="2447862">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447866">//&nbsp;The&nbsp;week&nbsp;number&nbsp;is&nbsp;now&nbsp;correct&nbsp;under&nbsp;the&nbsp;assumption</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447922">//&nbsp;that&nbsp;the&nbsp;first&nbsp;Monday&nbsp;of&nbsp;the&nbsp;year&nbsp;is&nbsp;in&nbsp;week&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2447974">//&nbsp;If&nbsp;Jan&nbsp;1&nbsp;is&nbsp;a&nbsp;Tuesday,&nbsp;Wednesday,&nbsp;or&nbsp;Thursday,&nbsp;the&nbsp;first&nbsp;Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448042">//&nbsp;is&nbsp;actually&nbsp;in&nbsp;week&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448069">jan1wday</span>&nbsp;<span class="op" id="2448078">:=</span>&nbsp;<span class="op" id="2448081">(</span><span class="ident" id="2448082">wday</span>&nbsp;<span class="op" id="2448087">-</span>&nbsp;<span class="ident" id="2448089">yday</span>&nbsp;<span class="op" id="2448094">+</span>&nbsp;<span class="num" id="2448096">7</span><span class="op" id="2448097">*</span><span class="num" id="2448098">53</span><span class="op" id="2448100">)</span>&nbsp;<span class="op" id="2448102">%</span>&nbsp;<span class="num" id="2448104">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448107">if</span>&nbsp;<span class="ident" id="2448110">Tue</span>&nbsp;<span class="op" id="2448114">&lt;=</span>&nbsp;<span class="ident" id="2448117">jan1wday</span>&nbsp;<span class="op" id="2448126">&amp;&amp;</span>&nbsp;<span class="ident" id="2448129">jan1wday</span>&nbsp;<span class="op" id="2448138">&lt;=</span>&nbsp;<span class="ident" id="2448141">Thu</span>&nbsp;<span class="op" id="2448145">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448149">week</span><span class="op" id="2448153">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448161">//&nbsp;If&nbsp;the&nbsp;week&nbsp;number&nbsp;is&nbsp;still&nbsp;0,&nbsp;we&#39;re&nbsp;in&nbsp;early&nbsp;January&nbsp;but&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448226">//&nbsp;the&nbsp;last&nbsp;week&nbsp;of&nbsp;last&nbsp;year.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448258">if</span>&nbsp;<span class="ident" id="2448261">week</span>&nbsp;<span class="op" id="2448266">==</span>&nbsp;<span class="num" id="2448269">0</span>&nbsp;<span class="op" id="2448271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448275">year</span><span class="op" id="2448279">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448284">week</span>&nbsp;<span class="op" id="2448289">=</span>&nbsp;<span class="num" id="2448291">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448296">//&nbsp;A&nbsp;year&nbsp;has&nbsp;53&nbsp;weeks&nbsp;when&nbsp;Jan&nbsp;1&nbsp;or&nbsp;Dec&nbsp;31&nbsp;is&nbsp;a&nbsp;Thursday,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448357">//&nbsp;meaning&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Friday</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448405">//&nbsp;or&nbsp;it&nbsp;was&nbsp;a&nbsp;leap&nbsp;year&nbsp;and&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Saturday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448474">if</span>&nbsp;<span class="ident" id="2448477">jan1wday</span>&nbsp;<span class="op" id="2448486">==</span>&nbsp;<span class="ident" id="2448489">Fri</span>&nbsp;<span class="op" id="2448493">||</span>&nbsp;<span class="op" id="2448496">(</span><span class="ident" id="2448497">jan1wday</span>&nbsp;<span class="op" id="2448506">==</span>&nbsp;<span class="ident" id="2448509">Sat</span>&nbsp;<span class="op" id="2448513">&amp;&amp;</span>&nbsp;<span class="ident" id="2448516">isLeap</span><span class="op" id="2448522">(</span><span class="ident" id="2448523">year</span><span class="op" id="2448527">)</span><span class="op" id="2448528">)</span>&nbsp;<span class="op" id="2448530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448535">week</span><span class="op" id="2448539">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448547">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448551">//&nbsp;December&nbsp;29&nbsp;to&nbsp;31&nbsp;are&nbsp;in&nbsp;week&nbsp;1&nbsp;of&nbsp;next&nbsp;year&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448603">//&nbsp;they&nbsp;are&nbsp;after&nbsp;the&nbsp;last&nbsp;Thursday&nbsp;of&nbsp;the&nbsp;year&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2448656">//&nbsp;December&nbsp;31&nbsp;is&nbsp;a&nbsp;Monday,&nbsp;Tuesday,&nbsp;or&nbsp;Wednesday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448708">if</span>&nbsp;<span class="ident" id="2448711">month</span>&nbsp;<span class="op" id="2448717">==</span>&nbsp;<span class="ident" id="2448720">December</span>&nbsp;<span class="op" id="2448729">&amp;&amp;</span>&nbsp;<span class="ident" id="2448732">day</span>&nbsp;<span class="op" id="2448736">&gt;=</span>&nbsp;<span class="num" id="2448739">29</span>&nbsp;<span class="op" id="2448742">&amp;&amp;</span>&nbsp;<span class="ident" id="2448745">wday</span>&nbsp;<span class="op" id="2448750">&lt;</span>&nbsp;<span class="ident" id="2448752">Thu</span>&nbsp;<span class="op" id="2448756">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448760">if</span>&nbsp;<span class="ident" id="2448763">dec31wday</span>&nbsp;<span class="op" id="2448773">:=</span>&nbsp;<span class="op" id="2448776">(</span><span class="ident" id="2448777">wday</span>&nbsp;<span class="op" id="2448782">+</span>&nbsp;<span class="num" id="2448784">31</span>&nbsp;<span class="op" id="2448787">-</span>&nbsp;<span class="ident" id="2448789">day</span><span class="op" id="2448792">)</span>&nbsp;<span class="op" id="2448794">%</span>&nbsp;<span class="num" id="2448796">7</span><span class="op" id="2448797">;</span>&nbsp;<span class="ident" id="2448799">Mon</span>&nbsp;<span class="op" id="2448803">&lt;=</span>&nbsp;<span class="ident" id="2448806">dec31wday</span>&nbsp;<span class="op" id="2448816">&amp;&amp;</span>&nbsp;<span class="ident" id="2448819">dec31wday</span>&nbsp;<span class="op" id="2448829">&lt;=</span>&nbsp;<span class="ident" id="2448832">Wed</span>&nbsp;<span class="op" id="2448836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448841">year</span><span class="op" id="2448845">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2448851">week</span>&nbsp;<span class="op" id="2448856">=</span>&nbsp;<span class="num" id="2448858">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2448865">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2448869">return</span><br>
<span class="lineno"></span><span class="op" id="2448876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2448879">//&nbsp;Clock&nbsp;returns&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;second&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno">385</span><span class="keyword" id="2448956">func</span>&nbsp;<span class="op" id="2448961">(</span><span class="ident" id="2448962">t</span>&nbsp;<span class="ident" id="2448964">Time</span><span class="op" id="2448968">)</span>&nbsp;<span class="ident" id="2448970">Clock</span><span class="op" id="2448975">(</span><span class="op" id="2448976">)</span>&nbsp;<span class="op" id="2448978">(</span><span class="ident" id="2448979">hour</span><span class="op" id="2448983">,</span>&nbsp;<span class="ident" id="2448985">min</span><span class="op" id="2448988">,</span>&nbsp;<span class="ident" id="2448990">sec</span>&nbsp;<span class="builtintype" id="2448994">int</span><span class="op" id="2448997">)</span>&nbsp;<span class="op" id="2448999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449002">return</span>&nbsp;<span class="ident" id="2449009">absClock</span><span class="op" id="2449017">(</span><span class="ident" id="2449018">t</span><span class="op" id="2449019">.</span><span class="ident" id="2449020">abs</span><span class="op" id="2449023">(</span><span class="op" id="2449024">)</span><span class="op" id="2449025">)</span><br>
<span class="lineno"></span><span class="op" id="2449027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449030">//&nbsp;absClock&nbsp;is&nbsp;like&nbsp;clock&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="2449090">func</span>&nbsp;<span class="ident" id="2449095">absClock</span><span class="op" id="2449103">(</span><span class="ident" id="2449104">abs</span>&nbsp;<span class="ident" id="2449108">uint64</span><span class="op" id="2449114">)</span>&nbsp;<span class="op" id="2449116">(</span><span class="ident" id="2449117">hour</span><span class="op" id="2449121">,</span>&nbsp;<span class="ident" id="2449123">min</span><span class="op" id="2449126">,</span>&nbsp;<span class="ident" id="2449128">sec</span>&nbsp;<span class="builtintype" id="2449132">int</span><span class="op" id="2449135">)</span>&nbsp;<span class="op" id="2449137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449140">sec</span>&nbsp;<span class="op" id="2449144">=</span>&nbsp;<span class="builtintype" id="2449146">int</span><span class="op" id="2449149">(</span><span class="ident" id="2449150">abs</span>&nbsp;<span class="op" id="2449154">%</span>&nbsp;<span class="ident" id="2449156">secondsPerDay</span><span class="op" id="2449169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449172">hour</span>&nbsp;<span class="op" id="2449177">=</span>&nbsp;<span class="ident" id="2449179">sec</span>&nbsp;<span class="op" id="2449183">/</span>&nbsp;<span class="ident" id="2449185">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449201">sec</span>&nbsp;<span class="op" id="2449205">-=</span>&nbsp;<span class="ident" id="2449208">hour</span>&nbsp;<span class="op" id="2449213">*</span>&nbsp;<span class="ident" id="2449215">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449231">min</span>&nbsp;<span class="op" id="2449235">=</span>&nbsp;<span class="ident" id="2449237">sec</span>&nbsp;<span class="op" id="2449241">/</span>&nbsp;<span class="ident" id="2449243">secondsPerMinute</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2449261">sec</span>&nbsp;<span class="op" id="2449265">-=</span>&nbsp;<span class="ident" id="2449268">min</span>&nbsp;<span class="op" id="2449272">*</span>&nbsp;<span class="ident" id="2449274">secondsPerMinute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449292">return</span><br>
<span class="lineno"></span><span class="op" id="2449299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449302">//&nbsp;Hour&nbsp;returns&nbsp;the&nbsp;hour&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;23].</span><br>
<span class="lineno">400</span><span class="keyword" id="2449380">func</span>&nbsp;<span class="op" id="2449385">(</span><span class="ident" id="2449386">t</span>&nbsp;<span class="ident" id="2449388">Time</span><span class="op" id="2449392">)</span>&nbsp;<span class="ident" id="2449394">Hour</span><span class="op" id="2449398">(</span><span class="op" id="2449399">)</span>&nbsp;<span class="builtintype" id="2449401">int</span>&nbsp;<span class="op" id="2449405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449408">return</span>&nbsp;<span class="builtintype" id="2449415">int</span><span class="op" id="2449418">(</span><span class="ident" id="2449419">t</span><span class="op" id="2449420">.</span><span class="ident" id="2449421">abs</span><span class="op" id="2449424">(</span><span class="op" id="2449425">)</span><span class="op" id="2449426">%</span><span class="ident" id="2449427">secondsPerDay</span><span class="op" id="2449440">)</span>&nbsp;<span class="op" id="2449442">/</span>&nbsp;<span class="ident" id="2449444">secondsPerHour</span><br>
<span class="lineno"></span><span class="op" id="2449459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449462">//&nbsp;Minute&nbsp;returns&nbsp;the&nbsp;minute&nbsp;offset&nbsp;within&nbsp;the&nbsp;hour&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">405</span><span class="keyword" id="2449552">func</span>&nbsp;<span class="op" id="2449557">(</span><span class="ident" id="2449558">t</span>&nbsp;<span class="ident" id="2449560">Time</span><span class="op" id="2449564">)</span>&nbsp;<span class="ident" id="2449566">Minute</span><span class="op" id="2449572">(</span><span class="op" id="2449573">)</span>&nbsp;<span class="builtintype" id="2449575">int</span>&nbsp;<span class="op" id="2449579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449582">return</span>&nbsp;<span class="builtintype" id="2449589">int</span><span class="op" id="2449592">(</span><span class="ident" id="2449593">t</span><span class="op" id="2449594">.</span><span class="ident" id="2449595">abs</span><span class="op" id="2449598">(</span><span class="op" id="2449599">)</span><span class="op" id="2449600">%</span><span class="ident" id="2449601">secondsPerHour</span><span class="op" id="2449615">)</span>&nbsp;<span class="op" id="2449617">/</span>&nbsp;<span class="ident" id="2449619">secondsPerMinute</span><br>
<span class="lineno"></span><span class="op" id="2449636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449639">//&nbsp;Second&nbsp;returns&nbsp;the&nbsp;second&nbsp;offset&nbsp;within&nbsp;the&nbsp;minute&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">410</span><span class="keyword" id="2449731">func</span>&nbsp;<span class="op" id="2449736">(</span><span class="ident" id="2449737">t</span>&nbsp;<span class="ident" id="2449739">Time</span><span class="op" id="2449743">)</span>&nbsp;<span class="ident" id="2449745">Second</span><span class="op" id="2449751">(</span><span class="op" id="2449752">)</span>&nbsp;<span class="builtintype" id="2449754">int</span>&nbsp;<span class="op" id="2449758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449761">return</span>&nbsp;<span class="builtintype" id="2449768">int</span><span class="op" id="2449771">(</span><span class="ident" id="2449772">t</span><span class="op" id="2449773">.</span><span class="ident" id="2449774">abs</span><span class="op" id="2449777">(</span><span class="op" id="2449778">)</span>&nbsp;<span class="op" id="2449780">%</span>&nbsp;<span class="ident" id="2449782">secondsPerMinute</span><span class="op" id="2449798">)</span><br>
<span class="lineno"></span><span class="op" id="2449800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2449803">//&nbsp;Nanosecond&nbsp;returns&nbsp;the&nbsp;nanosecond&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;specified&nbsp;by&nbsp;t,</span><br>
<span class="lineno">415</span><span class="comment" id="2449881">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2449913">func</span>&nbsp;<span class="op" id="2449918">(</span><span class="ident" id="2449919">t</span>&nbsp;<span class="ident" id="2449921">Time</span><span class="op" id="2449925">)</span>&nbsp;<span class="ident" id="2449927">Nanosecond</span><span class="op" id="2449937">(</span><span class="op" id="2449938">)</span>&nbsp;<span class="builtintype" id="2449940">int</span>&nbsp;<span class="op" id="2449944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2449947">return</span>&nbsp;<span class="builtintype" id="2449954">int</span><span class="op" id="2449957">(</span><span class="ident" id="2449958">t</span><span class="op" id="2449959">.</span><span class="ident" id="2449960">nsec</span><span class="op" id="2449964">)</span><br>
<span class="lineno"></span><span class="op" id="2449966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2449969">//&nbsp;YearDay&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[1,365]&nbsp;for&nbsp;non-leap&nbsp;years,</span><br>
<span class="lineno"></span><span class="comment" id="2450065">//&nbsp;and&nbsp;[1,366]&nbsp;in&nbsp;leap&nbsp;years.</span><br>
<span class="lineno"></span><span class="keyword" id="2450095">func</span>&nbsp;<span class="op" id="2450100">(</span><span class="ident" id="2450101">t</span>&nbsp;<span class="ident" id="2450103">Time</span><span class="op" id="2450107">)</span>&nbsp;<span class="ident" id="2450109">YearDay</span><span class="op" id="2450116">(</span><span class="op" id="2450117">)</span>&nbsp;<span class="builtintype" id="2450119">int</span>&nbsp;<span class="op" id="2450123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450126">_</span><span class="op" id="2450127">,</span>&nbsp;<span class="ident" id="2450129">_</span><span class="op" id="2450130">,</span>&nbsp;<span class="ident" id="2450132">_</span><span class="op" id="2450133">,</span>&nbsp;<span class="ident" id="2450135">yday</span>&nbsp;<span class="op" id="2450140">:=</span>&nbsp;<span class="ident" id="2450143">t</span><span class="op" id="2450144">.</span><span class="ident" id="2450145">date</span><span class="op" id="2450149">(</span><span class="builtintype" id="2450150">false</span><span class="op" id="2450155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2450158">return</span>&nbsp;<span class="ident" id="2450165">yday</span>&nbsp;<span class="op" id="2450170">+</span>&nbsp;<span class="num" id="2450172">1</span><br>
<span class="lineno">425</span><span class="op" id="2450174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2450177">//&nbsp;A&nbsp;Duration&nbsp;represents&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;two&nbsp;instants</span><br>
<span class="lineno"></span><span class="comment" id="2450240">//&nbsp;as&nbsp;an&nbsp;int64&nbsp;nanosecond&nbsp;count.&nbsp;&nbsp;The&nbsp;representation&nbsp;limits&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2450304">//&nbsp;largest&nbsp;representable&nbsp;duration&nbsp;to&nbsp;approximately&nbsp;290&nbsp;years.</span><br>
<span class="lineno">430</span><span class="keyword" id="2450366">type</span>&nbsp;<span class="ident" id="2450371">Duration</span>&nbsp;<span class="ident" id="2450380">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2450387">const</span>&nbsp;<span class="op" id="2450393">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450396">minDuration</span>&nbsp;<span class="ident" id="2450408">Duration</span>&nbsp;<span class="op" id="2450417">=</span>&nbsp;<span class="op" id="2450419">-</span><span class="num" id="2450420">1</span>&nbsp;<span class="op" id="2450422">&lt;&lt;</span>&nbsp;<span class="num" id="2450425">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450429">maxDuration</span>&nbsp;<span class="ident" id="2450441">Duration</span>&nbsp;<span class="op" id="2450450">=</span>&nbsp;<span class="num" id="2450452">1</span><span class="op" id="2450453">&lt;&lt;</span><span class="num" id="2450455">63</span>&nbsp;<span class="op" id="2450458">-</span>&nbsp;<span class="num" id="2450460">1</span><br>
<span class="lineno">435</span><span class="op" id="2450462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2450465">//&nbsp;Common&nbsp;durations.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;definition&nbsp;for&nbsp;units&nbsp;of&nbsp;Day&nbsp;or&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2450537">//&nbsp;to&nbsp;avoid&nbsp;confusion&nbsp;across&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;zone&nbsp;transitions.</span><br>
<span class="lineno"></span><span class="comment" id="2450606">//</span><br>
<span class="lineno">440</span><span class="comment" id="2450609">//&nbsp;To&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;units&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;divide:</span><br>
<span class="lineno"></span><span class="comment" id="2450664">//&nbsp;&nbsp;&nbsp;&nbspsecond&nbsp;:=&nbsp;time.Second</span><br>
<span class="lineno"></span><span class="comment" id="2450689">//&nbsp;&nbsp;&nbsp;&nbspfmt.Print(int64(second/time.Millisecond))&nbsp;//&nbsp;prints&nbsp;1000</span><br>
<span class="lineno"></span><span class="comment" id="2450749">//</span><br>
<span class="lineno"></span><span class="comment" id="2450752">//&nbsp;To&nbsp;convert&nbsp;an&nbsp;integer&nbsp;number&nbsp;of&nbsp;units&nbsp;to&nbsp;a&nbsp;Duration,&nbsp;multiply:</span><br>
<span class="lineno">445</span><span class="comment" id="2450818">//&nbsp;&nbsp;&nbsp;&nbspseconds&nbsp;:=&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2450835">//&nbsp;&nbsp;&nbsp;&nbspfmt.Print(time.Duration(seconds)*time.Second)&nbsp;//&nbsp;prints&nbsp;10s</span><br>
<span class="lineno"></span><span class="comment" id="2450898">//</span><br>
<span class="lineno"></span><span class="keyword" id="2450901">const</span>&nbsp;<span class="op" id="2450907">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450910">Nanosecond</span>&nbsp;&nbsp;<span class="ident" id="2450922">Duration</span>&nbsp;<span class="op" id="2450931">=</span>&nbsp;<span class="num" id="2450933">1</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450936">Microsecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2450957">=</span>&nbsp;<span class="num" id="2450959">1000</span>&nbsp;<span class="op" id="2450964">*</span>&nbsp;<span class="ident" id="2450966">Nanosecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2450978">Millisecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2450999">=</span>&nbsp;<span class="num" id="2451001">1000</span>&nbsp;<span class="op" id="2451006">*</span>&nbsp;<span class="ident" id="2451008">Microsecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451021">Second</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2451042">=</span>&nbsp;<span class="num" id="2451044">1000</span>&nbsp;<span class="op" id="2451049">*</span>&nbsp;<span class="ident" id="2451051">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451064">Minute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2451085">=</span>&nbsp;<span class="num" id="2451087">60</span>&nbsp;<span class="op" id="2451090">*</span>&nbsp;<span class="ident" id="2451092">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451100">Hour</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2451121">=</span>&nbsp;<span class="num" id="2451123">60</span>&nbsp;<span class="op" id="2451126">*</span>&nbsp;<span class="ident" id="2451128">Minute</span><br>
<span class="lineno">455</span><span class="op" id="2451135">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2451138">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;the&nbsp;duration&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;72h3m0.5s&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2451216">//&nbsp;Leading&nbsp;zero&nbsp;units&nbsp;are&nbsp;omitted.&nbsp;&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;durations&nbsp;less&nbsp;than&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2451295">//&nbsp;second&nbsp;format&nbsp;use&nbsp;a&nbsp;smaller&nbsp;unit&nbsp;(milli-,&nbsp;micro-,&nbsp;or&nbsp;nanoseconds)&nbsp;to&nbsp;ensure</span><br>
<span class="lineno">460</span><span class="comment" id="2451374">//&nbsp;that&nbsp;the&nbsp;leading&nbsp;digit&nbsp;is&nbsp;non-zero.&nbsp;&nbsp;The&nbsp;zero&nbsp;duration&nbsp;formats&nbsp;as&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="2451446">//&nbsp;with&nbsp;no&nbsp;unit.</span><br>
<span class="lineno"></span><span class="keyword" id="2451463">func</span>&nbsp;<span class="op" id="2451468">(</span><span class="ident" id="2451469">d</span>&nbsp;<span class="ident" id="2451471">Duration</span><span class="op" id="2451479">)</span>&nbsp;<span class="ident" id="2451481">String</span><span class="op" id="2451487">(</span><span class="op" id="2451488">)</span>&nbsp;<span class="builtintype" id="2451490">string</span>&nbsp;<span class="op" id="2451497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451500">//&nbsp;Largest&nbsp;time&nbsp;is&nbsp;2540400h10m10.000000000s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451545">var</span>&nbsp;<span class="ident" id="2451549">buf</span>&nbsp;<span class="op" id="2451553">[</span><span class="num" id="2451554">32</span><span class="op" id="2451556">]</span><span class="builtintype" id="2451557">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451563">w</span>&nbsp;<span class="op" id="2451565">:=</span>&nbsp;<span class="builtinfunc" id="2451568">len</span><span class="op" id="2451571">(</span><span class="ident" id="2451572">buf</span><span class="op" id="2451575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451579">u</span>&nbsp;<span class="op" id="2451581">:=</span>&nbsp;<span class="ident" id="2451584">uint64</span><span class="op" id="2451590">(</span><span class="ident" id="2451591">d</span><span class="op" id="2451592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451595">neg</span>&nbsp;<span class="op" id="2451599">:=</span>&nbsp;<span class="ident" id="2451602">d</span>&nbsp;<span class="op" id="2451604">&lt;</span>&nbsp;<span class="num" id="2451606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451609">if</span>&nbsp;<span class="ident" id="2451612">neg</span>&nbsp;<span class="op" id="2451616">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451620">u</span>&nbsp;<span class="op" id="2451622">=</span>&nbsp;<span class="op" id="2451624">-</span><span class="ident" id="2451625">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2451628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451632">if</span>&nbsp;<span class="ident" id="2451635">u</span>&nbsp;<span class="op" id="2451637">&lt;</span>&nbsp;<span class="ident" id="2451639">uint64</span><span class="op" id="2451645">(</span><span class="ident" id="2451646">Second</span><span class="op" id="2451652">)</span>&nbsp;<span class="op" id="2451654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451658">//&nbsp;Special&nbsp;case:&nbsp;if&nbsp;duration&nbsp;is&nbsp;smaller&nbsp;than&nbsp;a&nbsp;second,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451715">//&nbsp;use&nbsp;smaller&nbsp;units,&nbsp;like&nbsp;1.2ms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451750">var</span>&nbsp;<span class="ident" id="2451754">prec</span>&nbsp;<span class="builtintype" id="2451759">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451765">w</span><span class="op" id="2451766">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451771">buf</span><span class="op" id="2451774">[</span><span class="ident" id="2451775">w</span><span class="op" id="2451776">]</span>&nbsp;<span class="op" id="2451778">=</span>&nbsp;<span class="string" id="2451780">&#39;s&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451786">w</span><span class="op" id="2451787">--</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451792">switch</span>&nbsp;<span class="op" id="2451799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451803">case</span>&nbsp;<span class="ident" id="2451808">u</span>&nbsp;<span class="op" id="2451810">==</span>&nbsp;<span class="num" id="2451813">0</span><span class="op" id="2451814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451819">return</span>&nbsp;<span class="string" id="2451826">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451832">case</span>&nbsp;<span class="ident" id="2451837">u</span>&nbsp;<span class="op" id="2451839">&lt;</span>&nbsp;<span class="ident" id="2451841">uint64</span><span class="op" id="2451847">(</span><span class="ident" id="2451848">Microsecond</span><span class="op" id="2451859">)</span><span class="op" id="2451860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451865">//&nbsp;print&nbsp;nanoseconds</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451889">prec</span>&nbsp;<span class="op" id="2451894">=</span>&nbsp;<span class="num" id="2451896">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451901">buf</span><span class="op" id="2451904">[</span><span class="ident" id="2451905">w</span><span class="op" id="2451906">]</span>&nbsp;<span class="op" id="2451908">=</span>&nbsp;<span class="string" id="2451910">&#39;n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2451916">case</span>&nbsp;<span class="ident" id="2451921">u</span>&nbsp;<span class="op" id="2451923">&lt;</span>&nbsp;<span class="ident" id="2451925">uint64</span><span class="op" id="2451931">(</span><span class="ident" id="2451932">Millisecond</span><span class="op" id="2451943">)</span><span class="op" id="2451944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451949">//&nbsp;print&nbsp;microseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2451974">prec</span>&nbsp;<span class="op" id="2451979">=</span>&nbsp;<span class="num" id="2451981">3</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2451986">//&nbsp;U+00B5&nbsp;&#39;µ&#39;&nbsp;micro&nbsp;sign&nbsp;==&nbsp;0xC2&nbsp;0xB5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452028">w</span><span class="op" id="2452029">--</span>&nbsp;<span class="comment" id="2452032">//&nbsp;Need&nbsp;room&nbsp;for&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2452063">copy</span><span class="op" id="2452067">(</span><span class="ident" id="2452068">buf</span><span class="op" id="2452071">[</span><span class="ident" id="2452072">w</span><span class="op" id="2452073">:</span><span class="op" id="2452074">]</span><span class="op" id="2452075">,</span>&nbsp;<span class="string" id="2452077">&#34;µ&#34;</span><span class="op" id="2452081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452085">default</span><span class="op" id="2452092">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452097">//&nbsp;print&nbsp;milliseconds</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452122">prec</span>&nbsp;<span class="op" id="2452127">=</span>&nbsp;<span class="num" id="2452129">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452134">buf</span><span class="op" id="2452137">[</span><span class="ident" id="2452138">w</span><span class="op" id="2452139">]</span>&nbsp;<span class="op" id="2452141">=</span>&nbsp;<span class="string" id="2452143">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452153">w</span><span class="op" id="2452154">,</span>&nbsp;<span class="ident" id="2452156">u</span>&nbsp;<span class="op" id="2452158">=</span>&nbsp;<span class="ident" id="2452160">fmtFrac</span><span class="op" id="2452167">(</span><span class="ident" id="2452168">buf</span><span class="op" id="2452171">[</span><span class="op" id="2452172">:</span><span class="ident" id="2452173">w</span><span class="op" id="2452174">]</span><span class="op" id="2452175">,</span>&nbsp;<span class="ident" id="2452177">u</span><span class="op" id="2452178">,</span>&nbsp;<span class="ident" id="2452180">prec</span><span class="op" id="2452184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452188">w</span>&nbsp;<span class="op" id="2452190">=</span>&nbsp;<span class="ident" id="2452192">fmtInt</span><span class="op" id="2452198">(</span><span class="ident" id="2452199">buf</span><span class="op" id="2452202">[</span><span class="op" id="2452203">:</span><span class="ident" id="2452204">w</span><span class="op" id="2452205">]</span><span class="op" id="2452206">,</span>&nbsp;<span class="ident" id="2452208">u</span><span class="op" id="2452209">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452212">}</span>&nbsp;<span class="keyword" id="2452214">else</span>&nbsp;<span class="op" id="2452219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452223">w</span><span class="op" id="2452224">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452229">buf</span><span class="op" id="2452232">[</span><span class="ident" id="2452233">w</span><span class="op" id="2452234">]</span>&nbsp;<span class="op" id="2452236">=</span>&nbsp;<span class="string" id="2452238">&#39;s&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452245">w</span><span class="op" id="2452246">,</span>&nbsp;<span class="ident" id="2452248">u</span>&nbsp;<span class="op" id="2452250">=</span>&nbsp;<span class="ident" id="2452252">fmtFrac</span><span class="op" id="2452259">(</span><span class="ident" id="2452260">buf</span><span class="op" id="2452263">[</span><span class="op" id="2452264">:</span><span class="ident" id="2452265">w</span><span class="op" id="2452266">]</span><span class="op" id="2452267">,</span>&nbsp;<span class="ident" id="2452269">u</span><span class="op" id="2452270">,</span>&nbsp;<span class="num" id="2452272">9</span><span class="op" id="2452273">)</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452278">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452308">w</span>&nbsp;<span class="op" id="2452310">=</span>&nbsp;<span class="ident" id="2452312">fmtInt</span><span class="op" id="2452318">(</span><span class="ident" id="2452319">buf</span><span class="op" id="2452322">[</span><span class="op" id="2452323">:</span><span class="ident" id="2452324">w</span><span class="op" id="2452325">]</span><span class="op" id="2452326">,</span>&nbsp;<span class="ident" id="2452328">u</span><span class="op" id="2452329">%</span><span class="num" id="2452330">60</span><span class="op" id="2452332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452336">u</span>&nbsp;<span class="op" id="2452338">/=</span>&nbsp;<span class="num" id="2452341">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452347">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452377">if</span>&nbsp;<span class="ident" id="2452380">u</span>&nbsp;<span class="op" id="2452382">&gt;</span>&nbsp;<span class="num" id="2452384">0</span>&nbsp;<span class="op" id="2452386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452391">w</span><span class="op" id="2452392">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452398">buf</span><span class="op" id="2452401">[</span><span class="ident" id="2452402">w</span><span class="op" id="2452403">]</span>&nbsp;<span class="op" id="2452405">=</span>&nbsp;<span class="string" id="2452407">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452414">w</span>&nbsp;<span class="op" id="2452416">=</span>&nbsp;<span class="ident" id="2452418">fmtInt</span><span class="op" id="2452424">(</span><span class="ident" id="2452425">buf</span><span class="op" id="2452428">[</span><span class="op" id="2452429">:</span><span class="ident" id="2452430">w</span><span class="op" id="2452431">]</span><span class="op" id="2452432">,</span>&nbsp;<span class="ident" id="2452434">u</span><span class="op" id="2452435">%</span><span class="num" id="2452436">60</span><span class="op" id="2452438">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452443">u</span>&nbsp;<span class="op" id="2452445">/=</span>&nbsp;<span class="num" id="2452448">60</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452455">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;hours</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2452484">//&nbsp;Stop&nbsp;at&nbsp;hours&nbsp;because&nbsp;days&nbsp;can&nbsp;be&nbsp;different&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452543">if</span>&nbsp;<span class="ident" id="2452546">u</span>&nbsp;<span class="op" id="2452548">&gt;</span>&nbsp;<span class="num" id="2452550">0</span>&nbsp;<span class="op" id="2452552">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452558">w</span><span class="op" id="2452559">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452566">buf</span><span class="op" id="2452569">[</span><span class="ident" id="2452570">w</span><span class="op" id="2452571">]</span>&nbsp;<span class="op" id="2452573">=</span>&nbsp;<span class="string" id="2452575">&#39;h&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452583">w</span>&nbsp;<span class="op" id="2452585">=</span>&nbsp;<span class="ident" id="2452587">fmtInt</span><span class="op" id="2452593">(</span><span class="ident" id="2452594">buf</span><span class="op" id="2452597">[</span><span class="op" id="2452598">:</span><span class="ident" id="2452599">w</span><span class="op" id="2452600">]</span><span class="op" id="2452601">,</span>&nbsp;<span class="ident" id="2452603">u</span><span class="op" id="2452604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452613">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452620">if</span>&nbsp;<span class="ident" id="2452623">neg</span>&nbsp;<span class="op" id="2452627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452631">w</span><span class="op" id="2452632">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2452637">buf</span><span class="op" id="2452640">[</span><span class="ident" id="2452641">w</span><span class="op" id="2452642">]</span>&nbsp;<span class="op" id="2452644">=</span>&nbsp;<span class="string" id="2452646">&#39;-&#39;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2452651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2452655">return</span>&nbsp;<span class="builtintype" id="2452662">string</span><span class="op" id="2452668">(</span><span class="ident" id="2452669">buf</span><span class="op" id="2452672">[</span><span class="ident" id="2452673">w</span><span class="op" id="2452674">:</span><span class="op" id="2452675">]</span><span class="op" id="2452676">)</span><br>
<span class="lineno"></span><span class="op" id="2452678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="2452681">//&nbsp;fmtFrac&nbsp;formats&nbsp;the&nbsp;fraction&nbsp;of&nbsp;v/10**prec&nbsp;(e.g.,&nbsp;&#34;.12345&#34;)&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2452753">//&nbsp;tail&nbsp;of&nbsp;buf,&nbsp;omitting&nbsp;trailing&nbsp;zeros.&nbsp;&nbsp;it&nbsp;omits&nbsp;the&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2452816">//&nbsp;point&nbsp;too&nbsp;when&nbsp;the&nbsp;fraction&nbsp;is&nbsp;0.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2452885">//&nbsp;output&nbsp;bytes&nbsp;begin&nbsp;and&nbsp;the&nbsp;value&nbsp;v/10**prec.</span><br>
<span class="lineno"></span><span class="keyword" id="2452933">func</span>&nbsp;<span class="ident" id="2452938">fmtFrac</span><span class="op" id="2452945">(</span><span class="ident" id="2452946">buf</span>&nbsp;<span class="op" id="2452950">[</span><span class="op" id="2452951">]</span><span class="builtintype" id="2452952">byte</span><span class="op" id="2452956">,</span>&nbsp;<span class="ident" id="2452958">v</span>&nbsp;<span class="ident" id="2452960">uint64</span><span class="op" id="2452966">,</span>&nbsp;<span class="ident" id="2452968">prec</span>&nbsp;<span class="builtintype" id="2452973">int</span><span class="op" id="2452976">)</span>&nbsp;<span class="op" id="2452978">(</span><span class="ident" id="2452979">nw</span>&nbsp;<span class="builtintype" id="2452982">int</span><span class="op" id="2452985">,</span>&nbsp;<span class="ident" id="2452987">nv</span>&nbsp;<span class="ident" id="2452990">uint64</span><span class="op" id="2452996">)</span>&nbsp;<span class="op" id="2452998">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2453001">//&nbsp;Omit&nbsp;trailing&nbsp;zeros&nbsp;up&nbsp;to&nbsp;and&nbsp;including&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453060">w</span>&nbsp;<span class="op" id="2453062">:=</span>&nbsp;<span class="builtinfunc" id="2453065">len</span><span class="op" id="2453068">(</span><span class="ident" id="2453069">buf</span><span class="op" id="2453072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2453075">print</span>&nbsp;<span class="op" id="2453081">:=</span>&nbsp;<span class="builtintype" id="2453084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453091">for</span>&nbsp;<span class="ident" id="2453095">i</span>&nbsp;<span class="op" id="2453097">:=</span>&nbsp;<span class="num" id="2453100">0</span><span class="op" id="2453101">;</span>&nbsp;<span class="ident" id="2453103">i</span>&nbsp;<span class="op" id="2453105">&lt;</span>&nbsp;<span class="ident" id="2453107">prec</span><span class="op" id="2453111">;</span>&nbsp;<span class="ident" id="2453113">i</span><span class="op" id="2453114">++</span>&nbsp;<span class="op" id="2453117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453121">digit</span>&nbsp;<span class="op" id="2453127">:=</span>&nbsp;<span class="ident" id="2453130">v</span>&nbsp;<span class="op" id="2453132">%</span>&nbsp;<span class="num" id="2453134">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2453139">print</span>&nbsp;<span class="op" id="2453145">=</span>&nbsp;<span class="builtinfunc" id="2453147">print</span>&nbsp;<span class="op" id="2453153">||</span>&nbsp;<span class="ident" id="2453156">digit</span>&nbsp;<span class="op" id="2453162">!=</span>&nbsp;<span class="num" id="2453165">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453169">if</span>&nbsp;<span class="builtinfunc" id="2453172">print</span>&nbsp;<span class="op" id="2453178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453183">w</span><span class="op" id="2453184">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453190">buf</span><span class="op" id="2453193">[</span><span class="ident" id="2453194">w</span><span class="op" id="2453195">]</span>&nbsp;<span class="op" id="2453197">=</span>&nbsp;<span class="builtintype" id="2453199">byte</span><span class="op" id="2453203">(</span><span class="ident" id="2453204">digit</span><span class="op" id="2453209">)</span>&nbsp;<span class="op" id="2453211">+</span>&nbsp;<span class="string" id="2453213">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453219">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453223">v</span>&nbsp;<span class="op" id="2453225">/=</span>&nbsp;<span class="num" id="2453228">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453235">if</span>&nbsp;<span class="builtinfunc" id="2453238">print</span>&nbsp;<span class="op" id="2453244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453248">w</span><span class="op" id="2453249">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453254">buf</span><span class="op" id="2453257">[</span><span class="ident" id="2453258">w</span><span class="op" id="2453259">]</span>&nbsp;<span class="op" id="2453261">=</span>&nbsp;<span class="string" id="2453263">&#39;.&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453271">return</span>&nbsp;<span class="ident" id="2453278">w</span><span class="op" id="2453279">,</span>&nbsp;<span class="ident" id="2453281">v</span><br>
<span class="lineno"></span><span class="op" id="2453283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2453286">//&nbsp;fmtInt&nbsp;formats&nbsp;v&nbsp;into&nbsp;the&nbsp;tail&nbsp;of&nbsp;buf.</span><br>
<span class="lineno">560</span><span class="comment" id="2453328">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the&nbsp;output&nbsp;begins.</span><br>
<span class="lineno"></span><span class="keyword" id="2453377">func</span>&nbsp;<span class="ident" id="2453382">fmtInt</span><span class="op" id="2453388">(</span><span class="ident" id="2453389">buf</span>&nbsp;<span class="op" id="2453393">[</span><span class="op" id="2453394">]</span><span class="builtintype" id="2453395">byte</span><span class="op" id="2453399">,</span>&nbsp;<span class="ident" id="2453401">v</span>&nbsp;<span class="ident" id="2453403">uint64</span><span class="op" id="2453409">)</span>&nbsp;<span class="builtintype" id="2453411">int</span>&nbsp;<span class="op" id="2453415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453418">w</span>&nbsp;<span class="op" id="2453420">:=</span>&nbsp;<span class="builtinfunc" id="2453423">len</span><span class="op" id="2453426">(</span><span class="ident" id="2453427">buf</span><span class="op" id="2453430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453433">if</span>&nbsp;<span class="ident" id="2453436">v</span>&nbsp;<span class="op" id="2453438">==</span>&nbsp;<span class="num" id="2453441">0</span>&nbsp;<span class="op" id="2453443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453447">w</span><span class="op" id="2453448">--</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453453">buf</span><span class="op" id="2453456">[</span><span class="ident" id="2453457">w</span><span class="op" id="2453458">]</span>&nbsp;<span class="op" id="2453460">=</span>&nbsp;<span class="string" id="2453462">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453467">}</span>&nbsp;<span class="keyword" id="2453469">else</span>&nbsp;<span class="op" id="2453474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453478">for</span>&nbsp;<span class="ident" id="2453482">v</span>&nbsp;<span class="op" id="2453484">&gt;</span>&nbsp;<span class="num" id="2453486">0</span>&nbsp;<span class="op" id="2453488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453493">w</span><span class="op" id="2453494">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453500">buf</span><span class="op" id="2453503">[</span><span class="ident" id="2453504">w</span><span class="op" id="2453505">]</span>&nbsp;<span class="op" id="2453507">=</span>&nbsp;<span class="builtintype" id="2453509">byte</span><span class="op" id="2453513">(</span><span class="ident" id="2453514">v</span><span class="op" id="2453515">%</span><span class="num" id="2453516">10</span><span class="op" id="2453518">)</span>&nbsp;<span class="op" id="2453520">+</span>&nbsp;<span class="string" id="2453522">&#39;0&#39;</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2453529">v</span>&nbsp;<span class="op" id="2453531">/=</span>&nbsp;<span class="num" id="2453534">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2453542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2453545">return</span>&nbsp;<span class="ident" id="2453552">w</span><br>
<span class="lineno"></span><span class="op" id="2453554">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="2453557">//&nbsp;Nanoseconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;an&nbsp;integer&nbsp;nanosecond&nbsp;count.</span><br>
<span class="lineno"></span><span class="keyword" id="2453625">func</span>&nbsp;<span class="op" id="2453630">(</span><span class="ident" id="2453631">d</span>&nbsp;<span class="ident" id="2453633">Duration</span><span class="op" id="2453641">)</span>&nbsp;<span class="ident" id="2453643">Nanoseconds</span><span class="op" id="2453654">(</span><span class="op" id="2453655">)</span>&nbsp;<span class="ident" id="2453657">int64</span>&nbsp;<span class="op" id="2453663">{</span>&nbsp;<span class="keyword" id="2453665">return</span>&nbsp;<span class="ident" id="2453672">int64</span><span class="op" id="2453677">(</span><span class="ident" id="2453678">d</span><span class="op" id="2453679">)</span>&nbsp;<span class="op" id="2453681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2453684">//&nbsp;These&nbsp;methods&nbsp;return&nbsp;float64&nbsp;because&nbsp;the&nbsp;dominant</span><br>
<span class="lineno">580</span><span class="comment" id="2453737">//&nbsp;use&nbsp;case&nbsp;is&nbsp;for&nbsp;printing&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;like&nbsp;1.5s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2453804">//&nbsp;a&nbsp;truncation&nbsp;to&nbsp;integer&nbsp;would&nbsp;make&nbsp;them&nbsp;not&nbsp;useful&nbsp;in&nbsp;those&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="2453874">//&nbsp;Splitting&nbsp;the&nbsp;integer&nbsp;and&nbsp;fraction&nbsp;ourselves&nbsp;guarantees&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2453938">//&nbsp;converting&nbsp;the&nbsp;returned&nbsp;float64&nbsp;to&nbsp;an&nbsp;integer&nbsp;rounds&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2454003">//&nbsp;way&nbsp;that&nbsp;a&nbsp;pure&nbsp;integer&nbsp;conversion&nbsp;would&nbsp;have,&nbsp;even&nbsp;in&nbsp;cases</span><br>
<span class="lineno">585</span><span class="comment" id="2454067">//&nbsp;where,&nbsp;say,&nbsp;float64(d.Nanoseconds())/1e9&nbsp;would&nbsp;have&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2454130">//&nbsp;differently.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454147">//&nbsp;Seconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;seconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2454218">func</span>&nbsp;<span class="op" id="2454223">(</span><span class="ident" id="2454224">d</span>&nbsp;<span class="ident" id="2454226">Duration</span><span class="op" id="2454234">)</span>&nbsp;<span class="ident" id="2454236">Seconds</span><span class="op" id="2454243">(</span><span class="op" id="2454244">)</span>&nbsp;<span class="builtintype" id="2454246">float64</span>&nbsp;<span class="op" id="2454254">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454257">sec</span>&nbsp;<span class="op" id="2454261">:=</span>&nbsp;<span class="ident" id="2454264">d</span>&nbsp;<span class="op" id="2454266">/</span>&nbsp;<span class="ident" id="2454268">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454276">nsec</span>&nbsp;<span class="op" id="2454281">:=</span>&nbsp;<span class="ident" id="2454284">d</span>&nbsp;<span class="op" id="2454286">%</span>&nbsp;<span class="ident" id="2454288">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454296">return</span>&nbsp;<span class="builtintype" id="2454303">float64</span><span class="op" id="2454310">(</span><span class="ident" id="2454311">sec</span><span class="op" id="2454314">)</span>&nbsp;<span class="op" id="2454316">+</span>&nbsp;<span class="builtintype" id="2454318">float64</span><span class="op" id="2454325">(</span><span class="ident" id="2454326">nsec</span><span class="op" id="2454330">)</span><span class="op" id="2454331">*</span><span class="num" id="2454332">1e-9</span><br>
<span class="lineno"></span><span class="op" id="2454337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2454340">//&nbsp;Minutes&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;minutes.</span><br>
<span class="lineno"></span><span class="keyword" id="2454411">func</span>&nbsp;<span class="op" id="2454416">(</span><span class="ident" id="2454417">d</span>&nbsp;<span class="ident" id="2454419">Duration</span><span class="op" id="2454427">)</span>&nbsp;<span class="ident" id="2454429">Minutes</span><span class="op" id="2454436">(</span><span class="op" id="2454437">)</span>&nbsp;<span class="builtintype" id="2454439">float64</span>&nbsp;<span class="op" id="2454447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454450">min</span>&nbsp;<span class="op" id="2454454">:=</span>&nbsp;<span class="ident" id="2454457">d</span>&nbsp;<span class="op" id="2454459">/</span>&nbsp;<span class="ident" id="2454461">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454469">nsec</span>&nbsp;<span class="op" id="2454474">:=</span>&nbsp;<span class="ident" id="2454477">d</span>&nbsp;<span class="op" id="2454479">%</span>&nbsp;<span class="ident" id="2454481">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454489">return</span>&nbsp;<span class="builtintype" id="2454496">float64</span><span class="op" id="2454503">(</span><span class="ident" id="2454504">min</span><span class="op" id="2454507">)</span>&nbsp;<span class="op" id="2454509">+</span>&nbsp;<span class="builtintype" id="2454511">float64</span><span class="op" id="2454518">(</span><span class="ident" id="2454519">nsec</span><span class="op" id="2454523">)</span><span class="op" id="2454524">*</span><span class="op" id="2454525">(</span><span class="num" id="2454526">1e-9</span><span class="op" id="2454530">/</span><span class="num" id="2454531">60</span><span class="op" id="2454533">)</span><br>
<span class="lineno">600</span><span class="op" id="2454535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454538">//&nbsp;Hours&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;hours.</span><br>
<span class="lineno"></span><span class="keyword" id="2454605">func</span>&nbsp;<span class="op" id="2454610">(</span><span class="ident" id="2454611">d</span>&nbsp;<span class="ident" id="2454613">Duration</span><span class="op" id="2454621">)</span>&nbsp;<span class="ident" id="2454623">Hours</span><span class="op" id="2454628">(</span><span class="op" id="2454629">)</span>&nbsp;<span class="builtintype" id="2454631">float64</span>&nbsp;<span class="op" id="2454639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454642">hour</span>&nbsp;<span class="op" id="2454647">:=</span>&nbsp;<span class="ident" id="2454650">d</span>&nbsp;<span class="op" id="2454652">/</span>&nbsp;<span class="ident" id="2454654">Hour</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454660">nsec</span>&nbsp;<span class="op" id="2454665">:=</span>&nbsp;<span class="ident" id="2454668">d</span>&nbsp;<span class="op" id="2454670">%</span>&nbsp;<span class="ident" id="2454672">Hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454678">return</span>&nbsp;<span class="builtintype" id="2454685">float64</span><span class="op" id="2454692">(</span><span class="ident" id="2454693">hour</span><span class="op" id="2454697">)</span>&nbsp;<span class="op" id="2454699">+</span>&nbsp;<span class="builtintype" id="2454701">float64</span><span class="op" id="2454708">(</span><span class="ident" id="2454709">nsec</span><span class="op" id="2454713">)</span><span class="op" id="2454714">*</span><span class="op" id="2454715">(</span><span class="num" id="2454716">1e-9</span><span class="op" id="2454720">/</span><span class="num" id="2454721">60</span><span class="op" id="2454723">/</span><span class="num" id="2454724">60</span><span class="op" id="2454726">)</span><br>
<span class="lineno"></span><span class="op" id="2454728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454731">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;time&nbsp;t+d.</span><br>
<span class="lineno">610</span><span class="keyword" id="2454760">func</span>&nbsp;<span class="op" id="2454765">(</span><span class="ident" id="2454766">t</span>&nbsp;<span class="ident" id="2454768">Time</span><span class="op" id="2454772">)</span>&nbsp;<span class="ident" id="2454774">Add</span><span class="op" id="2454777">(</span><span class="ident" id="2454778">d</span>&nbsp;<span class="ident" id="2454780">Duration</span><span class="op" id="2454788">)</span>&nbsp;<span class="ident" id="2454790">Time</span>&nbsp;<span class="op" id="2454795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454798">t</span><span class="op" id="2454799">.</span><span class="ident" id="2454800">sec</span>&nbsp;<span class="op" id="2454804">+=</span>&nbsp;<span class="ident" id="2454807">int64</span><span class="op" id="2454812">(</span><span class="ident" id="2454813">d</span>&nbsp;<span class="op" id="2454815">/</span>&nbsp;<span class="num" id="2454817">1e9</span><span class="op" id="2454820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454823">nsec</span>&nbsp;<span class="op" id="2454828">:=</span>&nbsp;<span class="builtintype" id="2454831">int32</span><span class="op" id="2454836">(</span><span class="ident" id="2454837">t</span><span class="op" id="2454838">.</span><span class="ident" id="2454839">nsec</span><span class="op" id="2454843">)</span>&nbsp;<span class="op" id="2454845">+</span>&nbsp;<span class="builtintype" id="2454847">int32</span><span class="op" id="2454852">(</span><span class="ident" id="2454853">d</span><span class="op" id="2454854">%</span><span class="num" id="2454855">1e9</span><span class="op" id="2454858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454861">if</span>&nbsp;<span class="ident" id="2454864">nsec</span>&nbsp;<span class="op" id="2454869">&gt;=</span>&nbsp;<span class="num" id="2454872">1e9</span>&nbsp;<span class="op" id="2454876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454880">t</span><span class="op" id="2454881">.</span><span class="ident" id="2454882">sec</span><span class="op" id="2454885">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454890">nsec</span>&nbsp;<span class="op" id="2454895">-=</span>&nbsp;<span class="num" id="2454898">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454903">}</span>&nbsp;<span class="keyword" id="2454905">else</span>&nbsp;<span class="keyword" id="2454910">if</span>&nbsp;<span class="ident" id="2454913">nsec</span>&nbsp;<span class="op" id="2454918">&lt;</span>&nbsp;<span class="num" id="2454920">0</span>&nbsp;<span class="op" id="2454922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454926">t</span><span class="op" id="2454927">.</span><span class="ident" id="2454928">sec</span><span class="op" id="2454931">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454936">nsec</span>&nbsp;<span class="op" id="2454941">+=</span>&nbsp;<span class="num" id="2454944">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2454949">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2454952">t</span><span class="op" id="2454953">.</span><span class="ident" id="2454954">nsec</span>&nbsp;<span class="op" id="2454959">=</span>&nbsp;<span class="ident" id="2454961">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2454967">return</span>&nbsp;<span class="ident" id="2454974">t</span><br>
<span class="lineno"></span><span class="op" id="2454976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2454979">//&nbsp;Sub&nbsp;returns&nbsp;the&nbsp;duration&nbsp;t-u.&nbsp;If&nbsp;the&nbsp;result&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)</span><br>
<span class="lineno">625</span><span class="comment" id="2455059">//&nbsp;value&nbsp;that&nbsp;can&nbsp;be&nbsp;stored&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)&nbsp;duration</span><br>
<span class="lineno"></span><span class="comment" id="2455136">//&nbsp;will&nbsp;be&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="2455157">//&nbsp;To&nbsp;compute&nbsp;t-d&nbsp;for&nbsp;a&nbsp;duration&nbsp;d,&nbsp;use&nbsp;t.Add(-d).</span><br>
<span class="lineno"></span><span class="keyword" id="2455208">func</span>&nbsp;<span class="op" id="2455213">(</span><span class="ident" id="2455214">t</span>&nbsp;<span class="ident" id="2455216">Time</span><span class="op" id="2455220">)</span>&nbsp;<span class="ident" id="2455222">Sub</span><span class="op" id="2455225">(</span><span class="ident" id="2455226">u</span>&nbsp;<span class="ident" id="2455228">Time</span><span class="op" id="2455232">)</span>&nbsp;<span class="ident" id="2455234">Duration</span>&nbsp;<span class="op" id="2455243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2455246">d</span>&nbsp;<span class="op" id="2455248">:=</span>&nbsp;<span class="ident" id="2455251">Duration</span><span class="op" id="2455259">(</span><span class="ident" id="2455260">t</span><span class="op" id="2455261">.</span><span class="ident" id="2455262">sec</span><span class="op" id="2455265">-</span><span class="ident" id="2455266">u</span><span class="op" id="2455267">.</span><span class="ident" id="2455268">sec</span><span class="op" id="2455271">)</span><span class="op" id="2455272">*</span><span class="ident" id="2455273">Second</span>&nbsp;<span class="op" id="2455280">+</span>&nbsp;<span class="ident" id="2455282">Duration</span><span class="op" id="2455290">(</span><span class="builtintype" id="2455291">int32</span><span class="op" id="2455296">(</span><span class="ident" id="2455297">t</span><span class="op" id="2455298">.</span><span class="ident" id="2455299">nsec</span><span class="op" id="2455303">)</span><span class="op" id="2455304">-</span><span class="builtintype" id="2455305">int32</span><span class="op" id="2455310">(</span><span class="ident" id="2455311">u</span><span class="op" id="2455312">.</span><span class="ident" id="2455313">nsec</span><span class="op" id="2455317">)</span><span class="op" id="2455318">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2455321">//&nbsp;Check&nbsp;for&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455358">switch</span>&nbsp;<span class="op" id="2455365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455368">case</span>&nbsp;<span class="ident" id="2455373">u</span><span class="op" id="2455374">.</span><span class="ident" id="2455375">Add</span><span class="op" id="2455378">(</span><span class="ident" id="2455379">d</span><span class="op" id="2455380">)</span><span class="op" id="2455381">.</span><span class="ident" id="2455382">Equal</span><span class="op" id="2455387">(</span><span class="ident" id="2455388">t</span><span class="op" id="2455389">)</span><span class="op" id="2455390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455394">return</span>&nbsp;<span class="ident" id="2455401">d</span>&nbsp;<span class="comment" id="2455403">//&nbsp;d&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455420">case</span>&nbsp;<span class="ident" id="2455425">t</span><span class="op" id="2455426">.</span><span class="ident" id="2455427">Before</span><span class="op" id="2455433">(</span><span class="ident" id="2455434">u</span><span class="op" id="2455435">)</span><span class="op" id="2455436">:</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455440">return</span>&nbsp;<span class="ident" id="2455447">minDuration</span>&nbsp;<span class="comment" id="2455459">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;negative&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455494">default</span><span class="op" id="2455501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455505">return</span>&nbsp;<span class="ident" id="2455512">maxDuration</span>&nbsp;<span class="comment" id="2455524">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;positive&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2455559">}</span><br>
<span class="lineno"></span><span class="op" id="2455561">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2455564">//&nbsp;Since&nbsp;returns&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;since&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2455607">//&nbsp;It&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;time.Now().Sub(t).</span><br>
<span class="lineno"></span><span class="keyword" id="2455649">func</span>&nbsp;<span class="ident" id="2455654">Since</span><span class="op" id="2455659">(</span><span class="ident" id="2455660">t</span>&nbsp;<span class="ident" id="2455662">Time</span><span class="op" id="2455666">)</span>&nbsp;<span class="ident" id="2455668">Duration</span>&nbsp;<span class="op" id="2455677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2455680">return</span>&nbsp;<span class="ident" id="2455687">Now</span><span class="op" id="2455690">(</span><span class="op" id="2455691">)</span><span class="op" id="2455692">.</span><span class="ident" id="2455693">Sub</span><span class="op" id="2455696">(</span><span class="ident" id="2455697">t</span><span class="op" id="2455698">)</span><br>
<span class="lineno">645</span><span class="op" id="2455700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2455703">//&nbsp;AddDate&nbsp;returns&nbsp;the&nbsp;time&nbsp;corresponding&nbsp;to&nbsp;adding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2455759">//&nbsp;given&nbsp;number&nbsp;of&nbsp;years,&nbsp;months,&nbsp;and&nbsp;days&nbsp;to&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2455808">//&nbsp;For&nbsp;example,&nbsp;AddDate(-1,&nbsp;2,&nbsp;3)&nbsp;applied&nbsp;to&nbsp;January&nbsp;1,&nbsp;2011</span><br>
<span class="lineno">650</span><span class="comment" id="2455869">//&nbsp;returns&nbsp;March&nbsp;4,&nbsp;2010.</span><br>
<span class="lineno"></span><span class="comment" id="2455895">//</span><br>
<span class="lineno"></span><span class="comment" id="2455898">//&nbsp;AddDate&nbsp;normalizes&nbsp;its&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;Date&nbsp;does,</span><br>
<span class="lineno"></span><span class="comment" id="2455963">//&nbsp;so,&nbsp;for&nbsp;example,&nbsp;adding&nbsp;one&nbsp;month&nbsp;to&nbsp;October&nbsp;31&nbsp;yields</span><br>
<span class="lineno"></span><span class="comment" id="2456021">//&nbsp;December&nbsp;1,&nbsp;the&nbsp;normalized&nbsp;form&nbsp;for&nbsp;November&nbsp;31.</span><br>
<span class="lineno">655</span><span class="keyword" id="2456073">func</span>&nbsp;<span class="op" id="2456078">(</span><span class="ident" id="2456079">t</span>&nbsp;<span class="ident" id="2456081">Time</span><span class="op" id="2456085">)</span>&nbsp;<span class="ident" id="2456087">AddDate</span><span class="op" id="2456094">(</span><span class="ident" id="2456095">years</span>&nbsp;<span class="builtintype" id="2456101">int</span><span class="op" id="2456104">,</span>&nbsp;<span class="ident" id="2456106">months</span>&nbsp;<span class="builtintype" id="2456113">int</span><span class="op" id="2456116">,</span>&nbsp;<span class="ident" id="2456118">days</span>&nbsp;<span class="builtintype" id="2456123">int</span><span class="op" id="2456126">)</span>&nbsp;<span class="ident" id="2456128">Time</span>&nbsp;<span class="op" id="2456133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456136">year</span><span class="op" id="2456140">,</span>&nbsp;<span class="ident" id="2456142">month</span><span class="op" id="2456147">,</span>&nbsp;<span class="ident" id="2456149">day</span>&nbsp;<span class="op" id="2456153">:=</span>&nbsp;<span class="ident" id="2456156">t</span><span class="op" id="2456157">.</span><span class="ident" id="2456158">Date</span><span class="op" id="2456162">(</span><span class="op" id="2456163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456166">hour</span><span class="op" id="2456170">,</span>&nbsp;<span class="ident" id="2456172">min</span><span class="op" id="2456175">,</span>&nbsp;<span class="ident" id="2456177">sec</span>&nbsp;<span class="op" id="2456181">:=</span>&nbsp;<span class="ident" id="2456184">t</span><span class="op" id="2456185">.</span><span class="ident" id="2456186">Clock</span><span class="op" id="2456191">(</span><span class="op" id="2456192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456195">return</span>&nbsp;<span class="ident" id="2456202">Date</span><span class="op" id="2456206">(</span><span class="ident" id="2456207">year</span><span class="op" id="2456211">+</span><span class="ident" id="2456212">years</span><span class="op" id="2456217">,</span>&nbsp;<span class="ident" id="2456219">month</span><span class="op" id="2456224">+</span><span class="ident" id="2456225">Month</span><span class="op" id="2456230">(</span><span class="ident" id="2456231">months</span><span class="op" id="2456237">)</span><span class="op" id="2456238">,</span>&nbsp;<span class="ident" id="2456240">day</span><span class="op" id="2456243">+</span><span class="ident" id="2456244">days</span><span class="op" id="2456248">,</span>&nbsp;<span class="ident" id="2456250">hour</span><span class="op" id="2456254">,</span>&nbsp;<span class="ident" id="2456256">min</span><span class="op" id="2456259">,</span>&nbsp;<span class="ident" id="2456261">sec</span><span class="op" id="2456264">,</span>&nbsp;<span class="builtintype" id="2456266">int</span><span class="op" id="2456269">(</span><span class="ident" id="2456270">t</span><span class="op" id="2456271">.</span><span class="ident" id="2456272">nsec</span><span class="op" id="2456276">)</span><span class="op" id="2456277">,</span>&nbsp;<span class="ident" id="2456279">t</span><span class="op" id="2456280">.</span><span class="ident" id="2456281">loc</span><span class="op" id="2456284">)</span><br>
<span class="lineno"></span><span class="op" id="2456286">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="keyword" id="2456289">const</span>&nbsp;<span class="op" id="2456295">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456298">secondsPerMinute</span>&nbsp;<span class="op" id="2456315">=</span>&nbsp;<span class="num" id="2456317">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456321">secondsPerHour</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2456338">=</span>&nbsp;<span class="num" id="2456340">60</span>&nbsp;<span class="op" id="2456343">*</span>&nbsp;<span class="num" id="2456345">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456349">secondsPerDay</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456366">=</span>&nbsp;<span class="num" id="2456368">24</span>&nbsp;<span class="op" id="2456371">*</span>&nbsp;<span class="ident" id="2456373">secondsPerHour</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456389">secondsPerWeek</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2456406">=</span>&nbsp;<span class="num" id="2456408">7</span>&nbsp;<span class="op" id="2456410">*</span>&nbsp;<span class="ident" id="2456412">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456427">daysPer400Years</span>&nbsp;&nbsp;<span class="op" id="2456444">=</span>&nbsp;<span class="num" id="2456446">365</span><span class="op" id="2456449">*</span><span class="num" id="2456450">400</span>&nbsp;<span class="op" id="2456454">+</span>&nbsp;<span class="num" id="2456456">97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456460">daysPer100Years</span>&nbsp;&nbsp;<span class="op" id="2456477">=</span>&nbsp;<span class="num" id="2456479">365</span><span class="op" id="2456482">*</span><span class="num" id="2456483">100</span>&nbsp;<span class="op" id="2456487">+</span>&nbsp;<span class="num" id="2456489">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456493">daysPer4Years</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2456510">=</span>&nbsp;<span class="num" id="2456512">365</span><span class="op" id="2456515">*</span><span class="num" id="2456516">4</span>&nbsp;<span class="op" id="2456518">+</span>&nbsp;<span class="num" id="2456520">1</span><br>
<span class="lineno"></span><span class="op" id="2456522">)</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="2456525">//&nbsp;date&nbsp;computes&nbsp;the&nbsp;year,&nbsp;day&nbsp;of&nbsp;year,&nbsp;and&nbsp;when&nbsp;full=true,</span><br>
<span class="lineno"></span><span class="comment" id="2456585">//&nbsp;the&nbsp;month&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2456625">func</span>&nbsp;<span class="op" id="2456630">(</span><span class="ident" id="2456631">t</span>&nbsp;<span class="ident" id="2456633">Time</span><span class="op" id="2456637">)</span>&nbsp;<span class="ident" id="2456639">date</span><span class="op" id="2456643">(</span><span class="ident" id="2456644">full</span>&nbsp;<span class="builtintype" id="2456649">bool</span><span class="op" id="2456653">)</span>&nbsp;<span class="op" id="2456655">(</span><span class="ident" id="2456656">year</span>&nbsp;<span class="builtintype" id="2456661">int</span><span class="op" id="2456664">,</span>&nbsp;<span class="ident" id="2456666">month</span>&nbsp;<span class="ident" id="2456672">Month</span><span class="op" id="2456677">,</span>&nbsp;<span class="ident" id="2456679">day</span>&nbsp;<span class="builtintype" id="2456683">int</span><span class="op" id="2456686">,</span>&nbsp;<span class="ident" id="2456688">yday</span>&nbsp;<span class="builtintype" id="2456693">int</span><span class="op" id="2456696">)</span>&nbsp;<span class="op" id="2456698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2456701">return</span>&nbsp;<span class="ident" id="2456708">absDate</span><span class="op" id="2456715">(</span><span class="ident" id="2456716">t</span><span class="op" id="2456717">.</span><span class="ident" id="2456718">abs</span><span class="op" id="2456721">(</span><span class="op" id="2456722">)</span><span class="op" id="2456723">,</span>&nbsp;<span class="ident" id="2456725">full</span><span class="op" id="2456729">)</span><br>
<span class="lineno">675</span><span class="op" id="2456731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2456734">//&nbsp;absDate&nbsp;is&nbsp;like&nbsp;date&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2456792">func</span>&nbsp;<span class="ident" id="2456797">absDate</span><span class="op" id="2456804">(</span><span class="ident" id="2456805">abs</span>&nbsp;<span class="ident" id="2456809">uint64</span><span class="op" id="2456815">,</span>&nbsp;<span class="ident" id="2456817">full</span>&nbsp;<span class="builtintype" id="2456822">bool</span><span class="op" id="2456826">)</span>&nbsp;<span class="op" id="2456828">(</span><span class="ident" id="2456829">year</span>&nbsp;<span class="builtintype" id="2456834">int</span><span class="op" id="2456837">,</span>&nbsp;<span class="ident" id="2456839">month</span>&nbsp;<span class="ident" id="2456845">Month</span><span class="op" id="2456850">,</span>&nbsp;<span class="ident" id="2456852">day</span>&nbsp;<span class="builtintype" id="2456856">int</span><span class="op" id="2456859">,</span>&nbsp;<span class="ident" id="2456861">yday</span>&nbsp;<span class="builtintype" id="2456866">int</span><span class="op" id="2456869">)</span>&nbsp;<span class="op" id="2456871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2456874">//&nbsp;Split&nbsp;into&nbsp;time&nbsp;and&nbsp;day.</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456903">d</span>&nbsp;<span class="op" id="2456905">:=</span>&nbsp;<span class="ident" id="2456908">abs</span>&nbsp;<span class="op" id="2456912">/</span>&nbsp;<span class="ident" id="2456914">secondsPerDay</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2456930">//&nbsp;Account&nbsp;for&nbsp;400&nbsp;year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456963">n</span>&nbsp;<span class="op" id="2456965">:=</span>&nbsp;<span class="ident" id="2456968">d</span>&nbsp;<span class="op" id="2456970">/</span>&nbsp;<span class="ident" id="2456972">daysPer400Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2456989">y</span>&nbsp;<span class="op" id="2456991">:=</span>&nbsp;<span class="num" id="2456994">400</span>&nbsp;<span class="op" id="2456998">*</span>&nbsp;<span class="ident" id="2457000">n</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457003">d</span>&nbsp;<span class="op" id="2457005">-=</span>&nbsp;<span class="ident" id="2457008">daysPer400Years</span>&nbsp;<span class="op" id="2457024">*</span>&nbsp;<span class="ident" id="2457026">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457030">//&nbsp;Cut&nbsp;off&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457059">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;one&nbsp;extra&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457122">//&nbsp;of&nbsp;that&nbsp;year,&nbsp;day&nbsp;/&nbsp;daysPer100Years&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457186">//&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457233">n</span>&nbsp;<span class="op" id="2457235">=</span>&nbsp;<span class="ident" id="2457237">d</span>&nbsp;<span class="op" id="2457239">/</span>&nbsp;<span class="ident" id="2457241">daysPer100Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457258">n</span>&nbsp;<span class="op" id="2457260">-=</span>&nbsp;<span class="ident" id="2457263">n</span>&nbsp;<span class="op" id="2457265">&gt;&gt;</span>&nbsp;<span class="num" id="2457268">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457271">y</span>&nbsp;<span class="op" id="2457273">+=</span>&nbsp;<span class="num" id="2457276">100</span>&nbsp;<span class="op" id="2457280">*</span>&nbsp;<span class="ident" id="2457282">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457285">d</span>&nbsp;<span class="op" id="2457287">-=</span>&nbsp;<span class="ident" id="2457290">daysPer100Years</span>&nbsp;<span class="op" id="2457306">*</span>&nbsp;<span class="ident" id="2457308">n</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457312">//&nbsp;Cut&nbsp;off&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457339">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;a&nbsp;missing&nbsp;leap&nbsp;year,&nbsp;which&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457398">//&nbsp;affect&nbsp;the&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457426">n</span>&nbsp;<span class="op" id="2457428">=</span>&nbsp;<span class="ident" id="2457430">d</span>&nbsp;<span class="op" id="2457432">/</span>&nbsp;<span class="ident" id="2457434">daysPer4Years</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457449">y</span>&nbsp;<span class="op" id="2457451">+=</span>&nbsp;<span class="num" id="2457454">4</span>&nbsp;<span class="op" id="2457456">*</span>&nbsp;<span class="ident" id="2457458">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457461">d</span>&nbsp;<span class="op" id="2457463">-=</span>&nbsp;<span class="ident" id="2457466">daysPer4Years</span>&nbsp;<span class="op" id="2457480">*</span>&nbsp;<span class="ident" id="2457482">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457486">//&nbsp;Cut&nbsp;off&nbsp;years&nbsp;within&nbsp;a&nbsp;4-year&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457527">//&nbsp;The&nbsp;last&nbsp;year&nbsp;is&nbsp;a&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day&nbsp;of&nbsp;that&nbsp;year,</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457594">//&nbsp;day&nbsp;/&nbsp;365&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.&nbsp;&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457655">//&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457680">n</span>&nbsp;<span class="op" id="2457682">=</span>&nbsp;<span class="ident" id="2457684">d</span>&nbsp;<span class="op" id="2457686">/</span>&nbsp;<span class="num" id="2457688">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457693">n</span>&nbsp;<span class="op" id="2457695">-=</span>&nbsp;<span class="ident" id="2457698">n</span>&nbsp;<span class="op" id="2457700">&gt;&gt;</span>&nbsp;<span class="num" id="2457703">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457706">y</span>&nbsp;<span class="op" id="2457708">+=</span>&nbsp;<span class="ident" id="2457711">n</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457714">d</span>&nbsp;<span class="op" id="2457716">-=</span>&nbsp;<span class="num" id="2457719">365</span>&nbsp;<span class="op" id="2457723">*</span>&nbsp;<span class="ident" id="2457725">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457729">year</span>&nbsp;<span class="op" id="2457734">=</span>&nbsp;<span class="builtintype" id="2457736">int</span><span class="op" id="2457739">(</span><span class="ident" id="2457740">int64</span><span class="op" id="2457745">(</span><span class="ident" id="2457746">y</span><span class="op" id="2457747">)</span>&nbsp;<span class="op" id="2457749">+</span>&nbsp;<span class="ident" id="2457751">absoluteZeroYear</span><span class="op" id="2457767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457770">yday</span>&nbsp;<span class="op" id="2457775">=</span>&nbsp;<span class="builtintype" id="2457777">int</span><span class="op" id="2457780">(</span><span class="ident" id="2457781">d</span><span class="op" id="2457782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457786">if</span>&nbsp;<span class="op" id="2457789">!</span><span class="ident" id="2457790">full</span>&nbsp;<span class="op" id="2457795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457799">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2457807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457811">day</span>&nbsp;<span class="op" id="2457815">=</span>&nbsp;<span class="ident" id="2457817">yday</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457823">if</span>&nbsp;<span class="ident" id="2457826">isLeap</span><span class="op" id="2457832">(</span><span class="ident" id="2457833">year</span><span class="op" id="2457837">)</span>&nbsp;<span class="op" id="2457839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457843">//&nbsp;Leap&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457858">switch</span>&nbsp;<span class="op" id="2457865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457869">case</span>&nbsp;<span class="ident" id="2457874">day</span>&nbsp;<span class="op" id="2457878">&gt;</span>&nbsp;<span class="num" id="2457880">31</span><span class="op" id="2457882">+</span><span class="num" id="2457883">29</span><span class="op" id="2457885">-</span><span class="num" id="2457886">1</span><span class="op" id="2457887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457892">//&nbsp;After&nbsp;leap&nbsp;day;&nbsp;pretend&nbsp;it&nbsp;wasn&#39;t&nbsp;there.</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457939">day</span><span class="op" id="2457942">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2457947">case</span>&nbsp;<span class="ident" id="2457952">day</span>&nbsp;<span class="op" id="2457956">==</span>&nbsp;<span class="num" id="2457959">31</span><span class="op" id="2457961">+</span><span class="num" id="2457962">29</span><span class="op" id="2457964">-</span><span class="num" id="2457965">1</span><span class="op" id="2457966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2457971">//&nbsp;Leap&nbsp;day.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2457987">month</span>&nbsp;<span class="op" id="2457993">=</span>&nbsp;<span class="ident" id="2457995">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458007">day</span>&nbsp;<span class="op" id="2458011">=</span>&nbsp;<span class="num" id="2458013">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458019">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2458035">//&nbsp;Estimate&nbsp;month&nbsp;on&nbsp;assumption&nbsp;that&nbsp;every&nbsp;month&nbsp;has&nbsp;31&nbsp;days.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2458098">//&nbsp;The&nbsp;estimate&nbsp;may&nbsp;be&nbsp;too&nbsp;low&nbsp;by&nbsp;at&nbsp;most&nbsp;one&nbsp;month,&nbsp;so&nbsp;adjust.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458163">month</span>&nbsp;<span class="op" id="2458169">=</span>&nbsp;<span class="ident" id="2458171">Month</span><span class="op" id="2458176">(</span><span class="ident" id="2458177">day</span>&nbsp;<span class="op" id="2458181">/</span>&nbsp;<span class="num" id="2458183">31</span><span class="op" id="2458185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458188">end</span>&nbsp;<span class="op" id="2458192">:=</span>&nbsp;<span class="builtintype" id="2458195">int</span><span class="op" id="2458198">(</span><span class="ident" id="2458199">daysBefore</span><span class="op" id="2458209">[</span><span class="ident" id="2458210">month</span><span class="op" id="2458215">+</span><span class="num" id="2458216">1</span><span class="op" id="2458217">]</span><span class="op" id="2458218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458221">var</span>&nbsp;<span class="ident" id="2458225">begin</span>&nbsp;<span class="builtintype" id="2458231">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458236">if</span>&nbsp;<span class="ident" id="2458239">day</span>&nbsp;<span class="op" id="2458243">&gt;=</span>&nbsp;<span class="ident" id="2458246">end</span>&nbsp;<span class="op" id="2458250">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458254">month</span><span class="op" id="2458259">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458264">begin</span>&nbsp;<span class="op" id="2458270">=</span>&nbsp;<span class="ident" id="2458272">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458277">}</span>&nbsp;<span class="keyword" id="2458279">else</span>&nbsp;<span class="op" id="2458284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458288">begin</span>&nbsp;<span class="op" id="2458294">=</span>&nbsp;<span class="builtintype" id="2458296">int</span><span class="op" id="2458299">(</span><span class="ident" id="2458300">daysBefore</span><span class="op" id="2458310">[</span><span class="ident" id="2458311">month</span><span class="op" id="2458316">]</span><span class="op" id="2458317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2458320">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458324">month</span><span class="op" id="2458329">++</span>&nbsp;<span class="comment" id="2458332">//&nbsp;because&nbsp;January&nbsp;is&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2458357">day</span>&nbsp;<span class="op" id="2458361">=</span>&nbsp;<span class="ident" id="2458363">day</span>&nbsp;<span class="op" id="2458367">-</span>&nbsp;<span class="ident" id="2458369">begin</span>&nbsp;<span class="op" id="2458375">+</span>&nbsp;<span class="num" id="2458377">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2458380">return</span><br>
<span class="lineno"></span><span class="op" id="2458387">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="comment" id="2458390">//&nbsp;daysBefore[m]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;a&nbsp;non-leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2458452">//&nbsp;before&nbsp;month&nbsp;m&nbsp;begins.&nbsp;&nbsp;There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;m=12,&nbsp;counting</span><br>
<span class="lineno"></span><span class="comment" id="2458516">//&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;before&nbsp;January&nbsp;of&nbsp;next&nbsp;year&nbsp;(365).</span><br>
<span class="lineno"></span><span class="keyword" id="2458573">var</span>&nbsp;<span class="ident" id="2458577">daysBefore</span>&nbsp;<span class="op" id="2458588">=</span>&nbsp;<span class="op" id="2458590">[</span><span class="op" id="2458591">...</span><span class="op" id="2458594">]</span><span class="builtintype" id="2458595">int32</span><span class="op" id="2458600">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458603">0</span><span class="op" id="2458604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458607">31</span><span class="op" id="2458609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458612">31</span>&nbsp;<span class="op" id="2458615">+</span>&nbsp;<span class="num" id="2458617">28</span><span class="op" id="2458619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458622">31</span>&nbsp;<span class="op" id="2458625">+</span>&nbsp;<span class="num" id="2458627">28</span>&nbsp;<span class="op" id="2458630">+</span>&nbsp;<span class="num" id="2458632">31</span><span class="op" id="2458634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458637">31</span>&nbsp;<span class="op" id="2458640">+</span>&nbsp;<span class="num" id="2458642">28</span>&nbsp;<span class="op" id="2458645">+</span>&nbsp;<span class="num" id="2458647">31</span>&nbsp;<span class="op" id="2458650">+</span>&nbsp;<span class="num" id="2458652">30</span><span class="op" id="2458654">,</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458657">31</span>&nbsp;<span class="op" id="2458660">+</span>&nbsp;<span class="num" id="2458662">28</span>&nbsp;<span class="op" id="2458665">+</span>&nbsp;<span class="num" id="2458667">31</span>&nbsp;<span class="op" id="2458670">+</span>&nbsp;<span class="num" id="2458672">30</span>&nbsp;<span class="op" id="2458675">+</span>&nbsp;<span class="num" id="2458677">31</span><span class="op" id="2458679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458682">31</span>&nbsp;<span class="op" id="2458685">+</span>&nbsp;<span class="num" id="2458687">28</span>&nbsp;<span class="op" id="2458690">+</span>&nbsp;<span class="num" id="2458692">31</span>&nbsp;<span class="op" id="2458695">+</span>&nbsp;<span class="num" id="2458697">30</span>&nbsp;<span class="op" id="2458700">+</span>&nbsp;<span class="num" id="2458702">31</span>&nbsp;<span class="op" id="2458705">+</span>&nbsp;<span class="num" id="2458707">30</span><span class="op" id="2458709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458712">31</span>&nbsp;<span class="op" id="2458715">+</span>&nbsp;<span class="num" id="2458717">28</span>&nbsp;<span class="op" id="2458720">+</span>&nbsp;<span class="num" id="2458722">31</span>&nbsp;<span class="op" id="2458725">+</span>&nbsp;<span class="num" id="2458727">30</span>&nbsp;<span class="op" id="2458730">+</span>&nbsp;<span class="num" id="2458732">31</span>&nbsp;<span class="op" id="2458735">+</span>&nbsp;<span class="num" id="2458737">30</span>&nbsp;<span class="op" id="2458740">+</span>&nbsp;<span class="num" id="2458742">31</span><span class="op" id="2458744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458747">31</span>&nbsp;<span class="op" id="2458750">+</span>&nbsp;<span class="num" id="2458752">28</span>&nbsp;<span class="op" id="2458755">+</span>&nbsp;<span class="num" id="2458757">31</span>&nbsp;<span class="op" id="2458760">+</span>&nbsp;<span class="num" id="2458762">30</span>&nbsp;<span class="op" id="2458765">+</span>&nbsp;<span class="num" id="2458767">31</span>&nbsp;<span class="op" id="2458770">+</span>&nbsp;<span class="num" id="2458772">30</span>&nbsp;<span class="op" id="2458775">+</span>&nbsp;<span class="num" id="2458777">31</span>&nbsp;<span class="op" id="2458780">+</span>&nbsp;<span class="num" id="2458782">31</span><span class="op" id="2458784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458787">31</span>&nbsp;<span class="op" id="2458790">+</span>&nbsp;<span class="num" id="2458792">28</span>&nbsp;<span class="op" id="2458795">+</span>&nbsp;<span class="num" id="2458797">31</span>&nbsp;<span class="op" id="2458800">+</span>&nbsp;<span class="num" id="2458802">30</span>&nbsp;<span class="op" id="2458805">+</span>&nbsp;<span class="num" id="2458807">31</span>&nbsp;<span class="op" id="2458810">+</span>&nbsp;<span class="num" id="2458812">30</span>&nbsp;<span class="op" id="2458815">+</span>&nbsp;<span class="num" id="2458817">31</span>&nbsp;<span class="op" id="2458820">+</span>&nbsp;<span class="num" id="2458822">31</span>&nbsp;<span class="op" id="2458825">+</span>&nbsp;<span class="num" id="2458827">30</span><span class="op" id="2458829">,</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458832">31</span>&nbsp;<span class="op" id="2458835">+</span>&nbsp;<span class="num" id="2458837">28</span>&nbsp;<span class="op" id="2458840">+</span>&nbsp;<span class="num" id="2458842">31</span>&nbsp;<span class="op" id="2458845">+</span>&nbsp;<span class="num" id="2458847">30</span>&nbsp;<span class="op" id="2458850">+</span>&nbsp;<span class="num" id="2458852">31</span>&nbsp;<span class="op" id="2458855">+</span>&nbsp;<span class="num" id="2458857">30</span>&nbsp;<span class="op" id="2458860">+</span>&nbsp;<span class="num" id="2458862">31</span>&nbsp;<span class="op" id="2458865">+</span>&nbsp;<span class="num" id="2458867">31</span>&nbsp;<span class="op" id="2458870">+</span>&nbsp;<span class="num" id="2458872">30</span>&nbsp;<span class="op" id="2458875">+</span>&nbsp;<span class="num" id="2458877">31</span><span class="op" id="2458879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458882">31</span>&nbsp;<span class="op" id="2458885">+</span>&nbsp;<span class="num" id="2458887">28</span>&nbsp;<span class="op" id="2458890">+</span>&nbsp;<span class="num" id="2458892">31</span>&nbsp;<span class="op" id="2458895">+</span>&nbsp;<span class="num" id="2458897">30</span>&nbsp;<span class="op" id="2458900">+</span>&nbsp;<span class="num" id="2458902">31</span>&nbsp;<span class="op" id="2458905">+</span>&nbsp;<span class="num" id="2458907">30</span>&nbsp;<span class="op" id="2458910">+</span>&nbsp;<span class="num" id="2458912">31</span>&nbsp;<span class="op" id="2458915">+</span>&nbsp;<span class="num" id="2458917">31</span>&nbsp;<span class="op" id="2458920">+</span>&nbsp;<span class="num" id="2458922">30</span>&nbsp;<span class="op" id="2458925">+</span>&nbsp;<span class="num" id="2458927">31</span>&nbsp;<span class="op" id="2458930">+</span>&nbsp;<span class="num" id="2458932">30</span><span class="op" id="2458934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2458937">31</span>&nbsp;<span class="op" id="2458940">+</span>&nbsp;<span class="num" id="2458942">28</span>&nbsp;<span class="op" id="2458945">+</span>&nbsp;<span class="num" id="2458947">31</span>&nbsp;<span class="op" id="2458950">+</span>&nbsp;<span class="num" id="2458952">30</span>&nbsp;<span class="op" id="2458955">+</span>&nbsp;<span class="num" id="2458957">31</span>&nbsp;<span class="op" id="2458960">+</span>&nbsp;<span class="num" id="2458962">30</span>&nbsp;<span class="op" id="2458965">+</span>&nbsp;<span class="num" id="2458967">31</span>&nbsp;<span class="op" id="2458970">+</span>&nbsp;<span class="num" id="2458972">31</span>&nbsp;<span class="op" id="2458975">+</span>&nbsp;<span class="num" id="2458977">30</span>&nbsp;<span class="op" id="2458980">+</span>&nbsp;<span class="num" id="2458982">31</span>&nbsp;<span class="op" id="2458985">+</span>&nbsp;<span class="num" id="2458987">30</span>&nbsp;<span class="op" id="2458990">+</span>&nbsp;<span class="num" id="2458992">31</span><span class="op" id="2458994">,</span><br>
<span class="lineno"></span><span class="op" id="2458996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span><span class="keyword" id="2458999">func</span>&nbsp;<span class="ident" id="2459004">daysIn</span><span class="op" id="2459010">(</span><span class="ident" id="2459011">m</span>&nbsp;<span class="ident" id="2459013">Month</span><span class="op" id="2459018">,</span>&nbsp;<span class="ident" id="2459020">year</span>&nbsp;<span class="builtintype" id="2459025">int</span><span class="op" id="2459028">)</span>&nbsp;<span class="builtintype" id="2459030">int</span>&nbsp;<span class="op" id="2459034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459037">if</span>&nbsp;<span class="ident" id="2459040">m</span>&nbsp;<span class="op" id="2459042">==</span>&nbsp;<span class="ident" id="2459045">February</span>&nbsp;<span class="op" id="2459054">&amp;&amp;</span>&nbsp;<span class="ident" id="2459057">isLeap</span><span class="op" id="2459063">(</span><span class="ident" id="2459064">year</span><span class="op" id="2459068">)</span>&nbsp;<span class="op" id="2459070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459074">return</span>&nbsp;<span class="num" id="2459081">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459088">return</span>&nbsp;<span class="builtintype" id="2459095">int</span><span class="op" id="2459098">(</span><span class="ident" id="2459099">daysBefore</span><span class="op" id="2459109">[</span><span class="ident" id="2459110">m</span><span class="op" id="2459111">]</span>&nbsp;<span class="op" id="2459113">-</span>&nbsp;<span class="ident" id="2459115">daysBefore</span><span class="op" id="2459125">[</span><span class="ident" id="2459126">m</span><span class="op" id="2459127">-</span><span class="num" id="2459128">1</span><span class="op" id="2459129">]</span><span class="op" id="2459130">)</span><br>
<span class="lineno">775</span><span class="op" id="2459132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459135">//&nbsp;Provided&nbsp;by&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="2459167">func</span>&nbsp;<span class="ident" id="2459172">now</span><span class="op" id="2459175">(</span><span class="op" id="2459176">)</span>&nbsp;<span class="op" id="2459178">(</span><span class="ident" id="2459179">sec</span>&nbsp;<span class="ident" id="2459183">int64</span><span class="op" id="2459188">,</span>&nbsp;<span class="ident" id="2459190">nsec</span>&nbsp;<span class="builtintype" id="2459195">int32</span><span class="op" id="2459200">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="comment" id="2459203">//&nbsp;Now&nbsp;returns&nbsp;the&nbsp;current&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2459242">func</span>&nbsp;<span class="ident" id="2459247">Now</span><span class="op" id="2459250">(</span><span class="op" id="2459251">)</span>&nbsp;<span class="ident" id="2459253">Time</span>&nbsp;<span class="op" id="2459258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459261">sec</span><span class="op" id="2459264">,</span>&nbsp;<span class="ident" id="2459266">nsec</span>&nbsp;<span class="op" id="2459271">:=</span>&nbsp;<span class="ident" id="2459274">now</span><span class="op" id="2459277">(</span><span class="op" id="2459278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459281">return</span>&nbsp;<span class="ident" id="2459288">Time</span><span class="op" id="2459292">{</span><span class="ident" id="2459293">sec</span>&nbsp;<span class="op" id="2459297">+</span>&nbsp;<span class="ident" id="2459299">unixToInternal</span><span class="op" id="2459313">,</span>&nbsp;<span class="ident" id="2459315">nsec</span><span class="op" id="2459319">,</span>&nbsp;<span class="ident" id="2459321">Local</span><span class="op" id="2459326">}</span><br>
<span class="lineno"></span><span class="op" id="2459328">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="comment" id="2459331">//&nbsp;UTC&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2459378">func</span>&nbsp;<span class="op" id="2459383">(</span><span class="ident" id="2459384">t</span>&nbsp;<span class="ident" id="2459386">Time</span><span class="op" id="2459390">)</span>&nbsp;<span class="ident" id="2459392">UTC</span><span class="op" id="2459395">(</span><span class="op" id="2459396">)</span>&nbsp;<span class="ident" id="2459398">Time</span>&nbsp;<span class="op" id="2459403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459406">t</span><span class="op" id="2459407">.</span><span class="ident" id="2459408">loc</span>&nbsp;<span class="op" id="2459412">=</span>&nbsp;<span class="ident" id="2459414">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459419">return</span>&nbsp;<span class="ident" id="2459426">t</span><br>
<span class="lineno">790</span><span class="op" id="2459428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459431">//&nbsp;Local&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2459487">func</span>&nbsp;<span class="op" id="2459492">(</span><span class="ident" id="2459493">t</span>&nbsp;<span class="ident" id="2459495">Time</span><span class="op" id="2459499">)</span>&nbsp;<span class="ident" id="2459501">Local</span><span class="op" id="2459506">(</span><span class="op" id="2459507">)</span>&nbsp;<span class="ident" id="2459509">Time</span>&nbsp;<span class="op" id="2459514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459517">t</span><span class="op" id="2459518">.</span><span class="ident" id="2459519">loc</span>&nbsp;<span class="op" id="2459523">=</span>&nbsp;<span class="ident" id="2459525">Local</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459532">return</span>&nbsp;<span class="ident" id="2459539">t</span><br>
<span class="lineno"></span><span class="op" id="2459541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459544">//&nbsp;In&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;information&nbsp;set&nbsp;to&nbsp;loc.</span><br>
<span class="lineno"></span><span class="comment" id="2459602">//</span><br>
<span class="lineno">800</span><span class="comment" id="2459605">//&nbsp;In&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2459633">func</span>&nbsp;<span class="op" id="2459638">(</span><span class="ident" id="2459639">t</span>&nbsp;<span class="ident" id="2459641">Time</span><span class="op" id="2459645">)</span>&nbsp;<span class="ident" id="2459647">In</span><span class="op" id="2459649">(</span><span class="ident" id="2459650">loc</span>&nbsp;<span class="op" id="2459654">*</span><span class="ident" id="2459655">Location</span><span class="op" id="2459663">)</span>&nbsp;<span class="ident" id="2459665">Time</span>&nbsp;<span class="op" id="2459670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459673">if</span>&nbsp;<span class="ident" id="2459676">loc</span>&nbsp;<span class="op" id="2459680">==</span>&nbsp;<span class="ident" id="2459683">nil</span>&nbsp;<span class="op" id="2459687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2459691">panic</span><span class="op" id="2459696">(</span><span class="string" id="2459697">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Time.In&#34;</span><span class="op" id="2459740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459743">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459746">t</span><span class="op" id="2459747">.</span><span class="ident" id="2459748">loc</span>&nbsp;<span class="op" id="2459752">=</span>&nbsp;<span class="ident" id="2459754">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459759">return</span>&nbsp;<span class="ident" id="2459766">t</span><br>
<span class="lineno"></span><span class="op" id="2459768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459771">//&nbsp;Location&nbsp;returns&nbsp;the&nbsp;time&nbsp;zone&nbsp;information&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno">810</span><span class="keyword" id="2459836">func</span>&nbsp;<span class="op" id="2459841">(</span><span class="ident" id="2459842">t</span>&nbsp;<span class="ident" id="2459844">Time</span><span class="op" id="2459848">)</span>&nbsp;<span class="ident" id="2459850">Location</span><span class="op" id="2459858">(</span><span class="op" id="2459859">)</span>&nbsp;<span class="op" id="2459861">*</span><span class="ident" id="2459862">Location</span>&nbsp;<span class="op" id="2459871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459874">l</span>&nbsp;<span class="op" id="2459876">:=</span>&nbsp;<span class="ident" id="2459879">t</span><span class="op" id="2459880">.</span><span class="ident" id="2459881">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459886">if</span>&nbsp;<span class="ident" id="2459889">l</span>&nbsp;<span class="op" id="2459891">==</span>&nbsp;<span class="ident" id="2459894">nil</span>&nbsp;<span class="op" id="2459898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2459902">l</span>&nbsp;<span class="op" id="2459904">=</span>&nbsp;<span class="ident" id="2459906">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2459911">}</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2459914">return</span>&nbsp;<span class="ident" id="2459921">l</span><br>
<span class="lineno"></span><span class="op" id="2459923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2459926">//&nbsp;Zone&nbsp;computes&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;effect&nbsp;at&nbsp;time&nbsp;t,&nbsp;returning&nbsp;the&nbsp;abbreviated</span><br>
<span class="lineno"></span><span class="comment" id="2460004">//&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;)&nbsp;and&nbsp;its&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC.</span><br>
<span class="lineno">820</span><span class="keyword" id="2460079">func</span>&nbsp;<span class="op" id="2460084">(</span><span class="ident" id="2460085">t</span>&nbsp;<span class="ident" id="2460087">Time</span><span class="op" id="2460091">)</span>&nbsp;<span class="ident" id="2460093">Zone</span><span class="op" id="2460097">(</span><span class="op" id="2460098">)</span>&nbsp;<span class="op" id="2460100">(</span><span class="ident" id="2460101">name</span>&nbsp;<span class="builtintype" id="2460106">string</span><span class="op" id="2460112">,</span>&nbsp;<span class="ident" id="2460114">offset</span>&nbsp;<span class="builtintype" id="2460121">int</span><span class="op" id="2460124">)</span>&nbsp;<span class="op" id="2460126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460129">name</span><span class="op" id="2460133">,</span>&nbsp;<span class="ident" id="2460135">offset</span><span class="op" id="2460141">,</span>&nbsp;<span class="ident" id="2460143">_</span><span class="op" id="2460144">,</span>&nbsp;<span class="ident" id="2460146">_</span><span class="op" id="2460147">,</span>&nbsp;<span class="ident" id="2460149">_</span>&nbsp;<span class="op" id="2460151">=</span>&nbsp;<span class="ident" id="2460153">t</span><span class="op" id="2460154">.</span><span class="ident" id="2460155">loc</span><span class="op" id="2460158">.</span><span class="ident" id="2460159">lookup</span><span class="op" id="2460165">(</span><span class="ident" id="2460166">t</span><span class="op" id="2460167">.</span><span class="ident" id="2460168">sec</span>&nbsp;<span class="op" id="2460172">+</span>&nbsp;<span class="ident" id="2460174">internalToUnix</span><span class="op" id="2460188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460191">return</span><br>
<span class="lineno"></span><span class="op" id="2460198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="2460201">//&nbsp;Unix&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2460265">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2460295">func</span>&nbsp;<span class="op" id="2460300">(</span><span class="ident" id="2460301">t</span>&nbsp;<span class="ident" id="2460303">Time</span><span class="op" id="2460307">)</span>&nbsp;<span class="ident" id="2460309">Unix</span><span class="op" id="2460313">(</span><span class="op" id="2460314">)</span>&nbsp;<span class="ident" id="2460316">int64</span>&nbsp;<span class="op" id="2460322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460325">return</span>&nbsp;<span class="ident" id="2460332">t</span><span class="op" id="2460333">.</span><span class="ident" id="2460334">sec</span>&nbsp;<span class="op" id="2460338">+</span>&nbsp;<span class="ident" id="2460340">internalToUnix</span><br>
<span class="lineno"></span><span class="op" id="2460355">}</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span><span class="comment" id="2460358">//&nbsp;UnixNano&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;nanoseconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2460430">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.&nbsp;The&nbsp;result&nbsp;is&nbsp;undefined&nbsp;if&nbsp;the&nbsp;Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2460501">//&nbsp;in&nbsp;nanoseconds&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;an&nbsp;int64.&nbsp;Note&nbsp;that&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2460569">//&nbsp;means&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;UnixNano&nbsp;on&nbsp;the&nbsp;zero&nbsp;Time&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">835</span><span class="keyword" id="2460640">func</span>&nbsp;<span class="op" id="2460645">(</span><span class="ident" id="2460646">t</span>&nbsp;<span class="ident" id="2460648">Time</span><span class="op" id="2460652">)</span>&nbsp;<span class="ident" id="2460654">UnixNano</span><span class="op" id="2460662">(</span><span class="op" id="2460663">)</span>&nbsp;<span class="ident" id="2460665">int64</span>&nbsp;<span class="op" id="2460671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460674">return</span>&nbsp;<span class="op" id="2460681">(</span><span class="ident" id="2460682">t</span><span class="op" id="2460683">.</span><span class="ident" id="2460684">sec</span><span class="op" id="2460687">+</span><span class="ident" id="2460688">internalToUnix</span><span class="op" id="2460702">)</span><span class="op" id="2460703">*</span><span class="num" id="2460704">1e9</span>&nbsp;<span class="op" id="2460708">+</span>&nbsp;<span class="ident" id="2460710">int64</span><span class="op" id="2460715">(</span><span class="ident" id="2460716">t</span><span class="op" id="2460717">.</span><span class="ident" id="2460718">nsec</span><span class="op" id="2460722">)</span><br>
<span class="lineno"></span><span class="op" id="2460724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2460727">const</span>&nbsp;<span class="ident" id="2460733">timeBinaryVersion</span>&nbsp;<span class="builtintype" id="2460751">byte</span>&nbsp;<span class="op" id="2460756">=</span>&nbsp;<span class="num" id="2460758">1</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="comment" id="2460761">//&nbsp;MarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2460829">func</span>&nbsp;<span class="op" id="2460834">(</span><span class="ident" id="2460835">t</span>&nbsp;<span class="ident" id="2460837">Time</span><span class="op" id="2460841">)</span>&nbsp;<span class="ident" id="2460843">MarshalBinary</span><span class="op" id="2460856">(</span><span class="op" id="2460857">)</span>&nbsp;<span class="op" id="2460859">(</span><span class="op" id="2460860">[</span><span class="op" id="2460861">]</span><span class="builtintype" id="2460862">byte</span><span class="op" id="2460866">,</span>&nbsp;<span class="builtintype" id="2460868">error</span><span class="op" id="2460873">)</span>&nbsp;<span class="op" id="2460875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460878">var</span>&nbsp;<span class="ident" id="2460882">offsetMin</span>&nbsp;<span class="builtintype" id="2460892">int16</span>&nbsp;<span class="comment" id="2460898">//&nbsp;minutes&nbsp;east&nbsp;of&nbsp;UTC.&nbsp;-1&nbsp;is&nbsp;UTC.</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2460935">if</span>&nbsp;<span class="ident" id="2460938">t</span><span class="op" id="2460939">.</span><span class="ident" id="2460940">Location</span><span class="op" id="2460948">(</span><span class="op" id="2460949">)</span>&nbsp;<span class="op" id="2460951">==</span>&nbsp;<span class="op" id="2460954">&amp;</span><span class="ident" id="2460955">utcLoc</span>&nbsp;<span class="op" id="2460962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460966">offsetMin</span>&nbsp;<span class="op" id="2460976">=</span>&nbsp;<span class="op" id="2460978">-</span><span class="num" id="2460979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2460982">}</span>&nbsp;<span class="keyword" id="2460984">else</span>&nbsp;<span class="op" id="2460989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2460993">_</span><span class="op" id="2460994">,</span>&nbsp;<span class="ident" id="2460996">offset</span>&nbsp;<span class="op" id="2461003">:=</span>&nbsp;<span class="ident" id="2461006">t</span><span class="op" id="2461007">.</span><span class="ident" id="2461008">Zone</span><span class="op" id="2461012">(</span><span class="op" id="2461013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461017">if</span>&nbsp;<span class="ident" id="2461020">offset</span><span class="op" id="2461026">%</span><span class="num" id="2461027">60</span>&nbsp;<span class="op" id="2461030">!=</span>&nbsp;<span class="num" id="2461033">0</span>&nbsp;<span class="op" id="2461035">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461040">return</span>&nbsp;<span class="ident" id="2461047">nil</span><span class="op" id="2461050">,</span>&nbsp;<span class="ident" id="2461052">errors</span><span class="op" id="2461058">.</span><span class="ident" id="2461059">New</span><span class="op" id="2461062">(</span><span class="string" id="2461063">&#34;Time.MarshalBinary:&nbsp;zone&nbsp;offset&nbsp;has&nbsp;fractional&nbsp;minute&#34;</span><span class="op" id="2461118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2461122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461126">offset</span>&nbsp;<span class="op" id="2461133">/=</span>&nbsp;<span class="num" id="2461136">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461141">if</span>&nbsp;<span class="ident" id="2461144">offset</span>&nbsp;<span class="op" id="2461151">&lt;</span>&nbsp;<span class="op" id="2461153">-</span><span class="num" id="2461154">32768</span>&nbsp;<span class="op" id="2461160">||</span>&nbsp;<span class="ident" id="2461163">offset</span>&nbsp;<span class="op" id="2461170">==</span>&nbsp;<span class="op" id="2461173">-</span><span class="num" id="2461174">1</span>&nbsp;<span class="op" id="2461176">||</span>&nbsp;<span class="ident" id="2461179">offset</span>&nbsp;<span class="op" id="2461186">&gt;</span>&nbsp;<span class="num" id="2461188">32767</span>&nbsp;<span class="op" id="2461194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461199">return</span>&nbsp;<span class="ident" id="2461206">nil</span><span class="op" id="2461209">,</span>&nbsp;<span class="ident" id="2461211">errors</span><span class="op" id="2461217">.</span><span class="ident" id="2461218">New</span><span class="op" id="2461221">(</span><span class="string" id="2461222">&#34;Time.MarshalBinary:&nbsp;unexpected&nbsp;zone&nbsp;offset&#34;</span><span class="op" id="2461266">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2461270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461274">offsetMin</span>&nbsp;<span class="op" id="2461284">=</span>&nbsp;<span class="builtintype" id="2461286">int16</span><span class="op" id="2461291">(</span><span class="ident" id="2461292">offset</span><span class="op" id="2461298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2461301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461305">enc</span>&nbsp;<span class="op" id="2461309">:=</span>&nbsp;<span class="op" id="2461312">[</span><span class="op" id="2461313">]</span><span class="builtintype" id="2461314">byte</span><span class="op" id="2461318">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461322">timeBinaryVersion</span><span class="op" id="2461339">,</span>&nbsp;<span class="comment" id="2461341">//&nbsp;byte&nbsp;0&nbsp;:&nbsp;version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461363">byte</span><span class="op" id="2461367">(</span><span class="ident" id="2461368">t</span><span class="op" id="2461369">.</span><span class="ident" id="2461370">sec</span>&nbsp;<span class="op" id="2461374">&gt;&gt;</span>&nbsp;<span class="num" id="2461377">56</span><span class="op" id="2461379">)</span><span class="op" id="2461380">,</span>&nbsp;<span class="comment" id="2461382">//&nbsp;bytes&nbsp;1-8:&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461406">byte</span><span class="op" id="2461410">(</span><span class="ident" id="2461411">t</span><span class="op" id="2461412">.</span><span class="ident" id="2461413">sec</span>&nbsp;<span class="op" id="2461417">&gt;&gt;</span>&nbsp;<span class="num" id="2461420">48</span><span class="op" id="2461422">)</span><span class="op" id="2461423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461427">byte</span><span class="op" id="2461431">(</span><span class="ident" id="2461432">t</span><span class="op" id="2461433">.</span><span class="ident" id="2461434">sec</span>&nbsp;<span class="op" id="2461438">&gt;&gt;</span>&nbsp;<span class="num" id="2461441">40</span><span class="op" id="2461443">)</span><span class="op" id="2461444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461448">byte</span><span class="op" id="2461452">(</span><span class="ident" id="2461453">t</span><span class="op" id="2461454">.</span><span class="ident" id="2461455">sec</span>&nbsp;<span class="op" id="2461459">&gt;&gt;</span>&nbsp;<span class="num" id="2461462">32</span><span class="op" id="2461464">)</span><span class="op" id="2461465">,</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461469">byte</span><span class="op" id="2461473">(</span><span class="ident" id="2461474">t</span><span class="op" id="2461475">.</span><span class="ident" id="2461476">sec</span>&nbsp;<span class="op" id="2461480">&gt;&gt;</span>&nbsp;<span class="num" id="2461483">24</span><span class="op" id="2461485">)</span><span class="op" id="2461486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461490">byte</span><span class="op" id="2461494">(</span><span class="ident" id="2461495">t</span><span class="op" id="2461496">.</span><span class="ident" id="2461497">sec</span>&nbsp;<span class="op" id="2461501">&gt;&gt;</span>&nbsp;<span class="num" id="2461504">16</span><span class="op" id="2461506">)</span><span class="op" id="2461507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461511">byte</span><span class="op" id="2461515">(</span><span class="ident" id="2461516">t</span><span class="op" id="2461517">.</span><span class="ident" id="2461518">sec</span>&nbsp;<span class="op" id="2461522">&gt;&gt;</span>&nbsp;<span class="num" id="2461525">8</span><span class="op" id="2461526">)</span><span class="op" id="2461527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461531">byte</span><span class="op" id="2461535">(</span><span class="ident" id="2461536">t</span><span class="op" id="2461537">.</span><span class="ident" id="2461538">sec</span><span class="op" id="2461541">)</span><span class="op" id="2461542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461546">byte</span><span class="op" id="2461550">(</span><span class="ident" id="2461551">t</span><span class="op" id="2461552">.</span><span class="ident" id="2461553">nsec</span>&nbsp;<span class="op" id="2461558">&gt;&gt;</span>&nbsp;<span class="num" id="2461561">24</span><span class="op" id="2461563">)</span><span class="op" id="2461564">,</span>&nbsp;<span class="comment" id="2461566">//&nbsp;bytes&nbsp;9-12:&nbsp;nanoseconds</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461595">byte</span><span class="op" id="2461599">(</span><span class="ident" id="2461600">t</span><span class="op" id="2461601">.</span><span class="ident" id="2461602">nsec</span>&nbsp;<span class="op" id="2461607">&gt;&gt;</span>&nbsp;<span class="num" id="2461610">16</span><span class="op" id="2461612">)</span><span class="op" id="2461613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461617">byte</span><span class="op" id="2461621">(</span><span class="ident" id="2461622">t</span><span class="op" id="2461623">.</span><span class="ident" id="2461624">nsec</span>&nbsp;<span class="op" id="2461629">&gt;&gt;</span>&nbsp;<span class="num" id="2461632">8</span><span class="op" id="2461633">)</span><span class="op" id="2461634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461638">byte</span><span class="op" id="2461642">(</span><span class="ident" id="2461643">t</span><span class="op" id="2461644">.</span><span class="ident" id="2461645">nsec</span><span class="op" id="2461649">)</span><span class="op" id="2461650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461654">byte</span><span class="op" id="2461658">(</span><span class="ident" id="2461659">offsetMin</span>&nbsp;<span class="op" id="2461669">&gt;&gt;</span>&nbsp;<span class="num" id="2461672">8</span><span class="op" id="2461673">)</span><span class="op" id="2461674">,</span>&nbsp;<span class="comment" id="2461676">//&nbsp;bytes&nbsp;13-14:&nbsp;zone&nbsp;offset&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2461717">byte</span><span class="op" id="2461721">(</span><span class="ident" id="2461722">offsetMin</span><span class="op" id="2461731">)</span><span class="op" id="2461732">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2461735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461739">return</span>&nbsp;<span class="ident" id="2461746">enc</span><span class="op" id="2461749">,</span>&nbsp;<span class="ident" id="2461751">nil</span><br>
<span class="lineno"></span><span class="op" id="2461755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">880</span><span class="comment" id="2461758">//&nbsp;UnmarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2461830">func</span>&nbsp;<span class="op" id="2461835">(</span><span class="ident" id="2461836">t</span>&nbsp;<span class="op" id="2461838">*</span><span class="ident" id="2461839">Time</span><span class="op" id="2461843">)</span>&nbsp;<span class="ident" id="2461845">UnmarshalBinary</span><span class="op" id="2461860">(</span><span class="ident" id="2461861">data</span>&nbsp;<span class="op" id="2461866">[</span><span class="op" id="2461867">]</span><span class="builtintype" id="2461868">byte</span><span class="op" id="2461872">)</span>&nbsp;<span class="builtintype" id="2461874">error</span>&nbsp;<span class="op" id="2461880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2461883">buf</span>&nbsp;<span class="op" id="2461887">:=</span>&nbsp;<span class="ident" id="2461890">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461896">if</span>&nbsp;<span class="builtinfunc" id="2461899">len</span><span class="op" id="2461902">(</span><span class="ident" id="2461903">buf</span><span class="op" id="2461906">)</span>&nbsp;<span class="op" id="2461908">==</span>&nbsp;<span class="num" id="2461911">0</span>&nbsp;<span class="op" id="2461913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461917">return</span>&nbsp;<span class="ident" id="2461924">errors</span><span class="op" id="2461930">.</span><span class="ident" id="2461931">New</span><span class="op" id="2461934">(</span><span class="string" id="2461935">&#34;Time.UnmarshalBinary:&nbsp;no&nbsp;data&#34;</span><span class="op" id="2461966">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2461969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2461973">if</span>&nbsp;<span class="ident" id="2461976">buf</span><span class="op" id="2461979">[</span><span class="num" id="2461980">0</span><span class="op" id="2461981">]</span>&nbsp;<span class="op" id="2461983">!=</span>&nbsp;<span class="ident" id="2461986">timeBinaryVersion</span>&nbsp;<span class="op" id="2462004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2462008">return</span>&nbsp;<span class="ident" id="2462015">errors</span><span class="op" id="2462021">.</span><span class="ident" id="2462022">New</span><span class="op" id="2462025">(</span><span class="string" id="2462026">&#34;Time.UnmarshalBinary:&nbsp;unsupported&nbsp;version&#34;</span><span class="op" id="2462069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2462072">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2462076">if</span>&nbsp;<span class="builtinfunc" id="2462079">len</span><span class="op" id="2462082">(</span><span class="ident" id="2462083">buf</span><span class="op" id="2462086">)</span>&nbsp;<span class="op" id="2462088">!=</span>&nbsp;<span class="comment" id="2462091">/*version*/</span>&nbsp;<span class="num" id="2462103">1</span><span class="op" id="2462104">+</span>&nbsp;<span class="comment" id="2462106">/*sec*/</span>&nbsp;<span class="num" id="2462114">8</span><span class="op" id="2462115">+</span>&nbsp;<span class="comment" id="2462117">/*nsec*/</span>&nbsp;<span class="num" id="2462126">4</span><span class="op" id="2462127">+</span>&nbsp;<span class="comment" id="2462129">/*zone&nbsp;offset*/</span>&nbsp;<span class="num" id="2462145">2</span>&nbsp;<span class="op" id="2462147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2462151">return</span>&nbsp;<span class="ident" id="2462158">errors</span><span class="op" id="2462164">.</span><span class="ident" id="2462165">New</span><span class="op" id="2462168">(</span><span class="string" id="2462169">&#34;Time.UnmarshalBinary:&nbsp;invalid&nbsp;length&#34;</span><span class="op" id="2462207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2462210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462214">buf</span>&nbsp;<span class="op" id="2462218">=</span>&nbsp;<span class="ident" id="2462220">buf</span><span class="op" id="2462223">[</span><span class="num" id="2462224">1</span><span class="op" id="2462225">:</span><span class="op" id="2462226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462229">t</span><span class="op" id="2462230">.</span><span class="ident" id="2462231">sec</span>&nbsp;<span class="op" id="2462235">=</span>&nbsp;<span class="ident" id="2462237">int64</span><span class="op" id="2462242">(</span><span class="ident" id="2462243">buf</span><span class="op" id="2462246">[</span><span class="num" id="2462247">7</span><span class="op" id="2462248">]</span><span class="op" id="2462249">)</span>&nbsp;<span class="op" id="2462251">|</span>&nbsp;<span class="ident" id="2462253">int64</span><span class="op" id="2462258">(</span><span class="ident" id="2462259">buf</span><span class="op" id="2462262">[</span><span class="num" id="2462263">6</span><span class="op" id="2462264">]</span><span class="op" id="2462265">)</span><span class="op" id="2462266">&lt;&lt;</span><span class="num" id="2462268">8</span>&nbsp;<span class="op" id="2462270">|</span>&nbsp;<span class="ident" id="2462272">int64</span><span class="op" id="2462277">(</span><span class="ident" id="2462278">buf</span><span class="op" id="2462281">[</span><span class="num" id="2462282">5</span><span class="op" id="2462283">]</span><span class="op" id="2462284">)</span><span class="op" id="2462285">&lt;&lt;</span><span class="num" id="2462287">16</span>&nbsp;<span class="op" id="2462290">|</span>&nbsp;<span class="ident" id="2462292">int64</span><span class="op" id="2462297">(</span><span class="ident" id="2462298">buf</span><span class="op" id="2462301">[</span><span class="num" id="2462302">4</span><span class="op" id="2462303">]</span><span class="op" id="2462304">)</span><span class="op" id="2462305">&lt;&lt;</span><span class="num" id="2462307">24</span>&nbsp;<span class="op" id="2462310">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462314">int64</span><span class="op" id="2462319">(</span><span class="ident" id="2462320">buf</span><span class="op" id="2462323">[</span><span class="num" id="2462324">3</span><span class="op" id="2462325">]</span><span class="op" id="2462326">)</span><span class="op" id="2462327">&lt;&lt;</span><span class="num" id="2462329">32</span>&nbsp;<span class="op" id="2462332">|</span>&nbsp;<span class="ident" id="2462334">int64</span><span class="op" id="2462339">(</span><span class="ident" id="2462340">buf</span><span class="op" id="2462343">[</span><span class="num" id="2462344">2</span><span class="op" id="2462345">]</span><span class="op" id="2462346">)</span><span class="op" id="2462347">&lt;&lt;</span><span class="num" id="2462349">40</span>&nbsp;<span class="op" id="2462352">|</span>&nbsp;<span class="ident" id="2462354">int64</span><span class="op" id="2462359">(</span><span class="ident" id="2462360">buf</span><span class="op" id="2462363">[</span><span class="num" id="2462364">1</span><span class="op" id="2462365">]</span><span class="op" id="2462366">)</span><span class="op" id="2462367">&lt;&lt;</span><span class="num" id="2462369">48</span>&nbsp;<span class="op" id="2462372">|</span>&nbsp;<span class="ident" id="2462374">int64</span><span class="op" id="2462379">(</span><span class="ident" id="2462380">buf</span><span class="op" id="2462383">[</span><span class="num" id="2462384">0</span><span class="op" id="2462385">]</span><span class="op" id="2462386">)</span><span class="op" id="2462387">&lt;&lt;</span><span class="num" id="2462389">56</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462394">buf</span>&nbsp;<span class="op" id="2462398">=</span>&nbsp;<span class="ident" id="2462400">buf</span><span class="op" id="2462403">[</span><span class="num" id="2462404">8</span><span class="op" id="2462405">:</span><span class="op" id="2462406">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462409">t</span><span class="op" id="2462410">.</span><span class="ident" id="2462411">nsec</span>&nbsp;<span class="op" id="2462416">=</span>&nbsp;<span class="builtintype" id="2462418">int32</span><span class="op" id="2462423">(</span><span class="ident" id="2462424">buf</span><span class="op" id="2462427">[</span><span class="num" id="2462428">3</span><span class="op" id="2462429">]</span><span class="op" id="2462430">)</span>&nbsp;<span class="op" id="2462432">|</span>&nbsp;<span class="builtintype" id="2462434">int32</span><span class="op" id="2462439">(</span><span class="ident" id="2462440">buf</span><span class="op" id="2462443">[</span><span class="num" id="2462444">2</span><span class="op" id="2462445">]</span><span class="op" id="2462446">)</span><span class="op" id="2462447">&lt;&lt;</span><span class="num" id="2462449">8</span>&nbsp;<span class="op" id="2462451">|</span>&nbsp;<span class="builtintype" id="2462453">int32</span><span class="op" id="2462458">(</span><span class="ident" id="2462459">buf</span><span class="op" id="2462462">[</span><span class="num" id="2462463">1</span><span class="op" id="2462464">]</span><span class="op" id="2462465">)</span><span class="op" id="2462466">&lt;&lt;</span><span class="num" id="2462468">16</span>&nbsp;<span class="op" id="2462471">|</span>&nbsp;<span class="builtintype" id="2462473">int32</span><span class="op" id="2462478">(</span><span class="ident" id="2462479">buf</span><span class="op" id="2462482">[</span><span class="num" id="2462483">0</span><span class="op" id="2462484">]</span><span class="op" id="2462485">)</span><span class="op" id="2462486">&lt;&lt;</span><span class="num" id="2462488">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462493">buf</span>&nbsp;<span class="op" id="2462497">=</span>&nbsp;<span class="ident" id="2462499">buf</span><span class="op" id="2462502">[</span><span class="num" id="2462503">4</span><span class="op" id="2462504">:</span><span class="op" id="2462505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462508">offset</span>&nbsp;<span class="op" id="2462515">:=</span>&nbsp;<span class="builtintype" id="2462518">int</span><span class="op" id="2462521">(</span><span class="builtintype" id="2462522">int16</span><span class="op" id="2462527">(</span><span class="ident" id="2462528">buf</span><span class="op" id="2462531">[</span><span class="num" id="2462532">1</span><span class="op" id="2462533">]</span><span class="op" id="2462534">)</span><span class="op" id="2462535">|</span><span class="builtintype" id="2462536">int16</span><span class="op" id="2462541">(</span><span class="ident" id="2462542">buf</span><span class="op" id="2462545">[</span><span class="num" id="2462546">0</span><span class="op" id="2462547">]</span><span class="op" id="2462548">)</span><span class="op" id="2462549">&lt;&lt;</span><span class="num" id="2462551">8</span><span class="op" id="2462552">)</span>&nbsp;<span class="op" id="2462554">*</span>&nbsp;<span class="num" id="2462556">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2462561">if</span>&nbsp;<span class="ident" id="2462564">offset</span>&nbsp;<span class="op" id="2462571">==</span>&nbsp;<span class="op" id="2462574">-</span><span class="num" id="2462575">1</span><span class="op" id="2462576">*</span><span class="num" id="2462577">60</span>&nbsp;<span class="op" id="2462580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462584">t</span><span class="op" id="2462585">.</span><span class="ident" id="2462586">loc</span>&nbsp;<span class="op" id="2462590">=</span>&nbsp;<span class="op" id="2462592">&amp;</span><span class="ident" id="2462593">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2462601">}</span>&nbsp;<span class="keyword" id="2462603">else</span>&nbsp;<span class="keyword" id="2462608">if</span>&nbsp;<span class="ident" id="2462611">_</span><span class="op" id="2462612">,</span>&nbsp;<span class="ident" id="2462614">localoff</span><span class="op" id="2462622">,</span>&nbsp;<span class="ident" id="2462624">_</span><span class="op" id="2462625">,</span>&nbsp;<span class="ident" id="2462627">_</span><span class="op" id="2462628">,</span>&nbsp;<span class="ident" id="2462630">_</span>&nbsp;<span class="op" id="2462632">:=</span>&nbsp;<span class="ident" id="2462635">Local</span><span class="op" id="2462640">.</span><span class="ident" id="2462641">lookup</span><span class="op" id="2462647">(</span><span class="ident" id="2462648">t</span><span class="op" id="2462649">.</span><span class="ident" id="2462650">sec</span>&nbsp;<span class="op" id="2462654">+</span>&nbsp;<span class="ident" id="2462656">internalToUnix</span><span class="op" id="2462670">)</span><span class="op" id="2462671">;</span>&nbsp;<span class="ident" id="2462673">offset</span>&nbsp;<span class="op" id="2462680">==</span>&nbsp;<span class="ident" id="2462683">localoff</span>&nbsp;<span class="op" id="2462692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462696">t</span><span class="op" id="2462697">.</span><span class="ident" id="2462698">loc</span>&nbsp;<span class="op" id="2462702">=</span>&nbsp;<span class="ident" id="2462704">Local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2462711">}</span>&nbsp;<span class="keyword" id="2462713">else</span>&nbsp;<span class="op" id="2462718">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2462722">t</span><span class="op" id="2462723">.</span><span class="ident" id="2462724">loc</span>&nbsp;<span class="op" id="2462728">=</span>&nbsp;<span class="ident" id="2462730">FixedZone</span><span class="op" id="2462739">(</span><span class="string" id="2462740">&#34;&#34;</span><span class="op" id="2462742">,</span>&nbsp;<span class="ident" id="2462744">offset</span><span class="op" id="2462750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2462753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2462757">return</span>&nbsp;<span class="ident" id="2462764">nil</span><br>
<span class="lineno"></span><span class="op" id="2462768">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="2462771">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;GobEncoder,&nbsp;GobDecoder,&nbsp;MarshalJSON,&nbsp;UnmarshalJSON&nbsp;in&nbsp;Go&nbsp;2.</span><br>
<span class="lineno"></span><span class="comment" id="2462852">//&nbsp;The&nbsp;same&nbsp;semantics&nbsp;will&nbsp;be&nbsp;provided&nbsp;by&nbsp;the&nbsp;generic&nbsp;MarshalBinary,&nbsp;MarshalText,</span><br>
<span class="lineno"></span><span class="comment" id="2462934">//&nbsp;UnmarshalBinary,&nbsp;UnmarshalText.</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span><span class="comment" id="2462970">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2463024">func</span>&nbsp;<span class="op" id="2463029">(</span><span class="ident" id="2463030">t</span>&nbsp;<span class="ident" id="2463032">Time</span><span class="op" id="2463036">)</span>&nbsp;<span class="ident" id="2463038">GobEncode</span><span class="op" id="2463047">(</span><span class="op" id="2463048">)</span>&nbsp;<span class="op" id="2463050">(</span><span class="op" id="2463051">[</span><span class="op" id="2463052">]</span><span class="builtintype" id="2463053">byte</span><span class="op" id="2463057">,</span>&nbsp;<span class="builtintype" id="2463059">error</span><span class="op" id="2463064">)</span>&nbsp;<span class="op" id="2463066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463069">return</span>&nbsp;<span class="ident" id="2463076">t</span><span class="op" id="2463077">.</span><span class="ident" id="2463078">MarshalBinary</span><span class="op" id="2463091">(</span><span class="op" id="2463092">)</span><br>
<span class="lineno"></span><span class="op" id="2463094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="comment" id="2463097">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2463151">func</span>&nbsp;<span class="op" id="2463156">(</span><span class="ident" id="2463157">t</span>&nbsp;<span class="op" id="2463159">*</span><span class="ident" id="2463160">Time</span><span class="op" id="2463164">)</span>&nbsp;<span class="ident" id="2463166">GobDecode</span><span class="op" id="2463175">(</span><span class="ident" id="2463176">data</span>&nbsp;<span class="op" id="2463181">[</span><span class="op" id="2463182">]</span><span class="builtintype" id="2463183">byte</span><span class="op" id="2463187">)</span>&nbsp;<span class="builtintype" id="2463189">error</span>&nbsp;<span class="op" id="2463195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463198">return</span>&nbsp;<span class="ident" id="2463205">t</span><span class="op" id="2463206">.</span><span class="ident" id="2463207">UnmarshalBinary</span><span class="op" id="2463222">(</span><span class="ident" id="2463223">data</span><span class="op" id="2463227">)</span><br>
<span class="lineno"></span><span class="op" id="2463229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="2463232">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2463288">//&nbsp;The&nbsp;time&nbsp;is&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2463383">func</span>&nbsp;<span class="op" id="2463388">(</span><span class="ident" id="2463389">t</span>&nbsp;<span class="ident" id="2463391">Time</span><span class="op" id="2463395">)</span>&nbsp;<span class="ident" id="2463397">MarshalJSON</span><span class="op" id="2463408">(</span><span class="op" id="2463409">)</span>&nbsp;<span class="op" id="2463411">(</span><span class="op" id="2463412">[</span><span class="op" id="2463413">]</span><span class="builtintype" id="2463414">byte</span><span class="op" id="2463418">,</span>&nbsp;<span class="builtintype" id="2463420">error</span><span class="op" id="2463425">)</span>&nbsp;<span class="op" id="2463427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463430">if</span>&nbsp;<span class="ident" id="2463433">y</span>&nbsp;<span class="op" id="2463435">:=</span>&nbsp;<span class="ident" id="2463438">t</span><span class="op" id="2463439">.</span><span class="ident" id="2463440">Year</span><span class="op" id="2463444">(</span><span class="op" id="2463445">)</span><span class="op" id="2463446">;</span>&nbsp;<span class="ident" id="2463448">y</span>&nbsp;<span class="op" id="2463450">&lt;</span>&nbsp;<span class="num" id="2463452">0</span>&nbsp;<span class="op" id="2463454">||</span>&nbsp;<span class="ident" id="2463457">y</span>&nbsp;<span class="op" id="2463459">&gt;=</span>&nbsp;<span class="num" id="2463462">10000</span>&nbsp;<span class="op" id="2463468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2463472">//&nbsp;RFC&nbsp;3339&nbsp;is&nbsp;clear&nbsp;that&nbsp;years&nbsp;are&nbsp;4&nbsp;digits&nbsp;exactly.</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2463528">//&nbsp;See&nbsp;golang.org/issue/4556#c15&nbsp;for&nbsp;more&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463584">return</span>&nbsp;<span class="ident" id="2463591">nil</span><span class="op" id="2463594">,</span>&nbsp;<span class="ident" id="2463596">errors</span><span class="op" id="2463602">.</span><span class="ident" id="2463603">New</span><span class="op" id="2463606">(</span><span class="string" id="2463607">&#34;Time.MarshalJSON:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2463657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2463660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2463663">return</span>&nbsp;<span class="op" id="2463670">[</span><span class="op" id="2463671">]</span><span class="builtintype" id="2463672">byte</span><span class="op" id="2463676">(</span><span class="ident" id="2463677">t</span><span class="op" id="2463678">.</span><span class="ident" id="2463679">Format</span><span class="op" id="2463685">(</span><span class="string" id="2463686">`&#34;`</span>&nbsp;<span class="op" id="2463690">+</span>&nbsp;<span class="ident" id="2463692">RFC3339Nano</span>&nbsp;<span class="op" id="2463704">+</span>&nbsp;<span class="string" id="2463706">`&#34;`</span><span class="op" id="2463709">)</span><span class="op" id="2463710">)</span><span class="op" id="2463711">,</span>&nbsp;<span class="ident" id="2463713">nil</span><br>
<span class="lineno"></span><span class="op" id="2463717">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="comment" id="2463720">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2463780">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="2463846">func</span>&nbsp;<span class="op" id="2463851">(</span><span class="ident" id="2463852">t</span>&nbsp;<span class="op" id="2463854">*</span><span class="ident" id="2463855">Time</span><span class="op" id="2463859">)</span>&nbsp;<span class="ident" id="2463861">UnmarshalJSON</span><span class="op" id="2463874">(</span><span class="ident" id="2463875">data</span>&nbsp;<span class="op" id="2463880">[</span><span class="op" id="2463881">]</span><span class="builtintype" id="2463882">byte</span><span class="op" id="2463886">)</span>&nbsp;<span class="op" id="2463888">(</span><span class="ident" id="2463889">err</span>&nbsp;<span class="builtintype" id="2463893">error</span><span class="op" id="2463898">)</span>&nbsp;<span class="op" id="2463900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2463903">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2463959">*</span><span class="ident" id="2463960">t</span><span class="op" id="2463961">,</span>&nbsp;<span class="ident" id="2463963">err</span>&nbsp;<span class="op" id="2463967">=</span>&nbsp;<span class="ident" id="2463969">Parse</span><span class="op" id="2463974">(</span><span class="string" id="2463975">`&#34;`</span><span class="op" id="2463978">+</span><span class="ident" id="2463979">RFC3339</span><span class="op" id="2463986">+</span><span class="string" id="2463987">`&#34;`</span><span class="op" id="2463990">,</span>&nbsp;<span class="builtintype" id="2463992">string</span><span class="op" id="2463998">(</span><span class="ident" id="2463999">data</span><span class="op" id="2464003">)</span><span class="op" id="2464004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464007">return</span><br>
<span class="lineno"></span><span class="op" id="2464014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2464017">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno">950</span><span class="comment" id="2464081">//&nbsp;The&nbsp;time&nbsp;is&nbsp;formatted&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2464170">func</span>&nbsp;<span class="op" id="2464175">(</span><span class="ident" id="2464176">t</span>&nbsp;<span class="ident" id="2464178">Time</span><span class="op" id="2464182">)</span>&nbsp;<span class="ident" id="2464184">MarshalText</span><span class="op" id="2464195">(</span><span class="op" id="2464196">)</span>&nbsp;<span class="op" id="2464198">(</span><span class="op" id="2464199">[</span><span class="op" id="2464200">]</span><span class="builtintype" id="2464201">byte</span><span class="op" id="2464205">,</span>&nbsp;<span class="builtintype" id="2464207">error</span><span class="op" id="2464212">)</span>&nbsp;<span class="op" id="2464214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464217">if</span>&nbsp;<span class="ident" id="2464220">y</span>&nbsp;<span class="op" id="2464222">:=</span>&nbsp;<span class="ident" id="2464225">t</span><span class="op" id="2464226">.</span><span class="ident" id="2464227">Year</span><span class="op" id="2464231">(</span><span class="op" id="2464232">)</span><span class="op" id="2464233">;</span>&nbsp;<span class="ident" id="2464235">y</span>&nbsp;<span class="op" id="2464237">&lt;</span>&nbsp;<span class="num" id="2464239">0</span>&nbsp;<span class="op" id="2464241">||</span>&nbsp;<span class="ident" id="2464244">y</span>&nbsp;<span class="op" id="2464246">&gt;=</span>&nbsp;<span class="num" id="2464249">10000</span>&nbsp;<span class="op" id="2464255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464259">return</span>&nbsp;<span class="ident" id="2464266">nil</span><span class="op" id="2464269">,</span>&nbsp;<span class="ident" id="2464271">errors</span><span class="op" id="2464277">.</span><span class="ident" id="2464278">New</span><span class="op" id="2464281">(</span><span class="string" id="2464282">&#34;Time.MarshalText:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2464332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2464335">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464338">return</span>&nbsp;<span class="op" id="2464345">[</span><span class="op" id="2464346">]</span><span class="builtintype" id="2464347">byte</span><span class="op" id="2464351">(</span><span class="ident" id="2464352">t</span><span class="op" id="2464353">.</span><span class="ident" id="2464354">Format</span><span class="op" id="2464360">(</span><span class="ident" id="2464361">RFC3339Nano</span><span class="op" id="2464372">)</span><span class="op" id="2464373">)</span><span class="op" id="2464374">,</span>&nbsp;<span class="ident" id="2464376">nil</span><br>
<span class="lineno"></span><span class="op" id="2464380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2464383">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2464451">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno">960</span><span class="keyword" id="2464501">func</span>&nbsp;<span class="op" id="2464506">(</span><span class="ident" id="2464507">t</span>&nbsp;<span class="op" id="2464509">*</span><span class="ident" id="2464510">Time</span><span class="op" id="2464514">)</span>&nbsp;<span class="ident" id="2464516">UnmarshalText</span><span class="op" id="2464529">(</span><span class="ident" id="2464530">data</span>&nbsp;<span class="op" id="2464535">[</span><span class="op" id="2464536">]</span><span class="builtintype" id="2464537">byte</span><span class="op" id="2464541">)</span>&nbsp;<span class="op" id="2464543">(</span><span class="ident" id="2464544">err</span>&nbsp;<span class="builtintype" id="2464548">error</span><span class="op" id="2464553">)</span>&nbsp;<span class="op" id="2464555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2464558">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2464614">*</span><span class="ident" id="2464615">t</span><span class="op" id="2464616">,</span>&nbsp;<span class="ident" id="2464618">err</span>&nbsp;<span class="op" id="2464622">=</span>&nbsp;<span class="ident" id="2464624">Parse</span><span class="op" id="2464629">(</span><span class="ident" id="2464630">RFC3339</span><span class="op" id="2464637">,</span>&nbsp;<span class="builtintype" id="2464639">string</span><span class="op" id="2464645">(</span><span class="ident" id="2464646">data</span><span class="op" id="2464650">)</span><span class="op" id="2464651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464654">return</span><br>
<span class="lineno"></span><span class="op" id="2464661">}</span><br>
<span class="lineno">965</span><br>
<span class="lineno"></span><span class="comment" id="2464664">//&nbsp;Unix&nbsp;returns&nbsp;the&nbsp;local&nbsp;Time&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;given&nbsp;Unix&nbsp;time,</span><br>
<span class="lineno"></span><span class="comment" id="2464733">//&nbsp;sec&nbsp;seconds&nbsp;and&nbsp;nsec&nbsp;nanoseconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2464796">//&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;pass&nbsp;nsec&nbsp;outside&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2464858">func</span>&nbsp;<span class="ident" id="2464863">Unix</span><span class="op" id="2464867">(</span><span class="ident" id="2464868">sec</span>&nbsp;<span class="ident" id="2464872">int64</span><span class="op" id="2464877">,</span>&nbsp;<span class="ident" id="2464879">nsec</span>&nbsp;<span class="ident" id="2464884">int64</span><span class="op" id="2464889">)</span>&nbsp;<span class="ident" id="2464891">Time</span>&nbsp;<span class="op" id="2464896">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464899">if</span>&nbsp;<span class="ident" id="2464902">nsec</span>&nbsp;<span class="op" id="2464907">&lt;</span>&nbsp;<span class="num" id="2464909">0</span>&nbsp;<span class="op" id="2464911">||</span>&nbsp;<span class="ident" id="2464914">nsec</span>&nbsp;<span class="op" id="2464919">&gt;=</span>&nbsp;<span class="num" id="2464922">1e9</span>&nbsp;<span class="op" id="2464926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2464930">n</span>&nbsp;<span class="op" id="2464932">:=</span>&nbsp;<span class="ident" id="2464935">nsec</span>&nbsp;<span class="op" id="2464940">/</span>&nbsp;<span class="num" id="2464942">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2464948">sec</span>&nbsp;<span class="op" id="2464952">+=</span>&nbsp;<span class="ident" id="2464955">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2464959">nsec</span>&nbsp;<span class="op" id="2464964">-=</span>&nbsp;<span class="ident" id="2464967">n</span>&nbsp;<span class="op" id="2464969">*</span>&nbsp;<span class="num" id="2464971">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2464977">if</span>&nbsp;<span class="ident" id="2464980">nsec</span>&nbsp;<span class="op" id="2464985">&lt;</span>&nbsp;<span class="num" id="2464987">0</span>&nbsp;<span class="op" id="2464989">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2464994">nsec</span>&nbsp;<span class="op" id="2464999">+=</span>&nbsp;<span class="num" id="2465002">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465009">sec</span><span class="op" id="2465012">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2465017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2465020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2465023">return</span>&nbsp;<span class="ident" id="2465030">Time</span><span class="op" id="2465034">{</span><span class="ident" id="2465035">sec</span>&nbsp;<span class="op" id="2465039">+</span>&nbsp;<span class="ident" id="2465041">unixToInternal</span><span class="op" id="2465055">,</span>&nbsp;<span class="builtintype" id="2465057">int32</span><span class="op" id="2465062">(</span><span class="ident" id="2465063">nsec</span><span class="op" id="2465067">)</span><span class="op" id="2465068">,</span>&nbsp;<span class="ident" id="2465070">Local</span><span class="op" id="2465075">}</span><br>
<span class="lineno">980</span><span class="op" id="2465077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2465080">func</span>&nbsp;<span class="ident" id="2465085">isLeap</span><span class="op" id="2465091">(</span><span class="ident" id="2465092">year</span>&nbsp;<span class="builtintype" id="2465097">int</span><span class="op" id="2465100">)</span>&nbsp;<span class="builtintype" id="2465102">bool</span>&nbsp;<span class="op" id="2465107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2465110">return</span>&nbsp;<span class="ident" id="2465117">year</span><span class="op" id="2465121">%</span><span class="num" id="2465122">4</span>&nbsp;<span class="op" id="2465124">==</span>&nbsp;<span class="num" id="2465127">0</span>&nbsp;<span class="op" id="2465129">&amp;&amp;</span>&nbsp;<span class="op" id="2465132">(</span><span class="ident" id="2465133">year</span><span class="op" id="2465137">%</span><span class="num" id="2465138">100</span>&nbsp;<span class="op" id="2465142">!=</span>&nbsp;<span class="num" id="2465145">0</span>&nbsp;<span class="op" id="2465147">||</span>&nbsp;<span class="ident" id="2465150">year</span><span class="op" id="2465154">%</span><span class="num" id="2465155">400</span>&nbsp;<span class="op" id="2465159">==</span>&nbsp;<span class="num" id="2465162">0</span><span class="op" id="2465163">)</span><br>
<span class="lineno"></span><span class="op" id="2465165">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="2465168">//&nbsp;norm&nbsp;returns&nbsp;nhi,&nbsp;nlo&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2465203">//&nbsp;&nbsp;&nbsp;&nbsphi&nbsp;*&nbsp;base&nbsp;+&nbsp;lo&nbsp;==&nbsp;nhi&nbsp;*&nbsp;base&nbsp;+&nbsp;nlo</span><br>
<span class="lineno"></span><span class="comment" id="2465241">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&lt;=&nbsp;nlo&nbsp;&lt;&nbsp;base</span><br>
<span class="lineno"></span><span class="keyword" id="2465260">func</span>&nbsp;<span class="ident" id="2465265">norm</span><span class="op" id="2465269">(</span><span class="ident" id="2465270">hi</span><span class="op" id="2465272">,</span>&nbsp;<span class="ident" id="2465274">lo</span><span class="op" id="2465276">,</span>&nbsp;<span class="ident" id="2465278">base</span>&nbsp;<span class="builtintype" id="2465283">int</span><span class="op" id="2465286">)</span>&nbsp;<span class="op" id="2465288">(</span><span class="ident" id="2465289">nhi</span><span class="op" id="2465292">,</span>&nbsp;<span class="ident" id="2465294">nlo</span>&nbsp;<span class="builtintype" id="2465298">int</span><span class="op" id="2465301">)</span>&nbsp;<span class="op" id="2465303">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2465306">if</span>&nbsp;<span class="ident" id="2465309">lo</span>&nbsp;<span class="op" id="2465312">&lt;</span>&nbsp;<span class="num" id="2465314">0</span>&nbsp;<span class="op" id="2465316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465320">n</span>&nbsp;<span class="op" id="2465322">:=</span>&nbsp;<span class="op" id="2465325">(</span><span class="op" id="2465326">-</span><span class="ident" id="2465327">lo</span><span class="op" id="2465329">-</span><span class="num" id="2465330">1</span><span class="op" id="2465331">)</span><span class="op" id="2465332">/</span><span class="ident" id="2465333">base</span>&nbsp;<span class="op" id="2465338">+</span>&nbsp;<span class="num" id="2465340">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465344">hi</span>&nbsp;<span class="op" id="2465347">-=</span>&nbsp;<span class="ident" id="2465350">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465354">lo</span>&nbsp;<span class="op" id="2465357">+=</span>&nbsp;<span class="ident" id="2465360">n</span>&nbsp;<span class="op" id="2465362">*</span>&nbsp;<span class="ident" id="2465364">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2465370">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2465373">if</span>&nbsp;<span class="ident" id="2465376">lo</span>&nbsp;<span class="op" id="2465379">&gt;=</span>&nbsp;<span class="ident" id="2465382">base</span>&nbsp;<span class="op" id="2465387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465391">n</span>&nbsp;<span class="op" id="2465393">:=</span>&nbsp;<span class="ident" id="2465396">lo</span>&nbsp;<span class="op" id="2465399">/</span>&nbsp;<span class="ident" id="2465401">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465408">hi</span>&nbsp;<span class="op" id="2465411">+=</span>&nbsp;<span class="ident" id="2465414">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2465418">lo</span>&nbsp;<span class="op" id="2465421">-=</span>&nbsp;<span class="ident" id="2465424">n</span>&nbsp;<span class="op" id="2465426">*</span>&nbsp;<span class="ident" id="2465428">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2465434">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2465437">return</span>&nbsp;<span class="ident" id="2465444">hi</span><span class="op" id="2465446">,</span>&nbsp;<span class="ident" id="2465448">lo</span><br>
<span class="lineno"></span><span class="op" id="2465451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2465454">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;Time&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2465496">//&nbsp;&nbsp;&nbsp;&nbspyyyy-mm-dd&nbsp;hh:mm:ss&nbsp;+&nbsp;nsec&nbsp;nanoseconds</span><br>
<span class="lineno">1005</span><span class="comment" id="2465538">//&nbsp;in&nbsp;the&nbsp;appropriate&nbsp;zone&nbsp;for&nbsp;that&nbsp;time&nbsp;in&nbsp;the&nbsp;given&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="2465602">//</span><br>
<span class="lineno"></span><span class="comment" id="2465605">//&nbsp;The&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;min,&nbsp;sec,&nbsp;and&nbsp;nsec&nbsp;values&nbsp;may&nbsp;be&nbsp;outside</span><br>
<span class="lineno"></span><span class="comment" id="2465671">//&nbsp;their&nbsp;usual&nbsp;ranges&nbsp;and&nbsp;will&nbsp;be&nbsp;normalized&nbsp;during&nbsp;the&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2465739">//&nbsp;For&nbsp;example,&nbsp;October&nbsp;32&nbsp;converts&nbsp;to&nbsp;November&nbsp;1.</span><br>
<span class="lineno">1010</span><span class="comment" id="2465790">//</span><br>
<span class="lineno"></span><span class="comment" id="2465793">//&nbsp;A&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;transition&nbsp;skips&nbsp;or&nbsp;repeats&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2465855">//&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;United&nbsp;States,&nbsp;March&nbsp;13,&nbsp;2011&nbsp;2:15am&nbsp;never&nbsp;occurred,</span><br>
<span class="lineno"></span><span class="comment" id="2465931">//&nbsp;while&nbsp;November&nbsp;6,&nbsp;2011&nbsp;1:15am&nbsp;occurred&nbsp;twice.&nbsp;&nbsp;In&nbsp;such&nbsp;cases,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2466000">//&nbsp;choice&nbsp;of&nbsp;time&nbsp;zone,&nbsp;and&nbsp;therefore&nbsp;the&nbsp;time,&nbsp;is&nbsp;not&nbsp;well-defined.</span><br>
<span class="lineno">1015</span><span class="comment" id="2466069">//&nbsp;Date&nbsp;returns&nbsp;a&nbsp;time&nbsp;that&nbsp;is&nbsp;correct&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;zones&nbsp;involved</span><br>
<span class="lineno"></span><span class="comment" id="2466141">//&nbsp;in&nbsp;the&nbsp;transition,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;guarantee&nbsp;which.</span><br>
<span class="lineno"></span><span class="comment" id="2466196">//</span><br>
<span class="lineno"></span><span class="comment" id="2466199">//&nbsp;Date&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2466229">func</span>&nbsp;<span class="ident" id="2466234">Date</span><span class="op" id="2466238">(</span><span class="ident" id="2466239">year</span>&nbsp;<span class="builtintype" id="2466244">int</span><span class="op" id="2466247">,</span>&nbsp;<span class="ident" id="2466249">month</span>&nbsp;<span class="ident" id="2466255">Month</span><span class="op" id="2466260">,</span>&nbsp;<span class="ident" id="2466262">day</span><span class="op" id="2466265">,</span>&nbsp;<span class="ident" id="2466267">hour</span><span class="op" id="2466271">,</span>&nbsp;<span class="ident" id="2466273">min</span><span class="op" id="2466276">,</span>&nbsp;<span class="ident" id="2466278">sec</span><span class="op" id="2466281">,</span>&nbsp;<span class="ident" id="2466283">nsec</span>&nbsp;<span class="builtintype" id="2466288">int</span><span class="op" id="2466291">,</span>&nbsp;<span class="ident" id="2466293">loc</span>&nbsp;<span class="op" id="2466297">*</span><span class="ident" id="2466298">Location</span><span class="op" id="2466306">)</span>&nbsp;<span class="ident" id="2466308">Time</span>&nbsp;<span class="op" id="2466313">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2466316">if</span>&nbsp;<span class="ident" id="2466319">loc</span>&nbsp;<span class="op" id="2466323">==</span>&nbsp;<span class="ident" id="2466326">nil</span>&nbsp;<span class="op" id="2466330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2466334">panic</span><span class="op" id="2466339">(</span><span class="string" id="2466340">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Date&#34;</span><span class="op" id="2466380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2466383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466387">//&nbsp;Normalize&nbsp;month,&nbsp;overflowing&nbsp;into&nbsp;year.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466431">m</span>&nbsp;<span class="op" id="2466433">:=</span>&nbsp;<span class="builtintype" id="2466436">int</span><span class="op" id="2466439">(</span><span class="ident" id="2466440">month</span><span class="op" id="2466445">)</span>&nbsp;<span class="op" id="2466447">-</span>&nbsp;<span class="num" id="2466449">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466452">year</span><span class="op" id="2466456">,</span>&nbsp;<span class="ident" id="2466458">m</span>&nbsp;<span class="op" id="2466460">=</span>&nbsp;<span class="ident" id="2466462">norm</span><span class="op" id="2466466">(</span><span class="ident" id="2466467">year</span><span class="op" id="2466471">,</span>&nbsp;<span class="ident" id="2466473">m</span><span class="op" id="2466474">,</span>&nbsp;<span class="num" id="2466476">12</span><span class="op" id="2466478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466481">month</span>&nbsp;<span class="op" id="2466487">=</span>&nbsp;<span class="ident" id="2466489">Month</span><span class="op" id="2466494">(</span><span class="ident" id="2466495">m</span><span class="op" id="2466496">)</span>&nbsp;<span class="op" id="2466498">+</span>&nbsp;<span class="num" id="2466500">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466504">//&nbsp;Normalize&nbsp;nsec,&nbsp;sec,&nbsp;min,&nbsp;hour,&nbsp;overflowing&nbsp;into&nbsp;day.</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466562">sec</span><span class="op" id="2466565">,</span>&nbsp;<span class="ident" id="2466567">nsec</span>&nbsp;<span class="op" id="2466572">=</span>&nbsp;<span class="ident" id="2466574">norm</span><span class="op" id="2466578">(</span><span class="ident" id="2466579">sec</span><span class="op" id="2466582">,</span>&nbsp;<span class="ident" id="2466584">nsec</span><span class="op" id="2466588">,</span>&nbsp;<span class="num" id="2466590">1e9</span><span class="op" id="2466593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466596">min</span><span class="op" id="2466599">,</span>&nbsp;<span class="ident" id="2466601">sec</span>&nbsp;<span class="op" id="2466605">=</span>&nbsp;<span class="ident" id="2466607">norm</span><span class="op" id="2466611">(</span><span class="ident" id="2466612">min</span><span class="op" id="2466615">,</span>&nbsp;<span class="ident" id="2466617">sec</span><span class="op" id="2466620">,</span>&nbsp;<span class="num" id="2466622">60</span><span class="op" id="2466624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466627">hour</span><span class="op" id="2466631">,</span>&nbsp;<span class="ident" id="2466633">min</span>&nbsp;<span class="op" id="2466637">=</span>&nbsp;<span class="ident" id="2466639">norm</span><span class="op" id="2466643">(</span><span class="ident" id="2466644">hour</span><span class="op" id="2466648">,</span>&nbsp;<span class="ident" id="2466650">min</span><span class="op" id="2466653">,</span>&nbsp;<span class="num" id="2466655">60</span><span class="op" id="2466657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466660">day</span><span class="op" id="2466663">,</span>&nbsp;<span class="ident" id="2466665">hour</span>&nbsp;<span class="op" id="2466670">=</span>&nbsp;<span class="ident" id="2466672">norm</span><span class="op" id="2466676">(</span><span class="ident" id="2466677">day</span><span class="op" id="2466680">,</span>&nbsp;<span class="ident" id="2466682">hour</span><span class="op" id="2466686">,</span>&nbsp;<span class="num" id="2466688">24</span><span class="op" id="2466690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466694">y</span>&nbsp;<span class="op" id="2466696">:=</span>&nbsp;<span class="ident" id="2466699">uint64</span><span class="op" id="2466705">(</span><span class="ident" id="2466706">int64</span><span class="op" id="2466711">(</span><span class="ident" id="2466712">year</span><span class="op" id="2466716">)</span>&nbsp;<span class="op" id="2466718">-</span>&nbsp;<span class="ident" id="2466720">absoluteZeroYear</span><span class="op" id="2466736">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466740">//&nbsp;Compute&nbsp;days&nbsp;since&nbsp;the&nbsp;absolute&nbsp;epoch.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466784">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;from&nbsp;400-year&nbsp;cycles.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466822">n</span>&nbsp;<span class="op" id="2466824">:=</span>&nbsp;<span class="ident" id="2466827">y</span>&nbsp;<span class="op" id="2466829">/</span>&nbsp;<span class="num" id="2466831">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466836">y</span>&nbsp;<span class="op" id="2466838">-=</span>&nbsp;<span class="num" id="2466841">400</span>&nbsp;<span class="op" id="2466845">*</span>&nbsp;<span class="ident" id="2466847">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466850">d</span>&nbsp;<span class="op" id="2466852">:=</span>&nbsp;<span class="ident" id="2466855">daysPer400Years</span>&nbsp;<span class="op" id="2466871">*</span>&nbsp;<span class="ident" id="2466873">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466877">//&nbsp;Add&nbsp;in&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466905">n</span>&nbsp;<span class="op" id="2466907">=</span>&nbsp;<span class="ident" id="2466909">y</span>&nbsp;<span class="op" id="2466911">/</span>&nbsp;<span class="num" id="2466913">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466918">y</span>&nbsp;<span class="op" id="2466920">-=</span>&nbsp;<span class="num" id="2466923">100</span>&nbsp;<span class="op" id="2466927">*</span>&nbsp;<span class="ident" id="2466929">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466932">d</span>&nbsp;<span class="op" id="2466934">+=</span>&nbsp;<span class="ident" id="2466937">daysPer100Years</span>&nbsp;<span class="op" id="2466953">*</span>&nbsp;<span class="ident" id="2466955">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2466959">//&nbsp;Add&nbsp;in&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466985">n</span>&nbsp;<span class="op" id="2466987">=</span>&nbsp;<span class="ident" id="2466989">y</span>&nbsp;<span class="op" id="2466991">/</span>&nbsp;<span class="num" id="2466993">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2466996">y</span>&nbsp;<span class="op" id="2466998">-=</span>&nbsp;<span class="num" id="2467001">4</span>&nbsp;<span class="op" id="2467003">*</span>&nbsp;<span class="ident" id="2467005">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467008">d</span>&nbsp;<span class="op" id="2467010">+=</span>&nbsp;<span class="ident" id="2467013">daysPer4Years</span>&nbsp;<span class="op" id="2467027">*</span>&nbsp;<span class="ident" id="2467029">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467033">//&nbsp;Add&nbsp;in&nbsp;non-leap&nbsp;years.</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467060">n</span>&nbsp;<span class="op" id="2467062">=</span>&nbsp;<span class="ident" id="2467064">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467067">d</span>&nbsp;<span class="op" id="2467069">+=</span>&nbsp;<span class="num" id="2467072">365</span>&nbsp;<span class="op" id="2467076">*</span>&nbsp;<span class="ident" id="2467078">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467082">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;this&nbsp;month.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467117">d</span>&nbsp;<span class="op" id="2467119">+=</span>&nbsp;<span class="ident" id="2467122">uint64</span><span class="op" id="2467128">(</span><span class="ident" id="2467129">daysBefore</span><span class="op" id="2467139">[</span><span class="ident" id="2467140">month</span><span class="op" id="2467145">-</span><span class="num" id="2467146">1</span><span class="op" id="2467147">]</span><span class="op" id="2467148">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467151">if</span>&nbsp;<span class="ident" id="2467154">isLeap</span><span class="op" id="2467160">(</span><span class="ident" id="2467161">year</span><span class="op" id="2467165">)</span>&nbsp;<span class="op" id="2467167">&amp;&amp;</span>&nbsp;<span class="ident" id="2467170">month</span>&nbsp;<span class="op" id="2467176">&gt;=</span>&nbsp;<span class="ident" id="2467179">March</span>&nbsp;<span class="op" id="2467185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467189">d</span><span class="op" id="2467190">++</span>&nbsp;<span class="comment" id="2467193">//&nbsp;February&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2467209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467213">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;today.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467243">d</span>&nbsp;<span class="op" id="2467245">+=</span>&nbsp;<span class="ident" id="2467248">uint64</span><span class="op" id="2467254">(</span><span class="ident" id="2467255">day</span>&nbsp;<span class="op" id="2467259">-</span>&nbsp;<span class="num" id="2467261">1</span><span class="op" id="2467262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467266">//&nbsp;Add&nbsp;in&nbsp;time&nbsp;elapsed&nbsp;today.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467297">abs</span>&nbsp;<span class="op" id="2467301">:=</span>&nbsp;<span class="ident" id="2467304">d</span>&nbsp;<span class="op" id="2467306">*</span>&nbsp;<span class="ident" id="2467308">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467323">abs</span>&nbsp;<span class="op" id="2467327">+=</span>&nbsp;<span class="ident" id="2467330">uint64</span><span class="op" id="2467336">(</span><span class="ident" id="2467337">hour</span><span class="op" id="2467341">*</span><span class="ident" id="2467342">secondsPerHour</span>&nbsp;<span class="op" id="2467357">+</span>&nbsp;<span class="ident" id="2467359">min</span><span class="op" id="2467362">*</span><span class="ident" id="2467363">secondsPerMinute</span>&nbsp;<span class="op" id="2467380">+</span>&nbsp;<span class="ident" id="2467382">sec</span><span class="op" id="2467385">)</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467389">unix</span>&nbsp;<span class="op" id="2467394">:=</span>&nbsp;<span class="ident" id="2467397">int64</span><span class="op" id="2467402">(</span><span class="ident" id="2467403">abs</span><span class="op" id="2467406">)</span>&nbsp;<span class="op" id="2467408">+</span>&nbsp;<span class="op" id="2467410">(</span><span class="ident" id="2467411">absoluteToInternal</span>&nbsp;<span class="op" id="2467430">+</span>&nbsp;<span class="ident" id="2467432">internalToUnix</span><span class="op" id="2467446">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467450">//&nbsp;Look&nbsp;for&nbsp;zone&nbsp;offset&nbsp;for&nbsp;t,&nbsp;so&nbsp;we&nbsp;can&nbsp;adjust&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467507">//&nbsp;The&nbsp;lookup&nbsp;function&nbsp;expects&nbsp;UTC,&nbsp;so&nbsp;we&nbsp;pass&nbsp;t&nbsp;in&nbsp;the</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467564">//&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;too&nbsp;close&nbsp;to&nbsp;a&nbsp;zone&nbsp;transition,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2467625">//&nbsp;and&nbsp;then&nbsp;adjust&nbsp;if&nbsp;it&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467655">_</span><span class="op" id="2467656">,</span>&nbsp;<span class="ident" id="2467658">offset</span><span class="op" id="2467664">,</span>&nbsp;<span class="ident" id="2467666">_</span><span class="op" id="2467667">,</span>&nbsp;<span class="ident" id="2467669">start</span><span class="op" id="2467674">,</span>&nbsp;<span class="ident" id="2467676">end</span>&nbsp;<span class="op" id="2467680">:=</span>&nbsp;<span class="ident" id="2467683">loc</span><span class="op" id="2467686">.</span><span class="ident" id="2467687">lookup</span><span class="op" id="2467693">(</span><span class="ident" id="2467694">unix</span><span class="op" id="2467698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467701">if</span>&nbsp;<span class="ident" id="2467704">offset</span>&nbsp;<span class="op" id="2467711">!=</span>&nbsp;<span class="num" id="2467714">0</span>&nbsp;<span class="op" id="2467716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467720">switch</span>&nbsp;<span class="ident" id="2467727">utc</span>&nbsp;<span class="op" id="2467731">:=</span>&nbsp;<span class="ident" id="2467734">unix</span>&nbsp;<span class="op" id="2467739">-</span>&nbsp;<span class="ident" id="2467741">int64</span><span class="op" id="2467746">(</span><span class="ident" id="2467747">offset</span><span class="op" id="2467753">)</span><span class="op" id="2467754">;</span>&nbsp;<span class="op" id="2467756">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467760">case</span>&nbsp;<span class="ident" id="2467765">utc</span>&nbsp;<span class="op" id="2467769">&lt;</span>&nbsp;<span class="ident" id="2467771">start</span><span class="op" id="2467776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467781">_</span><span class="op" id="2467782">,</span>&nbsp;<span class="ident" id="2467784">offset</span><span class="op" id="2467790">,</span>&nbsp;<span class="ident" id="2467792">_</span><span class="op" id="2467793">,</span>&nbsp;<span class="ident" id="2467795">_</span><span class="op" id="2467796">,</span>&nbsp;<span class="ident" id="2467798">_</span>&nbsp;<span class="op" id="2467800">=</span>&nbsp;<span class="ident" id="2467802">loc</span><span class="op" id="2467805">.</span><span class="ident" id="2467806">lookup</span><span class="op" id="2467812">(</span><span class="ident" id="2467813">start</span>&nbsp;<span class="op" id="2467819">-</span>&nbsp;<span class="num" id="2467821">1</span><span class="op" id="2467822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467826">case</span>&nbsp;<span class="ident" id="2467831">utc</span>&nbsp;<span class="op" id="2467835">&gt;=</span>&nbsp;<span class="ident" id="2467838">end</span><span class="op" id="2467841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467846">_</span><span class="op" id="2467847">,</span>&nbsp;<span class="ident" id="2467849">offset</span><span class="op" id="2467855">,</span>&nbsp;<span class="ident" id="2467857">_</span><span class="op" id="2467858">,</span>&nbsp;<span class="ident" id="2467860">_</span><span class="op" id="2467861">,</span>&nbsp;<span class="ident" id="2467863">_</span>&nbsp;<span class="op" id="2467865">=</span>&nbsp;<span class="ident" id="2467867">loc</span><span class="op" id="2467870">.</span><span class="ident" id="2467871">lookup</span><span class="op" id="2467877">(</span><span class="ident" id="2467878">end</span><span class="op" id="2467881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2467885">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2467889">unix</span>&nbsp;<span class="op" id="2467894">-=</span>&nbsp;<span class="ident" id="2467897">int64</span><span class="op" id="2467902">(</span><span class="ident" id="2467903">offset</span><span class="op" id="2467909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2467912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2467916">return</span>&nbsp;<span class="ident" id="2467923">Time</span><span class="op" id="2467927">{</span><span class="ident" id="2467928">unix</span>&nbsp;<span class="op" id="2467933">+</span>&nbsp;<span class="ident" id="2467935">unixToInternal</span><span class="op" id="2467949">,</span>&nbsp;<span class="builtintype" id="2467951">int32</span><span class="op" id="2467956">(</span><span class="ident" id="2467957">nsec</span><span class="op" id="2467961">)</span><span class="op" id="2467962">,</span>&nbsp;<span class="ident" id="2467964">loc</span><span class="op" id="2467967">}</span><br>
<span class="lineno"></span><span class="op" id="2467969">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="2467972">//&nbsp;Truncate&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;down&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2468064">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Truncate&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2468108">func</span>&nbsp;<span class="op" id="2468113">(</span><span class="ident" id="2468114">t</span>&nbsp;<span class="ident" id="2468116">Time</span><span class="op" id="2468120">)</span>&nbsp;<span class="ident" id="2468122">Truncate</span><span class="op" id="2468130">(</span><span class="ident" id="2468131">d</span>&nbsp;<span class="ident" id="2468133">Duration</span><span class="op" id="2468141">)</span>&nbsp;<span class="ident" id="2468143">Time</span>&nbsp;<span class="op" id="2468148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468151">if</span>&nbsp;<span class="ident" id="2468154">d</span>&nbsp;<span class="op" id="2468156">&lt;=</span>&nbsp;<span class="num" id="2468159">0</span>&nbsp;<span class="op" id="2468161">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468165">return</span>&nbsp;<span class="ident" id="2468172">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2468175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468178">_</span><span class="op" id="2468179">,</span>&nbsp;<span class="ident" id="2468181">r</span>&nbsp;<span class="op" id="2468183">:=</span>&nbsp;<span class="ident" id="2468186">div</span><span class="op" id="2468189">(</span><span class="ident" id="2468190">t</span><span class="op" id="2468191">,</span>&nbsp;<span class="ident" id="2468193">d</span><span class="op" id="2468194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468197">return</span>&nbsp;<span class="ident" id="2468204">t</span><span class="op" id="2468205">.</span><span class="ident" id="2468206">Add</span><span class="op" id="2468209">(</span><span class="op" id="2468210">-</span><span class="ident" id="2468211">r</span><span class="op" id="2468212">)</span><br>
<span class="lineno"></span><span class="op" id="2468214">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="comment" id="2468217">//&nbsp;Round&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2468311">//&nbsp;The&nbsp;rounding&nbsp;behavior&nbsp;for&nbsp;halfway&nbsp;values&nbsp;is&nbsp;to&nbsp;round&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="2468371">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Round&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2468412">func</span>&nbsp;<span class="op" id="2468417">(</span><span class="ident" id="2468418">t</span>&nbsp;<span class="ident" id="2468420">Time</span><span class="op" id="2468424">)</span>&nbsp;<span class="ident" id="2468426">Round</span><span class="op" id="2468431">(</span><span class="ident" id="2468432">d</span>&nbsp;<span class="ident" id="2468434">Duration</span><span class="op" id="2468442">)</span>&nbsp;<span class="ident" id="2468444">Time</span>&nbsp;<span class="op" id="2468449">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468452">if</span>&nbsp;<span class="ident" id="2468455">d</span>&nbsp;<span class="op" id="2468457">&lt;=</span>&nbsp;<span class="num" id="2468460">0</span>&nbsp;<span class="op" id="2468462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468466">return</span>&nbsp;<span class="ident" id="2468473">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2468476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468479">_</span><span class="op" id="2468480">,</span>&nbsp;<span class="ident" id="2468482">r</span>&nbsp;<span class="op" id="2468484">:=</span>&nbsp;<span class="ident" id="2468487">div</span><span class="op" id="2468490">(</span><span class="ident" id="2468491">t</span><span class="op" id="2468492">,</span>&nbsp;<span class="ident" id="2468494">d</span><span class="op" id="2468495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468498">if</span>&nbsp;<span class="ident" id="2468501">r</span><span class="op" id="2468502">+</span><span class="ident" id="2468503">r</span>&nbsp;<span class="op" id="2468505">&lt;</span>&nbsp;<span class="ident" id="2468507">d</span>&nbsp;<span class="op" id="2468509">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468513">return</span>&nbsp;<span class="ident" id="2468520">t</span><span class="op" id="2468521">.</span><span class="ident" id="2468522">Add</span><span class="op" id="2468525">(</span><span class="op" id="2468526">-</span><span class="ident" id="2468527">r</span><span class="op" id="2468528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2468531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468534">return</span>&nbsp;<span class="ident" id="2468541">t</span><span class="op" id="2468542">.</span><span class="ident" id="2468543">Add</span><span class="op" id="2468546">(</span><span class="ident" id="2468547">d</span>&nbsp;<span class="op" id="2468549">-</span>&nbsp;<span class="ident" id="2468551">r</span><span class="op" id="2468552">)</span><br>
<span class="lineno"></span><span class="op" id="2468554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2468557">//&nbsp;div&nbsp;divides&nbsp;t&nbsp;by&nbsp;d&nbsp;and&nbsp;returns&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;and&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2468626">//&nbsp;We&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;anymore&nbsp;(round&nbsp;half&nbsp;up&nbsp;instead&nbsp;of&nbsp;round&nbsp;to&nbsp;even)</span><br>
<span class="lineno"></span><span class="comment" id="2468711">//&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;here&nbsp;in&nbsp;case&nbsp;we&nbsp;change&nbsp;our&nbsp;minds.</span><br>
<span class="lineno"></span><span class="keyword" id="2468763">func</span>&nbsp;<span class="ident" id="2468768">div</span><span class="op" id="2468771">(</span><span class="ident" id="2468772">t</span>&nbsp;<span class="ident" id="2468774">Time</span><span class="op" id="2468778">,</span>&nbsp;<span class="ident" id="2468780">d</span>&nbsp;<span class="ident" id="2468782">Duration</span><span class="op" id="2468790">)</span>&nbsp;<span class="op" id="2468792">(</span><span class="ident" id="2468793">qmod2</span>&nbsp;<span class="builtintype" id="2468799">int</span><span class="op" id="2468802">,</span>&nbsp;<span class="ident" id="2468804">r</span>&nbsp;<span class="ident" id="2468806">Duration</span><span class="op" id="2468814">)</span>&nbsp;<span class="op" id="2468816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468819">neg</span>&nbsp;<span class="op" id="2468823">:=</span>&nbsp;<span class="builtintype" id="2468826">false</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468833">nsec</span>&nbsp;<span class="op" id="2468838">:=</span>&nbsp;<span class="builtintype" id="2468841">int32</span><span class="op" id="2468846">(</span><span class="ident" id="2468847">t</span><span class="op" id="2468848">.</span><span class="ident" id="2468849">nsec</span><span class="op" id="2468853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468856">if</span>&nbsp;<span class="ident" id="2468859">t</span><span class="op" id="2468860">.</span><span class="ident" id="2468861">sec</span>&nbsp;<span class="op" id="2468865">&lt;</span>&nbsp;<span class="num" id="2468867">0</span>&nbsp;<span class="op" id="2468869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2468873">//&nbsp;Operate&nbsp;on&nbsp;absolute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468905">neg</span>&nbsp;<span class="op" id="2468909">=</span>&nbsp;<span class="builtintype" id="2468911">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468918">t</span><span class="op" id="2468919">.</span><span class="ident" id="2468920">sec</span>&nbsp;<span class="op" id="2468924">=</span>&nbsp;<span class="op" id="2468926">-</span><span class="ident" id="2468927">t</span><span class="op" id="2468928">.</span><span class="ident" id="2468929">sec</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468935">nsec</span>&nbsp;<span class="op" id="2468940">=</span>&nbsp;<span class="op" id="2468942">-</span><span class="ident" id="2468943">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2468950">if</span>&nbsp;<span class="ident" id="2468953">nsec</span>&nbsp;<span class="op" id="2468958">&lt;</span>&nbsp;<span class="num" id="2468960">0</span>&nbsp;<span class="op" id="2468962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468967">nsec</span>&nbsp;<span class="op" id="2468972">+=</span>&nbsp;<span class="num" id="2468975">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2468982">t</span><span class="op" id="2468983">.</span><span class="ident" id="2468984">sec</span><span class="op" id="2468987">--</span>&nbsp;<span class="comment" id="2468990">//&nbsp;t.sec&nbsp;&gt;=&nbsp;1&nbsp;before&nbsp;the&nbsp;--&nbsp;so&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2469028">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2469031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469035">switch</span>&nbsp;<span class="op" id="2469042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469045">//&nbsp;Special&nbsp;case:&nbsp;2d&nbsp;divides&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469084">case</span>&nbsp;<span class="ident" id="2469089">d</span>&nbsp;<span class="op" id="2469091">&lt;</span>&nbsp;<span class="ident" id="2469093">Second</span>&nbsp;<span class="op" id="2469100">&amp;&amp;</span>&nbsp;<span class="ident" id="2469103">Second</span><span class="op" id="2469109">%</span><span class="op" id="2469110">(</span><span class="ident" id="2469111">d</span><span class="op" id="2469112">+</span><span class="ident" id="2469113">d</span><span class="op" id="2469114">)</span>&nbsp;<span class="op" id="2469116">==</span>&nbsp;<span class="num" id="2469119">0</span><span class="op" id="2469120">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469124">qmod2</span>&nbsp;<span class="op" id="2469130">=</span>&nbsp;<span class="builtintype" id="2469132">int</span><span class="op" id="2469135">(</span><span class="ident" id="2469136">nsec</span><span class="op" id="2469140">/</span><span class="builtintype" id="2469141">int32</span><span class="op" id="2469146">(</span><span class="ident" id="2469147">d</span><span class="op" id="2469148">)</span><span class="op" id="2469149">)</span>&nbsp;<span class="op" id="2469151">&amp;</span>&nbsp;<span class="num" id="2469153">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469157">r</span>&nbsp;<span class="op" id="2469159">=</span>&nbsp;<span class="ident" id="2469161">Duration</span><span class="op" id="2469169">(</span><span class="ident" id="2469170">nsec</span>&nbsp;<span class="op" id="2469175">%</span>&nbsp;<span class="builtintype" id="2469177">int32</span><span class="op" id="2469182">(</span><span class="ident" id="2469183">d</span><span class="op" id="2469184">)</span><span class="op" id="2469185">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469189">//&nbsp;Special&nbsp;case:&nbsp;d&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469236">case</span>&nbsp;<span class="ident" id="2469241">d</span><span class="op" id="2469242">%</span><span class="ident" id="2469243">Second</span>&nbsp;<span class="op" id="2469250">==</span>&nbsp;<span class="num" id="2469253">0</span><span class="op" id="2469254">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469258">d1</span>&nbsp;<span class="op" id="2469261">:=</span>&nbsp;<span class="ident" id="2469264">int64</span><span class="op" id="2469269">(</span><span class="ident" id="2469270">d</span>&nbsp;<span class="op" id="2469272">/</span>&nbsp;<span class="ident" id="2469274">Second</span><span class="op" id="2469280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469284">qmod2</span>&nbsp;<span class="op" id="2469290">=</span>&nbsp;<span class="builtintype" id="2469292">int</span><span class="op" id="2469295">(</span><span class="ident" id="2469296">t</span><span class="op" id="2469297">.</span><span class="ident" id="2469298">sec</span><span class="op" id="2469301">/</span><span class="ident" id="2469302">d1</span><span class="op" id="2469304">)</span>&nbsp;<span class="op" id="2469306">&amp;</span>&nbsp;<span class="num" id="2469308">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469312">r</span>&nbsp;<span class="op" id="2469314">=</span>&nbsp;<span class="ident" id="2469316">Duration</span><span class="op" id="2469324">(</span><span class="ident" id="2469325">t</span><span class="op" id="2469326">.</span><span class="ident" id="2469327">sec</span><span class="op" id="2469330">%</span><span class="ident" id="2469331">d1</span><span class="op" id="2469333">)</span><span class="op" id="2469334">*</span><span class="ident" id="2469335">Second</span>&nbsp;<span class="op" id="2469342">+</span>&nbsp;<span class="ident" id="2469344">Duration</span><span class="op" id="2469352">(</span><span class="ident" id="2469353">nsec</span><span class="op" id="2469357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469361">//&nbsp;General&nbsp;case.</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469379">//&nbsp;This&nbsp;could&nbsp;be&nbsp;faster&nbsp;if&nbsp;more&nbsp;cleverness&nbsp;were&nbsp;applied,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469437">//&nbsp;but&nbsp;it&#39;s&nbsp;really&nbsp;only&nbsp;here&nbsp;to&nbsp;avoid&nbsp;special&nbsp;case&nbsp;restrictions&nbsp;in&nbsp;the&nbsp;API.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469514">//&nbsp;No&nbsp;one&nbsp;will&nbsp;care&nbsp;about&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469554">default</span><span class="op" id="2469561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469565">//&nbsp;Compute&nbsp;nanoseconds&nbsp;as&nbsp;128-bit&nbsp;number.</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469609">sec</span>&nbsp;<span class="op" id="2469613">:=</span>&nbsp;<span class="ident" id="2469616">uint64</span><span class="op" id="2469622">(</span><span class="ident" id="2469623">t</span><span class="op" id="2469624">.</span><span class="ident" id="2469625">sec</span><span class="op" id="2469628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469632">tmp</span>&nbsp;<span class="op" id="2469636">:=</span>&nbsp;<span class="op" id="2469639">(</span><span class="ident" id="2469640">sec</span>&nbsp;<span class="op" id="2469644">&gt;&gt;</span>&nbsp;<span class="num" id="2469647">32</span><span class="op" id="2469649">)</span>&nbsp;<span class="op" id="2469651">*</span>&nbsp;<span class="num" id="2469653">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469659">u1</span>&nbsp;<span class="op" id="2469662">:=</span>&nbsp;<span class="ident" id="2469665">tmp</span>&nbsp;<span class="op" id="2469669">&gt;&gt;</span>&nbsp;<span class="num" id="2469672">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469677">u0</span>&nbsp;<span class="op" id="2469680">:=</span>&nbsp;<span class="ident" id="2469683">tmp</span>&nbsp;<span class="op" id="2469687">&lt;&lt;</span>&nbsp;<span class="num" id="2469690">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469695">tmp</span>&nbsp;<span class="op" id="2469699">=</span>&nbsp;<span class="ident" id="2469701">uint64</span><span class="op" id="2469707">(</span><span class="ident" id="2469708">sec</span><span class="op" id="2469711">&amp;</span><span class="num" id="2469712">0xFFFFFFFF</span><span class="op" id="2469722">)</span>&nbsp;<span class="op" id="2469724">*</span>&nbsp;<span class="num" id="2469726">1e9</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469732">u0x</span><span class="op" id="2469735">,</span>&nbsp;<span class="ident" id="2469737">u0</span>&nbsp;<span class="op" id="2469740">:=</span>&nbsp;<span class="ident" id="2469743">u0</span><span class="op" id="2469745">,</span>&nbsp;<span class="ident" id="2469747">u0</span><span class="op" id="2469749">+</span><span class="ident" id="2469750">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469756">if</span>&nbsp;<span class="ident" id="2469759">u0</span>&nbsp;<span class="op" id="2469762">&lt;</span>&nbsp;<span class="ident" id="2469764">u0x</span>&nbsp;<span class="op" id="2469768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469773">u1</span><span class="op" id="2469775">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2469780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469784">u0x</span><span class="op" id="2469787">,</span>&nbsp;<span class="ident" id="2469789">u0</span>&nbsp;<span class="op" id="2469792">=</span>&nbsp;<span class="ident" id="2469794">u0</span><span class="op" id="2469796">,</span>&nbsp;<span class="ident" id="2469798">u0</span><span class="op" id="2469800">+</span><span class="ident" id="2469801">uint64</span><span class="op" id="2469807">(</span><span class="ident" id="2469808">nsec</span><span class="op" id="2469812">)</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469816">if</span>&nbsp;<span class="ident" id="2469819">u0</span>&nbsp;<span class="op" id="2469822">&lt;</span>&nbsp;<span class="ident" id="2469824">u0x</span>&nbsp;<span class="op" id="2469828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469833">u1</span><span class="op" id="2469835">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2469840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469845">//&nbsp;Compute&nbsp;remainder&nbsp;by&nbsp;subtracting&nbsp;r&lt;&lt;k&nbsp;for&nbsp;decreasing&nbsp;k.</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2469906">//&nbsp;Quotient&nbsp;parity&nbsp;is&nbsp;whether&nbsp;we&nbsp;subtract&nbsp;on&nbsp;last&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2469965">d1</span>&nbsp;<span class="op" id="2469968">:=</span>&nbsp;<span class="ident" id="2469971">uint64</span><span class="op" id="2469977">(</span><span class="ident" id="2469978">d</span><span class="op" id="2469979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2469983">for</span>&nbsp;<span class="ident" id="2469987">d1</span><span class="op" id="2469989">&gt;&gt;</span><span class="num" id="2469991">63</span>&nbsp;<span class="op" id="2469994">!=</span>&nbsp;<span class="num" id="2469997">1</span>&nbsp;<span class="op" id="2469999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470004">d1</span>&nbsp;<span class="op" id="2470007">&lt;&lt;=</span>&nbsp;<span class="num" id="2470011">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470015">}</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470019">d0</span>&nbsp;<span class="op" id="2470022">:=</span>&nbsp;<span class="ident" id="2470025">uint64</span><span class="op" id="2470031">(</span><span class="num" id="2470032">0</span><span class="op" id="2470033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470037">for</span>&nbsp;<span class="op" id="2470041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470046">qmod2</span>&nbsp;<span class="op" id="2470052">=</span>&nbsp;<span class="num" id="2470054">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470059">if</span>&nbsp;<span class="ident" id="2470062">u1</span>&nbsp;<span class="op" id="2470065">&gt;</span>&nbsp;<span class="ident" id="2470067">d1</span>&nbsp;<span class="op" id="2470070">||</span>&nbsp;<span class="ident" id="2470073">u1</span>&nbsp;<span class="op" id="2470076">==</span>&nbsp;<span class="ident" id="2470079">d1</span>&nbsp;<span class="op" id="2470082">&amp;&amp;</span>&nbsp;<span class="ident" id="2470085">u0</span>&nbsp;<span class="op" id="2470088">&gt;=</span>&nbsp;<span class="ident" id="2470091">d0</span>&nbsp;<span class="op" id="2470094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470100">//&nbsp;subtract</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470116">qmod2</span>&nbsp;<span class="op" id="2470122">=</span>&nbsp;<span class="num" id="2470124">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470130">u0x</span><span class="op" id="2470133">,</span>&nbsp;<span class="ident" id="2470135">u0</span>&nbsp;<span class="op" id="2470138">=</span>&nbsp;<span class="ident" id="2470140">u0</span><span class="op" id="2470142">,</span>&nbsp;<span class="ident" id="2470144">u0</span><span class="op" id="2470146">-</span><span class="ident" id="2470147">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470154">if</span>&nbsp;<span class="ident" id="2470157">u0</span>&nbsp;<span class="op" id="2470160">&gt;</span>&nbsp;<span class="ident" id="2470162">u0x</span>&nbsp;<span class="op" id="2470166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470173">u1</span><span class="op" id="2470175">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470182">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470188">u1</span>&nbsp;<span class="op" id="2470191">-=</span>&nbsp;<span class="ident" id="2470194">d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470205">if</span>&nbsp;<span class="ident" id="2470208">d1</span>&nbsp;<span class="op" id="2470211">==</span>&nbsp;<span class="num" id="2470214">0</span>&nbsp;<span class="op" id="2470216">&amp;&amp;</span>&nbsp;<span class="ident" id="2470219">d0</span>&nbsp;<span class="op" id="2470222">==</span>&nbsp;<span class="ident" id="2470225">uint64</span><span class="op" id="2470231">(</span><span class="ident" id="2470232">d</span><span class="op" id="2470233">)</span>&nbsp;<span class="op" id="2470235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470241">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470250">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470255">d0</span>&nbsp;<span class="op" id="2470258">&gt;&gt;=</span>&nbsp;<span class="num" id="2470262">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470267">d0</span>&nbsp;<span class="op" id="2470270">|=</span>&nbsp;<span class="op" id="2470273">(</span><span class="ident" id="2470274">d1</span>&nbsp;<span class="op" id="2470277">&amp;</span>&nbsp;<span class="num" id="2470279">1</span><span class="op" id="2470280">)</span>&nbsp;<span class="op" id="2470282">&lt;&lt;</span>&nbsp;<span class="num" id="2470285">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470291">d1</span>&nbsp;<span class="op" id="2470294">&gt;&gt;=</span>&nbsp;<span class="num" id="2470298">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470306">r</span>&nbsp;<span class="op" id="2470308">=</span>&nbsp;<span class="ident" id="2470310">Duration</span><span class="op" id="2470318">(</span><span class="ident" id="2470319">u0</span><span class="op" id="2470321">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470328">if</span>&nbsp;<span class="ident" id="2470331">neg</span>&nbsp;<span class="op" id="2470335">&amp;&amp;</span>&nbsp;<span class="ident" id="2470338">r</span>&nbsp;<span class="op" id="2470340">!=</span>&nbsp;<span class="num" id="2470343">0</span>&nbsp;<span class="op" id="2470345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470349">//&nbsp;If&nbsp;input&nbsp;was&nbsp;negative&nbsp;and&nbsp;not&nbsp;an&nbsp;exact&nbsp;multiple&nbsp;of&nbsp;d,&nbsp;we&nbsp;computed&nbsp;q,&nbsp;r&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470435">//&nbsp;&nbsp;&nbsp;&nbspq*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470453">//&nbsp;But&nbsp;the&nbsp;right&nbsp;answers&nbsp;are&nbsp;given&nbsp;by&nbsp;-(q-1),&nbsp;d-r:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470506">//&nbsp;&nbsp;&nbsp;&nbspq*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470524">//&nbsp;&nbsp;&nbsp;&nbsp-q*d&nbsp;-&nbsp;r&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2470542">//&nbsp;&nbsp;&nbsp;&nbsp-(q-1)*d&nbsp;+&nbsp;(d&nbsp;-&nbsp;r)&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470570">qmod2</span>&nbsp;<span class="op" id="2470576">^=</span>&nbsp;<span class="num" id="2470579">1</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2470583">r</span>&nbsp;<span class="op" id="2470585">=</span>&nbsp;<span class="ident" id="2470587">d</span>&nbsp;<span class="op" id="2470589">-</span>&nbsp;<span class="ident" id="2470591">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2470594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2470597">return</span><br>
<span class="lineno"></span><span class="op" id="2470604">}</span>
</div>
</body>
</html>
