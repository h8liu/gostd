<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4106759">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4106814">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4106868">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4106919">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4106989">package</span>&nbsp;<span class="ident" id="4106997">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4107003">import</span>&nbsp;<span class="op" id="4107010">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107013">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107022">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107028">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4107038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4107041">var</span>&nbsp;<span class="ident" id="4107045">typeFiles</span>&nbsp;<span class="op" id="4107055">=</span>&nbsp;<span class="op" id="4107057">[</span><span class="op" id="4107058">]</span><span class="builtintype" id="4107059">string</span><span class="op" id="4107065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107068">&#34;/etc/mime.types&#34;</span><span class="op" id="4107085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107088">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="4107113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107116">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="4107140">,</span><br>
<span class="lineno"></span><span class="op" id="4107142">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4107145">func</span>&nbsp;<span class="ident" id="4107150">loadMimeFile</span><span class="op" id="4107162">(</span><span class="ident" id="4107163">filename</span>&nbsp;<span class="builtintype" id="4107172">string</span><span class="op" id="4107178">)</span>&nbsp;<span class="op" id="4107180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107183">f</span><span class="op" id="4107184">,</span>&nbsp;<span class="ident" id="4107186">err</span>&nbsp;<span class="op" id="4107190">:=</span>&nbsp;<span class="ident" id="4107193">os</span><span class="op" id="4107195">.</span><span class="ident" id="4107196">Open</span><span class="op" id="4107200">(</span><span class="ident" id="4107201">filename</span><span class="op" id="4107209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107212">if</span>&nbsp;<span class="ident" id="4107215">err</span>&nbsp;<span class="op" id="4107219">!=</span>&nbsp;<span class="ident" id="4107222">nil</span>&nbsp;<span class="op" id="4107226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107230">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107241">defer</span>&nbsp;<span class="ident" id="4107247">f</span><span class="op" id="4107248">.</span><span class="ident" id="4107249">Close</span><span class="op" id="4107254">(</span><span class="op" id="4107255">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107259">scanner</span>&nbsp;<span class="op" id="4107267">:=</span>&nbsp;<span class="ident" id="4107270">bufio</span><span class="op" id="4107275">.</span><span class="ident" id="4107276">NewScanner</span><span class="op" id="4107286">(</span><span class="ident" id="4107287">f</span><span class="op" id="4107288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107291">for</span>&nbsp;<span class="ident" id="4107295">scanner</span><span class="op" id="4107302">.</span><span class="ident" id="4107303">Scan</span><span class="op" id="4107307">(</span><span class="op" id="4107308">)</span>&nbsp;<span class="op" id="4107310">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107314">fields</span>&nbsp;<span class="op" id="4107321">:=</span>&nbsp;<span class="ident" id="4107324">strings</span><span class="op" id="4107331">.</span><span class="ident" id="4107332">Fields</span><span class="op" id="4107338">(</span><span class="ident" id="4107339">scanner</span><span class="op" id="4107346">.</span><span class="ident" id="4107347">Text</span><span class="op" id="4107351">(</span><span class="op" id="4107352">)</span><span class="op" id="4107353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107357">if</span>&nbsp;<span class="builtinfunc" id="4107360">len</span><span class="op" id="4107363">(</span><span class="ident" id="4107364">fields</span><span class="op" id="4107370">)</span>&nbsp;<span class="op" id="4107372">&lt;=</span>&nbsp;<span class="num" id="4107375">1</span>&nbsp;<span class="op" id="4107377">||</span>&nbsp;<span class="ident" id="4107380">fields</span><span class="op" id="4107386">[</span><span class="num" id="4107387">0</span><span class="op" id="4107388">]</span><span class="op" id="4107389">[</span><span class="num" id="4107390">0</span><span class="op" id="4107391">]</span>&nbsp;<span class="op" id="4107393">==</span>&nbsp;<span class="string" id="4107396">&#39;#&#39;</span>&nbsp;<span class="op" id="4107400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107405">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107420">mimeType</span>&nbsp;<span class="op" id="4107429">:=</span>&nbsp;<span class="ident" id="4107432">fields</span><span class="op" id="4107438">[</span><span class="num" id="4107439">0</span><span class="op" id="4107440">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107444">for</span>&nbsp;<span class="ident" id="4107448">_</span><span class="op" id="4107449">,</span>&nbsp;<span class="ident" id="4107451">ext</span>&nbsp;<span class="op" id="4107455">:=</span>&nbsp;<span class="keyword" id="4107458">range</span>&nbsp;<span class="ident" id="4107464">fields</span><span class="op" id="4107470">[</span><span class="num" id="4107471">1</span><span class="op" id="4107472">:</span><span class="op" id="4107473">]</span>&nbsp;<span class="op" id="4107475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107480">if</span>&nbsp;<span class="ident" id="4107483">ext</span><span class="op" id="4107486">[</span><span class="num" id="4107487">0</span><span class="op" id="4107488">]</span>&nbsp;<span class="op" id="4107490">==</span>&nbsp;<span class="string" id="4107493">&#39;#&#39;</span>&nbsp;<span class="op" id="4107497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107503">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107517">setExtensionType</span><span class="op" id="4107533">(</span><span class="string" id="4107534">&#34;.&#34;</span><span class="op" id="4107537">+</span><span class="ident" id="4107538">ext</span><span class="op" id="4107541">,</span>&nbsp;<span class="ident" id="4107543">mimeType</span><span class="op" id="4107551">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107561">if</span>&nbsp;<span class="ident" id="4107564">err</span>&nbsp;<span class="op" id="4107568">:=</span>&nbsp;<span class="ident" id="4107571">scanner</span><span class="op" id="4107578">.</span><span class="ident" id="4107579">Err</span><span class="op" id="4107582">(</span><span class="op" id="4107583">)</span><span class="op" id="4107584">;</span>&nbsp;<span class="ident" id="4107586">err</span>&nbsp;<span class="op" id="4107590">!=</span>&nbsp;<span class="ident" id="4107593">nil</span>&nbsp;<span class="op" id="4107597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4107601">panic</span><span class="op" id="4107606">(</span><span class="ident" id="4107607">err</span><span class="op" id="4107610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107613">}</span><br>
<span class="lineno">45</span><span class="op" id="4107615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4107618">func</span>&nbsp;<span class="ident" id="4107623">initMime</span><span class="op" id="4107631">(</span><span class="op" id="4107632">)</span>&nbsp;<span class="op" id="4107634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107637">for</span>&nbsp;<span class="ident" id="4107641">_</span><span class="op" id="4107642">,</span>&nbsp;<span class="ident" id="4107644">filename</span>&nbsp;<span class="op" id="4107653">:=</span>&nbsp;<span class="keyword" id="4107656">range</span>&nbsp;<span class="ident" id="4107662">typeFiles</span>&nbsp;<span class="op" id="4107672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107676">loadMimeFile</span><span class="op" id="4107688">(</span><span class="ident" id="4107689">filename</span><span class="op" id="4107697">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107700">}</span><br>
<span class="lineno"></span><span class="op" id="4107702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4107705">func</span>&nbsp;<span class="ident" id="4107710">initMimeForTests</span><span class="op" id="4107726">(</span><span class="op" id="4107727">)</span>&nbsp;<span class="keyword" id="4107729">map</span><span class="op" id="4107732">[</span><span class="builtintype" id="4107733">string</span><span class="op" id="4107739">]</span><span class="builtintype" id="4107740">string</span>&nbsp;<span class="op" id="4107747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107750">typeFiles</span>&nbsp;<span class="op" id="4107760">=</span>&nbsp;<span class="op" id="4107762">[</span><span class="op" id="4107763">]</span><span class="builtintype" id="4107764">string</span><span class="op" id="4107770">{</span><span class="string" id="4107771">&#34;testdata/test.types&#34;</span><span class="op" id="4107792">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107795">return</span>&nbsp;<span class="keyword" id="4107802">map</span><span class="op" id="4107805">[</span><span class="builtintype" id="4107806">string</span><span class="op" id="4107812">]</span><span class="builtintype" id="4107813">string</span><span class="op" id="4107819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107823">&#34;.T1&#34;</span><span class="op" id="4107828">:</span>&nbsp;&nbsp;<span class="string" id="4107831">&#34;application/test&#34;</span><span class="op" id="4107849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107853">&#34;.t2&#34;</span><span class="op" id="4107858">:</span>&nbsp;&nbsp;<span class="string" id="4107861">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="4107887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4107891">&#34;.png&#34;</span><span class="op" id="4107897">:</span>&nbsp;<span class="string" id="4107899">&#34;image/png&#34;</span><span class="op" id="4107910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107913">}</span><br>
<span class="lineno">60</span><span class="op" id="4107915">}</span>
</div>
</body>
</html>
