<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html" class="current">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7570901">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7570956">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7571010">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7571061">package</span>&nbsp;<span class="ident" id="7571069">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7571074">import</span>&nbsp;<span class="op" id="7571081">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7571084">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7571093">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7571100">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7571106">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7571117">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7571128">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7571138">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7571141">//&nbsp;Test&nbsp;basic&nbsp;operations&nbsp;in&nbsp;a&nbsp;safe&nbsp;manner.</span><br>
<span class="lineno"></span><span class="keyword" id="7571184">func</span>&nbsp;<span class="ident" id="7571189">TestBasicEncoderDecoder</span><span class="op" id="7571212">(</span><span class="ident" id="7571213">t</span>&nbsp;<span class="op" id="7571215">*</span><span class="ident" id="7571216">testing</span><span class="op" id="7571223">.</span><span class="ident" id="7571224">T</span><span class="op" id="7571225">)</span>&nbsp;<span class="op" id="7571227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7571230">var</span>&nbsp;<span class="ident" id="7571234">values</span>&nbsp;<span class="op" id="7571241">=</span>&nbsp;<span class="op" id="7571243">[</span><span class="op" id="7571244">]</span><span class="keyword" id="7571245">interface</span><span class="op" id="7571254">{</span><span class="op" id="7571255">}</span><span class="op" id="7571256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571260">true</span><span class="op" id="7571264">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571268">int</span><span class="op" id="7571271">(</span><span class="num" id="7571272">123</span><span class="op" id="7571275">)</span><span class="op" id="7571276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571280">int8</span><span class="op" id="7571284">(</span><span class="num" id="7571285">123</span><span class="op" id="7571288">)</span><span class="op" id="7571289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571293">int16</span><span class="op" id="7571298">(</span><span class="op" id="7571299">-</span><span class="num" id="7571300">12345</span><span class="op" id="7571305">)</span><span class="op" id="7571306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571310">int32</span><span class="op" id="7571315">(</span><span class="num" id="7571316">123456</span><span class="op" id="7571322">)</span><span class="op" id="7571323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571327">int64</span><span class="op" id="7571332">(</span><span class="op" id="7571333">-</span><span class="num" id="7571334">1234567</span><span class="op" id="7571341">)</span><span class="op" id="7571342">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571346">uint</span><span class="op" id="7571350">(</span><span class="num" id="7571351">123</span><span class="op" id="7571354">)</span><span class="op" id="7571355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571359">uint8</span><span class="op" id="7571364">(</span><span class="num" id="7571365">123</span><span class="op" id="7571368">)</span><span class="op" id="7571369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571373">uint16</span><span class="op" id="7571379">(</span><span class="num" id="7571380">12345</span><span class="op" id="7571385">)</span><span class="op" id="7571386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571390">uint32</span><span class="op" id="7571396">(</span><span class="num" id="7571397">123456</span><span class="op" id="7571403">)</span><span class="op" id="7571404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571408">uint64</span><span class="op" id="7571414">(</span><span class="num" id="7571415">1234567</span><span class="op" id="7571422">)</span><span class="op" id="7571423">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571427">uintptr</span><span class="op" id="7571434">(</span><span class="num" id="7571435">12345678</span><span class="op" id="7571443">)</span><span class="op" id="7571444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571448">float32</span><span class="op" id="7571455">(</span><span class="num" id="7571456">1.2345</span><span class="op" id="7571462">)</span><span class="op" id="7571463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571467">float64</span><span class="op" id="7571474">(</span><span class="num" id="7571475">1.2345678</span><span class="op" id="7571484">)</span><span class="op" id="7571485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571489">complex64</span><span class="op" id="7571498">(</span><span class="num" id="7571499">1.2345</span>&nbsp;<span class="op" id="7571506">+</span>&nbsp;<span class="num" id="7571508">2.3456i</span><span class="op" id="7571515">)</span><span class="op" id="7571516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571520">complex128</span><span class="op" id="7571530">(</span><span class="num" id="7571531">1.2345678</span>&nbsp;<span class="op" id="7571541">+</span>&nbsp;<span class="num" id="7571543">2.3456789i</span><span class="op" id="7571553">)</span><span class="op" id="7571554">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7571558">[</span><span class="op" id="7571559">]</span><span class="builtintype" id="7571560">byte</span><span class="op" id="7571564">(</span><span class="string" id="7571565">&#34;hello&#34;</span><span class="op" id="7571572">)</span><span class="op" id="7571573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7571577">string</span><span class="op" id="7571583">(</span><span class="string" id="7571584">&#34;hello&#34;</span><span class="op" id="7571591">)</span><span class="op" id="7571592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7571595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7571598">for</span>&nbsp;<span class="ident" id="7571602">_</span><span class="op" id="7571603">,</span>&nbsp;<span class="ident" id="7571605">value</span>&nbsp;<span class="op" id="7571611">:=</span>&nbsp;<span class="keyword" id="7571614">range</span>&nbsp;<span class="ident" id="7571620">values</span>&nbsp;<span class="op" id="7571627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571631">b</span>&nbsp;<span class="op" id="7571633">:=</span>&nbsp;<span class="builtinfunc" id="7571636">new</span><span class="op" id="7571639">(</span><span class="ident" id="7571640">bytes</span><span class="op" id="7571645">.</span><span class="ident" id="7571646">Buffer</span><span class="op" id="7571652">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571656">enc</span>&nbsp;<span class="op" id="7571660">:=</span>&nbsp;<span class="ident" id="7571663">NewEncoder</span><span class="op" id="7571673">(</span><span class="ident" id="7571674">b</span><span class="op" id="7571675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571679">err</span>&nbsp;<span class="op" id="7571683">:=</span>&nbsp;<span class="ident" id="7571686">enc</span><span class="op" id="7571689">.</span><span class="ident" id="7571690">Encode</span><span class="op" id="7571696">(</span><span class="ident" id="7571697">value</span><span class="op" id="7571702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7571706">if</span>&nbsp;<span class="ident" id="7571709">err</span>&nbsp;<span class="op" id="7571713">!=</span>&nbsp;<span class="ident" id="7571716">nil</span>&nbsp;<span class="op" id="7571720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571725">t</span><span class="op" id="7571726">.</span><span class="ident" id="7571727">Error</span><span class="op" id="7571732">(</span><span class="string" id="7571733">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7571748">,</span>&nbsp;<span class="ident" id="7571750">err</span><span class="op" id="7571753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7571757">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571761">dec</span>&nbsp;<span class="op" id="7571765">:=</span>&nbsp;<span class="ident" id="7571768">NewDecoder</span><span class="op" id="7571778">(</span><span class="ident" id="7571779">b</span><span class="op" id="7571780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571784">result</span>&nbsp;<span class="op" id="7571791">:=</span>&nbsp;<span class="ident" id="7571794">reflect</span><span class="op" id="7571801">.</span><span class="ident" id="7571802">New</span><span class="op" id="7571805">(</span><span class="ident" id="7571806">reflect</span><span class="op" id="7571813">.</span><span class="ident" id="7571814">TypeOf</span><span class="op" id="7571820">(</span><span class="ident" id="7571821">value</span><span class="op" id="7571826">)</span><span class="op" id="7571827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571831">err</span>&nbsp;<span class="op" id="7571835">=</span>&nbsp;<span class="ident" id="7571837">dec</span><span class="op" id="7571840">.</span><span class="ident" id="7571841">Decode</span><span class="op" id="7571847">(</span><span class="ident" id="7571848">result</span><span class="op" id="7571854">.</span><span class="ident" id="7571855">Interface</span><span class="op" id="7571864">(</span><span class="op" id="7571865">)</span><span class="op" id="7571866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7571870">if</span>&nbsp;<span class="ident" id="7571873">err</span>&nbsp;<span class="op" id="7571877">!=</span>&nbsp;<span class="ident" id="7571880">nil</span>&nbsp;<span class="op" id="7571884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7571889">t</span><span class="op" id="7571890">.</span><span class="ident" id="7571891">Fatalf</span><span class="op" id="7571897">(</span><span class="string" id="7571898">&#34;error&nbsp;decoding&nbsp;%T:&nbsp;%v:&#34;</span><span class="op" id="7571922">,</span>&nbsp;<span class="ident" id="7571924">reflect</span><span class="op" id="7571931">.</span><span class="ident" id="7571932">TypeOf</span><span class="op" id="7571938">(</span><span class="ident" id="7571939">value</span><span class="op" id="7571944">)</span><span class="op" id="7571945">,</span>&nbsp;<span class="ident" id="7571947">err</span><span class="op" id="7571950">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7571954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7571958">if</span>&nbsp;<span class="op" id="7571961">!</span><span class="ident" id="7571962">reflect</span><span class="op" id="7571969">.</span><span class="ident" id="7571970">DeepEqual</span><span class="op" id="7571979">(</span><span class="ident" id="7571980">value</span><span class="op" id="7571985">,</span>&nbsp;<span class="ident" id="7571987">result</span><span class="op" id="7571993">.</span><span class="ident" id="7571994">Elem</span><span class="op" id="7571998">(</span><span class="op" id="7571999">)</span><span class="op" id="7572000">.</span><span class="ident" id="7572001">Interface</span><span class="op" id="7572010">(</span><span class="op" id="7572011">)</span><span class="op" id="7572012">)</span>&nbsp;<span class="op" id="7572014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572019">t</span><span class="op" id="7572020">.</span><span class="ident" id="7572021">Fatalf</span><span class="op" id="7572027">(</span><span class="string" id="7572028">&#34;%T:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7572052">,</span>&nbsp;<span class="ident" id="7572054">value</span><span class="op" id="7572059">,</span>&nbsp;<span class="ident" id="7572061">value</span><span class="op" id="7572066">,</span>&nbsp;<span class="ident" id="7572068">result</span><span class="op" id="7572074">.</span><span class="ident" id="7572075">Elem</span><span class="op" id="7572079">(</span><span class="op" id="7572080">)</span><span class="op" id="7572081">.</span><span class="ident" id="7572082">Interface</span><span class="op" id="7572091">(</span><span class="op" id="7572092">)</span><span class="op" id="7572093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7572097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7572100">}</span><br>
<span class="lineno">55</span><span class="op" id="7572102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7572105">type</span>&nbsp;<span class="ident" id="7572110">ET0</span>&nbsp;<span class="keyword" id="7572114">struct</span>&nbsp;<span class="op" id="7572121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572124">A</span>&nbsp;<span class="builtintype" id="7572126">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572131">B</span>&nbsp;<span class="builtintype" id="7572133">string</span><br>
<span class="lineno">60</span><span class="op" id="7572140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7572143">type</span>&nbsp;<span class="ident" id="7572148">ET2</span>&nbsp;<span class="keyword" id="7572152">struct</span>&nbsp;<span class="op" id="7572159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572162">X</span>&nbsp;<span class="builtintype" id="7572164">string</span><br>
<span class="lineno"></span><span class="op" id="7572171">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7572174">type</span>&nbsp;<span class="ident" id="7572179">ET1</span>&nbsp;<span class="keyword" id="7572183">struct</span>&nbsp;<span class="op" id="7572190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572193">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7572198">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572203">Et2</span>&nbsp;&nbsp;<span class="op" id="7572208">*</span><span class="ident" id="7572209">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572214">Next</span>&nbsp;<span class="op" id="7572219">*</span><span class="ident" id="7572220">ET1</span><br>
<span class="lineno">70</span><span class="op" id="7572224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7572227">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;name&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="7572277">type</span>&nbsp;<span class="ident" id="7572282">ET3</span>&nbsp;<span class="keyword" id="7572286">struct</span>&nbsp;<span class="op" id="7572293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572296">A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7572310">int</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572315">Et2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7572329">*</span><span class="ident" id="7572330">ET2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572335">DifferentNext</span>&nbsp;<span class="op" id="7572349">*</span><span class="ident" id="7572350">ET1</span><br>
<span class="lineno"></span><span class="op" id="7572354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7572357">//&nbsp;Like&nbsp;ET1&nbsp;but&nbsp;with&nbsp;a&nbsp;different&nbsp;type&nbsp;for&nbsp;a&nbsp;field</span><br>
<span class="lineno">80</span><span class="keyword" id="7572407">type</span>&nbsp;<span class="ident" id="7572412">ET4</span>&nbsp;<span class="keyword" id="7572416">struct</span>&nbsp;<span class="op" id="7572423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572426">A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7572431">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572436">Et2</span>&nbsp;&nbsp;<span class="builtintype" id="7572441">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572450">Next</span>&nbsp;<span class="builtintype" id="7572455">int</span><br>
<span class="lineno"></span><span class="op" id="7572459">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="7572462">func</span>&nbsp;<span class="ident" id="7572467">TestEncoderDecoder</span><span class="op" id="7572485">(</span><span class="ident" id="7572486">t</span>&nbsp;<span class="op" id="7572488">*</span><span class="ident" id="7572489">testing</span><span class="op" id="7572496">.</span><span class="ident" id="7572497">T</span><span class="op" id="7572498">)</span>&nbsp;<span class="op" id="7572500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572503">b</span>&nbsp;<span class="op" id="7572505">:=</span>&nbsp;<span class="builtinfunc" id="7572508">new</span><span class="op" id="7572511">(</span><span class="ident" id="7572512">bytes</span><span class="op" id="7572517">.</span><span class="ident" id="7572518">Buffer</span><span class="op" id="7572524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572527">enc</span>&nbsp;<span class="op" id="7572531">:=</span>&nbsp;<span class="ident" id="7572534">NewEncoder</span><span class="op" id="7572544">(</span><span class="ident" id="7572545">b</span><span class="op" id="7572546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572549">et0</span>&nbsp;<span class="op" id="7572553">:=</span>&nbsp;<span class="builtinfunc" id="7572556">new</span><span class="op" id="7572559">(</span><span class="ident" id="7572560">ET0</span><span class="op" id="7572563">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572566">et0</span><span class="op" id="7572569">.</span><span class="ident" id="7572570">A</span>&nbsp;<span class="op" id="7572572">=</span>&nbsp;<span class="num" id="7572574">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572577">et0</span><span class="op" id="7572580">.</span><span class="ident" id="7572581">B</span>&nbsp;<span class="op" id="7572583">=</span>&nbsp;<span class="string" id="7572585">&#34;gobs&nbsp;of&nbsp;fun&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572600">err</span>&nbsp;<span class="op" id="7572604">:=</span>&nbsp;<span class="ident" id="7572607">enc</span><span class="op" id="7572610">.</span><span class="ident" id="7572611">Encode</span><span class="op" id="7572617">(</span><span class="ident" id="7572618">et0</span><span class="op" id="7572621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7572624">if</span>&nbsp;<span class="ident" id="7572627">err</span>&nbsp;<span class="op" id="7572631">!=</span>&nbsp;<span class="ident" id="7572634">nil</span>&nbsp;<span class="op" id="7572638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572642">t</span><span class="op" id="7572643">.</span><span class="ident" id="7572644">Error</span><span class="op" id="7572649">(</span><span class="string" id="7572650">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7572665">,</span>&nbsp;<span class="ident" id="7572667">err</span><span class="op" id="7572670">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7572673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7572676">//fmt.Printf(&#34;%&nbsp;x&nbsp;%q\n&#34;,&nbsp;b,&nbsp;b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7572708">//Debug(b)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572720">dec</span>&nbsp;<span class="op" id="7572724">:=</span>&nbsp;<span class="ident" id="7572727">NewDecoder</span><span class="op" id="7572737">(</span><span class="ident" id="7572738">b</span><span class="op" id="7572739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572742">newEt0</span>&nbsp;<span class="op" id="7572749">:=</span>&nbsp;<span class="builtinfunc" id="7572752">new</span><span class="op" id="7572755">(</span><span class="ident" id="7572756">ET0</span><span class="op" id="7572759">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572762">err</span>&nbsp;<span class="op" id="7572766">=</span>&nbsp;<span class="ident" id="7572768">dec</span><span class="op" id="7572771">.</span><span class="ident" id="7572772">Decode</span><span class="op" id="7572778">(</span><span class="ident" id="7572779">newEt0</span><span class="op" id="7572785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7572788">if</span>&nbsp;<span class="ident" id="7572791">err</span>&nbsp;<span class="op" id="7572795">!=</span>&nbsp;<span class="ident" id="7572798">nil</span>&nbsp;<span class="op" id="7572802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572806">t</span><span class="op" id="7572807">.</span><span class="ident" id="7572808">Fatal</span><span class="op" id="7572813">(</span><span class="string" id="7572814">&#34;error&nbsp;decoding&nbsp;ET0:&#34;</span><span class="op" id="7572835">,</span>&nbsp;<span class="ident" id="7572837">err</span><span class="op" id="7572840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7572843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7572847">if</span>&nbsp;<span class="op" id="7572850">!</span><span class="ident" id="7572851">reflect</span><span class="op" id="7572858">.</span><span class="ident" id="7572859">DeepEqual</span><span class="op" id="7572868">(</span><span class="ident" id="7572869">et0</span><span class="op" id="7572872">,</span>&nbsp;<span class="ident" id="7572874">newEt0</span><span class="op" id="7572880">)</span>&nbsp;<span class="op" id="7572882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572886">t</span><span class="op" id="7572887">.</span><span class="ident" id="7572888">Fatalf</span><span class="op" id="7572894">(</span><span class="string" id="7572895">&#34;invalid&nbsp;data&nbsp;for&nbsp;et0:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7572940">,</span>&nbsp;<span class="op" id="7572942">*</span><span class="ident" id="7572943">et0</span><span class="op" id="7572946">,</span>&nbsp;<span class="op" id="7572948">*</span><span class="ident" id="7572949">newEt0</span><span class="op" id="7572955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7572958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7572961">if</span>&nbsp;<span class="ident" id="7572964">b</span><span class="op" id="7572965">.</span><span class="ident" id="7572966">Len</span><span class="op" id="7572969">(</span><span class="op" id="7572970">)</span>&nbsp;<span class="op" id="7572972">!=</span>&nbsp;<span class="num" id="7572975">0</span>&nbsp;<span class="op" id="7572977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7572981">t</span><span class="op" id="7572982">.</span><span class="ident" id="7572983">Error</span><span class="op" id="7572988">(</span><span class="string" id="7572989">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7573002">,</span>&nbsp;<span class="ident" id="7573004">b</span><span class="op" id="7573005">.</span><span class="ident" id="7573006">Len</span><span class="op" id="7573009">(</span><span class="op" id="7573010">)</span><span class="op" id="7573011">,</span>&nbsp;<span class="string" id="7573013">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7573025">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7573031">//&nbsp;&nbsp;&nbsp;&nbsp;t.FailNow()</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573048">b</span>&nbsp;<span class="op" id="7573050">=</span>&nbsp;<span class="builtinfunc" id="7573052">new</span><span class="op" id="7573055">(</span><span class="ident" id="7573056">bytes</span><span class="op" id="7573061">.</span><span class="ident" id="7573062">Buffer</span><span class="op" id="7573068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573071">enc</span>&nbsp;<span class="op" id="7573075">=</span>&nbsp;<span class="ident" id="7573077">NewEncoder</span><span class="op" id="7573087">(</span><span class="ident" id="7573088">b</span><span class="op" id="7573089">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573092">et1</span>&nbsp;<span class="op" id="7573096">:=</span>&nbsp;<span class="builtinfunc" id="7573099">new</span><span class="op" id="7573102">(</span><span class="ident" id="7573103">ET1</span><span class="op" id="7573106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573109">et1</span><span class="op" id="7573112">.</span><span class="ident" id="7573113">A</span>&nbsp;<span class="op" id="7573115">=</span>&nbsp;<span class="num" id="7573117">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573120">et1</span><span class="op" id="7573123">.</span><span class="ident" id="7573124">Et2</span>&nbsp;<span class="op" id="7573128">=</span>&nbsp;<span class="builtinfunc" id="7573130">new</span><span class="op" id="7573133">(</span><span class="ident" id="7573134">ET2</span><span class="op" id="7573137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573140">err</span>&nbsp;<span class="op" id="7573144">=</span>&nbsp;<span class="ident" id="7573146">enc</span><span class="op" id="7573149">.</span><span class="ident" id="7573150">Encode</span><span class="op" id="7573156">(</span><span class="ident" id="7573157">et1</span><span class="op" id="7573160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573163">if</span>&nbsp;<span class="ident" id="7573166">err</span>&nbsp;<span class="op" id="7573170">!=</span>&nbsp;<span class="ident" id="7573173">nil</span>&nbsp;<span class="op" id="7573177">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573181">t</span><span class="op" id="7573182">.</span><span class="ident" id="7573183">Error</span><span class="op" id="7573188">(</span><span class="string" id="7573189">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7573204">,</span>&nbsp;<span class="ident" id="7573206">err</span><span class="op" id="7573209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573215">dec</span>&nbsp;<span class="op" id="7573219">=</span>&nbsp;<span class="ident" id="7573221">NewDecoder</span><span class="op" id="7573231">(</span><span class="ident" id="7573232">b</span><span class="op" id="7573233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573236">newEt1</span>&nbsp;<span class="op" id="7573243">:=</span>&nbsp;<span class="builtinfunc" id="7573246">new</span><span class="op" id="7573249">(</span><span class="ident" id="7573250">ET1</span><span class="op" id="7573253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573256">err</span>&nbsp;<span class="op" id="7573260">=</span>&nbsp;<span class="ident" id="7573262">dec</span><span class="op" id="7573265">.</span><span class="ident" id="7573266">Decode</span><span class="op" id="7573272">(</span><span class="ident" id="7573273">newEt1</span><span class="op" id="7573279">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573282">if</span>&nbsp;<span class="ident" id="7573285">err</span>&nbsp;<span class="op" id="7573289">!=</span>&nbsp;<span class="ident" id="7573292">nil</span>&nbsp;<span class="op" id="7573296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573300">t</span><span class="op" id="7573301">.</span><span class="ident" id="7573302">Fatal</span><span class="op" id="7573307">(</span><span class="string" id="7573308">&#34;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="7573329">,</span>&nbsp;<span class="ident" id="7573331">err</span><span class="op" id="7573334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573341">if</span>&nbsp;<span class="op" id="7573344">!</span><span class="ident" id="7573345">reflect</span><span class="op" id="7573352">.</span><span class="ident" id="7573353">DeepEqual</span><span class="op" id="7573362">(</span><span class="ident" id="7573363">et1</span><span class="op" id="7573366">,</span>&nbsp;<span class="ident" id="7573368">newEt1</span><span class="op" id="7573374">)</span>&nbsp;<span class="op" id="7573376">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573380">t</span><span class="op" id="7573381">.</span><span class="ident" id="7573382">Fatalf</span><span class="op" id="7573388">(</span><span class="string" id="7573389">&#34;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7573434">,</span>&nbsp;<span class="op" id="7573436">*</span><span class="ident" id="7573437">et1</span><span class="op" id="7573440">,</span>&nbsp;<span class="op" id="7573442">*</span><span class="ident" id="7573443">newEt1</span><span class="op" id="7573449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573455">if</span>&nbsp;<span class="ident" id="7573458">b</span><span class="op" id="7573459">.</span><span class="ident" id="7573460">Len</span><span class="op" id="7573463">(</span><span class="op" id="7573464">)</span>&nbsp;<span class="op" id="7573466">!=</span>&nbsp;<span class="num" id="7573469">0</span>&nbsp;<span class="op" id="7573471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573475">t</span><span class="op" id="7573476">.</span><span class="ident" id="7573477">Error</span><span class="op" id="7573482">(</span><span class="string" id="7573483">&#34;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7573496">,</span>&nbsp;<span class="ident" id="7573498">b</span><span class="op" id="7573499">.</span><span class="ident" id="7573500">Len</span><span class="op" id="7573503">(</span><span class="op" id="7573504">)</span><span class="op" id="7573505">,</span>&nbsp;<span class="string" id="7573507">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7573519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573522">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573526">enc</span><span class="op" id="7573529">.</span><span class="ident" id="7573530">Encode</span><span class="op" id="7573536">(</span><span class="ident" id="7573537">et1</span><span class="op" id="7573540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573543">newEt1</span>&nbsp;<span class="op" id="7573550">=</span>&nbsp;<span class="builtinfunc" id="7573552">new</span><span class="op" id="7573555">(</span><span class="ident" id="7573556">ET1</span><span class="op" id="7573559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573562">err</span>&nbsp;<span class="op" id="7573566">=</span>&nbsp;<span class="ident" id="7573568">dec</span><span class="op" id="7573571">.</span><span class="ident" id="7573572">Decode</span><span class="op" id="7573578">(</span><span class="ident" id="7573579">newEt1</span><span class="op" id="7573585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573588">if</span>&nbsp;<span class="ident" id="7573591">err</span>&nbsp;<span class="op" id="7573595">!=</span>&nbsp;<span class="ident" id="7573598">nil</span>&nbsp;<span class="op" id="7573602">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573606">t</span><span class="op" id="7573607">.</span><span class="ident" id="7573608">Fatal</span><span class="op" id="7573613">(</span><span class="string" id="7573614">&#34;round&nbsp;2:&nbsp;error&nbsp;decoding&nbsp;ET1:&#34;</span><span class="op" id="7573644">,</span>&nbsp;<span class="ident" id="7573646">err</span><span class="op" id="7573649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573655">if</span>&nbsp;<span class="op" id="7573658">!</span><span class="ident" id="7573659">reflect</span><span class="op" id="7573666">.</span><span class="ident" id="7573667">DeepEqual</span><span class="op" id="7573676">(</span><span class="ident" id="7573677">et1</span><span class="op" id="7573680">,</span>&nbsp;<span class="ident" id="7573682">newEt1</span><span class="op" id="7573688">)</span>&nbsp;<span class="op" id="7573690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573694">t</span><span class="op" id="7573695">.</span><span class="ident" id="7573696">Fatalf</span><span class="op" id="7573702">(</span><span class="string" id="7573703">&#34;round&nbsp;2:&nbsp;invalid&nbsp;data&nbsp;for&nbsp;et1:&nbsp;expected&nbsp;%+v;&nbsp;got&nbsp;%+v&#34;</span><span class="op" id="7573757">,</span>&nbsp;<span class="op" id="7573759">*</span><span class="ident" id="7573760">et1</span><span class="op" id="7573763">,</span>&nbsp;<span class="op" id="7573765">*</span><span class="ident" id="7573766">newEt1</span><span class="op" id="7573772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573775">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573778">if</span>&nbsp;<span class="ident" id="7573781">b</span><span class="op" id="7573782">.</span><span class="ident" id="7573783">Len</span><span class="op" id="7573786">(</span><span class="op" id="7573787">)</span>&nbsp;<span class="op" id="7573789">!=</span>&nbsp;<span class="num" id="7573792">0</span>&nbsp;<span class="op" id="7573794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573798">t</span><span class="op" id="7573799">.</span><span class="ident" id="7573800">Error</span><span class="op" id="7573805">(</span><span class="string" id="7573806">&#34;round&nbsp;2:&nbsp;not&nbsp;at&nbsp;eof;&#34;</span><span class="op" id="7573828">,</span>&nbsp;<span class="ident" id="7573830">b</span><span class="op" id="7573831">.</span><span class="ident" id="7573832">Len</span><span class="op" id="7573835">(</span><span class="op" id="7573836">)</span><span class="op" id="7573837">,</span>&nbsp;<span class="string" id="7573839">&#34;bytes&nbsp;left&#34;</span><span class="op" id="7573851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7573854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7573858">//&nbsp;Now&nbsp;test&nbsp;with&nbsp;a&nbsp;running&nbsp;encoder/decoder&nbsp;pair&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;type&nbsp;mismatch.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573942">err</span>&nbsp;<span class="op" id="7573946">=</span>&nbsp;<span class="ident" id="7573948">enc</span><span class="op" id="7573951">.</span><span class="ident" id="7573952">Encode</span><span class="op" id="7573958">(</span><span class="ident" id="7573959">et1</span><span class="op" id="7573962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7573965">if</span>&nbsp;<span class="ident" id="7573968">err</span>&nbsp;<span class="op" id="7573972">!=</span>&nbsp;<span class="ident" id="7573975">nil</span>&nbsp;<span class="op" id="7573979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7573983">t</span><span class="op" id="7573984">.</span><span class="ident" id="7573985">Error</span><span class="op" id="7573990">(</span><span class="string" id="7573991">&#34;round&nbsp;3:&nbsp;encoder&nbsp;fail:&#34;</span><span class="op" id="7574015">,</span>&nbsp;<span class="ident" id="7574017">err</span><span class="op" id="7574020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7574023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574026">newEt2</span>&nbsp;<span class="op" id="7574033">:=</span>&nbsp;<span class="builtinfunc" id="7574036">new</span><span class="op" id="7574039">(</span><span class="ident" id="7574040">ET2</span><span class="op" id="7574043">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574046">err</span>&nbsp;<span class="op" id="7574050">=</span>&nbsp;<span class="ident" id="7574052">dec</span><span class="op" id="7574055">.</span><span class="ident" id="7574056">Decode</span><span class="op" id="7574062">(</span><span class="ident" id="7574063">newEt2</span><span class="op" id="7574069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7574072">if</span>&nbsp;<span class="ident" id="7574075">err</span>&nbsp;<span class="op" id="7574079">==</span>&nbsp;<span class="ident" id="7574082">nil</span>&nbsp;<span class="op" id="7574086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574090">t</span><span class="op" id="7574091">.</span><span class="ident" id="7574092">Fatal</span><span class="op" id="7574097">(</span><span class="string" id="7574098">&#34;round&nbsp;3:&nbsp;expected&nbsp;`bad&nbsp;type&#39;&nbsp;error&nbsp;decoding&nbsp;ET2&#34;</span><span class="op" id="7574147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7574150">}</span><br>
<span class="lineno"></span><span class="op" id="7574152">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7574155">//&nbsp;Run&nbsp;one&nbsp;value&nbsp;through&nbsp;the&nbsp;encoder/decoder,&nbsp;but&nbsp;use&nbsp;the&nbsp;wrong&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="7574225">//&nbsp;Input&nbsp;is&nbsp;always&nbsp;an&nbsp;ET1;&nbsp;we&nbsp;compare&nbsp;it&nbsp;to&nbsp;whatever&nbsp;is&nbsp;under&nbsp;&#39;e&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="7574292">func</span>&nbsp;<span class="ident" id="7574297">badTypeCheck</span><span class="op" id="7574309">(</span><span class="ident" id="7574310">e</span>&nbsp;<span class="keyword" id="7574312">interface</span><span class="op" id="7574321">{</span><span class="op" id="7574322">}</span><span class="op" id="7574323">,</span>&nbsp;<span class="ident" id="7574325">shouldFail</span>&nbsp;<span class="builtintype" id="7574336">bool</span><span class="op" id="7574340">,</span>&nbsp;<span class="ident" id="7574342">msg</span>&nbsp;<span class="builtintype" id="7574346">string</span><span class="op" id="7574352">,</span>&nbsp;<span class="ident" id="7574354">t</span>&nbsp;<span class="op" id="7574356">*</span><span class="ident" id="7574357">testing</span><span class="op" id="7574364">.</span><span class="ident" id="7574365">T</span><span class="op" id="7574366">)</span>&nbsp;<span class="op" id="7574368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574371">b</span>&nbsp;<span class="op" id="7574373">:=</span>&nbsp;<span class="builtinfunc" id="7574376">new</span><span class="op" id="7574379">(</span><span class="ident" id="7574380">bytes</span><span class="op" id="7574385">.</span><span class="ident" id="7574386">Buffer</span><span class="op" id="7574392">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574395">enc</span>&nbsp;<span class="op" id="7574399">:=</span>&nbsp;<span class="ident" id="7574402">NewEncoder</span><span class="op" id="7574412">(</span><span class="ident" id="7574413">b</span><span class="op" id="7574414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574417">et1</span>&nbsp;<span class="op" id="7574421">:=</span>&nbsp;<span class="builtinfunc" id="7574424">new</span><span class="op" id="7574427">(</span><span class="ident" id="7574428">ET1</span><span class="op" id="7574431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574434">et1</span><span class="op" id="7574437">.</span><span class="ident" id="7574438">A</span>&nbsp;<span class="op" id="7574440">=</span>&nbsp;<span class="num" id="7574442">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574445">et1</span><span class="op" id="7574448">.</span><span class="ident" id="7574449">Et2</span>&nbsp;<span class="op" id="7574453">=</span>&nbsp;<span class="builtinfunc" id="7574455">new</span><span class="op" id="7574458">(</span><span class="ident" id="7574459">ET2</span><span class="op" id="7574462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574465">err</span>&nbsp;<span class="op" id="7574469">:=</span>&nbsp;<span class="ident" id="7574472">enc</span><span class="op" id="7574475">.</span><span class="ident" id="7574476">Encode</span><span class="op" id="7574482">(</span><span class="ident" id="7574483">et1</span><span class="op" id="7574486">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7574489">if</span>&nbsp;<span class="ident" id="7574492">err</span>&nbsp;<span class="op" id="7574496">!=</span>&nbsp;<span class="ident" id="7574499">nil</span>&nbsp;<span class="op" id="7574503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574507">t</span><span class="op" id="7574508">.</span><span class="ident" id="7574509">Error</span><span class="op" id="7574514">(</span><span class="string" id="7574515">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7574530">,</span>&nbsp;<span class="ident" id="7574532">err</span><span class="op" id="7574535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7574538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574541">dec</span>&nbsp;<span class="op" id="7574545">:=</span>&nbsp;<span class="ident" id="7574548">NewDecoder</span><span class="op" id="7574558">(</span><span class="ident" id="7574559">b</span><span class="op" id="7574560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574563">err</span>&nbsp;<span class="op" id="7574567">=</span>&nbsp;<span class="ident" id="7574569">dec</span><span class="op" id="7574572">.</span><span class="ident" id="7574573">Decode</span><span class="op" id="7574579">(</span><span class="ident" id="7574580">e</span><span class="op" id="7574581">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7574584">if</span>&nbsp;<span class="ident" id="7574587">shouldFail</span>&nbsp;<span class="op" id="7574598">&amp;&amp;</span>&nbsp;<span class="ident" id="7574601">err</span>&nbsp;<span class="op" id="7574605">==</span>&nbsp;<span class="ident" id="7574608">nil</span>&nbsp;<span class="op" id="7574612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574616">t</span><span class="op" id="7574617">.</span><span class="ident" id="7574618">Error</span><span class="op" id="7574623">(</span><span class="string" id="7574624">&#34;expected&nbsp;error&nbsp;for&#34;</span><span class="op" id="7574644">,</span>&nbsp;<span class="ident" id="7574646">msg</span><span class="op" id="7574649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7574652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7574655">if</span>&nbsp;<span class="op" id="7574658">!</span><span class="ident" id="7574659">shouldFail</span>&nbsp;<span class="op" id="7574670">&amp;&amp;</span>&nbsp;<span class="ident" id="7574673">err</span>&nbsp;<span class="op" id="7574677">!=</span>&nbsp;<span class="ident" id="7574680">nil</span>&nbsp;<span class="op" id="7574684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574688">t</span><span class="op" id="7574689">.</span><span class="ident" id="7574690">Error</span><span class="op" id="7574695">(</span><span class="string" id="7574696">&#34;unexpected&nbsp;error&nbsp;for&#34;</span><span class="op" id="7574718">,</span>&nbsp;<span class="ident" id="7574720">msg</span><span class="op" id="7574723">,</span>&nbsp;<span class="ident" id="7574725">err</span><span class="op" id="7574728">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7574731">}</span><br>
<span class="lineno"></span><span class="op" id="7574733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7574736">//&nbsp;Test&nbsp;that&nbsp;we&nbsp;recognize&nbsp;a&nbsp;bad&nbsp;type&nbsp;the&nbsp;first&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="7574789">func</span>&nbsp;<span class="ident" id="7574794">TestWrongTypeDecoder</span><span class="op" id="7574814">(</span><span class="ident" id="7574815">t</span>&nbsp;<span class="op" id="7574817">*</span><span class="ident" id="7574818">testing</span><span class="op" id="7574825">.</span><span class="ident" id="7574826">T</span><span class="op" id="7574827">)</span>&nbsp;<span class="op" id="7574829">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574832">badTypeCheck</span><span class="op" id="7574844">(</span><span class="builtinfunc" id="7574845">new</span><span class="op" id="7574848">(</span><span class="ident" id="7574849">ET2</span><span class="op" id="7574852">)</span><span class="op" id="7574853">,</span>&nbsp;<span class="builtintype" id="7574855">true</span><span class="op" id="7574859">,</span>&nbsp;<span class="string" id="7574861">&#34;no&nbsp;fields&nbsp;in&nbsp;common&#34;</span><span class="op" id="7574882">,</span>&nbsp;<span class="ident" id="7574884">t</span><span class="op" id="7574885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574888">badTypeCheck</span><span class="op" id="7574900">(</span><span class="builtinfunc" id="7574901">new</span><span class="op" id="7574904">(</span><span class="ident" id="7574905">ET3</span><span class="op" id="7574908">)</span><span class="op" id="7574909">,</span>&nbsp;<span class="builtintype" id="7574911">false</span><span class="op" id="7574916">,</span>&nbsp;<span class="string" id="7574918">&#34;different&nbsp;name&nbsp;of&nbsp;field&#34;</span><span class="op" id="7574943">,</span>&nbsp;<span class="ident" id="7574945">t</span><span class="op" id="7574946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7574949">badTypeCheck</span><span class="op" id="7574961">(</span><span class="builtinfunc" id="7574962">new</span><span class="op" id="7574965">(</span><span class="ident" id="7574966">ET4</span><span class="op" id="7574969">)</span><span class="op" id="7574970">,</span>&nbsp;<span class="builtintype" id="7574972">true</span><span class="op" id="7574976">,</span>&nbsp;<span class="string" id="7574978">&#34;different&nbsp;type&nbsp;of&nbsp;field&#34;</span><span class="op" id="7575003">,</span>&nbsp;<span class="ident" id="7575005">t</span><span class="op" id="7575006">)</span><br>
<span class="lineno"></span><span class="op" id="7575008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7575011">func</span>&nbsp;<span class="ident" id="7575016">corruptDataCheck</span><span class="op" id="7575032">(</span><span class="ident" id="7575033">s</span>&nbsp;<span class="builtintype" id="7575035">string</span><span class="op" id="7575041">,</span>&nbsp;<span class="ident" id="7575043">err</span>&nbsp;<span class="builtintype" id="7575047">error</span><span class="op" id="7575052">,</span>&nbsp;<span class="ident" id="7575054">t</span>&nbsp;<span class="op" id="7575056">*</span><span class="ident" id="7575057">testing</span><span class="op" id="7575064">.</span><span class="ident" id="7575065">T</span><span class="op" id="7575066">)</span>&nbsp;<span class="op" id="7575068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575071">b</span>&nbsp;<span class="op" id="7575073">:=</span>&nbsp;<span class="ident" id="7575076">bytes</span><span class="op" id="7575081">.</span><span class="ident" id="7575082">NewBufferString</span><span class="op" id="7575097">(</span><span class="ident" id="7575098">s</span><span class="op" id="7575099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575102">dec</span>&nbsp;<span class="op" id="7575106">:=</span>&nbsp;<span class="ident" id="7575109">NewDecoder</span><span class="op" id="7575119">(</span><span class="ident" id="7575120">b</span><span class="op" id="7575121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575124">err1</span>&nbsp;<span class="op" id="7575129">:=</span>&nbsp;<span class="ident" id="7575132">dec</span><span class="op" id="7575135">.</span><span class="ident" id="7575136">Decode</span><span class="op" id="7575142">(</span><span class="builtinfunc" id="7575143">new</span><span class="op" id="7575146">(</span><span class="ident" id="7575147">ET2</span><span class="op" id="7575150">)</span><span class="op" id="7575151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7575154">if</span>&nbsp;<span class="ident" id="7575157">err1</span>&nbsp;<span class="op" id="7575162">!=</span>&nbsp;<span class="ident" id="7575165">err</span>&nbsp;<span class="op" id="7575169">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575173">t</span><span class="op" id="7575174">.</span><span class="ident" id="7575175">Errorf</span><span class="op" id="7575181">(</span><span class="string" id="7575182">&#34;from&nbsp;%q&nbsp;expected&nbsp;error&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7575217">,</span>&nbsp;<span class="ident" id="7575219">s</span><span class="op" id="7575220">,</span>&nbsp;<span class="ident" id="7575222">err</span><span class="op" id="7575225">,</span>&nbsp;<span class="ident" id="7575227">err1</span><span class="op" id="7575231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7575234">}</span><br>
<span class="lineno"></span><span class="op" id="7575236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7575239">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;survive&nbsp;bad&nbsp;data.</span><br>
<span class="lineno">200</span><span class="keyword" id="7575274">func</span>&nbsp;<span class="ident" id="7575279">TestBadData</span><span class="op" id="7575290">(</span><span class="ident" id="7575291">t</span>&nbsp;<span class="op" id="7575293">*</span><span class="ident" id="7575294">testing</span><span class="op" id="7575301">.</span><span class="ident" id="7575302">T</span><span class="op" id="7575303">)</span>&nbsp;<span class="op" id="7575305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575308">corruptDataCheck</span><span class="op" id="7575324">(</span><span class="string" id="7575325">&#34;&#34;</span><span class="op" id="7575327">,</span>&nbsp;<span class="ident" id="7575329">io</span><span class="op" id="7575331">.</span><span class="ident" id="7575332">EOF</span><span class="op" id="7575335">,</span>&nbsp;<span class="ident" id="7575337">t</span><span class="op" id="7575338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575341">corruptDataCheck</span><span class="op" id="7575357">(</span><span class="string" id="7575358">&#34;\x7Fhi&#34;</span><span class="op" id="7575366">,</span>&nbsp;<span class="ident" id="7575368">io</span><span class="op" id="7575370">.</span><span class="ident" id="7575371">ErrUnexpectedEOF</span><span class="op" id="7575387">,</span>&nbsp;<span class="ident" id="7575389">t</span><span class="op" id="7575390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575393">corruptDataCheck</span><span class="op" id="7575409">(</span><span class="string" id="7575410">&#34;\x03now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&#34;</span><span class="op" id="7575448">,</span>&nbsp;<span class="ident" id="7575450">errBadType</span><span class="op" id="7575460">,</span>&nbsp;<span class="ident" id="7575462">t</span><span class="op" id="7575463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7575466">//&nbsp;issue&nbsp;6323.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575482">corruptDataCheck</span><span class="op" id="7575498">(</span><span class="string" id="7575499">&#34;\x04\x24foo&#34;</span><span class="op" id="7575512">,</span>&nbsp;<span class="ident" id="7575514">errRange</span><span class="op" id="7575522">,</span>&nbsp;<span class="ident" id="7575524">t</span><span class="op" id="7575525">)</span><br>
<span class="lineno"></span><span class="op" id="7575527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7575530">//&nbsp;Types&nbsp;not&nbsp;supported&nbsp;at&nbsp;top&nbsp;level&nbsp;by&nbsp;the&nbsp;Encoder.</span><br>
<span class="lineno"></span><span class="keyword" id="7575582">var</span>&nbsp;<span class="ident" id="7575586">unsupportedValues</span>&nbsp;<span class="op" id="7575604">=</span>&nbsp;<span class="op" id="7575606">[</span><span class="op" id="7575607">]</span><span class="keyword" id="7575608">interface</span><span class="op" id="7575617">{</span><span class="op" id="7575618">}</span><span class="op" id="7575619">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7575622">make</span><span class="op" id="7575626">(</span><span class="keyword" id="7575627">chan</span>&nbsp;<span class="builtintype" id="7575632">int</span><span class="op" id="7575635">)</span><span class="op" id="7575636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7575639">func</span><span class="op" id="7575643">(</span><span class="ident" id="7575644">a</span>&nbsp;<span class="builtintype" id="7575646">int</span><span class="op" id="7575649">)</span>&nbsp;<span class="builtintype" id="7575651">bool</span>&nbsp;<span class="op" id="7575656">{</span>&nbsp;<span class="keyword" id="7575658">return</span>&nbsp;<span class="builtintype" id="7575665">true</span>&nbsp;<span class="op" id="7575670">}</span><span class="op" id="7575671">,</span><br>
<span class="lineno"></span><span class="op" id="7575673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7575676">func</span>&nbsp;<span class="ident" id="7575681">TestUnsupported</span><span class="op" id="7575696">(</span><span class="ident" id="7575697">t</span>&nbsp;<span class="op" id="7575699">*</span><span class="ident" id="7575700">testing</span><span class="op" id="7575707">.</span><span class="ident" id="7575708">T</span><span class="op" id="7575709">)</span>&nbsp;<span class="op" id="7575711">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7575714">var</span>&nbsp;<span class="ident" id="7575718">b</span>&nbsp;<span class="ident" id="7575720">bytes</span><span class="op" id="7575725">.</span><span class="ident" id="7575726">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575734">enc</span>&nbsp;<span class="op" id="7575738">:=</span>&nbsp;<span class="ident" id="7575741">NewEncoder</span><span class="op" id="7575751">(</span><span class="op" id="7575752">&amp;</span><span class="ident" id="7575753">b</span><span class="op" id="7575754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7575757">for</span>&nbsp;<span class="ident" id="7575761">_</span><span class="op" id="7575762">,</span>&nbsp;<span class="ident" id="7575764">v</span>&nbsp;<span class="op" id="7575766">:=</span>&nbsp;<span class="keyword" id="7575769">range</span>&nbsp;<span class="ident" id="7575775">unsupportedValues</span>&nbsp;<span class="op" id="7575793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575797">err</span>&nbsp;<span class="op" id="7575801">:=</span>&nbsp;<span class="ident" id="7575804">enc</span><span class="op" id="7575807">.</span><span class="ident" id="7575808">Encode</span><span class="op" id="7575814">(</span><span class="ident" id="7575815">v</span><span class="op" id="7575816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7575820">if</span>&nbsp;<span class="ident" id="7575823">err</span>&nbsp;<span class="op" id="7575827">==</span>&nbsp;<span class="ident" id="7575830">nil</span>&nbsp;<span class="op" id="7575834">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575839">t</span><span class="op" id="7575840">.</span><span class="ident" id="7575841">Errorf</span><span class="op" id="7575847">(</span><span class="string" id="7575848">&#34;expected&nbsp;error&nbsp;for&nbsp;%T;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7575881">,</span>&nbsp;<span class="ident" id="7575883">v</span><span class="op" id="7575884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7575888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7575891">}</span><br>
<span class="lineno"></span><span class="op" id="7575893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7575896">func</span>&nbsp;<span class="ident" id="7575901">encAndDec</span><span class="op" id="7575910">(</span><span class="ident" id="7575911">in</span><span class="op" id="7575913">,</span>&nbsp;<span class="ident" id="7575915">out</span>&nbsp;<span class="keyword" id="7575919">interface</span><span class="op" id="7575928">{</span><span class="op" id="7575929">}</span><span class="op" id="7575930">)</span>&nbsp;<span class="builtintype" id="7575932">error</span>&nbsp;<span class="op" id="7575938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575941">b</span>&nbsp;<span class="op" id="7575943">:=</span>&nbsp;<span class="builtinfunc" id="7575946">new</span><span class="op" id="7575949">(</span><span class="ident" id="7575950">bytes</span><span class="op" id="7575955">.</span><span class="ident" id="7575956">Buffer</span><span class="op" id="7575962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575965">enc</span>&nbsp;<span class="op" id="7575969">:=</span>&nbsp;<span class="ident" id="7575972">NewEncoder</span><span class="op" id="7575982">(</span><span class="ident" id="7575983">b</span><span class="op" id="7575984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7575987">err</span>&nbsp;<span class="op" id="7575991">:=</span>&nbsp;<span class="ident" id="7575994">enc</span><span class="op" id="7575997">.</span><span class="ident" id="7575998">Encode</span><span class="op" id="7576004">(</span><span class="ident" id="7576005">in</span><span class="op" id="7576007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576010">if</span>&nbsp;<span class="ident" id="7576013">err</span>&nbsp;<span class="op" id="7576017">!=</span>&nbsp;<span class="ident" id="7576020">nil</span>&nbsp;<span class="op" id="7576024">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576028">return</span>&nbsp;<span class="ident" id="7576035">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576043">dec</span>&nbsp;<span class="op" id="7576047">:=</span>&nbsp;<span class="ident" id="7576050">NewDecoder</span><span class="op" id="7576060">(</span><span class="ident" id="7576061">b</span><span class="op" id="7576062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576065">err</span>&nbsp;<span class="op" id="7576069">=</span>&nbsp;<span class="ident" id="7576071">dec</span><span class="op" id="7576074">.</span><span class="ident" id="7576075">Decode</span><span class="op" id="7576081">(</span><span class="ident" id="7576082">out</span><span class="op" id="7576085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576088">if</span>&nbsp;<span class="ident" id="7576091">err</span>&nbsp;<span class="op" id="7576095">!=</span>&nbsp;<span class="ident" id="7576098">nil</span>&nbsp;<span class="op" id="7576102">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576106">return</span>&nbsp;<span class="ident" id="7576113">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576121">return</span>&nbsp;<span class="ident" id="7576128">nil</span><br>
<span class="lineno"></span><span class="op" id="7576132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7576135">func</span>&nbsp;<span class="ident" id="7576140">TestTypeToPtrType</span><span class="op" id="7576157">(</span><span class="ident" id="7576158">t</span>&nbsp;<span class="op" id="7576160">*</span><span class="ident" id="7576161">testing</span><span class="op" id="7576168">.</span><span class="ident" id="7576169">T</span><span class="op" id="7576170">)</span>&nbsp;<span class="op" id="7576172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7576175">//&nbsp;Encode&nbsp;a&nbsp;T,&nbsp;decode&nbsp;a&nbsp;*T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576203">type</span>&nbsp;<span class="ident" id="7576208">Type0</span>&nbsp;<span class="keyword" id="7576214">struct</span>&nbsp;<span class="op" id="7576221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576225">A</span>&nbsp;<span class="builtintype" id="7576227">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576232">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576235">t0</span>&nbsp;<span class="op" id="7576238">:=</span>&nbsp;<span class="ident" id="7576241">Type0</span><span class="op" id="7576246">{</span><span class="num" id="7576247">7</span><span class="op" id="7576248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576251">t0p</span>&nbsp;<span class="op" id="7576255">:=</span>&nbsp;<span class="builtinfunc" id="7576258">new</span><span class="op" id="7576261">(</span><span class="ident" id="7576262">Type0</span><span class="op" id="7576267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576270">if</span>&nbsp;<span class="ident" id="7576273">err</span>&nbsp;<span class="op" id="7576277">:=</span>&nbsp;<span class="ident" id="7576280">encAndDec</span><span class="op" id="7576289">(</span><span class="ident" id="7576290">t0</span><span class="op" id="7576292">,</span>&nbsp;<span class="ident" id="7576294">t0p</span><span class="op" id="7576297">)</span><span class="op" id="7576298">;</span>&nbsp;<span class="ident" id="7576300">err</span>&nbsp;<span class="op" id="7576304">!=</span>&nbsp;<span class="ident" id="7576307">nil</span>&nbsp;<span class="op" id="7576311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576315">t</span><span class="op" id="7576316">.</span><span class="ident" id="7576317">Error</span><span class="op" id="7576322">(</span><span class="ident" id="7576323">err</span><span class="op" id="7576326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576329">}</span><br>
<span class="lineno">250</span><span class="op" id="7576331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7576334">func</span>&nbsp;<span class="ident" id="7576339">TestPtrTypeToType</span><span class="op" id="7576356">(</span><span class="ident" id="7576357">t</span>&nbsp;<span class="op" id="7576359">*</span><span class="ident" id="7576360">testing</span><span class="op" id="7576367">.</span><span class="ident" id="7576368">T</span><span class="op" id="7576369">)</span>&nbsp;<span class="op" id="7576371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7576374">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576402">type</span>&nbsp;<span class="ident" id="7576407">Type1</span>&nbsp;<span class="keyword" id="7576413">struct</span>&nbsp;<span class="op" id="7576420">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576424">A</span>&nbsp;<span class="builtintype" id="7576426">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576435">t1p</span>&nbsp;<span class="op" id="7576439">:=</span>&nbsp;<span class="op" id="7576442">&amp;</span><span class="ident" id="7576443">Type1</span><span class="op" id="7576448">{</span><span class="num" id="7576449">17</span><span class="op" id="7576451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576454">var</span>&nbsp;<span class="ident" id="7576458">t1</span>&nbsp;<span class="ident" id="7576461">Type1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576468">if</span>&nbsp;<span class="ident" id="7576471">err</span>&nbsp;<span class="op" id="7576475">:=</span>&nbsp;<span class="ident" id="7576478">encAndDec</span><span class="op" id="7576487">(</span><span class="ident" id="7576488">t1</span><span class="op" id="7576490">,</span>&nbsp;<span class="ident" id="7576492">t1p</span><span class="op" id="7576495">)</span><span class="op" id="7576496">;</span>&nbsp;<span class="ident" id="7576498">err</span>&nbsp;<span class="op" id="7576502">!=</span>&nbsp;<span class="ident" id="7576505">nil</span>&nbsp;<span class="op" id="7576509">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576513">t</span><span class="op" id="7576514">.</span><span class="ident" id="7576515">Error</span><span class="op" id="7576520">(</span><span class="ident" id="7576521">err</span><span class="op" id="7576524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576527">}</span><br>
<span class="lineno"></span><span class="op" id="7576529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7576532">func</span>&nbsp;<span class="ident" id="7576537">TestTypeToPtrPtrPtrPtrType</span><span class="op" id="7576563">(</span><span class="ident" id="7576564">t</span>&nbsp;<span class="op" id="7576566">*</span><span class="ident" id="7576567">testing</span><span class="op" id="7576574">.</span><span class="ident" id="7576575">T</span><span class="op" id="7576576">)</span>&nbsp;<span class="op" id="7576578">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576581">type</span>&nbsp;<span class="ident" id="7576586">Type2</span>&nbsp;<span class="keyword" id="7576592">struct</span>&nbsp;<span class="op" id="7576599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576603">A</span>&nbsp;<span class="op" id="7576605">*</span><span class="op" id="7576606">*</span><span class="op" id="7576607">*</span><span class="op" id="7576608">*</span><span class="builtintype" id="7576609">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576621">t2</span>&nbsp;<span class="op" id="7576624">:=</span>&nbsp;<span class="ident" id="7576627">Type2</span><span class="op" id="7576632">{</span><span class="op" id="7576633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576636">t2</span><span class="op" id="7576638">.</span><span class="ident" id="7576639">A</span>&nbsp;<span class="op" id="7576641">=</span>&nbsp;<span class="builtinfunc" id="7576643">new</span><span class="op" id="7576646">(</span><span class="op" id="7576647">*</span><span class="op" id="7576648">*</span><span class="op" id="7576649">*</span><span class="builtintype" id="7576650">float64</span><span class="op" id="7576657">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576660">*</span><span class="ident" id="7576661">t2</span><span class="op" id="7576663">.</span><span class="ident" id="7576664">A</span>&nbsp;<span class="op" id="7576666">=</span>&nbsp;<span class="builtinfunc" id="7576668">new</span><span class="op" id="7576671">(</span><span class="op" id="7576672">*</span><span class="op" id="7576673">*</span><span class="builtintype" id="7576674">float64</span><span class="op" id="7576681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576684">*</span><span class="op" id="7576685">*</span><span class="ident" id="7576686">t2</span><span class="op" id="7576688">.</span><span class="ident" id="7576689">A</span>&nbsp;<span class="op" id="7576691">=</span>&nbsp;<span class="builtinfunc" id="7576693">new</span><span class="op" id="7576696">(</span><span class="op" id="7576697">*</span><span class="builtintype" id="7576698">float64</span><span class="op" id="7576705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576708">*</span><span class="op" id="7576709">*</span><span class="op" id="7576710">*</span><span class="ident" id="7576711">t2</span><span class="op" id="7576713">.</span><span class="ident" id="7576714">A</span>&nbsp;<span class="op" id="7576716">=</span>&nbsp;<span class="builtinfunc" id="7576718">new</span><span class="op" id="7576721">(</span><span class="builtintype" id="7576722">float64</span><span class="op" id="7576729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576732">*</span><span class="op" id="7576733">*</span><span class="op" id="7576734">*</span><span class="op" id="7576735">*</span><span class="ident" id="7576736">t2</span><span class="op" id="7576738">.</span><span class="ident" id="7576739">A</span>&nbsp;<span class="op" id="7576741">=</span>&nbsp;<span class="num" id="7576743">27.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576749">t2pppp</span>&nbsp;<span class="op" id="7576756">:=</span>&nbsp;<span class="builtinfunc" id="7576759">new</span><span class="op" id="7576762">(</span><span class="op" id="7576763">*</span><span class="op" id="7576764">*</span><span class="op" id="7576765">*</span><span class="ident" id="7576766">Type2</span><span class="op" id="7576771">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576774">if</span>&nbsp;<span class="ident" id="7576777">err</span>&nbsp;<span class="op" id="7576781">:=</span>&nbsp;<span class="ident" id="7576784">encAndDec</span><span class="op" id="7576793">(</span><span class="ident" id="7576794">t2</span><span class="op" id="7576796">,</span>&nbsp;<span class="ident" id="7576798">t2pppp</span><span class="op" id="7576804">)</span><span class="op" id="7576805">;</span>&nbsp;<span class="ident" id="7576807">err</span>&nbsp;<span class="op" id="7576811">!=</span>&nbsp;<span class="ident" id="7576814">nil</span>&nbsp;<span class="op" id="7576818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576822">t</span><span class="op" id="7576823">.</span><span class="ident" id="7576824">Fatal</span><span class="op" id="7576829">(</span><span class="ident" id="7576830">err</span><span class="op" id="7576833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576839">if</span>&nbsp;<span class="op" id="7576842">*</span><span class="op" id="7576843">*</span><span class="op" id="7576844">*</span><span class="op" id="7576845">*</span><span class="op" id="7576846">(</span><span class="op" id="7576847">*</span><span class="op" id="7576848">*</span><span class="op" id="7576849">*</span><span class="op" id="7576850">*</span><span class="ident" id="7576851">t2pppp</span><span class="op" id="7576857">)</span><span class="op" id="7576858">.</span><span class="ident" id="7576859">A</span>&nbsp;<span class="op" id="7576861">!=</span>&nbsp;<span class="op" id="7576864">*</span><span class="op" id="7576865">*</span><span class="op" id="7576866">*</span><span class="op" id="7576867">*</span><span class="ident" id="7576868">t2</span><span class="op" id="7576870">.</span><span class="ident" id="7576871">A</span>&nbsp;<span class="op" id="7576873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7576877">t</span><span class="op" id="7576878">.</span><span class="ident" id="7576879">Errorf</span><span class="op" id="7576885">(</span><span class="string" id="7576886">&#34;wrong&nbsp;value&nbsp;after&nbsp;decode:&nbsp;%g&nbsp;not&nbsp;%g&#34;</span><span class="op" id="7576923">,</span>&nbsp;<span class="op" id="7576925">*</span><span class="op" id="7576926">*</span><span class="op" id="7576927">*</span><span class="op" id="7576928">*</span><span class="op" id="7576929">(</span><span class="op" id="7576930">*</span><span class="op" id="7576931">*</span><span class="op" id="7576932">*</span><span class="op" id="7576933">*</span><span class="ident" id="7576934">t2pppp</span><span class="op" id="7576940">)</span><span class="op" id="7576941">.</span><span class="ident" id="7576942">A</span><span class="op" id="7576943">,</span>&nbsp;<span class="op" id="7576945">*</span><span class="op" id="7576946">*</span><span class="op" id="7576947">*</span><span class="op" id="7576948">*</span><span class="ident" id="7576949">t2</span><span class="op" id="7576951">.</span><span class="ident" id="7576952">A</span><span class="op" id="7576953">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7576956">}</span><br>
<span class="lineno"></span><span class="op" id="7576958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7576961">func</span>&nbsp;<span class="ident" id="7576966">TestSlice</span><span class="op" id="7576975">(</span><span class="ident" id="7576976">t</span>&nbsp;<span class="op" id="7576978">*</span><span class="ident" id="7576979">testing</span><span class="op" id="7576986">.</span><span class="ident" id="7576987">T</span><span class="op" id="7576988">)</span>&nbsp;<span class="op" id="7576990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7576993">type</span>&nbsp;<span class="ident" id="7576998">Type3</span>&nbsp;<span class="keyword" id="7577004">struct</span>&nbsp;<span class="op" id="7577011">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577015">A</span>&nbsp;<span class="op" id="7577017">[</span><span class="op" id="7577018">]</span><span class="builtintype" id="7577019">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577030">t3p</span>&nbsp;<span class="op" id="7577034">:=</span>&nbsp;<span class="op" id="7577037">&amp;</span><span class="ident" id="7577038">Type3</span><span class="op" id="7577043">{</span><span class="op" id="7577044">[</span><span class="op" id="7577045">]</span><span class="builtintype" id="7577046">string</span><span class="op" id="7577052">{</span><span class="string" id="7577053">&#34;hello&#34;</span><span class="op" id="7577060">,</span>&nbsp;<span class="string" id="7577062">&#34;world&#34;</span><span class="op" id="7577069">}</span><span class="op" id="7577070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577073">var</span>&nbsp;<span class="ident" id="7577077">t3</span>&nbsp;<span class="ident" id="7577080">Type3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577087">if</span>&nbsp;<span class="ident" id="7577090">err</span>&nbsp;<span class="op" id="7577094">:=</span>&nbsp;<span class="ident" id="7577097">encAndDec</span><span class="op" id="7577106">(</span><span class="ident" id="7577107">t3</span><span class="op" id="7577109">,</span>&nbsp;<span class="ident" id="7577111">t3p</span><span class="op" id="7577114">)</span><span class="op" id="7577115">;</span>&nbsp;<span class="ident" id="7577117">err</span>&nbsp;<span class="op" id="7577121">!=</span>&nbsp;<span class="ident" id="7577124">nil</span>&nbsp;<span class="op" id="7577128">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577132">t</span><span class="op" id="7577133">.</span><span class="ident" id="7577134">Error</span><span class="op" id="7577139">(</span><span class="ident" id="7577140">err</span><span class="op" id="7577143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577146">}</span><br>
<span class="lineno"></span><span class="op" id="7577148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7577151">func</span>&nbsp;<span class="ident" id="7577156">TestValueError</span><span class="op" id="7577170">(</span><span class="ident" id="7577171">t</span>&nbsp;<span class="op" id="7577173">*</span><span class="ident" id="7577174">testing</span><span class="op" id="7577181">.</span><span class="ident" id="7577182">T</span><span class="op" id="7577183">)</span>&nbsp;<span class="op" id="7577185">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7577188">//&nbsp;Encode&nbsp;a&nbsp;*T,&nbsp;decode&nbsp;a&nbsp;T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577216">type</span>&nbsp;<span class="ident" id="7577221">Type4</span>&nbsp;<span class="keyword" id="7577227">struct</span>&nbsp;<span class="op" id="7577234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577238">A</span>&nbsp;<span class="builtintype" id="7577240">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577248">t4p</span>&nbsp;<span class="op" id="7577252">:=</span>&nbsp;<span class="op" id="7577255">&amp;</span><span class="ident" id="7577256">Type4</span><span class="op" id="7577261">{</span><span class="num" id="7577262">3</span><span class="op" id="7577263">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577266">var</span>&nbsp;<span class="ident" id="7577270">t4</span>&nbsp;<span class="ident" id="7577273">Type4</span>&nbsp;<span class="comment" id="7577279">//&nbsp;note:&nbsp;not&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577304">if</span>&nbsp;<span class="ident" id="7577307">err</span>&nbsp;<span class="op" id="7577311">:=</span>&nbsp;<span class="ident" id="7577314">encAndDec</span><span class="op" id="7577323">(</span><span class="ident" id="7577324">t4p</span><span class="op" id="7577327">,</span>&nbsp;<span class="ident" id="7577329">t4</span><span class="op" id="7577331">)</span><span class="op" id="7577332">;</span>&nbsp;<span class="ident" id="7577334">err</span>&nbsp;<span class="op" id="7577338">==</span>&nbsp;<span class="ident" id="7577341">nil</span>&nbsp;<span class="op" id="7577345">||</span>&nbsp;<span class="ident" id="7577348">strings</span><span class="op" id="7577355">.</span><span class="ident" id="7577356">Index</span><span class="op" id="7577361">(</span><span class="ident" id="7577362">err</span><span class="op" id="7577365">.</span><span class="ident" id="7577366">Error</span><span class="op" id="7577371">(</span><span class="op" id="7577372">)</span><span class="op" id="7577373">,</span>&nbsp;<span class="string" id="7577375">&#34;pointer&#34;</span><span class="op" id="7577384">)</span>&nbsp;<span class="op" id="7577386">&lt;</span>&nbsp;<span class="num" id="7577388">0</span>&nbsp;<span class="op" id="7577390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577394">t</span><span class="op" id="7577395">.</span><span class="ident" id="7577396">Error</span><span class="op" id="7577401">(</span><span class="string" id="7577402">&#34;expected&nbsp;error&nbsp;about&nbsp;pointer;&nbsp;got&#34;</span><span class="op" id="7577437">,</span>&nbsp;<span class="ident" id="7577439">err</span><span class="op" id="7577442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577445">}</span><br>
<span class="lineno"></span><span class="op" id="7577447">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="7577450">func</span>&nbsp;<span class="ident" id="7577455">TestArray</span><span class="op" id="7577464">(</span><span class="ident" id="7577465">t</span>&nbsp;<span class="op" id="7577467">*</span><span class="ident" id="7577468">testing</span><span class="op" id="7577475">.</span><span class="ident" id="7577476">T</span><span class="op" id="7577477">)</span>&nbsp;<span class="op" id="7577479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577482">type</span>&nbsp;<span class="ident" id="7577487">Type5</span>&nbsp;<span class="keyword" id="7577493">struct</span>&nbsp;<span class="op" id="7577500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577504">A</span>&nbsp;<span class="op" id="7577506">[</span><span class="num" id="7577507">3</span><span class="op" id="7577508">]</span><span class="builtintype" id="7577509">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577518">B</span>&nbsp;<span class="op" id="7577520">[</span><span class="num" id="7577521">3</span><span class="op" id="7577522">]</span><span class="builtintype" id="7577523">byte</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577532">type</span>&nbsp;<span class="ident" id="7577537">Type6</span>&nbsp;<span class="keyword" id="7577543">struct</span>&nbsp;<span class="op" id="7577550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577554">A</span>&nbsp;<span class="op" id="7577556">[</span><span class="num" id="7577557">2</span><span class="op" id="7577558">]</span><span class="builtintype" id="7577559">string</span>&nbsp;<span class="comment" id="7577566">//&nbsp;can&#39;t&nbsp;hold&nbsp;t5.a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577589">t5</span>&nbsp;<span class="op" id="7577592">:=</span>&nbsp;<span class="ident" id="7577595">Type5</span><span class="op" id="7577600">{</span><span class="op" id="7577601">[</span><span class="num" id="7577602">3</span><span class="op" id="7577603">]</span><span class="builtintype" id="7577604">string</span><span class="op" id="7577610">{</span><span class="string" id="7577611">&#34;hello&#34;</span><span class="op" id="7577618">,</span>&nbsp;<span class="string" id="7577620">&#34;,&#34;</span><span class="op" id="7577623">,</span>&nbsp;<span class="string" id="7577625">&#34;world&#34;</span><span class="op" id="7577632">}</span><span class="op" id="7577633">,</span>&nbsp;<span class="op" id="7577635">[</span><span class="num" id="7577636">3</span><span class="op" id="7577637">]</span><span class="builtintype" id="7577638">byte</span><span class="op" id="7577642">{</span><span class="num" id="7577643">1</span><span class="op" id="7577644">,</span>&nbsp;<span class="num" id="7577646">2</span><span class="op" id="7577647">,</span>&nbsp;<span class="num" id="7577649">3</span><span class="op" id="7577650">}</span><span class="op" id="7577651">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577654">var</span>&nbsp;<span class="ident" id="7577658">t5p</span>&nbsp;<span class="ident" id="7577662">Type5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577669">if</span>&nbsp;<span class="ident" id="7577672">err</span>&nbsp;<span class="op" id="7577676">:=</span>&nbsp;<span class="ident" id="7577679">encAndDec</span><span class="op" id="7577688">(</span><span class="ident" id="7577689">t5</span><span class="op" id="7577691">,</span>&nbsp;<span class="op" id="7577693">&amp;</span><span class="ident" id="7577694">t5p</span><span class="op" id="7577697">)</span><span class="op" id="7577698">;</span>&nbsp;<span class="ident" id="7577700">err</span>&nbsp;<span class="op" id="7577704">!=</span>&nbsp;<span class="ident" id="7577707">nil</span>&nbsp;<span class="op" id="7577711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577715">t</span><span class="op" id="7577716">.</span><span class="ident" id="7577717">Error</span><span class="op" id="7577722">(</span><span class="ident" id="7577723">err</span><span class="op" id="7577726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577732">var</span>&nbsp;<span class="ident" id="7577736">t6</span>&nbsp;<span class="ident" id="7577739">Type6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577746">if</span>&nbsp;<span class="ident" id="7577749">err</span>&nbsp;<span class="op" id="7577753">:=</span>&nbsp;<span class="ident" id="7577756">encAndDec</span><span class="op" id="7577765">(</span><span class="ident" id="7577766">t5</span><span class="op" id="7577768">,</span>&nbsp;<span class="op" id="7577770">&amp;</span><span class="ident" id="7577771">t6</span><span class="op" id="7577773">)</span><span class="op" id="7577774">;</span>&nbsp;<span class="ident" id="7577776">err</span>&nbsp;<span class="op" id="7577780">==</span>&nbsp;<span class="ident" id="7577783">nil</span>&nbsp;<span class="op" id="7577787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577791">t</span><span class="op" id="7577792">.</span><span class="ident" id="7577793">Error</span><span class="op" id="7577798">(</span><span class="string" id="7577799">&#34;should&nbsp;fail&nbsp;with&nbsp;mismatched&nbsp;array&nbsp;sizes&#34;</span><span class="op" id="7577840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7577843">}</span><br>
<span class="lineno"></span><span class="op" id="7577845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="7577848">func</span>&nbsp;<span class="ident" id="7577853">TestRecursiveMapType</span><span class="op" id="7577873">(</span><span class="ident" id="7577874">t</span>&nbsp;<span class="op" id="7577876">*</span><span class="ident" id="7577877">testing</span><span class="op" id="7577884">.</span><span class="ident" id="7577885">T</span><span class="op" id="7577886">)</span>&nbsp;<span class="op" id="7577888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7577891">type</span>&nbsp;<span class="ident" id="7577896">recursiveMap</span>&nbsp;<span class="keyword" id="7577909">map</span><span class="op" id="7577912">[</span><span class="builtintype" id="7577913">string</span><span class="op" id="7577919">]</span><span class="ident" id="7577920">recursiveMap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7577934">r1</span>&nbsp;<span class="op" id="7577937">:=</span>&nbsp;<span class="ident" id="7577940">recursiveMap</span><span class="op" id="7577952">{</span><span class="string" id="7577953">&#34;A&#34;</span><span class="op" id="7577956">:</span>&nbsp;<span class="ident" id="7577958">recursiveMap</span><span class="op" id="7577970">{</span><span class="string" id="7577971">&#34;B&#34;</span><span class="op" id="7577974">:</span>&nbsp;<span class="ident" id="7577976">nil</span><span class="op" id="7577979">,</span>&nbsp;<span class="string" id="7577981">&#34;C&#34;</span><span class="op" id="7577984">:</span>&nbsp;<span class="ident" id="7577986">nil</span><span class="op" id="7577989">}</span><span class="op" id="7577990">,</span>&nbsp;<span class="string" id="7577992">&#34;D&#34;</span><span class="op" id="7577995">:</span>&nbsp;<span class="ident" id="7577997">nil</span><span class="op" id="7578000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578003">r2</span>&nbsp;<span class="op" id="7578006">:=</span>&nbsp;<span class="builtinfunc" id="7578009">make</span><span class="op" id="7578013">(</span><span class="ident" id="7578014">recursiveMap</span><span class="op" id="7578026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7578029">if</span>&nbsp;<span class="ident" id="7578032">err</span>&nbsp;<span class="op" id="7578036">:=</span>&nbsp;<span class="ident" id="7578039">encAndDec</span><span class="op" id="7578048">(</span><span class="ident" id="7578049">r1</span><span class="op" id="7578051">,</span>&nbsp;<span class="op" id="7578053">&amp;</span><span class="ident" id="7578054">r2</span><span class="op" id="7578056">)</span><span class="op" id="7578057">;</span>&nbsp;<span class="ident" id="7578059">err</span>&nbsp;<span class="op" id="7578063">!=</span>&nbsp;<span class="ident" id="7578066">nil</span>&nbsp;<span class="op" id="7578070">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578074">t</span><span class="op" id="7578075">.</span><span class="ident" id="7578076">Error</span><span class="op" id="7578081">(</span><span class="ident" id="7578082">err</span><span class="op" id="7578085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578088">}</span><br>
<span class="lineno"></span><span class="op" id="7578090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7578093">func</span>&nbsp;<span class="ident" id="7578098">TestRecursiveSliceType</span><span class="op" id="7578120">(</span><span class="ident" id="7578121">t</span>&nbsp;<span class="op" id="7578123">*</span><span class="ident" id="7578124">testing</span><span class="op" id="7578131">.</span><span class="ident" id="7578132">T</span><span class="op" id="7578133">)</span>&nbsp;<span class="op" id="7578135">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7578138">type</span>&nbsp;<span class="ident" id="7578143">recursiveSlice</span>&nbsp;<span class="op" id="7578158">[</span><span class="op" id="7578159">]</span><span class="ident" id="7578160">recursiveSlice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578176">r1</span>&nbsp;<span class="op" id="7578179">:=</span>&nbsp;<span class="ident" id="7578182">recursiveSlice</span><span class="op" id="7578196">{</span><span class="num" id="7578197">0</span><span class="op" id="7578198">:</span>&nbsp;<span class="ident" id="7578200">recursiveSlice</span><span class="op" id="7578214">{</span><span class="num" id="7578215">0</span><span class="op" id="7578216">:</span>&nbsp;<span class="ident" id="7578218">nil</span><span class="op" id="7578221">}</span><span class="op" id="7578222">,</span>&nbsp;<span class="num" id="7578224">1</span><span class="op" id="7578225">:</span>&nbsp;<span class="ident" id="7578227">nil</span><span class="op" id="7578230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578233">r2</span>&nbsp;<span class="op" id="7578236">:=</span>&nbsp;<span class="builtinfunc" id="7578239">make</span><span class="op" id="7578243">(</span><span class="ident" id="7578244">recursiveSlice</span><span class="op" id="7578258">,</span>&nbsp;<span class="num" id="7578260">0</span><span class="op" id="7578261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7578264">if</span>&nbsp;<span class="ident" id="7578267">err</span>&nbsp;<span class="op" id="7578271">:=</span>&nbsp;<span class="ident" id="7578274">encAndDec</span><span class="op" id="7578283">(</span><span class="ident" id="7578284">r1</span><span class="op" id="7578286">,</span>&nbsp;<span class="op" id="7578288">&amp;</span><span class="ident" id="7578289">r2</span><span class="op" id="7578291">)</span><span class="op" id="7578292">;</span>&nbsp;<span class="ident" id="7578294">err</span>&nbsp;<span class="op" id="7578298">!=</span>&nbsp;<span class="ident" id="7578301">nil</span>&nbsp;<span class="op" id="7578305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578309">t</span><span class="op" id="7578310">.</span><span class="ident" id="7578311">Error</span><span class="op" id="7578316">(</span><span class="ident" id="7578317">err</span><span class="op" id="7578320">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578323">}</span><br>
<span class="lineno"></span><span class="op" id="7578325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7578328">//&nbsp;Regression&nbsp;test&nbsp;for&nbsp;bug:&nbsp;must&nbsp;send&nbsp;zero&nbsp;values&nbsp;inside&nbsp;arrays</span><br>
<span class="lineno"></span><span class="keyword" id="7578392">func</span>&nbsp;<span class="ident" id="7578397">TestDefaultsInArray</span><span class="op" id="7578416">(</span><span class="ident" id="7578417">t</span>&nbsp;<span class="op" id="7578419">*</span><span class="ident" id="7578420">testing</span><span class="op" id="7578427">.</span><span class="ident" id="7578428">T</span><span class="op" id="7578429">)</span>&nbsp;<span class="op" id="7578431">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7578434">type</span>&nbsp;<span class="ident" id="7578439">Type7</span>&nbsp;<span class="keyword" id="7578445">struct</span>&nbsp;<span class="op" id="7578452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578456">B</span>&nbsp;<span class="op" id="7578458">[</span><span class="op" id="7578459">]</span><span class="builtintype" id="7578460">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578467">I</span>&nbsp;<span class="op" id="7578469">[</span><span class="op" id="7578470">]</span><span class="builtintype" id="7578471">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578477">S</span>&nbsp;<span class="op" id="7578479">[</span><span class="op" id="7578480">]</span><span class="builtintype" id="7578481">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578490">F</span>&nbsp;<span class="op" id="7578492">[</span><span class="op" id="7578493">]</span><span class="builtintype" id="7578494">float64</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578506">t7</span>&nbsp;<span class="op" id="7578509">:=</span>&nbsp;<span class="ident" id="7578512">Type7</span><span class="op" id="7578517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578521">[</span><span class="op" id="7578522">]</span><span class="builtintype" id="7578523">bool</span><span class="op" id="7578527">{</span><span class="builtintype" id="7578528">false</span><span class="op" id="7578533">,</span>&nbsp;<span class="builtintype" id="7578535">false</span><span class="op" id="7578540">,</span>&nbsp;<span class="builtintype" id="7578542">true</span><span class="op" id="7578546">}</span><span class="op" id="7578547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578551">[</span><span class="op" id="7578552">]</span><span class="builtintype" id="7578553">int</span><span class="op" id="7578556">{</span><span class="num" id="7578557">0</span><span class="op" id="7578558">,</span>&nbsp;<span class="num" id="7578560">0</span><span class="op" id="7578561">,</span>&nbsp;<span class="num" id="7578563">1</span><span class="op" id="7578564">}</span><span class="op" id="7578565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578569">[</span><span class="op" id="7578570">]</span><span class="builtintype" id="7578571">string</span><span class="op" id="7578577">{</span><span class="string" id="7578578">&#34;hi&#34;</span><span class="op" id="7578582">,</span>&nbsp;<span class="string" id="7578584">&#34;&#34;</span><span class="op" id="7578586">,</span>&nbsp;<span class="string" id="7578588">&#34;there&#34;</span><span class="op" id="7578595">}</span><span class="op" id="7578596">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578600">[</span><span class="op" id="7578601">]</span><span class="builtintype" id="7578602">float64</span><span class="op" id="7578609">{</span><span class="num" id="7578610">0</span><span class="op" id="7578611">,</span>&nbsp;<span class="num" id="7578613">0</span><span class="op" id="7578614">,</span>&nbsp;<span class="num" id="7578616">1</span><span class="op" id="7578617">}</span><span class="op" id="7578618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7578624">var</span>&nbsp;<span class="ident" id="7578628">t7p</span>&nbsp;<span class="ident" id="7578632">Type7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7578639">if</span>&nbsp;<span class="ident" id="7578642">err</span>&nbsp;<span class="op" id="7578646">:=</span>&nbsp;<span class="ident" id="7578649">encAndDec</span><span class="op" id="7578658">(</span><span class="ident" id="7578659">t7</span><span class="op" id="7578661">,</span>&nbsp;<span class="op" id="7578663">&amp;</span><span class="ident" id="7578664">t7p</span><span class="op" id="7578667">)</span><span class="op" id="7578668">;</span>&nbsp;<span class="ident" id="7578670">err</span>&nbsp;<span class="op" id="7578674">!=</span>&nbsp;<span class="ident" id="7578677">nil</span>&nbsp;<span class="op" id="7578681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578685">t</span><span class="op" id="7578686">.</span><span class="ident" id="7578687">Error</span><span class="op" id="7578692">(</span><span class="ident" id="7578693">err</span><span class="op" id="7578696">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578699">}</span><br>
<span class="lineno"></span><span class="op" id="7578701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7578704">var</span>&nbsp;<span class="ident" id="7578708">testInt</span>&nbsp;<span class="builtintype" id="7578716">int</span><br>
<span class="lineno"></span><span class="keyword" id="7578720">var</span>&nbsp;<span class="ident" id="7578724">testFloat32</span>&nbsp;<span class="builtintype" id="7578736">float32</span><br>
<span class="lineno">365</span><span class="keyword" id="7578744">var</span>&nbsp;<span class="ident" id="7578748">testString</span>&nbsp;<span class="builtintype" id="7578759">string</span><br>
<span class="lineno"></span><span class="keyword" id="7578766">var</span>&nbsp;<span class="ident" id="7578770">testSlice</span>&nbsp;<span class="op" id="7578780">[</span><span class="op" id="7578781">]</span><span class="builtintype" id="7578782">string</span><br>
<span class="lineno"></span><span class="keyword" id="7578789">var</span>&nbsp;<span class="ident" id="7578793">testMap</span>&nbsp;<span class="keyword" id="7578801">map</span><span class="op" id="7578804">[</span><span class="builtintype" id="7578805">string</span><span class="op" id="7578811">]</span><span class="builtintype" id="7578812">int</span><br>
<span class="lineno"></span><span class="keyword" id="7578816">var</span>&nbsp;<span class="ident" id="7578820">testArray</span>&nbsp;<span class="op" id="7578830">[</span><span class="num" id="7578831">7</span><span class="op" id="7578832">]</span><span class="builtintype" id="7578833">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="7578838">type</span>&nbsp;<span class="ident" id="7578843">SingleTest</span>&nbsp;<span class="keyword" id="7578854">struct</span>&nbsp;<span class="op" id="7578861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578864">in</span>&nbsp;&nbsp;<span class="keyword" id="7578868">interface</span><span class="op" id="7578877">{</span><span class="op" id="7578878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578881">out</span>&nbsp;<span class="keyword" id="7578885">interface</span><span class="op" id="7578894">{</span><span class="op" id="7578895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7578898">err</span>&nbsp;<span class="builtintype" id="7578902">string</span><br>
<span class="lineno"></span><span class="op" id="7578909">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="7578912">var</span>&nbsp;<span class="ident" id="7578916">singleTests</span>&nbsp;<span class="op" id="7578928">=</span>&nbsp;<span class="op" id="7578930">[</span><span class="op" id="7578931">]</span><span class="ident" id="7578932">SingleTest</span><span class="op" id="7578942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578945">{</span><span class="num" id="7578946">17</span><span class="op" id="7578948">,</span>&nbsp;<span class="op" id="7578950">&amp;</span><span class="ident" id="7578951">testInt</span><span class="op" id="7578958">,</span>&nbsp;<span class="string" id="7578960">&#34;&#34;</span><span class="op" id="7578962">}</span><span class="op" id="7578963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7578966">{</span><span class="builtintype" id="7578967">float32</span><span class="op" id="7578974">(</span><span class="num" id="7578975">17.5</span><span class="op" id="7578979">)</span><span class="op" id="7578980">,</span>&nbsp;<span class="op" id="7578982">&amp;</span><span class="ident" id="7578983">testFloat32</span><span class="op" id="7578994">,</span>&nbsp;<span class="string" id="7578996">&#34;&#34;</span><span class="op" id="7578998">}</span><span class="op" id="7578999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579002">{</span><span class="string" id="7579003">&#34;bike&nbsp;shed&#34;</span><span class="op" id="7579014">,</span>&nbsp;<span class="op" id="7579016">&amp;</span><span class="ident" id="7579017">testString</span><span class="op" id="7579027">,</span>&nbsp;<span class="string" id="7579029">&#34;&#34;</span><span class="op" id="7579031">}</span><span class="op" id="7579032">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579035">{</span><span class="op" id="7579036">[</span><span class="op" id="7579037">]</span><span class="builtintype" id="7579038">string</span><span class="op" id="7579044">{</span><span class="string" id="7579045">&#34;bike&#34;</span><span class="op" id="7579051">,</span>&nbsp;<span class="string" id="7579053">&#34;shed&#34;</span><span class="op" id="7579059">,</span>&nbsp;<span class="string" id="7579061">&#34;paint&#34;</span><span class="op" id="7579068">,</span>&nbsp;<span class="string" id="7579070">&#34;color&#34;</span><span class="op" id="7579077">}</span><span class="op" id="7579078">,</span>&nbsp;<span class="op" id="7579080">&amp;</span><span class="ident" id="7579081">testSlice</span><span class="op" id="7579090">,</span>&nbsp;<span class="string" id="7579092">&#34;&#34;</span><span class="op" id="7579094">}</span><span class="op" id="7579095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579098">{</span><span class="keyword" id="7579099">map</span><span class="op" id="7579102">[</span><span class="builtintype" id="7579103">string</span><span class="op" id="7579109">]</span><span class="builtintype" id="7579110">int</span><span class="op" id="7579113">{</span><span class="string" id="7579114">&#34;seven&#34;</span><span class="op" id="7579121">:</span>&nbsp;<span class="num" id="7579123">7</span><span class="op" id="7579124">,</span>&nbsp;<span class="string" id="7579126">&#34;twelve&#34;</span><span class="op" id="7579134">:</span>&nbsp;<span class="num" id="7579136">12</span><span class="op" id="7579138">}</span><span class="op" id="7579139">,</span>&nbsp;<span class="op" id="7579141">&amp;</span><span class="ident" id="7579142">testMap</span><span class="op" id="7579149">,</span>&nbsp;<span class="string" id="7579151">&#34;&#34;</span><span class="op" id="7579153">}</span><span class="op" id="7579154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579157">{</span><span class="op" id="7579158">[</span><span class="num" id="7579159">7</span><span class="op" id="7579160">]</span><span class="builtintype" id="7579161">int</span><span class="op" id="7579164">{</span><span class="num" id="7579165">4</span><span class="op" id="7579166">,</span>&nbsp;<span class="num" id="7579168">55</span><span class="op" id="7579170">,</span>&nbsp;<span class="num" id="7579172">0</span><span class="op" id="7579173">,</span>&nbsp;<span class="num" id="7579175">0</span><span class="op" id="7579176">,</span>&nbsp;<span class="num" id="7579178">0</span><span class="op" id="7579179">,</span>&nbsp;<span class="num" id="7579181">0</span><span class="op" id="7579182">,</span>&nbsp;<span class="num" id="7579184">0</span><span class="op" id="7579185">}</span><span class="op" id="7579186">,</span>&nbsp;<span class="op" id="7579188">&amp;</span><span class="ident" id="7579189">testArray</span><span class="op" id="7579198">,</span>&nbsp;<span class="string" id="7579200">&#34;&#34;</span><span class="op" id="7579202">}</span><span class="op" id="7579203">,</span>&nbsp;<span class="comment" id="7579205">//&nbsp;case&nbsp;that&nbsp;once&nbsp;triggered&nbsp;a&nbsp;bug</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579240">{</span><span class="op" id="7579241">[</span><span class="num" id="7579242">7</span><span class="op" id="7579243">]</span><span class="builtintype" id="7579244">int</span><span class="op" id="7579247">{</span><span class="num" id="7579248">4</span><span class="op" id="7579249">,</span>&nbsp;<span class="num" id="7579251">55</span><span class="op" id="7579253">,</span>&nbsp;<span class="num" id="7579255">1</span><span class="op" id="7579256">,</span>&nbsp;<span class="num" id="7579258">44</span><span class="op" id="7579260">,</span>&nbsp;<span class="num" id="7579262">22</span><span class="op" id="7579264">,</span>&nbsp;<span class="num" id="7579266">66</span><span class="op" id="7579268">,</span>&nbsp;<span class="num" id="7579270">1234</span><span class="op" id="7579274">}</span><span class="op" id="7579275">,</span>&nbsp;<span class="op" id="7579277">&amp;</span><span class="ident" id="7579278">testArray</span><span class="op" id="7579287">,</span>&nbsp;<span class="string" id="7579289">&#34;&#34;</span><span class="op" id="7579291">}</span><span class="op" id="7579292">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7579296">//&nbsp;Decode&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579314">{</span><span class="num" id="7579315">172</span><span class="op" id="7579318">,</span>&nbsp;<span class="op" id="7579320">&amp;</span><span class="ident" id="7579321">testFloat32</span><span class="op" id="7579332">,</span>&nbsp;<span class="string" id="7579334">&#34;type&#34;</span><span class="op" id="7579340">}</span><span class="op" id="7579341">,</span><br>
<span class="lineno"></span><span class="op" id="7579343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7579346">func</span>&nbsp;<span class="ident" id="7579351">TestSingletons</span><span class="op" id="7579365">(</span><span class="ident" id="7579366">t</span>&nbsp;<span class="op" id="7579368">*</span><span class="ident" id="7579369">testing</span><span class="op" id="7579376">.</span><span class="ident" id="7579377">T</span><span class="op" id="7579378">)</span>&nbsp;<span class="op" id="7579380">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579383">b</span>&nbsp;<span class="op" id="7579385">:=</span>&nbsp;<span class="builtinfunc" id="7579388">new</span><span class="op" id="7579391">(</span><span class="ident" id="7579392">bytes</span><span class="op" id="7579397">.</span><span class="ident" id="7579398">Buffer</span><span class="op" id="7579404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579407">enc</span>&nbsp;<span class="op" id="7579411">:=</span>&nbsp;<span class="ident" id="7579414">NewEncoder</span><span class="op" id="7579424">(</span><span class="ident" id="7579425">b</span><span class="op" id="7579426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579429">dec</span>&nbsp;<span class="op" id="7579433">:=</span>&nbsp;<span class="ident" id="7579436">NewDecoder</span><span class="op" id="7579446">(</span><span class="ident" id="7579447">b</span><span class="op" id="7579448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579451">for</span>&nbsp;<span class="ident" id="7579455">_</span><span class="op" id="7579456">,</span>&nbsp;<span class="ident" id="7579458">test</span>&nbsp;<span class="op" id="7579463">:=</span>&nbsp;<span class="keyword" id="7579466">range</span>&nbsp;<span class="ident" id="7579472">singleTests</span>&nbsp;<span class="op" id="7579484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579488">b</span><span class="op" id="7579489">.</span><span class="ident" id="7579490">Reset</span><span class="op" id="7579495">(</span><span class="op" id="7579496">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579500">err</span>&nbsp;<span class="op" id="7579504">:=</span>&nbsp;<span class="ident" id="7579507">enc</span><span class="op" id="7579510">.</span><span class="ident" id="7579511">Encode</span><span class="op" id="7579517">(</span><span class="ident" id="7579518">test</span><span class="op" id="7579522">.</span><span class="ident" id="7579523">in</span><span class="op" id="7579525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579529">if</span>&nbsp;<span class="ident" id="7579532">err</span>&nbsp;<span class="op" id="7579536">!=</span>&nbsp;<span class="ident" id="7579539">nil</span>&nbsp;<span class="op" id="7579543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579548">t</span><span class="op" id="7579549">.</span><span class="ident" id="7579550">Errorf</span><span class="op" id="7579556">(</span><span class="string" id="7579557">&#34;error&nbsp;encoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7579580">,</span>&nbsp;<span class="ident" id="7579582">test</span><span class="op" id="7579586">.</span><span class="ident" id="7579587">in</span><span class="op" id="7579589">,</span>&nbsp;<span class="ident" id="7579591">err</span><span class="op" id="7579594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579599">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7579610">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579614">err</span>&nbsp;<span class="op" id="7579618">=</span>&nbsp;<span class="ident" id="7579620">dec</span><span class="op" id="7579623">.</span><span class="ident" id="7579624">Decode</span><span class="op" id="7579630">(</span><span class="ident" id="7579631">test</span><span class="op" id="7579635">.</span><span class="ident" id="7579636">out</span><span class="op" id="7579639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579643">switch</span>&nbsp;<span class="op" id="7579650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579654">case</span>&nbsp;<span class="ident" id="7579659">err</span>&nbsp;<span class="op" id="7579663">!=</span>&nbsp;<span class="ident" id="7579666">nil</span>&nbsp;<span class="op" id="7579670">&amp;&amp;</span>&nbsp;<span class="ident" id="7579673">test</span><span class="op" id="7579677">.</span><span class="ident" id="7579678">err</span>&nbsp;<span class="op" id="7579682">==</span>&nbsp;<span class="string" id="7579685">&#34;&#34;</span><span class="op" id="7579687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579692">t</span><span class="op" id="7579693">.</span><span class="ident" id="7579694">Errorf</span><span class="op" id="7579700">(</span><span class="string" id="7579701">&#34;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7579724">,</span>&nbsp;<span class="ident" id="7579726">test</span><span class="op" id="7579730">.</span><span class="ident" id="7579731">in</span><span class="op" id="7579733">,</span>&nbsp;<span class="ident" id="7579735">err</span><span class="op" id="7579738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579743">continue</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579754">case</span>&nbsp;<span class="ident" id="7579759">err</span>&nbsp;<span class="op" id="7579763">==</span>&nbsp;<span class="ident" id="7579766">nil</span>&nbsp;<span class="op" id="7579770">&amp;&amp;</span>&nbsp;<span class="ident" id="7579773">test</span><span class="op" id="7579777">.</span><span class="ident" id="7579778">err</span>&nbsp;<span class="op" id="7579782">!=</span>&nbsp;<span class="string" id="7579785">&#34;&#34;</span><span class="op" id="7579787">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579792">t</span><span class="op" id="7579793">.</span><span class="ident" id="7579794">Errorf</span><span class="op" id="7579800">(</span><span class="string" id="7579801">&#34;expected&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;%s&#34;</span><span class="op" id="7579833">,</span>&nbsp;<span class="ident" id="7579835">test</span><span class="op" id="7579839">.</span><span class="ident" id="7579840">in</span><span class="op" id="7579842">,</span>&nbsp;<span class="ident" id="7579844">test</span><span class="op" id="7579848">.</span><span class="ident" id="7579849">err</span><span class="op" id="7579852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579857">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579868">case</span>&nbsp;<span class="ident" id="7579873">err</span>&nbsp;<span class="op" id="7579877">!=</span>&nbsp;<span class="ident" id="7579880">nil</span>&nbsp;<span class="op" id="7579884">&amp;&amp;</span>&nbsp;<span class="ident" id="7579887">test</span><span class="op" id="7579891">.</span><span class="ident" id="7579892">err</span>&nbsp;<span class="op" id="7579896">!=</span>&nbsp;<span class="string" id="7579899">&#34;&#34;</span><span class="op" id="7579901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7579906">if</span>&nbsp;<span class="ident" id="7579909">strings</span><span class="op" id="7579916">.</span><span class="ident" id="7579917">Index</span><span class="op" id="7579922">(</span><span class="ident" id="7579923">err</span><span class="op" id="7579926">.</span><span class="ident" id="7579927">Error</span><span class="op" id="7579932">(</span><span class="op" id="7579933">)</span><span class="op" id="7579934">,</span>&nbsp;<span class="ident" id="7579936">test</span><span class="op" id="7579940">.</span><span class="ident" id="7579941">err</span><span class="op" id="7579944">)</span>&nbsp;<span class="op" id="7579946">&lt;</span>&nbsp;<span class="num" id="7579948">0</span>&nbsp;<span class="op" id="7579950">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7579956">t</span><span class="op" id="7579957">.</span><span class="ident" id="7579958">Errorf</span><span class="op" id="7579964">(</span><span class="string" id="7579965">&#34;wrong&nbsp;error&nbsp;decoding&nbsp;%v:&nbsp;wanted&nbsp;%s,&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7580009">,</span>&nbsp;<span class="ident" id="7580011">test</span><span class="op" id="7580015">.</span><span class="ident" id="7580016">in</span><span class="op" id="7580018">,</span>&nbsp;<span class="ident" id="7580020">test</span><span class="op" id="7580024">.</span><span class="ident" id="7580025">err</span><span class="op" id="7580028">,</span>&nbsp;<span class="ident" id="7580030">err</span><span class="op" id="7580033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580043">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7580058">//&nbsp;Get&nbsp;rid&nbsp;of&nbsp;the&nbsp;pointer&nbsp;in&nbsp;the&nbsp;rhs</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580097">val</span>&nbsp;<span class="op" id="7580101">:=</span>&nbsp;<span class="ident" id="7580104">reflect</span><span class="op" id="7580111">.</span><span class="ident" id="7580112">ValueOf</span><span class="op" id="7580119">(</span><span class="ident" id="7580120">test</span><span class="op" id="7580124">.</span><span class="ident" id="7580125">out</span><span class="op" id="7580128">)</span><span class="op" id="7580129">.</span><span class="ident" id="7580130">Elem</span><span class="op" id="7580134">(</span><span class="op" id="7580135">)</span><span class="op" id="7580136">.</span><span class="ident" id="7580137">Interface</span><span class="op" id="7580146">(</span><span class="op" id="7580147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580151">if</span>&nbsp;<span class="op" id="7580154">!</span><span class="ident" id="7580155">reflect</span><span class="op" id="7580162">.</span><span class="ident" id="7580163">DeepEqual</span><span class="op" id="7580172">(</span><span class="ident" id="7580173">test</span><span class="op" id="7580177">.</span><span class="ident" id="7580178">in</span><span class="op" id="7580180">,</span>&nbsp;<span class="ident" id="7580182">val</span><span class="op" id="7580185">)</span>&nbsp;<span class="op" id="7580187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580192">t</span><span class="op" id="7580193">.</span><span class="ident" id="7580194">Errorf</span><span class="op" id="7580200">(</span><span class="string" id="7580201">&#34;decoding&nbsp;singleton:&nbsp;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7580241">,</span>&nbsp;<span class="ident" id="7580243">test</span><span class="op" id="7580247">.</span><span class="ident" id="7580248">in</span><span class="op" id="7580250">,</span>&nbsp;<span class="ident" id="7580252">val</span><span class="op" id="7580255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580262">}</span><br>
<span class="lineno">420</span><span class="op" id="7580264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7580267">func</span>&nbsp;<span class="ident" id="7580272">TestStructNonStruct</span><span class="op" id="7580291">(</span><span class="ident" id="7580292">t</span>&nbsp;<span class="op" id="7580294">*</span><span class="ident" id="7580295">testing</span><span class="op" id="7580302">.</span><span class="ident" id="7580303">T</span><span class="op" id="7580304">)</span>&nbsp;<span class="op" id="7580306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580309">type</span>&nbsp;<span class="ident" id="7580314">Struct</span>&nbsp;<span class="keyword" id="7580321">struct</span>&nbsp;<span class="op" id="7580328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580332">A</span>&nbsp;<span class="builtintype" id="7580334">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580345">type</span>&nbsp;<span class="ident" id="7580350">NonStruct</span>&nbsp;<span class="builtintype" id="7580360">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580368">s</span>&nbsp;<span class="op" id="7580370">:=</span>&nbsp;<span class="ident" id="7580373">Struct</span><span class="op" id="7580379">{</span><span class="string" id="7580380">&#34;hello&#34;</span><span class="op" id="7580387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580390">var</span>&nbsp;<span class="ident" id="7580394">sp</span>&nbsp;<span class="ident" id="7580397">Struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580405">if</span>&nbsp;<span class="ident" id="7580408">err</span>&nbsp;<span class="op" id="7580412">:=</span>&nbsp;<span class="ident" id="7580415">encAndDec</span><span class="op" id="7580424">(</span><span class="ident" id="7580425">s</span><span class="op" id="7580426">,</span>&nbsp;<span class="op" id="7580428">&amp;</span><span class="ident" id="7580429">sp</span><span class="op" id="7580431">)</span><span class="op" id="7580432">;</span>&nbsp;<span class="ident" id="7580434">err</span>&nbsp;<span class="op" id="7580438">!=</span>&nbsp;<span class="ident" id="7580441">nil</span>&nbsp;<span class="op" id="7580445">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580449">t</span><span class="op" id="7580450">.</span><span class="ident" id="7580451">Error</span><span class="op" id="7580456">(</span><span class="ident" id="7580457">err</span><span class="op" id="7580460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580466">var</span>&nbsp;<span class="ident" id="7580470">ns</span>&nbsp;<span class="ident" id="7580473">NonStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580484">if</span>&nbsp;<span class="ident" id="7580487">err</span>&nbsp;<span class="op" id="7580491">:=</span>&nbsp;<span class="ident" id="7580494">encAndDec</span><span class="op" id="7580503">(</span><span class="ident" id="7580504">s</span><span class="op" id="7580505">,</span>&nbsp;<span class="op" id="7580507">&amp;</span><span class="ident" id="7580508">ns</span><span class="op" id="7580510">)</span><span class="op" id="7580511">;</span>&nbsp;<span class="ident" id="7580513">err</span>&nbsp;<span class="op" id="7580517">==</span>&nbsp;<span class="ident" id="7580520">nil</span>&nbsp;<span class="op" id="7580524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580528">t</span><span class="op" id="7580529">.</span><span class="ident" id="7580530">Error</span><span class="op" id="7580535">(</span><span class="string" id="7580536">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;struct/non-struct&#34;</span><span class="op" id="7580576">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580579">}</span>&nbsp;<span class="keyword" id="7580581">else</span>&nbsp;<span class="keyword" id="7580586">if</span>&nbsp;<span class="ident" id="7580589">strings</span><span class="op" id="7580596">.</span><span class="ident" id="7580597">Index</span><span class="op" id="7580602">(</span><span class="ident" id="7580603">err</span><span class="op" id="7580606">.</span><span class="ident" id="7580607">Error</span><span class="op" id="7580612">(</span><span class="op" id="7580613">)</span><span class="op" id="7580614">,</span>&nbsp;<span class="string" id="7580616">&#34;type&#34;</span><span class="op" id="7580622">)</span>&nbsp;<span class="op" id="7580624">&lt;</span>&nbsp;<span class="num" id="7580626">0</span>&nbsp;<span class="op" id="7580628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580632">t</span><span class="op" id="7580633">.</span><span class="ident" id="7580634">Error</span><span class="op" id="7580639">(</span><span class="string" id="7580640">&#34;for&nbsp;struct/non-struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7580688">,</span>&nbsp;<span class="ident" id="7580690">err</span><span class="op" id="7580693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7580699">//&nbsp;Now&nbsp;try&nbsp;the&nbsp;other&nbsp;way</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580725">var</span>&nbsp;<span class="ident" id="7580729">nsp</span>&nbsp;<span class="ident" id="7580733">NonStruct</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580744">if</span>&nbsp;<span class="ident" id="7580747">err</span>&nbsp;<span class="op" id="7580751">:=</span>&nbsp;<span class="ident" id="7580754">encAndDec</span><span class="op" id="7580763">(</span><span class="ident" id="7580764">ns</span><span class="op" id="7580766">,</span>&nbsp;<span class="op" id="7580768">&amp;</span><span class="ident" id="7580769">nsp</span><span class="op" id="7580772">)</span><span class="op" id="7580773">;</span>&nbsp;<span class="ident" id="7580775">err</span>&nbsp;<span class="op" id="7580779">!=</span>&nbsp;<span class="ident" id="7580782">nil</span>&nbsp;<span class="op" id="7580786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580790">t</span><span class="op" id="7580791">.</span><span class="ident" id="7580792">Error</span><span class="op" id="7580797">(</span><span class="ident" id="7580798">err</span><span class="op" id="7580801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7580807">if</span>&nbsp;<span class="ident" id="7580810">err</span>&nbsp;<span class="op" id="7580814">:=</span>&nbsp;<span class="ident" id="7580817">encAndDec</span><span class="op" id="7580826">(</span><span class="ident" id="7580827">ns</span><span class="op" id="7580829">,</span>&nbsp;<span class="op" id="7580831">&amp;</span><span class="ident" id="7580832">s</span><span class="op" id="7580833">)</span><span class="op" id="7580834">;</span>&nbsp;<span class="ident" id="7580836">err</span>&nbsp;<span class="op" id="7580840">==</span>&nbsp;<span class="ident" id="7580843">nil</span>&nbsp;<span class="op" id="7580847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580851">t</span><span class="op" id="7580852">.</span><span class="ident" id="7580853">Error</span><span class="op" id="7580858">(</span><span class="string" id="7580859">&#34;should&nbsp;get&nbsp;error&nbsp;for&nbsp;non-struct/struct&#34;</span><span class="op" id="7580899">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7580902">}</span>&nbsp;<span class="keyword" id="7580904">else</span>&nbsp;<span class="keyword" id="7580909">if</span>&nbsp;<span class="ident" id="7580912">strings</span><span class="op" id="7580919">.</span><span class="ident" id="7580920">Index</span><span class="op" id="7580925">(</span><span class="ident" id="7580926">err</span><span class="op" id="7580929">.</span><span class="ident" id="7580930">Error</span><span class="op" id="7580935">(</span><span class="op" id="7580936">)</span><span class="op" id="7580937">,</span>&nbsp;<span class="string" id="7580939">&#34;type&#34;</span><span class="op" id="7580945">)</span>&nbsp;<span class="op" id="7580947">&lt;</span>&nbsp;<span class="num" id="7580949">0</span>&nbsp;<span class="op" id="7580951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7580955">t</span><span class="op" id="7580956">.</span><span class="ident" id="7580957">Error</span><span class="op" id="7580962">(</span><span class="string" id="7580963">&#34;for&nbsp;non-struct/struct&nbsp;expected&nbsp;type&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7581011">,</span>&nbsp;<span class="ident" id="7581013">err</span><span class="op" id="7581016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7581019">}</span><br>
<span class="lineno"></span><span class="op" id="7581021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span><span class="keyword" id="7581024">type</span>&nbsp;<span class="ident" id="7581029">interfaceIndirectTestI</span>&nbsp;<span class="keyword" id="7581052">interface</span>&nbsp;<span class="op" id="7581062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581065">F</span><span class="op" id="7581066">(</span><span class="op" id="7581067">)</span>&nbsp;<span class="builtintype" id="7581069">bool</span><br>
<span class="lineno"></span><span class="op" id="7581074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7581077">type</span>&nbsp;<span class="ident" id="7581082">interfaceIndirectTestT</span>&nbsp;<span class="keyword" id="7581105">struct</span><span class="op" id="7581111">{</span><span class="op" id="7581112">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="7581115">func</span>&nbsp;<span class="op" id="7581120">(</span><span class="ident" id="7581121">this</span>&nbsp;<span class="op" id="7581126">*</span><span class="ident" id="7581127">interfaceIndirectTestT</span><span class="op" id="7581149">)</span>&nbsp;<span class="ident" id="7581151">F</span><span class="op" id="7581152">(</span><span class="op" id="7581153">)</span>&nbsp;<span class="builtintype" id="7581155">bool</span>&nbsp;<span class="op" id="7581160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7581163">return</span>&nbsp;<span class="builtintype" id="7581170">true</span><br>
<span class="lineno"></span><span class="op" id="7581175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="comment" id="7581178">//&nbsp;A&nbsp;version&nbsp;of&nbsp;a&nbsp;bug&nbsp;reported&nbsp;on&nbsp;golang-nuts.&nbsp;&nbsp;Also&nbsp;tests&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="7581247">//&nbsp;slice&nbsp;of&nbsp;interfaces.&nbsp;&nbsp;The&nbsp;issue&nbsp;was&nbsp;registering&nbsp;*T&nbsp;caused&nbsp;T&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="7581316">//&nbsp;stored&nbsp;as&nbsp;the&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="7581348">func</span>&nbsp;<span class="ident" id="7581353">TestInterfaceIndirect</span><span class="op" id="7581374">(</span><span class="ident" id="7581375">t</span>&nbsp;<span class="op" id="7581377">*</span><span class="ident" id="7581378">testing</span><span class="op" id="7581385">.</span><span class="ident" id="7581386">T</span><span class="op" id="7581387">)</span>&nbsp;<span class="op" id="7581389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581392">Register</span><span class="op" id="7581400">(</span><span class="op" id="7581401">&amp;</span><span class="ident" id="7581402">interfaceIndirectTestT</span><span class="op" id="7581424">{</span><span class="op" id="7581425">}</span><span class="op" id="7581426">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581429">b</span>&nbsp;<span class="op" id="7581431">:=</span>&nbsp;<span class="builtinfunc" id="7581434">new</span><span class="op" id="7581437">(</span><span class="ident" id="7581438">bytes</span><span class="op" id="7581443">.</span><span class="ident" id="7581444">Buffer</span><span class="op" id="7581450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581453">w</span>&nbsp;<span class="op" id="7581455">:=</span>&nbsp;<span class="op" id="7581458">[</span><span class="op" id="7581459">]</span><span class="ident" id="7581460">interfaceIndirectTestI</span><span class="op" id="7581482">{</span><span class="op" id="7581483">&amp;</span><span class="ident" id="7581484">interfaceIndirectTestT</span><span class="op" id="7581506">{</span><span class="op" id="7581507">}</span><span class="op" id="7581508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581511">err</span>&nbsp;<span class="op" id="7581515">:=</span>&nbsp;<span class="ident" id="7581518">NewEncoder</span><span class="op" id="7581528">(</span><span class="ident" id="7581529">b</span><span class="op" id="7581530">)</span><span class="op" id="7581531">.</span><span class="ident" id="7581532">Encode</span><span class="op" id="7581538">(</span><span class="ident" id="7581539">w</span><span class="op" id="7581540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7581543">if</span>&nbsp;<span class="ident" id="7581546">err</span>&nbsp;<span class="op" id="7581550">!=</span>&nbsp;<span class="ident" id="7581553">nil</span>&nbsp;<span class="op" id="7581557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581561">t</span><span class="op" id="7581562">.</span><span class="ident" id="7581563">Fatal</span><span class="op" id="7581568">(</span><span class="string" id="7581569">&#34;encode&nbsp;error:&#34;</span><span class="op" id="7581584">,</span>&nbsp;<span class="ident" id="7581586">err</span><span class="op" id="7581589">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7581592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7581596">var</span>&nbsp;<span class="ident" id="7581600">r</span>&nbsp;<span class="op" id="7581602">[</span><span class="op" id="7581603">]</span><span class="ident" id="7581604">interfaceIndirectTestI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581628">err</span>&nbsp;<span class="op" id="7581632">=</span>&nbsp;<span class="ident" id="7581634">NewDecoder</span><span class="op" id="7581644">(</span><span class="ident" id="7581645">b</span><span class="op" id="7581646">)</span><span class="op" id="7581647">.</span><span class="ident" id="7581648">Decode</span><span class="op" id="7581654">(</span><span class="op" id="7581655">&amp;</span><span class="ident" id="7581656">r</span><span class="op" id="7581657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7581660">if</span>&nbsp;<span class="ident" id="7581663">err</span>&nbsp;<span class="op" id="7581667">!=</span>&nbsp;<span class="ident" id="7581670">nil</span>&nbsp;<span class="op" id="7581674">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7581678">t</span><span class="op" id="7581679">.</span><span class="ident" id="7581680">Fatal</span><span class="op" id="7581685">(</span><span class="string" id="7581686">&#34;decode&nbsp;error:&#34;</span><span class="op" id="7581701">,</span>&nbsp;<span class="ident" id="7581703">err</span><span class="op" id="7581706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7581709">}</span><br>
<span class="lineno"></span><span class="op" id="7581711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7581714">//&nbsp;Now&nbsp;follow&nbsp;various&nbsp;tests&nbsp;that&nbsp;decode&nbsp;into&nbsp;things&nbsp;that&nbsp;can&#39;t&nbsp;represent&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="7581791">//&nbsp;encoded&nbsp;value,&nbsp;all&nbsp;of&nbsp;which&nbsp;should&nbsp;be&nbsp;legal.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7581840">//&nbsp;Also,&nbsp;when&nbsp;the&nbsp;ignored&nbsp;object&nbsp;contains&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;may&nbsp;define</span><br>
<span class="lineno"></span><span class="comment" id="7581916">//&nbsp;types.&nbsp;Make&nbsp;sure&nbsp;that&nbsp;skipping&nbsp;the&nbsp;value&nbsp;still&nbsp;defines&nbsp;the&nbsp;types&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="7581993">//&nbsp;the&nbsp;encoder/decoder&nbsp;pair&nbsp;to&nbsp;send&nbsp;a&nbsp;value&nbsp;afterwards.&nbsp;&nbsp;If&nbsp;an&nbsp;interface</span><br>
<span class="lineno">485</span><span class="comment" id="7582066">//&nbsp;is&nbsp;sent,&nbsp;its&nbsp;type&nbsp;in&nbsp;the&nbsp;test&nbsp;is&nbsp;always&nbsp;NewType0,&nbsp;so&nbsp;this&nbsp;checks&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7582143">//&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;don&#39;t&nbsp;skew&nbsp;with&nbsp;respect&nbsp;to&nbsp;type&nbsp;definitions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7582212">type</span>&nbsp;<span class="ident" id="7582217">Struct0</span>&nbsp;<span class="keyword" id="7582225">struct</span>&nbsp;<span class="op" id="7582232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7582235">I</span>&nbsp;<span class="keyword" id="7582237">interface</span><span class="op" id="7582246">{</span><span class="op" id="7582247">}</span><br>
<span class="lineno">490</span><span class="op" id="7582249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7582252">type</span>&nbsp;<span class="ident" id="7582257">NewType0</span>&nbsp;<span class="keyword" id="7582266">struct</span>&nbsp;<span class="op" id="7582273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7582276">S</span>&nbsp;<span class="builtintype" id="7582278">string</span><br>
<span class="lineno"></span><span class="op" id="7582285">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="7582288">type</span>&nbsp;<span class="ident" id="7582293">ignoreTest</span>&nbsp;<span class="keyword" id="7582304">struct</span>&nbsp;<span class="op" id="7582311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7582314">in</span><span class="op" id="7582316">,</span>&nbsp;<span class="ident" id="7582318">out</span>&nbsp;<span class="keyword" id="7582322">interface</span><span class="op" id="7582331">{</span><span class="op" id="7582332">}</span><br>
<span class="lineno"></span><span class="op" id="7582334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="7582337">var</span>&nbsp;<span class="ident" id="7582341">ignoreTests</span>&nbsp;<span class="op" id="7582353">=</span>&nbsp;<span class="op" id="7582355">[</span><span class="op" id="7582356">]</span><span class="ident" id="7582357">ignoreTest</span><span class="op" id="7582367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7582370">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;an&nbsp;empty&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7582416">{</span><span class="op" id="7582417">&amp;</span><span class="keyword" id="7582418">struct</span><span class="op" id="7582424">{</span>&nbsp;<span class="ident" id="7582426">A</span>&nbsp;<span class="builtintype" id="7582428">int</span>&nbsp;<span class="op" id="7582432">}</span><span class="op" id="7582433">{</span><span class="num" id="7582434">23</span><span class="op" id="7582436">}</span><span class="op" id="7582437">,</span>&nbsp;<span class="op" id="7582439">&amp;</span><span class="keyword" id="7582440">struct</span><span class="op" id="7582446">{</span><span class="op" id="7582447">}</span><span class="op" id="7582448">{</span><span class="op" id="7582449">}</span><span class="op" id="7582450">}</span><span class="op" id="7582451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7582454">//&nbsp;Decode&nbsp;normal&nbsp;struct&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7582491">{</span><span class="op" id="7582492">&amp;</span><span class="keyword" id="7582493">struct</span><span class="op" id="7582499">{</span>&nbsp;<span class="ident" id="7582501">A</span>&nbsp;<span class="builtintype" id="7582503">int</span>&nbsp;<span class="op" id="7582507">}</span><span class="op" id="7582508">{</span><span class="num" id="7582509">23</span><span class="op" id="7582511">}</span><span class="op" id="7582512">,</span>&nbsp;<span class="ident" id="7582514">nil</span><span class="op" id="7582517">}</span><span class="op" id="7582518">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7582521">//&nbsp;Decode&nbsp;singleton&nbsp;string&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7582561">{</span><span class="string" id="7582562">&#34;hello,&nbsp;world&#34;</span><span class="op" id="7582576">,</span>&nbsp;<span class="ident" id="7582578">nil</span><span class="op" id="7582581">}</span><span class="op" id="7582582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7582585">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7582624">{</span><span class="op" id="7582625">[</span><span class="op" id="7582626">]</span><span class="builtintype" id="7582627">int</span><span class="op" id="7582630">{</span><span class="num" id="7582631">1</span><span class="op" id="7582632">,</span>&nbsp;<span class="num" id="7582634">2</span><span class="op" id="7582635">,</span>&nbsp;<span class="num" id="7582637">3</span><span class="op" id="7582638">,</span>&nbsp;<span class="num" id="7582640">4</span><span class="op" id="7582641">}</span><span class="op" id="7582642">,</span>&nbsp;<span class="ident" id="7582644">nil</span><span class="op" id="7582647">}</span><span class="op" id="7582648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7582651">//&nbsp;Decode&nbsp;struct&nbsp;containing&nbsp;an&nbsp;interface&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7582705">{</span><span class="op" id="7582706">&amp;</span><span class="ident" id="7582707">Struct0</span><span class="op" id="7582714">{</span><span class="op" id="7582715">&amp;</span><span class="ident" id="7582716">NewType0</span><span class="op" id="7582724">{</span><span class="string" id="7582725">&#34;value0&#34;</span><span class="op" id="7582733">}</span><span class="op" id="7582734">}</span><span class="op" id="7582735">,</span>&nbsp;<span class="ident" id="7582737">nil</span><span class="op" id="7582740">}</span><span class="op" id="7582741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7582744">//&nbsp;Decode&nbsp;singleton&nbsp;slice&nbsp;of&nbsp;interfaces&nbsp;into&nbsp;a&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7582797">{</span><span class="op" id="7582798">[</span><span class="op" id="7582799">]</span><span class="keyword" id="7582800">interface</span><span class="op" id="7582809">{</span><span class="op" id="7582810">}</span><span class="op" id="7582811">{</span><span class="string" id="7582812">&#34;hi&#34;</span><span class="op" id="7582816">,</span>&nbsp;<span class="op" id="7582818">&amp;</span><span class="ident" id="7582819">NewType0</span><span class="op" id="7582827">{</span><span class="string" id="7582828">&#34;value1&#34;</span><span class="op" id="7582836">}</span><span class="op" id="7582837">,</span>&nbsp;<span class="num" id="7582839">23</span><span class="op" id="7582841">}</span><span class="op" id="7582842">,</span>&nbsp;<span class="ident" id="7582844">nil</span><span class="op" id="7582847">}</span><span class="op" id="7582848">,</span><br>
<span class="lineno"></span><span class="op" id="7582850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7582853">func</span>&nbsp;<span class="ident" id="7582858">TestDecodeIntoNothing</span><span class="op" id="7582879">(</span><span class="ident" id="7582880">t</span>&nbsp;<span class="op" id="7582882">*</span><span class="ident" id="7582883">testing</span><span class="op" id="7582890">.</span><span class="ident" id="7582891">T</span><span class="op" id="7582892">)</span>&nbsp;<span class="op" id="7582894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7582897">Register</span><span class="op" id="7582905">(</span><span class="builtinfunc" id="7582906">new</span><span class="op" id="7582909">(</span><span class="ident" id="7582910">NewType0</span><span class="op" id="7582918">)</span><span class="op" id="7582919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7582922">for</span>&nbsp;<span class="ident" id="7582926">i</span><span class="op" id="7582927">,</span>&nbsp;<span class="ident" id="7582929">test</span>&nbsp;<span class="op" id="7582934">:=</span>&nbsp;<span class="keyword" id="7582937">range</span>&nbsp;<span class="ident" id="7582943">ignoreTests</span>&nbsp;<span class="op" id="7582955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7582959">b</span>&nbsp;<span class="op" id="7582961">:=</span>&nbsp;<span class="builtinfunc" id="7582964">new</span><span class="op" id="7582967">(</span><span class="ident" id="7582968">bytes</span><span class="op" id="7582973">.</span><span class="ident" id="7582974">Buffer</span><span class="op" id="7582980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7582984">enc</span>&nbsp;<span class="op" id="7582988">:=</span>&nbsp;<span class="ident" id="7582991">NewEncoder</span><span class="op" id="7583001">(</span><span class="ident" id="7583002">b</span><span class="op" id="7583003">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583007">err</span>&nbsp;<span class="op" id="7583011">:=</span>&nbsp;<span class="ident" id="7583014">enc</span><span class="op" id="7583017">.</span><span class="ident" id="7583018">Encode</span><span class="op" id="7583024">(</span><span class="ident" id="7583025">test</span><span class="op" id="7583029">.</span><span class="ident" id="7583030">in</span><span class="op" id="7583032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583036">if</span>&nbsp;<span class="ident" id="7583039">err</span>&nbsp;<span class="op" id="7583043">!=</span>&nbsp;<span class="ident" id="7583046">nil</span>&nbsp;<span class="op" id="7583050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583055">t</span><span class="op" id="7583056">.</span><span class="ident" id="7583057">Errorf</span><span class="op" id="7583063">(</span><span class="string" id="7583064">&#34;%d:&nbsp;encode&nbsp;error&nbsp;%s:&#34;</span><span class="op" id="7583086">,</span>&nbsp;<span class="ident" id="7583088">i</span><span class="op" id="7583089">,</span>&nbsp;<span class="ident" id="7583091">err</span><span class="op" id="7583094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583099">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7583110">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583114">dec</span>&nbsp;<span class="op" id="7583118">:=</span>&nbsp;<span class="ident" id="7583121">NewDecoder</span><span class="op" id="7583131">(</span><span class="ident" id="7583132">b</span><span class="op" id="7583133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583137">err</span>&nbsp;<span class="op" id="7583141">=</span>&nbsp;<span class="ident" id="7583143">dec</span><span class="op" id="7583146">.</span><span class="ident" id="7583147">Decode</span><span class="op" id="7583153">(</span><span class="ident" id="7583154">test</span><span class="op" id="7583158">.</span><span class="ident" id="7583159">out</span><span class="op" id="7583162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583166">if</span>&nbsp;<span class="ident" id="7583169">err</span>&nbsp;<span class="op" id="7583173">!=</span>&nbsp;<span class="ident" id="7583176">nil</span>&nbsp;<span class="op" id="7583180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583185">t</span><span class="op" id="7583186">.</span><span class="ident" id="7583187">Errorf</span><span class="op" id="7583193">(</span><span class="string" id="7583194">&#34;%d:&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7583216">,</span>&nbsp;<span class="ident" id="7583218">i</span><span class="op" id="7583219">,</span>&nbsp;<span class="ident" id="7583221">err</span><span class="op" id="7583224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583229">continue</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7583240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7583244">//&nbsp;Now&nbsp;see&nbsp;if&nbsp;the&nbsp;encoder&nbsp;and&nbsp;decoder&nbsp;are&nbsp;in&nbsp;a&nbsp;consistent&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583311">str</span>&nbsp;<span class="op" id="7583315">:=</span>&nbsp;<span class="ident" id="7583318">fmt</span><span class="op" id="7583321">.</span><span class="ident" id="7583322">Sprintf</span><span class="op" id="7583329">(</span><span class="string" id="7583330">&#34;Value&nbsp;%d&#34;</span><span class="op" id="7583340">,</span>&nbsp;<span class="ident" id="7583342">i</span><span class="op" id="7583343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583347">err</span>&nbsp;<span class="op" id="7583351">=</span>&nbsp;<span class="ident" id="7583353">enc</span><span class="op" id="7583356">.</span><span class="ident" id="7583357">Encode</span><span class="op" id="7583363">(</span><span class="op" id="7583364">&amp;</span><span class="ident" id="7583365">NewType0</span><span class="op" id="7583373">{</span><span class="ident" id="7583374">str</span><span class="op" id="7583377">}</span><span class="op" id="7583378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583382">if</span>&nbsp;<span class="ident" id="7583385">err</span>&nbsp;<span class="op" id="7583389">!=</span>&nbsp;<span class="ident" id="7583392">nil</span>&nbsp;<span class="op" id="7583396">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583401">t</span><span class="op" id="7583402">.</span><span class="ident" id="7583403">Fatalf</span><span class="op" id="7583409">(</span><span class="string" id="7583410">&#34;%d:&nbsp;NewType0&nbsp;encode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7583441">,</span>&nbsp;<span class="ident" id="7583443">i</span><span class="op" id="7583444">,</span>&nbsp;<span class="ident" id="7583446">err</span><span class="op" id="7583449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7583453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583457">ns</span>&nbsp;<span class="op" id="7583460">:=</span>&nbsp;<span class="builtinfunc" id="7583463">new</span><span class="op" id="7583466">(</span><span class="ident" id="7583467">NewType0</span><span class="op" id="7583475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583479">err</span>&nbsp;<span class="op" id="7583483">=</span>&nbsp;<span class="ident" id="7583485">dec</span><span class="op" id="7583488">.</span><span class="ident" id="7583489">Decode</span><span class="op" id="7583495">(</span><span class="ident" id="7583496">ns</span><span class="op" id="7583498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583502">if</span>&nbsp;<span class="ident" id="7583505">err</span>&nbsp;<span class="op" id="7583509">!=</span>&nbsp;<span class="ident" id="7583512">nil</span>&nbsp;<span class="op" id="7583516">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583521">t</span><span class="op" id="7583522">.</span><span class="ident" id="7583523">Fatalf</span><span class="op" id="7583529">(</span><span class="string" id="7583530">&#34;%d:&nbsp;NewType0&nbsp;decode&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7583561">,</span>&nbsp;<span class="ident" id="7583563">i</span><span class="op" id="7583564">,</span>&nbsp;<span class="ident" id="7583566">err</span><span class="op" id="7583569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7583573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583577">if</span>&nbsp;<span class="ident" id="7583580">ns</span><span class="op" id="7583582">.</span><span class="ident" id="7583583">S</span>&nbsp;<span class="op" id="7583585">!=</span>&nbsp;<span class="ident" id="7583588">str</span>&nbsp;<span class="op" id="7583592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583597">t</span><span class="op" id="7583598">.</span><span class="ident" id="7583599">Fatalf</span><span class="op" id="7583605">(</span><span class="string" id="7583606">&#34;%d:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7583630">,</span>&nbsp;<span class="ident" id="7583632">i</span><span class="op" id="7583633">,</span>&nbsp;<span class="ident" id="7583635">str</span><span class="op" id="7583638">,</span>&nbsp;<span class="ident" id="7583640">ns</span><span class="op" id="7583642">.</span><span class="ident" id="7583643">S</span><span class="op" id="7583644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7583648">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7583651">}</span><br>
<span class="lineno"></span><span class="op" id="7583653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7583656">//&nbsp;Another&nbsp;bug&nbsp;from&nbsp;golang-nuts,&nbsp;involving&nbsp;nested&nbsp;interfaces.</span><br>
<span class="lineno"></span><span class="keyword" id="7583718">type</span>&nbsp;<span class="ident" id="7583723">Bug0Outer</span>&nbsp;<span class="keyword" id="7583733">struct</span>&nbsp;<span class="op" id="7583740">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583743">Bug0Field</span>&nbsp;<span class="keyword" id="7583753">interface</span><span class="op" id="7583762">{</span><span class="op" id="7583763">}</span><br>
<span class="lineno"></span><span class="op" id="7583765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7583768">type</span>&nbsp;<span class="ident" id="7583773">Bug0Inner</span>&nbsp;<span class="keyword" id="7583783">struct</span>&nbsp;<span class="op" id="7583790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583793">A</span>&nbsp;<span class="builtintype" id="7583795">int</span><br>
<span class="lineno">555</span><span class="op" id="7583799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7583802">func</span>&nbsp;<span class="ident" id="7583807">TestNestedInterfaces</span><span class="op" id="7583827">(</span><span class="ident" id="7583828">t</span>&nbsp;<span class="op" id="7583830">*</span><span class="ident" id="7583831">testing</span><span class="op" id="7583838">.</span><span class="ident" id="7583839">T</span><span class="op" id="7583840">)</span>&nbsp;<span class="op" id="7583842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7583845">var</span>&nbsp;<span class="ident" id="7583849">buf</span>&nbsp;<span class="ident" id="7583853">bytes</span><span class="op" id="7583858">.</span><span class="ident" id="7583859">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583867">e</span>&nbsp;<span class="op" id="7583869">:=</span>&nbsp;<span class="ident" id="7583872">NewEncoder</span><span class="op" id="7583882">(</span><span class="op" id="7583883">&amp;</span><span class="ident" id="7583884">buf</span><span class="op" id="7583887">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583890">d</span>&nbsp;<span class="op" id="7583892">:=</span>&nbsp;<span class="ident" id="7583895">NewDecoder</span><span class="op" id="7583905">(</span><span class="op" id="7583906">&amp;</span><span class="ident" id="7583907">buf</span><span class="op" id="7583910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583913">Register</span><span class="op" id="7583921">(</span><span class="builtinfunc" id="7583922">new</span><span class="op" id="7583925">(</span><span class="ident" id="7583926">Bug0Outer</span><span class="op" id="7583935">)</span><span class="op" id="7583936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583939">Register</span><span class="op" id="7583947">(</span><span class="builtinfunc" id="7583948">new</span><span class="op" id="7583951">(</span><span class="ident" id="7583952">Bug0Inner</span><span class="op" id="7583961">)</span><span class="op" id="7583962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583965">f</span>&nbsp;<span class="op" id="7583967">:=</span>&nbsp;<span class="op" id="7583970">&amp;</span><span class="ident" id="7583971">Bug0Outer</span><span class="op" id="7583980">{</span><span class="op" id="7583981">&amp;</span><span class="ident" id="7583982">Bug0Outer</span><span class="op" id="7583991">{</span><span class="op" id="7583992">&amp;</span><span class="ident" id="7583993">Bug0Inner</span><span class="op" id="7584002">{</span><span class="num" id="7584003">7</span><span class="op" id="7584004">}</span><span class="op" id="7584005">}</span><span class="op" id="7584006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584009">var</span>&nbsp;<span class="ident" id="7584013">v</span>&nbsp;<span class="keyword" id="7584015">interface</span><span class="op" id="7584024">{</span><span class="op" id="7584025">}</span>&nbsp;<span class="op" id="7584027">=</span>&nbsp;<span class="ident" id="7584029">f</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584032">err</span>&nbsp;<span class="op" id="7584036">:=</span>&nbsp;<span class="ident" id="7584039">e</span><span class="op" id="7584040">.</span><span class="ident" id="7584041">Encode</span><span class="op" id="7584047">(</span><span class="op" id="7584048">&amp;</span><span class="ident" id="7584049">v</span><span class="op" id="7584050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584053">if</span>&nbsp;<span class="ident" id="7584056">err</span>&nbsp;<span class="op" id="7584060">!=</span>&nbsp;<span class="ident" id="7584063">nil</span>&nbsp;<span class="op" id="7584067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584071">t</span><span class="op" id="7584072">.</span><span class="ident" id="7584073">Fatal</span><span class="op" id="7584078">(</span><span class="string" id="7584079">&#34;Encode:&#34;</span><span class="op" id="7584088">,</span>&nbsp;<span class="ident" id="7584090">err</span><span class="op" id="7584093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584099">err</span>&nbsp;<span class="op" id="7584103">=</span>&nbsp;<span class="ident" id="7584105">d</span><span class="op" id="7584106">.</span><span class="ident" id="7584107">Decode</span><span class="op" id="7584113">(</span><span class="op" id="7584114">&amp;</span><span class="ident" id="7584115">v</span><span class="op" id="7584116">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584119">if</span>&nbsp;<span class="ident" id="7584122">err</span>&nbsp;<span class="op" id="7584126">!=</span>&nbsp;<span class="ident" id="7584129">nil</span>&nbsp;<span class="op" id="7584133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584137">t</span><span class="op" id="7584138">.</span><span class="ident" id="7584139">Fatal</span><span class="op" id="7584144">(</span><span class="string" id="7584145">&#34;Decode:&#34;</span><span class="op" id="7584154">,</span>&nbsp;<span class="ident" id="7584156">err</span><span class="op" id="7584159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7584165">//&nbsp;Make&nbsp;sure&nbsp;it&nbsp;decoded&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584201">outer1</span><span class="op" id="7584207">,</span>&nbsp;<span class="ident" id="7584209">ok</span>&nbsp;<span class="op" id="7584212">:=</span>&nbsp;<span class="ident" id="7584215">v</span><span class="op" id="7584216">.</span><span class="op" id="7584217">(</span><span class="op" id="7584218">*</span><span class="ident" id="7584219">Bug0Outer</span><span class="op" id="7584228">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584231">if</span>&nbsp;<span class="op" id="7584234">!</span><span class="ident" id="7584235">ok</span>&nbsp;<span class="op" id="7584238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584242">t</span><span class="op" id="7584243">.</span><span class="ident" id="7584244">Fatalf</span><span class="op" id="7584250">(</span><span class="string" id="7584251">&#34;v&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="7584272">,</span>&nbsp;<span class="ident" id="7584274">v</span><span class="op" id="7584275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584281">outer2</span><span class="op" id="7584287">,</span>&nbsp;<span class="ident" id="7584289">ok</span>&nbsp;<span class="op" id="7584292">:=</span>&nbsp;<span class="ident" id="7584295">outer1</span><span class="op" id="7584301">.</span><span class="ident" id="7584302">Bug0Field</span><span class="op" id="7584311">.</span><span class="op" id="7584312">(</span><span class="op" id="7584313">*</span><span class="ident" id="7584314">Bug0Outer</span><span class="op" id="7584323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584326">if</span>&nbsp;<span class="op" id="7584329">!</span><span class="ident" id="7584330">ok</span>&nbsp;<span class="op" id="7584333">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584337">t</span><span class="op" id="7584338">.</span><span class="ident" id="7584339">Fatalf</span><span class="op" id="7584345">(</span><span class="string" id="7584346">&#34;v.Bug0Field&nbsp;not&nbsp;Bug0Outer:&nbsp;%T&#34;</span><span class="op" id="7584377">,</span>&nbsp;<span class="ident" id="7584379">outer1</span><span class="op" id="7584385">.</span><span class="ident" id="7584386">Bug0Field</span><span class="op" id="7584395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584401">inner</span><span class="op" id="7584406">,</span>&nbsp;<span class="ident" id="7584408">ok</span>&nbsp;<span class="op" id="7584411">:=</span>&nbsp;<span class="ident" id="7584414">outer2</span><span class="op" id="7584420">.</span><span class="ident" id="7584421">Bug0Field</span><span class="op" id="7584430">.</span><span class="op" id="7584431">(</span><span class="op" id="7584432">*</span><span class="ident" id="7584433">Bug0Inner</span><span class="op" id="7584442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584445">if</span>&nbsp;<span class="op" id="7584448">!</span><span class="ident" id="7584449">ok</span>&nbsp;<span class="op" id="7584452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584456">t</span><span class="op" id="7584457">.</span><span class="ident" id="7584458">Fatalf</span><span class="op" id="7584464">(</span><span class="string" id="7584465">&#34;v.Bug0Field.Bug0Field&nbsp;not&nbsp;Bug0Inner:&nbsp;%T&#34;</span><span class="op" id="7584506">,</span>&nbsp;<span class="ident" id="7584508">outer2</span><span class="op" id="7584514">.</span><span class="ident" id="7584515">Bug0Field</span><span class="op" id="7584524">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584530">if</span>&nbsp;<span class="ident" id="7584533">inner</span><span class="op" id="7584538">.</span><span class="ident" id="7584539">A</span>&nbsp;<span class="op" id="7584541">!=</span>&nbsp;<span class="num" id="7584544">7</span>&nbsp;<span class="op" id="7584546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584550">t</span><span class="op" id="7584551">.</span><span class="ident" id="7584552">Fatalf</span><span class="op" id="7584558">(</span><span class="string" id="7584559">&#34;final&nbsp;value&nbsp;%d;&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7584588">,</span>&nbsp;<span class="ident" id="7584590">inner</span><span class="op" id="7584595">.</span><span class="ident" id="7584596">A</span><span class="op" id="7584597">,</span>&nbsp;<span class="num" id="7584599">7</span><span class="op" id="7584600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584603">}</span><br>
<span class="lineno"></span><span class="op" id="7584605">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="7584608">//&nbsp;The&nbsp;bugs&nbsp;keep&nbsp;coming.&nbsp;We&nbsp;forgot&nbsp;to&nbsp;send&nbsp;map&nbsp;subtypes&nbsp;before&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7584681">type</span>&nbsp;<span class="ident" id="7584686">Bug1Elem</span>&nbsp;<span class="keyword" id="7584695">struct</span>&nbsp;<span class="op" id="7584702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584705">Name</span>&nbsp;<span class="builtintype" id="7584710">string</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584718">Id</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7584723">int</span><br>
<span class="lineno"></span><span class="op" id="7584727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7584730">type</span>&nbsp;<span class="ident" id="7584735">Bug1StructMap</span>&nbsp;<span class="keyword" id="7584749">map</span><span class="op" id="7584752">[</span><span class="builtintype" id="7584753">string</span><span class="op" id="7584759">]</span><span class="ident" id="7584760">Bug1Elem</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span><span class="keyword" id="7584770">func</span>&nbsp;<span class="ident" id="7584775">bug1EncDec</span><span class="op" id="7584785">(</span><span class="ident" id="7584786">in</span>&nbsp;<span class="ident" id="7584789">Bug1StructMap</span><span class="op" id="7584802">,</span>&nbsp;<span class="ident" id="7584804">out</span>&nbsp;<span class="op" id="7584808">*</span><span class="ident" id="7584809">Bug1StructMap</span><span class="op" id="7584822">)</span>&nbsp;<span class="builtintype" id="7584824">error</span>&nbsp;<span class="op" id="7584830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7584833">return</span>&nbsp;<span class="ident" id="7584840">nil</span><br>
<span class="lineno"></span><span class="op" id="7584844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7584847">func</span>&nbsp;<span class="ident" id="7584852">TestMapBug1</span><span class="op" id="7584863">(</span><span class="ident" id="7584864">t</span>&nbsp;<span class="op" id="7584866">*</span><span class="ident" id="7584867">testing</span><span class="op" id="7584874">.</span><span class="ident" id="7584875">T</span><span class="op" id="7584876">)</span>&nbsp;<span class="op" id="7584878">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584881">in</span>&nbsp;<span class="op" id="7584884">:=</span>&nbsp;<span class="builtinfunc" id="7584887">make</span><span class="op" id="7584891">(</span><span class="ident" id="7584892">Bug1StructMap</span><span class="op" id="7584905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584908">in</span><span class="op" id="7584910">[</span><span class="string" id="7584911">&#34;val1&#34;</span><span class="op" id="7584917">]</span>&nbsp;<span class="op" id="7584919">=</span>&nbsp;<span class="ident" id="7584921">Bug1Elem</span><span class="op" id="7584929">{</span><span class="string" id="7584930">&#34;elem1&#34;</span><span class="op" id="7584937">,</span>&nbsp;<span class="num" id="7584939">1</span><span class="op" id="7584940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584943">in</span><span class="op" id="7584945">[</span><span class="string" id="7584946">&#34;val2&#34;</span><span class="op" id="7584952">]</span>&nbsp;<span class="op" id="7584954">=</span>&nbsp;<span class="ident" id="7584956">Bug1Elem</span><span class="op" id="7584964">{</span><span class="string" id="7584965">&#34;elem2&#34;</span><span class="op" id="7584972">,</span>&nbsp;<span class="num" id="7584974">2</span><span class="op" id="7584975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7584979">b</span>&nbsp;<span class="op" id="7584981">:=</span>&nbsp;<span class="builtinfunc" id="7584984">new</span><span class="op" id="7584987">(</span><span class="ident" id="7584988">bytes</span><span class="op" id="7584993">.</span><span class="ident" id="7584994">Buffer</span><span class="op" id="7585000">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585003">enc</span>&nbsp;<span class="op" id="7585007">:=</span>&nbsp;<span class="ident" id="7585010">NewEncoder</span><span class="op" id="7585020">(</span><span class="ident" id="7585021">b</span><span class="op" id="7585022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585025">err</span>&nbsp;<span class="op" id="7585029">:=</span>&nbsp;<span class="ident" id="7585032">enc</span><span class="op" id="7585035">.</span><span class="ident" id="7585036">Encode</span><span class="op" id="7585042">(</span><span class="ident" id="7585043">in</span><span class="op" id="7585045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585048">if</span>&nbsp;<span class="ident" id="7585051">err</span>&nbsp;<span class="op" id="7585055">!=</span>&nbsp;<span class="ident" id="7585058">nil</span>&nbsp;<span class="op" id="7585062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585066">t</span><span class="op" id="7585067">.</span><span class="ident" id="7585068">Fatal</span><span class="op" id="7585073">(</span><span class="string" id="7585074">&#34;encode:&#34;</span><span class="op" id="7585083">,</span>&nbsp;<span class="ident" id="7585085">err</span><span class="op" id="7585088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585091">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585094">dec</span>&nbsp;<span class="op" id="7585098">:=</span>&nbsp;<span class="ident" id="7585101">NewDecoder</span><span class="op" id="7585111">(</span><span class="ident" id="7585112">b</span><span class="op" id="7585113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585116">out</span>&nbsp;<span class="op" id="7585120">:=</span>&nbsp;<span class="builtinfunc" id="7585123">make</span><span class="op" id="7585127">(</span><span class="ident" id="7585128">Bug1StructMap</span><span class="op" id="7585141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585144">err</span>&nbsp;<span class="op" id="7585148">=</span>&nbsp;<span class="ident" id="7585150">dec</span><span class="op" id="7585153">.</span><span class="ident" id="7585154">Decode</span><span class="op" id="7585160">(</span><span class="op" id="7585161">&amp;</span><span class="ident" id="7585162">out</span><span class="op" id="7585165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585168">if</span>&nbsp;<span class="ident" id="7585171">err</span>&nbsp;<span class="op" id="7585175">!=</span>&nbsp;<span class="ident" id="7585178">nil</span>&nbsp;<span class="op" id="7585182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585186">t</span><span class="op" id="7585187">.</span><span class="ident" id="7585188">Fatal</span><span class="op" id="7585193">(</span><span class="string" id="7585194">&#34;decode:&#34;</span><span class="op" id="7585203">,</span>&nbsp;<span class="ident" id="7585205">err</span><span class="op" id="7585208">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585214">if</span>&nbsp;<span class="op" id="7585217">!</span><span class="ident" id="7585218">reflect</span><span class="op" id="7585225">.</span><span class="ident" id="7585226">DeepEqual</span><span class="op" id="7585235">(</span><span class="ident" id="7585236">in</span><span class="op" id="7585238">,</span>&nbsp;<span class="ident" id="7585240">out</span><span class="op" id="7585243">)</span>&nbsp;<span class="op" id="7585245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585249">t</span><span class="op" id="7585250">.</span><span class="ident" id="7585251">Errorf</span><span class="op" id="7585257">(</span><span class="string" id="7585258">&#34;mismatch:&nbsp;%v&nbsp;%v&#34;</span><span class="op" id="7585275">,</span>&nbsp;<span class="ident" id="7585277">in</span><span class="op" id="7585279">,</span>&nbsp;<span class="ident" id="7585281">out</span><span class="op" id="7585284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585287">}</span><br>
<span class="lineno"></span><span class="op" id="7585289">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7585292">func</span>&nbsp;<span class="ident" id="7585297">TestGobMapInterfaceEncode</span><span class="op" id="7585322">(</span><span class="ident" id="7585323">t</span>&nbsp;<span class="op" id="7585325">*</span><span class="ident" id="7585326">testing</span><span class="op" id="7585333">.</span><span class="ident" id="7585334">T</span><span class="op" id="7585335">)</span>&nbsp;<span class="op" id="7585337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585340">m</span>&nbsp;<span class="op" id="7585342">:=</span>&nbsp;<span class="keyword" id="7585345">map</span><span class="op" id="7585348">[</span><span class="builtintype" id="7585349">string</span><span class="op" id="7585355">]</span><span class="keyword" id="7585356">interface</span><span class="op" id="7585365">{</span><span class="op" id="7585366">}</span><span class="op" id="7585367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585371">&#34;up&#34;</span><span class="op" id="7585375">:</span>&nbsp;<span class="builtintype" id="7585377">uintptr</span><span class="op" id="7585384">(</span><span class="num" id="7585385">0</span><span class="op" id="7585386">)</span><span class="op" id="7585387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585391">&#34;i0&#34;</span><span class="op" id="7585395">:</span>&nbsp;<span class="op" id="7585397">[</span><span class="op" id="7585398">]</span><span class="builtintype" id="7585399">int</span><span class="op" id="7585402">{</span><span class="op" id="7585403">-</span><span class="num" id="7585404">1</span><span class="op" id="7585405">}</span><span class="op" id="7585406">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585410">&#34;i1&#34;</span><span class="op" id="7585414">:</span>&nbsp;<span class="op" id="7585416">[</span><span class="op" id="7585417">]</span><span class="builtintype" id="7585418">int8</span><span class="op" id="7585422">{</span><span class="op" id="7585423">-</span><span class="num" id="7585424">1</span><span class="op" id="7585425">}</span><span class="op" id="7585426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585430">&#34;i2&#34;</span><span class="op" id="7585434">:</span>&nbsp;<span class="op" id="7585436">[</span><span class="op" id="7585437">]</span><span class="builtintype" id="7585438">int16</span><span class="op" id="7585443">{</span><span class="op" id="7585444">-</span><span class="num" id="7585445">1</span><span class="op" id="7585446">}</span><span class="op" id="7585447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585451">&#34;i3&#34;</span><span class="op" id="7585455">:</span>&nbsp;<span class="op" id="7585457">[</span><span class="op" id="7585458">]</span><span class="builtintype" id="7585459">int32</span><span class="op" id="7585464">{</span><span class="op" id="7585465">-</span><span class="num" id="7585466">1</span><span class="op" id="7585467">}</span><span class="op" id="7585468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585472">&#34;i4&#34;</span><span class="op" id="7585476">:</span>&nbsp;<span class="op" id="7585478">[</span><span class="op" id="7585479">]</span><span class="ident" id="7585480">int64</span><span class="op" id="7585485">{</span><span class="op" id="7585486">-</span><span class="num" id="7585487">1</span><span class="op" id="7585488">}</span><span class="op" id="7585489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585493">&#34;u0&#34;</span><span class="op" id="7585497">:</span>&nbsp;<span class="op" id="7585499">[</span><span class="op" id="7585500">]</span><span class="builtintype" id="7585501">uint</span><span class="op" id="7585505">{</span><span class="num" id="7585506">1</span><span class="op" id="7585507">}</span><span class="op" id="7585508">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585512">&#34;u1&#34;</span><span class="op" id="7585516">:</span>&nbsp;<span class="op" id="7585518">[</span><span class="op" id="7585519">]</span><span class="builtintype" id="7585520">uint8</span><span class="op" id="7585525">{</span><span class="num" id="7585526">1</span><span class="op" id="7585527">}</span><span class="op" id="7585528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585532">&#34;u2&#34;</span><span class="op" id="7585536">:</span>&nbsp;<span class="op" id="7585538">[</span><span class="op" id="7585539">]</span><span class="builtintype" id="7585540">uint16</span><span class="op" id="7585546">{</span><span class="num" id="7585547">1</span><span class="op" id="7585548">}</span><span class="op" id="7585549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585553">&#34;u3&#34;</span><span class="op" id="7585557">:</span>&nbsp;<span class="op" id="7585559">[</span><span class="op" id="7585560">]</span><span class="builtintype" id="7585561">uint32</span><span class="op" id="7585567">{</span><span class="num" id="7585568">1</span><span class="op" id="7585569">}</span><span class="op" id="7585570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585574">&#34;u4&#34;</span><span class="op" id="7585578">:</span>&nbsp;<span class="op" id="7585580">[</span><span class="op" id="7585581">]</span><span class="ident" id="7585582">uint64</span><span class="op" id="7585588">{</span><span class="num" id="7585589">1</span><span class="op" id="7585590">}</span><span class="op" id="7585591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585595">&#34;f0&#34;</span><span class="op" id="7585599">:</span>&nbsp;<span class="op" id="7585601">[</span><span class="op" id="7585602">]</span><span class="builtintype" id="7585603">float32</span><span class="op" id="7585610">{</span><span class="num" id="7585611">1</span><span class="op" id="7585612">}</span><span class="op" id="7585613">,</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585617">&#34;f1&#34;</span><span class="op" id="7585621">:</span>&nbsp;<span class="op" id="7585623">[</span><span class="op" id="7585624">]</span><span class="builtintype" id="7585625">float64</span><span class="op" id="7585632">{</span><span class="num" id="7585633">1</span><span class="op" id="7585634">}</span><span class="op" id="7585635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585639">&#34;c0&#34;</span><span class="op" id="7585643">:</span>&nbsp;<span class="op" id="7585645">[</span><span class="op" id="7585646">]</span><span class="builtintype" id="7585647">complex64</span><span class="op" id="7585656">{</span><span class="builtinfunc" id="7585657">complex</span><span class="op" id="7585664">(</span><span class="num" id="7585665">2</span><span class="op" id="7585666">,</span>&nbsp;<span class="op" id="7585668">-</span><span class="num" id="7585669">2</span><span class="op" id="7585670">)</span><span class="op" id="7585671">}</span><span class="op" id="7585672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585676">&#34;c1&#34;</span><span class="op" id="7585680">:</span>&nbsp;<span class="op" id="7585682">[</span><span class="op" id="7585683">]</span><span class="builtintype" id="7585684">complex128</span><span class="op" id="7585694">{</span><span class="builtinfunc" id="7585695">complex</span><span class="op" id="7585702">(</span><span class="num" id="7585703">2</span><span class="op" id="7585704">,</span>&nbsp;<span class="builtintype" id="7585706">float64</span><span class="op" id="7585713">(</span><span class="op" id="7585714">-</span><span class="num" id="7585715">2</span><span class="op" id="7585716">)</span><span class="op" id="7585717">)</span><span class="op" id="7585718">}</span><span class="op" id="7585719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585723">&#34;us&#34;</span><span class="op" id="7585727">:</span>&nbsp;<span class="op" id="7585729">[</span><span class="op" id="7585730">]</span><span class="builtintype" id="7585731">uintptr</span><span class="op" id="7585738">{</span><span class="num" id="7585739">0</span><span class="op" id="7585740">}</span><span class="op" id="7585741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585745">&#34;bo&#34;</span><span class="op" id="7585749">:</span>&nbsp;<span class="op" id="7585751">[</span><span class="op" id="7585752">]</span><span class="builtintype" id="7585753">bool</span><span class="op" id="7585757">{</span><span class="builtintype" id="7585758">false</span><span class="op" id="7585763">}</span><span class="op" id="7585764">,</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7585768">&#34;st&#34;</span><span class="op" id="7585772">:</span>&nbsp;<span class="op" id="7585774">[</span><span class="op" id="7585775">]</span><span class="builtintype" id="7585776">string</span><span class="op" id="7585782">{</span><span class="string" id="7585783">&#34;s&#34;</span><span class="op" id="7585786">}</span><span class="op" id="7585787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585793">enc</span>&nbsp;<span class="op" id="7585797">:=</span>&nbsp;<span class="ident" id="7585800">NewEncoder</span><span class="op" id="7585810">(</span><span class="builtinfunc" id="7585811">new</span><span class="op" id="7585814">(</span><span class="ident" id="7585815">bytes</span><span class="op" id="7585820">.</span><span class="ident" id="7585821">Buffer</span><span class="op" id="7585827">)</span><span class="op" id="7585828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585831">err</span>&nbsp;<span class="op" id="7585835">:=</span>&nbsp;<span class="ident" id="7585838">enc</span><span class="op" id="7585841">.</span><span class="ident" id="7585842">Encode</span><span class="op" id="7585848">(</span><span class="ident" id="7585849">m</span><span class="op" id="7585850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585853">if</span>&nbsp;<span class="ident" id="7585856">err</span>&nbsp;<span class="op" id="7585860">!=</span>&nbsp;<span class="ident" id="7585863">nil</span>&nbsp;<span class="op" id="7585867">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585871">t</span><span class="op" id="7585872">.</span><span class="ident" id="7585873">Errorf</span><span class="op" id="7585879">(</span><span class="string" id="7585880">&#34;encode&nbsp;map:&nbsp;%s&#34;</span><span class="op" id="7585896">,</span>&nbsp;<span class="ident" id="7585898">err</span><span class="op" id="7585901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585904">}</span><br>
<span class="lineno"></span><span class="op" id="7585906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7585909">func</span>&nbsp;<span class="ident" id="7585914">TestSliceReusesMemory</span><span class="op" id="7585935">(</span><span class="ident" id="7585936">t</span>&nbsp;<span class="op" id="7585938">*</span><span class="ident" id="7585939">testing</span><span class="op" id="7585946">.</span><span class="ident" id="7585947">T</span><span class="op" id="7585948">)</span>&nbsp;<span class="op" id="7585950">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585953">buf</span>&nbsp;<span class="op" id="7585957">:=</span>&nbsp;<span class="builtinfunc" id="7585960">new</span><span class="op" id="7585963">(</span><span class="ident" id="7585964">bytes</span><span class="op" id="7585969">.</span><span class="ident" id="7585970">Buffer</span><span class="op" id="7585976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585979">//&nbsp;Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585993">x</span>&nbsp;<span class="op" id="7585995">:=</span>&nbsp;<span class="op" id="7585998">[</span><span class="op" id="7585999">]</span><span class="builtintype" id="7586000">byte</span><span class="op" id="7586004">(</span><span class="string" id="7586005">&#34;abcd&#34;</span><span class="op" id="7586011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586015">enc</span>&nbsp;<span class="op" id="7586019">:=</span>&nbsp;<span class="ident" id="7586022">NewEncoder</span><span class="op" id="7586032">(</span><span class="ident" id="7586033">buf</span><span class="op" id="7586036">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586040">err</span>&nbsp;<span class="op" id="7586044">:=</span>&nbsp;<span class="ident" id="7586047">enc</span><span class="op" id="7586050">.</span><span class="ident" id="7586051">Encode</span><span class="op" id="7586057">(</span><span class="ident" id="7586058">x</span><span class="op" id="7586059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586063">if</span>&nbsp;<span class="ident" id="7586066">err</span>&nbsp;<span class="op" id="7586070">!=</span>&nbsp;<span class="ident" id="7586073">nil</span>&nbsp;<span class="op" id="7586077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586082">t</span><span class="op" id="7586083">.</span><span class="ident" id="7586084">Errorf</span><span class="op" id="7586090">(</span><span class="string" id="7586091">&#34;bytes:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="7586110">,</span>&nbsp;<span class="ident" id="7586112">err</span><span class="op" id="7586115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7586123">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586164">y</span>&nbsp;<span class="op" id="7586166">:=</span>&nbsp;<span class="op" id="7586169">[</span><span class="op" id="7586170">]</span><span class="builtintype" id="7586171">byte</span><span class="op" id="7586175">(</span><span class="string" id="7586176">&#34;ABCDE&#34;</span><span class="op" id="7586183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586187">addr</span>&nbsp;<span class="op" id="7586192">:=</span>&nbsp;<span class="op" id="7586195">&amp;</span><span class="ident" id="7586196">y</span><span class="op" id="7586197">[</span><span class="num" id="7586198">0</span><span class="op" id="7586199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586203">dec</span>&nbsp;<span class="op" id="7586207">:=</span>&nbsp;<span class="ident" id="7586210">NewDecoder</span><span class="op" id="7586220">(</span><span class="ident" id="7586221">buf</span><span class="op" id="7586224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586228">err</span>&nbsp;<span class="op" id="7586232">=</span>&nbsp;<span class="ident" id="7586234">dec</span><span class="op" id="7586237">.</span><span class="ident" id="7586238">Decode</span><span class="op" id="7586244">(</span><span class="op" id="7586245">&amp;</span><span class="ident" id="7586246">y</span><span class="op" id="7586247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586251">if</span>&nbsp;<span class="ident" id="7586254">err</span>&nbsp;<span class="op" id="7586258">!=</span>&nbsp;<span class="ident" id="7586261">nil</span>&nbsp;<span class="op" id="7586265">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586270">t</span><span class="op" id="7586271">.</span><span class="ident" id="7586272">Fatal</span><span class="op" id="7586277">(</span><span class="string" id="7586278">&#34;bytes:&nbsp;decode:&#34;</span><span class="op" id="7586294">,</span>&nbsp;<span class="ident" id="7586296">err</span><span class="op" id="7586299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586307">if</span>&nbsp;<span class="op" id="7586310">!</span><span class="ident" id="7586311">bytes</span><span class="op" id="7586316">.</span><span class="ident" id="7586317">Equal</span><span class="op" id="7586322">(</span><span class="ident" id="7586323">x</span><span class="op" id="7586324">,</span>&nbsp;<span class="ident" id="7586326">y</span><span class="op" id="7586327">)</span>&nbsp;<span class="op" id="7586329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586334">t</span><span class="op" id="7586335">.</span><span class="ident" id="7586336">Errorf</span><span class="op" id="7586342">(</span><span class="string" id="7586343">&#34;bytes:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="7586372">,</span>&nbsp;<span class="ident" id="7586374">x</span><span class="op" id="7586375">,</span>&nbsp;<span class="ident" id="7586377">y</span><span class="op" id="7586378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586382">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586386">if</span>&nbsp;<span class="ident" id="7586389">addr</span>&nbsp;<span class="op" id="7586394">!=</span>&nbsp;<span class="op" id="7586397">&amp;</span><span class="ident" id="7586398">y</span><span class="op" id="7586399">[</span><span class="num" id="7586400">0</span><span class="op" id="7586401">]</span>&nbsp;<span class="op" id="7586403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586408">t</span><span class="op" id="7586409">.</span><span class="ident" id="7586410">Errorf</span><span class="op" id="7586416">(</span><span class="string" id="7586417">&#34;bytes:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="7586450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7586460">//&nbsp;general&nbsp;slice</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586482">x</span>&nbsp;<span class="op" id="7586484">:=</span>&nbsp;<span class="op" id="7586487">[</span><span class="op" id="7586488">]</span><span class="builtintype" id="7586489">rune</span><span class="op" id="7586493">(</span><span class="string" id="7586494">&#34;abcd&#34;</span><span class="op" id="7586500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586504">enc</span>&nbsp;<span class="op" id="7586508">:=</span>&nbsp;<span class="ident" id="7586511">NewEncoder</span><span class="op" id="7586521">(</span><span class="ident" id="7586522">buf</span><span class="op" id="7586525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586529">err</span>&nbsp;<span class="op" id="7586533">:=</span>&nbsp;<span class="ident" id="7586536">enc</span><span class="op" id="7586539">.</span><span class="ident" id="7586540">Encode</span><span class="op" id="7586546">(</span><span class="ident" id="7586547">x</span><span class="op" id="7586548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586552">if</span>&nbsp;<span class="ident" id="7586555">err</span>&nbsp;<span class="op" id="7586559">!=</span>&nbsp;<span class="ident" id="7586562">nil</span>&nbsp;<span class="op" id="7586566">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586571">t</span><span class="op" id="7586572">.</span><span class="ident" id="7586573">Errorf</span><span class="op" id="7586579">(</span><span class="string" id="7586580">&#34;ints:&nbsp;encode:&nbsp;%s&#34;</span><span class="op" id="7586598">,</span>&nbsp;<span class="ident" id="7586600">err</span><span class="op" id="7586603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7586611">//&nbsp;Decode&nbsp;into&nbsp;y,&nbsp;which&nbsp;is&nbsp;big&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586652">y</span>&nbsp;<span class="op" id="7586654">:=</span>&nbsp;<span class="op" id="7586657">[</span><span class="op" id="7586658">]</span><span class="builtintype" id="7586659">rune</span><span class="op" id="7586663">(</span><span class="string" id="7586664">&#34;ABCDE&#34;</span><span class="op" id="7586671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586675">addr</span>&nbsp;<span class="op" id="7586680">:=</span>&nbsp;<span class="op" id="7586683">&amp;</span><span class="ident" id="7586684">y</span><span class="op" id="7586685">[</span><span class="num" id="7586686">0</span><span class="op" id="7586687">]</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586691">dec</span>&nbsp;<span class="op" id="7586695">:=</span>&nbsp;<span class="ident" id="7586698">NewDecoder</span><span class="op" id="7586708">(</span><span class="ident" id="7586709">buf</span><span class="op" id="7586712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586716">err</span>&nbsp;<span class="op" id="7586720">=</span>&nbsp;<span class="ident" id="7586722">dec</span><span class="op" id="7586725">.</span><span class="ident" id="7586726">Decode</span><span class="op" id="7586732">(</span><span class="op" id="7586733">&amp;</span><span class="ident" id="7586734">y</span><span class="op" id="7586735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586739">if</span>&nbsp;<span class="ident" id="7586742">err</span>&nbsp;<span class="op" id="7586746">!=</span>&nbsp;<span class="ident" id="7586749">nil</span>&nbsp;<span class="op" id="7586753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586758">t</span><span class="op" id="7586759">.</span><span class="ident" id="7586760">Fatal</span><span class="op" id="7586765">(</span><span class="string" id="7586766">&#34;ints:&nbsp;decode:&#34;</span><span class="op" id="7586781">,</span>&nbsp;<span class="ident" id="7586783">err</span><span class="op" id="7586786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586790">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586794">if</span>&nbsp;<span class="op" id="7586797">!</span><span class="ident" id="7586798">reflect</span><span class="op" id="7586805">.</span><span class="ident" id="7586806">DeepEqual</span><span class="op" id="7586815">(</span><span class="ident" id="7586816">x</span><span class="op" id="7586817">,</span>&nbsp;<span class="ident" id="7586819">y</span><span class="op" id="7586820">)</span>&nbsp;<span class="op" id="7586822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586827">t</span><span class="op" id="7586828">.</span><span class="ident" id="7586829">Errorf</span><span class="op" id="7586835">(</span><span class="string" id="7586836">&#34;ints:&nbsp;expected&nbsp;%q&nbsp;got&nbsp;%q\n&#34;</span><span class="op" id="7586864">,</span>&nbsp;<span class="ident" id="7586866">x</span><span class="op" id="7586867">,</span>&nbsp;<span class="ident" id="7586869">y</span><span class="op" id="7586870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586878">if</span>&nbsp;<span class="ident" id="7586881">addr</span>&nbsp;<span class="op" id="7586886">!=</span>&nbsp;<span class="op" id="7586889">&amp;</span><span class="ident" id="7586890">y</span><span class="op" id="7586891">[</span><span class="num" id="7586892">0</span><span class="op" id="7586893">]</span>&nbsp;<span class="op" id="7586895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586900">t</span><span class="op" id="7586901">.</span><span class="ident" id="7586902">Errorf</span><span class="op" id="7586908">(</span><span class="string" id="7586909">&#34;ints:&nbsp;unnecessary&nbsp;reallocation&#34;</span><span class="op" id="7586941">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586948">}</span><br>
<span class="lineno"></span><span class="op" id="7586950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7586953">//&nbsp;Used&nbsp;to&nbsp;crash:&nbsp;negative&nbsp;count&nbsp;in&nbsp;recvMessage.</span><br>
<span class="lineno">705</span><span class="keyword" id="7587002">func</span>&nbsp;<span class="ident" id="7587007">TestBadCount</span><span class="op" id="7587019">(</span><span class="ident" id="7587020">t</span>&nbsp;<span class="op" id="7587022">*</span><span class="ident" id="7587023">testing</span><span class="op" id="7587030">.</span><span class="ident" id="7587031">T</span><span class="op" id="7587032">)</span>&nbsp;<span class="op" id="7587034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587037">b</span>&nbsp;<span class="op" id="7587039">:=</span>&nbsp;<span class="op" id="7587042">[</span><span class="op" id="7587043">]</span><span class="builtintype" id="7587044">byte</span><span class="op" id="7587048">{</span><span class="num" id="7587049">0xfb</span><span class="op" id="7587053">,</span>&nbsp;<span class="num" id="7587055">0xa5</span><span class="op" id="7587059">,</span>&nbsp;<span class="num" id="7587061">0x82</span><span class="op" id="7587065">,</span>&nbsp;<span class="num" id="7587067">0x2f</span><span class="op" id="7587071">,</span>&nbsp;<span class="num" id="7587073">0xca</span><span class="op" id="7587077">,</span>&nbsp;<span class="num" id="7587079">0x1</span><span class="op" id="7587082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587085">if</span>&nbsp;<span class="ident" id="7587088">err</span>&nbsp;<span class="op" id="7587092">:=</span>&nbsp;<span class="ident" id="7587095">NewDecoder</span><span class="op" id="7587105">(</span><span class="ident" id="7587106">bytes</span><span class="op" id="7587111">.</span><span class="ident" id="7587112">NewReader</span><span class="op" id="7587121">(</span><span class="ident" id="7587122">b</span><span class="op" id="7587123">)</span><span class="op" id="7587124">)</span><span class="op" id="7587125">.</span><span class="ident" id="7587126">Decode</span><span class="op" id="7587132">(</span><span class="ident" id="7587133">nil</span><span class="op" id="7587136">)</span><span class="op" id="7587137">;</span>&nbsp;<span class="ident" id="7587139">err</span>&nbsp;<span class="op" id="7587143">==</span>&nbsp;<span class="ident" id="7587146">nil</span>&nbsp;<span class="op" id="7587150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587154">t</span><span class="op" id="7587155">.</span><span class="ident" id="7587156">Error</span><span class="op" id="7587161">(</span><span class="string" id="7587162">&#34;expected&nbsp;error&nbsp;from&nbsp;bad&nbsp;count&#34;</span><span class="op" id="7587193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587196">}</span>&nbsp;<span class="keyword" id="7587198">else</span>&nbsp;<span class="keyword" id="7587203">if</span>&nbsp;<span class="ident" id="7587206">err</span><span class="op" id="7587209">.</span><span class="ident" id="7587210">Error</span><span class="op" id="7587215">(</span><span class="op" id="7587216">)</span>&nbsp;<span class="op" id="7587218">!=</span>&nbsp;<span class="ident" id="7587221">errBadCount</span><span class="op" id="7587232">.</span><span class="ident" id="7587233">Error</span><span class="op" id="7587238">(</span><span class="op" id="7587239">)</span>&nbsp;<span class="op" id="7587241">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587245">t</span><span class="op" id="7587246">.</span><span class="ident" id="7587247">Error</span><span class="op" id="7587252">(</span><span class="string" id="7587253">&#34;expected&nbsp;bad&nbsp;count&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7587284">,</span>&nbsp;<span class="ident" id="7587286">err</span><span class="op" id="7587289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587292">}</span><br>
<span class="lineno"></span><span class="op" id="7587294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7587297">//&nbsp;Verify&nbsp;that&nbsp;sequential&nbsp;Decoders&nbsp;built&nbsp;on&nbsp;a&nbsp;single&nbsp;input&nbsp;will</span><br>
<span class="lineno">715</span><span class="comment" id="7587361">//&nbsp;succeed&nbsp;if&nbsp;the&nbsp;input&nbsp;implements&nbsp;ReadByte&nbsp;and&nbsp;there&nbsp;is&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="7587421">//&nbsp;type&nbsp;information&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="7587456">func</span>&nbsp;<span class="ident" id="7587461">TestSequentialDecoder</span><span class="op" id="7587482">(</span><span class="ident" id="7587483">t</span>&nbsp;<span class="op" id="7587485">*</span><span class="ident" id="7587486">testing</span><span class="op" id="7587493">.</span><span class="ident" id="7587494">T</span><span class="op" id="7587495">)</span>&nbsp;<span class="op" id="7587497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587500">b</span>&nbsp;<span class="op" id="7587502">:=</span>&nbsp;<span class="builtinfunc" id="7587505">new</span><span class="op" id="7587508">(</span><span class="ident" id="7587509">bytes</span><span class="op" id="7587514">.</span><span class="ident" id="7587515">Buffer</span><span class="op" id="7587521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587524">enc</span>&nbsp;<span class="op" id="7587528">:=</span>&nbsp;<span class="ident" id="7587531">NewEncoder</span><span class="op" id="7587541">(</span><span class="ident" id="7587542">b</span><span class="op" id="7587543">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587546">const</span>&nbsp;<span class="ident" id="7587552">count</span>&nbsp;<span class="op" id="7587558">=</span>&nbsp;<span class="num" id="7587560">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587564">for</span>&nbsp;<span class="ident" id="7587568">i</span>&nbsp;<span class="op" id="7587570">:=</span>&nbsp;<span class="num" id="7587573">0</span><span class="op" id="7587574">;</span>&nbsp;<span class="ident" id="7587576">i</span>&nbsp;<span class="op" id="7587578">&lt;</span>&nbsp;<span class="ident" id="7587580">count</span><span class="op" id="7587585">;</span>&nbsp;<span class="ident" id="7587587">i</span><span class="op" id="7587588">++</span>&nbsp;<span class="op" id="7587591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587595">s</span>&nbsp;<span class="op" id="7587597">:=</span>&nbsp;<span class="ident" id="7587600">fmt</span><span class="op" id="7587603">.</span><span class="ident" id="7587604">Sprintf</span><span class="op" id="7587611">(</span><span class="string" id="7587612">&#34;%d&#34;</span><span class="op" id="7587616">,</span>&nbsp;<span class="ident" id="7587618">i</span><span class="op" id="7587619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587623">if</span>&nbsp;<span class="ident" id="7587626">err</span>&nbsp;<span class="op" id="7587630">:=</span>&nbsp;<span class="ident" id="7587633">enc</span><span class="op" id="7587636">.</span><span class="ident" id="7587637">Encode</span><span class="op" id="7587643">(</span><span class="ident" id="7587644">s</span><span class="op" id="7587645">)</span><span class="op" id="7587646">;</span>&nbsp;<span class="ident" id="7587648">err</span>&nbsp;<span class="op" id="7587652">!=</span>&nbsp;<span class="ident" id="7587655">nil</span>&nbsp;<span class="op" id="7587659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587664">t</span><span class="op" id="7587665">.</span><span class="ident" id="7587666">Error</span><span class="op" id="7587671">(</span><span class="string" id="7587672">&#34;encoder&nbsp;fail:&#34;</span><span class="op" id="7587687">,</span>&nbsp;<span class="ident" id="7587689">err</span><span class="op" id="7587692">)</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587702">for</span>&nbsp;<span class="ident" id="7587706">i</span>&nbsp;<span class="op" id="7587708">:=</span>&nbsp;<span class="num" id="7587711">0</span><span class="op" id="7587712">;</span>&nbsp;<span class="ident" id="7587714">i</span>&nbsp;<span class="op" id="7587716">&lt;</span>&nbsp;<span class="ident" id="7587718">count</span><span class="op" id="7587723">;</span>&nbsp;<span class="ident" id="7587725">i</span><span class="op" id="7587726">++</span>&nbsp;<span class="op" id="7587729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587733">dec</span>&nbsp;<span class="op" id="7587737">:=</span>&nbsp;<span class="ident" id="7587740">NewDecoder</span><span class="op" id="7587750">(</span><span class="ident" id="7587751">b</span><span class="op" id="7587752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587756">var</span>&nbsp;<span class="ident" id="7587760">s</span>&nbsp;<span class="builtintype" id="7587762">string</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587771">if</span>&nbsp;<span class="ident" id="7587774">err</span>&nbsp;<span class="op" id="7587778">:=</span>&nbsp;<span class="ident" id="7587781">dec</span><span class="op" id="7587784">.</span><span class="ident" id="7587785">Decode</span><span class="op" id="7587791">(</span><span class="op" id="7587792">&amp;</span><span class="ident" id="7587793">s</span><span class="op" id="7587794">)</span><span class="op" id="7587795">;</span>&nbsp;<span class="ident" id="7587797">err</span>&nbsp;<span class="op" id="7587801">!=</span>&nbsp;<span class="ident" id="7587804">nil</span>&nbsp;<span class="op" id="7587808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587813">t</span><span class="op" id="7587814">.</span><span class="ident" id="7587815">Fatal</span><span class="op" id="7587820">(</span><span class="string" id="7587821">&#34;decoder&nbsp;fail:&#34;</span><span class="op" id="7587836">,</span>&nbsp;<span class="ident" id="7587838">err</span><span class="op" id="7587841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587849">if</span>&nbsp;<span class="ident" id="7587852">s</span>&nbsp;<span class="op" id="7587854">!=</span>&nbsp;<span class="ident" id="7587857">fmt</span><span class="op" id="7587860">.</span><span class="ident" id="7587861">Sprintf</span><span class="op" id="7587868">(</span><span class="string" id="7587869">&#34;%d&#34;</span><span class="op" id="7587873">,</span>&nbsp;<span class="ident" id="7587875">i</span><span class="op" id="7587876">)</span>&nbsp;<span class="op" id="7587878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587883">t</span><span class="op" id="7587884">.</span><span class="ident" id="7587885">Fatalf</span><span class="op" id="7587891">(</span><span class="string" id="7587892">&#34;decode&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7587919">,</span>&nbsp;<span class="ident" id="7587921">i</span><span class="op" id="7587922">,</span>&nbsp;<span class="ident" id="7587924">s</span><span class="op" id="7587925">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587932">}</span><br>
<span class="lineno"></span><span class="op" id="7587934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7587937">//&nbsp;Should&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;unrepresentable&nbsp;fields&nbsp;(chan,&nbsp;func,&nbsp;*chan&nbsp;etc.);&nbsp;we&nbsp;just&nbsp;ignore&nbsp;them.</span><br>
<span class="lineno">740</span><span class="keyword" id="7588033">type</span>&nbsp;<span class="ident" id="7588038">Bug2</span>&nbsp;<span class="keyword" id="7588043">struct</span>&nbsp;<span class="op" id="7588050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588053">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7588057">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588062">C</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588066">chan</span>&nbsp;<span class="builtintype" id="7588071">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588076">CP</span>&nbsp;&nbsp;<span class="op" id="7588080">*</span><span class="keyword" id="7588081">chan</span>&nbsp;<span class="builtintype" id="7588086">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588091">F</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588095">func</span><span class="op" id="7588099">(</span><span class="op" id="7588100">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588103">FPP</span>&nbsp;<span class="op" id="7588107">*</span><span class="op" id="7588108">*</span><span class="keyword" id="7588109">func</span><span class="op" id="7588113">(</span><span class="op" id="7588114">)</span><br>
<span class="lineno"></span><span class="op" id="7588116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7588119">func</span>&nbsp;<span class="ident" id="7588124">TestChanFuncIgnored</span><span class="op" id="7588143">(</span><span class="ident" id="7588144">t</span>&nbsp;<span class="op" id="7588146">*</span><span class="ident" id="7588147">testing</span><span class="op" id="7588154">.</span><span class="ident" id="7588155">T</span><span class="op" id="7588156">)</span>&nbsp;<span class="op" id="7588158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588161">c</span>&nbsp;<span class="op" id="7588163">:=</span>&nbsp;<span class="builtinfunc" id="7588166">make</span><span class="op" id="7588170">(</span><span class="keyword" id="7588171">chan</span>&nbsp;<span class="builtintype" id="7588176">int</span><span class="op" id="7588179">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588182">f</span>&nbsp;<span class="op" id="7588184">:=</span>&nbsp;<span class="keyword" id="7588187">func</span><span class="op" id="7588191">(</span><span class="op" id="7588192">)</span>&nbsp;<span class="op" id="7588194">{</span><span class="op" id="7588195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588198">fp</span>&nbsp;<span class="op" id="7588201">:=</span>&nbsp;<span class="op" id="7588204">&amp;</span><span class="ident" id="7588205">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588208">b0</span>&nbsp;<span class="op" id="7588211">:=</span>&nbsp;<span class="ident" id="7588214">Bug2</span><span class="op" id="7588218">{</span><span class="num" id="7588219">23</span><span class="op" id="7588221">,</span>&nbsp;<span class="ident" id="7588223">c</span><span class="op" id="7588224">,</span>&nbsp;<span class="op" id="7588226">&amp;</span><span class="ident" id="7588227">c</span><span class="op" id="7588228">,</span>&nbsp;<span class="ident" id="7588230">f</span><span class="op" id="7588231">,</span>&nbsp;<span class="op" id="7588233">&amp;</span><span class="ident" id="7588234">fp</span><span class="op" id="7588236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588239">var</span>&nbsp;<span class="ident" id="7588243">buf</span>&nbsp;<span class="ident" id="7588247">bytes</span><span class="op" id="7588252">.</span><span class="ident" id="7588253">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588261">enc</span>&nbsp;<span class="op" id="7588265">:=</span>&nbsp;<span class="ident" id="7588268">NewEncoder</span><span class="op" id="7588278">(</span><span class="op" id="7588279">&amp;</span><span class="ident" id="7588280">buf</span><span class="op" id="7588283">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588286">if</span>&nbsp;<span class="ident" id="7588289">err</span>&nbsp;<span class="op" id="7588293">:=</span>&nbsp;<span class="ident" id="7588296">enc</span><span class="op" id="7588299">.</span><span class="ident" id="7588300">Encode</span><span class="op" id="7588306">(</span><span class="ident" id="7588307">b0</span><span class="op" id="7588309">)</span><span class="op" id="7588310">;</span>&nbsp;<span class="ident" id="7588312">err</span>&nbsp;<span class="op" id="7588316">!=</span>&nbsp;<span class="ident" id="7588319">nil</span>&nbsp;<span class="op" id="7588323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588327">t</span><span class="op" id="7588328">.</span><span class="ident" id="7588329">Fatal</span><span class="op" id="7588334">(</span><span class="string" id="7588335">&#34;error&nbsp;encoding:&#34;</span><span class="op" id="7588352">,</span>&nbsp;<span class="ident" id="7588354">err</span><span class="op" id="7588357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588363">var</span>&nbsp;<span class="ident" id="7588367">b1</span>&nbsp;<span class="ident" id="7588370">Bug2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588376">err</span>&nbsp;<span class="op" id="7588380">:=</span>&nbsp;<span class="ident" id="7588383">NewDecoder</span><span class="op" id="7588393">(</span><span class="op" id="7588394">&amp;</span><span class="ident" id="7588395">buf</span><span class="op" id="7588398">)</span><span class="op" id="7588399">.</span><span class="ident" id="7588400">Decode</span><span class="op" id="7588406">(</span><span class="op" id="7588407">&amp;</span><span class="ident" id="7588408">b1</span><span class="op" id="7588410">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588413">if</span>&nbsp;<span class="ident" id="7588416">err</span>&nbsp;<span class="op" id="7588420">!=</span>&nbsp;<span class="ident" id="7588423">nil</span>&nbsp;<span class="op" id="7588427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588431">t</span><span class="op" id="7588432">.</span><span class="ident" id="7588433">Fatal</span><span class="op" id="7588438">(</span><span class="string" id="7588439">&#34;decode:&#34;</span><span class="op" id="7588448">,</span>&nbsp;<span class="ident" id="7588450">err</span><span class="op" id="7588453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588459">if</span>&nbsp;<span class="ident" id="7588462">b1</span><span class="op" id="7588464">.</span><span class="ident" id="7588465">A</span>&nbsp;<span class="op" id="7588467">!=</span>&nbsp;<span class="ident" id="7588470">b0</span><span class="op" id="7588472">.</span><span class="ident" id="7588473">A</span>&nbsp;<span class="op" id="7588475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588479">t</span><span class="op" id="7588480">.</span><span class="ident" id="7588481">Fatalf</span><span class="op" id="7588487">(</span><span class="string" id="7588488">&#34;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7588504">,</span>&nbsp;<span class="ident" id="7588506">b1</span><span class="op" id="7588508">.</span><span class="ident" id="7588509">A</span><span class="op" id="7588510">,</span>&nbsp;<span class="ident" id="7588512">b0</span><span class="op" id="7588514">.</span><span class="ident" id="7588515">A</span><span class="op" id="7588516">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588522">if</span>&nbsp;<span class="ident" id="7588525">b1</span><span class="op" id="7588527">.</span><span class="ident" id="7588528">C</span>&nbsp;<span class="op" id="7588530">!=</span>&nbsp;<span class="ident" id="7588533">nil</span>&nbsp;<span class="op" id="7588537">||</span>&nbsp;<span class="ident" id="7588540">b1</span><span class="op" id="7588542">.</span><span class="ident" id="7588543">CP</span>&nbsp;<span class="op" id="7588546">!=</span>&nbsp;<span class="ident" id="7588549">nil</span>&nbsp;<span class="op" id="7588553">||</span>&nbsp;<span class="ident" id="7588556">b1</span><span class="op" id="7588558">.</span><span class="ident" id="7588559">F</span>&nbsp;<span class="op" id="7588561">!=</span>&nbsp;<span class="ident" id="7588564">nil</span>&nbsp;<span class="op" id="7588568">||</span>&nbsp;<span class="ident" id="7588571">b1</span><span class="op" id="7588573">.</span><span class="ident" id="7588574">FPP</span>&nbsp;<span class="op" id="7588578">!=</span>&nbsp;<span class="ident" id="7588581">nil</span>&nbsp;<span class="op" id="7588585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588589">t</span><span class="op" id="7588590">.</span><span class="ident" id="7588591">Fatal</span><span class="op" id="7588596">(</span><span class="string" id="7588597">&#34;unexpected&nbsp;value&nbsp;for&nbsp;chan&nbsp;or&nbsp;func&#34;</span><span class="op" id="7588632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588635">}</span><br>
<span class="lineno"></span><span class="op" id="7588637">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="keyword" id="7588640">func</span>&nbsp;<span class="ident" id="7588645">TestSliceIncompatibility</span><span class="op" id="7588669">(</span><span class="ident" id="7588670">t</span>&nbsp;<span class="op" id="7588672">*</span><span class="ident" id="7588673">testing</span><span class="op" id="7588680">.</span><span class="ident" id="7588681">T</span><span class="op" id="7588682">)</span>&nbsp;<span class="op" id="7588684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588687">var</span>&nbsp;<span class="ident" id="7588691">in</span>&nbsp;<span class="op" id="7588694">=</span>&nbsp;<span class="op" id="7588696">[</span><span class="op" id="7588697">]</span><span class="builtintype" id="7588698">byte</span><span class="op" id="7588702">{</span><span class="num" id="7588703">1</span><span class="op" id="7588704">,</span>&nbsp;<span class="num" id="7588706">2</span><span class="op" id="7588707">,</span>&nbsp;<span class="num" id="7588709">3</span><span class="op" id="7588710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588713">var</span>&nbsp;<span class="ident" id="7588717">out</span>&nbsp;<span class="op" id="7588721">[</span><span class="op" id="7588722">]</span><span class="builtintype" id="7588723">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588728">if</span>&nbsp;<span class="ident" id="7588731">err</span>&nbsp;<span class="op" id="7588735">:=</span>&nbsp;<span class="ident" id="7588738">encAndDec</span><span class="op" id="7588747">(</span><span class="ident" id="7588748">in</span><span class="op" id="7588750">,</span>&nbsp;<span class="op" id="7588752">&amp;</span><span class="ident" id="7588753">out</span><span class="op" id="7588756">)</span><span class="op" id="7588757">;</span>&nbsp;<span class="ident" id="7588759">err</span>&nbsp;<span class="op" id="7588763">==</span>&nbsp;<span class="ident" id="7588766">nil</span>&nbsp;<span class="op" id="7588770">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588774">t</span><span class="op" id="7588775">.</span><span class="ident" id="7588776">Error</span><span class="op" id="7588781">(</span><span class="string" id="7588782">&#34;expected&nbsp;compatibility&nbsp;error&#34;</span><span class="op" id="7588812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588815">}</span><br>
<span class="lineno"></span><span class="op" id="7588817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7588820">//&nbsp;Mutually&nbsp;recursive&nbsp;slices&nbsp;of&nbsp;structs&nbsp;caused&nbsp;problems.</span><br>
<span class="lineno">780</span><span class="keyword" id="7588877">type</span>&nbsp;<span class="ident" id="7588882">Bug3</span>&nbsp;<span class="keyword" id="7588887">struct</span>&nbsp;<span class="op" id="7588894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588897">Num</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7588906">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588911">Children</span>&nbsp;<span class="op" id="7588920">[</span><span class="op" id="7588921">]</span><span class="op" id="7588922">*</span><span class="ident" id="7588923">Bug3</span><br>
<span class="lineno"></span><span class="op" id="7588928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">785</span><span class="keyword" id="7588931">func</span>&nbsp;<span class="ident" id="7588936">TestGobPtrSlices</span><span class="op" id="7588952">(</span><span class="ident" id="7588953">t</span>&nbsp;<span class="op" id="7588955">*</span><span class="ident" id="7588956">testing</span><span class="op" id="7588963">.</span><span class="ident" id="7588964">T</span><span class="op" id="7588965">)</span>&nbsp;<span class="op" id="7588967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588970">in</span>&nbsp;<span class="op" id="7588973">:=</span>&nbsp;<span class="op" id="7588976">[</span><span class="op" id="7588977">]</span><span class="op" id="7588978">*</span><span class="ident" id="7588979">Bug3</span><span class="op" id="7588983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588987">{</span><span class="num" id="7588988">1</span><span class="op" id="7588989">,</span>&nbsp;<span class="ident" id="7588991">nil</span><span class="op" id="7588994">}</span><span class="op" id="7588995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588999">{</span><span class="num" id="7589000">2</span><span class="op" id="7589001">,</span>&nbsp;<span class="ident" id="7589003">nil</span><span class="op" id="7589006">}</span><span class="op" id="7589007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589010">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589013">b</span>&nbsp;<span class="op" id="7589015">:=</span>&nbsp;<span class="builtinfunc" id="7589018">new</span><span class="op" id="7589021">(</span><span class="ident" id="7589022">bytes</span><span class="op" id="7589027">.</span><span class="ident" id="7589028">Buffer</span><span class="op" id="7589034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589037">err</span>&nbsp;<span class="op" id="7589041">:=</span>&nbsp;<span class="ident" id="7589044">NewEncoder</span><span class="op" id="7589054">(</span><span class="ident" id="7589055">b</span><span class="op" id="7589056">)</span><span class="op" id="7589057">.</span><span class="ident" id="7589058">Encode</span><span class="op" id="7589064">(</span><span class="op" id="7589065">&amp;</span><span class="ident" id="7589066">in</span><span class="op" id="7589068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589071">if</span>&nbsp;<span class="ident" id="7589074">err</span>&nbsp;<span class="op" id="7589078">!=</span>&nbsp;<span class="ident" id="7589081">nil</span>&nbsp;<span class="op" id="7589085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589089">t</span><span class="op" id="7589090">.</span><span class="ident" id="7589091">Fatal</span><span class="op" id="7589096">(</span><span class="string" id="7589097">&#34;encode:&#34;</span><span class="op" id="7589106">,</span>&nbsp;<span class="ident" id="7589108">err</span><span class="op" id="7589111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589114">}</span><br>
<span class="lineno">795</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589118">var</span>&nbsp;<span class="ident" id="7589122">out</span>&nbsp;<span class="op" id="7589126">[</span><span class="op" id="7589127">]</span><span class="op" id="7589128">*</span><span class="ident" id="7589129">Bug3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589135">err</span>&nbsp;<span class="op" id="7589139">=</span>&nbsp;<span class="ident" id="7589141">NewDecoder</span><span class="op" id="7589151">(</span><span class="ident" id="7589152">b</span><span class="op" id="7589153">)</span><span class="op" id="7589154">.</span><span class="ident" id="7589155">Decode</span><span class="op" id="7589161">(</span><span class="op" id="7589162">&amp;</span><span class="ident" id="7589163">out</span><span class="op" id="7589166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589169">if</span>&nbsp;<span class="ident" id="7589172">err</span>&nbsp;<span class="op" id="7589176">!=</span>&nbsp;<span class="ident" id="7589179">nil</span>&nbsp;<span class="op" id="7589183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589187">t</span><span class="op" id="7589188">.</span><span class="ident" id="7589189">Fatal</span><span class="op" id="7589194">(</span><span class="string" id="7589195">&#34;decode:&#34;</span><span class="op" id="7589204">,</span>&nbsp;<span class="ident" id="7589206">err</span><span class="op" id="7589209">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589215">if</span>&nbsp;<span class="op" id="7589218">!</span><span class="ident" id="7589219">reflect</span><span class="op" id="7589226">.</span><span class="ident" id="7589227">DeepEqual</span><span class="op" id="7589236">(</span><span class="ident" id="7589237">in</span><span class="op" id="7589239">,</span>&nbsp;<span class="ident" id="7589241">out</span><span class="op" id="7589244">)</span>&nbsp;<span class="op" id="7589246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589250">t</span><span class="op" id="7589251">.</span><span class="ident" id="7589252">Fatalf</span><span class="op" id="7589258">(</span><span class="string" id="7589259">&#34;got&nbsp;%v;&nbsp;wanted&nbsp;%v&#34;</span><span class="op" id="7589278">,</span>&nbsp;<span class="ident" id="7589280">out</span><span class="op" id="7589283">,</span>&nbsp;<span class="ident" id="7589285">in</span><span class="op" id="7589287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589290">}</span><br>
<span class="lineno"></span><span class="op" id="7589292">}</span><br>
<span class="lineno">805</span><br>
<span class="lineno"></span><span class="comment" id="7589295">//&nbsp;getDecEnginePtr&nbsp;cached&nbsp;engine&nbsp;for&nbsp;ut.base&nbsp;instead&nbsp;of&nbsp;ut.user&nbsp;so&nbsp;we&nbsp;passed</span><br>
<span class="lineno"></span><span class="comment" id="7589372">//&nbsp;a&nbsp;*map&nbsp;and&nbsp;then&nbsp;tried&nbsp;to&nbsp;reuse&nbsp;its&nbsp;engine&nbsp;to&nbsp;decode&nbsp;the&nbsp;inner&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="7589442">func</span>&nbsp;<span class="ident" id="7589447">TestPtrToMapOfMap</span><span class="op" id="7589464">(</span><span class="ident" id="7589465">t</span>&nbsp;<span class="op" id="7589467">*</span><span class="ident" id="7589468">testing</span><span class="op" id="7589475">.</span><span class="ident" id="7589476">T</span><span class="op" id="7589477">)</span>&nbsp;<span class="op" id="7589479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589482">Register</span><span class="op" id="7589490">(</span><span class="builtinfunc" id="7589491">make</span><span class="op" id="7589495">(</span><span class="keyword" id="7589496">map</span><span class="op" id="7589499">[</span><span class="builtintype" id="7589500">string</span><span class="op" id="7589506">]</span><span class="keyword" id="7589507">interface</span><span class="op" id="7589516">{</span><span class="op" id="7589517">}</span><span class="op" id="7589518">)</span><span class="op" id="7589519">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589522">subdata</span>&nbsp;<span class="op" id="7589530">:=</span>&nbsp;<span class="builtinfunc" id="7589533">make</span><span class="op" id="7589537">(</span><span class="keyword" id="7589538">map</span><span class="op" id="7589541">[</span><span class="builtintype" id="7589542">string</span><span class="op" id="7589548">]</span><span class="keyword" id="7589549">interface</span><span class="op" id="7589558">{</span><span class="op" id="7589559">}</span><span class="op" id="7589560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589563">subdata</span><span class="op" id="7589570">[</span><span class="string" id="7589571">&#34;bar&#34;</span><span class="op" id="7589576">]</span>&nbsp;<span class="op" id="7589578">=</span>&nbsp;<span class="string" id="7589580">&#34;baz&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589587">data</span>&nbsp;<span class="op" id="7589592">:=</span>&nbsp;<span class="builtinfunc" id="7589595">make</span><span class="op" id="7589599">(</span><span class="keyword" id="7589600">map</span><span class="op" id="7589603">[</span><span class="builtintype" id="7589604">string</span><span class="op" id="7589610">]</span><span class="keyword" id="7589611">interface</span><span class="op" id="7589620">{</span><span class="op" id="7589621">}</span><span class="op" id="7589622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589625">data</span><span class="op" id="7589629">[</span><span class="string" id="7589630">&#34;foo&#34;</span><span class="op" id="7589635">]</span>&nbsp;<span class="op" id="7589637">=</span>&nbsp;<span class="ident" id="7589639">subdata</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589649">b</span>&nbsp;<span class="op" id="7589651">:=</span>&nbsp;<span class="builtinfunc" id="7589654">new</span><span class="op" id="7589657">(</span><span class="ident" id="7589658">bytes</span><span class="op" id="7589663">.</span><span class="ident" id="7589664">Buffer</span><span class="op" id="7589670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589673">err</span>&nbsp;<span class="op" id="7589677">:=</span>&nbsp;<span class="ident" id="7589680">NewEncoder</span><span class="op" id="7589690">(</span><span class="ident" id="7589691">b</span><span class="op" id="7589692">)</span><span class="op" id="7589693">.</span><span class="ident" id="7589694">Encode</span><span class="op" id="7589700">(</span><span class="ident" id="7589701">data</span><span class="op" id="7589705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589708">if</span>&nbsp;<span class="ident" id="7589711">err</span>&nbsp;<span class="op" id="7589715">!=</span>&nbsp;<span class="ident" id="7589718">nil</span>&nbsp;<span class="op" id="7589722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589726">t</span><span class="op" id="7589727">.</span><span class="ident" id="7589728">Fatal</span><span class="op" id="7589733">(</span><span class="string" id="7589734">&#34;encode:&#34;</span><span class="op" id="7589743">,</span>&nbsp;<span class="ident" id="7589745">err</span><span class="op" id="7589748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589751">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589754">var</span>&nbsp;<span class="ident" id="7589758">newData</span>&nbsp;<span class="keyword" id="7589766">map</span><span class="op" id="7589769">[</span><span class="builtintype" id="7589770">string</span><span class="op" id="7589776">]</span><span class="keyword" id="7589777">interface</span><span class="op" id="7589786">{</span><span class="op" id="7589787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589790">err</span>&nbsp;<span class="op" id="7589794">=</span>&nbsp;<span class="ident" id="7589796">NewDecoder</span><span class="op" id="7589806">(</span><span class="ident" id="7589807">b</span><span class="op" id="7589808">)</span><span class="op" id="7589809">.</span><span class="ident" id="7589810">Decode</span><span class="op" id="7589816">(</span><span class="op" id="7589817">&amp;</span><span class="ident" id="7589818">newData</span><span class="op" id="7589825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589828">if</span>&nbsp;<span class="ident" id="7589831">err</span>&nbsp;<span class="op" id="7589835">!=</span>&nbsp;<span class="ident" id="7589838">nil</span>&nbsp;<span class="op" id="7589842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589846">t</span><span class="op" id="7589847">.</span><span class="ident" id="7589848">Fatal</span><span class="op" id="7589853">(</span><span class="string" id="7589854">&#34;decode:&#34;</span><span class="op" id="7589863">,</span>&nbsp;<span class="ident" id="7589865">err</span><span class="op" id="7589868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589871">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589874">if</span>&nbsp;<span class="op" id="7589877">!</span><span class="ident" id="7589878">reflect</span><span class="op" id="7589885">.</span><span class="ident" id="7589886">DeepEqual</span><span class="op" id="7589895">(</span><span class="ident" id="7589896">data</span><span class="op" id="7589900">,</span>&nbsp;<span class="ident" id="7589902">newData</span><span class="op" id="7589909">)</span>&nbsp;<span class="op" id="7589911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589915">t</span><span class="op" id="7589916">.</span><span class="ident" id="7589917">Fatalf</span><span class="op" id="7589923">(</span><span class="string" id="7589924">&#34;expected&nbsp;%v&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7589944">,</span>&nbsp;<span class="ident" id="7589946">data</span><span class="op" id="7589950">,</span>&nbsp;<span class="ident" id="7589952">newData</span><span class="op" id="7589959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589962">}</span><br>
<span class="lineno"></span><span class="op" id="7589964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="comment" id="7589967">//&nbsp;A&nbsp;top-level&nbsp;nil&nbsp;pointer&nbsp;generates&nbsp;a&nbsp;panic&nbsp;with&nbsp;a&nbsp;helpful&nbsp;string-valued&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="7590050">func</span>&nbsp;<span class="ident" id="7590055">TestTopLevelNilPointer</span><span class="op" id="7590077">(</span><span class="ident" id="7590078">t</span>&nbsp;<span class="op" id="7590080">*</span><span class="ident" id="7590081">testing</span><span class="op" id="7590088">.</span><span class="ident" id="7590089">T</span><span class="op" id="7590090">)</span>&nbsp;<span class="op" id="7590092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590095">errMsg</span>&nbsp;<span class="op" id="7590102">:=</span>&nbsp;<span class="ident" id="7590105">topLevelNilPanic</span><span class="op" id="7590121">(</span><span class="ident" id="7590122">t</span><span class="op" id="7590123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590126">if</span>&nbsp;<span class="ident" id="7590129">errMsg</span>&nbsp;<span class="op" id="7590136">==</span>&nbsp;<span class="string" id="7590139">&#34;&#34;</span>&nbsp;<span class="op" id="7590142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590146">t</span><span class="op" id="7590147">.</span><span class="ident" id="7590148">Fatal</span><span class="op" id="7590153">(</span><span class="string" id="7590154">&#34;top-level&nbsp;nil&nbsp;pointer&nbsp;did&nbsp;not&nbsp;panic&#34;</span><span class="op" id="7590191">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590197">if</span>&nbsp;<span class="op" id="7590200">!</span><span class="ident" id="7590201">strings</span><span class="op" id="7590208">.</span><span class="ident" id="7590209">Contains</span><span class="op" id="7590217">(</span><span class="ident" id="7590218">errMsg</span><span class="op" id="7590224">,</span>&nbsp;<span class="string" id="7590226">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="7590239">)</span>&nbsp;<span class="op" id="7590241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590245">t</span><span class="op" id="7590246">.</span><span class="ident" id="7590247">Fatal</span><span class="op" id="7590252">(</span><span class="string" id="7590253">&#34;expected&nbsp;nil&nbsp;pointer&nbsp;error,&nbsp;got:&#34;</span><span class="op" id="7590287">,</span>&nbsp;<span class="ident" id="7590289">errMsg</span><span class="op" id="7590295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590298">}</span><br>
<span class="lineno"></span><span class="op" id="7590300">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="7590303">func</span>&nbsp;<span class="ident" id="7590308">topLevelNilPanic</span><span class="op" id="7590324">(</span><span class="ident" id="7590325">t</span>&nbsp;<span class="op" id="7590327">*</span><span class="ident" id="7590328">testing</span><span class="op" id="7590335">.</span><span class="ident" id="7590336">T</span><span class="op" id="7590337">)</span>&nbsp;<span class="op" id="7590339">(</span><span class="ident" id="7590340">panicErr</span>&nbsp;<span class="builtintype" id="7590349">string</span><span class="op" id="7590355">)</span>&nbsp;<span class="op" id="7590357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590360">defer</span>&nbsp;<span class="keyword" id="7590366">func</span><span class="op" id="7590370">(</span><span class="op" id="7590371">)</span>&nbsp;<span class="op" id="7590373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590377">e</span>&nbsp;<span class="op" id="7590379">:=</span>&nbsp;<span class="builtinfunc" id="7590382">recover</span><span class="op" id="7590389">(</span><span class="op" id="7590390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590394">if</span>&nbsp;<span class="ident" id="7590397">err</span><span class="op" id="7590400">,</span>&nbsp;<span class="ident" id="7590402">ok</span>&nbsp;<span class="op" id="7590405">:=</span>&nbsp;<span class="ident" id="7590408">e</span><span class="op" id="7590409">.</span><span class="op" id="7590410">(</span><span class="builtintype" id="7590411">string</span><span class="op" id="7590417">)</span><span class="op" id="7590418">;</span>&nbsp;<span class="ident" id="7590420">ok</span>&nbsp;<span class="op" id="7590423">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590428">panicErr</span>&nbsp;<span class="op" id="7590437">=</span>&nbsp;<span class="ident" id="7590439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590448">}</span><span class="op" id="7590449">(</span><span class="op" id="7590450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590453">var</span>&nbsp;<span class="ident" id="7590457">ip</span>&nbsp;<span class="op" id="7590460">*</span><span class="builtintype" id="7590461">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590466">buf</span>&nbsp;<span class="op" id="7590470">:=</span>&nbsp;<span class="builtinfunc" id="7590473">new</span><span class="op" id="7590476">(</span><span class="ident" id="7590477">bytes</span><span class="op" id="7590482">.</span><span class="ident" id="7590483">Buffer</span><span class="op" id="7590489">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590492">if</span>&nbsp;<span class="ident" id="7590495">err</span>&nbsp;<span class="op" id="7590499">:=</span>&nbsp;<span class="ident" id="7590502">NewEncoder</span><span class="op" id="7590512">(</span><span class="ident" id="7590513">buf</span><span class="op" id="7590516">)</span><span class="op" id="7590517">.</span><span class="ident" id="7590518">Encode</span><span class="op" id="7590524">(</span><span class="ident" id="7590525">ip</span><span class="op" id="7590527">)</span><span class="op" id="7590528">;</span>&nbsp;<span class="ident" id="7590530">err</span>&nbsp;<span class="op" id="7590534">!=</span>&nbsp;<span class="ident" id="7590537">nil</span>&nbsp;<span class="op" id="7590541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590545">t</span><span class="op" id="7590546">.</span><span class="ident" id="7590547">Fatal</span><span class="op" id="7590552">(</span><span class="string" id="7590553">&#34;error&nbsp;in&nbsp;encode:&#34;</span><span class="op" id="7590571">,</span>&nbsp;<span class="ident" id="7590573">err</span><span class="op" id="7590576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590582">return</span><br>
<span class="lineno"></span><span class="op" id="7590589">}</span><br>
<span class="lineno">855</span><br>
<span class="lineno"></span><span class="keyword" id="7590592">func</span>&nbsp;<span class="ident" id="7590597">TestNilPointerInsideInterface</span><span class="op" id="7590626">(</span><span class="ident" id="7590627">t</span>&nbsp;<span class="op" id="7590629">*</span><span class="ident" id="7590630">testing</span><span class="op" id="7590637">.</span><span class="ident" id="7590638">T</span><span class="op" id="7590639">)</span>&nbsp;<span class="op" id="7590641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590644">var</span>&nbsp;<span class="ident" id="7590648">ip</span>&nbsp;<span class="op" id="7590651">*</span><span class="builtintype" id="7590652">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590657">si</span>&nbsp;<span class="op" id="7590660">:=</span>&nbsp;<span class="keyword" id="7590663">struct</span>&nbsp;<span class="op" id="7590670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590674">I</span>&nbsp;<span class="keyword" id="7590676">interface</span><span class="op" id="7590685">{</span><span class="op" id="7590686">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590689">}</span><span class="op" id="7590690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590694">I</span><span class="op" id="7590695">:</span>&nbsp;<span class="ident" id="7590697">ip</span><span class="op" id="7590699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590705">buf</span>&nbsp;<span class="op" id="7590709">:=</span>&nbsp;<span class="builtinfunc" id="7590712">new</span><span class="op" id="7590715">(</span><span class="ident" id="7590716">bytes</span><span class="op" id="7590721">.</span><span class="ident" id="7590722">Buffer</span><span class="op" id="7590728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590731">err</span>&nbsp;<span class="op" id="7590735">:=</span>&nbsp;<span class="ident" id="7590738">NewEncoder</span><span class="op" id="7590748">(</span><span class="ident" id="7590749">buf</span><span class="op" id="7590752">)</span><span class="op" id="7590753">.</span><span class="ident" id="7590754">Encode</span><span class="op" id="7590760">(</span><span class="ident" id="7590761">si</span><span class="op" id="7590763">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590766">if</span>&nbsp;<span class="ident" id="7590769">err</span>&nbsp;<span class="op" id="7590773">==</span>&nbsp;<span class="ident" id="7590776">nil</span>&nbsp;<span class="op" id="7590780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590784">t</span><span class="op" id="7590785">.</span><span class="ident" id="7590786">Fatal</span><span class="op" id="7590791">(</span><span class="string" id="7590792">&#34;expected&nbsp;error,&nbsp;got&nbsp;none&#34;</span><span class="op" id="7590818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590824">errMsg</span>&nbsp;<span class="op" id="7590831">:=</span>&nbsp;<span class="ident" id="7590834">err</span><span class="op" id="7590837">.</span><span class="ident" id="7590838">Error</span><span class="op" id="7590843">(</span><span class="op" id="7590844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590847">if</span>&nbsp;<span class="op" id="7590850">!</span><span class="ident" id="7590851">strings</span><span class="op" id="7590858">.</span><span class="ident" id="7590859">Contains</span><span class="op" id="7590867">(</span><span class="ident" id="7590868">errMsg</span><span class="op" id="7590874">,</span>&nbsp;<span class="string" id="7590876">&#34;nil&nbsp;pointer&#34;</span><span class="op" id="7590889">)</span>&nbsp;<span class="op" id="7590891">||</span>&nbsp;<span class="op" id="7590894">!</span><span class="ident" id="7590895">strings</span><span class="op" id="7590902">.</span><span class="ident" id="7590903">Contains</span><span class="op" id="7590911">(</span><span class="ident" id="7590912">errMsg</span><span class="op" id="7590918">,</span>&nbsp;<span class="string" id="7590920">&#34;interface&#34;</span><span class="op" id="7590931">)</span>&nbsp;<span class="op" id="7590933">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590937">t</span><span class="op" id="7590938">.</span><span class="ident" id="7590939">Fatal</span><span class="op" id="7590944">(</span><span class="string" id="7590945">&#34;expected&nbsp;error&nbsp;about&nbsp;nil&nbsp;pointer&nbsp;and&nbsp;interface,&nbsp;got:&#34;</span><span class="op" id="7590999">,</span>&nbsp;<span class="ident" id="7591001">errMsg</span><span class="op" id="7591007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7591010">}</span><br>
<span class="lineno"></span><span class="op" id="7591012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7591015">type</span>&nbsp;<span class="ident" id="7591020">Bug4Public</span>&nbsp;<span class="keyword" id="7591031">struct</span>&nbsp;<span class="op" id="7591038">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591041">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7591048">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591056">Secret</span>&nbsp;<span class="ident" id="7591063">Bug4Secret</span><br>
<span class="lineno"></span><span class="op" id="7591074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7591077">type</span>&nbsp;<span class="ident" id="7591082">Bug4Secret</span>&nbsp;<span class="keyword" id="7591093">struct</span>&nbsp;<span class="op" id="7591100">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591103">a</span>&nbsp;<span class="builtintype" id="7591105">int</span>&nbsp;<span class="comment" id="7591109">//&nbsp;error:&nbsp;no&nbsp;exported&nbsp;fields.</span><br>
<span class="lineno"></span><span class="op" id="7591139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7591142">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;failed&nbsp;compilation&nbsp;doesn&#39;t&nbsp;leave&nbsp;around&nbsp;an&nbsp;executable&nbsp;encoder.</span><br>
<span class="lineno"></span><span class="comment" id="7591220">//&nbsp;Issue&nbsp;3273.</span><br>
<span class="lineno">885</span><span class="keyword" id="7591235">func</span>&nbsp;<span class="ident" id="7591240">TestMutipleEncodingsOfBadType</span><span class="op" id="7591269">(</span><span class="ident" id="7591270">t</span>&nbsp;<span class="op" id="7591272">*</span><span class="ident" id="7591273">testing</span><span class="op" id="7591280">.</span><span class="ident" id="7591281">T</span><span class="op" id="7591282">)</span>&nbsp;<span class="op" id="7591284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591287">x</span>&nbsp;<span class="op" id="7591289">:=</span>&nbsp;<span class="ident" id="7591292">Bug4Public</span><span class="op" id="7591302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591306">Name</span><span class="op" id="7591310">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7591314">&#34;name&#34;</span><span class="op" id="7591320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591324">Secret</span><span class="op" id="7591330">:</span>&nbsp;<span class="ident" id="7591332">Bug4Secret</span><span class="op" id="7591342">{</span><span class="num" id="7591343">1</span><span class="op" id="7591344">}</span><span class="op" id="7591345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7591348">}</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591351">buf</span>&nbsp;<span class="op" id="7591355">:=</span>&nbsp;<span class="builtinfunc" id="7591358">new</span><span class="op" id="7591361">(</span><span class="ident" id="7591362">bytes</span><span class="op" id="7591367">.</span><span class="ident" id="7591368">Buffer</span><span class="op" id="7591374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591377">enc</span>&nbsp;<span class="op" id="7591381">:=</span>&nbsp;<span class="ident" id="7591384">NewEncoder</span><span class="op" id="7591394">(</span><span class="ident" id="7591395">buf</span><span class="op" id="7591398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591401">err</span>&nbsp;<span class="op" id="7591405">:=</span>&nbsp;<span class="ident" id="7591408">enc</span><span class="op" id="7591411">.</span><span class="ident" id="7591412">Encode</span><span class="op" id="7591418">(</span><span class="ident" id="7591419">x</span><span class="op" id="7591420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7591423">if</span>&nbsp;<span class="ident" id="7591426">err</span>&nbsp;<span class="op" id="7591430">==</span>&nbsp;<span class="ident" id="7591433">nil</span>&nbsp;<span class="op" id="7591437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591441">t</span><span class="op" id="7591442">.</span><span class="ident" id="7591443">Fatal</span><span class="op" id="7591448">(</span><span class="string" id="7591449">&#34;first&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7591481">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7591484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591487">buf</span><span class="op" id="7591490">.</span><span class="ident" id="7591491">Reset</span><span class="op" id="7591496">(</span><span class="op" id="7591497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591500">enc</span>&nbsp;<span class="op" id="7591504">=</span>&nbsp;<span class="ident" id="7591506">NewEncoder</span><span class="op" id="7591516">(</span><span class="ident" id="7591517">buf</span><span class="op" id="7591520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591523">err</span>&nbsp;<span class="op" id="7591527">=</span>&nbsp;<span class="ident" id="7591529">enc</span><span class="op" id="7591532">.</span><span class="ident" id="7591533">Encode</span><span class="op" id="7591539">(</span><span class="ident" id="7591540">x</span><span class="op" id="7591541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7591544">if</span>&nbsp;<span class="ident" id="7591547">err</span>&nbsp;<span class="op" id="7591551">==</span>&nbsp;<span class="ident" id="7591554">nil</span>&nbsp;<span class="op" id="7591558">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591562">t</span><span class="op" id="7591563">.</span><span class="ident" id="7591564">Fatal</span><span class="op" id="7591569">(</span><span class="string" id="7591570">&#34;second&nbsp;encoding:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7591603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7591606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7591609">if</span>&nbsp;<span class="op" id="7591612">!</span><span class="ident" id="7591613">strings</span><span class="op" id="7591620">.</span><span class="ident" id="7591621">Contains</span><span class="op" id="7591629">(</span><span class="ident" id="7591630">err</span><span class="op" id="7591633">.</span><span class="ident" id="7591634">Error</span><span class="op" id="7591639">(</span><span class="op" id="7591640">)</span><span class="op" id="7591641">,</span>&nbsp;<span class="string" id="7591643">&#34;no&nbsp;exported&nbsp;fields&#34;</span><span class="op" id="7591663">)</span>&nbsp;<span class="op" id="7591665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7591669">t</span><span class="op" id="7591670">.</span><span class="ident" id="7591671">Errorf</span><span class="op" id="7591677">(</span><span class="string" id="7591678">&#34;expected&nbsp;error&nbsp;about&nbsp;no&nbsp;exported&nbsp;fields;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7591727">,</span>&nbsp;<span class="ident" id="7591729">err</span><span class="op" id="7591732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7591735">}</span><br>
<span class="lineno">905</span><span class="op" id="7591737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7591740">//&nbsp;There&nbsp;was&nbsp;an&nbsp;error&nbsp;check&nbsp;comparing&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;input&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7591811">//&nbsp;length&nbsp;of&nbsp;the&nbsp;slice&nbsp;being&nbsp;decoded.&nbsp;It&nbsp;was&nbsp;wrong&nbsp;because&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="7591879">//&nbsp;thing&nbsp;in&nbsp;the&nbsp;input&nbsp;might&nbsp;be&nbsp;a&nbsp;type&nbsp;definition,&nbsp;which&nbsp;would&nbsp;lead&nbsp;to</span><br>
<span class="lineno">910</span><span class="comment" id="7591949">//&nbsp;an&nbsp;incorrect&nbsp;length&nbsp;check.&nbsp;&nbsp;This&nbsp;test&nbsp;reproduces&nbsp;the&nbsp;corner&nbsp;case.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7592019">type</span>&nbsp;<span class="ident" id="7592024">Z</span>&nbsp;<span class="keyword" id="7592026">struct</span>&nbsp;<span class="op" id="7592033">{</span><br>
<span class="lineno"></span><span class="op" id="7592035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="keyword" id="7592038">func</span>&nbsp;<span class="ident" id="7592043">Test29ElementSlice</span><span class="op" id="7592061">(</span><span class="ident" id="7592062">t</span>&nbsp;<span class="op" id="7592064">*</span><span class="ident" id="7592065">testing</span><span class="op" id="7592072">.</span><span class="ident" id="7592073">T</span><span class="op" id="7592074">)</span>&nbsp;<span class="op" id="7592076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592079">Register</span><span class="op" id="7592087">(</span><span class="ident" id="7592088">Z</span><span class="op" id="7592089">{</span><span class="op" id="7592090">}</span><span class="op" id="7592091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592094">src</span>&nbsp;<span class="op" id="7592098">:=</span>&nbsp;<span class="builtinfunc" id="7592101">make</span><span class="op" id="7592105">(</span><span class="op" id="7592106">[</span><span class="op" id="7592107">]</span><span class="keyword" id="7592108">interface</span><span class="op" id="7592117">{</span><span class="op" id="7592118">}</span><span class="op" id="7592119">,</span>&nbsp;<span class="num" id="7592121">100</span><span class="op" id="7592124">)</span>&nbsp;<span class="comment" id="7592126">//&nbsp;Size&nbsp;needs&nbsp;to&nbsp;be&nbsp;bigger&nbsp;than&nbsp;size&nbsp;of&nbsp;type&nbsp;definition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592184">for</span>&nbsp;<span class="ident" id="7592188">i</span>&nbsp;<span class="op" id="7592190">:=</span>&nbsp;<span class="keyword" id="7592193">range</span>&nbsp;<span class="ident" id="7592199">src</span>&nbsp;<span class="op" id="7592203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592207">src</span><span class="op" id="7592210">[</span><span class="ident" id="7592211">i</span><span class="op" id="7592212">]</span>&nbsp;<span class="op" id="7592214">=</span>&nbsp;<span class="ident" id="7592216">Z</span><span class="op" id="7592217">{</span><span class="op" id="7592218">}</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7592221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592224">buf</span>&nbsp;<span class="op" id="7592228">:=</span>&nbsp;<span class="builtinfunc" id="7592231">new</span><span class="op" id="7592234">(</span><span class="ident" id="7592235">bytes</span><span class="op" id="7592240">.</span><span class="ident" id="7592241">Buffer</span><span class="op" id="7592247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592250">err</span>&nbsp;<span class="op" id="7592254">:=</span>&nbsp;<span class="ident" id="7592257">NewEncoder</span><span class="op" id="7592267">(</span><span class="ident" id="7592268">buf</span><span class="op" id="7592271">)</span><span class="op" id="7592272">.</span><span class="ident" id="7592273">Encode</span><span class="op" id="7592279">(</span><span class="ident" id="7592280">src</span><span class="op" id="7592283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592286">if</span>&nbsp;<span class="ident" id="7592289">err</span>&nbsp;<span class="op" id="7592293">!=</span>&nbsp;<span class="ident" id="7592296">nil</span>&nbsp;<span class="op" id="7592300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592304">t</span><span class="op" id="7592305">.</span><span class="ident" id="7592306">Fatalf</span><span class="op" id="7592312">(</span><span class="string" id="7592313">&#34;encode:&nbsp;%v&#34;</span><span class="op" id="7592325">,</span>&nbsp;<span class="ident" id="7592327">err</span><span class="op" id="7592330">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592334">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7592342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592346">var</span>&nbsp;<span class="ident" id="7592350">dst</span>&nbsp;<span class="op" id="7592354">[</span><span class="op" id="7592355">]</span><span class="keyword" id="7592356">interface</span><span class="op" id="7592365">{</span><span class="op" id="7592366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592369">err</span>&nbsp;<span class="op" id="7592373">=</span>&nbsp;<span class="ident" id="7592375">NewDecoder</span><span class="op" id="7592385">(</span><span class="ident" id="7592386">buf</span><span class="op" id="7592389">)</span><span class="op" id="7592390">.</span><span class="ident" id="7592391">Decode</span><span class="op" id="7592397">(</span><span class="op" id="7592398">&amp;</span><span class="ident" id="7592399">dst</span><span class="op" id="7592402">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592405">if</span>&nbsp;<span class="ident" id="7592408">err</span>&nbsp;<span class="op" id="7592412">!=</span>&nbsp;<span class="ident" id="7592415">nil</span>&nbsp;<span class="op" id="7592419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592423">t</span><span class="op" id="7592424">.</span><span class="ident" id="7592425">Errorf</span><span class="op" id="7592431">(</span><span class="string" id="7592432">&#34;decode:&nbsp;%v&#34;</span><span class="op" id="7592444">,</span>&nbsp;<span class="ident" id="7592446">err</span><span class="op" id="7592449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592453">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7592461">}</span><br>
<span class="lineno"></span><span class="op" id="7592463">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="comment" id="7592466">//&nbsp;Don&#39;t&nbsp;crash,&nbsp;just&nbsp;give&nbsp;error&nbsp;when&nbsp;allocating&nbsp;a&nbsp;huge&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="7592528">//&nbsp;Issue&nbsp;8084.</span><br>
<span class="lineno"></span><span class="keyword" id="7592543">func</span>&nbsp;<span class="ident" id="7592548">TestErrorForHugeSlice</span><span class="op" id="7592569">(</span><span class="ident" id="7592570">t</span>&nbsp;<span class="op" id="7592572">*</span><span class="ident" id="7592573">testing</span><span class="op" id="7592580">.</span><span class="ident" id="7592581">T</span><span class="op" id="7592582">)</span>&nbsp;<span class="op" id="7592584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7592587">//&nbsp;Encode&nbsp;an&nbsp;int&nbsp;slice.</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592612">buf</span>&nbsp;<span class="op" id="7592616">:=</span>&nbsp;<span class="builtinfunc" id="7592619">new</span><span class="op" id="7592622">(</span><span class="ident" id="7592623">bytes</span><span class="op" id="7592628">.</span><span class="ident" id="7592629">Buffer</span><span class="op" id="7592635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592638">slice</span>&nbsp;<span class="op" id="7592644">:=</span>&nbsp;<span class="op" id="7592647">[</span><span class="op" id="7592648">]</span><span class="builtintype" id="7592649">int</span><span class="op" id="7592652">{</span><span class="num" id="7592653">1</span><span class="op" id="7592654">,</span>&nbsp;<span class="num" id="7592656">1</span><span class="op" id="7592657">,</span>&nbsp;<span class="num" id="7592659">1</span><span class="op" id="7592660">,</span>&nbsp;<span class="num" id="7592662">1</span><span class="op" id="7592663">,</span>&nbsp;<span class="num" id="7592665">1</span><span class="op" id="7592666">,</span>&nbsp;<span class="num" id="7592668">1</span><span class="op" id="7592669">,</span>&nbsp;<span class="num" id="7592671">1</span><span class="op" id="7592672">,</span>&nbsp;<span class="num" id="7592674">1</span><span class="op" id="7592675">,</span>&nbsp;<span class="num" id="7592677">1</span><span class="op" id="7592678">,</span>&nbsp;<span class="num" id="7592680">1</span><span class="op" id="7592681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592684">err</span>&nbsp;<span class="op" id="7592688">:=</span>&nbsp;<span class="ident" id="7592691">NewEncoder</span><span class="op" id="7592701">(</span><span class="ident" id="7592702">buf</span><span class="op" id="7592705">)</span><span class="op" id="7592706">.</span><span class="ident" id="7592707">Encode</span><span class="op" id="7592713">(</span><span class="ident" id="7592714">slice</span><span class="op" id="7592719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592722">if</span>&nbsp;<span class="ident" id="7592725">err</span>&nbsp;<span class="op" id="7592729">!=</span>&nbsp;<span class="ident" id="7592732">nil</span>&nbsp;<span class="op" id="7592736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592740">t</span><span class="op" id="7592741">.</span><span class="ident" id="7592742">Fatal</span><span class="op" id="7592747">(</span><span class="string" id="7592748">&#34;encode:&#34;</span><span class="op" id="7592757">,</span>&nbsp;<span class="ident" id="7592759">err</span><span class="op" id="7592762">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7592765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7592768">//&nbsp;Reach&nbsp;into&nbsp;the&nbsp;buffer&nbsp;and&nbsp;smash&nbsp;the&nbsp;count&nbsp;to&nbsp;make&nbsp;the&nbsp;encoded&nbsp;slice&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592851">buf</span><span class="op" id="7592854">.</span><span class="ident" id="7592855">Bytes</span><span class="op" id="7592860">(</span><span class="op" id="7592861">)</span><span class="op" id="7592862">[</span><span class="ident" id="7592863">buf</span><span class="op" id="7592866">.</span><span class="ident" id="7592867">Len</span><span class="op" id="7592870">(</span><span class="op" id="7592871">)</span><span class="op" id="7592872">-</span><span class="builtinfunc" id="7592873">len</span><span class="op" id="7592876">(</span><span class="ident" id="7592877">slice</span><span class="op" id="7592882">)</span><span class="op" id="7592883">-</span><span class="num" id="7592884">1</span><span class="op" id="7592885">]</span>&nbsp;<span class="op" id="7592887">=</span>&nbsp;<span class="num" id="7592889">0xfa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7592895">//&nbsp;Decode&nbsp;and&nbsp;see&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592921">err</span>&nbsp;<span class="op" id="7592925">=</span>&nbsp;<span class="ident" id="7592927">NewDecoder</span><span class="op" id="7592937">(</span><span class="ident" id="7592938">buf</span><span class="op" id="7592941">)</span><span class="op" id="7592942">.</span><span class="ident" id="7592943">Decode</span><span class="op" id="7592949">(</span><span class="op" id="7592950">&amp;</span><span class="ident" id="7592951">slice</span><span class="op" id="7592956">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7592959">if</span>&nbsp;<span class="ident" id="7592962">err</span>&nbsp;<span class="op" id="7592966">==</span>&nbsp;<span class="ident" id="7592969">nil</span>&nbsp;<span class="op" id="7592973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7592977">t</span><span class="op" id="7592978">.</span><span class="ident" id="7592979">Fatal</span><span class="op" id="7592984">(</span><span class="string" id="7592985">&#34;decode:&nbsp;no&nbsp;error&#34;</span><span class="op" id="7593003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7593006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7593009">if</span>&nbsp;<span class="op" id="7593012">!</span><span class="ident" id="7593013">strings</span><span class="op" id="7593020">.</span><span class="ident" id="7593021">Contains</span><span class="op" id="7593029">(</span><span class="ident" id="7593030">err</span><span class="op" id="7593033">.</span><span class="ident" id="7593034">Error</span><span class="op" id="7593039">(</span><span class="op" id="7593040">)</span><span class="op" id="7593041">,</span>&nbsp;<span class="string" id="7593043">&#34;slice&nbsp;too&nbsp;big&#34;</span><span class="op" id="7593058">)</span>&nbsp;<span class="op" id="7593060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7593064">t</span><span class="op" id="7593065">.</span><span class="ident" id="7593066">Fatal</span><span class="op" id="7593071">(</span><span class="string" id="7593072">&#34;decode:&nbsp;expected&nbsp;slice&nbsp;too&nbsp;big&nbsp;error,&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7593118">,</span>&nbsp;<span class="ident" id="7593120">err</span><span class="op" id="7593123">.</span><span class="ident" id="7593124">Error</span><span class="op" id="7593129">(</span><span class="op" id="7593130">)</span><span class="op" id="7593131">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7593134">}</span><br>
<span class="lineno"></span><span class="op" id="7593136">}</span>
</div>
</body>
</html>
