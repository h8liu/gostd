<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1515733">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1515789">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1515843">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1515894">//&nbsp;+build&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1515934">package</span>&nbsp;<span class="ident" id="1515942">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1515947">import</span>&nbsp;<span class="op" id="1515954">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1515957">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1515963">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1515974">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="1515981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1515984">func</span>&nbsp;<span class="ident" id="1515989">setKeepAlivePeriod</span><span class="op" id="1516007">(</span><span class="ident" id="1516008">fd</span>&nbsp;<span class="op" id="1516011">*</span><span class="ident" id="1516012"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1516017">,</span>&nbsp;<span class="ident" id="1516019">d</span>&nbsp;<span class="ident" id="1516021"><a href="/net/tcpsockopt_unix.go.html#1515974">time</a></span><span class="op" id="1516025">.</span><span class="ident" id="1516026">Duration</span><span class="op" id="1516034">)</span>&nbsp;<span class="builtintype" id="1516036">error</span>&nbsp;<span class="op" id="1516042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516045">if</span>&nbsp;<span class="ident" id="1516048">err</span>&nbsp;<span class="op" id="1516052">:=</span>&nbsp;<span class="ident" id="1516055"><a href="/net/tcpsockopt_unix.go.html#1516008">fd</a></span><span class="op" id="1516057">.</span><span class="ident" id="1516058">incref</span><span class="op" id="1516064">(</span><span class="op" id="1516065">)</span><span class="op" id="1516066">;</span>&nbsp;<span class="ident" id="1516068"><a href="/net/tcpsockopt_unix.go.html#1516048">err</a></span>&nbsp;<span class="op" id="1516072">!=</span>&nbsp;<span class="ident" id="1516075">nil</span>&nbsp;<span class="op" id="1516079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516083">return</span>&nbsp;<span class="ident" id="1516090"><a href="/net/tcpsockopt_unix.go.html#1516048">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516098">defer</span>&nbsp;<span class="ident" id="1516104"><a href="/net/tcpsockopt_unix.go.html#1516008">fd</a></span><span class="op" id="1516106">.</span><span class="ident" id="1516107">decref</span><span class="op" id="1516113">(</span><span class="op" id="1516114">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1516117">//&nbsp;The&nbsp;kernel&nbsp;expects&nbsp;seconds&nbsp;so&nbsp;round&nbsp;to&nbsp;next&nbsp;highest&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516181"><a href="/net/tcpsockopt_unix.go.html#1516019">d</a></span>&nbsp;<span class="op" id="1516183">+=</span>&nbsp;<span class="op" id="1516186">(</span><span class="ident" id="1516187"><a href="/net/tcpsockopt_unix.go.html#1515974">time</a></span><span class="op" id="1516191">.</span><span class="ident" id="1516192">Second</span>&nbsp;<span class="op" id="1516199">-</span>&nbsp;<span class="ident" id="1516201"><a href="/net/tcpsockopt_unix.go.html#1515974">time</a></span><span class="op" id="1516205">.</span><span class="ident" id="1516206">Nanosecond</span><span class="op" id="1516216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1516219">secs</span>&nbsp;<span class="op" id="1516224">:=</span>&nbsp;<span class="builtintype" id="1516227">int</span><span class="op" id="1516230">(</span><span class="ident" id="1516231"><a href="/net/tcpsockopt_unix.go.html#1516019">d</a></span><span class="op" id="1516232">.</span><span class="ident" id="1516233">Seconds</span><span class="op" id="1516240">(</span><span class="op" id="1516241">)</span><span class="op" id="1516242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516245">if</span>&nbsp;<span class="ident" id="1516248">err</span>&nbsp;<span class="op" id="1516252">:=</span>&nbsp;<span class="ident" id="1516255"><a href="/net/tcpsockopt_unix.go.html#1515963">syscall</a></span><span class="op" id="1516262">.</span><span class="ident" id="1516263">SetsockoptInt</span><span class="op" id="1516276">(</span><span class="ident" id="1516277"><a href="/net/tcpsockopt_unix.go.html#1516008">fd</a></span><span class="op" id="1516279">.</span><span class="ident" id="1516280">sysfd</span><span class="op" id="1516285">,</span>&nbsp;<span class="ident" id="1516287"><a href="/net/tcpsockopt_unix.go.html#1515963">syscall</a></span><span class="op" id="1516294">.</span><span class="ident" id="1516295">IPPROTO_TCP</span><span class="op" id="1516306">,</span>&nbsp;<span class="ident" id="1516308"><a href="/net/tcpsockopt_unix.go.html#1515963">syscall</a></span><span class="op" id="1516315">.</span><span class="ident" id="1516316">TCP_KEEPINTVL</span><span class="op" id="1516329">,</span>&nbsp;<span class="ident" id="1516331"><a href="/net/tcpsockopt_unix.go.html#1516219">secs</a></span><span class="op" id="1516335">)</span><span class="op" id="1516336">;</span>&nbsp;<span class="ident" id="1516338"><a href="/net/tcpsockopt_unix.go.html#1516248">err</a></span>&nbsp;<span class="op" id="1516342">!=</span>&nbsp;<span class="ident" id="1516345">nil</span>&nbsp;<span class="op" id="1516349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516353">return</span>&nbsp;<span class="ident" id="1516360"><a href="/net/tcpsockopt_unix.go.html#1515957">os</a></span><span class="op" id="1516362">.</span><span class="ident" id="1516363">NewSyscallError</span><span class="op" id="1516378">(</span><span class="string" id="1516379">&#34;setsockopt&#34;</span><span class="op" id="1516391">,</span>&nbsp;<span class="ident" id="1516393"><a href="/net/tcpsockopt_unix.go.html#1516248">err</a></span><span class="op" id="1516396">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1516399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1516402">return</span>&nbsp;<span class="ident" id="1516409"><a href="/net/tcpsockopt_unix.go.html#1515957">os</a></span><span class="op" id="1516411">.</span><span class="ident" id="1516412">NewSyscallError</span><span class="op" id="1516427">(</span><span class="string" id="1516428">&#34;setsockopt&#34;</span><span class="op" id="1516440">,</span>&nbsp;<span class="ident" id="1516442"><a href="/net/tcpsockopt_unix.go.html#1515963">syscall</a></span><span class="op" id="1516449">.</span><span class="ident" id="1516450">SetsockoptInt</span><span class="op" id="1516463">(</span><span class="ident" id="1516464"><a href="/net/tcpsockopt_unix.go.html#1516008">fd</a></span><span class="op" id="1516466">.</span><span class="ident" id="1516467">sysfd</span><span class="op" id="1516472">,</span>&nbsp;<span class="ident" id="1516474"><a href="/net/tcpsockopt_unix.go.html#1515963">syscall</a></span><span class="op" id="1516481">.</span><span class="ident" id="1516482">IPPROTO_TCP</span><span class="op" id="1516493">,</span>&nbsp;<span class="ident" id="1516495"><a href="/net/tcpsockopt_unix.go.html#1515963">syscall</a></span><span class="op" id="1516502">.</span><span class="ident" id="1516503">TCP_KEEPIDLE</span><span class="op" id="1516515">,</span>&nbsp;<span class="ident" id="1516517"><a href="/net/tcpsockopt_unix.go.html#1516219">secs</a></span><span class="op" id="1516521">)</span><span class="op" id="1516522">)</span><br>
<span class="lineno"></span><span class="op" id="1516524">}</span>
</div>
</body>
</html>
