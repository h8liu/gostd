<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2412584">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2412639">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2412693">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2412744">package</span>&nbsp;<span class="ident" id="2412752">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2412757">import</span>&nbsp;<span class="op" id="2412764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412767">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412777">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412783">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412791">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412797">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412808">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412819">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2412827">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2412842">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2412845">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2412914">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2412981">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2413051">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2413086">type</span>&nbsp;<span class="ident" id="2413091">runeUnreader</span>&nbsp;<span class="keyword" id="2413104">interface</span>&nbsp;<span class="op" id="2413114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413117">UnreadRune</span><span class="op" id="2413127">(</span><span class="op" id="2413128">)</span>&nbsp;<span class="builtintype" id="2413130">error</span><br>
<span class="lineno"></span><span class="op" id="2413136">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2413139">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2413208">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2413272">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2413319">type</span>&nbsp;<span class="ident" id="2413324">ScanState</span>&nbsp;<span class="keyword" id="2413334">interface</span>&nbsp;<span class="op" id="2413344">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413347">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413417">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413484">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413553">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413578">ReadRune</span><span class="op" id="2413586">(</span><span class="op" id="2413587">)</span>&nbsp;<span class="op" id="2413589">(</span><span class="ident" id="2413590">r</span>&nbsp;<span class="builtintype" id="2413592">rune</span><span class="op" id="2413596">,</span>&nbsp;<span class="ident" id="2413598">size</span>&nbsp;<span class="builtintype" id="2413603">int</span><span class="op" id="2413606">,</span>&nbsp;<span class="ident" id="2413608">err</span>&nbsp;<span class="builtintype" id="2413612">error</span><span class="op" id="2413617">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413620">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413693">UnreadRune</span><span class="op" id="2413703">(</span><span class="op" id="2413704">)</span>&nbsp;<span class="builtintype" id="2413706">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413713">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413783">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413858">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2413891">SkipSpace</span><span class="op" id="2413900">(</span><span class="op" id="2413901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413904">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2413978">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414042">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414114">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414187">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414260">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414335">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414412">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414467">Token</span><span class="op" id="2414472">(</span><span class="ident" id="2414473">skipSpace</span>&nbsp;<span class="builtintype" id="2414483">bool</span><span class="op" id="2414487">,</span>&nbsp;<span class="ident" id="2414489">f</span>&nbsp;<span class="keyword" id="2414491">func</span><span class="op" id="2414495">(</span><span class="builtintype" id="2414496">rune</span><span class="op" id="2414500">)</span>&nbsp;<span class="builtintype" id="2414502">bool</span><span class="op" id="2414506">)</span>&nbsp;<span class="op" id="2414508">(</span><span class="ident" id="2414509">token</span>&nbsp;<span class="op" id="2414515">[</span><span class="op" id="2414516">]</span><span class="builtintype" id="2414517">byte</span><span class="op" id="2414521">,</span>&nbsp;<span class="ident" id="2414523">err</span>&nbsp;<span class="builtintype" id="2414527">error</span><span class="op" id="2414532">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414535">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414612">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414649">Width</span><span class="op" id="2414654">(</span><span class="op" id="2414655">)</span>&nbsp;<span class="op" id="2414657">(</span><span class="ident" id="2414658">wid</span>&nbsp;<span class="builtintype" id="2414662">int</span><span class="op" id="2414665">,</span>&nbsp;<span class="ident" id="2414667">ok</span>&nbsp;<span class="builtintype" id="2414670">bool</span><span class="op" id="2414674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414677">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414752">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2414818">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2414880">Read</span><span class="op" id="2414884">(</span><span class="ident" id="2414885">buf</span>&nbsp;<span class="op" id="2414889">[</span><span class="op" id="2414890">]</span><span class="builtintype" id="2414891">byte</span><span class="op" id="2414895">)</span>&nbsp;<span class="op" id="2414897">(</span><span class="ident" id="2414898">n</span>&nbsp;<span class="builtintype" id="2414900">int</span><span class="op" id="2414903">,</span>&nbsp;<span class="ident" id="2414905">err</span>&nbsp;<span class="builtintype" id="2414909">error</span><span class="op" id="2414914">)</span><br>
<span class="lineno"></span><span class="op" id="2414916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2414919">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2414994">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2415070">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2415148">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2415214">type</span>&nbsp;<span class="ident" id="2415219">Scanner</span>&nbsp;<span class="keyword" id="2415227">interface</span>&nbsp;<span class="op" id="2415237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2415240">Scan</span><span class="op" id="2415244">(</span><span class="ident" id="2415245">state</span>&nbsp;<span class="ident" id="2415251">ScanState</span><span class="op" id="2415260">,</span>&nbsp;<span class="ident" id="2415262">verb</span>&nbsp;<span class="builtintype" id="2415267">rune</span><span class="op" id="2415271">)</span>&nbsp;<span class="builtintype" id="2415273">error</span><br>
<span class="lineno">65</span><span class="op" id="2415279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2415282">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2415346">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2415415">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2415482">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2415552">func</span>&nbsp;<span class="ident" id="2415557">Scan</span><span class="op" id="2415561">(</span><span class="ident" id="2415562">a</span>&nbsp;<span class="op" id="2415564">...</span><span class="keyword" id="2415567">interface</span><span class="op" id="2415576">{</span><span class="op" id="2415577">}</span><span class="op" id="2415578">)</span>&nbsp;<span class="op" id="2415580">(</span><span class="ident" id="2415581">n</span>&nbsp;<span class="builtintype" id="2415583">int</span><span class="op" id="2415586">,</span>&nbsp;<span class="ident" id="2415588">err</span>&nbsp;<span class="builtintype" id="2415592">error</span><span class="op" id="2415597">)</span>&nbsp;<span class="op" id="2415599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415602">return</span>&nbsp;<span class="ident" id="2415609">Fscan</span><span class="op" id="2415614">(</span><span class="ident" id="2415615">os</span><span class="op" id="2415617">.</span><span class="ident" id="2415618">Stdin</span><span class="op" id="2415623">,</span>&nbsp;<span class="ident" id="2415625">a</span><span class="op" id="2415626">...</span><span class="op" id="2415629">)</span><br>
<span class="lineno"></span><span class="op" id="2415631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2415634">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2415700">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2415756">func</span>&nbsp;<span class="ident" id="2415761">Scanln</span><span class="op" id="2415767">(</span><span class="ident" id="2415768">a</span>&nbsp;<span class="op" id="2415770">...</span><span class="keyword" id="2415773">interface</span><span class="op" id="2415782">{</span><span class="op" id="2415783">}</span><span class="op" id="2415784">)</span>&nbsp;<span class="op" id="2415786">(</span><span class="ident" id="2415787">n</span>&nbsp;<span class="builtintype" id="2415789">int</span><span class="op" id="2415792">,</span>&nbsp;<span class="ident" id="2415794">err</span>&nbsp;<span class="builtintype" id="2415798">error</span><span class="op" id="2415803">)</span>&nbsp;<span class="op" id="2415805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2415808">return</span>&nbsp;<span class="ident" id="2415815">Fscanln</span><span class="op" id="2415822">(</span><span class="ident" id="2415823">os</span><span class="op" id="2415825">.</span><span class="ident" id="2415826">Stdin</span><span class="op" id="2415831">,</span>&nbsp;<span class="ident" id="2415833">a</span><span class="op" id="2415834">...</span><span class="op" id="2415837">)</span><br>
<span class="lineno"></span><span class="op" id="2415839">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2415842">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2415907">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2415976">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2416045">func</span>&nbsp;<span class="ident" id="2416050">Scanf</span><span class="op" id="2416055">(</span><span class="ident" id="2416056">format</span>&nbsp;<span class="builtintype" id="2416063">string</span><span class="op" id="2416069">,</span>&nbsp;<span class="ident" id="2416071">a</span>&nbsp;<span class="op" id="2416073">...</span><span class="keyword" id="2416076">interface</span><span class="op" id="2416085">{</span><span class="op" id="2416086">}</span><span class="op" id="2416087">)</span>&nbsp;<span class="op" id="2416089">(</span><span class="ident" id="2416090">n</span>&nbsp;<span class="builtintype" id="2416092">int</span><span class="op" id="2416095">,</span>&nbsp;<span class="ident" id="2416097">err</span>&nbsp;<span class="builtintype" id="2416101">error</span><span class="op" id="2416106">)</span>&nbsp;<span class="op" id="2416108">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416111">return</span>&nbsp;<span class="ident" id="2416118">Fscanf</span><span class="op" id="2416124">(</span><span class="ident" id="2416125">os</span><span class="op" id="2416127">.</span><span class="ident" id="2416128">Stdin</span><span class="op" id="2416133">,</span>&nbsp;<span class="ident" id="2416135">format</span><span class="op" id="2416141">,</span>&nbsp;<span class="ident" id="2416143">a</span><span class="op" id="2416144">...</span><span class="op" id="2416147">)</span><br>
<span class="lineno"></span><span class="op" id="2416149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2416152">type</span>&nbsp;<span class="ident" id="2416157">stringReader</span>&nbsp;<span class="builtintype" id="2416170">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2416178">func</span>&nbsp;<span class="op" id="2416183">(</span><span class="ident" id="2416184">r</span>&nbsp;<span class="op" id="2416186">*</span><span class="ident" id="2416187">stringReader</span><span class="op" id="2416199">)</span>&nbsp;<span class="ident" id="2416201">Read</span><span class="op" id="2416205">(</span><span class="ident" id="2416206">b</span>&nbsp;<span class="op" id="2416208">[</span><span class="op" id="2416209">]</span><span class="builtintype" id="2416210">byte</span><span class="op" id="2416214">)</span>&nbsp;<span class="op" id="2416216">(</span><span class="ident" id="2416217">n</span>&nbsp;<span class="builtintype" id="2416219">int</span><span class="op" id="2416222">,</span>&nbsp;<span class="ident" id="2416224">err</span>&nbsp;<span class="builtintype" id="2416228">error</span><span class="op" id="2416233">)</span>&nbsp;<span class="op" id="2416235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416238">n</span>&nbsp;<span class="op" id="2416240">=</span>&nbsp;<span class="builtinfunc" id="2416242">copy</span><span class="op" id="2416246">(</span><span class="ident" id="2416247">b</span><span class="op" id="2416248">,</span>&nbsp;<span class="op" id="2416250">*</span><span class="ident" id="2416251">r</span><span class="op" id="2416252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2416255">*</span><span class="ident" id="2416256">r</span>&nbsp;<span class="op" id="2416258">=</span>&nbsp;<span class="op" id="2416260">(</span><span class="op" id="2416261">*</span><span class="ident" id="2416262">r</span><span class="op" id="2416263">)</span><span class="op" id="2416264">[</span><span class="ident" id="2416265">n</span><span class="op" id="2416266">:</span><span class="op" id="2416267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416270">if</span>&nbsp;<span class="ident" id="2416273">n</span>&nbsp;<span class="op" id="2416275">==</span>&nbsp;<span class="num" id="2416278">0</span>&nbsp;<span class="op" id="2416280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2416284">err</span>&nbsp;<span class="op" id="2416288">=</span>&nbsp;<span class="ident" id="2416290">io</span><span class="op" id="2416292">.</span><span class="ident" id="2416293">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2416298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416301">return</span><br>
<span class="lineno"></span><span class="op" id="2416308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416311">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2416382">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2416449">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2416519">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2416573">func</span>&nbsp;<span class="ident" id="2416578">Sscan</span><span class="op" id="2416583">(</span><span class="ident" id="2416584">str</span>&nbsp;<span class="builtintype" id="2416588">string</span><span class="op" id="2416594">,</span>&nbsp;<span class="ident" id="2416596">a</span>&nbsp;<span class="op" id="2416598">...</span><span class="keyword" id="2416601">interface</span><span class="op" id="2416610">{</span><span class="op" id="2416611">}</span><span class="op" id="2416612">)</span>&nbsp;<span class="op" id="2416614">(</span><span class="ident" id="2416615">n</span>&nbsp;<span class="builtintype" id="2416617">int</span><span class="op" id="2416620">,</span>&nbsp;<span class="ident" id="2416622">err</span>&nbsp;<span class="builtintype" id="2416626">error</span><span class="op" id="2416631">)</span>&nbsp;<span class="op" id="2416633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416636">return</span>&nbsp;<span class="ident" id="2416643">Fscan</span><span class="op" id="2416648">(</span><span class="op" id="2416649">(</span><span class="op" id="2416650">*</span><span class="ident" id="2416651">stringReader</span><span class="op" id="2416663">)</span><span class="op" id="2416664">(</span><span class="op" id="2416665">&amp;</span><span class="ident" id="2416666">str</span><span class="op" id="2416669">)</span><span class="op" id="2416670">,</span>&nbsp;<span class="ident" id="2416672">a</span><span class="op" id="2416673">...</span><span class="op" id="2416676">)</span><br>
<span class="lineno">105</span><span class="op" id="2416678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416681">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2416749">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2416805">func</span>&nbsp;<span class="ident" id="2416810">Sscanln</span><span class="op" id="2416817">(</span><span class="ident" id="2416818">str</span>&nbsp;<span class="builtintype" id="2416822">string</span><span class="op" id="2416828">,</span>&nbsp;<span class="ident" id="2416830">a</span>&nbsp;<span class="op" id="2416832">...</span><span class="keyword" id="2416835">interface</span><span class="op" id="2416844">{</span><span class="op" id="2416845">}</span><span class="op" id="2416846">)</span>&nbsp;<span class="op" id="2416848">(</span><span class="ident" id="2416849">n</span>&nbsp;<span class="builtintype" id="2416851">int</span><span class="op" id="2416854">,</span>&nbsp;<span class="ident" id="2416856">err</span>&nbsp;<span class="builtintype" id="2416860">error</span><span class="op" id="2416865">)</span>&nbsp;<span class="op" id="2416867">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2416870">return</span>&nbsp;<span class="ident" id="2416877">Fscanln</span><span class="op" id="2416884">(</span><span class="op" id="2416885">(</span><span class="op" id="2416886">*</span><span class="ident" id="2416887">stringReader</span><span class="op" id="2416899">)</span><span class="op" id="2416900">(</span><span class="op" id="2416901">&amp;</span><span class="ident" id="2416902">str</span><span class="op" id="2416905">)</span><span class="op" id="2416906">,</span>&nbsp;<span class="ident" id="2416908">a</span><span class="op" id="2416909">...</span><span class="op" id="2416912">)</span><br>
<span class="lineno"></span><span class="op" id="2416914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2416917">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2416989">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2417058">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2417110">func</span>&nbsp;<span class="ident" id="2417115">Sscanf</span><span class="op" id="2417121">(</span><span class="ident" id="2417122">str</span>&nbsp;<span class="builtintype" id="2417126">string</span><span class="op" id="2417132">,</span>&nbsp;<span class="ident" id="2417134">format</span>&nbsp;<span class="builtintype" id="2417141">string</span><span class="op" id="2417147">,</span>&nbsp;<span class="ident" id="2417149">a</span>&nbsp;<span class="op" id="2417151">...</span><span class="keyword" id="2417154">interface</span><span class="op" id="2417163">{</span><span class="op" id="2417164">}</span><span class="op" id="2417165">)</span>&nbsp;<span class="op" id="2417167">(</span><span class="ident" id="2417168">n</span>&nbsp;<span class="builtintype" id="2417170">int</span><span class="op" id="2417173">,</span>&nbsp;<span class="ident" id="2417175">err</span>&nbsp;<span class="builtintype" id="2417179">error</span><span class="op" id="2417184">)</span>&nbsp;<span class="op" id="2417186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417189">return</span>&nbsp;<span class="ident" id="2417196">Fscanf</span><span class="op" id="2417202">(</span><span class="op" id="2417203">(</span><span class="op" id="2417204">*</span><span class="ident" id="2417205">stringReader</span><span class="op" id="2417217">)</span><span class="op" id="2417218">(</span><span class="op" id="2417219">&amp;</span><span class="ident" id="2417220">str</span><span class="op" id="2417223">)</span><span class="op" id="2417224">,</span>&nbsp;<span class="ident" id="2417226">format</span><span class="op" id="2417232">,</span>&nbsp;<span class="ident" id="2417234">a</span><span class="op" id="2417235">...</span><span class="op" id="2417238">)</span><br>
<span class="lineno"></span><span class="op" id="2417240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2417243">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2417311">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2417378">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2417448">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2417502">func</span>&nbsp;<span class="ident" id="2417507">Fscan</span><span class="op" id="2417512">(</span><span class="ident" id="2417513">r</span>&nbsp;<span class="ident" id="2417515">io</span><span class="op" id="2417517">.</span><span class="ident" id="2417518">Reader</span><span class="op" id="2417524">,</span>&nbsp;<span class="ident" id="2417526">a</span>&nbsp;<span class="op" id="2417528">...</span><span class="keyword" id="2417531">interface</span><span class="op" id="2417540">{</span><span class="op" id="2417541">}</span><span class="op" id="2417542">)</span>&nbsp;<span class="op" id="2417544">(</span><span class="ident" id="2417545">n</span>&nbsp;<span class="builtintype" id="2417547">int</span><span class="op" id="2417550">,</span>&nbsp;<span class="ident" id="2417552">err</span>&nbsp;<span class="builtintype" id="2417556">error</span><span class="op" id="2417561">)</span>&nbsp;<span class="op" id="2417563">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417566">s</span><span class="op" id="2417567">,</span>&nbsp;<span class="ident" id="2417569">old</span>&nbsp;<span class="op" id="2417573">:=</span>&nbsp;<span class="ident" id="2417576">newScanState</span><span class="op" id="2417588">(</span><span class="ident" id="2417589">r</span><span class="op" id="2417590">,</span>&nbsp;<span class="builtintype" id="2417592">true</span><span class="op" id="2417596">,</span>&nbsp;<span class="builtintype" id="2417598">false</span><span class="op" id="2417603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417606">n</span><span class="op" id="2417607">,</span>&nbsp;<span class="ident" id="2417609">err</span>&nbsp;<span class="op" id="2417613">=</span>&nbsp;<span class="ident" id="2417615">s</span><span class="op" id="2417616">.</span><span class="ident" id="2417617">doScan</span><span class="op" id="2417623">(</span><span class="ident" id="2417624">a</span><span class="op" id="2417625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417628">s</span><span class="op" id="2417629">.</span><span class="ident" id="2417630">free</span><span class="op" id="2417634">(</span><span class="ident" id="2417635">old</span><span class="op" id="2417638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417641">return</span><br>
<span class="lineno"></span><span class="op" id="2417648">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2417651">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2417719">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2417775">func</span>&nbsp;<span class="ident" id="2417780">Fscanln</span><span class="op" id="2417787">(</span><span class="ident" id="2417788">r</span>&nbsp;<span class="ident" id="2417790">io</span><span class="op" id="2417792">.</span><span class="ident" id="2417793">Reader</span><span class="op" id="2417799">,</span>&nbsp;<span class="ident" id="2417801">a</span>&nbsp;<span class="op" id="2417803">...</span><span class="keyword" id="2417806">interface</span><span class="op" id="2417815">{</span><span class="op" id="2417816">}</span><span class="op" id="2417817">)</span>&nbsp;<span class="op" id="2417819">(</span><span class="ident" id="2417820">n</span>&nbsp;<span class="builtintype" id="2417822">int</span><span class="op" id="2417825">,</span>&nbsp;<span class="ident" id="2417827">err</span>&nbsp;<span class="builtintype" id="2417831">error</span><span class="op" id="2417836">)</span>&nbsp;<span class="op" id="2417838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417841">s</span><span class="op" id="2417842">,</span>&nbsp;<span class="ident" id="2417844">old</span>&nbsp;<span class="op" id="2417848">:=</span>&nbsp;<span class="ident" id="2417851">newScanState</span><span class="op" id="2417863">(</span><span class="ident" id="2417864">r</span><span class="op" id="2417865">,</span>&nbsp;<span class="builtintype" id="2417867">false</span><span class="op" id="2417872">,</span>&nbsp;<span class="builtintype" id="2417874">true</span><span class="op" id="2417878">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417881">n</span><span class="op" id="2417882">,</span>&nbsp;<span class="ident" id="2417884">err</span>&nbsp;<span class="op" id="2417888">=</span>&nbsp;<span class="ident" id="2417890">s</span><span class="op" id="2417891">.</span><span class="ident" id="2417892">doScan</span><span class="op" id="2417898">(</span><span class="ident" id="2417899">a</span><span class="op" id="2417900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2417903">s</span><span class="op" id="2417904">.</span><span class="ident" id="2417905">free</span><span class="op" id="2417909">(</span><span class="ident" id="2417910">old</span><span class="op" id="2417913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2417916">return</span><br>
<span class="lineno"></span><span class="op" id="2417923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2417926">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2417995">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2418064">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2418116">func</span>&nbsp;<span class="ident" id="2418121">Fscanf</span><span class="op" id="2418127">(</span><span class="ident" id="2418128">r</span>&nbsp;<span class="ident" id="2418130">io</span><span class="op" id="2418132">.</span><span class="ident" id="2418133">Reader</span><span class="op" id="2418139">,</span>&nbsp;<span class="ident" id="2418141">format</span>&nbsp;<span class="builtintype" id="2418148">string</span><span class="op" id="2418154">,</span>&nbsp;<span class="ident" id="2418156">a</span>&nbsp;<span class="op" id="2418158">...</span><span class="keyword" id="2418161">interface</span><span class="op" id="2418170">{</span><span class="op" id="2418171">}</span><span class="op" id="2418172">)</span>&nbsp;<span class="op" id="2418174">(</span><span class="ident" id="2418175">n</span>&nbsp;<span class="builtintype" id="2418177">int</span><span class="op" id="2418180">,</span>&nbsp;<span class="ident" id="2418182">err</span>&nbsp;<span class="builtintype" id="2418186">error</span><span class="op" id="2418191">)</span>&nbsp;<span class="op" id="2418193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418196">s</span><span class="op" id="2418197">,</span>&nbsp;<span class="ident" id="2418199">old</span>&nbsp;<span class="op" id="2418203">:=</span>&nbsp;<span class="ident" id="2418206">newScanState</span><span class="op" id="2418218">(</span><span class="ident" id="2418219">r</span><span class="op" id="2418220">,</span>&nbsp;<span class="builtintype" id="2418222">false</span><span class="op" id="2418227">,</span>&nbsp;<span class="builtintype" id="2418229">false</span><span class="op" id="2418234">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418237">n</span><span class="op" id="2418238">,</span>&nbsp;<span class="ident" id="2418240">err</span>&nbsp;<span class="op" id="2418244">=</span>&nbsp;<span class="ident" id="2418246">s</span><span class="op" id="2418247">.</span><span class="ident" id="2418248">doScanf</span><span class="op" id="2418255">(</span><span class="ident" id="2418256">format</span><span class="op" id="2418262">,</span>&nbsp;<span class="ident" id="2418264">a</span><span class="op" id="2418265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418268">s</span><span class="op" id="2418269">.</span><span class="ident" id="2418270">free</span><span class="op" id="2418274">(</span><span class="ident" id="2418275">old</span><span class="op" id="2418278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2418281">return</span><br>
<span class="lineno"></span><span class="op" id="2418288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2418291">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2418360">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2418436">type</span>&nbsp;<span class="ident" id="2418441">scanError</span>&nbsp;<span class="keyword" id="2418451">struct</span>&nbsp;<span class="op" id="2418458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418461">err</span>&nbsp;<span class="builtintype" id="2418465">error</span><br>
<span class="lineno"></span><span class="op" id="2418471">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2418474">const</span>&nbsp;<span class="ident" id="2418480">eof</span>&nbsp;<span class="op" id="2418484">=</span>&nbsp;<span class="op" id="2418486">-</span><span class="num" id="2418487">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2418490">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2418541">type</span>&nbsp;<span class="ident" id="2418546">ss</span>&nbsp;<span class="keyword" id="2418549">struct</span>&nbsp;<span class="op" id="2418556">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418559">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418568">io</span><span class="op" id="2418570">.</span><span class="ident" id="2418571">RuneReader</span>&nbsp;<span class="comment" id="2418582">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418606">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2418615">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418629">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418651">peekRune</span>&nbsp;<span class="builtintype" id="2418660">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418674">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418697">prevRune</span>&nbsp;<span class="builtintype" id="2418706">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418720">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418755">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2418764">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418778">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418805">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2418814">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2418828">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418849">ssave</span><br>
<span class="lineno"></span><span class="op" id="2418855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2418858">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2418905">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2418947">type</span>&nbsp;<span class="ident" id="2418952">ssave</span>&nbsp;<span class="keyword" id="2418958">struct</span>&nbsp;<span class="op" id="2418965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2418968">validSave</span>&nbsp;<span class="builtintype" id="2418978">bool</span>&nbsp;<span class="comment" id="2418983">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419021">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2419031">bool</span>&nbsp;<span class="comment" id="2419036">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419072">nlIsSpace</span>&nbsp;<span class="builtintype" id="2419082">bool</span>&nbsp;<span class="comment" id="2419087">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419129">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2419139">int</span>&nbsp;&nbsp;<span class="comment" id="2419144">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419202">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2419212">int</span>&nbsp;&nbsp;<span class="comment" id="2419217">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419244">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2419254">int</span>&nbsp;&nbsp;<span class="comment" id="2419259">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2419281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2419284">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2419342">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2419403">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2419462">func</span>&nbsp;<span class="op" id="2419467">(</span><span class="ident" id="2419468">s</span>&nbsp;<span class="op" id="2419470">*</span><span class="ident" id="2419471">ss</span><span class="op" id="2419473">)</span>&nbsp;<span class="ident" id="2419475">Read</span><span class="op" id="2419479">(</span><span class="ident" id="2419480">buf</span>&nbsp;<span class="op" id="2419484">[</span><span class="op" id="2419485">]</span><span class="builtintype" id="2419486">byte</span><span class="op" id="2419490">)</span>&nbsp;<span class="op" id="2419492">(</span><span class="ident" id="2419493">n</span>&nbsp;<span class="builtintype" id="2419495">int</span><span class="op" id="2419498">,</span>&nbsp;<span class="ident" id="2419500">err</span>&nbsp;<span class="builtintype" id="2419504">error</span><span class="op" id="2419509">)</span>&nbsp;<span class="op" id="2419511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419514">return</span>&nbsp;<span class="num" id="2419521">0</span><span class="op" id="2419522">,</span>&nbsp;<span class="ident" id="2419524">errors</span><span class="op" id="2419530">.</span><span class="ident" id="2419531">New</span><span class="op" id="2419534">(</span><span class="string" id="2419535">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2419588">)</span><br>
<span class="lineno">185</span><span class="op" id="2419590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2419593">func</span>&nbsp;<span class="op" id="2419598">(</span><span class="ident" id="2419599">s</span>&nbsp;<span class="op" id="2419601">*</span><span class="ident" id="2419602">ss</span><span class="op" id="2419604">)</span>&nbsp;<span class="ident" id="2419606">ReadRune</span><span class="op" id="2419614">(</span><span class="op" id="2419615">)</span>&nbsp;<span class="op" id="2419617">(</span><span class="ident" id="2419618">r</span>&nbsp;<span class="builtintype" id="2419620">rune</span><span class="op" id="2419624">,</span>&nbsp;<span class="ident" id="2419626">size</span>&nbsp;<span class="builtintype" id="2419631">int</span><span class="op" id="2419634">,</span>&nbsp;<span class="ident" id="2419636">err</span>&nbsp;<span class="builtintype" id="2419640">error</span><span class="op" id="2419645">)</span>&nbsp;<span class="op" id="2419647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419650">if</span>&nbsp;<span class="ident" id="2419653">s</span><span class="op" id="2419654">.</span><span class="ident" id="2419655">peekRune</span>&nbsp;<span class="op" id="2419664">&gt;=</span>&nbsp;<span class="num" id="2419667">0</span>&nbsp;<span class="op" id="2419669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419673">s</span><span class="op" id="2419674">.</span><span class="ident" id="2419675">count</span><span class="op" id="2419680">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419685">r</span>&nbsp;<span class="op" id="2419687">=</span>&nbsp;<span class="ident" id="2419689">s</span><span class="op" id="2419690">.</span><span class="ident" id="2419691">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419702">size</span>&nbsp;<span class="op" id="2419707">=</span>&nbsp;<span class="ident" id="2419709">utf8</span><span class="op" id="2419713">.</span><span class="ident" id="2419714">RuneLen</span><span class="op" id="2419721">(</span><span class="ident" id="2419722">r</span><span class="op" id="2419723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419727">s</span><span class="op" id="2419728">.</span><span class="ident" id="2419729">prevRune</span>&nbsp;<span class="op" id="2419738">=</span>&nbsp;<span class="ident" id="2419740">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419744">s</span><span class="op" id="2419745">.</span><span class="ident" id="2419746">peekRune</span>&nbsp;<span class="op" id="2419755">=</span>&nbsp;<span class="op" id="2419757">-</span><span class="num" id="2419758">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419762">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2419770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419773">if</span>&nbsp;<span class="ident" id="2419776">s</span><span class="op" id="2419777">.</span><span class="ident" id="2419778">atEOF</span>&nbsp;<span class="op" id="2419784">||</span>&nbsp;<span class="ident" id="2419787">s</span><span class="op" id="2419788">.</span><span class="ident" id="2419789">nlIsEnd</span>&nbsp;<span class="op" id="2419797">&amp;&amp;</span>&nbsp;<span class="ident" id="2419800">s</span><span class="op" id="2419801">.</span><span class="ident" id="2419802">prevRune</span>&nbsp;<span class="op" id="2419811">==</span>&nbsp;<span class="string" id="2419814">&#39;\n&#39;</span>&nbsp;<span class="op" id="2419819">||</span>&nbsp;<span class="ident" id="2419822">s</span><span class="op" id="2419823">.</span><span class="ident" id="2419824">count</span>&nbsp;<span class="op" id="2419830">&gt;=</span>&nbsp;<span class="ident" id="2419833">s</span><span class="op" id="2419834">.</span><span class="ident" id="2419835">argLimit</span>&nbsp;<span class="op" id="2419844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419848">err</span>&nbsp;<span class="op" id="2419852">=</span>&nbsp;<span class="ident" id="2419854">io</span><span class="op" id="2419856">.</span><span class="ident" id="2419857">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2419871">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419875">r</span><span class="op" id="2419876">,</span>&nbsp;<span class="ident" id="2419878">size</span><span class="op" id="2419882">,</span>&nbsp;<span class="ident" id="2419884">err</span>&nbsp;<span class="op" id="2419888">=</span>&nbsp;<span class="ident" id="2419890">s</span><span class="op" id="2419891">.</span><span class="ident" id="2419892">rr</span><span class="op" id="2419894">.</span><span class="ident" id="2419895">ReadRune</span><span class="op" id="2419903">(</span><span class="op" id="2419904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2419907">if</span>&nbsp;<span class="ident" id="2419910">err</span>&nbsp;<span class="op" id="2419914">==</span>&nbsp;<span class="ident" id="2419917">nil</span>&nbsp;<span class="op" id="2419921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419925">s</span><span class="op" id="2419926">.</span><span class="ident" id="2419927">count</span><span class="op" id="2419932">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419937">s</span><span class="op" id="2419938">.</span><span class="ident" id="2419939">prevRune</span>&nbsp;<span class="op" id="2419948">=</span>&nbsp;<span class="ident" id="2419950">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2419953">}</span>&nbsp;<span class="keyword" id="2419955">else</span>&nbsp;<span class="keyword" id="2419960">if</span>&nbsp;<span class="ident" id="2419963">err</span>&nbsp;<span class="op" id="2419967">==</span>&nbsp;<span class="ident" id="2419970">io</span><span class="op" id="2419972">.</span><span class="ident" id="2419973">EOF</span>&nbsp;<span class="op" id="2419977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2419981">s</span><span class="op" id="2419982">.</span><span class="ident" id="2419983">atEOF</span>&nbsp;<span class="op" id="2419989">=</span>&nbsp;<span class="builtintype" id="2419991">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2419997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420000">return</span><br>
<span class="lineno"></span><span class="op" id="2420007">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2420010">func</span>&nbsp;<span class="op" id="2420015">(</span><span class="ident" id="2420016">s</span>&nbsp;<span class="op" id="2420018">*</span><span class="ident" id="2420019">ss</span><span class="op" id="2420021">)</span>&nbsp;<span class="ident" id="2420023">Width</span><span class="op" id="2420028">(</span><span class="op" id="2420029">)</span>&nbsp;<span class="op" id="2420031">(</span><span class="ident" id="2420032">wid</span>&nbsp;<span class="builtintype" id="2420036">int</span><span class="op" id="2420039">,</span>&nbsp;<span class="ident" id="2420041">ok</span>&nbsp;<span class="builtintype" id="2420044">bool</span><span class="op" id="2420048">)</span>&nbsp;<span class="op" id="2420050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420053">if</span>&nbsp;<span class="ident" id="2420056">s</span><span class="op" id="2420057">.</span><span class="ident" id="2420058">maxWid</span>&nbsp;<span class="op" id="2420065">==</span>&nbsp;<span class="ident" id="2420068">hugeWid</span>&nbsp;<span class="op" id="2420076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420080">return</span>&nbsp;<span class="num" id="2420087">0</span><span class="op" id="2420088">,</span>&nbsp;<span class="builtintype" id="2420090">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420097">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420100">return</span>&nbsp;<span class="ident" id="2420107">s</span><span class="op" id="2420108">.</span><span class="ident" id="2420109">maxWid</span><span class="op" id="2420115">,</span>&nbsp;<span class="builtintype" id="2420117">true</span><br>
<span class="lineno"></span><span class="op" id="2420122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2420125">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2420189">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2420246">func</span>&nbsp;<span class="op" id="2420251">(</span><span class="ident" id="2420252">s</span>&nbsp;<span class="op" id="2420254">*</span><span class="ident" id="2420255">ss</span><span class="op" id="2420257">)</span>&nbsp;<span class="ident" id="2420259">getRune</span><span class="op" id="2420266">(</span><span class="op" id="2420267">)</span>&nbsp;<span class="op" id="2420269">(</span><span class="ident" id="2420270">r</span>&nbsp;<span class="builtintype" id="2420272">rune</span><span class="op" id="2420276">)</span>&nbsp;<span class="op" id="2420278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420281">r</span><span class="op" id="2420282">,</span>&nbsp;<span class="ident" id="2420284">_</span><span class="op" id="2420285">,</span>&nbsp;<span class="ident" id="2420287">err</span>&nbsp;<span class="op" id="2420291">:=</span>&nbsp;<span class="ident" id="2420294">s</span><span class="op" id="2420295">.</span><span class="ident" id="2420296">ReadRune</span><span class="op" id="2420304">(</span><span class="op" id="2420305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420308">if</span>&nbsp;<span class="ident" id="2420311">err</span>&nbsp;<span class="op" id="2420315">!=</span>&nbsp;<span class="ident" id="2420318">nil</span>&nbsp;<span class="op" id="2420322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420326">if</span>&nbsp;<span class="ident" id="2420329">err</span>&nbsp;<span class="op" id="2420333">==</span>&nbsp;<span class="ident" id="2420336">io</span><span class="op" id="2420338">.</span><span class="ident" id="2420339">EOF</span>&nbsp;<span class="op" id="2420343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420348">return</span>&nbsp;<span class="ident" id="2420355">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420365">s</span><span class="op" id="2420366">.</span><span class="builtintype" id="2420367">error</span><span class="op" id="2420372">(</span><span class="ident" id="2420373">err</span><span class="op" id="2420376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420382">return</span><br>
<span class="lineno"></span><span class="op" id="2420389">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2420392">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2420456">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2420523">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2420540">func</span>&nbsp;<span class="op" id="2420545">(</span><span class="ident" id="2420546">s</span>&nbsp;<span class="op" id="2420548">*</span><span class="ident" id="2420549">ss</span><span class="op" id="2420551">)</span>&nbsp;<span class="ident" id="2420553">mustReadRune</span><span class="op" id="2420565">(</span><span class="op" id="2420566">)</span>&nbsp;<span class="op" id="2420568">(</span><span class="ident" id="2420569">r</span>&nbsp;<span class="builtintype" id="2420571">rune</span><span class="op" id="2420575">)</span>&nbsp;<span class="op" id="2420577">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420580">r</span>&nbsp;<span class="op" id="2420582">=</span>&nbsp;<span class="ident" id="2420584">s</span><span class="op" id="2420585">.</span><span class="ident" id="2420586">getRune</span><span class="op" id="2420593">(</span><span class="op" id="2420594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420597">if</span>&nbsp;<span class="ident" id="2420600">r</span>&nbsp;<span class="op" id="2420602">==</span>&nbsp;<span class="ident" id="2420605">eof</span>&nbsp;<span class="op" id="2420609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420613">s</span><span class="op" id="2420614">.</span><span class="builtintype" id="2420615">error</span><span class="op" id="2420620">(</span><span class="ident" id="2420621">io</span><span class="op" id="2420623">.</span><span class="ident" id="2420624">ErrUnexpectedEOF</span><span class="op" id="2420640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420646">return</span><br>
<span class="lineno">240</span><span class="op" id="2420653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420656">func</span>&nbsp;<span class="op" id="2420661">(</span><span class="ident" id="2420662">s</span>&nbsp;<span class="op" id="2420664">*</span><span class="ident" id="2420665">ss</span><span class="op" id="2420667">)</span>&nbsp;<span class="ident" id="2420669">UnreadRune</span><span class="op" id="2420679">(</span><span class="op" id="2420680">)</span>&nbsp;<span class="builtintype" id="2420682">error</span>&nbsp;<span class="op" id="2420688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420691">if</span>&nbsp;<span class="ident" id="2420694">u</span><span class="op" id="2420695">,</span>&nbsp;<span class="ident" id="2420697">ok</span>&nbsp;<span class="op" id="2420700">:=</span>&nbsp;<span class="ident" id="2420703">s</span><span class="op" id="2420704">.</span><span class="ident" id="2420705">rr</span><span class="op" id="2420707">.</span><span class="op" id="2420708">(</span><span class="ident" id="2420709">runeUnreader</span><span class="op" id="2420721">)</span><span class="op" id="2420722">;</span>&nbsp;<span class="ident" id="2420724">ok</span>&nbsp;<span class="op" id="2420727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420731">u</span><span class="op" id="2420732">.</span><span class="ident" id="2420733">UnreadRune</span><span class="op" id="2420743">(</span><span class="op" id="2420744">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420747">}</span>&nbsp;<span class="keyword" id="2420749">else</span>&nbsp;<span class="op" id="2420754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420758">s</span><span class="op" id="2420759">.</span><span class="ident" id="2420760">peekRune</span>&nbsp;<span class="op" id="2420769">=</span>&nbsp;<span class="ident" id="2420771">s</span><span class="op" id="2420772">.</span><span class="ident" id="2420773">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2420783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420786">s</span><span class="op" id="2420787">.</span><span class="ident" id="2420788">prevRune</span>&nbsp;<span class="op" id="2420797">=</span>&nbsp;<span class="op" id="2420799">-</span><span class="num" id="2420800">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2420803">s</span><span class="op" id="2420804">.</span><span class="ident" id="2420805">count</span><span class="op" id="2420810">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2420814">return</span>&nbsp;<span class="ident" id="2420821">nil</span><br>
<span class="lineno"></span><span class="op" id="2420825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420828">func</span>&nbsp;<span class="op" id="2420833">(</span><span class="ident" id="2420834">s</span>&nbsp;<span class="op" id="2420836">*</span><span class="ident" id="2420837">ss</span><span class="op" id="2420839">)</span>&nbsp;<span class="builtintype" id="2420841">error</span><span class="op" id="2420846">(</span><span class="ident" id="2420847">err</span>&nbsp;<span class="builtintype" id="2420851">error</span><span class="op" id="2420856">)</span>&nbsp;<span class="op" id="2420858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2420861">panic</span><span class="op" id="2420866">(</span><span class="ident" id="2420867">scanError</span><span class="op" id="2420876">{</span><span class="ident" id="2420877">err</span><span class="op" id="2420880">}</span><span class="op" id="2420881">)</span><br>
<span class="lineno">255</span><span class="op" id="2420883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2420886">func</span>&nbsp;<span class="op" id="2420891">(</span><span class="ident" id="2420892">s</span>&nbsp;<span class="op" id="2420894">*</span><span class="ident" id="2420895">ss</span><span class="op" id="2420897">)</span>&nbsp;<span class="ident" id="2420899">errorString</span><span class="op" id="2420910">(</span><span class="ident" id="2420911">err</span>&nbsp;<span class="builtintype" id="2420915">string</span><span class="op" id="2420921">)</span>&nbsp;<span class="op" id="2420923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2420926">panic</span><span class="op" id="2420931">(</span><span class="ident" id="2420932">scanError</span><span class="op" id="2420941">{</span><span class="ident" id="2420942">errors</span><span class="op" id="2420948">.</span><span class="ident" id="2420949">New</span><span class="op" id="2420952">(</span><span class="ident" id="2420953">err</span><span class="op" id="2420956">)</span><span class="op" id="2420957">}</span><span class="op" id="2420958">)</span><br>
<span class="lineno"></span><span class="op" id="2420960">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2420963">func</span>&nbsp;<span class="op" id="2420968">(</span><span class="ident" id="2420969">s</span>&nbsp;<span class="op" id="2420971">*</span><span class="ident" id="2420972">ss</span><span class="op" id="2420974">)</span>&nbsp;<span class="ident" id="2420976">Token</span><span class="op" id="2420981">(</span><span class="ident" id="2420982">skipSpace</span>&nbsp;<span class="builtintype" id="2420992">bool</span><span class="op" id="2420996">,</span>&nbsp;<span class="ident" id="2420998">f</span>&nbsp;<span class="keyword" id="2421000">func</span><span class="op" id="2421004">(</span><span class="builtintype" id="2421005">rune</span><span class="op" id="2421009">)</span>&nbsp;<span class="builtintype" id="2421011">bool</span><span class="op" id="2421015">)</span>&nbsp;<span class="op" id="2421017">(</span><span class="ident" id="2421018">tok</span>&nbsp;<span class="op" id="2421022">[</span><span class="op" id="2421023">]</span><span class="builtintype" id="2421024">byte</span><span class="op" id="2421028">,</span>&nbsp;<span class="ident" id="2421030">err</span>&nbsp;<span class="builtintype" id="2421034">error</span><span class="op" id="2421039">)</span>&nbsp;<span class="op" id="2421041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421044">defer</span>&nbsp;<span class="keyword" id="2421050">func</span><span class="op" id="2421054">(</span><span class="op" id="2421055">)</span>&nbsp;<span class="op" id="2421057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421061">if</span>&nbsp;<span class="ident" id="2421064">e</span>&nbsp;<span class="op" id="2421066">:=</span>&nbsp;<span class="builtinfunc" id="2421069">recover</span><span class="op" id="2421076">(</span><span class="op" id="2421077">)</span><span class="op" id="2421078">;</span>&nbsp;<span class="ident" id="2421080">e</span>&nbsp;<span class="op" id="2421082">!=</span>&nbsp;<span class="ident" id="2421085">nil</span>&nbsp;<span class="op" id="2421089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421094">if</span>&nbsp;<span class="ident" id="2421097">se</span><span class="op" id="2421099">,</span>&nbsp;<span class="ident" id="2421101">ok</span>&nbsp;<span class="op" id="2421104">:=</span>&nbsp;<span class="ident" id="2421107">e</span><span class="op" id="2421108">.</span><span class="op" id="2421109">(</span><span class="ident" id="2421110">scanError</span><span class="op" id="2421119">)</span><span class="op" id="2421120">;</span>&nbsp;<span class="ident" id="2421122">ok</span>&nbsp;<span class="op" id="2421125">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421131">err</span>&nbsp;<span class="op" id="2421135">=</span>&nbsp;<span class="ident" id="2421137">se</span><span class="op" id="2421139">.</span><span class="ident" id="2421140">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421147">}</span>&nbsp;<span class="keyword" id="2421149">else</span>&nbsp;<span class="op" id="2421154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2421160">panic</span><span class="op" id="2421165">(</span><span class="ident" id="2421166">e</span><span class="op" id="2421167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421176">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421179">}</span><span class="op" id="2421180">(</span><span class="op" id="2421181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421184">if</span>&nbsp;<span class="ident" id="2421187">f</span>&nbsp;<span class="op" id="2421189">==</span>&nbsp;<span class="ident" id="2421192">nil</span>&nbsp;<span class="op" id="2421196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421200">f</span>&nbsp;<span class="op" id="2421202">=</span>&nbsp;<span class="ident" id="2421204">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421217">s</span><span class="op" id="2421218">.</span><span class="ident" id="2421219">buf</span>&nbsp;<span class="op" id="2421223">=</span>&nbsp;<span class="ident" id="2421225">s</span><span class="op" id="2421226">.</span><span class="ident" id="2421227">buf</span><span class="op" id="2421230">[</span><span class="op" id="2421231">:</span><span class="num" id="2421232">0</span><span class="op" id="2421233">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421236">tok</span>&nbsp;<span class="op" id="2421240">=</span>&nbsp;<span class="ident" id="2421242">s</span><span class="op" id="2421243">.</span><span class="ident" id="2421244">token</span><span class="op" id="2421249">(</span><span class="ident" id="2421250">skipSpace</span><span class="op" id="2421259">,</span>&nbsp;<span class="ident" id="2421261">f</span><span class="op" id="2421262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421265">return</span><br>
<span class="lineno"></span><span class="op" id="2421272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2421275">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2421329">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2421371">var</span>&nbsp;<span class="ident" id="2421375">space</span>&nbsp;<span class="op" id="2421381">=</span>&nbsp;<span class="op" id="2421383">[</span><span class="op" id="2421384">]</span><span class="op" id="2421385">[</span><span class="num" id="2421386">2</span><span class="op" id="2421387">]</span><span class="builtintype" id="2421388">uint16</span><span class="op" id="2421394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421397">{</span><span class="num" id="2421398">0x0009</span><span class="op" id="2421404">,</span>&nbsp;<span class="num" id="2421406">0x000d</span><span class="op" id="2421412">}</span><span class="op" id="2421413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421416">{</span><span class="num" id="2421417">0x0020</span><span class="op" id="2421423">,</span>&nbsp;<span class="num" id="2421425">0x0020</span><span class="op" id="2421431">}</span><span class="op" id="2421432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421435">{</span><span class="num" id="2421436">0x0085</span><span class="op" id="2421442">,</span>&nbsp;<span class="num" id="2421444">0x0085</span><span class="op" id="2421450">}</span><span class="op" id="2421451">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421454">{</span><span class="num" id="2421455">0x00a0</span><span class="op" id="2421461">,</span>&nbsp;<span class="num" id="2421463">0x00a0</span><span class="op" id="2421469">}</span><span class="op" id="2421470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421473">{</span><span class="num" id="2421474">0x1680</span><span class="op" id="2421480">,</span>&nbsp;<span class="num" id="2421482">0x1680</span><span class="op" id="2421488">}</span><span class="op" id="2421489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421492">{</span><span class="num" id="2421493">0x2000</span><span class="op" id="2421499">,</span>&nbsp;<span class="num" id="2421501">0x200a</span><span class="op" id="2421507">}</span><span class="op" id="2421508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421511">{</span><span class="num" id="2421512">0x2028</span><span class="op" id="2421518">,</span>&nbsp;<span class="num" id="2421520">0x2029</span><span class="op" id="2421526">}</span><span class="op" id="2421527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421530">{</span><span class="num" id="2421531">0x202f</span><span class="op" id="2421537">,</span>&nbsp;<span class="num" id="2421539">0x202f</span><span class="op" id="2421545">}</span><span class="op" id="2421546">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421549">{</span><span class="num" id="2421550">0x205f</span><span class="op" id="2421556">,</span>&nbsp;<span class="num" id="2421558">0x205f</span><span class="op" id="2421564">}</span><span class="op" id="2421565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421568">{</span><span class="num" id="2421569">0x3000</span><span class="op" id="2421575">,</span>&nbsp;<span class="num" id="2421577">0x3000</span><span class="op" id="2421583">}</span><span class="op" id="2421584">,</span><br>
<span class="lineno"></span><span class="op" id="2421586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2421589">func</span>&nbsp;<span class="ident" id="2421594">isSpace</span><span class="op" id="2421601">(</span><span class="ident" id="2421602">r</span>&nbsp;<span class="builtintype" id="2421604">rune</span><span class="op" id="2421608">)</span>&nbsp;<span class="builtintype" id="2421610">bool</span>&nbsp;<span class="op" id="2421615">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421618">if</span>&nbsp;<span class="ident" id="2421621">r</span>&nbsp;<span class="op" id="2421623">&gt;=</span>&nbsp;<span class="num" id="2421626">1</span><span class="op" id="2421627">&lt;&lt;</span><span class="num" id="2421629">16</span>&nbsp;<span class="op" id="2421632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421636">return</span>&nbsp;<span class="builtintype" id="2421643">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2421653">rx</span>&nbsp;<span class="op" id="2421656">:=</span>&nbsp;<span class="builtintype" id="2421659">uint16</span><span class="op" id="2421665">(</span><span class="ident" id="2421666">r</span><span class="op" id="2421667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421670">for</span>&nbsp;<span class="ident" id="2421674">_</span><span class="op" id="2421675">,</span>&nbsp;<span class="ident" id="2421677">rng</span>&nbsp;<span class="op" id="2421681">:=</span>&nbsp;<span class="keyword" id="2421684">range</span>&nbsp;<span class="ident" id="2421690">space</span>&nbsp;<span class="op" id="2421696">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421700">if</span>&nbsp;<span class="ident" id="2421703">rx</span>&nbsp;<span class="op" id="2421706">&lt;</span>&nbsp;<span class="ident" id="2421708">rng</span><span class="op" id="2421711">[</span><span class="num" id="2421712">0</span><span class="op" id="2421713">]</span>&nbsp;<span class="op" id="2421715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421720">return</span>&nbsp;<span class="builtintype" id="2421727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421739">if</span>&nbsp;<span class="ident" id="2421742">rx</span>&nbsp;<span class="op" id="2421745">&lt;=</span>&nbsp;<span class="ident" id="2421748">rng</span><span class="op" id="2421751">[</span><span class="num" id="2421752">1</span><span class="op" id="2421753">]</span>&nbsp;<span class="op" id="2421755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421760">return</span>&nbsp;<span class="builtintype" id="2421767">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2421777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421780">return</span>&nbsp;<span class="builtintype" id="2421787">false</span><br>
<span class="lineno"></span><span class="op" id="2421793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2421796">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2421856">func</span>&nbsp;<span class="ident" id="2421861">notSpace</span><span class="op" id="2421869">(</span><span class="ident" id="2421870">r</span>&nbsp;<span class="builtintype" id="2421872">rune</span><span class="op" id="2421876">)</span>&nbsp;<span class="builtintype" id="2421878">bool</span>&nbsp;<span class="op" id="2421883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2421886">return</span>&nbsp;<span class="op" id="2421893">!</span><span class="ident" id="2421894">isSpace</span><span class="op" id="2421901">(</span><span class="ident" id="2421902">r</span><span class="op" id="2421903">)</span><br>
<span class="lineno"></span><span class="op" id="2421905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2421908">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2421981">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2422059">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2422079">func</span>&nbsp;<span class="op" id="2422084">(</span><span class="ident" id="2422085">s</span>&nbsp;<span class="op" id="2422087">*</span><span class="ident" id="2422088">ss</span><span class="op" id="2422090">)</span>&nbsp;<span class="ident" id="2422092">SkipSpace</span><span class="op" id="2422101">(</span><span class="op" id="2422102">)</span>&nbsp;<span class="op" id="2422104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422107">s</span><span class="op" id="2422108">.</span><span class="ident" id="2422109">skipSpace</span><span class="op" id="2422118">(</span><span class="builtintype" id="2422119">false</span><span class="op" id="2422124">)</span><br>
<span class="lineno">320</span><span class="op" id="2422126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2422129">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2422200">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2422274">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2422314">type</span>&nbsp;<span class="ident" id="2422319">readRune</span>&nbsp;<span class="keyword" id="2422328">struct</span>&nbsp;<span class="op" id="2422335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422338">reader</span>&nbsp;&nbsp;<span class="ident" id="2422346">io</span><span class="op" id="2422348">.</span><span class="ident" id="2422349">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422357">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2422365">[</span><span class="ident" id="2422366">utf8</span><span class="op" id="2422370">.</span><span class="ident" id="2422371">UTFMax</span><span class="op" id="2422377">]</span><span class="builtintype" id="2422378">byte</span>&nbsp;<span class="comment" id="2422383">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422413">pending</span>&nbsp;<span class="builtintype" id="2422421">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2422439">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422493">pendBuf</span>&nbsp;<span class="op" id="2422501">[</span><span class="ident" id="2422502">utf8</span><span class="op" id="2422506">.</span><span class="ident" id="2422507">UTFMax</span><span class="op" id="2422513">]</span><span class="builtintype" id="2422514">byte</span>&nbsp;<span class="comment" id="2422519">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2422538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2422541">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2422604">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2422667">func</span>&nbsp;<span class="op" id="2422672">(</span><span class="ident" id="2422673">r</span>&nbsp;<span class="op" id="2422675">*</span><span class="ident" id="2422676">readRune</span><span class="op" id="2422684">)</span>&nbsp;<span class="ident" id="2422686">readByte</span><span class="op" id="2422694">(</span><span class="op" id="2422695">)</span>&nbsp;<span class="op" id="2422697">(</span><span class="ident" id="2422698">b</span>&nbsp;<span class="builtintype" id="2422700">byte</span><span class="op" id="2422704">,</span>&nbsp;<span class="ident" id="2422706">err</span>&nbsp;<span class="builtintype" id="2422710">error</span><span class="op" id="2422715">)</span>&nbsp;<span class="op" id="2422717">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2422720">if</span>&nbsp;<span class="ident" id="2422723">r</span><span class="op" id="2422724">.</span><span class="ident" id="2422725">pending</span>&nbsp;<span class="op" id="2422733">&gt;</span>&nbsp;<span class="num" id="2422735">0</span>&nbsp;<span class="op" id="2422737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422741">b</span>&nbsp;<span class="op" id="2422743">=</span>&nbsp;<span class="ident" id="2422745">r</span><span class="op" id="2422746">.</span><span class="ident" id="2422747">pendBuf</span><span class="op" id="2422754">[</span><span class="num" id="2422755">0</span><span class="op" id="2422756">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2422760">copy</span><span class="op" id="2422764">(</span><span class="ident" id="2422765">r</span><span class="op" id="2422766">.</span><span class="ident" id="2422767">pendBuf</span><span class="op" id="2422774">[</span><span class="num" id="2422775">0</span><span class="op" id="2422776">:</span><span class="op" id="2422777">]</span><span class="op" id="2422778">,</span>&nbsp;<span class="ident" id="2422780">r</span><span class="op" id="2422781">.</span><span class="ident" id="2422782">pendBuf</span><span class="op" id="2422789">[</span><span class="num" id="2422790">1</span><span class="op" id="2422791">:</span><span class="op" id="2422792">]</span><span class="op" id="2422793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422797">r</span><span class="op" id="2422798">.</span><span class="ident" id="2422799">pending</span><span class="op" id="2422806">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2422811">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2422819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2422822">n</span><span class="op" id="2422823">,</span>&nbsp;<span class="ident" id="2422825">err</span>&nbsp;<span class="op" id="2422829">:=</span>&nbsp;<span class="ident" id="2422832">io</span><span class="op" id="2422834">.</span><span class="ident" id="2422835">ReadFull</span><span class="op" id="2422843">(</span><span class="ident" id="2422844">r</span><span class="op" id="2422845">.</span><span class="ident" id="2422846">reader</span><span class="op" id="2422852">,</span>&nbsp;<span class="ident" id="2422854">r</span><span class="op" id="2422855">.</span><span class="ident" id="2422856">pendBuf</span><span class="op" id="2422863">[</span><span class="num" id="2422864">0</span><span class="op" id="2422865">:</span><span class="num" id="2422866">1</span><span class="op" id="2422867">]</span><span class="op" id="2422868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2422871">if</span>&nbsp;<span class="ident" id="2422874">n</span>&nbsp;<span class="op" id="2422876">!=</span>&nbsp;<span class="num" id="2422879">1</span>&nbsp;<span class="op" id="2422881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2422885">return</span>&nbsp;<span class="num" id="2422892">0</span><span class="op" id="2422893">,</span>&nbsp;<span class="ident" id="2422895">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2422900">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2422903">return</span>&nbsp;<span class="ident" id="2422910">r</span><span class="op" id="2422911">.</span><span class="ident" id="2422912">pendBuf</span><span class="op" id="2422919">[</span><span class="num" id="2422920">0</span><span class="op" id="2422921">]</span><span class="op" id="2422922">,</span>&nbsp;<span class="ident" id="2422924">err</span><br>
<span class="lineno"></span><span class="op" id="2422928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2422931">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2422976">func</span>&nbsp;<span class="op" id="2422981">(</span><span class="ident" id="2422982">r</span>&nbsp;<span class="op" id="2422984">*</span><span class="ident" id="2422985">readRune</span><span class="op" id="2422993">)</span>&nbsp;<span class="ident" id="2422995">unread</span><span class="op" id="2423001">(</span><span class="ident" id="2423002">buf</span>&nbsp;<span class="op" id="2423006">[</span><span class="op" id="2423007">]</span><span class="builtintype" id="2423008">byte</span><span class="op" id="2423012">)</span>&nbsp;<span class="op" id="2423014">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2423017">copy</span><span class="op" id="2423021">(</span><span class="ident" id="2423022">r</span><span class="op" id="2423023">.</span><span class="ident" id="2423024">pendBuf</span><span class="op" id="2423031">[</span><span class="ident" id="2423032">r</span><span class="op" id="2423033">.</span><span class="ident" id="2423034">pending</span><span class="op" id="2423041">:</span><span class="op" id="2423042">]</span><span class="op" id="2423043">,</span>&nbsp;<span class="ident" id="2423045">buf</span><span class="op" id="2423048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423051">r</span><span class="op" id="2423052">.</span><span class="ident" id="2423053">pending</span>&nbsp;<span class="op" id="2423061">+=</span>&nbsp;<span class="builtinfunc" id="2423064">len</span><span class="op" id="2423067">(</span><span class="ident" id="2423068">buf</span><span class="op" id="2423071">)</span><br>
<span class="lineno"></span><span class="op" id="2423073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2423076">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2423139">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2423162">func</span>&nbsp;<span class="op" id="2423167">(</span><span class="ident" id="2423168">r</span>&nbsp;<span class="op" id="2423170">*</span><span class="ident" id="2423171">readRune</span><span class="op" id="2423179">)</span>&nbsp;<span class="ident" id="2423181">ReadRune</span><span class="op" id="2423189">(</span><span class="op" id="2423190">)</span>&nbsp;<span class="op" id="2423192">(</span><span class="ident" id="2423193">rr</span>&nbsp;<span class="builtintype" id="2423196">rune</span><span class="op" id="2423200">,</span>&nbsp;<span class="ident" id="2423202">size</span>&nbsp;<span class="builtintype" id="2423207">int</span><span class="op" id="2423210">,</span>&nbsp;<span class="ident" id="2423212">err</span>&nbsp;<span class="builtintype" id="2423216">error</span><span class="op" id="2423221">)</span>&nbsp;<span class="op" id="2423223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423226">r</span><span class="op" id="2423227">.</span><span class="ident" id="2423228">buf</span><span class="op" id="2423231">[</span><span class="num" id="2423232">0</span><span class="op" id="2423233">]</span><span class="op" id="2423234">,</span>&nbsp;<span class="ident" id="2423236">err</span>&nbsp;<span class="op" id="2423240">=</span>&nbsp;<span class="ident" id="2423242">r</span><span class="op" id="2423243">.</span><span class="ident" id="2423244">readByte</span><span class="op" id="2423252">(</span><span class="op" id="2423253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423256">if</span>&nbsp;<span class="ident" id="2423259">err</span>&nbsp;<span class="op" id="2423263">!=</span>&nbsp;<span class="ident" id="2423266">nil</span>&nbsp;<span class="op" id="2423270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423274">return</span>&nbsp;<span class="num" id="2423281">0</span><span class="op" id="2423282">,</span>&nbsp;<span class="num" id="2423284">0</span><span class="op" id="2423285">,</span>&nbsp;<span class="ident" id="2423287">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2423292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423295">if</span>&nbsp;<span class="ident" id="2423298">r</span><span class="op" id="2423299">.</span><span class="ident" id="2423300">buf</span><span class="op" id="2423303">[</span><span class="num" id="2423304">0</span><span class="op" id="2423305">]</span>&nbsp;<span class="op" id="2423307">&lt;</span>&nbsp;<span class="ident" id="2423309">utf8</span><span class="op" id="2423313">.</span><span class="ident" id="2423314">RuneSelf</span>&nbsp;<span class="op" id="2423323">{</span>&nbsp;<span class="comment" id="2423325">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423363">rr</span>&nbsp;<span class="op" id="2423366">=</span>&nbsp;<span class="builtintype" id="2423368">rune</span><span class="op" id="2423372">(</span><span class="ident" id="2423373">r</span><span class="op" id="2423374">.</span><span class="ident" id="2423375">buf</span><span class="op" id="2423378">[</span><span class="num" id="2423379">0</span><span class="op" id="2423380">]</span><span class="op" id="2423381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423385">size</span>&nbsp;<span class="op" id="2423390">=</span>&nbsp;<span class="num" id="2423392">1</span>&nbsp;<span class="comment" id="2423394">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423414">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2423422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423425">var</span>&nbsp;<span class="ident" id="2423429">n</span>&nbsp;<span class="builtintype" id="2423431">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423436">for</span>&nbsp;<span class="ident" id="2423440">n</span>&nbsp;<span class="op" id="2423442">=</span>&nbsp;<span class="num" id="2423444">1</span><span class="op" id="2423445">;</span>&nbsp;<span class="op" id="2423447">!</span><span class="ident" id="2423448">utf8</span><span class="op" id="2423452">.</span><span class="ident" id="2423453">FullRune</span><span class="op" id="2423461">(</span><span class="ident" id="2423462">r</span><span class="op" id="2423463">.</span><span class="ident" id="2423464">buf</span><span class="op" id="2423467">[</span><span class="num" id="2423468">0</span><span class="op" id="2423469">:</span><span class="ident" id="2423470">n</span><span class="op" id="2423471">]</span><span class="op" id="2423472">)</span><span class="op" id="2423473">;</span>&nbsp;<span class="ident" id="2423475">n</span><span class="op" id="2423476">++</span>&nbsp;<span class="op" id="2423479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423483">r</span><span class="op" id="2423484">.</span><span class="ident" id="2423485">buf</span><span class="op" id="2423488">[</span><span class="ident" id="2423489">n</span><span class="op" id="2423490">]</span><span class="op" id="2423491">,</span>&nbsp;<span class="ident" id="2423493">err</span>&nbsp;<span class="op" id="2423497">=</span>&nbsp;<span class="ident" id="2423499">r</span><span class="op" id="2423500">.</span><span class="ident" id="2423501">readByte</span><span class="op" id="2423509">(</span><span class="op" id="2423510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423514">if</span>&nbsp;<span class="ident" id="2423517">err</span>&nbsp;<span class="op" id="2423521">!=</span>&nbsp;<span class="ident" id="2423524">nil</span>&nbsp;<span class="op" id="2423528">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423533">if</span>&nbsp;<span class="ident" id="2423536">err</span>&nbsp;<span class="op" id="2423540">==</span>&nbsp;<span class="ident" id="2423543">io</span><span class="op" id="2423545">.</span><span class="ident" id="2423546">EOF</span>&nbsp;<span class="op" id="2423550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423556">err</span>&nbsp;<span class="op" id="2423560">=</span>&nbsp;<span class="ident" id="2423562">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423570">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2423579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423584">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2423593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2423596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423599">rr</span><span class="op" id="2423601">,</span>&nbsp;<span class="ident" id="2423603">size</span>&nbsp;<span class="op" id="2423608">=</span>&nbsp;<span class="ident" id="2423610">utf8</span><span class="op" id="2423614">.</span><span class="ident" id="2423615">DecodeRune</span><span class="op" id="2423625">(</span><span class="ident" id="2423626">r</span><span class="op" id="2423627">.</span><span class="ident" id="2423628">buf</span><span class="op" id="2423631">[</span><span class="num" id="2423632">0</span><span class="op" id="2423633">:</span><span class="ident" id="2423634">n</span><span class="op" id="2423635">]</span><span class="op" id="2423636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423639">if</span>&nbsp;<span class="ident" id="2423642">size</span>&nbsp;<span class="op" id="2423647">&lt;</span>&nbsp;<span class="ident" id="2423649">n</span>&nbsp;<span class="op" id="2423651">{</span>&nbsp;<span class="comment" id="2423653">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423667">r</span><span class="op" id="2423668">.</span><span class="ident" id="2423669">unread</span><span class="op" id="2423675">(</span><span class="ident" id="2423676">r</span><span class="op" id="2423677">.</span><span class="ident" id="2423678">buf</span><span class="op" id="2423681">[</span><span class="ident" id="2423682">size</span><span class="op" id="2423686">:</span><span class="ident" id="2423687">n</span><span class="op" id="2423688">]</span><span class="op" id="2423689">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2423692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2423695">return</span><br>
<span class="lineno"></span><span class="op" id="2423702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2423705">var</span>&nbsp;<span class="ident" id="2423709">ssFree</span>&nbsp;<span class="op" id="2423716">=</span>&nbsp;<span class="ident" id="2423718">sync</span><span class="op" id="2423722">.</span><span class="ident" id="2423723">Pool</span><span class="op" id="2423727">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2423730">New</span><span class="op" id="2423733">:</span>&nbsp;<span class="keyword" id="2423735">func</span><span class="op" id="2423739">(</span><span class="op" id="2423740">)</span>&nbsp;<span class="keyword" id="2423742">interface</span><span class="op" id="2423751">{</span><span class="op" id="2423752">}</span>&nbsp;<span class="op" id="2423754">{</span>&nbsp;<span class="keyword" id="2423756">return</span>&nbsp;<span class="builtinfunc" id="2423763">new</span><span class="op" id="2423766">(</span><span class="ident" id="2423767">ss</span><span class="op" id="2423769">)</span>&nbsp;<span class="op" id="2423771">}</span><span class="op" id="2423772">,</span><br>
<span class="lineno"></span><span class="op" id="2423774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2423777">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2423841">func</span>&nbsp;<span class="ident" id="2423846">newScanState</span><span class="op" id="2423858">(</span><span class="ident" id="2423859">r</span>&nbsp;<span class="ident" id="2423861">io</span><span class="op" id="2423863">.</span><span class="ident" id="2423864">Reader</span><span class="op" id="2423870">,</span>&nbsp;<span class="ident" id="2423872">nlIsSpace</span><span class="op" id="2423881">,</span>&nbsp;<span class="ident" id="2423883">nlIsEnd</span>&nbsp;<span class="builtintype" id="2423891">bool</span><span class="op" id="2423895">)</span>&nbsp;<span class="op" id="2423897">(</span><span class="ident" id="2423898">s</span>&nbsp;<span class="op" id="2423900">*</span><span class="ident" id="2423901">ss</span><span class="op" id="2423903">,</span>&nbsp;<span class="ident" id="2423905">old</span>&nbsp;<span class="ident" id="2423909">ssave</span><span class="op" id="2423914">)</span>&nbsp;<span class="op" id="2423916">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423919">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2423974">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424018">s</span><span class="op" id="2424019">,</span>&nbsp;<span class="ident" id="2424021">ok</span>&nbsp;<span class="op" id="2424024">:=</span>&nbsp;<span class="ident" id="2424027">r</span><span class="op" id="2424028">.</span><span class="op" id="2424029">(</span><span class="op" id="2424030">*</span><span class="ident" id="2424031">ss</span><span class="op" id="2424033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424036">if</span>&nbsp;<span class="ident" id="2424039">ok</span>&nbsp;<span class="op" id="2424042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424046">old</span>&nbsp;<span class="op" id="2424050">=</span>&nbsp;<span class="ident" id="2424052">s</span><span class="op" id="2424053">.</span><span class="ident" id="2424054">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424062">s</span><span class="op" id="2424063">.</span><span class="ident" id="2424064">limit</span>&nbsp;<span class="op" id="2424070">=</span>&nbsp;<span class="ident" id="2424072">s</span><span class="op" id="2424073">.</span><span class="ident" id="2424074">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424085">s</span><span class="op" id="2424086">.</span><span class="ident" id="2424087">nlIsEnd</span>&nbsp;<span class="op" id="2424095">=</span>&nbsp;<span class="ident" id="2424097">nlIsEnd</span>&nbsp;<span class="op" id="2424105">||</span>&nbsp;<span class="ident" id="2424108">s</span><span class="op" id="2424109">.</span><span class="ident" id="2424110">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424120">s</span><span class="op" id="2424121">.</span><span class="ident" id="2424122">nlIsSpace</span>&nbsp;<span class="op" id="2424132">=</span>&nbsp;<span class="ident" id="2424134">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424146">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2424154">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424158">s</span>&nbsp;<span class="op" id="2424160">=</span>&nbsp;<span class="ident" id="2424162">ssFree</span><span class="op" id="2424168">.</span><span class="ident" id="2424169">Get</span><span class="op" id="2424172">(</span><span class="op" id="2424173">)</span><span class="op" id="2424174">.</span><span class="op" id="2424175">(</span><span class="op" id="2424176">*</span><span class="ident" id="2424177">ss</span><span class="op" id="2424179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424182">if</span>&nbsp;<span class="ident" id="2424185">rr</span><span class="op" id="2424187">,</span>&nbsp;<span class="ident" id="2424189">ok</span>&nbsp;<span class="op" id="2424192">:=</span>&nbsp;<span class="ident" id="2424195">r</span><span class="op" id="2424196">.</span><span class="op" id="2424197">(</span><span class="ident" id="2424198">io</span><span class="op" id="2424200">.</span><span class="ident" id="2424201">RuneReader</span><span class="op" id="2424211">)</span><span class="op" id="2424212">;</span>&nbsp;<span class="ident" id="2424214">ok</span>&nbsp;<span class="op" id="2424217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424221">s</span><span class="op" id="2424222">.</span><span class="ident" id="2424223">rr</span>&nbsp;<span class="op" id="2424226">=</span>&nbsp;<span class="ident" id="2424228">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2424232">}</span>&nbsp;<span class="keyword" id="2424234">else</span>&nbsp;<span class="op" id="2424239">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424243">s</span><span class="op" id="2424244">.</span><span class="ident" id="2424245">rr</span>&nbsp;<span class="op" id="2424248">=</span>&nbsp;<span class="op" id="2424250">&amp;</span><span class="ident" id="2424251">readRune</span><span class="op" id="2424259">{</span><span class="ident" id="2424260">reader</span><span class="op" id="2424266">:</span>&nbsp;<span class="ident" id="2424268">r</span><span class="op" id="2424269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2424272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424275">s</span><span class="op" id="2424276">.</span><span class="ident" id="2424277">nlIsSpace</span>&nbsp;<span class="op" id="2424287">=</span>&nbsp;<span class="ident" id="2424289">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424300">s</span><span class="op" id="2424301">.</span><span class="ident" id="2424302">nlIsEnd</span>&nbsp;<span class="op" id="2424310">=</span>&nbsp;<span class="ident" id="2424312">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424321">s</span><span class="op" id="2424322">.</span><span class="ident" id="2424323">prevRune</span>&nbsp;<span class="op" id="2424332">=</span>&nbsp;<span class="op" id="2424334">-</span><span class="num" id="2424335">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424338">s</span><span class="op" id="2424339">.</span><span class="ident" id="2424340">peekRune</span>&nbsp;<span class="op" id="2424349">=</span>&nbsp;<span class="op" id="2424351">-</span><span class="num" id="2424352">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424355">s</span><span class="op" id="2424356">.</span><span class="ident" id="2424357">atEOF</span>&nbsp;<span class="op" id="2424363">=</span>&nbsp;<span class="builtintype" id="2424365">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424372">s</span><span class="op" id="2424373">.</span><span class="ident" id="2424374">limit</span>&nbsp;<span class="op" id="2424380">=</span>&nbsp;<span class="ident" id="2424382">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424391">s</span><span class="op" id="2424392">.</span><span class="ident" id="2424393">argLimit</span>&nbsp;<span class="op" id="2424402">=</span>&nbsp;<span class="ident" id="2424404">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424413">s</span><span class="op" id="2424414">.</span><span class="ident" id="2424415">maxWid</span>&nbsp;<span class="op" id="2424422">=</span>&nbsp;<span class="ident" id="2424424">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424433">s</span><span class="op" id="2424434">.</span><span class="ident" id="2424435">validSave</span>&nbsp;<span class="op" id="2424445">=</span>&nbsp;<span class="builtintype" id="2424447">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424453">s</span><span class="op" id="2424454">.</span><span class="ident" id="2424455">count</span>&nbsp;<span class="op" id="2424461">=</span>&nbsp;<span class="num" id="2424463">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424466">return</span><br>
<span class="lineno"></span><span class="op" id="2424473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2424476">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2424553">func</span>&nbsp;<span class="op" id="2424558">(</span><span class="ident" id="2424559">s</span>&nbsp;<span class="op" id="2424561">*</span><span class="ident" id="2424562">ss</span><span class="op" id="2424564">)</span>&nbsp;<span class="ident" id="2424566">free</span><span class="op" id="2424570">(</span><span class="ident" id="2424571">old</span>&nbsp;<span class="ident" id="2424575">ssave</span><span class="op" id="2424580">)</span>&nbsp;<span class="op" id="2424582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424585">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424645">if</span>&nbsp;<span class="ident" id="2424648">old</span><span class="op" id="2424651">.</span><span class="ident" id="2424652">validSave</span>&nbsp;<span class="op" id="2424662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424666">s</span><span class="op" id="2424667">.</span><span class="ident" id="2424668">ssave</span>&nbsp;<span class="op" id="2424674">=</span>&nbsp;<span class="ident" id="2424676">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424682">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2424690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2424693">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424745">if</span>&nbsp;<span class="builtinfunc" id="2424748">cap</span><span class="op" id="2424751">(</span><span class="ident" id="2424752">s</span><span class="op" id="2424753">.</span><span class="ident" id="2424754">buf</span><span class="op" id="2424757">)</span>&nbsp;<span class="op" id="2424759">&gt;</span>&nbsp;<span class="num" id="2424761">1024</span>&nbsp;<span class="op" id="2424766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424770">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2424778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424781">s</span><span class="op" id="2424782">.</span><span class="ident" id="2424783">buf</span>&nbsp;<span class="op" id="2424787">=</span>&nbsp;<span class="ident" id="2424789">s</span><span class="op" id="2424790">.</span><span class="ident" id="2424791">buf</span><span class="op" id="2424794">[</span><span class="op" id="2424795">:</span><span class="num" id="2424796">0</span><span class="op" id="2424797">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424800">s</span><span class="op" id="2424801">.</span><span class="ident" id="2424802">rr</span>&nbsp;<span class="op" id="2424805">=</span>&nbsp;<span class="ident" id="2424807">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424812">ssFree</span><span class="op" id="2424818">.</span><span class="ident" id="2424819">Put</span><span class="op" id="2424822">(</span><span class="ident" id="2424823">s</span><span class="op" id="2424824">)</span><br>
<span class="lineno"></span><span class="op" id="2424826">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2424829">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2424875">func</span>&nbsp;<span class="op" id="2424880">(</span><span class="ident" id="2424881">s</span>&nbsp;<span class="op" id="2424883">*</span><span class="ident" id="2424884">ss</span><span class="op" id="2424886">)</span>&nbsp;<span class="ident" id="2424888">skipSpace</span><span class="op" id="2424897">(</span><span class="ident" id="2424898">stopAtNewline</span>&nbsp;<span class="builtintype" id="2424912">bool</span><span class="op" id="2424916">)</span>&nbsp;<span class="op" id="2424918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424921">for</span>&nbsp;<span class="op" id="2424925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2424929">r</span>&nbsp;<span class="op" id="2424931">:=</span>&nbsp;<span class="ident" id="2424934">s</span><span class="op" id="2424935">.</span><span class="ident" id="2424936">getRune</span><span class="op" id="2424943">(</span><span class="op" id="2424944">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424948">if</span>&nbsp;<span class="ident" id="2424951">r</span>&nbsp;<span class="op" id="2424953">==</span>&nbsp;<span class="ident" id="2424956">eof</span>&nbsp;<span class="op" id="2424960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424965">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2424974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2424978">if</span>&nbsp;<span class="ident" id="2424981">r</span>&nbsp;<span class="op" id="2424983">==</span>&nbsp;<span class="string" id="2424986">&#39;\r&#39;</span>&nbsp;<span class="op" id="2424991">&amp;&amp;</span>&nbsp;<span class="ident" id="2424994">s</span><span class="op" id="2424995">.</span><span class="ident" id="2424996">peek</span><span class="op" id="2425000">(</span><span class="string" id="2425001">&#34;\n&#34;</span><span class="op" id="2425005">)</span>&nbsp;<span class="op" id="2425007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425012">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425027">if</span>&nbsp;<span class="ident" id="2425030">r</span>&nbsp;<span class="op" id="2425032">==</span>&nbsp;<span class="string" id="2425035">&#39;\n&#39;</span>&nbsp;<span class="op" id="2425040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425045">if</span>&nbsp;<span class="ident" id="2425048">stopAtNewline</span>&nbsp;<span class="op" id="2425062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425068">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425077">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425082">if</span>&nbsp;<span class="ident" id="2425085">s</span><span class="op" id="2425086">.</span><span class="ident" id="2425087">nlIsSpace</span>&nbsp;<span class="op" id="2425097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425103">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425120">s</span><span class="op" id="2425121">.</span><span class="ident" id="2425122">errorString</span><span class="op" id="2425133">(</span><span class="string" id="2425134">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2425154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425159">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425172">if</span>&nbsp;<span class="op" id="2425175">!</span><span class="ident" id="2425176">isSpace</span><span class="op" id="2425183">(</span><span class="ident" id="2425184">r</span><span class="op" id="2425185">)</span>&nbsp;<span class="op" id="2425187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425192">s</span><span class="op" id="2425193">.</span><span class="ident" id="2425194">UnreadRune</span><span class="op" id="2425204">(</span><span class="op" id="2425205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425210">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425218">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425221">}</span><br>
<span class="lineno"></span><span class="op" id="2425223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2425226">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2425295">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2425363">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2425398">func</span>&nbsp;<span class="op" id="2425403">(</span><span class="ident" id="2425404">s</span>&nbsp;<span class="op" id="2425406">*</span><span class="ident" id="2425407">ss</span><span class="op" id="2425409">)</span>&nbsp;<span class="ident" id="2425411">token</span><span class="op" id="2425416">(</span><span class="ident" id="2425417">skipSpace</span>&nbsp;<span class="builtintype" id="2425427">bool</span><span class="op" id="2425431">,</span>&nbsp;<span class="ident" id="2425433">f</span>&nbsp;<span class="keyword" id="2425435">func</span><span class="op" id="2425439">(</span><span class="builtintype" id="2425440">rune</span><span class="op" id="2425444">)</span>&nbsp;<span class="builtintype" id="2425446">bool</span><span class="op" id="2425450">)</span>&nbsp;<span class="op" id="2425452">[</span><span class="op" id="2425453">]</span><span class="builtintype" id="2425454">byte</span>&nbsp;<span class="op" id="2425459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425462">if</span>&nbsp;<span class="ident" id="2425465">skipSpace</span>&nbsp;<span class="op" id="2425475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425479">s</span><span class="op" id="2425480">.</span><span class="ident" id="2425481">skipSpace</span><span class="op" id="2425490">(</span><span class="builtintype" id="2425491">false</span><span class="op" id="2425496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425499">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2425502">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425540">for</span>&nbsp;<span class="op" id="2425544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425548">r</span>&nbsp;<span class="op" id="2425550">:=</span>&nbsp;<span class="ident" id="2425553">s</span><span class="op" id="2425554">.</span><span class="ident" id="2425555">getRune</span><span class="op" id="2425562">(</span><span class="op" id="2425563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425567">if</span>&nbsp;<span class="ident" id="2425570">r</span>&nbsp;<span class="op" id="2425572">==</span>&nbsp;<span class="ident" id="2425575">eof</span>&nbsp;<span class="op" id="2425579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425584">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425596">if</span>&nbsp;<span class="op" id="2425599">!</span><span class="ident" id="2425600">f</span><span class="op" id="2425601">(</span><span class="ident" id="2425602">r</span><span class="op" id="2425603">)</span>&nbsp;<span class="op" id="2425605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425610">s</span><span class="op" id="2425611">.</span><span class="ident" id="2425612">UnreadRune</span><span class="op" id="2425622">(</span><span class="op" id="2425623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425628">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425636">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2425640">s</span><span class="op" id="2425641">.</span><span class="ident" id="2425642">buf</span><span class="op" id="2425645">.</span><span class="ident" id="2425646">WriteRune</span><span class="op" id="2425655">(</span><span class="ident" id="2425656">r</span><span class="op" id="2425657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425663">return</span>&nbsp;<span class="ident" id="2425670">s</span><span class="op" id="2425671">.</span><span class="ident" id="2425672">buf</span><br>
<span class="lineno"></span><span class="op" id="2425676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2425679">var</span>&nbsp;<span class="ident" id="2425683">complexError</span>&nbsp;<span class="op" id="2425696">=</span>&nbsp;<span class="ident" id="2425698">errors</span><span class="op" id="2425704">.</span><span class="ident" id="2425705">New</span><span class="op" id="2425708">(</span><span class="string" id="2425709">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2425747">)</span><br>
<span class="lineno"></span><span class="keyword" id="2425749">var</span>&nbsp;<span class="ident" id="2425753">boolError</span>&nbsp;<span class="op" id="2425763">=</span>&nbsp;<span class="ident" id="2425765">errors</span><span class="op" id="2425771">.</span><span class="ident" id="2425772">New</span><span class="op" id="2425775">(</span><span class="string" id="2425776">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2425807">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2425810">func</span>&nbsp;<span class="ident" id="2425815">indexRune</span><span class="op" id="2425824">(</span><span class="ident" id="2425825">s</span>&nbsp;<span class="builtintype" id="2425827">string</span><span class="op" id="2425833">,</span>&nbsp;<span class="ident" id="2425835">r</span>&nbsp;<span class="builtintype" id="2425837">rune</span><span class="op" id="2425841">)</span>&nbsp;<span class="builtintype" id="2425843">int</span>&nbsp;<span class="op" id="2425847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425850">for</span>&nbsp;<span class="ident" id="2425854">i</span><span class="op" id="2425855">,</span>&nbsp;<span class="ident" id="2425857">c</span>&nbsp;<span class="op" id="2425859">:=</span>&nbsp;<span class="keyword" id="2425862">range</span>&nbsp;<span class="ident" id="2425868">s</span>&nbsp;<span class="op" id="2425870">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425874">if</span>&nbsp;<span class="ident" id="2425877">c</span>&nbsp;<span class="op" id="2425879">==</span>&nbsp;<span class="ident" id="2425882">r</span>&nbsp;<span class="op" id="2425884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425889">return</span>&nbsp;<span class="ident" id="2425896">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2425903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2425906">return</span>&nbsp;<span class="op" id="2425913">-</span><span class="num" id="2425914">1</span><br>
<span class="lineno">495</span><span class="op" id="2425916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2425919">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2426007">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2426073">func</span>&nbsp;<span class="op" id="2426078">(</span><span class="ident" id="2426079">s</span>&nbsp;<span class="op" id="2426081">*</span><span class="ident" id="2426082">ss</span><span class="op" id="2426084">)</span>&nbsp;<span class="ident" id="2426086">consume</span><span class="op" id="2426093">(</span><span class="ident" id="2426094">ok</span>&nbsp;<span class="builtintype" id="2426097">string</span><span class="op" id="2426103">,</span>&nbsp;<span class="ident" id="2426105">accept</span>&nbsp;<span class="builtintype" id="2426112">bool</span><span class="op" id="2426116">)</span>&nbsp;<span class="builtintype" id="2426118">bool</span>&nbsp;<span class="op" id="2426123">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426126">r</span>&nbsp;<span class="op" id="2426128">:=</span>&nbsp;<span class="ident" id="2426131">s</span><span class="op" id="2426132">.</span><span class="ident" id="2426133">getRune</span><span class="op" id="2426140">(</span><span class="op" id="2426141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426144">if</span>&nbsp;<span class="ident" id="2426147">r</span>&nbsp;<span class="op" id="2426149">==</span>&nbsp;<span class="ident" id="2426152">eof</span>&nbsp;<span class="op" id="2426156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426160">return</span>&nbsp;<span class="builtintype" id="2426167">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2426174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426177">if</span>&nbsp;<span class="ident" id="2426180">indexRune</span><span class="op" id="2426189">(</span><span class="ident" id="2426190">ok</span><span class="op" id="2426192">,</span>&nbsp;<span class="ident" id="2426194">r</span><span class="op" id="2426195">)</span>&nbsp;<span class="op" id="2426197">&gt;=</span>&nbsp;<span class="num" id="2426200">0</span>&nbsp;<span class="op" id="2426202">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426206">if</span>&nbsp;<span class="ident" id="2426209">accept</span>&nbsp;<span class="op" id="2426216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426221">s</span><span class="op" id="2426222">.</span><span class="ident" id="2426223">buf</span><span class="op" id="2426226">.</span><span class="ident" id="2426227">WriteRune</span><span class="op" id="2426236">(</span><span class="ident" id="2426237">r</span><span class="op" id="2426238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2426242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426246">return</span>&nbsp;<span class="builtintype" id="2426253">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2426259">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426262">if</span>&nbsp;<span class="ident" id="2426265">r</span>&nbsp;<span class="op" id="2426267">!=</span>&nbsp;<span class="ident" id="2426270">eof</span>&nbsp;<span class="op" id="2426274">&amp;&amp;</span>&nbsp;<span class="ident" id="2426277">accept</span>&nbsp;<span class="op" id="2426284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426288">s</span><span class="op" id="2426289">.</span><span class="ident" id="2426290">UnreadRune</span><span class="op" id="2426300">(</span><span class="op" id="2426301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2426304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426307">return</span>&nbsp;<span class="builtintype" id="2426314">false</span><br>
<span class="lineno"></span><span class="op" id="2426320">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2426323">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2426409">func</span>&nbsp;<span class="op" id="2426414">(</span><span class="ident" id="2426415">s</span>&nbsp;<span class="op" id="2426417">*</span><span class="ident" id="2426418">ss</span><span class="op" id="2426420">)</span>&nbsp;<span class="ident" id="2426422">peek</span><span class="op" id="2426426">(</span><span class="ident" id="2426427">ok</span>&nbsp;<span class="builtintype" id="2426430">string</span><span class="op" id="2426436">)</span>&nbsp;<span class="builtintype" id="2426438">bool</span>&nbsp;<span class="op" id="2426443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426446">r</span>&nbsp;<span class="op" id="2426448">:=</span>&nbsp;<span class="ident" id="2426451">s</span><span class="op" id="2426452">.</span><span class="ident" id="2426453">getRune</span><span class="op" id="2426460">(</span><span class="op" id="2426461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426464">if</span>&nbsp;<span class="ident" id="2426467">r</span>&nbsp;<span class="op" id="2426469">!=</span>&nbsp;<span class="ident" id="2426472">eof</span>&nbsp;<span class="op" id="2426476">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426480">s</span><span class="op" id="2426481">.</span><span class="ident" id="2426482">UnreadRune</span><span class="op" id="2426492">(</span><span class="op" id="2426493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2426496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426499">return</span>&nbsp;<span class="ident" id="2426506">indexRune</span><span class="op" id="2426515">(</span><span class="ident" id="2426516">ok</span><span class="op" id="2426518">,</span>&nbsp;<span class="ident" id="2426520">r</span><span class="op" id="2426521">)</span>&nbsp;<span class="op" id="2426523">&gt;=</span>&nbsp;<span class="num" id="2426526">0</span><br>
<span class="lineno"></span><span class="op" id="2426528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2426531">func</span>&nbsp;<span class="op" id="2426536">(</span><span class="ident" id="2426537">s</span>&nbsp;<span class="op" id="2426539">*</span><span class="ident" id="2426540">ss</span><span class="op" id="2426542">)</span>&nbsp;<span class="ident" id="2426544">notEOF</span><span class="op" id="2426550">(</span><span class="op" id="2426551">)</span>&nbsp;<span class="op" id="2426553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2426556">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426596">if</span>&nbsp;<span class="ident" id="2426599">r</span>&nbsp;<span class="op" id="2426601">:=</span>&nbsp;<span class="ident" id="2426604">s</span><span class="op" id="2426605">.</span><span class="ident" id="2426606">getRune</span><span class="op" id="2426613">(</span><span class="op" id="2426614">)</span><span class="op" id="2426615">;</span>&nbsp;<span class="ident" id="2426617">r</span>&nbsp;<span class="op" id="2426619">==</span>&nbsp;<span class="ident" id="2426622">eof</span>&nbsp;<span class="op" id="2426626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2426630">panic</span><span class="op" id="2426635">(</span><span class="ident" id="2426636">io</span><span class="op" id="2426638">.</span><span class="ident" id="2426639">EOF</span><span class="op" id="2426642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2426645">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2426648">s</span><span class="op" id="2426649">.</span><span class="ident" id="2426650">UnreadRune</span><span class="op" id="2426660">(</span><span class="op" id="2426661">)</span><br>
<span class="lineno"></span><span class="op" id="2426663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2426666">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2426766">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2426821">func</span>&nbsp;<span class="op" id="2426826">(</span><span class="ident" id="2426827">s</span>&nbsp;<span class="op" id="2426829">*</span><span class="ident" id="2426830">ss</span><span class="op" id="2426832">)</span>&nbsp;<span class="ident" id="2426834">accept</span><span class="op" id="2426840">(</span><span class="ident" id="2426841">ok</span>&nbsp;<span class="builtintype" id="2426844">string</span><span class="op" id="2426850">)</span>&nbsp;<span class="builtintype" id="2426852">bool</span>&nbsp;<span class="op" id="2426857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2426860">return</span>&nbsp;<span class="ident" id="2426867">s</span><span class="op" id="2426868">.</span><span class="ident" id="2426869">consume</span><span class="op" id="2426876">(</span><span class="ident" id="2426877">ok</span><span class="op" id="2426879">,</span>&nbsp;<span class="builtintype" id="2426881">true</span><span class="op" id="2426885">)</span><br>
<span class="lineno"></span><span class="op" id="2426887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2426890">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2426983">func</span>&nbsp;<span class="op" id="2426988">(</span><span class="ident" id="2426989">s</span>&nbsp;<span class="op" id="2426991">*</span><span class="ident" id="2426992">ss</span><span class="op" id="2426994">)</span>&nbsp;<span class="ident" id="2426996">okVerb</span><span class="op" id="2427002">(</span><span class="ident" id="2427003">verb</span>&nbsp;<span class="builtintype" id="2427008">rune</span><span class="op" id="2427012">,</span>&nbsp;<span class="ident" id="2427014">okVerbs</span><span class="op" id="2427021">,</span>&nbsp;<span class="ident" id="2427023">typ</span>&nbsp;<span class="builtintype" id="2427027">string</span><span class="op" id="2427033">)</span>&nbsp;<span class="builtintype" id="2427035">bool</span>&nbsp;<span class="op" id="2427040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427043">for</span>&nbsp;<span class="ident" id="2427047">_</span><span class="op" id="2427048">,</span>&nbsp;<span class="ident" id="2427050">v</span>&nbsp;<span class="op" id="2427052">:=</span>&nbsp;<span class="keyword" id="2427055">range</span>&nbsp;<span class="ident" id="2427061">okVerbs</span>&nbsp;<span class="op" id="2427069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427073">if</span>&nbsp;<span class="ident" id="2427076">v</span>&nbsp;<span class="op" id="2427078">==</span>&nbsp;<span class="ident" id="2427081">verb</span>&nbsp;<span class="op" id="2427086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427091">return</span>&nbsp;<span class="builtintype" id="2427098">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2427105">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2427108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427111">s</span><span class="op" id="2427112">.</span><span class="ident" id="2427113">errorString</span><span class="op" id="2427124">(</span><span class="string" id="2427125">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2427138">+</span>&nbsp;<span class="builtintype" id="2427140">string</span><span class="op" id="2427146">(</span><span class="ident" id="2427147">verb</span><span class="op" id="2427151">)</span>&nbsp;<span class="op" id="2427153">+</span>&nbsp;<span class="string" id="2427155">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2427163">+</span>&nbsp;<span class="ident" id="2427165">typ</span><span class="op" id="2427168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427171">return</span>&nbsp;<span class="builtintype" id="2427178">false</span><br>
<span class="lineno"></span><span class="op" id="2427184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2427187">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2427263">func</span>&nbsp;<span class="op" id="2427268">(</span><span class="ident" id="2427269">s</span>&nbsp;<span class="op" id="2427271">*</span><span class="ident" id="2427272">ss</span><span class="op" id="2427274">)</span>&nbsp;<span class="ident" id="2427276">scanBool</span><span class="op" id="2427284">(</span><span class="ident" id="2427285">verb</span>&nbsp;<span class="builtintype" id="2427290">rune</span><span class="op" id="2427294">)</span>&nbsp;<span class="builtintype" id="2427296">bool</span>&nbsp;<span class="op" id="2427301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427304">s</span><span class="op" id="2427305">.</span><span class="ident" id="2427306">skipSpace</span><span class="op" id="2427315">(</span><span class="builtintype" id="2427316">false</span><span class="op" id="2427321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427324">s</span><span class="op" id="2427325">.</span><span class="ident" id="2427326">notEOF</span><span class="op" id="2427332">(</span><span class="op" id="2427333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427336">if</span>&nbsp;<span class="op" id="2427339">!</span><span class="ident" id="2427340">s</span><span class="op" id="2427341">.</span><span class="ident" id="2427342">okVerb</span><span class="op" id="2427348">(</span><span class="ident" id="2427349">verb</span><span class="op" id="2427353">,</span>&nbsp;<span class="string" id="2427355">&#34;tv&#34;</span><span class="op" id="2427359">,</span>&nbsp;<span class="string" id="2427361">&#34;boolean&#34;</span><span class="op" id="2427370">)</span>&nbsp;<span class="op" id="2427372">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427376">return</span>&nbsp;<span class="builtintype" id="2427383">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2427390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2427393">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427470">switch</span>&nbsp;<span class="ident" id="2427477">s</span><span class="op" id="2427478">.</span><span class="ident" id="2427479">getRune</span><span class="op" id="2427486">(</span><span class="op" id="2427487">)</span>&nbsp;<span class="op" id="2427489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427492">case</span>&nbsp;<span class="string" id="2427497">&#39;0&#39;</span><span class="op" id="2427500">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427504">return</span>&nbsp;<span class="builtintype" id="2427511">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427518">case</span>&nbsp;<span class="string" id="2427523">&#39;1&#39;</span><span class="op" id="2427526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427530">return</span>&nbsp;<span class="builtintype" id="2427537">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427543">case</span>&nbsp;<span class="string" id="2427548">&#39;t&#39;</span><span class="op" id="2427551">,</span>&nbsp;<span class="string" id="2427553">&#39;T&#39;</span><span class="op" id="2427556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427560">if</span>&nbsp;<span class="ident" id="2427563">s</span><span class="op" id="2427564">.</span><span class="ident" id="2427565">accept</span><span class="op" id="2427571">(</span><span class="string" id="2427572">&#34;rR&#34;</span><span class="op" id="2427576">)</span>&nbsp;<span class="op" id="2427578">&amp;&amp;</span>&nbsp;<span class="op" id="2427581">(</span><span class="op" id="2427582">!</span><span class="ident" id="2427583">s</span><span class="op" id="2427584">.</span><span class="ident" id="2427585">accept</span><span class="op" id="2427591">(</span><span class="string" id="2427592">&#34;uU&#34;</span><span class="op" id="2427596">)</span>&nbsp;<span class="op" id="2427598">||</span>&nbsp;<span class="op" id="2427601">!</span><span class="ident" id="2427602">s</span><span class="op" id="2427603">.</span><span class="ident" id="2427604">accept</span><span class="op" id="2427610">(</span><span class="string" id="2427611">&#34;eE&#34;</span><span class="op" id="2427615">)</span><span class="op" id="2427616">)</span>&nbsp;<span class="op" id="2427618">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427623">s</span><span class="op" id="2427624">.</span><span class="builtintype" id="2427625">error</span><span class="op" id="2427630">(</span><span class="ident" id="2427631">boolError</span><span class="op" id="2427640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2427644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427648">return</span>&nbsp;<span class="builtintype" id="2427655">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427661">case</span>&nbsp;<span class="string" id="2427666">&#39;f&#39;</span><span class="op" id="2427669">,</span>&nbsp;<span class="string" id="2427671">&#39;F&#39;</span><span class="op" id="2427674">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427678">if</span>&nbsp;<span class="ident" id="2427681">s</span><span class="op" id="2427682">.</span><span class="ident" id="2427683">accept</span><span class="op" id="2427689">(</span><span class="string" id="2427690">&#34;aA&#34;</span><span class="op" id="2427694">)</span>&nbsp;<span class="op" id="2427696">&amp;&amp;</span>&nbsp;<span class="op" id="2427699">(</span><span class="op" id="2427700">!</span><span class="ident" id="2427701">s</span><span class="op" id="2427702">.</span><span class="ident" id="2427703">accept</span><span class="op" id="2427709">(</span><span class="string" id="2427710">&#34;lL&#34;</span><span class="op" id="2427714">)</span>&nbsp;<span class="op" id="2427716">||</span>&nbsp;<span class="op" id="2427719">!</span><span class="ident" id="2427720">s</span><span class="op" id="2427721">.</span><span class="ident" id="2427722">accept</span><span class="op" id="2427728">(</span><span class="string" id="2427729">&#34;sS&#34;</span><span class="op" id="2427733">)</span>&nbsp;<span class="op" id="2427735">||</span>&nbsp;<span class="op" id="2427738">!</span><span class="ident" id="2427739">s</span><span class="op" id="2427740">.</span><span class="ident" id="2427741">accept</span><span class="op" id="2427747">(</span><span class="string" id="2427748">&#34;eE&#34;</span><span class="op" id="2427752">)</span><span class="op" id="2427753">)</span>&nbsp;<span class="op" id="2427755">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427760">s</span><span class="op" id="2427761">.</span><span class="builtintype" id="2427762">error</span><span class="op" id="2427767">(</span><span class="ident" id="2427768">boolError</span><span class="op" id="2427777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2427781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427785">return</span>&nbsp;<span class="builtintype" id="2427792">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2427799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2427802">return</span>&nbsp;<span class="builtintype" id="2427809">false</span><br>
<span class="lineno">575</span><span class="op" id="2427815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2427818">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2427840">const</span>&nbsp;<span class="op" id="2427846">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427849">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2427867">=</span>&nbsp;<span class="string" id="2427869">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427875">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2427893">=</span>&nbsp;<span class="string" id="2427895">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427907">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2427925">=</span>&nbsp;<span class="string" id="2427927">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427941">hexadecimalDigits</span>&nbsp;<span class="op" id="2427959">=</span>&nbsp;<span class="string" id="2427961">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2427987">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2428005">=</span>&nbsp;<span class="string" id="2428007">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428013">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2428031">=</span>&nbsp;<span class="string" id="2428033">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428038">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2428056">=</span>&nbsp;<span class="string" id="2428058">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2428064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2428067">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2428149">func</span>&nbsp;<span class="op" id="2428154">(</span><span class="ident" id="2428155">s</span>&nbsp;<span class="op" id="2428157">*</span><span class="ident" id="2428158">ss</span><span class="op" id="2428160">)</span>&nbsp;<span class="ident" id="2428162">getBase</span><span class="op" id="2428169">(</span><span class="ident" id="2428170">verb</span>&nbsp;<span class="builtintype" id="2428175">rune</span><span class="op" id="2428179">)</span>&nbsp;<span class="op" id="2428181">(</span><span class="ident" id="2428182">base</span>&nbsp;<span class="builtintype" id="2428187">int</span><span class="op" id="2428190">,</span>&nbsp;<span class="ident" id="2428192">digits</span>&nbsp;<span class="builtintype" id="2428199">string</span><span class="op" id="2428205">)</span>&nbsp;<span class="op" id="2428207">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428210">s</span><span class="op" id="2428211">.</span><span class="ident" id="2428212">okVerb</span><span class="op" id="2428218">(</span><span class="ident" id="2428219">verb</span><span class="op" id="2428223">,</span>&nbsp;<span class="string" id="2428225">&#34;bdoUxXv&#34;</span><span class="op" id="2428234">,</span>&nbsp;<span class="string" id="2428236">&#34;integer&#34;</span><span class="op" id="2428245">)</span>&nbsp;<span class="comment" id="2428247">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428262">base</span>&nbsp;<span class="op" id="2428267">=</span>&nbsp;<span class="num" id="2428269">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428273">digits</span>&nbsp;<span class="op" id="2428280">=</span>&nbsp;<span class="ident" id="2428282">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428297">switch</span>&nbsp;<span class="ident" id="2428304">verb</span>&nbsp;<span class="op" id="2428309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428312">case</span>&nbsp;<span class="string" id="2428317">&#39;b&#39;</span><span class="op" id="2428320">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428324">base</span>&nbsp;<span class="op" id="2428329">=</span>&nbsp;<span class="num" id="2428331">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428335">digits</span>&nbsp;<span class="op" id="2428342">=</span>&nbsp;<span class="ident" id="2428344">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428358">case</span>&nbsp;<span class="string" id="2428363">&#39;o&#39;</span><span class="op" id="2428366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428370">base</span>&nbsp;<span class="op" id="2428375">=</span>&nbsp;<span class="num" id="2428377">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428381">digits</span>&nbsp;<span class="op" id="2428388">=</span>&nbsp;<span class="ident" id="2428390">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428403">case</span>&nbsp;<span class="string" id="2428408">&#39;x&#39;</span><span class="op" id="2428411">,</span>&nbsp;<span class="string" id="2428413">&#39;X&#39;</span><span class="op" id="2428416">,</span>&nbsp;<span class="string" id="2428418">&#39;U&#39;</span><span class="op" id="2428421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428425">base</span>&nbsp;<span class="op" id="2428430">=</span>&nbsp;<span class="num" id="2428432">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428437">digits</span>&nbsp;<span class="op" id="2428444">=</span>&nbsp;<span class="ident" id="2428446">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2428465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428468">return</span><br>
<span class="lineno">605</span><span class="op" id="2428475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2428478">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2428558">func</span>&nbsp;<span class="op" id="2428563">(</span><span class="ident" id="2428564">s</span>&nbsp;<span class="op" id="2428566">*</span><span class="ident" id="2428567">ss</span><span class="op" id="2428569">)</span>&nbsp;<span class="ident" id="2428571">scanNumber</span><span class="op" id="2428581">(</span><span class="ident" id="2428582">digits</span>&nbsp;<span class="builtintype" id="2428589">string</span><span class="op" id="2428595">,</span>&nbsp;<span class="ident" id="2428597">haveDigits</span>&nbsp;<span class="builtintype" id="2428608">bool</span><span class="op" id="2428612">)</span>&nbsp;<span class="builtintype" id="2428614">string</span>&nbsp;<span class="op" id="2428621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428624">if</span>&nbsp;<span class="op" id="2428627">!</span><span class="ident" id="2428628">haveDigits</span>&nbsp;<span class="op" id="2428639">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428643">s</span><span class="op" id="2428644">.</span><span class="ident" id="2428645">notEOF</span><span class="op" id="2428651">(</span><span class="op" id="2428652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428656">if</span>&nbsp;<span class="op" id="2428659">!</span><span class="ident" id="2428660">s</span><span class="op" id="2428661">.</span><span class="ident" id="2428662">accept</span><span class="op" id="2428668">(</span><span class="ident" id="2428669">digits</span><span class="op" id="2428675">)</span>&nbsp;<span class="op" id="2428677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428682">s</span><span class="op" id="2428683">.</span><span class="ident" id="2428684">errorString</span><span class="op" id="2428695">(</span><span class="string" id="2428696">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2428714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2428718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2428721">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428724">for</span>&nbsp;<span class="ident" id="2428728">s</span><span class="op" id="2428729">.</span><span class="ident" id="2428730">accept</span><span class="op" id="2428736">(</span><span class="ident" id="2428737">digits</span><span class="op" id="2428743">)</span>&nbsp;<span class="op" id="2428745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2428748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428751">return</span>&nbsp;<span class="builtintype" id="2428758">string</span><span class="op" id="2428764">(</span><span class="ident" id="2428765">s</span><span class="op" id="2428766">.</span><span class="ident" id="2428767">buf</span><span class="op" id="2428770">)</span><br>
<span class="lineno"></span><span class="op" id="2428772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2428775">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2428829">func</span>&nbsp;<span class="op" id="2428834">(</span><span class="ident" id="2428835">s</span>&nbsp;<span class="op" id="2428837">*</span><span class="ident" id="2428838">ss</span><span class="op" id="2428840">)</span>&nbsp;<span class="ident" id="2428842">scanRune</span><span class="op" id="2428850">(</span><span class="ident" id="2428851">bitSize</span>&nbsp;<span class="builtintype" id="2428859">int</span><span class="op" id="2428862">)</span>&nbsp;<span class="ident" id="2428864">int64</span>&nbsp;<span class="op" id="2428870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428873">s</span><span class="op" id="2428874">.</span><span class="ident" id="2428875">notEOF</span><span class="op" id="2428881">(</span><span class="op" id="2428882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428885">r</span>&nbsp;<span class="op" id="2428887">:=</span>&nbsp;<span class="ident" id="2428890">int64</span><span class="op" id="2428895">(</span><span class="ident" id="2428896">s</span><span class="op" id="2428897">.</span><span class="ident" id="2428898">getRune</span><span class="op" id="2428905">(</span><span class="op" id="2428906">)</span><span class="op" id="2428907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428910">n</span>&nbsp;<span class="op" id="2428912">:=</span>&nbsp;<span class="builtintype" id="2428915">uint</span><span class="op" id="2428919">(</span><span class="ident" id="2428920">bitSize</span><span class="op" id="2428927">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428930">x</span>&nbsp;<span class="op" id="2428932">:=</span>&nbsp;<span class="op" id="2428935">(</span><span class="ident" id="2428936">r</span>&nbsp;<span class="op" id="2428938">&lt;&lt;</span>&nbsp;<span class="op" id="2428941">(</span><span class="num" id="2428942">64</span>&nbsp;<span class="op" id="2428945">-</span>&nbsp;<span class="ident" id="2428947">n</span><span class="op" id="2428948">)</span><span class="op" id="2428949">)</span>&nbsp;<span class="op" id="2428951">&gt;&gt;</span>&nbsp;<span class="op" id="2428954">(</span><span class="num" id="2428955">64</span>&nbsp;<span class="op" id="2428958">-</span>&nbsp;<span class="ident" id="2428960">n</span><span class="op" id="2428961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2428964">if</span>&nbsp;<span class="ident" id="2428967">x</span>&nbsp;<span class="op" id="2428969">!=</span>&nbsp;<span class="ident" id="2428972">r</span>&nbsp;<span class="op" id="2428974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2428978">s</span><span class="op" id="2428979">.</span><span class="ident" id="2428980">errorString</span><span class="op" id="2428991">(</span><span class="string" id="2428992">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2429023">+</span>&nbsp;<span class="builtintype" id="2429025">string</span><span class="op" id="2429031">(</span><span class="ident" id="2429032">r</span><span class="op" id="2429033">)</span><span class="op" id="2429034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429040">return</span>&nbsp;<span class="ident" id="2429047">r</span><br>
<span class="lineno">630</span><span class="op" id="2429049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2429052">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2429121">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2429190">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2429230">func</span>&nbsp;<span class="op" id="2429235">(</span><span class="ident" id="2429236">s</span>&nbsp;<span class="op" id="2429238">*</span><span class="ident" id="2429239">ss</span><span class="op" id="2429241">)</span>&nbsp;<span class="ident" id="2429243">scanBasePrefix</span><span class="op" id="2429257">(</span><span class="op" id="2429258">)</span>&nbsp;<span class="op" id="2429260">(</span><span class="ident" id="2429261">base</span>&nbsp;<span class="builtintype" id="2429266">int</span><span class="op" id="2429269">,</span>&nbsp;<span class="ident" id="2429271">digits</span>&nbsp;<span class="builtintype" id="2429278">string</span><span class="op" id="2429284">,</span>&nbsp;<span class="ident" id="2429286">found</span>&nbsp;<span class="builtintype" id="2429292">bool</span><span class="op" id="2429296">)</span>&nbsp;<span class="op" id="2429298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429301">if</span>&nbsp;<span class="op" id="2429304">!</span><span class="ident" id="2429305">s</span><span class="op" id="2429306">.</span><span class="ident" id="2429307">peek</span><span class="op" id="2429311">(</span><span class="string" id="2429312">&#34;0&#34;</span><span class="op" id="2429315">)</span>&nbsp;<span class="op" id="2429317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429321">return</span>&nbsp;<span class="num" id="2429328">10</span><span class="op" id="2429330">,</span>&nbsp;<span class="ident" id="2429332">decimalDigits</span><span class="op" id="2429345">,</span>&nbsp;<span class="builtintype" id="2429347">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429357">s</span><span class="op" id="2429358">.</span><span class="ident" id="2429359">accept</span><span class="op" id="2429365">(</span><span class="string" id="2429366">&#34;0&#34;</span><span class="op" id="2429369">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429372">found</span>&nbsp;<span class="op" id="2429378">=</span>&nbsp;<span class="builtintype" id="2429380">true</span>&nbsp;<span class="comment" id="2429385">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2429430">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429464">base</span><span class="op" id="2429468">,</span>&nbsp;<span class="ident" id="2429470">digits</span>&nbsp;<span class="op" id="2429477">=</span>&nbsp;<span class="num" id="2429479">8</span><span class="op" id="2429480">,</span>&nbsp;<span class="ident" id="2429482">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429495">if</span>&nbsp;<span class="ident" id="2429498">s</span><span class="op" id="2429499">.</span><span class="ident" id="2429500">peek</span><span class="op" id="2429504">(</span><span class="string" id="2429505">&#34;xX&#34;</span><span class="op" id="2429509">)</span>&nbsp;<span class="op" id="2429511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429515">s</span><span class="op" id="2429516">.</span><span class="ident" id="2429517">consume</span><span class="op" id="2429524">(</span><span class="string" id="2429525">&#34;xX&#34;</span><span class="op" id="2429529">,</span>&nbsp;<span class="builtintype" id="2429531">false</span><span class="op" id="2429536">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429540">base</span><span class="op" id="2429544">,</span>&nbsp;<span class="ident" id="2429546">digits</span>&nbsp;<span class="op" id="2429553">=</span>&nbsp;<span class="num" id="2429555">16</span><span class="op" id="2429557">,</span>&nbsp;<span class="ident" id="2429559">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429581">return</span><br>
<span class="lineno"></span><span class="op" id="2429588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2429591">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2429659">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2429723">func</span>&nbsp;<span class="op" id="2429728">(</span><span class="ident" id="2429729">s</span>&nbsp;<span class="op" id="2429731">*</span><span class="ident" id="2429732">ss</span><span class="op" id="2429734">)</span>&nbsp;<span class="ident" id="2429736">scanInt</span><span class="op" id="2429743">(</span><span class="ident" id="2429744">verb</span>&nbsp;<span class="builtintype" id="2429749">rune</span><span class="op" id="2429753">,</span>&nbsp;<span class="ident" id="2429755">bitSize</span>&nbsp;<span class="builtintype" id="2429763">int</span><span class="op" id="2429766">)</span>&nbsp;<span class="ident" id="2429768">int64</span>&nbsp;<span class="op" id="2429774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429777">if</span>&nbsp;<span class="ident" id="2429780">verb</span>&nbsp;<span class="op" id="2429785">==</span>&nbsp;<span class="string" id="2429788">&#39;c&#39;</span>&nbsp;<span class="op" id="2429792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429796">return</span>&nbsp;<span class="ident" id="2429803">s</span><span class="op" id="2429804">.</span><span class="ident" id="2429805">scanRune</span><span class="op" id="2429813">(</span><span class="ident" id="2429814">bitSize</span><span class="op" id="2429821">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2429824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429827">s</span><span class="op" id="2429828">.</span><span class="ident" id="2429829">skipSpace</span><span class="op" id="2429838">(</span><span class="builtintype" id="2429839">false</span><span class="op" id="2429844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429847">s</span><span class="op" id="2429848">.</span><span class="ident" id="2429849">notEOF</span><span class="op" id="2429855">(</span><span class="op" id="2429856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429859">base</span><span class="op" id="2429863">,</span>&nbsp;<span class="ident" id="2429865">digits</span>&nbsp;<span class="op" id="2429872">:=</span>&nbsp;<span class="ident" id="2429875">s</span><span class="op" id="2429876">.</span><span class="ident" id="2429877">getBase</span><span class="op" id="2429884">(</span><span class="ident" id="2429885">verb</span><span class="op" id="2429889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429892">haveDigits</span>&nbsp;<span class="op" id="2429903">:=</span>&nbsp;<span class="builtintype" id="2429906">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429913">if</span>&nbsp;<span class="ident" id="2429916">verb</span>&nbsp;<span class="op" id="2429921">==</span>&nbsp;<span class="string" id="2429924">&#39;U&#39;</span>&nbsp;<span class="op" id="2429928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2429932">if</span>&nbsp;<span class="op" id="2429935">!</span><span class="ident" id="2429936">s</span><span class="op" id="2429937">.</span><span class="ident" id="2429938">consume</span><span class="op" id="2429945">(</span><span class="string" id="2429946">&#34;U&#34;</span><span class="op" id="2429949">,</span>&nbsp;<span class="builtintype" id="2429951">false</span><span class="op" id="2429956">)</span>&nbsp;<span class="op" id="2429958">||</span>&nbsp;<span class="op" id="2429961">!</span><span class="ident" id="2429962">s</span><span class="op" id="2429963">.</span><span class="ident" id="2429964">consume</span><span class="op" id="2429971">(</span><span class="string" id="2429972">&#34;+&#34;</span><span class="op" id="2429975">,</span>&nbsp;<span class="builtintype" id="2429977">false</span><span class="op" id="2429982">)</span>&nbsp;<span class="op" id="2429984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2429989">s</span><span class="op" id="2429990">.</span><span class="ident" id="2429991">errorString</span><span class="op" id="2430002">(</span><span class="string" id="2430003">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2430024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430031">}</span>&nbsp;<span class="keyword" id="2430033">else</span>&nbsp;<span class="op" id="2430038">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430042">s</span><span class="op" id="2430043">.</span><span class="ident" id="2430044">accept</span><span class="op" id="2430050">(</span><span class="ident" id="2430051">sign</span><span class="op" id="2430055">)</span>&nbsp;<span class="comment" id="2430057">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430118">if</span>&nbsp;<span class="ident" id="2430121">verb</span>&nbsp;<span class="op" id="2430126">==</span>&nbsp;<span class="string" id="2430129">&#39;v&#39;</span>&nbsp;<span class="op" id="2430133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430138">base</span><span class="op" id="2430142">,</span>&nbsp;<span class="ident" id="2430144">digits</span><span class="op" id="2430150">,</span>&nbsp;<span class="ident" id="2430152">haveDigits</span>&nbsp;<span class="op" id="2430163">=</span>&nbsp;<span class="ident" id="2430165">s</span><span class="op" id="2430166">.</span><span class="ident" id="2430167">scanBasePrefix</span><span class="op" id="2430181">(</span><span class="op" id="2430182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430189">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430192">tok</span>&nbsp;<span class="op" id="2430196">:=</span>&nbsp;<span class="ident" id="2430199">s</span><span class="op" id="2430200">.</span><span class="ident" id="2430201">scanNumber</span><span class="op" id="2430211">(</span><span class="ident" id="2430212">digits</span><span class="op" id="2430218">,</span>&nbsp;<span class="ident" id="2430220">haveDigits</span><span class="op" id="2430230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430233">i</span><span class="op" id="2430234">,</span>&nbsp;<span class="ident" id="2430236">err</span>&nbsp;<span class="op" id="2430240">:=</span>&nbsp;<span class="ident" id="2430243">strconv</span><span class="op" id="2430250">.</span><span class="ident" id="2430251">ParseInt</span><span class="op" id="2430259">(</span><span class="ident" id="2430260">tok</span><span class="op" id="2430263">,</span>&nbsp;<span class="ident" id="2430265">base</span><span class="op" id="2430269">,</span>&nbsp;<span class="num" id="2430271">64</span><span class="op" id="2430273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430276">if</span>&nbsp;<span class="ident" id="2430279">err</span>&nbsp;<span class="op" id="2430283">!=</span>&nbsp;<span class="ident" id="2430286">nil</span>&nbsp;<span class="op" id="2430290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430294">s</span><span class="op" id="2430295">.</span><span class="builtintype" id="2430296">error</span><span class="op" id="2430301">(</span><span class="ident" id="2430302">err</span><span class="op" id="2430305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430308">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430311">n</span>&nbsp;<span class="op" id="2430313">:=</span>&nbsp;<span class="builtintype" id="2430316">uint</span><span class="op" id="2430320">(</span><span class="ident" id="2430321">bitSize</span><span class="op" id="2430328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430331">x</span>&nbsp;<span class="op" id="2430333">:=</span>&nbsp;<span class="op" id="2430336">(</span><span class="ident" id="2430337">i</span>&nbsp;<span class="op" id="2430339">&lt;&lt;</span>&nbsp;<span class="op" id="2430342">(</span><span class="num" id="2430343">64</span>&nbsp;<span class="op" id="2430346">-</span>&nbsp;<span class="ident" id="2430348">n</span><span class="op" id="2430349">)</span><span class="op" id="2430350">)</span>&nbsp;<span class="op" id="2430352">&gt;&gt;</span>&nbsp;<span class="op" id="2430355">(</span><span class="num" id="2430356">64</span>&nbsp;<span class="op" id="2430359">-</span>&nbsp;<span class="ident" id="2430361">n</span><span class="op" id="2430362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430365">if</span>&nbsp;<span class="ident" id="2430368">x</span>&nbsp;<span class="op" id="2430370">!=</span>&nbsp;<span class="ident" id="2430373">i</span>&nbsp;<span class="op" id="2430375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430379">s</span><span class="op" id="2430380">.</span><span class="ident" id="2430381">errorString</span><span class="op" id="2430392">(</span><span class="string" id="2430393">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2430422">+</span>&nbsp;<span class="ident" id="2430424">tok</span><span class="op" id="2430427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430430">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430433">return</span>&nbsp;<span class="ident" id="2430440">i</span><br>
<span class="lineno"></span><span class="op" id="2430442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2430445">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2430511">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2430587">func</span>&nbsp;<span class="op" id="2430592">(</span><span class="ident" id="2430593">s</span>&nbsp;<span class="op" id="2430595">*</span><span class="ident" id="2430596">ss</span><span class="op" id="2430598">)</span>&nbsp;<span class="ident" id="2430600">scanUint</span><span class="op" id="2430608">(</span><span class="ident" id="2430609">verb</span>&nbsp;<span class="builtintype" id="2430614">rune</span><span class="op" id="2430618">,</span>&nbsp;<span class="ident" id="2430620">bitSize</span>&nbsp;<span class="builtintype" id="2430628">int</span><span class="op" id="2430631">)</span>&nbsp;<span class="ident" id="2430633">uint64</span>&nbsp;<span class="op" id="2430640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430643">if</span>&nbsp;<span class="ident" id="2430646">verb</span>&nbsp;<span class="op" id="2430651">==</span>&nbsp;<span class="string" id="2430654">&#39;c&#39;</span>&nbsp;<span class="op" id="2430658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430662">return</span>&nbsp;<span class="ident" id="2430669">uint64</span><span class="op" id="2430675">(</span><span class="ident" id="2430676">s</span><span class="op" id="2430677">.</span><span class="ident" id="2430678">scanRune</span><span class="op" id="2430686">(</span><span class="ident" id="2430687">bitSize</span><span class="op" id="2430694">)</span><span class="op" id="2430695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430701">s</span><span class="op" id="2430702">.</span><span class="ident" id="2430703">skipSpace</span><span class="op" id="2430712">(</span><span class="builtintype" id="2430713">false</span><span class="op" id="2430718">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430721">s</span><span class="op" id="2430722">.</span><span class="ident" id="2430723">notEOF</span><span class="op" id="2430729">(</span><span class="op" id="2430730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430733">base</span><span class="op" id="2430737">,</span>&nbsp;<span class="ident" id="2430739">digits</span>&nbsp;<span class="op" id="2430746">:=</span>&nbsp;<span class="ident" id="2430749">s</span><span class="op" id="2430750">.</span><span class="ident" id="2430751">getBase</span><span class="op" id="2430758">(</span><span class="ident" id="2430759">verb</span><span class="op" id="2430763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430766">haveDigits</span>&nbsp;<span class="op" id="2430777">:=</span>&nbsp;<span class="builtintype" id="2430780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430787">if</span>&nbsp;<span class="ident" id="2430790">verb</span>&nbsp;<span class="op" id="2430795">==</span>&nbsp;<span class="string" id="2430798">&#39;U&#39;</span>&nbsp;<span class="op" id="2430802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2430806">if</span>&nbsp;<span class="op" id="2430809">!</span><span class="ident" id="2430810">s</span><span class="op" id="2430811">.</span><span class="ident" id="2430812">consume</span><span class="op" id="2430819">(</span><span class="string" id="2430820">&#34;U&#34;</span><span class="op" id="2430823">,</span>&nbsp;<span class="builtintype" id="2430825">false</span><span class="op" id="2430830">)</span>&nbsp;<span class="op" id="2430832">||</span>&nbsp;<span class="op" id="2430835">!</span><span class="ident" id="2430836">s</span><span class="op" id="2430837">.</span><span class="ident" id="2430838">consume</span><span class="op" id="2430845">(</span><span class="string" id="2430846">&#34;+&#34;</span><span class="op" id="2430849">,</span>&nbsp;<span class="builtintype" id="2430851">false</span><span class="op" id="2430856">)</span>&nbsp;<span class="op" id="2430858">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430863">s</span><span class="op" id="2430864">.</span><span class="ident" id="2430865">errorString</span><span class="op" id="2430876">(</span><span class="string" id="2430877">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2430898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430905">}</span>&nbsp;<span class="keyword" id="2430907">else</span>&nbsp;<span class="keyword" id="2430912">if</span>&nbsp;<span class="ident" id="2430915">verb</span>&nbsp;<span class="op" id="2430920">==</span>&nbsp;<span class="string" id="2430923">&#39;v&#39;</span>&nbsp;<span class="op" id="2430927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430931">base</span><span class="op" id="2430935">,</span>&nbsp;<span class="ident" id="2430937">digits</span><span class="op" id="2430943">,</span>&nbsp;<span class="ident" id="2430945">haveDigits</span>&nbsp;<span class="op" id="2430956">=</span>&nbsp;<span class="ident" id="2430958">s</span><span class="op" id="2430959">.</span><span class="ident" id="2430960">scanBasePrefix</span><span class="op" id="2430974">(</span><span class="op" id="2430975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2430978">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2430981">tok</span>&nbsp;<span class="op" id="2430985">:=</span>&nbsp;<span class="ident" id="2430988">s</span><span class="op" id="2430989">.</span><span class="ident" id="2430990">scanNumber</span><span class="op" id="2431000">(</span><span class="ident" id="2431001">digits</span><span class="op" id="2431007">,</span>&nbsp;<span class="ident" id="2431009">haveDigits</span><span class="op" id="2431019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431022">i</span><span class="op" id="2431023">,</span>&nbsp;<span class="ident" id="2431025">err</span>&nbsp;<span class="op" id="2431029">:=</span>&nbsp;<span class="ident" id="2431032">strconv</span><span class="op" id="2431039">.</span><span class="ident" id="2431040">ParseUint</span><span class="op" id="2431049">(</span><span class="ident" id="2431050">tok</span><span class="op" id="2431053">,</span>&nbsp;<span class="ident" id="2431055">base</span><span class="op" id="2431059">,</span>&nbsp;<span class="num" id="2431061">64</span><span class="op" id="2431063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431066">if</span>&nbsp;<span class="ident" id="2431069">err</span>&nbsp;<span class="op" id="2431073">!=</span>&nbsp;<span class="ident" id="2431076">nil</span>&nbsp;<span class="op" id="2431080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431084">s</span><span class="op" id="2431085">.</span><span class="builtintype" id="2431086">error</span><span class="op" id="2431091">(</span><span class="ident" id="2431092">err</span><span class="op" id="2431095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431098">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431101">n</span>&nbsp;<span class="op" id="2431103">:=</span>&nbsp;<span class="builtintype" id="2431106">uint</span><span class="op" id="2431110">(</span><span class="ident" id="2431111">bitSize</span><span class="op" id="2431118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431121">x</span>&nbsp;<span class="op" id="2431123">:=</span>&nbsp;<span class="op" id="2431126">(</span><span class="ident" id="2431127">i</span>&nbsp;<span class="op" id="2431129">&lt;&lt;</span>&nbsp;<span class="op" id="2431132">(</span><span class="num" id="2431133">64</span>&nbsp;<span class="op" id="2431136">-</span>&nbsp;<span class="ident" id="2431138">n</span><span class="op" id="2431139">)</span><span class="op" id="2431140">)</span>&nbsp;<span class="op" id="2431142">&gt;&gt;</span>&nbsp;<span class="op" id="2431145">(</span><span class="num" id="2431146">64</span>&nbsp;<span class="op" id="2431149">-</span>&nbsp;<span class="ident" id="2431151">n</span><span class="op" id="2431152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431155">if</span>&nbsp;<span class="ident" id="2431158">x</span>&nbsp;<span class="op" id="2431160">!=</span>&nbsp;<span class="ident" id="2431163">i</span>&nbsp;<span class="op" id="2431165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431169">s</span><span class="op" id="2431170">.</span><span class="ident" id="2431171">errorString</span><span class="op" id="2431182">(</span><span class="string" id="2431183">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2431221">+</span>&nbsp;<span class="ident" id="2431223">tok</span><span class="op" id="2431226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431229">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431232">return</span>&nbsp;<span class="ident" id="2431239">i</span><br>
<span class="lineno"></span><span class="op" id="2431241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2431244">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2431327">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2431418">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2431474">func</span>&nbsp;<span class="op" id="2431479">(</span><span class="ident" id="2431480">s</span>&nbsp;<span class="op" id="2431482">*</span><span class="ident" id="2431483">ss</span><span class="op" id="2431485">)</span>&nbsp;<span class="ident" id="2431487">floatToken</span><span class="op" id="2431497">(</span><span class="op" id="2431498">)</span>&nbsp;<span class="builtintype" id="2431500">string</span>&nbsp;<span class="op" id="2431507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431510">s</span><span class="op" id="2431511">.</span><span class="ident" id="2431512">buf</span>&nbsp;<span class="op" id="2431516">=</span>&nbsp;<span class="ident" id="2431518">s</span><span class="op" id="2431519">.</span><span class="ident" id="2431520">buf</span><span class="op" id="2431523">[</span><span class="op" id="2431524">:</span><span class="num" id="2431525">0</span><span class="op" id="2431526">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431529">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431538">if</span>&nbsp;<span class="ident" id="2431541">s</span><span class="op" id="2431542">.</span><span class="ident" id="2431543">accept</span><span class="op" id="2431549">(</span><span class="string" id="2431550">&#34;nN&#34;</span><span class="op" id="2431554">)</span>&nbsp;<span class="op" id="2431556">&amp;&amp;</span>&nbsp;<span class="ident" id="2431559">s</span><span class="op" id="2431560">.</span><span class="ident" id="2431561">accept</span><span class="op" id="2431567">(</span><span class="string" id="2431568">&#34;aA&#34;</span><span class="op" id="2431572">)</span>&nbsp;<span class="op" id="2431574">&amp;&amp;</span>&nbsp;<span class="ident" id="2431577">s</span><span class="op" id="2431578">.</span><span class="ident" id="2431579">accept</span><span class="op" id="2431585">(</span><span class="string" id="2431586">&#34;nN&#34;</span><span class="op" id="2431590">)</span>&nbsp;<span class="op" id="2431592">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431596">return</span>&nbsp;<span class="builtintype" id="2431603">string</span><span class="op" id="2431609">(</span><span class="ident" id="2431610">s</span><span class="op" id="2431611">.</span><span class="ident" id="2431612">buf</span><span class="op" id="2431615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431621">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431639">s</span><span class="op" id="2431640">.</span><span class="ident" id="2431641">accept</span><span class="op" id="2431647">(</span><span class="ident" id="2431648">sign</span><span class="op" id="2431652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431655">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431664">if</span>&nbsp;<span class="ident" id="2431667">s</span><span class="op" id="2431668">.</span><span class="ident" id="2431669">accept</span><span class="op" id="2431675">(</span><span class="string" id="2431676">&#34;iI&#34;</span><span class="op" id="2431680">)</span>&nbsp;<span class="op" id="2431682">&amp;&amp;</span>&nbsp;<span class="ident" id="2431685">s</span><span class="op" id="2431686">.</span><span class="ident" id="2431687">accept</span><span class="op" id="2431693">(</span><span class="string" id="2431694">&#34;nN&#34;</span><span class="op" id="2431698">)</span>&nbsp;<span class="op" id="2431700">&amp;&amp;</span>&nbsp;<span class="ident" id="2431703">s</span><span class="op" id="2431704">.</span><span class="ident" id="2431705">accept</span><span class="op" id="2431711">(</span><span class="string" id="2431712">&#34;fF&#34;</span><span class="op" id="2431716">)</span>&nbsp;<span class="op" id="2431718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431722">return</span>&nbsp;<span class="builtintype" id="2431729">string</span><span class="op" id="2431735">(</span><span class="ident" id="2431736">s</span><span class="op" id="2431737">.</span><span class="ident" id="2431738">buf</span><span class="op" id="2431741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431747">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431759">for</span>&nbsp;<span class="ident" id="2431763">s</span><span class="op" id="2431764">.</span><span class="ident" id="2431765">accept</span><span class="op" id="2431771">(</span><span class="ident" id="2431772">decimalDigits</span><span class="op" id="2431785">)</span>&nbsp;<span class="op" id="2431787">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431793">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431812">if</span>&nbsp;<span class="ident" id="2431815">s</span><span class="op" id="2431816">.</span><span class="ident" id="2431817">accept</span><span class="op" id="2431823">(</span><span class="ident" id="2431824">period</span><span class="op" id="2431830">)</span>&nbsp;<span class="op" id="2431832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431836">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431851">for</span>&nbsp;<span class="ident" id="2431855">s</span><span class="op" id="2431856">.</span><span class="ident" id="2431857">accept</span><span class="op" id="2431863">(</span><span class="ident" id="2431864">decimalDigits</span><span class="op" id="2431877">)</span>&nbsp;<span class="op" id="2431879">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2431886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431889">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431903">if</span>&nbsp;<span class="ident" id="2431906">s</span><span class="op" id="2431907">.</span><span class="ident" id="2431908">accept</span><span class="op" id="2431914">(</span><span class="ident" id="2431915">exponent</span><span class="op" id="2431923">)</span>&nbsp;<span class="op" id="2431925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431929">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2431948">s</span><span class="op" id="2431949">.</span><span class="ident" id="2431950">accept</span><span class="op" id="2431956">(</span><span class="ident" id="2431957">sign</span><span class="op" id="2431961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2431965">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2431978">for</span>&nbsp;<span class="ident" id="2431982">s</span><span class="op" id="2431983">.</span><span class="ident" id="2431984">accept</span><span class="op" id="2431990">(</span><span class="ident" id="2431991">decimalDigits</span><span class="op" id="2432004">)</span>&nbsp;<span class="op" id="2432006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432013">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432016">return</span>&nbsp;<span class="builtintype" id="2432023">string</span><span class="op" id="2432029">(</span><span class="ident" id="2432030">s</span><span class="op" id="2432031">.</span><span class="ident" id="2432032">buf</span><span class="op" id="2432035">)</span><br>
<span class="lineno"></span><span class="op" id="2432037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2432040">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2432131">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2432222">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2432264">func</span>&nbsp;<span class="op" id="2432269">(</span><span class="ident" id="2432270">s</span>&nbsp;<span class="op" id="2432272">*</span><span class="ident" id="2432273">ss</span><span class="op" id="2432275">)</span>&nbsp;<span class="ident" id="2432277">complexTokens</span><span class="op" id="2432290">(</span><span class="op" id="2432291">)</span>&nbsp;<span class="op" id="2432293">(</span><span class="builtinfunc" id="2432294">real</span><span class="op" id="2432298">,</span>&nbsp;<span class="builtinfunc" id="2432300">imag</span>&nbsp;<span class="builtintype" id="2432305">string</span><span class="op" id="2432311">)</span>&nbsp;<span class="op" id="2432313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2432316">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432357">parens</span>&nbsp;<span class="op" id="2432364">:=</span>&nbsp;<span class="ident" id="2432367">s</span><span class="op" id="2432368">.</span><span class="ident" id="2432369">accept</span><span class="op" id="2432375">(</span><span class="string" id="2432376">&#34;(&#34;</span><span class="op" id="2432379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2432382">real</span>&nbsp;<span class="op" id="2432387">=</span>&nbsp;<span class="ident" id="2432389">s</span><span class="op" id="2432390">.</span><span class="ident" id="2432391">floatToken</span><span class="op" id="2432401">(</span><span class="op" id="2432402">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432405">s</span><span class="op" id="2432406">.</span><span class="ident" id="2432407">buf</span>&nbsp;<span class="op" id="2432411">=</span>&nbsp;<span class="ident" id="2432413">s</span><span class="op" id="2432414">.</span><span class="ident" id="2432415">buf</span><span class="op" id="2432418">[</span><span class="op" id="2432419">:</span><span class="num" id="2432420">0</span><span class="op" id="2432421">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2432424">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432450">if</span>&nbsp;<span class="op" id="2432453">!</span><span class="ident" id="2432454">s</span><span class="op" id="2432455">.</span><span class="ident" id="2432456">accept</span><span class="op" id="2432462">(</span><span class="string" id="2432463">&#34;+-&#34;</span><span class="op" id="2432467">)</span>&nbsp;<span class="op" id="2432469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432473">s</span><span class="op" id="2432474">.</span><span class="builtintype" id="2432475">error</span><span class="op" id="2432480">(</span><span class="ident" id="2432481">complexError</span><span class="op" id="2432493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432496">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2432499">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432525">imagSign</span>&nbsp;<span class="op" id="2432534">:=</span>&nbsp;<span class="builtintype" id="2432537">string</span><span class="op" id="2432543">(</span><span class="ident" id="2432544">s</span><span class="op" id="2432545">.</span><span class="ident" id="2432546">buf</span><span class="op" id="2432549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2432552">imag</span>&nbsp;<span class="op" id="2432557">=</span>&nbsp;<span class="ident" id="2432559">s</span><span class="op" id="2432560">.</span><span class="ident" id="2432561">floatToken</span><span class="op" id="2432571">(</span><span class="op" id="2432572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432575">if</span>&nbsp;<span class="op" id="2432578">!</span><span class="ident" id="2432579">s</span><span class="op" id="2432580">.</span><span class="ident" id="2432581">accept</span><span class="op" id="2432587">(</span><span class="string" id="2432588">&#34;i&#34;</span><span class="op" id="2432591">)</span>&nbsp;<span class="op" id="2432593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432597">s</span><span class="op" id="2432598">.</span><span class="builtintype" id="2432599">error</span><span class="op" id="2432604">(</span><span class="ident" id="2432605">complexError</span><span class="op" id="2432617">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432623">if</span>&nbsp;<span class="ident" id="2432626">parens</span>&nbsp;<span class="op" id="2432633">&amp;&amp;</span>&nbsp;<span class="op" id="2432636">!</span><span class="ident" id="2432637">s</span><span class="op" id="2432638">.</span><span class="ident" id="2432639">accept</span><span class="op" id="2432645">(</span><span class="string" id="2432646">&#34;)&#34;</span><span class="op" id="2432649">)</span>&nbsp;<span class="op" id="2432651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432655">s</span><span class="op" id="2432656">.</span><span class="builtintype" id="2432657">error</span><span class="op" id="2432662">(</span><span class="ident" id="2432663">complexError</span><span class="op" id="2432675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2432678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432681">return</span>&nbsp;<span class="builtinfunc" id="2432688">real</span><span class="op" id="2432692">,</span>&nbsp;<span class="ident" id="2432694">imagSign</span>&nbsp;<span class="op" id="2432703">+</span>&nbsp;<span class="builtinfunc" id="2432705">imag</span><br>
<span class="lineno">770</span><span class="op" id="2432710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2432713">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2432768">func</span>&nbsp;<span class="op" id="2432773">(</span><span class="ident" id="2432774">s</span>&nbsp;<span class="op" id="2432776">*</span><span class="ident" id="2432777">ss</span><span class="op" id="2432779">)</span>&nbsp;<span class="ident" id="2432781">convertFloat</span><span class="op" id="2432793">(</span><span class="ident" id="2432794">str</span>&nbsp;<span class="builtintype" id="2432798">string</span><span class="op" id="2432804">,</span>&nbsp;<span class="ident" id="2432806">n</span>&nbsp;<span class="builtintype" id="2432808">int</span><span class="op" id="2432811">)</span>&nbsp;<span class="builtintype" id="2432813">float64</span>&nbsp;<span class="op" id="2432821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432824">if</span>&nbsp;<span class="ident" id="2432827">p</span>&nbsp;<span class="op" id="2432829">:=</span>&nbsp;<span class="ident" id="2432832">indexRune</span><span class="op" id="2432841">(</span><span class="ident" id="2432842">str</span><span class="op" id="2432845">,</span>&nbsp;<span class="string" id="2432847">&#39;p&#39;</span><span class="op" id="2432850">)</span><span class="op" id="2432851">;</span>&nbsp;<span class="ident" id="2432853">p</span>&nbsp;<span class="op" id="2432855">&gt;=</span>&nbsp;<span class="num" id="2432858">0</span>&nbsp;<span class="op" id="2432860">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2432864">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2432911">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2432946">f</span><span class="op" id="2432947">,</span>&nbsp;<span class="ident" id="2432949">err</span>&nbsp;<span class="op" id="2432953">:=</span>&nbsp;<span class="ident" id="2432956">strconv</span><span class="op" id="2432963">.</span><span class="ident" id="2432964">ParseFloat</span><span class="op" id="2432974">(</span><span class="ident" id="2432975">str</span><span class="op" id="2432978">[</span><span class="op" id="2432979">:</span><span class="ident" id="2432980">p</span><span class="op" id="2432981">]</span><span class="op" id="2432982">,</span>&nbsp;<span class="ident" id="2432984">n</span><span class="op" id="2432985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2432989">if</span>&nbsp;<span class="ident" id="2432992">err</span>&nbsp;<span class="op" id="2432996">!=</span>&nbsp;<span class="ident" id="2432999">nil</span>&nbsp;<span class="op" id="2433003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2433008">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433042">if</span>&nbsp;<span class="ident" id="2433045">e</span><span class="op" id="2433046">,</span>&nbsp;<span class="ident" id="2433048">ok</span>&nbsp;<span class="op" id="2433051">:=</span>&nbsp;<span class="ident" id="2433054">err</span><span class="op" id="2433057">.</span><span class="op" id="2433058">(</span><span class="op" id="2433059">*</span><span class="ident" id="2433060">strconv</span><span class="op" id="2433067">.</span><span class="ident" id="2433068">NumError</span><span class="op" id="2433076">)</span><span class="op" id="2433077">;</span>&nbsp;<span class="ident" id="2433079">ok</span>&nbsp;<span class="op" id="2433082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433088">e</span><span class="op" id="2433089">.</span><span class="ident" id="2433090">Num</span>&nbsp;<span class="op" id="2433094">=</span>&nbsp;<span class="ident" id="2433096">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433108">s</span><span class="op" id="2433109">.</span><span class="builtintype" id="2433110">error</span><span class="op" id="2433115">(</span><span class="ident" id="2433116">err</span><span class="op" id="2433119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433123">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433127">m</span><span class="op" id="2433128">,</span>&nbsp;<span class="ident" id="2433130">err</span>&nbsp;<span class="op" id="2433134">:=</span>&nbsp;<span class="ident" id="2433137">strconv</span><span class="op" id="2433144">.</span><span class="ident" id="2433145">Atoi</span><span class="op" id="2433149">(</span><span class="ident" id="2433150">str</span><span class="op" id="2433153">[</span><span class="ident" id="2433154">p</span><span class="op" id="2433155">+</span><span class="num" id="2433156">1</span><span class="op" id="2433157">:</span><span class="op" id="2433158">]</span><span class="op" id="2433159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433163">if</span>&nbsp;<span class="ident" id="2433166">err</span>&nbsp;<span class="op" id="2433170">!=</span>&nbsp;<span class="ident" id="2433173">nil</span>&nbsp;<span class="op" id="2433177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2433182">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433216">if</span>&nbsp;<span class="ident" id="2433219">e</span><span class="op" id="2433220">,</span>&nbsp;<span class="ident" id="2433222">ok</span>&nbsp;<span class="op" id="2433225">:=</span>&nbsp;<span class="ident" id="2433228">err</span><span class="op" id="2433231">.</span><span class="op" id="2433232">(</span><span class="op" id="2433233">*</span><span class="ident" id="2433234">strconv</span><span class="op" id="2433241">.</span><span class="ident" id="2433242">NumError</span><span class="op" id="2433250">)</span><span class="op" id="2433251">;</span>&nbsp;<span class="ident" id="2433253">ok</span>&nbsp;<span class="op" id="2433256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433262">e</span><span class="op" id="2433263">.</span><span class="ident" id="2433264">Num</span>&nbsp;<span class="op" id="2433268">=</span>&nbsp;<span class="ident" id="2433270">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433282">s</span><span class="op" id="2433283">.</span><span class="builtintype" id="2433284">error</span><span class="op" id="2433289">(</span><span class="ident" id="2433290">err</span><span class="op" id="2433293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433301">return</span>&nbsp;<span class="ident" id="2433308">math</span><span class="op" id="2433312">.</span><span class="ident" id="2433313">Ldexp</span><span class="op" id="2433318">(</span><span class="ident" id="2433319">f</span><span class="op" id="2433320">,</span>&nbsp;<span class="ident" id="2433322">m</span><span class="op" id="2433323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433326">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433329">f</span><span class="op" id="2433330">,</span>&nbsp;<span class="ident" id="2433332">err</span>&nbsp;<span class="op" id="2433336">:=</span>&nbsp;<span class="ident" id="2433339">strconv</span><span class="op" id="2433346">.</span><span class="ident" id="2433347">ParseFloat</span><span class="op" id="2433357">(</span><span class="ident" id="2433358">str</span><span class="op" id="2433361">,</span>&nbsp;<span class="ident" id="2433363">n</span><span class="op" id="2433364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433367">if</span>&nbsp;<span class="ident" id="2433370">err</span>&nbsp;<span class="op" id="2433374">!=</span>&nbsp;<span class="ident" id="2433377">nil</span>&nbsp;<span class="op" id="2433381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433385">s</span><span class="op" id="2433386">.</span><span class="builtintype" id="2433387">error</span><span class="op" id="2433392">(</span><span class="ident" id="2433393">err</span><span class="op" id="2433396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433402">return</span>&nbsp;<span class="ident" id="2433409">f</span><br>
<span class="lineno">800</span><span class="op" id="2433411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2433414">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2433479">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2433551">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2433624">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2433694">func</span>&nbsp;<span class="op" id="2433699">(</span><span class="ident" id="2433700">s</span>&nbsp;<span class="op" id="2433702">*</span><span class="ident" id="2433703">ss</span><span class="op" id="2433705">)</span>&nbsp;<span class="ident" id="2433707">scanComplex</span><span class="op" id="2433718">(</span><span class="ident" id="2433719">verb</span>&nbsp;<span class="builtintype" id="2433724">rune</span><span class="op" id="2433728">,</span>&nbsp;<span class="ident" id="2433730">n</span>&nbsp;<span class="builtintype" id="2433732">int</span><span class="op" id="2433735">)</span>&nbsp;<span class="builtintype" id="2433737">complex128</span>&nbsp;<span class="op" id="2433748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433751">if</span>&nbsp;<span class="op" id="2433754">!</span><span class="ident" id="2433755">s</span><span class="op" id="2433756">.</span><span class="ident" id="2433757">okVerb</span><span class="op" id="2433763">(</span><span class="ident" id="2433764">verb</span><span class="op" id="2433768">,</span>&nbsp;<span class="ident" id="2433770">floatVerbs</span><span class="op" id="2433780">,</span>&nbsp;<span class="string" id="2433782">&#34;complex&#34;</span><span class="op" id="2433791">)</span>&nbsp;<span class="op" id="2433793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433797">return</span>&nbsp;<span class="num" id="2433804">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2433807">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433810">s</span><span class="op" id="2433811">.</span><span class="ident" id="2433812">skipSpace</span><span class="op" id="2433821">(</span><span class="builtintype" id="2433822">false</span><span class="op" id="2433827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433830">s</span><span class="op" id="2433831">.</span><span class="ident" id="2433832">notEOF</span><span class="op" id="2433838">(</span><span class="op" id="2433839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2433842">sreal</span><span class="op" id="2433847">,</span>&nbsp;<span class="ident" id="2433849">simag</span>&nbsp;<span class="op" id="2433855">:=</span>&nbsp;<span class="ident" id="2433858">s</span><span class="op" id="2433859">.</span><span class="ident" id="2433860">complexTokens</span><span class="op" id="2433873">(</span><span class="op" id="2433874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2433877">real</span>&nbsp;<span class="op" id="2433882">:=</span>&nbsp;<span class="ident" id="2433885">s</span><span class="op" id="2433886">.</span><span class="ident" id="2433887">convertFloat</span><span class="op" id="2433899">(</span><span class="ident" id="2433900">sreal</span><span class="op" id="2433905">,</span>&nbsp;<span class="ident" id="2433907">n</span><span class="op" id="2433908">/</span><span class="num" id="2433909">2</span><span class="op" id="2433910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2433913">imag</span>&nbsp;<span class="op" id="2433918">:=</span>&nbsp;<span class="ident" id="2433921">s</span><span class="op" id="2433922">.</span><span class="ident" id="2433923">convertFloat</span><span class="op" id="2433935">(</span><span class="ident" id="2433936">simag</span><span class="op" id="2433941">,</span>&nbsp;<span class="ident" id="2433943">n</span><span class="op" id="2433944">/</span><span class="num" id="2433945">2</span><span class="op" id="2433946">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2433949">return</span>&nbsp;<span class="builtinfunc" id="2433956">complex</span><span class="op" id="2433963">(</span><span class="builtinfunc" id="2433964">real</span><span class="op" id="2433968">,</span>&nbsp;<span class="builtinfunc" id="2433970">imag</span><span class="op" id="2433974">)</span><br>
<span class="lineno"></span><span class="op" id="2433976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2433979">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2434057">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2434111">func</span>&nbsp;<span class="op" id="2434116">(</span><span class="ident" id="2434117">s</span>&nbsp;<span class="op" id="2434119">*</span><span class="ident" id="2434120">ss</span><span class="op" id="2434122">)</span>&nbsp;<span class="ident" id="2434124">convertString</span><span class="op" id="2434137">(</span><span class="ident" id="2434138">verb</span>&nbsp;<span class="builtintype" id="2434143">rune</span><span class="op" id="2434147">)</span>&nbsp;<span class="op" id="2434149">(</span><span class="ident" id="2434150">str</span>&nbsp;<span class="builtintype" id="2434154">string</span><span class="op" id="2434160">)</span>&nbsp;<span class="op" id="2434162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434165">if</span>&nbsp;<span class="op" id="2434168">!</span><span class="ident" id="2434169">s</span><span class="op" id="2434170">.</span><span class="ident" id="2434171">okVerb</span><span class="op" id="2434177">(</span><span class="ident" id="2434178">verb</span><span class="op" id="2434182">,</span>&nbsp;<span class="string" id="2434184">&#34;svqx&#34;</span><span class="op" id="2434190">,</span>&nbsp;<span class="string" id="2434192">&#34;string&#34;</span><span class="op" id="2434200">)</span>&nbsp;<span class="op" id="2434202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434206">return</span>&nbsp;<span class="string" id="2434213">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434220">s</span><span class="op" id="2434221">.</span><span class="ident" id="2434222">skipSpace</span><span class="op" id="2434231">(</span><span class="builtintype" id="2434232">false</span><span class="op" id="2434237">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434240">s</span><span class="op" id="2434241">.</span><span class="ident" id="2434242">notEOF</span><span class="op" id="2434248">(</span><span class="op" id="2434249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434252">switch</span>&nbsp;<span class="ident" id="2434259">verb</span>&nbsp;<span class="op" id="2434264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434267">case</span>&nbsp;<span class="string" id="2434272">&#39;q&#39;</span><span class="op" id="2434275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434279">str</span>&nbsp;<span class="op" id="2434283">=</span>&nbsp;<span class="ident" id="2434285">s</span><span class="op" id="2434286">.</span><span class="ident" id="2434287">quotedString</span><span class="op" id="2434299">(</span><span class="op" id="2434300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434303">case</span>&nbsp;<span class="string" id="2434308">&#39;x&#39;</span><span class="op" id="2434311">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434315">str</span>&nbsp;<span class="op" id="2434319">=</span>&nbsp;<span class="ident" id="2434321">s</span><span class="op" id="2434322">.</span><span class="ident" id="2434323">hexString</span><span class="op" id="2434332">(</span><span class="op" id="2434333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434336">default</span><span class="op" id="2434343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434347">str</span>&nbsp;<span class="op" id="2434351">=</span>&nbsp;<span class="builtintype" id="2434353">string</span><span class="op" id="2434359">(</span><span class="ident" id="2434360">s</span><span class="op" id="2434361">.</span><span class="ident" id="2434362">token</span><span class="op" id="2434367">(</span><span class="builtintype" id="2434368">true</span><span class="op" id="2434372">,</span>&nbsp;<span class="ident" id="2434374">notSpace</span><span class="op" id="2434382">)</span><span class="op" id="2434383">)</span>&nbsp;<span class="comment" id="2434385">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434428">return</span><br>
<span class="lineno">835</span><span class="op" id="2434435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2434438">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2434538">func</span>&nbsp;<span class="op" id="2434543">(</span><span class="ident" id="2434544">s</span>&nbsp;<span class="op" id="2434546">*</span><span class="ident" id="2434547">ss</span><span class="op" id="2434549">)</span>&nbsp;<span class="ident" id="2434551">quotedString</span><span class="op" id="2434563">(</span><span class="op" id="2434564">)</span>&nbsp;<span class="builtintype" id="2434566">string</span>&nbsp;<span class="op" id="2434573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434576">s</span><span class="op" id="2434577">.</span><span class="ident" id="2434578">notEOF</span><span class="op" id="2434584">(</span><span class="op" id="2434585">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434588">quote</span>&nbsp;<span class="op" id="2434594">:=</span>&nbsp;<span class="ident" id="2434597">s</span><span class="op" id="2434598">.</span><span class="ident" id="2434599">getRune</span><span class="op" id="2434606">(</span><span class="op" id="2434607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434610">switch</span>&nbsp;<span class="ident" id="2434617">quote</span>&nbsp;<span class="op" id="2434623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434626">case</span>&nbsp;<span class="string" id="2434631">&#39;`&#39;</span><span class="op" id="2434634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2434638">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434695">for</span>&nbsp;<span class="op" id="2434699">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434704">r</span>&nbsp;<span class="op" id="2434706">:=</span>&nbsp;<span class="ident" id="2434709">s</span><span class="op" id="2434710">.</span><span class="ident" id="2434711">mustReadRune</span><span class="op" id="2434723">(</span><span class="op" id="2434724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434729">if</span>&nbsp;<span class="ident" id="2434732">r</span>&nbsp;<span class="op" id="2434734">==</span>&nbsp;<span class="ident" id="2434737">quote</span>&nbsp;<span class="op" id="2434743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434749">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434763">s</span><span class="op" id="2434764">.</span><span class="ident" id="2434765">buf</span><span class="op" id="2434768">.</span><span class="ident" id="2434769">WriteRune</span><span class="op" id="2434778">(</span><span class="ident" id="2434779">r</span><span class="op" id="2434780">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2434784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434788">return</span>&nbsp;<span class="builtintype" id="2434795">string</span><span class="op" id="2434801">(</span><span class="ident" id="2434802">s</span><span class="op" id="2434803">.</span><span class="ident" id="2434804">buf</span><span class="op" id="2434807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434810">case</span>&nbsp;<span class="string" id="2434815">&#39;&#34;&#39;</span><span class="op" id="2434818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2434822">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434911">s</span><span class="op" id="2434912">.</span><span class="ident" id="2434913">buf</span><span class="op" id="2434916">.</span><span class="ident" id="2434917">WriteRune</span><span class="op" id="2434926">(</span><span class="ident" id="2434927">quote</span><span class="op" id="2434932">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434936">for</span>&nbsp;<span class="op" id="2434940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434945">r</span>&nbsp;<span class="op" id="2434947">:=</span>&nbsp;<span class="ident" id="2434950">s</span><span class="op" id="2434951">.</span><span class="ident" id="2434952">mustReadRune</span><span class="op" id="2434964">(</span><span class="op" id="2434965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2434970">s</span><span class="op" id="2434971">.</span><span class="ident" id="2434972">buf</span><span class="op" id="2434975">.</span><span class="ident" id="2434976">WriteRune</span><span class="op" id="2434985">(</span><span class="ident" id="2434986">r</span><span class="op" id="2434987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2434992">if</span>&nbsp;<span class="ident" id="2434995">r</span>&nbsp;<span class="op" id="2434997">==</span>&nbsp;<span class="string" id="2435000">&#39;\\&#39;</span>&nbsp;<span class="op" id="2435005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2435011">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2435086">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2435158">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435235">s</span><span class="op" id="2435236">.</span><span class="ident" id="2435237">buf</span><span class="op" id="2435240">.</span><span class="ident" id="2435241">WriteRune</span><span class="op" id="2435250">(</span><span class="ident" id="2435251">s</span><span class="op" id="2435252">.</span><span class="ident" id="2435253">mustReadRune</span><span class="op" id="2435265">(</span><span class="op" id="2435266">)</span><span class="op" id="2435267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435272">}</span>&nbsp;<span class="keyword" id="2435274">else</span>&nbsp;<span class="keyword" id="2435279">if</span>&nbsp;<span class="ident" id="2435282">r</span>&nbsp;<span class="op" id="2435284">==</span>&nbsp;<span class="string" id="2435287">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2435291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435297">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435314">result</span><span class="op" id="2435320">,</span>&nbsp;<span class="ident" id="2435322">err</span>&nbsp;<span class="op" id="2435326">:=</span>&nbsp;<span class="ident" id="2435329">strconv</span><span class="op" id="2435336">.</span><span class="ident" id="2435337">Unquote</span><span class="op" id="2435344">(</span><span class="builtintype" id="2435345">string</span><span class="op" id="2435351">(</span><span class="ident" id="2435352">s</span><span class="op" id="2435353">.</span><span class="ident" id="2435354">buf</span><span class="op" id="2435357">)</span><span class="op" id="2435358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435362">if</span>&nbsp;<span class="ident" id="2435365">err</span>&nbsp;<span class="op" id="2435369">!=</span>&nbsp;<span class="ident" id="2435372">nil</span>&nbsp;<span class="op" id="2435376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435381">s</span><span class="op" id="2435382">.</span><span class="builtintype" id="2435383">error</span><span class="op" id="2435388">(</span><span class="ident" id="2435389">err</span><span class="op" id="2435392">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435400">return</span>&nbsp;<span class="ident" id="2435407">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435415">default</span><span class="op" id="2435422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435426">s</span><span class="op" id="2435427">.</span><span class="ident" id="2435428">errorString</span><span class="op" id="2435439">(</span><span class="string" id="2435440">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2435464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435467">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435470">return</span>&nbsp;<span class="string" id="2435477">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2435480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2435483">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2435538">func</span>&nbsp;<span class="op" id="2435543">(</span><span class="ident" id="2435544">s</span>&nbsp;<span class="op" id="2435546">*</span><span class="ident" id="2435547">ss</span><span class="op" id="2435549">)</span>&nbsp;<span class="ident" id="2435551">hexDigit</span><span class="op" id="2435559">(</span><span class="ident" id="2435560">d</span>&nbsp;<span class="builtintype" id="2435562">rune</span><span class="op" id="2435566">)</span>&nbsp;<span class="builtintype" id="2435568">int</span>&nbsp;<span class="op" id="2435572">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435575">digit</span>&nbsp;<span class="op" id="2435581">:=</span>&nbsp;<span class="builtintype" id="2435584">int</span><span class="op" id="2435587">(</span><span class="ident" id="2435588">d</span><span class="op" id="2435589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435592">switch</span>&nbsp;<span class="ident" id="2435599">digit</span>&nbsp;<span class="op" id="2435605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435608">case</span>&nbsp;<span class="string" id="2435613">&#39;0&#39;</span><span class="op" id="2435616">,</span>&nbsp;<span class="string" id="2435618">&#39;1&#39;</span><span class="op" id="2435621">,</span>&nbsp;<span class="string" id="2435623">&#39;2&#39;</span><span class="op" id="2435626">,</span>&nbsp;<span class="string" id="2435628">&#39;3&#39;</span><span class="op" id="2435631">,</span>&nbsp;<span class="string" id="2435633">&#39;4&#39;</span><span class="op" id="2435636">,</span>&nbsp;<span class="string" id="2435638">&#39;5&#39;</span><span class="op" id="2435641">,</span>&nbsp;<span class="string" id="2435643">&#39;6&#39;</span><span class="op" id="2435646">,</span>&nbsp;<span class="string" id="2435648">&#39;7&#39;</span><span class="op" id="2435651">,</span>&nbsp;<span class="string" id="2435653">&#39;8&#39;</span><span class="op" id="2435656">,</span>&nbsp;<span class="string" id="2435658">&#39;9&#39;</span><span class="op" id="2435661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435665">return</span>&nbsp;<span class="ident" id="2435672">digit</span>&nbsp;<span class="op" id="2435678">-</span>&nbsp;<span class="string" id="2435680">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435685">case</span>&nbsp;<span class="string" id="2435690">&#39;a&#39;</span><span class="op" id="2435693">,</span>&nbsp;<span class="string" id="2435695">&#39;b&#39;</span><span class="op" id="2435698">,</span>&nbsp;<span class="string" id="2435700">&#39;c&#39;</span><span class="op" id="2435703">,</span>&nbsp;<span class="string" id="2435705">&#39;d&#39;</span><span class="op" id="2435708">,</span>&nbsp;<span class="string" id="2435710">&#39;e&#39;</span><span class="op" id="2435713">,</span>&nbsp;<span class="string" id="2435715">&#39;f&#39;</span><span class="op" id="2435718">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435722">return</span>&nbsp;<span class="num" id="2435729">10</span>&nbsp;<span class="op" id="2435732">+</span>&nbsp;<span class="ident" id="2435734">digit</span>&nbsp;<span class="op" id="2435740">-</span>&nbsp;<span class="string" id="2435742">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435747">case</span>&nbsp;<span class="string" id="2435752">&#39;A&#39;</span><span class="op" id="2435755">,</span>&nbsp;<span class="string" id="2435757">&#39;B&#39;</span><span class="op" id="2435760">,</span>&nbsp;<span class="string" id="2435762">&#39;C&#39;</span><span class="op" id="2435765">,</span>&nbsp;<span class="string" id="2435767">&#39;D&#39;</span><span class="op" id="2435770">,</span>&nbsp;<span class="string" id="2435772">&#39;E&#39;</span><span class="op" id="2435775">,</span>&nbsp;<span class="string" id="2435777">&#39;F&#39;</span><span class="op" id="2435780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435784">return</span>&nbsp;<span class="num" id="2435791">10</span>&nbsp;<span class="op" id="2435794">+</span>&nbsp;<span class="ident" id="2435796">digit</span>&nbsp;<span class="op" id="2435802">-</span>&nbsp;<span class="string" id="2435804">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2435809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2435812">s</span><span class="op" id="2435813">.</span><span class="ident" id="2435814">errorString</span><span class="op" id="2435825">(</span><span class="string" id="2435826">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2435845">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2435848">return</span>&nbsp;<span class="num" id="2435855">0</span><br>
<span class="lineno"></span><span class="op" id="2435857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2435860">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2435937">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2436019">func</span>&nbsp;<span class="op" id="2436024">(</span><span class="ident" id="2436025">s</span>&nbsp;<span class="op" id="2436027">*</span><span class="ident" id="2436028">ss</span><span class="op" id="2436030">)</span>&nbsp;<span class="ident" id="2436032">hexByte</span><span class="op" id="2436039">(</span><span class="op" id="2436040">)</span>&nbsp;<span class="op" id="2436042">(</span><span class="ident" id="2436043">b</span>&nbsp;<span class="builtintype" id="2436045">byte</span><span class="op" id="2436049">,</span>&nbsp;<span class="ident" id="2436051">ok</span>&nbsp;<span class="builtintype" id="2436054">bool</span><span class="op" id="2436058">)</span>&nbsp;<span class="op" id="2436060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436063">rune1</span>&nbsp;<span class="op" id="2436069">:=</span>&nbsp;<span class="ident" id="2436072">s</span><span class="op" id="2436073">.</span><span class="ident" id="2436074">getRune</span><span class="op" id="2436081">(</span><span class="op" id="2436082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436085">if</span>&nbsp;<span class="ident" id="2436088">rune1</span>&nbsp;<span class="op" id="2436094">==</span>&nbsp;<span class="ident" id="2436097">eof</span>&nbsp;<span class="op" id="2436101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436113">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436116">if</span>&nbsp;<span class="ident" id="2436119">isSpace</span><span class="op" id="2436126">(</span><span class="ident" id="2436127">rune1</span><span class="op" id="2436132">)</span>&nbsp;<span class="op" id="2436134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436138">s</span><span class="op" id="2436139">.</span><span class="ident" id="2436140">UnreadRune</span><span class="op" id="2436150">(</span><span class="op" id="2436151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436155">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436166">rune2</span>&nbsp;<span class="op" id="2436172">:=</span>&nbsp;<span class="ident" id="2436175">s</span><span class="op" id="2436176">.</span><span class="ident" id="2436177">mustReadRune</span><span class="op" id="2436189">(</span><span class="op" id="2436190">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436193">return</span>&nbsp;<span class="builtintype" id="2436200">byte</span><span class="op" id="2436204">(</span><span class="ident" id="2436205">s</span><span class="op" id="2436206">.</span><span class="ident" id="2436207">hexDigit</span><span class="op" id="2436215">(</span><span class="ident" id="2436216">rune1</span><span class="op" id="2436221">)</span><span class="op" id="2436222">&lt;&lt;</span><span class="num" id="2436224">4</span>&nbsp;<span class="op" id="2436226">|</span>&nbsp;<span class="ident" id="2436228">s</span><span class="op" id="2436229">.</span><span class="ident" id="2436230">hexDigit</span><span class="op" id="2436238">(</span><span class="ident" id="2436239">rune2</span><span class="op" id="2436244">)</span><span class="op" id="2436245">)</span><span class="op" id="2436246">,</span>&nbsp;<span class="builtintype" id="2436248">true</span><br>
<span class="lineno"></span><span class="op" id="2436253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2436256">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2436321">func</span>&nbsp;<span class="op" id="2436326">(</span><span class="ident" id="2436327">s</span>&nbsp;<span class="op" id="2436329">*</span><span class="ident" id="2436330">ss</span><span class="op" id="2436332">)</span>&nbsp;<span class="ident" id="2436334">hexString</span><span class="op" id="2436343">(</span><span class="op" id="2436344">)</span>&nbsp;<span class="builtintype" id="2436346">string</span>&nbsp;<span class="op" id="2436353">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436356">s</span><span class="op" id="2436357">.</span><span class="ident" id="2436358">notEOF</span><span class="op" id="2436364">(</span><span class="op" id="2436365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436368">for</span>&nbsp;<span class="op" id="2436372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436376">b</span><span class="op" id="2436377">,</span>&nbsp;<span class="ident" id="2436379">ok</span>&nbsp;<span class="op" id="2436382">:=</span>&nbsp;<span class="ident" id="2436385">s</span><span class="op" id="2436386">.</span><span class="ident" id="2436387">hexByte</span><span class="op" id="2436394">(</span><span class="op" id="2436395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436399">if</span>&nbsp;<span class="op" id="2436402">!</span><span class="ident" id="2436403">ok</span>&nbsp;<span class="op" id="2436406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436411">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436423">s</span><span class="op" id="2436424">.</span><span class="ident" id="2436425">buf</span><span class="op" id="2436428">.</span><span class="ident" id="2436429">WriteByte</span><span class="op" id="2436438">(</span><span class="ident" id="2436439">b</span><span class="op" id="2436440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436446">if</span>&nbsp;<span class="builtinfunc" id="2436449">len</span><span class="op" id="2436452">(</span><span class="ident" id="2436453">s</span><span class="op" id="2436454">.</span><span class="ident" id="2436455">buf</span><span class="op" id="2436458">)</span>&nbsp;<span class="op" id="2436460">==</span>&nbsp;<span class="num" id="2436463">0</span>&nbsp;<span class="op" id="2436465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436469">s</span><span class="op" id="2436470">.</span><span class="ident" id="2436471">errorString</span><span class="op" id="2436482">(</span><span class="string" id="2436483">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2436510">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436514">return</span>&nbsp;<span class="string" id="2436521">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436528">return</span>&nbsp;<span class="builtintype" id="2436535">string</span><span class="op" id="2436541">(</span><span class="ident" id="2436542">s</span><span class="op" id="2436543">.</span><span class="ident" id="2436544">buf</span><span class="op" id="2436547">)</span><br>
<span class="lineno"></span><span class="op" id="2436549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2436552">const</span>&nbsp;<span class="ident" id="2436558">floatVerbs</span>&nbsp;<span class="op" id="2436569">=</span>&nbsp;<span class="string" id="2436571">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2436583">const</span>&nbsp;<span class="ident" id="2436589">hugeWid</span>&nbsp;<span class="op" id="2436597">=</span>&nbsp;<span class="num" id="2436599">1</span>&nbsp;<span class="op" id="2436601">&lt;&lt;</span>&nbsp;<span class="num" id="2436604">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2436608">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2436693">func</span>&nbsp;<span class="op" id="2436698">(</span><span class="ident" id="2436699">s</span>&nbsp;<span class="op" id="2436701">*</span><span class="ident" id="2436702">ss</span><span class="op" id="2436704">)</span>&nbsp;<span class="ident" id="2436706">scanOne</span><span class="op" id="2436713">(</span><span class="ident" id="2436714">verb</span>&nbsp;<span class="builtintype" id="2436719">rune</span><span class="op" id="2436723">,</span>&nbsp;<span class="ident" id="2436725">arg</span>&nbsp;<span class="keyword" id="2436729">interface</span><span class="op" id="2436738">{</span><span class="op" id="2436739">}</span><span class="op" id="2436740">)</span>&nbsp;<span class="op" id="2436742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436745">s</span><span class="op" id="2436746">.</span><span class="ident" id="2436747">buf</span>&nbsp;<span class="op" id="2436751">=</span>&nbsp;<span class="ident" id="2436753">s</span><span class="op" id="2436754">.</span><span class="ident" id="2436755">buf</span><span class="op" id="2436758">[</span><span class="op" id="2436759">:</span><span class="num" id="2436760">0</span><span class="op" id="2436761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436764">var</span>&nbsp;<span class="ident" id="2436768">err</span>&nbsp;<span class="builtintype" id="2436772">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2436779">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436835">if</span>&nbsp;<span class="ident" id="2436838">v</span><span class="op" id="2436839">,</span>&nbsp;<span class="ident" id="2436841">ok</span>&nbsp;<span class="op" id="2436844">:=</span>&nbsp;<span class="ident" id="2436847">arg</span><span class="op" id="2436850">.</span><span class="op" id="2436851">(</span><span class="ident" id="2436852">Scanner</span><span class="op" id="2436859">)</span><span class="op" id="2436860">;</span>&nbsp;<span class="ident" id="2436862">ok</span>&nbsp;<span class="op" id="2436865">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436869">err</span>&nbsp;<span class="op" id="2436873">=</span>&nbsp;<span class="ident" id="2436875">v</span><span class="op" id="2436876">.</span><span class="ident" id="2436877">Scan</span><span class="op" id="2436881">(</span><span class="ident" id="2436882">s</span><span class="op" id="2436883">,</span>&nbsp;<span class="ident" id="2436885">verb</span><span class="op" id="2436889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436893">if</span>&nbsp;<span class="ident" id="2436896">err</span>&nbsp;<span class="op" id="2436900">!=</span>&nbsp;<span class="ident" id="2436903">nil</span>&nbsp;<span class="op" id="2436907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436912">if</span>&nbsp;<span class="ident" id="2436915">err</span>&nbsp;<span class="op" id="2436919">==</span>&nbsp;<span class="ident" id="2436922">io</span><span class="op" id="2436924">.</span><span class="ident" id="2436925">EOF</span>&nbsp;<span class="op" id="2436929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436935">err</span>&nbsp;<span class="op" id="2436939">=</span>&nbsp;<span class="ident" id="2436941">io</span><span class="op" id="2436943">.</span><span class="ident" id="2436944">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436964">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2436969">s</span><span class="op" id="2436970">.</span><span class="builtintype" id="2436971">error</span><span class="op" id="2436976">(</span><span class="ident" id="2436977">err</span><span class="op" id="2436980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2436988">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2436996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437000">switch</span>&nbsp;<span class="ident" id="2437007">v</span>&nbsp;<span class="op" id="2437009">:=</span>&nbsp;<span class="ident" id="2437012">arg</span><span class="op" id="2437015">.</span><span class="op" id="2437016">(</span><span class="keyword" id="2437017">type</span><span class="op" id="2437021">)</span>&nbsp;<span class="op" id="2437023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437026">case</span>&nbsp;<span class="op" id="2437031">*</span><span class="builtintype" id="2437032">bool</span><span class="op" id="2437036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437040">*</span><span class="ident" id="2437041">v</span>&nbsp;<span class="op" id="2437043">=</span>&nbsp;<span class="ident" id="2437045">s</span><span class="op" id="2437046">.</span><span class="ident" id="2437047">scanBool</span><span class="op" id="2437055">(</span><span class="ident" id="2437056">verb</span><span class="op" id="2437060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437063">case</span>&nbsp;<span class="op" id="2437068">*</span><span class="builtintype" id="2437069">complex64</span><span class="op" id="2437078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437082">*</span><span class="ident" id="2437083">v</span>&nbsp;<span class="op" id="2437085">=</span>&nbsp;<span class="builtintype" id="2437087">complex64</span><span class="op" id="2437096">(</span><span class="ident" id="2437097">s</span><span class="op" id="2437098">.</span><span class="ident" id="2437099">scanComplex</span><span class="op" id="2437110">(</span><span class="ident" id="2437111">verb</span><span class="op" id="2437115">,</span>&nbsp;<span class="num" id="2437117">64</span><span class="op" id="2437119">)</span><span class="op" id="2437120">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437123">case</span>&nbsp;<span class="op" id="2437128">*</span><span class="builtintype" id="2437129">complex128</span><span class="op" id="2437139">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437143">*</span><span class="ident" id="2437144">v</span>&nbsp;<span class="op" id="2437146">=</span>&nbsp;<span class="ident" id="2437148">s</span><span class="op" id="2437149">.</span><span class="ident" id="2437150">scanComplex</span><span class="op" id="2437161">(</span><span class="ident" id="2437162">verb</span><span class="op" id="2437166">,</span>&nbsp;<span class="num" id="2437168">128</span><span class="op" id="2437171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437174">case</span>&nbsp;<span class="op" id="2437179">*</span><span class="builtintype" id="2437180">int</span><span class="op" id="2437183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437187">*</span><span class="ident" id="2437188">v</span>&nbsp;<span class="op" id="2437190">=</span>&nbsp;<span class="builtintype" id="2437192">int</span><span class="op" id="2437195">(</span><span class="ident" id="2437196">s</span><span class="op" id="2437197">.</span><span class="ident" id="2437198">scanInt</span><span class="op" id="2437205">(</span><span class="ident" id="2437206">verb</span><span class="op" id="2437210">,</span>&nbsp;<span class="ident" id="2437212">intBits</span><span class="op" id="2437219">)</span><span class="op" id="2437220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437223">case</span>&nbsp;<span class="op" id="2437228">*</span><span class="builtintype" id="2437229">int8</span><span class="op" id="2437233">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437237">*</span><span class="ident" id="2437238">v</span>&nbsp;<span class="op" id="2437240">=</span>&nbsp;<span class="builtintype" id="2437242">int8</span><span class="op" id="2437246">(</span><span class="ident" id="2437247">s</span><span class="op" id="2437248">.</span><span class="ident" id="2437249">scanInt</span><span class="op" id="2437256">(</span><span class="ident" id="2437257">verb</span><span class="op" id="2437261">,</span>&nbsp;<span class="num" id="2437263">8</span><span class="op" id="2437264">)</span><span class="op" id="2437265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437268">case</span>&nbsp;<span class="op" id="2437273">*</span><span class="builtintype" id="2437274">int16</span><span class="op" id="2437279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437283">*</span><span class="ident" id="2437284">v</span>&nbsp;<span class="op" id="2437286">=</span>&nbsp;<span class="builtintype" id="2437288">int16</span><span class="op" id="2437293">(</span><span class="ident" id="2437294">s</span><span class="op" id="2437295">.</span><span class="ident" id="2437296">scanInt</span><span class="op" id="2437303">(</span><span class="ident" id="2437304">verb</span><span class="op" id="2437308">,</span>&nbsp;<span class="num" id="2437310">16</span><span class="op" id="2437312">)</span><span class="op" id="2437313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437316">case</span>&nbsp;<span class="op" id="2437321">*</span><span class="builtintype" id="2437322">int32</span><span class="op" id="2437327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437331">*</span><span class="ident" id="2437332">v</span>&nbsp;<span class="op" id="2437334">=</span>&nbsp;<span class="builtintype" id="2437336">int32</span><span class="op" id="2437341">(</span><span class="ident" id="2437342">s</span><span class="op" id="2437343">.</span><span class="ident" id="2437344">scanInt</span><span class="op" id="2437351">(</span><span class="ident" id="2437352">verb</span><span class="op" id="2437356">,</span>&nbsp;<span class="num" id="2437358">32</span><span class="op" id="2437360">)</span><span class="op" id="2437361">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437364">case</span>&nbsp;<span class="op" id="2437369">*</span><span class="ident" id="2437370">int64</span><span class="op" id="2437375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437379">*</span><span class="ident" id="2437380">v</span>&nbsp;<span class="op" id="2437382">=</span>&nbsp;<span class="ident" id="2437384">s</span><span class="op" id="2437385">.</span><span class="ident" id="2437386">scanInt</span><span class="op" id="2437393">(</span><span class="ident" id="2437394">verb</span><span class="op" id="2437398">,</span>&nbsp;<span class="num" id="2437400">64</span><span class="op" id="2437402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437405">case</span>&nbsp;<span class="op" id="2437410">*</span><span class="builtintype" id="2437411">uint</span><span class="op" id="2437415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437419">*</span><span class="ident" id="2437420">v</span>&nbsp;<span class="op" id="2437422">=</span>&nbsp;<span class="builtintype" id="2437424">uint</span><span class="op" id="2437428">(</span><span class="ident" id="2437429">s</span><span class="op" id="2437430">.</span><span class="ident" id="2437431">scanUint</span><span class="op" id="2437439">(</span><span class="ident" id="2437440">verb</span><span class="op" id="2437444">,</span>&nbsp;<span class="ident" id="2437446">intBits</span><span class="op" id="2437453">)</span><span class="op" id="2437454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437457">case</span>&nbsp;<span class="op" id="2437462">*</span><span class="builtintype" id="2437463">uint8</span><span class="op" id="2437468">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437472">*</span><span class="ident" id="2437473">v</span>&nbsp;<span class="op" id="2437475">=</span>&nbsp;<span class="builtintype" id="2437477">uint8</span><span class="op" id="2437482">(</span><span class="ident" id="2437483">s</span><span class="op" id="2437484">.</span><span class="ident" id="2437485">scanUint</span><span class="op" id="2437493">(</span><span class="ident" id="2437494">verb</span><span class="op" id="2437498">,</span>&nbsp;<span class="num" id="2437500">8</span><span class="op" id="2437501">)</span><span class="op" id="2437502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437505">case</span>&nbsp;<span class="op" id="2437510">*</span><span class="builtintype" id="2437511">uint16</span><span class="op" id="2437517">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437521">*</span><span class="ident" id="2437522">v</span>&nbsp;<span class="op" id="2437524">=</span>&nbsp;<span class="builtintype" id="2437526">uint16</span><span class="op" id="2437532">(</span><span class="ident" id="2437533">s</span><span class="op" id="2437534">.</span><span class="ident" id="2437535">scanUint</span><span class="op" id="2437543">(</span><span class="ident" id="2437544">verb</span><span class="op" id="2437548">,</span>&nbsp;<span class="num" id="2437550">16</span><span class="op" id="2437552">)</span><span class="op" id="2437553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437556">case</span>&nbsp;<span class="op" id="2437561">*</span><span class="builtintype" id="2437562">uint32</span><span class="op" id="2437568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437572">*</span><span class="ident" id="2437573">v</span>&nbsp;<span class="op" id="2437575">=</span>&nbsp;<span class="builtintype" id="2437577">uint32</span><span class="op" id="2437583">(</span><span class="ident" id="2437584">s</span><span class="op" id="2437585">.</span><span class="ident" id="2437586">scanUint</span><span class="op" id="2437594">(</span><span class="ident" id="2437595">verb</span><span class="op" id="2437599">,</span>&nbsp;<span class="num" id="2437601">32</span><span class="op" id="2437603">)</span><span class="op" id="2437604">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437607">case</span>&nbsp;<span class="op" id="2437612">*</span><span class="ident" id="2437613">uint64</span><span class="op" id="2437619">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437623">*</span><span class="ident" id="2437624">v</span>&nbsp;<span class="op" id="2437626">=</span>&nbsp;<span class="ident" id="2437628">s</span><span class="op" id="2437629">.</span><span class="ident" id="2437630">scanUint</span><span class="op" id="2437638">(</span><span class="ident" id="2437639">verb</span><span class="op" id="2437643">,</span>&nbsp;<span class="num" id="2437645">64</span><span class="op" id="2437647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437650">case</span>&nbsp;<span class="op" id="2437655">*</span><span class="builtintype" id="2437656">uintptr</span><span class="op" id="2437663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437667">*</span><span class="ident" id="2437668">v</span>&nbsp;<span class="op" id="2437670">=</span>&nbsp;<span class="builtintype" id="2437672">uintptr</span><span class="op" id="2437679">(</span><span class="ident" id="2437680">s</span><span class="op" id="2437681">.</span><span class="ident" id="2437682">scanUint</span><span class="op" id="2437690">(</span><span class="ident" id="2437691">verb</span><span class="op" id="2437695">,</span>&nbsp;<span class="ident" id="2437697">uintptrBits</span><span class="op" id="2437708">)</span><span class="op" id="2437709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2437712">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2437795">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437885">case</span>&nbsp;<span class="op" id="2437890">*</span><span class="builtintype" id="2437891">float32</span><span class="op" id="2437898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2437902">if</span>&nbsp;<span class="ident" id="2437905">s</span><span class="op" id="2437906">.</span><span class="ident" id="2437907">okVerb</span><span class="op" id="2437913">(</span><span class="ident" id="2437914">verb</span><span class="op" id="2437918">,</span>&nbsp;<span class="ident" id="2437920">floatVerbs</span><span class="op" id="2437930">,</span>&nbsp;<span class="string" id="2437932">&#34;float32&#34;</span><span class="op" id="2437941">)</span>&nbsp;<span class="op" id="2437943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437948">s</span><span class="op" id="2437949">.</span><span class="ident" id="2437950">skipSpace</span><span class="op" id="2437959">(</span><span class="builtintype" id="2437960">false</span><span class="op" id="2437965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2437970">s</span><span class="op" id="2437971">.</span><span class="ident" id="2437972">notEOF</span><span class="op" id="2437978">(</span><span class="op" id="2437979">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2437984">*</span><span class="ident" id="2437985">v</span>&nbsp;<span class="op" id="2437987">=</span>&nbsp;<span class="builtintype" id="2437989">float32</span><span class="op" id="2437996">(</span><span class="ident" id="2437997">s</span><span class="op" id="2437998">.</span><span class="ident" id="2437999">convertFloat</span><span class="op" id="2438011">(</span><span class="ident" id="2438012">s</span><span class="op" id="2438013">.</span><span class="ident" id="2438014">floatToken</span><span class="op" id="2438024">(</span><span class="op" id="2438025">)</span><span class="op" id="2438026">,</span>&nbsp;<span class="num" id="2438028">32</span><span class="op" id="2438030">)</span><span class="op" id="2438031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438038">case</span>&nbsp;<span class="op" id="2438043">*</span><span class="builtintype" id="2438044">float64</span><span class="op" id="2438051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438055">if</span>&nbsp;<span class="ident" id="2438058">s</span><span class="op" id="2438059">.</span><span class="ident" id="2438060">okVerb</span><span class="op" id="2438066">(</span><span class="ident" id="2438067">verb</span><span class="op" id="2438071">,</span>&nbsp;<span class="ident" id="2438073">floatVerbs</span><span class="op" id="2438083">,</span>&nbsp;<span class="string" id="2438085">&#34;float64&#34;</span><span class="op" id="2438094">)</span>&nbsp;<span class="op" id="2438096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438101">s</span><span class="op" id="2438102">.</span><span class="ident" id="2438103">skipSpace</span><span class="op" id="2438112">(</span><span class="builtintype" id="2438113">false</span><span class="op" id="2438118">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438123">s</span><span class="op" id="2438124">.</span><span class="ident" id="2438125">notEOF</span><span class="op" id="2438131">(</span><span class="op" id="2438132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438137">*</span><span class="ident" id="2438138">v</span>&nbsp;<span class="op" id="2438140">=</span>&nbsp;<span class="ident" id="2438142">s</span><span class="op" id="2438143">.</span><span class="ident" id="2438144">convertFloat</span><span class="op" id="2438156">(</span><span class="ident" id="2438157">s</span><span class="op" id="2438158">.</span><span class="ident" id="2438159">floatToken</span><span class="op" id="2438169">(</span><span class="op" id="2438170">)</span><span class="op" id="2438171">,</span>&nbsp;<span class="num" id="2438173">64</span><span class="op" id="2438175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438182">case</span>&nbsp;<span class="op" id="2438187">*</span><span class="builtintype" id="2438188">string</span><span class="op" id="2438194">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438198">*</span><span class="ident" id="2438199">v</span>&nbsp;<span class="op" id="2438201">=</span>&nbsp;<span class="ident" id="2438203">s</span><span class="op" id="2438204">.</span><span class="ident" id="2438205">convertString</span><span class="op" id="2438218">(</span><span class="ident" id="2438219">verb</span><span class="op" id="2438223">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438226">case</span>&nbsp;<span class="op" id="2438231">*</span><span class="op" id="2438232">[</span><span class="op" id="2438233">]</span><span class="builtintype" id="2438234">byte</span><span class="op" id="2438238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438242">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2438307">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438373">*</span><span class="ident" id="2438374">v</span>&nbsp;<span class="op" id="2438376">=</span>&nbsp;<span class="op" id="2438378">[</span><span class="op" id="2438379">]</span><span class="builtintype" id="2438380">byte</span><span class="op" id="2438384">(</span><span class="ident" id="2438385">s</span><span class="op" id="2438386">.</span><span class="ident" id="2438387">convertString</span><span class="op" id="2438400">(</span><span class="ident" id="2438401">verb</span><span class="op" id="2438405">)</span><span class="op" id="2438406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438409">default</span><span class="op" id="2438416">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438420">val</span>&nbsp;<span class="op" id="2438424">:=</span>&nbsp;<span class="ident" id="2438427">reflect</span><span class="op" id="2438434">.</span><span class="ident" id="2438435">ValueOf</span><span class="op" id="2438442">(</span><span class="ident" id="2438443">v</span><span class="op" id="2438444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438448">ptr</span>&nbsp;<span class="op" id="2438452">:=</span>&nbsp;<span class="ident" id="2438455">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438461">if</span>&nbsp;<span class="ident" id="2438464">ptr</span><span class="op" id="2438467">.</span><span class="ident" id="2438468">Kind</span><span class="op" id="2438472">(</span><span class="op" id="2438473">)</span>&nbsp;<span class="op" id="2438475">!=</span>&nbsp;<span class="ident" id="2438478">reflect</span><span class="op" id="2438485">.</span><span class="ident" id="2438486">Ptr</span>&nbsp;<span class="op" id="2438490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438495">s</span><span class="op" id="2438496">.</span><span class="ident" id="2438497">errorString</span><span class="op" id="2438508">(</span><span class="string" id="2438509">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2438532">+</span>&nbsp;<span class="ident" id="2438534">val</span><span class="op" id="2438537">.</span><span class="ident" id="2438538">Type</span><span class="op" id="2438542">(</span><span class="op" id="2438543">)</span><span class="op" id="2438544">.</span><span class="ident" id="2438545">String</span><span class="op" id="2438551">(</span><span class="op" id="2438552">)</span><span class="op" id="2438553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438558">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2438567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438571">switch</span>&nbsp;<span class="ident" id="2438578">v</span>&nbsp;<span class="op" id="2438580">:=</span>&nbsp;<span class="ident" id="2438583">ptr</span><span class="op" id="2438586">.</span><span class="ident" id="2438587">Elem</span><span class="op" id="2438591">(</span><span class="op" id="2438592">)</span><span class="op" id="2438593">;</span>&nbsp;<span class="ident" id="2438595">v</span><span class="op" id="2438596">.</span><span class="ident" id="2438597">Kind</span><span class="op" id="2438601">(</span><span class="op" id="2438602">)</span>&nbsp;<span class="op" id="2438604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438608">case</span>&nbsp;<span class="ident" id="2438613">reflect</span><span class="op" id="2438620">.</span><span class="ident" id="2438621">Bool</span><span class="op" id="2438625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438630">v</span><span class="op" id="2438631">.</span><span class="ident" id="2438632">SetBool</span><span class="op" id="2438639">(</span><span class="ident" id="2438640">s</span><span class="op" id="2438641">.</span><span class="ident" id="2438642">scanBool</span><span class="op" id="2438650">(</span><span class="ident" id="2438651">verb</span><span class="op" id="2438655">)</span><span class="op" id="2438656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438660">case</span>&nbsp;<span class="ident" id="2438665">reflect</span><span class="op" id="2438672">.</span><span class="ident" id="2438673">Int</span><span class="op" id="2438676">,</span>&nbsp;<span class="ident" id="2438678">reflect</span><span class="op" id="2438685">.</span><span class="ident" id="2438686">Int8</span><span class="op" id="2438690">,</span>&nbsp;<span class="ident" id="2438692">reflect</span><span class="op" id="2438699">.</span><span class="ident" id="2438700">Int16</span><span class="op" id="2438705">,</span>&nbsp;<span class="ident" id="2438707">reflect</span><span class="op" id="2438714">.</span><span class="ident" id="2438715">Int32</span><span class="op" id="2438720">,</span>&nbsp;<span class="ident" id="2438722">reflect</span><span class="op" id="2438729">.</span><span class="ident" id="2438730">Int64</span><span class="op" id="2438735">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438740">v</span><span class="op" id="2438741">.</span><span class="ident" id="2438742">SetInt</span><span class="op" id="2438748">(</span><span class="ident" id="2438749">s</span><span class="op" id="2438750">.</span><span class="ident" id="2438751">scanInt</span><span class="op" id="2438758">(</span><span class="ident" id="2438759">verb</span><span class="op" id="2438763">,</span>&nbsp;<span class="ident" id="2438765">v</span><span class="op" id="2438766">.</span><span class="ident" id="2438767">Type</span><span class="op" id="2438771">(</span><span class="op" id="2438772">)</span><span class="op" id="2438773">.</span><span class="ident" id="2438774">Bits</span><span class="op" id="2438778">(</span><span class="op" id="2438779">)</span><span class="op" id="2438780">)</span><span class="op" id="2438781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438785">case</span>&nbsp;<span class="ident" id="2438790">reflect</span><span class="op" id="2438797">.</span><span class="ident" id="2438798">Uint</span><span class="op" id="2438802">,</span>&nbsp;<span class="ident" id="2438804">reflect</span><span class="op" id="2438811">.</span><span class="ident" id="2438812">Uint8</span><span class="op" id="2438817">,</span>&nbsp;<span class="ident" id="2438819">reflect</span><span class="op" id="2438826">.</span><span class="ident" id="2438827">Uint16</span><span class="op" id="2438833">,</span>&nbsp;<span class="ident" id="2438835">reflect</span><span class="op" id="2438842">.</span><span class="ident" id="2438843">Uint32</span><span class="op" id="2438849">,</span>&nbsp;<span class="ident" id="2438851">reflect</span><span class="op" id="2438858">.</span><span class="ident" id="2438859">Uint64</span><span class="op" id="2438865">,</span>&nbsp;<span class="ident" id="2438867">reflect</span><span class="op" id="2438874">.</span><span class="ident" id="2438875">Uintptr</span><span class="op" id="2438882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438887">v</span><span class="op" id="2438888">.</span><span class="ident" id="2438889">SetUint</span><span class="op" id="2438896">(</span><span class="ident" id="2438897">s</span><span class="op" id="2438898">.</span><span class="ident" id="2438899">scanUint</span><span class="op" id="2438907">(</span><span class="ident" id="2438908">verb</span><span class="op" id="2438912">,</span>&nbsp;<span class="ident" id="2438914">v</span><span class="op" id="2438915">.</span><span class="ident" id="2438916">Type</span><span class="op" id="2438920">(</span><span class="op" id="2438921">)</span><span class="op" id="2438922">.</span><span class="ident" id="2438923">Bits</span><span class="op" id="2438927">(</span><span class="op" id="2438928">)</span><span class="op" id="2438929">)</span><span class="op" id="2438930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438934">case</span>&nbsp;<span class="ident" id="2438939">reflect</span><span class="op" id="2438946">.</span><span class="ident" id="2438947">String</span><span class="op" id="2438953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2438958">v</span><span class="op" id="2438959">.</span><span class="ident" id="2438960">SetString</span><span class="op" id="2438969">(</span><span class="ident" id="2438970">s</span><span class="op" id="2438971">.</span><span class="ident" id="2438972">convertString</span><span class="op" id="2438985">(</span><span class="ident" id="2438986">verb</span><span class="op" id="2438990">)</span><span class="op" id="2438991">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2438995">case</span>&nbsp;<span class="ident" id="2439000">reflect</span><span class="op" id="2439007">.</span><span class="ident" id="2439008">Slice</span><span class="op" id="2439013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2439018">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439067">typ</span>&nbsp;<span class="op" id="2439071">:=</span>&nbsp;<span class="ident" id="2439074">v</span><span class="op" id="2439075">.</span><span class="ident" id="2439076">Type</span><span class="op" id="2439080">(</span><span class="op" id="2439081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439086">if</span>&nbsp;<span class="ident" id="2439089">typ</span><span class="op" id="2439092">.</span><span class="ident" id="2439093">Elem</span><span class="op" id="2439097">(</span><span class="op" id="2439098">)</span><span class="op" id="2439099">.</span><span class="ident" id="2439100">Kind</span><span class="op" id="2439104">(</span><span class="op" id="2439105">)</span>&nbsp;<span class="op" id="2439107">!=</span>&nbsp;<span class="ident" id="2439110">reflect</span><span class="op" id="2439117">.</span><span class="ident" id="2439118">Uint8</span>&nbsp;<span class="op" id="2439124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439130">s</span><span class="op" id="2439131">.</span><span class="ident" id="2439132">errorString</span><span class="op" id="2439143">(</span><span class="string" id="2439144">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2439164">+</span>&nbsp;<span class="ident" id="2439166">val</span><span class="op" id="2439169">.</span><span class="ident" id="2439170">Type</span><span class="op" id="2439174">(</span><span class="op" id="2439175">)</span><span class="op" id="2439176">.</span><span class="ident" id="2439177">String</span><span class="op" id="2439183">(</span><span class="op" id="2439184">)</span><span class="op" id="2439185">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439195">str</span>&nbsp;<span class="op" id="2439199">:=</span>&nbsp;<span class="ident" id="2439202">s</span><span class="op" id="2439203">.</span><span class="ident" id="2439204">convertString</span><span class="op" id="2439217">(</span><span class="ident" id="2439218">verb</span><span class="op" id="2439222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439227">v</span><span class="op" id="2439228">.</span><span class="ident" id="2439229">Set</span><span class="op" id="2439232">(</span><span class="ident" id="2439233">reflect</span><span class="op" id="2439240">.</span><span class="ident" id="2439241">MakeSlice</span><span class="op" id="2439250">(</span><span class="ident" id="2439251">typ</span><span class="op" id="2439254">,</span>&nbsp;<span class="builtinfunc" id="2439256">len</span><span class="op" id="2439259">(</span><span class="ident" id="2439260">str</span><span class="op" id="2439263">)</span><span class="op" id="2439264">,</span>&nbsp;<span class="builtinfunc" id="2439266">len</span><span class="op" id="2439269">(</span><span class="ident" id="2439270">str</span><span class="op" id="2439273">)</span><span class="op" id="2439274">)</span><span class="op" id="2439275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439280">for</span>&nbsp;<span class="ident" id="2439284">i</span>&nbsp;<span class="op" id="2439286">:=</span>&nbsp;<span class="num" id="2439289">0</span><span class="op" id="2439290">;</span>&nbsp;<span class="ident" id="2439292">i</span>&nbsp;<span class="op" id="2439294">&lt;</span>&nbsp;<span class="builtinfunc" id="2439296">len</span><span class="op" id="2439299">(</span><span class="ident" id="2439300">str</span><span class="op" id="2439303">)</span><span class="op" id="2439304">;</span>&nbsp;<span class="ident" id="2439306">i</span><span class="op" id="2439307">++</span>&nbsp;<span class="op" id="2439310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439316">v</span><span class="op" id="2439317">.</span><span class="ident" id="2439318">Index</span><span class="op" id="2439323">(</span><span class="ident" id="2439324">i</span><span class="op" id="2439325">)</span><span class="op" id="2439326">.</span><span class="ident" id="2439327">SetUint</span><span class="op" id="2439334">(</span><span class="ident" id="2439335">uint64</span><span class="op" id="2439341">(</span><span class="ident" id="2439342">str</span><span class="op" id="2439345">[</span><span class="ident" id="2439346">i</span><span class="op" id="2439347">]</span><span class="op" id="2439348">)</span><span class="op" id="2439349">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439358">case</span>&nbsp;<span class="ident" id="2439363">reflect</span><span class="op" id="2439370">.</span><span class="ident" id="2439371">Float32</span><span class="op" id="2439378">,</span>&nbsp;<span class="ident" id="2439380">reflect</span><span class="op" id="2439387">.</span><span class="ident" id="2439388">Float64</span><span class="op" id="2439395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439400">s</span><span class="op" id="2439401">.</span><span class="ident" id="2439402">skipSpace</span><span class="op" id="2439411">(</span><span class="builtintype" id="2439412">false</span><span class="op" id="2439417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439422">s</span><span class="op" id="2439423">.</span><span class="ident" id="2439424">notEOF</span><span class="op" id="2439430">(</span><span class="op" id="2439431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439436">v</span><span class="op" id="2439437">.</span><span class="ident" id="2439438">SetFloat</span><span class="op" id="2439446">(</span><span class="ident" id="2439447">s</span><span class="op" id="2439448">.</span><span class="ident" id="2439449">convertFloat</span><span class="op" id="2439461">(</span><span class="ident" id="2439462">s</span><span class="op" id="2439463">.</span><span class="ident" id="2439464">floatToken</span><span class="op" id="2439474">(</span><span class="op" id="2439475">)</span><span class="op" id="2439476">,</span>&nbsp;<span class="ident" id="2439478">v</span><span class="op" id="2439479">.</span><span class="ident" id="2439480">Type</span><span class="op" id="2439484">(</span><span class="op" id="2439485">)</span><span class="op" id="2439486">.</span><span class="ident" id="2439487">Bits</span><span class="op" id="2439491">(</span><span class="op" id="2439492">)</span><span class="op" id="2439493">)</span><span class="op" id="2439494">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439498">case</span>&nbsp;<span class="ident" id="2439503">reflect</span><span class="op" id="2439510">.</span><span class="ident" id="2439511">Complex64</span><span class="op" id="2439520">,</span>&nbsp;<span class="ident" id="2439522">reflect</span><span class="op" id="2439529">.</span><span class="ident" id="2439530">Complex128</span><span class="op" id="2439540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439545">v</span><span class="op" id="2439546">.</span><span class="ident" id="2439547">SetComplex</span><span class="op" id="2439557">(</span><span class="ident" id="2439558">s</span><span class="op" id="2439559">.</span><span class="ident" id="2439560">scanComplex</span><span class="op" id="2439571">(</span><span class="ident" id="2439572">verb</span><span class="op" id="2439576">,</span>&nbsp;<span class="ident" id="2439578">v</span><span class="op" id="2439579">.</span><span class="ident" id="2439580">Type</span><span class="op" id="2439584">(</span><span class="op" id="2439585">)</span><span class="op" id="2439586">.</span><span class="ident" id="2439587">Bits</span><span class="op" id="2439591">(</span><span class="op" id="2439592">)</span><span class="op" id="2439593">)</span><span class="op" id="2439594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439598">default</span><span class="op" id="2439605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2439610">s</span><span class="op" id="2439611">.</span><span class="ident" id="2439612">errorString</span><span class="op" id="2439623">(</span><span class="string" id="2439624">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2439644">+</span>&nbsp;<span class="ident" id="2439646">val</span><span class="op" id="2439649">.</span><span class="ident" id="2439650">Type</span><span class="op" id="2439654">(</span><span class="op" id="2439655">)</span><span class="op" id="2439656">.</span><span class="ident" id="2439657">String</span><span class="op" id="2439663">(</span><span class="op" id="2439664">)</span><span class="op" id="2439665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439669">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439672">}</span><br>
<span class="lineno"></span><span class="op" id="2439674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2439677">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2439732">func</span>&nbsp;<span class="ident" id="2439737">errorHandler</span><span class="op" id="2439749">(</span><span class="ident" id="2439750">errp</span>&nbsp;<span class="op" id="2439755">*</span><span class="builtintype" id="2439756">error</span><span class="op" id="2439761">)</span>&nbsp;<span class="op" id="2439763">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439766">if</span>&nbsp;<span class="ident" id="2439769">e</span>&nbsp;<span class="op" id="2439771">:=</span>&nbsp;<span class="builtinfunc" id="2439774">recover</span><span class="op" id="2439781">(</span><span class="op" id="2439782">)</span><span class="op" id="2439783">;</span>&nbsp;<span class="ident" id="2439785">e</span>&nbsp;<span class="op" id="2439787">!=</span>&nbsp;<span class="ident" id="2439790">nil</span>&nbsp;<span class="op" id="2439794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2439798">if</span>&nbsp;<span class="ident" id="2439801">se</span><span class="op" id="2439803">,</span>&nbsp;<span class="ident" id="2439805">ok</span>&nbsp;<span class="op" id="2439808">:=</span>&nbsp;<span class="ident" id="2439811">e</span><span class="op" id="2439812">.</span><span class="op" id="2439813">(</span><span class="ident" id="2439814">scanError</span><span class="op" id="2439823">)</span><span class="op" id="2439824">;</span>&nbsp;<span class="ident" id="2439826">ok</span>&nbsp;<span class="op" id="2439829">{</span>&nbsp;<span class="comment" id="2439831">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439855">*</span><span class="ident" id="2439856">errp</span>&nbsp;<span class="op" id="2439861">=</span>&nbsp;<span class="ident" id="2439863">se</span><span class="op" id="2439865">.</span><span class="ident" id="2439866">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439872">}</span>&nbsp;<span class="keyword" id="2439874">else</span>&nbsp;<span class="keyword" id="2439879">if</span>&nbsp;<span class="ident" id="2439882">eof</span><span class="op" id="2439885">,</span>&nbsp;<span class="ident" id="2439887">ok</span>&nbsp;<span class="op" id="2439890">:=</span>&nbsp;<span class="ident" id="2439893">e</span><span class="op" id="2439894">.</span><span class="op" id="2439895">(</span><span class="builtintype" id="2439896">error</span><span class="op" id="2439901">)</span><span class="op" id="2439902">;</span>&nbsp;<span class="ident" id="2439904">ok</span>&nbsp;<span class="op" id="2439907">&amp;&amp;</span>&nbsp;<span class="ident" id="2439910">eof</span>&nbsp;<span class="op" id="2439914">==</span>&nbsp;<span class="ident" id="2439917">io</span><span class="op" id="2439919">.</span><span class="ident" id="2439920">EOF</span>&nbsp;<span class="op" id="2439924">{</span>&nbsp;<span class="comment" id="2439926">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439945">*</span><span class="ident" id="2439946">errp</span>&nbsp;<span class="op" id="2439951">=</span>&nbsp;<span class="ident" id="2439953">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439959">}</span>&nbsp;<span class="keyword" id="2439961">else</span>&nbsp;<span class="op" id="2439966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2439971">panic</span><span class="op" id="2439976">(</span><span class="ident" id="2439977">e</span><span class="op" id="2439978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2439985">}</span><br>
<span class="lineno"></span><span class="op" id="2439987">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2439990">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2440057">func</span>&nbsp;<span class="op" id="2440062">(</span><span class="ident" id="2440063">s</span>&nbsp;<span class="op" id="2440065">*</span><span class="ident" id="2440066">ss</span><span class="op" id="2440068">)</span>&nbsp;<span class="ident" id="2440070">doScan</span><span class="op" id="2440076">(</span><span class="ident" id="2440077">a</span>&nbsp;<span class="op" id="2440079">[</span><span class="op" id="2440080">]</span><span class="keyword" id="2440081">interface</span><span class="op" id="2440090">{</span><span class="op" id="2440091">}</span><span class="op" id="2440092">)</span>&nbsp;<span class="op" id="2440094">(</span><span class="ident" id="2440095">numProcessed</span>&nbsp;<span class="builtintype" id="2440108">int</span><span class="op" id="2440111">,</span>&nbsp;<span class="ident" id="2440113">err</span>&nbsp;<span class="builtintype" id="2440117">error</span><span class="op" id="2440122">)</span>&nbsp;<span class="op" id="2440124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440127">defer</span>&nbsp;<span class="ident" id="2440133">errorHandler</span><span class="op" id="2440145">(</span><span class="op" id="2440146">&amp;</span><span class="ident" id="2440147">err</span><span class="op" id="2440150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440153">for</span>&nbsp;<span class="ident" id="2440157">_</span><span class="op" id="2440158">,</span>&nbsp;<span class="ident" id="2440160">arg</span>&nbsp;<span class="op" id="2440164">:=</span>&nbsp;<span class="keyword" id="2440167">range</span>&nbsp;<span class="ident" id="2440173">a</span>&nbsp;<span class="op" id="2440175">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440179">s</span><span class="op" id="2440180">.</span><span class="ident" id="2440181">scanOne</span><span class="op" id="2440188">(</span><span class="string" id="2440189">&#39;v&#39;</span><span class="op" id="2440192">,</span>&nbsp;<span class="ident" id="2440194">arg</span><span class="op" id="2440197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440201">numProcessed</span><span class="op" id="2440213">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2440220">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440255">if</span>&nbsp;<span class="op" id="2440258">!</span><span class="ident" id="2440259">s</span><span class="op" id="2440260">.</span><span class="ident" id="2440261">nlIsSpace</span>&nbsp;<span class="op" id="2440271">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440275">for</span>&nbsp;<span class="op" id="2440279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440284">r</span>&nbsp;<span class="op" id="2440286">:=</span>&nbsp;<span class="ident" id="2440289">s</span><span class="op" id="2440290">.</span><span class="ident" id="2440291">getRune</span><span class="op" id="2440298">(</span><span class="op" id="2440299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440304">if</span>&nbsp;<span class="ident" id="2440307">r</span>&nbsp;<span class="op" id="2440309">==</span>&nbsp;<span class="string" id="2440312">&#39;\n&#39;</span>&nbsp;<span class="op" id="2440317">||</span>&nbsp;<span class="ident" id="2440320">r</span>&nbsp;<span class="op" id="2440322">==</span>&nbsp;<span class="ident" id="2440325">eof</span>&nbsp;<span class="op" id="2440329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440335">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440344">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440349">if</span>&nbsp;<span class="op" id="2440352">!</span><span class="ident" id="2440353">isSpace</span><span class="op" id="2440360">(</span><span class="ident" id="2440361">r</span><span class="op" id="2440362">)</span>&nbsp;<span class="op" id="2440364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440370">s</span><span class="op" id="2440371">.</span><span class="ident" id="2440372">errorString</span><span class="op" id="2440383">(</span><span class="string" id="2440384">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2440402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440408">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440421">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2440424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440427">return</span><br>
<span class="lineno"></span><span class="op" id="2440434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2440437">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2440506">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2440577">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2440646">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2440716">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2440784">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2440848">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2440906">func</span>&nbsp;<span class="op" id="2440911">(</span><span class="ident" id="2440912">s</span>&nbsp;<span class="op" id="2440914">*</span><span class="ident" id="2440915">ss</span><span class="op" id="2440917">)</span>&nbsp;<span class="ident" id="2440919">advance</span><span class="op" id="2440926">(</span><span class="ident" id="2440927">format</span>&nbsp;<span class="builtintype" id="2440934">string</span><span class="op" id="2440940">)</span>&nbsp;<span class="op" id="2440942">(</span><span class="ident" id="2440943">i</span>&nbsp;<span class="builtintype" id="2440945">int</span><span class="op" id="2440948">)</span>&nbsp;<span class="op" id="2440950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2440953">for</span>&nbsp;<span class="ident" id="2440957">i</span>&nbsp;<span class="op" id="2440959">&lt;</span>&nbsp;<span class="builtinfunc" id="2440961">len</span><span class="op" id="2440964">(</span><span class="ident" id="2440965">format</span><span class="op" id="2440971">)</span>&nbsp;<span class="op" id="2440973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2440977">fmtc</span><span class="op" id="2440981">,</span>&nbsp;<span class="ident" id="2440983">w</span>&nbsp;<span class="op" id="2440985">:=</span>&nbsp;<span class="ident" id="2440988">utf8</span><span class="op" id="2440992">.</span><span class="ident" id="2440993">DecodeRuneInString</span><span class="op" id="2441011">(</span><span class="ident" id="2441012">format</span><span class="op" id="2441018">[</span><span class="ident" id="2441019">i</span><span class="op" id="2441020">:</span><span class="op" id="2441021">]</span><span class="op" id="2441022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441026">if</span>&nbsp;<span class="ident" id="2441029">fmtc</span>&nbsp;<span class="op" id="2441034">==</span>&nbsp;<span class="string" id="2441037">&#39;%&#39;</span>&nbsp;<span class="op" id="2441041">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441046">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441080">nextc</span><span class="op" id="2441085">,</span>&nbsp;<span class="ident" id="2441087">_</span>&nbsp;<span class="op" id="2441089">:=</span>&nbsp;<span class="ident" id="2441092">utf8</span><span class="op" id="2441096">.</span><span class="ident" id="2441097">DecodeRuneInString</span><span class="op" id="2441115">(</span><span class="ident" id="2441116">format</span><span class="op" id="2441122">[</span><span class="ident" id="2441123">i</span><span class="op" id="2441124">+</span><span class="ident" id="2441125">w</span><span class="op" id="2441126">:</span><span class="op" id="2441127">]</span><span class="op" id="2441128">)</span>&nbsp;<span class="comment" id="2441130">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441172">if</span>&nbsp;<span class="ident" id="2441175">nextc</span>&nbsp;<span class="op" id="2441181">!=</span>&nbsp;<span class="string" id="2441184">&#39;%&#39;</span>&nbsp;<span class="op" id="2441188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441194">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441204">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441209">i</span>&nbsp;<span class="op" id="2441211">+=</span>&nbsp;<span class="ident" id="2441214">w</span>&nbsp;<span class="comment" id="2441216">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441242">sawSpace</span>&nbsp;<span class="op" id="2441251">:=</span>&nbsp;<span class="builtintype" id="2441254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441262">for</span>&nbsp;<span class="ident" id="2441266">isSpace</span><span class="op" id="2441273">(</span><span class="ident" id="2441274">fmtc</span><span class="op" id="2441278">)</span>&nbsp;<span class="op" id="2441280">&amp;&amp;</span>&nbsp;<span class="ident" id="2441283">i</span>&nbsp;<span class="op" id="2441285">&lt;</span>&nbsp;<span class="builtinfunc" id="2441287">len</span><span class="op" id="2441290">(</span><span class="ident" id="2441291">format</span><span class="op" id="2441297">)</span>&nbsp;<span class="op" id="2441299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441304">sawSpace</span>&nbsp;<span class="op" id="2441313">=</span>&nbsp;<span class="builtintype" id="2441315">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441323">i</span>&nbsp;<span class="op" id="2441325">+=</span>&nbsp;<span class="ident" id="2441328">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441333">fmtc</span><span class="op" id="2441337">,</span>&nbsp;<span class="ident" id="2441339">w</span>&nbsp;<span class="op" id="2441341">=</span>&nbsp;<span class="ident" id="2441343">utf8</span><span class="op" id="2441347">.</span><span class="ident" id="2441348">DecodeRuneInString</span><span class="op" id="2441366">(</span><span class="ident" id="2441367">format</span><span class="op" id="2441373">[</span><span class="ident" id="2441374">i</span><span class="op" id="2441375">:</span><span class="op" id="2441376">]</span><span class="op" id="2441377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441385">if</span>&nbsp;<span class="ident" id="2441388">sawSpace</span>&nbsp;<span class="op" id="2441397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441402">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441470">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441490">inputc</span>&nbsp;<span class="op" id="2441497">:=</span>&nbsp;<span class="ident" id="2441500">s</span><span class="op" id="2441501">.</span><span class="ident" id="2441502">getRune</span><span class="op" id="2441509">(</span><span class="op" id="2441510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441515">if</span>&nbsp;<span class="ident" id="2441518">inputc</span>&nbsp;<span class="op" id="2441525">==</span>&nbsp;<span class="ident" id="2441528">eof</span>&nbsp;<span class="op" id="2441532">||</span>&nbsp;<span class="ident" id="2441535">inputc</span>&nbsp;<span class="op" id="2441542">==</span>&nbsp;<span class="string" id="2441545">&#39;\n&#39;</span>&nbsp;<span class="op" id="2441550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441556">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441619">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441634">if</span>&nbsp;<span class="op" id="2441637">!</span><span class="ident" id="2441638">isSpace</span><span class="op" id="2441645">(</span><span class="ident" id="2441646">inputc</span><span class="op" id="2441652">)</span>&nbsp;<span class="op" id="2441654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2441660">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441707">s</span><span class="op" id="2441708">.</span><span class="ident" id="2441709">errorString</span><span class="op" id="2441720">(</span><span class="string" id="2441721">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2441762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441767">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441772">s</span><span class="op" id="2441773">.</span><span class="ident" id="2441774">skipSpace</span><span class="op" id="2441783">(</span><span class="builtintype" id="2441784">true</span><span class="op" id="2441788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441793">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441808">inputc</span>&nbsp;<span class="op" id="2441815">:=</span>&nbsp;<span class="ident" id="2441818">s</span><span class="op" id="2441819">.</span><span class="ident" id="2441820">mustReadRune</span><span class="op" id="2441832">(</span><span class="op" id="2441833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441837">if</span>&nbsp;<span class="ident" id="2441840">fmtc</span>&nbsp;<span class="op" id="2441845">!=</span>&nbsp;<span class="ident" id="2441848">inputc</span>&nbsp;<span class="op" id="2441855">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441860">s</span><span class="op" id="2441861">.</span><span class="ident" id="2441862">UnreadRune</span><span class="op" id="2441872">(</span><span class="op" id="2441873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441878">return</span>&nbsp;<span class="op" id="2441885">-</span><span class="num" id="2441886">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2441894">i</span>&nbsp;<span class="op" id="2441896">+=</span>&nbsp;<span class="ident" id="2441899">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2441902">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2441905">return</span><br>
<span class="lineno"></span><span class="op" id="2441912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2441915">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2441981">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2442041">func</span>&nbsp;<span class="op" id="2442046">(</span><span class="ident" id="2442047">s</span>&nbsp;<span class="op" id="2442049">*</span><span class="ident" id="2442050">ss</span><span class="op" id="2442052">)</span>&nbsp;<span class="ident" id="2442054">doScanf</span><span class="op" id="2442061">(</span><span class="ident" id="2442062">format</span>&nbsp;<span class="builtintype" id="2442069">string</span><span class="op" id="2442075">,</span>&nbsp;<span class="ident" id="2442077">a</span>&nbsp;<span class="op" id="2442079">[</span><span class="op" id="2442080">]</span><span class="keyword" id="2442081">interface</span><span class="op" id="2442090">{</span><span class="op" id="2442091">}</span><span class="op" id="2442092">)</span>&nbsp;<span class="op" id="2442094">(</span><span class="ident" id="2442095">numProcessed</span>&nbsp;<span class="builtintype" id="2442108">int</span><span class="op" id="2442111">,</span>&nbsp;<span class="ident" id="2442113">err</span>&nbsp;<span class="builtintype" id="2442117">error</span><span class="op" id="2442122">)</span>&nbsp;<span class="op" id="2442124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442127">defer</span>&nbsp;<span class="ident" id="2442133">errorHandler</span><span class="op" id="2442145">(</span><span class="op" id="2442146">&amp;</span><span class="ident" id="2442147">err</span><span class="op" id="2442150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442153">end</span>&nbsp;<span class="op" id="2442157">:=</span>&nbsp;<span class="builtinfunc" id="2442160">len</span><span class="op" id="2442163">(</span><span class="ident" id="2442164">format</span><span class="op" id="2442170">)</span>&nbsp;<span class="op" id="2442172">-</span>&nbsp;<span class="num" id="2442174">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442177">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442224">for</span>&nbsp;<span class="ident" id="2442228">i</span>&nbsp;<span class="op" id="2442230">:=</span>&nbsp;<span class="num" id="2442233">0</span><span class="op" id="2442234">;</span>&nbsp;<span class="ident" id="2442236">i</span>&nbsp;<span class="op" id="2442238">&lt;=</span>&nbsp;<span class="ident" id="2442241">end</span><span class="op" id="2442244">;</span>&nbsp;<span class="op" id="2442246">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442250">w</span>&nbsp;<span class="op" id="2442252">:=</span>&nbsp;<span class="ident" id="2442255">s</span><span class="op" id="2442256">.</span><span class="ident" id="2442257">advance</span><span class="op" id="2442264">(</span><span class="ident" id="2442265">format</span><span class="op" id="2442271">[</span><span class="ident" id="2442272">i</span><span class="op" id="2442273">:</span><span class="op" id="2442274">]</span><span class="op" id="2442275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442279">if</span>&nbsp;<span class="ident" id="2442282">w</span>&nbsp;<span class="op" id="2442284">&gt;</span>&nbsp;<span class="num" id="2442286">0</span>&nbsp;<span class="op" id="2442288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442293">i</span>&nbsp;<span class="op" id="2442295">+=</span>&nbsp;<span class="ident" id="2442298">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442303">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442314">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442318">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442405">if</span>&nbsp;<span class="ident" id="2442408">format</span><span class="op" id="2442414">[</span><span class="ident" id="2442415">i</span><span class="op" id="2442416">]</span>&nbsp;<span class="op" id="2442418">!=</span>&nbsp;<span class="string" id="2442421">&#39;%&#39;</span>&nbsp;<span class="op" id="2442425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442430">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442468">if</span>&nbsp;<span class="ident" id="2442471">w</span>&nbsp;<span class="op" id="2442473">&lt;</span>&nbsp;<span class="num" id="2442475">0</span>&nbsp;<span class="op" id="2442477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442483">s</span><span class="op" id="2442484">.</span><span class="ident" id="2442485">errorString</span><span class="op" id="2442496">(</span><span class="string" id="2442497">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2442526">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442536">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442600">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442612">i</span><span class="op" id="2442613">++</span>&nbsp;<span class="comment" id="2442616">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2442636">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442664">var</span>&nbsp;<span class="ident" id="2442668">widPresent</span>&nbsp;<span class="builtintype" id="2442679">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442686">s</span><span class="op" id="2442687">.</span><span class="ident" id="2442688">maxWid</span><span class="op" id="2442694">,</span>&nbsp;<span class="ident" id="2442696">widPresent</span><span class="op" id="2442706">,</span>&nbsp;<span class="ident" id="2442708">i</span>&nbsp;<span class="op" id="2442710">=</span>&nbsp;<span class="ident" id="2442712">parsenum</span><span class="op" id="2442720">(</span><span class="ident" id="2442721">format</span><span class="op" id="2442727">,</span>&nbsp;<span class="ident" id="2442729">i</span><span class="op" id="2442730">,</span>&nbsp;<span class="ident" id="2442732">end</span><span class="op" id="2442735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442739">if</span>&nbsp;<span class="op" id="2442742">!</span><span class="ident" id="2442743">widPresent</span>&nbsp;<span class="op" id="2442754">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442759">s</span><span class="op" id="2442760">.</span><span class="ident" id="2442761">maxWid</span>&nbsp;<span class="op" id="2442768">=</span>&nbsp;<span class="ident" id="2442770">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442784">s</span><span class="op" id="2442785">.</span><span class="ident" id="2442786">argLimit</span>&nbsp;<span class="op" id="2442795">=</span>&nbsp;<span class="ident" id="2442797">s</span><span class="op" id="2442798">.</span><span class="ident" id="2442799">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442807">if</span>&nbsp;<span class="ident" id="2442810">f</span>&nbsp;<span class="op" id="2442812">:=</span>&nbsp;<span class="ident" id="2442815">s</span><span class="op" id="2442816">.</span><span class="ident" id="2442817">count</span>&nbsp;<span class="op" id="2442823">+</span>&nbsp;<span class="ident" id="2442825">s</span><span class="op" id="2442826">.</span><span class="ident" id="2442827">maxWid</span><span class="op" id="2442833">;</span>&nbsp;<span class="ident" id="2442835">f</span>&nbsp;<span class="op" id="2442837">&lt;</span>&nbsp;<span class="ident" id="2442839">s</span><span class="op" id="2442840">.</span><span class="ident" id="2442841">argLimit</span>&nbsp;<span class="op" id="2442850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442855">s</span><span class="op" id="2442856">.</span><span class="ident" id="2442857">argLimit</span>&nbsp;<span class="op" id="2442866">=</span>&nbsp;<span class="ident" id="2442868">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2442872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442877">c</span><span class="op" id="2442878">,</span>&nbsp;<span class="ident" id="2442880">w</span>&nbsp;<span class="op" id="2442882">:=</span>&nbsp;<span class="ident" id="2442885">utf8</span><span class="op" id="2442889">.</span><span class="ident" id="2442890">DecodeRuneInString</span><span class="op" id="2442908">(</span><span class="ident" id="2442909">format</span><span class="op" id="2442915">[</span><span class="ident" id="2442916">i</span><span class="op" id="2442917">:</span><span class="op" id="2442918">]</span><span class="op" id="2442919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442923">i</span>&nbsp;<span class="op" id="2442925">+=</span>&nbsp;<span class="ident" id="2442928">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2442933">if</span>&nbsp;<span class="ident" id="2442936">numProcessed</span>&nbsp;<span class="op" id="2442949">&gt;=</span>&nbsp;<span class="builtinfunc" id="2442952">len</span><span class="op" id="2442955">(</span><span class="ident" id="2442956">a</span><span class="op" id="2442957">)</span>&nbsp;<span class="op" id="2442959">{</span>&nbsp;<span class="comment" id="2442961">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2442983">s</span><span class="op" id="2442984">.</span><span class="ident" id="2442985">errorString</span><span class="op" id="2442996">(</span><span class="string" id="2442997">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2443029">+</span>&nbsp;<span class="ident" id="2443031">format</span><span class="op" id="2443037">[</span><span class="ident" id="2443038">i</span><span class="op" id="2443039">-</span><span class="ident" id="2443040">w</span><span class="op" id="2443041">:</span><span class="op" id="2443042">]</span><span class="op" id="2443043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443048">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2443056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443060">arg</span>&nbsp;<span class="op" id="2443064">:=</span>&nbsp;<span class="ident" id="2443067">a</span><span class="op" id="2443068">[</span><span class="ident" id="2443069">numProcessed</span><span class="op" id="2443081">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443086">s</span><span class="op" id="2443087">.</span><span class="ident" id="2443088">scanOne</span><span class="op" id="2443095">(</span><span class="ident" id="2443096">c</span><span class="op" id="2443097">,</span>&nbsp;<span class="ident" id="2443099">arg</span><span class="op" id="2443102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443106">numProcessed</span><span class="op" id="2443118">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443123">s</span><span class="op" id="2443124">.</span><span class="ident" id="2443125">argLimit</span>&nbsp;<span class="op" id="2443134">=</span>&nbsp;<span class="ident" id="2443136">s</span><span class="op" id="2443137">.</span><span class="ident" id="2443138">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2443145">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443148">if</span>&nbsp;<span class="ident" id="2443151">numProcessed</span>&nbsp;<span class="op" id="2443164">&lt;</span>&nbsp;<span class="builtinfunc" id="2443166">len</span><span class="op" id="2443169">(</span><span class="ident" id="2443170">a</span><span class="op" id="2443171">)</span>&nbsp;<span class="op" id="2443173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2443177">s</span><span class="op" id="2443178">.</span><span class="ident" id="2443179">errorString</span><span class="op" id="2443190">(</span><span class="string" id="2443191">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2443210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2443213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2443216">return</span><br>
<span class="lineno"></span><span class="op" id="2443223">}</span>
</div>
</body>
</html>
