<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4620308">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4620363">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4620417">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4620468">package</span>&nbsp;<span class="ident" id="4620476">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4620482">import</span>&nbsp;<span class="op" id="4620489">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4620492">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4620512">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4620529">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4620539">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4620545">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620548">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4620599">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4620659">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4620675">type</span>&nbsp;<span class="ident" id="4620680">pkcs8</span>&nbsp;<span class="keyword" id="4620686">struct</span>&nbsp;<span class="op" id="4620693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620696">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4620707">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620712">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620723">pkix</span><span class="op" id="4620727">.</span><span class="ident" id="4620728">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620749">PrivateKey</span>&nbsp;<span class="op" id="4620760">[</span><span class="op" id="4620761">]</span><span class="builtintype" id="4620762">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4620768">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4620800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620803">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4620874">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4620934">func</span>&nbsp;<span class="ident" id="4620939">ParsePKCS8PrivateKey</span><span class="op" id="4620959">(</span><span class="ident" id="4620960">der</span>&nbsp;<span class="op" id="4620964">[</span><span class="op" id="4620965">]</span><span class="builtintype" id="4620966">byte</span><span class="op" id="4620970">)</span>&nbsp;<span class="op" id="4620972">(</span><span class="ident" id="4620973">key</span>&nbsp;<span class="keyword" id="4620977">interface</span><span class="op" id="4620986">{</span><span class="op" id="4620987">}</span><span class="op" id="4620988">,</span>&nbsp;<span class="ident" id="4620990">err</span>&nbsp;<span class="builtintype" id="4620994">error</span><span class="op" id="4620999">)</span>&nbsp;<span class="op" id="4621001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621004">var</span>&nbsp;<span class="ident" id="4621008">privKey</span>&nbsp;<span class="ident" id="4621016">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621023">if</span>&nbsp;<span class="ident" id="4621026">_</span><span class="op" id="4621027">,</span>&nbsp;<span class="ident" id="4621029">err</span>&nbsp;<span class="op" id="4621033">:=</span>&nbsp;<span class="ident" id="4621036">asn1</span><span class="op" id="4621040">.</span><span class="ident" id="4621041">Unmarshal</span><span class="op" id="4621050">(</span><span class="ident" id="4621051">der</span><span class="op" id="4621054">,</span>&nbsp;<span class="op" id="4621056">&amp;</span><span class="ident" id="4621057">privKey</span><span class="op" id="4621064">)</span><span class="op" id="4621065">;</span>&nbsp;<span class="ident" id="4621067">err</span>&nbsp;<span class="op" id="4621071">!=</span>&nbsp;<span class="ident" id="4621074">nil</span>&nbsp;<span class="op" id="4621078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621082">return</span>&nbsp;<span class="ident" id="4621089">nil</span><span class="op" id="4621092">,</span>&nbsp;<span class="ident" id="4621094">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621102">switch</span>&nbsp;<span class="op" id="4621109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621112">case</span>&nbsp;<span class="ident" id="4621117">privKey</span><span class="op" id="4621124">.</span><span class="ident" id="4621125">Algo</span><span class="op" id="4621129">.</span><span class="ident" id="4621130">Algorithm</span><span class="op" id="4621139">.</span><span class="ident" id="4621140">Equal</span><span class="op" id="4621145">(</span><span class="ident" id="4621146">oidPublicKeyRSA</span><span class="op" id="4621161">)</span><span class="op" id="4621162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621166">key</span><span class="op" id="4621169">,</span>&nbsp;<span class="ident" id="4621171">err</span>&nbsp;<span class="op" id="4621175">=</span>&nbsp;<span class="ident" id="4621177">ParsePKCS1PrivateKey</span><span class="op" id="4621197">(</span><span class="ident" id="4621198">privKey</span><span class="op" id="4621205">.</span><span class="ident" id="4621206">PrivateKey</span><span class="op" id="4621216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621220">if</span>&nbsp;<span class="ident" id="4621223">err</span>&nbsp;<span class="op" id="4621227">!=</span>&nbsp;<span class="ident" id="4621230">nil</span>&nbsp;<span class="op" id="4621234">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621239">return</span>&nbsp;<span class="ident" id="4621246">nil</span><span class="op" id="4621249">,</span>&nbsp;<span class="ident" id="4621251">errors</span><span class="op" id="4621257">.</span><span class="ident" id="4621258">New</span><span class="op" id="4621261">(</span><span class="string" id="4621262">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4621323">+</span>&nbsp;<span class="ident" id="4621325">err</span><span class="op" id="4621328">.</span><span class="ident" id="4621329">Error</span><span class="op" id="4621334">(</span><span class="op" id="4621335">)</span><span class="op" id="4621336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621344">return</span>&nbsp;<span class="ident" id="4621351">key</span><span class="op" id="4621354">,</span>&nbsp;<span class="ident" id="4621356">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621362">case</span>&nbsp;<span class="ident" id="4621367">privKey</span><span class="op" id="4621374">.</span><span class="ident" id="4621375">Algo</span><span class="op" id="4621379">.</span><span class="ident" id="4621380">Algorithm</span><span class="op" id="4621389">.</span><span class="ident" id="4621390">Equal</span><span class="op" id="4621395">(</span><span class="ident" id="4621396">oidPublicKeyECDSA</span><span class="op" id="4621413">)</span><span class="op" id="4621414">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621418">bytes</span>&nbsp;<span class="op" id="4621424">:=</span>&nbsp;<span class="ident" id="4621427">privKey</span><span class="op" id="4621434">.</span><span class="ident" id="4621435">Algo</span><span class="op" id="4621439">.</span><span class="ident" id="4621440">Parameters</span><span class="op" id="4621450">.</span><span class="ident" id="4621451">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621463">namedCurveOID</span>&nbsp;<span class="op" id="4621477">:=</span>&nbsp;<span class="builtinfunc" id="4621480">new</span><span class="op" id="4621483">(</span><span class="ident" id="4621484">asn1</span><span class="op" id="4621488">.</span><span class="ident" id="4621489">ObjectIdentifier</span><span class="op" id="4621505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621509">if</span>&nbsp;<span class="ident" id="4621512">_</span><span class="op" id="4621513">,</span>&nbsp;<span class="ident" id="4621515">err</span>&nbsp;<span class="op" id="4621519">:=</span>&nbsp;<span class="ident" id="4621522">asn1</span><span class="op" id="4621526">.</span><span class="ident" id="4621527">Unmarshal</span><span class="op" id="4621536">(</span><span class="ident" id="4621537">bytes</span><span class="op" id="4621542">,</span>&nbsp;<span class="ident" id="4621544">namedCurveOID</span><span class="op" id="4621557">)</span><span class="op" id="4621558">;</span>&nbsp;<span class="ident" id="4621560">err</span>&nbsp;<span class="op" id="4621564">!=</span>&nbsp;<span class="ident" id="4621567">nil</span>&nbsp;<span class="op" id="4621571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621576">namedCurveOID</span>&nbsp;<span class="op" id="4621590">=</span>&nbsp;<span class="ident" id="4621592">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621598">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621602">key</span><span class="op" id="4621605">,</span>&nbsp;<span class="ident" id="4621607">err</span>&nbsp;<span class="op" id="4621611">=</span>&nbsp;<span class="ident" id="4621613">parseECPrivateKey</span><span class="op" id="4621630">(</span><span class="ident" id="4621631">namedCurveOID</span><span class="op" id="4621644">,</span>&nbsp;<span class="ident" id="4621646">privKey</span><span class="op" id="4621653">.</span><span class="ident" id="4621654">PrivateKey</span><span class="op" id="4621664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621668">if</span>&nbsp;<span class="ident" id="4621671">err</span>&nbsp;<span class="op" id="4621675">!=</span>&nbsp;<span class="ident" id="4621678">nil</span>&nbsp;<span class="op" id="4621682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621687">return</span>&nbsp;<span class="ident" id="4621694">nil</span><span class="op" id="4621697">,</span>&nbsp;<span class="ident" id="4621699">errors</span><span class="op" id="4621705">.</span><span class="ident" id="4621706">New</span><span class="op" id="4621709">(</span><span class="string" id="4621710">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4621770">+</span>&nbsp;<span class="ident" id="4621772">err</span><span class="op" id="4621775">.</span><span class="ident" id="4621776">Error</span><span class="op" id="4621781">(</span><span class="op" id="4621782">)</span><span class="op" id="4621783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621791">return</span>&nbsp;<span class="ident" id="4621798">key</span><span class="op" id="4621801">,</span>&nbsp;<span class="ident" id="4621803">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621809">default</span><span class="op" id="4621816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621820">return</span>&nbsp;<span class="ident" id="4621827">nil</span><span class="op" id="4621830">,</span>&nbsp;<span class="ident" id="4621832">fmt</span><span class="op" id="4621835">.</span><span class="ident" id="4621836">Errorf</span><span class="op" id="4621842">(</span><span class="string" id="4621843">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4621915">,</span>&nbsp;<span class="ident" id="4621917">privKey</span><span class="op" id="4621924">.</span><span class="ident" id="4621925">Algo</span><span class="op" id="4621929">.</span><span class="ident" id="4621930">Algorithm</span><span class="op" id="4621939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621942">}</span><br>
<span class="lineno"></span><span class="op" id="4621944">}</span>
</div>
</body>
</html>
