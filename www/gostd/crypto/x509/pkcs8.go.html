<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3951282">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3951337">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3951391">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3951442">package</span>&nbsp;<span class="ident" id="3951450">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951456">import</span>&nbsp;<span class="op" id="3951463">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951466">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951486">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951503">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951513">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="3951519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951522">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="3951573">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="3951633">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="3951649">type</span>&nbsp;<span class="ident" id="3951654">pkcs8</span>&nbsp;<span class="keyword" id="3951660">struct</span>&nbsp;<span class="op" id="3951667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951670">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3951681">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951686">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3951697">pkix</span><span class="op" id="3951701">.</span><span class="ident" id="3951702">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951723">PrivateKey</span>&nbsp;<span class="op" id="3951734">[</span><span class="op" id="3951735">]</span><span class="builtintype" id="3951736">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3951742">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="3951774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951777">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="3951848">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="3951908">func</span>&nbsp;<span class="ident" id="3951913">ParsePKCS8PrivateKey</span><span class="op" id="3951933">(</span><span class="ident" id="3951934">der</span>&nbsp;<span class="op" id="3951938">[</span><span class="op" id="3951939">]</span><span class="builtintype" id="3951940">byte</span><span class="op" id="3951944">)</span>&nbsp;<span class="op" id="3951946">(</span><span class="ident" id="3951947">key</span>&nbsp;<span class="keyword" id="3951951">interface</span><span class="op" id="3951960">{</span><span class="op" id="3951961">}</span><span class="op" id="3951962">,</span>&nbsp;<span class="ident" id="3951964">err</span>&nbsp;<span class="builtintype" id="3951968">error</span><span class="op" id="3951973">)</span>&nbsp;<span class="op" id="3951975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951978">var</span>&nbsp;<span class="ident" id="3951982">privKey</span>&nbsp;<span class="ident" id="3951990">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951997">if</span>&nbsp;<span class="ident" id="3952000">_</span><span class="op" id="3952001">,</span>&nbsp;<span class="ident" id="3952003">err</span>&nbsp;<span class="op" id="3952007">:=</span>&nbsp;<span class="ident" id="3952010">asn1</span><span class="op" id="3952014">.</span><span class="ident" id="3952015">Unmarshal</span><span class="op" id="3952024">(</span><span class="ident" id="3952025">der</span><span class="op" id="3952028">,</span>&nbsp;<span class="op" id="3952030">&amp;</span><span class="ident" id="3952031">privKey</span><span class="op" id="3952038">)</span><span class="op" id="3952039">;</span>&nbsp;<span class="ident" id="3952041">err</span>&nbsp;<span class="op" id="3952045">!=</span>&nbsp;<span class="ident" id="3952048">nil</span>&nbsp;<span class="op" id="3952052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952056">return</span>&nbsp;<span class="ident" id="3952063">nil</span><span class="op" id="3952066">,</span>&nbsp;<span class="ident" id="3952068">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952076">switch</span>&nbsp;<span class="op" id="3952083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952086">case</span>&nbsp;<span class="ident" id="3952091">privKey</span><span class="op" id="3952098">.</span><span class="ident" id="3952099">Algo</span><span class="op" id="3952103">.</span><span class="ident" id="3952104">Algorithm</span><span class="op" id="3952113">.</span><span class="ident" id="3952114">Equal</span><span class="op" id="3952119">(</span><span class="ident" id="3952120">oidPublicKeyRSA</span><span class="op" id="3952135">)</span><span class="op" id="3952136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952140">key</span><span class="op" id="3952143">,</span>&nbsp;<span class="ident" id="3952145">err</span>&nbsp;<span class="op" id="3952149">=</span>&nbsp;<span class="ident" id="3952151">ParsePKCS1PrivateKey</span><span class="op" id="3952171">(</span><span class="ident" id="3952172">privKey</span><span class="op" id="3952179">.</span><span class="ident" id="3952180">PrivateKey</span><span class="op" id="3952190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952194">if</span>&nbsp;<span class="ident" id="3952197">err</span>&nbsp;<span class="op" id="3952201">!=</span>&nbsp;<span class="ident" id="3952204">nil</span>&nbsp;<span class="op" id="3952208">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952213">return</span>&nbsp;<span class="ident" id="3952220">nil</span><span class="op" id="3952223">,</span>&nbsp;<span class="ident" id="3952225">errors</span><span class="op" id="3952231">.</span><span class="ident" id="3952232">New</span><span class="op" id="3952235">(</span><span class="string" id="3952236">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="3952297">+</span>&nbsp;<span class="ident" id="3952299">err</span><span class="op" id="3952302">.</span><span class="ident" id="3952303">Error</span><span class="op" id="3952308">(</span><span class="op" id="3952309">)</span><span class="op" id="3952310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952318">return</span>&nbsp;<span class="ident" id="3952325">key</span><span class="op" id="3952328">,</span>&nbsp;<span class="ident" id="3952330">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952336">case</span>&nbsp;<span class="ident" id="3952341">privKey</span><span class="op" id="3952348">.</span><span class="ident" id="3952349">Algo</span><span class="op" id="3952353">.</span><span class="ident" id="3952354">Algorithm</span><span class="op" id="3952363">.</span><span class="ident" id="3952364">Equal</span><span class="op" id="3952369">(</span><span class="ident" id="3952370">oidPublicKeyECDSA</span><span class="op" id="3952387">)</span><span class="op" id="3952388">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952392">bytes</span>&nbsp;<span class="op" id="3952398">:=</span>&nbsp;<span class="ident" id="3952401">privKey</span><span class="op" id="3952408">.</span><span class="ident" id="3952409">Algo</span><span class="op" id="3952413">.</span><span class="ident" id="3952414">Parameters</span><span class="op" id="3952424">.</span><span class="ident" id="3952425">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952437">namedCurveOID</span>&nbsp;<span class="op" id="3952451">:=</span>&nbsp;<span class="builtinfunc" id="3952454">new</span><span class="op" id="3952457">(</span><span class="ident" id="3952458">asn1</span><span class="op" id="3952462">.</span><span class="ident" id="3952463">ObjectIdentifier</span><span class="op" id="3952479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952483">if</span>&nbsp;<span class="ident" id="3952486">_</span><span class="op" id="3952487">,</span>&nbsp;<span class="ident" id="3952489">err</span>&nbsp;<span class="op" id="3952493">:=</span>&nbsp;<span class="ident" id="3952496">asn1</span><span class="op" id="3952500">.</span><span class="ident" id="3952501">Unmarshal</span><span class="op" id="3952510">(</span><span class="ident" id="3952511">bytes</span><span class="op" id="3952516">,</span>&nbsp;<span class="ident" id="3952518">namedCurveOID</span><span class="op" id="3952531">)</span><span class="op" id="3952532">;</span>&nbsp;<span class="ident" id="3952534">err</span>&nbsp;<span class="op" id="3952538">!=</span>&nbsp;<span class="ident" id="3952541">nil</span>&nbsp;<span class="op" id="3952545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952550">namedCurveOID</span>&nbsp;<span class="op" id="3952564">=</span>&nbsp;<span class="ident" id="3952566">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952572">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952576">key</span><span class="op" id="3952579">,</span>&nbsp;<span class="ident" id="3952581">err</span>&nbsp;<span class="op" id="3952585">=</span>&nbsp;<span class="ident" id="3952587">parseECPrivateKey</span><span class="op" id="3952604">(</span><span class="ident" id="3952605">namedCurveOID</span><span class="op" id="3952618">,</span>&nbsp;<span class="ident" id="3952620">privKey</span><span class="op" id="3952627">.</span><span class="ident" id="3952628">PrivateKey</span><span class="op" id="3952638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952642">if</span>&nbsp;<span class="ident" id="3952645">err</span>&nbsp;<span class="op" id="3952649">!=</span>&nbsp;<span class="ident" id="3952652">nil</span>&nbsp;<span class="op" id="3952656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952661">return</span>&nbsp;<span class="ident" id="3952668">nil</span><span class="op" id="3952671">,</span>&nbsp;<span class="ident" id="3952673">errors</span><span class="op" id="3952679">.</span><span class="ident" id="3952680">New</span><span class="op" id="3952683">(</span><span class="string" id="3952684">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="3952744">+</span>&nbsp;<span class="ident" id="3952746">err</span><span class="op" id="3952749">.</span><span class="ident" id="3952750">Error</span><span class="op" id="3952755">(</span><span class="op" id="3952756">)</span><span class="op" id="3952757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952765">return</span>&nbsp;<span class="ident" id="3952772">key</span><span class="op" id="3952775">,</span>&nbsp;<span class="ident" id="3952777">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952783">default</span><span class="op" id="3952790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952794">return</span>&nbsp;<span class="ident" id="3952801">nil</span><span class="op" id="3952804">,</span>&nbsp;<span class="ident" id="3952806">fmt</span><span class="op" id="3952809">.</span><span class="ident" id="3952810">Errorf</span><span class="op" id="3952816">(</span><span class="string" id="3952817">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="3952889">,</span>&nbsp;<span class="ident" id="3952891">privKey</span><span class="op" id="3952898">.</span><span class="ident" id="3952899">Algo</span><span class="op" id="3952903">.</span><span class="ident" id="3952904">Algorithm</span><span class="op" id="3952913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952916">}</span><br>
<span class="lineno"></span><span class="op" id="3952918">}</span>
</div>
</body>
</html>
