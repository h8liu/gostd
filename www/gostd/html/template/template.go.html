<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html" class="current">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5091787">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5091842">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5091896">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5091947">package</span>&nbsp;<span class="ident" id="5091955">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5091965">import</span>&nbsp;<span class="op" id="5091972">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5091975">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5091982">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5091988">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5092001">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5092018">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5092026">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5092043">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5092065">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5092068">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="5092148">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="5092175">type</span>&nbsp;<span class="ident" id="5092180">Template</span>&nbsp;<span class="keyword" id="5092189">struct</span>&nbsp;<span class="op" id="5092196">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5092199">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5092235">escapeErr</span>&nbsp;<span class="builtintype" id="5092245">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5092252">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5092326">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5092395">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5092419">text</span>&nbsp;<span class="op" id="5092424">*</span><span class="ident" id="5092425">template</span><span class="op" id="5092433">.</span><span class="ident" id="5092434">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5092444">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5092511">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5092522">*</span><span class="ident" id="5092523">parse</span><span class="op" id="5092528">.</span><span class="ident" id="5092529">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5092535">*</span><span class="ident" id="5092536">nameSpace</span>&nbsp;<span class="comment" id="5092546">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="5092584">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5092587">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="5092652">var</span>&nbsp;<span class="ident" id="5092656">escapeOK</span>&nbsp;<span class="op" id="5092665">=</span>&nbsp;<span class="ident" id="5092667">fmt</span><span class="op" id="5092670">.</span><span class="ident" id="5092671">Errorf</span><span class="op" id="5092677">(</span><span class="string" id="5092678">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="5092706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5092709">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="5092787">type</span>&nbsp;<span class="ident" id="5092792">nameSpace</span>&nbsp;<span class="keyword" id="5092802">struct</span>&nbsp;<span class="op" id="5092809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5092812">mu</span>&nbsp;&nbsp;<span class="ident" id="5092816">sync</span><span class="op" id="5092820">.</span><span class="ident" id="5092821">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5092828">set</span>&nbsp;<span class="keyword" id="5092832">map</span><span class="op" id="5092835">[</span><span class="builtintype" id="5092836">string</span><span class="op" id="5092842">]</span><span class="op" id="5092843">*</span><span class="ident" id="5092844">Template</span><br>
<span class="lineno"></span><span class="op" id="5092853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5092856">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="5092933">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="5092944">func</span>&nbsp;<span class="op" id="5092949">(</span><span class="ident" id="5092950">t</span>&nbsp;<span class="op" id="5092952">*</span><span class="ident" id="5092953">Template</span><span class="op" id="5092961">)</span>&nbsp;<span class="ident" id="5092963">Templates</span><span class="op" id="5092972">(</span><span class="op" id="5092973">)</span>&nbsp;<span class="op" id="5092975">[</span><span class="op" id="5092976">]</span><span class="op" id="5092977">*</span><span class="ident" id="5092978">Template</span>&nbsp;<span class="op" id="5092987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5092990">ns</span>&nbsp;<span class="op" id="5092993">:=</span>&nbsp;<span class="ident" id="5092996">t</span><span class="op" id="5092997">.</span><span class="ident" id="5092998">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5093009">ns</span><span class="op" id="5093011">.</span><span class="ident" id="5093012">mu</span><span class="op" id="5093014">.</span><span class="ident" id="5093015">Lock</span><span class="op" id="5093019">(</span><span class="op" id="5093020">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093023">defer</span>&nbsp;<span class="ident" id="5093029">ns</span><span class="op" id="5093031">.</span><span class="ident" id="5093032">mu</span><span class="op" id="5093034">.</span><span class="ident" id="5093035">Unlock</span><span class="op" id="5093041">(</span><span class="op" id="5093042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5093045">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5093092">m</span>&nbsp;<span class="op" id="5093094">:=</span>&nbsp;<span class="builtinfunc" id="5093097">make</span><span class="op" id="5093101">(</span><span class="op" id="5093102">[</span><span class="op" id="5093103">]</span><span class="op" id="5093104">*</span><span class="ident" id="5093105">Template</span><span class="op" id="5093113">,</span>&nbsp;<span class="num" id="5093115">0</span><span class="op" id="5093116">,</span>&nbsp;<span class="builtinfunc" id="5093118">len</span><span class="op" id="5093121">(</span><span class="ident" id="5093122">ns</span><span class="op" id="5093124">.</span><span class="ident" id="5093125">set</span><span class="op" id="5093128">)</span><span class="op" id="5093129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093132">for</span>&nbsp;<span class="ident" id="5093136">_</span><span class="op" id="5093137">,</span>&nbsp;<span class="ident" id="5093139">v</span>&nbsp;<span class="op" id="5093141">:=</span>&nbsp;<span class="keyword" id="5093144">range</span>&nbsp;<span class="ident" id="5093150">ns</span><span class="op" id="5093152">.</span><span class="ident" id="5093153">set</span>&nbsp;<span class="op" id="5093157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5093161">m</span>&nbsp;<span class="op" id="5093163">=</span>&nbsp;<span class="builtinfunc" id="5093165">append</span><span class="op" id="5093171">(</span><span class="ident" id="5093172">m</span><span class="op" id="5093173">,</span>&nbsp;<span class="ident" id="5093175">v</span><span class="op" id="5093176">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5093179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093182">return</span>&nbsp;<span class="ident" id="5093189">m</span><br>
<span class="lineno"></span><span class="op" id="5093191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5093194">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="5093238">func</span>&nbsp;<span class="op" id="5093243">(</span><span class="ident" id="5093244">t</span>&nbsp;<span class="op" id="5093246">*</span><span class="ident" id="5093247">Template</span><span class="op" id="5093255">)</span>&nbsp;<span class="ident" id="5093257">escape</span><span class="op" id="5093263">(</span><span class="op" id="5093264">)</span>&nbsp;<span class="builtintype" id="5093266">error</span>&nbsp;<span class="op" id="5093272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5093275">t</span><span class="op" id="5093276">.</span><span class="ident" id="5093277">nameSpace</span><span class="op" id="5093286">.</span><span class="ident" id="5093287">mu</span><span class="op" id="5093289">.</span><span class="ident" id="5093290">Lock</span><span class="op" id="5093294">(</span><span class="op" id="5093295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093298">defer</span>&nbsp;<span class="ident" id="5093304">t</span><span class="op" id="5093305">.</span><span class="ident" id="5093306">nameSpace</span><span class="op" id="5093315">.</span><span class="ident" id="5093316">mu</span><span class="op" id="5093318">.</span><span class="ident" id="5093319">Unlock</span><span class="op" id="5093325">(</span><span class="op" id="5093326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093329">if</span>&nbsp;<span class="ident" id="5093332">t</span><span class="op" id="5093333">.</span><span class="ident" id="5093334">escapeErr</span>&nbsp;<span class="op" id="5093344">==</span>&nbsp;<span class="ident" id="5093347">nil</span>&nbsp;<span class="op" id="5093351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093355">if</span>&nbsp;<span class="ident" id="5093358">err</span>&nbsp;<span class="op" id="5093362">:=</span>&nbsp;<span class="ident" id="5093365">escapeTemplate</span><span class="op" id="5093379">(</span><span class="ident" id="5093380">t</span><span class="op" id="5093381">,</span>&nbsp;<span class="ident" id="5093383">t</span><span class="op" id="5093384">.</span><span class="ident" id="5093385">text</span><span class="op" id="5093389">.</span><span class="ident" id="5093390">Root</span><span class="op" id="5093394">,</span>&nbsp;<span class="ident" id="5093396">t</span><span class="op" id="5093397">.</span><span class="ident" id="5093398">Name</span><span class="op" id="5093402">(</span><span class="op" id="5093403">)</span><span class="op" id="5093404">)</span><span class="op" id="5093405">;</span>&nbsp;<span class="ident" id="5093407">err</span>&nbsp;<span class="op" id="5093411">!=</span>&nbsp;<span class="ident" id="5093414">nil</span>&nbsp;<span class="op" id="5093418">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093423">return</span>&nbsp;<span class="ident" id="5093430">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5093436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5093439">}</span>&nbsp;<span class="keyword" id="5093441">else</span>&nbsp;<span class="keyword" id="5093446">if</span>&nbsp;<span class="ident" id="5093449">t</span><span class="op" id="5093450">.</span><span class="ident" id="5093451">escapeErr</span>&nbsp;<span class="op" id="5093461">!=</span>&nbsp;<span class="ident" id="5093464">escapeOK</span>&nbsp;<span class="op" id="5093473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093477">return</span>&nbsp;<span class="ident" id="5093484">t</span><span class="op" id="5093485">.</span><span class="ident" id="5093486">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5093497">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093500">return</span>&nbsp;<span class="ident" id="5093507">nil</span><br>
<span class="lineno"></span><span class="op" id="5093511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5093514">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="5093581">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="5093610">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5093678">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5093751">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5093773">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5093823">func</span>&nbsp;<span class="op" id="5093828">(</span><span class="ident" id="5093829">t</span>&nbsp;<span class="op" id="5093831">*</span><span class="ident" id="5093832">Template</span><span class="op" id="5093840">)</span>&nbsp;<span class="ident" id="5093842">Execute</span><span class="op" id="5093849">(</span><span class="ident" id="5093850">wr</span>&nbsp;<span class="ident" id="5093853">io</span><span class="op" id="5093855">.</span><span class="ident" id="5093856">Writer</span><span class="op" id="5093862">,</span>&nbsp;<span class="ident" id="5093864">data</span>&nbsp;<span class="keyword" id="5093869">interface</span><span class="op" id="5093878">{</span><span class="op" id="5093879">}</span><span class="op" id="5093880">)</span>&nbsp;<span class="builtintype" id="5093882">error</span>&nbsp;<span class="op" id="5093888">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093891">if</span>&nbsp;<span class="ident" id="5093894">err</span>&nbsp;<span class="op" id="5093898">:=</span>&nbsp;<span class="ident" id="5093901">t</span><span class="op" id="5093902">.</span><span class="ident" id="5093903">escape</span><span class="op" id="5093909">(</span><span class="op" id="5093910">)</span><span class="op" id="5093911">;</span>&nbsp;<span class="ident" id="5093913">err</span>&nbsp;<span class="op" id="5093917">!=</span>&nbsp;<span class="ident" id="5093920">nil</span>&nbsp;<span class="op" id="5093924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093928">return</span>&nbsp;<span class="ident" id="5093935">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5093940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5093943">return</span>&nbsp;<span class="ident" id="5093950">t</span><span class="op" id="5093951">.</span><span class="ident" id="5093952">text</span><span class="op" id="5093956">.</span><span class="ident" id="5093957">Execute</span><span class="op" id="5093964">(</span><span class="ident" id="5093965">wr</span><span class="op" id="5093967">,</span>&nbsp;<span class="ident" id="5093969">data</span><span class="op" id="5093973">)</span><br>
<span class="lineno"></span><span class="op" id="5093975">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="5093978">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="5094055">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="5094121">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="5094189">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="5094262">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="5094284">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="5094334">func</span>&nbsp;<span class="op" id="5094339">(</span><span class="ident" id="5094340">t</span>&nbsp;<span class="op" id="5094342">*</span><span class="ident" id="5094343">Template</span><span class="op" id="5094351">)</span>&nbsp;<span class="ident" id="5094353">ExecuteTemplate</span><span class="op" id="5094368">(</span><span class="ident" id="5094369">wr</span>&nbsp;<span class="ident" id="5094372">io</span><span class="op" id="5094374">.</span><span class="ident" id="5094375">Writer</span><span class="op" id="5094381">,</span>&nbsp;<span class="ident" id="5094383">name</span>&nbsp;<span class="builtintype" id="5094388">string</span><span class="op" id="5094394">,</span>&nbsp;<span class="ident" id="5094396">data</span>&nbsp;<span class="keyword" id="5094401">interface</span><span class="op" id="5094410">{</span><span class="op" id="5094411">}</span><span class="op" id="5094412">)</span>&nbsp;<span class="builtintype" id="5094414">error</span>&nbsp;<span class="op" id="5094420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5094423">tmpl</span><span class="op" id="5094427">,</span>&nbsp;<span class="ident" id="5094429">err</span>&nbsp;<span class="op" id="5094433">:=</span>&nbsp;<span class="ident" id="5094436">t</span><span class="op" id="5094437">.</span><span class="ident" id="5094438">lookupAndEscapeTemplate</span><span class="op" id="5094461">(</span><span class="ident" id="5094462">name</span><span class="op" id="5094466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094469">if</span>&nbsp;<span class="ident" id="5094472">err</span>&nbsp;<span class="op" id="5094476">!=</span>&nbsp;<span class="ident" id="5094479">nil</span>&nbsp;<span class="op" id="5094483">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094487">return</span>&nbsp;<span class="ident" id="5094494">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5094499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094502">return</span>&nbsp;<span class="ident" id="5094509">tmpl</span><span class="op" id="5094513">.</span><span class="ident" id="5094514">text</span><span class="op" id="5094518">.</span><span class="ident" id="5094519">Execute</span><span class="op" id="5094526">(</span><span class="ident" id="5094527">wr</span><span class="op" id="5094529">,</span>&nbsp;<span class="ident" id="5094531">data</span><span class="op" id="5094535">)</span><br>
<span class="lineno"></span><span class="op" id="5094537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="5094540">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5094616">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="5094689">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5094702">func</span>&nbsp;<span class="op" id="5094707">(</span><span class="ident" id="5094708">t</span>&nbsp;<span class="op" id="5094710">*</span><span class="ident" id="5094711">Template</span><span class="op" id="5094719">)</span>&nbsp;<span class="ident" id="5094721">lookupAndEscapeTemplate</span><span class="op" id="5094744">(</span><span class="ident" id="5094745">name</span>&nbsp;<span class="builtintype" id="5094750">string</span><span class="op" id="5094756">)</span>&nbsp;<span class="op" id="5094758">(</span><span class="ident" id="5094759">tmpl</span>&nbsp;<span class="op" id="5094764">*</span><span class="ident" id="5094765">Template</span><span class="op" id="5094773">,</span>&nbsp;<span class="ident" id="5094775">err</span>&nbsp;<span class="builtintype" id="5094779">error</span><span class="op" id="5094784">)</span>&nbsp;<span class="op" id="5094786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5094789">t</span><span class="op" id="5094790">.</span><span class="ident" id="5094791">nameSpace</span><span class="op" id="5094800">.</span><span class="ident" id="5094801">mu</span><span class="op" id="5094803">.</span><span class="ident" id="5094804">Lock</span><span class="op" id="5094808">(</span><span class="op" id="5094809">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094812">defer</span>&nbsp;<span class="ident" id="5094818">t</span><span class="op" id="5094819">.</span><span class="ident" id="5094820">nameSpace</span><span class="op" id="5094829">.</span><span class="ident" id="5094830">mu</span><span class="op" id="5094832">.</span><span class="ident" id="5094833">Unlock</span><span class="op" id="5094839">(</span><span class="op" id="5094840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5094843">tmpl</span>&nbsp;<span class="op" id="5094848">=</span>&nbsp;<span class="ident" id="5094850">t</span><span class="op" id="5094851">.</span><span class="ident" id="5094852">set</span><span class="op" id="5094855">[</span><span class="ident" id="5094856">name</span><span class="op" id="5094860">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094863">if</span>&nbsp;<span class="ident" id="5094866">tmpl</span>&nbsp;<span class="op" id="5094871">==</span>&nbsp;<span class="ident" id="5094874">nil</span>&nbsp;<span class="op" id="5094878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094882">return</span>&nbsp;<span class="ident" id="5094889">nil</span><span class="op" id="5094892">,</span>&nbsp;<span class="ident" id="5094894">fmt</span><span class="op" id="5094897">.</span><span class="ident" id="5094898">Errorf</span><span class="op" id="5094904">(</span><span class="string" id="5094905">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="5094937">,</span>&nbsp;<span class="ident" id="5094939">name</span><span class="op" id="5094943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5094946">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5094949">if</span>&nbsp;<span class="ident" id="5094952">tmpl</span><span class="op" id="5094956">.</span><span class="ident" id="5094957">escapeErr</span>&nbsp;<span class="op" id="5094967">!=</span>&nbsp;<span class="ident" id="5094970">nil</span>&nbsp;<span class="op" id="5094974">&amp;&amp;</span>&nbsp;<span class="ident" id="5094977">tmpl</span><span class="op" id="5094981">.</span><span class="ident" id="5094982">escapeErr</span>&nbsp;<span class="op" id="5094992">!=</span>&nbsp;<span class="ident" id="5094995">escapeOK</span>&nbsp;<span class="op" id="5095004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5095008">return</span>&nbsp;<span class="ident" id="5095015">nil</span><span class="op" id="5095018">,</span>&nbsp;<span class="ident" id="5095020">tmpl</span><span class="op" id="5095024">.</span><span class="ident" id="5095025">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5095036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5095039">if</span>&nbsp;<span class="ident" id="5095042">tmpl</span><span class="op" id="5095046">.</span><span class="ident" id="5095047">text</span><span class="op" id="5095051">.</span><span class="ident" id="5095052">Tree</span>&nbsp;<span class="op" id="5095057">==</span>&nbsp;<span class="ident" id="5095060">nil</span>&nbsp;<span class="op" id="5095064">||</span>&nbsp;<span class="ident" id="5095067">tmpl</span><span class="op" id="5095071">.</span><span class="ident" id="5095072">text</span><span class="op" id="5095076">.</span><span class="ident" id="5095077">Root</span>&nbsp;<span class="op" id="5095082">==</span>&nbsp;<span class="ident" id="5095085">nil</span>&nbsp;<span class="op" id="5095089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5095093">return</span>&nbsp;<span class="ident" id="5095100">nil</span><span class="op" id="5095103">,</span>&nbsp;<span class="ident" id="5095105">fmt</span><span class="op" id="5095108">.</span><span class="ident" id="5095109">Errorf</span><span class="op" id="5095115">(</span><span class="string" id="5095116">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="5095161">,</span>&nbsp;<span class="ident" id="5095163">name</span><span class="op" id="5095167">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5095170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5095173">if</span>&nbsp;<span class="ident" id="5095176">t</span><span class="op" id="5095177">.</span><span class="ident" id="5095178">text</span><span class="op" id="5095182">.</span><span class="ident" id="5095183">Lookup</span><span class="op" id="5095189">(</span><span class="ident" id="5095190">name</span><span class="op" id="5095194">)</span>&nbsp;<span class="op" id="5095196">==</span>&nbsp;<span class="ident" id="5095199">nil</span>&nbsp;<span class="op" id="5095203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5095207">panic</span><span class="op" id="5095212">(</span><span class="string" id="5095213">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="5095274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5095277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5095280">if</span>&nbsp;<span class="ident" id="5095283">tmpl</span><span class="op" id="5095287">.</span><span class="ident" id="5095288">escapeErr</span>&nbsp;<span class="op" id="5095298">==</span>&nbsp;<span class="ident" id="5095301">nil</span>&nbsp;<span class="op" id="5095305">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5095309">err</span>&nbsp;<span class="op" id="5095313">=</span>&nbsp;<span class="ident" id="5095315">escapeTemplate</span><span class="op" id="5095329">(</span><span class="ident" id="5095330">tmpl</span><span class="op" id="5095334">,</span>&nbsp;<span class="ident" id="5095336">tmpl</span><span class="op" id="5095340">.</span><span class="ident" id="5095341">text</span><span class="op" id="5095345">.</span><span class="ident" id="5095346">Root</span><span class="op" id="5095350">,</span>&nbsp;<span class="ident" id="5095352">name</span><span class="op" id="5095356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5095359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5095362">return</span>&nbsp;<span class="ident" id="5095369">tmpl</span><span class="op" id="5095373">,</span>&nbsp;<span class="ident" id="5095375">err</span><br>
<span class="lineno"></span><span class="op" id="5095379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="5095382">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="5095452">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5095518">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="5095590">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="5095663">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="5095727">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="5095798">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="5095865">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="5095923">func</span>&nbsp;<span class="op" id="5095928">(</span><span class="ident" id="5095929">t</span>&nbsp;<span class="op" id="5095931">*</span><span class="ident" id="5095932">Template</span><span class="op" id="5095940">)</span>&nbsp;<span class="ident" id="5095942">Parse</span><span class="op" id="5095947">(</span><span class="ident" id="5095948">src</span>&nbsp;<span class="builtintype" id="5095952">string</span><span class="op" id="5095958">)</span>&nbsp;<span class="op" id="5095960">(</span><span class="op" id="5095961">*</span><span class="ident" id="5095962">Template</span><span class="op" id="5095970">,</span>&nbsp;<span class="builtintype" id="5095972">error</span><span class="op" id="5095977">)</span>&nbsp;<span class="op" id="5095979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5095982">t</span><span class="op" id="5095983">.</span><span class="ident" id="5095984">nameSpace</span><span class="op" id="5095993">.</span><span class="ident" id="5095994">mu</span><span class="op" id="5095996">.</span><span class="ident" id="5095997">Lock</span><span class="op" id="5096001">(</span><span class="op" id="5096002">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096005">t</span><span class="op" id="5096006">.</span><span class="ident" id="5096007">escapeErr</span>&nbsp;<span class="op" id="5096017">=</span>&nbsp;<span class="ident" id="5096019">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096024">t</span><span class="op" id="5096025">.</span><span class="ident" id="5096026">nameSpace</span><span class="op" id="5096035">.</span><span class="ident" id="5096036">mu</span><span class="op" id="5096038">.</span><span class="ident" id="5096039">Unlock</span><span class="op" id="5096045">(</span><span class="op" id="5096046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096049">ret</span><span class="op" id="5096052">,</span>&nbsp;<span class="ident" id="5096054">err</span>&nbsp;<span class="op" id="5096058">:=</span>&nbsp;<span class="ident" id="5096061">t</span><span class="op" id="5096062">.</span><span class="ident" id="5096063">text</span><span class="op" id="5096067">.</span><span class="ident" id="5096068">Parse</span><span class="op" id="5096073">(</span><span class="ident" id="5096074">src</span><span class="op" id="5096077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096080">if</span>&nbsp;<span class="ident" id="5096083">err</span>&nbsp;<span class="op" id="5096087">!=</span>&nbsp;<span class="ident" id="5096090">nil</span>&nbsp;<span class="op" id="5096094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096098">return</span>&nbsp;<span class="ident" id="5096105">nil</span><span class="op" id="5096108">,</span>&nbsp;<span class="ident" id="5096110">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096118">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096188">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096241">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096302">t</span><span class="op" id="5096303">.</span><span class="ident" id="5096304">nameSpace</span><span class="op" id="5096313">.</span><span class="ident" id="5096314">mu</span><span class="op" id="5096316">.</span><span class="ident" id="5096317">Lock</span><span class="op" id="5096321">(</span><span class="op" id="5096322">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096325">defer</span>&nbsp;<span class="ident" id="5096331">t</span><span class="op" id="5096332">.</span><span class="ident" id="5096333">nameSpace</span><span class="op" id="5096342">.</span><span class="ident" id="5096343">mu</span><span class="op" id="5096345">.</span><span class="ident" id="5096346">Unlock</span><span class="op" id="5096352">(</span><span class="op" id="5096353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096356">for</span>&nbsp;<span class="ident" id="5096360">_</span><span class="op" id="5096361">,</span>&nbsp;<span class="ident" id="5096363">v</span>&nbsp;<span class="op" id="5096365">:=</span>&nbsp;<span class="keyword" id="5096368">range</span>&nbsp;<span class="ident" id="5096374">ret</span><span class="op" id="5096377">.</span><span class="ident" id="5096378">Templates</span><span class="op" id="5096387">(</span><span class="op" id="5096388">)</span>&nbsp;<span class="op" id="5096390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096394">name</span>&nbsp;<span class="op" id="5096399">:=</span>&nbsp;<span class="ident" id="5096402">v</span><span class="op" id="5096403">.</span><span class="ident" id="5096404">Name</span><span class="op" id="5096408">(</span><span class="op" id="5096409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096413">tmpl</span>&nbsp;<span class="op" id="5096418">:=</span>&nbsp;<span class="ident" id="5096421">t</span><span class="op" id="5096422">.</span><span class="ident" id="5096423">set</span><span class="op" id="5096426">[</span><span class="ident" id="5096427">name</span><span class="op" id="5096431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096435">if</span>&nbsp;<span class="ident" id="5096438">tmpl</span>&nbsp;<span class="op" id="5096443">==</span>&nbsp;<span class="ident" id="5096446">nil</span>&nbsp;<span class="op" id="5096450">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096455">tmpl</span>&nbsp;<span class="op" id="5096460">=</span>&nbsp;<span class="ident" id="5096462">t</span><span class="op" id="5096463">.</span><span class="builtinfunc" id="5096464">new</span><span class="op" id="5096467">(</span><span class="ident" id="5096468">name</span><span class="op" id="5096472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5096480">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096559">tmpl</span><span class="op" id="5096563">.</span><span class="ident" id="5096564">escapeErr</span>&nbsp;<span class="op" id="5096574">=</span>&nbsp;<span class="ident" id="5096576">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096582">tmpl</span><span class="op" id="5096586">.</span><span class="ident" id="5096587">text</span>&nbsp;<span class="op" id="5096592">=</span>&nbsp;<span class="ident" id="5096594">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096598">tmpl</span><span class="op" id="5096602">.</span><span class="ident" id="5096603">Tree</span>&nbsp;<span class="op" id="5096608">=</span>&nbsp;<span class="ident" id="5096610">v</span><span class="op" id="5096611">.</span><span class="ident" id="5096612">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5096618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096621">return</span>&nbsp;<span class="ident" id="5096628">t</span><span class="op" id="5096629">,</span>&nbsp;<span class="ident" id="5096631">nil</span><br>
<span class="lineno"></span><span class="op" id="5096635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="5096638">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="5096706">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="5096735">//</span><br>
<span class="lineno"></span><span class="comment" id="5096738">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5096793">func</span>&nbsp;<span class="op" id="5096798">(</span><span class="ident" id="5096799">t</span>&nbsp;<span class="op" id="5096801">*</span><span class="ident" id="5096802">Template</span><span class="op" id="5096810">)</span>&nbsp;<span class="ident" id="5096812">AddParseTree</span><span class="op" id="5096824">(</span><span class="ident" id="5096825">name</span>&nbsp;<span class="builtintype" id="5096830">string</span><span class="op" id="5096836">,</span>&nbsp;<span class="ident" id="5096838">tree</span>&nbsp;<span class="op" id="5096843">*</span><span class="ident" id="5096844">parse</span><span class="op" id="5096849">.</span><span class="ident" id="5096850">Tree</span><span class="op" id="5096854">)</span>&nbsp;<span class="op" id="5096856">(</span><span class="op" id="5096857">*</span><span class="ident" id="5096858">Template</span><span class="op" id="5096866">,</span>&nbsp;<span class="builtintype" id="5096868">error</span><span class="op" id="5096873">)</span>&nbsp;<span class="op" id="5096875">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5096878">t</span><span class="op" id="5096879">.</span><span class="ident" id="5096880">nameSpace</span><span class="op" id="5096889">.</span><span class="ident" id="5096890">mu</span><span class="op" id="5096892">.</span><span class="ident" id="5096893">Lock</span><span class="op" id="5096897">(</span><span class="op" id="5096898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096901">defer</span>&nbsp;<span class="ident" id="5096907">t</span><span class="op" id="5096908">.</span><span class="ident" id="5096909">nameSpace</span><span class="op" id="5096918">.</span><span class="ident" id="5096919">mu</span><span class="op" id="5096921">.</span><span class="ident" id="5096922">Unlock</span><span class="op" id="5096928">(</span><span class="op" id="5096929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096932">if</span>&nbsp;<span class="ident" id="5096935">t</span><span class="op" id="5096936">.</span><span class="ident" id="5096937">escapeErr</span>&nbsp;<span class="op" id="5096947">!=</span>&nbsp;<span class="ident" id="5096950">nil</span>&nbsp;<span class="op" id="5096954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5096958">return</span>&nbsp;<span class="ident" id="5096965">nil</span><span class="op" id="5096968">,</span>&nbsp;<span class="ident" id="5096970">fmt</span><span class="op" id="5096973">.</span><span class="ident" id="5096974">Errorf</span><span class="op" id="5096980">(</span><span class="string" id="5096981">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5097045">,</span>&nbsp;<span class="ident" id="5097047">t</span><span class="op" id="5097048">.</span><span class="ident" id="5097049">Name</span><span class="op" id="5097053">(</span><span class="op" id="5097054">)</span><span class="op" id="5097055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097058">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097061">text</span><span class="op" id="5097065">,</span>&nbsp;<span class="ident" id="5097067">err</span>&nbsp;<span class="op" id="5097071">:=</span>&nbsp;<span class="ident" id="5097074">t</span><span class="op" id="5097075">.</span><span class="ident" id="5097076">text</span><span class="op" id="5097080">.</span><span class="ident" id="5097081">AddParseTree</span><span class="op" id="5097093">(</span><span class="ident" id="5097094">name</span><span class="op" id="5097098">,</span>&nbsp;<span class="ident" id="5097100">tree</span><span class="op" id="5097104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097107">if</span>&nbsp;<span class="ident" id="5097110">err</span>&nbsp;<span class="op" id="5097114">!=</span>&nbsp;<span class="ident" id="5097117">nil</span>&nbsp;<span class="op" id="5097121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097125">return</span>&nbsp;<span class="ident" id="5097132">nil</span><span class="op" id="5097135">,</span>&nbsp;<span class="ident" id="5097137">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097145">ret</span>&nbsp;<span class="op" id="5097149">:=</span>&nbsp;<span class="op" id="5097152">&amp;</span><span class="ident" id="5097153">Template</span><span class="op" id="5097161">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097165">nil</span><span class="op" id="5097168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097172">text</span><span class="op" id="5097176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097180">text</span><span class="op" id="5097184">.</span><span class="ident" id="5097185">Tree</span><span class="op" id="5097189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097193">t</span><span class="op" id="5097194">.</span><span class="ident" id="5097195">nameSpace</span><span class="op" id="5097204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097207">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097210">t</span><span class="op" id="5097211">.</span><span class="ident" id="5097212">set</span><span class="op" id="5097215">[</span><span class="ident" id="5097216">name</span><span class="op" id="5097220">]</span>&nbsp;<span class="op" id="5097222">=</span>&nbsp;<span class="ident" id="5097224">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097229">return</span>&nbsp;<span class="ident" id="5097236">ret</span><span class="op" id="5097239">,</span>&nbsp;<span class="ident" id="5097241">nil</span><br>
<span class="lineno"></span><span class="op" id="5097245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5097248">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="5097319">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5097396">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="5097471">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="5097550">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="5097628">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="5097679">//</span><br>
<span class="lineno"></span><span class="comment" id="5097682">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="5097737">func</span>&nbsp;<span class="op" id="5097742">(</span><span class="ident" id="5097743">t</span>&nbsp;<span class="op" id="5097745">*</span><span class="ident" id="5097746">Template</span><span class="op" id="5097754">)</span>&nbsp;<span class="ident" id="5097756">Clone</span><span class="op" id="5097761">(</span><span class="op" id="5097762">)</span>&nbsp;<span class="op" id="5097764">(</span><span class="op" id="5097765">*</span><span class="ident" id="5097766">Template</span><span class="op" id="5097774">,</span>&nbsp;<span class="builtintype" id="5097776">error</span><span class="op" id="5097781">)</span>&nbsp;<span class="op" id="5097783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097786">t</span><span class="op" id="5097787">.</span><span class="ident" id="5097788">nameSpace</span><span class="op" id="5097797">.</span><span class="ident" id="5097798">mu</span><span class="op" id="5097800">.</span><span class="ident" id="5097801">Lock</span><span class="op" id="5097805">(</span><span class="op" id="5097806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097809">defer</span>&nbsp;<span class="ident" id="5097815">t</span><span class="op" id="5097816">.</span><span class="ident" id="5097817">nameSpace</span><span class="op" id="5097826">.</span><span class="ident" id="5097827">mu</span><span class="op" id="5097829">.</span><span class="ident" id="5097830">Unlock</span><span class="op" id="5097836">(</span><span class="op" id="5097837">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097840">if</span>&nbsp;<span class="ident" id="5097843">t</span><span class="op" id="5097844">.</span><span class="ident" id="5097845">escapeErr</span>&nbsp;<span class="op" id="5097855">!=</span>&nbsp;<span class="ident" id="5097858">nil</span>&nbsp;<span class="op" id="5097862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097866">return</span>&nbsp;<span class="ident" id="5097873">nil</span><span class="op" id="5097876">,</span>&nbsp;<span class="ident" id="5097878">fmt</span><span class="op" id="5097881">.</span><span class="ident" id="5097882">Errorf</span><span class="op" id="5097888">(</span><span class="string" id="5097889">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5097943">,</span>&nbsp;<span class="ident" id="5097945">t</span><span class="op" id="5097946">.</span><span class="ident" id="5097947">Name</span><span class="op" id="5097951">(</span><span class="op" id="5097952">)</span><span class="op" id="5097953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5097956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5097959">textClone</span><span class="op" id="5097968">,</span>&nbsp;<span class="ident" id="5097970">err</span>&nbsp;<span class="op" id="5097974">:=</span>&nbsp;<span class="ident" id="5097977">t</span><span class="op" id="5097978">.</span><span class="ident" id="5097979">text</span><span class="op" id="5097983">.</span><span class="ident" id="5097984">Clone</span><span class="op" id="5097989">(</span><span class="op" id="5097990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5097993">if</span>&nbsp;<span class="ident" id="5097996">err</span>&nbsp;<span class="op" id="5098000">!=</span>&nbsp;<span class="ident" id="5098003">nil</span>&nbsp;<span class="op" id="5098007">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098011">return</span>&nbsp;<span class="ident" id="5098018">nil</span><span class="op" id="5098021">,</span>&nbsp;<span class="ident" id="5098023">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098031">ret</span>&nbsp;<span class="op" id="5098035">:=</span>&nbsp;<span class="op" id="5098038">&amp;</span><span class="ident" id="5098039">Template</span><span class="op" id="5098047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098051">nil</span><span class="op" id="5098054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098058">textClone</span><span class="op" id="5098067">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098071">textClone</span><span class="op" id="5098080">.</span><span class="ident" id="5098081">Tree</span><span class="op" id="5098085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098089">&amp;</span><span class="ident" id="5098090">nameSpace</span><span class="op" id="5098099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098104">set</span><span class="op" id="5098107">:</span>&nbsp;<span class="builtinfunc" id="5098109">make</span><span class="op" id="5098113">(</span><span class="keyword" id="5098114">map</span><span class="op" id="5098117">[</span><span class="builtintype" id="5098118">string</span><span class="op" id="5098124">]</span><span class="op" id="5098125">*</span><span class="ident" id="5098126">Template</span><span class="op" id="5098134">)</span><span class="op" id="5098135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098139">}</span><span class="op" id="5098140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098143">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098146">for</span>&nbsp;<span class="ident" id="5098150">_</span><span class="op" id="5098151">,</span>&nbsp;<span class="ident" id="5098153">x</span>&nbsp;<span class="op" id="5098155">:=</span>&nbsp;<span class="keyword" id="5098158">range</span>&nbsp;<span class="ident" id="5098164">textClone</span><span class="op" id="5098173">.</span><span class="ident" id="5098174">Templates</span><span class="op" id="5098183">(</span><span class="op" id="5098184">)</span>&nbsp;<span class="op" id="5098186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098190">name</span>&nbsp;<span class="op" id="5098195">:=</span>&nbsp;<span class="ident" id="5098198">x</span><span class="op" id="5098199">.</span><span class="ident" id="5098200">Name</span><span class="op" id="5098204">(</span><span class="op" id="5098205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098209">src</span>&nbsp;<span class="op" id="5098213">:=</span>&nbsp;<span class="ident" id="5098216">t</span><span class="op" id="5098217">.</span><span class="ident" id="5098218">set</span><span class="op" id="5098221">[</span><span class="ident" id="5098222">name</span><span class="op" id="5098226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098230">if</span>&nbsp;<span class="ident" id="5098233">src</span>&nbsp;<span class="op" id="5098237">==</span>&nbsp;<span class="ident" id="5098240">nil</span>&nbsp;<span class="op" id="5098244">||</span>&nbsp;<span class="ident" id="5098247">src</span><span class="op" id="5098250">.</span><span class="ident" id="5098251">escapeErr</span>&nbsp;<span class="op" id="5098261">!=</span>&nbsp;<span class="ident" id="5098264">nil</span>&nbsp;<span class="op" id="5098268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098273">return</span>&nbsp;<span class="ident" id="5098280">nil</span><span class="op" id="5098283">,</span>&nbsp;<span class="ident" id="5098285">fmt</span><span class="op" id="5098288">.</span><span class="ident" id="5098289">Errorf</span><span class="op" id="5098295">(</span><span class="string" id="5098296">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="5098350">,</span>&nbsp;<span class="ident" id="5098352">t</span><span class="op" id="5098353">.</span><span class="ident" id="5098354">Name</span><span class="op" id="5098358">(</span><span class="op" id="5098359">)</span><span class="op" id="5098360">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098368">x</span><span class="op" id="5098369">.</span><span class="ident" id="5098370">Tree</span>&nbsp;<span class="op" id="5098375">=</span>&nbsp;<span class="ident" id="5098377">x</span><span class="op" id="5098378">.</span><span class="ident" id="5098379">Tree</span><span class="op" id="5098383">.</span><span class="ident" id="5098384">Copy</span><span class="op" id="5098388">(</span><span class="op" id="5098389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098393">ret</span><span class="op" id="5098396">.</span><span class="ident" id="5098397">set</span><span class="op" id="5098400">[</span><span class="ident" id="5098401">name</span><span class="op" id="5098405">]</span>&nbsp;<span class="op" id="5098407">=</span>&nbsp;<span class="op" id="5098409">&amp;</span><span class="ident" id="5098410">Template</span><span class="op" id="5098418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098423">nil</span><span class="op" id="5098426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098431">x</span><span class="op" id="5098432">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098437">x</span><span class="op" id="5098438">.</span><span class="ident" id="5098439">Tree</span><span class="op" id="5098443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098448">ret</span><span class="op" id="5098451">.</span><span class="ident" id="5098452">nameSpace</span><span class="op" id="5098461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098471">return</span>&nbsp;<span class="ident" id="5098478">ret</span><span class="op" id="5098481">,</span>&nbsp;<span class="ident" id="5098483">nil</span><br>
<span class="lineno">220</span><span class="op" id="5098487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5098490">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5098548">func</span>&nbsp;<span class="ident" id="5098553">New</span><span class="op" id="5098556">(</span><span class="ident" id="5098557">name</span>&nbsp;<span class="builtintype" id="5098562">string</span><span class="op" id="5098568">)</span>&nbsp;<span class="op" id="5098570">*</span><span class="ident" id="5098571">Template</span>&nbsp;<span class="op" id="5098580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098583">tmpl</span>&nbsp;<span class="op" id="5098588">:=</span>&nbsp;<span class="op" id="5098591">&amp;</span><span class="ident" id="5098592">Template</span><span class="op" id="5098600">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098604">nil</span><span class="op" id="5098607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098611">template</span><span class="op" id="5098619">.</span><span class="ident" id="5098620">New</span><span class="op" id="5098623">(</span><span class="ident" id="5098624">name</span><span class="op" id="5098628">)</span><span class="op" id="5098629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098633">nil</span><span class="op" id="5098636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098640">&amp;</span><span class="ident" id="5098641">nameSpace</span><span class="op" id="5098650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098655">set</span><span class="op" id="5098658">:</span>&nbsp;<span class="builtinfunc" id="5098660">make</span><span class="op" id="5098664">(</span><span class="keyword" id="5098665">map</span><span class="op" id="5098668">[</span><span class="builtintype" id="5098669">string</span><span class="op" id="5098675">]</span><span class="op" id="5098676">*</span><span class="ident" id="5098677">Template</span><span class="op" id="5098685">)</span><span class="op" id="5098686">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098690">}</span><span class="op" id="5098691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5098694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098697">tmpl</span><span class="op" id="5098701">.</span><span class="ident" id="5098702">set</span><span class="op" id="5098705">[</span><span class="ident" id="5098706">name</span><span class="op" id="5098710">]</span>&nbsp;<span class="op" id="5098712">=</span>&nbsp;<span class="ident" id="5098714">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5098720">return</span>&nbsp;<span class="ident" id="5098727">tmpl</span><br>
<span class="lineno"></span><span class="op" id="5098732">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="5098735">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5098802">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="5098873">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="5098942">func</span>&nbsp;<span class="op" id="5098947">(</span><span class="ident" id="5098948">t</span>&nbsp;<span class="op" id="5098950">*</span><span class="ident" id="5098951">Template</span><span class="op" id="5098959">)</span>&nbsp;<span class="ident" id="5098961">New</span><span class="op" id="5098964">(</span><span class="ident" id="5098965">name</span>&nbsp;<span class="builtintype" id="5098970">string</span><span class="op" id="5098976">)</span>&nbsp;<span class="op" id="5098978">*</span><span class="ident" id="5098979">Template</span>&nbsp;<span class="op" id="5098988">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5098991">t</span><span class="op" id="5098992">.</span><span class="ident" id="5098993">nameSpace</span><span class="op" id="5099002">.</span><span class="ident" id="5099003">mu</span><span class="op" id="5099005">.</span><span class="ident" id="5099006">Lock</span><span class="op" id="5099010">(</span><span class="op" id="5099011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5099014">defer</span>&nbsp;<span class="ident" id="5099020">t</span><span class="op" id="5099021">.</span><span class="ident" id="5099022">nameSpace</span><span class="op" id="5099031">.</span><span class="ident" id="5099032">mu</span><span class="op" id="5099034">.</span><span class="ident" id="5099035">Unlock</span><span class="op" id="5099041">(</span><span class="op" id="5099042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5099045">return</span>&nbsp;<span class="ident" id="5099052">t</span><span class="op" id="5099053">.</span><span class="builtinfunc" id="5099054">new</span><span class="op" id="5099057">(</span><span class="ident" id="5099058">name</span><span class="op" id="5099062">)</span><br>
<span class="lineno"></span><span class="op" id="5099064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="5099067">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="5099122">func</span>&nbsp;<span class="op" id="5099127">(</span><span class="ident" id="5099128">t</span>&nbsp;<span class="op" id="5099130">*</span><span class="ident" id="5099131">Template</span><span class="op" id="5099139">)</span>&nbsp;<span class="builtinfunc" id="5099141">new</span><span class="op" id="5099144">(</span><span class="ident" id="5099145">name</span>&nbsp;<span class="builtintype" id="5099150">string</span><span class="op" id="5099156">)</span>&nbsp;<span class="op" id="5099158">*</span><span class="ident" id="5099159">Template</span>&nbsp;<span class="op" id="5099168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5099171">tmpl</span>&nbsp;<span class="op" id="5099176">:=</span>&nbsp;<span class="op" id="5099179">&amp;</span><span class="ident" id="5099180">Template</span><span class="op" id="5099188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5099192">nil</span><span class="op" id="5099195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5099199">t</span><span class="op" id="5099200">.</span><span class="ident" id="5099201">text</span><span class="op" id="5099205">.</span><span class="ident" id="5099206">New</span><span class="op" id="5099209">(</span><span class="ident" id="5099210">name</span><span class="op" id="5099214">)</span><span class="op" id="5099215">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5099219">nil</span><span class="op" id="5099222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5099226">t</span><span class="op" id="5099227">.</span><span class="ident" id="5099228">nameSpace</span><span class="op" id="5099237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5099240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5099243">tmpl</span><span class="op" id="5099247">.</span><span class="ident" id="5099248">set</span><span class="op" id="5099251">[</span><span class="ident" id="5099252">name</span><span class="op" id="5099256">]</span>&nbsp;<span class="op" id="5099258">=</span>&nbsp;<span class="ident" id="5099260">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5099266">return</span>&nbsp;<span class="ident" id="5099273">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="5099278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5099281">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5099323">func</span>&nbsp;<span class="op" id="5099328">(</span><span class="ident" id="5099329">t</span>&nbsp;<span class="op" id="5099331">*</span><span class="ident" id="5099332">Template</span><span class="op" id="5099340">)</span>&nbsp;<span class="ident" id="5099342">Name</span><span class="op" id="5099346">(</span><span class="op" id="5099347">)</span>&nbsp;<span class="builtintype" id="5099349">string</span>&nbsp;<span class="op" id="5099356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5099359">return</span>&nbsp;<span class="ident" id="5099366">t</span><span class="op" id="5099367">.</span><span class="ident" id="5099368">text</span><span class="op" id="5099372">.</span><span class="ident" id="5099373">Name</span><span class="op" id="5099377">(</span><span class="op" id="5099378">)</span><br>
<span class="lineno">260</span><span class="op" id="5099380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5099383">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5099452">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="5099527">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="5099601">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="5099677">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5099754">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="5099827">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="5099847">type</span>&nbsp;<span class="ident" id="5099852">FuncMap</span>&nbsp;<span class="keyword" id="5099860">map</span><span class="op" id="5099863">[</span><span class="builtintype" id="5099864">string</span><span class="op" id="5099870">]</span><span class="keyword" id="5099871">interface</span><span class="op" id="5099880">{</span><span class="op" id="5099881">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="5099884">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5099963">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5100040">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="5100115">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="5100166">func</span>&nbsp;<span class="op" id="5100171">(</span><span class="ident" id="5100172">t</span>&nbsp;<span class="op" id="5100174">*</span><span class="ident" id="5100175">Template</span><span class="op" id="5100183">)</span>&nbsp;<span class="ident" id="5100185">Funcs</span><span class="op" id="5100190">(</span><span class="ident" id="5100191">funcMap</span>&nbsp;<span class="ident" id="5100199">FuncMap</span><span class="op" id="5100206">)</span>&nbsp;<span class="op" id="5100208">*</span><span class="ident" id="5100209">Template</span>&nbsp;<span class="op" id="5100218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5100221">t</span><span class="op" id="5100222">.</span><span class="ident" id="5100223">text</span><span class="op" id="5100227">.</span><span class="ident" id="5100228">Funcs</span><span class="op" id="5100233">(</span><span class="ident" id="5100234">template</span><span class="op" id="5100242">.</span><span class="ident" id="5100243">FuncMap</span><span class="op" id="5100250">(</span><span class="ident" id="5100251">funcMap</span><span class="op" id="5100258">)</span><span class="op" id="5100259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5100262">return</span>&nbsp;<span class="ident" id="5100269">t</span><br>
<span class="lineno"></span><span class="op" id="5100271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="5100274">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5100351">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5100423">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5100499">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="5100535">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="5100597">func</span>&nbsp;<span class="op" id="5100602">(</span><span class="ident" id="5100603">t</span>&nbsp;<span class="op" id="5100605">*</span><span class="ident" id="5100606">Template</span><span class="op" id="5100614">)</span>&nbsp;<span class="ident" id="5100616">Delims</span><span class="op" id="5100622">(</span><span class="ident" id="5100623">left</span><span class="op" id="5100627">,</span>&nbsp;<span class="ident" id="5100629">right</span>&nbsp;<span class="builtintype" id="5100635">string</span><span class="op" id="5100641">)</span>&nbsp;<span class="op" id="5100643">*</span><span class="ident" id="5100644">Template</span>&nbsp;<span class="op" id="5100653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5100656">t</span><span class="op" id="5100657">.</span><span class="ident" id="5100658">text</span><span class="op" id="5100662">.</span><span class="ident" id="5100663">Delims</span><span class="op" id="5100669">(</span><span class="ident" id="5100670">left</span><span class="op" id="5100674">,</span>&nbsp;<span class="ident" id="5100676">right</span><span class="op" id="5100681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5100684">return</span>&nbsp;<span class="ident" id="5100691">t</span><br>
<span class="lineno"></span><span class="op" id="5100693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="5100696">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="5100774">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="5100814">func</span>&nbsp;<span class="op" id="5100819">(</span><span class="ident" id="5100820">t</span>&nbsp;<span class="op" id="5100822">*</span><span class="ident" id="5100823">Template</span><span class="op" id="5100831">)</span>&nbsp;<span class="ident" id="5100833">Lookup</span><span class="op" id="5100839">(</span><span class="ident" id="5100840">name</span>&nbsp;<span class="builtintype" id="5100845">string</span><span class="op" id="5100851">)</span>&nbsp;<span class="op" id="5100853">*</span><span class="ident" id="5100854">Template</span>&nbsp;<span class="op" id="5100863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5100866">t</span><span class="op" id="5100867">.</span><span class="ident" id="5100868">nameSpace</span><span class="op" id="5100877">.</span><span class="ident" id="5100878">mu</span><span class="op" id="5100880">.</span><span class="ident" id="5100881">Lock</span><span class="op" id="5100885">(</span><span class="op" id="5100886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5100889">defer</span>&nbsp;<span class="ident" id="5100895">t</span><span class="op" id="5100896">.</span><span class="ident" id="5100897">nameSpace</span><span class="op" id="5100906">.</span><span class="ident" id="5100907">mu</span><span class="op" id="5100909">.</span><span class="ident" id="5100910">Unlock</span><span class="op" id="5100916">(</span><span class="op" id="5100917">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5100920">return</span>&nbsp;<span class="ident" id="5100927">t</span><span class="op" id="5100928">.</span><span class="ident" id="5100929">set</span><span class="op" id="5100932">[</span><span class="ident" id="5100933">name</span><span class="op" id="5100937">]</span><br>
<span class="lineno"></span><span class="op" id="5100939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5100942">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="5101023">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="5101113">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5101124">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="5101185">func</span>&nbsp;<span class="ident" id="5101190">Must</span><span class="op" id="5101194">(</span><span class="ident" id="5101195">t</span>&nbsp;<span class="op" id="5101197">*</span><span class="ident" id="5101198">Template</span><span class="op" id="5101206">,</span>&nbsp;<span class="ident" id="5101208">err</span>&nbsp;<span class="builtintype" id="5101212">error</span><span class="op" id="5101217">)</span>&nbsp;<span class="op" id="5101219">*</span><span class="ident" id="5101220">Template</span>&nbsp;<span class="op" id="5101229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5101232">if</span>&nbsp;<span class="ident" id="5101235">err</span>&nbsp;<span class="op" id="5101239">!=</span>&nbsp;<span class="ident" id="5101242">nil</span>&nbsp;<span class="op" id="5101246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5101250">panic</span><span class="op" id="5101255">(</span><span class="ident" id="5101256">err</span><span class="op" id="5101259">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5101262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5101265">return</span>&nbsp;<span class="ident" id="5101272">t</span><br>
<span class="lineno"></span><span class="op" id="5101274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5101277">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="5101355">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5101434">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5101507">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5101579">func</span>&nbsp;<span class="ident" id="5101584">ParseFiles</span><span class="op" id="5101594">(</span><span class="ident" id="5101595">filenames</span>&nbsp;<span class="op" id="5101605">...</span><span class="builtintype" id="5101608">string</span><span class="op" id="5101614">)</span>&nbsp;<span class="op" id="5101616">(</span><span class="op" id="5101617">*</span><span class="ident" id="5101618">Template</span><span class="op" id="5101626">,</span>&nbsp;<span class="builtintype" id="5101628">error</span><span class="op" id="5101633">)</span>&nbsp;<span class="op" id="5101635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5101638">return</span>&nbsp;<span class="ident" id="5101645">parseFiles</span><span class="op" id="5101655">(</span><span class="ident" id="5101656">nil</span><span class="op" id="5101659">,</span>&nbsp;<span class="ident" id="5101661">filenames</span><span class="op" id="5101670">...</span><span class="op" id="5101673">)</span><br>
<span class="lineno">315</span><span class="op" id="5101675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5101678">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5101759">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5101833">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="5101888">func</span>&nbsp;<span class="op" id="5101893">(</span><span class="ident" id="5101894">t</span>&nbsp;<span class="op" id="5101896">*</span><span class="ident" id="5101897">Template</span><span class="op" id="5101905">)</span>&nbsp;<span class="ident" id="5101907">ParseFiles</span><span class="op" id="5101917">(</span><span class="ident" id="5101918">filenames</span>&nbsp;<span class="op" id="5101928">...</span><span class="builtintype" id="5101931">string</span><span class="op" id="5101937">)</span>&nbsp;<span class="op" id="5101939">(</span><span class="op" id="5101940">*</span><span class="ident" id="5101941">Template</span><span class="op" id="5101949">,</span>&nbsp;<span class="builtintype" id="5101951">error</span><span class="op" id="5101956">)</span>&nbsp;<span class="op" id="5101958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5101961">return</span>&nbsp;<span class="ident" id="5101968">parseFiles</span><span class="op" id="5101978">(</span><span class="ident" id="5101979">t</span><span class="op" id="5101980">,</span>&nbsp;<span class="ident" id="5101982">filenames</span><span class="op" id="5101991">...</span><span class="op" id="5101994">)</span><br>
<span class="lineno"></span><span class="op" id="5101996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5101999">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="5102072">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5102127">func</span>&nbsp;<span class="ident" id="5102132">parseFiles</span><span class="op" id="5102142">(</span><span class="ident" id="5102143">t</span>&nbsp;<span class="op" id="5102145">*</span><span class="ident" id="5102146">Template</span><span class="op" id="5102154">,</span>&nbsp;<span class="ident" id="5102156">filenames</span>&nbsp;<span class="op" id="5102166">...</span><span class="builtintype" id="5102169">string</span><span class="op" id="5102175">)</span>&nbsp;<span class="op" id="5102177">(</span><span class="op" id="5102178">*</span><span class="ident" id="5102179">Template</span><span class="op" id="5102187">,</span>&nbsp;<span class="builtintype" id="5102189">error</span><span class="op" id="5102194">)</span>&nbsp;<span class="op" id="5102196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102199">if</span>&nbsp;<span class="builtinfunc" id="5102202">len</span><span class="op" id="5102205">(</span><span class="ident" id="5102206">filenames</span><span class="op" id="5102215">)</span>&nbsp;<span class="op" id="5102217">==</span>&nbsp;<span class="num" id="5102220">0</span>&nbsp;<span class="op" id="5102222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102226">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102272">return</span>&nbsp;<span class="ident" id="5102279">nil</span><span class="op" id="5102282">,</span>&nbsp;<span class="ident" id="5102284">fmt</span><span class="op" id="5102287">.</span><span class="ident" id="5102288">Errorf</span><span class="op" id="5102294">(</span><span class="string" id="5102295">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="5102348">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5102351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102354">for</span>&nbsp;<span class="ident" id="5102358">_</span><span class="op" id="5102359">,</span>&nbsp;<span class="ident" id="5102361">filename</span>&nbsp;<span class="op" id="5102370">:=</span>&nbsp;<span class="keyword" id="5102373">range</span>&nbsp;<span class="ident" id="5102379">filenames</span>&nbsp;<span class="op" id="5102389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102393">b</span><span class="op" id="5102394">,</span>&nbsp;<span class="ident" id="5102396">err</span>&nbsp;<span class="op" id="5102400">:=</span>&nbsp;<span class="ident" id="5102403">ioutil</span><span class="op" id="5102409">.</span><span class="ident" id="5102410">ReadFile</span><span class="op" id="5102418">(</span><span class="ident" id="5102419">filename</span><span class="op" id="5102427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102431">if</span>&nbsp;<span class="ident" id="5102434">err</span>&nbsp;<span class="op" id="5102438">!=</span>&nbsp;<span class="ident" id="5102441">nil</span>&nbsp;<span class="op" id="5102445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102450">return</span>&nbsp;<span class="ident" id="5102457">nil</span><span class="op" id="5102460">,</span>&nbsp;<span class="ident" id="5102462">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5102468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102472">s</span>&nbsp;<span class="op" id="5102474">:=</span>&nbsp;<span class="builtintype" id="5102477">string</span><span class="op" id="5102483">(</span><span class="ident" id="5102484">b</span><span class="op" id="5102485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102489">name</span>&nbsp;<span class="op" id="5102494">:=</span>&nbsp;<span class="ident" id="5102497">filepath</span><span class="op" id="5102505">.</span><span class="ident" id="5102506">Base</span><span class="op" id="5102510">(</span><span class="ident" id="5102511">filename</span><span class="op" id="5102519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102523">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102588">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102651">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102721">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102772">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5102826">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102892">var</span>&nbsp;<span class="ident" id="5102896">tmpl</span>&nbsp;<span class="op" id="5102901">*</span><span class="ident" id="5102902">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102913">if</span>&nbsp;<span class="ident" id="5102916">t</span>&nbsp;<span class="op" id="5102918">==</span>&nbsp;<span class="ident" id="5102921">nil</span>&nbsp;<span class="op" id="5102925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102930">t</span>&nbsp;<span class="op" id="5102932">=</span>&nbsp;<span class="ident" id="5102934">New</span><span class="op" id="5102937">(</span><span class="ident" id="5102938">name</span><span class="op" id="5102942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5102946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5102950">if</span>&nbsp;<span class="ident" id="5102953">name</span>&nbsp;<span class="op" id="5102958">==</span>&nbsp;<span class="ident" id="5102961">t</span><span class="op" id="5102962">.</span><span class="ident" id="5102963">Name</span><span class="op" id="5102967">(</span><span class="op" id="5102968">)</span>&nbsp;<span class="op" id="5102970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102975">tmpl</span>&nbsp;<span class="op" id="5102980">=</span>&nbsp;<span class="ident" id="5102982">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5102986">}</span>&nbsp;<span class="keyword" id="5102988">else</span>&nbsp;<span class="op" id="5102993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5102998">tmpl</span>&nbsp;<span class="op" id="5103003">=</span>&nbsp;<span class="ident" id="5103005">t</span><span class="op" id="5103006">.</span><span class="ident" id="5103007">New</span><span class="op" id="5103010">(</span><span class="ident" id="5103011">name</span><span class="op" id="5103015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5103019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5103023">_</span><span class="op" id="5103024">,</span>&nbsp;<span class="ident" id="5103026">err</span>&nbsp;<span class="op" id="5103030">=</span>&nbsp;<span class="ident" id="5103032">tmpl</span><span class="op" id="5103036">.</span><span class="ident" id="5103037">Parse</span><span class="op" id="5103042">(</span><span class="ident" id="5103043">s</span><span class="op" id="5103044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103048">if</span>&nbsp;<span class="ident" id="5103051">err</span>&nbsp;<span class="op" id="5103055">!=</span>&nbsp;<span class="ident" id="5103058">nil</span>&nbsp;<span class="op" id="5103062">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103067">return</span>&nbsp;<span class="ident" id="5103074">nil</span><span class="op" id="5103077">,</span>&nbsp;<span class="ident" id="5103079">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5103085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5103088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103091">return</span>&nbsp;<span class="ident" id="5103098">t</span><span class="op" id="5103099">,</span>&nbsp;<span class="ident" id="5103101">nil</span><br>
<span class="lineno"></span><span class="op" id="5103105">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="5103108">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5103189">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="5103265">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5103341">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="5103414">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="5103475">func</span>&nbsp;<span class="ident" id="5103480">ParseGlob</span><span class="op" id="5103489">(</span><span class="ident" id="5103490">pattern</span>&nbsp;<span class="builtintype" id="5103498">string</span><span class="op" id="5103504">)</span>&nbsp;<span class="op" id="5103506">(</span><span class="op" id="5103507">*</span><span class="ident" id="5103508">Template</span><span class="op" id="5103516">,</span>&nbsp;<span class="builtintype" id="5103518">error</span><span class="op" id="5103523">)</span>&nbsp;<span class="op" id="5103525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103528">return</span>&nbsp;<span class="ident" id="5103535">parseGlob</span><span class="op" id="5103544">(</span><span class="ident" id="5103545">nil</span><span class="op" id="5103548">,</span>&nbsp;<span class="ident" id="5103550">pattern</span><span class="op" id="5103557">)</span><br>
<span class="lineno"></span><span class="op" id="5103559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="5103562">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5103638">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5103711">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5103788">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5103864">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="5103876">func</span>&nbsp;<span class="op" id="5103881">(</span><span class="ident" id="5103882">t</span>&nbsp;<span class="op" id="5103884">*</span><span class="ident" id="5103885">Template</span><span class="op" id="5103893">)</span>&nbsp;<span class="ident" id="5103895">ParseGlob</span><span class="op" id="5103904">(</span><span class="ident" id="5103905">pattern</span>&nbsp;<span class="builtintype" id="5103913">string</span><span class="op" id="5103919">)</span>&nbsp;<span class="op" id="5103921">(</span><span class="op" id="5103922">*</span><span class="ident" id="5103923">Template</span><span class="op" id="5103931">,</span>&nbsp;<span class="builtintype" id="5103933">error</span><span class="op" id="5103938">)</span>&nbsp;<span class="op" id="5103940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5103943">return</span>&nbsp;<span class="ident" id="5103950">parseGlob</span><span class="op" id="5103959">(</span><span class="ident" id="5103960">t</span><span class="op" id="5103961">,</span>&nbsp;<span class="ident" id="5103963">pattern</span><span class="op" id="5103970">)</span><br>
<span class="lineno"></span><span class="op" id="5103972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5103975">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="5104048">func</span>&nbsp;<span class="ident" id="5104053">parseGlob</span><span class="op" id="5104062">(</span><span class="ident" id="5104063">t</span>&nbsp;<span class="op" id="5104065">*</span><span class="ident" id="5104066">Template</span><span class="op" id="5104074">,</span>&nbsp;<span class="ident" id="5104076">pattern</span>&nbsp;<span class="builtintype" id="5104084">string</span><span class="op" id="5104090">)</span>&nbsp;<span class="op" id="5104092">(</span><span class="op" id="5104093">*</span><span class="ident" id="5104094">Template</span><span class="op" id="5104102">,</span>&nbsp;<span class="builtintype" id="5104104">error</span><span class="op" id="5104109">)</span>&nbsp;<span class="op" id="5104111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5104114">filenames</span><span class="op" id="5104123">,</span>&nbsp;<span class="ident" id="5104125">err</span>&nbsp;<span class="op" id="5104129">:=</span>&nbsp;<span class="ident" id="5104132">filepath</span><span class="op" id="5104140">.</span><span class="ident" id="5104141">Glob</span><span class="op" id="5104145">(</span><span class="ident" id="5104146">pattern</span><span class="op" id="5104153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104156">if</span>&nbsp;<span class="ident" id="5104159">err</span>&nbsp;<span class="op" id="5104163">!=</span>&nbsp;<span class="ident" id="5104166">nil</span>&nbsp;<span class="op" id="5104170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104174">return</span>&nbsp;<span class="ident" id="5104181">nil</span><span class="op" id="5104184">,</span>&nbsp;<span class="ident" id="5104186">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5104191">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104194">if</span>&nbsp;<span class="builtinfunc" id="5104197">len</span><span class="op" id="5104200">(</span><span class="ident" id="5104201">filenames</span><span class="op" id="5104210">)</span>&nbsp;<span class="op" id="5104212">==</span>&nbsp;<span class="num" id="5104215">0</span>&nbsp;<span class="op" id="5104217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104221">return</span>&nbsp;<span class="ident" id="5104228">nil</span><span class="op" id="5104231">,</span>&nbsp;<span class="ident" id="5104233">fmt</span><span class="op" id="5104236">.</span><span class="ident" id="5104237">Errorf</span><span class="op" id="5104243">(</span><span class="string" id="5104244">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="5104290">,</span>&nbsp;<span class="ident" id="5104292">pattern</span><span class="op" id="5104299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5104302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5104305">return</span>&nbsp;<span class="ident" id="5104312">parseFiles</span><span class="op" id="5104322">(</span><span class="ident" id="5104323">t</span><span class="op" id="5104324">,</span>&nbsp;<span class="ident" id="5104326">filenames</span><span class="op" id="5104335">...</span><span class="op" id="5104338">)</span><br>
<span class="lineno"></span><span class="op" id="5104340">}</span>
</div>
</body>
</html>
