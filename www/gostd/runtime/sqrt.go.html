<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html" class="current">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1685943">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1685998">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1686052">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1686103">//&nbsp;Copy&nbsp;of&nbsp;math/sqrt.go,&nbsp;here&nbsp;for&nbsp;use&nbsp;by&nbsp;ARM&nbsp;softfloat.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1686160">package</span>&nbsp;<span class="ident" id="1686168">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1686177">import</span>&nbsp;<span class="string" id="1686184">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1686194">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1686248">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_sqrt.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1686301">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1686356">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1686386">//</span><br>
<span class="lineno"></span><span class="comment" id="1686389">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1686445">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1686514">//</span><br>
<span class="lineno"></span><span class="comment" id="1686517">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1686576">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1686632">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1686689">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1686706">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1686762">//</span><br>
<span class="lineno">25</span><span class="comment" id="1686765">//&nbsp;__ieee754_sqrt(x)</span><br>
<span class="lineno"></span><span class="comment" id="1686786">//&nbsp;Return&nbsp;correctly&nbsp;rounded&nbsp;sqrt.</span><br>
<span class="lineno"></span><span class="comment" id="1686820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="1686875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Use&nbsp;the&nbsp;hardware&nbsp;sqrt&nbsp;if&nbsp;you&nbsp;have&nbsp;one&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1686930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------</span><br>
<span class="lineno">30</span><span class="comment" id="1686985">//&nbsp;Method:</span><br>
<span class="lineno"></span><span class="comment" id="1686996">//&nbsp;&nbsp;&nbsp;Bit&nbsp;by&nbsp;bit&nbsp;method&nbsp;using&nbsp;integer&nbsp;arithmetic.&nbsp;(Slow,&nbsp;but&nbsp;portable)</span><br>
<span class="lineno"></span><span class="comment" id="1687066">//&nbsp;&nbsp;&nbsp;1.&nbsp;Normalization</span><br>
<span class="lineno"></span><span class="comment" id="1687088">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scale&nbsp;x&nbsp;to&nbsp;y&nbsp;in&nbsp;[1,4)&nbsp;with&nbsp;even&nbsp;powers&nbsp;of&nbsp;2:</span><br>
<span class="lineno"></span><span class="comment" id="1687141">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find&nbsp;an&nbsp;integer&nbsp;k&nbsp;such&nbsp;that&nbsp;&nbsp;1&nbsp;&lt;=&nbsp;(y=x*2**(2k))&nbsp;&lt;&nbsp;4,&nbsp;then</span><br>
<span class="lineno">35</span><span class="comment" id="1687207">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;sqrt(y)</span><br>
<span class="lineno"></span><span class="comment" id="1687248">//&nbsp;&nbsp;&nbsp;2.&nbsp;Bit&nbsp;by&nbsp;bit&nbsp;computation</span><br>
<span class="lineno"></span><span class="comment" id="1687279">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;q&nbsp;&nbsp;=&nbsp;sqrt(y)&nbsp;truncated&nbsp;to&nbsp;i&nbsp;bit&nbsp;after&nbsp;binary&nbsp;point&nbsp;(q&nbsp;=&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="1687351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="1687418">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</span><br>
<span class="lineno">40</span><span class="comment" id="1687471">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;=&nbsp;2*q&nbsp;,&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;&nbsp;=&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;*&nbsp;(&nbsp;y&nbsp;-&nbsp;q&nbsp;&nbsp;).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1)</span><br>
<span class="lineno"></span><span class="comment" id="1687540">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1687593">//</span><br>
<span class="lineno"></span><span class="comment" id="1687596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;q&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;q&nbsp;,&nbsp;one&nbsp;checks&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="1687648">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno">45</span><span class="comment" id="1687680">//</span><br>
<span class="lineno"></span><span class="comment" id="1687683">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1687722">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(q&nbsp;+&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;&lt;=&nbsp;y.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2)</span><br>
<span class="lineno"></span><span class="comment" id="1687791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1687819">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)</span><br>
<span class="lineno">50</span><span class="comment" id="1687888">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;(2)&nbsp;is&nbsp;false,&nbsp;then&nbsp;q&nbsp;&nbsp;&nbsp;=&nbsp;q&nbsp;;&nbsp;otherwise&nbsp;q&nbsp;&nbsp;&nbsp;=&nbsp;q&nbsp;&nbsp;+&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="1687958">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1688017">//</span><br>
<span class="lineno"></span><span class="comment" id="1688020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With&nbsp;some&nbsp;algebraic&nbsp;manipulation,&nbsp;it&nbsp;is&nbsp;not&nbsp;difficult&nbsp;to&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="1688089">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;(2)&nbsp;is&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="1688123">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)</span><br>
<span class="lineno"></span><span class="comment" id="1688161">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;+&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3)</span><br>
<span class="lineno"></span><span class="comment" id="1688230">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1688274">//</span><br>
<span class="lineno"></span><span class="comment" id="1688277">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;advantage&nbsp;of&nbsp;(3)&nbsp;is&nbsp;that&nbsp;s&nbsp;&nbsp;and&nbsp;y&nbsp;&nbsp;can&nbsp;be&nbsp;computed&nbsp;by</span><br>
<span class="lineno">60</span><span class="comment" id="1688343">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1688390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;following&nbsp;recurrence&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="1688432">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(3)&nbsp;is&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1688460">//</span><br>
<span class="lineno"></span><span class="comment" id="1688463">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;s&nbsp;&nbsp;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;y&nbsp;&nbsp;&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4)</span><br>
<span class="lineno">65</span><span class="comment" id="1688532">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1688574">//</span><br>
<span class="lineno"></span><span class="comment" id="1688577">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise,</span><br>
<span class="lineno"></span><span class="comment" id="1688596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-(i+1)</span><br>
<span class="lineno"></span><span class="comment" id="1688654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;s&nbsp;&nbsp;+&nbsp;2&nbsp;&nbsp;,&nbsp;&nbsp;y&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;y&nbsp;&nbsp;-&nbsp;&nbsp;s&nbsp;&nbsp;-&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(5)</span><br>
<span class="lineno">70</span><span class="comment" id="1688723">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+1&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><br>
<span class="lineno"></span><span class="comment" id="1688771">//</span><br>
<span class="lineno"></span><span class="comment" id="1688774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;One&nbsp;may&nbsp;easily&nbsp;use&nbsp;induction&nbsp;to&nbsp;prove&nbsp;(4)&nbsp;and&nbsp;(5).</span><br>
<span class="lineno"></span><span class="comment" id="1688833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note.&nbsp;Since&nbsp;the&nbsp;left&nbsp;hand&nbsp;side&nbsp;of&nbsp;(3)&nbsp;contain&nbsp;only&nbsp;i+2&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="1688902">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;does&nbsp;not&nbsp;necessary&nbsp;to&nbsp;do&nbsp;a&nbsp;full&nbsp;(53-bit)&nbsp;comparison</span><br>
<span class="lineno">75</span><span class="comment" id="1688971">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;(3).</span><br>
<span class="lineno"></span><span class="comment" id="1688993">//&nbsp;&nbsp;&nbsp;3.&nbsp;Final&nbsp;rounding</span><br>
<span class="lineno"></span><span class="comment" id="1689016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;After&nbsp;generating&nbsp;the&nbsp;53&nbsp;bits&nbsp;result,&nbsp;we&nbsp;compute&nbsp;one&nbsp;more&nbsp;bit.</span><br>
<span class="lineno"></span><span class="comment" id="1689086">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Together&nbsp;with&nbsp;the&nbsp;remainder,&nbsp;we&nbsp;can&nbsp;decide&nbsp;whether&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1689149">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;is&nbsp;exact,&nbsp;bigger&nbsp;than&nbsp;1/2ulp,&nbsp;or&nbsp;less&nbsp;than&nbsp;1/2ulp</span><br>
<span class="lineno">80</span><span class="comment" id="1689214">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(it&nbsp;will&nbsp;never&nbsp;equal&nbsp;to&nbsp;1/2ulp).</span><br>
<span class="lineno"></span><span class="comment" id="1689255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;rounding&nbsp;mode&nbsp;can&nbsp;be&nbsp;detected&nbsp;by&nbsp;checking&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="1689317">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;huge&nbsp;+&nbsp;tiny&nbsp;is&nbsp;equal&nbsp;to&nbsp;huge,&nbsp;and&nbsp;whether&nbsp;huge&nbsp;-&nbsp;tiny&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1689382">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal&nbsp;to&nbsp;huge&nbsp;for&nbsp;some&nbsp;floating&nbsp;point&nbsp;number&nbsp;&#34;huge&#34;&nbsp;and&nbsp;&#34;tiny&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1689454">//</span><br>
<span class="lineno">85</span><span class="comment" id="1689457">//</span><br>
<span class="lineno"></span><span class="comment" id="1689460">//&nbsp;Notes:&nbsp;&nbsp;Rounding&nbsp;mode&nbsp;detection&nbsp;omitted.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1689505">const</span>&nbsp;<span class="op" id="1689511">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689514">uvnan</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689525">=</span>&nbsp;<span class="num" id="1689527">0x7FF8000000000001</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689547">uvinf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689558">=</span>&nbsp;<span class="num" id="1689560">0x7FF0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689580">uvneginf</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1689591">=</span>&nbsp;<span class="num" id="1689593">0xFFF0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689613">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689624">=</span>&nbsp;<span class="num" id="1689626">0x7FF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689633">shift</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689644">=</span>&nbsp;<span class="num" id="1689646">64</span>&nbsp;<span class="op" id="1689649">-</span>&nbsp;<span class="num" id="1689651">11</span>&nbsp;<span class="op" id="1689654">-</span>&nbsp;<span class="num" id="1689656">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689659">bias</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689670">=</span>&nbsp;<span class="num" id="1689672">1023</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689678">maxFloat64</span>&nbsp;<span class="op" id="1689689">=</span>&nbsp;<span class="num" id="1689691">1.797693134862315708145274237317043567981e+308</span>&nbsp;<span class="comment" id="1689738">//&nbsp;2**1023&nbsp;*&nbsp;(2**53&nbsp;-&nbsp;1)&nbsp;/&nbsp;2**52</span><br>
<span class="lineno"></span><span class="op" id="1689771">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1689774">func</span>&nbsp;<span class="ident" id="1689779">float64bits</span><span class="op" id="1689790">(</span><span class="ident" id="1689791">f</span>&nbsp;<span class="builtintype" id="1689793">float64</span><span class="op" id="1689800">)</span>&nbsp;<span class="ident" id="1689802">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689813">{</span>&nbsp;<span class="keyword" id="1689815">return</span>&nbsp;<span class="op" id="1689822">*</span><span class="op" id="1689823">(</span><span class="op" id="1689824">*</span><span class="ident" id="1689825">uint64</span><span class="op" id="1689831">)</span><span class="op" id="1689832">(</span><span class="ident" id="1689833">unsafe</span><span class="op" id="1689839">.</span><span class="ident" id="1689840">Pointer</span><span class="op" id="1689847">(</span><span class="op" id="1689848">&amp;</span><span class="ident" id="1689849">f</span><span class="op" id="1689850">)</span><span class="op" id="1689851">)</span>&nbsp;<span class="op" id="1689853">}</span><br>
<span class="lineno"></span><span class="keyword" id="1689855">func</span>&nbsp;<span class="ident" id="1689860">float64frombits</span><span class="op" id="1689875">(</span><span class="ident" id="1689876">b</span>&nbsp;<span class="ident" id="1689878">uint64</span><span class="op" id="1689884">)</span>&nbsp;<span class="builtintype" id="1689886">float64</span>&nbsp;<span class="op" id="1689894">{</span>&nbsp;<span class="keyword" id="1689896">return</span>&nbsp;<span class="op" id="1689903">*</span><span class="op" id="1689904">(</span><span class="op" id="1689905">*</span><span class="builtintype" id="1689906">float64</span><span class="op" id="1689913">)</span><span class="op" id="1689914">(</span><span class="ident" id="1689915">unsafe</span><span class="op" id="1689921">.</span><span class="ident" id="1689922">Pointer</span><span class="op" id="1689929">(</span><span class="op" id="1689930">&amp;</span><span class="ident" id="1689931">b</span><span class="op" id="1689932">)</span><span class="op" id="1689933">)</span>&nbsp;<span class="op" id="1689935">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="1689938">func</span>&nbsp;<span class="ident" id="1689943">sqrt</span><span class="op" id="1689947">(</span><span class="ident" id="1689948">x</span>&nbsp;<span class="builtintype" id="1689950">float64</span><span class="op" id="1689957">)</span>&nbsp;<span class="builtintype" id="1689959">float64</span>&nbsp;<span class="op" id="1689967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1689970">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689988">switch</span>&nbsp;<span class="op" id="1689995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689998">case</span>&nbsp;<span class="ident" id="1690003">x</span>&nbsp;<span class="op" id="1690005">==</span>&nbsp;<span class="num" id="1690008">0</span>&nbsp;<span class="op" id="1690010">||</span>&nbsp;<span class="ident" id="1690013">x</span>&nbsp;<span class="op" id="1690015">!=</span>&nbsp;<span class="ident" id="1690018">x</span>&nbsp;<span class="op" id="1690020">||</span>&nbsp;<span class="ident" id="1690023">x</span>&nbsp;<span class="op" id="1690025">&gt;</span>&nbsp;<span class="ident" id="1690027">maxFloat64</span><span class="op" id="1690037">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690041">return</span>&nbsp;<span class="ident" id="1690048">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690051">case</span>&nbsp;<span class="ident" id="1690056">x</span>&nbsp;<span class="op" id="1690058">&lt;</span>&nbsp;<span class="num" id="1690060">0</span><span class="op" id="1690061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690065">return</span>&nbsp;<span class="ident" id="1690072">nan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690080">ix</span>&nbsp;<span class="op" id="1690083">:=</span>&nbsp;<span class="ident" id="1690086">float64bits</span><span class="op" id="1690097">(</span><span class="ident" id="1690098">x</span><span class="op" id="1690099">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690102">//&nbsp;normalize&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690118">exp</span>&nbsp;<span class="op" id="1690122">:=</span>&nbsp;<span class="builtintype" id="1690125">int</span><span class="op" id="1690128">(</span><span class="op" id="1690129">(</span><span class="ident" id="1690130">ix</span>&nbsp;<span class="op" id="1690133">&gt;&gt;</span>&nbsp;<span class="ident" id="1690136">shift</span><span class="op" id="1690141">)</span>&nbsp;<span class="op" id="1690143">&amp;</span>&nbsp;<span class="ident" id="1690145">mask</span><span class="op" id="1690149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690152">if</span>&nbsp;<span class="ident" id="1690155">exp</span>&nbsp;<span class="op" id="1690159">==</span>&nbsp;<span class="num" id="1690162">0</span>&nbsp;<span class="op" id="1690164">{</span>&nbsp;<span class="comment" id="1690166">//&nbsp;subnormal&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690183">for</span>&nbsp;<span class="ident" id="1690187">ix</span><span class="op" id="1690189">&amp;</span><span class="num" id="1690190">1</span><span class="op" id="1690191">&lt;&lt;</span><span class="ident" id="1690193">shift</span>&nbsp;<span class="op" id="1690199">==</span>&nbsp;<span class="num" id="1690202">0</span>&nbsp;<span class="op" id="1690204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690209">ix</span>&nbsp;<span class="op" id="1690212">&lt;&lt;=</span>&nbsp;<span class="num" id="1690216">1</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690221">exp</span><span class="op" id="1690224">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690233">exp</span><span class="op" id="1690236">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690243">exp</span>&nbsp;<span class="op" id="1690247">-=</span>&nbsp;<span class="ident" id="1690250">bias</span>&nbsp;<span class="comment" id="1690255">//&nbsp;unbias&nbsp;exponent</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690275">ix</span>&nbsp;<span class="op" id="1690278">&amp;^=</span>&nbsp;<span class="ident" id="1690282">mask</span>&nbsp;<span class="op" id="1690287">&lt;&lt;</span>&nbsp;<span class="ident" id="1690290">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690297">ix</span>&nbsp;<span class="op" id="1690300">|=</span>&nbsp;<span class="num" id="1690303">1</span>&nbsp;<span class="op" id="1690305">&lt;&lt;</span>&nbsp;<span class="ident" id="1690308">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690315">if</span>&nbsp;<span class="ident" id="1690318">exp</span><span class="op" id="1690321">&amp;</span><span class="num" id="1690322">1</span>&nbsp;<span class="op" id="1690324">==</span>&nbsp;<span class="num" id="1690327">1</span>&nbsp;<span class="op" id="1690329">{</span>&nbsp;<span class="comment" id="1690331">//&nbsp;odd&nbsp;exp,&nbsp;double&nbsp;x&nbsp;to&nbsp;make&nbsp;it&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690370">ix</span>&nbsp;<span class="op" id="1690373">&lt;&lt;=</span>&nbsp;<span class="num" id="1690377">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690380">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690383">exp</span>&nbsp;<span class="op" id="1690387">&gt;&gt;=</span>&nbsp;<span class="num" id="1690391">1</span>&nbsp;<span class="comment" id="1690393">//&nbsp;exp&nbsp;=&nbsp;exp/2,&nbsp;exponent&nbsp;of&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690434">//&nbsp;generate&nbsp;sqrt(x)&nbsp;bit&nbsp;by&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690466">ix</span>&nbsp;<span class="op" id="1690469">&lt;&lt;=</span>&nbsp;<span class="num" id="1690473">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690476">var</span>&nbsp;<span class="ident" id="1690480">q</span><span class="op" id="1690481">,</span>&nbsp;<span class="ident" id="1690483">s</span>&nbsp;<span class="ident" id="1690485">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690506">//&nbsp;q&nbsp;=&nbsp;sqrt(x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690522">r</span>&nbsp;<span class="op" id="1690524">:=</span>&nbsp;<span class="ident" id="1690527">uint64</span><span class="op" id="1690533">(</span><span class="num" id="1690534">1</span>&nbsp;<span class="op" id="1690536">&lt;&lt;</span>&nbsp;<span class="op" id="1690539">(</span><span class="ident" id="1690540">shift</span>&nbsp;<span class="op" id="1690546">+</span>&nbsp;<span class="num" id="1690548">1</span><span class="op" id="1690549">)</span><span class="op" id="1690550">)</span>&nbsp;<span class="comment" id="1690552">//&nbsp;r&nbsp;=&nbsp;moving&nbsp;bit&nbsp;from&nbsp;MSB&nbsp;to&nbsp;LSB</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690587">for</span>&nbsp;<span class="ident" id="1690591">r</span>&nbsp;<span class="op" id="1690593">!=</span>&nbsp;<span class="num" id="1690596">0</span>&nbsp;<span class="op" id="1690598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690602">t</span>&nbsp;<span class="op" id="1690604">:=</span>&nbsp;<span class="ident" id="1690607">s</span>&nbsp;<span class="op" id="1690609">+</span>&nbsp;<span class="ident" id="1690611">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690615">if</span>&nbsp;<span class="ident" id="1690618">t</span>&nbsp;<span class="op" id="1690620">&lt;=</span>&nbsp;<span class="ident" id="1690623">ix</span>&nbsp;<span class="op" id="1690626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690631">s</span>&nbsp;<span class="op" id="1690633">=</span>&nbsp;<span class="ident" id="1690635">t</span>&nbsp;<span class="op" id="1690637">+</span>&nbsp;<span class="ident" id="1690639">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690644">ix</span>&nbsp;<span class="op" id="1690647">-=</span>&nbsp;<span class="ident" id="1690650">t</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690655">q</span>&nbsp;<span class="op" id="1690657">+=</span>&nbsp;<span class="ident" id="1690660">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690668">ix</span>&nbsp;<span class="op" id="1690671">&lt;&lt;=</span>&nbsp;<span class="num" id="1690675">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690679">r</span>&nbsp;<span class="op" id="1690681">&gt;&gt;=</span>&nbsp;<span class="num" id="1690685">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690688">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690691">//&nbsp;final&nbsp;rounding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690710">if</span>&nbsp;<span class="ident" id="1690713">ix</span>&nbsp;<span class="op" id="1690716">!=</span>&nbsp;<span class="num" id="1690719">0</span>&nbsp;<span class="op" id="1690721">{</span>&nbsp;<span class="comment" id="1690723">//&nbsp;remainder,&nbsp;result&nbsp;not&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690756">q</span>&nbsp;<span class="op" id="1690758">+=</span>&nbsp;<span class="ident" id="1690761">q</span>&nbsp;<span class="op" id="1690763">&amp;</span>&nbsp;<span class="num" id="1690765">1</span>&nbsp;<span class="comment" id="1690767">//&nbsp;round&nbsp;according&nbsp;to&nbsp;extra&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690803">ix</span>&nbsp;<span class="op" id="1690806">=</span>&nbsp;<span class="ident" id="1690808">q</span><span class="op" id="1690809">&gt;&gt;</span><span class="num" id="1690811">1</span>&nbsp;<span class="op" id="1690813">+</span>&nbsp;<span class="ident" id="1690815">uint64</span><span class="op" id="1690821">(</span><span class="ident" id="1690822">exp</span><span class="op" id="1690825">-</span><span class="num" id="1690826">1</span><span class="op" id="1690827">+</span><span class="ident" id="1690828">bias</span><span class="op" id="1690832">)</span><span class="op" id="1690833">&lt;&lt;</span><span class="ident" id="1690835">shift</span>&nbsp;<span class="comment" id="1690841">//&nbsp;significand&nbsp;+&nbsp;biased&nbsp;exponent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690875">return</span>&nbsp;<span class="ident" id="1690882">float64frombits</span><span class="op" id="1690897">(</span><span class="ident" id="1690898">ix</span><span class="op" id="1690900">)</span><br>
<span class="lineno"></span><span class="op" id="1690902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1690905">func</span>&nbsp;<span class="ident" id="1690910">sqrtC</span><span class="op" id="1690915">(</span><span class="ident" id="1690916">f</span>&nbsp;<span class="builtintype" id="1690918">float64</span><span class="op" id="1690925">,</span>&nbsp;<span class="ident" id="1690927">r</span>&nbsp;<span class="op" id="1690929">*</span><span class="builtintype" id="1690930">float64</span><span class="op" id="1690937">)</span>&nbsp;<span class="op" id="1690939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690942">*</span><span class="ident" id="1690943">r</span>&nbsp;<span class="op" id="1690945">=</span>&nbsp;<span class="ident" id="1690947">sqrt</span><span class="op" id="1690951">(</span><span class="ident" id="1690952">f</span><span class="op" id="1690953">)</span><br>
<span class="lineno">150</span><span class="op" id="1690955">}</span>
</div>
</body>
</html>
