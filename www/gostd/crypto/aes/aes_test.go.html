<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6506563">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6506618">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6506672">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6506723">package</span>&nbsp;<span class="ident" id="6506731">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6506736">import</span>&nbsp;<span class="op" id="6506743">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6506746">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6506756">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="6506759">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6506803">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="6506847">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="6506892">func</span>&nbsp;<span class="ident" id="6506897">TestPowx</span><span class="op" id="6506905">(</span><span class="ident" id="6506906">t</span>&nbsp;<span class="op" id="6506908">*</span><span class="ident" id="6506909">testing</span><span class="op" id="6506916">.</span><span class="ident" id="6506917">T</span><span class="op" id="6506918">)</span>&nbsp;<span class="op" id="6506920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6506923">p</span>&nbsp;<span class="op" id="6506925">:=</span>&nbsp;<span class="num" id="6506928">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6506931">for</span>&nbsp;<span class="ident" id="6506935">i</span>&nbsp;<span class="op" id="6506937">:=</span>&nbsp;<span class="num" id="6506940">0</span><span class="op" id="6506941">;</span>&nbsp;<span class="ident" id="6506943">i</span>&nbsp;<span class="op" id="6506945">&lt;</span>&nbsp;<span class="builtinfunc" id="6506947">len</span><span class="op" id="6506950">(</span><span class="ident" id="6506951">powx</span><span class="op" id="6506955">)</span><span class="op" id="6506956">;</span>&nbsp;<span class="ident" id="6506958">i</span><span class="op" id="6506959">++</span>&nbsp;<span class="op" id="6506962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6506966">if</span>&nbsp;<span class="ident" id="6506969">powx</span><span class="op" id="6506973">[</span><span class="ident" id="6506974">i</span><span class="op" id="6506975">]</span>&nbsp;<span class="op" id="6506977">!=</span>&nbsp;<span class="builtintype" id="6506980">byte</span><span class="op" id="6506984">(</span><span class="ident" id="6506985">p</span><span class="op" id="6506986">)</span>&nbsp;<span class="op" id="6506988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6506993">t</span><span class="op" id="6506994">.</span><span class="ident" id="6506995">Errorf</span><span class="op" id="6507001">(</span><span class="string" id="6507002">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6507028">,</span>&nbsp;<span class="ident" id="6507030">i</span><span class="op" id="6507031">,</span>&nbsp;<span class="ident" id="6507033">powx</span><span class="op" id="6507037">[</span><span class="ident" id="6507038">i</span><span class="op" id="6507039">]</span><span class="op" id="6507040">,</span>&nbsp;<span class="ident" id="6507042">p</span><span class="op" id="6507043">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507051">p</span>&nbsp;<span class="op" id="6507053">&lt;&lt;=</span>&nbsp;<span class="num" id="6507057">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507061">if</span>&nbsp;<span class="ident" id="6507064">p</span><span class="op" id="6507065">&amp;</span><span class="num" id="6507066">0x100</span>&nbsp;<span class="op" id="6507072">!=</span>&nbsp;<span class="num" id="6507075">0</span>&nbsp;<span class="op" id="6507077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507082">p</span>&nbsp;<span class="op" id="6507084">^=</span>&nbsp;<span class="ident" id="6507087">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507094">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507097">}</span><br>
<span class="lineno"></span><span class="op" id="6507099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6507102">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="6507155">func</span>&nbsp;<span class="ident" id="6507160">mul</span><span class="op" id="6507163">(</span><span class="ident" id="6507164">b</span><span class="op" id="6507165">,</span>&nbsp;<span class="ident" id="6507167">c</span>&nbsp;<span class="builtintype" id="6507169">uint32</span><span class="op" id="6507175">)</span>&nbsp;<span class="builtintype" id="6507177">uint32</span>&nbsp;<span class="op" id="6507184">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507187">i</span>&nbsp;<span class="op" id="6507189">:=</span>&nbsp;<span class="ident" id="6507192">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507195">j</span>&nbsp;<span class="op" id="6507197">:=</span>&nbsp;<span class="ident" id="6507200">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507203">s</span>&nbsp;<span class="op" id="6507205">:=</span>&nbsp;<span class="builtintype" id="6507208">uint32</span><span class="op" id="6507214">(</span><span class="num" id="6507215">0</span><span class="op" id="6507216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507219">for</span>&nbsp;<span class="ident" id="6507223">k</span>&nbsp;<span class="op" id="6507225">:=</span>&nbsp;<span class="builtintype" id="6507228">uint32</span><span class="op" id="6507234">(</span><span class="num" id="6507235">1</span><span class="op" id="6507236">)</span><span class="op" id="6507237">;</span>&nbsp;<span class="ident" id="6507239">k</span>&nbsp;<span class="op" id="6507241">&lt;</span>&nbsp;<span class="num" id="6507243">0x100</span>&nbsp;<span class="op" id="6507249">&amp;&amp;</span>&nbsp;<span class="ident" id="6507252">j</span>&nbsp;<span class="op" id="6507254">!=</span>&nbsp;<span class="num" id="6507257">0</span><span class="op" id="6507258">;</span>&nbsp;<span class="ident" id="6507260">k</span>&nbsp;<span class="op" id="6507262">&lt;&lt;=</span>&nbsp;<span class="num" id="6507266">1</span>&nbsp;<span class="op" id="6507268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6507272">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;xⁿ</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507314">if</span>&nbsp;<span class="ident" id="6507317">j</span><span class="op" id="6507318">&amp;</span><span class="ident" id="6507319">k</span>&nbsp;<span class="op" id="6507321">!=</span>&nbsp;<span class="num" id="6507324">0</span>&nbsp;<span class="op" id="6507326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6507331">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507368">s</span>&nbsp;<span class="op" id="6507370">^=</span>&nbsp;<span class="ident" id="6507373">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507378">j</span>&nbsp;<span class="op" id="6507380">^=</span>&nbsp;<span class="ident" id="6507383">k</span>&nbsp;<span class="comment" id="6507385">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6507426">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507469">i</span>&nbsp;<span class="op" id="6507471">&lt;&lt;=</span>&nbsp;<span class="num" id="6507475">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507479">if</span>&nbsp;<span class="ident" id="6507482">i</span><span class="op" id="6507483">&amp;</span><span class="num" id="6507484">0x100</span>&nbsp;<span class="op" id="6507490">!=</span>&nbsp;<span class="num" id="6507493">0</span>&nbsp;<span class="op" id="6507495">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507500">i</span>&nbsp;<span class="op" id="6507502">^=</span>&nbsp;<span class="ident" id="6507505">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507518">return</span>&nbsp;<span class="ident" id="6507525">s</span><br>
<span class="lineno"></span><span class="op" id="6507527">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="6507530">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n²&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="6507587">func</span>&nbsp;<span class="ident" id="6507592">TestMul</span><span class="op" id="6507599">(</span><span class="ident" id="6507600">t</span>&nbsp;<span class="op" id="6507602">*</span><span class="ident" id="6507603">testing</span><span class="op" id="6507610">.</span><span class="ident" id="6507611">T</span><span class="op" id="6507612">)</span>&nbsp;<span class="op" id="6507614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507617">for</span>&nbsp;<span class="ident" id="6507621">i</span>&nbsp;<span class="op" id="6507623">:=</span>&nbsp;<span class="builtintype" id="6507626">uint32</span><span class="op" id="6507632">(</span><span class="num" id="6507633">0</span><span class="op" id="6507634">)</span><span class="op" id="6507635">;</span>&nbsp;<span class="ident" id="6507637">i</span>&nbsp;<span class="op" id="6507639">&lt;</span>&nbsp;<span class="num" id="6507641">256</span><span class="op" id="6507644">;</span>&nbsp;<span class="ident" id="6507646">i</span><span class="op" id="6507647">++</span>&nbsp;<span class="op" id="6507650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507654">for</span>&nbsp;<span class="ident" id="6507658">j</span>&nbsp;<span class="op" id="6507660">:=</span>&nbsp;<span class="builtintype" id="6507663">uint32</span><span class="op" id="6507669">(</span><span class="num" id="6507670">0</span><span class="op" id="6507671">)</span><span class="op" id="6507672">;</span>&nbsp;<span class="ident" id="6507674">j</span>&nbsp;<span class="op" id="6507676">&lt;</span>&nbsp;<span class="num" id="6507678">256</span><span class="op" id="6507681">;</span>&nbsp;<span class="ident" id="6507683">j</span><span class="op" id="6507684">++</span>&nbsp;<span class="op" id="6507687">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6507692">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507724">s</span>&nbsp;<span class="op" id="6507726">:=</span>&nbsp;<span class="builtintype" id="6507729">uint8</span><span class="op" id="6507734">(</span><span class="num" id="6507735">0</span><span class="op" id="6507736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507741">for</span>&nbsp;<span class="ident" id="6507745">k</span>&nbsp;<span class="op" id="6507747">:=</span>&nbsp;<span class="builtintype" id="6507750">uint</span><span class="op" id="6507754">(</span><span class="num" id="6507755">0</span><span class="op" id="6507756">)</span><span class="op" id="6507757">;</span>&nbsp;<span class="ident" id="6507759">k</span>&nbsp;<span class="op" id="6507761">&lt;</span>&nbsp;<span class="num" id="6507763">8</span><span class="op" id="6507764">;</span>&nbsp;<span class="ident" id="6507766">k</span><span class="op" id="6507767">++</span>&nbsp;<span class="op" id="6507770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507776">for</span>&nbsp;<span class="ident" id="6507780">l</span>&nbsp;<span class="op" id="6507782">:=</span>&nbsp;<span class="builtintype" id="6507785">uint</span><span class="op" id="6507789">(</span><span class="num" id="6507790">0</span><span class="op" id="6507791">)</span><span class="op" id="6507792">;</span>&nbsp;<span class="ident" id="6507794">l</span>&nbsp;<span class="op" id="6507796">&lt;</span>&nbsp;<span class="num" id="6507798">8</span><span class="op" id="6507799">;</span>&nbsp;<span class="ident" id="6507801">l</span><span class="op" id="6507802">++</span>&nbsp;<span class="op" id="6507805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507812">if</span>&nbsp;<span class="ident" id="6507815">i</span><span class="op" id="6507816">&amp;</span><span class="op" id="6507817">(</span><span class="num" id="6507818">1</span><span class="op" id="6507819">&lt;&lt;</span><span class="ident" id="6507821">k</span><span class="op" id="6507822">)</span>&nbsp;<span class="op" id="6507824">!=</span>&nbsp;<span class="num" id="6507827">0</span>&nbsp;<span class="op" id="6507829">&amp;&amp;</span>&nbsp;<span class="ident" id="6507832">j</span><span class="op" id="6507833">&amp;</span><span class="op" id="6507834">(</span><span class="num" id="6507835">1</span><span class="op" id="6507836">&lt;&lt;</span><span class="ident" id="6507838">l</span><span class="op" id="6507839">)</span>&nbsp;<span class="op" id="6507841">!=</span>&nbsp;<span class="num" id="6507844">0</span>&nbsp;<span class="op" id="6507846">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507854">s</span>&nbsp;<span class="op" id="6507856">^=</span>&nbsp;<span class="ident" id="6507859">powx</span><span class="op" id="6507863">[</span><span class="ident" id="6507864">k</span><span class="op" id="6507865">+</span><span class="ident" id="6507866">l</span><span class="op" id="6507867">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6507890">if</span>&nbsp;<span class="ident" id="6507893">x</span>&nbsp;<span class="op" id="6507895">:=</span>&nbsp;<span class="ident" id="6507898">mul</span><span class="op" id="6507901">(</span><span class="ident" id="6507902">i</span><span class="op" id="6507903">,</span>&nbsp;<span class="ident" id="6507905">j</span><span class="op" id="6507906">)</span><span class="op" id="6507907">;</span>&nbsp;<span class="ident" id="6507909">x</span>&nbsp;<span class="op" id="6507911">!=</span>&nbsp;<span class="builtintype" id="6507914">uint32</span><span class="op" id="6507920">(</span><span class="ident" id="6507921">s</span><span class="op" id="6507922">)</span>&nbsp;<span class="op" id="6507924">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6507930">t</span><span class="op" id="6507931">.</span><span class="ident" id="6507932">Fatalf</span><span class="op" id="6507938">(</span><span class="string" id="6507939">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6507970">,</span>&nbsp;<span class="ident" id="6507972">i</span><span class="op" id="6507973">,</span>&nbsp;<span class="ident" id="6507975">j</span><span class="op" id="6507976">,</span>&nbsp;<span class="ident" id="6507978">x</span><span class="op" id="6507979">,</span>&nbsp;<span class="ident" id="6507981">s</span><span class="op" id="6507982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6507994">}</span><br>
<span class="lineno"></span><span class="op" id="6507996">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="6507999">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="6508049">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="6508097">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="6508146">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="6508193">func</span>&nbsp;<span class="ident" id="6508198">TestSboxes</span><span class="op" id="6508208">(</span><span class="ident" id="6508209">t</span>&nbsp;<span class="op" id="6508211">*</span><span class="ident" id="6508212">testing</span><span class="op" id="6508219">.</span><span class="ident" id="6508220">T</span><span class="op" id="6508221">)</span>&nbsp;<span class="op" id="6508223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508226">for</span>&nbsp;<span class="ident" id="6508230">i</span>&nbsp;<span class="op" id="6508232">:=</span>&nbsp;<span class="num" id="6508235">0</span><span class="op" id="6508236">;</span>&nbsp;<span class="ident" id="6508238">i</span>&nbsp;<span class="op" id="6508240">&lt;</span>&nbsp;<span class="num" id="6508242">256</span><span class="op" id="6508245">;</span>&nbsp;<span class="ident" id="6508247">i</span><span class="op" id="6508248">++</span>&nbsp;<span class="op" id="6508251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508255">if</span>&nbsp;<span class="ident" id="6508258">j</span>&nbsp;<span class="op" id="6508260">:=</span>&nbsp;<span class="ident" id="6508263">sbox0</span><span class="op" id="6508268">[</span><span class="ident" id="6508269">sbox1</span><span class="op" id="6508274">[</span><span class="ident" id="6508275">i</span><span class="op" id="6508276">]</span><span class="op" id="6508277">]</span><span class="op" id="6508278">;</span>&nbsp;<span class="ident" id="6508280">j</span>&nbsp;<span class="op" id="6508282">!=</span>&nbsp;<span class="builtintype" id="6508285">byte</span><span class="op" id="6508289">(</span><span class="ident" id="6508290">i</span><span class="op" id="6508291">)</span>&nbsp;<span class="op" id="6508293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508298">t</span><span class="op" id="6508299">.</span><span class="ident" id="6508300">Errorf</span><span class="op" id="6508306">(</span><span class="string" id="6508307">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6508332">,</span>&nbsp;<span class="ident" id="6508334">i</span><span class="op" id="6508335">,</span>&nbsp;<span class="ident" id="6508337">j</span><span class="op" id="6508338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6508342">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508346">if</span>&nbsp;<span class="ident" id="6508349">j</span>&nbsp;<span class="op" id="6508351">:=</span>&nbsp;<span class="ident" id="6508354">sbox1</span><span class="op" id="6508359">[</span><span class="ident" id="6508360">sbox0</span><span class="op" id="6508365">[</span><span class="ident" id="6508366">i</span><span class="op" id="6508367">]</span><span class="op" id="6508368">]</span><span class="op" id="6508369">;</span>&nbsp;<span class="ident" id="6508371">j</span>&nbsp;<span class="op" id="6508373">!=</span>&nbsp;<span class="builtintype" id="6508376">byte</span><span class="op" id="6508380">(</span><span class="ident" id="6508381">i</span><span class="op" id="6508382">)</span>&nbsp;<span class="op" id="6508384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508389">t</span><span class="op" id="6508390">.</span><span class="ident" id="6508391">Errorf</span><span class="op" id="6508397">(</span><span class="string" id="6508398">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6508423">,</span>&nbsp;<span class="ident" id="6508425">i</span><span class="op" id="6508426">,</span>&nbsp;<span class="ident" id="6508428">j</span><span class="op" id="6508429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6508433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6508436">}</span><br>
<span class="lineno"></span><span class="op" id="6508438">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="6508441">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="6508485">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6508532">func</span>&nbsp;<span class="ident" id="6508537">TestTe</span><span class="op" id="6508543">(</span><span class="ident" id="6508544">t</span>&nbsp;<span class="op" id="6508546">*</span><span class="ident" id="6508547">testing</span><span class="op" id="6508554">.</span><span class="ident" id="6508555">T</span><span class="op" id="6508556">)</span>&nbsp;<span class="op" id="6508558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508561">for</span>&nbsp;<span class="ident" id="6508565">i</span>&nbsp;<span class="op" id="6508567">:=</span>&nbsp;<span class="num" id="6508570">0</span><span class="op" id="6508571">;</span>&nbsp;<span class="ident" id="6508573">i</span>&nbsp;<span class="op" id="6508575">&lt;</span>&nbsp;<span class="num" id="6508577">256</span><span class="op" id="6508580">;</span>&nbsp;<span class="ident" id="6508582">i</span><span class="op" id="6508583">++</span>&nbsp;<span class="op" id="6508586">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508590">s</span>&nbsp;<span class="op" id="6508592">:=</span>&nbsp;<span class="builtintype" id="6508595">uint32</span><span class="op" id="6508601">(</span><span class="ident" id="6508602">sbox0</span><span class="op" id="6508607">[</span><span class="ident" id="6508608">i</span><span class="op" id="6508609">]</span><span class="op" id="6508610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508614">s2</span>&nbsp;<span class="op" id="6508617">:=</span>&nbsp;<span class="ident" id="6508620">mul</span><span class="op" id="6508623">(</span><span class="ident" id="6508624">s</span><span class="op" id="6508625">,</span>&nbsp;<span class="num" id="6508627">2</span><span class="op" id="6508628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508632">s3</span>&nbsp;<span class="op" id="6508635">:=</span>&nbsp;<span class="ident" id="6508638">mul</span><span class="op" id="6508641">(</span><span class="ident" id="6508642">s</span><span class="op" id="6508643">,</span>&nbsp;<span class="num" id="6508645">3</span><span class="op" id="6508646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508650">w</span>&nbsp;<span class="op" id="6508652">:=</span>&nbsp;<span class="ident" id="6508655">s2</span><span class="op" id="6508657">&lt;&lt;</span><span class="num" id="6508659">24</span>&nbsp;<span class="op" id="6508662">|</span>&nbsp;<span class="ident" id="6508664">s</span><span class="op" id="6508665">&lt;&lt;</span><span class="num" id="6508667">16</span>&nbsp;<span class="op" id="6508670">|</span>&nbsp;<span class="ident" id="6508672">s</span><span class="op" id="6508673">&lt;&lt;</span><span class="num" id="6508675">8</span>&nbsp;<span class="op" id="6508677">|</span>&nbsp;<span class="ident" id="6508679">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508684">te</span>&nbsp;<span class="op" id="6508687">:=</span>&nbsp;<span class="op" id="6508690">[</span><span class="op" id="6508691">]</span><span class="op" id="6508692">[</span><span class="num" id="6508693">256</span><span class="op" id="6508696">]</span><span class="builtintype" id="6508697">uint32</span><span class="op" id="6508703">{</span><span class="ident" id="6508704">te0</span><span class="op" id="6508707">,</span>&nbsp;<span class="ident" id="6508709">te1</span><span class="op" id="6508712">,</span>&nbsp;<span class="ident" id="6508714">te2</span><span class="op" id="6508717">,</span>&nbsp;<span class="ident" id="6508719">te3</span><span class="op" id="6508722">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508726">for</span>&nbsp;<span class="ident" id="6508730">j</span>&nbsp;<span class="op" id="6508732">:=</span>&nbsp;<span class="num" id="6508735">0</span><span class="op" id="6508736">;</span>&nbsp;<span class="ident" id="6508738">j</span>&nbsp;<span class="op" id="6508740">&lt;</span>&nbsp;<span class="num" id="6508742">4</span><span class="op" id="6508743">;</span>&nbsp;<span class="ident" id="6508745">j</span><span class="op" id="6508746">++</span>&nbsp;<span class="op" id="6508749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508754">if</span>&nbsp;<span class="ident" id="6508757">x</span>&nbsp;<span class="op" id="6508759">:=</span>&nbsp;<span class="ident" id="6508762">te</span><span class="op" id="6508764">[</span><span class="ident" id="6508765">j</span><span class="op" id="6508766">]</span><span class="op" id="6508767">[</span><span class="ident" id="6508768">i</span><span class="op" id="6508769">]</span><span class="op" id="6508770">;</span>&nbsp;<span class="ident" id="6508772">x</span>&nbsp;<span class="op" id="6508774">!=</span>&nbsp;<span class="ident" id="6508777">w</span>&nbsp;<span class="op" id="6508779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508785">t</span><span class="op" id="6508786">.</span><span class="ident" id="6508787">Fatalf</span><span class="op" id="6508793">(</span><span class="string" id="6508794">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6508822">,</span>&nbsp;<span class="ident" id="6508824">j</span><span class="op" id="6508825">,</span>&nbsp;<span class="ident" id="6508827">i</span><span class="op" id="6508828">,</span>&nbsp;<span class="ident" id="6508830">x</span><span class="op" id="6508831">,</span>&nbsp;<span class="ident" id="6508833">w</span><span class="op" id="6508834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6508839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6508844">w</span>&nbsp;<span class="op" id="6508846">=</span>&nbsp;<span class="ident" id="6508848">w</span><span class="op" id="6508849">&lt;&lt;</span><span class="num" id="6508851">24</span>&nbsp;<span class="op" id="6508854">|</span>&nbsp;<span class="ident" id="6508856">w</span><span class="op" id="6508857">&gt;&gt;</span><span class="num" id="6508859">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6508863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6508866">}</span><br>
<span class="lineno"></span><span class="op" id="6508868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6508871">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="6508915">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6508962">func</span>&nbsp;<span class="ident" id="6508967">TestTd</span><span class="op" id="6508973">(</span><span class="ident" id="6508974">t</span>&nbsp;<span class="op" id="6508976">*</span><span class="ident" id="6508977">testing</span><span class="op" id="6508984">.</span><span class="ident" id="6508985">T</span><span class="op" id="6508986">)</span>&nbsp;<span class="op" id="6508988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6508991">for</span>&nbsp;<span class="ident" id="6508995">i</span>&nbsp;<span class="op" id="6508997">:=</span>&nbsp;<span class="num" id="6509000">0</span><span class="op" id="6509001">;</span>&nbsp;<span class="ident" id="6509003">i</span>&nbsp;<span class="op" id="6509005">&lt;</span>&nbsp;<span class="num" id="6509007">256</span><span class="op" id="6509010">;</span>&nbsp;<span class="ident" id="6509012">i</span><span class="op" id="6509013">++</span>&nbsp;<span class="op" id="6509016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509020">s</span>&nbsp;<span class="op" id="6509022">:=</span>&nbsp;<span class="builtintype" id="6509025">uint32</span><span class="op" id="6509031">(</span><span class="ident" id="6509032">sbox1</span><span class="op" id="6509037">[</span><span class="ident" id="6509038">i</span><span class="op" id="6509039">]</span><span class="op" id="6509040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509044">s9</span>&nbsp;<span class="op" id="6509047">:=</span>&nbsp;<span class="ident" id="6509050">mul</span><span class="op" id="6509053">(</span><span class="ident" id="6509054">s</span><span class="op" id="6509055">,</span>&nbsp;<span class="num" id="6509057">0x9</span><span class="op" id="6509060">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509064">sb</span>&nbsp;<span class="op" id="6509067">:=</span>&nbsp;<span class="ident" id="6509070">mul</span><span class="op" id="6509073">(</span><span class="ident" id="6509074">s</span><span class="op" id="6509075">,</span>&nbsp;<span class="num" id="6509077">0xb</span><span class="op" id="6509080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509084">sd</span>&nbsp;<span class="op" id="6509087">:=</span>&nbsp;<span class="ident" id="6509090">mul</span><span class="op" id="6509093">(</span><span class="ident" id="6509094">s</span><span class="op" id="6509095">,</span>&nbsp;<span class="num" id="6509097">0xd</span><span class="op" id="6509100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509104">se</span>&nbsp;<span class="op" id="6509107">:=</span>&nbsp;<span class="ident" id="6509110">mul</span><span class="op" id="6509113">(</span><span class="ident" id="6509114">s</span><span class="op" id="6509115">,</span>&nbsp;<span class="num" id="6509117">0xe</span><span class="op" id="6509120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509124">w</span>&nbsp;<span class="op" id="6509126">:=</span>&nbsp;<span class="ident" id="6509129">se</span><span class="op" id="6509131">&lt;&lt;</span><span class="num" id="6509133">24</span>&nbsp;<span class="op" id="6509136">|</span>&nbsp;<span class="ident" id="6509138">s9</span><span class="op" id="6509140">&lt;&lt;</span><span class="num" id="6509142">16</span>&nbsp;<span class="op" id="6509145">|</span>&nbsp;<span class="ident" id="6509147">sd</span><span class="op" id="6509149">&lt;&lt;</span><span class="num" id="6509151">8</span>&nbsp;<span class="op" id="6509153">|</span>&nbsp;<span class="ident" id="6509155">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509160">td</span>&nbsp;<span class="op" id="6509163">:=</span>&nbsp;<span class="op" id="6509166">[</span><span class="op" id="6509167">]</span><span class="op" id="6509168">[</span><span class="num" id="6509169">256</span><span class="op" id="6509172">]</span><span class="builtintype" id="6509173">uint32</span><span class="op" id="6509179">{</span><span class="ident" id="6509180">td0</span><span class="op" id="6509183">,</span>&nbsp;<span class="ident" id="6509185">td1</span><span class="op" id="6509188">,</span>&nbsp;<span class="ident" id="6509190">td2</span><span class="op" id="6509193">,</span>&nbsp;<span class="ident" id="6509195">td3</span><span class="op" id="6509198">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6509202">for</span>&nbsp;<span class="ident" id="6509206">j</span>&nbsp;<span class="op" id="6509208">:=</span>&nbsp;<span class="num" id="6509211">0</span><span class="op" id="6509212">;</span>&nbsp;<span class="ident" id="6509214">j</span>&nbsp;<span class="op" id="6509216">&lt;</span>&nbsp;<span class="num" id="6509218">4</span><span class="op" id="6509219">;</span>&nbsp;<span class="ident" id="6509221">j</span><span class="op" id="6509222">++</span>&nbsp;<span class="op" id="6509225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6509230">if</span>&nbsp;<span class="ident" id="6509233">x</span>&nbsp;<span class="op" id="6509235">:=</span>&nbsp;<span class="ident" id="6509238">td</span><span class="op" id="6509240">[</span><span class="ident" id="6509241">j</span><span class="op" id="6509242">]</span><span class="op" id="6509243">[</span><span class="ident" id="6509244">i</span><span class="op" id="6509245">]</span><span class="op" id="6509246">;</span>&nbsp;<span class="ident" id="6509248">x</span>&nbsp;<span class="op" id="6509250">!=</span>&nbsp;<span class="ident" id="6509253">w</span>&nbsp;<span class="op" id="6509255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509261">t</span><span class="op" id="6509262">.</span><span class="ident" id="6509263">Fatalf</span><span class="op" id="6509269">(</span><span class="string" id="6509270">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6509298">,</span>&nbsp;<span class="ident" id="6509300">j</span><span class="op" id="6509301">,</span>&nbsp;<span class="ident" id="6509303">i</span><span class="op" id="6509304">,</span>&nbsp;<span class="ident" id="6509306">x</span><span class="op" id="6509307">,</span>&nbsp;<span class="ident" id="6509309">w</span><span class="op" id="6509310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6509315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509320">w</span>&nbsp;<span class="op" id="6509322">=</span>&nbsp;<span class="ident" id="6509324">w</span><span class="op" id="6509325">&lt;&lt;</span><span class="num" id="6509327">24</span>&nbsp;<span class="op" id="6509330">|</span>&nbsp;<span class="ident" id="6509332">w</span><span class="op" id="6509333">&gt;&gt;</span><span class="num" id="6509335">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6509339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6509342">}</span><br>
<span class="lineno"></span><span class="op" id="6509344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6509347">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="6509382">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6509450">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="6509500">type</span>&nbsp;<span class="ident" id="6509505">KeyTest</span>&nbsp;<span class="keyword" id="6509513">struct</span>&nbsp;<span class="op" id="6509520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509523">key</span>&nbsp;<span class="op" id="6509527">[</span><span class="op" id="6509528">]</span><span class="builtintype" id="6509529">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509535">enc</span>&nbsp;<span class="op" id="6509539">[</span><span class="op" id="6509540">]</span><span class="builtintype" id="6509541">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6509549">dec</span>&nbsp;<span class="op" id="6509553">[</span><span class="op" id="6509554">]</span><span class="builtintype" id="6509555">uint32</span>&nbsp;<span class="comment" id="6509562">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="6509636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6509639">var</span>&nbsp;<span class="ident" id="6509643">keyTests</span>&nbsp;<span class="op" id="6509652">=</span>&nbsp;<span class="op" id="6509654">[</span><span class="op" id="6509655">]</span><span class="ident" id="6509656">KeyTest</span><span class="op" id="6509663">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6509666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6509670">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6509715">[</span><span class="op" id="6509716">]</span><span class="builtintype" id="6509717">byte</span><span class="op" id="6509721">{</span><span class="num" id="6509722">0x2b</span><span class="op" id="6509726">,</span>&nbsp;<span class="num" id="6509728">0x7e</span><span class="op" id="6509732">,</span>&nbsp;<span class="num" id="6509734">0x15</span><span class="op" id="6509738">,</span>&nbsp;<span class="num" id="6509740">0x16</span><span class="op" id="6509744">,</span>&nbsp;<span class="num" id="6509746">0x28</span><span class="op" id="6509750">,</span>&nbsp;<span class="num" id="6509752">0xae</span><span class="op" id="6509756">,</span>&nbsp;<span class="num" id="6509758">0xd2</span><span class="op" id="6509762">,</span>&nbsp;<span class="num" id="6509764">0xa6</span><span class="op" id="6509768">,</span>&nbsp;<span class="num" id="6509770">0xab</span><span class="op" id="6509774">,</span>&nbsp;<span class="num" id="6509776">0xf7</span><span class="op" id="6509780">,</span>&nbsp;<span class="num" id="6509782">0x15</span><span class="op" id="6509786">,</span>&nbsp;<span class="num" id="6509788">0x88</span><span class="op" id="6509792">,</span>&nbsp;<span class="num" id="6509794">0x09</span><span class="op" id="6509798">,</span>&nbsp;<span class="num" id="6509800">0xcf</span><span class="op" id="6509804">,</span>&nbsp;<span class="num" id="6509806">0x4f</span><span class="op" id="6509810">,</span>&nbsp;<span class="num" id="6509812">0x3c</span><span class="op" id="6509816">}</span><span class="op" id="6509817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6509821">[</span><span class="op" id="6509822">]</span><span class="builtintype" id="6509823">uint32</span><span class="op" id="6509829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6509834">0x2b7e1516</span><span class="op" id="6509844">,</span>&nbsp;<span class="num" id="6509846">0x28aed2a6</span><span class="op" id="6509856">,</span>&nbsp;<span class="num" id="6509858">0xabf71588</span><span class="op" id="6509868">,</span>&nbsp;<span class="num" id="6509870">0x09cf4f3c</span><span class="op" id="6509880">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6509885">0xa0fafe17</span><span class="op" id="6509895">,</span>&nbsp;<span class="num" id="6509897">0x88542cb1</span><span class="op" id="6509907">,</span>&nbsp;<span class="num" id="6509909">0x23a33939</span><span class="op" id="6509919">,</span>&nbsp;<span class="num" id="6509921">0x2a6c7605</span><span class="op" id="6509931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6509936">0xf2c295f2</span><span class="op" id="6509946">,</span>&nbsp;<span class="num" id="6509948">0x7a96b943</span><span class="op" id="6509958">,</span>&nbsp;<span class="num" id="6509960">0x5935807a</span><span class="op" id="6509970">,</span>&nbsp;<span class="num" id="6509972">0x7359f67f</span><span class="op" id="6509982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6509987">0x3d80477d</span><span class="op" id="6509997">,</span>&nbsp;<span class="num" id="6509999">0x4716fe3e</span><span class="op" id="6510009">,</span>&nbsp;<span class="num" id="6510011">0x1e237e44</span><span class="op" id="6510021">,</span>&nbsp;<span class="num" id="6510023">0x6d7a883b</span><span class="op" id="6510033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510038">0xef44a541</span><span class="op" id="6510048">,</span>&nbsp;<span class="num" id="6510050">0xa8525b7f</span><span class="op" id="6510060">,</span>&nbsp;<span class="num" id="6510062">0xb671253b</span><span class="op" id="6510072">,</span>&nbsp;<span class="num" id="6510074">0xdb0bad00</span><span class="op" id="6510084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510089">0xd4d1c6f8</span><span class="op" id="6510099">,</span>&nbsp;<span class="num" id="6510101">0x7c839d87</span><span class="op" id="6510111">,</span>&nbsp;<span class="num" id="6510113">0xcaf2b8bc</span><span class="op" id="6510123">,</span>&nbsp;<span class="num" id="6510125">0x11f915bc</span><span class="op" id="6510135">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510140">0x6d88a37a</span><span class="op" id="6510150">,</span>&nbsp;<span class="num" id="6510152">0x110b3efd</span><span class="op" id="6510162">,</span>&nbsp;<span class="num" id="6510164">0xdbf98641</span><span class="op" id="6510174">,</span>&nbsp;<span class="num" id="6510176">0xca0093fd</span><span class="op" id="6510186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510191">0x4e54f70e</span><span class="op" id="6510201">,</span>&nbsp;<span class="num" id="6510203">0x5f5fc9f3</span><span class="op" id="6510213">,</span>&nbsp;<span class="num" id="6510215">0x84a64fb2</span><span class="op" id="6510225">,</span>&nbsp;<span class="num" id="6510227">0x4ea6dc4f</span><span class="op" id="6510237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510242">0xead27321</span><span class="op" id="6510252">,</span>&nbsp;<span class="num" id="6510254">0xb58dbad2</span><span class="op" id="6510264">,</span>&nbsp;<span class="num" id="6510266">0x312bf560</span><span class="op" id="6510276">,</span>&nbsp;<span class="num" id="6510278">0x7f8d292f</span><span class="op" id="6510288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510293">0xac7766f3</span><span class="op" id="6510303">,</span>&nbsp;<span class="num" id="6510305">0x19fadc21</span><span class="op" id="6510315">,</span>&nbsp;<span class="num" id="6510317">0x28d12941</span><span class="op" id="6510327">,</span>&nbsp;<span class="num" id="6510329">0x575c006e</span><span class="op" id="6510339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510344">0xd014f9a8</span><span class="op" id="6510354">,</span>&nbsp;<span class="num" id="6510356">0xc9ee2589</span><span class="op" id="6510366">,</span>&nbsp;<span class="num" id="6510368">0xe13f0cc8</span><span class="op" id="6510378">,</span>&nbsp;<span class="num" id="6510380">0xb6630ca6</span><span class="op" id="6510390">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6510394">}</span><span class="op" id="6510395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6510399">[</span><span class="op" id="6510400">]</span><span class="builtintype" id="6510401">uint32</span><span class="op" id="6510407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510412">0xd014f9a8</span><span class="op" id="6510422">,</span>&nbsp;<span class="num" id="6510424">0xc9ee2589</span><span class="op" id="6510434">,</span>&nbsp;<span class="num" id="6510436">0xe13f0cc8</span><span class="op" id="6510446">,</span>&nbsp;<span class="num" id="6510448">0xb6630ca6</span><span class="op" id="6510458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510463">0xc7b5a63</span><span class="op" id="6510472">,</span>&nbsp;<span class="num" id="6510474">0x1319eafe</span><span class="op" id="6510484">,</span>&nbsp;<span class="num" id="6510486">0xb0398890</span><span class="op" id="6510496">,</span>&nbsp;<span class="num" id="6510498">0x664cfbb4</span><span class="op" id="6510508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510513">0xdf7d925a</span><span class="op" id="6510523">,</span>&nbsp;<span class="num" id="6510525">0x1f62b09d</span><span class="op" id="6510535">,</span>&nbsp;<span class="num" id="6510537">0xa320626e</span><span class="op" id="6510547">,</span>&nbsp;<span class="num" id="6510549">0xd6757324</span><span class="op" id="6510559">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510564">0x12c07647</span><span class="op" id="6510574">,</span>&nbsp;<span class="num" id="6510576">0xc01f22c7</span><span class="op" id="6510586">,</span>&nbsp;<span class="num" id="6510588">0xbc42d2f3</span><span class="op" id="6510598">,</span>&nbsp;<span class="num" id="6510600">0x7555114a</span><span class="op" id="6510610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510615">0x6efcd876</span><span class="op" id="6510625">,</span>&nbsp;<span class="num" id="6510627">0xd2df5480</span><span class="op" id="6510637">,</span>&nbsp;<span class="num" id="6510639">0x7c5df034</span><span class="op" id="6510649">,</span>&nbsp;<span class="num" id="6510651">0xc917c3b9</span><span class="op" id="6510661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510666">0x6ea30afc</span><span class="op" id="6510676">,</span>&nbsp;<span class="num" id="6510678">0xbc238cf6</span><span class="op" id="6510688">,</span>&nbsp;<span class="num" id="6510690">0xae82a4b4</span><span class="op" id="6510700">,</span>&nbsp;<span class="num" id="6510702">0xb54a338d</span><span class="op" id="6510712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510717">0x90884413</span><span class="op" id="6510727">,</span>&nbsp;<span class="num" id="6510729">0xd280860a</span><span class="op" id="6510739">,</span>&nbsp;<span class="num" id="6510741">0x12a12842</span><span class="op" id="6510751">,</span>&nbsp;<span class="num" id="6510753">0x1bc89739</span><span class="op" id="6510763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510768">0x7c1f13f7</span><span class="op" id="6510778">,</span>&nbsp;<span class="num" id="6510780">0x4208c219</span><span class="op" id="6510790">,</span>&nbsp;<span class="num" id="6510792">0xc021ae48</span><span class="op" id="6510802">,</span>&nbsp;<span class="num" id="6510804">0x969bf7b</span><span class="op" id="6510813">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510818">0xcc7505eb</span><span class="op" id="6510828">,</span>&nbsp;<span class="num" id="6510830">0x3e17d1ee</span><span class="op" id="6510840">,</span>&nbsp;<span class="num" id="6510842">0x82296c51</span><span class="op" id="6510852">,</span>&nbsp;<span class="num" id="6510854">0xc9481133</span><span class="op" id="6510864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510869">0x2b3708a7</span><span class="op" id="6510879">,</span>&nbsp;<span class="num" id="6510881">0xf262d405</span><span class="op" id="6510891">,</span>&nbsp;<span class="num" id="6510893">0xbc3ebdbf</span><span class="op" id="6510903">,</span>&nbsp;<span class="num" id="6510905">0x4b617d62</span><span class="op" id="6510915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6510920">0x2b7e1516</span><span class="op" id="6510930">,</span>&nbsp;<span class="num" id="6510932">0x28aed2a6</span><span class="op" id="6510942">,</span>&nbsp;<span class="num" id="6510944">0xabf71588</span><span class="op" id="6510954">,</span>&nbsp;<span class="num" id="6510956">0x9cf4f3c</span><span class="op" id="6510965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6510969">}</span><span class="op" id="6510970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6510973">}</span><span class="op" id="6510974">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6510977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6510981">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511026">[</span><span class="op" id="6511027">]</span><span class="builtintype" id="6511028">byte</span><span class="op" id="6511032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511037">0x8e</span><span class="op" id="6511041">,</span>&nbsp;<span class="num" id="6511043">0x73</span><span class="op" id="6511047">,</span>&nbsp;<span class="num" id="6511049">0xb0</span><span class="op" id="6511053">,</span>&nbsp;<span class="num" id="6511055">0xf7</span><span class="op" id="6511059">,</span>&nbsp;<span class="num" id="6511061">0xda</span><span class="op" id="6511065">,</span>&nbsp;<span class="num" id="6511067">0x0e</span><span class="op" id="6511071">,</span>&nbsp;<span class="num" id="6511073">0x64</span><span class="op" id="6511077">,</span>&nbsp;<span class="num" id="6511079">0x52</span><span class="op" id="6511083">,</span>&nbsp;<span class="num" id="6511085">0xc8</span><span class="op" id="6511089">,</span>&nbsp;<span class="num" id="6511091">0x10</span><span class="op" id="6511095">,</span>&nbsp;<span class="num" id="6511097">0xf3</span><span class="op" id="6511101">,</span>&nbsp;<span class="num" id="6511103">0x2b</span><span class="op" id="6511107">,</span>&nbsp;<span class="num" id="6511109">0x80</span><span class="op" id="6511113">,</span>&nbsp;<span class="num" id="6511115">0x90</span><span class="op" id="6511119">,</span>&nbsp;<span class="num" id="6511121">0x79</span><span class="op" id="6511125">,</span>&nbsp;<span class="num" id="6511127">0xe5</span><span class="op" id="6511131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511136">0x62</span><span class="op" id="6511140">,</span>&nbsp;<span class="num" id="6511142">0xf8</span><span class="op" id="6511146">,</span>&nbsp;<span class="num" id="6511148">0xea</span><span class="op" id="6511152">,</span>&nbsp;<span class="num" id="6511154">0xd2</span><span class="op" id="6511158">,</span>&nbsp;<span class="num" id="6511160">0x52</span><span class="op" id="6511164">,</span>&nbsp;<span class="num" id="6511166">0x2c</span><span class="op" id="6511170">,</span>&nbsp;<span class="num" id="6511172">0x6b</span><span class="op" id="6511176">,</span>&nbsp;<span class="num" id="6511178">0x7b</span><span class="op" id="6511182">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511186">}</span><span class="op" id="6511187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511191">[</span><span class="op" id="6511192">]</span><span class="builtintype" id="6511193">uint32</span><span class="op" id="6511199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511204">0x8e73b0f7</span><span class="op" id="6511214">,</span>&nbsp;<span class="num" id="6511216">0xda0e6452</span><span class="op" id="6511226">,</span>&nbsp;<span class="num" id="6511228">0xc810f32b</span><span class="op" id="6511238">,</span>&nbsp;<span class="num" id="6511240">0x809079e5</span><span class="op" id="6511250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511255">0x62f8ead2</span><span class="op" id="6511265">,</span>&nbsp;<span class="num" id="6511267">0x522c6b7b</span><span class="op" id="6511277">,</span>&nbsp;<span class="num" id="6511279">0xfe0c91f7</span><span class="op" id="6511289">,</span>&nbsp;<span class="num" id="6511291">0x2402f5a5</span><span class="op" id="6511301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511306">0xec12068e</span><span class="op" id="6511316">,</span>&nbsp;<span class="num" id="6511318">0x6c827f6b</span><span class="op" id="6511328">,</span>&nbsp;<span class="num" id="6511330">0x0e7a95b9</span><span class="op" id="6511340">,</span>&nbsp;<span class="num" id="6511342">0x5c56fec2</span><span class="op" id="6511352">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511357">0x4db7b4bd</span><span class="op" id="6511367">,</span>&nbsp;<span class="num" id="6511369">0x69b54118</span><span class="op" id="6511379">,</span>&nbsp;<span class="num" id="6511381">0x85a74796</span><span class="op" id="6511391">,</span>&nbsp;<span class="num" id="6511393">0xe92538fd</span><span class="op" id="6511403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511408">0xe75fad44</span><span class="op" id="6511418">,</span>&nbsp;<span class="num" id="6511420">0xbb095386</span><span class="op" id="6511430">,</span>&nbsp;<span class="num" id="6511432">0x485af057</span><span class="op" id="6511442">,</span>&nbsp;<span class="num" id="6511444">0x21efb14f</span><span class="op" id="6511454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511459">0xa448f6d9</span><span class="op" id="6511469">,</span>&nbsp;<span class="num" id="6511471">0x4d6dce24</span><span class="op" id="6511481">,</span>&nbsp;<span class="num" id="6511483">0xaa326360</span><span class="op" id="6511493">,</span>&nbsp;<span class="num" id="6511495">0x113b30e6</span><span class="op" id="6511505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511510">0xa25e7ed5</span><span class="op" id="6511520">,</span>&nbsp;<span class="num" id="6511522">0x83b1cf9a</span><span class="op" id="6511532">,</span>&nbsp;<span class="num" id="6511534">0x27f93943</span><span class="op" id="6511544">,</span>&nbsp;<span class="num" id="6511546">0x6a94f767</span><span class="op" id="6511556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511561">0xc0a69407</span><span class="op" id="6511571">,</span>&nbsp;<span class="num" id="6511573">0xd19da4e1</span><span class="op" id="6511583">,</span>&nbsp;<span class="num" id="6511585">0xec1786eb</span><span class="op" id="6511595">,</span>&nbsp;<span class="num" id="6511597">0x6fa64971</span><span class="op" id="6511607">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511612">0x485f7032</span><span class="op" id="6511622">,</span>&nbsp;<span class="num" id="6511624">0x22cb8755</span><span class="op" id="6511634">,</span>&nbsp;<span class="num" id="6511636">0xe26d1352</span><span class="op" id="6511646">,</span>&nbsp;<span class="num" id="6511648">0x33f0b7b3</span><span class="op" id="6511658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511663">0x40beeb28</span><span class="op" id="6511673">,</span>&nbsp;<span class="num" id="6511675">0x2f18a259</span><span class="op" id="6511685">,</span>&nbsp;<span class="num" id="6511687">0x6747d26b</span><span class="op" id="6511697">,</span>&nbsp;<span class="num" id="6511699">0x458c553e</span><span class="op" id="6511709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511714">0xa7e1466c</span><span class="op" id="6511724">,</span>&nbsp;<span class="num" id="6511726">0x9411f1df</span><span class="op" id="6511736">,</span>&nbsp;<span class="num" id="6511738">0x821f750a</span><span class="op" id="6511748">,</span>&nbsp;<span class="num" id="6511750">0xad07d753</span><span class="op" id="6511760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511765">0xca400538</span><span class="op" id="6511775">,</span>&nbsp;<span class="num" id="6511777">0x8fcc5006</span><span class="op" id="6511787">,</span>&nbsp;<span class="num" id="6511789">0x282d166a</span><span class="op" id="6511799">,</span>&nbsp;<span class="num" id="6511801">0xbc3ce7b5</span><span class="op" id="6511811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511816">0xe98ba06f</span><span class="op" id="6511826">,</span>&nbsp;<span class="num" id="6511828">0x448c773c</span><span class="op" id="6511838">,</span>&nbsp;<span class="num" id="6511840">0x8ecc7204</span><span class="op" id="6511850">,</span>&nbsp;<span class="num" id="6511852">0x01002202</span><span class="op" id="6511862">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511866">}</span><span class="op" id="6511867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6511871">nil</span><span class="op" id="6511874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511877">}</span><span class="op" id="6511878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6511885">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6511930">[</span><span class="op" id="6511931">]</span><span class="builtintype" id="6511932">byte</span><span class="op" id="6511936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6511941">0x60</span><span class="op" id="6511945">,</span>&nbsp;<span class="num" id="6511947">0x3d</span><span class="op" id="6511951">,</span>&nbsp;<span class="num" id="6511953">0xeb</span><span class="op" id="6511957">,</span>&nbsp;<span class="num" id="6511959">0x10</span><span class="op" id="6511963">,</span>&nbsp;<span class="num" id="6511965">0x15</span><span class="op" id="6511969">,</span>&nbsp;<span class="num" id="6511971">0xca</span><span class="op" id="6511975">,</span>&nbsp;<span class="num" id="6511977">0x71</span><span class="op" id="6511981">,</span>&nbsp;<span class="num" id="6511983">0xbe</span><span class="op" id="6511987">,</span>&nbsp;<span class="num" id="6511989">0x2b</span><span class="op" id="6511993">,</span>&nbsp;<span class="num" id="6511995">0x73</span><span class="op" id="6511999">,</span>&nbsp;<span class="num" id="6512001">0xae</span><span class="op" id="6512005">,</span>&nbsp;<span class="num" id="6512007">0xf0</span><span class="op" id="6512011">,</span>&nbsp;<span class="num" id="6512013">0x85</span><span class="op" id="6512017">,</span>&nbsp;<span class="num" id="6512019">0x7d</span><span class="op" id="6512023">,</span>&nbsp;<span class="num" id="6512025">0x77</span><span class="op" id="6512029">,</span>&nbsp;<span class="num" id="6512031">0x81</span><span class="op" id="6512035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512040">0x1f</span><span class="op" id="6512044">,</span>&nbsp;<span class="num" id="6512046">0x35</span><span class="op" id="6512050">,</span>&nbsp;<span class="num" id="6512052">0x2c</span><span class="op" id="6512056">,</span>&nbsp;<span class="num" id="6512058">0x07</span><span class="op" id="6512062">,</span>&nbsp;<span class="num" id="6512064">0x3b</span><span class="op" id="6512068">,</span>&nbsp;<span class="num" id="6512070">0x61</span><span class="op" id="6512074">,</span>&nbsp;<span class="num" id="6512076">0x08</span><span class="op" id="6512080">,</span>&nbsp;<span class="num" id="6512082">0xd7</span><span class="op" id="6512086">,</span>&nbsp;<span class="num" id="6512088">0x2d</span><span class="op" id="6512092">,</span>&nbsp;<span class="num" id="6512094">0x98</span><span class="op" id="6512098">,</span>&nbsp;<span class="num" id="6512100">0x10</span><span class="op" id="6512104">,</span>&nbsp;<span class="num" id="6512106">0xa3</span><span class="op" id="6512110">,</span>&nbsp;<span class="num" id="6512112">0x09</span><span class="op" id="6512116">,</span>&nbsp;<span class="num" id="6512118">0x14</span><span class="op" id="6512122">,</span>&nbsp;<span class="num" id="6512124">0xdf</span><span class="op" id="6512128">,</span>&nbsp;<span class="num" id="6512130">0xf4</span><span class="op" id="6512134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6512138">}</span><span class="op" id="6512139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6512143">[</span><span class="op" id="6512144">]</span><span class="builtintype" id="6512145">uint32</span><span class="op" id="6512151">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512156">0x603deb10</span><span class="op" id="6512166">,</span>&nbsp;<span class="num" id="6512168">0x15ca71be</span><span class="op" id="6512178">,</span>&nbsp;<span class="num" id="6512180">0x2b73aef0</span><span class="op" id="6512190">,</span>&nbsp;<span class="num" id="6512192">0x857d7781</span><span class="op" id="6512202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512207">0x1f352c07</span><span class="op" id="6512217">,</span>&nbsp;<span class="num" id="6512219">0x3b6108d7</span><span class="op" id="6512229">,</span>&nbsp;<span class="num" id="6512231">0x2d9810a3</span><span class="op" id="6512241">,</span>&nbsp;<span class="num" id="6512243">0x0914dff4</span><span class="op" id="6512253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512258">0x9ba35411</span><span class="op" id="6512268">,</span>&nbsp;<span class="num" id="6512270">0x8e6925af</span><span class="op" id="6512280">,</span>&nbsp;<span class="num" id="6512282">0xa51a8b5f</span><span class="op" id="6512292">,</span>&nbsp;<span class="num" id="6512294">0x2067fcde</span><span class="op" id="6512304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512309">0xa8b09c1a</span><span class="op" id="6512319">,</span>&nbsp;<span class="num" id="6512321">0x93d194cd</span><span class="op" id="6512331">,</span>&nbsp;<span class="num" id="6512333">0xbe49846e</span><span class="op" id="6512343">,</span>&nbsp;<span class="num" id="6512345">0xb75d5b9a</span><span class="op" id="6512355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512360">0xd59aecb8</span><span class="op" id="6512370">,</span>&nbsp;<span class="num" id="6512372">0x5bf3c917</span><span class="op" id="6512382">,</span>&nbsp;<span class="num" id="6512384">0xfee94248</span><span class="op" id="6512394">,</span>&nbsp;<span class="num" id="6512396">0xde8ebe96</span><span class="op" id="6512406">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512411">0xb5a9328a</span><span class="op" id="6512421">,</span>&nbsp;<span class="num" id="6512423">0x2678a647</span><span class="op" id="6512433">,</span>&nbsp;<span class="num" id="6512435">0x98312229</span><span class="op" id="6512445">,</span>&nbsp;<span class="num" id="6512447">0x2f6c79b3</span><span class="op" id="6512457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512462">0x812c81ad</span><span class="op" id="6512472">,</span>&nbsp;<span class="num" id="6512474">0xdadf48ba</span><span class="op" id="6512484">,</span>&nbsp;<span class="num" id="6512486">0x24360af2</span><span class="op" id="6512496">,</span>&nbsp;<span class="num" id="6512498">0xfab8b464</span><span class="op" id="6512508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512513">0x98c5bfc9</span><span class="op" id="6512523">,</span>&nbsp;<span class="num" id="6512525">0xbebd198e</span><span class="op" id="6512535">,</span>&nbsp;<span class="num" id="6512537">0x268c3ba7</span><span class="op" id="6512547">,</span>&nbsp;<span class="num" id="6512549">0x09e04214</span><span class="op" id="6512559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512564">0x68007bac</span><span class="op" id="6512574">,</span>&nbsp;<span class="num" id="6512576">0xb2df3316</span><span class="op" id="6512586">,</span>&nbsp;<span class="num" id="6512588">0x96e939e4</span><span class="op" id="6512598">,</span>&nbsp;<span class="num" id="6512600">0x6c518d80</span><span class="op" id="6512610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512615">0xc814e204</span><span class="op" id="6512625">,</span>&nbsp;<span class="num" id="6512627">0x76a9fb8a</span><span class="op" id="6512637">,</span>&nbsp;<span class="num" id="6512639">0x5025c02d</span><span class="op" id="6512649">,</span>&nbsp;<span class="num" id="6512651">0x59c58239</span><span class="op" id="6512661">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512666">0xde136967</span><span class="op" id="6512676">,</span>&nbsp;<span class="num" id="6512678">0x6ccc5a71</span><span class="op" id="6512688">,</span>&nbsp;<span class="num" id="6512690">0xfa256395</span><span class="op" id="6512700">,</span>&nbsp;<span class="num" id="6512702">0x9674ee15</span><span class="op" id="6512712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512717">0x5886ca5d</span><span class="op" id="6512727">,</span>&nbsp;<span class="num" id="6512729">0x2e2f31d7</span><span class="op" id="6512739">,</span>&nbsp;<span class="num" id="6512741">0x7e0af1fa</span><span class="op" id="6512751">,</span>&nbsp;<span class="num" id="6512753">0x27cf73c3</span><span class="op" id="6512763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512768">0x749c47ab</span><span class="op" id="6512778">,</span>&nbsp;<span class="num" id="6512780">0x18501dda</span><span class="op" id="6512790">,</span>&nbsp;<span class="num" id="6512792">0xe2757e4f</span><span class="op" id="6512802">,</span>&nbsp;<span class="num" id="6512804">0x7401905a</span><span class="op" id="6512814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512819">0xcafaaae3</span><span class="op" id="6512829">,</span>&nbsp;<span class="num" id="6512831">0xe4d59b34</span><span class="op" id="6512841">,</span>&nbsp;<span class="num" id="6512843">0x9adf6ace</span><span class="op" id="6512853">,</span>&nbsp;<span class="num" id="6512855">0xbd10190d</span><span class="op" id="6512865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6512870">0xfe4890d1</span><span class="op" id="6512880">,</span>&nbsp;<span class="num" id="6512882">0xe6188d0b</span><span class="op" id="6512892">,</span>&nbsp;<span class="num" id="6512894">0x046df344</span><span class="op" id="6512904">,</span>&nbsp;<span class="num" id="6512906">0x706c631e</span><span class="op" id="6512916">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6512920">}</span><span class="op" id="6512921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6512925">nil</span><span class="op" id="6512928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6512931">}</span><span class="op" id="6512932">,</span><br>
<span class="lineno"></span><span class="op" id="6512934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="6512937">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6512986">func</span>&nbsp;<span class="ident" id="6512991">TestExpandKey</span><span class="op" id="6513004">(</span><span class="ident" id="6513005">t</span>&nbsp;<span class="op" id="6513007">*</span><span class="ident" id="6513008">testing</span><span class="op" id="6513015">.</span><span class="ident" id="6513016">T</span><span class="op" id="6513017">)</span>&nbsp;<span class="op" id="6513019">{</span><br>
<span class="lineno"></span><span class="ident" id="6513021">L</span><span class="op" id="6513022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513025">for</span>&nbsp;<span class="ident" id="6513029">i</span><span class="op" id="6513030">,</span>&nbsp;<span class="ident" id="6513032">tt</span>&nbsp;<span class="op" id="6513035">:=</span>&nbsp;<span class="keyword" id="6513038">range</span>&nbsp;<span class="ident" id="6513044">keyTests</span>&nbsp;<span class="op" id="6513053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513057">enc</span>&nbsp;<span class="op" id="6513061">:=</span>&nbsp;<span class="builtinfunc" id="6513064">make</span><span class="op" id="6513068">(</span><span class="op" id="6513069">[</span><span class="op" id="6513070">]</span><span class="builtintype" id="6513071">uint32</span><span class="op" id="6513077">,</span>&nbsp;<span class="builtinfunc" id="6513079">len</span><span class="op" id="6513082">(</span><span class="ident" id="6513083">tt</span><span class="op" id="6513085">.</span><span class="ident" id="6513086">enc</span><span class="op" id="6513089">)</span><span class="op" id="6513090">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513094">var</span>&nbsp;<span class="ident" id="6513098">dec</span>&nbsp;<span class="op" id="6513102">[</span><span class="op" id="6513103">]</span><span class="builtintype" id="6513104">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513113">if</span>&nbsp;<span class="ident" id="6513116">tt</span><span class="op" id="6513118">.</span><span class="ident" id="6513119">dec</span>&nbsp;<span class="op" id="6513123">!=</span>&nbsp;<span class="ident" id="6513126">nil</span>&nbsp;<span class="op" id="6513130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513135">dec</span>&nbsp;<span class="op" id="6513139">=</span>&nbsp;<span class="builtinfunc" id="6513141">make</span><span class="op" id="6513145">(</span><span class="op" id="6513146">[</span><span class="op" id="6513147">]</span><span class="builtintype" id="6513148">uint32</span><span class="op" id="6513154">,</span>&nbsp;<span class="builtinfunc" id="6513156">len</span><span class="op" id="6513159">(</span><span class="ident" id="6513160">tt</span><span class="op" id="6513162">.</span><span class="ident" id="6513163">dec</span><span class="op" id="6513166">)</span><span class="op" id="6513167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6513175">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6513242">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6513307">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513376">expandKeyGo</span><span class="op" id="6513387">(</span><span class="ident" id="6513388">tt</span><span class="op" id="6513390">.</span><span class="ident" id="6513391">key</span><span class="op" id="6513394">,</span>&nbsp;<span class="ident" id="6513396">enc</span><span class="op" id="6513399">,</span>&nbsp;<span class="ident" id="6513401">dec</span><span class="op" id="6513404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513408">for</span>&nbsp;<span class="ident" id="6513412">j</span><span class="op" id="6513413">,</span>&nbsp;<span class="ident" id="6513415">v</span>&nbsp;<span class="op" id="6513417">:=</span>&nbsp;<span class="keyword" id="6513420">range</span>&nbsp;<span class="ident" id="6513426">enc</span>&nbsp;<span class="op" id="6513430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513435">if</span>&nbsp;<span class="ident" id="6513438">v</span>&nbsp;<span class="op" id="6513440">!=</span>&nbsp;<span class="ident" id="6513443">tt</span><span class="op" id="6513445">.</span><span class="ident" id="6513446">enc</span><span class="op" id="6513449">[</span><span class="ident" id="6513450">j</span><span class="op" id="6513451">]</span>&nbsp;<span class="op" id="6513453">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513459">t</span><span class="op" id="6513460">.</span><span class="ident" id="6513461">Errorf</span><span class="op" id="6513467">(</span><span class="string" id="6513468">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6513501">,</span>&nbsp;<span class="ident" id="6513503">i</span><span class="op" id="6513504">,</span>&nbsp;<span class="ident" id="6513506">j</span><span class="op" id="6513507">,</span>&nbsp;<span class="ident" id="6513509">v</span><span class="op" id="6513510">,</span>&nbsp;<span class="ident" id="6513512">tt</span><span class="op" id="6513514">.</span><span class="ident" id="6513515">enc</span><span class="op" id="6513518">[</span><span class="ident" id="6513519">j</span><span class="op" id="6513520">]</span><span class="op" id="6513521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513527">continue</span>&nbsp;<span class="ident" id="6513536">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513549">if</span>&nbsp;<span class="ident" id="6513552">dec</span>&nbsp;<span class="op" id="6513556">!=</span>&nbsp;<span class="ident" id="6513559">nil</span>&nbsp;<span class="op" id="6513563">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513568">for</span>&nbsp;<span class="ident" id="6513572">j</span><span class="op" id="6513573">,</span>&nbsp;<span class="ident" id="6513575">v</span>&nbsp;<span class="op" id="6513577">:=</span>&nbsp;<span class="keyword" id="6513580">range</span>&nbsp;<span class="ident" id="6513586">dec</span>&nbsp;<span class="op" id="6513590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513596">if</span>&nbsp;<span class="ident" id="6513599">v</span>&nbsp;<span class="op" id="6513601">!=</span>&nbsp;<span class="ident" id="6513604">tt</span><span class="op" id="6513606">.</span><span class="ident" id="6513607">dec</span><span class="op" id="6513610">[</span><span class="ident" id="6513611">j</span><span class="op" id="6513612">]</span>&nbsp;<span class="op" id="6513614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513621">t</span><span class="op" id="6513622">.</span><span class="ident" id="6513623">Errorf</span><span class="op" id="6513629">(</span><span class="string" id="6513630">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6513663">,</span>&nbsp;<span class="ident" id="6513665">i</span><span class="op" id="6513666">,</span>&nbsp;<span class="ident" id="6513668">j</span><span class="op" id="6513669">,</span>&nbsp;<span class="ident" id="6513671">v</span><span class="op" id="6513672">,</span>&nbsp;<span class="ident" id="6513674">tt</span><span class="op" id="6513676">.</span><span class="ident" id="6513677">dec</span><span class="op" id="6513680">[</span><span class="ident" id="6513681">j</span><span class="op" id="6513682">]</span><span class="op" id="6513683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6513690">continue</span>&nbsp;<span class="ident" id="6513699">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513705">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513717">}</span><br>
<span class="lineno"></span><span class="op" id="6513719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="6513722">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="6513786">type</span>&nbsp;<span class="ident" id="6513791">CryptTest</span>&nbsp;<span class="keyword" id="6513801">struct</span>&nbsp;<span class="op" id="6513808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513811">key</span>&nbsp;<span class="op" id="6513815">[</span><span class="op" id="6513816">]</span><span class="builtintype" id="6513817">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513823">in</span>&nbsp;&nbsp;<span class="op" id="6513827">[</span><span class="op" id="6513828">]</span><span class="builtintype" id="6513829">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6513835">out</span>&nbsp;<span class="op" id="6513839">[</span><span class="op" id="6513840">]</span><span class="builtintype" id="6513841">byte</span><br>
<span class="lineno">250</span><span class="op" id="6513846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6513849">var</span>&nbsp;<span class="ident" id="6513853">encryptTests</span>&nbsp;<span class="op" id="6513866">=</span>&nbsp;<span class="op" id="6513868">[</span><span class="op" id="6513869">]</span><span class="ident" id="6513870">CryptTest</span><span class="op" id="6513879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6513886">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6513903">[</span><span class="op" id="6513904">]</span><span class="builtintype" id="6513905">byte</span><span class="op" id="6513909">{</span><span class="num" id="6513910">0x2b</span><span class="op" id="6513914">,</span>&nbsp;<span class="num" id="6513916">0x7e</span><span class="op" id="6513920">,</span>&nbsp;<span class="num" id="6513922">0x15</span><span class="op" id="6513926">,</span>&nbsp;<span class="num" id="6513928">0x16</span><span class="op" id="6513932">,</span>&nbsp;<span class="num" id="6513934">0x28</span><span class="op" id="6513938">,</span>&nbsp;<span class="num" id="6513940">0xae</span><span class="op" id="6513944">,</span>&nbsp;<span class="num" id="6513946">0xd2</span><span class="op" id="6513950">,</span>&nbsp;<span class="num" id="6513952">0xa6</span><span class="op" id="6513956">,</span>&nbsp;<span class="num" id="6513958">0xab</span><span class="op" id="6513962">,</span>&nbsp;<span class="num" id="6513964">0xf7</span><span class="op" id="6513968">,</span>&nbsp;<span class="num" id="6513970">0x15</span><span class="op" id="6513974">,</span>&nbsp;<span class="num" id="6513976">0x88</span><span class="op" id="6513980">,</span>&nbsp;<span class="num" id="6513982">0x09</span><span class="op" id="6513986">,</span>&nbsp;<span class="num" id="6513988">0xcf</span><span class="op" id="6513992">,</span>&nbsp;<span class="num" id="6513994">0x4f</span><span class="op" id="6513998">,</span>&nbsp;<span class="num" id="6514000">0x3c</span><span class="op" id="6514004">}</span><span class="op" id="6514005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514009">[</span><span class="op" id="6514010">]</span><span class="builtintype" id="6514011">byte</span><span class="op" id="6514015">{</span><span class="num" id="6514016">0x32</span><span class="op" id="6514020">,</span>&nbsp;<span class="num" id="6514022">0x43</span><span class="op" id="6514026">,</span>&nbsp;<span class="num" id="6514028">0xf6</span><span class="op" id="6514032">,</span>&nbsp;<span class="num" id="6514034">0xa8</span><span class="op" id="6514038">,</span>&nbsp;<span class="num" id="6514040">0x88</span><span class="op" id="6514044">,</span>&nbsp;<span class="num" id="6514046">0x5a</span><span class="op" id="6514050">,</span>&nbsp;<span class="num" id="6514052">0x30</span><span class="op" id="6514056">,</span>&nbsp;<span class="num" id="6514058">0x8d</span><span class="op" id="6514062">,</span>&nbsp;<span class="num" id="6514064">0x31</span><span class="op" id="6514068">,</span>&nbsp;<span class="num" id="6514070">0x31</span><span class="op" id="6514074">,</span>&nbsp;<span class="num" id="6514076">0x98</span><span class="op" id="6514080">,</span>&nbsp;<span class="num" id="6514082">0xa2</span><span class="op" id="6514086">,</span>&nbsp;<span class="num" id="6514088">0xe0</span><span class="op" id="6514092">,</span>&nbsp;<span class="num" id="6514094">0x37</span><span class="op" id="6514098">,</span>&nbsp;<span class="num" id="6514100">0x07</span><span class="op" id="6514104">,</span>&nbsp;<span class="num" id="6514106">0x34</span><span class="op" id="6514110">}</span><span class="op" id="6514111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514115">[</span><span class="op" id="6514116">]</span><span class="builtintype" id="6514117">byte</span><span class="op" id="6514121">{</span><span class="num" id="6514122">0x39</span><span class="op" id="6514126">,</span>&nbsp;<span class="num" id="6514128">0x25</span><span class="op" id="6514132">,</span>&nbsp;<span class="num" id="6514134">0x84</span><span class="op" id="6514138">,</span>&nbsp;<span class="num" id="6514140">0x1d</span><span class="op" id="6514144">,</span>&nbsp;<span class="num" id="6514146">0x02</span><span class="op" id="6514150">,</span>&nbsp;<span class="num" id="6514152">0xdc</span><span class="op" id="6514156">,</span>&nbsp;<span class="num" id="6514158">0x09</span><span class="op" id="6514162">,</span>&nbsp;<span class="num" id="6514164">0xfb</span><span class="op" id="6514168">,</span>&nbsp;<span class="num" id="6514170">0xdc</span><span class="op" id="6514174">,</span>&nbsp;<span class="num" id="6514176">0x11</span><span class="op" id="6514180">,</span>&nbsp;<span class="num" id="6514182">0x85</span><span class="op" id="6514186">,</span>&nbsp;<span class="num" id="6514188">0x97</span><span class="op" id="6514192">,</span>&nbsp;<span class="num" id="6514194">0x19</span><span class="op" id="6514198">,</span>&nbsp;<span class="num" id="6514200">0x6a</span><span class="op" id="6514204">,</span>&nbsp;<span class="num" id="6514206">0x0b</span><span class="op" id="6514210">,</span>&nbsp;<span class="num" id="6514212">0x32</span><span class="op" id="6514216">}</span><span class="op" id="6514217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514220">}</span><span class="op" id="6514221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514224">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6514228">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514256">[</span><span class="op" id="6514257">]</span><span class="builtintype" id="6514258">byte</span><span class="op" id="6514262">{</span><span class="num" id="6514263">0x00</span><span class="op" id="6514267">,</span>&nbsp;<span class="num" id="6514269">0x01</span><span class="op" id="6514273">,</span>&nbsp;<span class="num" id="6514275">0x02</span><span class="op" id="6514279">,</span>&nbsp;<span class="num" id="6514281">0x03</span><span class="op" id="6514285">,</span>&nbsp;<span class="num" id="6514287">0x04</span><span class="op" id="6514291">,</span>&nbsp;<span class="num" id="6514293">0x05</span><span class="op" id="6514297">,</span>&nbsp;<span class="num" id="6514299">0x06</span><span class="op" id="6514303">,</span>&nbsp;<span class="num" id="6514305">0x07</span><span class="op" id="6514309">,</span>&nbsp;<span class="num" id="6514311">0x08</span><span class="op" id="6514315">,</span>&nbsp;<span class="num" id="6514317">0x09</span><span class="op" id="6514321">,</span>&nbsp;<span class="num" id="6514323">0x0a</span><span class="op" id="6514327">,</span>&nbsp;<span class="num" id="6514329">0x0b</span><span class="op" id="6514333">,</span>&nbsp;<span class="num" id="6514335">0x0c</span><span class="op" id="6514339">,</span>&nbsp;<span class="num" id="6514341">0x0d</span><span class="op" id="6514345">,</span>&nbsp;<span class="num" id="6514347">0x0e</span><span class="op" id="6514351">,</span>&nbsp;<span class="num" id="6514353">0x0f</span><span class="op" id="6514357">}</span><span class="op" id="6514358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514362">[</span><span class="op" id="6514363">]</span><span class="builtintype" id="6514364">byte</span><span class="op" id="6514368">{</span><span class="num" id="6514369">0x00</span><span class="op" id="6514373">,</span>&nbsp;<span class="num" id="6514375">0x11</span><span class="op" id="6514379">,</span>&nbsp;<span class="num" id="6514381">0x22</span><span class="op" id="6514385">,</span>&nbsp;<span class="num" id="6514387">0x33</span><span class="op" id="6514391">,</span>&nbsp;<span class="num" id="6514393">0x44</span><span class="op" id="6514397">,</span>&nbsp;<span class="num" id="6514399">0x55</span><span class="op" id="6514403">,</span>&nbsp;<span class="num" id="6514405">0x66</span><span class="op" id="6514409">,</span>&nbsp;<span class="num" id="6514411">0x77</span><span class="op" id="6514415">,</span>&nbsp;<span class="num" id="6514417">0x88</span><span class="op" id="6514421">,</span>&nbsp;<span class="num" id="6514423">0x99</span><span class="op" id="6514427">,</span>&nbsp;<span class="num" id="6514429">0xaa</span><span class="op" id="6514433">,</span>&nbsp;<span class="num" id="6514435">0xbb</span><span class="op" id="6514439">,</span>&nbsp;<span class="num" id="6514441">0xcc</span><span class="op" id="6514445">,</span>&nbsp;<span class="num" id="6514447">0xdd</span><span class="op" id="6514451">,</span>&nbsp;<span class="num" id="6514453">0xee</span><span class="op" id="6514457">,</span>&nbsp;<span class="num" id="6514459">0xff</span><span class="op" id="6514463">}</span><span class="op" id="6514464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514468">[</span><span class="op" id="6514469">]</span><span class="builtintype" id="6514470">byte</span><span class="op" id="6514474">{</span><span class="num" id="6514475">0x69</span><span class="op" id="6514479">,</span>&nbsp;<span class="num" id="6514481">0xc4</span><span class="op" id="6514485">,</span>&nbsp;<span class="num" id="6514487">0xe0</span><span class="op" id="6514491">,</span>&nbsp;<span class="num" id="6514493">0xd8</span><span class="op" id="6514497">,</span>&nbsp;<span class="num" id="6514499">0x6a</span><span class="op" id="6514503">,</span>&nbsp;<span class="num" id="6514505">0x7b</span><span class="op" id="6514509">,</span>&nbsp;<span class="num" id="6514511">0x04</span><span class="op" id="6514515">,</span>&nbsp;<span class="num" id="6514517">0x30</span><span class="op" id="6514521">,</span>&nbsp;<span class="num" id="6514523">0xd8</span><span class="op" id="6514527">,</span>&nbsp;<span class="num" id="6514529">0xcd</span><span class="op" id="6514533">,</span>&nbsp;<span class="num" id="6514535">0xb7</span><span class="op" id="6514539">,</span>&nbsp;<span class="num" id="6514541">0x80</span><span class="op" id="6514545">,</span>&nbsp;<span class="num" id="6514547">0x70</span><span class="op" id="6514551">,</span>&nbsp;<span class="num" id="6514553">0xb4</span><span class="op" id="6514557">,</span>&nbsp;<span class="num" id="6514559">0xc5</span><span class="op" id="6514563">,</span>&nbsp;<span class="num" id="6514565">0x5a</span><span class="op" id="6514569">}</span><span class="op" id="6514570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514573">}</span><span class="op" id="6514574">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6514581">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514609">[</span><span class="op" id="6514610">]</span><span class="builtintype" id="6514611">byte</span><span class="op" id="6514615">{</span><span class="num" id="6514616">0x00</span><span class="op" id="6514620">,</span>&nbsp;<span class="num" id="6514622">0x01</span><span class="op" id="6514626">,</span>&nbsp;<span class="num" id="6514628">0x02</span><span class="op" id="6514632">,</span>&nbsp;<span class="num" id="6514634">0x03</span><span class="op" id="6514638">,</span>&nbsp;<span class="num" id="6514640">0x04</span><span class="op" id="6514644">,</span>&nbsp;<span class="num" id="6514646">0x05</span><span class="op" id="6514650">,</span>&nbsp;<span class="num" id="6514652">0x06</span><span class="op" id="6514656">,</span>&nbsp;<span class="num" id="6514658">0x07</span><span class="op" id="6514662">,</span>&nbsp;<span class="num" id="6514664">0x08</span><span class="op" id="6514668">,</span>&nbsp;<span class="num" id="6514670">0x09</span><span class="op" id="6514674">,</span>&nbsp;<span class="num" id="6514676">0x0a</span><span class="op" id="6514680">,</span>&nbsp;<span class="num" id="6514682">0x0b</span><span class="op" id="6514686">,</span>&nbsp;<span class="num" id="6514688">0x0c</span><span class="op" id="6514692">,</span>&nbsp;<span class="num" id="6514694">0x0d</span><span class="op" id="6514698">,</span>&nbsp;<span class="num" id="6514700">0x0e</span><span class="op" id="6514704">,</span>&nbsp;<span class="num" id="6514706">0x0f</span><span class="op" id="6514710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6514715">0x10</span><span class="op" id="6514719">,</span>&nbsp;<span class="num" id="6514721">0x11</span><span class="op" id="6514725">,</span>&nbsp;<span class="num" id="6514727">0x12</span><span class="op" id="6514731">,</span>&nbsp;<span class="num" id="6514733">0x13</span><span class="op" id="6514737">,</span>&nbsp;<span class="num" id="6514739">0x14</span><span class="op" id="6514743">,</span>&nbsp;<span class="num" id="6514745">0x15</span><span class="op" id="6514749">,</span>&nbsp;<span class="num" id="6514751">0x16</span><span class="op" id="6514755">,</span>&nbsp;<span class="num" id="6514757">0x17</span><span class="op" id="6514761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514765">}</span><span class="op" id="6514766">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514770">[</span><span class="op" id="6514771">]</span><span class="builtintype" id="6514772">byte</span><span class="op" id="6514776">{</span><span class="num" id="6514777">0x00</span><span class="op" id="6514781">,</span>&nbsp;<span class="num" id="6514783">0x11</span><span class="op" id="6514787">,</span>&nbsp;<span class="num" id="6514789">0x22</span><span class="op" id="6514793">,</span>&nbsp;<span class="num" id="6514795">0x33</span><span class="op" id="6514799">,</span>&nbsp;<span class="num" id="6514801">0x44</span><span class="op" id="6514805">,</span>&nbsp;<span class="num" id="6514807">0x55</span><span class="op" id="6514811">,</span>&nbsp;<span class="num" id="6514813">0x66</span><span class="op" id="6514817">,</span>&nbsp;<span class="num" id="6514819">0x77</span><span class="op" id="6514823">,</span>&nbsp;<span class="num" id="6514825">0x88</span><span class="op" id="6514829">,</span>&nbsp;<span class="num" id="6514831">0x99</span><span class="op" id="6514835">,</span>&nbsp;<span class="num" id="6514837">0xaa</span><span class="op" id="6514841">,</span>&nbsp;<span class="num" id="6514843">0xbb</span><span class="op" id="6514847">,</span>&nbsp;<span class="num" id="6514849">0xcc</span><span class="op" id="6514853">,</span>&nbsp;<span class="num" id="6514855">0xdd</span><span class="op" id="6514859">,</span>&nbsp;<span class="num" id="6514861">0xee</span><span class="op" id="6514865">,</span>&nbsp;<span class="num" id="6514867">0xff</span><span class="op" id="6514871">}</span><span class="op" id="6514872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514876">[</span><span class="op" id="6514877">]</span><span class="builtintype" id="6514878">byte</span><span class="op" id="6514882">{</span><span class="num" id="6514883">0xdd</span><span class="op" id="6514887">,</span>&nbsp;<span class="num" id="6514889">0xa9</span><span class="op" id="6514893">,</span>&nbsp;<span class="num" id="6514895">0x7c</span><span class="op" id="6514899">,</span>&nbsp;<span class="num" id="6514901">0xa4</span><span class="op" id="6514905">,</span>&nbsp;<span class="num" id="6514907">0x86</span><span class="op" id="6514911">,</span>&nbsp;<span class="num" id="6514913">0x4c</span><span class="op" id="6514917">,</span>&nbsp;<span class="num" id="6514919">0xdf</span><span class="op" id="6514923">,</span>&nbsp;<span class="num" id="6514925">0xe0</span><span class="op" id="6514929">,</span>&nbsp;<span class="num" id="6514931">0x6e</span><span class="op" id="6514935">,</span>&nbsp;<span class="num" id="6514937">0xaf</span><span class="op" id="6514941">,</span>&nbsp;<span class="num" id="6514943">0x70</span><span class="op" id="6514947">,</span>&nbsp;<span class="num" id="6514949">0xa0</span><span class="op" id="6514953">,</span>&nbsp;<span class="num" id="6514955">0xec</span><span class="op" id="6514959">,</span>&nbsp;<span class="num" id="6514961">0x0d</span><span class="op" id="6514965">,</span>&nbsp;<span class="num" id="6514967">0x71</span><span class="op" id="6514971">,</span>&nbsp;<span class="num" id="6514973">0x91</span><span class="op" id="6514977">}</span><span class="op" id="6514978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514981">}</span><span class="op" id="6514982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6514985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6514989">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515017">[</span><span class="op" id="6515018">]</span><span class="builtintype" id="6515019">byte</span><span class="op" id="6515023">{</span><span class="num" id="6515024">0x00</span><span class="op" id="6515028">,</span>&nbsp;<span class="num" id="6515030">0x01</span><span class="op" id="6515034">,</span>&nbsp;<span class="num" id="6515036">0x02</span><span class="op" id="6515040">,</span>&nbsp;<span class="num" id="6515042">0x03</span><span class="op" id="6515046">,</span>&nbsp;<span class="num" id="6515048">0x04</span><span class="op" id="6515052">,</span>&nbsp;<span class="num" id="6515054">0x05</span><span class="op" id="6515058">,</span>&nbsp;<span class="num" id="6515060">0x06</span><span class="op" id="6515064">,</span>&nbsp;<span class="num" id="6515066">0x07</span><span class="op" id="6515070">,</span>&nbsp;<span class="num" id="6515072">0x08</span><span class="op" id="6515076">,</span>&nbsp;<span class="num" id="6515078">0x09</span><span class="op" id="6515082">,</span>&nbsp;<span class="num" id="6515084">0x0a</span><span class="op" id="6515088">,</span>&nbsp;<span class="num" id="6515090">0x0b</span><span class="op" id="6515094">,</span>&nbsp;<span class="num" id="6515096">0x0c</span><span class="op" id="6515100">,</span>&nbsp;<span class="num" id="6515102">0x0d</span><span class="op" id="6515106">,</span>&nbsp;<span class="num" id="6515108">0x0e</span><span class="op" id="6515112">,</span>&nbsp;<span class="num" id="6515114">0x0f</span><span class="op" id="6515118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6515123">0x10</span><span class="op" id="6515127">,</span>&nbsp;<span class="num" id="6515129">0x11</span><span class="op" id="6515133">,</span>&nbsp;<span class="num" id="6515135">0x12</span><span class="op" id="6515139">,</span>&nbsp;<span class="num" id="6515141">0x13</span><span class="op" id="6515145">,</span>&nbsp;<span class="num" id="6515147">0x14</span><span class="op" id="6515151">,</span>&nbsp;<span class="num" id="6515153">0x15</span><span class="op" id="6515157">,</span>&nbsp;<span class="num" id="6515159">0x16</span><span class="op" id="6515163">,</span>&nbsp;<span class="num" id="6515165">0x17</span><span class="op" id="6515169">,</span>&nbsp;<span class="num" id="6515171">0x18</span><span class="op" id="6515175">,</span>&nbsp;<span class="num" id="6515177">0x19</span><span class="op" id="6515181">,</span>&nbsp;<span class="num" id="6515183">0x1a</span><span class="op" id="6515187">,</span>&nbsp;<span class="num" id="6515189">0x1b</span><span class="op" id="6515193">,</span>&nbsp;<span class="num" id="6515195">0x1c</span><span class="op" id="6515199">,</span>&nbsp;<span class="num" id="6515201">0x1d</span><span class="op" id="6515205">,</span>&nbsp;<span class="num" id="6515207">0x1e</span><span class="op" id="6515211">,</span>&nbsp;<span class="num" id="6515213">0x1f</span><span class="op" id="6515217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515221">}</span><span class="op" id="6515222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515226">[</span><span class="op" id="6515227">]</span><span class="builtintype" id="6515228">byte</span><span class="op" id="6515232">{</span><span class="num" id="6515233">0x00</span><span class="op" id="6515237">,</span>&nbsp;<span class="num" id="6515239">0x11</span><span class="op" id="6515243">,</span>&nbsp;<span class="num" id="6515245">0x22</span><span class="op" id="6515249">,</span>&nbsp;<span class="num" id="6515251">0x33</span><span class="op" id="6515255">,</span>&nbsp;<span class="num" id="6515257">0x44</span><span class="op" id="6515261">,</span>&nbsp;<span class="num" id="6515263">0x55</span><span class="op" id="6515267">,</span>&nbsp;<span class="num" id="6515269">0x66</span><span class="op" id="6515273">,</span>&nbsp;<span class="num" id="6515275">0x77</span><span class="op" id="6515279">,</span>&nbsp;<span class="num" id="6515281">0x88</span><span class="op" id="6515285">,</span>&nbsp;<span class="num" id="6515287">0x99</span><span class="op" id="6515291">,</span>&nbsp;<span class="num" id="6515293">0xaa</span><span class="op" id="6515297">,</span>&nbsp;<span class="num" id="6515299">0xbb</span><span class="op" id="6515303">,</span>&nbsp;<span class="num" id="6515305">0xcc</span><span class="op" id="6515309">,</span>&nbsp;<span class="num" id="6515311">0xdd</span><span class="op" id="6515315">,</span>&nbsp;<span class="num" id="6515317">0xee</span><span class="op" id="6515321">,</span>&nbsp;<span class="num" id="6515323">0xff</span><span class="op" id="6515327">}</span><span class="op" id="6515328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515332">[</span><span class="op" id="6515333">]</span><span class="builtintype" id="6515334">byte</span><span class="op" id="6515338">{</span><span class="num" id="6515339">0x8e</span><span class="op" id="6515343">,</span>&nbsp;<span class="num" id="6515345">0xa2</span><span class="op" id="6515349">,</span>&nbsp;<span class="num" id="6515351">0xb7</span><span class="op" id="6515355">,</span>&nbsp;<span class="num" id="6515357">0xca</span><span class="op" id="6515361">,</span>&nbsp;<span class="num" id="6515363">0x51</span><span class="op" id="6515367">,</span>&nbsp;<span class="num" id="6515369">0x67</span><span class="op" id="6515373">,</span>&nbsp;<span class="num" id="6515375">0x45</span><span class="op" id="6515379">,</span>&nbsp;<span class="num" id="6515381">0xbf</span><span class="op" id="6515385">,</span>&nbsp;<span class="num" id="6515387">0xea</span><span class="op" id="6515391">,</span>&nbsp;<span class="num" id="6515393">0xfc</span><span class="op" id="6515397">,</span>&nbsp;<span class="num" id="6515399">0x49</span><span class="op" id="6515403">,</span>&nbsp;<span class="num" id="6515405">0x90</span><span class="op" id="6515409">,</span>&nbsp;<span class="num" id="6515411">0x4b</span><span class="op" id="6515415">,</span>&nbsp;<span class="num" id="6515417">0x49</span><span class="op" id="6515421">,</span>&nbsp;<span class="num" id="6515423">0x60</span><span class="op" id="6515427">,</span>&nbsp;<span class="num" id="6515429">0x89</span><span class="op" id="6515433">}</span><span class="op" id="6515434">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515437">}</span><span class="op" id="6515438">,</span><br>
<span class="lineno"></span><span class="op" id="6515440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6515443">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6515491">func</span>&nbsp;<span class="ident" id="6515496">TestEncryptBlock</span><span class="op" id="6515512">(</span><span class="ident" id="6515513">t</span>&nbsp;<span class="op" id="6515515">*</span><span class="ident" id="6515516">testing</span><span class="op" id="6515523">.</span><span class="ident" id="6515524">T</span><span class="op" id="6515525">)</span>&nbsp;<span class="op" id="6515527">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6515530">for</span>&nbsp;<span class="ident" id="6515534">i</span><span class="op" id="6515535">,</span>&nbsp;<span class="ident" id="6515537">tt</span>&nbsp;<span class="op" id="6515540">:=</span>&nbsp;<span class="keyword" id="6515543">range</span>&nbsp;<span class="ident" id="6515549">encryptTests</span>&nbsp;<span class="op" id="6515562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515566">n</span>&nbsp;<span class="op" id="6515568">:=</span>&nbsp;<span class="builtinfunc" id="6515571">len</span><span class="op" id="6515574">(</span><span class="ident" id="6515575">tt</span><span class="op" id="6515577">.</span><span class="ident" id="6515578">key</span><span class="op" id="6515581">)</span>&nbsp;<span class="op" id="6515583">+</span>&nbsp;<span class="num" id="6515585">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515590">enc</span>&nbsp;<span class="op" id="6515594">:=</span>&nbsp;<span class="builtinfunc" id="6515597">make</span><span class="op" id="6515601">(</span><span class="op" id="6515602">[</span><span class="op" id="6515603">]</span><span class="builtintype" id="6515604">uint32</span><span class="op" id="6515610">,</span>&nbsp;<span class="ident" id="6515612">n</span><span class="op" id="6515613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515617">dec</span>&nbsp;<span class="op" id="6515621">:=</span>&nbsp;<span class="builtinfunc" id="6515624">make</span><span class="op" id="6515628">(</span><span class="op" id="6515629">[</span><span class="op" id="6515630">]</span><span class="builtintype" id="6515631">uint32</span><span class="op" id="6515637">,</span>&nbsp;<span class="ident" id="6515639">n</span><span class="op" id="6515640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515644">expandKey</span><span class="op" id="6515653">(</span><span class="ident" id="6515654">tt</span><span class="op" id="6515656">.</span><span class="ident" id="6515657">key</span><span class="op" id="6515660">,</span>&nbsp;<span class="ident" id="6515662">enc</span><span class="op" id="6515665">,</span>&nbsp;<span class="ident" id="6515667">dec</span><span class="op" id="6515670">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515674">out</span>&nbsp;<span class="op" id="6515678">:=</span>&nbsp;<span class="builtinfunc" id="6515681">make</span><span class="op" id="6515685">(</span><span class="op" id="6515686">[</span><span class="op" id="6515687">]</span><span class="builtintype" id="6515688">byte</span><span class="op" id="6515692">,</span>&nbsp;<span class="builtinfunc" id="6515694">len</span><span class="op" id="6515697">(</span><span class="ident" id="6515698">tt</span><span class="op" id="6515700">.</span><span class="ident" id="6515701">in</span><span class="op" id="6515703">)</span><span class="op" id="6515704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515708">encryptBlock</span><span class="op" id="6515720">(</span><span class="ident" id="6515721">enc</span><span class="op" id="6515724">,</span>&nbsp;<span class="ident" id="6515726">out</span><span class="op" id="6515729">,</span>&nbsp;<span class="ident" id="6515731">tt</span><span class="op" id="6515733">.</span><span class="ident" id="6515734">in</span><span class="op" id="6515736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6515740">for</span>&nbsp;<span class="ident" id="6515744">j</span><span class="op" id="6515745">,</span>&nbsp;<span class="ident" id="6515747">v</span>&nbsp;<span class="op" id="6515749">:=</span>&nbsp;<span class="keyword" id="6515752">range</span>&nbsp;<span class="ident" id="6515758">out</span>&nbsp;<span class="op" id="6515762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6515767">if</span>&nbsp;<span class="ident" id="6515770">v</span>&nbsp;<span class="op" id="6515772">!=</span>&nbsp;<span class="ident" id="6515775">tt</span><span class="op" id="6515777">.</span><span class="ident" id="6515778">out</span><span class="op" id="6515781">[</span><span class="ident" id="6515782">j</span><span class="op" id="6515783">]</span>&nbsp;<span class="op" id="6515785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6515791">t</span><span class="op" id="6515792">.</span><span class="ident" id="6515793">Errorf</span><span class="op" id="6515799">(</span><span class="string" id="6515800">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6515842">,</span>&nbsp;<span class="ident" id="6515844">i</span><span class="op" id="6515845">,</span>&nbsp;<span class="ident" id="6515847">j</span><span class="op" id="6515848">,</span>&nbsp;<span class="ident" id="6515850">v</span><span class="op" id="6515851">,</span>&nbsp;<span class="ident" id="6515853">tt</span><span class="op" id="6515855">.</span><span class="ident" id="6515856">out</span><span class="op" id="6515859">[</span><span class="ident" id="6515860">j</span><span class="op" id="6515861">]</span><span class="op" id="6515862">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6515868">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6515884">}</span><br>
<span class="lineno"></span><span class="op" id="6515886">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="6515889">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6515937">func</span>&nbsp;<span class="ident" id="6515942">TestDecryptBlock</span><span class="op" id="6515958">(</span><span class="ident" id="6515959">t</span>&nbsp;<span class="op" id="6515961">*</span><span class="ident" id="6515962">testing</span><span class="op" id="6515969">.</span><span class="ident" id="6515970">T</span><span class="op" id="6515971">)</span>&nbsp;<span class="op" id="6515973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6515976">for</span>&nbsp;<span class="ident" id="6515980">i</span><span class="op" id="6515981">,</span>&nbsp;<span class="ident" id="6515983">tt</span>&nbsp;<span class="op" id="6515986">:=</span>&nbsp;<span class="keyword" id="6515989">range</span>&nbsp;<span class="ident" id="6515995">encryptTests</span>&nbsp;<span class="op" id="6516008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516012">n</span>&nbsp;<span class="op" id="6516014">:=</span>&nbsp;<span class="builtinfunc" id="6516017">len</span><span class="op" id="6516020">(</span><span class="ident" id="6516021">tt</span><span class="op" id="6516023">.</span><span class="ident" id="6516024">key</span><span class="op" id="6516027">)</span>&nbsp;<span class="op" id="6516029">+</span>&nbsp;<span class="num" id="6516031">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516036">enc</span>&nbsp;<span class="op" id="6516040">:=</span>&nbsp;<span class="builtinfunc" id="6516043">make</span><span class="op" id="6516047">(</span><span class="op" id="6516048">[</span><span class="op" id="6516049">]</span><span class="builtintype" id="6516050">uint32</span><span class="op" id="6516056">,</span>&nbsp;<span class="ident" id="6516058">n</span><span class="op" id="6516059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516063">dec</span>&nbsp;<span class="op" id="6516067">:=</span>&nbsp;<span class="builtinfunc" id="6516070">make</span><span class="op" id="6516074">(</span><span class="op" id="6516075">[</span><span class="op" id="6516076">]</span><span class="builtintype" id="6516077">uint32</span><span class="op" id="6516083">,</span>&nbsp;<span class="ident" id="6516085">n</span><span class="op" id="6516086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516090">expandKey</span><span class="op" id="6516099">(</span><span class="ident" id="6516100">tt</span><span class="op" id="6516102">.</span><span class="ident" id="6516103">key</span><span class="op" id="6516106">,</span>&nbsp;<span class="ident" id="6516108">enc</span><span class="op" id="6516111">,</span>&nbsp;<span class="ident" id="6516113">dec</span><span class="op" id="6516116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516120">plain</span>&nbsp;<span class="op" id="6516126">:=</span>&nbsp;<span class="builtinfunc" id="6516129">make</span><span class="op" id="6516133">(</span><span class="op" id="6516134">[</span><span class="op" id="6516135">]</span><span class="builtintype" id="6516136">byte</span><span class="op" id="6516140">,</span>&nbsp;<span class="builtinfunc" id="6516142">len</span><span class="op" id="6516145">(</span><span class="ident" id="6516146">tt</span><span class="op" id="6516148">.</span><span class="ident" id="6516149">in</span><span class="op" id="6516151">)</span><span class="op" id="6516152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516156">decryptBlock</span><span class="op" id="6516168">(</span><span class="ident" id="6516169">dec</span><span class="op" id="6516172">,</span>&nbsp;<span class="ident" id="6516174">plain</span><span class="op" id="6516179">,</span>&nbsp;<span class="ident" id="6516181">tt</span><span class="op" id="6516183">.</span><span class="ident" id="6516184">out</span><span class="op" id="6516187">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516191">for</span>&nbsp;<span class="ident" id="6516195">j</span><span class="op" id="6516196">,</span>&nbsp;<span class="ident" id="6516198">v</span>&nbsp;<span class="op" id="6516200">:=</span>&nbsp;<span class="keyword" id="6516203">range</span>&nbsp;<span class="ident" id="6516209">plain</span>&nbsp;<span class="op" id="6516215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516220">if</span>&nbsp;<span class="ident" id="6516223">v</span>&nbsp;<span class="op" id="6516225">!=</span>&nbsp;<span class="ident" id="6516228">tt</span><span class="op" id="6516230">.</span><span class="ident" id="6516231">in</span><span class="op" id="6516233">[</span><span class="ident" id="6516234">j</span><span class="op" id="6516235">]</span>&nbsp;<span class="op" id="6516237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516243">t</span><span class="op" id="6516244">.</span><span class="ident" id="6516245">Errorf</span><span class="op" id="6516251">(</span><span class="string" id="6516252">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6516296">,</span>&nbsp;<span class="ident" id="6516298">i</span><span class="op" id="6516299">,</span>&nbsp;<span class="ident" id="6516301">j</span><span class="op" id="6516302">,</span>&nbsp;<span class="ident" id="6516304">v</span><span class="op" id="6516305">,</span>&nbsp;<span class="ident" id="6516307">tt</span><span class="op" id="6516309">.</span><span class="ident" id="6516310">in</span><span class="op" id="6516312">[</span><span class="ident" id="6516313">j</span><span class="op" id="6516314">]</span><span class="op" id="6516315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516321">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516330">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516337">}</span><br>
<span class="lineno"></span><span class="op" id="6516339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6516342">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="6516399">func</span>&nbsp;<span class="ident" id="6516404">TestCipherEncrypt</span><span class="op" id="6516421">(</span><span class="ident" id="6516422">t</span>&nbsp;<span class="op" id="6516424">*</span><span class="ident" id="6516425">testing</span><span class="op" id="6516432">.</span><span class="ident" id="6516433">T</span><span class="op" id="6516434">)</span>&nbsp;<span class="op" id="6516436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516439">for</span>&nbsp;<span class="ident" id="6516443">i</span><span class="op" id="6516444">,</span>&nbsp;<span class="ident" id="6516446">tt</span>&nbsp;<span class="op" id="6516449">:=</span>&nbsp;<span class="keyword" id="6516452">range</span>&nbsp;<span class="ident" id="6516458">encryptTests</span>&nbsp;<span class="op" id="6516471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516475">c</span><span class="op" id="6516476">,</span>&nbsp;<span class="ident" id="6516478">err</span>&nbsp;<span class="op" id="6516482">:=</span>&nbsp;<span class="ident" id="6516485">NewCipher</span><span class="op" id="6516494">(</span><span class="ident" id="6516495">tt</span><span class="op" id="6516497">.</span><span class="ident" id="6516498">key</span><span class="op" id="6516501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516505">if</span>&nbsp;<span class="ident" id="6516508">err</span>&nbsp;<span class="op" id="6516512">!=</span>&nbsp;<span class="ident" id="6516515">nil</span>&nbsp;<span class="op" id="6516519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516524">t</span><span class="op" id="6516525">.</span><span class="ident" id="6516526">Errorf</span><span class="op" id="6516532">(</span><span class="string" id="6516533">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6516559">,</span>&nbsp;<span class="builtinfunc" id="6516561">len</span><span class="op" id="6516564">(</span><span class="ident" id="6516565">tt</span><span class="op" id="6516567">.</span><span class="ident" id="6516568">key</span><span class="op" id="6516571">)</span><span class="op" id="6516572">,</span>&nbsp;<span class="ident" id="6516574">err</span><span class="op" id="6516577">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516582">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516597">out</span>&nbsp;<span class="op" id="6516601">:=</span>&nbsp;<span class="builtinfunc" id="6516604">make</span><span class="op" id="6516608">(</span><span class="op" id="6516609">[</span><span class="op" id="6516610">]</span><span class="builtintype" id="6516611">byte</span><span class="op" id="6516615">,</span>&nbsp;<span class="builtinfunc" id="6516617">len</span><span class="op" id="6516620">(</span><span class="ident" id="6516621">tt</span><span class="op" id="6516623">.</span><span class="ident" id="6516624">in</span><span class="op" id="6516626">)</span><span class="op" id="6516627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516631">c</span><span class="op" id="6516632">.</span><span class="ident" id="6516633">Encrypt</span><span class="op" id="6516640">(</span><span class="ident" id="6516641">out</span><span class="op" id="6516644">,</span>&nbsp;<span class="ident" id="6516646">tt</span><span class="op" id="6516648">.</span><span class="ident" id="6516649">in</span><span class="op" id="6516651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516655">for</span>&nbsp;<span class="ident" id="6516659">j</span><span class="op" id="6516660">,</span>&nbsp;<span class="ident" id="6516662">v</span>&nbsp;<span class="op" id="6516664">:=</span>&nbsp;<span class="keyword" id="6516667">range</span>&nbsp;<span class="ident" id="6516673">out</span>&nbsp;<span class="op" id="6516677">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516682">if</span>&nbsp;<span class="ident" id="6516685">v</span>&nbsp;<span class="op" id="6516687">!=</span>&nbsp;<span class="ident" id="6516690">tt</span><span class="op" id="6516692">.</span><span class="ident" id="6516693">out</span><span class="op" id="6516696">[</span><span class="ident" id="6516697">j</span><span class="op" id="6516698">]</span>&nbsp;<span class="op" id="6516700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516706">t</span><span class="op" id="6516707">.</span><span class="ident" id="6516708">Errorf</span><span class="op" id="6516714">(</span><span class="string" id="6516715">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6516759">,</span>&nbsp;<span class="ident" id="6516761">i</span><span class="op" id="6516762">,</span>&nbsp;<span class="ident" id="6516764">j</span><span class="op" id="6516765">,</span>&nbsp;<span class="ident" id="6516767">v</span><span class="op" id="6516768">,</span>&nbsp;<span class="ident" id="6516770">tt</span><span class="op" id="6516772">.</span><span class="ident" id="6516773">out</span><span class="op" id="6516776">[</span><span class="ident" id="6516777">j</span><span class="op" id="6516778">]</span><span class="op" id="6516779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516785">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516798">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6516801">}</span><br>
<span class="lineno"></span><span class="op" id="6516803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6516806">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6516856">func</span>&nbsp;<span class="ident" id="6516861">TestCipherDecrypt</span><span class="op" id="6516878">(</span><span class="ident" id="6516879">t</span>&nbsp;<span class="op" id="6516881">*</span><span class="ident" id="6516882">testing</span><span class="op" id="6516889">.</span><span class="ident" id="6516890">T</span><span class="op" id="6516891">)</span>&nbsp;<span class="op" id="6516893">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516896">for</span>&nbsp;<span class="ident" id="6516900">i</span><span class="op" id="6516901">,</span>&nbsp;<span class="ident" id="6516903">tt</span>&nbsp;<span class="op" id="6516906">:=</span>&nbsp;<span class="keyword" id="6516909">range</span>&nbsp;<span class="ident" id="6516915">encryptTests</span>&nbsp;<span class="op" id="6516928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516932">c</span><span class="op" id="6516933">,</span>&nbsp;<span class="ident" id="6516935">err</span>&nbsp;<span class="op" id="6516939">:=</span>&nbsp;<span class="ident" id="6516942">NewCipher</span><span class="op" id="6516951">(</span><span class="ident" id="6516952">tt</span><span class="op" id="6516954">.</span><span class="ident" id="6516955">key</span><span class="op" id="6516958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6516962">if</span>&nbsp;<span class="ident" id="6516965">err</span>&nbsp;<span class="op" id="6516969">!=</span>&nbsp;<span class="ident" id="6516972">nil</span>&nbsp;<span class="op" id="6516976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6516981">t</span><span class="op" id="6516982">.</span><span class="ident" id="6516983">Errorf</span><span class="op" id="6516989">(</span><span class="string" id="6516990">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6517016">,</span>&nbsp;<span class="builtinfunc" id="6517018">len</span><span class="op" id="6517021">(</span><span class="ident" id="6517022">tt</span><span class="op" id="6517024">.</span><span class="ident" id="6517025">key</span><span class="op" id="6517028">)</span><span class="op" id="6517029">,</span>&nbsp;<span class="ident" id="6517031">err</span><span class="op" id="6517034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6517039">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6517050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517054">plain</span>&nbsp;<span class="op" id="6517060">:=</span>&nbsp;<span class="builtinfunc" id="6517063">make</span><span class="op" id="6517067">(</span><span class="op" id="6517068">[</span><span class="op" id="6517069">]</span><span class="builtintype" id="6517070">byte</span><span class="op" id="6517074">,</span>&nbsp;<span class="builtinfunc" id="6517076">len</span><span class="op" id="6517079">(</span><span class="ident" id="6517080">tt</span><span class="op" id="6517082">.</span><span class="ident" id="6517083">in</span><span class="op" id="6517085">)</span><span class="op" id="6517086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517090">c</span><span class="op" id="6517091">.</span><span class="ident" id="6517092">Decrypt</span><span class="op" id="6517099">(</span><span class="ident" id="6517100">plain</span><span class="op" id="6517105">,</span>&nbsp;<span class="ident" id="6517107">tt</span><span class="op" id="6517109">.</span><span class="ident" id="6517110">out</span><span class="op" id="6517113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6517117">for</span>&nbsp;<span class="ident" id="6517121">j</span><span class="op" id="6517122">,</span>&nbsp;<span class="ident" id="6517124">v</span>&nbsp;<span class="op" id="6517126">:=</span>&nbsp;<span class="keyword" id="6517129">range</span>&nbsp;<span class="ident" id="6517135">plain</span>&nbsp;<span class="op" id="6517141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6517146">if</span>&nbsp;<span class="ident" id="6517149">v</span>&nbsp;<span class="op" id="6517151">!=</span>&nbsp;<span class="ident" id="6517154">tt</span><span class="op" id="6517156">.</span><span class="ident" id="6517157">in</span><span class="op" id="6517159">[</span><span class="ident" id="6517160">j</span><span class="op" id="6517161">]</span>&nbsp;<span class="op" id="6517163">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517169">t</span><span class="op" id="6517170">.</span><span class="ident" id="6517171">Errorf</span><span class="op" id="6517177">(</span><span class="string" id="6517178">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6517222">,</span>&nbsp;<span class="ident" id="6517224">i</span><span class="op" id="6517225">,</span>&nbsp;<span class="ident" id="6517227">j</span><span class="op" id="6517228">,</span>&nbsp;<span class="ident" id="6517230">v</span><span class="op" id="6517231">,</span>&nbsp;<span class="ident" id="6517233">tt</span><span class="op" id="6517235">.</span><span class="ident" id="6517236">in</span><span class="op" id="6517238">[</span><span class="ident" id="6517239">j</span><span class="op" id="6517240">]</span><span class="op" id="6517241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6517247">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6517256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6517260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6517263">}</span><br>
<span class="lineno">355</span><span class="op" id="6517265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6517268">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="6517296">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="6517328">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="6517347">func</span>&nbsp;<span class="ident" id="6517352">TestShortBlocks</span><span class="op" id="6517367">(</span><span class="ident" id="6517368">t</span>&nbsp;<span class="op" id="6517370">*</span><span class="ident" id="6517371">testing</span><span class="op" id="6517378">.</span><span class="ident" id="6517379">T</span><span class="op" id="6517380">)</span>&nbsp;<span class="op" id="6517382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517385">bytes</span>&nbsp;<span class="op" id="6517391">:=</span>&nbsp;<span class="keyword" id="6517394">func</span><span class="op" id="6517398">(</span><span class="ident" id="6517399">n</span>&nbsp;<span class="builtintype" id="6517401">int</span><span class="op" id="6517404">)</span>&nbsp;<span class="op" id="6517406">[</span><span class="op" id="6517407">]</span><span class="builtintype" id="6517408">byte</span>&nbsp;<span class="op" id="6517413">{</span>&nbsp;<span class="keyword" id="6517415">return</span>&nbsp;<span class="builtinfunc" id="6517422">make</span><span class="op" id="6517426">(</span><span class="op" id="6517427">[</span><span class="op" id="6517428">]</span><span class="builtintype" id="6517429">byte</span><span class="op" id="6517433">,</span>&nbsp;<span class="ident" id="6517435">n</span><span class="op" id="6517436">)</span>&nbsp;<span class="op" id="6517438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517442">c</span><span class="op" id="6517443">,</span>&nbsp;<span class="ident" id="6517445">_</span>&nbsp;<span class="op" id="6517447">:=</span>&nbsp;<span class="ident" id="6517450">NewCipher</span><span class="op" id="6517459">(</span><span class="ident" id="6517460">bytes</span><span class="op" id="6517465">(</span><span class="num" id="6517466">16</span><span class="op" id="6517468">)</span><span class="op" id="6517469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517473">mustPanic</span><span class="op" id="6517482">(</span><span class="ident" id="6517483">t</span><span class="op" id="6517484">,</span>&nbsp;<span class="string" id="6517486">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6517520">,</span>&nbsp;<span class="keyword" id="6517522">func</span><span class="op" id="6517526">(</span><span class="op" id="6517527">)</span>&nbsp;<span class="op" id="6517529">{</span>&nbsp;<span class="ident" id="6517531">c</span><span class="op" id="6517532">.</span><span class="ident" id="6517533">Encrypt</span><span class="op" id="6517540">(</span><span class="ident" id="6517541">bytes</span><span class="op" id="6517546">(</span><span class="num" id="6517547">1</span><span class="op" id="6517548">)</span><span class="op" id="6517549">,</span>&nbsp;<span class="ident" id="6517551">bytes</span><span class="op" id="6517556">(</span><span class="num" id="6517557">1</span><span class="op" id="6517558">)</span><span class="op" id="6517559">)</span>&nbsp;<span class="op" id="6517561">}</span><span class="op" id="6517562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517565">mustPanic</span><span class="op" id="6517574">(</span><span class="ident" id="6517575">t</span><span class="op" id="6517576">,</span>&nbsp;<span class="string" id="6517578">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6517612">,</span>&nbsp;<span class="keyword" id="6517614">func</span><span class="op" id="6517618">(</span><span class="op" id="6517619">)</span>&nbsp;<span class="op" id="6517621">{</span>&nbsp;<span class="ident" id="6517623">c</span><span class="op" id="6517624">.</span><span class="ident" id="6517625">Decrypt</span><span class="op" id="6517632">(</span><span class="ident" id="6517633">bytes</span><span class="op" id="6517638">(</span><span class="num" id="6517639">1</span><span class="op" id="6517640">)</span><span class="op" id="6517641">,</span>&nbsp;<span class="ident" id="6517643">bytes</span><span class="op" id="6517648">(</span><span class="num" id="6517649">1</span><span class="op" id="6517650">)</span><span class="op" id="6517651">)</span>&nbsp;<span class="op" id="6517653">}</span><span class="op" id="6517654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517657">mustPanic</span><span class="op" id="6517666">(</span><span class="ident" id="6517667">t</span><span class="op" id="6517668">,</span>&nbsp;<span class="string" id="6517670">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6517704">,</span>&nbsp;<span class="keyword" id="6517706">func</span><span class="op" id="6517710">(</span><span class="op" id="6517711">)</span>&nbsp;<span class="op" id="6517713">{</span>&nbsp;<span class="ident" id="6517715">c</span><span class="op" id="6517716">.</span><span class="ident" id="6517717">Encrypt</span><span class="op" id="6517724">(</span><span class="ident" id="6517725">bytes</span><span class="op" id="6517730">(</span><span class="num" id="6517731">100</span><span class="op" id="6517734">)</span><span class="op" id="6517735">,</span>&nbsp;<span class="ident" id="6517737">bytes</span><span class="op" id="6517742">(</span><span class="num" id="6517743">1</span><span class="op" id="6517744">)</span><span class="op" id="6517745">)</span>&nbsp;<span class="op" id="6517747">}</span><span class="op" id="6517748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517751">mustPanic</span><span class="op" id="6517760">(</span><span class="ident" id="6517761">t</span><span class="op" id="6517762">,</span>&nbsp;<span class="string" id="6517764">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6517798">,</span>&nbsp;<span class="keyword" id="6517800">func</span><span class="op" id="6517804">(</span><span class="op" id="6517805">)</span>&nbsp;<span class="op" id="6517807">{</span>&nbsp;<span class="ident" id="6517809">c</span><span class="op" id="6517810">.</span><span class="ident" id="6517811">Decrypt</span><span class="op" id="6517818">(</span><span class="ident" id="6517819">bytes</span><span class="op" id="6517824">(</span><span class="num" id="6517825">100</span><span class="op" id="6517828">)</span><span class="op" id="6517829">,</span>&nbsp;<span class="ident" id="6517831">bytes</span><span class="op" id="6517836">(</span><span class="num" id="6517837">1</span><span class="op" id="6517838">)</span><span class="op" id="6517839">)</span>&nbsp;<span class="op" id="6517841">}</span><span class="op" id="6517842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517845">mustPanic</span><span class="op" id="6517854">(</span><span class="ident" id="6517855">t</span><span class="op" id="6517856">,</span>&nbsp;<span class="string" id="6517858">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6517893">,</span>&nbsp;<span class="keyword" id="6517895">func</span><span class="op" id="6517899">(</span><span class="op" id="6517900">)</span>&nbsp;<span class="op" id="6517902">{</span>&nbsp;<span class="ident" id="6517904">c</span><span class="op" id="6517905">.</span><span class="ident" id="6517906">Encrypt</span><span class="op" id="6517913">(</span><span class="ident" id="6517914">bytes</span><span class="op" id="6517919">(</span><span class="num" id="6517920">1</span><span class="op" id="6517921">)</span><span class="op" id="6517922">,</span>&nbsp;<span class="ident" id="6517924">bytes</span><span class="op" id="6517929">(</span><span class="num" id="6517930">100</span><span class="op" id="6517933">)</span><span class="op" id="6517934">)</span>&nbsp;<span class="op" id="6517936">}</span><span class="op" id="6517937">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6517940">mustPanic</span><span class="op" id="6517949">(</span><span class="ident" id="6517950">t</span><span class="op" id="6517951">,</span>&nbsp;<span class="string" id="6517953">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6517988">,</span>&nbsp;<span class="keyword" id="6517990">func</span><span class="op" id="6517994">(</span><span class="op" id="6517995">)</span>&nbsp;<span class="op" id="6517997">{</span>&nbsp;<span class="ident" id="6517999">c</span><span class="op" id="6518000">.</span><span class="ident" id="6518001">Decrypt</span><span class="op" id="6518008">(</span><span class="ident" id="6518009">bytes</span><span class="op" id="6518014">(</span><span class="num" id="6518015">1</span><span class="op" id="6518016">)</span><span class="op" id="6518017">,</span>&nbsp;<span class="ident" id="6518019">bytes</span><span class="op" id="6518024">(</span><span class="num" id="6518025">100</span><span class="op" id="6518028">)</span><span class="op" id="6518029">)</span>&nbsp;<span class="op" id="6518031">}</span><span class="op" id="6518032">)</span><br>
<span class="lineno"></span><span class="op" id="6518034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6518037">func</span>&nbsp;<span class="ident" id="6518042">mustPanic</span><span class="op" id="6518051">(</span><span class="ident" id="6518052">t</span>&nbsp;<span class="op" id="6518054">*</span><span class="ident" id="6518055">testing</span><span class="op" id="6518062">.</span><span class="ident" id="6518063">T</span><span class="op" id="6518064">,</span>&nbsp;<span class="ident" id="6518066">msg</span>&nbsp;<span class="builtintype" id="6518070">string</span><span class="op" id="6518076">,</span>&nbsp;<span class="ident" id="6518078">f</span>&nbsp;<span class="keyword" id="6518080">func</span><span class="op" id="6518084">(</span><span class="op" id="6518085">)</span><span class="op" id="6518086">)</span>&nbsp;<span class="op" id="6518088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518091">defer</span>&nbsp;<span class="keyword" id="6518097">func</span><span class="op" id="6518101">(</span><span class="op" id="6518102">)</span>&nbsp;<span class="op" id="6518104">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518108">err</span>&nbsp;<span class="op" id="6518112">:=</span>&nbsp;<span class="builtinfunc" id="6518115">recover</span><span class="op" id="6518122">(</span><span class="op" id="6518123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518127">if</span>&nbsp;<span class="ident" id="6518130">err</span>&nbsp;<span class="op" id="6518134">==</span>&nbsp;<span class="ident" id="6518137">nil</span>&nbsp;<span class="op" id="6518141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518146">t</span><span class="op" id="6518147">.</span><span class="ident" id="6518148">Errorf</span><span class="op" id="6518154">(</span><span class="string" id="6518155">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6518190">,</span>&nbsp;<span class="ident" id="6518192">msg</span><span class="op" id="6518195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518199">}</span>&nbsp;<span class="keyword" id="6518201">else</span>&nbsp;<span class="keyword" id="6518206">if</span>&nbsp;<span class="ident" id="6518209">err</span>&nbsp;<span class="op" id="6518213">!=</span>&nbsp;<span class="ident" id="6518216">msg</span>&nbsp;<span class="op" id="6518220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518225">t</span><span class="op" id="6518226">.</span><span class="ident" id="6518227">Errorf</span><span class="op" id="6518233">(</span><span class="string" id="6518234">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6518259">,</span>&nbsp;<span class="ident" id="6518261">err</span><span class="op" id="6518264">,</span>&nbsp;<span class="ident" id="6518266">msg</span><span class="op" id="6518269">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518276">}</span><span class="op" id="6518277">(</span><span class="op" id="6518278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518281">f</span><span class="op" id="6518282">(</span><span class="op" id="6518283">)</span><br>
<span class="lineno"></span><span class="op" id="6518285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6518288">func</span>&nbsp;<span class="ident" id="6518293">BenchmarkEncrypt</span><span class="op" id="6518309">(</span><span class="ident" id="6518310">b</span>&nbsp;<span class="op" id="6518312">*</span><span class="ident" id="6518313">testing</span><span class="op" id="6518320">.</span><span class="ident" id="6518321">B</span><span class="op" id="6518322">)</span>&nbsp;<span class="op" id="6518324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518327">tt</span>&nbsp;<span class="op" id="6518330">:=</span>&nbsp;<span class="ident" id="6518333">encryptTests</span><span class="op" id="6518345">[</span><span class="num" id="6518346">0</span><span class="op" id="6518347">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518350">c</span><span class="op" id="6518351">,</span>&nbsp;<span class="ident" id="6518353">err</span>&nbsp;<span class="op" id="6518357">:=</span>&nbsp;<span class="ident" id="6518360">NewCipher</span><span class="op" id="6518369">(</span><span class="ident" id="6518370">tt</span><span class="op" id="6518372">.</span><span class="ident" id="6518373">key</span><span class="op" id="6518376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518379">if</span>&nbsp;<span class="ident" id="6518382">err</span>&nbsp;<span class="op" id="6518386">!=</span>&nbsp;<span class="ident" id="6518389">nil</span>&nbsp;<span class="op" id="6518393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518397">b</span><span class="op" id="6518398">.</span><span class="ident" id="6518399">Fatal</span><span class="op" id="6518404">(</span><span class="string" id="6518405">&#34;NewCipher:&#34;</span><span class="op" id="6518417">,</span>&nbsp;<span class="ident" id="6518419">err</span><span class="op" id="6518422">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518428">out</span>&nbsp;<span class="op" id="6518432">:=</span>&nbsp;<span class="builtinfunc" id="6518435">make</span><span class="op" id="6518439">(</span><span class="op" id="6518440">[</span><span class="op" id="6518441">]</span><span class="builtintype" id="6518442">byte</span><span class="op" id="6518446">,</span>&nbsp;<span class="builtinfunc" id="6518448">len</span><span class="op" id="6518451">(</span><span class="ident" id="6518452">tt</span><span class="op" id="6518454">.</span><span class="ident" id="6518455">in</span><span class="op" id="6518457">)</span><span class="op" id="6518458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518461">b</span><span class="op" id="6518462">.</span><span class="ident" id="6518463">SetBytes</span><span class="op" id="6518471">(</span><span class="ident" id="6518472">int64</span><span class="op" id="6518477">(</span><span class="builtinfunc" id="6518478">len</span><span class="op" id="6518481">(</span><span class="ident" id="6518482">out</span><span class="op" id="6518485">)</span><span class="op" id="6518486">)</span><span class="op" id="6518487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518490">b</span><span class="op" id="6518491">.</span><span class="ident" id="6518492">ResetTimer</span><span class="op" id="6518502">(</span><span class="op" id="6518503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518506">for</span>&nbsp;<span class="ident" id="6518510">i</span>&nbsp;<span class="op" id="6518512">:=</span>&nbsp;<span class="num" id="6518515">0</span><span class="op" id="6518516">;</span>&nbsp;<span class="ident" id="6518518">i</span>&nbsp;<span class="op" id="6518520">&lt;</span>&nbsp;<span class="ident" id="6518522">b</span><span class="op" id="6518523">.</span><span class="ident" id="6518524">N</span><span class="op" id="6518525">;</span>&nbsp;<span class="ident" id="6518527">i</span><span class="op" id="6518528">++</span>&nbsp;<span class="op" id="6518531">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518535">c</span><span class="op" id="6518536">.</span><span class="ident" id="6518537">Encrypt</span><span class="op" id="6518544">(</span><span class="ident" id="6518545">out</span><span class="op" id="6518548">,</span>&nbsp;<span class="ident" id="6518550">tt</span><span class="op" id="6518552">.</span><span class="ident" id="6518553">in</span><span class="op" id="6518555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518558">}</span><br>
<span class="lineno"></span><span class="op" id="6518560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6518563">func</span>&nbsp;<span class="ident" id="6518568">BenchmarkDecrypt</span><span class="op" id="6518584">(</span><span class="ident" id="6518585">b</span>&nbsp;<span class="op" id="6518587">*</span><span class="ident" id="6518588">testing</span><span class="op" id="6518595">.</span><span class="ident" id="6518596">B</span><span class="op" id="6518597">)</span>&nbsp;<span class="op" id="6518599">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518602">tt</span>&nbsp;<span class="op" id="6518605">:=</span>&nbsp;<span class="ident" id="6518608">encryptTests</span><span class="op" id="6518620">[</span><span class="num" id="6518621">0</span><span class="op" id="6518622">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518625">c</span><span class="op" id="6518626">,</span>&nbsp;<span class="ident" id="6518628">err</span>&nbsp;<span class="op" id="6518632">:=</span>&nbsp;<span class="ident" id="6518635">NewCipher</span><span class="op" id="6518644">(</span><span class="ident" id="6518645">tt</span><span class="op" id="6518647">.</span><span class="ident" id="6518648">key</span><span class="op" id="6518651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518654">if</span>&nbsp;<span class="ident" id="6518657">err</span>&nbsp;<span class="op" id="6518661">!=</span>&nbsp;<span class="ident" id="6518664">nil</span>&nbsp;<span class="op" id="6518668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518672">b</span><span class="op" id="6518673">.</span><span class="ident" id="6518674">Fatal</span><span class="op" id="6518679">(</span><span class="string" id="6518680">&#34;NewCipher:&#34;</span><span class="op" id="6518692">,</span>&nbsp;<span class="ident" id="6518694">err</span><span class="op" id="6518697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518700">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518703">out</span>&nbsp;<span class="op" id="6518707">:=</span>&nbsp;<span class="builtinfunc" id="6518710">make</span><span class="op" id="6518714">(</span><span class="op" id="6518715">[</span><span class="op" id="6518716">]</span><span class="builtintype" id="6518717">byte</span><span class="op" id="6518721">,</span>&nbsp;<span class="builtinfunc" id="6518723">len</span><span class="op" id="6518726">(</span><span class="ident" id="6518727">tt</span><span class="op" id="6518729">.</span><span class="ident" id="6518730">out</span><span class="op" id="6518733">)</span><span class="op" id="6518734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518737">b</span><span class="op" id="6518738">.</span><span class="ident" id="6518739">SetBytes</span><span class="op" id="6518747">(</span><span class="ident" id="6518748">int64</span><span class="op" id="6518753">(</span><span class="builtinfunc" id="6518754">len</span><span class="op" id="6518757">(</span><span class="ident" id="6518758">out</span><span class="op" id="6518761">)</span><span class="op" id="6518762">)</span><span class="op" id="6518763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518766">b</span><span class="op" id="6518767">.</span><span class="ident" id="6518768">ResetTimer</span><span class="op" id="6518778">(</span><span class="op" id="6518779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518782">for</span>&nbsp;<span class="ident" id="6518786">i</span>&nbsp;<span class="op" id="6518788">:=</span>&nbsp;<span class="num" id="6518791">0</span><span class="op" id="6518792">;</span>&nbsp;<span class="ident" id="6518794">i</span>&nbsp;<span class="op" id="6518796">&lt;</span>&nbsp;<span class="ident" id="6518798">b</span><span class="op" id="6518799">.</span><span class="ident" id="6518800">N</span><span class="op" id="6518801">;</span>&nbsp;<span class="ident" id="6518803">i</span><span class="op" id="6518804">++</span>&nbsp;<span class="op" id="6518807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518811">c</span><span class="op" id="6518812">.</span><span class="ident" id="6518813">Decrypt</span><span class="op" id="6518820">(</span><span class="ident" id="6518821">out</span><span class="op" id="6518824">,</span>&nbsp;<span class="ident" id="6518826">tt</span><span class="op" id="6518828">.</span><span class="ident" id="6518829">out</span><span class="op" id="6518832">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6518835">}</span><br>
<span class="lineno"></span><span class="op" id="6518837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6518840">func</span>&nbsp;<span class="ident" id="6518845">BenchmarkExpand</span><span class="op" id="6518860">(</span><span class="ident" id="6518861">b</span>&nbsp;<span class="op" id="6518863">*</span><span class="ident" id="6518864">testing</span><span class="op" id="6518871">.</span><span class="ident" id="6518872">B</span><span class="op" id="6518873">)</span>&nbsp;<span class="op" id="6518875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518878">tt</span>&nbsp;<span class="op" id="6518881">:=</span>&nbsp;<span class="ident" id="6518884">encryptTests</span><span class="op" id="6518896">[</span><span class="num" id="6518897">0</span><span class="op" id="6518898">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518901">n</span>&nbsp;<span class="op" id="6518903">:=</span>&nbsp;<span class="builtinfunc" id="6518906">len</span><span class="op" id="6518909">(</span><span class="ident" id="6518910">tt</span><span class="op" id="6518912">.</span><span class="ident" id="6518913">key</span><span class="op" id="6518916">)</span>&nbsp;<span class="op" id="6518918">+</span>&nbsp;<span class="num" id="6518920">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518924">c</span>&nbsp;<span class="op" id="6518926">:=</span>&nbsp;<span class="op" id="6518929">&amp;</span><span class="ident" id="6518930">aesCipher</span><span class="op" id="6518939">{</span><span class="builtinfunc" id="6518940">make</span><span class="op" id="6518944">(</span><span class="op" id="6518945">[</span><span class="op" id="6518946">]</span><span class="builtintype" id="6518947">uint32</span><span class="op" id="6518953">,</span>&nbsp;<span class="ident" id="6518955">n</span><span class="op" id="6518956">)</span><span class="op" id="6518957">,</span>&nbsp;<span class="builtinfunc" id="6518959">make</span><span class="op" id="6518963">(</span><span class="op" id="6518964">[</span><span class="op" id="6518965">]</span><span class="builtintype" id="6518966">uint32</span><span class="op" id="6518972">,</span>&nbsp;<span class="ident" id="6518974">n</span><span class="op" id="6518975">)</span><span class="op" id="6518976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6518979">b</span><span class="op" id="6518980">.</span><span class="ident" id="6518981">ResetTimer</span><span class="op" id="6518991">(</span><span class="op" id="6518992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6518995">for</span>&nbsp;<span class="ident" id="6518999">i</span>&nbsp;<span class="op" id="6519001">:=</span>&nbsp;<span class="num" id="6519004">0</span><span class="op" id="6519005">;</span>&nbsp;<span class="ident" id="6519007">i</span>&nbsp;<span class="op" id="6519009">&lt;</span>&nbsp;<span class="ident" id="6519011">b</span><span class="op" id="6519012">.</span><span class="ident" id="6519013">N</span><span class="op" id="6519014">;</span>&nbsp;<span class="ident" id="6519016">i</span><span class="op" id="6519017">++</span>&nbsp;<span class="op" id="6519020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519024">expandKey</span><span class="op" id="6519033">(</span><span class="ident" id="6519034">tt</span><span class="op" id="6519036">.</span><span class="ident" id="6519037">key</span><span class="op" id="6519040">,</span>&nbsp;<span class="ident" id="6519042">c</span><span class="op" id="6519043">.</span><span class="ident" id="6519044">enc</span><span class="op" id="6519047">,</span>&nbsp;<span class="ident" id="6519049">c</span><span class="op" id="6519050">.</span><span class="ident" id="6519051">dec</span><span class="op" id="6519054">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519057">}</span><br>
<span class="lineno"></span><span class="op" id="6519059">}</span>
</div>
</body>
</html>
