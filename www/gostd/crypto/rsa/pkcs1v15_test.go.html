<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8198502">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8198557">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8198611">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8198662">package</span>&nbsp;<span class="ident" id="8198670">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8198675">import</span>&nbsp;<span class="op" id="8198682">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198685">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198694">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198704">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198719">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198734">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198753">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198769">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198775">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198787">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8198798">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8198814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8198817">func</span>&nbsp;<span class="ident" id="8198822">decodeBase64</span><span class="op" id="8198834">(</span><span class="ident" id="8198835">in</span>&nbsp;<span class="builtintype" id="8198838">string</span><span class="op" id="8198844">)</span>&nbsp;<span class="op" id="8198846">[</span><span class="op" id="8198847">]</span><span class="builtintype" id="8198848">byte</span>&nbsp;<span class="op" id="8198853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8198856">out</span>&nbsp;<span class="op" id="8198860">:=</span>&nbsp;<span class="builtinfunc" id="8198863">make</span><span class="op" id="8198867">(</span><span class="op" id="8198868">[</span><span class="op" id="8198869">]</span><span class="builtintype" id="8198870">byte</span><span class="op" id="8198874">,</span>&nbsp;<span class="ident" id="8198876">base64</span><span class="op" id="8198882">.</span><span class="ident" id="8198883">StdEncoding</span><span class="op" id="8198894">.</span><span class="ident" id="8198895">DecodedLen</span><span class="op" id="8198905">(</span><span class="builtinfunc" id="8198906">len</span><span class="op" id="8198909">(</span><span class="ident" id="8198910">in</span><span class="op" id="8198912">)</span><span class="op" id="8198913">)</span><span class="op" id="8198914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8198917">n</span><span class="op" id="8198918">,</span>&nbsp;<span class="ident" id="8198920">err</span>&nbsp;<span class="op" id="8198924">:=</span>&nbsp;<span class="ident" id="8198927">base64</span><span class="op" id="8198933">.</span><span class="ident" id="8198934">StdEncoding</span><span class="op" id="8198945">.</span><span class="ident" id="8198946">Decode</span><span class="op" id="8198952">(</span><span class="ident" id="8198953">out</span><span class="op" id="8198956">,</span>&nbsp;<span class="op" id="8198958">[</span><span class="op" id="8198959">]</span><span class="builtintype" id="8198960">byte</span><span class="op" id="8198964">(</span><span class="ident" id="8198965">in</span><span class="op" id="8198967">)</span><span class="op" id="8198968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8198971">if</span>&nbsp;<span class="ident" id="8198974">err</span>&nbsp;<span class="op" id="8198978">!=</span>&nbsp;<span class="ident" id="8198981">nil</span>&nbsp;<span class="op" id="8198985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8198989">return</span>&nbsp;<span class="ident" id="8198996">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8199004">return</span>&nbsp;<span class="ident" id="8199011">out</span><span class="op" id="8199014">[</span><span class="num" id="8199015">0</span><span class="op" id="8199016">:</span><span class="ident" id="8199017">n</span><span class="op" id="8199018">]</span><br>
<span class="lineno"></span><span class="op" id="8199020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8199023">type</span>&nbsp;<span class="ident" id="8199028">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="8199048">struct</span>&nbsp;<span class="op" id="8199055">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8199058">in</span><span class="op" id="8199060">,</span>&nbsp;<span class="ident" id="8199062">out</span>&nbsp;<span class="builtintype" id="8199066">string</span><br>
<span class="lineno"></span><span class="op" id="8199073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8199076">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8199150">var</span>&nbsp;<span class="ident" id="8199154">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8199175">=</span>&nbsp;<span class="op" id="8199177">[</span><span class="op" id="8199178">]</span><span class="ident" id="8199179">DecryptPKCS1v15Test</span><span class="op" id="8199198">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199205">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="8199295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199299">&#34;x&#34;</span><span class="op" id="8199302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199305">}</span><span class="op" id="8199306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199309">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199313">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="8199403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199407">&#34;testing.&#34;</span><span class="op" id="8199417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199420">}</span><span class="op" id="8199421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199428">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="8199518">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199522">&#34;testing.\n&#34;</span><span class="op" id="8199534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199537">}</span><span class="op" id="8199538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199545">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="8199635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8199639">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="8199694">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199697">}</span><span class="op" id="8199698">,</span><br>
<span class="lineno"></span><span class="op" id="8199700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8199703">func</span>&nbsp;<span class="ident" id="8199708">TestDecryptPKCS1v15</span><span class="op" id="8199727">(</span><span class="ident" id="8199728">t</span>&nbsp;<span class="op" id="8199730">*</span><span class="ident" id="8199731">testing</span><span class="op" id="8199738">.</span><span class="ident" id="8199739">T</span><span class="op" id="8199740">)</span>&nbsp;<span class="op" id="8199742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8199745">for</span>&nbsp;<span class="ident" id="8199749">i</span><span class="op" id="8199750">,</span>&nbsp;<span class="ident" id="8199752">test</span>&nbsp;<span class="op" id="8199757">:=</span>&nbsp;<span class="keyword" id="8199760">range</span>&nbsp;<span class="ident" id="8199766">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="8199787">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8199791">out</span><span class="op" id="8199794">,</span>&nbsp;<span class="ident" id="8199796">err</span>&nbsp;<span class="op" id="8199800">:=</span>&nbsp;<span class="ident" id="8199803">DecryptPKCS1v15</span><span class="op" id="8199818">(</span><span class="ident" id="8199819">nil</span><span class="op" id="8199822">,</span>&nbsp;<span class="ident" id="8199824">rsaPrivateKey</span><span class="op" id="8199837">,</span>&nbsp;<span class="ident" id="8199839">decodeBase64</span><span class="op" id="8199851">(</span><span class="ident" id="8199852">test</span><span class="op" id="8199856">.</span><span class="ident" id="8199857">in</span><span class="op" id="8199859">)</span><span class="op" id="8199860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8199864">if</span>&nbsp;<span class="ident" id="8199867">err</span>&nbsp;<span class="op" id="8199871">!=</span>&nbsp;<span class="ident" id="8199874">nil</span>&nbsp;<span class="op" id="8199878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8199883">t</span><span class="op" id="8199884">.</span><span class="ident" id="8199885">Errorf</span><span class="op" id="8199891">(</span><span class="string" id="8199892">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8199914">,</span>&nbsp;<span class="ident" id="8199916">i</span><span class="op" id="8199917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8199921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8199925">want</span>&nbsp;<span class="op" id="8199930">:=</span>&nbsp;<span class="op" id="8199933">[</span><span class="op" id="8199934">]</span><span class="builtintype" id="8199935">byte</span><span class="op" id="8199939">(</span><span class="ident" id="8199940">test</span><span class="op" id="8199944">.</span><span class="ident" id="8199945">out</span><span class="op" id="8199948">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8199952">if</span>&nbsp;<span class="op" id="8199955">!</span><span class="ident" id="8199956">bytes</span><span class="op" id="8199961">.</span><span class="ident" id="8199962">Equal</span><span class="op" id="8199967">(</span><span class="ident" id="8199968">out</span><span class="op" id="8199971">,</span>&nbsp;<span class="ident" id="8199973">want</span><span class="op" id="8199977">)</span>&nbsp;<span class="op" id="8199979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8199984">t</span><span class="op" id="8199985">.</span><span class="ident" id="8199986">Errorf</span><span class="op" id="8199992">(</span><span class="string" id="8199993">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8200015">,</span>&nbsp;<span class="ident" id="8200017">i</span><span class="op" id="8200018">,</span>&nbsp;<span class="ident" id="8200020">out</span><span class="op" id="8200023">,</span>&nbsp;<span class="ident" id="8200025">want</span><span class="op" id="8200029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200036">}</span><br>
<span class="lineno"></span><span class="op" id="8200038">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="8200041">func</span>&nbsp;<span class="ident" id="8200046">TestEncryptPKCS1v15</span><span class="op" id="8200065">(</span><span class="ident" id="8200066">t</span>&nbsp;<span class="op" id="8200068">*</span><span class="ident" id="8200069">testing</span><span class="op" id="8200076">.</span><span class="ident" id="8200077">T</span><span class="op" id="8200078">)</span>&nbsp;<span class="op" id="8200080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200083">random</span>&nbsp;<span class="op" id="8200090">:=</span>&nbsp;<span class="ident" id="8200093">rand</span><span class="op" id="8200097">.</span><span class="ident" id="8200098">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200106">k</span>&nbsp;<span class="op" id="8200108">:=</span>&nbsp;<span class="op" id="8200111">(</span><span class="ident" id="8200112">rsaPrivateKey</span><span class="op" id="8200125">.</span><span class="ident" id="8200126">N</span><span class="op" id="8200127">.</span><span class="ident" id="8200128">BitLen</span><span class="op" id="8200134">(</span><span class="op" id="8200135">)</span>&nbsp;<span class="op" id="8200137">+</span>&nbsp;<span class="num" id="8200139">7</span><span class="op" id="8200140">)</span>&nbsp;<span class="op" id="8200142">/</span>&nbsp;<span class="num" id="8200144">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200148">tryEncryptDecrypt</span>&nbsp;<span class="op" id="8200166">:=</span>&nbsp;<span class="keyword" id="8200169">func</span><span class="op" id="8200173">(</span><span class="ident" id="8200174">in</span>&nbsp;<span class="op" id="8200177">[</span><span class="op" id="8200178">]</span><span class="builtintype" id="8200179">byte</span><span class="op" id="8200183">,</span>&nbsp;<span class="ident" id="8200185">blind</span>&nbsp;<span class="builtintype" id="8200191">bool</span><span class="op" id="8200195">)</span>&nbsp;<span class="builtintype" id="8200197">bool</span>&nbsp;<span class="op" id="8200202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200206">if</span>&nbsp;<span class="builtinfunc" id="8200209">len</span><span class="op" id="8200212">(</span><span class="ident" id="8200213">in</span><span class="op" id="8200215">)</span>&nbsp;<span class="op" id="8200217">&gt;</span>&nbsp;<span class="ident" id="8200219">k</span><span class="op" id="8200220">-</span><span class="num" id="8200221">11</span>&nbsp;<span class="op" id="8200224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200229">in</span>&nbsp;<span class="op" id="8200232">=</span>&nbsp;<span class="ident" id="8200234">in</span><span class="op" id="8200236">[</span><span class="num" id="8200237">0</span>&nbsp;<span class="op" id="8200239">:</span>&nbsp;<span class="ident" id="8200241">k</span><span class="op" id="8200242">-</span><span class="num" id="8200243">11</span><span class="op" id="8200245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200254">ciphertext</span><span class="op" id="8200264">,</span>&nbsp;<span class="ident" id="8200266">err</span>&nbsp;<span class="op" id="8200270">:=</span>&nbsp;<span class="ident" id="8200273">EncryptPKCS1v15</span><span class="op" id="8200288">(</span><span class="ident" id="8200289">random</span><span class="op" id="8200295">,</span>&nbsp;<span class="op" id="8200297">&amp;</span><span class="ident" id="8200298">rsaPrivateKey</span><span class="op" id="8200311">.</span><span class="ident" id="8200312">PublicKey</span><span class="op" id="8200321">,</span>&nbsp;<span class="ident" id="8200323">in</span><span class="op" id="8200325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200329">if</span>&nbsp;<span class="ident" id="8200332">err</span>&nbsp;<span class="op" id="8200336">!=</span>&nbsp;<span class="ident" id="8200339">nil</span>&nbsp;<span class="op" id="8200343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200348">t</span><span class="op" id="8200349">.</span><span class="ident" id="8200350">Errorf</span><span class="op" id="8200356">(</span><span class="string" id="8200357">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="8200379">,</span>&nbsp;<span class="ident" id="8200381">err</span><span class="op" id="8200384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200389">return</span>&nbsp;<span class="builtintype" id="8200396">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200404">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200409">var</span>&nbsp;<span class="ident" id="8200413">rand</span>&nbsp;<span class="ident" id="8200418">io</span><span class="op" id="8200420">.</span><span class="ident" id="8200421">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200430">if</span>&nbsp;<span class="op" id="8200433">!</span><span class="ident" id="8200434">blind</span>&nbsp;<span class="op" id="8200440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200445">rand</span>&nbsp;<span class="op" id="8200450">=</span>&nbsp;<span class="ident" id="8200452">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200458">}</span>&nbsp;<span class="keyword" id="8200460">else</span>&nbsp;<span class="op" id="8200465">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200470">rand</span>&nbsp;<span class="op" id="8200475">=</span>&nbsp;<span class="ident" id="8200477">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200490">plaintext</span><span class="op" id="8200499">,</span>&nbsp;<span class="ident" id="8200501">err</span>&nbsp;<span class="op" id="8200505">:=</span>&nbsp;<span class="ident" id="8200508">DecryptPKCS1v15</span><span class="op" id="8200523">(</span><span class="ident" id="8200524">rand</span><span class="op" id="8200528">,</span>&nbsp;<span class="ident" id="8200530">rsaPrivateKey</span><span class="op" id="8200543">,</span>&nbsp;<span class="ident" id="8200545">ciphertext</span><span class="op" id="8200555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200559">if</span>&nbsp;<span class="ident" id="8200562">err</span>&nbsp;<span class="op" id="8200566">!=</span>&nbsp;<span class="ident" id="8200569">nil</span>&nbsp;<span class="op" id="8200573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200578">t</span><span class="op" id="8200579">.</span><span class="ident" id="8200580">Errorf</span><span class="op" id="8200586">(</span><span class="string" id="8200587">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="8200609">,</span>&nbsp;<span class="ident" id="8200611">err</span><span class="op" id="8200614">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200619">return</span>&nbsp;<span class="builtintype" id="8200626">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200639">if</span>&nbsp;<span class="op" id="8200642">!</span><span class="ident" id="8200643">bytes</span><span class="op" id="8200648">.</span><span class="ident" id="8200649">Equal</span><span class="op" id="8200654">(</span><span class="ident" id="8200655">plaintext</span><span class="op" id="8200664">,</span>&nbsp;<span class="ident" id="8200666">in</span><span class="op" id="8200668">)</span>&nbsp;<span class="op" id="8200670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200675">t</span><span class="op" id="8200676">.</span><span class="ident" id="8200677">Errorf</span><span class="op" id="8200683">(</span><span class="string" id="8200684">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="8200710">,</span>&nbsp;<span class="ident" id="8200712">plaintext</span><span class="op" id="8200721">,</span>&nbsp;<span class="ident" id="8200723">in</span><span class="op" id="8200725">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200730">return</span>&nbsp;<span class="builtintype" id="8200737">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200749">return</span>&nbsp;<span class="builtintype" id="8200756">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200766">config</span>&nbsp;<span class="op" id="8200773">:=</span>&nbsp;<span class="builtinfunc" id="8200776">new</span><span class="op" id="8200779">(</span><span class="ident" id="8200780">quick</span><span class="op" id="8200785">.</span><span class="ident" id="8200786">Config</span><span class="op" id="8200792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8200795">if</span>&nbsp;<span class="ident" id="8200798">testing</span><span class="op" id="8200805">.</span><span class="ident" id="8200806">Short</span><span class="op" id="8200811">(</span><span class="op" id="8200812">)</span>&nbsp;<span class="op" id="8200814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200818">config</span><span class="op" id="8200824">.</span><span class="ident" id="8200825">MaxCount</span>&nbsp;<span class="op" id="8200834">=</span>&nbsp;<span class="num" id="8200836">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8200840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8200843">quick</span><span class="op" id="8200848">.</span><span class="ident" id="8200849">Check</span><span class="op" id="8200854">(</span><span class="ident" id="8200855">tryEncryptDecrypt</span><span class="op" id="8200872">,</span>&nbsp;<span class="ident" id="8200874">config</span><span class="op" id="8200880">)</span><br>
<span class="lineno">105</span><span class="op" id="8200882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8200885">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="8200959">var</span>&nbsp;<span class="ident" id="8200963">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8200994">=</span>&nbsp;<span class="op" id="8200996">[</span><span class="op" id="8200997">]</span><span class="ident" id="8200998">DecryptPKCS1v15Test</span><span class="op" id="8201017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201020">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201024">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="8201114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201118">&#34;1234&#34;</span><span class="op" id="8201124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201127">}</span><span class="op" id="8201128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201135">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="8201225">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201229">&#34;FAIL&#34;</span><span class="op" id="8201235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201238">}</span><span class="op" id="8201239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201246">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="8201336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201340">&#34;abcd&#34;</span><span class="op" id="8201346">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201349">}</span><span class="op" id="8201350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201357">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="8201447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8201451">&#34;FAIL&#34;</span><span class="op" id="8201457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201460">}</span><span class="op" id="8201461">,</span><br>
<span class="lineno">125</span><span class="op" id="8201463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8201466">func</span>&nbsp;<span class="ident" id="8201471">TestEncryptPKCS1v15SessionKey</span><span class="op" id="8201500">(</span><span class="ident" id="8201501">t</span>&nbsp;<span class="op" id="8201503">*</span><span class="ident" id="8201504">testing</span><span class="op" id="8201511">.</span><span class="ident" id="8201512">T</span><span class="op" id="8201513">)</span>&nbsp;<span class="op" id="8201515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8201518">for</span>&nbsp;<span class="ident" id="8201522">i</span><span class="op" id="8201523">,</span>&nbsp;<span class="ident" id="8201525">test</span>&nbsp;<span class="op" id="8201530">:=</span>&nbsp;<span class="keyword" id="8201533">range</span>&nbsp;<span class="ident" id="8201539">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="8201570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201574">key</span>&nbsp;<span class="op" id="8201578">:=</span>&nbsp;<span class="op" id="8201581">[</span><span class="op" id="8201582">]</span><span class="builtintype" id="8201583">byte</span><span class="op" id="8201587">(</span><span class="string" id="8201588">&#34;FAIL&#34;</span><span class="op" id="8201594">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201598">err</span>&nbsp;<span class="op" id="8201602">:=</span>&nbsp;<span class="ident" id="8201605">DecryptPKCS1v15SessionKey</span><span class="op" id="8201630">(</span><span class="ident" id="8201631">nil</span><span class="op" id="8201634">,</span>&nbsp;<span class="ident" id="8201636">rsaPrivateKey</span><span class="op" id="8201649">,</span>&nbsp;<span class="ident" id="8201651">decodeBase64</span><span class="op" id="8201663">(</span><span class="ident" id="8201664">test</span><span class="op" id="8201668">.</span><span class="ident" id="8201669">in</span><span class="op" id="8201671">)</span><span class="op" id="8201672">,</span>&nbsp;<span class="ident" id="8201674">key</span><span class="op" id="8201677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8201681">if</span>&nbsp;<span class="ident" id="8201684">err</span>&nbsp;<span class="op" id="8201688">!=</span>&nbsp;<span class="ident" id="8201691">nil</span>&nbsp;<span class="op" id="8201695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201700">t</span><span class="op" id="8201701">.</span><span class="ident" id="8201702">Errorf</span><span class="op" id="8201708">(</span><span class="string" id="8201709">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="8201731">,</span>&nbsp;<span class="ident" id="8201733">i</span><span class="op" id="8201734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201742">want</span>&nbsp;<span class="op" id="8201747">:=</span>&nbsp;<span class="op" id="8201750">[</span><span class="op" id="8201751">]</span><span class="builtintype" id="8201752">byte</span><span class="op" id="8201756">(</span><span class="ident" id="8201757">test</span><span class="op" id="8201761">.</span><span class="ident" id="8201762">out</span><span class="op" id="8201765">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8201769">if</span>&nbsp;<span class="op" id="8201772">!</span><span class="ident" id="8201773">bytes</span><span class="op" id="8201778">.</span><span class="ident" id="8201779">Equal</span><span class="op" id="8201784">(</span><span class="ident" id="8201785">key</span><span class="op" id="8201788">,</span>&nbsp;<span class="ident" id="8201790">want</span><span class="op" id="8201794">)</span>&nbsp;<span class="op" id="8201796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201801">t</span><span class="op" id="8201802">.</span><span class="ident" id="8201803">Errorf</span><span class="op" id="8201809">(</span><span class="string" id="8201810">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8201832">,</span>&nbsp;<span class="ident" id="8201834">i</span><span class="op" id="8201835">,</span>&nbsp;<span class="ident" id="8201837">key</span><span class="op" id="8201840">,</span>&nbsp;<span class="ident" id="8201842">want</span><span class="op" id="8201846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8201853">}</span><br>
<span class="lineno"></span><span class="op" id="8201855">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8201858">func</span>&nbsp;<span class="ident" id="8201863">TestNonZeroRandomBytes</span><span class="op" id="8201885">(</span><span class="ident" id="8201886">t</span>&nbsp;<span class="op" id="8201888">*</span><span class="ident" id="8201889">testing</span><span class="op" id="8201896">.</span><span class="ident" id="8201897">T</span><span class="op" id="8201898">)</span>&nbsp;<span class="op" id="8201900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201903">random</span>&nbsp;<span class="op" id="8201910">:=</span>&nbsp;<span class="ident" id="8201913">rand</span><span class="op" id="8201917">.</span><span class="ident" id="8201918">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201927">b</span>&nbsp;<span class="op" id="8201929">:=</span>&nbsp;<span class="builtinfunc" id="8201932">make</span><span class="op" id="8201936">(</span><span class="op" id="8201937">[</span><span class="op" id="8201938">]</span><span class="builtintype" id="8201939">byte</span><span class="op" id="8201943">,</span>&nbsp;<span class="num" id="8201945">512</span><span class="op" id="8201948">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201951">err</span>&nbsp;<span class="op" id="8201955">:=</span>&nbsp;<span class="ident" id="8201958">nonZeroRandomBytes</span><span class="op" id="8201976">(</span><span class="ident" id="8201977">b</span><span class="op" id="8201978">,</span>&nbsp;<span class="ident" id="8201980">random</span><span class="op" id="8201986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8201989">if</span>&nbsp;<span class="ident" id="8201992">err</span>&nbsp;<span class="op" id="8201996">!=</span>&nbsp;<span class="ident" id="8201999">nil</span>&nbsp;<span class="op" id="8202003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202007">t</span><span class="op" id="8202008">.</span><span class="ident" id="8202009">Errorf</span><span class="op" id="8202015">(</span><span class="string" id="8202016">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="8202036">,</span>&nbsp;<span class="ident" id="8202038">err</span><span class="op" id="8202041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202047">for</span>&nbsp;<span class="ident" id="8202051">_</span><span class="op" id="8202052">,</span>&nbsp;<span class="ident" id="8202054">b</span>&nbsp;<span class="op" id="8202056">:=</span>&nbsp;<span class="keyword" id="8202059">range</span>&nbsp;<span class="ident" id="8202065">b</span>&nbsp;<span class="op" id="8202067">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202071">if</span>&nbsp;<span class="ident" id="8202074">b</span>&nbsp;<span class="op" id="8202076">==</span>&nbsp;<span class="num" id="8202079">0</span>&nbsp;<span class="op" id="8202081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202086">t</span><span class="op" id="8202087">.</span><span class="ident" id="8202088">Errorf</span><span class="op" id="8202094">(</span><span class="string" id="8202095">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="8202113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202118">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202130">}</span><br>
<span class="lineno">155</span><span class="op" id="8202132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8202135">type</span>&nbsp;<span class="ident" id="8202140">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="8202157">struct</span>&nbsp;<span class="op" id="8202164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202167">in</span><span class="op" id="8202169">,</span>&nbsp;<span class="ident" id="8202171">out</span>&nbsp;<span class="builtintype" id="8202175">string</span><br>
<span class="lineno"></span><span class="op" id="8202182">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="8202185">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="8202224">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="8202291">var</span>&nbsp;<span class="ident" id="8202295">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8202313">=</span>&nbsp;<span class="op" id="8202315">[</span><span class="op" id="8202316">]</span><span class="ident" id="8202317">signPKCS1v15Test</span><span class="op" id="8202333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202336">{</span><span class="string" id="8202337">&#34;Test.\n&#34;</span><span class="op" id="8202346">,</span>&nbsp;<span class="string" id="8202348">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="8202478">}</span><span class="op" id="8202479">,</span><br>
<span class="lineno">165</span><span class="op" id="8202481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8202484">func</span>&nbsp;<span class="ident" id="8202489">TestSignPKCS1v15</span><span class="op" id="8202505">(</span><span class="ident" id="8202506">t</span>&nbsp;<span class="op" id="8202508">*</span><span class="ident" id="8202509">testing</span><span class="op" id="8202516">.</span><span class="ident" id="8202517">T</span><span class="op" id="8202518">)</span>&nbsp;<span class="op" id="8202520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202523">for</span>&nbsp;<span class="ident" id="8202527">i</span><span class="op" id="8202528">,</span>&nbsp;<span class="ident" id="8202530">test</span>&nbsp;<span class="op" id="8202535">:=</span>&nbsp;<span class="keyword" id="8202538">range</span>&nbsp;<span class="ident" id="8202544">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8202562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202566">h</span>&nbsp;<span class="op" id="8202568">:=</span>&nbsp;<span class="ident" id="8202571">sha1</span><span class="op" id="8202575">.</span><span class="ident" id="8202576">New</span><span class="op" id="8202579">(</span><span class="op" id="8202580">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202584">h</span><span class="op" id="8202585">.</span><span class="ident" id="8202586">Write</span><span class="op" id="8202591">(</span><span class="op" id="8202592">[</span><span class="op" id="8202593">]</span><span class="builtintype" id="8202594">byte</span><span class="op" id="8202598">(</span><span class="ident" id="8202599">test</span><span class="op" id="8202603">.</span><span class="ident" id="8202604">in</span><span class="op" id="8202606">)</span><span class="op" id="8202607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202611">digest</span>&nbsp;<span class="op" id="8202618">:=</span>&nbsp;<span class="ident" id="8202621">h</span><span class="op" id="8202622">.</span><span class="ident" id="8202623">Sum</span><span class="op" id="8202626">(</span><span class="ident" id="8202627">nil</span><span class="op" id="8202630">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202635">s</span><span class="op" id="8202636">,</span>&nbsp;<span class="ident" id="8202638">err</span>&nbsp;<span class="op" id="8202642">:=</span>&nbsp;<span class="ident" id="8202645">SignPKCS1v15</span><span class="op" id="8202657">(</span><span class="ident" id="8202658">nil</span><span class="op" id="8202661">,</span>&nbsp;<span class="ident" id="8202663">rsaPrivateKey</span><span class="op" id="8202676">,</span>&nbsp;<span class="ident" id="8202678">crypto</span><span class="op" id="8202684">.</span><span class="ident" id="8202685">SHA1</span><span class="op" id="8202689">,</span>&nbsp;<span class="ident" id="8202691">digest</span><span class="op" id="8202697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202701">if</span>&nbsp;<span class="ident" id="8202704">err</span>&nbsp;<span class="op" id="8202708">!=</span>&nbsp;<span class="ident" id="8202711">nil</span>&nbsp;<span class="op" id="8202715">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202720">t</span><span class="op" id="8202721">.</span><span class="ident" id="8202722">Errorf</span><span class="op" id="8202728">(</span><span class="string" id="8202729">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8202737">,</span>&nbsp;<span class="ident" id="8202739">i</span><span class="op" id="8202740">,</span>&nbsp;<span class="ident" id="8202742">err</span><span class="op" id="8202745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202754">expected</span><span class="op" id="8202762">,</span>&nbsp;<span class="ident" id="8202764">_</span>&nbsp;<span class="op" id="8202766">:=</span>&nbsp;<span class="ident" id="8202769">hex</span><span class="op" id="8202772">.</span><span class="ident" id="8202773">DecodeString</span><span class="op" id="8202785">(</span><span class="ident" id="8202786">test</span><span class="op" id="8202790">.</span><span class="ident" id="8202791">out</span><span class="op" id="8202794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202798">if</span>&nbsp;<span class="op" id="8202801">!</span><span class="ident" id="8202802">bytes</span><span class="op" id="8202807">.</span><span class="ident" id="8202808">Equal</span><span class="op" id="8202813">(</span><span class="ident" id="8202814">s</span><span class="op" id="8202815">,</span>&nbsp;<span class="ident" id="8202817">expected</span><span class="op" id="8202825">)</span>&nbsp;<span class="op" id="8202827">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202832">t</span><span class="op" id="8202833">.</span><span class="ident" id="8202834">Errorf</span><span class="op" id="8202840">(</span><span class="string" id="8202841">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="8202863">,</span>&nbsp;<span class="ident" id="8202865">i</span><span class="op" id="8202866">,</span>&nbsp;<span class="ident" id="8202868">s</span><span class="op" id="8202869">,</span>&nbsp;<span class="ident" id="8202871">expected</span><span class="op" id="8202879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202886">}</span><br>
<span class="lineno"></span><span class="op" id="8202888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8202891">func</span>&nbsp;<span class="ident" id="8202896">TestVerifyPKCS1v15</span><span class="op" id="8202914">(</span><span class="ident" id="8202915">t</span>&nbsp;<span class="op" id="8202917">*</span><span class="ident" id="8202918">testing</span><span class="op" id="8202925">.</span><span class="ident" id="8202926">T</span><span class="op" id="8202927">)</span>&nbsp;<span class="op" id="8202929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202932">for</span>&nbsp;<span class="ident" id="8202936">i</span><span class="op" id="8202937">,</span>&nbsp;<span class="ident" id="8202939">test</span>&nbsp;<span class="op" id="8202944">:=</span>&nbsp;<span class="keyword" id="8202947">range</span>&nbsp;<span class="ident" id="8202953">signPKCS1v15Tests</span>&nbsp;<span class="op" id="8202971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202975">h</span>&nbsp;<span class="op" id="8202977">:=</span>&nbsp;<span class="ident" id="8202980">sha1</span><span class="op" id="8202984">.</span><span class="ident" id="8202985">New</span><span class="op" id="8202988">(</span><span class="op" id="8202989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202993">h</span><span class="op" id="8202994">.</span><span class="ident" id="8202995">Write</span><span class="op" id="8203000">(</span><span class="op" id="8203001">[</span><span class="op" id="8203002">]</span><span class="builtintype" id="8203003">byte</span><span class="op" id="8203007">(</span><span class="ident" id="8203008">test</span><span class="op" id="8203012">.</span><span class="ident" id="8203013">in</span><span class="op" id="8203015">)</span><span class="op" id="8203016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203020">digest</span>&nbsp;<span class="op" id="8203027">:=</span>&nbsp;<span class="ident" id="8203030">h</span><span class="op" id="8203031">.</span><span class="ident" id="8203032">Sum</span><span class="op" id="8203035">(</span><span class="ident" id="8203036">nil</span><span class="op" id="8203039">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203044">sig</span><span class="op" id="8203047">,</span>&nbsp;<span class="ident" id="8203049">_</span>&nbsp;<span class="op" id="8203051">:=</span>&nbsp;<span class="ident" id="8203054">hex</span><span class="op" id="8203057">.</span><span class="ident" id="8203058">DecodeString</span><span class="op" id="8203070">(</span><span class="ident" id="8203071">test</span><span class="op" id="8203075">.</span><span class="ident" id="8203076">out</span><span class="op" id="8203079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203084">err</span>&nbsp;<span class="op" id="8203088">:=</span>&nbsp;<span class="ident" id="8203091">VerifyPKCS1v15</span><span class="op" id="8203105">(</span><span class="op" id="8203106">&amp;</span><span class="ident" id="8203107">rsaPrivateKey</span><span class="op" id="8203120">.</span><span class="ident" id="8203121">PublicKey</span><span class="op" id="8203130">,</span>&nbsp;<span class="ident" id="8203132">crypto</span><span class="op" id="8203138">.</span><span class="ident" id="8203139">SHA1</span><span class="op" id="8203143">,</span>&nbsp;<span class="ident" id="8203145">digest</span><span class="op" id="8203151">,</span>&nbsp;<span class="ident" id="8203153">sig</span><span class="op" id="8203156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203160">if</span>&nbsp;<span class="ident" id="8203163">err</span>&nbsp;<span class="op" id="8203167">!=</span>&nbsp;<span class="ident" id="8203170">nil</span>&nbsp;<span class="op" id="8203174">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203179">t</span><span class="op" id="8203180">.</span><span class="ident" id="8203181">Errorf</span><span class="op" id="8203187">(</span><span class="string" id="8203188">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="8203196">,</span>&nbsp;<span class="ident" id="8203198">i</span><span class="op" id="8203199">,</span>&nbsp;<span class="ident" id="8203201">err</span><span class="op" id="8203204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203211">}</span><br>
<span class="lineno"></span><span class="op" id="8203213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="8203216">func</span>&nbsp;<span class="ident" id="8203221">TestOverlongMessagePKCS1v15</span><span class="op" id="8203248">(</span><span class="ident" id="8203249">t</span>&nbsp;<span class="op" id="8203251">*</span><span class="ident" id="8203252">testing</span><span class="op" id="8203259">.</span><span class="ident" id="8203260">T</span><span class="op" id="8203261">)</span>&nbsp;<span class="op" id="8203263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203266">ciphertext</span>&nbsp;<span class="op" id="8203277">:=</span>&nbsp;<span class="ident" id="8203280">decodeBase64</span><span class="op" id="8203292">(</span><span class="string" id="8203293">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="8203385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203388">_</span><span class="op" id="8203389">,</span>&nbsp;<span class="ident" id="8203391">err</span>&nbsp;<span class="op" id="8203395">:=</span>&nbsp;<span class="ident" id="8203398">DecryptPKCS1v15</span><span class="op" id="8203413">(</span><span class="ident" id="8203414">nil</span><span class="op" id="8203417">,</span>&nbsp;<span class="ident" id="8203419">rsaPrivateKey</span><span class="op" id="8203432">,</span>&nbsp;<span class="ident" id="8203434">ciphertext</span><span class="op" id="8203444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203447">if</span>&nbsp;<span class="ident" id="8203450">err</span>&nbsp;<span class="op" id="8203454">==</span>&nbsp;<span class="ident" id="8203457">nil</span>&nbsp;<span class="op" id="8203461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203465">t</span><span class="op" id="8203466">.</span><span class="ident" id="8203467">Error</span><span class="op" id="8203472">(</span><span class="string" id="8203473">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="8203517">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203520">}</span><br>
<span class="lineno"></span><span class="op" id="8203522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8203525">func</span>&nbsp;<span class="ident" id="8203530">TestUnpaddedSignature</span><span class="op" id="8203551">(</span><span class="ident" id="8203552">t</span>&nbsp;<span class="op" id="8203554">*</span><span class="ident" id="8203555">testing</span><span class="op" id="8203562">.</span><span class="ident" id="8203563">T</span><span class="op" id="8203564">)</span>&nbsp;<span class="op" id="8203566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203569">msg</span>&nbsp;<span class="op" id="8203573">:=</span>&nbsp;<span class="op" id="8203576">[</span><span class="op" id="8203577">]</span><span class="builtintype" id="8203578">byte</span><span class="op" id="8203582">(</span><span class="string" id="8203583">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="8203615">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203618">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203660">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203711">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203776">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203780">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8203853">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203863">expectedSig</span>&nbsp;<span class="op" id="8203875">:=</span>&nbsp;<span class="ident" id="8203878">decodeBase64</span><span class="op" id="8203890">(</span><span class="string" id="8203891">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="8203981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203985">sig</span><span class="op" id="8203988">,</span>&nbsp;<span class="ident" id="8203990">err</span>&nbsp;<span class="op" id="8203994">:=</span>&nbsp;<span class="ident" id="8203997">SignPKCS1v15</span><span class="op" id="8204009">(</span><span class="ident" id="8204010">nil</span><span class="op" id="8204013">,</span>&nbsp;<span class="ident" id="8204015">rsaPrivateKey</span><span class="op" id="8204028">,</span>&nbsp;<span class="ident" id="8204030">crypto</span><span class="op" id="8204036">.</span><span class="ident" id="8204037">Hash</span><span class="op" id="8204041">(</span><span class="num" id="8204042">0</span><span class="op" id="8204043">)</span><span class="op" id="8204044">,</span>&nbsp;<span class="ident" id="8204046">msg</span><span class="op" id="8204049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204052">if</span>&nbsp;<span class="ident" id="8204055">err</span>&nbsp;<span class="op" id="8204059">!=</span>&nbsp;<span class="ident" id="8204062">nil</span>&nbsp;<span class="op" id="8204066">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204070">t</span><span class="op" id="8204071">.</span><span class="ident" id="8204072">Fatalf</span><span class="op" id="8204078">(</span><span class="string" id="8204079">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8204104">,</span>&nbsp;<span class="ident" id="8204106">err</span><span class="op" id="8204109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204115">if</span>&nbsp;<span class="op" id="8204118">!</span><span class="ident" id="8204119">bytes</span><span class="op" id="8204124">.</span><span class="ident" id="8204125">Equal</span><span class="op" id="8204130">(</span><span class="ident" id="8204131">sig</span><span class="op" id="8204134">,</span>&nbsp;<span class="ident" id="8204136">expectedSig</span><span class="op" id="8204147">)</span>&nbsp;<span class="op" id="8204149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204153">t</span><span class="op" id="8204154">.</span><span class="ident" id="8204155">Fatalf</span><span class="op" id="8204161">(</span><span class="string" id="8204162">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8204212">,</span>&nbsp;<span class="ident" id="8204214">sig</span><span class="op" id="8204217">,</span>&nbsp;<span class="ident" id="8204219">expectedSig</span><span class="op" id="8204230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204233">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204236">if</span>&nbsp;<span class="ident" id="8204239">err</span>&nbsp;<span class="op" id="8204243">:=</span>&nbsp;<span class="ident" id="8204246">VerifyPKCS1v15</span><span class="op" id="8204260">(</span><span class="op" id="8204261">&amp;</span><span class="ident" id="8204262">rsaPrivateKey</span><span class="op" id="8204275">.</span><span class="ident" id="8204276">PublicKey</span><span class="op" id="8204285">,</span>&nbsp;<span class="ident" id="8204287">crypto</span><span class="op" id="8204293">.</span><span class="ident" id="8204294">Hash</span><span class="op" id="8204298">(</span><span class="num" id="8204299">0</span><span class="op" id="8204300">)</span><span class="op" id="8204301">,</span>&nbsp;<span class="ident" id="8204303">msg</span><span class="op" id="8204306">,</span>&nbsp;<span class="ident" id="8204308">sig</span><span class="op" id="8204311">)</span><span class="op" id="8204312">;</span>&nbsp;<span class="ident" id="8204314">err</span>&nbsp;<span class="op" id="8204318">!=</span>&nbsp;<span class="ident" id="8204321">nil</span>&nbsp;<span class="op" id="8204325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204329">t</span><span class="op" id="8204330">.</span><span class="ident" id="8204331">Fatalf</span><span class="op" id="8204337">(</span><span class="string" id="8204338">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="8204370">,</span>&nbsp;<span class="ident" id="8204372">err</span><span class="op" id="8204375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204378">}</span><br>
<span class="lineno"></span><span class="op" id="8204380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8204383">func</span>&nbsp;<span class="ident" id="8204388">TestShortSessionKey</span><span class="op" id="8204407">(</span><span class="ident" id="8204408">t</span>&nbsp;<span class="op" id="8204410">*</span><span class="ident" id="8204411">testing</span><span class="op" id="8204418">.</span><span class="ident" id="8204419">T</span><span class="op" id="8204420">)</span>&nbsp;<span class="op" id="8204422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8204425">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8204491">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204557">ciphertext</span><span class="op" id="8204567">,</span>&nbsp;<span class="ident" id="8204569">err</span>&nbsp;<span class="op" id="8204573">:=</span>&nbsp;<span class="ident" id="8204576">EncryptPKCS1v15</span><span class="op" id="8204591">(</span><span class="ident" id="8204592">rand</span><span class="op" id="8204596">.</span><span class="ident" id="8204597">Reader</span><span class="op" id="8204603">,</span>&nbsp;<span class="op" id="8204605">&amp;</span><span class="ident" id="8204606">rsaPrivateKey</span><span class="op" id="8204619">.</span><span class="ident" id="8204620">PublicKey</span><span class="op" id="8204629">,</span>&nbsp;<span class="op" id="8204631">[</span><span class="op" id="8204632">]</span><span class="builtintype" id="8204633">byte</span><span class="op" id="8204637">{</span><span class="num" id="8204638">1</span><span class="op" id="8204639">}</span><span class="op" id="8204640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204643">if</span>&nbsp;<span class="ident" id="8204646">err</span>&nbsp;<span class="op" id="8204650">!=</span>&nbsp;<span class="ident" id="8204653">nil</span>&nbsp;<span class="op" id="8204657">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204661">t</span><span class="op" id="8204662">.</span><span class="ident" id="8204663">Fatalf</span><span class="op" id="8204669">(</span><span class="string" id="8204670">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8204707">,</span>&nbsp;<span class="ident" id="8204709">err</span><span class="op" id="8204712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204719">var</span>&nbsp;<span class="ident" id="8204723">key</span>&nbsp;<span class="op" id="8204727">[</span><span class="num" id="8204728">32</span><span class="op" id="8204730">]</span><span class="builtintype" id="8204731">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204737">if</span>&nbsp;<span class="ident" id="8204740">err</span>&nbsp;<span class="op" id="8204744">:=</span>&nbsp;<span class="ident" id="8204747">DecryptPKCS1v15SessionKey</span><span class="op" id="8204772">(</span><span class="ident" id="8204773">nil</span><span class="op" id="8204776">,</span>&nbsp;<span class="ident" id="8204778">rsaPrivateKey</span><span class="op" id="8204791">,</span>&nbsp;<span class="ident" id="8204793">ciphertext</span><span class="op" id="8204803">,</span>&nbsp;<span class="ident" id="8204805">key</span><span class="op" id="8204808">[</span><span class="op" id="8204809">:</span><span class="op" id="8204810">]</span><span class="op" id="8204811">)</span><span class="op" id="8204812">;</span>&nbsp;<span class="ident" id="8204814">err</span>&nbsp;<span class="op" id="8204818">!=</span>&nbsp;<span class="ident" id="8204821">nil</span>&nbsp;<span class="op" id="8204825">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204829">t</span><span class="op" id="8204830">.</span><span class="ident" id="8204831">Fatalf</span><span class="op" id="8204837">(</span><span class="string" id="8204838">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="8204875">,</span>&nbsp;<span class="ident" id="8204877">err</span><span class="op" id="8204880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204887">for</span>&nbsp;<span class="ident" id="8204891">_</span><span class="op" id="8204892">,</span>&nbsp;<span class="ident" id="8204894">v</span>&nbsp;<span class="op" id="8204896">:=</span>&nbsp;<span class="keyword" id="8204899">range</span>&nbsp;<span class="ident" id="8204905">key</span>&nbsp;<span class="op" id="8204909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204913">if</span>&nbsp;<span class="ident" id="8204916">v</span>&nbsp;<span class="op" id="8204918">!=</span>&nbsp;<span class="num" id="8204921">0</span>&nbsp;<span class="op" id="8204923">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204928">t</span><span class="op" id="8204929">.</span><span class="ident" id="8204930">Fatal</span><span class="op" id="8204935">(</span><span class="string" id="8204936">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="8204982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204989">}</span><br>
<span class="lineno"></span><span class="op" id="8204991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="8204994">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="8205073">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="8205108">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="8205176">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="8205244">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="8205312">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="8205380">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="8205448">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="8205516">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="8205560">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8205594">var</span>&nbsp;<span class="ident" id="8205598">rsaPrivateKey</span>&nbsp;<span class="op" id="8205612">=</span>&nbsp;<span class="op" id="8205614">&amp;</span><span class="ident" id="8205615">PrivateKey</span><span class="op" id="8205625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205628">PublicKey</span><span class="op" id="8205637">:</span>&nbsp;<span class="ident" id="8205639">PublicKey</span><span class="op" id="8205648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205652">N</span><span class="op" id="8205653">:</span>&nbsp;<span class="ident" id="8205655">fromBase10</span><span class="op" id="8205665">(</span><span class="string" id="8205666">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8205822">)</span><span class="op" id="8205823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205827">E</span><span class="op" id="8205828">:</span>&nbsp;<span class="num" id="8205830">65537</span><span class="op" id="8205835">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205838">}</span><span class="op" id="8205839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205842">D</span><span class="op" id="8205843">:</span>&nbsp;<span class="ident" id="8205845">fromBase10</span><span class="op" id="8205855">(</span><span class="string" id="8205856">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8206012">)</span><span class="op" id="8206013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206016">Primes</span><span class="op" id="8206022">:</span>&nbsp;<span class="op" id="8206024">[</span><span class="op" id="8206025">]</span><span class="op" id="8206026">*</span><span class="ident" id="8206027">big</span><span class="op" id="8206030">.</span><span class="ident" id="8206031">Int</span><span class="op" id="8206034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206038">fromBase10</span><span class="op" id="8206048">(</span><span class="string" id="8206049">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8206128">)</span><span class="op" id="8206129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206133">fromBase10</span><span class="op" id="8206143">(</span><span class="string" id="8206144">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8206223">)</span><span class="op" id="8206224">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206227">}</span><span class="op" id="8206228">,</span><br>
<span class="lineno"></span><span class="op" id="8206230">}</span>
</div>
</body>
</html>
