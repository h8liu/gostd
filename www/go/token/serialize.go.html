<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5946609">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5946664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5946718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5946769">package</span>&nbsp;<span class="ident" id="5946777">token</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5946784">type</span>&nbsp;<span class="ident" id="5946789">serializedFile</span>&nbsp;<span class="keyword" id="5946804">struct</span>&nbsp;<span class="op" id="5946811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5946814">//&nbsp;fields&nbsp;correspond&nbsp;1:1&nbsp;to&nbsp;fields&nbsp;with&nbsp;same&nbsp;(lower-case)&nbsp;name&nbsp;in&nbsp;File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946886">Name</span>&nbsp;&nbsp;<span class="builtintype" id="5946892">string</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946900">Base</span>&nbsp;&nbsp;<span class="builtintype" id="5946906">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946911">Size</span>&nbsp;&nbsp;<span class="builtintype" id="5946917">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946922">Lines</span>&nbsp;<span class="op" id="5946928">[</span><span class="op" id="5946929">]</span><span class="builtintype" id="5946930">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946935">Infos</span>&nbsp;<span class="op" id="5946941">[</span><span class="op" id="5946942">]</span><span class="ident" id="5946943"><a href="/go/token/position.go.html#5938606">lineInfo</a></span><br>
<span class="lineno"></span><span class="op" id="5946952">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="5946955">type</span>&nbsp;<span class="ident" id="5946960">serializedFileSet</span>&nbsp;<span class="keyword" id="5946978">struct</span>&nbsp;<span class="op" id="5946985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946988">Base</span>&nbsp;&nbsp;<span class="builtintype" id="5946994">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5946999">Files</span>&nbsp;<span class="op" id="5947005">[</span><span class="op" id="5947006">]</span><span class="ident" id="5947007"><a href="/go/token/serialize.go.html#5946789">serializedFile</a></span><br>
<span class="lineno"></span><span class="op" id="5947022">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5947025">//&nbsp;Read&nbsp;calls&nbsp;decode&nbsp;to&nbsp;deserialize&nbsp;a&nbsp;file&nbsp;set&nbsp;into&nbsp;s;&nbsp;s&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5947099">func</span>&nbsp;<span class="op" id="5947104">(</span><span class="ident" id="5947105">s</span>&nbsp;<span class="op" id="5947107">*</span><span class="ident" id="5947108"><a href="/go/token/position.go.html#5942060">FileSet</a></span><span class="op" id="5947115">)</span>&nbsp;<span class="ident" id="5947117">Read</span><span class="op" id="5947121">(</span><span class="ident" id="5947122">decode</span>&nbsp;<span class="keyword" id="5947129">func</span><span class="op" id="5947133">(</span><span class="keyword" id="5947134">interface</span><span class="op" id="5947143">{</span><span class="op" id="5947144">}</span><span class="op" id="5947145">)</span>&nbsp;<span class="builtintype" id="5947147">error</span><span class="op" id="5947152">)</span>&nbsp;<span class="builtintype" id="5947154">error</span>&nbsp;<span class="op" id="5947160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947163">var</span>&nbsp;<span class="ident" id="5947167">ss</span>&nbsp;<span class="ident" id="5947170"><a href="/go/token/serialize.go.html#5946960">serializedFileSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947189">if</span>&nbsp;<span class="ident" id="5947192">err</span>&nbsp;<span class="op" id="5947196">:=</span>&nbsp;<span class="ident" id="5947199"><a href="/go/token/serialize.go.html#5947122">decode</a></span><span class="op" id="5947205">(</span><span class="op" id="5947206">&amp;</span><span class="ident" id="5947207"><a href="/go/token/serialize.go.html#5947167">ss</a></span><span class="op" id="5947209">)</span><span class="op" id="5947210">;</span>&nbsp;<span class="ident" id="5947212"><a href="/go/token/serialize.go.html#5947192">err</a></span>&nbsp;<span class="op" id="5947216">!=</span>&nbsp;<span class="ident" id="5947219">nil</span>&nbsp;<span class="op" id="5947223">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947227">return</span>&nbsp;<span class="ident" id="5947234"><a href="/go/token/serialize.go.html#5947192">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5947239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947243"><a href="/go/token/serialize.go.html#5947105">s</a></span><span class="op" id="5947244">.</span><span class="ident" id="5947245">mutex</span><span class="op" id="5947250">.</span><span class="ident" id="5947251">Lock</span><span class="op" id="5947255">(</span><span class="op" id="5947256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947259"><a href="/go/token/serialize.go.html#5947105">s</a></span><span class="op" id="5947260">.</span><span class="ident" id="5947261">base</span>&nbsp;<span class="op" id="5947266">=</span>&nbsp;<span class="ident" id="5947268"><a href="/go/token/serialize.go.html#5947167">ss</a></span><span class="op" id="5947270">.</span><span class="ident" id="5947271">Base</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947277">files</span>&nbsp;<span class="op" id="5947283">:=</span>&nbsp;<span class="builtinfunc" id="5947286">make</span><span class="op" id="5947290">(</span><span class="op" id="5947291">[</span><span class="op" id="5947292">]</span><span class="op" id="5947293">*</span><span class="ident" id="5947294"><a href="/go/token/position.go.html#5935090">File</a></span><span class="op" id="5947298">,</span>&nbsp;<span class="builtinfunc" id="5947300">len</span><span class="op" id="5947303">(</span><span class="ident" id="5947304"><a href="/go/token/serialize.go.html#5947167">ss</a></span><span class="op" id="5947306">.</span><span class="ident" id="5947307">Files</span><span class="op" id="5947312">)</span><span class="op" id="5947313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947316">for</span>&nbsp;<span class="ident" id="5947320">i</span>&nbsp;<span class="op" id="5947322">:=</span>&nbsp;<span class="num" id="5947325">0</span><span class="op" id="5947326">;</span>&nbsp;<span class="ident" id="5947328"><a href="/go/token/serialize.go.html#5947320">i</a></span>&nbsp;<span class="op" id="5947330">&lt;</span>&nbsp;<span class="builtinfunc" id="5947332">len</span><span class="op" id="5947335">(</span><span class="ident" id="5947336"><a href="/go/token/serialize.go.html#5947167">ss</a></span><span class="op" id="5947338">.</span><span class="ident" id="5947339">Files</span><span class="op" id="5947344">)</span><span class="op" id="5947345">;</span>&nbsp;<span class="ident" id="5947347"><a href="/go/token/serialize.go.html#5947320">i</a></span><span class="op" id="5947348">++</span>&nbsp;<span class="op" id="5947351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947355">f</span>&nbsp;<span class="op" id="5947357">:=</span>&nbsp;<span class="op" id="5947360">&amp;</span><span class="ident" id="5947361"><a href="/go/token/serialize.go.html#5947167">ss</a></span><span class="op" id="5947363">.</span><span class="ident" id="5947364">Files</span><span class="op" id="5947369">[</span><span class="ident" id="5947370"><a href="/go/token/serialize.go.html#5947320">i</a></span><span class="op" id="5947371">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947375"><a href="/go/token/serialize.go.html#5947277">files</a></span><span class="op" id="5947380">[</span><span class="ident" id="5947381"><a href="/go/token/serialize.go.html#5947320">i</a></span><span class="op" id="5947382">]</span>&nbsp;<span class="op" id="5947384">=</span>&nbsp;<span class="op" id="5947386">&amp;</span><span class="ident" id="5947387"><a href="/go/token/position.go.html#5935090">File</a></span><span class="op" id="5947391">{</span><span class="ident" id="5947392"><a href="/go/token/serialize.go.html#5947105">s</a></span><span class="op" id="5947393">,</span>&nbsp;<span class="ident" id="5947395"><a href="/go/token/serialize.go.html#5947355">f</a></span><span class="op" id="5947396">.</span><span class="ident" id="5947397">Name</span><span class="op" id="5947401">,</span>&nbsp;<span class="ident" id="5947403"><a href="/go/token/serialize.go.html#5947355">f</a></span><span class="op" id="5947404">.</span><span class="ident" id="5947405">Base</span><span class="op" id="5947409">,</span>&nbsp;<span class="ident" id="5947411"><a href="/go/token/serialize.go.html#5947355">f</a></span><span class="op" id="5947412">.</span><span class="ident" id="5947413">Size</span><span class="op" id="5947417">,</span>&nbsp;<span class="ident" id="5947419"><a href="/go/token/serialize.go.html#5947355">f</a></span><span class="op" id="5947420">.</span><span class="ident" id="5947421">Lines</span><span class="op" id="5947426">,</span>&nbsp;<span class="ident" id="5947428"><a href="/go/token/serialize.go.html#5947355">f</a></span><span class="op" id="5947429">.</span><span class="ident" id="5947430">Infos</span><span class="op" id="5947435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5947438">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947441"><a href="/go/token/serialize.go.html#5947105">s</a></span><span class="op" id="5947442">.</span><span class="ident" id="5947443">files</span>&nbsp;<span class="op" id="5947449">=</span>&nbsp;<span class="ident" id="5947451"><a href="/go/token/serialize.go.html#5947277">files</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947458"><a href="/go/token/serialize.go.html#5947105">s</a></span><span class="op" id="5947459">.</span><span class="ident" id="5947460">last</span>&nbsp;<span class="op" id="5947465">=</span>&nbsp;<span class="ident" id="5947467">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947472"><a href="/go/token/serialize.go.html#5947105">s</a></span><span class="op" id="5947473">.</span><span class="ident" id="5947474">mutex</span><span class="op" id="5947479">.</span><span class="ident" id="5947480">Unlock</span><span class="op" id="5947486">(</span><span class="op" id="5947487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947491">return</span>&nbsp;<span class="ident" id="5947498">nil</span><br>
<span class="lineno">40</span><span class="op" id="5947502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5947505">//&nbsp;Write&nbsp;calls&nbsp;encode&nbsp;to&nbsp;serialize&nbsp;the&nbsp;file&nbsp;set&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5947556">func</span>&nbsp;<span class="op" id="5947561">(</span><span class="ident" id="5947562">s</span>&nbsp;<span class="op" id="5947564">*</span><span class="ident" id="5947565"><a href="/go/token/position.go.html#5942060">FileSet</a></span><span class="op" id="5947572">)</span>&nbsp;<span class="ident" id="5947574">Write</span><span class="op" id="5947579">(</span><span class="ident" id="5947580">encode</span>&nbsp;<span class="keyword" id="5947587">func</span><span class="op" id="5947591">(</span><span class="keyword" id="5947592">interface</span><span class="op" id="5947601">{</span><span class="op" id="5947602">}</span><span class="op" id="5947603">)</span>&nbsp;<span class="builtintype" id="5947605">error</span><span class="op" id="5947610">)</span>&nbsp;<span class="builtintype" id="5947612">error</span>&nbsp;<span class="op" id="5947618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947621">var</span>&nbsp;<span class="ident" id="5947625">ss</span>&nbsp;<span class="ident" id="5947628"><a href="/go/token/serialize.go.html#5946960">serializedFileSet</a></span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947648"><a href="/go/token/serialize.go.html#5947562">s</a></span><span class="op" id="5947649">.</span><span class="ident" id="5947650">mutex</span><span class="op" id="5947655">.</span><span class="ident" id="5947656">Lock</span><span class="op" id="5947660">(</span><span class="op" id="5947661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947664"><a href="/go/token/serialize.go.html#5947625">ss</a></span><span class="op" id="5947666">.</span><span class="ident" id="5947667">Base</span>&nbsp;<span class="op" id="5947672">=</span>&nbsp;<span class="ident" id="5947674"><a href="/go/token/serialize.go.html#5947562">s</a></span><span class="op" id="5947675">.</span><span class="ident" id="5947676">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947682">files</span>&nbsp;<span class="op" id="5947688">:=</span>&nbsp;<span class="builtinfunc" id="5947691">make</span><span class="op" id="5947695">(</span><span class="op" id="5947696">[</span><span class="op" id="5947697">]</span><span class="ident" id="5947698"><a href="/go/token/serialize.go.html#5946789">serializedFile</a></span><span class="op" id="5947712">,</span>&nbsp;<span class="builtinfunc" id="5947714">len</span><span class="op" id="5947717">(</span><span class="ident" id="5947718"><a href="/go/token/serialize.go.html#5947562">s</a></span><span class="op" id="5947719">.</span><span class="ident" id="5947720">files</span><span class="op" id="5947725">)</span><span class="op" id="5947726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947729">for</span>&nbsp;<span class="ident" id="5947733">i</span><span class="op" id="5947734">,</span>&nbsp;<span class="ident" id="5947736">f</span>&nbsp;<span class="op" id="5947738">:=</span>&nbsp;<span class="keyword" id="5947741">range</span>&nbsp;<span class="ident" id="5947747"><a href="/go/token/serialize.go.html#5947562">s</a></span><span class="op" id="5947748">.</span><span class="ident" id="5947749">files</span>&nbsp;<span class="op" id="5947755">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947759"><a href="/go/token/serialize.go.html#5947682">files</a></span><span class="op" id="5947764">[</span><span class="ident" id="5947765"><a href="/go/token/serialize.go.html#5947733">i</a></span><span class="op" id="5947766">]</span>&nbsp;<span class="op" id="5947768">=</span>&nbsp;<span class="ident" id="5947770"><a href="/go/token/serialize.go.html#5946789">serializedFile</a></span><span class="op" id="5947784">{</span><span class="ident" id="5947785"><a href="/go/token/serialize.go.html#5947736">f</a></span><span class="op" id="5947786">.</span><span class="ident" id="5947787">name</span><span class="op" id="5947791">,</span>&nbsp;<span class="ident" id="5947793"><a href="/go/token/serialize.go.html#5947736">f</a></span><span class="op" id="5947794">.</span><span class="ident" id="5947795">base</span><span class="op" id="5947799">,</span>&nbsp;<span class="ident" id="5947801"><a href="/go/token/serialize.go.html#5947736">f</a></span><span class="op" id="5947802">.</span><span class="ident" id="5947803">size</span><span class="op" id="5947807">,</span>&nbsp;<span class="ident" id="5947809"><a href="/go/token/serialize.go.html#5947736">f</a></span><span class="op" id="5947810">.</span><span class="ident" id="5947811">lines</span><span class="op" id="5947816">,</span>&nbsp;<span class="ident" id="5947818"><a href="/go/token/serialize.go.html#5947736">f</a></span><span class="op" id="5947819">.</span><span class="ident" id="5947820">infos</span><span class="op" id="5947825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5947828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947831"><a href="/go/token/serialize.go.html#5947625">ss</a></span><span class="op" id="5947833">.</span><span class="ident" id="5947834">Files</span>&nbsp;<span class="op" id="5947840">=</span>&nbsp;<span class="ident" id="5947842"><a href="/go/token/serialize.go.html#5947682">files</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5947849"><a href="/go/token/serialize.go.html#5947562">s</a></span><span class="op" id="5947850">.</span><span class="ident" id="5947851">mutex</span><span class="op" id="5947856">.</span><span class="ident" id="5947857">Unlock</span><span class="op" id="5947863">(</span><span class="op" id="5947864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5947868">return</span>&nbsp;<span class="ident" id="5947875"><a href="/go/token/serialize.go.html#5947580">encode</a></span><span class="op" id="5947881">(</span><span class="ident" id="5947882"><a href="/go/token/serialize.go.html#5947625">ss</a></span><span class="op" id="5947884">)</span><br>
<span class="lineno"></span><span class="op" id="5947886">}</span>
</div>
</body>
</html>
