<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3887665">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3887720">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3887774">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3887825">package</span>&nbsp;<span class="ident" id="3887833">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3887838">import</span>&nbsp;<span class="op" id="3887845">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3887848">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3887865">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3887875">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3887878">//&nbsp;The&nbsp;AES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3887910">const</span>&nbsp;<span class="ident" id="3887916">BlockSize</span>&nbsp;<span class="op" id="3887926">=</span>&nbsp;<span class="num" id="3887928">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3887932">//&nbsp;A&nbsp;cipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;AES&nbsp;encryption&nbsp;using&nbsp;a&nbsp;particular&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3888001">type</span>&nbsp;<span class="ident" id="3888006">aesCipher</span>&nbsp;<span class="keyword" id="3888016">struct</span>&nbsp;<span class="op" id="3888023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888026">enc</span>&nbsp;<span class="op" id="3888030">[</span><span class="op" id="3888031">]</span><span class="builtintype" id="3888032">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888040">dec</span>&nbsp;<span class="op" id="3888044">[</span><span class="op" id="3888045">]</span><span class="builtintype" id="3888046">uint32</span><br>
<span class="lineno"></span><span class="op" id="3888053">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3888056">type</span>&nbsp;<span class="ident" id="3888061">KeySizeError</span>&nbsp;<span class="builtintype" id="3888074">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3888079">func</span>&nbsp;<span class="op" id="3888084">(</span><span class="ident" id="3888085">k</span>&nbsp;<span class="ident" id="3888087">KeySizeError</span><span class="op" id="3888099">)</span>&nbsp;<span class="ident" id="3888101">Error</span><span class="op" id="3888106">(</span><span class="op" id="3888107">)</span>&nbsp;<span class="builtintype" id="3888109">string</span>&nbsp;<span class="op" id="3888116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888119">return</span>&nbsp;<span class="string" id="3888126">&#34;crypto/aes:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3888158">+</span>&nbsp;<span class="ident" id="3888160">strconv</span><span class="op" id="3888167">.</span><span class="ident" id="3888168">Itoa</span><span class="op" id="3888172">(</span><span class="builtintype" id="3888173">int</span><span class="op" id="3888176">(</span><span class="ident" id="3888177">k</span><span class="op" id="3888178">)</span><span class="op" id="3888179">)</span><br>
<span class="lineno">25</span><span class="op" id="3888181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3888184">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="comment" id="3888237">//&nbsp;The&nbsp;key&nbsp;argument&nbsp;should&nbsp;be&nbsp;the&nbsp;AES&nbsp;key,</span><br>
<span class="lineno"></span><span class="comment" id="3888280">//&nbsp;either&nbsp;16,&nbsp;24,&nbsp;or&nbsp;32&nbsp;bytes&nbsp;to&nbsp;select</span><br>
<span class="lineno">30</span><span class="comment" id="3888320">//&nbsp;AES-128,&nbsp;AES-192,&nbsp;or&nbsp;AES-256.</span><br>
<span class="lineno"></span><span class="keyword" id="3888353">func</span>&nbsp;<span class="ident" id="3888358">NewCipher</span><span class="op" id="3888367">(</span><span class="ident" id="3888368">key</span>&nbsp;<span class="op" id="3888372">[</span><span class="op" id="3888373">]</span><span class="builtintype" id="3888374">byte</span><span class="op" id="3888378">)</span>&nbsp;<span class="op" id="3888380">(</span><span class="ident" id="3888381">cipher</span><span class="op" id="3888387">.</span><span class="ident" id="3888388">Block</span><span class="op" id="3888393">,</span>&nbsp;<span class="builtintype" id="3888395">error</span><span class="op" id="3888400">)</span>&nbsp;<span class="op" id="3888402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888405">k</span>&nbsp;<span class="op" id="3888407">:=</span>&nbsp;<span class="builtinfunc" id="3888410">len</span><span class="op" id="3888413">(</span><span class="ident" id="3888414">key</span><span class="op" id="3888417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888420">switch</span>&nbsp;<span class="ident" id="3888427">k</span>&nbsp;<span class="op" id="3888429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888432">default</span><span class="op" id="3888439">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888443">return</span>&nbsp;<span class="ident" id="3888450">nil</span><span class="op" id="3888453">,</span>&nbsp;<span class="ident" id="3888455">KeySizeError</span><span class="op" id="3888467">(</span><span class="ident" id="3888468">k</span><span class="op" id="3888469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888472">case</span>&nbsp;<span class="num" id="3888477">16</span><span class="op" id="3888479">,</span>&nbsp;<span class="num" id="3888481">24</span><span class="op" id="3888483">,</span>&nbsp;<span class="num" id="3888485">32</span><span class="op" id="3888487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888491">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888502">n</span>&nbsp;<span class="op" id="3888504">:=</span>&nbsp;<span class="ident" id="3888507">k</span>&nbsp;<span class="op" id="3888509">+</span>&nbsp;<span class="num" id="3888511">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888515">c</span>&nbsp;<span class="op" id="3888517">:=</span>&nbsp;<span class="op" id="3888520">&amp;</span><span class="ident" id="3888521">aesCipher</span><span class="op" id="3888530">{</span><span class="builtinfunc" id="3888531">make</span><span class="op" id="3888535">(</span><span class="op" id="3888536">[</span><span class="op" id="3888537">]</span><span class="builtintype" id="3888538">uint32</span><span class="op" id="3888544">,</span>&nbsp;<span class="ident" id="3888546">n</span><span class="op" id="3888547">)</span><span class="op" id="3888548">,</span>&nbsp;<span class="builtinfunc" id="3888550">make</span><span class="op" id="3888554">(</span><span class="op" id="3888555">[</span><span class="op" id="3888556">]</span><span class="builtintype" id="3888557">uint32</span><span class="op" id="3888563">,</span>&nbsp;<span class="ident" id="3888565">n</span><span class="op" id="3888566">)</span><span class="op" id="3888567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888570">expandKey</span><span class="op" id="3888579">(</span><span class="ident" id="3888580">key</span><span class="op" id="3888583">,</span>&nbsp;<span class="ident" id="3888585">c</span><span class="op" id="3888586">.</span><span class="ident" id="3888587">enc</span><span class="op" id="3888590">,</span>&nbsp;<span class="ident" id="3888592">c</span><span class="op" id="3888593">.</span><span class="ident" id="3888594">dec</span><span class="op" id="3888597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888600">return</span>&nbsp;<span class="ident" id="3888607">c</span><span class="op" id="3888608">,</span>&nbsp;<span class="ident" id="3888610">nil</span><br>
<span class="lineno"></span><span class="op" id="3888614">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3888617">func</span>&nbsp;<span class="op" id="3888622">(</span><span class="ident" id="3888623">c</span>&nbsp;<span class="op" id="3888625">*</span><span class="ident" id="3888626">aesCipher</span><span class="op" id="3888635">)</span>&nbsp;<span class="ident" id="3888637">BlockSize</span><span class="op" id="3888646">(</span><span class="op" id="3888647">)</span>&nbsp;<span class="builtintype" id="3888649">int</span>&nbsp;<span class="op" id="3888653">{</span>&nbsp;<span class="keyword" id="3888655">return</span>&nbsp;<span class="ident" id="3888662">BlockSize</span>&nbsp;<span class="op" id="3888672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3888675">func</span>&nbsp;<span class="op" id="3888680">(</span><span class="ident" id="3888681">c</span>&nbsp;<span class="op" id="3888683">*</span><span class="ident" id="3888684">aesCipher</span><span class="op" id="3888693">)</span>&nbsp;<span class="ident" id="3888695">Encrypt</span><span class="op" id="3888702">(</span><span class="ident" id="3888703">dst</span><span class="op" id="3888706">,</span>&nbsp;<span class="ident" id="3888708">src</span>&nbsp;<span class="op" id="3888712">[</span><span class="op" id="3888713">]</span><span class="builtintype" id="3888714">byte</span><span class="op" id="3888718">)</span>&nbsp;<span class="op" id="3888720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888723">if</span>&nbsp;<span class="builtinfunc" id="3888726">len</span><span class="op" id="3888729">(</span><span class="ident" id="3888730">src</span><span class="op" id="3888733">)</span>&nbsp;<span class="op" id="3888735">&lt;</span>&nbsp;<span class="ident" id="3888737">BlockSize</span>&nbsp;<span class="op" id="3888747">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3888751">panic</span><span class="op" id="3888756">(</span><span class="string" id="3888757">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3888791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888797">if</span>&nbsp;<span class="builtinfunc" id="3888800">len</span><span class="op" id="3888803">(</span><span class="ident" id="3888804">dst</span><span class="op" id="3888807">)</span>&nbsp;<span class="op" id="3888809">&lt;</span>&nbsp;<span class="ident" id="3888811">BlockSize</span>&nbsp;<span class="op" id="3888821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3888825">panic</span><span class="op" id="3888830">(</span><span class="string" id="3888831">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3888866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888869">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888872">encryptBlock</span><span class="op" id="3888884">(</span><span class="ident" id="3888885">c</span><span class="op" id="3888886">.</span><span class="ident" id="3888887">enc</span><span class="op" id="3888890">,</span>&nbsp;<span class="ident" id="3888892">dst</span><span class="op" id="3888895">,</span>&nbsp;<span class="ident" id="3888897">src</span><span class="op" id="3888900">)</span><br>
<span class="lineno"></span><span class="op" id="3888902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3888905">func</span>&nbsp;<span class="op" id="3888910">(</span><span class="ident" id="3888911">c</span>&nbsp;<span class="op" id="3888913">*</span><span class="ident" id="3888914">aesCipher</span><span class="op" id="3888923">)</span>&nbsp;<span class="ident" id="3888925">Decrypt</span><span class="op" id="3888932">(</span><span class="ident" id="3888933">dst</span><span class="op" id="3888936">,</span>&nbsp;<span class="ident" id="3888938">src</span>&nbsp;<span class="op" id="3888942">[</span><span class="op" id="3888943">]</span><span class="builtintype" id="3888944">byte</span><span class="op" id="3888948">)</span>&nbsp;<span class="op" id="3888950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888953">if</span>&nbsp;<span class="builtinfunc" id="3888956">len</span><span class="op" id="3888959">(</span><span class="ident" id="3888960">src</span><span class="op" id="3888963">)</span>&nbsp;<span class="op" id="3888965">&lt;</span>&nbsp;<span class="ident" id="3888967">BlockSize</span>&nbsp;<span class="op" id="3888977">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3888981">panic</span><span class="op" id="3888986">(</span><span class="string" id="3888987">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3889021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889027">if</span>&nbsp;<span class="builtinfunc" id="3889030">len</span><span class="op" id="3889033">(</span><span class="ident" id="3889034">dst</span><span class="op" id="3889037">)</span>&nbsp;<span class="op" id="3889039">&lt;</span>&nbsp;<span class="ident" id="3889041">BlockSize</span>&nbsp;<span class="op" id="3889051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3889055">panic</span><span class="op" id="3889060">(</span><span class="string" id="3889061">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3889096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889099">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889102">decryptBlock</span><span class="op" id="3889114">(</span><span class="ident" id="3889115">c</span><span class="op" id="3889116">.</span><span class="ident" id="3889117">dec</span><span class="op" id="3889120">,</span>&nbsp;<span class="ident" id="3889122">dst</span><span class="op" id="3889125">,</span>&nbsp;<span class="ident" id="3889127">src</span><span class="op" id="3889130">)</span><br>
<span class="lineno"></span><span class="op" id="3889132">}</span>
</div>
</body>
</html>
