<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7964415">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7964470">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7964524">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7964575">package</span>&nbsp;<span class="ident" id="7964583">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7964588">import</span>&nbsp;<span class="op" id="7964595">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964598">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964613">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964620">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964626">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964637">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="7964646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7964649">type</span>&nbsp;<span class="ident" id="7964654">md5Test</span>&nbsp;<span class="keyword" id="7964662">struct</span>&nbsp;<span class="op" id="7964669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7964672">out</span>&nbsp;<span class="builtintype" id="7964676">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7964684">in</span>&nbsp;&nbsp;<span class="builtintype" id="7964688">string</span><br>
<span class="lineno"></span><span class="op" id="7964695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7964698">var</span>&nbsp;<span class="ident" id="7964702">golden</span>&nbsp;<span class="op" id="7964709">=</span>&nbsp;<span class="op" id="7964711">[</span><span class="op" id="7964712">]</span><span class="ident" id="7964713">md5Test</span><span class="op" id="7964720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964723">{</span><span class="string" id="7964724">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="7964758">,</span>&nbsp;<span class="string" id="7964760">&#34;&#34;</span><span class="op" id="7964762">}</span><span class="op" id="7964763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964766">{</span><span class="string" id="7964767">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="7964801">,</span>&nbsp;<span class="string" id="7964803">&#34;a&#34;</span><span class="op" id="7964806">}</span><span class="op" id="7964807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964810">{</span><span class="string" id="7964811">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="7964845">,</span>&nbsp;<span class="string" id="7964847">&#34;ab&#34;</span><span class="op" id="7964851">}</span><span class="op" id="7964852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964855">{</span><span class="string" id="7964856">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="7964890">,</span>&nbsp;<span class="string" id="7964892">&#34;abc&#34;</span><span class="op" id="7964897">}</span><span class="op" id="7964898">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964901">{</span><span class="string" id="7964902">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="7964936">,</span>&nbsp;<span class="string" id="7964938">&#34;abcd&#34;</span><span class="op" id="7964944">}</span><span class="op" id="7964945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964948">{</span><span class="string" id="7964949">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="7964983">,</span>&nbsp;<span class="string" id="7964985">&#34;abcde&#34;</span><span class="op" id="7964992">}</span><span class="op" id="7964993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964996">{</span><span class="string" id="7964997">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="7965031">,</span>&nbsp;<span class="string" id="7965033">&#34;abcdef&#34;</span><span class="op" id="7965041">}</span><span class="op" id="7965042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965045">{</span><span class="string" id="7965046">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="7965080">,</span>&nbsp;<span class="string" id="7965082">&#34;abcdefg&#34;</span><span class="op" id="7965091">}</span><span class="op" id="7965092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965095">{</span><span class="string" id="7965096">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="7965130">,</span>&nbsp;<span class="string" id="7965132">&#34;abcdefgh&#34;</span><span class="op" id="7965142">}</span><span class="op" id="7965143">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965146">{</span><span class="string" id="7965147">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="7965181">,</span>&nbsp;<span class="string" id="7965183">&#34;abcdefghi&#34;</span><span class="op" id="7965194">}</span><span class="op" id="7965195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965198">{</span><span class="string" id="7965199">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="7965233">,</span>&nbsp;<span class="string" id="7965235">&#34;abcdefghij&#34;</span><span class="op" id="7965247">}</span><span class="op" id="7965248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965251">{</span><span class="string" id="7965252">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="7965286">,</span>&nbsp;<span class="string" id="7965288">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="7965331">}</span><span class="op" id="7965332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965335">{</span><span class="string" id="7965336">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="7965370">,</span>&nbsp;<span class="string" id="7965372">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="7965431">}</span><span class="op" id="7965432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965435">{</span><span class="string" id="7965436">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="7965470">,</span>&nbsp;<span class="string" id="7965472">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="7965516">}</span><span class="op" id="7965517">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965520">{</span><span class="string" id="7965521">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="7965555">,</span>&nbsp;<span class="string" id="7965557">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="7965616">}</span><span class="op" id="7965617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965620">{</span><span class="string" id="7965621">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="7965655">,</span>&nbsp;<span class="string" id="7965657">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="7965717">}</span><span class="op" id="7965718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965721">{</span><span class="string" id="7965722">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="7965756">,</span>&nbsp;<span class="string" id="7965758">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="7965787">}</span><span class="op" id="7965788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965791">{</span><span class="string" id="7965792">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="7965826">,</span>&nbsp;<span class="string" id="7965828">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="7965897">}</span><span class="op" id="7965898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965901">{</span><span class="string" id="7965902">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="7965936">,</span>&nbsp;<span class="string" id="7965938">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="7965997">}</span><span class="op" id="7965998">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966001">{</span><span class="string" id="7966002">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="7966036">,</span>&nbsp;<span class="string" id="7966038">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="7966128">}</span><span class="op" id="7966129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966132">{</span><span class="string" id="7966133">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="7966167">,</span>&nbsp;<span class="string" id="7966169">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="7966246">}</span><span class="op" id="7966247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966250">{</span><span class="string" id="7966251">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="7966285">,</span>&nbsp;<span class="string" id="7966287">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="7966313">}</span><span class="op" id="7966314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966317">{</span><span class="string" id="7966318">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="7966352">,</span>&nbsp;<span class="string" id="7966354">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="7966405">}</span><span class="op" id="7966406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966409">{</span><span class="string" id="7966410">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="7966444">,</span>&nbsp;<span class="string" id="7966446">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="7966520">}</span><span class="op" id="7966521">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966524">{</span><span class="string" id="7966525">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="7966559">,</span>&nbsp;<span class="string" id="7966561">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="7966609">}</span><span class="op" id="7966610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966613">{</span><span class="string" id="7966614">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="7966648">,</span>&nbsp;<span class="string" id="7966650">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="7966722">}</span><span class="op" id="7966723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966726">{</span><span class="string" id="7966727">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="7966761">,</span>&nbsp;<span class="string" id="7966763">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="7966833">}</span><span class="op" id="7966834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966837">{</span><span class="string" id="7966838">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="7966872">,</span>&nbsp;<span class="string" id="7966874">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="7966908">}</span><span class="op" id="7966909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7966912">{</span><span class="string" id="7966913">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="7966947">,</span>&nbsp;<span class="string" id="7966949">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="7967039">}</span><span class="op" id="7967040">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7967043">{</span><span class="string" id="7967044">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="7967078">,</span>&nbsp;<span class="string" id="7967080">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="7967214">}</span><span class="op" id="7967215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7967218">{</span><span class="string" id="7967219">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="7967253">,</span>&nbsp;<span class="string" id="7967255">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="7967313">}</span><span class="op" id="7967314">,</span><br>
<span class="lineno"></span><span class="op" id="7967316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7967319">func</span>&nbsp;<span class="ident" id="7967324">TestGolden</span><span class="op" id="7967334">(</span><span class="ident" id="7967335">t</span>&nbsp;<span class="op" id="7967337">*</span><span class="ident" id="7967338">testing</span><span class="op" id="7967345">.</span><span class="ident" id="7967346">T</span><span class="op" id="7967347">)</span>&nbsp;<span class="op" id="7967349">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7967352">for</span>&nbsp;<span class="ident" id="7967356">i</span>&nbsp;<span class="op" id="7967358">:=</span>&nbsp;<span class="num" id="7967361">0</span><span class="op" id="7967362">;</span>&nbsp;<span class="ident" id="7967364">i</span>&nbsp;<span class="op" id="7967366">&lt;</span>&nbsp;<span class="builtinfunc" id="7967368">len</span><span class="op" id="7967371">(</span><span class="ident" id="7967372">golden</span><span class="op" id="7967378">)</span><span class="op" id="7967379">;</span>&nbsp;<span class="ident" id="7967381">i</span><span class="op" id="7967382">++</span>&nbsp;<span class="op" id="7967385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967389">g</span>&nbsp;<span class="op" id="7967391">:=</span>&nbsp;<span class="ident" id="7967394">golden</span><span class="op" id="7967400">[</span><span class="ident" id="7967401">i</span><span class="op" id="7967402">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967406">s</span>&nbsp;<span class="op" id="7967408">:=</span>&nbsp;<span class="ident" id="7967411">fmt</span><span class="op" id="7967414">.</span><span class="ident" id="7967415">Sprintf</span><span class="op" id="7967422">(</span><span class="string" id="7967423">&#34;%x&#34;</span><span class="op" id="7967427">,</span>&nbsp;<span class="ident" id="7967429">Sum</span><span class="op" id="7967432">(</span><span class="op" id="7967433">[</span><span class="op" id="7967434">]</span><span class="builtintype" id="7967435">byte</span><span class="op" id="7967439">(</span><span class="ident" id="7967440">g</span><span class="op" id="7967441">.</span><span class="ident" id="7967442">in</span><span class="op" id="7967444">)</span><span class="op" id="7967445">)</span><span class="op" id="7967446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7967450">if</span>&nbsp;<span class="ident" id="7967453">s</span>&nbsp;<span class="op" id="7967455">!=</span>&nbsp;<span class="ident" id="7967458">g</span><span class="op" id="7967459">.</span><span class="ident" id="7967460">out</span>&nbsp;<span class="op" id="7967464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967469">t</span><span class="op" id="7967470">.</span><span class="ident" id="7967471">Fatalf</span><span class="op" id="7967477">(</span><span class="string" id="7967478">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7967514">,</span>&nbsp;<span class="ident" id="7967516">g</span><span class="op" id="7967517">.</span><span class="ident" id="7967518">in</span><span class="op" id="7967520">,</span>&nbsp;<span class="ident" id="7967522">s</span><span class="op" id="7967523">,</span>&nbsp;<span class="ident" id="7967525">g</span><span class="op" id="7967526">.</span><span class="ident" id="7967527">out</span><span class="op" id="7967530">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7967534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967538">c</span>&nbsp;<span class="op" id="7967540">:=</span>&nbsp;<span class="ident" id="7967543">New</span><span class="op" id="7967546">(</span><span class="op" id="7967547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967551">buf</span>&nbsp;<span class="op" id="7967555">:=</span>&nbsp;<span class="builtinfunc" id="7967558">make</span><span class="op" id="7967562">(</span><span class="op" id="7967563">[</span><span class="op" id="7967564">]</span><span class="builtintype" id="7967565">byte</span><span class="op" id="7967569">,</span>&nbsp;<span class="builtinfunc" id="7967571">len</span><span class="op" id="7967574">(</span><span class="ident" id="7967575">g</span><span class="op" id="7967576">.</span><span class="ident" id="7967577">in</span><span class="op" id="7967579">)</span><span class="op" id="7967580">+</span><span class="num" id="7967581">4</span><span class="op" id="7967582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7967586">for</span>&nbsp;<span class="ident" id="7967590">j</span>&nbsp;<span class="op" id="7967592">:=</span>&nbsp;<span class="num" id="7967595">0</span><span class="op" id="7967596">;</span>&nbsp;<span class="ident" id="7967598">j</span>&nbsp;<span class="op" id="7967600">&lt;</span>&nbsp;<span class="num" id="7967602">3</span><span class="op" id="7967603">+</span><span class="num" id="7967604">4</span><span class="op" id="7967605">;</span>&nbsp;<span class="ident" id="7967607">j</span><span class="op" id="7967608">++</span>&nbsp;<span class="op" id="7967611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7967616">if</span>&nbsp;<span class="ident" id="7967619">j</span>&nbsp;<span class="op" id="7967621">&lt;</span>&nbsp;<span class="num" id="7967623">2</span>&nbsp;<span class="op" id="7967625">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967631">io</span><span class="op" id="7967633">.</span><span class="ident" id="7967634">WriteString</span><span class="op" id="7967645">(</span><span class="ident" id="7967646">c</span><span class="op" id="7967647">,</span>&nbsp;<span class="ident" id="7967649">g</span><span class="op" id="7967650">.</span><span class="ident" id="7967651">in</span><span class="op" id="7967653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7967658">}</span>&nbsp;<span class="keyword" id="7967660">else</span>&nbsp;<span class="keyword" id="7967665">if</span>&nbsp;<span class="ident" id="7967668">j</span>&nbsp;<span class="op" id="7967670">==</span>&nbsp;<span class="num" id="7967673">2</span>&nbsp;<span class="op" id="7967675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967681">io</span><span class="op" id="7967683">.</span><span class="ident" id="7967684">WriteString</span><span class="op" id="7967695">(</span><span class="ident" id="7967696">c</span><span class="op" id="7967697">,</span>&nbsp;<span class="ident" id="7967699">g</span><span class="op" id="7967700">.</span><span class="ident" id="7967701">in</span><span class="op" id="7967703">[</span><span class="num" id="7967704">0</span><span class="op" id="7967705">:</span><span class="builtinfunc" id="7967706">len</span><span class="op" id="7967709">(</span><span class="ident" id="7967710">g</span><span class="op" id="7967711">.</span><span class="ident" id="7967712">in</span><span class="op" id="7967714">)</span><span class="op" id="7967715">/</span><span class="num" id="7967716">2</span><span class="op" id="7967717">]</span><span class="op" id="7967718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967724">c</span><span class="op" id="7967725">.</span><span class="ident" id="7967726">Sum</span><span class="op" id="7967729">(</span><span class="ident" id="7967730">nil</span><span class="op" id="7967733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967739">io</span><span class="op" id="7967741">.</span><span class="ident" id="7967742">WriteString</span><span class="op" id="7967753">(</span><span class="ident" id="7967754">c</span><span class="op" id="7967755">,</span>&nbsp;<span class="ident" id="7967757">g</span><span class="op" id="7967758">.</span><span class="ident" id="7967759">in</span><span class="op" id="7967761">[</span><span class="builtinfunc" id="7967762">len</span><span class="op" id="7967765">(</span><span class="ident" id="7967766">g</span><span class="op" id="7967767">.</span><span class="ident" id="7967768">in</span><span class="op" id="7967770">)</span><span class="op" id="7967771">/</span><span class="num" id="7967772">2</span><span class="op" id="7967773">:</span><span class="op" id="7967774">]</span><span class="op" id="7967775">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7967780">}</span>&nbsp;<span class="keyword" id="7967782">else</span>&nbsp;<span class="keyword" id="7967787">if</span>&nbsp;<span class="ident" id="7967790">j</span>&nbsp;<span class="op" id="7967792">&gt;</span>&nbsp;<span class="num" id="7967794">2</span>&nbsp;<span class="op" id="7967796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7967802">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967830">buf</span>&nbsp;<span class="op" id="7967834">=</span>&nbsp;<span class="ident" id="7967836">buf</span><span class="op" id="7967839">[</span><span class="num" id="7967840">1</span><span class="op" id="7967841">:</span><span class="op" id="7967842">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7967848">copy</span><span class="op" id="7967852">(</span><span class="ident" id="7967853">buf</span><span class="op" id="7967856">,</span>&nbsp;<span class="ident" id="7967858">g</span><span class="op" id="7967859">.</span><span class="ident" id="7967860">in</span><span class="op" id="7967862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967868">c</span><span class="op" id="7967869">.</span><span class="ident" id="7967870">Write</span><span class="op" id="7967875">(</span><span class="ident" id="7967876">buf</span><span class="op" id="7967879">[</span><span class="op" id="7967880">:</span><span class="builtinfunc" id="7967881">len</span><span class="op" id="7967884">(</span><span class="ident" id="7967885">g</span><span class="op" id="7967886">.</span><span class="ident" id="7967887">in</span><span class="op" id="7967889">)</span><span class="op" id="7967890">]</span><span class="op" id="7967891">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7967896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967901">s</span>&nbsp;<span class="op" id="7967903">:=</span>&nbsp;<span class="ident" id="7967906">fmt</span><span class="op" id="7967909">.</span><span class="ident" id="7967910">Sprintf</span><span class="op" id="7967917">(</span><span class="string" id="7967918">&#34;%x&#34;</span><span class="op" id="7967922">,</span>&nbsp;<span class="ident" id="7967924">c</span><span class="op" id="7967925">.</span><span class="ident" id="7967926">Sum</span><span class="op" id="7967929">(</span><span class="ident" id="7967930">nil</span><span class="op" id="7967933">)</span><span class="op" id="7967934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7967939">if</span>&nbsp;<span class="ident" id="7967942">s</span>&nbsp;<span class="op" id="7967944">!=</span>&nbsp;<span class="ident" id="7967947">g</span><span class="op" id="7967948">.</span><span class="ident" id="7967949">out</span>&nbsp;<span class="op" id="7967953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7967959">t</span><span class="op" id="7967960">.</span><span class="ident" id="7967961">Fatalf</span><span class="op" id="7967967">(</span><span class="string" id="7967968">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7967994">,</span>&nbsp;<span class="ident" id="7967996">j</span><span class="op" id="7967997">,</span>&nbsp;<span class="ident" id="7967999">g</span><span class="op" id="7968000">.</span><span class="ident" id="7968001">in</span><span class="op" id="7968003">,</span>&nbsp;<span class="ident" id="7968005">s</span><span class="op" id="7968006">,</span>&nbsp;<span class="ident" id="7968008">g</span><span class="op" id="7968009">.</span><span class="ident" id="7968010">out</span><span class="op" id="7968013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968018">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968023">c</span><span class="op" id="7968024">.</span><span class="ident" id="7968025">Reset</span><span class="op" id="7968030">(</span><span class="op" id="7968031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968038">}</span><br>
<span class="lineno"></span><span class="op" id="7968040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7968043">func</span>&nbsp;<span class="ident" id="7968048">TestLarge</span><span class="op" id="7968057">(</span><span class="ident" id="7968058">t</span>&nbsp;<span class="op" id="7968060">*</span><span class="ident" id="7968061">testing</span><span class="op" id="7968068">.</span><span class="ident" id="7968069">T</span><span class="op" id="7968070">)</span>&nbsp;<span class="op" id="7968072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968075">const</span>&nbsp;<span class="ident" id="7968081">N</span>&nbsp;<span class="op" id="7968083">=</span>&nbsp;<span class="num" id="7968085">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968092">ok</span>&nbsp;<span class="op" id="7968095">:=</span>&nbsp;<span class="string" id="7968098">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="7968133">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968167">block</span>&nbsp;<span class="op" id="7968173">:=</span>&nbsp;<span class="builtinfunc" id="7968176">make</span><span class="op" id="7968180">(</span><span class="op" id="7968181">[</span><span class="op" id="7968182">]</span><span class="builtintype" id="7968183">byte</span><span class="op" id="7968187">,</span>&nbsp;<span class="num" id="7968189">10004</span><span class="op" id="7968194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968197">c</span>&nbsp;<span class="op" id="7968199">:=</span>&nbsp;<span class="ident" id="7968202">New</span><span class="op" id="7968205">(</span><span class="op" id="7968206">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968209">for</span>&nbsp;<span class="ident" id="7968213">offset</span>&nbsp;<span class="op" id="7968220">:=</span>&nbsp;<span class="num" id="7968223">0</span><span class="op" id="7968224">;</span>&nbsp;<span class="ident" id="7968226">offset</span>&nbsp;<span class="op" id="7968233">&lt;</span>&nbsp;<span class="num" id="7968235">4</span><span class="op" id="7968236">;</span>&nbsp;<span class="ident" id="7968238">offset</span><span class="op" id="7968244">++</span>&nbsp;<span class="op" id="7968247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968251">for</span>&nbsp;<span class="ident" id="7968255">i</span>&nbsp;<span class="op" id="7968257">:=</span>&nbsp;<span class="num" id="7968260">0</span><span class="op" id="7968261">;</span>&nbsp;<span class="ident" id="7968263">i</span>&nbsp;<span class="op" id="7968265">&lt;</span>&nbsp;<span class="ident" id="7968267">N</span><span class="op" id="7968268">;</span>&nbsp;<span class="ident" id="7968270">i</span><span class="op" id="7968271">++</span>&nbsp;<span class="op" id="7968274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968279">block</span><span class="op" id="7968284">[</span><span class="ident" id="7968285">offset</span><span class="op" id="7968291">+</span><span class="ident" id="7968292">i</span><span class="op" id="7968293">]</span>&nbsp;<span class="op" id="7968295">=</span>&nbsp;<span class="string" id="7968297">&#39;0&#39;</span>&nbsp;<span class="op" id="7968301">+</span>&nbsp;<span class="builtintype" id="7968303">byte</span><span class="op" id="7968307">(</span><span class="ident" id="7968308">i</span><span class="op" id="7968309">%</span><span class="num" id="7968310">10</span><span class="op" id="7968312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968320">for</span>&nbsp;<span class="ident" id="7968324">blockSize</span>&nbsp;<span class="op" id="7968334">:=</span>&nbsp;<span class="num" id="7968337">10</span><span class="op" id="7968339">;</span>&nbsp;<span class="ident" id="7968341">blockSize</span>&nbsp;<span class="op" id="7968351">&lt;=</span>&nbsp;<span class="ident" id="7968354">N</span><span class="op" id="7968355">;</span>&nbsp;<span class="ident" id="7968357">blockSize</span>&nbsp;<span class="op" id="7968367">*=</span>&nbsp;<span class="num" id="7968370">10</span>&nbsp;<span class="op" id="7968373">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968378">blocks</span>&nbsp;<span class="op" id="7968385">:=</span>&nbsp;<span class="ident" id="7968388">N</span>&nbsp;<span class="op" id="7968390">/</span>&nbsp;<span class="ident" id="7968392">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968405">b</span>&nbsp;<span class="op" id="7968407">:=</span>&nbsp;<span class="ident" id="7968410">block</span><span class="op" id="7968415">[</span><span class="ident" id="7968416">offset</span>&nbsp;<span class="op" id="7968423">:</span>&nbsp;<span class="ident" id="7968425">offset</span><span class="op" id="7968431">+</span><span class="ident" id="7968432">blockSize</span><span class="op" id="7968441">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968446">c</span><span class="op" id="7968447">.</span><span class="ident" id="7968448">Reset</span><span class="op" id="7968453">(</span><span class="op" id="7968454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968459">for</span>&nbsp;<span class="ident" id="7968463">i</span>&nbsp;<span class="op" id="7968465">:=</span>&nbsp;<span class="num" id="7968468">0</span><span class="op" id="7968469">;</span>&nbsp;<span class="ident" id="7968471">i</span>&nbsp;<span class="op" id="7968473">&lt;</span>&nbsp;<span class="ident" id="7968475">blocks</span><span class="op" id="7968481">;</span>&nbsp;<span class="ident" id="7968483">i</span><span class="op" id="7968484">++</span>&nbsp;<span class="op" id="7968487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968493">c</span><span class="op" id="7968494">.</span><span class="ident" id="7968495">Write</span><span class="op" id="7968500">(</span><span class="ident" id="7968501">b</span><span class="op" id="7968502">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968512">s</span>&nbsp;<span class="op" id="7968514">:=</span>&nbsp;<span class="ident" id="7968517">fmt</span><span class="op" id="7968520">.</span><span class="ident" id="7968521">Sprintf</span><span class="op" id="7968528">(</span><span class="string" id="7968529">&#34;%x&#34;</span><span class="op" id="7968533">,</span>&nbsp;<span class="ident" id="7968535">c</span><span class="op" id="7968536">.</span><span class="ident" id="7968537">Sum</span><span class="op" id="7968540">(</span><span class="ident" id="7968541">nil</span><span class="op" id="7968544">)</span><span class="op" id="7968545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968550">if</span>&nbsp;<span class="ident" id="7968553">s</span>&nbsp;<span class="op" id="7968555">!=</span>&nbsp;<span class="ident" id="7968558">ok</span>&nbsp;<span class="op" id="7968561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968567">t</span><span class="op" id="7968568">.</span><span class="ident" id="7968569">Fatalf</span><span class="op" id="7968575">(</span><span class="string" id="7968576">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7968628">,</span>&nbsp;<span class="ident" id="7968630">offset</span><span class="op" id="7968636">,</span>&nbsp;<span class="ident" id="7968638">blockSize</span><span class="op" id="7968647">,</span>&nbsp;<span class="ident" id="7968649">s</span><span class="op" id="7968650">,</span>&nbsp;<span class="ident" id="7968652">ok</span><span class="op" id="7968654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968659">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7968666">}</span><br>
<span class="lineno"></span><span class="op" id="7968668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7968671">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="7968759">func</span>&nbsp;<span class="ident" id="7968764">TestBlockGeneric</span><span class="op" id="7968780">(</span><span class="ident" id="7968781">t</span>&nbsp;<span class="op" id="7968783">*</span><span class="ident" id="7968784">testing</span><span class="op" id="7968791">.</span><span class="ident" id="7968792">T</span><span class="op" id="7968793">)</span>&nbsp;<span class="op" id="7968795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968798">gen</span><span class="op" id="7968801">,</span>&nbsp;<span class="ident" id="7968803">asm</span>&nbsp;<span class="op" id="7968807">:=</span>&nbsp;<span class="ident" id="7968810">New</span><span class="op" id="7968813">(</span><span class="op" id="7968814">)</span><span class="op" id="7968815">.</span><span class="op" id="7968816">(</span><span class="op" id="7968817">*</span><span class="ident" id="7968818">digest</span><span class="op" id="7968824">)</span><span class="op" id="7968825">,</span>&nbsp;<span class="ident" id="7968827">New</span><span class="op" id="7968830">(</span><span class="op" id="7968831">)</span><span class="op" id="7968832">.</span><span class="op" id="7968833">(</span><span class="op" id="7968834">*</span><span class="ident" id="7968835">digest</span><span class="op" id="7968841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968844">buf</span>&nbsp;<span class="op" id="7968848">:=</span>&nbsp;<span class="builtinfunc" id="7968851">make</span><span class="op" id="7968855">(</span><span class="op" id="7968856">[</span><span class="op" id="7968857">]</span><span class="builtintype" id="7968858">byte</span><span class="op" id="7968862">,</span>&nbsp;<span class="ident" id="7968864">BlockSize</span><span class="op" id="7968873">*</span><span class="num" id="7968874">20</span><span class="op" id="7968876">)</span>&nbsp;<span class="comment" id="7968878">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968899">rand</span><span class="op" id="7968903">.</span><span class="ident" id="7968904">Read</span><span class="op" id="7968908">(</span><span class="ident" id="7968909">buf</span><span class="op" id="7968912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968915">blockGeneric</span><span class="op" id="7968927">(</span><span class="ident" id="7968928">gen</span><span class="op" id="7968931">,</span>&nbsp;<span class="ident" id="7968933">buf</span><span class="op" id="7968936">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968939">block</span><span class="op" id="7968944">(</span><span class="ident" id="7968945">asm</span><span class="op" id="7968948">,</span>&nbsp;<span class="ident" id="7968950">buf</span><span class="op" id="7968953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7968956">if</span>&nbsp;<span class="op" id="7968959">*</span><span class="ident" id="7968960">gen</span>&nbsp;<span class="op" id="7968964">!=</span>&nbsp;<span class="op" id="7968967">*</span><span class="ident" id="7968968">asm</span>&nbsp;<span class="op" id="7968972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7968976">t</span><span class="op" id="7968977">.</span><span class="ident" id="7968978">Error</span><span class="op" id="7968983">(</span><span class="string" id="7968984">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="7969037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969040">}</span><br>
<span class="lineno"></span><span class="op" id="7969042">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7969045">var</span>&nbsp;<span class="ident" id="7969049">bench</span>&nbsp;<span class="op" id="7969055">=</span>&nbsp;<span class="ident" id="7969057">New</span><span class="op" id="7969060">(</span><span class="op" id="7969061">)</span><br>
<span class="lineno"></span><span class="keyword" id="7969063">var</span>&nbsp;<span class="ident" id="7969067">buf</span>&nbsp;<span class="op" id="7969071">=</span>&nbsp;<span class="builtinfunc" id="7969073">make</span><span class="op" id="7969077">(</span><span class="op" id="7969078">[</span><span class="op" id="7969079">]</span><span class="builtintype" id="7969080">byte</span><span class="op" id="7969084">,</span>&nbsp;<span class="num" id="7969086">8192</span><span class="op" id="7969090">+</span><span class="num" id="7969091">1</span><span class="op" id="7969092">)</span><br>
<span class="lineno"></span><span class="keyword" id="7969094">var</span>&nbsp;<span class="ident" id="7969098">sum</span>&nbsp;<span class="op" id="7969102">=</span>&nbsp;<span class="builtinfunc" id="7969104">make</span><span class="op" id="7969108">(</span><span class="op" id="7969109">[</span><span class="op" id="7969110">]</span><span class="builtintype" id="7969111">byte</span><span class="op" id="7969115">,</span>&nbsp;<span class="ident" id="7969117">bench</span><span class="op" id="7969122">.</span><span class="ident" id="7969123">Size</span><span class="op" id="7969127">(</span><span class="op" id="7969128">)</span><span class="op" id="7969129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7969132">func</span>&nbsp;<span class="ident" id="7969137">benchmarkSize</span><span class="op" id="7969150">(</span><span class="ident" id="7969151">b</span>&nbsp;<span class="op" id="7969153">*</span><span class="ident" id="7969154">testing</span><span class="op" id="7969161">.</span><span class="ident" id="7969162">B</span><span class="op" id="7969163">,</span>&nbsp;<span class="ident" id="7969165">size</span>&nbsp;<span class="builtintype" id="7969170">int</span><span class="op" id="7969173">,</span>&nbsp;<span class="ident" id="7969175">unaligned</span>&nbsp;<span class="builtintype" id="7969185">bool</span><span class="op" id="7969189">)</span>&nbsp;<span class="op" id="7969191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969194">b</span><span class="op" id="7969195">.</span><span class="ident" id="7969196">SetBytes</span><span class="op" id="7969204">(</span><span class="ident" id="7969205">int64</span><span class="op" id="7969210">(</span><span class="ident" id="7969211">size</span><span class="op" id="7969215">)</span><span class="op" id="7969216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969219">buf</span>&nbsp;<span class="op" id="7969223">:=</span>&nbsp;<span class="ident" id="7969226">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7969231">if</span>&nbsp;<span class="ident" id="7969234">unaligned</span>&nbsp;<span class="op" id="7969244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7969248">if</span>&nbsp;<span class="builtintype" id="7969251">uintptr</span><span class="op" id="7969258">(</span><span class="ident" id="7969259">unsafe</span><span class="op" id="7969265">.</span><span class="ident" id="7969266">Pointer</span><span class="op" id="7969273">(</span><span class="op" id="7969274">&amp;</span><span class="ident" id="7969275">buf</span><span class="op" id="7969278">[</span><span class="num" id="7969279">0</span><span class="op" id="7969280">]</span><span class="op" id="7969281">)</span><span class="op" id="7969282">)</span><span class="op" id="7969283">&amp;</span><span class="op" id="7969284">(</span><span class="ident" id="7969285">unsafe</span><span class="op" id="7969291">.</span><span class="ident" id="7969292">Alignof</span><span class="op" id="7969299">(</span><span class="builtintype" id="7969300">uint32</span><span class="op" id="7969306">(</span><span class="num" id="7969307">0</span><span class="op" id="7969308">)</span><span class="op" id="7969309">)</span><span class="op" id="7969310">-</span><span class="num" id="7969311">1</span><span class="op" id="7969312">)</span>&nbsp;<span class="op" id="7969314">==</span>&nbsp;<span class="num" id="7969317">0</span>&nbsp;<span class="op" id="7969319">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969324">buf</span>&nbsp;<span class="op" id="7969328">=</span>&nbsp;<span class="ident" id="7969330">buf</span><span class="op" id="7969333">[</span><span class="num" id="7969334">1</span><span class="op" id="7969335">:</span><span class="op" id="7969336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969346">b</span><span class="op" id="7969347">.</span><span class="ident" id="7969348">ResetTimer</span><span class="op" id="7969358">(</span><span class="op" id="7969359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7969362">for</span>&nbsp;<span class="ident" id="7969366">i</span>&nbsp;<span class="op" id="7969368">:=</span>&nbsp;<span class="num" id="7969371">0</span><span class="op" id="7969372">;</span>&nbsp;<span class="ident" id="7969374">i</span>&nbsp;<span class="op" id="7969376">&lt;</span>&nbsp;<span class="ident" id="7969378">b</span><span class="op" id="7969379">.</span><span class="ident" id="7969380">N</span><span class="op" id="7969381">;</span>&nbsp;<span class="ident" id="7969383">i</span><span class="op" id="7969384">++</span>&nbsp;<span class="op" id="7969387">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969391">bench</span><span class="op" id="7969396">.</span><span class="ident" id="7969397">Reset</span><span class="op" id="7969402">(</span><span class="op" id="7969403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969407">bench</span><span class="op" id="7969412">.</span><span class="ident" id="7969413">Write</span><span class="op" id="7969418">(</span><span class="ident" id="7969419">buf</span><span class="op" id="7969422">[</span><span class="op" id="7969423">:</span><span class="ident" id="7969424">size</span><span class="op" id="7969428">]</span><span class="op" id="7969429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969433">bench</span><span class="op" id="7969438">.</span><span class="ident" id="7969439">Sum</span><span class="op" id="7969442">(</span><span class="ident" id="7969443">sum</span><span class="op" id="7969446">[</span><span class="op" id="7969447">:</span><span class="num" id="7969448">0</span><span class="op" id="7969449">]</span><span class="op" id="7969450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7969453">}</span><br>
<span class="lineno"></span><span class="op" id="7969455">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7969458">func</span>&nbsp;<span class="ident" id="7969463">BenchmarkHash8Bytes</span><span class="op" id="7969482">(</span><span class="ident" id="7969483">b</span>&nbsp;<span class="op" id="7969485">*</span><span class="ident" id="7969486">testing</span><span class="op" id="7969493">.</span><span class="ident" id="7969494">B</span><span class="op" id="7969495">)</span>&nbsp;<span class="op" id="7969497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969500">benchmarkSize</span><span class="op" id="7969513">(</span><span class="ident" id="7969514">b</span><span class="op" id="7969515">,</span>&nbsp;<span class="num" id="7969517">8</span><span class="op" id="7969518">,</span>&nbsp;<span class="builtintype" id="7969520">false</span><span class="op" id="7969525">)</span><br>
<span class="lineno"></span><span class="op" id="7969527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="7969530">func</span>&nbsp;<span class="ident" id="7969535">BenchmarkHash1K</span><span class="op" id="7969550">(</span><span class="ident" id="7969551">b</span>&nbsp;<span class="op" id="7969553">*</span><span class="ident" id="7969554">testing</span><span class="op" id="7969561">.</span><span class="ident" id="7969562">B</span><span class="op" id="7969563">)</span>&nbsp;<span class="op" id="7969565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969568">benchmarkSize</span><span class="op" id="7969581">(</span><span class="ident" id="7969582">b</span><span class="op" id="7969583">,</span>&nbsp;<span class="num" id="7969585">1024</span><span class="op" id="7969589">,</span>&nbsp;<span class="builtintype" id="7969591">false</span><span class="op" id="7969596">)</span><br>
<span class="lineno"></span><span class="op" id="7969598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7969601">func</span>&nbsp;<span class="ident" id="7969606">BenchmarkHash8K</span><span class="op" id="7969621">(</span><span class="ident" id="7969622">b</span>&nbsp;<span class="op" id="7969624">*</span><span class="ident" id="7969625">testing</span><span class="op" id="7969632">.</span><span class="ident" id="7969633">B</span><span class="op" id="7969634">)</span>&nbsp;<span class="op" id="7969636">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969639">benchmarkSize</span><span class="op" id="7969652">(</span><span class="ident" id="7969653">b</span><span class="op" id="7969654">,</span>&nbsp;<span class="num" id="7969656">8192</span><span class="op" id="7969660">,</span>&nbsp;<span class="builtintype" id="7969662">false</span><span class="op" id="7969667">)</span><br>
<span class="lineno"></span><span class="op" id="7969669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7969672">func</span>&nbsp;<span class="ident" id="7969677">BenchmarkHash8BytesUnaligned</span><span class="op" id="7969705">(</span><span class="ident" id="7969706">b</span>&nbsp;<span class="op" id="7969708">*</span><span class="ident" id="7969709">testing</span><span class="op" id="7969716">.</span><span class="ident" id="7969717">B</span><span class="op" id="7969718">)</span>&nbsp;<span class="op" id="7969720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969723">benchmarkSize</span><span class="op" id="7969736">(</span><span class="ident" id="7969737">b</span><span class="op" id="7969738">,</span>&nbsp;<span class="num" id="7969740">8</span><span class="op" id="7969741">,</span>&nbsp;<span class="builtintype" id="7969743">true</span><span class="op" id="7969747">)</span><br>
<span class="lineno">155</span><span class="op" id="7969749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7969752">func</span>&nbsp;<span class="ident" id="7969757">BenchmarkHash1KUnaligned</span><span class="op" id="7969781">(</span><span class="ident" id="7969782">b</span>&nbsp;<span class="op" id="7969784">*</span><span class="ident" id="7969785">testing</span><span class="op" id="7969792">.</span><span class="ident" id="7969793">B</span><span class="op" id="7969794">)</span>&nbsp;<span class="op" id="7969796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969799">benchmarkSize</span><span class="op" id="7969812">(</span><span class="ident" id="7969813">b</span><span class="op" id="7969814">,</span>&nbsp;<span class="num" id="7969816">1024</span><span class="op" id="7969820">,</span>&nbsp;<span class="builtintype" id="7969822">true</span><span class="op" id="7969826">)</span><br>
<span class="lineno"></span><span class="op" id="7969828">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="7969831">func</span>&nbsp;<span class="ident" id="7969836">BenchmarkHash8KUnaligned</span><span class="op" id="7969860">(</span><span class="ident" id="7969861">b</span>&nbsp;<span class="op" id="7969863">*</span><span class="ident" id="7969864">testing</span><span class="op" id="7969871">.</span><span class="ident" id="7969872">B</span><span class="op" id="7969873">)</span>&nbsp;<span class="op" id="7969875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7969878">benchmarkSize</span><span class="op" id="7969891">(</span><span class="ident" id="7969892">b</span><span class="op" id="7969893">,</span>&nbsp;<span class="num" id="7969895">8192</span><span class="op" id="7969899">,</span>&nbsp;<span class="builtintype" id="7969901">true</span><span class="op" id="7969905">)</span><br>
<span class="lineno"></span><span class="op" id="7969907">}</span>
</div>
</body>
</html>
