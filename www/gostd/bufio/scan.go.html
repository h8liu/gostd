<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3503908">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3503963">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3504017">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3504068">package</span>&nbsp;<span class="ident" id="3504076">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3504083">import</span>&nbsp;<span class="op" id="3504090">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3504093">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3504102">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3504112">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3504118">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3504133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3504136">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="3504204">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3504270">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="3504340">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3504405">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="3504473">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="3504551">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3504617">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3504686">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3504741">//</span><br>
<span class="lineno"></span><span class="comment" id="3504744">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="3504820">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3504890">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3504963">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="3505040">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3505089">//</span><br>
<span class="lineno">30</span><span class="keyword" id="3505092">type</span>&nbsp;<span class="ident" id="3505097">Scanner</span>&nbsp;<span class="keyword" id="3505105">struct</span>&nbsp;<span class="op" id="3505112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505115">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3505128">io</span><span class="op" id="3505130">.</span><span class="ident" id="3505131">Reader</span>&nbsp;<span class="comment" id="3505138">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505177">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3505190">SplitFunc</span>&nbsp;<span class="comment" id="3505200">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505238">maxTokenSize</span>&nbsp;<span class="builtintype" id="3505251">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505261">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505309">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3505322">[</span><span class="op" id="3505323">]</span><span class="builtintype" id="3505324">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505332">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505366">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3505379">[</span><span class="op" id="3505380">]</span><span class="builtintype" id="3505381">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505389">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505427">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3505440">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505450">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505487">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3505500">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505510">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505534">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3505547">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505557">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505575">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3505588">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3505598">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="3505635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3505638">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3505711">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="3505789">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="3505865">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3505940">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3506015">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="3506093">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3506167">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="3506245">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3506289">//</span><br>
<span class="lineno"></span><span class="comment" id="3506292">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="3506358">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3506388">//</span><br>
<span class="lineno">55</span><span class="comment" id="3506391">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="3506461">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="3506527">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3506565">type</span>&nbsp;<span class="ident" id="3506570">SplitFunc</span>&nbsp;<span class="keyword" id="3506580">func</span><span class="op" id="3506584">(</span><span class="ident" id="3506585">data</span>&nbsp;<span class="op" id="3506590">[</span><span class="op" id="3506591">]</span><span class="builtintype" id="3506592">byte</span><span class="op" id="3506596">,</span>&nbsp;<span class="ident" id="3506598">atEOF</span>&nbsp;<span class="builtintype" id="3506604">bool</span><span class="op" id="3506608">)</span>&nbsp;<span class="op" id="3506610">(</span><span class="ident" id="3506611">advance</span>&nbsp;<span class="builtintype" id="3506619">int</span><span class="op" id="3506622">,</span>&nbsp;<span class="ident" id="3506624">token</span>&nbsp;<span class="op" id="3506630">[</span><span class="op" id="3506631">]</span><span class="builtintype" id="3506632">byte</span><span class="op" id="3506636">,</span>&nbsp;<span class="ident" id="3506638">err</span>&nbsp;<span class="builtintype" id="3506642">error</span><span class="op" id="3506647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3506650">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3506681">var</span>&nbsp;<span class="op" id="3506685">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506688">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3506707">=</span>&nbsp;<span class="ident" id="3506709">errors</span><span class="op" id="3506715">.</span><span class="ident" id="3506716">New</span><span class="op" id="3506719">(</span><span class="string" id="3506720">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="3506751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506754">ErrNegativeAdvance</span>&nbsp;<span class="op" id="3506773">=</span>&nbsp;<span class="ident" id="3506775">errors</span><span class="op" id="3506781">.</span><span class="ident" id="3506782">New</span><span class="op" id="3506785">(</span><span class="string" id="3506786">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="3506843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506846">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3506865">=</span>&nbsp;<span class="ident" id="3506867">errors</span><span class="op" id="3506873">.</span><span class="ident" id="3506874">New</span><span class="op" id="3506877">(</span><span class="string" id="3506878">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="3506939">)</span><br>
<span class="lineno">65</span><span class="op" id="3506941">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3506944">const</span>&nbsp;<span class="op" id="3506950">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3506953">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3507018">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3507081">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507131">MaxScanTokenSize</span>&nbsp;<span class="op" id="3507148">=</span>&nbsp;<span class="num" id="3507150">64</span>&nbsp;<span class="op" id="3507153">*</span>&nbsp;<span class="num" id="3507155">1024</span><br>
<span class="lineno"></span><span class="op" id="3507160">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3507163">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="3507215">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3507260">func</span>&nbsp;<span class="ident" id="3507265">NewScanner</span><span class="op" id="3507275">(</span><span class="ident" id="3507276">r</span>&nbsp;<span class="ident" id="3507278">io</span><span class="op" id="3507280">.</span><span class="ident" id="3507281">Reader</span><span class="op" id="3507287">)</span>&nbsp;<span class="op" id="3507289">*</span><span class="ident" id="3507290">Scanner</span>&nbsp;<span class="op" id="3507298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507301">return</span>&nbsp;<span class="op" id="3507308">&amp;</span><span class="ident" id="3507309">Scanner</span><span class="op" id="3507316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507320">r</span><span class="op" id="3507321">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3507334">r</span><span class="op" id="3507335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507339">split</span><span class="op" id="3507344">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3507353">ScanLines</span><span class="op" id="3507362">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507366">maxTokenSize</span><span class="op" id="3507378">:</span>&nbsp;<span class="ident" id="3507380">MaxScanTokenSize</span><span class="op" id="3507396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3507400">buf</span><span class="op" id="3507403">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3507414">make</span><span class="op" id="3507418">(</span><span class="op" id="3507419">[</span><span class="op" id="3507420">]</span><span class="builtintype" id="3507421">byte</span><span class="op" id="3507425">,</span>&nbsp;<span class="num" id="3507427">4096</span><span class="op" id="3507431">)</span><span class="op" id="3507432">,</span>&nbsp;<span class="comment" id="3507434">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3507481">}</span><br>
<span class="lineno"></span><span class="op" id="3507483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3507486">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3507562">func</span>&nbsp;<span class="op" id="3507567">(</span><span class="ident" id="3507568">s</span>&nbsp;<span class="op" id="3507570">*</span><span class="ident" id="3507571">Scanner</span><span class="op" id="3507578">)</span>&nbsp;<span class="ident" id="3507580">Err</span><span class="op" id="3507583">(</span><span class="op" id="3507584">)</span>&nbsp;<span class="builtintype" id="3507586">error</span>&nbsp;<span class="op" id="3507592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507595">if</span>&nbsp;<span class="ident" id="3507598">s</span><span class="op" id="3507599">.</span><span class="ident" id="3507600">err</span>&nbsp;<span class="op" id="3507604">==</span>&nbsp;<span class="ident" id="3507607">io</span><span class="op" id="3507609">.</span><span class="ident" id="3507610">EOF</span>&nbsp;<span class="op" id="3507614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507618">return</span>&nbsp;<span class="ident" id="3507625">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3507630">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507633">return</span>&nbsp;<span class="ident" id="3507640">s</span><span class="op" id="3507641">.</span><span class="ident" id="3507642">err</span><br>
<span class="lineno"></span><span class="op" id="3507646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3507649">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="3507717">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="3507784">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3507840">func</span>&nbsp;<span class="op" id="3507845">(</span><span class="ident" id="3507846">s</span>&nbsp;<span class="op" id="3507848">*</span><span class="ident" id="3507849">Scanner</span><span class="op" id="3507856">)</span>&nbsp;<span class="ident" id="3507858">Bytes</span><span class="op" id="3507863">(</span><span class="op" id="3507864">)</span>&nbsp;<span class="op" id="3507866">[</span><span class="op" id="3507867">]</span><span class="builtintype" id="3507868">byte</span>&nbsp;<span class="op" id="3507873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507876">return</span>&nbsp;<span class="ident" id="3507883">s</span><span class="op" id="3507884">.</span><span class="ident" id="3507885">token</span><br>
<span class="lineno"></span><span class="op" id="3507891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3507894">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="3507960">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3508010">func</span>&nbsp;<span class="op" id="3508015">(</span><span class="ident" id="3508016">s</span>&nbsp;<span class="op" id="3508018">*</span><span class="ident" id="3508019">Scanner</span><span class="op" id="3508026">)</span>&nbsp;<span class="ident" id="3508028">Text</span><span class="op" id="3508032">(</span><span class="op" id="3508033">)</span>&nbsp;<span class="builtintype" id="3508035">string</span>&nbsp;<span class="op" id="3508042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508045">return</span>&nbsp;<span class="builtintype" id="3508052">string</span><span class="op" id="3508058">(</span><span class="ident" id="3508059">s</span><span class="op" id="3508060">.</span><span class="ident" id="3508061">token</span><span class="op" id="3508066">)</span><br>
<span class="lineno"></span><span class="op" id="3508068">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3508071">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3508138">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3508211">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3508279">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="3508350">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="3508413">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3508433">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3508504">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="3508570">func</span>&nbsp;<span class="op" id="3508575">(</span><span class="ident" id="3508576">s</span>&nbsp;<span class="op" id="3508578">*</span><span class="ident" id="3508579">Scanner</span><span class="op" id="3508586">)</span>&nbsp;<span class="ident" id="3508588">Scan</span><span class="op" id="3508592">(</span><span class="op" id="3508593">)</span>&nbsp;<span class="builtintype" id="3508595">bool</span>&nbsp;<span class="op" id="3508600">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3508603">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508635">for</span>&nbsp;<span class="op" id="3508639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3508643">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3508701">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3508774">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508836">if</span>&nbsp;<span class="ident" id="3508839">s</span><span class="op" id="3508840">.</span><span class="ident" id="3508841">end</span>&nbsp;<span class="op" id="3508845">&gt;</span>&nbsp;<span class="ident" id="3508847">s</span><span class="op" id="3508848">.</span><span class="ident" id="3508849">start</span>&nbsp;<span class="op" id="3508855">||</span>&nbsp;<span class="ident" id="3508858">s</span><span class="op" id="3508859">.</span><span class="ident" id="3508860">err</span>&nbsp;<span class="op" id="3508864">!=</span>&nbsp;<span class="ident" id="3508867">nil</span>&nbsp;<span class="op" id="3508871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3508876">advance</span><span class="op" id="3508883">,</span>&nbsp;<span class="ident" id="3508885">token</span><span class="op" id="3508890">,</span>&nbsp;<span class="ident" id="3508892">err</span>&nbsp;<span class="op" id="3508896">:=</span>&nbsp;<span class="ident" id="3508899">s</span><span class="op" id="3508900">.</span><span class="ident" id="3508901">split</span><span class="op" id="3508906">(</span><span class="ident" id="3508907">s</span><span class="op" id="3508908">.</span><span class="ident" id="3508909">buf</span><span class="op" id="3508912">[</span><span class="ident" id="3508913">s</span><span class="op" id="3508914">.</span><span class="ident" id="3508915">start</span><span class="op" id="3508920">:</span><span class="ident" id="3508921">s</span><span class="op" id="3508922">.</span><span class="ident" id="3508923">end</span><span class="op" id="3508926">]</span><span class="op" id="3508927">,</span>&nbsp;<span class="ident" id="3508929">s</span><span class="op" id="3508930">.</span><span class="ident" id="3508931">err</span>&nbsp;<span class="op" id="3508935">!=</span>&nbsp;<span class="ident" id="3508938">nil</span><span class="op" id="3508941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508946">if</span>&nbsp;<span class="ident" id="3508949">err</span>&nbsp;<span class="op" id="3508953">!=</span>&nbsp;<span class="ident" id="3508956">nil</span>&nbsp;<span class="op" id="3508960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3508966">s</span><span class="op" id="3508967">.</span><span class="ident" id="3508968">setErr</span><span class="op" id="3508974">(</span><span class="ident" id="3508975">err</span><span class="op" id="3508978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3508984">return</span>&nbsp;<span class="builtintype" id="3508991">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509005">if</span>&nbsp;<span class="op" id="3509008">!</span><span class="ident" id="3509009">s</span><span class="op" id="3509010">.</span><span class="ident" id="3509011">advance</span><span class="op" id="3509018">(</span><span class="ident" id="3509019">advance</span><span class="op" id="3509026">)</span>&nbsp;<span class="op" id="3509028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509034">return</span>&nbsp;<span class="builtintype" id="3509041">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509055">s</span><span class="op" id="3509056">.</span><span class="ident" id="3509057">token</span>&nbsp;<span class="op" id="3509063">=</span>&nbsp;<span class="ident" id="3509065">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509074">if</span>&nbsp;<span class="ident" id="3509077">token</span>&nbsp;<span class="op" id="3509083">!=</span>&nbsp;<span class="ident" id="3509086">nil</span>&nbsp;<span class="op" id="3509090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509096">if</span>&nbsp;<span class="ident" id="3509099">s</span><span class="op" id="3509100">.</span><span class="ident" id="3509101">err</span>&nbsp;<span class="op" id="3509105">==</span>&nbsp;<span class="ident" id="3509108">nil</span>&nbsp;<span class="op" id="3509112">||</span>&nbsp;<span class="ident" id="3509115">advance</span>&nbsp;<span class="op" id="3509123">&gt;</span>&nbsp;<span class="num" id="3509125">0</span>&nbsp;<span class="op" id="3509127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509134">s</span><span class="op" id="3509135">.</span><span class="ident" id="3509136">empties</span>&nbsp;<span class="op" id="3509144">=</span>&nbsp;<span class="num" id="3509146">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509152">}</span>&nbsp;<span class="keyword" id="3509154">else</span>&nbsp;<span class="op" id="3509159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509166">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509219">s</span><span class="op" id="3509220">.</span><span class="ident" id="3509221">empties</span><span class="op" id="3509228">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509236">if</span>&nbsp;<span class="ident" id="3509239">s</span><span class="op" id="3509240">.</span><span class="ident" id="3509241">empties</span>&nbsp;<span class="op" id="3509249">&gt;</span>&nbsp;<span class="num" id="3509251">100</span>&nbsp;<span class="op" id="3509255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3509263">panic</span><span class="op" id="3509268">(</span><span class="string" id="3509269">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="3509319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509332">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509338">return</span>&nbsp;<span class="builtintype" id="3509345">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509361">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509419">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509479">if</span>&nbsp;<span class="ident" id="3509482">s</span><span class="op" id="3509483">.</span><span class="ident" id="3509484">err</span>&nbsp;<span class="op" id="3509488">!=</span>&nbsp;<span class="ident" id="3509491">nil</span>&nbsp;<span class="op" id="3509495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509500">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509520">s</span><span class="op" id="3509521">.</span><span class="ident" id="3509522">start</span>&nbsp;<span class="op" id="3509528">=</span>&nbsp;<span class="num" id="3509530">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509535">s</span><span class="op" id="3509536">.</span><span class="ident" id="3509537">end</span>&nbsp;<span class="op" id="3509541">=</span>&nbsp;<span class="num" id="3509543">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509548">return</span>&nbsp;<span class="builtintype" id="3509555">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509567">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509593">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509670">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509695">if</span>&nbsp;<span class="ident" id="3509698">s</span><span class="op" id="3509699">.</span><span class="ident" id="3509700">start</span>&nbsp;<span class="op" id="3509706">&gt;</span>&nbsp;<span class="num" id="3509708">0</span>&nbsp;<span class="op" id="3509710">&amp;&amp;</span>&nbsp;<span class="op" id="3509713">(</span><span class="ident" id="3509714">s</span><span class="op" id="3509715">.</span><span class="ident" id="3509716">end</span>&nbsp;<span class="op" id="3509720">==</span>&nbsp;<span class="builtinfunc" id="3509723">len</span><span class="op" id="3509726">(</span><span class="ident" id="3509727">s</span><span class="op" id="3509728">.</span><span class="ident" id="3509729">buf</span><span class="op" id="3509732">)</span>&nbsp;<span class="op" id="3509734">||</span>&nbsp;<span class="ident" id="3509737">s</span><span class="op" id="3509738">.</span><span class="ident" id="3509739">start</span>&nbsp;<span class="op" id="3509745">&gt;</span>&nbsp;<span class="builtinfunc" id="3509747">len</span><span class="op" id="3509750">(</span><span class="ident" id="3509751">s</span><span class="op" id="3509752">.</span><span class="ident" id="3509753">buf</span><span class="op" id="3509756">)</span><span class="op" id="3509757">/</span><span class="num" id="3509758">2</span><span class="op" id="3509759">)</span>&nbsp;<span class="op" id="3509761">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3509766">copy</span><span class="op" id="3509770">(</span><span class="ident" id="3509771">s</span><span class="op" id="3509772">.</span><span class="ident" id="3509773">buf</span><span class="op" id="3509776">,</span>&nbsp;<span class="ident" id="3509778">s</span><span class="op" id="3509779">.</span><span class="ident" id="3509780">buf</span><span class="op" id="3509783">[</span><span class="ident" id="3509784">s</span><span class="op" id="3509785">.</span><span class="ident" id="3509786">start</span><span class="op" id="3509791">:</span><span class="ident" id="3509792">s</span><span class="op" id="3509793">.</span><span class="ident" id="3509794">end</span><span class="op" id="3509797">]</span><span class="op" id="3509798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509803">s</span><span class="op" id="3509804">.</span><span class="ident" id="3509805">end</span>&nbsp;<span class="op" id="3509809">-=</span>&nbsp;<span class="ident" id="3509812">s</span><span class="op" id="3509813">.</span><span class="ident" id="3509814">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509823">s</span><span class="op" id="3509824">.</span><span class="ident" id="3509825">start</span>&nbsp;<span class="op" id="3509831">=</span>&nbsp;<span class="num" id="3509833">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3509841">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509881">if</span>&nbsp;<span class="ident" id="3509884">s</span><span class="op" id="3509885">.</span><span class="ident" id="3509886">end</span>&nbsp;<span class="op" id="3509890">==</span>&nbsp;<span class="builtinfunc" id="3509893">len</span><span class="op" id="3509896">(</span><span class="ident" id="3509897">s</span><span class="op" id="3509898">.</span><span class="ident" id="3509899">buf</span><span class="op" id="3509902">)</span>&nbsp;<span class="op" id="3509904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509909">if</span>&nbsp;<span class="builtinfunc" id="3509912">len</span><span class="op" id="3509915">(</span><span class="ident" id="3509916">s</span><span class="op" id="3509917">.</span><span class="ident" id="3509918">buf</span><span class="op" id="3509921">)</span>&nbsp;<span class="op" id="3509923">&gt;=</span>&nbsp;<span class="ident" id="3509926">s</span><span class="op" id="3509927">.</span><span class="ident" id="3509928">maxTokenSize</span>&nbsp;<span class="op" id="3509941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509947">s</span><span class="op" id="3509948">.</span><span class="ident" id="3509949">setErr</span><span class="op" id="3509955">(</span><span class="ident" id="3509956">ErrTooLong</span><span class="op" id="3509966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3509972">return</span>&nbsp;<span class="builtintype" id="3509979">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3509988">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3509993">newSize</span>&nbsp;<span class="op" id="3510001">:=</span>&nbsp;<span class="builtinfunc" id="3510004">len</span><span class="op" id="3510007">(</span><span class="ident" id="3510008">s</span><span class="op" id="3510009">.</span><span class="ident" id="3510010">buf</span><span class="op" id="3510013">)</span>&nbsp;<span class="op" id="3510015">*</span>&nbsp;<span class="num" id="3510017">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510022">if</span>&nbsp;<span class="ident" id="3510025">newSize</span>&nbsp;<span class="op" id="3510033">&gt;</span>&nbsp;<span class="ident" id="3510035">s</span><span class="op" id="3510036">.</span><span class="ident" id="3510037">maxTokenSize</span>&nbsp;<span class="op" id="3510050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510056">newSize</span>&nbsp;<span class="op" id="3510064">=</span>&nbsp;<span class="ident" id="3510066">s</span><span class="op" id="3510067">.</span><span class="ident" id="3510068">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510089">newBuf</span>&nbsp;<span class="op" id="3510096">:=</span>&nbsp;<span class="builtinfunc" id="3510099">make</span><span class="op" id="3510103">(</span><span class="op" id="3510104">[</span><span class="op" id="3510105">]</span><span class="builtintype" id="3510106">byte</span><span class="op" id="3510110">,</span>&nbsp;<span class="ident" id="3510112">newSize</span><span class="op" id="3510119">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3510124">copy</span><span class="op" id="3510128">(</span><span class="ident" id="3510129">newBuf</span><span class="op" id="3510135">,</span>&nbsp;<span class="ident" id="3510137">s</span><span class="op" id="3510138">.</span><span class="ident" id="3510139">buf</span><span class="op" id="3510142">[</span><span class="ident" id="3510143">s</span><span class="op" id="3510144">.</span><span class="ident" id="3510145">start</span><span class="op" id="3510150">:</span><span class="ident" id="3510151">s</span><span class="op" id="3510152">.</span><span class="ident" id="3510153">end</span><span class="op" id="3510156">]</span><span class="op" id="3510157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510162">s</span><span class="op" id="3510163">.</span><span class="ident" id="3510164">buf</span>&nbsp;<span class="op" id="3510168">=</span>&nbsp;<span class="ident" id="3510170">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510180">s</span><span class="op" id="3510181">.</span><span class="ident" id="3510182">end</span>&nbsp;<span class="op" id="3510186">-=</span>&nbsp;<span class="ident" id="3510189">s</span><span class="op" id="3510190">.</span><span class="ident" id="3510191">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510200">s</span><span class="op" id="3510201">.</span><span class="ident" id="3510202">start</span>&nbsp;<span class="op" id="3510208">=</span>&nbsp;<span class="num" id="3510210">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510215">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3510230">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3510301">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3510375">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510432">for</span>&nbsp;<span class="ident" id="3510436">loop</span>&nbsp;<span class="op" id="3510441">:=</span>&nbsp;<span class="num" id="3510444">0</span><span class="op" id="3510445">;</span>&nbsp;<span class="op" id="3510447">;</span>&nbsp;<span class="op" id="3510449">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510454">n</span><span class="op" id="3510455">,</span>&nbsp;<span class="ident" id="3510457">err</span>&nbsp;<span class="op" id="3510461">:=</span>&nbsp;<span class="ident" id="3510464">s</span><span class="op" id="3510465">.</span><span class="ident" id="3510466">r</span><span class="op" id="3510467">.</span><span class="ident" id="3510468">Read</span><span class="op" id="3510472">(</span><span class="ident" id="3510473">s</span><span class="op" id="3510474">.</span><span class="ident" id="3510475">buf</span><span class="op" id="3510478">[</span><span class="ident" id="3510479">s</span><span class="op" id="3510480">.</span><span class="ident" id="3510481">end</span><span class="op" id="3510484">:</span><span class="builtinfunc" id="3510485">len</span><span class="op" id="3510488">(</span><span class="ident" id="3510489">s</span><span class="op" id="3510490">.</span><span class="ident" id="3510491">buf</span><span class="op" id="3510494">)</span><span class="op" id="3510495">]</span><span class="op" id="3510496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510501">s</span><span class="op" id="3510502">.</span><span class="ident" id="3510503">end</span>&nbsp;<span class="op" id="3510507">+=</span>&nbsp;<span class="ident" id="3510510">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510515">if</span>&nbsp;<span class="ident" id="3510518">err</span>&nbsp;<span class="op" id="3510522">!=</span>&nbsp;<span class="ident" id="3510525">nil</span>&nbsp;<span class="op" id="3510529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510535">s</span><span class="op" id="3510536">.</span><span class="ident" id="3510537">setErr</span><span class="op" id="3510543">(</span><span class="ident" id="3510544">err</span><span class="op" id="3510547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510553">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510567">if</span>&nbsp;<span class="ident" id="3510570">n</span>&nbsp;<span class="op" id="3510572">&gt;</span>&nbsp;<span class="num" id="3510574">0</span>&nbsp;<span class="op" id="3510576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510582">s</span><span class="op" id="3510583">.</span><span class="ident" id="3510584">empties</span>&nbsp;<span class="op" id="3510592">=</span>&nbsp;<span class="num" id="3510594">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510600">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510609">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510614">loop</span><span class="op" id="3510618">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510624">if</span>&nbsp;<span class="ident" id="3510627">loop</span>&nbsp;<span class="op" id="3510632">&gt;</span>&nbsp;<span class="ident" id="3510634">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="3510659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510665">s</span><span class="op" id="3510666">.</span><span class="ident" id="3510667">setErr</span><span class="op" id="3510673">(</span><span class="ident" id="3510674">io</span><span class="op" id="3510676">.</span><span class="ident" id="3510677">ErrNoProgress</span><span class="op" id="3510690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510696">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510705">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510712">}</span><br>
<span class="lineno"></span><span class="op" id="3510714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3510717">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="3510802">func</span>&nbsp;<span class="op" id="3510807">(</span><span class="ident" id="3510808">s</span>&nbsp;<span class="op" id="3510810">*</span><span class="ident" id="3510811">Scanner</span><span class="op" id="3510818">)</span>&nbsp;<span class="ident" id="3510820">advance</span><span class="op" id="3510827">(</span><span class="ident" id="3510828">n</span>&nbsp;<span class="builtintype" id="3510830">int</span><span class="op" id="3510833">)</span>&nbsp;<span class="builtintype" id="3510835">bool</span>&nbsp;<span class="op" id="3510840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510843">if</span>&nbsp;<span class="ident" id="3510846">n</span>&nbsp;<span class="op" id="3510848">&lt;</span>&nbsp;<span class="num" id="3510850">0</span>&nbsp;<span class="op" id="3510852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510856">s</span><span class="op" id="3510857">.</span><span class="ident" id="3510858">setErr</span><span class="op" id="3510864">(</span><span class="ident" id="3510865">ErrNegativeAdvance</span><span class="op" id="3510883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510887">return</span>&nbsp;<span class="builtintype" id="3510894">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510901">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510904">if</span>&nbsp;<span class="ident" id="3510907">n</span>&nbsp;<span class="op" id="3510909">&gt;</span>&nbsp;<span class="ident" id="3510911">s</span><span class="op" id="3510912">.</span><span class="ident" id="3510913">end</span><span class="op" id="3510916">-</span><span class="ident" id="3510917">s</span><span class="op" id="3510918">.</span><span class="ident" id="3510919">start</span>&nbsp;<span class="op" id="3510925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510929">s</span><span class="op" id="3510930">.</span><span class="ident" id="3510931">setErr</span><span class="op" id="3510937">(</span><span class="ident" id="3510938">ErrAdvanceTooFar</span><span class="op" id="3510954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510958">return</span>&nbsp;<span class="builtintype" id="3510965">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3510972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3510975">s</span><span class="op" id="3510976">.</span><span class="ident" id="3510977">start</span>&nbsp;<span class="op" id="3510983">+=</span>&nbsp;<span class="ident" id="3510986">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3510989">return</span>&nbsp;<span class="builtintype" id="3510996">true</span><br>
<span class="lineno"></span><span class="op" id="3511001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3511004">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="3511051">func</span>&nbsp;<span class="op" id="3511056">(</span><span class="ident" id="3511057">s</span>&nbsp;<span class="op" id="3511059">*</span><span class="ident" id="3511060">Scanner</span><span class="op" id="3511067">)</span>&nbsp;<span class="ident" id="3511069">setErr</span><span class="op" id="3511075">(</span><span class="ident" id="3511076">err</span>&nbsp;<span class="builtintype" id="3511080">error</span><span class="op" id="3511085">)</span>&nbsp;<span class="op" id="3511087">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511090">if</span>&nbsp;<span class="ident" id="3511093">s</span><span class="op" id="3511094">.</span><span class="ident" id="3511095">err</span>&nbsp;<span class="op" id="3511099">==</span>&nbsp;<span class="ident" id="3511102">nil</span>&nbsp;<span class="op" id="3511106">||</span>&nbsp;<span class="ident" id="3511109">s</span><span class="op" id="3511110">.</span><span class="ident" id="3511111">err</span>&nbsp;<span class="op" id="3511115">==</span>&nbsp;<span class="ident" id="3511118">io</span><span class="op" id="3511120">.</span><span class="ident" id="3511121">EOF</span>&nbsp;<span class="op" id="3511125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511129">s</span><span class="op" id="3511130">.</span><span class="ident" id="3511131">err</span>&nbsp;<span class="op" id="3511135">=</span>&nbsp;<span class="ident" id="3511137">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511142">}</span><br>
<span class="lineno"></span><span class="op" id="3511144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3511147">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3511219">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3511283">func</span>&nbsp;<span class="op" id="3511288">(</span><span class="ident" id="3511289">s</span>&nbsp;<span class="op" id="3511291">*</span><span class="ident" id="3511292">Scanner</span><span class="op" id="3511299">)</span>&nbsp;<span class="ident" id="3511301">Split</span><span class="op" id="3511306">(</span><span class="ident" id="3511307">split</span>&nbsp;<span class="ident" id="3511313">SplitFunc</span><span class="op" id="3511322">)</span>&nbsp;<span class="op" id="3511324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3511327">s</span><span class="op" id="3511328">.</span><span class="ident" id="3511329">split</span>&nbsp;<span class="op" id="3511335">=</span>&nbsp;<span class="ident" id="3511337">split</span><br>
<span class="lineno"></span><span class="op" id="3511343">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3511346">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3511366">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3511448">func</span>&nbsp;<span class="ident" id="3511453">ScanBytes</span><span class="op" id="3511462">(</span><span class="ident" id="3511463">data</span>&nbsp;<span class="op" id="3511468">[</span><span class="op" id="3511469">]</span><span class="builtintype" id="3511470">byte</span><span class="op" id="3511474">,</span>&nbsp;<span class="ident" id="3511476">atEOF</span>&nbsp;<span class="builtintype" id="3511482">bool</span><span class="op" id="3511486">)</span>&nbsp;<span class="op" id="3511488">(</span><span class="ident" id="3511489">advance</span>&nbsp;<span class="builtintype" id="3511497">int</span><span class="op" id="3511500">,</span>&nbsp;<span class="ident" id="3511502">token</span>&nbsp;<span class="op" id="3511508">[</span><span class="op" id="3511509">]</span><span class="builtintype" id="3511510">byte</span><span class="op" id="3511514">,</span>&nbsp;<span class="ident" id="3511516">err</span>&nbsp;<span class="builtintype" id="3511520">error</span><span class="op" id="3511525">)</span>&nbsp;<span class="op" id="3511527">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511530">if</span>&nbsp;<span class="ident" id="3511533">atEOF</span>&nbsp;<span class="op" id="3511539">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3511542">len</span><span class="op" id="3511545">(</span><span class="ident" id="3511546">data</span><span class="op" id="3511550">)</span>&nbsp;<span class="op" id="3511552">==</span>&nbsp;<span class="num" id="3511555">0</span>&nbsp;<span class="op" id="3511557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511561">return</span>&nbsp;<span class="num" id="3511568">0</span><span class="op" id="3511569">,</span>&nbsp;<span class="ident" id="3511571">nil</span><span class="op" id="3511574">,</span>&nbsp;<span class="ident" id="3511576">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3511581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3511584">return</span>&nbsp;<span class="num" id="3511591">1</span><span class="op" id="3511592">,</span>&nbsp;<span class="ident" id="3511594">data</span><span class="op" id="3511598">[</span><span class="num" id="3511599">0</span><span class="op" id="3511600">:</span><span class="num" id="3511601">1</span><span class="op" id="3511602">]</span><span class="op" id="3511603">,</span>&nbsp;<span class="ident" id="3511605">nil</span><br>
<span class="lineno"></span><span class="op" id="3511609">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="3511612">var</span>&nbsp;<span class="ident" id="3511616">errorRune</span>&nbsp;<span class="op" id="3511626">=</span>&nbsp;<span class="op" id="3511628">[</span><span class="op" id="3511629">]</span><span class="builtintype" id="3511630">byte</span><span class="op" id="3511634">(</span><span class="builtintype" id="3511635">string</span><span class="op" id="3511641">(</span><span class="ident" id="3511642">utf8</span><span class="op" id="3511646">.</span><span class="ident" id="3511647">RuneError</span><span class="op" id="3511656">)</span><span class="op" id="3511657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3511660">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3511725">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="3511793">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3511867">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3511945">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3512022">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3512095">func</span>&nbsp;<span class="ident" id="3512100">ScanRunes</span><span class="op" id="3512109">(</span><span class="ident" id="3512110">data</span>&nbsp;<span class="op" id="3512115">[</span><span class="op" id="3512116">]</span><span class="builtintype" id="3512117">byte</span><span class="op" id="3512121">,</span>&nbsp;<span class="ident" id="3512123">atEOF</span>&nbsp;<span class="builtintype" id="3512129">bool</span><span class="op" id="3512133">)</span>&nbsp;<span class="op" id="3512135">(</span><span class="ident" id="3512136">advance</span>&nbsp;<span class="builtintype" id="3512144">int</span><span class="op" id="3512147">,</span>&nbsp;<span class="ident" id="3512149">token</span>&nbsp;<span class="op" id="3512155">[</span><span class="op" id="3512156">]</span><span class="builtintype" id="3512157">byte</span><span class="op" id="3512161">,</span>&nbsp;<span class="ident" id="3512163">err</span>&nbsp;<span class="builtintype" id="3512167">error</span><span class="op" id="3512172">)</span>&nbsp;<span class="op" id="3512174">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512177">if</span>&nbsp;<span class="ident" id="3512180">atEOF</span>&nbsp;<span class="op" id="3512186">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3512189">len</span><span class="op" id="3512192">(</span><span class="ident" id="3512193">data</span><span class="op" id="3512197">)</span>&nbsp;<span class="op" id="3512199">==</span>&nbsp;<span class="num" id="3512202">0</span>&nbsp;<span class="op" id="3512204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512208">return</span>&nbsp;<span class="num" id="3512215">0</span><span class="op" id="3512216">,</span>&nbsp;<span class="ident" id="3512218">nil</span><span class="op" id="3512221">,</span>&nbsp;<span class="ident" id="3512223">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3512228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512232">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512256">if</span>&nbsp;<span class="ident" id="3512259">data</span><span class="op" id="3512263">[</span><span class="num" id="3512264">0</span><span class="op" id="3512265">]</span>&nbsp;<span class="op" id="3512267">&lt;</span>&nbsp;<span class="ident" id="3512269">utf8</span><span class="op" id="3512273">.</span><span class="ident" id="3512274">RuneSelf</span>&nbsp;<span class="op" id="3512283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512287">return</span>&nbsp;<span class="num" id="3512294">1</span><span class="op" id="3512295">,</span>&nbsp;<span class="ident" id="3512297">data</span><span class="op" id="3512301">[</span><span class="num" id="3512302">0</span><span class="op" id="3512303">:</span><span class="num" id="3512304">1</span><span class="op" id="3512305">]</span><span class="op" id="3512306">,</span>&nbsp;<span class="ident" id="3512308">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3512313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512317">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3512370">_</span><span class="op" id="3512371">,</span>&nbsp;<span class="ident" id="3512373">width</span>&nbsp;<span class="op" id="3512379">:=</span>&nbsp;<span class="ident" id="3512382">utf8</span><span class="op" id="3512386">.</span><span class="ident" id="3512387">DecodeRune</span><span class="op" id="3512397">(</span><span class="ident" id="3512398">data</span><span class="op" id="3512402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512405">if</span>&nbsp;<span class="ident" id="3512408">width</span>&nbsp;<span class="op" id="3512414">&gt;</span>&nbsp;<span class="num" id="3512416">1</span>&nbsp;<span class="op" id="3512418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512422">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512494">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512515">return</span>&nbsp;<span class="ident" id="3512522">width</span><span class="op" id="3512527">,</span>&nbsp;<span class="ident" id="3512529">data</span><span class="op" id="3512533">[</span><span class="num" id="3512534">0</span><span class="op" id="3512535">:</span><span class="ident" id="3512536">width</span><span class="op" id="3512541">]</span><span class="op" id="3512542">,</span>&nbsp;<span class="ident" id="3512544">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3512549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512553">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512631">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512696">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512777">if</span>&nbsp;<span class="op" id="3512780">!</span><span class="ident" id="3512781">atEOF</span>&nbsp;<span class="op" id="3512787">&amp;&amp;</span>&nbsp;<span class="op" id="3512790">!</span><span class="ident" id="3512791">utf8</span><span class="op" id="3512795">.</span><span class="ident" id="3512796">FullRune</span><span class="op" id="3512804">(</span><span class="ident" id="3512805">data</span><span class="op" id="3512809">)</span>&nbsp;<span class="op" id="3512811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512815">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3512848">return</span>&nbsp;<span class="num" id="3512855">0</span><span class="op" id="3512856">,</span>&nbsp;<span class="ident" id="3512858">nil</span><span class="op" id="3512861">,</span>&nbsp;<span class="ident" id="3512863">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3512868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512872">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3512950">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513028">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513063">return</span>&nbsp;<span class="num" id="3513070">1</span><span class="op" id="3513071">,</span>&nbsp;<span class="ident" id="3513073">errorRune</span><span class="op" id="3513082">,</span>&nbsp;<span class="ident" id="3513084">nil</span><br>
<span class="lineno"></span><span class="op" id="3513088">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="3513091">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3513136">func</span>&nbsp;<span class="ident" id="3513141">dropCR</span><span class="op" id="3513147">(</span><span class="ident" id="3513148">data</span>&nbsp;<span class="op" id="3513153">[</span><span class="op" id="3513154">]</span><span class="builtintype" id="3513155">byte</span><span class="op" id="3513159">)</span>&nbsp;<span class="op" id="3513161">[</span><span class="op" id="3513162">]</span><span class="builtintype" id="3513163">byte</span>&nbsp;<span class="op" id="3513168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513171">if</span>&nbsp;<span class="builtinfunc" id="3513174">len</span><span class="op" id="3513177">(</span><span class="ident" id="3513178">data</span><span class="op" id="3513182">)</span>&nbsp;<span class="op" id="3513184">&gt;</span>&nbsp;<span class="num" id="3513186">0</span>&nbsp;<span class="op" id="3513188">&amp;&amp;</span>&nbsp;<span class="ident" id="3513191">data</span><span class="op" id="3513195">[</span><span class="builtinfunc" id="3513196">len</span><span class="op" id="3513199">(</span><span class="ident" id="3513200">data</span><span class="op" id="3513204">)</span><span class="op" id="3513205">-</span><span class="num" id="3513206">1</span><span class="op" id="3513207">]</span>&nbsp;<span class="op" id="3513209">==</span>&nbsp;<span class="string" id="3513212">&#39;\r&#39;</span>&nbsp;<span class="op" id="3513217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513221">return</span>&nbsp;<span class="ident" id="3513228">data</span><span class="op" id="3513232">[</span><span class="num" id="3513233">0</span>&nbsp;<span class="op" id="3513235">:</span>&nbsp;<span class="builtinfunc" id="3513237">len</span><span class="op" id="3513240">(</span><span class="ident" id="3513241">data</span><span class="op" id="3513245">)</span><span class="op" id="3513246">-</span><span class="num" id="3513247">1</span><span class="op" id="3513248">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513254">return</span>&nbsp;<span class="ident" id="3513261">data</span><br>
<span class="lineno"></span><span class="op" id="3513266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3513269">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="3513342">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="3513418">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="3513495">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="3513571">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3513642">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="3513654">func</span>&nbsp;<span class="ident" id="3513659">ScanLines</span><span class="op" id="3513668">(</span><span class="ident" id="3513669">data</span>&nbsp;<span class="op" id="3513674">[</span><span class="op" id="3513675">]</span><span class="builtintype" id="3513676">byte</span><span class="op" id="3513680">,</span>&nbsp;<span class="ident" id="3513682">atEOF</span>&nbsp;<span class="builtintype" id="3513688">bool</span><span class="op" id="3513692">)</span>&nbsp;<span class="op" id="3513694">(</span><span class="ident" id="3513695">advance</span>&nbsp;<span class="builtintype" id="3513703">int</span><span class="op" id="3513706">,</span>&nbsp;<span class="ident" id="3513708">token</span>&nbsp;<span class="op" id="3513714">[</span><span class="op" id="3513715">]</span><span class="builtintype" id="3513716">byte</span><span class="op" id="3513720">,</span>&nbsp;<span class="ident" id="3513722">err</span>&nbsp;<span class="builtintype" id="3513726">error</span><span class="op" id="3513731">)</span>&nbsp;<span class="op" id="3513733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513736">if</span>&nbsp;<span class="ident" id="3513739">atEOF</span>&nbsp;<span class="op" id="3513745">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3513748">len</span><span class="op" id="3513751">(</span><span class="ident" id="3513752">data</span><span class="op" id="3513756">)</span>&nbsp;<span class="op" id="3513758">==</span>&nbsp;<span class="num" id="3513761">0</span>&nbsp;<span class="op" id="3513763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513767">return</span>&nbsp;<span class="num" id="3513774">0</span><span class="op" id="3513775">,</span>&nbsp;<span class="ident" id="3513777">nil</span><span class="op" id="3513780">,</span>&nbsp;<span class="ident" id="3513782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513790">if</span>&nbsp;<span class="ident" id="3513793">i</span>&nbsp;<span class="op" id="3513795">:=</span>&nbsp;<span class="ident" id="3513798">bytes</span><span class="op" id="3513803">.</span><span class="ident" id="3513804">IndexByte</span><span class="op" id="3513813">(</span><span class="ident" id="3513814">data</span><span class="op" id="3513818">,</span>&nbsp;<span class="string" id="3513820">&#39;\n&#39;</span><span class="op" id="3513824">)</span><span class="op" id="3513825">;</span>&nbsp;<span class="ident" id="3513827">i</span>&nbsp;<span class="op" id="3513829">&gt;=</span>&nbsp;<span class="num" id="3513832">0</span>&nbsp;<span class="op" id="3513834">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513838">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513883">return</span>&nbsp;<span class="ident" id="3513890">i</span>&nbsp;<span class="op" id="3513892">+</span>&nbsp;<span class="num" id="3513894">1</span><span class="op" id="3513895">,</span>&nbsp;<span class="ident" id="3513897">dropCR</span><span class="op" id="3513903">(</span><span class="ident" id="3513904">data</span><span class="op" id="3513908">[</span><span class="num" id="3513909">0</span><span class="op" id="3513910">:</span><span class="ident" id="3513911">i</span><span class="op" id="3513912">]</span><span class="op" id="3513913">)</span><span class="op" id="3513914">,</span>&nbsp;<span class="ident" id="3513916">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3513921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3513924">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3513994">if</span>&nbsp;<span class="ident" id="3513997">atEOF</span>&nbsp;<span class="op" id="3514003">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514007">return</span>&nbsp;<span class="builtinfunc" id="3514014">len</span><span class="op" id="3514017">(</span><span class="ident" id="3514018">data</span><span class="op" id="3514022">)</span><span class="op" id="3514023">,</span>&nbsp;<span class="ident" id="3514025">dropCR</span><span class="op" id="3514031">(</span><span class="ident" id="3514032">data</span><span class="op" id="3514036">)</span><span class="op" id="3514037">,</span>&nbsp;<span class="ident" id="3514039">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3514047">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514070">return</span>&nbsp;<span class="num" id="3514077">0</span><span class="op" id="3514078">,</span>&nbsp;<span class="ident" id="3514080">nil</span><span class="op" id="3514083">,</span>&nbsp;<span class="ident" id="3514085">nil</span><br>
<span class="lineno"></span><span class="op" id="3514089">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="3514092">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3514169">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3514257">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="3514274">func</span>&nbsp;<span class="ident" id="3514279">isSpace</span><span class="op" id="3514286">(</span><span class="ident" id="3514287">r</span>&nbsp;<span class="builtintype" id="3514289">rune</span><span class="op" id="3514293">)</span>&nbsp;<span class="builtintype" id="3514295">bool</span>&nbsp;<span class="op" id="3514300">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514303">if</span>&nbsp;<span class="ident" id="3514306">r</span>&nbsp;<span class="op" id="3514308">&lt;=</span>&nbsp;<span class="string" id="3514311">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="3514320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3514324">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514402">switch</span>&nbsp;<span class="ident" id="3514409">r</span>&nbsp;<span class="op" id="3514411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514415">case</span>&nbsp;<span class="string" id="3514420">&#39;&nbsp;&#39;</span><span class="op" id="3514423">,</span>&nbsp;<span class="string" id="3514425">&#39;\t&#39;</span><span class="op" id="3514429">,</span>&nbsp;<span class="string" id="3514431">&#39;\n&#39;</span><span class="op" id="3514435">,</span>&nbsp;<span class="string" id="3514437">&#39;\v&#39;</span><span class="op" id="3514441">,</span>&nbsp;<span class="string" id="3514443">&#39;\f&#39;</span><span class="op" id="3514447">,</span>&nbsp;<span class="string" id="3514449">&#39;\r&#39;</span><span class="op" id="3514453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514458">return</span>&nbsp;<span class="builtintype" id="3514465">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514472">case</span>&nbsp;<span class="string" id="3514477">&#39;\u0085&#39;</span><span class="op" id="3514485">,</span>&nbsp;<span class="string" id="3514487">&#39;\u00A0&#39;</span><span class="op" id="3514495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514500">return</span>&nbsp;<span class="builtintype" id="3514507">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514518">return</span>&nbsp;<span class="builtintype" id="3514525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514532">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3514535">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514557">if</span>&nbsp;<span class="string" id="3514560">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="3514569">&lt;=</span>&nbsp;<span class="ident" id="3514572">r</span>&nbsp;<span class="op" id="3514574">&amp;&amp;</span>&nbsp;<span class="ident" id="3514577">r</span>&nbsp;<span class="op" id="3514579">&lt;=</span>&nbsp;<span class="string" id="3514582">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="3514591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514595">return</span>&nbsp;<span class="builtintype" id="3514602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514611">switch</span>&nbsp;<span class="ident" id="3514618">r</span>&nbsp;<span class="op" id="3514620">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514623">case</span>&nbsp;<span class="string" id="3514628">&#39;\u1680&#39;</span><span class="op" id="3514636">,</span>&nbsp;<span class="string" id="3514638">&#39;\u2028&#39;</span><span class="op" id="3514646">,</span>&nbsp;<span class="string" id="3514648">&#39;\u2029&#39;</span><span class="op" id="3514656">,</span>&nbsp;<span class="string" id="3514658">&#39;\u202f&#39;</span><span class="op" id="3514666">,</span>&nbsp;<span class="string" id="3514668">&#39;\u205f&#39;</span><span class="op" id="3514676">,</span>&nbsp;<span class="string" id="3514678">&#39;\u3000&#39;</span><span class="op" id="3514686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514690">return</span>&nbsp;<span class="builtintype" id="3514697">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3514703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3514706">return</span>&nbsp;<span class="builtintype" id="3514713">false</span><br>
<span class="lineno"></span><span class="op" id="3514719">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3514722">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3514787">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3514861">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3514928">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="3514948">func</span>&nbsp;<span class="ident" id="3514953">ScanWords</span><span class="op" id="3514962">(</span><span class="ident" id="3514963">data</span>&nbsp;<span class="op" id="3514968">[</span><span class="op" id="3514969">]</span><span class="builtintype" id="3514970">byte</span><span class="op" id="3514974">,</span>&nbsp;<span class="ident" id="3514976">atEOF</span>&nbsp;<span class="builtintype" id="3514982">bool</span><span class="op" id="3514986">)</span>&nbsp;<span class="op" id="3514988">(</span><span class="ident" id="3514989">advance</span>&nbsp;<span class="builtintype" id="3514997">int</span><span class="op" id="3515000">,</span>&nbsp;<span class="ident" id="3515002">token</span>&nbsp;<span class="op" id="3515008">[</span><span class="op" id="3515009">]</span><span class="builtintype" id="3515010">byte</span><span class="op" id="3515014">,</span>&nbsp;<span class="ident" id="3515016">err</span>&nbsp;<span class="builtintype" id="3515020">error</span><span class="op" id="3515025">)</span>&nbsp;<span class="op" id="3515027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3515030">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515055">start</span>&nbsp;<span class="op" id="3515061">:=</span>&nbsp;<span class="num" id="3515064">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515067">for</span>&nbsp;<span class="ident" id="3515071">width</span>&nbsp;<span class="op" id="3515077">:=</span>&nbsp;<span class="num" id="3515080">0</span><span class="op" id="3515081">;</span>&nbsp;<span class="ident" id="3515083">start</span>&nbsp;<span class="op" id="3515089">&lt;</span>&nbsp;<span class="builtinfunc" id="3515091">len</span><span class="op" id="3515094">(</span><span class="ident" id="3515095">data</span><span class="op" id="3515099">)</span><span class="op" id="3515100">;</span>&nbsp;<span class="ident" id="3515102">start</span>&nbsp;<span class="op" id="3515108">+=</span>&nbsp;<span class="ident" id="3515111">width</span>&nbsp;<span class="op" id="3515117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515121">var</span>&nbsp;<span class="ident" id="3515125">r</span>&nbsp;<span class="builtintype" id="3515127">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515134">r</span><span class="op" id="3515135">,</span>&nbsp;<span class="ident" id="3515137">width</span>&nbsp;<span class="op" id="3515143">=</span>&nbsp;<span class="ident" id="3515145">utf8</span><span class="op" id="3515149">.</span><span class="ident" id="3515150">DecodeRune</span><span class="op" id="3515160">(</span><span class="ident" id="3515161">data</span><span class="op" id="3515165">[</span><span class="ident" id="3515166">start</span><span class="op" id="3515171">:</span><span class="op" id="3515172">]</span><span class="op" id="3515173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515177">if</span>&nbsp;<span class="op" id="3515180">!</span><span class="ident" id="3515181">isSpace</span><span class="op" id="3515188">(</span><span class="ident" id="3515189">r</span><span class="op" id="3515190">)</span>&nbsp;<span class="op" id="3515192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515197">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515208">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3515211">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515254">for</span>&nbsp;<span class="ident" id="3515258">width</span><span class="op" id="3515263">,</span>&nbsp;<span class="ident" id="3515265">i</span>&nbsp;<span class="op" id="3515267">:=</span>&nbsp;<span class="num" id="3515270">0</span><span class="op" id="3515271">,</span>&nbsp;<span class="ident" id="3515273">start</span><span class="op" id="3515278">;</span>&nbsp;<span class="ident" id="3515280">i</span>&nbsp;<span class="op" id="3515282">&lt;</span>&nbsp;<span class="builtinfunc" id="3515284">len</span><span class="op" id="3515287">(</span><span class="ident" id="3515288">data</span><span class="op" id="3515292">)</span><span class="op" id="3515293">;</span>&nbsp;<span class="ident" id="3515295">i</span>&nbsp;<span class="op" id="3515297">+=</span>&nbsp;<span class="ident" id="3515300">width</span>&nbsp;<span class="op" id="3515306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515310">var</span>&nbsp;<span class="ident" id="3515314">r</span>&nbsp;<span class="builtintype" id="3515316">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3515323">r</span><span class="op" id="3515324">,</span>&nbsp;<span class="ident" id="3515326">width</span>&nbsp;<span class="op" id="3515332">=</span>&nbsp;<span class="ident" id="3515334">utf8</span><span class="op" id="3515338">.</span><span class="ident" id="3515339">DecodeRune</span><span class="op" id="3515349">(</span><span class="ident" id="3515350">data</span><span class="op" id="3515354">[</span><span class="ident" id="3515355">i</span><span class="op" id="3515356">:</span><span class="op" id="3515357">]</span><span class="op" id="3515358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515362">if</span>&nbsp;<span class="ident" id="3515365">isSpace</span><span class="op" id="3515372">(</span><span class="ident" id="3515373">r</span><span class="op" id="3515374">)</span>&nbsp;<span class="op" id="3515376">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515381">return</span>&nbsp;<span class="ident" id="3515388">i</span>&nbsp;<span class="op" id="3515390">+</span>&nbsp;<span class="ident" id="3515392">width</span><span class="op" id="3515397">,</span>&nbsp;<span class="ident" id="3515399">data</span><span class="op" id="3515403">[</span><span class="ident" id="3515404">start</span><span class="op" id="3515409">:</span><span class="ident" id="3515410">i</span><span class="op" id="3515411">]</span><span class="op" id="3515412">,</span>&nbsp;<span class="ident" id="3515414">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3515426">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515507">if</span>&nbsp;<span class="ident" id="3515510">atEOF</span>&nbsp;<span class="op" id="3515516">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3515519">len</span><span class="op" id="3515522">(</span><span class="ident" id="3515523">data</span><span class="op" id="3515527">)</span>&nbsp;<span class="op" id="3515529">&gt;</span>&nbsp;<span class="ident" id="3515531">start</span>&nbsp;<span class="op" id="3515537">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515541">return</span>&nbsp;<span class="builtinfunc" id="3515548">len</span><span class="op" id="3515551">(</span><span class="ident" id="3515552">data</span><span class="op" id="3515556">)</span><span class="op" id="3515557">,</span>&nbsp;<span class="ident" id="3515559">data</span><span class="op" id="3515563">[</span><span class="ident" id="3515564">start</span><span class="op" id="3515569">:</span><span class="op" id="3515570">]</span><span class="op" id="3515571">,</span>&nbsp;<span class="ident" id="3515573">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3515578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3515581">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3515604">return</span>&nbsp;<span class="ident" id="3515611">start</span><span class="op" id="3515616">,</span>&nbsp;<span class="ident" id="3515618">nil</span><span class="op" id="3515621">,</span>&nbsp;<span class="ident" id="3515623">nil</span><br>
<span class="lineno"></span><span class="op" id="3515627">}</span>
</div>
</body>
</html>
