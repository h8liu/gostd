<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html" class="current">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2024341">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2024396">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2024450">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2024501">//&nbsp;Package&nbsp;dsa&nbsp;implements&nbsp;the&nbsp;Digital&nbsp;Signature&nbsp;Algorithm,&nbsp;as&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="2024586">package</span>&nbsp;<span class="ident" id="2024594">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2024599">import</span>&nbsp;<span class="op" id="2024606">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2024609">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2024619">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2024625">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="2024636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2024639">//&nbsp;Parameters&nbsp;represents&nbsp;the&nbsp;domain&nbsp;parameters&nbsp;for&nbsp;a&nbsp;key.&nbsp;These&nbsp;parameters&nbsp;can</span><br>
<span class="lineno">15</span><span class="comment" id="2024718">//&nbsp;be&nbsp;shared&nbsp;across&nbsp;many&nbsp;keys.&nbsp;The&nbsp;bit&nbsp;length&nbsp;of&nbsp;Q&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8.</span><br>
<span class="lineno"></span><span class="keyword" id="2024794">type</span>&nbsp;<span class="ident" id="2024799">Parameters</span>&nbsp;<span class="keyword" id="2024810">struct</span>&nbsp;<span class="op" id="2024817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024820">P</span><span class="op" id="2024821">,</span>&nbsp;<span class="ident" id="2024823">Q</span><span class="op" id="2024824">,</span>&nbsp;<span class="ident" id="2024826">G</span>&nbsp;<span class="op" id="2024828">*</span><span class="ident" id="2024829"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2024832">.</span><span class="ident" id="2024833"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><span class="op" id="2024837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2024840">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;DSA&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="2024882">type</span>&nbsp;<span class="ident" id="2024887">PublicKey</span>&nbsp;<span class="keyword" id="2024897">struct</span>&nbsp;<span class="op" id="2024904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024907"><a href="/gostd/crypto/dsa/dsa.go.html#2024799">Parameters</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2024919">Y</span>&nbsp;<span class="op" id="2024921">*</span><span class="ident" id="2024922"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2024925">.</span><span class="ident" id="2024926"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span><span class="op" id="2024930">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2024933">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;DSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="2024977">type</span>&nbsp;<span class="ident" id="2024982">PrivateKey</span>&nbsp;<span class="keyword" id="2024993">struct</span>&nbsp;<span class="op" id="2025000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025003"><a href="/gostd/crypto/dsa/dsa.go.html#2024887">PublicKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025014">X</span>&nbsp;<span class="op" id="2025016">*</span><span class="ident" id="2025017"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2025020">.</span><span class="ident" id="2025021"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno">30</span><span class="op" id="2025025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025028">//&nbsp;ErrInvalidPublicKey&nbsp;results&nbsp;when&nbsp;a&nbsp;public&nbsp;key&nbsp;is&nbsp;not&nbsp;usable&nbsp;by&nbsp;this&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="2025105">//&nbsp;FIPS&nbsp;is&nbsp;quite&nbsp;strict&nbsp;about&nbsp;the&nbsp;format&nbsp;of&nbsp;DSA&nbsp;keys,&nbsp;but&nbsp;other&nbsp;code&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2025181">//&nbsp;less&nbsp;so.&nbsp;Thus,&nbsp;when&nbsp;using&nbsp;keys&nbsp;which&nbsp;may&nbsp;have&nbsp;been&nbsp;generated&nbsp;by&nbsp;other&nbsp;code,</span><br>
<span class="lineno">35</span><span class="comment" id="2025260">//&nbsp;this&nbsp;error&nbsp;must&nbsp;be&nbsp;handled.</span><br>
<span class="lineno"></span><span class="keyword" id="2025291">var</span>&nbsp;<span class="ident" id="2025295">ErrInvalidPublicKey</span>&nbsp;<span class="op" id="2025315">=</span>&nbsp;<span class="ident" id="2025317"><a href="/gostd/crypto/dsa/dsa.go.html#2024609">errors</a></span><span class="op" id="2025323">.</span><span class="ident" id="2025324"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="2025327">(</span><span class="string" id="2025328">&#34;crypto/dsa:&nbsp;invalid&nbsp;public&nbsp;key&#34;</span><span class="op" id="2025360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025363">//&nbsp;ParameterSizes&nbsp;is&nbsp;a&nbsp;enumeration&nbsp;of&nbsp;the&nbsp;acceptable&nbsp;bit&nbsp;lengths&nbsp;of&nbsp;the&nbsp;primes</span><br>
<span class="lineno"></span><span class="comment" id="2025442">//&nbsp;in&nbsp;a&nbsp;set&nbsp;of&nbsp;DSA&nbsp;parameters.&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno">40</span><span class="keyword" id="2025502">type</span>&nbsp;<span class="ident" id="2025507">ParameterSizes</span>&nbsp;<span class="builtintype" id="2025522">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2025527">const</span>&nbsp;<span class="op" id="2025533">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025536">L1024N160</span>&nbsp;<span class="ident" id="2025546"><a href="/gostd/crypto/dsa/dsa.go.html#2025507">ParameterSizes</a></span>&nbsp;<span class="op" id="2025561">=</span>&nbsp;<span class="ident" id="2025563">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025569">L2048N224</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025580">L2048N256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2025591">L3072N256</span><br>
<span class="lineno"></span><span class="op" id="2025601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025604">//&nbsp;numMRTests&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;Miller-Rabin&nbsp;primality&nbsp;tests&nbsp;that&nbsp;we&nbsp;perform.&nbsp;We</span><br>
<span class="lineno">50</span><span class="comment" id="2025684">//&nbsp;pick&nbsp;the&nbsp;largest&nbsp;recommended&nbsp;number&nbsp;from&nbsp;table&nbsp;C.1&nbsp;of&nbsp;FIPS&nbsp;186-3.</span><br>
<span class="lineno"></span><span class="keyword" id="2025753">const</span>&nbsp;<span class="ident" id="2025759">numMRTests</span>&nbsp;<span class="op" id="2025770">=</span>&nbsp;<span class="num" id="2025772">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2025776">//&nbsp;GenerateParameters&nbsp;puts&nbsp;a&nbsp;random,&nbsp;valid&nbsp;set&nbsp;of&nbsp;DSA&nbsp;parameters&nbsp;into&nbsp;params.</span><br>
<span class="lineno"></span><span class="comment" id="2025854">//&nbsp;This&nbsp;function&nbsp;takes&nbsp;many&nbsp;seconds,&nbsp;even&nbsp;on&nbsp;fast&nbsp;machines.</span><br>
<span class="lineno">55</span><span class="keyword" id="2025914">func</span>&nbsp;<span class="ident" id="2025919">GenerateParameters</span><span class="op" id="2025937">(</span><span class="ident" id="2025938">params</span>&nbsp;<span class="op" id="2025945">*</span><span class="ident" id="2025946"><a href="/gostd/crypto/dsa/dsa.go.html#2024799">Parameters</a></span><span class="op" id="2025956">,</span>&nbsp;<span class="ident" id="2025958">rand</span>&nbsp;<span class="ident" id="2025963"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2025965">.</span><span class="ident" id="2025966"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="2025972">,</span>&nbsp;<span class="ident" id="2025974">sizes</span>&nbsp;<span class="ident" id="2025980"><a href="/gostd/crypto/dsa/dsa.go.html#2025507">ParameterSizes</a></span><span class="op" id="2025994">)</span>&nbsp;<span class="op" id="2025996">(</span><span class="ident" id="2025997">err</span>&nbsp;<span class="builtintype" id="2026001">error</span><span class="op" id="2026006">)</span>&nbsp;<span class="op" id="2026008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2026011">//&nbsp;This&nbsp;function&nbsp;doesn&#39;t&nbsp;follow&nbsp;FIPS&nbsp;186-3&nbsp;exactly&nbsp;in&nbsp;that&nbsp;it&nbsp;doesn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2026082">//&nbsp;use&nbsp;a&nbsp;verification&nbsp;seed&nbsp;to&nbsp;generate&nbsp;the&nbsp;primes.&nbsp;The&nbsp;verification</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2026151">//&nbsp;seed&nbsp;doesn&#39;t&nbsp;appear&nbsp;to&nbsp;be&nbsp;exported&nbsp;or&nbsp;used&nbsp;by&nbsp;other&nbsp;code&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2026216">//&nbsp;omitting&nbsp;it&nbsp;makes&nbsp;the&nbsp;code&nbsp;cleaner.</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026257">var</span>&nbsp;<span class="ident" id="2026261">L</span><span class="op" id="2026262">,</span>&nbsp;<span class="ident" id="2026264">N</span>&nbsp;<span class="builtintype" id="2026266">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026271">switch</span>&nbsp;<span class="ident" id="2026278"><a href="/gostd/crypto/dsa/dsa.go.html#2025974">sizes</a></span>&nbsp;<span class="op" id="2026284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026287">case</span>&nbsp;<span class="ident" id="2026292"><a href="/gostd/crypto/dsa/dsa.go.html#2025536">L1024N160</a></span><span class="op" id="2026301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026305"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span>&nbsp;<span class="op" id="2026307">=</span>&nbsp;<span class="num" id="2026309">1024</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026316"><a href="/gostd/crypto/dsa/dsa.go.html#2026264">N</a></span>&nbsp;<span class="op" id="2026318">=</span>&nbsp;<span class="num" id="2026320">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026325">case</span>&nbsp;<span class="ident" id="2026330"><a href="/gostd/crypto/dsa/dsa.go.html#2025569">L2048N224</a></span><span class="op" id="2026339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026343"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span>&nbsp;<span class="op" id="2026345">=</span>&nbsp;<span class="num" id="2026347">2048</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026354"><a href="/gostd/crypto/dsa/dsa.go.html#2026264">N</a></span>&nbsp;<span class="op" id="2026356">=</span>&nbsp;<span class="num" id="2026358">224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026363">case</span>&nbsp;<span class="ident" id="2026368"><a href="/gostd/crypto/dsa/dsa.go.html#2025580">L2048N256</a></span><span class="op" id="2026377">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026381"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span>&nbsp;<span class="op" id="2026383">=</span>&nbsp;<span class="num" id="2026385">2048</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026392"><a href="/gostd/crypto/dsa/dsa.go.html#2026264">N</a></span>&nbsp;<span class="op" id="2026394">=</span>&nbsp;<span class="num" id="2026396">256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026401">case</span>&nbsp;<span class="ident" id="2026406"><a href="/gostd/crypto/dsa/dsa.go.html#2025591">L3072N256</a></span><span class="op" id="2026415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026419"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span>&nbsp;<span class="op" id="2026421">=</span>&nbsp;<span class="num" id="2026423">3072</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026430"><a href="/gostd/crypto/dsa/dsa.go.html#2026264">N</a></span>&nbsp;<span class="op" id="2026432">=</span>&nbsp;<span class="num" id="2026434">256</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026439">default</span><span class="op" id="2026446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026450">return</span>&nbsp;<span class="ident" id="2026457"><a href="/gostd/crypto/dsa/dsa.go.html#2024609">errors</a></span><span class="op" id="2026463">.</span><span class="ident" id="2026464"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="2026467">(</span><span class="string" id="2026468">&#34;crypto/dsa:&nbsp;invalid&nbsp;ParameterSizes&#34;</span><span class="op" id="2026504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026511">qBytes</span>&nbsp;<span class="op" id="2026518">:=</span>&nbsp;<span class="builtinfunc" id="2026521">make</span><span class="op" id="2026525">(</span><span class="op" id="2026526">[</span><span class="op" id="2026527">]</span><span class="builtintype" id="2026528">byte</span><span class="op" id="2026532">,</span>&nbsp;<span class="ident" id="2026534"><a href="/gostd/crypto/dsa/dsa.go.html#2026264">N</a></span><span class="op" id="2026535">/</span><span class="num" id="2026536">8</span><span class="op" id="2026537">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026540">pBytes</span>&nbsp;<span class="op" id="2026547">:=</span>&nbsp;<span class="builtinfunc" id="2026550">make</span><span class="op" id="2026554">(</span><span class="op" id="2026555">[</span><span class="op" id="2026556">]</span><span class="builtintype" id="2026557">byte</span><span class="op" id="2026561">,</span>&nbsp;<span class="ident" id="2026563"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span><span class="op" id="2026564">/</span><span class="num" id="2026565">8</span><span class="op" id="2026566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026570">q</span>&nbsp;<span class="op" id="2026572">:=</span>&nbsp;<span class="builtinfunc" id="2026575">new</span><span class="op" id="2026578">(</span><span class="ident" id="2026579"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2026582">.</span><span class="ident" id="2026583"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2026586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026589">p</span>&nbsp;<span class="op" id="2026591">:=</span>&nbsp;<span class="builtinfunc" id="2026594">new</span><span class="op" id="2026597">(</span><span class="ident" id="2026598"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2026601">.</span><span class="ident" id="2026602"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2026605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026608">rem</span>&nbsp;<span class="op" id="2026612">:=</span>&nbsp;<span class="builtinfunc" id="2026615">new</span><span class="op" id="2026618">(</span><span class="ident" id="2026619"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2026622">.</span><span class="ident" id="2026623"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2026626">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026629">one</span>&nbsp;<span class="op" id="2026633">:=</span>&nbsp;<span class="builtinfunc" id="2026636">new</span><span class="op" id="2026639">(</span><span class="ident" id="2026640"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2026643">.</span><span class="ident" id="2026644"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2026647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026650"><a href="/gostd/crypto/dsa/dsa.go.html#2026629">one</a></span><span class="op" id="2026653">.</span><span class="ident" id="2026654"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="2026662">(</span><span class="num" id="2026663">1</span><span class="op" id="2026664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2026667">GeneratePrimes</span><span class="op" id="2026681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026684">for</span>&nbsp;<span class="op" id="2026688">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026692">_</span><span class="op" id="2026693">,</span>&nbsp;<span class="ident" id="2026695"><a href="/gostd/crypto/dsa/dsa.go.html#2025997">err</a></span>&nbsp;<span class="op" id="2026699">=</span>&nbsp;<span class="ident" id="2026701"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2026703">.</span><span class="ident" id="2026704"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="2026712">(</span><span class="ident" id="2026713"><a href="/gostd/crypto/dsa/dsa.go.html#2025958">rand</a></span><span class="op" id="2026717">,</span>&nbsp;<span class="ident" id="2026719"><a href="/gostd/crypto/dsa/dsa.go.html#2026511">qBytes</a></span><span class="op" id="2026725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026729">if</span>&nbsp;<span class="ident" id="2026732"><a href="/gostd/crypto/dsa/dsa.go.html#2025997">err</a></span>&nbsp;<span class="op" id="2026736">!=</span>&nbsp;<span class="builtintype" id="2026739">nil</span>&nbsp;<span class="op" id="2026743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026748">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026762"><a href="/gostd/crypto/dsa/dsa.go.html#2026511">qBytes</a></span><span class="op" id="2026768">[</span><span class="builtinfunc" id="2026769">len</span><span class="op" id="2026772">(</span><span class="ident" id="2026773"><a href="/gostd/crypto/dsa/dsa.go.html#2026511">qBytes</a></span><span class="op" id="2026779">)</span><span class="op" id="2026780">-</span><span class="num" id="2026781">1</span><span class="op" id="2026782">]</span>&nbsp;<span class="op" id="2026784">|=</span>&nbsp;<span class="num" id="2026787">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026791"><a href="/gostd/crypto/dsa/dsa.go.html#2026511">qBytes</a></span><span class="op" id="2026797">[</span><span class="num" id="2026798">0</span><span class="op" id="2026799">]</span>&nbsp;<span class="op" id="2026801">|=</span>&nbsp;<span class="num" id="2026804">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026811"><a href="/gostd/crypto/dsa/dsa.go.html#2026570">q</a></span><span class="op" id="2026812">.</span><span class="ident" id="2026813"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="2026821">(</span><span class="ident" id="2026822"><a href="/gostd/crypto/dsa/dsa.go.html#2026511">qBytes</a></span><span class="op" id="2026828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026833">if</span>&nbsp;<span class="op" id="2026836">!</span><span class="ident" id="2026837"><a href="/gostd/crypto/dsa/dsa.go.html#2026570">q</a></span><span class="op" id="2026838">.</span><span class="ident" id="2026839"><a href="/gostd/math/big/int.go.html#2053360">ProbablyPrime</a></span><span class="op" id="2026852">(</span><span class="ident" id="2026853"><a href="/gostd/crypto/dsa/dsa.go.html#2025759">numMRTests</a></span><span class="op" id="2026863">)</span>&nbsp;<span class="op" id="2026865">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026886">for</span>&nbsp;<span class="ident" id="2026890">i</span>&nbsp;<span class="op" id="2026892">:=</span>&nbsp;<span class="num" id="2026895">0</span><span class="op" id="2026896">;</span>&nbsp;<span class="ident" id="2026898"><a href="/gostd/crypto/dsa/dsa.go.html#2026890">i</a></span>&nbsp;<span class="op" id="2026900">&lt;</span>&nbsp;<span class="num" id="2026902">4</span><span class="op" id="2026903">*</span><span class="ident" id="2026904"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span><span class="op" id="2026905">;</span>&nbsp;<span class="ident" id="2026907"><a href="/gostd/crypto/dsa/dsa.go.html#2026890">i</a></span><span class="op" id="2026908">++</span>&nbsp;<span class="op" id="2026911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026916">_</span><span class="op" id="2026917">,</span>&nbsp;<span class="ident" id="2026919"><a href="/gostd/crypto/dsa/dsa.go.html#2025997">err</a></span>&nbsp;<span class="op" id="2026923">=</span>&nbsp;<span class="ident" id="2026925"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2026927">.</span><span class="ident" id="2026928"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="2026936">(</span><span class="ident" id="2026937"><a href="/gostd/crypto/dsa/dsa.go.html#2025958">rand</a></span><span class="op" id="2026941">,</span>&nbsp;<span class="ident" id="2026943"><a href="/gostd/crypto/dsa/dsa.go.html#2026540">pBytes</a></span><span class="op" id="2026949">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026954">if</span>&nbsp;<span class="ident" id="2026957"><a href="/gostd/crypto/dsa/dsa.go.html#2025997">err</a></span>&nbsp;<span class="op" id="2026961">!=</span>&nbsp;<span class="builtintype" id="2026964">nil</span>&nbsp;<span class="op" id="2026968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2026974">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2026984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2026990"><a href="/gostd/crypto/dsa/dsa.go.html#2026540">pBytes</a></span><span class="op" id="2026996">[</span><span class="builtinfunc" id="2026997">len</span><span class="op" id="2027000">(</span><span class="ident" id="2027001"><a href="/gostd/crypto/dsa/dsa.go.html#2026540">pBytes</a></span><span class="op" id="2027007">)</span><span class="op" id="2027008">-</span><span class="num" id="2027009">1</span><span class="op" id="2027010">]</span>&nbsp;<span class="op" id="2027012">|=</span>&nbsp;<span class="num" id="2027015">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027020"><a href="/gostd/crypto/dsa/dsa.go.html#2026540">pBytes</a></span><span class="op" id="2027026">[</span><span class="num" id="2027027">0</span><span class="op" id="2027028">]</span>&nbsp;<span class="op" id="2027030">|=</span>&nbsp;<span class="num" id="2027033">0x80</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027042"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027043">.</span><span class="ident" id="2027044"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="2027052">(</span><span class="ident" id="2027053"><a href="/gostd/crypto/dsa/dsa.go.html#2026540">pBytes</a></span><span class="op" id="2027059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027064"><a href="/gostd/crypto/dsa/dsa.go.html#2026608">rem</a></span><span class="op" id="2027067">.</span><span class="ident" id="2027068"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2027071">(</span><span class="ident" id="2027072"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027073">,</span>&nbsp;<span class="ident" id="2027075"><a href="/gostd/crypto/dsa/dsa.go.html#2026570">q</a></span><span class="op" id="2027076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027081"><a href="/gostd/crypto/dsa/dsa.go.html#2026608">rem</a></span><span class="op" id="2027084">.</span><span class="ident" id="2027085"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="2027088">(</span><span class="ident" id="2027089"><a href="/gostd/crypto/dsa/dsa.go.html#2026608">rem</a></span><span class="op" id="2027092">,</span>&nbsp;<span class="ident" id="2027094"><a href="/gostd/crypto/dsa/dsa.go.html#2026629">one</a></span><span class="op" id="2027097">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027102"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027103">.</span><span class="ident" id="2027104"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="2027107">(</span><span class="ident" id="2027108"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027109">,</span>&nbsp;<span class="ident" id="2027111"><a href="/gostd/crypto/dsa/dsa.go.html#2026608">rem</a></span><span class="op" id="2027114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027119">if</span>&nbsp;<span class="ident" id="2027122"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027123">.</span><span class="ident" id="2027124"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="2027130">(</span><span class="op" id="2027131">)</span>&nbsp;<span class="op" id="2027133">&lt;</span>&nbsp;<span class="ident" id="2027135"><a href="/gostd/crypto/dsa/dsa.go.html#2026261">L</a></span>&nbsp;<span class="op" id="2027137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027143">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027161">if</span>&nbsp;<span class="op" id="2027164">!</span><span class="ident" id="2027165"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027166">.</span><span class="ident" id="2027167"><a href="/gostd/math/big/int.go.html#2053360">ProbablyPrime</a></span><span class="op" id="2027180">(</span><span class="ident" id="2027181"><a href="/gostd/crypto/dsa/dsa.go.html#2025759">numMRTests</a></span><span class="op" id="2027191">)</span>&nbsp;<span class="op" id="2027193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027199">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027217"><a href="/gostd/crypto/dsa/dsa.go.html#2025938">params</a></span><span class="op" id="2027223">.</span><span class="ident" id="2027224"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span>&nbsp;<span class="op" id="2027226">=</span>&nbsp;<span class="ident" id="2027228"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027233"><a href="/gostd/crypto/dsa/dsa.go.html#2025938">params</a></span><span class="op" id="2027239">.</span><span class="ident" id="2027240"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span>&nbsp;<span class="op" id="2027242">=</span>&nbsp;<span class="ident" id="2027244"><a href="/gostd/crypto/dsa/dsa.go.html#2026570">q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027249">break</span>&nbsp;<span class="ident" id="2027255"><a href="/gostd/crypto/dsa/dsa.go.html#2026667">GeneratePrimes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027279">h</span>&nbsp;<span class="op" id="2027281">:=</span>&nbsp;<span class="builtinfunc" id="2027284">new</span><span class="op" id="2027287">(</span><span class="ident" id="2027288"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2027291">.</span><span class="ident" id="2027292"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2027295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027298"><a href="/gostd/crypto/dsa/dsa.go.html#2027279">h</a></span><span class="op" id="2027299">.</span><span class="ident" id="2027300"><a href="/gostd/math/big/int.go.html#2036323">SetInt64</a></span><span class="op" id="2027308">(</span><span class="num" id="2027309">2</span><span class="op" id="2027310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027313">g</span>&nbsp;<span class="op" id="2027315">:=</span>&nbsp;<span class="builtinfunc" id="2027318">new</span><span class="op" id="2027321">(</span><span class="ident" id="2027322"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2027325">.</span><span class="ident" id="2027326"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2027329">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027333">pm1</span>&nbsp;<span class="op" id="2027337">:=</span>&nbsp;<span class="builtinfunc" id="2027340">new</span><span class="op" id="2027343">(</span><span class="ident" id="2027344"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2027347">.</span><span class="ident" id="2027348"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2027351">)</span><span class="op" id="2027352">.</span><span class="ident" id="2027353"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="2027356">(</span><span class="ident" id="2027357"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027358">,</span>&nbsp;<span class="ident" id="2027360"><a href="/gostd/crypto/dsa/dsa.go.html#2026629">one</a></span><span class="op" id="2027363">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027366">e</span>&nbsp;<span class="op" id="2027368">:=</span>&nbsp;<span class="builtinfunc" id="2027371">new</span><span class="op" id="2027374">(</span><span class="ident" id="2027375"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2027378">.</span><span class="ident" id="2027379"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2027382">)</span><span class="op" id="2027383">.</span><span class="ident" id="2027384"><a href="/gostd/math/big/int.go.html#2041362">Div</a></span><span class="op" id="2027387">(</span><span class="ident" id="2027388"><a href="/gostd/crypto/dsa/dsa.go.html#2027333">pm1</a></span><span class="op" id="2027391">,</span>&nbsp;<span class="ident" id="2027393"><a href="/gostd/crypto/dsa/dsa.go.html#2026570">q</a></span><span class="op" id="2027394">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027398">for</span>&nbsp;<span class="op" id="2027402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027406"><a href="/gostd/crypto/dsa/dsa.go.html#2027313">g</a></span><span class="op" id="2027407">.</span><span class="ident" id="2027408"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="2027411">(</span><span class="ident" id="2027412"><a href="/gostd/crypto/dsa/dsa.go.html#2027279">h</a></span><span class="op" id="2027413">,</span>&nbsp;<span class="ident" id="2027415"><a href="/gostd/crypto/dsa/dsa.go.html#2027366">e</a></span><span class="op" id="2027416">,</span>&nbsp;<span class="ident" id="2027418"><a href="/gostd/crypto/dsa/dsa.go.html#2026589">p</a></span><span class="op" id="2027419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027423">if</span>&nbsp;<span class="ident" id="2027426"><a href="/gostd/crypto/dsa/dsa.go.html#2027313">g</a></span><span class="op" id="2027427">.</span><span class="ident" id="2027428"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="2027431">(</span><span class="ident" id="2027432"><a href="/gostd/crypto/dsa/dsa.go.html#2026629">one</a></span><span class="op" id="2027435">)</span>&nbsp;<span class="op" id="2027437">==</span>&nbsp;<span class="num" id="2027440">0</span>&nbsp;<span class="op" id="2027442">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027447"><a href="/gostd/crypto/dsa/dsa.go.html#2027279">h</a></span><span class="op" id="2027448">.</span><span class="ident" id="2027449"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="2027452">(</span><span class="ident" id="2027453"><a href="/gostd/crypto/dsa/dsa.go.html#2027279">h</a></span><span class="op" id="2027454">,</span>&nbsp;<span class="ident" id="2027456"><a href="/gostd/crypto/dsa/dsa.go.html#2026629">one</a></span><span class="op" id="2027459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027464">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027480"><a href="/gostd/crypto/dsa/dsa.go.html#2025938">params</a></span><span class="op" id="2027486">.</span><span class="ident" id="2027487"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span>&nbsp;<span class="op" id="2027489">=</span>&nbsp;<span class="ident" id="2027491"><a href="/gostd/crypto/dsa/dsa.go.html#2027313">g</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027495">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027503">}</span><br>
<span class="lineno"></span><span class="op" id="2027505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2027508">//&nbsp;GenerateKey&nbsp;generates&nbsp;a&nbsp;public&amp;private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;Parameters&nbsp;of&nbsp;the</span><br>
<span class="lineno">150</span><span class="comment" id="2027582">//&nbsp;PrivateKey&nbsp;must&nbsp;already&nbsp;be&nbsp;valid&nbsp;(see&nbsp;GenerateParameters).</span><br>
<span class="lineno"></span><span class="keyword" id="2027644">func</span>&nbsp;<span class="ident" id="2027649">GenerateKey</span><span class="op" id="2027660">(</span><span class="ident" id="2027661">priv</span>&nbsp;<span class="op" id="2027666">*</span><span class="ident" id="2027667"><a href="/gostd/crypto/dsa/dsa.go.html#2024982">PrivateKey</a></span><span class="op" id="2027677">,</span>&nbsp;<span class="ident" id="2027679">rand</span>&nbsp;<span class="ident" id="2027684"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2027686">.</span><span class="ident" id="2027687"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="2027693">)</span>&nbsp;<span class="builtintype" id="2027695">error</span>&nbsp;<span class="op" id="2027701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027704">if</span>&nbsp;<span class="ident" id="2027707"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2027711">.</span><span class="ident" id="2027712"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span>&nbsp;<span class="op" id="2027714">==</span>&nbsp;<span class="builtintype" id="2027717">nil</span>&nbsp;<span class="op" id="2027721">||</span>&nbsp;<span class="ident" id="2027724"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2027728">.</span><span class="ident" id="2027729"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span>&nbsp;<span class="op" id="2027731">==</span>&nbsp;<span class="builtintype" id="2027734">nil</span>&nbsp;<span class="op" id="2027738">||</span>&nbsp;<span class="ident" id="2027741"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2027745">.</span><span class="ident" id="2027746"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span>&nbsp;<span class="op" id="2027748">==</span>&nbsp;<span class="builtintype" id="2027751">nil</span>&nbsp;<span class="op" id="2027755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027759">return</span>&nbsp;<span class="ident" id="2027766"><a href="/gostd/crypto/dsa/dsa.go.html#2024609">errors</a></span><span class="op" id="2027772">.</span><span class="ident" id="2027773"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="2027776">(</span><span class="string" id="2027777">&#34;crypto/dsa:&nbsp;parameters&nbsp;not&nbsp;set&nbsp;up&nbsp;before&nbsp;generating&nbsp;key&#34;</span><span class="op" id="2027834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027837">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027841">x</span>&nbsp;<span class="op" id="2027843">:=</span>&nbsp;<span class="builtinfunc" id="2027846">new</span><span class="op" id="2027849">(</span><span class="ident" id="2027850"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2027853">.</span><span class="ident" id="2027854"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2027857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027860">xBytes</span>&nbsp;<span class="op" id="2027867">:=</span>&nbsp;<span class="builtinfunc" id="2027870">make</span><span class="op" id="2027874">(</span><span class="op" id="2027875">[</span><span class="op" id="2027876">]</span><span class="builtintype" id="2027877">byte</span><span class="op" id="2027881">,</span>&nbsp;<span class="ident" id="2027883"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2027887">.</span><span class="ident" id="2027888"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2027889">.</span><span class="ident" id="2027890"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="2027896">(</span><span class="op" id="2027897">)</span><span class="op" id="2027898">/</span><span class="num" id="2027899">8</span><span class="op" id="2027900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027904">for</span>&nbsp;<span class="op" id="2027908">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027912">_</span><span class="op" id="2027913">,</span>&nbsp;<span class="ident" id="2027915">err</span>&nbsp;<span class="op" id="2027919">:=</span>&nbsp;<span class="ident" id="2027922"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2027924">.</span><span class="ident" id="2027925"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="2027933">(</span><span class="ident" id="2027934"><a href="/gostd/crypto/dsa/dsa.go.html#2027679">rand</a></span><span class="op" id="2027938">,</span>&nbsp;<span class="ident" id="2027940"><a href="/gostd/crypto/dsa/dsa.go.html#2027860">xBytes</a></span><span class="op" id="2027946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027950">if</span>&nbsp;<span class="ident" id="2027953"><a href="/gostd/crypto/dsa/dsa.go.html#2027915">err</a></span>&nbsp;<span class="op" id="2027957">!=</span>&nbsp;<span class="builtintype" id="2027960">nil</span>&nbsp;<span class="op" id="2027964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2027969">return</span>&nbsp;<span class="ident" id="2027976"><a href="/gostd/crypto/dsa/dsa.go.html#2027915">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2027982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2027986"><a href="/gostd/crypto/dsa/dsa.go.html#2027841">x</a></span><span class="op" id="2027987">.</span><span class="ident" id="2027988"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="2027996">(</span><span class="ident" id="2027997"><a href="/gostd/crypto/dsa/dsa.go.html#2027860">xBytes</a></span><span class="op" id="2028003">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028007">if</span>&nbsp;<span class="ident" id="2028010"><a href="/gostd/crypto/dsa/dsa.go.html#2027841">x</a></span><span class="op" id="2028011">.</span><span class="ident" id="2028012"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="2028016">(</span><span class="op" id="2028017">)</span>&nbsp;<span class="op" id="2028019">!=</span>&nbsp;<span class="num" id="2028022">0</span>&nbsp;<span class="op" id="2028024">&amp;&amp;</span>&nbsp;<span class="ident" id="2028027"><a href="/gostd/crypto/dsa/dsa.go.html#2027841">x</a></span><span class="op" id="2028028">.</span><span class="ident" id="2028029"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="2028032">(</span><span class="ident" id="2028033"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2028037">.</span><span class="ident" id="2028038"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2028039">)</span>&nbsp;<span class="op" id="2028041">&lt;</span>&nbsp;<span class="num" id="2028043">0</span>&nbsp;<span class="op" id="2028045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028050">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2028061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028065"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2028069">.</span><span class="ident" id="2028070"><a href="/gostd/crypto/dsa/dsa.go.html#2025014">X</a></span>&nbsp;<span class="op" id="2028072">=</span>&nbsp;<span class="ident" id="2028074"><a href="/gostd/crypto/dsa/dsa.go.html#2027841">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028077"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2028081">.</span><span class="ident" id="2028082"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span>&nbsp;<span class="op" id="2028084">=</span>&nbsp;<span class="builtinfunc" id="2028086">new</span><span class="op" id="2028089">(</span><span class="ident" id="2028090"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2028093">.</span><span class="ident" id="2028094"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2028097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028100"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2028104">.</span><span class="ident" id="2028105"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="2028106">.</span><span class="ident" id="2028107"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="2028110">(</span><span class="ident" id="2028111"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2028115">.</span><span class="ident" id="2028116"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="2028117">,</span>&nbsp;<span class="ident" id="2028119"><a href="/gostd/crypto/dsa/dsa.go.html#2027841">x</a></span><span class="op" id="2028120">,</span>&nbsp;<span class="ident" id="2028122"><a href="/gostd/crypto/dsa/dsa.go.html#2027661">priv</a></span><span class="op" id="2028126">.</span><span class="ident" id="2028127"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="2028128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028131">return</span>&nbsp;<span class="builtintype" id="2028138">nil</span><br>
<span class="lineno"></span><span class="op" id="2028142">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="2028145">//&nbsp;fermatInverse&nbsp;calculates&nbsp;the&nbsp;inverse&nbsp;of&nbsp;k&nbsp;in&nbsp;GF(P)&nbsp;using&nbsp;Fermat&#39;s&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2028222">//&nbsp;This&nbsp;has&nbsp;better&nbsp;constant-time&nbsp;properties&nbsp;than&nbsp;Euclid&#39;s&nbsp;method&nbsp;(implemented</span><br>
<span class="lineno"></span><span class="comment" id="2028300">//&nbsp;in&nbsp;math/big.Int.ModInverse)&nbsp;although&nbsp;math/big&nbsp;itself&nbsp;isn&#39;t&nbsp;strictly</span><br>
<span class="lineno"></span><span class="comment" id="2028371">//&nbsp;constant-time&nbsp;so&nbsp;it&#39;s&nbsp;not&nbsp;perfect.</span><br>
<span class="lineno">180</span><span class="keyword" id="2028409">func</span>&nbsp;<span class="ident" id="2028414">fermatInverse</span><span class="op" id="2028427">(</span><span class="ident" id="2028428">k</span><span class="op" id="2028429">,</span>&nbsp;<span class="ident" id="2028431">P</span>&nbsp;<span class="op" id="2028433">*</span><span class="ident" id="2028434"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2028437">.</span><span class="ident" id="2028438"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2028441">)</span>&nbsp;<span class="op" id="2028443">*</span><span class="ident" id="2028444"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2028447">.</span><span class="ident" id="2028448"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="2028452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028455">two</span>&nbsp;<span class="op" id="2028459">:=</span>&nbsp;<span class="ident" id="2028462"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2028465">.</span><span class="ident" id="2028466"><a href="/gostd/math/big/int.go.html#2036655">NewInt</a></span><span class="op" id="2028472">(</span><span class="num" id="2028473">2</span><span class="op" id="2028474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2028477">pMinus2</span>&nbsp;<span class="op" id="2028485">:=</span>&nbsp;<span class="builtinfunc" id="2028488">new</span><span class="op" id="2028491">(</span><span class="ident" id="2028492"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2028495">.</span><span class="ident" id="2028496"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2028499">)</span><span class="op" id="2028500">.</span><span class="ident" id="2028501"><a href="/gostd/math/big/int.go.html#2038464">Sub</a></span><span class="op" id="2028504">(</span><span class="ident" id="2028505"><a href="/gostd/crypto/dsa/dsa.go.html#2028431">P</a></span><span class="op" id="2028506">,</span>&nbsp;<span class="ident" id="2028508"><a href="/gostd/crypto/dsa/dsa.go.html#2028455">two</a></span><span class="op" id="2028511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2028514">return</span>&nbsp;<span class="builtinfunc" id="2028521">new</span><span class="op" id="2028524">(</span><span class="ident" id="2028525"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2028528">.</span><span class="ident" id="2028529"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2028532">)</span><span class="op" id="2028533">.</span><span class="ident" id="2028534"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="2028537">(</span><span class="ident" id="2028538"><a href="/gostd/crypto/dsa/dsa.go.html#2028428">k</a></span><span class="op" id="2028539">,</span>&nbsp;<span class="ident" id="2028541"><a href="/gostd/crypto/dsa/dsa.go.html#2028477">pMinus2</a></span><span class="op" id="2028548">,</span>&nbsp;<span class="ident" id="2028550"><a href="/gostd/crypto/dsa/dsa.go.html#2028431">P</a></span><span class="op" id="2028551">)</span><br>
<span class="lineno"></span><span class="op" id="2028553">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="comment" id="2028556">//&nbsp;Sign&nbsp;signs&nbsp;an&nbsp;arbitrary&nbsp;length&nbsp;hash&nbsp;(which&nbsp;should&nbsp;be&nbsp;the&nbsp;result&nbsp;of&nbsp;hashing&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2028636">//&nbsp;larger&nbsp;message)&nbsp;using&nbsp;the&nbsp;private&nbsp;key,&nbsp;priv.&nbsp;It&nbsp;returns&nbsp;the&nbsp;signature&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2028714">//&nbsp;pair&nbsp;of&nbsp;integers.&nbsp;The&nbsp;security&nbsp;of&nbsp;the&nbsp;private&nbsp;key&nbsp;depends&nbsp;on&nbsp;the&nbsp;entropy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2028793">//&nbsp;rand.</span><br>
<span class="lineno">190</span><span class="comment" id="2028802">//</span><br>
<span class="lineno"></span><span class="comment" id="2028805">//&nbsp;Note&nbsp;that&nbsp;FIPS&nbsp;186-3&nbsp;section&nbsp;4.6&nbsp;specifies&nbsp;that&nbsp;the&nbsp;hash&nbsp;should&nbsp;be&nbsp;truncated</span><br>
<span class="lineno"></span><span class="comment" id="2028885">//&nbsp;to&nbsp;the&nbsp;byte-length&nbsp;of&nbsp;the&nbsp;subgroup.&nbsp;This&nbsp;function&nbsp;does&nbsp;not&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2028960">//&nbsp;truncation&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="2028982">func</span>&nbsp;<span class="ident" id="2028987">Sign</span><span class="op" id="2028991">(</span><span class="ident" id="2028992">rand</span>&nbsp;<span class="ident" id="2028997"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2028999">.</span><span class="ident" id="2029000"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="2029006">,</span>&nbsp;<span class="ident" id="2029008">priv</span>&nbsp;<span class="op" id="2029013">*</span><span class="ident" id="2029014"><a href="/gostd/crypto/dsa/dsa.go.html#2024982">PrivateKey</a></span><span class="op" id="2029024">,</span>&nbsp;<span class="ident" id="2029026">hash</span>&nbsp;<span class="op" id="2029031">[</span><span class="op" id="2029032">]</span><span class="builtintype" id="2029033">byte</span><span class="op" id="2029037">)</span>&nbsp;<span class="op" id="2029039">(</span><span class="ident" id="2029040">r</span><span class="op" id="2029041">,</span>&nbsp;<span class="ident" id="2029043">s</span>&nbsp;<span class="op" id="2029045">*</span><span class="ident" id="2029046"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2029049">.</span><span class="ident" id="2029050"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2029053">,</span>&nbsp;<span class="ident" id="2029055">err</span>&nbsp;<span class="builtintype" id="2029059">error</span><span class="op" id="2029064">)</span>&nbsp;<span class="op" id="2029066">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2029069">//&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029098">n</span>&nbsp;<span class="op" id="2029100">:=</span>&nbsp;<span class="ident" id="2029103"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029107">.</span><span class="ident" id="2029108"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2029109">.</span><span class="ident" id="2029110"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="2029116">(</span><span class="op" id="2029117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029120">if</span>&nbsp;<span class="ident" id="2029123"><a href="/gostd/crypto/dsa/dsa.go.html#2029098">n</a></span><span class="op" id="2029124">&amp;</span><span class="num" id="2029125">7</span>&nbsp;<span class="op" id="2029127">!=</span>&nbsp;<span class="num" id="2029130">0</span>&nbsp;<span class="op" id="2029132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029136"><a href="/gostd/crypto/dsa/dsa.go.html#2029055">err</a></span>&nbsp;<span class="op" id="2029140">=</span>&nbsp;<span class="ident" id="2029142"><a href="/gostd/crypto/dsa/dsa.go.html#2025295">ErrInvalidPublicKey</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029164">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029175"><a href="/gostd/crypto/dsa/dsa.go.html#2029098">n</a></span>&nbsp;<span class="op" id="2029177">&gt;&gt;=</span>&nbsp;<span class="num" id="2029181">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029185">for</span>&nbsp;<span class="op" id="2029189">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029193">k</span>&nbsp;<span class="op" id="2029195">:=</span>&nbsp;<span class="builtinfunc" id="2029198">new</span><span class="op" id="2029201">(</span><span class="ident" id="2029202"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2029205">.</span><span class="ident" id="2029206"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2029209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029213">buf</span>&nbsp;<span class="op" id="2029217">:=</span>&nbsp;<span class="builtinfunc" id="2029220">make</span><span class="op" id="2029224">(</span><span class="op" id="2029225">[</span><span class="op" id="2029226">]</span><span class="builtintype" id="2029227">byte</span><span class="op" id="2029231">,</span>&nbsp;<span class="ident" id="2029233"><a href="/gostd/crypto/dsa/dsa.go.html#2029098">n</a></span><span class="op" id="2029234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029238">for</span>&nbsp;<span class="op" id="2029242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029247">_</span><span class="op" id="2029248">,</span>&nbsp;<span class="ident" id="2029250"><a href="/gostd/crypto/dsa/dsa.go.html#2029055">err</a></span>&nbsp;<span class="op" id="2029254">=</span>&nbsp;<span class="ident" id="2029256"><a href="/gostd/crypto/dsa/dsa.go.html#2024619">io</a></span><span class="op" id="2029258">.</span><span class="ident" id="2029259"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="2029267">(</span><span class="ident" id="2029268"><a href="/gostd/crypto/dsa/dsa.go.html#2028992">rand</a></span><span class="op" id="2029272">,</span>&nbsp;<span class="ident" id="2029274"><a href="/gostd/crypto/dsa/dsa.go.html#2029213">buf</a></span><span class="op" id="2029277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029282">if</span>&nbsp;<span class="ident" id="2029285"><a href="/gostd/crypto/dsa/dsa.go.html#2029055">err</a></span>&nbsp;<span class="op" id="2029289">!=</span>&nbsp;<span class="builtintype" id="2029292">nil</span>&nbsp;<span class="op" id="2029296">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029302">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029317"><a href="/gostd/crypto/dsa/dsa.go.html#2029193">k</a></span><span class="op" id="2029318">.</span><span class="ident" id="2029319"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="2029327">(</span><span class="ident" id="2029328"><a href="/gostd/crypto/dsa/dsa.go.html#2029213">buf</a></span><span class="op" id="2029331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029336">if</span>&nbsp;<span class="ident" id="2029339"><a href="/gostd/crypto/dsa/dsa.go.html#2029193">k</a></span><span class="op" id="2029340">.</span><span class="ident" id="2029341"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="2029345">(</span><span class="op" id="2029346">)</span>&nbsp;<span class="op" id="2029348">&gt;</span>&nbsp;<span class="num" id="2029350">0</span>&nbsp;<span class="op" id="2029352">&amp;&amp;</span>&nbsp;<span class="ident" id="2029355"><a href="/gostd/crypto/dsa/dsa.go.html#2029193">k</a></span><span class="op" id="2029356">.</span><span class="ident" id="2029357"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="2029360">(</span><span class="ident" id="2029361"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029365">.</span><span class="ident" id="2029366"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2029367">)</span>&nbsp;<span class="op" id="2029369">&lt;</span>&nbsp;<span class="num" id="2029371">0</span>&nbsp;<span class="op" id="2029373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029379">break</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029397">kInv</span>&nbsp;<span class="op" id="2029402">:=</span>&nbsp;<span class="ident" id="2029405"><a href="/gostd/crypto/dsa/dsa.go.html#2028414">fermatInverse</a></span><span class="op" id="2029418">(</span><span class="ident" id="2029419"><a href="/gostd/crypto/dsa/dsa.go.html#2029193">k</a></span><span class="op" id="2029420">,</span>&nbsp;<span class="ident" id="2029422"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029426">.</span><span class="ident" id="2029427"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2029428">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029433"><a href="/gostd/crypto/dsa/dsa.go.html#2029040">r</a></span>&nbsp;<span class="op" id="2029435">=</span>&nbsp;<span class="builtinfunc" id="2029437">new</span><span class="op" id="2029440">(</span><span class="ident" id="2029441"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2029444">.</span><span class="ident" id="2029445"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2029448">)</span><span class="op" id="2029449">.</span><span class="ident" id="2029450"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="2029453">(</span><span class="ident" id="2029454"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029458">.</span><span class="ident" id="2029459"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="2029460">,</span>&nbsp;<span class="ident" id="2029462"><a href="/gostd/crypto/dsa/dsa.go.html#2029193">k</a></span><span class="op" id="2029463">,</span>&nbsp;<span class="ident" id="2029465"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029469">.</span><span class="ident" id="2029470"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="2029471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029475"><a href="/gostd/crypto/dsa/dsa.go.html#2029040">r</a></span><span class="op" id="2029476">.</span><span class="ident" id="2029477"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2029480">(</span><span class="ident" id="2029481"><a href="/gostd/crypto/dsa/dsa.go.html#2029040">r</a></span><span class="op" id="2029482">,</span>&nbsp;<span class="ident" id="2029484"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029488">.</span><span class="ident" id="2029489"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2029490">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029495">if</span>&nbsp;<span class="ident" id="2029498"><a href="/gostd/crypto/dsa/dsa.go.html#2029040">r</a></span><span class="op" id="2029499">.</span><span class="ident" id="2029500"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="2029504">(</span><span class="op" id="2029505">)</span>&nbsp;<span class="op" id="2029507">==</span>&nbsp;<span class="num" id="2029510">0</span>&nbsp;<span class="op" id="2029512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029517">continue</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029533">z</span>&nbsp;<span class="op" id="2029535">:=</span>&nbsp;<span class="ident" id="2029538"><a href="/gostd/crypto/dsa/dsa.go.html#2029193">k</a></span><span class="op" id="2029539">.</span><span class="ident" id="2029540"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="2029548">(</span><span class="ident" id="2029549"><a href="/gostd/crypto/dsa/dsa.go.html#2029026">hash</a></span><span class="op" id="2029553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029558"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span>&nbsp;<span class="op" id="2029560">=</span>&nbsp;<span class="builtinfunc" id="2029562">new</span><span class="op" id="2029565">(</span><span class="ident" id="2029566"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2029569">.</span><span class="ident" id="2029570"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2029573">)</span><span class="op" id="2029574">.</span><span class="ident" id="2029575"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="2029578">(</span><span class="ident" id="2029579"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029583">.</span><span class="ident" id="2029584"><a href="/gostd/crypto/dsa/dsa.go.html#2025014">X</a></span><span class="op" id="2029585">,</span>&nbsp;<span class="ident" id="2029587"><a href="/gostd/crypto/dsa/dsa.go.html#2029040">r</a></span><span class="op" id="2029588">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029592"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029593">.</span><span class="ident" id="2029594"><a href="/gostd/math/big/int.go.html#2037987">Add</a></span><span class="op" id="2029597">(</span><span class="ident" id="2029598"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029599">,</span>&nbsp;<span class="ident" id="2029601"><a href="/gostd/crypto/dsa/dsa.go.html#2029533">z</a></span><span class="op" id="2029602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029606"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029607">.</span><span class="ident" id="2029608"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2029611">(</span><span class="ident" id="2029612"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029613">,</span>&nbsp;<span class="ident" id="2029615"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029619">.</span><span class="ident" id="2029620"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2029621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029625"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029626">.</span><span class="ident" id="2029627"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="2029630">(</span><span class="ident" id="2029631"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029632">,</span>&nbsp;<span class="ident" id="2029634"><a href="/gostd/crypto/dsa/dsa.go.html#2029397">kInv</a></span><span class="op" id="2029638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2029642"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029643">.</span><span class="ident" id="2029644"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2029647">(</span><span class="ident" id="2029648"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029649">,</span>&nbsp;<span class="ident" id="2029651"><a href="/gostd/crypto/dsa/dsa.go.html#2029008">priv</a></span><span class="op" id="2029655">.</span><span class="ident" id="2029656"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2029657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029662">if</span>&nbsp;<span class="ident" id="2029665"><a href="/gostd/crypto/dsa/dsa.go.html#2029043">s</a></span><span class="op" id="2029666">.</span><span class="ident" id="2029667"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="2029671">(</span><span class="op" id="2029672">)</span>&nbsp;<span class="op" id="2029674">!=</span>&nbsp;<span class="num" id="2029677">0</span>&nbsp;<span class="op" id="2029679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029684">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2029695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2029699">return</span><br>
<span class="lineno"></span><span class="op" id="2029706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2029709">//&nbsp;Verify&nbsp;verifies&nbsp;the&nbsp;signature&nbsp;in&nbsp;r,&nbsp;s&nbsp;of&nbsp;hash&nbsp;using&nbsp;the&nbsp;public&nbsp;key,&nbsp;pub.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2029788">//&nbsp;reports&nbsp;whether&nbsp;the&nbsp;signature&nbsp;is&nbsp;valid.</span><br>
<span class="lineno">245</span><span class="comment" id="2029831">//</span><br>
<span class="lineno"></span><span class="comment" id="2029834">//&nbsp;Note&nbsp;that&nbsp;FIPS&nbsp;186-3&nbsp;section&nbsp;4.6&nbsp;specifies&nbsp;that&nbsp;the&nbsp;hash&nbsp;should&nbsp;be&nbsp;truncated</span><br>
<span class="lineno"></span><span class="comment" id="2029914">//&nbsp;to&nbsp;the&nbsp;byte-length&nbsp;of&nbsp;the&nbsp;subgroup.&nbsp;This&nbsp;function&nbsp;does&nbsp;not&nbsp;perform&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2029989">//&nbsp;truncation&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="2030011">func</span>&nbsp;<span class="ident" id="2030016">Verify</span><span class="op" id="2030022">(</span><span class="ident" id="2030023">pub</span>&nbsp;<span class="op" id="2030027">*</span><span class="ident" id="2030028"><a href="/gostd/crypto/dsa/dsa.go.html#2024887">PublicKey</a></span><span class="op" id="2030037">,</span>&nbsp;<span class="ident" id="2030039">hash</span>&nbsp;<span class="op" id="2030044">[</span><span class="op" id="2030045">]</span><span class="builtintype" id="2030046">byte</span><span class="op" id="2030050">,</span>&nbsp;<span class="ident" id="2030052">r</span><span class="op" id="2030053">,</span>&nbsp;<span class="ident" id="2030055">s</span>&nbsp;<span class="op" id="2030057">*</span><span class="ident" id="2030058"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2030061">.</span><span class="ident" id="2030062"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2030065">)</span>&nbsp;<span class="builtintype" id="2030067">bool</span>&nbsp;<span class="op" id="2030072">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2030075">//&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;4.7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030104">if</span>&nbsp;<span class="ident" id="2030107"><a href="/gostd/crypto/dsa/dsa.go.html#2030052">r</a></span><span class="op" id="2030108">.</span><span class="ident" id="2030109"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="2030113">(</span><span class="op" id="2030114">)</span>&nbsp;<span class="op" id="2030116">&lt;</span>&nbsp;<span class="num" id="2030118">1</span>&nbsp;<span class="op" id="2030120">||</span>&nbsp;<span class="ident" id="2030123"><a href="/gostd/crypto/dsa/dsa.go.html#2030052">r</a></span><span class="op" id="2030124">.</span><span class="ident" id="2030125"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="2030128">(</span><span class="ident" id="2030129"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030132">.</span><span class="ident" id="2030133"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030134">)</span>&nbsp;<span class="op" id="2030136">&gt;=</span>&nbsp;<span class="num" id="2030139">0</span>&nbsp;<span class="op" id="2030141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030145">return</span>&nbsp;<span class="builtintype" id="2030152">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030159">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030162">if</span>&nbsp;<span class="ident" id="2030165"><a href="/gostd/crypto/dsa/dsa.go.html#2030055">s</a></span><span class="op" id="2030166">.</span><span class="ident" id="2030167"><a href="/gostd/math/big/int.go.html#2036181">Sign</a></span><span class="op" id="2030171">(</span><span class="op" id="2030172">)</span>&nbsp;<span class="op" id="2030174">&lt;</span>&nbsp;<span class="num" id="2030176">1</span>&nbsp;<span class="op" id="2030178">||</span>&nbsp;<span class="ident" id="2030181"><a href="/gostd/crypto/dsa/dsa.go.html#2030055">s</a></span><span class="op" id="2030182">.</span><span class="ident" id="2030183"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="2030186">(</span><span class="ident" id="2030187"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030190">.</span><span class="ident" id="2030191"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030192">)</span>&nbsp;<span class="op" id="2030194">&gt;=</span>&nbsp;<span class="num" id="2030197">0</span>&nbsp;<span class="op" id="2030199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030203">return</span>&nbsp;<span class="builtintype" id="2030210">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030221">w</span>&nbsp;<span class="op" id="2030223">:=</span>&nbsp;<span class="builtinfunc" id="2030226">new</span><span class="op" id="2030229">(</span><span class="ident" id="2030230"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2030233">.</span><span class="ident" id="2030234"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2030237">)</span><span class="op" id="2030238">.</span><span class="ident" id="2030239"><a href="/gostd/math/big/int.go.html#2053864">ModInverse</a></span><span class="op" id="2030249">(</span><span class="ident" id="2030250"><a href="/gostd/crypto/dsa/dsa.go.html#2030055">s</a></span><span class="op" id="2030251">,</span>&nbsp;<span class="ident" id="2030253"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030256">.</span><span class="ident" id="2030257"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030258">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030262">n</span>&nbsp;<span class="op" id="2030264">:=</span>&nbsp;<span class="ident" id="2030267"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030270">.</span><span class="ident" id="2030271"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030272">.</span><span class="ident" id="2030273"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="2030279">(</span><span class="op" id="2030280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030283">if</span>&nbsp;<span class="ident" id="2030286"><a href="/gostd/crypto/dsa/dsa.go.html#2030262">n</a></span><span class="op" id="2030287">&amp;</span><span class="num" id="2030288">7</span>&nbsp;<span class="op" id="2030290">!=</span>&nbsp;<span class="num" id="2030293">0</span>&nbsp;<span class="op" id="2030295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030299">return</span>&nbsp;<span class="builtintype" id="2030306">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2030313">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030316">z</span>&nbsp;<span class="op" id="2030318">:=</span>&nbsp;<span class="builtinfunc" id="2030321">new</span><span class="op" id="2030324">(</span><span class="ident" id="2030325"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2030328">.</span><span class="ident" id="2030329"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2030332">)</span><span class="op" id="2030333">.</span><span class="ident" id="2030334"><a href="/gostd/math/big/int.go.html#2050026">SetBytes</a></span><span class="op" id="2030342">(</span><span class="ident" id="2030343"><a href="/gostd/crypto/dsa/dsa.go.html#2030039">hash</a></span><span class="op" id="2030347">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030351">u1</span>&nbsp;<span class="op" id="2030354">:=</span>&nbsp;<span class="builtinfunc" id="2030357">new</span><span class="op" id="2030360">(</span><span class="ident" id="2030361"><a href="/gostd/crypto/dsa/dsa.go.html#2024625">big</a></span><span class="op" id="2030364">.</span><span class="ident" id="2030365"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="2030368">)</span><span class="op" id="2030369">.</span><span class="ident" id="2030370"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="2030373">(</span><span class="ident" id="2030374"><a href="/gostd/crypto/dsa/dsa.go.html#2030316">z</a></span><span class="op" id="2030375">,</span>&nbsp;<span class="ident" id="2030377"><a href="/gostd/crypto/dsa/dsa.go.html#2030221">w</a></span><span class="op" id="2030378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030381"><a href="/gostd/crypto/dsa/dsa.go.html#2030351">u1</a></span><span class="op" id="2030383">.</span><span class="ident" id="2030384"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2030387">(</span><span class="ident" id="2030388"><a href="/gostd/crypto/dsa/dsa.go.html#2030351">u1</a></span><span class="op" id="2030390">,</span>&nbsp;<span class="ident" id="2030392"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030395">.</span><span class="ident" id="2030396"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030400">u2</span>&nbsp;<span class="op" id="2030403">:=</span>&nbsp;<span class="ident" id="2030406"><a href="/gostd/crypto/dsa/dsa.go.html#2030221">w</a></span><span class="op" id="2030407">.</span><span class="ident" id="2030408"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="2030411">(</span><span class="ident" id="2030412"><a href="/gostd/crypto/dsa/dsa.go.html#2030052">r</a></span><span class="op" id="2030413">,</span>&nbsp;<span class="ident" id="2030415"><a href="/gostd/crypto/dsa/dsa.go.html#2030221">w</a></span><span class="op" id="2030416">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030419"><a href="/gostd/crypto/dsa/dsa.go.html#2030400">u2</a></span><span class="op" id="2030421">.</span><span class="ident" id="2030422"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2030425">(</span><span class="ident" id="2030426"><a href="/gostd/crypto/dsa/dsa.go.html#2030400">u2</a></span><span class="op" id="2030428">,</span>&nbsp;<span class="ident" id="2030430"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030433">.</span><span class="ident" id="2030434"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030438">v</span>&nbsp;<span class="op" id="2030440">:=</span>&nbsp;<span class="ident" id="2030443"><a href="/gostd/crypto/dsa/dsa.go.html#2030351">u1</a></span><span class="op" id="2030445">.</span><span class="ident" id="2030446"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="2030449">(</span><span class="ident" id="2030450"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030453">.</span><span class="ident" id="2030454"><a href="/gostd/crypto/dsa/dsa.go.html#2024826">G</a></span><span class="op" id="2030455">,</span>&nbsp;<span class="ident" id="2030457"><a href="/gostd/crypto/dsa/dsa.go.html#2030351">u1</a></span><span class="op" id="2030459">,</span>&nbsp;<span class="ident" id="2030461"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030464">.</span><span class="ident" id="2030465"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="2030466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030469"><a href="/gostd/crypto/dsa/dsa.go.html#2030400">u2</a></span><span class="op" id="2030471">.</span><span class="ident" id="2030472"><a href="/gostd/math/big/int.go.html#2050632">Exp</a></span><span class="op" id="2030475">(</span><span class="ident" id="2030476"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030479">.</span><span class="ident" id="2030480"><a href="/gostd/crypto/dsa/dsa.go.html#2024919">Y</a></span><span class="op" id="2030481">,</span>&nbsp;<span class="ident" id="2030483"><a href="/gostd/crypto/dsa/dsa.go.html#2030400">u2</a></span><span class="op" id="2030485">,</span>&nbsp;<span class="ident" id="2030487"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030490">.</span><span class="ident" id="2030491"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="2030492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030495"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030496">.</span><span class="ident" id="2030497"><a href="/gostd/math/big/int.go.html#2038938">Mul</a></span><span class="op" id="2030500">(</span><span class="ident" id="2030501"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030502">,</span>&nbsp;<span class="ident" id="2030504"><a href="/gostd/crypto/dsa/dsa.go.html#2030400">u2</a></span><span class="op" id="2030506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030509"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030510">.</span><span class="ident" id="2030511"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2030514">(</span><span class="ident" id="2030515"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030516">,</span>&nbsp;<span class="ident" id="2030518"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030521">.</span><span class="ident" id="2030522"><a href="/gostd/crypto/dsa/dsa.go.html#2024820">P</a></span><span class="op" id="2030523">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030526"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030527">.</span><span class="ident" id="2030528"><a href="/gostd/math/big/int.go.html#2041761">Mod</a></span><span class="op" id="2030531">(</span><span class="ident" id="2030532"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030533">,</span>&nbsp;<span class="ident" id="2030535"><a href="/gostd/crypto/dsa/dsa.go.html#2030023">pub</a></span><span class="op" id="2030538">.</span><span class="ident" id="2030539"><a href="/gostd/crypto/dsa/dsa.go.html#2024823">Q</a></span><span class="op" id="2030540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030544">return</span>&nbsp;<span class="ident" id="2030551"><a href="/gostd/crypto/dsa/dsa.go.html#2030438">v</a></span><span class="op" id="2030552">.</span><span class="ident" id="2030553"><a href="/gostd/math/big/int.go.html#2042946">Cmp</a></span><span class="op" id="2030556">(</span><span class="ident" id="2030557"><a href="/gostd/crypto/dsa/dsa.go.html#2030052">r</a></span><span class="op" id="2030558">)</span>&nbsp;<span class="op" id="2030560">==</span>&nbsp;<span class="num" id="2030563">0</span><br>
<span class="lineno"></span><span class="op" id="2030565">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
