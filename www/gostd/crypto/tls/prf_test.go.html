<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html" class="current">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8510074">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8510129">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8510183">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8510234">package</span>&nbsp;<span class="ident" id="8510242">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8510247">import</span>&nbsp;<span class="op" id="8510254">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8510257">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8510273">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8510283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8510286">type</span>&nbsp;<span class="ident" id="8510291">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="8510320">struct</span>&nbsp;<span class="op" id="8510327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510330">in</span><span class="op" id="8510332">,</span>&nbsp;<span class="ident" id="8510334">out1</span><span class="op" id="8510338">,</span>&nbsp;<span class="ident" id="8510340">out2</span>&nbsp;<span class="builtintype" id="8510345">string</span><br>
<span class="lineno"></span><span class="op" id="8510352">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8510355">var</span>&nbsp;<span class="ident" id="8510359">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8510389">=</span>&nbsp;<span class="op" id="8510391">[</span><span class="op" id="8510392">]</span><span class="ident" id="8510393">testSplitPreMasterSecretTest</span><span class="op" id="8510421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510424">{</span><span class="string" id="8510425">&#34;&#34;</span><span class="op" id="8510427">,</span>&nbsp;<span class="string" id="8510429">&#34;&#34;</span><span class="op" id="8510431">,</span>&nbsp;<span class="string" id="8510433">&#34;&#34;</span><span class="op" id="8510435">}</span><span class="op" id="8510436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510439">{</span><span class="string" id="8510440">&#34;00&#34;</span><span class="op" id="8510444">,</span>&nbsp;<span class="string" id="8510446">&#34;00&#34;</span><span class="op" id="8510450">,</span>&nbsp;<span class="string" id="8510452">&#34;00&#34;</span><span class="op" id="8510456">}</span><span class="op" id="8510457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510460">{</span><span class="string" id="8510461">&#34;0011&#34;</span><span class="op" id="8510467">,</span>&nbsp;<span class="string" id="8510469">&#34;00&#34;</span><span class="op" id="8510473">,</span>&nbsp;<span class="string" id="8510475">&#34;11&#34;</span><span class="op" id="8510479">}</span><span class="op" id="8510480">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510483">{</span><span class="string" id="8510484">&#34;001122&#34;</span><span class="op" id="8510492">,</span>&nbsp;<span class="string" id="8510494">&#34;0011&#34;</span><span class="op" id="8510500">,</span>&nbsp;<span class="string" id="8510502">&#34;1122&#34;</span><span class="op" id="8510508">}</span><span class="op" id="8510509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510512">{</span><span class="string" id="8510513">&#34;00112233&#34;</span><span class="op" id="8510523">,</span>&nbsp;<span class="string" id="8510525">&#34;0011&#34;</span><span class="op" id="8510531">,</span>&nbsp;<span class="string" id="8510533">&#34;2233&#34;</span><span class="op" id="8510539">}</span><span class="op" id="8510540">,</span><br>
<span class="lineno"></span><span class="op" id="8510542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8510545">func</span>&nbsp;<span class="ident" id="8510550">TestSplitPreMasterSecret</span><span class="op" id="8510574">(</span><span class="ident" id="8510575">t</span>&nbsp;<span class="op" id="8510577">*</span><span class="ident" id="8510578">testing</span><span class="op" id="8510585">.</span><span class="ident" id="8510586">T</span><span class="op" id="8510587">)</span>&nbsp;<span class="op" id="8510589">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8510592">for</span>&nbsp;<span class="ident" id="8510596">i</span><span class="op" id="8510597">,</span>&nbsp;<span class="ident" id="8510599">test</span>&nbsp;<span class="op" id="8510604">:=</span>&nbsp;<span class="keyword" id="8510607">range</span>&nbsp;<span class="ident" id="8510613">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8510643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510647">in</span><span class="op" id="8510649">,</span>&nbsp;<span class="ident" id="8510651">_</span>&nbsp;<span class="op" id="8510653">:=</span>&nbsp;<span class="ident" id="8510656">hex</span><span class="op" id="8510659">.</span><span class="ident" id="8510660">DecodeString</span><span class="op" id="8510672">(</span><span class="ident" id="8510673">test</span><span class="op" id="8510677">.</span><span class="ident" id="8510678">in</span><span class="op" id="8510680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510684">out1</span><span class="op" id="8510688">,</span>&nbsp;<span class="ident" id="8510690">out2</span>&nbsp;<span class="op" id="8510695">:=</span>&nbsp;<span class="ident" id="8510698">splitPreMasterSecret</span><span class="op" id="8510718">(</span><span class="ident" id="8510719">in</span><span class="op" id="8510721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510725">s1</span>&nbsp;<span class="op" id="8510728">:=</span>&nbsp;<span class="ident" id="8510731">hex</span><span class="op" id="8510734">.</span><span class="ident" id="8510735">EncodeToString</span><span class="op" id="8510749">(</span><span class="ident" id="8510750">out1</span><span class="op" id="8510754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510758">s2</span>&nbsp;<span class="op" id="8510761">:=</span>&nbsp;<span class="ident" id="8510764">hex</span><span class="op" id="8510767">.</span><span class="ident" id="8510768">EncodeToString</span><span class="op" id="8510782">(</span><span class="ident" id="8510783">out2</span><span class="op" id="8510787">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8510791">if</span>&nbsp;<span class="ident" id="8510794">s1</span>&nbsp;<span class="op" id="8510797">!=</span>&nbsp;<span class="ident" id="8510800">test</span><span class="op" id="8510804">.</span><span class="ident" id="8510805">out1</span>&nbsp;<span class="op" id="8510810">||</span>&nbsp;<span class="ident" id="8510813">s2</span>&nbsp;<span class="op" id="8510816">!=</span>&nbsp;<span class="ident" id="8510819">test</span><span class="op" id="8510823">.</span><span class="ident" id="8510824">out2</span>&nbsp;<span class="op" id="8510829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510834">t</span><span class="op" id="8510835">.</span><span class="ident" id="8510836">Errorf</span><span class="op" id="8510842">(</span><span class="string" id="8510843">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="8510878">,</span>&nbsp;<span class="ident" id="8510880">i</span><span class="op" id="8510881">,</span>&nbsp;<span class="ident" id="8510883">s1</span><span class="op" id="8510885">,</span>&nbsp;<span class="ident" id="8510887">s2</span><span class="op" id="8510889">,</span>&nbsp;<span class="ident" id="8510891">test</span><span class="op" id="8510895">.</span><span class="ident" id="8510896">out1</span><span class="op" id="8510900">,</span>&nbsp;<span class="ident" id="8510902">test</span><span class="op" id="8510906">.</span><span class="ident" id="8510907">out2</span><span class="op" id="8510911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8510918">}</span><br>
<span class="lineno"></span><span class="op" id="8510920">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8510923">type</span>&nbsp;<span class="ident" id="8510928">testKeysFromTest</span>&nbsp;<span class="keyword" id="8510945">struct</span>&nbsp;<span class="op" id="8510952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510955">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8510982">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8510990">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8511017">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511025">clientRandom</span><span class="op" id="8511037">,</span>&nbsp;<span class="ident" id="8511039">serverRandom</span>&nbsp;<span class="builtintype" id="8511052">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511060">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8511087">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511095">clientMAC</span><span class="op" id="8511104">,</span>&nbsp;<span class="ident" id="8511106">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8511122">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511130">clientKey</span><span class="op" id="8511139">,</span>&nbsp;<span class="ident" id="8511141">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8511157">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511165">macLen</span><span class="op" id="8511171">,</span>&nbsp;<span class="ident" id="8511173">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8511192">int</span><br>
<span class="lineno"></span><span class="op" id="8511196">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8511199">func</span>&nbsp;<span class="ident" id="8511204">TestKeysFromPreMasterSecret</span><span class="op" id="8511231">(</span><span class="ident" id="8511232">t</span>&nbsp;<span class="op" id="8511234">*</span><span class="ident" id="8511235">testing</span><span class="op" id="8511242">.</span><span class="ident" id="8511243">T</span><span class="op" id="8511244">)</span>&nbsp;<span class="op" id="8511246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511249">for</span>&nbsp;<span class="ident" id="8511253">i</span><span class="op" id="8511254">,</span>&nbsp;<span class="ident" id="8511256">test</span>&nbsp;<span class="op" id="8511261">:=</span>&nbsp;<span class="keyword" id="8511264">range</span>&nbsp;<span class="ident" id="8511270">testKeysFromTests</span>&nbsp;<span class="op" id="8511288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511292">in</span><span class="op" id="8511294">,</span>&nbsp;<span class="ident" id="8511296">_</span>&nbsp;<span class="op" id="8511298">:=</span>&nbsp;<span class="ident" id="8511301">hex</span><span class="op" id="8511304">.</span><span class="ident" id="8511305">DecodeString</span><span class="op" id="8511317">(</span><span class="ident" id="8511318">test</span><span class="op" id="8511322">.</span><span class="ident" id="8511323">preMasterSecret</span><span class="op" id="8511338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511342">clientRandom</span><span class="op" id="8511354">,</span>&nbsp;<span class="ident" id="8511356">_</span>&nbsp;<span class="op" id="8511358">:=</span>&nbsp;<span class="ident" id="8511361">hex</span><span class="op" id="8511364">.</span><span class="ident" id="8511365">DecodeString</span><span class="op" id="8511377">(</span><span class="ident" id="8511378">test</span><span class="op" id="8511382">.</span><span class="ident" id="8511383">clientRandom</span><span class="op" id="8511395">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511399">serverRandom</span><span class="op" id="8511411">,</span>&nbsp;<span class="ident" id="8511413">_</span>&nbsp;<span class="op" id="8511415">:=</span>&nbsp;<span class="ident" id="8511418">hex</span><span class="op" id="8511421">.</span><span class="ident" id="8511422">DecodeString</span><span class="op" id="8511434">(</span><span class="ident" id="8511435">test</span><span class="op" id="8511439">.</span><span class="ident" id="8511440">serverRandom</span><span class="op" id="8511452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511457">masterSecret</span>&nbsp;<span class="op" id="8511470">:=</span>&nbsp;<span class="ident" id="8511473">masterFromPreMasterSecret</span><span class="op" id="8511498">(</span><span class="ident" id="8511499">test</span><span class="op" id="8511503">.</span><span class="ident" id="8511504">version</span><span class="op" id="8511511">,</span>&nbsp;<span class="ident" id="8511513">in</span><span class="op" id="8511515">,</span>&nbsp;<span class="ident" id="8511517">clientRandom</span><span class="op" id="8511529">,</span>&nbsp;<span class="ident" id="8511531">serverRandom</span><span class="op" id="8511543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511547">if</span>&nbsp;<span class="ident" id="8511550">s</span>&nbsp;<span class="op" id="8511552">:=</span>&nbsp;<span class="ident" id="8511555">hex</span><span class="op" id="8511558">.</span><span class="ident" id="8511559">EncodeToString</span><span class="op" id="8511573">(</span><span class="ident" id="8511574">masterSecret</span><span class="op" id="8511586">)</span><span class="op" id="8511587">;</span>&nbsp;<span class="ident" id="8511589">s</span>&nbsp;<span class="op" id="8511591">!=</span>&nbsp;<span class="ident" id="8511594">test</span><span class="op" id="8511598">.</span><span class="ident" id="8511599">masterSecret</span>&nbsp;<span class="op" id="8511612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511617">t</span><span class="op" id="8511618">.</span><span class="ident" id="8511619">Errorf</span><span class="op" id="8511625">(</span><span class="string" id="8511626">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8511662">,</span>&nbsp;<span class="ident" id="8511664">i</span><span class="op" id="8511665">,</span>&nbsp;<span class="ident" id="8511667">s</span><span class="op" id="8511668">,</span>&nbsp;<span class="ident" id="8511670">test</span><span class="op" id="8511674">.</span><span class="ident" id="8511675">masterSecret</span><span class="op" id="8511687">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511692">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8511703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511708">clientMAC</span><span class="op" id="8511717">,</span>&nbsp;<span class="ident" id="8511719">serverMAC</span><span class="op" id="8511728">,</span>&nbsp;<span class="ident" id="8511730">clientKey</span><span class="op" id="8511739">,</span>&nbsp;<span class="ident" id="8511741">serverKey</span><span class="op" id="8511750">,</span>&nbsp;<span class="ident" id="8511752">_</span><span class="op" id="8511753">,</span>&nbsp;<span class="ident" id="8511755">_</span>&nbsp;<span class="op" id="8511757">:=</span>&nbsp;<span class="ident" id="8511760">keysFromMasterSecret</span><span class="op" id="8511780">(</span><span class="ident" id="8511781">test</span><span class="op" id="8511785">.</span><span class="ident" id="8511786">version</span><span class="op" id="8511793">,</span>&nbsp;<span class="ident" id="8511795">masterSecret</span><span class="op" id="8511807">,</span>&nbsp;<span class="ident" id="8511809">clientRandom</span><span class="op" id="8511821">,</span>&nbsp;<span class="ident" id="8511823">serverRandom</span><span class="op" id="8511835">,</span>&nbsp;<span class="ident" id="8511837">test</span><span class="op" id="8511841">.</span><span class="ident" id="8511842">macLen</span><span class="op" id="8511848">,</span>&nbsp;<span class="ident" id="8511850">test</span><span class="op" id="8511854">.</span><span class="ident" id="8511855">keyLen</span><span class="op" id="8511861">,</span>&nbsp;<span class="num" id="8511863">0</span><span class="op" id="8511864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511868">clientMACString</span>&nbsp;<span class="op" id="8511884">:=</span>&nbsp;<span class="ident" id="8511887">hex</span><span class="op" id="8511890">.</span><span class="ident" id="8511891">EncodeToString</span><span class="op" id="8511905">(</span><span class="ident" id="8511906">clientMAC</span><span class="op" id="8511915">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511919">serverMACString</span>&nbsp;<span class="op" id="8511935">:=</span>&nbsp;<span class="ident" id="8511938">hex</span><span class="op" id="8511941">.</span><span class="ident" id="8511942">EncodeToString</span><span class="op" id="8511956">(</span><span class="ident" id="8511957">serverMAC</span><span class="op" id="8511966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511970">clientKeyString</span>&nbsp;<span class="op" id="8511986">:=</span>&nbsp;<span class="ident" id="8511989">hex</span><span class="op" id="8511992">.</span><span class="ident" id="8511993">EncodeToString</span><span class="op" id="8512007">(</span><span class="ident" id="8512008">clientKey</span><span class="op" id="8512017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512021">serverKeyString</span>&nbsp;<span class="op" id="8512037">:=</span>&nbsp;<span class="ident" id="8512040">hex</span><span class="op" id="8512043">.</span><span class="ident" id="8512044">EncodeToString</span><span class="op" id="8512058">(</span><span class="ident" id="8512059">serverKey</span><span class="op" id="8512068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512072">if</span>&nbsp;<span class="ident" id="8512075">clientMACString</span>&nbsp;<span class="op" id="8512091">!=</span>&nbsp;<span class="ident" id="8512094">test</span><span class="op" id="8512098">.</span><span class="ident" id="8512099">clientMAC</span>&nbsp;<span class="op" id="8512109">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512115">serverMACString</span>&nbsp;<span class="op" id="8512131">!=</span>&nbsp;<span class="ident" id="8512134">test</span><span class="op" id="8512138">.</span><span class="ident" id="8512139">serverMAC</span>&nbsp;<span class="op" id="8512149">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512155">clientKeyString</span>&nbsp;<span class="op" id="8512171">!=</span>&nbsp;<span class="ident" id="8512174">test</span><span class="op" id="8512178">.</span><span class="ident" id="8512179">clientKey</span>&nbsp;<span class="op" id="8512189">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512195">serverKeyString</span>&nbsp;<span class="op" id="8512211">!=</span>&nbsp;<span class="ident" id="8512214">test</span><span class="op" id="8512218">.</span><span class="ident" id="8512219">serverKey</span>&nbsp;<span class="op" id="8512229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512234">t</span><span class="op" id="8512235">.</span><span class="ident" id="8512236">Errorf</span><span class="op" id="8512242">(</span><span class="string" id="8512243">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="8512294">,</span>&nbsp;<span class="ident" id="8512296">i</span><span class="op" id="8512297">,</span>&nbsp;<span class="ident" id="8512299">clientMACString</span><span class="op" id="8512314">,</span>&nbsp;<span class="ident" id="8512316">serverMACString</span><span class="op" id="8512331">,</span>&nbsp;<span class="ident" id="8512333">clientKeyString</span><span class="op" id="8512348">,</span>&nbsp;<span class="ident" id="8512350">serverKeyString</span><span class="op" id="8512365">,</span>&nbsp;<span class="ident" id="8512367">test</span><span class="op" id="8512371">.</span><span class="ident" id="8512372">clientMAC</span><span class="op" id="8512381">,</span>&nbsp;<span class="ident" id="8512383">test</span><span class="op" id="8512387">.</span><span class="ident" id="8512388">serverMAC</span><span class="op" id="8512397">,</span>&nbsp;<span class="ident" id="8512399">test</span><span class="op" id="8512403">.</span><span class="ident" id="8512404">clientKey</span><span class="op" id="8512413">,</span>&nbsp;<span class="ident" id="8512415">test</span><span class="op" id="8512419">.</span><span class="ident" id="8512420">serverKey</span><span class="op" id="8512429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512436">}</span><br>
<span class="lineno">70</span><span class="op" id="8512438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8512441">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="8512526">var</span>&nbsp;<span class="ident" id="8512530">testKeysFromTests</span>&nbsp;<span class="op" id="8512548">=</span>&nbsp;<span class="op" id="8512550">[</span><span class="op" id="8512551">]</span><span class="ident" id="8512552">testKeysFromTest</span><span class="op" id="8512568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512571">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512575">VersionTLS10</span><span class="op" id="8512587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8512591">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="8512689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8512693">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="8512759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8512763">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="8512829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8512833">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="8512931">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8512935">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="8512977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8512981">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="8513023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513027">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="8513061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513065">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="8513099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8513103">20</span><span class="op" id="8513105">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8513109">16</span><span class="op" id="8513111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513114">}</span><span class="op" id="8513115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513122">VersionTLS10</span><span class="op" id="8513134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513138">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="8513236">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513240">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="8513306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513310">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="8513376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513380">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="8513478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513482">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="8513524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513528">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="8513570">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513574">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="8513608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513612">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="8513646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8513650">20</span><span class="op" id="8513652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8513656">16</span><span class="op" id="8513658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513661">}</span><span class="op" id="8513662">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513669">VersionTLS10</span><span class="op" id="8513681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513685">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8513943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8513947">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8514013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514017">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8514083">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514087">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="8514185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514189">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="8514231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514235">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="8514277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514281">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="8514315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514319">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="8514353">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8514357">20</span><span class="op" id="8514359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8514363">16</span><span class="op" id="8514365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514368">}</span><span class="op" id="8514369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514376">VersionSSL30</span><span class="op" id="8514388">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514392">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8514650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514654">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8514720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514724">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8514790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514794">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="8514892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514896">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="8514938">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514942">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="8514984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514988">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="8515022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8515026">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="8515060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8515064">20</span><span class="op" id="8515066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8515070">16</span><span class="op" id="8515072">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515075">}</span><span class="op" id="8515076">,</span><br>
<span class="lineno"></span><span class="op" id="8515078">}</span>
</div>
</body>
</html>
