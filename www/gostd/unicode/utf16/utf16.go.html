<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4956456">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4956512">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4956566">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4956617">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="4956688">package</span>&nbsp;<span class="ident" id="4956696">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4956703">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4956766">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="4956821">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4956897">const</span>&nbsp;<span class="op" id="4956903">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956906">replacementChar</span>&nbsp;<span class="op" id="4956922">=</span>&nbsp;<span class="string" id="4956924">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4956937">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956971">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4956987">=</span>&nbsp;<span class="string" id="4956989">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="4957002">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="4957039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4957042">const</span>&nbsp;<span class="op" id="4957048">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957051">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957105">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957158">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957203">surr1</span>&nbsp;<span class="op" id="4957209">=</span>&nbsp;<span class="num" id="4957211">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957219">surr2</span>&nbsp;<span class="op" id="4957225">=</span>&nbsp;<span class="num" id="4957227">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957235">surr3</span>&nbsp;<span class="op" id="4957241">=</span>&nbsp;<span class="num" id="4957243">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957252">surrSelf</span>&nbsp;<span class="op" id="4957261">=</span>&nbsp;<span class="num" id="4957263">0x10000</span><br>
<span class="lineno"></span><span class="op" id="4957271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4957274">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="4957338">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="4957373">func</span>&nbsp;<span class="ident" id="4957378">IsSurrogate</span><span class="op" id="4957389">(</span><span class="ident" id="4957390">r</span>&nbsp;<span class="builtintype" id="4957392">rune</span><span class="op" id="4957396">)</span>&nbsp;<span class="builtintype" id="4957398">bool</span>&nbsp;<span class="op" id="4957403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957406">return</span>&nbsp;<span class="ident" id="4957413">surr1</span>&nbsp;<span class="op" id="4957419">&lt;=</span>&nbsp;<span class="ident" id="4957422">r</span>&nbsp;<span class="op" id="4957424">&amp;&amp;</span>&nbsp;<span class="ident" id="4957427">r</span>&nbsp;<span class="op" id="4957429">&lt;</span>&nbsp;<span class="ident" id="4957431">surr3</span><br>
<span class="lineno"></span><span class="op" id="4957437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4957440">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="4957503">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4957575">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4957621">func</span>&nbsp;<span class="ident" id="4957626">DecodeRune</span><span class="op" id="4957636">(</span><span class="ident" id="4957637">r1</span><span class="op" id="4957639">,</span>&nbsp;<span class="ident" id="4957641">r2</span>&nbsp;<span class="builtintype" id="4957644">rune</span><span class="op" id="4957648">)</span>&nbsp;<span class="builtintype" id="4957650">rune</span>&nbsp;<span class="op" id="4957655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957658">if</span>&nbsp;<span class="ident" id="4957661">surr1</span>&nbsp;<span class="op" id="4957667">&lt;=</span>&nbsp;<span class="ident" id="4957670">r1</span>&nbsp;<span class="op" id="4957673">&amp;&amp;</span>&nbsp;<span class="ident" id="4957676">r1</span>&nbsp;<span class="op" id="4957679">&lt;</span>&nbsp;<span class="ident" id="4957681">surr2</span>&nbsp;<span class="op" id="4957687">&amp;&amp;</span>&nbsp;<span class="ident" id="4957690">surr2</span>&nbsp;<span class="op" id="4957696">&lt;=</span>&nbsp;<span class="ident" id="4957699">r2</span>&nbsp;<span class="op" id="4957702">&amp;&amp;</span>&nbsp;<span class="ident" id="4957705">r2</span>&nbsp;<span class="op" id="4957708">&lt;</span>&nbsp;<span class="ident" id="4957710">surr3</span>&nbsp;<span class="op" id="4957716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957720">return</span>&nbsp;<span class="op" id="4957727">(</span><span class="ident" id="4957728">r1</span><span class="op" id="4957730">-</span><span class="ident" id="4957731">surr1</span><span class="op" id="4957736">)</span><span class="op" id="4957737">&lt;&lt;</span><span class="num" id="4957739">10</span>&nbsp;<span class="op" id="4957742">|</span>&nbsp;<span class="op" id="4957744">(</span><span class="ident" id="4957745">r2</span>&nbsp;<span class="op" id="4957748">-</span>&nbsp;<span class="ident" id="4957750">surr2</span><span class="op" id="4957755">)</span>&nbsp;<span class="op" id="4957757">+</span>&nbsp;<span class="num" id="4957759">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4957768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957771">return</span>&nbsp;<span class="ident" id="4957778">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="4957794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4957797">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="4957872">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="4957948">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4957986">func</span>&nbsp;<span class="ident" id="4957991">EncodeRune</span><span class="op" id="4958001">(</span><span class="ident" id="4958002">r</span>&nbsp;<span class="builtintype" id="4958004">rune</span><span class="op" id="4958008">)</span>&nbsp;<span class="op" id="4958010">(</span><span class="ident" id="4958011">r1</span><span class="op" id="4958013">,</span>&nbsp;<span class="ident" id="4958015">r2</span>&nbsp;<span class="builtintype" id="4958018">rune</span><span class="op" id="4958022">)</span>&nbsp;<span class="op" id="4958024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958027">if</span>&nbsp;<span class="ident" id="4958030">r</span>&nbsp;<span class="op" id="4958032">&lt;</span>&nbsp;<span class="ident" id="4958034">surrSelf</span>&nbsp;<span class="op" id="4958043">||</span>&nbsp;<span class="ident" id="4958046">r</span>&nbsp;<span class="op" id="4958048">&gt;</span>&nbsp;<span class="ident" id="4958050">maxRune</span>&nbsp;<span class="op" id="4958058">||</span>&nbsp;<span class="ident" id="4958061">IsSurrogate</span><span class="op" id="4958072">(</span><span class="ident" id="4958073">r</span><span class="op" id="4958074">)</span>&nbsp;<span class="op" id="4958076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958080">return</span>&nbsp;<span class="ident" id="4958087">replacementChar</span><span class="op" id="4958102">,</span>&nbsp;<span class="ident" id="4958104">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4958121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958124">r</span>&nbsp;<span class="op" id="4958126">-=</span>&nbsp;<span class="ident" id="4958129">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958139">return</span>&nbsp;<span class="ident" id="4958146">surr1</span>&nbsp;<span class="op" id="4958152">+</span>&nbsp;<span class="op" id="4958154">(</span><span class="ident" id="4958155">r</span><span class="op" id="4958156">&gt;&gt;</span><span class="num" id="4958158">10</span><span class="op" id="4958160">)</span><span class="op" id="4958161">&amp;</span><span class="num" id="4958162">0x3ff</span><span class="op" id="4958167">,</span>&nbsp;<span class="ident" id="4958169">surr2</span>&nbsp;<span class="op" id="4958175">+</span>&nbsp;<span class="ident" id="4958177">r</span><span class="op" id="4958178">&amp;</span><span class="num" id="4958179">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="4958185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4958188">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4958264">func</span>&nbsp;<span class="ident" id="4958269">Encode</span><span class="op" id="4958275">(</span><span class="ident" id="4958276">s</span>&nbsp;<span class="op" id="4958278">[</span><span class="op" id="4958279">]</span><span class="builtintype" id="4958280">rune</span><span class="op" id="4958284">)</span>&nbsp;<span class="op" id="4958286">[</span><span class="op" id="4958287">]</span><span class="builtintype" id="4958288">uint16</span>&nbsp;<span class="op" id="4958295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958298">n</span>&nbsp;<span class="op" id="4958300">:=</span>&nbsp;<span class="builtinfunc" id="4958303">len</span><span class="op" id="4958306">(</span><span class="ident" id="4958307">s</span><span class="op" id="4958308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958311">for</span>&nbsp;<span class="ident" id="4958315">_</span><span class="op" id="4958316">,</span>&nbsp;<span class="ident" id="4958318">v</span>&nbsp;<span class="op" id="4958320">:=</span>&nbsp;<span class="keyword" id="4958323">range</span>&nbsp;<span class="ident" id="4958329">s</span>&nbsp;<span class="op" id="4958331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958335">if</span>&nbsp;<span class="ident" id="4958338">v</span>&nbsp;<span class="op" id="4958340">&gt;=</span>&nbsp;<span class="ident" id="4958343">surrSelf</span>&nbsp;<span class="op" id="4958352">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958357">n</span><span class="op" id="4958358">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4958363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4958366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958370">a</span>&nbsp;<span class="op" id="4958372">:=</span>&nbsp;<span class="builtinfunc" id="4958375">make</span><span class="op" id="4958379">(</span><span class="op" id="4958380">[</span><span class="op" id="4958381">]</span><span class="builtintype" id="4958382">uint16</span><span class="op" id="4958388">,</span>&nbsp;<span class="ident" id="4958390">n</span><span class="op" id="4958391">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958394">n</span>&nbsp;<span class="op" id="4958396">=</span>&nbsp;<span class="num" id="4958398">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958401">for</span>&nbsp;<span class="ident" id="4958405">_</span><span class="op" id="4958406">,</span>&nbsp;<span class="ident" id="4958408">v</span>&nbsp;<span class="op" id="4958410">:=</span>&nbsp;<span class="keyword" id="4958413">range</span>&nbsp;<span class="ident" id="4958419">s</span>&nbsp;<span class="op" id="4958421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958425">switch</span>&nbsp;<span class="op" id="4958432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958436">case</span>&nbsp;<span class="ident" id="4958441">v</span>&nbsp;<span class="op" id="4958443">&lt;</span>&nbsp;<span class="num" id="4958445">0</span><span class="op" id="4958446">,</span>&nbsp;<span class="ident" id="4958448">surr1</span>&nbsp;<span class="op" id="4958454">&lt;=</span>&nbsp;<span class="ident" id="4958457">v</span>&nbsp;<span class="op" id="4958459">&amp;&amp;</span>&nbsp;<span class="ident" id="4958462">v</span>&nbsp;<span class="op" id="4958464">&lt;</span>&nbsp;<span class="ident" id="4958466">surr3</span><span class="op" id="4958471">,</span>&nbsp;<span class="ident" id="4958473">v</span>&nbsp;<span class="op" id="4958475">&gt;</span>&nbsp;<span class="ident" id="4958477">maxRune</span><span class="op" id="4958484">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958489">v</span>&nbsp;<span class="op" id="4958491">=</span>&nbsp;<span class="ident" id="4958493">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958512">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958526">case</span>&nbsp;<span class="ident" id="4958531">v</span>&nbsp;<span class="op" id="4958533">&lt;</span>&nbsp;<span class="ident" id="4958535">surrSelf</span><span class="op" id="4958543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958548">a</span><span class="op" id="4958549">[</span><span class="ident" id="4958550">n</span><span class="op" id="4958551">]</span>&nbsp;<span class="op" id="4958553">=</span>&nbsp;<span class="builtintype" id="4958555">uint16</span><span class="op" id="4958561">(</span><span class="ident" id="4958562">v</span><span class="op" id="4958563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958568">n</span><span class="op" id="4958569">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958574">default</span><span class="op" id="4958581">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958586">r1</span><span class="op" id="4958588">,</span>&nbsp;<span class="ident" id="4958590">r2</span>&nbsp;<span class="op" id="4958593">:=</span>&nbsp;<span class="ident" id="4958596">EncodeRune</span><span class="op" id="4958606">(</span><span class="ident" id="4958607">v</span><span class="op" id="4958608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958613">a</span><span class="op" id="4958614">[</span><span class="ident" id="4958615">n</span><span class="op" id="4958616">]</span>&nbsp;<span class="op" id="4958618">=</span>&nbsp;<span class="builtintype" id="4958620">uint16</span><span class="op" id="4958626">(</span><span class="ident" id="4958627">r1</span><span class="op" id="4958629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958634">a</span><span class="op" id="4958635">[</span><span class="ident" id="4958636">n</span><span class="op" id="4958637">+</span><span class="num" id="4958638">1</span><span class="op" id="4958639">]</span>&nbsp;<span class="op" id="4958641">=</span>&nbsp;<span class="builtintype" id="4958643">uint16</span><span class="op" id="4958649">(</span><span class="ident" id="4958650">r2</span><span class="op" id="4958652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958657">n</span>&nbsp;<span class="op" id="4958659">+=</span>&nbsp;<span class="num" id="4958662">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4958666">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4958669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958672">return</span>&nbsp;<span class="ident" id="4958679">a</span><span class="op" id="4958680">[</span><span class="num" id="4958681">0</span><span class="op" id="4958682">:</span><span class="ident" id="4958683">n</span><span class="op" id="4958684">]</span><br>
<span class="lineno"></span><span class="op" id="4958686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4958689">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="4958751">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4958780">func</span>&nbsp;<span class="ident" id="4958785">Decode</span><span class="op" id="4958791">(</span><span class="ident" id="4958792">s</span>&nbsp;<span class="op" id="4958794">[</span><span class="op" id="4958795">]</span><span class="builtintype" id="4958796">uint16</span><span class="op" id="4958802">)</span>&nbsp;<span class="op" id="4958804">[</span><span class="op" id="4958805">]</span><span class="builtintype" id="4958806">rune</span>&nbsp;<span class="op" id="4958811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958814">a</span>&nbsp;<span class="op" id="4958816">:=</span>&nbsp;<span class="builtinfunc" id="4958819">make</span><span class="op" id="4958823">(</span><span class="op" id="4958824">[</span><span class="op" id="4958825">]</span><span class="builtintype" id="4958826">rune</span><span class="op" id="4958830">,</span>&nbsp;<span class="builtinfunc" id="4958832">len</span><span class="op" id="4958835">(</span><span class="ident" id="4958836">s</span><span class="op" id="4958837">)</span><span class="op" id="4958838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958841">n</span>&nbsp;<span class="op" id="4958843">:=</span>&nbsp;<span class="num" id="4958846">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958849">for</span>&nbsp;<span class="ident" id="4958853">i</span>&nbsp;<span class="op" id="4958855">:=</span>&nbsp;<span class="num" id="4958858">0</span><span class="op" id="4958859">;</span>&nbsp;<span class="ident" id="4958861">i</span>&nbsp;<span class="op" id="4958863">&lt;</span>&nbsp;<span class="builtinfunc" id="4958865">len</span><span class="op" id="4958868">(</span><span class="ident" id="4958869">s</span><span class="op" id="4958870">)</span><span class="op" id="4958871">;</span>&nbsp;<span class="ident" id="4958873">i</span><span class="op" id="4958874">++</span>&nbsp;<span class="op" id="4958877">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958881">switch</span>&nbsp;<span class="ident" id="4958888">r</span>&nbsp;<span class="op" id="4958890">:=</span>&nbsp;<span class="ident" id="4958893">s</span><span class="op" id="4958894">[</span><span class="ident" id="4958895">i</span><span class="op" id="4958896">]</span><span class="op" id="4958897">;</span>&nbsp;<span class="op" id="4958899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958903">case</span>&nbsp;<span class="ident" id="4958908">surr1</span>&nbsp;<span class="op" id="4958914">&lt;=</span>&nbsp;<span class="ident" id="4958917">r</span>&nbsp;<span class="op" id="4958919">&amp;&amp;</span>&nbsp;<span class="ident" id="4958922">r</span>&nbsp;<span class="op" id="4958924">&lt;</span>&nbsp;<span class="ident" id="4958926">surr2</span>&nbsp;<span class="op" id="4958932">&amp;&amp;</span>&nbsp;<span class="ident" id="4958935">i</span><span class="op" id="4958936">+</span><span class="num" id="4958937">1</span>&nbsp;<span class="op" id="4958939">&lt;</span>&nbsp;<span class="builtinfunc" id="4958941">len</span><span class="op" id="4958944">(</span><span class="ident" id="4958945">s</span><span class="op" id="4958946">)</span>&nbsp;<span class="op" id="4958948">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958954">surr2</span>&nbsp;<span class="op" id="4958960">&lt;=</span>&nbsp;<span class="ident" id="4958963">s</span><span class="op" id="4958964">[</span><span class="ident" id="4958965">i</span><span class="op" id="4958966">+</span><span class="num" id="4958967">1</span><span class="op" id="4958968">]</span>&nbsp;<span class="op" id="4958970">&amp;&amp;</span>&nbsp;<span class="ident" id="4958973">s</span><span class="op" id="4958974">[</span><span class="ident" id="4958975">i</span><span class="op" id="4958976">+</span><span class="num" id="4958977">1</span><span class="op" id="4958978">]</span>&nbsp;<span class="op" id="4958980">&lt;</span>&nbsp;<span class="ident" id="4958982">surr3</span><span class="op" id="4958987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4958992">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959023">a</span><span class="op" id="4959024">[</span><span class="ident" id="4959025">n</span><span class="op" id="4959026">]</span>&nbsp;<span class="op" id="4959028">=</span>&nbsp;<span class="ident" id="4959030">DecodeRune</span><span class="op" id="4959040">(</span><span class="builtintype" id="4959041">rune</span><span class="op" id="4959045">(</span><span class="ident" id="4959046">r</span><span class="op" id="4959047">)</span><span class="op" id="4959048">,</span>&nbsp;<span class="builtintype" id="4959050">rune</span><span class="op" id="4959054">(</span><span class="ident" id="4959055">s</span><span class="op" id="4959056">[</span><span class="ident" id="4959057">i</span><span class="op" id="4959058">+</span><span class="num" id="4959059">1</span><span class="op" id="4959060">]</span><span class="op" id="4959061">)</span><span class="op" id="4959062">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959067">i</span><span class="op" id="4959068">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959074">n</span><span class="op" id="4959075">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4959080">case</span>&nbsp;<span class="ident" id="4959085">surr1</span>&nbsp;<span class="op" id="4959091">&lt;=</span>&nbsp;<span class="ident" id="4959094">r</span>&nbsp;<span class="op" id="4959096">&amp;&amp;</span>&nbsp;<span class="ident" id="4959099">r</span>&nbsp;<span class="op" id="4959101">&lt;</span>&nbsp;<span class="ident" id="4959103">surr3</span><span class="op" id="4959108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4959113">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959146">a</span><span class="op" id="4959147">[</span><span class="ident" id="4959148">n</span><span class="op" id="4959149">]</span>&nbsp;<span class="op" id="4959151">=</span>&nbsp;<span class="ident" id="4959153">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959172">n</span><span class="op" id="4959173">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4959178">default</span><span class="op" id="4959185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4959190">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959208">a</span><span class="op" id="4959209">[</span><span class="ident" id="4959210">n</span><span class="op" id="4959211">]</span>&nbsp;<span class="op" id="4959213">=</span>&nbsp;<span class="builtintype" id="4959215">rune</span><span class="op" id="4959219">(</span><span class="ident" id="4959220">r</span><span class="op" id="4959221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4959226">n</span><span class="op" id="4959227">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4959232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4959235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4959238">return</span>&nbsp;<span class="ident" id="4959245">a</span><span class="op" id="4959246">[</span><span class="num" id="4959247">0</span><span class="op" id="4959248">:</span><span class="ident" id="4959249">n</span><span class="op" id="4959250">]</span><br>
<span class="lineno"></span><span class="op" id="4959252">}</span>
</div>
</body>
</html>
