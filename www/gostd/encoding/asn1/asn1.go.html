<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3862816">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3862871">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3862925">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3862976">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="3863049">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="3863083">//</span><br>
<span class="lineno"></span><span class="comment" id="3863086">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3863155">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="3863207">package</span>&nbsp;<span class="ident" id="3863215">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3863221">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="3863301">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="3863377">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="3863453">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="3863532">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="3863607">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3863679">//</span><br>
<span class="lineno"></span><span class="comment" id="3863682">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="3863753">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3863782">import</span>&nbsp;<span class="op" id="3863789">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3863792">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3863799">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3863811">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3863822">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3863833">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3863840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="3863843">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="3863919">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3863959">type</span>&nbsp;<span class="ident" id="3863964">StructuralError</span>&nbsp;<span class="keyword" id="3863980">struct</span>&nbsp;<span class="op" id="3863987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863990">Msg</span>&nbsp;<span class="builtintype" id="3863994">string</span><br>
<span class="lineno"></span><span class="op" id="3864001">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3864004">func</span>&nbsp;<span class="op" id="3864009">(</span><span class="ident" id="3864010">e</span>&nbsp;<span class="ident" id="3864012">StructuralError</span><span class="op" id="3864027">)</span>&nbsp;<span class="ident" id="3864029">Error</span><span class="op" id="3864034">(</span><span class="op" id="3864035">)</span>&nbsp;<span class="builtintype" id="3864037">string</span>&nbsp;<span class="op" id="3864044">{</span>&nbsp;<span class="keyword" id="3864046">return</span>&nbsp;<span class="string" id="3864053">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="3864079">+</span>&nbsp;<span class="ident" id="3864081">e</span><span class="op" id="3864082">.</span><span class="ident" id="3864083">Msg</span>&nbsp;<span class="op" id="3864087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3864090">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="3864148">type</span>&nbsp;<span class="ident" id="3864153">SyntaxError</span>&nbsp;<span class="keyword" id="3864165">struct</span>&nbsp;<span class="op" id="3864172">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864175">Msg</span>&nbsp;<span class="builtintype" id="3864179">string</span><br>
<span class="lineno"></span><span class="op" id="3864186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3864189">func</span>&nbsp;<span class="op" id="3864194">(</span><span class="ident" id="3864195">e</span>&nbsp;<span class="ident" id="3864197">SyntaxError</span><span class="op" id="3864208">)</span>&nbsp;<span class="ident" id="3864210">Error</span><span class="op" id="3864215">(</span><span class="op" id="3864216">)</span>&nbsp;<span class="builtintype" id="3864218">string</span>&nbsp;<span class="op" id="3864225">{</span>&nbsp;<span class="keyword" id="3864227">return</span>&nbsp;<span class="string" id="3864234">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="3864257">+</span>&nbsp;<span class="ident" id="3864259">e</span><span class="op" id="3864260">.</span><span class="ident" id="3864261">Msg</span>&nbsp;<span class="op" id="3864265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3864268">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3864334">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3864346">func</span>&nbsp;<span class="ident" id="3864351">parseBool</span><span class="op" id="3864360">(</span><span class="ident" id="3864361">bytes</span>&nbsp;<span class="op" id="3864367">[</span><span class="op" id="3864368">]</span><span class="builtintype" id="3864369">byte</span><span class="op" id="3864373">)</span>&nbsp;<span class="op" id="3864375">(</span><span class="ident" id="3864376">ret</span>&nbsp;<span class="builtintype" id="3864380">bool</span><span class="op" id="3864384">,</span>&nbsp;<span class="ident" id="3864386">err</span>&nbsp;<span class="builtintype" id="3864390">error</span><span class="op" id="3864395">)</span>&nbsp;<span class="op" id="3864397">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864400">if</span>&nbsp;<span class="builtinfunc" id="3864403">len</span><span class="op" id="3864406">(</span><span class="ident" id="3864407">bytes</span><span class="op" id="3864412">)</span>&nbsp;<span class="op" id="3864414">!=</span>&nbsp;<span class="num" id="3864417">1</span>&nbsp;<span class="op" id="3864419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864423">err</span>&nbsp;<span class="op" id="3864427">=</span>&nbsp;<span class="ident" id="3864429">SyntaxError</span><span class="op" id="3864440">{</span><span class="string" id="3864441">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="3864458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864462">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3864474">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3864547">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3864616">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864666">switch</span>&nbsp;<span class="ident" id="3864673">bytes</span><span class="op" id="3864678">[</span><span class="num" id="3864679">0</span><span class="op" id="3864680">]</span>&nbsp;<span class="op" id="3864682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864685">case</span>&nbsp;<span class="num" id="3864690">0</span><span class="op" id="3864691">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864695">ret</span>&nbsp;<span class="op" id="3864699">=</span>&nbsp;<span class="builtintype" id="3864701">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864708">case</span>&nbsp;<span class="num" id="3864713">0xff</span><span class="op" id="3864717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864721">ret</span>&nbsp;<span class="op" id="3864725">=</span>&nbsp;<span class="builtintype" id="3864727">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864733">default</span><span class="op" id="3864740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864744">err</span>&nbsp;<span class="op" id="3864748">=</span>&nbsp;<span class="ident" id="3864750">SyntaxError</span><span class="op" id="3864761">{</span><span class="string" id="3864762">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="3864779">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864786">return</span><br>
<span class="lineno"></span><span class="op" id="3864793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="3864796">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3864808">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3864881">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3864904">func</span>&nbsp;<span class="ident" id="3864909">parseInt64</span><span class="op" id="3864919">(</span><span class="ident" id="3864920">bytes</span>&nbsp;<span class="op" id="3864926">[</span><span class="op" id="3864927">]</span><span class="builtintype" id="3864928">byte</span><span class="op" id="3864932">)</span>&nbsp;<span class="op" id="3864934">(</span><span class="ident" id="3864935">ret</span>&nbsp;<span class="ident" id="3864939">int64</span><span class="op" id="3864944">,</span>&nbsp;<span class="ident" id="3864946">err</span>&nbsp;<span class="builtintype" id="3864950">error</span><span class="op" id="3864955">)</span>&nbsp;<span class="op" id="3864957">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864960">if</span>&nbsp;<span class="builtinfunc" id="3864963">len</span><span class="op" id="3864966">(</span><span class="ident" id="3864967">bytes</span><span class="op" id="3864972">)</span>&nbsp;<span class="op" id="3864974">&gt;</span>&nbsp;<span class="num" id="3864976">8</span>&nbsp;<span class="op" id="3864978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3864982">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865025">err</span>&nbsp;<span class="op" id="3865029">=</span>&nbsp;<span class="ident" id="3865031">StructuralError</span><span class="op" id="3865046">{</span><span class="string" id="3865047">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3865066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865070">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865078">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865081">for</span>&nbsp;<span class="ident" id="3865085">bytesRead</span>&nbsp;<span class="op" id="3865095">:=</span>&nbsp;<span class="num" id="3865098">0</span><span class="op" id="3865099">;</span>&nbsp;<span class="ident" id="3865101">bytesRead</span>&nbsp;<span class="op" id="3865111">&lt;</span>&nbsp;<span class="builtinfunc" id="3865113">len</span><span class="op" id="3865116">(</span><span class="ident" id="3865117">bytes</span><span class="op" id="3865122">)</span><span class="op" id="3865123">;</span>&nbsp;<span class="ident" id="3865125">bytesRead</span><span class="op" id="3865134">++</span>&nbsp;<span class="op" id="3865137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865141">ret</span>&nbsp;<span class="op" id="3865145">&lt;&lt;=</span>&nbsp;<span class="num" id="3865149">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865153">ret</span>&nbsp;<span class="op" id="3865157">|=</span>&nbsp;<span class="ident" id="3865160">int64</span><span class="op" id="3865165">(</span><span class="ident" id="3865166">bytes</span><span class="op" id="3865171">[</span><span class="ident" id="3865172">bytesRead</span><span class="op" id="3865181">]</span><span class="op" id="3865182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3865189">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865247">ret</span>&nbsp;<span class="op" id="3865251">&lt;&lt;=</span>&nbsp;<span class="num" id="3865255">64</span>&nbsp;<span class="op" id="3865258">-</span>&nbsp;<span class="builtintype" id="3865260">uint8</span><span class="op" id="3865265">(</span><span class="builtinfunc" id="3865266">len</span><span class="op" id="3865269">(</span><span class="ident" id="3865270">bytes</span><span class="op" id="3865275">)</span><span class="op" id="3865276">)</span><span class="op" id="3865277">*</span><span class="num" id="3865278">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865281">ret</span>&nbsp;<span class="op" id="3865285">&gt;&gt;=</span>&nbsp;<span class="num" id="3865289">64</span>&nbsp;<span class="op" id="3865292">-</span>&nbsp;<span class="builtintype" id="3865294">uint8</span><span class="op" id="3865299">(</span><span class="builtinfunc" id="3865300">len</span><span class="op" id="3865303">(</span><span class="ident" id="3865304">bytes</span><span class="op" id="3865309">)</span><span class="op" id="3865310">)</span><span class="op" id="3865311">*</span><span class="num" id="3865312">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865315">return</span><br>
<span class="lineno"></span><span class="op" id="3865322">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="3865325">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3865404">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3865419">func</span>&nbsp;<span class="ident" id="3865424">parseInt32</span><span class="op" id="3865434">(</span><span class="ident" id="3865435">bytes</span>&nbsp;<span class="op" id="3865441">[</span><span class="op" id="3865442">]</span><span class="builtintype" id="3865443">byte</span><span class="op" id="3865447">)</span>&nbsp;<span class="op" id="3865449">(</span><span class="builtintype" id="3865450">int32</span><span class="op" id="3865455">,</span>&nbsp;<span class="builtintype" id="3865457">error</span><span class="op" id="3865462">)</span>&nbsp;<span class="op" id="3865464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865467">ret64</span><span class="op" id="3865472">,</span>&nbsp;<span class="ident" id="3865474">err</span>&nbsp;<span class="op" id="3865478">:=</span>&nbsp;<span class="ident" id="3865481">parseInt64</span><span class="op" id="3865491">(</span><span class="ident" id="3865492">bytes</span><span class="op" id="3865497">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865500">if</span>&nbsp;<span class="ident" id="3865503">err</span>&nbsp;<span class="op" id="3865507">!=</span>&nbsp;<span class="ident" id="3865510">nil</span>&nbsp;<span class="op" id="3865514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865518">return</span>&nbsp;<span class="num" id="3865525">0</span><span class="op" id="3865526">,</span>&nbsp;<span class="ident" id="3865528">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865536">if</span>&nbsp;<span class="ident" id="3865539">ret64</span>&nbsp;<span class="op" id="3865545">!=</span>&nbsp;<span class="ident" id="3865548">int64</span><span class="op" id="3865553">(</span><span class="builtintype" id="3865554">int32</span><span class="op" id="3865559">(</span><span class="ident" id="3865560">ret64</span><span class="op" id="3865565">)</span><span class="op" id="3865566">)</span>&nbsp;<span class="op" id="3865568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865572">return</span>&nbsp;<span class="num" id="3865579">0</span><span class="op" id="3865580">,</span>&nbsp;<span class="ident" id="3865582">StructuralError</span><span class="op" id="3865597">{</span><span class="string" id="3865598">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3865617">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865623">return</span>&nbsp;<span class="builtintype" id="3865630">int32</span><span class="op" id="3865635">(</span><span class="ident" id="3865636">ret64</span><span class="op" id="3865641">)</span><span class="op" id="3865642">,</span>&nbsp;<span class="ident" id="3865644">nil</span><br>
<span class="lineno"></span><span class="op" id="3865648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3865651">var</span>&nbsp;<span class="ident" id="3865655">bigOne</span>&nbsp;<span class="op" id="3865662">=</span>&nbsp;<span class="ident" id="3865664">big</span><span class="op" id="3865667">.</span><span class="ident" id="3865668">NewInt</span><span class="op" id="3865674">(</span><span class="num" id="3865675">1</span><span class="op" id="3865676">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3865679">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3865761">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="3865776">func</span>&nbsp;<span class="ident" id="3865781">parseBigInt</span><span class="op" id="3865792">(</span><span class="ident" id="3865793">bytes</span>&nbsp;<span class="op" id="3865799">[</span><span class="op" id="3865800">]</span><span class="builtintype" id="3865801">byte</span><span class="op" id="3865805">)</span>&nbsp;<span class="op" id="3865807">*</span><span class="ident" id="3865808">big</span><span class="op" id="3865811">.</span><span class="ident" id="3865812">Int</span>&nbsp;<span class="op" id="3865816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865819">ret</span>&nbsp;<span class="op" id="3865823">:=</span>&nbsp;<span class="builtinfunc" id="3865826">new</span><span class="op" id="3865829">(</span><span class="ident" id="3865830">big</span><span class="op" id="3865833">.</span><span class="ident" id="3865834">Int</span><span class="op" id="3865837">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865840">if</span>&nbsp;<span class="builtinfunc" id="3865843">len</span><span class="op" id="3865846">(</span><span class="ident" id="3865847">bytes</span><span class="op" id="3865852">)</span>&nbsp;<span class="op" id="3865854">&gt;</span>&nbsp;<span class="num" id="3865856">0</span>&nbsp;<span class="op" id="3865858">&amp;&amp;</span>&nbsp;<span class="ident" id="3865861">bytes</span><span class="op" id="3865866">[</span><span class="num" id="3865867">0</span><span class="op" id="3865868">]</span><span class="op" id="3865869">&amp;</span><span class="num" id="3865870">0x80</span>&nbsp;<span class="op" id="3865875">==</span>&nbsp;<span class="num" id="3865878">0x80</span>&nbsp;<span class="op" id="3865883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3865887">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865919">notBytes</span>&nbsp;<span class="op" id="3865928">:=</span>&nbsp;<span class="builtinfunc" id="3865931">make</span><span class="op" id="3865935">(</span><span class="op" id="3865936">[</span><span class="op" id="3865937">]</span><span class="builtintype" id="3865938">byte</span><span class="op" id="3865942">,</span>&nbsp;<span class="builtinfunc" id="3865944">len</span><span class="op" id="3865947">(</span><span class="ident" id="3865948">bytes</span><span class="op" id="3865953">)</span><span class="op" id="3865954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865958">for</span>&nbsp;<span class="ident" id="3865962">i</span>&nbsp;<span class="op" id="3865964">:=</span>&nbsp;<span class="keyword" id="3865967">range</span>&nbsp;<span class="ident" id="3865973">notBytes</span>&nbsp;<span class="op" id="3865982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865987">notBytes</span><span class="op" id="3865995">[</span><span class="ident" id="3865996">i</span><span class="op" id="3865997">]</span>&nbsp;<span class="op" id="3865999">=</span>&nbsp;<span class="op" id="3866001">^</span><span class="ident" id="3866002">bytes</span><span class="op" id="3866007">[</span><span class="ident" id="3866008">i</span><span class="op" id="3866009">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866017">ret</span><span class="op" id="3866020">.</span><span class="ident" id="3866021">SetBytes</span><span class="op" id="3866029">(</span><span class="ident" id="3866030">notBytes</span><span class="op" id="3866038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866042">ret</span><span class="op" id="3866045">.</span><span class="ident" id="3866046">Add</span><span class="op" id="3866049">(</span><span class="ident" id="3866050">ret</span><span class="op" id="3866053">,</span>&nbsp;<span class="ident" id="3866055">bigOne</span><span class="op" id="3866061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866065">ret</span><span class="op" id="3866068">.</span><span class="ident" id="3866069">Neg</span><span class="op" id="3866072">(</span><span class="ident" id="3866073">ret</span><span class="op" id="3866076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866080">return</span>&nbsp;<span class="ident" id="3866087">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866095">ret</span><span class="op" id="3866098">.</span><span class="ident" id="3866099">SetBytes</span><span class="op" id="3866107">(</span><span class="ident" id="3866108">bytes</span><span class="op" id="3866113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866116">return</span>&nbsp;<span class="ident" id="3866123">ret</span><br>
<span class="lineno"></span><span class="op" id="3866127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3866130">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3866145">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="3866224">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3866299">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="3866353">type</span>&nbsp;<span class="ident" id="3866358">BitString</span>&nbsp;<span class="keyword" id="3866368">struct</span>&nbsp;<span class="op" id="3866375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866378">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3866388">[</span><span class="op" id="3866389">]</span><span class="builtintype" id="3866390">byte</span>&nbsp;<span class="comment" id="3866395">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866423">BitLength</span>&nbsp;<span class="builtintype" id="3866433">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3866440">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="3866459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3866462">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3866536">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="3866554">func</span>&nbsp;<span class="op" id="3866559">(</span><span class="ident" id="3866560">b</span>&nbsp;<span class="ident" id="3866562">BitString</span><span class="op" id="3866571">)</span>&nbsp;<span class="ident" id="3866573">At</span><span class="op" id="3866575">(</span><span class="ident" id="3866576">i</span>&nbsp;<span class="builtintype" id="3866578">int</span><span class="op" id="3866581">)</span>&nbsp;<span class="builtintype" id="3866583">int</span>&nbsp;<span class="op" id="3866587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866590">if</span>&nbsp;<span class="ident" id="3866593">i</span>&nbsp;<span class="op" id="3866595">&lt;</span>&nbsp;<span class="num" id="3866597">0</span>&nbsp;<span class="op" id="3866599">||</span>&nbsp;<span class="ident" id="3866602">i</span>&nbsp;<span class="op" id="3866604">&gt;=</span>&nbsp;<span class="ident" id="3866607">b</span><span class="op" id="3866608">.</span><span class="ident" id="3866609">BitLength</span>&nbsp;<span class="op" id="3866619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866623">return</span>&nbsp;<span class="num" id="3866630">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866636">x</span>&nbsp;<span class="op" id="3866638">:=</span>&nbsp;<span class="ident" id="3866641">i</span>&nbsp;<span class="op" id="3866643">/</span>&nbsp;<span class="num" id="3866645">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866648">y</span>&nbsp;<span class="op" id="3866650">:=</span>&nbsp;<span class="num" id="3866653">7</span>&nbsp;<span class="op" id="3866655">-</span>&nbsp;<span class="builtintype" id="3866657">uint</span><span class="op" id="3866661">(</span><span class="ident" id="3866662">i</span><span class="op" id="3866663">%</span><span class="num" id="3866664">8</span><span class="op" id="3866665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866668">return</span>&nbsp;<span class="builtintype" id="3866675">int</span><span class="op" id="3866678">(</span><span class="ident" id="3866679">b</span><span class="op" id="3866680">.</span><span class="ident" id="3866681">Bytes</span><span class="op" id="3866686">[</span><span class="ident" id="3866687">x</span><span class="op" id="3866688">]</span><span class="op" id="3866689">&gt;&gt;</span><span class="ident" id="3866691">y</span><span class="op" id="3866692">)</span>&nbsp;<span class="op" id="3866694">&amp;</span>&nbsp;<span class="num" id="3866696">1</span><br>
<span class="lineno"></span><span class="op" id="3866698">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3866701">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3866780">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="3866826">func</span>&nbsp;<span class="op" id="3866831">(</span><span class="ident" id="3866832">b</span>&nbsp;<span class="ident" id="3866834">BitString</span><span class="op" id="3866843">)</span>&nbsp;<span class="ident" id="3866845">RightAlign</span><span class="op" id="3866855">(</span><span class="op" id="3866856">)</span>&nbsp;<span class="op" id="3866858">[</span><span class="op" id="3866859">]</span><span class="builtintype" id="3866860">byte</span>&nbsp;<span class="op" id="3866865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866868">shift</span>&nbsp;<span class="op" id="3866874">:=</span>&nbsp;<span class="builtintype" id="3866877">uint</span><span class="op" id="3866881">(</span><span class="num" id="3866882">8</span>&nbsp;<span class="op" id="3866884">-</span>&nbsp;<span class="op" id="3866886">(</span><span class="ident" id="3866887">b</span><span class="op" id="3866888">.</span><span class="ident" id="3866889">BitLength</span>&nbsp;<span class="op" id="3866899">%</span>&nbsp;<span class="num" id="3866901">8</span><span class="op" id="3866902">)</span><span class="op" id="3866903">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866906">if</span>&nbsp;<span class="ident" id="3866909">shift</span>&nbsp;<span class="op" id="3866915">==</span>&nbsp;<span class="num" id="3866918">8</span>&nbsp;<span class="op" id="3866920">||</span>&nbsp;<span class="builtinfunc" id="3866923">len</span><span class="op" id="3866926">(</span><span class="ident" id="3866927">b</span><span class="op" id="3866928">.</span><span class="ident" id="3866929">Bytes</span><span class="op" id="3866934">)</span>&nbsp;<span class="op" id="3866936">==</span>&nbsp;<span class="num" id="3866939">0</span>&nbsp;<span class="op" id="3866941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3866945">return</span>&nbsp;<span class="ident" id="3866952">b</span><span class="op" id="3866953">.</span><span class="ident" id="3866954">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3866961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866965">a</span>&nbsp;<span class="op" id="3866967">:=</span>&nbsp;<span class="builtinfunc" id="3866970">make</span><span class="op" id="3866974">(</span><span class="op" id="3866975">[</span><span class="op" id="3866976">]</span><span class="builtintype" id="3866977">byte</span><span class="op" id="3866981">,</span>&nbsp;<span class="builtinfunc" id="3866983">len</span><span class="op" id="3866986">(</span><span class="ident" id="3866987">b</span><span class="op" id="3866988">.</span><span class="ident" id="3866989">Bytes</span><span class="op" id="3866994">)</span><span class="op" id="3866995">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3866998">a</span><span class="op" id="3866999">[</span><span class="num" id="3867000">0</span><span class="op" id="3867001">]</span>&nbsp;<span class="op" id="3867003">=</span>&nbsp;<span class="ident" id="3867005">b</span><span class="op" id="3867006">.</span><span class="ident" id="3867007">Bytes</span><span class="op" id="3867012">[</span><span class="num" id="3867013">0</span><span class="op" id="3867014">]</span>&nbsp;<span class="op" id="3867016">&gt;&gt;</span>&nbsp;<span class="ident" id="3867019">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867026">for</span>&nbsp;<span class="ident" id="3867030">i</span>&nbsp;<span class="op" id="3867032">:=</span>&nbsp;<span class="num" id="3867035">1</span><span class="op" id="3867036">;</span>&nbsp;<span class="ident" id="3867038">i</span>&nbsp;<span class="op" id="3867040">&lt;</span>&nbsp;<span class="builtinfunc" id="3867042">len</span><span class="op" id="3867045">(</span><span class="ident" id="3867046">b</span><span class="op" id="3867047">.</span><span class="ident" id="3867048">Bytes</span><span class="op" id="3867053">)</span><span class="op" id="3867054">;</span>&nbsp;<span class="ident" id="3867056">i</span><span class="op" id="3867057">++</span>&nbsp;<span class="op" id="3867060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867064">a</span><span class="op" id="3867065">[</span><span class="ident" id="3867066">i</span><span class="op" id="3867067">]</span>&nbsp;<span class="op" id="3867069">=</span>&nbsp;<span class="ident" id="3867071">b</span><span class="op" id="3867072">.</span><span class="ident" id="3867073">Bytes</span><span class="op" id="3867078">[</span><span class="ident" id="3867079">i</span><span class="op" id="3867080">-</span><span class="num" id="3867081">1</span><span class="op" id="3867082">]</span>&nbsp;<span class="op" id="3867084">&lt;&lt;</span>&nbsp;<span class="op" id="3867087">(</span><span class="num" id="3867088">8</span>&nbsp;<span class="op" id="3867090">-</span>&nbsp;<span class="ident" id="3867092">shift</span><span class="op" id="3867097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867101">a</span><span class="op" id="3867102">[</span><span class="ident" id="3867103">i</span><span class="op" id="3867104">]</span>&nbsp;<span class="op" id="3867106">|=</span>&nbsp;<span class="ident" id="3867109">b</span><span class="op" id="3867110">.</span><span class="ident" id="3867111">Bytes</span><span class="op" id="3867116">[</span><span class="ident" id="3867117">i</span><span class="op" id="3867118">]</span>&nbsp;<span class="op" id="3867120">&gt;&gt;</span>&nbsp;<span class="ident" id="3867123">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867130">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867134">return</span>&nbsp;<span class="ident" id="3867141">a</span><br>
<span class="lineno"></span><span class="op" id="3867143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3867146">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="3867233">func</span>&nbsp;<span class="ident" id="3867238">parseBitString</span><span class="op" id="3867252">(</span><span class="ident" id="3867253">bytes</span>&nbsp;<span class="op" id="3867259">[</span><span class="op" id="3867260">]</span><span class="builtintype" id="3867261">byte</span><span class="op" id="3867265">)</span>&nbsp;<span class="op" id="3867267">(</span><span class="ident" id="3867268">ret</span>&nbsp;<span class="ident" id="3867272">BitString</span><span class="op" id="3867281">,</span>&nbsp;<span class="ident" id="3867283">err</span>&nbsp;<span class="builtintype" id="3867287">error</span><span class="op" id="3867292">)</span>&nbsp;<span class="op" id="3867294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867297">if</span>&nbsp;<span class="builtinfunc" id="3867300">len</span><span class="op" id="3867303">(</span><span class="ident" id="3867304">bytes</span><span class="op" id="3867309">)</span>&nbsp;<span class="op" id="3867311">==</span>&nbsp;<span class="num" id="3867314">0</span>&nbsp;<span class="op" id="3867316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867320">err</span>&nbsp;<span class="op" id="3867324">=</span>&nbsp;<span class="ident" id="3867326">SyntaxError</span><span class="op" id="3867337">{</span><span class="string" id="3867338">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="3867362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867366">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867374">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867377">paddingBits</span>&nbsp;<span class="op" id="3867389">:=</span>&nbsp;<span class="builtintype" id="3867392">int</span><span class="op" id="3867395">(</span><span class="ident" id="3867396">bytes</span><span class="op" id="3867401">[</span><span class="num" id="3867402">0</span><span class="op" id="3867403">]</span><span class="op" id="3867404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867407">if</span>&nbsp;<span class="ident" id="3867410">paddingBits</span>&nbsp;<span class="op" id="3867422">&gt;</span>&nbsp;<span class="num" id="3867424">7</span>&nbsp;<span class="op" id="3867426">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3867431">len</span><span class="op" id="3867434">(</span><span class="ident" id="3867435">bytes</span><span class="op" id="3867440">)</span>&nbsp;<span class="op" id="3867442">==</span>&nbsp;<span class="num" id="3867445">1</span>&nbsp;<span class="op" id="3867447">&amp;&amp;</span>&nbsp;<span class="ident" id="3867450">paddingBits</span>&nbsp;<span class="op" id="3867462">&gt;</span>&nbsp;<span class="num" id="3867464">0</span>&nbsp;<span class="op" id="3867466">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867471">bytes</span><span class="op" id="3867476">[</span><span class="builtinfunc" id="3867477">len</span><span class="op" id="3867480">(</span><span class="ident" id="3867481">bytes</span><span class="op" id="3867486">)</span><span class="op" id="3867487">-</span><span class="num" id="3867488">1</span><span class="op" id="3867489">]</span><span class="op" id="3867490">&amp;</span><span class="op" id="3867491">(</span><span class="op" id="3867492">(</span><span class="num" id="3867493">1</span><span class="op" id="3867494">&lt;&lt;</span><span class="ident" id="3867496">bytes</span><span class="op" id="3867501">[</span><span class="num" id="3867502">0</span><span class="op" id="3867503">]</span><span class="op" id="3867504">)</span><span class="op" id="3867505">-</span><span class="num" id="3867506">1</span><span class="op" id="3867507">)</span>&nbsp;<span class="op" id="3867509">!=</span>&nbsp;<span class="num" id="3867512">0</span>&nbsp;<span class="op" id="3867514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867518">err</span>&nbsp;<span class="op" id="3867522">=</span>&nbsp;<span class="ident" id="3867524">SyntaxError</span><span class="op" id="3867535">{</span><span class="string" id="3867536">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="3867572">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867576">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867587">ret</span><span class="op" id="3867590">.</span><span class="ident" id="3867591">BitLength</span>&nbsp;<span class="op" id="3867601">=</span>&nbsp;<span class="op" id="3867603">(</span><span class="builtinfunc" id="3867604">len</span><span class="op" id="3867607">(</span><span class="ident" id="3867608">bytes</span><span class="op" id="3867613">)</span><span class="op" id="3867614">-</span><span class="num" id="3867615">1</span><span class="op" id="3867616">)</span><span class="op" id="3867617">*</span><span class="num" id="3867618">8</span>&nbsp;<span class="op" id="3867620">-</span>&nbsp;<span class="ident" id="3867622">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3867635">ret</span><span class="op" id="3867638">.</span><span class="ident" id="3867639">Bytes</span>&nbsp;<span class="op" id="3867645">=</span>&nbsp;<span class="ident" id="3867647">bytes</span><span class="op" id="3867652">[</span><span class="num" id="3867653">1</span><span class="op" id="3867654">:</span><span class="op" id="3867655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867658">return</span><br>
<span class="lineno">180</span><span class="op" id="3867665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3867668">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3867690">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="3867752">type</span>&nbsp;<span class="ident" id="3867757">ObjectIdentifier</span>&nbsp;<span class="op" id="3867774">[</span><span class="op" id="3867775">]</span><span class="builtintype" id="3867776">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3867781">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="3867850">func</span>&nbsp;<span class="op" id="3867855">(</span><span class="ident" id="3867856">oi</span>&nbsp;<span class="ident" id="3867859">ObjectIdentifier</span><span class="op" id="3867875">)</span>&nbsp;<span class="ident" id="3867877">Equal</span><span class="op" id="3867882">(</span><span class="ident" id="3867883">other</span>&nbsp;<span class="ident" id="3867889">ObjectIdentifier</span><span class="op" id="3867905">)</span>&nbsp;<span class="builtintype" id="3867907">bool</span>&nbsp;<span class="op" id="3867912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867915">if</span>&nbsp;<span class="builtinfunc" id="3867918">len</span><span class="op" id="3867921">(</span><span class="ident" id="3867922">oi</span><span class="op" id="3867924">)</span>&nbsp;<span class="op" id="3867926">!=</span>&nbsp;<span class="builtinfunc" id="3867929">len</span><span class="op" id="3867932">(</span><span class="ident" id="3867933">other</span><span class="op" id="3867938">)</span>&nbsp;<span class="op" id="3867940">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867944">return</span>&nbsp;<span class="builtintype" id="3867951">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3867958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867961">for</span>&nbsp;<span class="ident" id="3867965">i</span>&nbsp;<span class="op" id="3867967">:=</span>&nbsp;<span class="num" id="3867970">0</span><span class="op" id="3867971">;</span>&nbsp;<span class="ident" id="3867973">i</span>&nbsp;<span class="op" id="3867975">&lt;</span>&nbsp;<span class="builtinfunc" id="3867977">len</span><span class="op" id="3867980">(</span><span class="ident" id="3867981">oi</span><span class="op" id="3867983">)</span><span class="op" id="3867984">;</span>&nbsp;<span class="ident" id="3867986">i</span><span class="op" id="3867987">++</span>&nbsp;<span class="op" id="3867990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3867994">if</span>&nbsp;<span class="ident" id="3867997">oi</span><span class="op" id="3867999">[</span><span class="ident" id="3868000">i</span><span class="op" id="3868001">]</span>&nbsp;<span class="op" id="3868003">!=</span>&nbsp;<span class="ident" id="3868006">other</span><span class="op" id="3868011">[</span><span class="ident" id="3868012">i</span><span class="op" id="3868013">]</span>&nbsp;<span class="op" id="3868015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868020">return</span>&nbsp;<span class="builtintype" id="3868027">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868042">return</span>&nbsp;<span class="builtintype" id="3868049">true</span><br>
<span class="lineno"></span><span class="op" id="3868054">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="3868057">func</span>&nbsp;<span class="op" id="3868062">(</span><span class="ident" id="3868063">oi</span>&nbsp;<span class="ident" id="3868066">ObjectIdentifier</span><span class="op" id="3868082">)</span>&nbsp;<span class="ident" id="3868084">String</span><span class="op" id="3868090">(</span><span class="op" id="3868091">)</span>&nbsp;<span class="builtintype" id="3868093">string</span>&nbsp;<span class="op" id="3868100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868103">var</span>&nbsp;<span class="ident" id="3868107">s</span>&nbsp;<span class="builtintype" id="3868109">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868118">for</span>&nbsp;<span class="ident" id="3868122">i</span><span class="op" id="3868123">,</span>&nbsp;<span class="ident" id="3868125">v</span>&nbsp;<span class="op" id="3868127">:=</span>&nbsp;<span class="keyword" id="3868130">range</span>&nbsp;<span class="ident" id="3868136">oi</span>&nbsp;<span class="op" id="3868139">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868143">if</span>&nbsp;<span class="ident" id="3868146">i</span>&nbsp;<span class="op" id="3868148">&gt;</span>&nbsp;<span class="num" id="3868150">0</span>&nbsp;<span class="op" id="3868152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868157">s</span>&nbsp;<span class="op" id="3868159">+=</span>&nbsp;<span class="string" id="3868162">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868172">s</span>&nbsp;<span class="op" id="3868174">+=</span>&nbsp;<span class="ident" id="3868177">strconv</span><span class="op" id="3868184">.</span><span class="ident" id="3868185">Itoa</span><span class="op" id="3868189">(</span><span class="ident" id="3868190">v</span><span class="op" id="3868191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868194">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868198">return</span>&nbsp;<span class="ident" id="3868205">s</span><br>
<span class="lineno"></span><span class="op" id="3868207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3868210">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="3868288">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="3868366">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="3868403">func</span>&nbsp;<span class="ident" id="3868408">parseObjectIdentifier</span><span class="op" id="3868429">(</span><span class="ident" id="3868430">bytes</span>&nbsp;<span class="op" id="3868436">[</span><span class="op" id="3868437">]</span><span class="builtintype" id="3868438">byte</span><span class="op" id="3868442">)</span>&nbsp;<span class="op" id="3868444">(</span><span class="ident" id="3868445">s</span>&nbsp;<span class="op" id="3868447">[</span><span class="op" id="3868448">]</span><span class="builtintype" id="3868449">int</span><span class="op" id="3868452">,</span>&nbsp;<span class="ident" id="3868454">err</span>&nbsp;<span class="builtintype" id="3868458">error</span><span class="op" id="3868463">)</span>&nbsp;<span class="op" id="3868465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868468">if</span>&nbsp;<span class="builtinfunc" id="3868471">len</span><span class="op" id="3868474">(</span><span class="ident" id="3868475">bytes</span><span class="op" id="3868480">)</span>&nbsp;<span class="op" id="3868482">==</span>&nbsp;<span class="num" id="3868485">0</span>&nbsp;<span class="op" id="3868487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868491">err</span>&nbsp;<span class="op" id="3868495">=</span>&nbsp;<span class="ident" id="3868497">SyntaxError</span><span class="op" id="3868508">{</span><span class="string" id="3868509">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="3868540">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3868544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3868552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868556">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868629">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868699">s</span>&nbsp;<span class="op" id="3868701">=</span>&nbsp;<span class="builtinfunc" id="3868703">make</span><span class="op" id="3868707">(</span><span class="op" id="3868708">[</span><span class="op" id="3868709">]</span><span class="builtintype" id="3868710">int</span><span class="op" id="3868713">,</span>&nbsp;<span class="builtinfunc" id="3868715">len</span><span class="op" id="3868718">(</span><span class="ident" id="3868719">bytes</span><span class="op" id="3868724">)</span><span class="op" id="3868725">+</span><span class="num" id="3868726">1</span><span class="op" id="3868727">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868731">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868775">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868850">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3868924">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3868970">v</span><span class="op" id="3868971">,</span>&nbsp;<span class="ident" id="3868973">offset</span><span class="op" id="3868979">,</span>&nbsp;<span class="ident" id="3868981">err</span>&nbsp;<span class="op" id="3868985">:=</span>&nbsp;<span class="ident" id="3868988">parseBase128Int</span><span class="op" id="3869003">(</span><span class="ident" id="3869004">bytes</span><span class="op" id="3869009">,</span>&nbsp;<span class="num" id="3869011">0</span><span class="op" id="3869012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869015">if</span>&nbsp;<span class="ident" id="3869018">err</span>&nbsp;<span class="op" id="3869022">!=</span>&nbsp;<span class="ident" id="3869025">nil</span>&nbsp;<span class="op" id="3869029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869033">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869041">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869044">if</span>&nbsp;<span class="ident" id="3869047">v</span>&nbsp;<span class="op" id="3869049">&lt;</span>&nbsp;<span class="num" id="3869051">80</span>&nbsp;<span class="op" id="3869054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869058">s</span><span class="op" id="3869059">[</span><span class="num" id="3869060">0</span><span class="op" id="3869061">]</span>&nbsp;<span class="op" id="3869063">=</span>&nbsp;<span class="ident" id="3869065">v</span>&nbsp;<span class="op" id="3869067">/</span>&nbsp;<span class="num" id="3869069">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869074">s</span><span class="op" id="3869075">[</span><span class="num" id="3869076">1</span><span class="op" id="3869077">]</span>&nbsp;<span class="op" id="3869079">=</span>&nbsp;<span class="ident" id="3869081">v</span>&nbsp;<span class="op" id="3869083">%</span>&nbsp;<span class="num" id="3869085">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869089">}</span>&nbsp;<span class="keyword" id="3869091">else</span>&nbsp;<span class="op" id="3869096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869100">s</span><span class="op" id="3869101">[</span><span class="num" id="3869102">0</span><span class="op" id="3869103">]</span>&nbsp;<span class="op" id="3869105">=</span>&nbsp;<span class="num" id="3869107">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869111">s</span><span class="op" id="3869112">[</span><span class="num" id="3869113">1</span><span class="op" id="3869114">]</span>&nbsp;<span class="op" id="3869116">=</span>&nbsp;<span class="ident" id="3869118">v</span>&nbsp;<span class="op" id="3869120">-</span>&nbsp;<span class="num" id="3869122">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869130">i</span>&nbsp;<span class="op" id="3869132">:=</span>&nbsp;<span class="num" id="3869135">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869138">for</span>&nbsp;<span class="op" id="3869142">;</span>&nbsp;<span class="ident" id="3869144">offset</span>&nbsp;<span class="op" id="3869151">&lt;</span>&nbsp;<span class="builtinfunc" id="3869153">len</span><span class="op" id="3869156">(</span><span class="ident" id="3869157">bytes</span><span class="op" id="3869162">)</span><span class="op" id="3869163">;</span>&nbsp;<span class="ident" id="3869165">i</span><span class="op" id="3869166">++</span>&nbsp;<span class="op" id="3869169">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869173">v</span><span class="op" id="3869174">,</span>&nbsp;<span class="ident" id="3869176">offset</span><span class="op" id="3869182">,</span>&nbsp;<span class="ident" id="3869184">err</span>&nbsp;<span class="op" id="3869188">=</span>&nbsp;<span class="ident" id="3869190">parseBase128Int</span><span class="op" id="3869205">(</span><span class="ident" id="3869206">bytes</span><span class="op" id="3869211">,</span>&nbsp;<span class="ident" id="3869213">offset</span><span class="op" id="3869219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869223">if</span>&nbsp;<span class="ident" id="3869226">err</span>&nbsp;<span class="op" id="3869230">!=</span>&nbsp;<span class="ident" id="3869233">nil</span>&nbsp;<span class="op" id="3869237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869255">s</span><span class="op" id="3869256">[</span><span class="ident" id="3869257">i</span><span class="op" id="3869258">]</span>&nbsp;<span class="op" id="3869260">=</span>&nbsp;<span class="ident" id="3869262">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869268">s</span>&nbsp;<span class="op" id="3869270">=</span>&nbsp;<span class="ident" id="3869272">s</span><span class="op" id="3869273">[</span><span class="num" id="3869274">0</span><span class="op" id="3869275">:</span><span class="ident" id="3869276">i</span><span class="op" id="3869277">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869280">return</span><br>
<span class="lineno"></span><span class="op" id="3869287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="3869290">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3869305">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="3869353">type</span>&nbsp;<span class="ident" id="3869358">Enumerated</span>&nbsp;<span class="builtintype" id="3869369">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3869374">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3869383">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3869441">type</span>&nbsp;<span class="ident" id="3869446">Flag</span>&nbsp;<span class="builtintype" id="3869451">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="3869457">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3869535">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="3869597">func</span>&nbsp;<span class="ident" id="3869602">parseBase128Int</span><span class="op" id="3869617">(</span><span class="ident" id="3869618">bytes</span>&nbsp;<span class="op" id="3869624">[</span><span class="op" id="3869625">]</span><span class="builtintype" id="3869626">byte</span><span class="op" id="3869630">,</span>&nbsp;<span class="ident" id="3869632">initOffset</span>&nbsp;<span class="builtintype" id="3869643">int</span><span class="op" id="3869646">)</span>&nbsp;<span class="op" id="3869648">(</span><span class="ident" id="3869649">ret</span><span class="op" id="3869652">,</span>&nbsp;<span class="ident" id="3869654">offset</span>&nbsp;<span class="builtintype" id="3869661">int</span><span class="op" id="3869664">,</span>&nbsp;<span class="ident" id="3869666">err</span>&nbsp;<span class="builtintype" id="3869670">error</span><span class="op" id="3869675">)</span>&nbsp;<span class="op" id="3869677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869680">offset</span>&nbsp;<span class="op" id="3869687">=</span>&nbsp;<span class="ident" id="3869689">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869701">for</span>&nbsp;<span class="ident" id="3869705">shifted</span>&nbsp;<span class="op" id="3869713">:=</span>&nbsp;<span class="num" id="3869716">0</span><span class="op" id="3869717">;</span>&nbsp;<span class="ident" id="3869719">offset</span>&nbsp;<span class="op" id="3869726">&lt;</span>&nbsp;<span class="builtinfunc" id="3869728">len</span><span class="op" id="3869731">(</span><span class="ident" id="3869732">bytes</span><span class="op" id="3869737">)</span><span class="op" id="3869738">;</span>&nbsp;<span class="ident" id="3869740">shifted</span><span class="op" id="3869747">++</span>&nbsp;<span class="op" id="3869750">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869754">if</span>&nbsp;<span class="ident" id="3869757">shifted</span>&nbsp;<span class="op" id="3869765">&gt;</span>&nbsp;<span class="num" id="3869767">4</span>&nbsp;<span class="op" id="3869769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869774">err</span>&nbsp;<span class="op" id="3869778">=</span>&nbsp;<span class="ident" id="3869780">StructuralError</span><span class="op" id="3869795">{</span><span class="string" id="3869796">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="3869824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869842">ret</span>&nbsp;<span class="op" id="3869846">&lt;&lt;=</span>&nbsp;<span class="num" id="3869850">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869854">b</span>&nbsp;<span class="op" id="3869856">:=</span>&nbsp;<span class="ident" id="3869859">bytes</span><span class="op" id="3869864">[</span><span class="ident" id="3869865">offset</span><span class="op" id="3869871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869875">ret</span>&nbsp;<span class="op" id="3869879">|=</span>&nbsp;<span class="builtintype" id="3869882">int</span><span class="op" id="3869885">(</span><span class="ident" id="3869886">b</span>&nbsp;<span class="op" id="3869888">&amp;</span>&nbsp;<span class="num" id="3869890">0x7f</span><span class="op" id="3869894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869898">offset</span><span class="op" id="3869904">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869909">if</span>&nbsp;<span class="ident" id="3869912">b</span><span class="op" id="3869913">&amp;</span><span class="num" id="3869914">0x80</span>&nbsp;<span class="op" id="3869919">==</span>&nbsp;<span class="num" id="3869922">0</span>&nbsp;<span class="op" id="3869924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869929">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3869941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3869944">err</span>&nbsp;<span class="op" id="3869948">=</span>&nbsp;<span class="ident" id="3869950">SyntaxError</span><span class="op" id="3869961">{</span><span class="string" id="3869962">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="3869990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3869993">return</span><br>
<span class="lineno"></span><span class="op" id="3870000">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="3870003">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3870015">func</span>&nbsp;<span class="ident" id="3870020">parseUTCTime</span><span class="op" id="3870032">(</span><span class="ident" id="3870033">bytes</span>&nbsp;<span class="op" id="3870039">[</span><span class="op" id="3870040">]</span><span class="builtintype" id="3870041">byte</span><span class="op" id="3870045">)</span>&nbsp;<span class="op" id="3870047">(</span><span class="ident" id="3870048">ret</span>&nbsp;<span class="ident" id="3870052">time</span><span class="op" id="3870056">.</span><span class="ident" id="3870057">Time</span><span class="op" id="3870061">,</span>&nbsp;<span class="ident" id="3870063">err</span>&nbsp;<span class="builtintype" id="3870067">error</span><span class="op" id="3870072">)</span>&nbsp;<span class="op" id="3870074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870077">s</span>&nbsp;<span class="op" id="3870079">:=</span>&nbsp;<span class="builtintype" id="3870082">string</span><span class="op" id="3870088">(</span><span class="ident" id="3870089">bytes</span><span class="op" id="3870094">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870097">ret</span><span class="op" id="3870100">,</span>&nbsp;<span class="ident" id="3870102">err</span>&nbsp;<span class="op" id="3870106">=</span>&nbsp;<span class="ident" id="3870108">time</span><span class="op" id="3870112">.</span><span class="ident" id="3870113">Parse</span><span class="op" id="3870118">(</span><span class="string" id="3870119">&#34;0601021504Z0700&#34;</span><span class="op" id="3870136">,</span>&nbsp;<span class="ident" id="3870138">s</span><span class="op" id="3870139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870142">if</span>&nbsp;<span class="ident" id="3870145">err</span>&nbsp;<span class="op" id="3870149">!=</span>&nbsp;<span class="ident" id="3870152">nil</span>&nbsp;<span class="op" id="3870156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870160">ret</span><span class="op" id="3870163">,</span>&nbsp;<span class="ident" id="3870165">err</span>&nbsp;<span class="op" id="3870169">=</span>&nbsp;<span class="ident" id="3870171">time</span><span class="op" id="3870175">.</span><span class="ident" id="3870176">Parse</span><span class="op" id="3870181">(</span><span class="string" id="3870182">&#34;060102150405Z0700&#34;</span><span class="op" id="3870201">,</span>&nbsp;<span class="ident" id="3870203">s</span><span class="op" id="3870204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870210">if</span>&nbsp;<span class="ident" id="3870213">err</span>&nbsp;<span class="op" id="3870217">==</span>&nbsp;<span class="ident" id="3870220">nil</span>&nbsp;<span class="op" id="3870224">&amp;&amp;</span>&nbsp;<span class="ident" id="3870227">ret</span><span class="op" id="3870230">.</span><span class="ident" id="3870231">Year</span><span class="op" id="3870235">(</span><span class="op" id="3870236">)</span>&nbsp;<span class="op" id="3870238">&gt;=</span>&nbsp;<span class="num" id="3870241">2050</span>&nbsp;<span class="op" id="3870246">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3870250">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870355">ret</span>&nbsp;<span class="op" id="3870359">=</span>&nbsp;<span class="ident" id="3870361">ret</span><span class="op" id="3870364">.</span><span class="ident" id="3870365">AddDate</span><span class="op" id="3870372">(</span><span class="op" id="3870373">-</span><span class="num" id="3870374">100</span><span class="op" id="3870377">,</span>&nbsp;<span class="num" id="3870379">0</span><span class="op" id="3870380">,</span>&nbsp;<span class="num" id="3870382">0</span><span class="op" id="3870383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870390">return</span><br>
<span class="lineno">300</span><span class="op" id="3870397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3870400">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3870477">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="3870512">func</span>&nbsp;<span class="ident" id="3870517">parseGeneralizedTime</span><span class="op" id="3870537">(</span><span class="ident" id="3870538">bytes</span>&nbsp;<span class="op" id="3870544">[</span><span class="op" id="3870545">]</span><span class="builtintype" id="3870546">byte</span><span class="op" id="3870550">)</span>&nbsp;<span class="op" id="3870552">(</span><span class="ident" id="3870553">ret</span>&nbsp;<span class="ident" id="3870557">time</span><span class="op" id="3870561">.</span><span class="ident" id="3870562">Time</span><span class="op" id="3870566">,</span>&nbsp;<span class="ident" id="3870568">err</span>&nbsp;<span class="builtintype" id="3870572">error</span><span class="op" id="3870577">)</span>&nbsp;<span class="op" id="3870579">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870582">return</span>&nbsp;<span class="ident" id="3870589">time</span><span class="op" id="3870593">.</span><span class="ident" id="3870594">Parse</span><span class="op" id="3870599">(</span><span class="string" id="3870600">&#34;20060102150405Z0700&#34;</span><span class="op" id="3870621">,</span>&nbsp;<span class="builtintype" id="3870623">string</span><span class="op" id="3870629">(</span><span class="ident" id="3870630">bytes</span><span class="op" id="3870635">)</span><span class="op" id="3870636">)</span><br>
<span class="lineno"></span><span class="op" id="3870638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3870641">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="3870661">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="3870736">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3870761">func</span>&nbsp;<span class="ident" id="3870766">parsePrintableString</span><span class="op" id="3870786">(</span><span class="ident" id="3870787">bytes</span>&nbsp;<span class="op" id="3870793">[</span><span class="op" id="3870794">]</span><span class="builtintype" id="3870795">byte</span><span class="op" id="3870799">)</span>&nbsp;<span class="op" id="3870801">(</span><span class="ident" id="3870802">ret</span>&nbsp;<span class="builtintype" id="3870806">string</span><span class="op" id="3870812">,</span>&nbsp;<span class="ident" id="3870814">err</span>&nbsp;<span class="builtintype" id="3870818">error</span><span class="op" id="3870823">)</span>&nbsp;<span class="op" id="3870825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870828">for</span>&nbsp;<span class="ident" id="3870832">_</span><span class="op" id="3870833">,</span>&nbsp;<span class="ident" id="3870835">b</span>&nbsp;<span class="op" id="3870837">:=</span>&nbsp;<span class="keyword" id="3870840">range</span>&nbsp;<span class="ident" id="3870846">bytes</span>&nbsp;<span class="op" id="3870852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870856">if</span>&nbsp;<span class="op" id="3870859">!</span><span class="ident" id="3870860">isPrintable</span><span class="op" id="3870871">(</span><span class="ident" id="3870872">b</span><span class="op" id="3870873">)</span>&nbsp;<span class="op" id="3870875">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870880">err</span>&nbsp;<span class="op" id="3870884">=</span>&nbsp;<span class="ident" id="3870886">SyntaxError</span><span class="op" id="3870897">{</span><span class="string" id="3870898">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="3870942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870947">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3870959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3870962">ret</span>&nbsp;<span class="op" id="3870966">=</span>&nbsp;<span class="builtintype" id="3870968">string</span><span class="op" id="3870974">(</span><span class="ident" id="3870975">bytes</span><span class="op" id="3870980">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3870983">return</span><br>
<span class="lineno"></span><span class="op" id="3870990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3870993">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="3871074">func</span>&nbsp;<span class="ident" id="3871079">isPrintable</span><span class="op" id="3871090">(</span><span class="ident" id="3871091">b</span>&nbsp;<span class="builtintype" id="3871093">byte</span><span class="op" id="3871097">)</span>&nbsp;<span class="builtintype" id="3871099">bool</span>&nbsp;<span class="op" id="3871104">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871107">return</span>&nbsp;<span class="string" id="3871114">&#39;a&#39;</span>&nbsp;<span class="op" id="3871118">&lt;=</span>&nbsp;<span class="ident" id="3871121">b</span>&nbsp;<span class="op" id="3871123">&amp;&amp;</span>&nbsp;<span class="ident" id="3871126">b</span>&nbsp;<span class="op" id="3871128">&lt;=</span>&nbsp;<span class="string" id="3871131">&#39;z&#39;</span>&nbsp;<span class="op" id="3871135">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3871140">&#39;A&#39;</span>&nbsp;<span class="op" id="3871144">&lt;=</span>&nbsp;<span class="ident" id="3871147">b</span>&nbsp;<span class="op" id="3871149">&amp;&amp;</span>&nbsp;<span class="ident" id="3871152">b</span>&nbsp;<span class="op" id="3871154">&lt;=</span>&nbsp;<span class="string" id="3871157">&#39;Z&#39;</span>&nbsp;<span class="op" id="3871161">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3871166">&#39;0&#39;</span>&nbsp;<span class="op" id="3871170">&lt;=</span>&nbsp;<span class="ident" id="3871173">b</span>&nbsp;<span class="op" id="3871175">&amp;&amp;</span>&nbsp;<span class="ident" id="3871178">b</span>&nbsp;<span class="op" id="3871180">&lt;=</span>&nbsp;<span class="string" id="3871183">&#39;9&#39;</span>&nbsp;<span class="op" id="3871187">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3871192">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="3871197">&lt;=</span>&nbsp;<span class="ident" id="3871200">b</span>&nbsp;<span class="op" id="3871202">&amp;&amp;</span>&nbsp;<span class="ident" id="3871205">b</span>&nbsp;<span class="op" id="3871207">&lt;=</span>&nbsp;<span class="string" id="3871210">&#39;)&#39;</span>&nbsp;<span class="op" id="3871214">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3871219">&#39;+&#39;</span>&nbsp;<span class="op" id="3871223">&lt;=</span>&nbsp;<span class="ident" id="3871226">b</span>&nbsp;<span class="op" id="3871228">&amp;&amp;</span>&nbsp;<span class="ident" id="3871231">b</span>&nbsp;<span class="op" id="3871233">&lt;=</span>&nbsp;<span class="string" id="3871236">&#39;/&#39;</span>&nbsp;<span class="op" id="3871240">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871245">b</span>&nbsp;<span class="op" id="3871247">==</span>&nbsp;<span class="string" id="3871250">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3871254">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871259">b</span>&nbsp;<span class="op" id="3871261">==</span>&nbsp;<span class="string" id="3871264">&#39;:&#39;</span>&nbsp;<span class="op" id="3871268">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871273">b</span>&nbsp;<span class="op" id="3871275">==</span>&nbsp;<span class="string" id="3871278">&#39;=&#39;</span>&nbsp;<span class="op" id="3871282">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871287">b</span>&nbsp;<span class="op" id="3871289">==</span>&nbsp;<span class="string" id="3871292">&#39;?&#39;</span>&nbsp;<span class="op" id="3871296">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3871301">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3871360">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3871420">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871477">b</span>&nbsp;<span class="op" id="3871479">==</span>&nbsp;<span class="string" id="3871482">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="3871486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="3871489">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3871503">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3871576">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3871606">func</span>&nbsp;<span class="ident" id="3871611">parseIA5String</span><span class="op" id="3871625">(</span><span class="ident" id="3871626">bytes</span>&nbsp;<span class="op" id="3871632">[</span><span class="op" id="3871633">]</span><span class="builtintype" id="3871634">byte</span><span class="op" id="3871638">)</span>&nbsp;<span class="op" id="3871640">(</span><span class="ident" id="3871641">ret</span>&nbsp;<span class="builtintype" id="3871645">string</span><span class="op" id="3871651">,</span>&nbsp;<span class="ident" id="3871653">err</span>&nbsp;<span class="builtintype" id="3871657">error</span><span class="op" id="3871662">)</span>&nbsp;<span class="op" id="3871664">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871667">for</span>&nbsp;<span class="ident" id="3871671">_</span><span class="op" id="3871672">,</span>&nbsp;<span class="ident" id="3871674">b</span>&nbsp;<span class="op" id="3871676">:=</span>&nbsp;<span class="keyword" id="3871679">range</span>&nbsp;<span class="ident" id="3871685">bytes</span>&nbsp;<span class="op" id="3871691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871695">if</span>&nbsp;<span class="ident" id="3871698">b</span>&nbsp;<span class="op" id="3871700">&gt;=</span>&nbsp;<span class="num" id="3871703">0x80</span>&nbsp;<span class="op" id="3871708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871713">err</span>&nbsp;<span class="op" id="3871717">=</span>&nbsp;<span class="ident" id="3871719">SyntaxError</span><span class="op" id="3871730">{</span><span class="string" id="3871731">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="3871769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871774">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871783">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3871786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3871789">ret</span>&nbsp;<span class="op" id="3871793">=</span>&nbsp;<span class="builtintype" id="3871795">string</span><span class="op" id="3871801">(</span><span class="ident" id="3871802">bytes</span><span class="op" id="3871807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3871810">return</span><br>
<span class="lineno"></span><span class="op" id="3871817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3871820">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3871834">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3871913">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3871943">func</span>&nbsp;<span class="ident" id="3871948">parseT61String</span><span class="op" id="3871962">(</span><span class="ident" id="3871963">bytes</span>&nbsp;<span class="op" id="3871969">[</span><span class="op" id="3871970">]</span><span class="builtintype" id="3871971">byte</span><span class="op" id="3871975">)</span>&nbsp;<span class="op" id="3871977">(</span><span class="ident" id="3871978">ret</span>&nbsp;<span class="builtintype" id="3871982">string</span><span class="op" id="3871988">,</span>&nbsp;<span class="ident" id="3871990">err</span>&nbsp;<span class="builtintype" id="3871994">error</span><span class="op" id="3871999">)</span>&nbsp;<span class="op" id="3872001">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872004">return</span>&nbsp;<span class="builtintype" id="3872011">string</span><span class="op" id="3872017">(</span><span class="ident" id="3872018">bytes</span><span class="op" id="3872023">)</span><span class="op" id="3872024">,</span>&nbsp;<span class="ident" id="3872026">nil</span><br>
<span class="lineno"></span><span class="op" id="3872030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3872033">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3872048">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="3872125">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3872150">func</span>&nbsp;<span class="ident" id="3872155">parseUTF8String</span><span class="op" id="3872170">(</span><span class="ident" id="3872171">bytes</span>&nbsp;<span class="op" id="3872177">[</span><span class="op" id="3872178">]</span><span class="builtintype" id="3872179">byte</span><span class="op" id="3872183">)</span>&nbsp;<span class="op" id="3872185">(</span><span class="ident" id="3872186">ret</span>&nbsp;<span class="builtintype" id="3872190">string</span><span class="op" id="3872196">,</span>&nbsp;<span class="ident" id="3872198">err</span>&nbsp;<span class="builtintype" id="3872202">error</span><span class="op" id="3872207">)</span>&nbsp;<span class="op" id="3872209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3872212">return</span>&nbsp;<span class="builtintype" id="3872219">string</span><span class="op" id="3872225">(</span><span class="ident" id="3872226">bytes</span><span class="op" id="3872231">)</span><span class="op" id="3872232">,</span>&nbsp;<span class="ident" id="3872234">nil</span><br>
<span class="lineno"></span><span class="op" id="3872238">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="3872241">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3872293">type</span>&nbsp;<span class="ident" id="3872298">RawValue</span>&nbsp;<span class="keyword" id="3872307">struct</span>&nbsp;<span class="op" id="3872314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872317">Class</span><span class="op" id="3872322">,</span>&nbsp;<span class="ident" id="3872324">Tag</span>&nbsp;<span class="builtintype" id="3872328">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872333">IsCompound</span>&nbsp;<span class="builtintype" id="3872344">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872350">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3872361">[</span><span class="op" id="3872362">]</span><span class="builtintype" id="3872363">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3872369">FullBytes</span>&nbsp;&nbsp;<span class="op" id="3872380">[</span><span class="op" id="3872381">]</span><span class="builtintype" id="3872382">byte</span>&nbsp;<span class="comment" id="3872387">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="3872418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3872421">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="3872494">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3872572">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3872647">type</span>&nbsp;<span class="ident" id="3872652">RawContent</span>&nbsp;<span class="op" id="3872663">[</span><span class="op" id="3872664">]</span><span class="builtintype" id="3872665">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3872671">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="3872683">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="3872762">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3872839">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="3872915">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="3872988">func</span>&nbsp;<span class="ident" id="3872993">parseTagAndLength</span><span class="op" id="3873010">(</span><span class="ident" id="3873011">bytes</span>&nbsp;<span class="op" id="3873017">[</span><span class="op" id="3873018">]</span><span class="builtintype" id="3873019">byte</span><span class="op" id="3873023">,</span>&nbsp;<span class="ident" id="3873025">initOffset</span>&nbsp;<span class="builtintype" id="3873036">int</span><span class="op" id="3873039">)</span>&nbsp;<span class="op" id="3873041">(</span><span class="ident" id="3873042">ret</span>&nbsp;<span class="ident" id="3873046">tagAndLength</span><span class="op" id="3873058">,</span>&nbsp;<span class="ident" id="3873060">offset</span>&nbsp;<span class="builtintype" id="3873067">int</span><span class="op" id="3873070">,</span>&nbsp;<span class="ident" id="3873072">err</span>&nbsp;<span class="builtintype" id="3873076">error</span><span class="op" id="3873081">)</span>&nbsp;<span class="op" id="3873083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873086">offset</span>&nbsp;<span class="op" id="3873093">=</span>&nbsp;<span class="ident" id="3873095">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873107">b</span>&nbsp;<span class="op" id="3873109">:=</span>&nbsp;<span class="ident" id="3873112">bytes</span><span class="op" id="3873117">[</span><span class="ident" id="3873118">offset</span><span class="op" id="3873124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873127">offset</span><span class="op" id="3873133">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873137">ret</span><span class="op" id="3873140">.</span><span class="ident" id="3873141">class</span>&nbsp;<span class="op" id="3873147">=</span>&nbsp;<span class="builtintype" id="3873149">int</span><span class="op" id="3873152">(</span><span class="ident" id="3873153">b</span>&nbsp;<span class="op" id="3873155">&gt;&gt;</span>&nbsp;<span class="num" id="3873158">6</span><span class="op" id="3873159">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873162">ret</span><span class="op" id="3873165">.</span><span class="ident" id="3873166">isCompound</span>&nbsp;<span class="op" id="3873177">=</span>&nbsp;<span class="ident" id="3873179">b</span><span class="op" id="3873180">&amp;</span><span class="num" id="3873181">0x20</span>&nbsp;<span class="op" id="3873186">==</span>&nbsp;<span class="num" id="3873189">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873195">ret</span><span class="op" id="3873198">.</span><span class="ident" id="3873199">tag</span>&nbsp;<span class="op" id="3873203">=</span>&nbsp;<span class="builtintype" id="3873205">int</span><span class="op" id="3873208">(</span><span class="ident" id="3873209">b</span>&nbsp;<span class="op" id="3873211">&amp;</span>&nbsp;<span class="num" id="3873213">0x1f</span><span class="op" id="3873217">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873221">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873299">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873322">if</span>&nbsp;<span class="ident" id="3873325">ret</span><span class="op" id="3873328">.</span><span class="ident" id="3873329">tag</span>&nbsp;<span class="op" id="3873333">==</span>&nbsp;<span class="num" id="3873336">0x1f</span>&nbsp;<span class="op" id="3873341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873345">ret</span><span class="op" id="3873348">.</span><span class="ident" id="3873349">tag</span><span class="op" id="3873352">,</span>&nbsp;<span class="ident" id="3873354">offset</span><span class="op" id="3873360">,</span>&nbsp;<span class="ident" id="3873362">err</span>&nbsp;<span class="op" id="3873366">=</span>&nbsp;<span class="ident" id="3873368">parseBase128Int</span><span class="op" id="3873383">(</span><span class="ident" id="3873384">bytes</span><span class="op" id="3873389">,</span>&nbsp;<span class="ident" id="3873391">offset</span><span class="op" id="3873397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873401">if</span>&nbsp;<span class="ident" id="3873404">err</span>&nbsp;<span class="op" id="3873408">!=</span>&nbsp;<span class="ident" id="3873411">nil</span>&nbsp;<span class="op" id="3873415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873420">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873429">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873435">if</span>&nbsp;<span class="ident" id="3873438">offset</span>&nbsp;<span class="op" id="3873445">&gt;=</span>&nbsp;<span class="builtinfunc" id="3873448">len</span><span class="op" id="3873451">(</span><span class="ident" id="3873452">bytes</span><span class="op" id="3873457">)</span>&nbsp;<span class="op" id="3873459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873463">err</span>&nbsp;<span class="op" id="3873467">=</span>&nbsp;<span class="ident" id="3873469">SyntaxError</span><span class="op" id="3873480">{</span><span class="string" id="3873481">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="3873506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873510">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873518">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873521">b</span>&nbsp;<span class="op" id="3873523">=</span>&nbsp;<span class="ident" id="3873525">bytes</span><span class="op" id="3873530">[</span><span class="ident" id="3873531">offset</span><span class="op" id="3873537">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873540">offset</span><span class="op" id="3873546">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873550">if</span>&nbsp;<span class="ident" id="3873553">b</span><span class="op" id="3873554">&amp;</span><span class="num" id="3873555">0x80</span>&nbsp;<span class="op" id="3873560">==</span>&nbsp;<span class="num" id="3873563">0</span>&nbsp;<span class="op" id="3873565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873569">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873618">ret</span><span class="op" id="3873621">.</span><span class="ident" id="3873622">length</span>&nbsp;<span class="op" id="3873629">=</span>&nbsp;<span class="builtintype" id="3873631">int</span><span class="op" id="3873634">(</span><span class="ident" id="3873635">b</span>&nbsp;<span class="op" id="3873637">&amp;</span>&nbsp;<span class="num" id="3873639">0x7f</span><span class="op" id="3873643">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873646">}</span>&nbsp;<span class="keyword" id="3873648">else</span>&nbsp;<span class="op" id="3873653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3873657">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873719">numBytes</span>&nbsp;<span class="op" id="3873728">:=</span>&nbsp;<span class="builtintype" id="3873731">int</span><span class="op" id="3873734">(</span><span class="ident" id="3873735">b</span>&nbsp;<span class="op" id="3873737">&amp;</span>&nbsp;<span class="num" id="3873739">0x7f</span><span class="op" id="3873743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873747">if</span>&nbsp;<span class="ident" id="3873750">numBytes</span>&nbsp;<span class="op" id="3873759">==</span>&nbsp;<span class="num" id="3873762">0</span>&nbsp;<span class="op" id="3873764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873769">err</span>&nbsp;<span class="op" id="3873773">=</span>&nbsp;<span class="ident" id="3873775">SyntaxError</span><span class="op" id="3873786">{</span><span class="string" id="3873787">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="3873822">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873840">ret</span><span class="op" id="3873843">.</span><span class="ident" id="3873844">length</span>&nbsp;<span class="op" id="3873851">=</span>&nbsp;<span class="num" id="3873853">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873857">for</span>&nbsp;<span class="ident" id="3873861">i</span>&nbsp;<span class="op" id="3873863">:=</span>&nbsp;<span class="num" id="3873866">0</span><span class="op" id="3873867">;</span>&nbsp;<span class="ident" id="3873869">i</span>&nbsp;<span class="op" id="3873871">&lt;</span>&nbsp;<span class="ident" id="3873873">numBytes</span><span class="op" id="3873881">;</span>&nbsp;<span class="ident" id="3873883">i</span><span class="op" id="3873884">++</span>&nbsp;<span class="op" id="3873887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873892">if</span>&nbsp;<span class="ident" id="3873895">offset</span>&nbsp;<span class="op" id="3873902">&gt;=</span>&nbsp;<span class="builtinfunc" id="3873905">len</span><span class="op" id="3873908">(</span><span class="ident" id="3873909">bytes</span><span class="op" id="3873914">)</span>&nbsp;<span class="op" id="3873916">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873922">err</span>&nbsp;<span class="op" id="3873926">=</span>&nbsp;<span class="ident" id="3873928">SyntaxError</span><span class="op" id="3873939">{</span><span class="string" id="3873940">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="3873965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3873971">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3873981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3873986">b</span>&nbsp;<span class="op" id="3873988">=</span>&nbsp;<span class="ident" id="3873990">bytes</span><span class="op" id="3873995">[</span><span class="ident" id="3873996">offset</span><span class="op" id="3874002">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874007">offset</span><span class="op" id="3874013">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874019">if</span>&nbsp;<span class="ident" id="3874022">ret</span><span class="op" id="3874025">.</span><span class="ident" id="3874026">length</span>&nbsp;<span class="op" id="3874033">&gt;=</span>&nbsp;<span class="num" id="3874036">1</span><span class="op" id="3874037">&lt;&lt;</span><span class="num" id="3874039">23</span>&nbsp;<span class="op" id="3874042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874048">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874092">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874112">err</span>&nbsp;<span class="op" id="3874116">=</span>&nbsp;<span class="ident" id="3874118">StructuralError</span><span class="op" id="3874133">{</span><span class="string" id="3874134">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="3874152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874158">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874173">ret</span><span class="op" id="3874176">.</span><span class="ident" id="3874177">length</span>&nbsp;<span class="op" id="3874184">&lt;&lt;=</span>&nbsp;<span class="num" id="3874188">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874193">ret</span><span class="op" id="3874196">.</span><span class="ident" id="3874197">length</span>&nbsp;<span class="op" id="3874204">|=</span>&nbsp;<span class="builtintype" id="3874207">int</span><span class="op" id="3874210">(</span><span class="ident" id="3874211">b</span><span class="op" id="3874212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874217">if</span>&nbsp;<span class="ident" id="3874220">ret</span><span class="op" id="3874223">.</span><span class="ident" id="3874224">length</span>&nbsp;<span class="op" id="3874231">==</span>&nbsp;<span class="num" id="3874234">0</span>&nbsp;<span class="op" id="3874236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874242">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874287">err</span>&nbsp;<span class="op" id="3874291">=</span>&nbsp;<span class="ident" id="3874293">StructuralError</span><span class="op" id="3874308">{</span><span class="string" id="3874309">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="3874346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874352">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874369">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874373">return</span><br>
<span class="lineno"></span><span class="op" id="3874380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3874383">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="3874463">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3874539">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3874580">func</span>&nbsp;<span class="ident" id="3874585">parseSequenceOf</span><span class="op" id="3874600">(</span><span class="ident" id="3874601">bytes</span>&nbsp;<span class="op" id="3874607">[</span><span class="op" id="3874608">]</span><span class="builtintype" id="3874609">byte</span><span class="op" id="3874613">,</span>&nbsp;<span class="ident" id="3874615">sliceType</span>&nbsp;<span class="ident" id="3874625">reflect</span><span class="op" id="3874632">.</span><span class="ident" id="3874633">Type</span><span class="op" id="3874637">,</span>&nbsp;<span class="ident" id="3874639">elemType</span>&nbsp;<span class="ident" id="3874648">reflect</span><span class="op" id="3874655">.</span><span class="ident" id="3874656">Type</span><span class="op" id="3874660">)</span>&nbsp;<span class="op" id="3874662">(</span><span class="ident" id="3874663">ret</span>&nbsp;<span class="ident" id="3874667">reflect</span><span class="op" id="3874674">.</span><span class="ident" id="3874675">Value</span><span class="op" id="3874680">,</span>&nbsp;<span class="ident" id="3874682">err</span>&nbsp;<span class="builtintype" id="3874686">error</span><span class="op" id="3874691">)</span>&nbsp;<span class="op" id="3874693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874696">expectedTag</span><span class="op" id="3874707">,</span>&nbsp;<span class="ident" id="3874709">compoundType</span><span class="op" id="3874721">,</span>&nbsp;<span class="ident" id="3874723">ok</span>&nbsp;<span class="op" id="3874726">:=</span>&nbsp;<span class="ident" id="3874729">getUniversalType</span><span class="op" id="3874745">(</span><span class="ident" id="3874746">elemType</span><span class="op" id="3874754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874757">if</span>&nbsp;<span class="op" id="3874760">!</span><span class="ident" id="3874761">ok</span>&nbsp;<span class="op" id="3874764">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874768">err</span>&nbsp;<span class="op" id="3874772">=</span>&nbsp;<span class="ident" id="3874774">StructuralError</span><span class="op" id="3874789">{</span><span class="string" id="3874790">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="3874817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3874829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874833">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3874903">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3874957">numElements</span>&nbsp;<span class="op" id="3874969">:=</span>&nbsp;<span class="num" id="3874972">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3874975">for</span>&nbsp;<span class="ident" id="3874979">offset</span>&nbsp;<span class="op" id="3874986">:=</span>&nbsp;<span class="num" id="3874989">0</span><span class="op" id="3874990">;</span>&nbsp;<span class="ident" id="3874992">offset</span>&nbsp;<span class="op" id="3874999">&lt;</span>&nbsp;<span class="builtinfunc" id="3875001">len</span><span class="op" id="3875004">(</span><span class="ident" id="3875005">bytes</span><span class="op" id="3875010">)</span><span class="op" id="3875011">;</span>&nbsp;<span class="op" id="3875013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875017">var</span>&nbsp;<span class="ident" id="3875021">t</span>&nbsp;<span class="ident" id="3875023">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875038">t</span><span class="op" id="3875039">,</span>&nbsp;<span class="ident" id="3875041">offset</span><span class="op" id="3875047">,</span>&nbsp;<span class="ident" id="3875049">err</span>&nbsp;<span class="op" id="3875053">=</span>&nbsp;<span class="ident" id="3875055">parseTagAndLength</span><span class="op" id="3875072">(</span><span class="ident" id="3875073">bytes</span><span class="op" id="3875078">,</span>&nbsp;<span class="ident" id="3875080">offset</span><span class="op" id="3875086">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875090">if</span>&nbsp;<span class="ident" id="3875093">err</span>&nbsp;<span class="op" id="3875097">!=</span>&nbsp;<span class="ident" id="3875100">nil</span>&nbsp;<span class="op" id="3875104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875109">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875122">switch</span>&nbsp;<span class="ident" id="3875129">t</span><span class="op" id="3875130">.</span><span class="ident" id="3875131">tag</span>&nbsp;<span class="op" id="3875135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875139">case</span>&nbsp;<span class="ident" id="3875144">tagIA5String</span><span class="op" id="3875156">,</span>&nbsp;<span class="ident" id="3875158">tagGeneralString</span><span class="op" id="3875174">,</span>&nbsp;<span class="ident" id="3875176">tagT61String</span><span class="op" id="3875188">,</span>&nbsp;<span class="ident" id="3875190">tagUTF8String</span><span class="op" id="3875203">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875208">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875261">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875319">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875349">t</span><span class="op" id="3875350">.</span><span class="ident" id="3875351">tag</span>&nbsp;<span class="op" id="3875355">=</span>&nbsp;<span class="ident" id="3875357">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875378">case</span>&nbsp;<span class="ident" id="3875383">tagGeneralizedTime</span><span class="op" id="3875401">,</span>&nbsp;<span class="ident" id="3875403">tagUTCTime</span><span class="op" id="3875413">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3875418">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875472">t</span><span class="op" id="3875473">.</span><span class="ident" id="3875474">tag</span>&nbsp;<span class="op" id="3875478">=</span>&nbsp;<span class="ident" id="3875480">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875498">if</span>&nbsp;<span class="ident" id="3875501">t</span><span class="op" id="3875502">.</span><span class="ident" id="3875503">class</span>&nbsp;<span class="op" id="3875509">!=</span>&nbsp;<span class="ident" id="3875512">classUniversal</span>&nbsp;<span class="op" id="3875527">||</span>&nbsp;<span class="ident" id="3875530">t</span><span class="op" id="3875531">.</span><span class="ident" id="3875532">isCompound</span>&nbsp;<span class="op" id="3875543">!=</span>&nbsp;<span class="ident" id="3875546">compoundType</span>&nbsp;<span class="op" id="3875559">||</span>&nbsp;<span class="ident" id="3875562">t</span><span class="op" id="3875563">.</span><span class="ident" id="3875564">tag</span>&nbsp;<span class="op" id="3875568">!=</span>&nbsp;<span class="ident" id="3875571">expectedTag</span>&nbsp;<span class="op" id="3875583">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875588">err</span>&nbsp;<span class="op" id="3875592">=</span>&nbsp;<span class="ident" id="3875594">StructuralError</span><span class="op" id="3875609">{</span><span class="string" id="3875610">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="3875633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875638">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875651">if</span>&nbsp;<span class="ident" id="3875654">invalidLength</span><span class="op" id="3875667">(</span><span class="ident" id="3875668">offset</span><span class="op" id="3875674">,</span>&nbsp;<span class="ident" id="3875676">t</span><span class="op" id="3875677">.</span><span class="ident" id="3875678">length</span><span class="op" id="3875684">,</span>&nbsp;<span class="builtinfunc" id="3875686">len</span><span class="op" id="3875689">(</span><span class="ident" id="3875690">bytes</span><span class="op" id="3875695">)</span><span class="op" id="3875696">)</span>&nbsp;<span class="op" id="3875698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875703">err</span>&nbsp;<span class="op" id="3875707">=</span>&nbsp;<span class="ident" id="3875709">SyntaxError</span><span class="op" id="3875720">{</span><span class="string" id="3875721">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="3875741">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875746">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875759">offset</span>&nbsp;<span class="op" id="3875766">+=</span>&nbsp;<span class="ident" id="3875769">t</span><span class="op" id="3875770">.</span><span class="ident" id="3875771">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875780">numElements</span><span class="op" id="3875791">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3875795">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875798">ret</span>&nbsp;<span class="op" id="3875802">=</span>&nbsp;<span class="ident" id="3875804">reflect</span><span class="op" id="3875811">.</span><span class="ident" id="3875812">MakeSlice</span><span class="op" id="3875821">(</span><span class="ident" id="3875822">sliceType</span><span class="op" id="3875831">,</span>&nbsp;<span class="ident" id="3875833">numElements</span><span class="op" id="3875844">,</span>&nbsp;<span class="ident" id="3875846">numElements</span><span class="op" id="3875857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875860">params</span>&nbsp;<span class="op" id="3875867">:=</span>&nbsp;<span class="ident" id="3875870">fieldParameters</span><span class="op" id="3875885">{</span><span class="op" id="3875886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875889">offset</span>&nbsp;<span class="op" id="3875896">:=</span>&nbsp;<span class="num" id="3875899">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3875902">for</span>&nbsp;<span class="ident" id="3875906">i</span>&nbsp;<span class="op" id="3875908">:=</span>&nbsp;<span class="num" id="3875911">0</span><span class="op" id="3875912">;</span>&nbsp;<span class="ident" id="3875914">i</span>&nbsp;<span class="op" id="3875916">&lt;</span>&nbsp;<span class="ident" id="3875918">numElements</span><span class="op" id="3875929">;</span>&nbsp;<span class="ident" id="3875931">i</span><span class="op" id="3875932">++</span>&nbsp;<span class="op" id="3875935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3875939">offset</span><span class="op" id="3875945">,</span>&nbsp;<span class="ident" id="3875947">err</span>&nbsp;<span class="op" id="3875951">=</span>&nbsp;<span class="ident" id="3875953">parseField</span><span class="op" id="3875963">(</span><span class="ident" id="3875964">ret</span><span class="op" id="3875967">.</span><span class="ident" id="3875968">Index</span><span class="op" id="3875973">(</span><span class="ident" id="3875974">i</span><span class="op" id="3875975">)</span><span class="op" id="3875976">,</span>&nbsp;<span class="ident" id="3875978">bytes</span><span class="op" id="3875983">,</span>&nbsp;<span class="ident" id="3875985">offset</span><span class="op" id="3875991">,</span>&nbsp;<span class="ident" id="3875993">params</span><span class="op" id="3875999">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876003">if</span>&nbsp;<span class="ident" id="3876006">err</span>&nbsp;<span class="op" id="3876010">!=</span>&nbsp;<span class="ident" id="3876013">nil</span>&nbsp;<span class="op" id="3876017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876022">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3876034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876037">return</span><br>
<span class="lineno">500</span><span class="op" id="3876044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3876047">var</span>&nbsp;<span class="op" id="3876051">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876054">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876075">=</span>&nbsp;<span class="ident" id="3876077">reflect</span><span class="op" id="3876084">.</span><span class="ident" id="3876085">TypeOf</span><span class="op" id="3876091">(</span><span class="ident" id="3876092">BitString</span><span class="op" id="3876101">{</span><span class="op" id="3876102">}</span><span class="op" id="3876103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876106">objectIdentifierType</span>&nbsp;<span class="op" id="3876127">=</span>&nbsp;<span class="ident" id="3876129">reflect</span><span class="op" id="3876136">.</span><span class="ident" id="3876137">TypeOf</span><span class="op" id="3876143">(</span><span class="ident" id="3876144">ObjectIdentifier</span><span class="op" id="3876160">{</span><span class="op" id="3876161">}</span><span class="op" id="3876162">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876165">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876186">=</span>&nbsp;<span class="ident" id="3876188">reflect</span><span class="op" id="3876195">.</span><span class="ident" id="3876196">TypeOf</span><span class="op" id="3876202">(</span><span class="ident" id="3876203">Enumerated</span><span class="op" id="3876213">(</span><span class="num" id="3876214">0</span><span class="op" id="3876215">)</span><span class="op" id="3876216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876219">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876240">=</span>&nbsp;<span class="ident" id="3876242">reflect</span><span class="op" id="3876249">.</span><span class="ident" id="3876250">TypeOf</span><span class="op" id="3876256">(</span><span class="ident" id="3876257">Flag</span><span class="op" id="3876261">(</span><span class="builtintype" id="3876262">false</span><span class="op" id="3876267">)</span><span class="op" id="3876268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876271">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876292">=</span>&nbsp;<span class="ident" id="3876294">reflect</span><span class="op" id="3876301">.</span><span class="ident" id="3876302">TypeOf</span><span class="op" id="3876308">(</span><span class="ident" id="3876309">time</span><span class="op" id="3876313">.</span><span class="ident" id="3876314">Time</span><span class="op" id="3876318">{</span><span class="op" id="3876319">}</span><span class="op" id="3876320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876323">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876344">=</span>&nbsp;<span class="ident" id="3876346">reflect</span><span class="op" id="3876353">.</span><span class="ident" id="3876354">TypeOf</span><span class="op" id="3876360">(</span><span class="ident" id="3876361">RawValue</span><span class="op" id="3876369">{</span><span class="op" id="3876370">}</span><span class="op" id="3876371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876374">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876395">=</span>&nbsp;<span class="ident" id="3876397">reflect</span><span class="op" id="3876404">.</span><span class="ident" id="3876405">TypeOf</span><span class="op" id="3876411">(</span><span class="ident" id="3876412">RawContent</span><span class="op" id="3876422">(</span><span class="ident" id="3876423">nil</span><span class="op" id="3876426">)</span><span class="op" id="3876427">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3876430">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876451">=</span>&nbsp;<span class="ident" id="3876453">reflect</span><span class="op" id="3876460">.</span><span class="ident" id="3876461">TypeOf</span><span class="op" id="3876467">(</span><span class="builtinfunc" id="3876468">new</span><span class="op" id="3876471">(</span><span class="ident" id="3876472">big</span><span class="op" id="3876475">.</span><span class="ident" id="3876476">Int</span><span class="op" id="3876479">)</span><span class="op" id="3876480">)</span><br>
<span class="lineno"></span><span class="op" id="3876482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876485">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3876560">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="3876588">func</span>&nbsp;<span class="ident" id="3876593">invalidLength</span><span class="op" id="3876606">(</span><span class="ident" id="3876607">offset</span><span class="op" id="3876613">,</span>&nbsp;<span class="ident" id="3876615">length</span><span class="op" id="3876621">,</span>&nbsp;<span class="ident" id="3876623">sliceLength</span>&nbsp;<span class="builtintype" id="3876635">int</span><span class="op" id="3876638">)</span>&nbsp;<span class="builtintype" id="3876640">bool</span>&nbsp;<span class="op" id="3876645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3876648">return</span>&nbsp;<span class="ident" id="3876655">offset</span><span class="op" id="3876661">+</span><span class="ident" id="3876662">length</span>&nbsp;<span class="op" id="3876669">&lt;</span>&nbsp;<span class="ident" id="3876671">offset</span>&nbsp;<span class="op" id="3876678">||</span>&nbsp;<span class="ident" id="3876681">offset</span><span class="op" id="3876687">+</span><span class="ident" id="3876688">length</span>&nbsp;<span class="op" id="3876695">&gt;</span>&nbsp;<span class="ident" id="3876697">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="3876709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876712">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="3876789">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3876869">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="3876892">func</span>&nbsp;<span class="ident" id="3876897">parseField</span><span class="op" id="3876907">(</span><span class="ident" id="3876908">v</span>&nbsp;<span class="ident" id="3876910">reflect</span><span class="op" id="3876917">.</span><span class="ident" id="3876918">Value</span><span class="op" id="3876923">,</span>&nbsp;<span class="ident" id="3876925">bytes</span>&nbsp;<span class="op" id="3876931">[</span><span class="op" id="3876932">]</span><span class="builtintype" id="3876933">byte</span><span class="op" id="3876937">,</span>&nbsp;<span class="ident" id="3876939">initOffset</span>&nbsp;<span class="builtintype" id="3876950">int</span><span class="op" id="3876953">,</span>&nbsp;<span class="ident" id="3876955">params</span>&nbsp;<span class="ident" id="3876962">fieldParameters</span><span class="op" id="3876977">)</span>&nbsp;<span class="op" id="3876979">(</span><span class="ident" id="3876980">offset</span>&nbsp;<span class="builtintype" id="3876987">int</span><span class="op" id="3876990">,</span>&nbsp;<span class="ident" id="3876992">err</span>&nbsp;<span class="builtintype" id="3876996">error</span><span class="op" id="3877001">)</span>&nbsp;<span class="op" id="3877003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877006">offset</span>&nbsp;<span class="op" id="3877013">=</span>&nbsp;<span class="ident" id="3877015">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877027">fieldType</span>&nbsp;<span class="op" id="3877037">:=</span>&nbsp;<span class="ident" id="3877040">v</span><span class="op" id="3877041">.</span><span class="ident" id="3877042">Type</span><span class="op" id="3877046">(</span><span class="op" id="3877047">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3877051">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877138">if</span>&nbsp;<span class="ident" id="3877141">offset</span>&nbsp;<span class="op" id="3877148">==</span>&nbsp;<span class="builtinfunc" id="3877151">len</span><span class="op" id="3877154">(</span><span class="ident" id="3877155">bytes</span><span class="op" id="3877160">)</span>&nbsp;<span class="op" id="3877162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877166">if</span>&nbsp;<span class="op" id="3877169">!</span><span class="ident" id="3877170">setDefaultValue</span><span class="op" id="3877185">(</span><span class="ident" id="3877186">v</span><span class="op" id="3877187">,</span>&nbsp;<span class="ident" id="3877189">params</span><span class="op" id="3877195">)</span>&nbsp;<span class="op" id="3877197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877202">err</span>&nbsp;<span class="op" id="3877206">=</span>&nbsp;<span class="ident" id="3877208">SyntaxError</span><span class="op" id="3877219">{</span><span class="string" id="3877220">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="3877240">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3877260">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877286">if</span>&nbsp;<span class="ident" id="3877289">fieldType</span>&nbsp;<span class="op" id="3877299">==</span>&nbsp;<span class="ident" id="3877302">rawValueType</span>&nbsp;<span class="op" id="3877315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877319">var</span>&nbsp;<span class="ident" id="3877323">t</span>&nbsp;<span class="ident" id="3877325">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877340">t</span><span class="op" id="3877341">,</span>&nbsp;<span class="ident" id="3877343">offset</span><span class="op" id="3877349">,</span>&nbsp;<span class="ident" id="3877351">err</span>&nbsp;<span class="op" id="3877355">=</span>&nbsp;<span class="ident" id="3877357">parseTagAndLength</span><span class="op" id="3877374">(</span><span class="ident" id="3877375">bytes</span><span class="op" id="3877380">,</span>&nbsp;<span class="ident" id="3877382">offset</span><span class="op" id="3877388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877392">if</span>&nbsp;<span class="ident" id="3877395">err</span>&nbsp;<span class="op" id="3877399">!=</span>&nbsp;<span class="ident" id="3877402">nil</span>&nbsp;<span class="op" id="3877406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877411">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877424">if</span>&nbsp;<span class="ident" id="3877427">invalidLength</span><span class="op" id="3877440">(</span><span class="ident" id="3877441">offset</span><span class="op" id="3877447">,</span>&nbsp;<span class="ident" id="3877449">t</span><span class="op" id="3877450">.</span><span class="ident" id="3877451">length</span><span class="op" id="3877457">,</span>&nbsp;<span class="builtinfunc" id="3877459">len</span><span class="op" id="3877462">(</span><span class="ident" id="3877463">bytes</span><span class="op" id="3877468">)</span><span class="op" id="3877469">)</span>&nbsp;<span class="op" id="3877471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877476">err</span>&nbsp;<span class="op" id="3877480">=</span>&nbsp;<span class="ident" id="3877482">SyntaxError</span><span class="op" id="3877493">{</span><span class="string" id="3877494">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3877510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877515">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877524">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877528">result</span>&nbsp;<span class="op" id="3877535">:=</span>&nbsp;<span class="ident" id="3877538">RawValue</span><span class="op" id="3877546">{</span><span class="ident" id="3877547">t</span><span class="op" id="3877548">.</span><span class="ident" id="3877549">class</span><span class="op" id="3877554">,</span>&nbsp;<span class="ident" id="3877556">t</span><span class="op" id="3877557">.</span><span class="ident" id="3877558">tag</span><span class="op" id="3877561">,</span>&nbsp;<span class="ident" id="3877563">t</span><span class="op" id="3877564">.</span><span class="ident" id="3877565">isCompound</span><span class="op" id="3877575">,</span>&nbsp;<span class="ident" id="3877577">bytes</span><span class="op" id="3877582">[</span><span class="ident" id="3877583">offset</span>&nbsp;<span class="op" id="3877590">:</span>&nbsp;<span class="ident" id="3877592">offset</span><span class="op" id="3877598">+</span><span class="ident" id="3877599">t</span><span class="op" id="3877600">.</span><span class="ident" id="3877601">length</span><span class="op" id="3877607">]</span><span class="op" id="3877608">,</span>&nbsp;<span class="ident" id="3877610">bytes</span><span class="op" id="3877615">[</span><span class="ident" id="3877616">initOffset</span>&nbsp;<span class="op" id="3877627">:</span>&nbsp;<span class="ident" id="3877629">offset</span><span class="op" id="3877635">+</span><span class="ident" id="3877636">t</span><span class="op" id="3877637">.</span><span class="ident" id="3877638">length</span><span class="op" id="3877644">]</span><span class="op" id="3877645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877649">offset</span>&nbsp;<span class="op" id="3877656">+=</span>&nbsp;<span class="ident" id="3877659">t</span><span class="op" id="3877660">.</span><span class="ident" id="3877661">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877670">v</span><span class="op" id="3877671">.</span><span class="ident" id="3877672">Set</span><span class="op" id="3877675">(</span><span class="ident" id="3877676">reflect</span><span class="op" id="3877683">.</span><span class="ident" id="3877684">ValueOf</span><span class="op" id="3877691">(</span><span class="ident" id="3877692">result</span><span class="op" id="3877698">)</span><span class="op" id="3877699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877703">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877711">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3877715">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877743">if</span>&nbsp;<span class="ident" id="3877746">ifaceType</span>&nbsp;<span class="op" id="3877756">:=</span>&nbsp;<span class="ident" id="3877759">fieldType</span><span class="op" id="3877768">;</span>&nbsp;<span class="ident" id="3877770">ifaceType</span><span class="op" id="3877779">.</span><span class="ident" id="3877780">Kind</span><span class="op" id="3877784">(</span><span class="op" id="3877785">)</span>&nbsp;<span class="op" id="3877787">==</span>&nbsp;<span class="ident" id="3877790">reflect</span><span class="op" id="3877797">.</span><span class="ident" id="3877798">Interface</span>&nbsp;<span class="op" id="3877808">&amp;&amp;</span>&nbsp;<span class="ident" id="3877811">ifaceType</span><span class="op" id="3877820">.</span><span class="ident" id="3877821">NumMethod</span><span class="op" id="3877830">(</span><span class="op" id="3877831">)</span>&nbsp;<span class="op" id="3877833">==</span>&nbsp;<span class="num" id="3877836">0</span>&nbsp;<span class="op" id="3877838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877842">var</span>&nbsp;<span class="ident" id="3877846">t</span>&nbsp;<span class="ident" id="3877848">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877863">t</span><span class="op" id="3877864">,</span>&nbsp;<span class="ident" id="3877866">offset</span><span class="op" id="3877872">,</span>&nbsp;<span class="ident" id="3877874">err</span>&nbsp;<span class="op" id="3877878">=</span>&nbsp;<span class="ident" id="3877880">parseTagAndLength</span><span class="op" id="3877897">(</span><span class="ident" id="3877898">bytes</span><span class="op" id="3877903">,</span>&nbsp;<span class="ident" id="3877905">offset</span><span class="op" id="3877911">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877915">if</span>&nbsp;<span class="ident" id="3877918">err</span>&nbsp;<span class="op" id="3877922">!=</span>&nbsp;<span class="ident" id="3877925">nil</span>&nbsp;<span class="op" id="3877929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877934">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3877943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3877947">if</span>&nbsp;<span class="ident" id="3877950">invalidLength</span><span class="op" id="3877963">(</span><span class="ident" id="3877964">offset</span><span class="op" id="3877970">,</span>&nbsp;<span class="ident" id="3877972">t</span><span class="op" id="3877973">.</span><span class="ident" id="3877974">length</span><span class="op" id="3877980">,</span>&nbsp;<span class="builtinfunc" id="3877982">len</span><span class="op" id="3877985">(</span><span class="ident" id="3877986">bytes</span><span class="op" id="3877991">)</span><span class="op" id="3877992">)</span>&nbsp;<span class="op" id="3877994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3877999">err</span>&nbsp;<span class="op" id="3878003">=</span>&nbsp;<span class="ident" id="3878005">SyntaxError</span><span class="op" id="3878016">{</span><span class="string" id="3878017">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3878033">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878038">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878051">var</span>&nbsp;<span class="ident" id="3878055">result</span>&nbsp;<span class="keyword" id="3878062">interface</span><span class="op" id="3878071">{</span><span class="op" id="3878072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878076">if</span>&nbsp;<span class="op" id="3878079">!</span><span class="ident" id="3878080">t</span><span class="op" id="3878081">.</span><span class="ident" id="3878082">isCompound</span>&nbsp;<span class="op" id="3878093">&amp;&amp;</span>&nbsp;<span class="ident" id="3878096">t</span><span class="op" id="3878097">.</span><span class="ident" id="3878098">class</span>&nbsp;<span class="op" id="3878104">==</span>&nbsp;<span class="ident" id="3878107">classUniversal</span>&nbsp;<span class="op" id="3878122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878127">innerBytes</span>&nbsp;<span class="op" id="3878138">:=</span>&nbsp;<span class="ident" id="3878141">bytes</span><span class="op" id="3878146">[</span><span class="ident" id="3878147">offset</span>&nbsp;<span class="op" id="3878154">:</span>&nbsp;<span class="ident" id="3878156">offset</span><span class="op" id="3878162">+</span><span class="ident" id="3878163">t</span><span class="op" id="3878164">.</span><span class="ident" id="3878165">length</span><span class="op" id="3878171">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878176">switch</span>&nbsp;<span class="ident" id="3878183">t</span><span class="op" id="3878184">.</span><span class="ident" id="3878185">tag</span>&nbsp;<span class="op" id="3878189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878194">case</span>&nbsp;<span class="ident" id="3878199">tagPrintableString</span><span class="op" id="3878217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878223">result</span><span class="op" id="3878229">,</span>&nbsp;<span class="ident" id="3878231">err</span>&nbsp;<span class="op" id="3878235">=</span>&nbsp;<span class="ident" id="3878237">parsePrintableString</span><span class="op" id="3878257">(</span><span class="ident" id="3878258">innerBytes</span><span class="op" id="3878268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878273">case</span>&nbsp;<span class="ident" id="3878278">tagIA5String</span><span class="op" id="3878290">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878296">result</span><span class="op" id="3878302">,</span>&nbsp;<span class="ident" id="3878304">err</span>&nbsp;<span class="op" id="3878308">=</span>&nbsp;<span class="ident" id="3878310">parseIA5String</span><span class="op" id="3878324">(</span><span class="ident" id="3878325">innerBytes</span><span class="op" id="3878335">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878340">case</span>&nbsp;<span class="ident" id="3878345">tagT61String</span><span class="op" id="3878357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878363">result</span><span class="op" id="3878369">,</span>&nbsp;<span class="ident" id="3878371">err</span>&nbsp;<span class="op" id="3878375">=</span>&nbsp;<span class="ident" id="3878377">parseT61String</span><span class="op" id="3878391">(</span><span class="ident" id="3878392">innerBytes</span><span class="op" id="3878402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878407">case</span>&nbsp;<span class="ident" id="3878412">tagUTF8String</span><span class="op" id="3878425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878431">result</span><span class="op" id="3878437">,</span>&nbsp;<span class="ident" id="3878439">err</span>&nbsp;<span class="op" id="3878443">=</span>&nbsp;<span class="ident" id="3878445">parseUTF8String</span><span class="op" id="3878460">(</span><span class="ident" id="3878461">innerBytes</span><span class="op" id="3878471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878476">case</span>&nbsp;<span class="ident" id="3878481">tagInteger</span><span class="op" id="3878491">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878497">result</span><span class="op" id="3878503">,</span>&nbsp;<span class="ident" id="3878505">err</span>&nbsp;<span class="op" id="3878509">=</span>&nbsp;<span class="ident" id="3878511">parseInt64</span><span class="op" id="3878521">(</span><span class="ident" id="3878522">innerBytes</span><span class="op" id="3878532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878537">case</span>&nbsp;<span class="ident" id="3878542">tagBitString</span><span class="op" id="3878554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878560">result</span><span class="op" id="3878566">,</span>&nbsp;<span class="ident" id="3878568">err</span>&nbsp;<span class="op" id="3878572">=</span>&nbsp;<span class="ident" id="3878574">parseBitString</span><span class="op" id="3878588">(</span><span class="ident" id="3878589">innerBytes</span><span class="op" id="3878599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878604">case</span>&nbsp;<span class="ident" id="3878609">tagOID</span><span class="op" id="3878615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878621">result</span><span class="op" id="3878627">,</span>&nbsp;<span class="ident" id="3878629">err</span>&nbsp;<span class="op" id="3878633">=</span>&nbsp;<span class="ident" id="3878635">parseObjectIdentifier</span><span class="op" id="3878656">(</span><span class="ident" id="3878657">innerBytes</span><span class="op" id="3878667">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878672">case</span>&nbsp;<span class="ident" id="3878677">tagUTCTime</span><span class="op" id="3878687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878693">result</span><span class="op" id="3878699">,</span>&nbsp;<span class="ident" id="3878701">err</span>&nbsp;<span class="op" id="3878705">=</span>&nbsp;<span class="ident" id="3878707">parseUTCTime</span><span class="op" id="3878719">(</span><span class="ident" id="3878720">innerBytes</span><span class="op" id="3878730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878735">case</span>&nbsp;<span class="ident" id="3878740">tagOctetString</span><span class="op" id="3878754">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878760">result</span>&nbsp;<span class="op" id="3878767">=</span>&nbsp;<span class="ident" id="3878769">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878783">default</span><span class="op" id="3878790">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3878796">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878879">offset</span>&nbsp;<span class="op" id="3878886">+=</span>&nbsp;<span class="ident" id="3878889">t</span><span class="op" id="3878890">.</span><span class="ident" id="3878891">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878900">if</span>&nbsp;<span class="ident" id="3878903">err</span>&nbsp;<span class="op" id="3878907">!=</span>&nbsp;<span class="ident" id="3878910">nil</span>&nbsp;<span class="op" id="3878914">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878919">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878932">if</span>&nbsp;<span class="ident" id="3878935">result</span>&nbsp;<span class="op" id="3878942">!=</span>&nbsp;<span class="ident" id="3878945">nil</span>&nbsp;<span class="op" id="3878949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3878954">v</span><span class="op" id="3878955">.</span><span class="ident" id="3878956">Set</span><span class="op" id="3878959">(</span><span class="ident" id="3878960">reflect</span><span class="op" id="3878967">.</span><span class="ident" id="3878968">ValueOf</span><span class="op" id="3878975">(</span><span class="ident" id="3878976">result</span><span class="op" id="3878982">)</span><span class="op" id="3878983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878987">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3878991">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3878999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879002">universalTag</span><span class="op" id="3879014">,</span>&nbsp;<span class="ident" id="3879016">compoundType</span><span class="op" id="3879028">,</span>&nbsp;<span class="ident" id="3879030">ok1</span>&nbsp;<span class="op" id="3879034">:=</span>&nbsp;<span class="ident" id="3879037">getUniversalType</span><span class="op" id="3879053">(</span><span class="ident" id="3879054">fieldType</span><span class="op" id="3879063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879066">if</span>&nbsp;<span class="op" id="3879069">!</span><span class="ident" id="3879070">ok1</span>&nbsp;<span class="op" id="3879074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879078">err</span>&nbsp;<span class="op" id="3879082">=</span>&nbsp;<span class="ident" id="3879084">StructuralError</span><span class="op" id="3879099">{</span><span class="ident" id="3879100">fmt</span><span class="op" id="3879103">.</span><span class="ident" id="3879104">Sprintf</span><span class="op" id="3879111">(</span><span class="string" id="3879112">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="3879133">,</span>&nbsp;<span class="ident" id="3879135">fieldType</span><span class="op" id="3879144">)</span><span class="op" id="3879145">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879149">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879161">t</span><span class="op" id="3879162">,</span>&nbsp;<span class="ident" id="3879164">offset</span><span class="op" id="3879170">,</span>&nbsp;<span class="ident" id="3879172">err</span>&nbsp;<span class="op" id="3879176">:=</span>&nbsp;<span class="ident" id="3879179">parseTagAndLength</span><span class="op" id="3879196">(</span><span class="ident" id="3879197">bytes</span><span class="op" id="3879202">,</span>&nbsp;<span class="ident" id="3879204">offset</span><span class="op" id="3879210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879213">if</span>&nbsp;<span class="ident" id="3879216">err</span>&nbsp;<span class="op" id="3879220">!=</span>&nbsp;<span class="ident" id="3879223">nil</span>&nbsp;<span class="op" id="3879227">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879231">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879242">if</span>&nbsp;<span class="ident" id="3879245">params</span><span class="op" id="3879251">.</span><span class="ident" id="3879252">explicit</span>&nbsp;<span class="op" id="3879261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879265">expectedClass</span>&nbsp;<span class="op" id="3879279">:=</span>&nbsp;<span class="ident" id="3879282">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879305">if</span>&nbsp;<span class="ident" id="3879308">params</span><span class="op" id="3879314">.</span><span class="ident" id="3879315">application</span>&nbsp;<span class="op" id="3879327">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879332">expectedClass</span>&nbsp;<span class="op" id="3879346">=</span>&nbsp;<span class="ident" id="3879348">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879371">if</span>&nbsp;<span class="ident" id="3879374">t</span><span class="op" id="3879375">.</span><span class="ident" id="3879376">class</span>&nbsp;<span class="op" id="3879382">==</span>&nbsp;<span class="ident" id="3879385">expectedClass</span>&nbsp;<span class="op" id="3879399">&amp;&amp;</span>&nbsp;<span class="ident" id="3879402">t</span><span class="op" id="3879403">.</span><span class="ident" id="3879404">tag</span>&nbsp;<span class="op" id="3879408">==</span>&nbsp;<span class="op" id="3879411">*</span><span class="ident" id="3879412">params</span><span class="op" id="3879418">.</span><span class="ident" id="3879419">tag</span>&nbsp;<span class="op" id="3879423">&amp;&amp;</span>&nbsp;<span class="op" id="3879426">(</span><span class="ident" id="3879427">t</span><span class="op" id="3879428">.</span><span class="ident" id="3879429">length</span>&nbsp;<span class="op" id="3879436">==</span>&nbsp;<span class="num" id="3879439">0</span>&nbsp;<span class="op" id="3879441">||</span>&nbsp;<span class="ident" id="3879444">t</span><span class="op" id="3879445">.</span><span class="ident" id="3879446">isCompound</span><span class="op" id="3879456">)</span>&nbsp;<span class="op" id="3879458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879463">if</span>&nbsp;<span class="ident" id="3879466">t</span><span class="op" id="3879467">.</span><span class="ident" id="3879468">length</span>&nbsp;<span class="op" id="3879475">&gt;</span>&nbsp;<span class="num" id="3879477">0</span>&nbsp;<span class="op" id="3879479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879485">t</span><span class="op" id="3879486">,</span>&nbsp;<span class="ident" id="3879488">offset</span><span class="op" id="3879494">,</span>&nbsp;<span class="ident" id="3879496">err</span>&nbsp;<span class="op" id="3879500">=</span>&nbsp;<span class="ident" id="3879502">parseTagAndLength</span><span class="op" id="3879519">(</span><span class="ident" id="3879520">bytes</span><span class="op" id="3879525">,</span>&nbsp;<span class="ident" id="3879527">offset</span><span class="op" id="3879533">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879539">if</span>&nbsp;<span class="ident" id="3879542">err</span>&nbsp;<span class="op" id="3879546">!=</span>&nbsp;<span class="ident" id="3879549">nil</span>&nbsp;<span class="op" id="3879553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879560">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879576">}</span>&nbsp;<span class="keyword" id="3879578">else</span>&nbsp;<span class="op" id="3879583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879589">if</span>&nbsp;<span class="ident" id="3879592">fieldType</span>&nbsp;<span class="op" id="3879602">!=</span>&nbsp;<span class="ident" id="3879605">flagType</span>&nbsp;<span class="op" id="3879614">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879621">err</span>&nbsp;<span class="op" id="3879625">=</span>&nbsp;<span class="ident" id="3879627">StructuralError</span><span class="op" id="3879642">{</span><span class="string" id="3879643">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="3879690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879697">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879714">v</span><span class="op" id="3879715">.</span><span class="ident" id="3879716">SetBool</span><span class="op" id="3879723">(</span><span class="builtintype" id="3879724">true</span><span class="op" id="3879728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879734">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879748">}</span>&nbsp;<span class="keyword" id="3879750">else</span>&nbsp;<span class="op" id="3879755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879760">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879822">ok</span>&nbsp;<span class="op" id="3879825">:=</span>&nbsp;<span class="ident" id="3879828">setDefaultValue</span><span class="op" id="3879843">(</span><span class="ident" id="3879844">v</span><span class="op" id="3879845">,</span>&nbsp;<span class="ident" id="3879847">params</span><span class="op" id="3879853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879858">if</span>&nbsp;<span class="ident" id="3879861">ok</span>&nbsp;<span class="op" id="3879864">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879870">offset</span>&nbsp;<span class="op" id="3879877">=</span>&nbsp;<span class="ident" id="3879879">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879893">}</span>&nbsp;<span class="keyword" id="3879895">else</span>&nbsp;<span class="op" id="3879900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3879906">err</span>&nbsp;<span class="op" id="3879910">=</span>&nbsp;<span class="ident" id="3879912">StructuralError</span><span class="op" id="3879927">{</span><span class="string" id="3879928">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="3879967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3879977">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3879989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3879993">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880064">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880134">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880205">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880254">if</span>&nbsp;<span class="ident" id="3880257">universalTag</span>&nbsp;<span class="op" id="3880270">==</span>&nbsp;<span class="ident" id="3880273">tagPrintableString</span>&nbsp;<span class="op" id="3880292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880296">if</span>&nbsp;<span class="ident" id="3880299">t</span><span class="op" id="3880300">.</span><span class="ident" id="3880301">class</span>&nbsp;<span class="op" id="3880307">==</span>&nbsp;<span class="ident" id="3880310">classUniversal</span>&nbsp;<span class="op" id="3880325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880330">switch</span>&nbsp;<span class="ident" id="3880337">t</span><span class="op" id="3880338">.</span><span class="ident" id="3880339">tag</span>&nbsp;<span class="op" id="3880343">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880348">case</span>&nbsp;<span class="ident" id="3880353">tagIA5String</span><span class="op" id="3880365">,</span>&nbsp;<span class="ident" id="3880367">tagGeneralString</span><span class="op" id="3880383">,</span>&nbsp;<span class="ident" id="3880385">tagT61String</span><span class="op" id="3880397">,</span>&nbsp;<span class="ident" id="3880399">tagUTF8String</span><span class="op" id="3880412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880418">universalTag</span>&nbsp;<span class="op" id="3880431">=</span>&nbsp;<span class="ident" id="3880433">t</span><span class="op" id="3880434">.</span><span class="ident" id="3880435">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880446">}</span>&nbsp;<span class="keyword" id="3880448">else</span>&nbsp;<span class="keyword" id="3880453">if</span>&nbsp;<span class="ident" id="3880456">params</span><span class="op" id="3880462">.</span><span class="ident" id="3880463">stringType</span>&nbsp;<span class="op" id="3880474">!=</span>&nbsp;<span class="num" id="3880477">0</span>&nbsp;<span class="op" id="3880479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880484">universalTag</span>&nbsp;<span class="op" id="3880497">=</span>&nbsp;<span class="ident" id="3880499">params</span><span class="op" id="3880505">.</span><span class="ident" id="3880506">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880526">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3880597">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880620">if</span>&nbsp;<span class="ident" id="3880623">universalTag</span>&nbsp;<span class="op" id="3880636">==</span>&nbsp;<span class="ident" id="3880639">tagUTCTime</span>&nbsp;<span class="op" id="3880650">&amp;&amp;</span>&nbsp;<span class="ident" id="3880653">t</span><span class="op" id="3880654">.</span><span class="ident" id="3880655">tag</span>&nbsp;<span class="op" id="3880659">==</span>&nbsp;<span class="ident" id="3880662">tagGeneralizedTime</span>&nbsp;<span class="op" id="3880681">&amp;&amp;</span>&nbsp;<span class="ident" id="3880684">t</span><span class="op" id="3880685">.</span><span class="ident" id="3880686">class</span>&nbsp;<span class="op" id="3880692">==</span>&nbsp;<span class="ident" id="3880695">classUniversal</span>&nbsp;<span class="op" id="3880710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880714">universalTag</span>&nbsp;<span class="op" id="3880727">=</span>&nbsp;<span class="ident" id="3880729">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880753">if</span>&nbsp;<span class="ident" id="3880756">params</span><span class="op" id="3880762">.</span><span class="ident" id="3880763">set</span>&nbsp;<span class="op" id="3880767">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880771">universalTag</span>&nbsp;<span class="op" id="3880784">=</span>&nbsp;<span class="ident" id="3880786">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880798">expectedClass</span>&nbsp;<span class="op" id="3880812">:=</span>&nbsp;<span class="ident" id="3880815">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880831">expectedTag</span>&nbsp;<span class="op" id="3880843">:=</span>&nbsp;<span class="ident" id="3880846">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880861">if</span>&nbsp;<span class="op" id="3880864">!</span><span class="ident" id="3880865">params</span><span class="op" id="3880871">.</span><span class="ident" id="3880872">explicit</span>&nbsp;<span class="op" id="3880881">&amp;&amp;</span>&nbsp;<span class="ident" id="3880884">params</span><span class="op" id="3880890">.</span><span class="ident" id="3880891">tag</span>&nbsp;<span class="op" id="3880895">!=</span>&nbsp;<span class="ident" id="3880898">nil</span>&nbsp;<span class="op" id="3880902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880906">expectedClass</span>&nbsp;<span class="op" id="3880920">=</span>&nbsp;<span class="ident" id="3880922">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3880945">expectedTag</span>&nbsp;<span class="op" id="3880957">=</span>&nbsp;<span class="op" id="3880959">*</span><span class="ident" id="3880960">params</span><span class="op" id="3880966">.</span><span class="ident" id="3880967">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3880972">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3880976">if</span>&nbsp;<span class="op" id="3880979">!</span><span class="ident" id="3880980">params</span><span class="op" id="3880986">.</span><span class="ident" id="3880987">explicit</span>&nbsp;<span class="op" id="3880996">&amp;&amp;</span>&nbsp;<span class="ident" id="3880999">params</span><span class="op" id="3881005">.</span><span class="ident" id="3881006">application</span>&nbsp;<span class="op" id="3881018">&amp;&amp;</span>&nbsp;<span class="ident" id="3881021">params</span><span class="op" id="3881027">.</span><span class="ident" id="3881028">tag</span>&nbsp;<span class="op" id="3881032">!=</span>&nbsp;<span class="ident" id="3881035">nil</span>&nbsp;<span class="op" id="3881039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881043">expectedClass</span>&nbsp;<span class="op" id="3881057">=</span>&nbsp;<span class="ident" id="3881059">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881078">expectedTag</span>&nbsp;<span class="op" id="3881090">=</span>&nbsp;<span class="op" id="3881092">*</span><span class="ident" id="3881093">params</span><span class="op" id="3881099">.</span><span class="ident" id="3881100">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881105">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3881109">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881167">if</span>&nbsp;<span class="ident" id="3881170">t</span><span class="op" id="3881171">.</span><span class="ident" id="3881172">class</span>&nbsp;<span class="op" id="3881178">!=</span>&nbsp;<span class="ident" id="3881181">expectedClass</span>&nbsp;<span class="op" id="3881195">||</span>&nbsp;<span class="ident" id="3881198">t</span><span class="op" id="3881199">.</span><span class="ident" id="3881200">tag</span>&nbsp;<span class="op" id="3881204">!=</span>&nbsp;<span class="ident" id="3881207">expectedTag</span>&nbsp;<span class="op" id="3881219">||</span>&nbsp;<span class="ident" id="3881222">t</span><span class="op" id="3881223">.</span><span class="ident" id="3881224">isCompound</span>&nbsp;<span class="op" id="3881235">!=</span>&nbsp;<span class="ident" id="3881238">compoundType</span>&nbsp;<span class="op" id="3881251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3881255">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881318">ok</span>&nbsp;<span class="op" id="3881321">:=</span>&nbsp;<span class="ident" id="3881324">setDefaultValue</span><span class="op" id="3881339">(</span><span class="ident" id="3881340">v</span><span class="op" id="3881341">,</span>&nbsp;<span class="ident" id="3881343">params</span><span class="op" id="3881349">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881353">if</span>&nbsp;<span class="ident" id="3881356">ok</span>&nbsp;<span class="op" id="3881359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881364">offset</span>&nbsp;<span class="op" id="3881371">=</span>&nbsp;<span class="ident" id="3881373">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881386">}</span>&nbsp;<span class="keyword" id="3881388">else</span>&nbsp;<span class="op" id="3881393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881398">err</span>&nbsp;<span class="op" id="3881402">=</span>&nbsp;<span class="ident" id="3881404">StructuralError</span><span class="op" id="3881419">{</span><span class="ident" id="3881420">fmt</span><span class="op" id="3881423">.</span><span class="ident" id="3881424">Sprintf</span><span class="op" id="3881431">(</span><span class="string" id="3881432">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="3881473">,</span>&nbsp;<span class="ident" id="3881475">expectedTag</span><span class="op" id="3881486">,</span>&nbsp;<span class="ident" id="3881488">t</span><span class="op" id="3881489">,</span>&nbsp;<span class="ident" id="3881491">params</span><span class="op" id="3881497">,</span>&nbsp;<span class="ident" id="3881499">fieldType</span><span class="op" id="3881508">.</span><span class="ident" id="3881509">Name</span><span class="op" id="3881513">(</span><span class="op" id="3881514">)</span><span class="op" id="3881515">,</span>&nbsp;<span class="ident" id="3881517">offset</span><span class="op" id="3881523">)</span><span class="op" id="3881524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881528">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881532">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881543">if</span>&nbsp;<span class="ident" id="3881546">invalidLength</span><span class="op" id="3881559">(</span><span class="ident" id="3881560">offset</span><span class="op" id="3881566">,</span>&nbsp;<span class="ident" id="3881568">t</span><span class="op" id="3881569">.</span><span class="ident" id="3881570">length</span><span class="op" id="3881576">,</span>&nbsp;<span class="builtinfunc" id="3881578">len</span><span class="op" id="3881581">(</span><span class="ident" id="3881582">bytes</span><span class="op" id="3881587">)</span><span class="op" id="3881588">)</span>&nbsp;<span class="op" id="3881590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881594">err</span>&nbsp;<span class="op" id="3881598">=</span>&nbsp;<span class="ident" id="3881600">SyntaxError</span><span class="op" id="3881611">{</span><span class="string" id="3881612">&#34;data&nbsp;truncated&#34;</span><span class="op" id="3881628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881632">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3881640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881643">innerBytes</span>&nbsp;<span class="op" id="3881654">:=</span>&nbsp;<span class="ident" id="3881657">bytes</span><span class="op" id="3881662">[</span><span class="ident" id="3881663">offset</span>&nbsp;<span class="op" id="3881670">:</span>&nbsp;<span class="ident" id="3881672">offset</span><span class="op" id="3881678">+</span><span class="ident" id="3881679">t</span><span class="op" id="3881680">.</span><span class="ident" id="3881681">length</span><span class="op" id="3881687">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881690">offset</span>&nbsp;<span class="op" id="3881697">+=</span>&nbsp;<span class="ident" id="3881700">t</span><span class="op" id="3881701">.</span><span class="ident" id="3881702">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3881711">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881774">switch</span>&nbsp;<span class="ident" id="3881781">fieldType</span>&nbsp;<span class="op" id="3881791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881794">case</span>&nbsp;<span class="ident" id="3881799">objectIdentifierType</span><span class="op" id="3881819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881823">newSlice</span><span class="op" id="3881831">,</span>&nbsp;<span class="ident" id="3881833">err1</span>&nbsp;<span class="op" id="3881838">:=</span>&nbsp;<span class="ident" id="3881841">parseObjectIdentifier</span><span class="op" id="3881862">(</span><span class="ident" id="3881863">innerBytes</span><span class="op" id="3881873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881877">v</span><span class="op" id="3881878">.</span><span class="ident" id="3881879">Set</span><span class="op" id="3881882">(</span><span class="ident" id="3881883">reflect</span><span class="op" id="3881890">.</span><span class="ident" id="3881891">MakeSlice</span><span class="op" id="3881900">(</span><span class="ident" id="3881901">v</span><span class="op" id="3881902">.</span><span class="ident" id="3881903">Type</span><span class="op" id="3881907">(</span><span class="op" id="3881908">)</span><span class="op" id="3881909">,</span>&nbsp;<span class="builtinfunc" id="3881911">len</span><span class="op" id="3881914">(</span><span class="ident" id="3881915">newSlice</span><span class="op" id="3881923">)</span><span class="op" id="3881924">,</span>&nbsp;<span class="builtinfunc" id="3881926">len</span><span class="op" id="3881929">(</span><span class="ident" id="3881930">newSlice</span><span class="op" id="3881938">)</span><span class="op" id="3881939">)</span><span class="op" id="3881940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3881944">if</span>&nbsp;<span class="ident" id="3881947">err1</span>&nbsp;<span class="op" id="3881952">==</span>&nbsp;<span class="ident" id="3881955">nil</span>&nbsp;<span class="op" id="3881959">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3881964">reflect</span><span class="op" id="3881971">.</span><span class="ident" id="3881972">Copy</span><span class="op" id="3881976">(</span><span class="ident" id="3881977">v</span><span class="op" id="3881978">,</span>&nbsp;<span class="ident" id="3881980">reflect</span><span class="op" id="3881987">.</span><span class="ident" id="3881988">ValueOf</span><span class="op" id="3881995">(</span><span class="ident" id="3881996">newSlice</span><span class="op" id="3882004">)</span><span class="op" id="3882005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882013">err</span>&nbsp;<span class="op" id="3882017">=</span>&nbsp;<span class="ident" id="3882019">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882026">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882034">case</span>&nbsp;<span class="ident" id="3882039">bitStringType</span><span class="op" id="3882052">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882056">bs</span><span class="op" id="3882058">,</span>&nbsp;<span class="ident" id="3882060">err1</span>&nbsp;<span class="op" id="3882065">:=</span>&nbsp;<span class="ident" id="3882068">parseBitString</span><span class="op" id="3882082">(</span><span class="ident" id="3882083">innerBytes</span><span class="op" id="3882093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882097">if</span>&nbsp;<span class="ident" id="3882100">err1</span>&nbsp;<span class="op" id="3882105">==</span>&nbsp;<span class="ident" id="3882108">nil</span>&nbsp;<span class="op" id="3882112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882117">v</span><span class="op" id="3882118">.</span><span class="ident" id="3882119">Set</span><span class="op" id="3882122">(</span><span class="ident" id="3882123">reflect</span><span class="op" id="3882130">.</span><span class="ident" id="3882131">ValueOf</span><span class="op" id="3882138">(</span><span class="ident" id="3882139">bs</span><span class="op" id="3882141">)</span><span class="op" id="3882142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882150">err</span>&nbsp;<span class="op" id="3882154">=</span>&nbsp;<span class="ident" id="3882156">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882163">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882171">case</span>&nbsp;<span class="ident" id="3882176">timeType</span><span class="op" id="3882184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882188">var</span>&nbsp;<span class="ident" id="3882192">time</span>&nbsp;<span class="ident" id="3882197">time</span><span class="op" id="3882201">.</span><span class="ident" id="3882202">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882209">var</span>&nbsp;<span class="ident" id="3882213">err1</span>&nbsp;<span class="builtintype" id="3882218">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882226">if</span>&nbsp;<span class="ident" id="3882229">universalTag</span>&nbsp;<span class="op" id="3882242">==</span>&nbsp;<span class="ident" id="3882245">tagUTCTime</span>&nbsp;<span class="op" id="3882256">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882261">time</span><span class="op" id="3882265">,</span>&nbsp;<span class="ident" id="3882267">err1</span>&nbsp;<span class="op" id="3882272">=</span>&nbsp;<span class="ident" id="3882274">parseUTCTime</span><span class="op" id="3882286">(</span><span class="ident" id="3882287">innerBytes</span><span class="op" id="3882297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882301">}</span>&nbsp;<span class="keyword" id="3882303">else</span>&nbsp;<span class="op" id="3882308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882313">time</span><span class="op" id="3882317">,</span>&nbsp;<span class="ident" id="3882319">err1</span>&nbsp;<span class="op" id="3882324">=</span>&nbsp;<span class="ident" id="3882326">parseGeneralizedTime</span><span class="op" id="3882346">(</span><span class="ident" id="3882347">innerBytes</span><span class="op" id="3882357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882365">if</span>&nbsp;<span class="ident" id="3882368">err1</span>&nbsp;<span class="op" id="3882373">==</span>&nbsp;<span class="ident" id="3882376">nil</span>&nbsp;<span class="op" id="3882380">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882385">v</span><span class="op" id="3882386">.</span><span class="ident" id="3882387">Set</span><span class="op" id="3882390">(</span><span class="ident" id="3882391">reflect</span><span class="op" id="3882398">.</span><span class="ident" id="3882399">ValueOf</span><span class="op" id="3882406">(</span><span class="ident" id="3882407">time</span><span class="op" id="3882411">)</span><span class="op" id="3882412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882420">err</span>&nbsp;<span class="op" id="3882424">=</span>&nbsp;<span class="ident" id="3882426">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882433">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882441">case</span>&nbsp;<span class="ident" id="3882446">enumeratedType</span><span class="op" id="3882460">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882464">parsedInt</span><span class="op" id="3882473">,</span>&nbsp;<span class="ident" id="3882475">err1</span>&nbsp;<span class="op" id="3882480">:=</span>&nbsp;<span class="ident" id="3882483">parseInt32</span><span class="op" id="3882493">(</span><span class="ident" id="3882494">innerBytes</span><span class="op" id="3882504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882508">if</span>&nbsp;<span class="ident" id="3882511">err1</span>&nbsp;<span class="op" id="3882516">==</span>&nbsp;<span class="ident" id="3882519">nil</span>&nbsp;<span class="op" id="3882523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882528">v</span><span class="op" id="3882529">.</span><span class="ident" id="3882530">SetInt</span><span class="op" id="3882536">(</span><span class="ident" id="3882537">int64</span><span class="op" id="3882542">(</span><span class="ident" id="3882543">parsedInt</span><span class="op" id="3882552">)</span><span class="op" id="3882553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882561">err</span>&nbsp;<span class="op" id="3882565">=</span>&nbsp;<span class="ident" id="3882567">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882574">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882582">case</span>&nbsp;<span class="ident" id="3882587">flagType</span><span class="op" id="3882595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882599">v</span><span class="op" id="3882600">.</span><span class="ident" id="3882601">SetBool</span><span class="op" id="3882608">(</span><span class="builtintype" id="3882609">true</span><span class="op" id="3882613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882617">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882625">case</span>&nbsp;<span class="ident" id="3882630">bigIntType</span><span class="op" id="3882640">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882644">parsedInt</span>&nbsp;<span class="op" id="3882654">:=</span>&nbsp;<span class="ident" id="3882657">parseBigInt</span><span class="op" id="3882668">(</span><span class="ident" id="3882669">innerBytes</span><span class="op" id="3882679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882683">v</span><span class="op" id="3882684">.</span><span class="ident" id="3882685">Set</span><span class="op" id="3882688">(</span><span class="ident" id="3882689">reflect</span><span class="op" id="3882696">.</span><span class="ident" id="3882697">ValueOf</span><span class="op" id="3882704">(</span><span class="ident" id="3882705">parsedInt</span><span class="op" id="3882714">)</span><span class="op" id="3882715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882719">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882730">switch</span>&nbsp;<span class="ident" id="3882737">val</span>&nbsp;<span class="op" id="3882741">:=</span>&nbsp;<span class="ident" id="3882744">v</span><span class="op" id="3882745">;</span>&nbsp;<span class="ident" id="3882747">val</span><span class="op" id="3882750">.</span><span class="ident" id="3882751">Kind</span><span class="op" id="3882755">(</span><span class="op" id="3882756">)</span>&nbsp;<span class="op" id="3882758">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882761">case</span>&nbsp;<span class="ident" id="3882766">reflect</span><span class="op" id="3882773">.</span><span class="ident" id="3882774">Bool</span><span class="op" id="3882778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882782">parsedBool</span><span class="op" id="3882792">,</span>&nbsp;<span class="ident" id="3882794">err1</span>&nbsp;<span class="op" id="3882799">:=</span>&nbsp;<span class="ident" id="3882802">parseBool</span><span class="op" id="3882811">(</span><span class="ident" id="3882812">innerBytes</span><span class="op" id="3882822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882826">if</span>&nbsp;<span class="ident" id="3882829">err1</span>&nbsp;<span class="op" id="3882834">==</span>&nbsp;<span class="ident" id="3882837">nil</span>&nbsp;<span class="op" id="3882841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882846">val</span><span class="op" id="3882849">.</span><span class="ident" id="3882850">SetBool</span><span class="op" id="3882857">(</span><span class="ident" id="3882858">parsedBool</span><span class="op" id="3882868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3882872">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882876">err</span>&nbsp;<span class="op" id="3882880">=</span>&nbsp;<span class="ident" id="3882882">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882889">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882897">case</span>&nbsp;<span class="ident" id="3882902">reflect</span><span class="op" id="3882909">.</span><span class="ident" id="3882910">Int</span><span class="op" id="3882913">,</span>&nbsp;<span class="ident" id="3882915">reflect</span><span class="op" id="3882922">.</span><span class="ident" id="3882923">Int32</span><span class="op" id="3882928">,</span>&nbsp;<span class="ident" id="3882930">reflect</span><span class="op" id="3882937">.</span><span class="ident" id="3882938">Int64</span><span class="op" id="3882943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3882947">if</span>&nbsp;<span class="ident" id="3882950">val</span><span class="op" id="3882953">.</span><span class="ident" id="3882954">Type</span><span class="op" id="3882958">(</span><span class="op" id="3882959">)</span><span class="op" id="3882960">.</span><span class="ident" id="3882961">Size</span><span class="op" id="3882965">(</span><span class="op" id="3882966">)</span>&nbsp;<span class="op" id="3882968">==</span>&nbsp;<span class="num" id="3882971">4</span>&nbsp;<span class="op" id="3882973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3882978">parsedInt</span><span class="op" id="3882987">,</span>&nbsp;<span class="ident" id="3882989">err1</span>&nbsp;<span class="op" id="3882994">:=</span>&nbsp;<span class="ident" id="3882997">parseInt32</span><span class="op" id="3883007">(</span><span class="ident" id="3883008">innerBytes</span><span class="op" id="3883018">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883023">if</span>&nbsp;<span class="ident" id="3883026">err1</span>&nbsp;<span class="op" id="3883031">==</span>&nbsp;<span class="ident" id="3883034">nil</span>&nbsp;<span class="op" id="3883038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883044">val</span><span class="op" id="3883047">.</span><span class="ident" id="3883048">SetInt</span><span class="op" id="3883054">(</span><span class="ident" id="3883055">int64</span><span class="op" id="3883060">(</span><span class="ident" id="3883061">parsedInt</span><span class="op" id="3883070">)</span><span class="op" id="3883071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883081">err</span>&nbsp;<span class="op" id="3883085">=</span>&nbsp;<span class="ident" id="3883087">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883094">}</span>&nbsp;<span class="keyword" id="3883096">else</span>&nbsp;<span class="op" id="3883101">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883106">parsedInt</span><span class="op" id="3883115">,</span>&nbsp;<span class="ident" id="3883117">err1</span>&nbsp;<span class="op" id="3883122">:=</span>&nbsp;<span class="ident" id="3883125">parseInt64</span><span class="op" id="3883135">(</span><span class="ident" id="3883136">innerBytes</span><span class="op" id="3883146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883151">if</span>&nbsp;<span class="ident" id="3883154">err1</span>&nbsp;<span class="op" id="3883159">==</span>&nbsp;<span class="ident" id="3883162">nil</span>&nbsp;<span class="op" id="3883166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883172">val</span><span class="op" id="3883175">.</span><span class="ident" id="3883176">SetInt</span><span class="op" id="3883182">(</span><span class="ident" id="3883183">parsedInt</span><span class="op" id="3883192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883202">err</span>&nbsp;<span class="op" id="3883206">=</span>&nbsp;<span class="ident" id="3883208">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883227">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883285">case</span>&nbsp;<span class="ident" id="3883290">reflect</span><span class="op" id="3883297">.</span><span class="ident" id="3883298">Struct</span><span class="op" id="3883304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883308">structType</span>&nbsp;<span class="op" id="3883319">:=</span>&nbsp;<span class="ident" id="3883322">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883335">if</span>&nbsp;<span class="ident" id="3883338">structType</span><span class="op" id="3883348">.</span><span class="ident" id="3883349">NumField</span><span class="op" id="3883357">(</span><span class="op" id="3883358">)</span>&nbsp;<span class="op" id="3883360">&gt;</span>&nbsp;<span class="num" id="3883362">0</span>&nbsp;<span class="op" id="3883364">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883370">structType</span><span class="op" id="3883380">.</span><span class="ident" id="3883381">Field</span><span class="op" id="3883386">(</span><span class="num" id="3883387">0</span><span class="op" id="3883388">)</span><span class="op" id="3883389">.</span><span class="ident" id="3883390">Type</span>&nbsp;<span class="op" id="3883395">==</span>&nbsp;<span class="ident" id="3883398">rawContentsType</span>&nbsp;<span class="op" id="3883414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883419">bytes</span>&nbsp;<span class="op" id="3883425">:=</span>&nbsp;<span class="ident" id="3883428">bytes</span><span class="op" id="3883433">[</span><span class="ident" id="3883434">initOffset</span><span class="op" id="3883444">:</span><span class="ident" id="3883445">offset</span><span class="op" id="3883451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883456">val</span><span class="op" id="3883459">.</span><span class="ident" id="3883460">Field</span><span class="op" id="3883465">(</span><span class="num" id="3883466">0</span><span class="op" id="3883467">)</span><span class="op" id="3883468">.</span><span class="ident" id="3883469">Set</span><span class="op" id="3883472">(</span><span class="ident" id="3883473">reflect</span><span class="op" id="3883480">.</span><span class="ident" id="3883481">ValueOf</span><span class="op" id="3883488">(</span><span class="ident" id="3883489">RawContent</span><span class="op" id="3883499">(</span><span class="ident" id="3883500">bytes</span><span class="op" id="3883505">)</span><span class="op" id="3883506">)</span><span class="op" id="3883507">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883516">innerOffset</span>&nbsp;<span class="op" id="3883528">:=</span>&nbsp;<span class="num" id="3883531">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883535">for</span>&nbsp;<span class="ident" id="3883539">i</span>&nbsp;<span class="op" id="3883541">:=</span>&nbsp;<span class="num" id="3883544">0</span><span class="op" id="3883545">;</span>&nbsp;<span class="ident" id="3883547">i</span>&nbsp;<span class="op" id="3883549">&lt;</span>&nbsp;<span class="ident" id="3883551">structType</span><span class="op" id="3883561">.</span><span class="ident" id="3883562">NumField</span><span class="op" id="3883570">(</span><span class="op" id="3883571">)</span><span class="op" id="3883572">;</span>&nbsp;<span class="ident" id="3883574">i</span><span class="op" id="3883575">++</span>&nbsp;<span class="op" id="3883578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883583">field</span>&nbsp;<span class="op" id="3883589">:=</span>&nbsp;<span class="ident" id="3883592">structType</span><span class="op" id="3883602">.</span><span class="ident" id="3883603">Field</span><span class="op" id="3883608">(</span><span class="ident" id="3883609">i</span><span class="op" id="3883610">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883615">if</span>&nbsp;<span class="ident" id="3883618">i</span>&nbsp;<span class="op" id="3883620">==</span>&nbsp;<span class="num" id="3883623">0</span>&nbsp;<span class="op" id="3883625">&amp;&amp;</span>&nbsp;<span class="ident" id="3883628">field</span><span class="op" id="3883633">.</span><span class="ident" id="3883634">Type</span>&nbsp;<span class="op" id="3883639">==</span>&nbsp;<span class="ident" id="3883642">rawContentsType</span>&nbsp;<span class="op" id="3883658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883664">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3883681">innerOffset</span><span class="op" id="3883692">,</span>&nbsp;<span class="ident" id="3883694">err</span>&nbsp;<span class="op" id="3883698">=</span>&nbsp;<span class="ident" id="3883700">parseField</span><span class="op" id="3883710">(</span><span class="ident" id="3883711">val</span><span class="op" id="3883714">.</span><span class="ident" id="3883715">Field</span><span class="op" id="3883720">(</span><span class="ident" id="3883721">i</span><span class="op" id="3883722">)</span><span class="op" id="3883723">,</span>&nbsp;<span class="ident" id="3883725">innerBytes</span><span class="op" id="3883735">,</span>&nbsp;<span class="ident" id="3883737">innerOffset</span><span class="op" id="3883748">,</span>&nbsp;<span class="ident" id="3883750">parseFieldParameters</span><span class="op" id="3883770">(</span><span class="ident" id="3883771">field</span><span class="op" id="3883776">.</span><span class="ident" id="3883777">Tag</span><span class="op" id="3883780">.</span><span class="ident" id="3883781">Get</span><span class="op" id="3883784">(</span><span class="string" id="3883785">&#34;asn1&#34;</span><span class="op" id="3883791">)</span><span class="op" id="3883792">)</span><span class="op" id="3883793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883798">if</span>&nbsp;<span class="ident" id="3883801">err</span>&nbsp;<span class="op" id="3883805">!=</span>&nbsp;<span class="ident" id="3883808">nil</span>&nbsp;<span class="op" id="3883812">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3883832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883836">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883897">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3883959">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3883996">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884004">case</span>&nbsp;<span class="ident" id="3884009">reflect</span><span class="op" id="3884016">.</span><span class="ident" id="3884017">Slice</span><span class="op" id="3884022">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884026">sliceType</span>&nbsp;<span class="op" id="3884036">:=</span>&nbsp;<span class="ident" id="3884039">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884051">if</span>&nbsp;<span class="ident" id="3884054">sliceType</span><span class="op" id="3884063">.</span><span class="ident" id="3884064">Elem</span><span class="op" id="3884068">(</span><span class="op" id="3884069">)</span><span class="op" id="3884070">.</span><span class="ident" id="3884071">Kind</span><span class="op" id="3884075">(</span><span class="op" id="3884076">)</span>&nbsp;<span class="op" id="3884078">==</span>&nbsp;<span class="ident" id="3884081">reflect</span><span class="op" id="3884088">.</span><span class="ident" id="3884089">Uint8</span>&nbsp;<span class="op" id="3884095">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884100">val</span><span class="op" id="3884103">.</span><span class="ident" id="3884104">Set</span><span class="op" id="3884107">(</span><span class="ident" id="3884108">reflect</span><span class="op" id="3884115">.</span><span class="ident" id="3884116">MakeSlice</span><span class="op" id="3884125">(</span><span class="ident" id="3884126">sliceType</span><span class="op" id="3884135">,</span>&nbsp;<span class="builtinfunc" id="3884137">len</span><span class="op" id="3884140">(</span><span class="ident" id="3884141">innerBytes</span><span class="op" id="3884151">)</span><span class="op" id="3884152">,</span>&nbsp;<span class="builtinfunc" id="3884154">len</span><span class="op" id="3884157">(</span><span class="ident" id="3884158">innerBytes</span><span class="op" id="3884168">)</span><span class="op" id="3884169">)</span><span class="op" id="3884170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884175">reflect</span><span class="op" id="3884182">.</span><span class="ident" id="3884183">Copy</span><span class="op" id="3884187">(</span><span class="ident" id="3884188">val</span><span class="op" id="3884191">,</span>&nbsp;<span class="ident" id="3884193">reflect</span><span class="op" id="3884200">.</span><span class="ident" id="3884201">ValueOf</span><span class="op" id="3884208">(</span><span class="ident" id="3884209">innerBytes</span><span class="op" id="3884219">)</span><span class="op" id="3884220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884225">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884238">newSlice</span><span class="op" id="3884246">,</span>&nbsp;<span class="ident" id="3884248">err1</span>&nbsp;<span class="op" id="3884253">:=</span>&nbsp;<span class="ident" id="3884256">parseSequenceOf</span><span class="op" id="3884271">(</span><span class="ident" id="3884272">innerBytes</span><span class="op" id="3884282">,</span>&nbsp;<span class="ident" id="3884284">sliceType</span><span class="op" id="3884293">,</span>&nbsp;<span class="ident" id="3884295">sliceType</span><span class="op" id="3884304">.</span><span class="ident" id="3884305">Elem</span><span class="op" id="3884309">(</span><span class="op" id="3884310">)</span><span class="op" id="3884311">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884315">if</span>&nbsp;<span class="ident" id="3884318">err1</span>&nbsp;<span class="op" id="3884323">==</span>&nbsp;<span class="ident" id="3884326">nil</span>&nbsp;<span class="op" id="3884330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884335">val</span><span class="op" id="3884338">.</span><span class="ident" id="3884339">Set</span><span class="op" id="3884342">(</span><span class="ident" id="3884343">newSlice</span><span class="op" id="3884351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3884355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884359">err</span>&nbsp;<span class="op" id="3884363">=</span>&nbsp;<span class="ident" id="3884365">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884372">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884380">case</span>&nbsp;<span class="ident" id="3884385">reflect</span><span class="op" id="3884392">.</span><span class="ident" id="3884393">String</span><span class="op" id="3884399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884403">var</span>&nbsp;<span class="ident" id="3884407">v</span>&nbsp;<span class="builtintype" id="3884409">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884418">switch</span>&nbsp;<span class="ident" id="3884425">universalTag</span>&nbsp;<span class="op" id="3884438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884442">case</span>&nbsp;<span class="ident" id="3884447">tagPrintableString</span><span class="op" id="3884465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884470">v</span><span class="op" id="3884471">,</span>&nbsp;<span class="ident" id="3884473">err</span>&nbsp;<span class="op" id="3884477">=</span>&nbsp;<span class="ident" id="3884479">parsePrintableString</span><span class="op" id="3884499">(</span><span class="ident" id="3884500">innerBytes</span><span class="op" id="3884510">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884514">case</span>&nbsp;<span class="ident" id="3884519">tagIA5String</span><span class="op" id="3884531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884536">v</span><span class="op" id="3884537">,</span>&nbsp;<span class="ident" id="3884539">err</span>&nbsp;<span class="op" id="3884543">=</span>&nbsp;<span class="ident" id="3884545">parseIA5String</span><span class="op" id="3884559">(</span><span class="ident" id="3884560">innerBytes</span><span class="op" id="3884570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884574">case</span>&nbsp;<span class="ident" id="3884579">tagT61String</span><span class="op" id="3884591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884596">v</span><span class="op" id="3884597">,</span>&nbsp;<span class="ident" id="3884599">err</span>&nbsp;<span class="op" id="3884603">=</span>&nbsp;<span class="ident" id="3884605">parseT61String</span><span class="op" id="3884619">(</span><span class="ident" id="3884620">innerBytes</span><span class="op" id="3884630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884634">case</span>&nbsp;<span class="ident" id="3884639">tagUTF8String</span><span class="op" id="3884652">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884657">v</span><span class="op" id="3884658">,</span>&nbsp;<span class="ident" id="3884660">err</span>&nbsp;<span class="op" id="3884664">=</span>&nbsp;<span class="ident" id="3884666">parseUTF8String</span><span class="op" id="3884681">(</span><span class="ident" id="3884682">innerBytes</span><span class="op" id="3884692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884696">case</span>&nbsp;<span class="ident" id="3884701">tagGeneralString</span><span class="op" id="3884717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3884722">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3884776">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3884834">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3884888">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884943">v</span><span class="op" id="3884944">,</span>&nbsp;<span class="ident" id="3884946">err</span>&nbsp;<span class="op" id="3884950">=</span>&nbsp;<span class="ident" id="3884952">parseT61String</span><span class="op" id="3884966">(</span><span class="ident" id="3884967">innerBytes</span><span class="op" id="3884977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3884981">default</span><span class="op" id="3884988">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3884993">err</span>&nbsp;<span class="op" id="3884997">=</span>&nbsp;<span class="ident" id="3884999">SyntaxError</span><span class="op" id="3885010">{</span><span class="ident" id="3885011">fmt</span><span class="op" id="3885014">.</span><span class="ident" id="3885015">Sprintf</span><span class="op" id="3885022">(</span><span class="string" id="3885023">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="3885063">,</span>&nbsp;<span class="ident" id="3885065">universalTag</span><span class="op" id="3885077">)</span><span class="op" id="3885078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885082">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885086">if</span>&nbsp;<span class="ident" id="3885089">err</span>&nbsp;<span class="op" id="3885093">==</span>&nbsp;<span class="ident" id="3885096">nil</span>&nbsp;<span class="op" id="3885100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885105">val</span><span class="op" id="3885108">.</span><span class="ident" id="3885109">SetString</span><span class="op" id="3885118">(</span><span class="ident" id="3885119">v</span><span class="op" id="3885120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885128">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885136">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885139">err</span>&nbsp;<span class="op" id="3885143">=</span>&nbsp;<span class="ident" id="3885145">StructuralError</span><span class="op" id="3885160">{</span><span class="string" id="3885161">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="3885177">+</span>&nbsp;<span class="ident" id="3885179">v</span><span class="op" id="3885180">.</span><span class="ident" id="3885181">Type</span><span class="op" id="3885185">(</span><span class="op" id="3885186">)</span><span class="op" id="3885187">.</span><span class="ident" id="3885188">String</span><span class="op" id="3885194">(</span><span class="op" id="3885195">)</span><span class="op" id="3885196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885199">return</span><br>
<span class="lineno"></span><span class="op" id="3885206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3885209">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="3885287">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="3885334">func</span>&nbsp;<span class="ident" id="3885339">canHaveDefaultValue</span><span class="op" id="3885358">(</span><span class="ident" id="3885359">k</span>&nbsp;<span class="ident" id="3885361">reflect</span><span class="op" id="3885368">.</span><span class="ident" id="3885369">Kind</span><span class="op" id="3885373">)</span>&nbsp;<span class="builtintype" id="3885375">bool</span>&nbsp;<span class="op" id="3885380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885383">switch</span>&nbsp;<span class="ident" id="3885390">k</span>&nbsp;<span class="op" id="3885392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885395">case</span>&nbsp;<span class="ident" id="3885400">reflect</span><span class="op" id="3885407">.</span><span class="ident" id="3885408">Int</span><span class="op" id="3885411">,</span>&nbsp;<span class="ident" id="3885413">reflect</span><span class="op" id="3885420">.</span><span class="ident" id="3885421">Int8</span><span class="op" id="3885425">,</span>&nbsp;<span class="ident" id="3885427">reflect</span><span class="op" id="3885434">.</span><span class="ident" id="3885435">Int16</span><span class="op" id="3885440">,</span>&nbsp;<span class="ident" id="3885442">reflect</span><span class="op" id="3885449">.</span><span class="ident" id="3885450">Int32</span><span class="op" id="3885455">,</span>&nbsp;<span class="ident" id="3885457">reflect</span><span class="op" id="3885464">.</span><span class="ident" id="3885465">Int64</span><span class="op" id="3885470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885474">return</span>&nbsp;<span class="builtintype" id="3885481">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885491">return</span>&nbsp;<span class="builtintype" id="3885498">false</span><br>
<span class="lineno"></span><span class="op" id="3885504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="3885507">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3885586">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3885666">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="3885728">func</span>&nbsp;<span class="ident" id="3885733">setDefaultValue</span><span class="op" id="3885748">(</span><span class="ident" id="3885749">v</span>&nbsp;<span class="ident" id="3885751">reflect</span><span class="op" id="3885758">.</span><span class="ident" id="3885759">Value</span><span class="op" id="3885764">,</span>&nbsp;<span class="ident" id="3885766">params</span>&nbsp;<span class="ident" id="3885773">fieldParameters</span><span class="op" id="3885788">)</span>&nbsp;<span class="op" id="3885790">(</span><span class="ident" id="3885791">ok</span>&nbsp;<span class="builtintype" id="3885794">bool</span><span class="op" id="3885798">)</span>&nbsp;<span class="op" id="3885800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885803">if</span>&nbsp;<span class="op" id="3885806">!</span><span class="ident" id="3885807">params</span><span class="op" id="3885813">.</span><span class="ident" id="3885814">optional</span>&nbsp;<span class="op" id="3885823">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885838">ok</span>&nbsp;<span class="op" id="3885841">=</span>&nbsp;<span class="builtintype" id="3885843">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885849">if</span>&nbsp;<span class="ident" id="3885852">params</span><span class="op" id="3885858">.</span><span class="ident" id="3885859">defaultValue</span>&nbsp;<span class="op" id="3885872">==</span>&nbsp;<span class="ident" id="3885875">nil</span>&nbsp;<span class="op" id="3885879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885883">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885894">if</span>&nbsp;<span class="ident" id="3885897">canHaveDefaultValue</span><span class="op" id="3885916">(</span><span class="ident" id="3885917">v</span><span class="op" id="3885918">.</span><span class="ident" id="3885919">Kind</span><span class="op" id="3885923">(</span><span class="op" id="3885924">)</span><span class="op" id="3885925">)</span>&nbsp;<span class="op" id="3885927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3885931">v</span><span class="op" id="3885932">.</span><span class="ident" id="3885933">SetInt</span><span class="op" id="3885939">(</span><span class="op" id="3885940">*</span><span class="ident" id="3885941">params</span><span class="op" id="3885947">.</span><span class="ident" id="3885948">defaultValue</span><span class="op" id="3885960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3885963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3885966">return</span><br>
<span class="lineno">855</span><span class="op" id="3885973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3885976">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="3886035">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="3886116">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="3886175">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="3886228">//</span><br>
<span class="lineno"></span><span class="comment" id="3886231">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="3886291">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="3886335">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="3886388">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3886424">//</span><br>
<span class="lineno"></span><span class="comment" id="3886427">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="3886481">//</span><br>
<span class="lineno"></span><span class="comment" id="3886484">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="3886537">//</span><br>
<span class="lineno"></span><span class="comment" id="3886540">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3886591">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="3886612">//</span><br>
<span class="lineno"></span><span class="comment" id="3886615">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="3886671">//</span><br>
<span class="lineno"></span><span class="comment" id="3886674">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="3886744">//</span><br>
<span class="lineno"></span><span class="comment" id="3886747">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3886816">//</span><br>
<span class="lineno">880</span><span class="comment" id="3886819">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="3886886">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3886954">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="3886991">//</span><br>
<span class="lineno"></span><span class="comment" id="3886994">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="3887047">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="3887113">//</span><br>
<span class="lineno"></span><span class="comment" id="3887116">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="3887171">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3887221">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="3887276">//</span><br>
<span class="lineno"></span><span class="comment" id="3887279">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="3887353">//</span><br>
<span class="lineno"></span><span class="comment" id="3887356">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="3887412">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="3887476">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3887554">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="3887600">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="3887665">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="3887738">//</span><br>
<span class="lineno">900</span><span class="comment" id="3887741">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="3887817">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3887870">//</span><br>
<span class="lineno"></span><span class="comment" id="3887873">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="3887952">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="3888028">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="3888059">//</span><br>
<span class="lineno"></span><span class="comment" id="3888062">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="3888125">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3888161">func</span>&nbsp;<span class="ident" id="3888166">Unmarshal</span><span class="op" id="3888175">(</span><span class="ident" id="3888176">b</span>&nbsp;<span class="op" id="3888178">[</span><span class="op" id="3888179">]</span><span class="builtintype" id="3888180">byte</span><span class="op" id="3888184">,</span>&nbsp;<span class="ident" id="3888186">val</span>&nbsp;<span class="keyword" id="3888190">interface</span><span class="op" id="3888199">{</span><span class="op" id="3888200">}</span><span class="op" id="3888201">)</span>&nbsp;<span class="op" id="3888203">(</span><span class="ident" id="3888204">rest</span>&nbsp;<span class="op" id="3888209">[</span><span class="op" id="3888210">]</span><span class="builtintype" id="3888211">byte</span><span class="op" id="3888215">,</span>&nbsp;<span class="ident" id="3888217">err</span>&nbsp;<span class="builtintype" id="3888221">error</span><span class="op" id="3888226">)</span>&nbsp;<span class="op" id="3888228">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888231">return</span>&nbsp;<span class="ident" id="3888238">UnmarshalWithParams</span><span class="op" id="3888257">(</span><span class="ident" id="3888258">b</span><span class="op" id="3888259">,</span>&nbsp;<span class="ident" id="3888261">val</span><span class="op" id="3888264">,</span>&nbsp;<span class="string" id="3888266">&#34;&#34;</span><span class="op" id="3888268">)</span><br>
<span class="lineno"></span><span class="op" id="3888270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3888273">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3888344">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="3888420">func</span>&nbsp;<span class="ident" id="3888425">UnmarshalWithParams</span><span class="op" id="3888444">(</span><span class="ident" id="3888445">b</span>&nbsp;<span class="op" id="3888447">[</span><span class="op" id="3888448">]</span><span class="builtintype" id="3888449">byte</span><span class="op" id="3888453">,</span>&nbsp;<span class="ident" id="3888455">val</span>&nbsp;<span class="keyword" id="3888459">interface</span><span class="op" id="3888468">{</span><span class="op" id="3888469">}</span><span class="op" id="3888470">,</span>&nbsp;<span class="ident" id="3888472">params</span>&nbsp;<span class="builtintype" id="3888479">string</span><span class="op" id="3888485">)</span>&nbsp;<span class="op" id="3888487">(</span><span class="ident" id="3888488">rest</span>&nbsp;<span class="op" id="3888493">[</span><span class="op" id="3888494">]</span><span class="builtintype" id="3888495">byte</span><span class="op" id="3888499">,</span>&nbsp;<span class="ident" id="3888501">err</span>&nbsp;<span class="builtintype" id="3888505">error</span><span class="op" id="3888510">)</span>&nbsp;<span class="op" id="3888512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888515">v</span>&nbsp;<span class="op" id="3888517">:=</span>&nbsp;<span class="ident" id="3888520">reflect</span><span class="op" id="3888527">.</span><span class="ident" id="3888528">ValueOf</span><span class="op" id="3888535">(</span><span class="ident" id="3888536">val</span><span class="op" id="3888539">)</span><span class="op" id="3888540">.</span><span class="ident" id="3888541">Elem</span><span class="op" id="3888545">(</span><span class="op" id="3888546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888549">offset</span><span class="op" id="3888555">,</span>&nbsp;<span class="ident" id="3888557">err</span>&nbsp;<span class="op" id="3888561">:=</span>&nbsp;<span class="ident" id="3888564">parseField</span><span class="op" id="3888574">(</span><span class="ident" id="3888575">v</span><span class="op" id="3888576">,</span>&nbsp;<span class="ident" id="3888578">b</span><span class="op" id="3888579">,</span>&nbsp;<span class="num" id="3888581">0</span><span class="op" id="3888582">,</span>&nbsp;<span class="ident" id="3888584">parseFieldParameters</span><span class="op" id="3888604">(</span><span class="ident" id="3888605">params</span><span class="op" id="3888611">)</span><span class="op" id="3888612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888615">if</span>&nbsp;<span class="ident" id="3888618">err</span>&nbsp;<span class="op" id="3888622">!=</span>&nbsp;<span class="ident" id="3888625">nil</span>&nbsp;<span class="op" id="3888629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888633">return</span>&nbsp;<span class="ident" id="3888640">nil</span><span class="op" id="3888643">,</span>&nbsp;<span class="ident" id="3888645">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3888650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3888653">return</span>&nbsp;<span class="ident" id="3888660">b</span><span class="op" id="3888661">[</span><span class="ident" id="3888662">offset</span><span class="op" id="3888668">:</span><span class="op" id="3888669">]</span><span class="op" id="3888670">,</span>&nbsp;<span class="ident" id="3888672">nil</span><br>
<span class="lineno"></span><span class="op" id="3888676">}</span>
</div>
</body>
</html>
