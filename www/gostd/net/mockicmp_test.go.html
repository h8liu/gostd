<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html" class="current">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8057820">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8057876">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8057930">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8057981">package</span>&nbsp;<span class="ident" id="8057989">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8057994">import</span>&nbsp;<span class="string" id="8058001">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8058011">const</span>&nbsp;<span class="op" id="8058017">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058020">icmpv4EchoRequest</span>&nbsp;<span class="op" id="8058038">=</span>&nbsp;<span class="num" id="8058040">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058043">icmpv4EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8058061">=</span>&nbsp;<span class="num" id="8058063">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058066">icmpv6EchoRequest</span>&nbsp;<span class="op" id="8058084">=</span>&nbsp;<span class="num" id="8058086">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058091">icmpv6EchoReply</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8058109">=</span>&nbsp;<span class="num" id="8058111">129</span><br>
<span class="lineno"></span><span class="op" id="8058115">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8058118">//&nbsp;icmpMessage&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8058161">type</span>&nbsp;<span class="ident" id="8058166">icmpMessage</span>&nbsp;<span class="keyword" id="8058178">struct</span>&nbsp;<span class="op" id="8058185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058188">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8058197">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8058213">//&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058222">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8058231">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8058247">//&nbsp;code</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058256">Checksum</span>&nbsp;<span class="builtintype" id="8058265">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8058281">//&nbsp;checksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058294">Body</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058303">icmpMessageBody</span>&nbsp;<span class="comment" id="8058319">//&nbsp;body</span><br>
<span class="lineno"></span><span class="op" id="8058327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8058330">//&nbsp;icmpMessageBody&nbsp;represents&nbsp;an&nbsp;ICMP&nbsp;message&nbsp;body.</span><br>
<span class="lineno">25</span><span class="keyword" id="8058382">type</span>&nbsp;<span class="ident" id="8058387">icmpMessageBody</span>&nbsp;<span class="keyword" id="8058403">interface</span>&nbsp;<span class="op" id="8058413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058416">Len</span><span class="op" id="8058419">(</span><span class="op" id="8058420">)</span>&nbsp;<span class="builtintype" id="8058422">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058427">Marshal</span><span class="op" id="8058434">(</span><span class="op" id="8058435">)</span>&nbsp;<span class="op" id="8058437">(</span><span class="op" id="8058438">[</span><span class="op" id="8058439">]</span><span class="builtintype" id="8058440">byte</span><span class="op" id="8058444">,</span>&nbsp;<span class="builtintype" id="8058446">error</span><span class="op" id="8058451">)</span><br>
<span class="lineno"></span><span class="op" id="8058453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="8058456">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="8058524">//&nbsp;reply&nbsp;message&nbsp;m.</span><br>
<span class="lineno"></span><span class="keyword" id="8058544">func</span>&nbsp;<span class="op" id="8058549">(</span><span class="ident" id="8058550">m</span>&nbsp;<span class="op" id="8058552">*</span><span class="ident" id="8058553">icmpMessage</span><span class="op" id="8058564">)</span>&nbsp;<span class="ident" id="8058566">Marshal</span><span class="op" id="8058573">(</span><span class="op" id="8058574">)</span>&nbsp;<span class="op" id="8058576">(</span><span class="op" id="8058577">[</span><span class="op" id="8058578">]</span><span class="builtintype" id="8058579">byte</span><span class="op" id="8058583">,</span>&nbsp;<span class="builtintype" id="8058585">error</span><span class="op" id="8058590">)</span>&nbsp;<span class="op" id="8058592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058595">b</span>&nbsp;<span class="op" id="8058597">:=</span>&nbsp;<span class="op" id="8058600">[</span><span class="op" id="8058601">]</span><span class="builtintype" id="8058602">byte</span><span class="op" id="8058606">{</span><span class="builtintype" id="8058607">byte</span><span class="op" id="8058611">(</span><span class="ident" id="8058612">m</span><span class="op" id="8058613">.</span><span class="ident" id="8058614">Type</span><span class="op" id="8058618">)</span><span class="op" id="8058619">,</span>&nbsp;<span class="builtintype" id="8058621">byte</span><span class="op" id="8058625">(</span><span class="ident" id="8058626">m</span><span class="op" id="8058627">.</span><span class="ident" id="8058628">Code</span><span class="op" id="8058632">)</span><span class="op" id="8058633">,</span>&nbsp;<span class="num" id="8058635">0</span><span class="op" id="8058636">,</span>&nbsp;<span class="num" id="8058638">0</span><span class="op" id="8058639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058642">if</span>&nbsp;<span class="ident" id="8058645">m</span><span class="op" id="8058646">.</span><span class="ident" id="8058647">Body</span>&nbsp;<span class="op" id="8058652">!=</span>&nbsp;<span class="ident" id="8058655">nil</span>&nbsp;<span class="op" id="8058659">&amp;&amp;</span>&nbsp;<span class="ident" id="8058662">m</span><span class="op" id="8058663">.</span><span class="ident" id="8058664">Body</span><span class="op" id="8058668">.</span><span class="ident" id="8058669">Len</span><span class="op" id="8058672">(</span><span class="op" id="8058673">)</span>&nbsp;<span class="op" id="8058675">!=</span>&nbsp;<span class="num" id="8058678">0</span>&nbsp;<span class="op" id="8058680">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058684">mb</span><span class="op" id="8058686">,</span>&nbsp;<span class="ident" id="8058688">err</span>&nbsp;<span class="op" id="8058692">:=</span>&nbsp;<span class="ident" id="8058695">m</span><span class="op" id="8058696">.</span><span class="ident" id="8058697">Body</span><span class="op" id="8058701">.</span><span class="ident" id="8058702">Marshal</span><span class="op" id="8058709">(</span><span class="op" id="8058710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058714">if</span>&nbsp;<span class="ident" id="8058717">err</span>&nbsp;<span class="op" id="8058721">!=</span>&nbsp;<span class="ident" id="8058724">nil</span>&nbsp;<span class="op" id="8058728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058733">return</span>&nbsp;<span class="ident" id="8058740">nil</span><span class="op" id="8058743">,</span>&nbsp;<span class="ident" id="8058745">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8058751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058755">b</span>&nbsp;<span class="op" id="8058757">=</span>&nbsp;<span class="builtinfunc" id="8058759">append</span><span class="op" id="8058765">(</span><span class="ident" id="8058766">b</span><span class="op" id="8058767">,</span>&nbsp;<span class="ident" id="8058769">mb</span><span class="op" id="8058771">...</span><span class="op" id="8058774">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8058777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058780">switch</span>&nbsp;<span class="ident" id="8058787">m</span><span class="op" id="8058788">.</span><span class="ident" id="8058789">Type</span>&nbsp;<span class="op" id="8058794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058797">case</span>&nbsp;<span class="ident" id="8058802">icmpv6EchoRequest</span><span class="op" id="8058819">,</span>&nbsp;<span class="ident" id="8058821">icmpv6EchoReply</span><span class="op" id="8058836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058840">return</span>&nbsp;<span class="ident" id="8058847">b</span><span class="op" id="8058848">,</span>&nbsp;<span class="ident" id="8058850">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8058855">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058858">csumcv</span>&nbsp;<span class="op" id="8058865">:=</span>&nbsp;<span class="builtinfunc" id="8058868">len</span><span class="op" id="8058871">(</span><span class="ident" id="8058872">b</span><span class="op" id="8058873">)</span>&nbsp;<span class="op" id="8058875">-</span>&nbsp;<span class="num" id="8058877">1</span>&nbsp;<span class="comment" id="8058879">//&nbsp;checksum&nbsp;coverage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058901">s</span>&nbsp;<span class="op" id="8058903">:=</span>&nbsp;<span class="builtintype" id="8058906">uint32</span><span class="op" id="8058912">(</span><span class="num" id="8058913">0</span><span class="op" id="8058914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058917">for</span>&nbsp;<span class="ident" id="8058921">i</span>&nbsp;<span class="op" id="8058923">:=</span>&nbsp;<span class="num" id="8058926">0</span><span class="op" id="8058927">;</span>&nbsp;<span class="ident" id="8058929">i</span>&nbsp;<span class="op" id="8058931">&lt;</span>&nbsp;<span class="ident" id="8058933">csumcv</span><span class="op" id="8058939">;</span>&nbsp;<span class="ident" id="8058941">i</span>&nbsp;<span class="op" id="8058943">+=</span>&nbsp;<span class="num" id="8058946">2</span>&nbsp;<span class="op" id="8058948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8058952">s</span>&nbsp;<span class="op" id="8058954">+=</span>&nbsp;<span class="builtintype" id="8058957">uint32</span><span class="op" id="8058963">(</span><span class="ident" id="8058964">b</span><span class="op" id="8058965">[</span><span class="ident" id="8058966">i</span><span class="op" id="8058967">+</span><span class="num" id="8058968">1</span><span class="op" id="8058969">]</span><span class="op" id="8058970">)</span><span class="op" id="8058971">&lt;&lt;</span><span class="num" id="8058973">8</span>&nbsp;<span class="op" id="8058975">|</span>&nbsp;<span class="builtintype" id="8058977">uint32</span><span class="op" id="8058983">(</span><span class="ident" id="8058984">b</span><span class="op" id="8058985">[</span><span class="ident" id="8058986">i</span><span class="op" id="8058987">]</span><span class="op" id="8058988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8058991">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8058994">if</span>&nbsp;<span class="ident" id="8058997">csumcv</span><span class="op" id="8059003">&amp;</span><span class="num" id="8059004">1</span>&nbsp;<span class="op" id="8059006">==</span>&nbsp;<span class="num" id="8059009">0</span>&nbsp;<span class="op" id="8059011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059015">s</span>&nbsp;<span class="op" id="8059017">+=</span>&nbsp;<span class="builtintype" id="8059020">uint32</span><span class="op" id="8059026">(</span><span class="ident" id="8059027">b</span><span class="op" id="8059028">[</span><span class="ident" id="8059029">csumcv</span><span class="op" id="8059035">]</span><span class="op" id="8059036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8059039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059042">s</span>&nbsp;<span class="op" id="8059044">=</span>&nbsp;<span class="ident" id="8059046">s</span><span class="op" id="8059047">&gt;&gt;</span><span class="num" id="8059049">16</span>&nbsp;<span class="op" id="8059052">+</span>&nbsp;<span class="ident" id="8059054">s</span><span class="op" id="8059055">&amp;</span><span class="num" id="8059056">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059064">s</span>&nbsp;<span class="op" id="8059066">=</span>&nbsp;<span class="ident" id="8059068">s</span>&nbsp;<span class="op" id="8059070">+</span>&nbsp;<span class="ident" id="8059072">s</span><span class="op" id="8059073">&gt;&gt;</span><span class="num" id="8059075">16</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8059079">//&nbsp;Place&nbsp;checksum&nbsp;back&nbsp;in&nbsp;header;&nbsp;using&nbsp;^=&nbsp;avoids&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8059134">//&nbsp;assumption&nbsp;the&nbsp;checksum&nbsp;bytes&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059178">b</span><span class="op" id="8059179">[</span><span class="num" id="8059180">2</span><span class="op" id="8059181">]</span>&nbsp;<span class="op" id="8059183">^=</span>&nbsp;<span class="builtintype" id="8059186">byte</span><span class="op" id="8059190">(</span><span class="op" id="8059191">^</span><span class="ident" id="8059192">s</span><span class="op" id="8059193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059196">b</span><span class="op" id="8059197">[</span><span class="num" id="8059198">3</span><span class="op" id="8059199">]</span>&nbsp;<span class="op" id="8059201">^=</span>&nbsp;<span class="builtintype" id="8059204">byte</span><span class="op" id="8059208">(</span><span class="op" id="8059209">^</span><span class="ident" id="8059210">s</span>&nbsp;<span class="op" id="8059212">&gt;&gt;</span>&nbsp;<span class="num" id="8059215">8</span><span class="op" id="8059216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059219">return</span>&nbsp;<span class="ident" id="8059226">b</span><span class="op" id="8059227">,</span>&nbsp;<span class="ident" id="8059229">nil</span><br>
<span class="lineno">60</span><span class="op" id="8059233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8059236">//&nbsp;parseICMPMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="8059285">func</span>&nbsp;<span class="ident" id="8059290">parseICMPMessage</span><span class="op" id="8059306">(</span><span class="ident" id="8059307">b</span>&nbsp;<span class="op" id="8059309">[</span><span class="op" id="8059310">]</span><span class="builtintype" id="8059311">byte</span><span class="op" id="8059315">)</span>&nbsp;<span class="op" id="8059317">(</span><span class="op" id="8059318">*</span><span class="ident" id="8059319">icmpMessage</span><span class="op" id="8059330">,</span>&nbsp;<span class="builtintype" id="8059332">error</span><span class="op" id="8059337">)</span>&nbsp;<span class="op" id="8059339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059342">msglen</span>&nbsp;<span class="op" id="8059349">:=</span>&nbsp;<span class="builtinfunc" id="8059352">len</span><span class="op" id="8059355">(</span><span class="ident" id="8059356">b</span><span class="op" id="8059357">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059360">if</span>&nbsp;<span class="ident" id="8059363">msglen</span>&nbsp;<span class="op" id="8059370">&lt;</span>&nbsp;<span class="num" id="8059372">4</span>&nbsp;<span class="op" id="8059374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059378">return</span>&nbsp;<span class="ident" id="8059385">nil</span><span class="op" id="8059388">,</span>&nbsp;<span class="ident" id="8059390">errors</span><span class="op" id="8059396">.</span><span class="ident" id="8059397">New</span><span class="op" id="8059400">(</span><span class="string" id="8059401">&#34;message&nbsp;too&nbsp;short&#34;</span><span class="op" id="8059420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8059423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059426">m</span>&nbsp;<span class="op" id="8059428">:=</span>&nbsp;<span class="op" id="8059431">&amp;</span><span class="ident" id="8059432">icmpMessage</span><span class="op" id="8059443">{</span><span class="ident" id="8059444">Type</span><span class="op" id="8059448">:</span>&nbsp;<span class="builtintype" id="8059450">int</span><span class="op" id="8059453">(</span><span class="ident" id="8059454">b</span><span class="op" id="8059455">[</span><span class="num" id="8059456">0</span><span class="op" id="8059457">]</span><span class="op" id="8059458">)</span><span class="op" id="8059459">,</span>&nbsp;<span class="ident" id="8059461">Code</span><span class="op" id="8059465">:</span>&nbsp;<span class="builtintype" id="8059467">int</span><span class="op" id="8059470">(</span><span class="ident" id="8059471">b</span><span class="op" id="8059472">[</span><span class="num" id="8059473">1</span><span class="op" id="8059474">]</span><span class="op" id="8059475">)</span><span class="op" id="8059476">,</span>&nbsp;<span class="ident" id="8059478">Checksum</span><span class="op" id="8059486">:</span>&nbsp;<span class="builtintype" id="8059488">int</span><span class="op" id="8059491">(</span><span class="ident" id="8059492">b</span><span class="op" id="8059493">[</span><span class="num" id="8059494">2</span><span class="op" id="8059495">]</span><span class="op" id="8059496">)</span><span class="op" id="8059497">&lt;&lt;</span><span class="num" id="8059499">8</span>&nbsp;<span class="op" id="8059501">|</span>&nbsp;<span class="builtintype" id="8059503">int</span><span class="op" id="8059506">(</span><span class="ident" id="8059507">b</span><span class="op" id="8059508">[</span><span class="num" id="8059509">3</span><span class="op" id="8059510">]</span><span class="op" id="8059511">)</span><span class="op" id="8059512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059515">if</span>&nbsp;<span class="ident" id="8059518">msglen</span>&nbsp;<span class="op" id="8059525">&gt;</span>&nbsp;<span class="num" id="8059527">4</span>&nbsp;<span class="op" id="8059529">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059533">var</span>&nbsp;<span class="ident" id="8059537">err</span>&nbsp;<span class="builtintype" id="8059541">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059549">switch</span>&nbsp;<span class="ident" id="8059556">m</span><span class="op" id="8059557">.</span><span class="ident" id="8059558">Type</span>&nbsp;<span class="op" id="8059563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059567">case</span>&nbsp;<span class="ident" id="8059572">icmpv4EchoRequest</span><span class="op" id="8059589">,</span>&nbsp;<span class="ident" id="8059591">icmpv4EchoReply</span><span class="op" id="8059606">,</span>&nbsp;<span class="ident" id="8059608">icmpv6EchoRequest</span><span class="op" id="8059625">,</span>&nbsp;<span class="ident" id="8059627">icmpv6EchoReply</span><span class="op" id="8059642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059647">m</span><span class="op" id="8059648">.</span><span class="ident" id="8059649">Body</span><span class="op" id="8059653">,</span>&nbsp;<span class="ident" id="8059655">err</span>&nbsp;<span class="op" id="8059659">=</span>&nbsp;<span class="ident" id="8059661">parseICMPEcho</span><span class="op" id="8059674">(</span><span class="ident" id="8059675">b</span><span class="op" id="8059676">[</span><span class="num" id="8059677">4</span><span class="op" id="8059678">:</span><span class="op" id="8059679">]</span><span class="op" id="8059680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059685">if</span>&nbsp;<span class="ident" id="8059688">err</span>&nbsp;<span class="op" id="8059692">!=</span>&nbsp;<span class="ident" id="8059695">nil</span>&nbsp;<span class="op" id="8059699">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059705">return</span>&nbsp;<span class="ident" id="8059712">nil</span><span class="op" id="8059715">,</span>&nbsp;<span class="ident" id="8059717">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8059724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8059728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8059731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059734">return</span>&nbsp;<span class="ident" id="8059741">m</span><span class="op" id="8059742">,</span>&nbsp;<span class="ident" id="8059744">nil</span><br>
<span class="lineno">80</span><span class="op" id="8059748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8059751">//&nbsp;imcpEcho&nbsp;represenets&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8059819">type</span>&nbsp;<span class="ident" id="8059824">icmpEcho</span>&nbsp;<span class="keyword" id="8059833">struct</span>&nbsp;<span class="op" id="8059840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059843">ID</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8059848">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8059855">//&nbsp;identifier</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059870">Seq</span>&nbsp;&nbsp;<span class="builtintype" id="8059875">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8059882">//&nbsp;sequence&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8059902">Data</span>&nbsp;<span class="op" id="8059907">[</span><span class="op" id="8059908">]</span><span class="builtintype" id="8059909">byte</span>&nbsp;<span class="comment" id="8059914">//&nbsp;data</span><br>
<span class="lineno"></span><span class="op" id="8059922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8059925">func</span>&nbsp;<span class="op" id="8059930">(</span><span class="ident" id="8059931">p</span>&nbsp;<span class="op" id="8059933">*</span><span class="ident" id="8059934">icmpEcho</span><span class="op" id="8059942">)</span>&nbsp;<span class="ident" id="8059944">Len</span><span class="op" id="8059947">(</span><span class="op" id="8059948">)</span>&nbsp;<span class="builtintype" id="8059950">int</span>&nbsp;<span class="op" id="8059954">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059957">if</span>&nbsp;<span class="ident" id="8059960">p</span>&nbsp;<span class="op" id="8059962">==</span>&nbsp;<span class="ident" id="8059965">nil</span>&nbsp;<span class="op" id="8059969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059973">return</span>&nbsp;<span class="num" id="8059980">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8059983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8059986">return</span>&nbsp;<span class="num" id="8059993">4</span>&nbsp;<span class="op" id="8059995">+</span>&nbsp;<span class="builtinfunc" id="8059997">len</span><span class="op" id="8060000">(</span><span class="ident" id="8060001">p</span><span class="op" id="8060002">.</span><span class="ident" id="8060003">Data</span><span class="op" id="8060007">)</span><br>
<span class="lineno"></span><span class="op" id="8060009">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="8060012">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;binary&nbsp;enconding&nbsp;of&nbsp;the&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="8060080">//&nbsp;reply&nbsp;message&nbsp;body&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="8060105">func</span>&nbsp;<span class="op" id="8060110">(</span><span class="ident" id="8060111">p</span>&nbsp;<span class="op" id="8060113">*</span><span class="ident" id="8060114">icmpEcho</span><span class="op" id="8060122">)</span>&nbsp;<span class="ident" id="8060124">Marshal</span><span class="op" id="8060131">(</span><span class="op" id="8060132">)</span>&nbsp;<span class="op" id="8060134">(</span><span class="op" id="8060135">[</span><span class="op" id="8060136">]</span><span class="builtintype" id="8060137">byte</span><span class="op" id="8060141">,</span>&nbsp;<span class="builtintype" id="8060143">error</span><span class="op" id="8060148">)</span>&nbsp;<span class="op" id="8060150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8060153">b</span>&nbsp;<span class="op" id="8060155">:=</span>&nbsp;<span class="builtinfunc" id="8060158">make</span><span class="op" id="8060162">(</span><span class="op" id="8060163">[</span><span class="op" id="8060164">]</span><span class="builtintype" id="8060165">byte</span><span class="op" id="8060169">,</span>&nbsp;<span class="num" id="8060171">4</span><span class="op" id="8060172">+</span><span class="builtinfunc" id="8060173">len</span><span class="op" id="8060176">(</span><span class="ident" id="8060177">p</span><span class="op" id="8060178">.</span><span class="ident" id="8060179">Data</span><span class="op" id="8060183">)</span><span class="op" id="8060184">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8060187">b</span><span class="op" id="8060188">[</span><span class="num" id="8060189">0</span><span class="op" id="8060190">]</span><span class="op" id="8060191">,</span>&nbsp;<span class="ident" id="8060193">b</span><span class="op" id="8060194">[</span><span class="num" id="8060195">1</span><span class="op" id="8060196">]</span>&nbsp;<span class="op" id="8060198">=</span>&nbsp;<span class="builtintype" id="8060200">byte</span><span class="op" id="8060204">(</span><span class="ident" id="8060205">p</span><span class="op" id="8060206">.</span><span class="ident" id="8060207">ID</span><span class="op" id="8060209">&gt;&gt;</span><span class="num" id="8060211">8</span><span class="op" id="8060212">)</span><span class="op" id="8060213">,</span>&nbsp;<span class="builtintype" id="8060215">byte</span><span class="op" id="8060219">(</span><span class="ident" id="8060220">p</span><span class="op" id="8060221">.</span><span class="ident" id="8060222">ID</span><span class="op" id="8060224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8060227">b</span><span class="op" id="8060228">[</span><span class="num" id="8060229">2</span><span class="op" id="8060230">]</span><span class="op" id="8060231">,</span>&nbsp;<span class="ident" id="8060233">b</span><span class="op" id="8060234">[</span><span class="num" id="8060235">3</span><span class="op" id="8060236">]</span>&nbsp;<span class="op" id="8060238">=</span>&nbsp;<span class="builtintype" id="8060240">byte</span><span class="op" id="8060244">(</span><span class="ident" id="8060245">p</span><span class="op" id="8060246">.</span><span class="ident" id="8060247">Seq</span><span class="op" id="8060250">&gt;&gt;</span><span class="num" id="8060252">8</span><span class="op" id="8060253">)</span><span class="op" id="8060254">,</span>&nbsp;<span class="builtintype" id="8060256">byte</span><span class="op" id="8060260">(</span><span class="ident" id="8060261">p</span><span class="op" id="8060262">.</span><span class="ident" id="8060263">Seq</span><span class="op" id="8060266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8060269">copy</span><span class="op" id="8060273">(</span><span class="ident" id="8060274">b</span><span class="op" id="8060275">[</span><span class="num" id="8060276">4</span><span class="op" id="8060277">:</span><span class="op" id="8060278">]</span><span class="op" id="8060279">,</span>&nbsp;<span class="ident" id="8060281">p</span><span class="op" id="8060282">.</span><span class="ident" id="8060283">Data</span><span class="op" id="8060287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8060290">return</span>&nbsp;<span class="ident" id="8060297">b</span><span class="op" id="8060298">,</span>&nbsp;<span class="ident" id="8060300">nil</span><br>
<span class="lineno"></span><span class="op" id="8060304">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="8060307">//&nbsp;parseICMPEcho&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;ICMP&nbsp;echo&nbsp;request&nbsp;or&nbsp;reply&nbsp;message</span><br>
<span class="lineno"></span><span class="comment" id="8060374">//&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="8060383">func</span>&nbsp;<span class="ident" id="8060388">parseICMPEcho</span><span class="op" id="8060401">(</span><span class="ident" id="8060402">b</span>&nbsp;<span class="op" id="8060404">[</span><span class="op" id="8060405">]</span><span class="builtintype" id="8060406">byte</span><span class="op" id="8060410">)</span>&nbsp;<span class="op" id="8060412">(</span><span class="op" id="8060413">*</span><span class="ident" id="8060414">icmpEcho</span><span class="op" id="8060422">,</span>&nbsp;<span class="builtintype" id="8060424">error</span><span class="op" id="8060429">)</span>&nbsp;<span class="op" id="8060431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8060434">bodylen</span>&nbsp;<span class="op" id="8060442">:=</span>&nbsp;<span class="builtinfunc" id="8060445">len</span><span class="op" id="8060448">(</span><span class="ident" id="8060449">b</span><span class="op" id="8060450">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8060453">p</span>&nbsp;<span class="op" id="8060455">:=</span>&nbsp;<span class="op" id="8060458">&amp;</span><span class="ident" id="8060459">icmpEcho</span><span class="op" id="8060467">{</span><span class="ident" id="8060468">ID</span><span class="op" id="8060470">:</span>&nbsp;<span class="builtintype" id="8060472">int</span><span class="op" id="8060475">(</span><span class="ident" id="8060476">b</span><span class="op" id="8060477">[</span><span class="num" id="8060478">0</span><span class="op" id="8060479">]</span><span class="op" id="8060480">)</span><span class="op" id="8060481">&lt;&lt;</span><span class="num" id="8060483">8</span>&nbsp;<span class="op" id="8060485">|</span>&nbsp;<span class="builtintype" id="8060487">int</span><span class="op" id="8060490">(</span><span class="ident" id="8060491">b</span><span class="op" id="8060492">[</span><span class="num" id="8060493">1</span><span class="op" id="8060494">]</span><span class="op" id="8060495">)</span><span class="op" id="8060496">,</span>&nbsp;<span class="ident" id="8060498">Seq</span><span class="op" id="8060501">:</span>&nbsp;<span class="builtintype" id="8060503">int</span><span class="op" id="8060506">(</span><span class="ident" id="8060507">b</span><span class="op" id="8060508">[</span><span class="num" id="8060509">2</span><span class="op" id="8060510">]</span><span class="op" id="8060511">)</span><span class="op" id="8060512">&lt;&lt;</span><span class="num" id="8060514">8</span>&nbsp;<span class="op" id="8060516">|</span>&nbsp;<span class="builtintype" id="8060518">int</span><span class="op" id="8060521">(</span><span class="ident" id="8060522">b</span><span class="op" id="8060523">[</span><span class="num" id="8060524">3</span><span class="op" id="8060525">]</span><span class="op" id="8060526">)</span><span class="op" id="8060527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8060530">if</span>&nbsp;<span class="ident" id="8060533">bodylen</span>&nbsp;<span class="op" id="8060541">&gt;</span>&nbsp;<span class="num" id="8060543">4</span>&nbsp;<span class="op" id="8060545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8060549">p</span><span class="op" id="8060550">.</span><span class="ident" id="8060551">Data</span>&nbsp;<span class="op" id="8060556">=</span>&nbsp;<span class="builtinfunc" id="8060558">make</span><span class="op" id="8060562">(</span><span class="op" id="8060563">[</span><span class="op" id="8060564">]</span><span class="builtintype" id="8060565">byte</span><span class="op" id="8060569">,</span>&nbsp;<span class="ident" id="8060571">bodylen</span><span class="op" id="8060578">-</span><span class="num" id="8060579">4</span><span class="op" id="8060580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8060584">copy</span><span class="op" id="8060588">(</span><span class="ident" id="8060589">p</span><span class="op" id="8060590">.</span><span class="ident" id="8060591">Data</span><span class="op" id="8060595">,</span>&nbsp;<span class="ident" id="8060597">b</span><span class="op" id="8060598">[</span><span class="num" id="8060599">4</span><span class="op" id="8060600">:</span><span class="op" id="8060601">]</span><span class="op" id="8060602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8060605">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8060608">return</span>&nbsp;<span class="ident" id="8060615">p</span><span class="op" id="8060616">,</span>&nbsp;<span class="ident" id="8060618">nil</span><br>
<span class="lineno"></span><span class="op" id="8060622">}</span>
</div>
</body>
</html>
