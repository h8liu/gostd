<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6132050">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6132105">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6132159">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6132210">//&nbsp;Package&nbsp;fcgi&nbsp;implements&nbsp;the&nbsp;FastCGI&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="comment" id="6132259">//&nbsp;Currently&nbsp;only&nbsp;the&nbsp;responder&nbsp;role&nbsp;is&nbsp;supported.</span><br>
<span class="lineno"></span><span class="comment" id="6132310">//&nbsp;The&nbsp;protocol&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://www.fastcgi.com/drupal/node/6?q=node/22</span><br>
<span class="lineno"></span><span class="keyword" id="6132387">package</span>&nbsp;<span class="ident" id="6132395">fcgi</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="6132401">//&nbsp;This&nbsp;file&nbsp;defines&nbsp;the&nbsp;raw&nbsp;protocol&nbsp;and&nbsp;some&nbsp;utilities&nbsp;used&nbsp;by&nbsp;the&nbsp;child&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6132480">//&nbsp;the&nbsp;host.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6132494">import</span>&nbsp;<span class="op" id="6132501">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132504">&#34;bufio&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132513">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132522">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132541">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132551">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6132557">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="6132564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6132567">//&nbsp;recType&nbsp;is&nbsp;a&nbsp;record&nbsp;type,&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6132610">//&nbsp;http://www.fastcgi.com/devkit/doc/fcgi-spec.html#S8</span><br>
<span class="lineno"></span><span class="keyword" id="6132665">type</span>&nbsp;<span class="ident" id="6132670">recType</span>&nbsp;<span class="builtintype" id="6132678">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6132685">const</span>&nbsp;<span class="op" id="6132691">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132694">typeBeginRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132714"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132722">=</span>&nbsp;<span class="num" id="6132724">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132727">typeAbortRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132747"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132755">=</span>&nbsp;<span class="num" id="6132757">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132760">typeEndRequest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132780"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132788">=</span>&nbsp;<span class="num" id="6132790">3</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132793">typeParams</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132813"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132821">=</span>&nbsp;<span class="num" id="6132823">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132826">typeStdin</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132846"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132854">=</span>&nbsp;<span class="num" id="6132856">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132859">typeStdout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132879"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132887">=</span>&nbsp;<span class="num" id="6132889">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132892">typeStderr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132912"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132920">=</span>&nbsp;<span class="num" id="6132922">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132925">typeData</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132945"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132953">=</span>&nbsp;<span class="num" id="6132955">8</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132958">typeGetValues</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6132978"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6132986">=</span>&nbsp;<span class="num" id="6132988">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6132991">typeGetValuesResult</span>&nbsp;<span class="ident" id="6133011"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6133019">=</span>&nbsp;<span class="num" id="6133021">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133025">typeUnknownType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6133045"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span>&nbsp;<span class="op" id="6133053">=</span>&nbsp;<span class="num" id="6133055">11</span><br>
<span class="lineno"></span><span class="op" id="6133058">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="6133061">//&nbsp;keep&nbsp;the&nbsp;connection&nbsp;between&nbsp;web-server&nbsp;and&nbsp;responder&nbsp;open&nbsp;after&nbsp;request</span><br>
<span class="lineno"></span><span class="keyword" id="6133136">const</span>&nbsp;<span class="ident" id="6133142">flagKeepConn</span>&nbsp;<span class="op" id="6133155">=</span>&nbsp;<span class="num" id="6133157">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133160">const</span>&nbsp;<span class="op" id="6133166">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133169">maxWrite</span>&nbsp;<span class="op" id="6133178">=</span>&nbsp;<span class="num" id="6133180">65535</span>&nbsp;<span class="comment" id="6133186">//&nbsp;maximum&nbsp;record&nbsp;body</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133210">maxPad</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6133219">=</span>&nbsp;<span class="num" id="6133221">255</span><br>
<span class="lineno"></span><span class="op" id="6133225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133228">const</span>&nbsp;<span class="op" id="6133234">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133237">roleResponder</span>&nbsp;<span class="op" id="6133251">=</span>&nbsp;<span class="ident" id="6133253">iota</span>&nbsp;<span class="op" id="6133258">+</span>&nbsp;<span class="num" id="6133260">1</span>&nbsp;<span class="comment" id="6133262">//&nbsp;only&nbsp;Responders&nbsp;are&nbsp;implemented.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133299">roleAuthorizer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133315">roleFilter</span><br>
<span class="lineno"></span><span class="op" id="6133326">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133329">const</span>&nbsp;<span class="op" id="6133335">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133338">statusRequestComplete</span>&nbsp;<span class="op" id="6133360">=</span>&nbsp;<span class="ident" id="6133362">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133368">statusCantMultiplex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133389">statusOverloaded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133407">statusUnknownRole</span><br>
<span class="lineno"></span><span class="op" id="6133425">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="6133428">const</span>&nbsp;<span class="ident" id="6133434">headerLen</span>&nbsp;<span class="op" id="6133444">=</span>&nbsp;<span class="num" id="6133446">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133449">type</span>&nbsp;<span class="ident" id="6133454">header</span>&nbsp;<span class="keyword" id="6133461">struct</span>&nbsp;<span class="op" id="6133468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133471">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6133485">uint8</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133492">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6133506"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133515">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6133529">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133537">ContentLength</span>&nbsp;<span class="builtintype" id="6133551">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133559">PaddingLength</span>&nbsp;<span class="builtintype" id="6133573">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133580">Reserved</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6133594">uint8</span><br>
<span class="lineno">70</span><span class="op" id="6133600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133603">type</span>&nbsp;<span class="ident" id="6133608">beginRequest</span>&nbsp;<span class="keyword" id="6133621">struct</span>&nbsp;<span class="op" id="6133628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133631">role</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6133640">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133648">flags</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6133657">uint8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133664">reserved</span>&nbsp;<span class="op" id="6133673">[</span><span class="num" id="6133674">5</span><span class="op" id="6133675">]</span><span class="builtintype" id="6133676">uint8</span><br>
<span class="lineno"></span><span class="op" id="6133682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6133685">func</span>&nbsp;<span class="op" id="6133690">(</span><span class="ident" id="6133691">br</span>&nbsp;<span class="op" id="6133694">*</span><span class="ident" id="6133695"><a href="/net/http/fcgi/fcgi.go.html#6133608">beginRequest</a></span><span class="op" id="6133707">)</span>&nbsp;<span class="ident" id="6133709">read</span><span class="op" id="6133713">(</span><span class="ident" id="6133714">content</span>&nbsp;<span class="op" id="6133722">[</span><span class="op" id="6133723">]</span><span class="builtintype" id="6133724">byte</span><span class="op" id="6133728">)</span>&nbsp;<span class="builtintype" id="6133730">error</span>&nbsp;<span class="op" id="6133736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133739">if</span>&nbsp;<span class="builtinfunc" id="6133742">len</span><span class="op" id="6133745">(</span><span class="ident" id="6133746"><a href="/net/http/fcgi/fcgi.go.html#6133714">content</a></span><span class="op" id="6133753">)</span>&nbsp;<span class="op" id="6133755">!=</span>&nbsp;<span class="num" id="6133758">8</span>&nbsp;<span class="op" id="6133760">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133764">return</span>&nbsp;<span class="ident" id="6133771"><a href="/net/http/fcgi/fcgi.go.html#6132541">errors</a></span><span class="op" id="6133777">.</span><span class="ident" id="6133778">New</span><span class="op" id="6133781">(</span><span class="string" id="6133782">&#34;fcgi:&nbsp;invalid&nbsp;begin&nbsp;request&nbsp;record&#34;</span><span class="op" id="6133818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6133821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133824"><a href="/net/http/fcgi/fcgi.go.html#6133691">br</a></span><span class="op" id="6133826">.</span><span class="ident" id="6133827">role</span>&nbsp;<span class="op" id="6133832">=</span>&nbsp;<span class="ident" id="6133834"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6133840">.</span><span class="ident" id="6133841">BigEndian</span><span class="op" id="6133850">.</span><span class="ident" id="6133851">Uint16</span><span class="op" id="6133857">(</span><span class="ident" id="6133858"><a href="/net/http/fcgi/fcgi.go.html#6133714">content</a></span><span class="op" id="6133865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6133868"><a href="/net/http/fcgi/fcgi.go.html#6133691">br</a></span><span class="op" id="6133870">.</span><span class="ident" id="6133871">flags</span>&nbsp;<span class="op" id="6133877">=</span>&nbsp;<span class="ident" id="6133879"><a href="/net/http/fcgi/fcgi.go.html#6133714">content</a></span><span class="op" id="6133886">[</span><span class="num" id="6133887">2</span><span class="op" id="6133888">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6133891">return</span>&nbsp;<span class="ident" id="6133898">nil</span><br>
<span class="lineno">85</span><span class="op" id="6133902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6133905">//&nbsp;for&nbsp;padding&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;allocate&nbsp;all&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="6133962">//&nbsp;not&nbsp;synchronized&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;care&nbsp;what&nbsp;the&nbsp;contents&nbsp;are</span><br>
<span class="lineno"></span><span class="keyword" id="6134026">var</span>&nbsp;<span class="ident" id="6134030">pad</span>&nbsp;<span class="op" id="6134034">[</span><span class="ident" id="6134035"><a href="/net/http/fcgi/fcgi.go.html#6133210">maxPad</a></span><span class="op" id="6134041">]</span><span class="builtintype" id="6134042">byte</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6134048">func</span>&nbsp;<span class="op" id="6134053">(</span><span class="ident" id="6134054">h</span>&nbsp;<span class="op" id="6134056">*</span><span class="ident" id="6134057"><a href="/net/http/fcgi/fcgi.go.html#6133454">header</a></span><span class="op" id="6134063">)</span>&nbsp;<span class="ident" id="6134065">init</span><span class="op" id="6134069">(</span><span class="ident" id="6134070">recType</span>&nbsp;<span class="ident" id="6134078"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span><span class="op" id="6134085">,</span>&nbsp;<span class="ident" id="6134087">reqId</span>&nbsp;<span class="builtintype" id="6134093">uint16</span><span class="op" id="6134099">,</span>&nbsp;<span class="ident" id="6134101">contentLength</span>&nbsp;<span class="builtintype" id="6134115">int</span><span class="op" id="6134118">)</span>&nbsp;<span class="op" id="6134120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134123"><a href="/net/http/fcgi/fcgi.go.html#6134054">h</a></span><span class="op" id="6134124">.</span><span class="ident" id="6134125">Version</span>&nbsp;<span class="op" id="6134133">=</span>&nbsp;<span class="num" id="6134135">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134138"><a href="/net/http/fcgi/fcgi.go.html#6134054">h</a></span><span class="op" id="6134139">.</span><span class="ident" id="6134140">Type</span>&nbsp;<span class="op" id="6134145">=</span>&nbsp;<span class="ident" id="6134147"><a href="/net/http/fcgi/fcgi.go.html#6134070">recType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134156"><a href="/net/http/fcgi/fcgi.go.html#6134054">h</a></span><span class="op" id="6134157">.</span><span class="ident" id="6134158">Id</span>&nbsp;<span class="op" id="6134161">=</span>&nbsp;<span class="ident" id="6134163"><a href="/net/http/fcgi/fcgi.go.html#6134087">reqId</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134170"><a href="/net/http/fcgi/fcgi.go.html#6134054">h</a></span><span class="op" id="6134171">.</span><span class="ident" id="6134172">ContentLength</span>&nbsp;<span class="op" id="6134186">=</span>&nbsp;<span class="builtintype" id="6134188">uint16</span><span class="op" id="6134194">(</span><span class="ident" id="6134195"><a href="/net/http/fcgi/fcgi.go.html#6134101">contentLength</a></span><span class="op" id="6134208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134211"><a href="/net/http/fcgi/fcgi.go.html#6134054">h</a></span><span class="op" id="6134212">.</span><span class="ident" id="6134213">PaddingLength</span>&nbsp;<span class="op" id="6134227">=</span>&nbsp;<span class="builtintype" id="6134229">uint8</span><span class="op" id="6134234">(</span><span class="op" id="6134235">-</span><span class="ident" id="6134236"><a href="/net/http/fcgi/fcgi.go.html#6134101">contentLength</a></span>&nbsp;<span class="op" id="6134250">&amp;</span>&nbsp;<span class="num" id="6134252">7</span><span class="op" id="6134253">)</span><br>
<span class="lineno"></span><span class="op" id="6134255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6134258">//&nbsp;conn&nbsp;sends&nbsp;records&nbsp;over&nbsp;rwc</span><br>
<span class="lineno">100</span><span class="keyword" id="6134289">type</span>&nbsp;<span class="ident" id="6134294">conn</span>&nbsp;<span class="keyword" id="6134299">struct</span>&nbsp;<span class="op" id="6134306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134309">mutex</span>&nbsp;<span class="ident" id="6134315"><a href="/net/http/fcgi/fcgi.go.html#6132557">sync</a></span><span class="op" id="6134319">.</span><span class="ident" id="6134320">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134327">rwc</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6134333"><a href="/net/http/fcgi/fcgi.go.html#6132551">io</a></span><span class="op" id="6134335">.</span><span class="ident" id="6134336">ReadWriteCloser</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6134354">//&nbsp;to&nbsp;avoid&nbsp;allocations</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134379">buf</span>&nbsp;<span class="ident" id="6134383"><a href="/net/http/fcgi/fcgi.go.html#6132513">bytes</a></span><span class="op" id="6134388">.</span><span class="ident" id="6134389">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134397">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6134401"><a href="/net/http/fcgi/fcgi.go.html#6133454">header</a></span><br>
<span class="lineno"></span><span class="op" id="6134408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6134411">func</span>&nbsp;<span class="ident" id="6134416">newConn</span><span class="op" id="6134423">(</span><span class="ident" id="6134424">rwc</span>&nbsp;<span class="ident" id="6134428"><a href="/net/http/fcgi/fcgi.go.html#6132551">io</a></span><span class="op" id="6134430">.</span><span class="ident" id="6134431">ReadWriteCloser</span><span class="op" id="6134446">)</span>&nbsp;<span class="op" id="6134448">*</span><span class="ident" id="6134449"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span>&nbsp;<span class="op" id="6134454">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134457">return</span>&nbsp;<span class="op" id="6134464">&amp;</span><span class="ident" id="6134465"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6134469">{</span><span class="ident" id="6134470">rwc</span><span class="op" id="6134473">:</span>&nbsp;<span class="ident" id="6134475"><a href="/net/http/fcgi/fcgi.go.html#6134424">rwc</a></span><span class="op" id="6134478">}</span><br>
<span class="lineno"></span><span class="op" id="6134480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6134483">func</span>&nbsp;<span class="op" id="6134488">(</span><span class="ident" id="6134489">c</span>&nbsp;<span class="op" id="6134491">*</span><span class="ident" id="6134492"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6134496">)</span>&nbsp;<span class="ident" id="6134498">Close</span><span class="op" id="6134503">(</span><span class="op" id="6134504">)</span>&nbsp;<span class="builtintype" id="6134506">error</span>&nbsp;<span class="op" id="6134512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134515"><a href="/net/http/fcgi/fcgi.go.html#6134489">c</a></span><span class="op" id="6134516">.</span><span class="ident" id="6134517">mutex</span><span class="op" id="6134522">.</span><span class="ident" id="6134523">Lock</span><span class="op" id="6134527">(</span><span class="op" id="6134528">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134531">defer</span>&nbsp;<span class="ident" id="6134537"><a href="/net/http/fcgi/fcgi.go.html#6134489">c</a></span><span class="op" id="6134538">.</span><span class="ident" id="6134539">mutex</span><span class="op" id="6134544">.</span><span class="ident" id="6134545">Unlock</span><span class="op" id="6134551">(</span><span class="op" id="6134552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134555">return</span>&nbsp;<span class="ident" id="6134562"><a href="/net/http/fcgi/fcgi.go.html#6134489">c</a></span><span class="op" id="6134563">.</span><span class="ident" id="6134564">rwc</span><span class="op" id="6134567">.</span><span class="ident" id="6134568">Close</span><span class="op" id="6134573">(</span><span class="op" id="6134574">)</span><br>
<span class="lineno"></span><span class="op" id="6134576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6134579">type</span>&nbsp;<span class="ident" id="6134584">record</span>&nbsp;<span class="keyword" id="6134591">struct</span>&nbsp;<span class="op" id="6134598">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134601">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6134605"><a href="/net/http/fcgi/fcgi.go.html#6133454">header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134613">buf</span>&nbsp;<span class="op" id="6134617">[</span><span class="ident" id="6134618"><a href="/net/http/fcgi/fcgi.go.html#6133169">maxWrite</a></span>&nbsp;<span class="op" id="6134627">+</span>&nbsp;<span class="ident" id="6134629"><a href="/net/http/fcgi/fcgi.go.html#6133210">maxPad</a></span><span class="op" id="6134635">]</span><span class="builtintype" id="6134636">byte</span><br>
<span class="lineno"></span><span class="op" id="6134641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6134644">func</span>&nbsp;<span class="op" id="6134649">(</span><span class="ident" id="6134650">rec</span>&nbsp;<span class="op" id="6134654">*</span><span class="ident" id="6134655"><a href="/net/http/fcgi/fcgi.go.html#6134584">record</a></span><span class="op" id="6134661">)</span>&nbsp;<span class="ident" id="6134663">read</span><span class="op" id="6134667">(</span><span class="ident" id="6134668">r</span>&nbsp;<span class="ident" id="6134670"><a href="/net/http/fcgi/fcgi.go.html#6132551">io</a></span><span class="op" id="6134672">.</span><span class="ident" id="6134673">Reader</span><span class="op" id="6134679">)</span>&nbsp;<span class="op" id="6134681">(</span><span class="ident" id="6134682">err</span>&nbsp;<span class="builtintype" id="6134686">error</span><span class="op" id="6134691">)</span>&nbsp;<span class="op" id="6134693">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134696">if</span>&nbsp;<span class="ident" id="6134699"><a href="/net/http/fcgi/fcgi.go.html#6134682">err</a></span>&nbsp;<span class="op" id="6134703">=</span>&nbsp;<span class="ident" id="6134705"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6134711">.</span><span class="ident" id="6134712">Read</span><span class="op" id="6134716">(</span><span class="ident" id="6134717"><a href="/net/http/fcgi/fcgi.go.html#6134668">r</a></span><span class="op" id="6134718">,</span>&nbsp;<span class="ident" id="6134720"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6134726">.</span><span class="ident" id="6134727">BigEndian</span><span class="op" id="6134736">,</span>&nbsp;<span class="op" id="6134738">&amp;</span><span class="ident" id="6134739"><a href="/net/http/fcgi/fcgi.go.html#6134650">rec</a></span><span class="op" id="6134742">.</span><span class="ident" id="6134743">h</span><span class="op" id="6134744">)</span><span class="op" id="6134745">;</span>&nbsp;<span class="ident" id="6134747"><a href="/net/http/fcgi/fcgi.go.html#6134682">err</a></span>&nbsp;<span class="op" id="6134751">!=</span>&nbsp;<span class="ident" id="6134754">nil</span>&nbsp;<span class="op" id="6134758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134762">return</span>&nbsp;<span class="ident" id="6134769"><a href="/net/http/fcgi/fcgi.go.html#6134682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6134774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134777">if</span>&nbsp;<span class="ident" id="6134780"><a href="/net/http/fcgi/fcgi.go.html#6134650">rec</a></span><span class="op" id="6134783">.</span><span class="ident" id="6134784">h</span><span class="op" id="6134785">.</span><span class="ident" id="6134786">Version</span>&nbsp;<span class="op" id="6134794">!=</span>&nbsp;<span class="num" id="6134797">1</span>&nbsp;<span class="op" id="6134799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134803">return</span>&nbsp;<span class="ident" id="6134810"><a href="/net/http/fcgi/fcgi.go.html#6132541">errors</a></span><span class="op" id="6134816">.</span><span class="ident" id="6134817">New</span><span class="op" id="6134820">(</span><span class="string" id="6134821">&#34;fcgi:&nbsp;invalid&nbsp;header&nbsp;version&#34;</span><span class="op" id="6134851">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6134854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6134857">n</span>&nbsp;<span class="op" id="6134859">:=</span>&nbsp;<span class="builtintype" id="6134862">int</span><span class="op" id="6134865">(</span><span class="ident" id="6134866"><a href="/net/http/fcgi/fcgi.go.html#6134650">rec</a></span><span class="op" id="6134869">.</span><span class="ident" id="6134870">h</span><span class="op" id="6134871">.</span><span class="ident" id="6134872">ContentLength</span><span class="op" id="6134885">)</span>&nbsp;<span class="op" id="6134887">+</span>&nbsp;<span class="builtintype" id="6134889">int</span><span class="op" id="6134892">(</span><span class="ident" id="6134893"><a href="/net/http/fcgi/fcgi.go.html#6134650">rec</a></span><span class="op" id="6134896">.</span><span class="ident" id="6134897">h</span><span class="op" id="6134898">.</span><span class="ident" id="6134899">PaddingLength</span><span class="op" id="6134912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134915">if</span>&nbsp;<span class="ident" id="6134918">_</span><span class="op" id="6134919">,</span>&nbsp;<span class="ident" id="6134921"><a href="/net/http/fcgi/fcgi.go.html#6134682">err</a></span>&nbsp;<span class="op" id="6134925">=</span>&nbsp;<span class="ident" id="6134927"><a href="/net/http/fcgi/fcgi.go.html#6132551">io</a></span><span class="op" id="6134929">.</span><span class="ident" id="6134930">ReadFull</span><span class="op" id="6134938">(</span><span class="ident" id="6134939"><a href="/net/http/fcgi/fcgi.go.html#6134668">r</a></span><span class="op" id="6134940">,</span>&nbsp;<span class="ident" id="6134942"><a href="/net/http/fcgi/fcgi.go.html#6134650">rec</a></span><span class="op" id="6134945">.</span><span class="ident" id="6134946">buf</span><span class="op" id="6134949">[</span><span class="op" id="6134950">:</span><span class="ident" id="6134951"><a href="/net/http/fcgi/fcgi.go.html#6134857">n</a></span><span class="op" id="6134952">]</span><span class="op" id="6134953">)</span><span class="op" id="6134954">;</span>&nbsp;<span class="ident" id="6134956"><a href="/net/http/fcgi/fcgi.go.html#6134682">err</a></span>&nbsp;<span class="op" id="6134960">!=</span>&nbsp;<span class="ident" id="6134963">nil</span>&nbsp;<span class="op" id="6134967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134971">return</span>&nbsp;<span class="ident" id="6134978"><a href="/net/http/fcgi/fcgi.go.html#6134682">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6134983">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6134986">return</span>&nbsp;<span class="ident" id="6134993">nil</span><br>
<span class="lineno"></span><span class="op" id="6134997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6135000">func</span>&nbsp;<span class="op" id="6135005">(</span><span class="ident" id="6135006">r</span>&nbsp;<span class="op" id="6135008">*</span><span class="ident" id="6135009"><a href="/net/http/fcgi/fcgi.go.html#6134584">record</a></span><span class="op" id="6135015">)</span>&nbsp;<span class="ident" id="6135017">content</span><span class="op" id="6135024">(</span><span class="op" id="6135025">)</span>&nbsp;<span class="op" id="6135027">[</span><span class="op" id="6135028">]</span><span class="builtintype" id="6135029">byte</span>&nbsp;<span class="op" id="6135034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135037">return</span>&nbsp;<span class="ident" id="6135044"><a href="/net/http/fcgi/fcgi.go.html#6135006">r</a></span><span class="op" id="6135045">.</span><span class="ident" id="6135046">buf</span><span class="op" id="6135049">[</span><span class="op" id="6135050">:</span><span class="ident" id="6135051"><a href="/net/http/fcgi/fcgi.go.html#6135006">r</a></span><span class="op" id="6135052">.</span><span class="ident" id="6135053">h</span><span class="op" id="6135054">.</span><span class="ident" id="6135055">ContentLength</span><span class="op" id="6135068">]</span><br>
<span class="lineno">140</span><span class="op" id="6135070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6135073">//&nbsp;writeRecord&nbsp;writes&nbsp;and&nbsp;sends&nbsp;a&nbsp;single&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="6135122">func</span>&nbsp;<span class="op" id="6135127">(</span><span class="ident" id="6135128">c</span>&nbsp;<span class="op" id="6135130">*</span><span class="ident" id="6135131"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6135135">)</span>&nbsp;<span class="ident" id="6135137">writeRecord</span><span class="op" id="6135148">(</span><span class="ident" id="6135149">recType</span>&nbsp;<span class="ident" id="6135157"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span><span class="op" id="6135164">,</span>&nbsp;<span class="ident" id="6135166">reqId</span>&nbsp;<span class="builtintype" id="6135172">uint16</span><span class="op" id="6135178">,</span>&nbsp;<span class="ident" id="6135180">b</span>&nbsp;<span class="op" id="6135182">[</span><span class="op" id="6135183">]</span><span class="builtintype" id="6135184">byte</span><span class="op" id="6135188">)</span>&nbsp;<span class="builtintype" id="6135190">error</span>&nbsp;<span class="op" id="6135196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135199"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135200">.</span><span class="ident" id="6135201">mutex</span><span class="op" id="6135206">.</span><span class="ident" id="6135207">Lock</span><span class="op" id="6135211">(</span><span class="op" id="6135212">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135215">defer</span>&nbsp;<span class="ident" id="6135221"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135222">.</span><span class="ident" id="6135223">mutex</span><span class="op" id="6135228">.</span><span class="ident" id="6135229">Unlock</span><span class="op" id="6135235">(</span><span class="op" id="6135236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135239"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135240">.</span><span class="ident" id="6135241">buf</span><span class="op" id="6135244">.</span><span class="ident" id="6135245">Reset</span><span class="op" id="6135250">(</span><span class="op" id="6135251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135254"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135255">.</span><span class="ident" id="6135256">h</span><span class="op" id="6135257">.</span><span class="ident" id="6135258">init</span><span class="op" id="6135262">(</span><span class="ident" id="6135263"><a href="/net/http/fcgi/fcgi.go.html#6135149">recType</a></span><span class="op" id="6135270">,</span>&nbsp;<span class="ident" id="6135272"><a href="/net/http/fcgi/fcgi.go.html#6135166">reqId</a></span><span class="op" id="6135277">,</span>&nbsp;<span class="builtinfunc" id="6135279">len</span><span class="op" id="6135282">(</span><span class="ident" id="6135283"><a href="/net/http/fcgi/fcgi.go.html#6135180">b</a></span><span class="op" id="6135284">)</span><span class="op" id="6135285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135288">if</span>&nbsp;<span class="ident" id="6135291">err</span>&nbsp;<span class="op" id="6135295">:=</span>&nbsp;<span class="ident" id="6135298"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6135304">.</span><span class="ident" id="6135305">Write</span><span class="op" id="6135310">(</span><span class="op" id="6135311">&amp;</span><span class="ident" id="6135312"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135313">.</span><span class="ident" id="6135314">buf</span><span class="op" id="6135317">,</span>&nbsp;<span class="ident" id="6135319"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6135325">.</span><span class="ident" id="6135326">BigEndian</span><span class="op" id="6135335">,</span>&nbsp;<span class="ident" id="6135337"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135338">.</span><span class="ident" id="6135339">h</span><span class="op" id="6135340">)</span><span class="op" id="6135341">;</span>&nbsp;<span class="ident" id="6135343"><a href="/net/http/fcgi/fcgi.go.html#6135291">err</a></span>&nbsp;<span class="op" id="6135347">!=</span>&nbsp;<span class="ident" id="6135350">nil</span>&nbsp;<span class="op" id="6135354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135358">return</span>&nbsp;<span class="ident" id="6135365"><a href="/net/http/fcgi/fcgi.go.html#6135291">err</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6135370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135373">if</span>&nbsp;<span class="ident" id="6135376">_</span><span class="op" id="6135377">,</span>&nbsp;<span class="ident" id="6135379">err</span>&nbsp;<span class="op" id="6135383">:=</span>&nbsp;<span class="ident" id="6135386"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135387">.</span><span class="ident" id="6135388">buf</span><span class="op" id="6135391">.</span><span class="ident" id="6135392">Write</span><span class="op" id="6135397">(</span><span class="ident" id="6135398"><a href="/net/http/fcgi/fcgi.go.html#6135180">b</a></span><span class="op" id="6135399">)</span><span class="op" id="6135400">;</span>&nbsp;<span class="ident" id="6135402"><a href="/net/http/fcgi/fcgi.go.html#6135379">err</a></span>&nbsp;<span class="op" id="6135406">!=</span>&nbsp;<span class="ident" id="6135409">nil</span>&nbsp;<span class="op" id="6135413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135417">return</span>&nbsp;<span class="ident" id="6135424"><a href="/net/http/fcgi/fcgi.go.html#6135379">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6135429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135432">if</span>&nbsp;<span class="ident" id="6135435">_</span><span class="op" id="6135436">,</span>&nbsp;<span class="ident" id="6135438">err</span>&nbsp;<span class="op" id="6135442">:=</span>&nbsp;<span class="ident" id="6135445"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135446">.</span><span class="ident" id="6135447">buf</span><span class="op" id="6135450">.</span><span class="ident" id="6135451">Write</span><span class="op" id="6135456">(</span><span class="ident" id="6135457"><a href="/net/http/fcgi/fcgi.go.html#6134030">pad</a></span><span class="op" id="6135460">[</span><span class="op" id="6135461">:</span><span class="ident" id="6135462"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135463">.</span><span class="ident" id="6135464">h</span><span class="op" id="6135465">.</span><span class="ident" id="6135466">PaddingLength</span><span class="op" id="6135479">]</span><span class="op" id="6135480">)</span><span class="op" id="6135481">;</span>&nbsp;<span class="ident" id="6135483"><a href="/net/http/fcgi/fcgi.go.html#6135438">err</a></span>&nbsp;<span class="op" id="6135487">!=</span>&nbsp;<span class="ident" id="6135490">nil</span>&nbsp;<span class="op" id="6135494">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135498">return</span>&nbsp;<span class="ident" id="6135505"><a href="/net/http/fcgi/fcgi.go.html#6135438">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6135510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135513">_</span><span class="op" id="6135514">,</span>&nbsp;<span class="ident" id="6135516">err</span>&nbsp;<span class="op" id="6135520">:=</span>&nbsp;<span class="ident" id="6135523"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135524">.</span><span class="ident" id="6135525">rwc</span><span class="op" id="6135528">.</span><span class="ident" id="6135529">Write</span><span class="op" id="6135534">(</span><span class="ident" id="6135535"><a href="/net/http/fcgi/fcgi.go.html#6135128">c</a></span><span class="op" id="6135536">.</span><span class="ident" id="6135537">buf</span><span class="op" id="6135540">.</span><span class="ident" id="6135541">Bytes</span><span class="op" id="6135546">(</span><span class="op" id="6135547">)</span><span class="op" id="6135548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135551">return</span>&nbsp;<span class="ident" id="6135558"><a href="/net/http/fcgi/fcgi.go.html#6135516">err</a></span><br>
<span class="lineno"></span><span class="op" id="6135562">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="6135565">func</span>&nbsp;<span class="op" id="6135570">(</span><span class="ident" id="6135571">c</span>&nbsp;<span class="op" id="6135573">*</span><span class="ident" id="6135574"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6135578">)</span>&nbsp;<span class="ident" id="6135580">writeBeginRequest</span><span class="op" id="6135597">(</span><span class="ident" id="6135598">reqId</span>&nbsp;<span class="builtintype" id="6135604">uint16</span><span class="op" id="6135610">,</span>&nbsp;<span class="ident" id="6135612">role</span>&nbsp;<span class="builtintype" id="6135617">uint16</span><span class="op" id="6135623">,</span>&nbsp;<span class="ident" id="6135625">flags</span>&nbsp;<span class="builtintype" id="6135631">uint8</span><span class="op" id="6135636">)</span>&nbsp;<span class="builtintype" id="6135638">error</span>&nbsp;<span class="op" id="6135644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135647">b</span>&nbsp;<span class="op" id="6135649">:=</span>&nbsp;<span class="op" id="6135652">[</span><span class="num" id="6135653">8</span><span class="op" id="6135654">]</span><span class="builtintype" id="6135655">byte</span><span class="op" id="6135659">{</span><span class="builtintype" id="6135660">byte</span><span class="op" id="6135664">(</span><span class="ident" id="6135665"><a href="/net/http/fcgi/fcgi.go.html#6135612">role</a></span>&nbsp;<span class="op" id="6135670">&gt;&gt;</span>&nbsp;<span class="num" id="6135673">8</span><span class="op" id="6135674">)</span><span class="op" id="6135675">,</span>&nbsp;<span class="builtintype" id="6135677">byte</span><span class="op" id="6135681">(</span><span class="ident" id="6135682"><a href="/net/http/fcgi/fcgi.go.html#6135612">role</a></span><span class="op" id="6135686">)</span><span class="op" id="6135687">,</span>&nbsp;<span class="ident" id="6135689"><a href="/net/http/fcgi/fcgi.go.html#6135625">flags</a></span><span class="op" id="6135694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135697">return</span>&nbsp;<span class="ident" id="6135704"><a href="/net/http/fcgi/fcgi.go.html#6135571">c</a></span><span class="op" id="6135705">.</span><span class="ident" id="6135706">writeRecord</span><span class="op" id="6135717">(</span><span class="ident" id="6135718"><a href="/net/http/fcgi/fcgi.go.html#6132694">typeBeginRequest</a></span><span class="op" id="6135734">,</span>&nbsp;<span class="ident" id="6135736"><a href="/net/http/fcgi/fcgi.go.html#6135598">reqId</a></span><span class="op" id="6135741">,</span>&nbsp;<span class="ident" id="6135743"><a href="/net/http/fcgi/fcgi.go.html#6135647">b</a></span><span class="op" id="6135744">[</span><span class="op" id="6135745">:</span><span class="op" id="6135746">]</span><span class="op" id="6135747">)</span><br>
<span class="lineno"></span><span class="op" id="6135749">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6135752">func</span>&nbsp;<span class="op" id="6135757">(</span><span class="ident" id="6135758">c</span>&nbsp;<span class="op" id="6135760">*</span><span class="ident" id="6135761"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6135765">)</span>&nbsp;<span class="ident" id="6135767">writeEndRequest</span><span class="op" id="6135782">(</span><span class="ident" id="6135783">reqId</span>&nbsp;<span class="builtintype" id="6135789">uint16</span><span class="op" id="6135795">,</span>&nbsp;<span class="ident" id="6135797">appStatus</span>&nbsp;<span class="builtintype" id="6135807">int</span><span class="op" id="6135810">,</span>&nbsp;<span class="ident" id="6135812">protocolStatus</span>&nbsp;<span class="builtintype" id="6135827">uint8</span><span class="op" id="6135832">)</span>&nbsp;<span class="builtintype" id="6135834">error</span>&nbsp;<span class="op" id="6135840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135843">b</span>&nbsp;<span class="op" id="6135845">:=</span>&nbsp;<span class="builtinfunc" id="6135848">make</span><span class="op" id="6135852">(</span><span class="op" id="6135853">[</span><span class="op" id="6135854">]</span><span class="builtintype" id="6135855">byte</span><span class="op" id="6135859">,</span>&nbsp;<span class="num" id="6135861">8</span><span class="op" id="6135862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135865"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6135871">.</span><span class="ident" id="6135872">BigEndian</span><span class="op" id="6135881">.</span><span class="ident" id="6135882">PutUint32</span><span class="op" id="6135891">(</span><span class="ident" id="6135892"><a href="/net/http/fcgi/fcgi.go.html#6135843">b</a></span><span class="op" id="6135893">,</span>&nbsp;<span class="builtintype" id="6135895">uint32</span><span class="op" id="6135901">(</span><span class="ident" id="6135902"><a href="/net/http/fcgi/fcgi.go.html#6135797">appStatus</a></span><span class="op" id="6135911">)</span><span class="op" id="6135912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6135915"><a href="/net/http/fcgi/fcgi.go.html#6135843">b</a></span><span class="op" id="6135916">[</span><span class="num" id="6135917">4</span><span class="op" id="6135918">]</span>&nbsp;<span class="op" id="6135920">=</span>&nbsp;<span class="ident" id="6135922"><a href="/net/http/fcgi/fcgi.go.html#6135812">protocolStatus</a></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6135938">return</span>&nbsp;<span class="ident" id="6135945"><a href="/net/http/fcgi/fcgi.go.html#6135758">c</a></span><span class="op" id="6135946">.</span><span class="ident" id="6135947">writeRecord</span><span class="op" id="6135958">(</span><span class="ident" id="6135959"><a href="/net/http/fcgi/fcgi.go.html#6132760">typeEndRequest</a></span><span class="op" id="6135973">,</span>&nbsp;<span class="ident" id="6135975"><a href="/net/http/fcgi/fcgi.go.html#6135783">reqId</a></span><span class="op" id="6135980">,</span>&nbsp;<span class="ident" id="6135982"><a href="/net/http/fcgi/fcgi.go.html#6135843">b</a></span><span class="op" id="6135983">)</span><br>
<span class="lineno"></span><span class="op" id="6135985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6135988">func</span>&nbsp;<span class="op" id="6135993">(</span><span class="ident" id="6135994">c</span>&nbsp;<span class="op" id="6135996">*</span><span class="ident" id="6135997"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6136001">)</span>&nbsp;<span class="ident" id="6136003">writePairs</span><span class="op" id="6136013">(</span><span class="ident" id="6136014">recType</span>&nbsp;<span class="ident" id="6136022"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span><span class="op" id="6136029">,</span>&nbsp;<span class="ident" id="6136031">reqId</span>&nbsp;<span class="builtintype" id="6136037">uint16</span><span class="op" id="6136043">,</span>&nbsp;<span class="ident" id="6136045">pairs</span>&nbsp;<span class="keyword" id="6136051">map</span><span class="op" id="6136054">[</span><span class="builtintype" id="6136055">string</span><span class="op" id="6136061">]</span><span class="builtintype" id="6136062">string</span><span class="op" id="6136068">)</span>&nbsp;<span class="builtintype" id="6136070">error</span>&nbsp;<span class="op" id="6136076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136079">w</span>&nbsp;<span class="op" id="6136081">:=</span>&nbsp;<span class="ident" id="6136084"><a href="/net/http/fcgi/fcgi.go.html#6137289">newWriter</a></span><span class="op" id="6136093">(</span><span class="ident" id="6136094"><a href="/net/http/fcgi/fcgi.go.html#6135994">c</a></span><span class="op" id="6136095">,</span>&nbsp;<span class="ident" id="6136097"><a href="/net/http/fcgi/fcgi.go.html#6136014">recType</a></span><span class="op" id="6136104">,</span>&nbsp;<span class="ident" id="6136106"><a href="/net/http/fcgi/fcgi.go.html#6136031">reqId</a></span><span class="op" id="6136111">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136114">b</span>&nbsp;<span class="op" id="6136116">:=</span>&nbsp;<span class="builtinfunc" id="6136119">make</span><span class="op" id="6136123">(</span><span class="op" id="6136124">[</span><span class="op" id="6136125">]</span><span class="builtintype" id="6136126">byte</span><span class="op" id="6136130">,</span>&nbsp;<span class="num" id="6136132">8</span><span class="op" id="6136133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136136">for</span>&nbsp;<span class="ident" id="6136140">k</span><span class="op" id="6136141">,</span>&nbsp;<span class="ident" id="6136143">v</span>&nbsp;<span class="op" id="6136145">:=</span>&nbsp;<span class="keyword" id="6136148">range</span>&nbsp;<span class="ident" id="6136154"><a href="/net/http/fcgi/fcgi.go.html#6136045">pairs</a></span>&nbsp;<span class="op" id="6136160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136164">n</span>&nbsp;<span class="op" id="6136166">:=</span>&nbsp;<span class="ident" id="6136169"><a href="/net/http/fcgi/fcgi.go.html#6136831">encodeSize</a></span><span class="op" id="6136179">(</span><span class="ident" id="6136180"><a href="/net/http/fcgi/fcgi.go.html#6136114">b</a></span><span class="op" id="6136181">,</span>&nbsp;<span class="builtintype" id="6136183">uint32</span><span class="op" id="6136189">(</span><span class="builtinfunc" id="6136190">len</span><span class="op" id="6136193">(</span><span class="ident" id="6136194"><a href="/net/http/fcgi/fcgi.go.html#6136140">k</a></span><span class="op" id="6136195">)</span><span class="op" id="6136196">)</span><span class="op" id="6136197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136201"><a href="/net/http/fcgi/fcgi.go.html#6136164">n</a></span>&nbsp;<span class="op" id="6136203">+=</span>&nbsp;<span class="ident" id="6136206"><a href="/net/http/fcgi/fcgi.go.html#6136831">encodeSize</a></span><span class="op" id="6136216">(</span><span class="ident" id="6136217"><a href="/net/http/fcgi/fcgi.go.html#6136114">b</a></span><span class="op" id="6136218">[</span><span class="ident" id="6136219"><a href="/net/http/fcgi/fcgi.go.html#6136164">n</a></span><span class="op" id="6136220">:</span><span class="op" id="6136221">]</span><span class="op" id="6136222">,</span>&nbsp;<span class="builtintype" id="6136224">uint32</span><span class="op" id="6136230">(</span><span class="builtinfunc" id="6136231">len</span><span class="op" id="6136234">(</span><span class="ident" id="6136235"><a href="/net/http/fcgi/fcgi.go.html#6136143">v</a></span><span class="op" id="6136236">)</span><span class="op" id="6136237">)</span><span class="op" id="6136238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136242">if</span>&nbsp;<span class="ident" id="6136245">_</span><span class="op" id="6136246">,</span>&nbsp;<span class="ident" id="6136248">err</span>&nbsp;<span class="op" id="6136252">:=</span>&nbsp;<span class="ident" id="6136255"><a href="/net/http/fcgi/fcgi.go.html#6136079">w</a></span><span class="op" id="6136256">.</span><span class="ident" id="6136257">Write</span><span class="op" id="6136262">(</span><span class="ident" id="6136263"><a href="/net/http/fcgi/fcgi.go.html#6136114">b</a></span><span class="op" id="6136264">[</span><span class="op" id="6136265">:</span><span class="ident" id="6136266"><a href="/net/http/fcgi/fcgi.go.html#6136164">n</a></span><span class="op" id="6136267">]</span><span class="op" id="6136268">)</span><span class="op" id="6136269">;</span>&nbsp;<span class="ident" id="6136271"><a href="/net/http/fcgi/fcgi.go.html#6136248">err</a></span>&nbsp;<span class="op" id="6136275">!=</span>&nbsp;<span class="ident" id="6136278">nil</span>&nbsp;<span class="op" id="6136282">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136287">return</span>&nbsp;<span class="ident" id="6136294"><a href="/net/http/fcgi/fcgi.go.html#6136248">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136304">if</span>&nbsp;<span class="ident" id="6136307">_</span><span class="op" id="6136308">,</span>&nbsp;<span class="ident" id="6136310">err</span>&nbsp;<span class="op" id="6136314">:=</span>&nbsp;<span class="ident" id="6136317"><a href="/net/http/fcgi/fcgi.go.html#6136079">w</a></span><span class="op" id="6136318">.</span><span class="ident" id="6136319">WriteString</span><span class="op" id="6136330">(</span><span class="ident" id="6136331"><a href="/net/http/fcgi/fcgi.go.html#6136140">k</a></span><span class="op" id="6136332">)</span><span class="op" id="6136333">;</span>&nbsp;<span class="ident" id="6136335"><a href="/net/http/fcgi/fcgi.go.html#6136310">err</a></span>&nbsp;<span class="op" id="6136339">!=</span>&nbsp;<span class="ident" id="6136342">nil</span>&nbsp;<span class="op" id="6136346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136351">return</span>&nbsp;<span class="ident" id="6136358"><a href="/net/http/fcgi/fcgi.go.html#6136310">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136364">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136368">if</span>&nbsp;<span class="ident" id="6136371">_</span><span class="op" id="6136372">,</span>&nbsp;<span class="ident" id="6136374">err</span>&nbsp;<span class="op" id="6136378">:=</span>&nbsp;<span class="ident" id="6136381"><a href="/net/http/fcgi/fcgi.go.html#6136079">w</a></span><span class="op" id="6136382">.</span><span class="ident" id="6136383">WriteString</span><span class="op" id="6136394">(</span><span class="ident" id="6136395"><a href="/net/http/fcgi/fcgi.go.html#6136143">v</a></span><span class="op" id="6136396">)</span><span class="op" id="6136397">;</span>&nbsp;<span class="ident" id="6136399"><a href="/net/http/fcgi/fcgi.go.html#6136374">err</a></span>&nbsp;<span class="op" id="6136403">!=</span>&nbsp;<span class="ident" id="6136406">nil</span>&nbsp;<span class="op" id="6136410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136415">return</span>&nbsp;<span class="ident" id="6136422"><a href="/net/http/fcgi/fcgi.go.html#6136374">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136434"><a href="/net/http/fcgi/fcgi.go.html#6136079">w</a></span><span class="op" id="6136435">.</span><span class="ident" id="6136436">Close</span><span class="op" id="6136441">(</span><span class="op" id="6136442">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136445">return</span>&nbsp;<span class="ident" id="6136452">nil</span><br>
<span class="lineno"></span><span class="op" id="6136456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6136459">func</span>&nbsp;<span class="ident" id="6136464">readSize</span><span class="op" id="6136472">(</span><span class="ident" id="6136473">s</span>&nbsp;<span class="op" id="6136475">[</span><span class="op" id="6136476">]</span><span class="builtintype" id="6136477">byte</span><span class="op" id="6136481">)</span>&nbsp;<span class="op" id="6136483">(</span><span class="builtintype" id="6136484">uint32</span><span class="op" id="6136490">,</span>&nbsp;<span class="builtintype" id="6136492">int</span><span class="op" id="6136495">)</span>&nbsp;<span class="op" id="6136497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136500">if</span>&nbsp;<span class="builtinfunc" id="6136503">len</span><span class="op" id="6136506">(</span><span class="ident" id="6136507"><a href="/net/http/fcgi/fcgi.go.html#6136473">s</a></span><span class="op" id="6136508">)</span>&nbsp;<span class="op" id="6136510">==</span>&nbsp;<span class="num" id="6136513">0</span>&nbsp;<span class="op" id="6136515">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136519">return</span>&nbsp;<span class="num" id="6136526">0</span><span class="op" id="6136527">,</span>&nbsp;<span class="num" id="6136529">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136535">size</span><span class="op" id="6136539">,</span>&nbsp;<span class="ident" id="6136541">n</span>&nbsp;<span class="op" id="6136543">:=</span>&nbsp;<span class="builtintype" id="6136546">uint32</span><span class="op" id="6136552">(</span><span class="ident" id="6136553"><a href="/net/http/fcgi/fcgi.go.html#6136473">s</a></span><span class="op" id="6136554">[</span><span class="num" id="6136555">0</span><span class="op" id="6136556">]</span><span class="op" id="6136557">)</span><span class="op" id="6136558">,</span>&nbsp;<span class="num" id="6136560">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136563">if</span>&nbsp;<span class="ident" id="6136566"><a href="/net/http/fcgi/fcgi.go.html#6136535">size</a></span><span class="op" id="6136570">&amp;</span><span class="op" id="6136571">(</span><span class="num" id="6136572">1</span><span class="op" id="6136573">&lt;&lt;</span><span class="num" id="6136575">7</span><span class="op" id="6136576">)</span>&nbsp;<span class="op" id="6136578">!=</span>&nbsp;<span class="num" id="6136581">0</span>&nbsp;<span class="op" id="6136583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136587">if</span>&nbsp;<span class="builtinfunc" id="6136590">len</span><span class="op" id="6136593">(</span><span class="ident" id="6136594"><a href="/net/http/fcgi/fcgi.go.html#6136473">s</a></span><span class="op" id="6136595">)</span>&nbsp;<span class="op" id="6136597">&lt;</span>&nbsp;<span class="num" id="6136599">4</span>&nbsp;<span class="op" id="6136601">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136606">return</span>&nbsp;<span class="num" id="6136613">0</span><span class="op" id="6136614">,</span>&nbsp;<span class="num" id="6136616">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136624"><a href="/net/http/fcgi/fcgi.go.html#6136541">n</a></span>&nbsp;<span class="op" id="6136626">=</span>&nbsp;<span class="num" id="6136628">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136632"><a href="/net/http/fcgi/fcgi.go.html#6136535">size</a></span>&nbsp;<span class="op" id="6136637">=</span>&nbsp;<span class="ident" id="6136639"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6136645">.</span><span class="ident" id="6136646">BigEndian</span><span class="op" id="6136655">.</span><span class="ident" id="6136656">Uint32</span><span class="op" id="6136662">(</span><span class="ident" id="6136663"><a href="/net/http/fcgi/fcgi.go.html#6136473">s</a></span><span class="op" id="6136664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136668"><a href="/net/http/fcgi/fcgi.go.html#6136535">size</a></span>&nbsp;<span class="op" id="6136673">&amp;^=</span>&nbsp;<span class="num" id="6136677">1</span>&nbsp;<span class="op" id="6136679">&lt;&lt;</span>&nbsp;<span class="num" id="6136682">31</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136689">return</span>&nbsp;<span class="ident" id="6136696"><a href="/net/http/fcgi/fcgi.go.html#6136535">size</a></span><span class="op" id="6136700">,</span>&nbsp;<span class="ident" id="6136702"><a href="/net/http/fcgi/fcgi.go.html#6136541">n</a></span><br>
<span class="lineno"></span><span class="op" id="6136704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6136707">func</span>&nbsp;<span class="ident" id="6136712">readString</span><span class="op" id="6136722">(</span><span class="ident" id="6136723">s</span>&nbsp;<span class="op" id="6136725">[</span><span class="op" id="6136726">]</span><span class="builtintype" id="6136727">byte</span><span class="op" id="6136731">,</span>&nbsp;<span class="ident" id="6136733">size</span>&nbsp;<span class="builtintype" id="6136738">uint32</span><span class="op" id="6136744">)</span>&nbsp;<span class="builtintype" id="6136746">string</span>&nbsp;<span class="op" id="6136753">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136756">if</span>&nbsp;<span class="ident" id="6136759"><a href="/net/http/fcgi/fcgi.go.html#6136733">size</a></span>&nbsp;<span class="op" id="6136764">&gt;</span>&nbsp;<span class="builtintype" id="6136766">uint32</span><span class="op" id="6136772">(</span><span class="builtinfunc" id="6136773">len</span><span class="op" id="6136776">(</span><span class="ident" id="6136777"><a href="/net/http/fcgi/fcgi.go.html#6136723">s</a></span><span class="op" id="6136778">)</span><span class="op" id="6136779">)</span>&nbsp;<span class="op" id="6136781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136785">return</span>&nbsp;<span class="string" id="6136792">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136799">return</span>&nbsp;<span class="builtintype" id="6136806">string</span><span class="op" id="6136812">(</span><span class="ident" id="6136813"><a href="/net/http/fcgi/fcgi.go.html#6136723">s</a></span><span class="op" id="6136814">[</span><span class="op" id="6136815">:</span><span class="ident" id="6136816"><a href="/net/http/fcgi/fcgi.go.html#6136733">size</a></span><span class="op" id="6136820">]</span><span class="op" id="6136821">)</span><br>
<span class="lineno"></span><span class="op" id="6136823">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6136826">func</span>&nbsp;<span class="ident" id="6136831">encodeSize</span><span class="op" id="6136841">(</span><span class="ident" id="6136842">b</span>&nbsp;<span class="op" id="6136844">[</span><span class="op" id="6136845">]</span><span class="builtintype" id="6136846">byte</span><span class="op" id="6136850">,</span>&nbsp;<span class="ident" id="6136852">size</span>&nbsp;<span class="builtintype" id="6136857">uint32</span><span class="op" id="6136863">)</span>&nbsp;<span class="builtintype" id="6136865">int</span>&nbsp;<span class="op" id="6136869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136872">if</span>&nbsp;<span class="ident" id="6136875"><a href="/net/http/fcgi/fcgi.go.html#6136852">size</a></span>&nbsp;<span class="op" id="6136880">&gt;</span>&nbsp;<span class="num" id="6136882">127</span>&nbsp;<span class="op" id="6136886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136890"><a href="/net/http/fcgi/fcgi.go.html#6136852">size</a></span>&nbsp;<span class="op" id="6136895">|=</span>&nbsp;<span class="num" id="6136898">1</span>&nbsp;<span class="op" id="6136900">&lt;&lt;</span>&nbsp;<span class="num" id="6136903">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136908"><a href="/net/http/fcgi/fcgi.go.html#6132522">binary</a></span><span class="op" id="6136914">.</span><span class="ident" id="6136915">BigEndian</span><span class="op" id="6136924">.</span><span class="ident" id="6136925">PutUint32</span><span class="op" id="6136934">(</span><span class="ident" id="6136935"><a href="/net/http/fcgi/fcgi.go.html#6136842">b</a></span><span class="op" id="6136936">,</span>&nbsp;<span class="ident" id="6136938"><a href="/net/http/fcgi/fcgi.go.html#6136852">size</a></span><span class="op" id="6136942">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136946">return</span>&nbsp;<span class="num" id="6136953">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6136956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6136959"><a href="/net/http/fcgi/fcgi.go.html#6136842">b</a></span><span class="op" id="6136960">[</span><span class="num" id="6136961">0</span><span class="op" id="6136962">]</span>&nbsp;<span class="op" id="6136964">=</span>&nbsp;<span class="builtintype" id="6136966">byte</span><span class="op" id="6136970">(</span><span class="ident" id="6136971"><a href="/net/http/fcgi/fcgi.go.html#6136852">size</a></span><span class="op" id="6136975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6136978">return</span>&nbsp;<span class="num" id="6136985">1</span><br>
<span class="lineno"></span><span class="op" id="6136987">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="6136990">//&nbsp;bufWriter&nbsp;encapsulates&nbsp;bufio.Writer&nbsp;but&nbsp;also&nbsp;closes&nbsp;the&nbsp;underlying&nbsp;stream&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="6137072">//&nbsp;Closed.</span><br>
<span class="lineno"></span><span class="keyword" id="6137083">type</span>&nbsp;<span class="ident" id="6137088">bufWriter</span>&nbsp;<span class="keyword" id="6137098">struct</span>&nbsp;<span class="op" id="6137105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137108">closer</span>&nbsp;<span class="ident" id="6137115"><a href="/net/http/fcgi/fcgi.go.html#6132551">io</a></span><span class="op" id="6137117">.</span><span class="ident" id="6137118">Closer</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137126">*</span><span class="ident" id="6137127"><a href="/net/http/fcgi/fcgi.go.html#6132504">bufio</a></span><span class="op" id="6137132">.</span><span class="ident" id="6137133">Writer</span><br>
<span class="lineno"></span><span class="op" id="6137140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6137143">func</span>&nbsp;<span class="op" id="6137148">(</span><span class="ident" id="6137149">w</span>&nbsp;<span class="op" id="6137151">*</span><span class="ident" id="6137152"><a href="/net/http/fcgi/fcgi.go.html#6137088">bufWriter</a></span><span class="op" id="6137161">)</span>&nbsp;<span class="ident" id="6137163">Close</span><span class="op" id="6137168">(</span><span class="op" id="6137169">)</span>&nbsp;<span class="builtintype" id="6137171">error</span>&nbsp;<span class="op" id="6137177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137180">if</span>&nbsp;<span class="ident" id="6137183">err</span>&nbsp;<span class="op" id="6137187">:=</span>&nbsp;<span class="ident" id="6137190"><a href="/net/http/fcgi/fcgi.go.html#6137149">w</a></span><span class="op" id="6137191">.</span><span class="ident" id="6137192">Writer</span><span class="op" id="6137198">.</span><span class="ident" id="6137199">Flush</span><span class="op" id="6137204">(</span><span class="op" id="6137205">)</span><span class="op" id="6137206">;</span>&nbsp;<span class="ident" id="6137208"><a href="/net/http/fcgi/fcgi.go.html#6137183">err</a></span>&nbsp;<span class="op" id="6137212">!=</span>&nbsp;<span class="ident" id="6137215">nil</span>&nbsp;<span class="op" id="6137219">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137223"><a href="/net/http/fcgi/fcgi.go.html#6137149">w</a></span><span class="op" id="6137224">.</span><span class="ident" id="6137225">closer</span><span class="op" id="6137231">.</span><span class="ident" id="6137232">Close</span><span class="op" id="6137237">(</span><span class="op" id="6137238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137242">return</span>&nbsp;<span class="ident" id="6137249"><a href="/net/http/fcgi/fcgi.go.html#6137183">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137257">return</span>&nbsp;<span class="ident" id="6137264"><a href="/net/http/fcgi/fcgi.go.html#6137149">w</a></span><span class="op" id="6137265">.</span><span class="ident" id="6137266">closer</span><span class="op" id="6137272">.</span><span class="ident" id="6137273">Close</span><span class="op" id="6137278">(</span><span class="op" id="6137279">)</span><br>
<span class="lineno"></span><span class="op" id="6137281">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="6137284">func</span>&nbsp;<span class="ident" id="6137289">newWriter</span><span class="op" id="6137298">(</span><span class="ident" id="6137299">c</span>&nbsp;<span class="op" id="6137301">*</span><span class="ident" id="6137302"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><span class="op" id="6137306">,</span>&nbsp;<span class="ident" id="6137308">recType</span>&nbsp;<span class="ident" id="6137316"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span><span class="op" id="6137323">,</span>&nbsp;<span class="ident" id="6137325">reqId</span>&nbsp;<span class="builtintype" id="6137331">uint16</span><span class="op" id="6137337">)</span>&nbsp;<span class="op" id="6137339">*</span><span class="ident" id="6137340"><a href="/net/http/fcgi/fcgi.go.html#6137088">bufWriter</a></span>&nbsp;<span class="op" id="6137350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137353">s</span>&nbsp;<span class="op" id="6137355">:=</span>&nbsp;<span class="op" id="6137358">&amp;</span><span class="ident" id="6137359"><a href="/net/http/fcgi/fcgi.go.html#6137606">streamWriter</a></span><span class="op" id="6137371">{</span><span class="ident" id="6137372">c</span><span class="op" id="6137373">:</span>&nbsp;<span class="ident" id="6137375"><a href="/net/http/fcgi/fcgi.go.html#6137299">c</a></span><span class="op" id="6137376">,</span>&nbsp;<span class="ident" id="6137378">recType</span><span class="op" id="6137385">:</span>&nbsp;<span class="ident" id="6137387"><a href="/net/http/fcgi/fcgi.go.html#6137308">recType</a></span><span class="op" id="6137394">,</span>&nbsp;<span class="ident" id="6137396">reqId</span><span class="op" id="6137401">:</span>&nbsp;<span class="ident" id="6137403"><a href="/net/http/fcgi/fcgi.go.html#6137325">reqId</a></span><span class="op" id="6137408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137411">w</span>&nbsp;<span class="op" id="6137413">:=</span>&nbsp;<span class="ident" id="6137416"><a href="/net/http/fcgi/fcgi.go.html#6132504">bufio</a></span><span class="op" id="6137421">.</span><span class="ident" id="6137422">NewWriterSize</span><span class="op" id="6137435">(</span><span class="ident" id="6137436"><a href="/net/http/fcgi/fcgi.go.html#6137353">s</a></span><span class="op" id="6137437">,</span>&nbsp;<span class="ident" id="6137439"><a href="/net/http/fcgi/fcgi.go.html#6133169">maxWrite</a></span><span class="op" id="6137447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137450">return</span>&nbsp;<span class="op" id="6137457">&amp;</span><span class="ident" id="6137458"><a href="/net/http/fcgi/fcgi.go.html#6137088">bufWriter</a></span><span class="op" id="6137467">{</span><span class="ident" id="6137468"><a href="/net/http/fcgi/fcgi.go.html#6137353">s</a></span><span class="op" id="6137469">,</span>&nbsp;<span class="ident" id="6137471"><a href="/net/http/fcgi/fcgi.go.html#6137411">w</a></span><span class="op" id="6137472">}</span><br>
<span class="lineno">245</span><span class="op" id="6137474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6137477">//&nbsp;streamWriter&nbsp;abstracts&nbsp;out&nbsp;the&nbsp;separation&nbsp;of&nbsp;a&nbsp;stream&nbsp;into&nbsp;discrete&nbsp;records.</span><br>
<span class="lineno"></span><span class="comment" id="6137557">//&nbsp;It&nbsp;only&nbsp;writes&nbsp;maxWrite&nbsp;bytes&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="6137601">type</span>&nbsp;<span class="ident" id="6137606">streamWriter</span>&nbsp;<span class="keyword" id="6137619">struct</span>&nbsp;<span class="op" id="6137626">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137629">c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6137637">*</span><span class="ident" id="6137638"><a href="/net/http/fcgi/fcgi.go.html#6134294">conn</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137644">recType</span>&nbsp;<span class="ident" id="6137652"><a href="/net/http/fcgi/fcgi.go.html#6132670">recType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137661">reqId</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6137669">uint16</span><br>
<span class="lineno"></span><span class="op" id="6137676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="6137679">func</span>&nbsp;<span class="op" id="6137684">(</span><span class="ident" id="6137685">w</span>&nbsp;<span class="op" id="6137687">*</span><span class="ident" id="6137688"><a href="/net/http/fcgi/fcgi.go.html#6137606">streamWriter</a></span><span class="op" id="6137700">)</span>&nbsp;<span class="ident" id="6137702">Write</span><span class="op" id="6137707">(</span><span class="ident" id="6137708">p</span>&nbsp;<span class="op" id="6137710">[</span><span class="op" id="6137711">]</span><span class="builtintype" id="6137712">byte</span><span class="op" id="6137716">)</span>&nbsp;<span class="op" id="6137718">(</span><span class="builtintype" id="6137719">int</span><span class="op" id="6137722">,</span>&nbsp;<span class="builtintype" id="6137724">error</span><span class="op" id="6137729">)</span>&nbsp;<span class="op" id="6137731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137734">nn</span>&nbsp;<span class="op" id="6137737">:=</span>&nbsp;<span class="num" id="6137740">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137743">for</span>&nbsp;<span class="builtinfunc" id="6137747">len</span><span class="op" id="6137750">(</span><span class="ident" id="6137751"><a href="/net/http/fcgi/fcgi.go.html#6137708">p</a></span><span class="op" id="6137752">)</span>&nbsp;<span class="op" id="6137754">&gt;</span>&nbsp;<span class="num" id="6137756">0</span>&nbsp;<span class="op" id="6137758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137762">n</span>&nbsp;<span class="op" id="6137764">:=</span>&nbsp;<span class="builtinfunc" id="6137767">len</span><span class="op" id="6137770">(</span><span class="ident" id="6137771"><a href="/net/http/fcgi/fcgi.go.html#6137708">p</a></span><span class="op" id="6137772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137776">if</span>&nbsp;<span class="ident" id="6137779"><a href="/net/http/fcgi/fcgi.go.html#6137762">n</a></span>&nbsp;<span class="op" id="6137781">&gt;</span>&nbsp;<span class="ident" id="6137783"><a href="/net/http/fcgi/fcgi.go.html#6133169">maxWrite</a></span>&nbsp;<span class="op" id="6137792">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137797"><a href="/net/http/fcgi/fcgi.go.html#6137762">n</a></span>&nbsp;<span class="op" id="6137799">=</span>&nbsp;<span class="ident" id="6137801"><a href="/net/http/fcgi/fcgi.go.html#6133169">maxWrite</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137816">if</span>&nbsp;<span class="ident" id="6137819">err</span>&nbsp;<span class="op" id="6137823">:=</span>&nbsp;<span class="ident" id="6137826"><a href="/net/http/fcgi/fcgi.go.html#6137685">w</a></span><span class="op" id="6137827">.</span><span class="ident" id="6137828">c</span><span class="op" id="6137829">.</span><span class="ident" id="6137830">writeRecord</span><span class="op" id="6137841">(</span><span class="ident" id="6137842"><a href="/net/http/fcgi/fcgi.go.html#6137685">w</a></span><span class="op" id="6137843">.</span><span class="ident" id="6137844">recType</span><span class="op" id="6137851">,</span>&nbsp;<span class="ident" id="6137853"><a href="/net/http/fcgi/fcgi.go.html#6137685">w</a></span><span class="op" id="6137854">.</span><span class="ident" id="6137855">reqId</span><span class="op" id="6137860">,</span>&nbsp;<span class="ident" id="6137862"><a href="/net/http/fcgi/fcgi.go.html#6137708">p</a></span><span class="op" id="6137863">[</span><span class="op" id="6137864">:</span><span class="ident" id="6137865"><a href="/net/http/fcgi/fcgi.go.html#6137762">n</a></span><span class="op" id="6137866">]</span><span class="op" id="6137867">)</span><span class="op" id="6137868">;</span>&nbsp;<span class="ident" id="6137870"><a href="/net/http/fcgi/fcgi.go.html#6137819">err</a></span>&nbsp;<span class="op" id="6137874">!=</span>&nbsp;<span class="ident" id="6137877">nil</span>&nbsp;<span class="op" id="6137881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137886">return</span>&nbsp;<span class="ident" id="6137893"><a href="/net/http/fcgi/fcgi.go.html#6137734">nn</a></span><span class="op" id="6137895">,</span>&nbsp;<span class="ident" id="6137897"><a href="/net/http/fcgi/fcgi.go.html#6137819">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137903">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137907"><a href="/net/http/fcgi/fcgi.go.html#6137734">nn</a></span>&nbsp;<span class="op" id="6137910">+=</span>&nbsp;<span class="ident" id="6137913"><a href="/net/http/fcgi/fcgi.go.html#6137762">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6137917"><a href="/net/http/fcgi/fcgi.go.html#6137708">p</a></span>&nbsp;<span class="op" id="6137919">=</span>&nbsp;<span class="ident" id="6137921"><a href="/net/http/fcgi/fcgi.go.html#6137708">p</a></span><span class="op" id="6137922">[</span><span class="ident" id="6137923"><a href="/net/http/fcgi/fcgi.go.html#6137762">n</a></span><span class="op" id="6137924">:</span><span class="op" id="6137925">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6137928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6137931">return</span>&nbsp;<span class="ident" id="6137938"><a href="/net/http/fcgi/fcgi.go.html#6137734">nn</a></span><span class="op" id="6137940">,</span>&nbsp;<span class="ident" id="6137942">nil</span><br>
<span class="lineno"></span><span class="op" id="6137946">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="6137949">func</span>&nbsp;<span class="op" id="6137954">(</span><span class="ident" id="6137955">w</span>&nbsp;<span class="op" id="6137957">*</span><span class="ident" id="6137958"><a href="/net/http/fcgi/fcgi.go.html#6137606">streamWriter</a></span><span class="op" id="6137970">)</span>&nbsp;<span class="ident" id="6137972">Close</span><span class="op" id="6137977">(</span><span class="op" id="6137978">)</span>&nbsp;<span class="builtintype" id="6137980">error</span>&nbsp;<span class="op" id="6137986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6137989">//&nbsp;send&nbsp;empty&nbsp;record&nbsp;to&nbsp;close&nbsp;the&nbsp;stream</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6138031">return</span>&nbsp;<span class="ident" id="6138038"><a href="/net/http/fcgi/fcgi.go.html#6137955">w</a></span><span class="op" id="6138039">.</span><span class="ident" id="6138040">c</span><span class="op" id="6138041">.</span><span class="ident" id="6138042">writeRecord</span><span class="op" id="6138053">(</span><span class="ident" id="6138054"><a href="/net/http/fcgi/fcgi.go.html#6137955">w</a></span><span class="op" id="6138055">.</span><span class="ident" id="6138056">recType</span><span class="op" id="6138063">,</span>&nbsp;<span class="ident" id="6138065"><a href="/net/http/fcgi/fcgi.go.html#6137955">w</a></span><span class="op" id="6138066">.</span><span class="ident" id="6138067">reqId</span><span class="op" id="6138072">,</span>&nbsp;<span class="ident" id="6138074">nil</span><span class="op" id="6138077">)</span><br>
<span class="lineno"></span><span class="op" id="6138079">}</span>
</div>
</body>
</html>
