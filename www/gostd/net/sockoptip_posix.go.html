<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html" class="current">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3177735">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3177791">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3177845">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3177896">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3177961">package</span>&nbsp;<span class="ident" id="3177969">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3177974">import</span>&nbsp;<span class="op" id="3177981">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3177984">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3177990">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3178000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3178003">func</span>&nbsp;<span class="ident" id="3178008">joinIPv4Group</span><span class="op" id="3178021">(</span><span class="ident" id="3178022">fd</span>&nbsp;<span class="op" id="3178025">*</span><span class="ident" id="3178026">netFD</span><span class="op" id="3178031">,</span>&nbsp;<span class="ident" id="3178033">ifi</span>&nbsp;<span class="op" id="3178037">*</span><span class="ident" id="3178038">Interface</span><span class="op" id="3178047">,</span>&nbsp;<span class="ident" id="3178049">ip</span>&nbsp;<span class="ident" id="3178052">IP</span><span class="op" id="3178054">)</span>&nbsp;<span class="builtintype" id="3178056">error</span>&nbsp;<span class="op" id="3178062">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3178065">mreq</span>&nbsp;<span class="op" id="3178070">:=</span>&nbsp;<span class="op" id="3178073">&amp;</span><span class="ident" id="3178074">syscall</span><span class="op" id="3178081">.</span><span class="ident" id="3178082">IPMreq</span><span class="op" id="3178088">{</span><span class="ident" id="3178089">Multiaddr</span><span class="op" id="3178098">:</span>&nbsp;<span class="op" id="3178100">[</span><span class="num" id="3178101">4</span><span class="op" id="3178102">]</span><span class="builtintype" id="3178103">byte</span><span class="op" id="3178107">{</span><span class="ident" id="3178108">ip</span><span class="op" id="3178110">[</span><span class="num" id="3178111">0</span><span class="op" id="3178112">]</span><span class="op" id="3178113">,</span>&nbsp;<span class="ident" id="3178115">ip</span><span class="op" id="3178117">[</span><span class="num" id="3178118">1</span><span class="op" id="3178119">]</span><span class="op" id="3178120">,</span>&nbsp;<span class="ident" id="3178122">ip</span><span class="op" id="3178124">[</span><span class="num" id="3178125">2</span><span class="op" id="3178126">]</span><span class="op" id="3178127">,</span>&nbsp;<span class="ident" id="3178129">ip</span><span class="op" id="3178131">[</span><span class="num" id="3178132">3</span><span class="op" id="3178133">]</span><span class="op" id="3178134">}</span><span class="op" id="3178135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178138">if</span>&nbsp;<span class="ident" id="3178141">err</span>&nbsp;<span class="op" id="3178145">:=</span>&nbsp;<span class="ident" id="3178148">setIPv4MreqToInterface</span><span class="op" id="3178170">(</span><span class="ident" id="3178171">mreq</span><span class="op" id="3178175">,</span>&nbsp;<span class="ident" id="3178177">ifi</span><span class="op" id="3178180">)</span><span class="op" id="3178181">;</span>&nbsp;<span class="ident" id="3178183">err</span>&nbsp;<span class="op" id="3178187">!=</span>&nbsp;<span class="ident" id="3178190">nil</span>&nbsp;<span class="op" id="3178194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178198">return</span>&nbsp;<span class="ident" id="3178205">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3178210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178213">if</span>&nbsp;<span class="ident" id="3178216">err</span>&nbsp;<span class="op" id="3178220">:=</span>&nbsp;<span class="ident" id="3178223">fd</span><span class="op" id="3178225">.</span><span class="ident" id="3178226">incref</span><span class="op" id="3178232">(</span><span class="op" id="3178233">)</span><span class="op" id="3178234">;</span>&nbsp;<span class="ident" id="3178236">err</span>&nbsp;<span class="op" id="3178240">!=</span>&nbsp;<span class="ident" id="3178243">nil</span>&nbsp;<span class="op" id="3178247">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178251">return</span>&nbsp;<span class="ident" id="3178258">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3178263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178266">defer</span>&nbsp;<span class="ident" id="3178272">fd</span><span class="op" id="3178274">.</span><span class="ident" id="3178275">decref</span><span class="op" id="3178281">(</span><span class="op" id="3178282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178285">return</span>&nbsp;<span class="ident" id="3178292">os</span><span class="op" id="3178294">.</span><span class="ident" id="3178295">NewSyscallError</span><span class="op" id="3178310">(</span><span class="string" id="3178311">&#34;setsockopt&#34;</span><span class="op" id="3178323">,</span>&nbsp;<span class="ident" id="3178325">syscall</span><span class="op" id="3178332">.</span><span class="ident" id="3178333">SetsockoptIPMreq</span><span class="op" id="3178349">(</span><span class="ident" id="3178350">fd</span><span class="op" id="3178352">.</span><span class="ident" id="3178353">sysfd</span><span class="op" id="3178358">,</span>&nbsp;<span class="ident" id="3178360">syscall</span><span class="op" id="3178367">.</span><span class="ident" id="3178368">IPPROTO_IP</span><span class="op" id="3178378">,</span>&nbsp;<span class="ident" id="3178380">syscall</span><span class="op" id="3178387">.</span><span class="ident" id="3178388">IP_ADD_MEMBERSHIP</span><span class="op" id="3178405">,</span>&nbsp;<span class="ident" id="3178407">mreq</span><span class="op" id="3178411">)</span><span class="op" id="3178412">)</span><br>
<span class="lineno"></span><span class="op" id="3178414">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3178417">func</span>&nbsp;<span class="ident" id="3178422">setIPv6MulticastInterface</span><span class="op" id="3178447">(</span><span class="ident" id="3178448">fd</span>&nbsp;<span class="op" id="3178451">*</span><span class="ident" id="3178452">netFD</span><span class="op" id="3178457">,</span>&nbsp;<span class="ident" id="3178459">ifi</span>&nbsp;<span class="op" id="3178463">*</span><span class="ident" id="3178464">Interface</span><span class="op" id="3178473">)</span>&nbsp;<span class="builtintype" id="3178475">error</span>&nbsp;<span class="op" id="3178481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178484">var</span>&nbsp;<span class="ident" id="3178488">v</span>&nbsp;<span class="builtintype" id="3178490">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178495">if</span>&nbsp;<span class="ident" id="3178498">ifi</span>&nbsp;<span class="op" id="3178502">!=</span>&nbsp;<span class="ident" id="3178505">nil</span>&nbsp;<span class="op" id="3178509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3178513">v</span>&nbsp;<span class="op" id="3178515">=</span>&nbsp;<span class="ident" id="3178517">ifi</span><span class="op" id="3178520">.</span><span class="ident" id="3178521">Index</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3178528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178531">if</span>&nbsp;<span class="ident" id="3178534">err</span>&nbsp;<span class="op" id="3178538">:=</span>&nbsp;<span class="ident" id="3178541">fd</span><span class="op" id="3178543">.</span><span class="ident" id="3178544">incref</span><span class="op" id="3178550">(</span><span class="op" id="3178551">)</span><span class="op" id="3178552">;</span>&nbsp;<span class="ident" id="3178554">err</span>&nbsp;<span class="op" id="3178558">!=</span>&nbsp;<span class="ident" id="3178561">nil</span>&nbsp;<span class="op" id="3178565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178569">return</span>&nbsp;<span class="ident" id="3178576">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3178581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178584">defer</span>&nbsp;<span class="ident" id="3178590">fd</span><span class="op" id="3178592">.</span><span class="ident" id="3178593">decref</span><span class="op" id="3178599">(</span><span class="op" id="3178600">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178603">return</span>&nbsp;<span class="ident" id="3178610">os</span><span class="op" id="3178612">.</span><span class="ident" id="3178613">NewSyscallError</span><span class="op" id="3178628">(</span><span class="string" id="3178629">&#34;setsockopt&#34;</span><span class="op" id="3178641">,</span>&nbsp;<span class="ident" id="3178643">syscall</span><span class="op" id="3178650">.</span><span class="ident" id="3178651">SetsockoptInt</span><span class="op" id="3178664">(</span><span class="ident" id="3178665">fd</span><span class="op" id="3178667">.</span><span class="ident" id="3178668">sysfd</span><span class="op" id="3178673">,</span>&nbsp;<span class="ident" id="3178675">syscall</span><span class="op" id="3178682">.</span><span class="ident" id="3178683">IPPROTO_IPV6</span><span class="op" id="3178695">,</span>&nbsp;<span class="ident" id="3178697">syscall</span><span class="op" id="3178704">.</span><span class="ident" id="3178705">IPV6_MULTICAST_IF</span><span class="op" id="3178722">,</span>&nbsp;<span class="ident" id="3178724">v</span><span class="op" id="3178725">)</span><span class="op" id="3178726">)</span><br>
<span class="lineno"></span><span class="op" id="3178728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3178731">func</span>&nbsp;<span class="ident" id="3178736">setIPv6MulticastLoopback</span><span class="op" id="3178760">(</span><span class="ident" id="3178761">fd</span>&nbsp;<span class="op" id="3178764">*</span><span class="ident" id="3178765">netFD</span><span class="op" id="3178770">,</span>&nbsp;<span class="ident" id="3178772">v</span>&nbsp;<span class="builtintype" id="3178774">bool</span><span class="op" id="3178778">)</span>&nbsp;<span class="builtintype" id="3178780">error</span>&nbsp;<span class="op" id="3178786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178789">if</span>&nbsp;<span class="ident" id="3178792">err</span>&nbsp;<span class="op" id="3178796">:=</span>&nbsp;<span class="ident" id="3178799">fd</span><span class="op" id="3178801">.</span><span class="ident" id="3178802">incref</span><span class="op" id="3178808">(</span><span class="op" id="3178809">)</span><span class="op" id="3178810">;</span>&nbsp;<span class="ident" id="3178812">err</span>&nbsp;<span class="op" id="3178816">!=</span>&nbsp;<span class="ident" id="3178819">nil</span>&nbsp;<span class="op" id="3178823">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178827">return</span>&nbsp;<span class="ident" id="3178834">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3178839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178842">defer</span>&nbsp;<span class="ident" id="3178848">fd</span><span class="op" id="3178850">.</span><span class="ident" id="3178851">decref</span><span class="op" id="3178857">(</span><span class="op" id="3178858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3178861">return</span>&nbsp;<span class="ident" id="3178868">os</span><span class="op" id="3178870">.</span><span class="ident" id="3178871">NewSyscallError</span><span class="op" id="3178886">(</span><span class="string" id="3178887">&#34;setsockopt&#34;</span><span class="op" id="3178899">,</span>&nbsp;<span class="ident" id="3178901">syscall</span><span class="op" id="3178908">.</span><span class="ident" id="3178909">SetsockoptInt</span><span class="op" id="3178922">(</span><span class="ident" id="3178923">fd</span><span class="op" id="3178925">.</span><span class="ident" id="3178926">sysfd</span><span class="op" id="3178931">,</span>&nbsp;<span class="ident" id="3178933">syscall</span><span class="op" id="3178940">.</span><span class="ident" id="3178941">IPPROTO_IPV6</span><span class="op" id="3178953">,</span>&nbsp;<span class="ident" id="3178955">syscall</span><span class="op" id="3178962">.</span><span class="ident" id="3178963">IPV6_MULTICAST_LOOP</span><span class="op" id="3178982">,</span>&nbsp;<span class="ident" id="3178984">boolint</span><span class="op" id="3178991">(</span><span class="ident" id="3178992">v</span><span class="op" id="3178993">)</span><span class="op" id="3178994">)</span><span class="op" id="3178995">)</span><br>
<span class="lineno"></span><span class="op" id="3178997">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3179000">func</span>&nbsp;<span class="ident" id="3179005">joinIPv6Group</span><span class="op" id="3179018">(</span><span class="ident" id="3179019">fd</span>&nbsp;<span class="op" id="3179022">*</span><span class="ident" id="3179023">netFD</span><span class="op" id="3179028">,</span>&nbsp;<span class="ident" id="3179030">ifi</span>&nbsp;<span class="op" id="3179034">*</span><span class="ident" id="3179035">Interface</span><span class="op" id="3179044">,</span>&nbsp;<span class="ident" id="3179046">ip</span>&nbsp;<span class="ident" id="3179049">IP</span><span class="op" id="3179051">)</span>&nbsp;<span class="builtintype" id="3179053">error</span>&nbsp;<span class="op" id="3179059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3179062">mreq</span>&nbsp;<span class="op" id="3179067">:=</span>&nbsp;<span class="op" id="3179070">&amp;</span><span class="ident" id="3179071">syscall</span><span class="op" id="3179078">.</span><span class="ident" id="3179079">IPv6Mreq</span><span class="op" id="3179087">{</span><span class="op" id="3179088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3179091">copy</span><span class="op" id="3179095">(</span><span class="ident" id="3179096">mreq</span><span class="op" id="3179100">.</span><span class="ident" id="3179101">Multiaddr</span><span class="op" id="3179110">[</span><span class="op" id="3179111">:</span><span class="op" id="3179112">]</span><span class="op" id="3179113">,</span>&nbsp;<span class="ident" id="3179115">ip</span><span class="op" id="3179117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3179120">if</span>&nbsp;<span class="ident" id="3179123">ifi</span>&nbsp;<span class="op" id="3179127">!=</span>&nbsp;<span class="ident" id="3179130">nil</span>&nbsp;<span class="op" id="3179134">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3179138">mreq</span><span class="op" id="3179142">.</span><span class="ident" id="3179143">Interface</span>&nbsp;<span class="op" id="3179153">=</span>&nbsp;<span class="builtintype" id="3179155">uint32</span><span class="op" id="3179161">(</span><span class="ident" id="3179162">ifi</span><span class="op" id="3179165">.</span><span class="ident" id="3179166">Index</span><span class="op" id="3179171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3179174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3179177">if</span>&nbsp;<span class="ident" id="3179180">err</span>&nbsp;<span class="op" id="3179184">:=</span>&nbsp;<span class="ident" id="3179187">fd</span><span class="op" id="3179189">.</span><span class="ident" id="3179190">incref</span><span class="op" id="3179196">(</span><span class="op" id="3179197">)</span><span class="op" id="3179198">;</span>&nbsp;<span class="ident" id="3179200">err</span>&nbsp;<span class="op" id="3179204">!=</span>&nbsp;<span class="ident" id="3179207">nil</span>&nbsp;<span class="op" id="3179211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3179215">return</span>&nbsp;<span class="ident" id="3179222">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3179227">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3179230">defer</span>&nbsp;<span class="ident" id="3179236">fd</span><span class="op" id="3179238">.</span><span class="ident" id="3179239">decref</span><span class="op" id="3179245">(</span><span class="op" id="3179246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3179249">return</span>&nbsp;<span class="ident" id="3179256">os</span><span class="op" id="3179258">.</span><span class="ident" id="3179259">NewSyscallError</span><span class="op" id="3179274">(</span><span class="string" id="3179275">&#34;setsockopt&#34;</span><span class="op" id="3179287">,</span>&nbsp;<span class="ident" id="3179289">syscall</span><span class="op" id="3179296">.</span><span class="ident" id="3179297">SetsockoptIPv6Mreq</span><span class="op" id="3179315">(</span><span class="ident" id="3179316">fd</span><span class="op" id="3179318">.</span><span class="ident" id="3179319">sysfd</span><span class="op" id="3179324">,</span>&nbsp;<span class="ident" id="3179326">syscall</span><span class="op" id="3179333">.</span><span class="ident" id="3179334">IPPROTO_IPV6</span><span class="op" id="3179346">,</span>&nbsp;<span class="ident" id="3179348">syscall</span><span class="op" id="3179355">.</span><span class="ident" id="3179356">IPV6_JOIN_GROUP</span><span class="op" id="3179371">,</span>&nbsp;<span class="ident" id="3179373">mreq</span><span class="op" id="3179377">)</span><span class="op" id="3179378">)</span><br>
<span class="lineno"></span><span class="op" id="3179380">}</span>
</div>
</body>
</html>
