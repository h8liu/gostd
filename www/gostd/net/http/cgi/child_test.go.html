<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/cgi</h2>
<ul>
<li><a href="/gostd/net/http/cgi/child.go.html">child.go</a></li>
<li><a href="/gostd/net/http/cgi/child_test.go.html" class="current">child_test.go</a></li>
<li><a href="/gostd/net/http/cgi/host.go.html">host.go</a></li>
<li><a href="/gostd/net/http/cgi/host_test.go.html">host_test.go</a></li>
<li><a href="/gostd/net/http/cgi/matryoshka_test.go.html">matryoshka_test.go</a></li>
<li><a href="/gostd/net/http/cgi/posix_test.go.html">posix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7414546">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7414601">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7414655">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7414706">//&nbsp;Tests&nbsp;for&nbsp;CGI&nbsp;(the&nbsp;child&nbsp;process&nbsp;perspective)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7414756">package</span>&nbsp;<span class="ident" id="7414764">cgi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7414769">import</span>&nbsp;<span class="op" id="7414776">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414779">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7414789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7414792">func</span>&nbsp;<span class="ident" id="7414797">TestRequest</span><span class="op" id="7414808">(</span><span class="ident" id="7414809">t</span>&nbsp;<span class="op" id="7414811">*</span><span class="ident" id="7414812"><a href="/gostd/net/http/cgi/child_test.go.html#7414779">testing</a></span><span class="op" id="7414819">.</span><span class="ident" id="7414820"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7414821">)</span>&nbsp;<span class="op" id="7414823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7414826">env</span>&nbsp;<span class="op" id="7414830">:=</span>&nbsp;<span class="keyword" id="7414833">map</span><span class="op" id="7414836">[</span><span class="builtintype" id="7414837">string</span><span class="op" id="7414843">]</span><span class="builtintype" id="7414844">string</span><span class="op" id="7414850">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414854">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7414871">:</span>&nbsp;<span class="string" id="7414873">&#34;HTTP/1.1&#34;</span><span class="op" id="7414883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414887">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7414903">:</span>&nbsp;&nbsp;<span class="string" id="7414906">&#34;GET&#34;</span><span class="op" id="7414911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414915">&#34;HTTP_HOST&#34;</span><span class="op" id="7414926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414934">&#34;example.com&#34;</span><span class="op" id="7414947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414951">&#34;HTTP_REFERER&#34;</span><span class="op" id="7414965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414970">&#34;elsewhere&#34;</span><span class="op" id="7414981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7414985">&#34;HTTP_USER_AGENT&#34;</span><span class="op" id="7415002">:</span>&nbsp;<span class="string" id="7415004">&#34;goclient&#34;</span><span class="op" id="7415014">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415018">&#34;HTTP_FOO_BAR&#34;</span><span class="op" id="7415032">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415037">&#34;baz&#34;</span><span class="op" id="7415042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415046">&#34;REQUEST_URI&#34;</span><span class="op" id="7415059">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415065">&#34;/path?a=b&#34;</span><span class="op" id="7415076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415080">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="7415096">:</span>&nbsp;&nbsp;<span class="string" id="7415099">&#34;123&#34;</span><span class="op" id="7415104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415108">&#34;CONTENT_TYPE&#34;</span><span class="op" id="7415122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415127">&#34;text/xml&#34;</span><span class="op" id="7415137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415141">&#34;REMOTE_ADDR&#34;</span><span class="op" id="7415154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7415160">&#34;5.6.7.8&#34;</span><span class="op" id="7415169">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415175">req</span><span class="op" id="7415178">,</span>&nbsp;<span class="ident" id="7415180">err</span>&nbsp;<span class="op" id="7415184">:=</span>&nbsp;<span class="ident" id="7415187"><a href="/gostd/net/http/cgi/child.go.html#5690647">RequestFromMap</a></span><span class="op" id="7415201">(</span><span class="ident" id="7415202"><a href="/gostd/net/http/cgi/child_test.go.html#7414826">env</a></span><span class="op" id="7415205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415208">if</span>&nbsp;<span class="ident" id="7415211"><a href="/gostd/net/http/cgi/child_test.go.html#7415180">err</a></span>&nbsp;<span class="op" id="7415215">!=</span>&nbsp;<span class="builtintype" id="7415218">nil</span>&nbsp;<span class="op" id="7415222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415226"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415227">.</span><span class="ident" id="7415228"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7415234">(</span><span class="string" id="7415235">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7415255">,</span>&nbsp;<span class="ident" id="7415257"><a href="/gostd/net/http/cgi/child_test.go.html#7415180">err</a></span><span class="op" id="7415260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415263">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415266">if</span>&nbsp;<span class="ident" id="7415269">g</span><span class="op" id="7415270">,</span>&nbsp;<span class="ident" id="7415272">e</span>&nbsp;<span class="op" id="7415274">:=</span>&nbsp;<span class="ident" id="7415277"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415280">.</span><span class="ident" id="7415281"><a href="/gostd/net/http/request.go.html#4142212">UserAgent</a></span><span class="op" id="7415290">(</span><span class="op" id="7415291">)</span><span class="op" id="7415292">,</span>&nbsp;<span class="string" id="7415294">&#34;goclient&#34;</span><span class="op" id="7415304">;</span>&nbsp;<span class="ident" id="7415306"><a href="/gostd/net/http/cgi/child_test.go.html#7415272">e</a></span>&nbsp;<span class="op" id="7415308">!=</span>&nbsp;<span class="ident" id="7415311"><a href="/gostd/net/http/cgi/child_test.go.html#7415269">g</a></span>&nbsp;<span class="op" id="7415313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415317"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415318">.</span><span class="ident" id="7415319"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7415325">(</span><span class="string" id="7415326">&#34;expected&nbsp;UserAgent&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7415357">,</span>&nbsp;<span class="ident" id="7415359"><a href="/gostd/net/http/cgi/child_test.go.html#7415272">e</a></span><span class="op" id="7415360">,</span>&nbsp;<span class="ident" id="7415362"><a href="/gostd/net/http/cgi/child_test.go.html#7415269">g</a></span><span class="op" id="7415363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415369">if</span>&nbsp;<span class="ident" id="7415372">g</span><span class="op" id="7415373">,</span>&nbsp;<span class="ident" id="7415375">e</span>&nbsp;<span class="op" id="7415377">:=</span>&nbsp;<span class="ident" id="7415380"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415383">.</span><span class="ident" id="7415384"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span><span class="op" id="7415390">,</span>&nbsp;<span class="string" id="7415392">&#34;GET&#34;</span><span class="op" id="7415397">;</span>&nbsp;<span class="ident" id="7415399"><a href="/gostd/net/http/cgi/child_test.go.html#7415375">e</a></span>&nbsp;<span class="op" id="7415401">!=</span>&nbsp;<span class="ident" id="7415404"><a href="/gostd/net/http/cgi/child_test.go.html#7415372">g</a></span>&nbsp;<span class="op" id="7415406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415410"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415411">.</span><span class="ident" id="7415412"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7415418">(</span><span class="string" id="7415419">&#34;expected&nbsp;Method&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7415447">,</span>&nbsp;<span class="ident" id="7415449"><a href="/gostd/net/http/cgi/child_test.go.html#7415375">e</a></span><span class="op" id="7415450">,</span>&nbsp;<span class="ident" id="7415452"><a href="/gostd/net/http/cgi/child_test.go.html#7415372">g</a></span><span class="op" id="7415453">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415459">if</span>&nbsp;<span class="ident" id="7415462">g</span><span class="op" id="7415463">,</span>&nbsp;<span class="ident" id="7415465">e</span>&nbsp;<span class="op" id="7415467">:=</span>&nbsp;<span class="ident" id="7415470"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415473">.</span><span class="ident" id="7415474"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="7415480">.</span><span class="ident" id="7415481"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="7415484">(</span><span class="string" id="7415485">&#34;Content-Type&#34;</span><span class="op" id="7415499">)</span><span class="op" id="7415500">,</span>&nbsp;<span class="string" id="7415502">&#34;text/xml&#34;</span><span class="op" id="7415512">;</span>&nbsp;<span class="ident" id="7415514"><a href="/gostd/net/http/cgi/child_test.go.html#7415465">e</a></span>&nbsp;<span class="op" id="7415516">!=</span>&nbsp;<span class="ident" id="7415519"><a href="/gostd/net/http/cgi/child_test.go.html#7415462">g</a></span>&nbsp;<span class="op" id="7415521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415525"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415526">.</span><span class="ident" id="7415527"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7415533">(</span><span class="string" id="7415534">&#34;expected&nbsp;Content-Type&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7415568">,</span>&nbsp;<span class="ident" id="7415570"><a href="/gostd/net/http/cgi/child_test.go.html#7415465">e</a></span><span class="op" id="7415571">,</span>&nbsp;<span class="ident" id="7415573"><a href="/gostd/net/http/cgi/child_test.go.html#7415462">g</a></span><span class="op" id="7415574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415580">if</span>&nbsp;<span class="ident" id="7415583">g</span><span class="op" id="7415584">,</span>&nbsp;<span class="ident" id="7415586">e</span>&nbsp;<span class="op" id="7415588">:=</span>&nbsp;<span class="ident" id="7415591"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415594">.</span><span class="ident" id="7415595"><a href="/gostd/net/http/request.go.html#4138292">ContentLength</a></span><span class="op" id="7415608">,</span>&nbsp;<span class="builtintype" id="7415610">int64</span><span class="op" id="7415615">(</span><span class="num" id="7415616">123</span><span class="op" id="7415619">)</span><span class="op" id="7415620">;</span>&nbsp;<span class="ident" id="7415622"><a href="/gostd/net/http/cgi/child_test.go.html#7415586">e</a></span>&nbsp;<span class="op" id="7415624">!=</span>&nbsp;<span class="ident" id="7415627"><a href="/gostd/net/http/cgi/child_test.go.html#7415583">g</a></span>&nbsp;<span class="op" id="7415629">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415633"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415634">.</span><span class="ident" id="7415635"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7415641">(</span><span class="string" id="7415642">&#34;expected&nbsp;ContentLength&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7415677">,</span>&nbsp;<span class="ident" id="7415679"><a href="/gostd/net/http/cgi/child_test.go.html#7415586">e</a></span><span class="op" id="7415680">,</span>&nbsp;<span class="ident" id="7415682"><a href="/gostd/net/http/cgi/child_test.go.html#7415583">g</a></span><span class="op" id="7415683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415689">if</span>&nbsp;<span class="ident" id="7415692">g</span><span class="op" id="7415693">,</span>&nbsp;<span class="ident" id="7415695">e</span>&nbsp;<span class="op" id="7415697">:=</span>&nbsp;<span class="ident" id="7415700"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415703">.</span><span class="ident" id="7415704"><a href="/gostd/net/http/request.go.html#4143681">Referer</a></span><span class="op" id="7415711">(</span><span class="op" id="7415712">)</span><span class="op" id="7415713">,</span>&nbsp;<span class="string" id="7415715">&#34;elsewhere&#34;</span><span class="op" id="7415726">;</span>&nbsp;<span class="ident" id="7415728"><a href="/gostd/net/http/cgi/child_test.go.html#7415695">e</a></span>&nbsp;<span class="op" id="7415730">!=</span>&nbsp;<span class="ident" id="7415733"><a href="/gostd/net/http/cgi/child_test.go.html#7415692">g</a></span>&nbsp;<span class="op" id="7415735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415739"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415740">.</span><span class="ident" id="7415741"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7415747">(</span><span class="string" id="7415748">&#34;expected&nbsp;Referer&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7415777">,</span>&nbsp;<span class="ident" id="7415779"><a href="/gostd/net/http/cgi/child_test.go.html#7415695">e</a></span><span class="op" id="7415780">,</span>&nbsp;<span class="ident" id="7415782"><a href="/gostd/net/http/cgi/child_test.go.html#7415692">g</a></span><span class="op" id="7415783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415786">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415789">if</span>&nbsp;<span class="ident" id="7415792"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415795">.</span><span class="ident" id="7415796"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span>&nbsp;<span class="op" id="7415803">==</span>&nbsp;<span class="builtintype" id="7415806">nil</span>&nbsp;<span class="op" id="7415810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415814"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415815">.</span><span class="ident" id="7415816"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7415822">(</span><span class="string" id="7415823">&#34;unexpected&nbsp;nil&nbsp;Header&#34;</span><span class="op" id="7415846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415852">if</span>&nbsp;<span class="ident" id="7415855">g</span><span class="op" id="7415856">,</span>&nbsp;<span class="ident" id="7415858">e</span>&nbsp;<span class="op" id="7415860">:=</span>&nbsp;<span class="ident" id="7415863"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415866">.</span><span class="ident" id="7415867"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="7415873">.</span><span class="ident" id="7415874"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="7415877">(</span><span class="string" id="7415878">&#34;Foo-Bar&#34;</span><span class="op" id="7415887">)</span><span class="op" id="7415888">,</span>&nbsp;<span class="string" id="7415890">&#34;baz&#34;</span><span class="op" id="7415895">;</span>&nbsp;<span class="ident" id="7415897"><a href="/gostd/net/http/cgi/child_test.go.html#7415858">e</a></span>&nbsp;<span class="op" id="7415899">!=</span>&nbsp;<span class="ident" id="7415902"><a href="/gostd/net/http/cgi/child_test.go.html#7415855">g</a></span>&nbsp;<span class="op" id="7415904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7415908"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7415909">.</span><span class="ident" id="7415910"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7415916">(</span><span class="string" id="7415917">&#34;expected&nbsp;Foo-Bar&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7415946">,</span>&nbsp;<span class="ident" id="7415948"><a href="/gostd/net/http/cgi/child_test.go.html#7415858">e</a></span><span class="op" id="7415949">,</span>&nbsp;<span class="ident" id="7415951"><a href="/gostd/net/http/cgi/child_test.go.html#7415855">g</a></span><span class="op" id="7415952">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7415955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7415958">if</span>&nbsp;<span class="ident" id="7415961">g</span><span class="op" id="7415962">,</span>&nbsp;<span class="ident" id="7415964">e</span>&nbsp;<span class="op" id="7415966">:=</span>&nbsp;<span class="ident" id="7415969"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7415972">.</span><span class="ident" id="7415973"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="7415976">.</span><span class="ident" id="7415977"><a href="/gostd/net/url/url.go.html#3757924">String</a></span><span class="op" id="7415983">(</span><span class="op" id="7415984">)</span><span class="op" id="7415985">,</span>&nbsp;<span class="string" id="7415987">&#34;http://example.com/path?a=b&#34;</span><span class="op" id="7416016">;</span>&nbsp;<span class="ident" id="7416018"><a href="/gostd/net/http/cgi/child_test.go.html#7415964">e</a></span>&nbsp;<span class="op" id="7416020">!=</span>&nbsp;<span class="ident" id="7416023"><a href="/gostd/net/http/cgi/child_test.go.html#7415961">g</a></span>&nbsp;<span class="op" id="7416025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416029"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7416030">.</span><span class="ident" id="7416031"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416037">(</span><span class="string" id="7416038">&#34;expected&nbsp;URL&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7416063">,</span>&nbsp;<span class="ident" id="7416065"><a href="/gostd/net/http/cgi/child_test.go.html#7415964">e</a></span><span class="op" id="7416066">,</span>&nbsp;<span class="ident" id="7416068"><a href="/gostd/net/http/cgi/child_test.go.html#7415961">g</a></span><span class="op" id="7416069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416075">if</span>&nbsp;<span class="ident" id="7416078">g</span><span class="op" id="7416079">,</span>&nbsp;<span class="ident" id="7416081">e</span>&nbsp;<span class="op" id="7416083">:=</span>&nbsp;<span class="ident" id="7416086"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7416089">.</span><span class="ident" id="7416090"><a href="/gostd/net/http/request.go.html#4159257">FormValue</a></span><span class="op" id="7416099">(</span><span class="string" id="7416100">&#34;a&#34;</span><span class="op" id="7416103">)</span><span class="op" id="7416104">,</span>&nbsp;<span class="string" id="7416106">&#34;b&#34;</span><span class="op" id="7416109">;</span>&nbsp;<span class="ident" id="7416111"><a href="/gostd/net/http/cgi/child_test.go.html#7416081">e</a></span>&nbsp;<span class="op" id="7416113">!=</span>&nbsp;<span class="ident" id="7416116"><a href="/gostd/net/http/cgi/child_test.go.html#7416078">g</a></span>&nbsp;<span class="op" id="7416118">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416122"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7416123">.</span><span class="ident" id="7416124"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416130">(</span><span class="string" id="7416131">&#34;expected&nbsp;FormValue(a)&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7416165">,</span>&nbsp;<span class="ident" id="7416167"><a href="/gostd/net/http/cgi/child_test.go.html#7416081">e</a></span><span class="op" id="7416168">,</span>&nbsp;<span class="ident" id="7416170"><a href="/gostd/net/http/cgi/child_test.go.html#7416078">g</a></span><span class="op" id="7416171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416177">if</span>&nbsp;<span class="ident" id="7416180"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7416183">.</span><span class="ident" id="7416184"><a href="/gostd/net/http/request.go.html#4140820">Trailer</a></span>&nbsp;<span class="op" id="7416192">==</span>&nbsp;<span class="builtintype" id="7416195">nil</span>&nbsp;<span class="op" id="7416199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416203"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7416204">.</span><span class="ident" id="7416205"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416211">(</span><span class="string" id="7416212">&#34;unexpected&nbsp;nil&nbsp;Trailer&#34;</span><span class="op" id="7416236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416239">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416242">if</span>&nbsp;<span class="ident" id="7416245"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7416248">.</span><span class="ident" id="7416249"><a href="/gostd/net/http/request.go.html#4141858">TLS</a></span>&nbsp;<span class="op" id="7416253">!=</span>&nbsp;<span class="builtintype" id="7416256">nil</span>&nbsp;<span class="op" id="7416260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416264"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7416265">.</span><span class="ident" id="7416266"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416272">(</span><span class="string" id="7416273">&#34;expected&nbsp;nil&nbsp;TLS&#34;</span><span class="op" id="7416291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416297">if</span>&nbsp;<span class="ident" id="7416300">e</span><span class="op" id="7416301">,</span>&nbsp;<span class="ident" id="7416303">g</span>&nbsp;<span class="op" id="7416305">:=</span>&nbsp;<span class="string" id="7416308">&#34;5.6.7.8:0&#34;</span><span class="op" id="7416319">,</span>&nbsp;<span class="ident" id="7416321"><a href="/gostd/net/http/cgi/child_test.go.html#7415175">req</a></span><span class="op" id="7416324">.</span><span class="ident" id="7416325"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span><span class="op" id="7416335">;</span>&nbsp;<span class="ident" id="7416337"><a href="/gostd/net/http/cgi/child_test.go.html#7416300">e</a></span>&nbsp;<span class="op" id="7416339">!=</span>&nbsp;<span class="ident" id="7416342"><a href="/gostd/net/http/cgi/child_test.go.html#7416303">g</a></span>&nbsp;<span class="op" id="7416344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416348"><a href="/gostd/net/http/cgi/child_test.go.html#7414809">t</a></span><span class="op" id="7416349">.</span><span class="ident" id="7416350"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416356">(</span><span class="string" id="7416357">&#34;RemoteAddr:&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7416386">,</span>&nbsp;<span class="ident" id="7416388"><a href="/gostd/net/http/cgi/child_test.go.html#7416303">g</a></span><span class="op" id="7416389">,</span>&nbsp;<span class="ident" id="7416391"><a href="/gostd/net/http/cgi/child_test.go.html#7416300">e</a></span><span class="op" id="7416392">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416395">}</span><br>
<span class="lineno"></span><span class="op" id="7416397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7416400">func</span>&nbsp;<span class="ident" id="7416405">TestRequestWithTLS</span><span class="op" id="7416423">(</span><span class="ident" id="7416424">t</span>&nbsp;<span class="op" id="7416426">*</span><span class="ident" id="7416427"><a href="/gostd/net/http/cgi/child_test.go.html#7414779">testing</a></span><span class="op" id="7416434">.</span><span class="ident" id="7416435"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7416436">)</span>&nbsp;<span class="op" id="7416438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416441">env</span>&nbsp;<span class="op" id="7416445">:=</span>&nbsp;<span class="keyword" id="7416448">map</span><span class="op" id="7416451">[</span><span class="builtintype" id="7416452">string</span><span class="op" id="7416458">]</span><span class="builtintype" id="7416459">string</span><span class="op" id="7416465">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416469">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7416486">:</span>&nbsp;<span class="string" id="7416488">&#34;HTTP/1.1&#34;</span><span class="op" id="7416498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416502">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7416518">:</span>&nbsp;&nbsp;<span class="string" id="7416521">&#34;GET&#34;</span><span class="op" id="7416526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416530">&#34;HTTP_HOST&#34;</span><span class="op" id="7416541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416549">&#34;example.com&#34;</span><span class="op" id="7416562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416566">&#34;HTTP_REFERER&#34;</span><span class="op" id="7416580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416585">&#34;elsewhere&#34;</span><span class="op" id="7416596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416600">&#34;REQUEST_URI&#34;</span><span class="op" id="7416613">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416619">&#34;/path?a=b&#34;</span><span class="op" id="7416630">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416634">&#34;CONTENT_TYPE&#34;</span><span class="op" id="7416648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416653">&#34;text/xml&#34;</span><span class="op" id="7416663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416667">&#34;HTTPS&#34;</span><span class="op" id="7416674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416686">&#34;1&#34;</span><span class="op" id="7416689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416693">&#34;REMOTE_ADDR&#34;</span><span class="op" id="7416706">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7416712">&#34;5.6.7.8&#34;</span><span class="op" id="7416721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416727">req</span><span class="op" id="7416730">,</span>&nbsp;<span class="ident" id="7416732">err</span>&nbsp;<span class="op" id="7416736">:=</span>&nbsp;<span class="ident" id="7416739"><a href="/gostd/net/http/cgi/child.go.html#5690647">RequestFromMap</a></span><span class="op" id="7416753">(</span><span class="ident" id="7416754"><a href="/gostd/net/http/cgi/child_test.go.html#7416441">env</a></span><span class="op" id="7416757">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416760">if</span>&nbsp;<span class="ident" id="7416763"><a href="/gostd/net/http/cgi/child_test.go.html#7416732">err</a></span>&nbsp;<span class="op" id="7416767">!=</span>&nbsp;<span class="builtintype" id="7416770">nil</span>&nbsp;<span class="op" id="7416774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416778"><a href="/gostd/net/http/cgi/child_test.go.html#7416424">t</a></span><span class="op" id="7416779">.</span><span class="ident" id="7416780"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7416786">(</span><span class="string" id="7416787">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7416807">,</span>&nbsp;<span class="ident" id="7416809"><a href="/gostd/net/http/cgi/child_test.go.html#7416732">err</a></span><span class="op" id="7416812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416818">if</span>&nbsp;<span class="ident" id="7416821">g</span><span class="op" id="7416822">,</span>&nbsp;<span class="ident" id="7416824">e</span>&nbsp;<span class="op" id="7416826">:=</span>&nbsp;<span class="ident" id="7416829"><a href="/gostd/net/http/cgi/child_test.go.html#7416727">req</a></span><span class="op" id="7416832">.</span><span class="ident" id="7416833"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="7416836">.</span><span class="ident" id="7416837"><a href="/gostd/net/url/url.go.html#3757924">String</a></span><span class="op" id="7416843">(</span><span class="op" id="7416844">)</span><span class="op" id="7416845">,</span>&nbsp;<span class="string" id="7416847">&#34;https://example.com/path?a=b&#34;</span><span class="op" id="7416877">;</span>&nbsp;<span class="ident" id="7416879"><a href="/gostd/net/http/cgi/child_test.go.html#7416824">e</a></span>&nbsp;<span class="op" id="7416881">!=</span>&nbsp;<span class="ident" id="7416884"><a href="/gostd/net/http/cgi/child_test.go.html#7416821">g</a></span>&nbsp;<span class="op" id="7416886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416890"><a href="/gostd/net/http/cgi/child_test.go.html#7416424">t</a></span><span class="op" id="7416891">.</span><span class="ident" id="7416892"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416898">(</span><span class="string" id="7416899">&#34;expected&nbsp;URL&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7416924">,</span>&nbsp;<span class="ident" id="7416926"><a href="/gostd/net/http/cgi/child_test.go.html#7416824">e</a></span><span class="op" id="7416927">,</span>&nbsp;<span class="ident" id="7416929"><a href="/gostd/net/http/cgi/child_test.go.html#7416821">g</a></span><span class="op" id="7416930">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7416936">if</span>&nbsp;<span class="ident" id="7416939"><a href="/gostd/net/http/cgi/child_test.go.html#7416727">req</a></span><span class="op" id="7416942">.</span><span class="ident" id="7416943"><a href="/gostd/net/http/request.go.html#4141858">TLS</a></span>&nbsp;<span class="op" id="7416947">==</span>&nbsp;<span class="builtintype" id="7416950">nil</span>&nbsp;<span class="op" id="7416954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416958"><a href="/gostd/net/http/cgi/child_test.go.html#7416424">t</a></span><span class="op" id="7416959">.</span><span class="ident" id="7416960"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7416966">(</span><span class="string" id="7416967">&#34;expected&nbsp;non-nil&nbsp;TLS&#34;</span><span class="op" id="7416989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7416992">}</span><br>
<span class="lineno"></span><span class="op" id="7416994">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7416997">func</span>&nbsp;<span class="ident" id="7417002">TestRequestWithoutHost</span><span class="op" id="7417024">(</span><span class="ident" id="7417025">t</span>&nbsp;<span class="op" id="7417027">*</span><span class="ident" id="7417028"><a href="/gostd/net/http/cgi/child_test.go.html#7414779">testing</a></span><span class="op" id="7417035">.</span><span class="ident" id="7417036"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7417037">)</span>&nbsp;<span class="op" id="7417039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417042">env</span>&nbsp;<span class="op" id="7417046">:=</span>&nbsp;<span class="keyword" id="7417049">map</span><span class="op" id="7417052">[</span><span class="builtintype" id="7417053">string</span><span class="op" id="7417059">]</span><span class="builtintype" id="7417060">string</span><span class="op" id="7417066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417070">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7417087">:</span>&nbsp;<span class="string" id="7417089">&#34;HTTP/1.1&#34;</span><span class="op" id="7417099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417103">&#34;HTTP_HOST&#34;</span><span class="op" id="7417114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417122">&#34;&#34;</span><span class="op" id="7417124">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417128">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7417144">:</span>&nbsp;&nbsp;<span class="string" id="7417147">&#34;GET&#34;</span><span class="op" id="7417152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417156">&#34;REQUEST_URI&#34;</span><span class="op" id="7417169">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417175">&#34;/path?a=b&#34;</span><span class="op" id="7417186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417190">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="7417206">:</span>&nbsp;&nbsp;<span class="string" id="7417209">&#34;123&#34;</span><span class="op" id="7417214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417220">req</span><span class="op" id="7417223">,</span>&nbsp;<span class="ident" id="7417225">err</span>&nbsp;<span class="op" id="7417229">:=</span>&nbsp;<span class="ident" id="7417232"><a href="/gostd/net/http/cgi/child.go.html#5690647">RequestFromMap</a></span><span class="op" id="7417246">(</span><span class="ident" id="7417247"><a href="/gostd/net/http/cgi/child_test.go.html#7417042">env</a></span><span class="op" id="7417250">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7417253">if</span>&nbsp;<span class="ident" id="7417256"><a href="/gostd/net/http/cgi/child_test.go.html#7417225">err</a></span>&nbsp;<span class="op" id="7417260">!=</span>&nbsp;<span class="builtintype" id="7417263">nil</span>&nbsp;<span class="op" id="7417267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417271"><a href="/gostd/net/http/cgi/child_test.go.html#7417025">t</a></span><span class="op" id="7417272">.</span><span class="ident" id="7417273"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7417279">(</span><span class="string" id="7417280">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7417300">,</span>&nbsp;<span class="ident" id="7417302"><a href="/gostd/net/http/cgi/child_test.go.html#7417225">err</a></span><span class="op" id="7417305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7417311">if</span>&nbsp;<span class="ident" id="7417314"><a href="/gostd/net/http/cgi/child_test.go.html#7417220">req</a></span><span class="op" id="7417317">.</span><span class="ident" id="7417318"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span>&nbsp;<span class="op" id="7417322">==</span>&nbsp;<span class="builtintype" id="7417325">nil</span>&nbsp;<span class="op" id="7417329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417333"><a href="/gostd/net/http/cgi/child_test.go.html#7417025">t</a></span><span class="op" id="7417334">.</span><span class="ident" id="7417335"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7417341">(</span><span class="string" id="7417342">&#34;unexpected&nbsp;nil&nbsp;URL&#34;</span><span class="op" id="7417362">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7417368">if</span>&nbsp;<span class="ident" id="7417371">g</span><span class="op" id="7417372">,</span>&nbsp;<span class="ident" id="7417374">e</span>&nbsp;<span class="op" id="7417376">:=</span>&nbsp;<span class="ident" id="7417379"><a href="/gostd/net/http/cgi/child_test.go.html#7417220">req</a></span><span class="op" id="7417382">.</span><span class="ident" id="7417383"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="7417386">.</span><span class="ident" id="7417387"><a href="/gostd/net/url/url.go.html#3757924">String</a></span><span class="op" id="7417393">(</span><span class="op" id="7417394">)</span><span class="op" id="7417395">,</span>&nbsp;<span class="string" id="7417397">&#34;/path?a=b&#34;</span><span class="op" id="7417408">;</span>&nbsp;<span class="ident" id="7417410"><a href="/gostd/net/http/cgi/child_test.go.html#7417374">e</a></span>&nbsp;<span class="op" id="7417412">!=</span>&nbsp;<span class="ident" id="7417415"><a href="/gostd/net/http/cgi/child_test.go.html#7417371">g</a></span>&nbsp;<span class="op" id="7417417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417421"><a href="/gostd/net/http/cgi/child_test.go.html#7417025">t</a></span><span class="op" id="7417422">.</span><span class="ident" id="7417423"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7417429">(</span><span class="string" id="7417430">&#34;URL&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7417449">,</span>&nbsp;<span class="ident" id="7417451"><a href="/gostd/net/http/cgi/child_test.go.html#7417371">g</a></span><span class="op" id="7417452">,</span>&nbsp;<span class="ident" id="7417454"><a href="/gostd/net/http/cgi/child_test.go.html#7417374">e</a></span><span class="op" id="7417455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417458">}</span><br>
<span class="lineno"></span><span class="op" id="7417460">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="7417463">func</span>&nbsp;<span class="ident" id="7417468">TestRequestWithoutRequestURI</span><span class="op" id="7417496">(</span><span class="ident" id="7417497">t</span>&nbsp;<span class="op" id="7417499">*</span><span class="ident" id="7417500"><a href="/gostd/net/http/cgi/child_test.go.html#7414779">testing</a></span><span class="op" id="7417507">.</span><span class="ident" id="7417508"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7417509">)</span>&nbsp;<span class="op" id="7417511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417514">env</span>&nbsp;<span class="op" id="7417518">:=</span>&nbsp;<span class="keyword" id="7417521">map</span><span class="op" id="7417524">[</span><span class="builtintype" id="7417525">string</span><span class="op" id="7417531">]</span><span class="builtintype" id="7417532">string</span><span class="op" id="7417538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417542">&#34;SERVER_PROTOCOL&#34;</span><span class="op" id="7417559">:</span>&nbsp;<span class="string" id="7417561">&#34;HTTP/1.1&#34;</span><span class="op" id="7417571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417575">&#34;HTTP_HOST&#34;</span><span class="op" id="7417586">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417594">&#34;example.com&#34;</span><span class="op" id="7417607">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417611">&#34;REQUEST_METHOD&#34;</span><span class="op" id="7417627">:</span>&nbsp;&nbsp;<span class="string" id="7417630">&#34;GET&#34;</span><span class="op" id="7417635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417639">&#34;SCRIPT_NAME&#34;</span><span class="op" id="7417652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417658">&#34;/dir/scriptname&#34;</span><span class="op" id="7417675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417679">&#34;PATH_INFO&#34;</span><span class="op" id="7417690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417698">&#34;/p1/p2&#34;</span><span class="op" id="7417706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417710">&#34;QUERY_STRING&#34;</span><span class="op" id="7417724">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417729">&#34;a=1&amp;b=2&#34;</span><span class="op" id="7417738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7417742">&#34;CONTENT_LENGTH&#34;</span><span class="op" id="7417758">:</span>&nbsp;&nbsp;<span class="string" id="7417761">&#34;123&#34;</span><span class="op" id="7417766">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417772">req</span><span class="op" id="7417775">,</span>&nbsp;<span class="ident" id="7417777">err</span>&nbsp;<span class="op" id="7417781">:=</span>&nbsp;<span class="ident" id="7417784"><a href="/gostd/net/http/cgi/child.go.html#5690647">RequestFromMap</a></span><span class="op" id="7417798">(</span><span class="ident" id="7417799"><a href="/gostd/net/http/cgi/child_test.go.html#7417514">env</a></span><span class="op" id="7417802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7417805">if</span>&nbsp;<span class="ident" id="7417808"><a href="/gostd/net/http/cgi/child_test.go.html#7417777">err</a></span>&nbsp;<span class="op" id="7417812">!=</span>&nbsp;<span class="builtintype" id="7417815">nil</span>&nbsp;<span class="op" id="7417819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417823"><a href="/gostd/net/http/cgi/child_test.go.html#7417497">t</a></span><span class="op" id="7417824">.</span><span class="ident" id="7417825"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7417831">(</span><span class="string" id="7417832">&#34;RequestFromMap:&nbsp;%v&#34;</span><span class="op" id="7417852">,</span>&nbsp;<span class="ident" id="7417854"><a href="/gostd/net/http/cgi/child_test.go.html#7417777">err</a></span><span class="op" id="7417857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417860">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7417863">if</span>&nbsp;<span class="ident" id="7417866"><a href="/gostd/net/http/cgi/child_test.go.html#7417772">req</a></span><span class="op" id="7417869">.</span><span class="ident" id="7417870"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span>&nbsp;<span class="op" id="7417874">==</span>&nbsp;<span class="builtintype" id="7417877">nil</span>&nbsp;<span class="op" id="7417881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7417885"><a href="/gostd/net/http/cgi/child_test.go.html#7417497">t</a></span><span class="op" id="7417886">.</span><span class="ident" id="7417887"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7417893">(</span><span class="string" id="7417894">&#34;unexpected&nbsp;nil&nbsp;URL&#34;</span><span class="op" id="7417914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7417917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7417920">if</span>&nbsp;<span class="ident" id="7417923">g</span><span class="op" id="7417924">,</span>&nbsp;<span class="ident" id="7417926">e</span>&nbsp;<span class="op" id="7417928">:=</span>&nbsp;<span class="ident" id="7417931"><a href="/gostd/net/http/cgi/child_test.go.html#7417772">req</a></span><span class="op" id="7417934">.</span><span class="ident" id="7417935"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="7417938">.</span><span class="ident" id="7417939"><a href="/gostd/net/url/url.go.html#3757924">String</a></span><span class="op" id="7417945">(</span><span class="op" id="7417946">)</span><span class="op" id="7417947">,</span>&nbsp;<span class="string" id="7417949">&#34;http://example.com/dir/scriptname/p1/p2?a=1&amp;b=2&#34;</span><span class="op" id="7417998">;</span>&nbsp;<span class="ident" id="7418000"><a href="/gostd/net/http/cgi/child_test.go.html#7417926">e</a></span>&nbsp;<span class="op" id="7418002">!=</span>&nbsp;<span class="ident" id="7418005"><a href="/gostd/net/http/cgi/child_test.go.html#7417923">g</a></span>&nbsp;<span class="op" id="7418007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7418011"><a href="/gostd/net/http/cgi/child_test.go.html#7417497">t</a></span><span class="op" id="7418012">.</span><span class="ident" id="7418013"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7418019">(</span><span class="string" id="7418020">&#34;URL&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7418039">,</span>&nbsp;<span class="ident" id="7418041"><a href="/gostd/net/http/cgi/child_test.go.html#7417923">g</a></span><span class="op" id="7418042">,</span>&nbsp;<span class="ident" id="7418044"><a href="/gostd/net/http/cgi/child_test.go.html#7417926">e</a></span><span class="op" id="7418045">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7418048">}</span><br>
<span class="lineno"></span><span class="op" id="7418050">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
