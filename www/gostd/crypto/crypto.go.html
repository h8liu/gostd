<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3935116">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3935171">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3935225">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3935276">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3935335">package</span>&nbsp;<span class="ident" id="3935343">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3935351">import</span>&nbsp;<span class="op" id="3935358">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3935361">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3935369">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3935375">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3935385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3935388">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3935468">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3935480">type</span>&nbsp;<span class="ident" id="3935485">Hash</span>&nbsp;<span class="builtintype" id="3935490">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3935496">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3935574">func</span>&nbsp;<span class="op" id="3935579">(</span><span class="ident" id="3935580">h</span>&nbsp;<span class="ident" id="3935582">Hash</span><span class="op" id="3935586">)</span>&nbsp;<span class="ident" id="3935588">HashFunc</span><span class="op" id="3935596">(</span><span class="op" id="3935597">)</span>&nbsp;<span class="ident" id="3935599">Hash</span>&nbsp;<span class="op" id="3935604">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3935607">return</span>&nbsp;<span class="ident" id="3935614">h</span><br>
<span class="lineno"></span><span class="op" id="3935616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3935619">const</span>&nbsp;<span class="op" id="3935625">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935628">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935638">Hash</span>&nbsp;<span class="op" id="3935643">=</span>&nbsp;<span class="num" id="3935645">1</span>&nbsp;<span class="op" id="3935647">+</span>&nbsp;<span class="ident" id="3935649">iota</span>&nbsp;<span class="comment" id="3935654">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935689">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935715">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935737">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935763">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935786">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935812">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935837">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935863">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935888">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935914">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935939">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935965">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3935990">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936016">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936065">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936091">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936132">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936158">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936194">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936220">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936256">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936282">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936318">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3936344">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936380">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3936388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3936391">var</span>&nbsp;<span class="ident" id="3936395">digestSizes</span>&nbsp;<span class="op" id="3936407">=</span>&nbsp;<span class="op" id="3936409">[</span><span class="op" id="3936410">]</span><span class="builtintype" id="3936411">uint8</span><span class="op" id="3936416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936419">MD4</span><span class="op" id="3936422">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936430">16</span><span class="op" id="3936432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936435">MD5</span><span class="op" id="3936438">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936446">16</span><span class="op" id="3936448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936451">SHA1</span><span class="op" id="3936455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936462">20</span><span class="op" id="3936464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936467">SHA224</span><span class="op" id="3936473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936478">28</span><span class="op" id="3936480">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936483">SHA256</span><span class="op" id="3936489">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936494">32</span><span class="op" id="3936496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936499">SHA384</span><span class="op" id="3936505">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936510">48</span><span class="op" id="3936512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936515">SHA512</span><span class="op" id="3936521">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3936526">64</span><span class="op" id="3936528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936531">SHA3_224</span><span class="op" id="3936539">:</span>&nbsp;&nbsp;<span class="num" id="3936542">28</span><span class="op" id="3936544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936547">SHA3_256</span><span class="op" id="3936555">:</span>&nbsp;&nbsp;<span class="num" id="3936558">32</span><span class="op" id="3936560">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936563">SHA3_384</span><span class="op" id="3936571">:</span>&nbsp;&nbsp;<span class="num" id="3936574">48</span><span class="op" id="3936576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936579">SHA3_512</span><span class="op" id="3936587">:</span>&nbsp;&nbsp;<span class="num" id="3936590">64</span><span class="op" id="3936592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936595">MD5SHA1</span><span class="op" id="3936602">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3936606">36</span><span class="op" id="3936608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3936611">RIPEMD160</span><span class="op" id="3936620">:</span>&nbsp;<span class="num" id="3936622">20</span><span class="op" id="3936624">,</span><br>
<span class="lineno"></span><span class="op" id="3936626">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3936629">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3936709">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3936786">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3936807">func</span>&nbsp;<span class="op" id="3936812">(</span><span class="ident" id="3936813">h</span>&nbsp;<span class="ident" id="3936815">Hash</span><span class="op" id="3936819">)</span>&nbsp;<span class="ident" id="3936821">Size</span><span class="op" id="3936825">(</span><span class="op" id="3936826">)</span>&nbsp;<span class="builtintype" id="3936828">int</span>&nbsp;<span class="op" id="3936832">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3936835">if</span>&nbsp;<span class="ident" id="3936838">h</span>&nbsp;<span class="op" id="3936840">&gt;</span>&nbsp;<span class="num" id="3936842">0</span>&nbsp;<span class="op" id="3936844">&amp;&amp;</span>&nbsp;<span class="ident" id="3936847">h</span>&nbsp;<span class="op" id="3936849">&lt;</span>&nbsp;<span class="ident" id="3936851">maxHash</span>&nbsp;<span class="op" id="3936859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3936863">return</span>&nbsp;<span class="builtintype" id="3936870">int</span><span class="op" id="3936873">(</span><span class="ident" id="3936874">digestSizes</span><span class="op" id="3936885">[</span><span class="ident" id="3936886">h</span><span class="op" id="3936887">]</span><span class="op" id="3936888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3936891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3936894">panic</span><span class="op" id="3936899">(</span><span class="string" id="3936900">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3936939">)</span><br>
<span class="lineno"></span><span class="op" id="3936941">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3936944">var</span>&nbsp;<span class="ident" id="3936948">hashes</span>&nbsp;<span class="op" id="3936955">=</span>&nbsp;<span class="builtinfunc" id="3936957">make</span><span class="op" id="3936961">(</span><span class="op" id="3936962">[</span><span class="op" id="3936963">]</span><span class="keyword" id="3936964">func</span><span class="op" id="3936968">(</span><span class="op" id="3936969">)</span>&nbsp;<span class="ident" id="3936971">hash</span><span class="op" id="3936975">.</span><span class="ident" id="3936976">Hash</span><span class="op" id="3936980">,</span>&nbsp;<span class="ident" id="3936982">maxHash</span><span class="op" id="3936989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3936992">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3937071">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3937126">func</span>&nbsp;<span class="op" id="3937131">(</span><span class="ident" id="3937132">h</span>&nbsp;<span class="ident" id="3937134">Hash</span><span class="op" id="3937138">)</span>&nbsp;<span class="ident" id="3937140">New</span><span class="op" id="3937143">(</span><span class="op" id="3937144">)</span>&nbsp;<span class="ident" id="3937146">hash</span><span class="op" id="3937150">.</span><span class="ident" id="3937151">Hash</span>&nbsp;<span class="op" id="3937156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937159">if</span>&nbsp;<span class="ident" id="3937162">h</span>&nbsp;<span class="op" id="3937164">&gt;</span>&nbsp;<span class="num" id="3937166">0</span>&nbsp;<span class="op" id="3937168">&amp;&amp;</span>&nbsp;<span class="ident" id="3937171">h</span>&nbsp;<span class="op" id="3937173">&lt;</span>&nbsp;<span class="ident" id="3937175">maxHash</span>&nbsp;<span class="op" id="3937183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937187">f</span>&nbsp;<span class="op" id="3937189">:=</span>&nbsp;<span class="ident" id="3937192">hashes</span><span class="op" id="3937198">[</span><span class="ident" id="3937199">h</span><span class="op" id="3937200">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937204">if</span>&nbsp;<span class="ident" id="3937207">f</span>&nbsp;<span class="op" id="3937209">!=</span>&nbsp;<span class="ident" id="3937212">nil</span>&nbsp;<span class="op" id="3937216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937221">return</span>&nbsp;<span class="ident" id="3937228">f</span><span class="op" id="3937229">(</span><span class="op" id="3937230">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3937234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3937237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3937240">panic</span><span class="op" id="3937245">(</span><span class="string" id="3937246">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3937282">+</span>&nbsp;<span class="ident" id="3937284">strconv</span><span class="op" id="3937291">.</span><span class="ident" id="3937292">Itoa</span><span class="op" id="3937296">(</span><span class="builtintype" id="3937297">int</span><span class="op" id="3937300">(</span><span class="ident" id="3937301">h</span><span class="op" id="3937302">)</span><span class="op" id="3937303">)</span>&nbsp;<span class="op" id="3937305">+</span>&nbsp;<span class="string" id="3937307">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3937324">)</span><br>
<span class="lineno"></span><span class="op" id="3937326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3937329">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3937409">func</span>&nbsp;<span class="op" id="3937414">(</span><span class="ident" id="3937415">h</span>&nbsp;<span class="ident" id="3937417">Hash</span><span class="op" id="3937421">)</span>&nbsp;<span class="ident" id="3937423">Available</span><span class="op" id="3937432">(</span><span class="op" id="3937433">)</span>&nbsp;<span class="builtintype" id="3937435">bool</span>&nbsp;<span class="op" id="3937440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937443">return</span>&nbsp;<span class="ident" id="3937450">h</span>&nbsp;<span class="op" id="3937452">&lt;</span>&nbsp;<span class="ident" id="3937454">maxHash</span>&nbsp;<span class="op" id="3937462">&amp;&amp;</span>&nbsp;<span class="ident" id="3937465">hashes</span><span class="op" id="3937471">[</span><span class="ident" id="3937472">h</span><span class="op" id="3937473">]</span>&nbsp;<span class="op" id="3937475">!=</span>&nbsp;<span class="ident" id="3937478">nil</span><br>
<span class="lineno"></span><span class="op" id="3937482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3937485">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3937563">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3937637">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3937680">func</span>&nbsp;<span class="ident" id="3937685">RegisterHash</span><span class="op" id="3937697">(</span><span class="ident" id="3937698">h</span>&nbsp;<span class="ident" id="3937700">Hash</span><span class="op" id="3937704">,</span>&nbsp;<span class="ident" id="3937706">f</span>&nbsp;<span class="keyword" id="3937708">func</span><span class="op" id="3937712">(</span><span class="op" id="3937713">)</span>&nbsp;<span class="ident" id="3937715">hash</span><span class="op" id="3937719">.</span><span class="ident" id="3937720">Hash</span><span class="op" id="3937724">)</span>&nbsp;<span class="op" id="3937726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3937729">if</span>&nbsp;<span class="ident" id="3937732">h</span>&nbsp;<span class="op" id="3937734">&gt;=</span>&nbsp;<span class="ident" id="3937737">maxHash</span>&nbsp;<span class="op" id="3937745">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3937749">panic</span><span class="op" id="3937754">(</span><span class="string" id="3937755">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3937802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3937805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3937808">hashes</span><span class="op" id="3937814">[</span><span class="ident" id="3937815">h</span><span class="op" id="3937816">]</span>&nbsp;<span class="op" id="3937818">=</span>&nbsp;<span class="ident" id="3937820">f</span><br>
<span class="lineno"></span><span class="op" id="3937822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3937825">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3937894">type</span>&nbsp;<span class="ident" id="3937899">PublicKey</span>&nbsp;<span class="keyword" id="3937909">interface</span><span class="op" id="3937918">{</span><span class="op" id="3937919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3937922">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3937993">type</span>&nbsp;<span class="ident" id="3937998">PrivateKey</span>&nbsp;<span class="keyword" id="3938009">interface</span><span class="op" id="3938018">{</span><span class="op" id="3938019">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3938022">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3938095">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3938169">type</span>&nbsp;<span class="ident" id="3938174">Signer</span>&nbsp;<span class="keyword" id="3938181">interface</span>&nbsp;<span class="op" id="3938191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938194">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938257">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938274">Public</span><span class="op" id="3938280">(</span><span class="op" id="3938281">)</span>&nbsp;<span class="ident" id="3938283">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938295">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938364">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938433">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938505">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938572">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938576">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938649">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938722">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3938790">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3938862">Sign</span><span class="op" id="3938866">(</span><span class="ident" id="3938867">rand</span>&nbsp;<span class="ident" id="3938872">io</span><span class="op" id="3938874">.</span><span class="ident" id="3938875">Reader</span><span class="op" id="3938881">,</span>&nbsp;<span class="ident" id="3938883">msg</span>&nbsp;<span class="op" id="3938887">[</span><span class="op" id="3938888">]</span><span class="builtintype" id="3938889">byte</span><span class="op" id="3938893">,</span>&nbsp;<span class="ident" id="3938895">opts</span>&nbsp;<span class="ident" id="3938900">SignerOpts</span><span class="op" id="3938910">)</span>&nbsp;<span class="op" id="3938912">(</span><span class="ident" id="3938913">signature</span>&nbsp;<span class="op" id="3938923">[</span><span class="op" id="3938924">]</span><span class="builtintype" id="3938925">byte</span><span class="op" id="3938929">,</span>&nbsp;<span class="ident" id="3938931">err</span>&nbsp;<span class="builtintype" id="3938935">error</span><span class="op" id="3938940">)</span><br>
<span class="lineno"></span><span class="op" id="3938942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3938945">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3939003">type</span>&nbsp;<span class="ident" id="3939008">SignerOpts</span>&nbsp;<span class="keyword" id="3939019">interface</span>&nbsp;<span class="op" id="3939029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939032">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939105">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3939177">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3939199">HashFunc</span><span class="op" id="3939207">(</span><span class="op" id="3939208">)</span>&nbsp;<span class="ident" id="3939210">Hash</span><br>
<span class="lineno"></span><span class="op" id="3939215">}</span>
</div>
</body>
</html>
