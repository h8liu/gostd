<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3269428">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3269484">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3269538">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3269589">package</span>&nbsp;<span class="ident" id="3269597">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3269602">import</span>&nbsp;<span class="op" id="3269609">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3269612">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3269618">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3269624">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3269634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269637">//&nbsp;maxSendfileSize&nbsp;is&nbsp;the&nbsp;largest&nbsp;chunk&nbsp;size&nbsp;we&nbsp;ask&nbsp;the&nbsp;kernel&nbsp;to&nbsp;copy</span><br>
<span class="lineno"></span><span class="comment" id="3269708">//&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno">15</span><span class="keyword" id="3269722">const</span>&nbsp;<span class="ident" id="3269728">maxSendfileSize</span>&nbsp;<span class="builtintype" id="3269744">int</span>&nbsp;<span class="op" id="3269748">=</span>&nbsp;<span class="num" id="3269750">4</span>&nbsp;<span class="op" id="3269752">&lt;&lt;</span>&nbsp;<span class="num" id="3269755">20</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3269759">//&nbsp;sendFile&nbsp;copies&nbsp;the&nbsp;contents&nbsp;of&nbsp;r&nbsp;to&nbsp;c&nbsp;using&nbsp;the&nbsp;sendfile</span><br>
<span class="lineno"></span><span class="comment" id="3269820">//&nbsp;system&nbsp;call&nbsp;to&nbsp;minimize&nbsp;copies.</span><br>
<span class="lineno"></span><span class="comment" id="3269855">//</span><br>
<span class="lineno">20</span><span class="comment" id="3269858">//&nbsp;if&nbsp;handled&nbsp;==&nbsp;true,&nbsp;sendFile&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="3269933">//&nbsp;non-EOF&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3269951">//</span><br>
<span class="lineno"></span><span class="comment" id="3269954">//&nbsp;if&nbsp;handled&nbsp;==&nbsp;false,&nbsp;sendFile&nbsp;performed&nbsp;no&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="3270006">func</span>&nbsp;<span class="ident" id="3270011">sendFile</span><span class="op" id="3270019">(</span><span class="ident" id="3270020">c</span>&nbsp;<span class="op" id="3270022">*</span><span class="ident" id="3270023">netFD</span><span class="op" id="3270028">,</span>&nbsp;<span class="ident" id="3270030">r</span>&nbsp;<span class="ident" id="3270032">io</span><span class="op" id="3270034">.</span><span class="ident" id="3270035">Reader</span><span class="op" id="3270041">)</span>&nbsp;<span class="op" id="3270043">(</span><span class="ident" id="3270044">written</span>&nbsp;<span class="ident" id="3270052">int64</span><span class="op" id="3270057">,</span>&nbsp;<span class="ident" id="3270059">err</span>&nbsp;<span class="builtintype" id="3270063">error</span><span class="op" id="3270068">,</span>&nbsp;<span class="ident" id="3270070">handled</span>&nbsp;<span class="builtintype" id="3270078">bool</span><span class="op" id="3270082">)</span>&nbsp;<span class="op" id="3270084">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270087">var</span>&nbsp;<span class="ident" id="3270091">remain</span>&nbsp;<span class="ident" id="3270098">int64</span>&nbsp;<span class="op" id="3270104">=</span>&nbsp;<span class="num" id="3270106">1</span>&nbsp;<span class="op" id="3270108">&lt;&lt;</span>&nbsp;<span class="num" id="3270111">62</span>&nbsp;<span class="comment" id="3270114">//&nbsp;by&nbsp;default,&nbsp;copy&nbsp;until&nbsp;EOF</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270146">lr</span><span class="op" id="3270148">,</span>&nbsp;<span class="ident" id="3270150">ok</span>&nbsp;<span class="op" id="3270153">:=</span>&nbsp;<span class="ident" id="3270156">r</span><span class="op" id="3270157">.</span><span class="op" id="3270158">(</span><span class="op" id="3270159">*</span><span class="ident" id="3270160">io</span><span class="op" id="3270162">.</span><span class="ident" id="3270163">LimitedReader</span><span class="op" id="3270176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270179">if</span>&nbsp;<span class="ident" id="3270182">ok</span>&nbsp;<span class="op" id="3270185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270189">remain</span><span class="op" id="3270195">,</span>&nbsp;<span class="ident" id="3270197">r</span>&nbsp;<span class="op" id="3270199">=</span>&nbsp;<span class="ident" id="3270201">lr</span><span class="op" id="3270203">.</span><span class="ident" id="3270204">N</span><span class="op" id="3270205">,</span>&nbsp;<span class="ident" id="3270207">lr</span><span class="op" id="3270209">.</span><span class="ident" id="3270210">R</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270214">if</span>&nbsp;<span class="ident" id="3270217">remain</span>&nbsp;<span class="op" id="3270224">&lt;=</span>&nbsp;<span class="num" id="3270227">0</span>&nbsp;<span class="op" id="3270229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270234">return</span>&nbsp;<span class="num" id="3270241">0</span><span class="op" id="3270242">,</span>&nbsp;<span class="ident" id="3270244">nil</span><span class="op" id="3270247">,</span>&nbsp;<span class="builtintype" id="3270249">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270262">f</span><span class="op" id="3270263">,</span>&nbsp;<span class="ident" id="3270265">ok</span>&nbsp;<span class="op" id="3270268">:=</span>&nbsp;<span class="ident" id="3270271">r</span><span class="op" id="3270272">.</span><span class="op" id="3270273">(</span><span class="op" id="3270274">*</span><span class="ident" id="3270275">os</span><span class="op" id="3270277">.</span><span class="ident" id="3270278">File</span><span class="op" id="3270282">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270285">if</span>&nbsp;<span class="op" id="3270288">!</span><span class="ident" id="3270289">ok</span>&nbsp;<span class="op" id="3270292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270296">return</span>&nbsp;<span class="num" id="3270303">0</span><span class="op" id="3270304">,</span>&nbsp;<span class="ident" id="3270306">nil</span><span class="op" id="3270309">,</span>&nbsp;<span class="builtintype" id="3270311">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270322">if</span>&nbsp;<span class="ident" id="3270325">err</span>&nbsp;<span class="op" id="3270329">:=</span>&nbsp;<span class="ident" id="3270332">c</span><span class="op" id="3270333">.</span><span class="ident" id="3270334">writeLock</span><span class="op" id="3270343">(</span><span class="op" id="3270344">)</span><span class="op" id="3270345">;</span>&nbsp;<span class="ident" id="3270347">err</span>&nbsp;<span class="op" id="3270351">!=</span>&nbsp;<span class="ident" id="3270354">nil</span>&nbsp;<span class="op" id="3270358">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270362">return</span>&nbsp;<span class="num" id="3270369">0</span><span class="op" id="3270370">,</span>&nbsp;<span class="ident" id="3270372">err</span><span class="op" id="3270375">,</span>&nbsp;<span class="builtintype" id="3270377">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270386">defer</span>&nbsp;<span class="ident" id="3270392">c</span><span class="op" id="3270393">.</span><span class="ident" id="3270394">writeUnlock</span><span class="op" id="3270405">(</span><span class="op" id="3270406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270410">dst</span>&nbsp;<span class="op" id="3270414">:=</span>&nbsp;<span class="ident" id="3270417">c</span><span class="op" id="3270418">.</span><span class="ident" id="3270419">sysfd</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270426">src</span>&nbsp;<span class="op" id="3270430">:=</span>&nbsp;<span class="builtintype" id="3270433">int</span><span class="op" id="3270436">(</span><span class="ident" id="3270437">f</span><span class="op" id="3270438">.</span><span class="ident" id="3270439">Fd</span><span class="op" id="3270441">(</span><span class="op" id="3270442">)</span><span class="op" id="3270443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270446">for</span>&nbsp;<span class="ident" id="3270450">remain</span>&nbsp;<span class="op" id="3270457">&gt;</span>&nbsp;<span class="num" id="3270459">0</span>&nbsp;<span class="op" id="3270461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270465">n</span>&nbsp;<span class="op" id="3270467">:=</span>&nbsp;<span class="ident" id="3270470">maxSendfileSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270488">if</span>&nbsp;<span class="ident" id="3270491">int64</span><span class="op" id="3270496">(</span><span class="ident" id="3270497">n</span><span class="op" id="3270498">)</span>&nbsp;<span class="op" id="3270500">&gt;</span>&nbsp;<span class="ident" id="3270502">remain</span>&nbsp;<span class="op" id="3270509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270514">n</span>&nbsp;<span class="op" id="3270516">=</span>&nbsp;<span class="builtintype" id="3270518">int</span><span class="op" id="3270521">(</span><span class="ident" id="3270522">remain</span><span class="op" id="3270528">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270536">n</span><span class="op" id="3270537">,</span>&nbsp;<span class="ident" id="3270539">err1</span>&nbsp;<span class="op" id="3270544">:=</span>&nbsp;<span class="ident" id="3270547">syscall</span><span class="op" id="3270554">.</span><span class="ident" id="3270555">Sendfile</span><span class="op" id="3270563">(</span><span class="ident" id="3270564">dst</span><span class="op" id="3270567">,</span>&nbsp;<span class="ident" id="3270569">src</span><span class="op" id="3270572">,</span>&nbsp;<span class="ident" id="3270574">nil</span><span class="op" id="3270577">,</span>&nbsp;<span class="ident" id="3270579">n</span><span class="op" id="3270580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270584">if</span>&nbsp;<span class="ident" id="3270587">n</span>&nbsp;<span class="op" id="3270589">&gt;</span>&nbsp;<span class="num" id="3270591">0</span>&nbsp;<span class="op" id="3270593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270598">written</span>&nbsp;<span class="op" id="3270606">+=</span>&nbsp;<span class="ident" id="3270609">int64</span><span class="op" id="3270614">(</span><span class="ident" id="3270615">n</span><span class="op" id="3270616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270621">remain</span>&nbsp;<span class="op" id="3270628">-=</span>&nbsp;<span class="ident" id="3270631">int64</span><span class="op" id="3270636">(</span><span class="ident" id="3270637">n</span><span class="op" id="3270638">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270646">if</span>&nbsp;<span class="ident" id="3270649">n</span>&nbsp;<span class="op" id="3270651">==</span>&nbsp;<span class="num" id="3270654">0</span>&nbsp;<span class="op" id="3270656">&amp;&amp;</span>&nbsp;<span class="ident" id="3270659">err1</span>&nbsp;<span class="op" id="3270664">==</span>&nbsp;<span class="ident" id="3270667">nil</span>&nbsp;<span class="op" id="3270671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270676">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270688">if</span>&nbsp;<span class="ident" id="3270691">err1</span>&nbsp;<span class="op" id="3270696">==</span>&nbsp;<span class="ident" id="3270699">syscall</span><span class="op" id="3270706">.</span><span class="ident" id="3270707">EAGAIN</span>&nbsp;<span class="op" id="3270714">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270719">if</span>&nbsp;<span class="ident" id="3270722">err1</span>&nbsp;<span class="op" id="3270727">=</span>&nbsp;<span class="ident" id="3270729">c</span><span class="op" id="3270730">.</span><span class="ident" id="3270731">pd</span><span class="op" id="3270733">.</span><span class="ident" id="3270734">WaitWrite</span><span class="op" id="3270743">(</span><span class="op" id="3270744">)</span><span class="op" id="3270745">;</span>&nbsp;<span class="ident" id="3270747">err1</span>&nbsp;<span class="op" id="3270752">==</span>&nbsp;<span class="ident" id="3270755">nil</span>&nbsp;<span class="op" id="3270759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270765">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3270781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270785">if</span>&nbsp;<span class="ident" id="3270788">err1</span>&nbsp;<span class="op" id="3270793">!=</span>&nbsp;<span class="ident" id="3270796">nil</span>&nbsp;<span class="op" id="3270800">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3270805">//&nbsp;This&nbsp;includes&nbsp;syscall.ENOSYS&nbsp;(no&nbsp;kernel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3270851">//&nbsp;support)&nbsp;and&nbsp;syscall.EINVAL&nbsp;(fd&nbsp;types&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3270901">//&nbsp;don&#39;t&nbsp;implement&nbsp;sendfile&nbsp;together)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3270942">err</span>&nbsp;<span class="op" id="3270946">=</span>&nbsp;<span class="op" id="3270948">&amp;</span><span class="ident" id="3270949">OpError</span><span class="op" id="3270956">{</span><span class="string" id="3270957">&#34;sendfile&#34;</span><span class="op" id="3270967">,</span>&nbsp;<span class="ident" id="3270969">c</span><span class="op" id="3270970">.</span><span class="ident" id="3270971">net</span><span class="op" id="3270974">,</span>&nbsp;<span class="ident" id="3270976">c</span><span class="op" id="3270977">.</span><span class="ident" id="3270978">raddr</span><span class="op" id="3270983">,</span>&nbsp;<span class="ident" id="3270985">err1</span><span class="op" id="3270989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3270994">break</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271008">if</span>&nbsp;<span class="ident" id="3271011">lr</span>&nbsp;<span class="op" id="3271014">!=</span>&nbsp;<span class="ident" id="3271017">nil</span>&nbsp;<span class="op" id="3271021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3271025">lr</span><span class="op" id="3271027">.</span><span class="ident" id="3271028">N</span>&nbsp;<span class="op" id="3271030">=</span>&nbsp;<span class="ident" id="3271032">remain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3271040">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3271043">return</span>&nbsp;<span class="ident" id="3271050">written</span><span class="op" id="3271057">,</span>&nbsp;<span class="ident" id="3271059">err</span><span class="op" id="3271062">,</span>&nbsp;<span class="ident" id="3271064">written</span>&nbsp;<span class="op" id="3271072">&gt;</span>&nbsp;<span class="num" id="3271074">0</span><br>
<span class="lineno"></span><span class="op" id="3271076">}</span>
</div>
</body>
</html>
