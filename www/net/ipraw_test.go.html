<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7902210">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7902266">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7902320">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7902371">package</span>&nbsp;<span class="ident" id="7902379">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7902384">import</span>&nbsp;<span class="op" id="7902391">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902394">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902403">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902410">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902416">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902427">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902438">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7902449">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7902456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7902459">type</span>&nbsp;<span class="ident" id="7902464">resolveIPAddrTest</span>&nbsp;<span class="keyword" id="7902482">struct</span>&nbsp;<span class="op" id="7902489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902492">net</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7902506">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902514">litAddrOrName</span>&nbsp;<span class="builtintype" id="7902528">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902536">addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7902550">*</span><span class="ident" id="7902551"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7902559">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7902573">error</span><br>
<span class="lineno"></span><span class="op" id="7902579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7902582">var</span>&nbsp;<span class="ident" id="7902586">resolveIPAddrTests</span>&nbsp;<span class="op" id="7902605">=</span>&nbsp;<span class="op" id="7902607">[</span><span class="op" id="7902608">]</span><span class="ident" id="7902609"><a href="/net/ipraw_test.go.html#7902464">resolveIPAddrTest</a></span><span class="op" id="7902626">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902629">{</span><span class="string" id="7902630">&#34;ip&#34;</span><span class="op" id="7902634">,</span>&nbsp;<span class="string" id="7902636">&#34;127.0.0.1&#34;</span><span class="op" id="7902647">,</span>&nbsp;<span class="op" id="7902649">&amp;</span><span class="ident" id="7902650"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7902656">{</span><span class="ident" id="7902657">IP</span><span class="op" id="7902659">:</span>&nbsp;<span class="ident" id="7902661"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7902665">(</span><span class="num" id="7902666">127</span><span class="op" id="7902669">,</span>&nbsp;<span class="num" id="7902671">0</span><span class="op" id="7902672">,</span>&nbsp;<span class="num" id="7902674">0</span><span class="op" id="7902675">,</span>&nbsp;<span class="num" id="7902677">1</span><span class="op" id="7902678">)</span><span class="op" id="7902679">}</span><span class="op" id="7902680">,</span>&nbsp;<span class="ident" id="7902682">nil</span><span class="op" id="7902685">}</span><span class="op" id="7902686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902689">{</span><span class="string" id="7902690">&#34;ip4&#34;</span><span class="op" id="7902695">,</span>&nbsp;<span class="string" id="7902697">&#34;127.0.0.1&#34;</span><span class="op" id="7902708">,</span>&nbsp;<span class="op" id="7902710">&amp;</span><span class="ident" id="7902711"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7902717">{</span><span class="ident" id="7902718">IP</span><span class="op" id="7902720">:</span>&nbsp;<span class="ident" id="7902722"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7902726">(</span><span class="num" id="7902727">127</span><span class="op" id="7902730">,</span>&nbsp;<span class="num" id="7902732">0</span><span class="op" id="7902733">,</span>&nbsp;<span class="num" id="7902735">0</span><span class="op" id="7902736">,</span>&nbsp;<span class="num" id="7902738">1</span><span class="op" id="7902739">)</span><span class="op" id="7902740">}</span><span class="op" id="7902741">,</span>&nbsp;<span class="ident" id="7902743">nil</span><span class="op" id="7902746">}</span><span class="op" id="7902747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902750">{</span><span class="string" id="7902751">&#34;ip4:icmp&#34;</span><span class="op" id="7902761">,</span>&nbsp;<span class="string" id="7902763">&#34;127.0.0.1&#34;</span><span class="op" id="7902774">,</span>&nbsp;<span class="op" id="7902776">&amp;</span><span class="ident" id="7902777"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7902783">{</span><span class="ident" id="7902784">IP</span><span class="op" id="7902786">:</span>&nbsp;<span class="ident" id="7902788"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7902792">(</span><span class="num" id="7902793">127</span><span class="op" id="7902796">,</span>&nbsp;<span class="num" id="7902798">0</span><span class="op" id="7902799">,</span>&nbsp;<span class="num" id="7902801">0</span><span class="op" id="7902802">,</span>&nbsp;<span class="num" id="7902804">1</span><span class="op" id="7902805">)</span><span class="op" id="7902806">}</span><span class="op" id="7902807">,</span>&nbsp;<span class="ident" id="7902809">nil</span><span class="op" id="7902812">}</span><span class="op" id="7902813">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902817">{</span><span class="string" id="7902818">&#34;ip&#34;</span><span class="op" id="7902822">,</span>&nbsp;<span class="string" id="7902824">&#34;::1&#34;</span><span class="op" id="7902829">,</span>&nbsp;<span class="op" id="7902831">&amp;</span><span class="ident" id="7902832"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7902838">{</span><span class="ident" id="7902839">IP</span><span class="op" id="7902841">:</span>&nbsp;<span class="ident" id="7902843"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7902850">(</span><span class="string" id="7902851">&#34;::1&#34;</span><span class="op" id="7902856">)</span><span class="op" id="7902857">}</span><span class="op" id="7902858">,</span>&nbsp;<span class="ident" id="7902860">nil</span><span class="op" id="7902863">}</span><span class="op" id="7902864">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902867">{</span><span class="string" id="7902868">&#34;ip6&#34;</span><span class="op" id="7902873">,</span>&nbsp;<span class="string" id="7902875">&#34;::1&#34;</span><span class="op" id="7902880">,</span>&nbsp;<span class="op" id="7902882">&amp;</span><span class="ident" id="7902883"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7902889">{</span><span class="ident" id="7902890">IP</span><span class="op" id="7902892">:</span>&nbsp;<span class="ident" id="7902894"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7902901">(</span><span class="string" id="7902902">&#34;::1&#34;</span><span class="op" id="7902907">)</span><span class="op" id="7902908">}</span><span class="op" id="7902909">,</span>&nbsp;<span class="ident" id="7902911">nil</span><span class="op" id="7902914">}</span><span class="op" id="7902915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902918">{</span><span class="string" id="7902919">&#34;ip6:ipv6-icmp&#34;</span><span class="op" id="7902934">,</span>&nbsp;<span class="string" id="7902936">&#34;::1&#34;</span><span class="op" id="7902941">,</span>&nbsp;<span class="op" id="7902943">&amp;</span><span class="ident" id="7902944"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7902950">{</span><span class="ident" id="7902951">IP</span><span class="op" id="7902953">:</span>&nbsp;<span class="ident" id="7902955"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7902962">(</span><span class="string" id="7902963">&#34;::1&#34;</span><span class="op" id="7902968">)</span><span class="op" id="7902969">}</span><span class="op" id="7902970">,</span>&nbsp;<span class="ident" id="7902972">nil</span><span class="op" id="7902975">}</span><span class="op" id="7902976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7902979">{</span><span class="string" id="7902980">&#34;ip6:IPv6-ICMP&#34;</span><span class="op" id="7902995">,</span>&nbsp;<span class="string" id="7902997">&#34;::1&#34;</span><span class="op" id="7903002">,</span>&nbsp;<span class="op" id="7903004">&amp;</span><span class="ident" id="7903005"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903011">{</span><span class="ident" id="7903012">IP</span><span class="op" id="7903014">:</span>&nbsp;<span class="ident" id="7903016"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7903023">(</span><span class="string" id="7903024">&#34;::1&#34;</span><span class="op" id="7903029">)</span><span class="op" id="7903030">}</span><span class="op" id="7903031">,</span>&nbsp;<span class="ident" id="7903033">nil</span><span class="op" id="7903036">}</span><span class="op" id="7903037">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903041">{</span><span class="string" id="7903042">&#34;ip&#34;</span><span class="op" id="7903046">,</span>&nbsp;<span class="string" id="7903048">&#34;::1%en0&#34;</span><span class="op" id="7903057">,</span>&nbsp;<span class="op" id="7903059">&amp;</span><span class="ident" id="7903060"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903066">{</span><span class="ident" id="7903067">IP</span><span class="op" id="7903069">:</span>&nbsp;<span class="ident" id="7903071"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7903078">(</span><span class="string" id="7903079">&#34;::1&#34;</span><span class="op" id="7903084">)</span><span class="op" id="7903085">,</span>&nbsp;<span class="ident" id="7903087">Zone</span><span class="op" id="7903091">:</span>&nbsp;<span class="string" id="7903093">&#34;en0&#34;</span><span class="op" id="7903098">}</span><span class="op" id="7903099">,</span>&nbsp;<span class="ident" id="7903101">nil</span><span class="op" id="7903104">}</span><span class="op" id="7903105">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903108">{</span><span class="string" id="7903109">&#34;ip6&#34;</span><span class="op" id="7903114">,</span>&nbsp;<span class="string" id="7903116">&#34;::1%911&#34;</span><span class="op" id="7903125">,</span>&nbsp;<span class="op" id="7903127">&amp;</span><span class="ident" id="7903128"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903134">{</span><span class="ident" id="7903135">IP</span><span class="op" id="7903137">:</span>&nbsp;<span class="ident" id="7903139"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7903146">(</span><span class="string" id="7903147">&#34;::1&#34;</span><span class="op" id="7903152">)</span><span class="op" id="7903153">,</span>&nbsp;<span class="ident" id="7903155">Zone</span><span class="op" id="7903159">:</span>&nbsp;<span class="string" id="7903161">&#34;911&#34;</span><span class="op" id="7903166">}</span><span class="op" id="7903167">,</span>&nbsp;<span class="ident" id="7903169">nil</span><span class="op" id="7903172">}</span><span class="op" id="7903173">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903177">{</span><span class="string" id="7903178">&#34;&#34;</span><span class="op" id="7903180">,</span>&nbsp;<span class="string" id="7903182">&#34;127.0.0.1&#34;</span><span class="op" id="7903193">,</span>&nbsp;<span class="op" id="7903195">&amp;</span><span class="ident" id="7903196"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903202">{</span><span class="ident" id="7903203">IP</span><span class="op" id="7903205">:</span>&nbsp;<span class="ident" id="7903207"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7903211">(</span><span class="num" id="7903212">127</span><span class="op" id="7903215">,</span>&nbsp;<span class="num" id="7903217">0</span><span class="op" id="7903218">,</span>&nbsp;<span class="num" id="7903220">0</span><span class="op" id="7903221">,</span>&nbsp;<span class="num" id="7903223">1</span><span class="op" id="7903224">)</span><span class="op" id="7903225">}</span><span class="op" id="7903226">,</span>&nbsp;<span class="ident" id="7903228">nil</span><span class="op" id="7903231">}</span><span class="op" id="7903232">,</span>&nbsp;<span class="comment" id="7903234">//&nbsp;Go&nbsp;1.0&nbsp;behavior</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903254">{</span><span class="string" id="7903255">&#34;&#34;</span><span class="op" id="7903257">,</span>&nbsp;<span class="string" id="7903259">&#34;::1&#34;</span><span class="op" id="7903264">,</span>&nbsp;<span class="op" id="7903266">&amp;</span><span class="ident" id="7903267"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903273">{</span><span class="ident" id="7903274">IP</span><span class="op" id="7903276">:</span>&nbsp;<span class="ident" id="7903278"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7903285">(</span><span class="string" id="7903286">&#34;::1&#34;</span><span class="op" id="7903291">)</span><span class="op" id="7903292">}</span><span class="op" id="7903293">,</span>&nbsp;<span class="ident" id="7903295">nil</span><span class="op" id="7903298">}</span><span class="op" id="7903299">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7903311">//&nbsp;Go&nbsp;1.0&nbsp;behavior</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903332">{</span><span class="string" id="7903333">&#34;l2tp&#34;</span><span class="op" id="7903339">,</span>&nbsp;<span class="string" id="7903341">&#34;127.0.0.1&#34;</span><span class="op" id="7903352">,</span>&nbsp;<span class="ident" id="7903354">nil</span><span class="op" id="7903357">,</span>&nbsp;<span class="ident" id="7903359"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="7903378">(</span><span class="string" id="7903379">&#34;l2tp&#34;</span><span class="op" id="7903385">)</span><span class="op" id="7903386">}</span><span class="op" id="7903387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903390">{</span><span class="string" id="7903391">&#34;l2tp:gre&#34;</span><span class="op" id="7903401">,</span>&nbsp;<span class="string" id="7903403">&#34;127.0.0.1&#34;</span><span class="op" id="7903414">,</span>&nbsp;<span class="ident" id="7903416">nil</span><span class="op" id="7903419">,</span>&nbsp;<span class="ident" id="7903421"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="7903440">(</span><span class="string" id="7903441">&#34;l2tp:gre&#34;</span><span class="op" id="7903451">)</span><span class="op" id="7903452">}</span><span class="op" id="7903453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903456">{</span><span class="string" id="7903457">&#34;tcp&#34;</span><span class="op" id="7903462">,</span>&nbsp;<span class="string" id="7903464">&#34;1.2.3.4:123&#34;</span><span class="op" id="7903477">,</span>&nbsp;<span class="ident" id="7903479">nil</span><span class="op" id="7903482">,</span>&nbsp;<span class="ident" id="7903484"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="7903503">(</span><span class="string" id="7903504">&#34;tcp&#34;</span><span class="op" id="7903509">)</span><span class="op" id="7903510">}</span><span class="op" id="7903511">,</span><br>
<span class="lineno"></span><span class="op" id="7903513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7903516">func</span>&nbsp;<span class="ident" id="7903521">init</span><span class="op" id="7903525">(</span><span class="op" id="7903526">)</span>&nbsp;<span class="op" id="7903528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903531">if</span>&nbsp;<span class="ident" id="7903534">ifi</span>&nbsp;<span class="op" id="7903538">:=</span>&nbsp;<span class="ident" id="7903541"><a href="/net/interface_test.go.html#7876504">loopbackInterface</a></span><span class="op" id="7903558">(</span><span class="op" id="7903559">)</span><span class="op" id="7903560">;</span>&nbsp;<span class="ident" id="7903562"><a href="/net/ipraw_test.go.html#7903534">ifi</a></span>&nbsp;<span class="op" id="7903566">!=</span>&nbsp;<span class="ident" id="7903569">nil</span>&nbsp;<span class="op" id="7903573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903577">index</span>&nbsp;<span class="op" id="7903583">:=</span>&nbsp;<span class="ident" id="7903586"><a href="/net/ipraw_test.go.html#7902403">fmt</a></span><span class="op" id="7903589">.</span><span class="ident" id="7903590">Sprintf</span><span class="op" id="7903597">(</span><span class="string" id="7903598">&#34;%v&#34;</span><span class="op" id="7903602">,</span>&nbsp;<span class="ident" id="7903604"><a href="/net/ipraw_test.go.html#7903534">ifi</a></span><span class="op" id="7903607">.</span><span class="ident" id="7903608">Index</span><span class="op" id="7903613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903617"><a href="/net/ipraw_test.go.html#7902586">resolveIPAddrTests</a></span>&nbsp;<span class="op" id="7903636">=</span>&nbsp;<span class="builtinfunc" id="7903638">append</span><span class="op" id="7903644">(</span><span class="ident" id="7903645"><a href="/net/ipraw_test.go.html#7902586">resolveIPAddrTests</a></span><span class="op" id="7903663">,</span>&nbsp;<span class="op" id="7903665">[</span><span class="op" id="7903666">]</span><span class="ident" id="7903667"><a href="/net/ipraw_test.go.html#7902464">resolveIPAddrTest</a></span><span class="op" id="7903684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903689">{</span><span class="string" id="7903690">&#34;ip6&#34;</span><span class="op" id="7903695">,</span>&nbsp;<span class="string" id="7903697">&#34;fe80::1%&#34;</span>&nbsp;<span class="op" id="7903708">+</span>&nbsp;<span class="ident" id="7903710"><a href="/net/ipraw_test.go.html#7903534">ifi</a></span><span class="op" id="7903713">.</span><span class="ident" id="7903714">Name</span><span class="op" id="7903718">,</span>&nbsp;<span class="op" id="7903720">&amp;</span><span class="ident" id="7903721"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903727">{</span><span class="ident" id="7903728">IP</span><span class="op" id="7903730">:</span>&nbsp;<span class="ident" id="7903732"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7903739">(</span><span class="string" id="7903740">&#34;fe80::1&#34;</span><span class="op" id="7903749">)</span><span class="op" id="7903750">,</span>&nbsp;<span class="ident" id="7903752">Zone</span><span class="op" id="7903756">:</span>&nbsp;<span class="ident" id="7903758"><a href="/net/ipsock.go.html#1448067">zoneToString</a></span><span class="op" id="7903770">(</span><span class="ident" id="7903771"><a href="/net/ipraw_test.go.html#7903534">ifi</a></span><span class="op" id="7903774">.</span><span class="ident" id="7903775">Index</span><span class="op" id="7903780">)</span><span class="op" id="7903781">}</span><span class="op" id="7903782">,</span>&nbsp;<span class="ident" id="7903784">nil</span><span class="op" id="7903787">}</span><span class="op" id="7903788">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903793">{</span><span class="string" id="7903794">&#34;ip6&#34;</span><span class="op" id="7903799">,</span>&nbsp;<span class="string" id="7903801">&#34;fe80::1%&#34;</span>&nbsp;<span class="op" id="7903812">+</span>&nbsp;<span class="ident" id="7903814"><a href="/net/ipraw_test.go.html#7903577">index</a></span><span class="op" id="7903819">,</span>&nbsp;<span class="op" id="7903821">&amp;</span><span class="ident" id="7903822"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7903828">{</span><span class="ident" id="7903829">IP</span><span class="op" id="7903831">:</span>&nbsp;<span class="ident" id="7903833"><a href="/net/ip.go.html#1430775">ParseIP</a></span><span class="op" id="7903840">(</span><span class="string" id="7903841">&#34;fe80::1&#34;</span><span class="op" id="7903850">)</span><span class="op" id="7903851">,</span>&nbsp;<span class="ident" id="7903853">Zone</span><span class="op" id="7903857">:</span>&nbsp;<span class="ident" id="7903859"><a href="/net/ipraw_test.go.html#7903577">index</a></span><span class="op" id="7903864">}</span><span class="op" id="7903865">,</span>&nbsp;<span class="ident" id="7903867">nil</span><span class="op" id="7903870">}</span><span class="op" id="7903871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903875">}</span><span class="op" id="7903876">...</span><span class="op" id="7903879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903885">if</span>&nbsp;<span class="ident" id="7903888">ips</span><span class="op" id="7903891">,</span>&nbsp;<span class="ident" id="7903893">err</span>&nbsp;<span class="op" id="7903897">:=</span>&nbsp;<span class="ident" id="7903900"><a href="/net/lookup.go.html#1454959">LookupIP</a></span><span class="op" id="7903908">(</span><span class="string" id="7903909">&#34;localhost&#34;</span><span class="op" id="7903920">)</span><span class="op" id="7903921">;</span>&nbsp;<span class="ident" id="7903923"><a href="/net/ipraw_test.go.html#7903893">err</a></span>&nbsp;<span class="op" id="7903927">==</span>&nbsp;<span class="ident" id="7903930">nil</span>&nbsp;<span class="op" id="7903934">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7903937">len</span><span class="op" id="7903940">(</span><span class="ident" id="7903941"><a href="/net/ipraw_test.go.html#7903888">ips</a></span><span class="op" id="7903944">)</span>&nbsp;<span class="op" id="7903946">&gt;</span>&nbsp;<span class="num" id="7903948">1</span>&nbsp;<span class="op" id="7903950">&amp;&amp;</span>&nbsp;<span class="ident" id="7903953"><a href="/net/ipsock.go.html#1440518">supportsIPv4</a></span>&nbsp;<span class="op" id="7903966">&amp;&amp;</span>&nbsp;<span class="ident" id="7903969"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7903982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903986"><a href="/net/ipraw_test.go.html#7902586">resolveIPAddrTests</a></span>&nbsp;<span class="op" id="7904005">=</span>&nbsp;<span class="builtinfunc" id="7904007">append</span><span class="op" id="7904013">(</span><span class="ident" id="7904014"><a href="/net/ipraw_test.go.html#7902586">resolveIPAddrTests</a></span><span class="op" id="7904032">,</span>&nbsp;<span class="op" id="7904034">[</span><span class="op" id="7904035">]</span><span class="ident" id="7904036"><a href="/net/ipraw_test.go.html#7902464">resolveIPAddrTest</a></span><span class="op" id="7904053">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904058">{</span><span class="string" id="7904059">&#34;ip&#34;</span><span class="op" id="7904063">,</span>&nbsp;<span class="string" id="7904065">&#34;localhost&#34;</span><span class="op" id="7904076">,</span>&nbsp;<span class="op" id="7904078">&amp;</span><span class="ident" id="7904079"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7904085">{</span><span class="ident" id="7904086">IP</span><span class="op" id="7904088">:</span>&nbsp;<span class="ident" id="7904090"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7904094">(</span><span class="num" id="7904095">127</span><span class="op" id="7904098">,</span>&nbsp;<span class="num" id="7904100">0</span><span class="op" id="7904101">,</span>&nbsp;<span class="num" id="7904103">0</span><span class="op" id="7904104">,</span>&nbsp;<span class="num" id="7904106">1</span><span class="op" id="7904107">)</span><span class="op" id="7904108">}</span><span class="op" id="7904109">,</span>&nbsp;<span class="ident" id="7904111">nil</span><span class="op" id="7904114">}</span><span class="op" id="7904115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904120">{</span><span class="string" id="7904121">&#34;ip4&#34;</span><span class="op" id="7904126">,</span>&nbsp;<span class="string" id="7904128">&#34;localhost&#34;</span><span class="op" id="7904139">,</span>&nbsp;<span class="op" id="7904141">&amp;</span><span class="ident" id="7904142"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7904148">{</span><span class="ident" id="7904149">IP</span><span class="op" id="7904151">:</span>&nbsp;<span class="ident" id="7904153"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7904157">(</span><span class="num" id="7904158">127</span><span class="op" id="7904161">,</span>&nbsp;<span class="num" id="7904163">0</span><span class="op" id="7904164">,</span>&nbsp;<span class="num" id="7904166">0</span><span class="op" id="7904167">,</span>&nbsp;<span class="num" id="7904169">1</span><span class="op" id="7904170">)</span><span class="op" id="7904171">}</span><span class="op" id="7904172">,</span>&nbsp;<span class="ident" id="7904174">nil</span><span class="op" id="7904177">}</span><span class="op" id="7904178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904183">{</span><span class="string" id="7904184">&#34;ip6&#34;</span><span class="op" id="7904189">,</span>&nbsp;<span class="string" id="7904191">&#34;localhost&#34;</span><span class="op" id="7904202">,</span>&nbsp;<span class="op" id="7904204">&amp;</span><span class="ident" id="7904205"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7904211">{</span><span class="ident" id="7904212">IP</span><span class="op" id="7904214">:</span>&nbsp;<span class="ident" id="7904216"><a href="/net/ip.go.html#1418830">IPv6loopback</a></span><span class="op" id="7904228">}</span><span class="op" id="7904229">,</span>&nbsp;<span class="ident" id="7904231">nil</span><span class="op" id="7904234">}</span><span class="op" id="7904235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904239">}</span><span class="op" id="7904240">...</span><span class="op" id="7904243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904246">}</span><br>
<span class="lineno">60</span><span class="op" id="7904248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7904251">func</span>&nbsp;<span class="ident" id="7904256">skipRawSocketTest</span><span class="op" id="7904273">(</span><span class="ident" id="7904274">t</span>&nbsp;<span class="op" id="7904276">*</span><span class="ident" id="7904277"><a href="/net/ipraw_test.go.html#7902438">testing</a></span><span class="op" id="7904284">.</span><span class="ident" id="7904285">T</span><span class="op" id="7904286">)</span>&nbsp;<span class="op" id="7904288">(</span><span class="ident" id="7904289">skip</span>&nbsp;<span class="builtintype" id="7904294">bool</span><span class="op" id="7904298">,</span>&nbsp;<span class="ident" id="7904300">skipmsg</span>&nbsp;<span class="builtintype" id="7904308">string</span><span class="op" id="7904314">)</span>&nbsp;<span class="op" id="7904316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904319"><a href="/net/ipraw_test.go.html#7904289">skip</a></span><span class="op" id="7904323">,</span>&nbsp;<span class="ident" id="7904325"><a href="/net/ipraw_test.go.html#7904300">skipmsg</a></span><span class="op" id="7904332">,</span>&nbsp;<span class="ident" id="7904334">err</span>&nbsp;<span class="op" id="7904338">:=</span>&nbsp;<span class="ident" id="7904341"><a href="/net/fd_unix.go.html#1400169">skipRawSocketTests</a></span><span class="op" id="7904359">(</span><span class="op" id="7904360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904363">if</span>&nbsp;<span class="ident" id="7904366"><a href="/net/ipraw_test.go.html#7904334">err</a></span>&nbsp;<span class="op" id="7904370">!=</span>&nbsp;<span class="ident" id="7904373">nil</span>&nbsp;<span class="op" id="7904377">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904381"><a href="/net/ipraw_test.go.html#7904274">t</a></span><span class="op" id="7904382">.</span><span class="ident" id="7904383">Fatal</span><span class="op" id="7904388">(</span><span class="ident" id="7904389"><a href="/net/ipraw_test.go.html#7904334">err</a></span><span class="op" id="7904392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904398">return</span>&nbsp;<span class="ident" id="7904405"><a href="/net/ipraw_test.go.html#7904289">skip</a></span><span class="op" id="7904409">,</span>&nbsp;<span class="ident" id="7904411"><a href="/net/ipraw_test.go.html#7904300">skipmsg</a></span><br>
<span class="lineno"></span><span class="op" id="7904419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="7904422">func</span>&nbsp;<span class="ident" id="7904427">TestResolveIPAddr</span><span class="op" id="7904444">(</span><span class="ident" id="7904445">t</span>&nbsp;<span class="op" id="7904447">*</span><span class="ident" id="7904448"><a href="/net/ipraw_test.go.html#7902438">testing</a></span><span class="op" id="7904455">.</span><span class="ident" id="7904456">T</span><span class="op" id="7904457">)</span>&nbsp;<span class="op" id="7904459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904462">switch</span>&nbsp;<span class="ident" id="7904469"><a href="/net/ipraw_test.go.html#7902427">runtime</a></span><span class="op" id="7904476">.</span><span class="ident" id="7904477">GOOS</span>&nbsp;<span class="op" id="7904482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904485">case</span>&nbsp;<span class="string" id="7904490">&#34;nacl&#34;</span><span class="op" id="7904496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904500"><a href="/net/ipraw_test.go.html#7904445">t</a></span><span class="op" id="7904501">.</span><span class="ident" id="7904502">Skipf</span><span class="op" id="7904507">(</span><span class="string" id="7904508">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7904529">,</span>&nbsp;<span class="ident" id="7904531"><a href="/net/ipraw_test.go.html#7902427">runtime</a></span><span class="op" id="7904538">.</span><span class="ident" id="7904539">GOOS</span><span class="op" id="7904543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904546">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904550">for</span>&nbsp;<span class="ident" id="7904554">_</span><span class="op" id="7904555">,</span>&nbsp;<span class="ident" id="7904557">tt</span>&nbsp;<span class="op" id="7904560">:=</span>&nbsp;<span class="keyword" id="7904563">range</span>&nbsp;<span class="ident" id="7904569"><a href="/net/ipraw_test.go.html#7902586">resolveIPAddrTests</a></span>&nbsp;<span class="op" id="7904588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904592">addr</span><span class="op" id="7904596">,</span>&nbsp;<span class="ident" id="7904598">err</span>&nbsp;<span class="op" id="7904602">:=</span>&nbsp;<span class="ident" id="7904605"><a href="/net/iprawsock.go.html#1432625">ResolveIPAddr</a></span><span class="op" id="7904618">(</span><span class="ident" id="7904619"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904621">.</span><span class="ident" id="7904622">net</span><span class="op" id="7904625">,</span>&nbsp;<span class="ident" id="7904627"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904629">.</span><span class="ident" id="7904630">litAddrOrName</span><span class="op" id="7904643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904647">if</span>&nbsp;<span class="ident" id="7904650"><a href="/net/ipraw_test.go.html#7904598">err</a></span>&nbsp;<span class="op" id="7904654">!=</span>&nbsp;<span class="ident" id="7904657"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904659">.</span><span class="ident" id="7904660">err</span>&nbsp;<span class="op" id="7904664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904669"><a href="/net/ipraw_test.go.html#7904445">t</a></span><span class="op" id="7904670">.</span><span class="ident" id="7904671">Fatalf</span><span class="op" id="7904677">(</span><span class="string" id="7904678">&#34;ResolveIPAddr(%v,&nbsp;%v)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7904712">,</span>&nbsp;<span class="ident" id="7904714"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904716">.</span><span class="ident" id="7904717">net</span><span class="op" id="7904720">,</span>&nbsp;<span class="ident" id="7904722"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904724">.</span><span class="ident" id="7904725">litAddrOrName</span><span class="op" id="7904738">,</span>&nbsp;<span class="ident" id="7904740"><a href="/net/ipraw_test.go.html#7904598">err</a></span><span class="op" id="7904743">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904747">}</span>&nbsp;<span class="keyword" id="7904749">else</span>&nbsp;<span class="keyword" id="7904754">if</span>&nbsp;<span class="op" id="7904757">!</span><span class="ident" id="7904758"><a href="/net/ipraw_test.go.html#7902416">reflect</a></span><span class="op" id="7904765">.</span><span class="ident" id="7904766">DeepEqual</span><span class="op" id="7904775">(</span><span class="ident" id="7904776"><a href="/net/ipraw_test.go.html#7904592">addr</a></span><span class="op" id="7904780">,</span>&nbsp;<span class="ident" id="7904782"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904784">.</span><span class="ident" id="7904785">addr</span><span class="op" id="7904789">)</span>&nbsp;<span class="op" id="7904791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904796"><a href="/net/ipraw_test.go.html#7904445">t</a></span><span class="op" id="7904797">.</span><span class="ident" id="7904798">Fatalf</span><span class="op" id="7904804">(</span><span class="string" id="7904805">&#34;got&nbsp;%#v;&nbsp;expected&nbsp;%#v&#34;</span><span class="op" id="7904828">,</span>&nbsp;<span class="ident" id="7904830"><a href="/net/ipraw_test.go.html#7904592">addr</a></span><span class="op" id="7904834">,</span>&nbsp;<span class="ident" id="7904836"><a href="/net/ipraw_test.go.html#7904557">tt</a></span><span class="op" id="7904838">.</span><span class="ident" id="7904839">addr</span><span class="op" id="7904843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904850">}</span><br>
<span class="lineno"></span><span class="op" id="7904852">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="7904855">var</span>&nbsp;<span class="ident" id="7904859">icmpEchoTests</span>&nbsp;<span class="op" id="7904873">=</span>&nbsp;<span class="op" id="7904875">[</span><span class="op" id="7904876">]</span><span class="keyword" id="7904877">struct</span>&nbsp;<span class="op" id="7904884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904887">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7904893">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904901">laddr</span>&nbsp;<span class="builtintype" id="7904907">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904915">raddr</span>&nbsp;<span class="builtintype" id="7904921">string</span><br>
<span class="lineno">90</span><span class="op" id="7904928">}</span><span class="op" id="7904929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904932">{</span><span class="string" id="7904933">&#34;ip4:icmp&#34;</span><span class="op" id="7904943">,</span>&nbsp;<span class="string" id="7904945">&#34;0.0.0.0&#34;</span><span class="op" id="7904954">,</span>&nbsp;<span class="string" id="7904956">&#34;127.0.0.1&#34;</span><span class="op" id="7904967">}</span><span class="op" id="7904968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904971">{</span><span class="string" id="7904972">&#34;ip6:ipv6-icmp&#34;</span><span class="op" id="7904987">,</span>&nbsp;<span class="string" id="7904989">&#34;::&#34;</span><span class="op" id="7904993">,</span>&nbsp;<span class="string" id="7904995">&#34;::1&#34;</span><span class="op" id="7905000">}</span><span class="op" id="7905001">,</span><br>
<span class="lineno"></span><span class="op" id="7905003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7905006">func</span>&nbsp;<span class="ident" id="7905011">TestConnICMPEcho</span><span class="op" id="7905027">(</span><span class="ident" id="7905028">t</span>&nbsp;<span class="op" id="7905030">*</span><span class="ident" id="7905031"><a href="/net/ipraw_test.go.html#7902438">testing</a></span><span class="op" id="7905038">.</span><span class="ident" id="7905039">T</span><span class="op" id="7905040">)</span>&nbsp;<span class="op" id="7905042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905045">if</span>&nbsp;<span class="ident" id="7905048">skip</span><span class="op" id="7905052">,</span>&nbsp;<span class="ident" id="7905054">skipmsg</span>&nbsp;<span class="op" id="7905062">:=</span>&nbsp;<span class="ident" id="7905065"><a href="/net/ipraw_test.go.html#7904256">skipRawSocketTest</a></span><span class="op" id="7905082">(</span><span class="ident" id="7905083"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7905084">)</span><span class="op" id="7905085">;</span>&nbsp;<span class="ident" id="7905087"><a href="/net/ipraw_test.go.html#7905048">skip</a></span>&nbsp;<span class="op" id="7905092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905096"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7905097">.</span><span class="ident" id="7905098">Skip</span><span class="op" id="7905102">(</span><span class="ident" id="7905103"><a href="/net/ipraw_test.go.html#7905054">skipmsg</a></span><span class="op" id="7905110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905117">for</span>&nbsp;<span class="ident" id="7905121">i</span><span class="op" id="7905122">,</span>&nbsp;<span class="ident" id="7905124">tt</span>&nbsp;<span class="op" id="7905127">:=</span>&nbsp;<span class="keyword" id="7905130">range</span>&nbsp;<span class="ident" id="7905136"><a href="/net/ipraw_test.go.html#7904859">icmpEchoTests</a></span>&nbsp;<span class="op" id="7905150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905154">net</span><span class="op" id="7905157">,</span>&nbsp;<span class="ident" id="7905159">_</span><span class="op" id="7905160">,</span>&nbsp;<span class="ident" id="7905162">err</span>&nbsp;<span class="op" id="7905166">:=</span>&nbsp;<span class="ident" id="7905169"><a href="/net/dial.go.html#1332358">parseNetwork</a></span><span class="op" id="7905181">(</span><span class="ident" id="7905182"><a href="/net/ipraw_test.go.html#7905124">tt</a></span><span class="op" id="7905184">.</span><span class="ident" id="7905185">net</span><span class="op" id="7905188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905192">if</span>&nbsp;<span class="ident" id="7905195"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7905199">!=</span>&nbsp;<span class="ident" id="7905202">nil</span>&nbsp;<span class="op" id="7905206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905211"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7905212">.</span><span class="ident" id="7905213">Fatalf</span><span class="op" id="7905219">(</span><span class="string" id="7905220">&#34;parseNetwork&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7905245">,</span>&nbsp;<span class="ident" id="7905247"><a href="/net/ipraw_test.go.html#7905162">err</a></span><span class="op" id="7905250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905254">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905258">if</span>&nbsp;<span class="ident" id="7905261"><a href="/net/ipraw_test.go.html#7905154">net</a></span>&nbsp;<span class="op" id="7905265">==</span>&nbsp;<span class="string" id="7905268">&#34;ip6&#34;</span>&nbsp;<span class="op" id="7905274">&amp;&amp;</span>&nbsp;<span class="op" id="7905277">!</span><span class="ident" id="7905278"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7905291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905296">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905312">c</span><span class="op" id="7905313">,</span>&nbsp;<span class="ident" id="7905315"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7905319">:=</span>&nbsp;<span class="ident" id="7905322"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7905326">(</span><span class="ident" id="7905327"><a href="/net/ipraw_test.go.html#7905124">tt</a></span><span class="op" id="7905329">.</span><span class="ident" id="7905330">net</span><span class="op" id="7905333">,</span>&nbsp;<span class="ident" id="7905335"><a href="/net/ipraw_test.go.html#7905124">tt</a></span><span class="op" id="7905337">.</span><span class="ident" id="7905338">raddr</span><span class="op" id="7905343">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905347">if</span>&nbsp;<span class="ident" id="7905350"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7905354">!=</span>&nbsp;<span class="ident" id="7905357">nil</span>&nbsp;<span class="op" id="7905361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905366"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7905367">.</span><span class="ident" id="7905368">Fatalf</span><span class="op" id="7905374">(</span><span class="string" id="7905375">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7905392">,</span>&nbsp;<span class="ident" id="7905394"><a href="/net/ipraw_test.go.html#7905162">err</a></span><span class="op" id="7905397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905405"><a href="/net/ipraw_test.go.html#7905312">c</a></span><span class="op" id="7905406">.</span><span class="ident" id="7905407">SetDeadline</span><span class="op" id="7905418">(</span><span class="ident" id="7905419"><a href="/net/ipraw_test.go.html#7902449">time</a></span><span class="op" id="7905423">.</span><span class="ident" id="7905424">Now</span><span class="op" id="7905427">(</span><span class="op" id="7905428">)</span><span class="op" id="7905429">.</span><span class="ident" id="7905430">Add</span><span class="op" id="7905433">(</span><span class="num" id="7905434">100</span>&nbsp;<span class="op" id="7905438">*</span>&nbsp;<span class="ident" id="7905440"><a href="/net/ipraw_test.go.html#7902449">time</a></span><span class="op" id="7905444">.</span><span class="ident" id="7905445">Millisecond</span><span class="op" id="7905456">)</span><span class="op" id="7905457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905461">defer</span>&nbsp;<span class="ident" id="7905467"><a href="/net/ipraw_test.go.html#7905312">c</a></span><span class="op" id="7905468">.</span><span class="ident" id="7905469">Close</span><span class="op" id="7905474">(</span><span class="op" id="7905475">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905480">typ</span>&nbsp;<span class="op" id="7905484">:=</span>&nbsp;<span class="ident" id="7905487"><a href="/net/mockicmp_test.go.html#7921291">icmpv4EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905507">if</span>&nbsp;<span class="ident" id="7905510"><a href="/net/ipraw_test.go.html#7905154">net</a></span>&nbsp;<span class="op" id="7905514">==</span>&nbsp;<span class="string" id="7905517">&#34;ip6&#34;</span>&nbsp;<span class="op" id="7905523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905528"><a href="/net/ipraw_test.go.html#7905480">typ</a></span>&nbsp;<span class="op" id="7905532">=</span>&nbsp;<span class="ident" id="7905534"><a href="/net/mockicmp_test.go.html#7921337">icmpv6EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905554">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905558">xid</span><span class="op" id="7905561">,</span>&nbsp;<span class="ident" id="7905563">xseq</span>&nbsp;<span class="op" id="7905568">:=</span>&nbsp;<span class="ident" id="7905571"><a href="/net/ipraw_test.go.html#7902410">os</a></span><span class="op" id="7905573">.</span><span class="ident" id="7905574">Getpid</span><span class="op" id="7905580">(</span><span class="op" id="7905581">)</span><span class="op" id="7905582">&amp;</span><span class="num" id="7905583">0xffff</span><span class="op" id="7905589">,</span>&nbsp;<span class="ident" id="7905591"><a href="/net/ipraw_test.go.html#7905121">i</a></span><span class="op" id="7905592">+</span><span class="num" id="7905593">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905597">wb</span><span class="op" id="7905599">,</span>&nbsp;<span class="ident" id="7905601"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7905605">:=</span>&nbsp;<span class="op" id="7905608">(</span><span class="op" id="7905609">&amp;</span><span class="ident" id="7905610"><a href="/net/mockicmp_test.go.html#7921437">icmpMessage</a></span><span class="op" id="7905621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905626">Type</span><span class="op" id="7905630">:</span>&nbsp;<span class="ident" id="7905632"><a href="/net/ipraw_test.go.html#7905480">typ</a></span><span class="op" id="7905635">,</span>&nbsp;<span class="ident" id="7905637">Code</span><span class="op" id="7905641">:</span>&nbsp;<span class="num" id="7905643">0</span><span class="op" id="7905644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905649">Body</span><span class="op" id="7905653">:</span>&nbsp;<span class="op" id="7905655">&amp;</span><span class="ident" id="7905656"><a href="/net/mockicmp_test.go.html#7923095">icmpEcho</a></span><span class="op" id="7905664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905670">ID</span><span class="op" id="7905672">:</span>&nbsp;<span class="ident" id="7905674"><a href="/net/ipraw_test.go.html#7905558">xid</a></span><span class="op" id="7905677">,</span>&nbsp;<span class="ident" id="7905679">Seq</span><span class="op" id="7905682">:</span>&nbsp;<span class="ident" id="7905684"><a href="/net/ipraw_test.go.html#7905563">xseq</a></span><span class="op" id="7905688">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905694">Data</span><span class="op" id="7905698">:</span>&nbsp;<span class="ident" id="7905700"><a href="/net/ipraw_test.go.html#7902394">bytes</a></span><span class="op" id="7905705">.</span><span class="ident" id="7905706">Repeat</span><span class="op" id="7905712">(</span><span class="op" id="7905713">[</span><span class="op" id="7905714">]</span><span class="builtintype" id="7905715">byte</span><span class="op" id="7905719">(</span><span class="string" id="7905720">&#34;Go&nbsp;Go&nbsp;Gadget&nbsp;Ping!!!&#34;</span><span class="op" id="7905742">)</span><span class="op" id="7905743">,</span>&nbsp;<span class="num" id="7905745">3</span><span class="op" id="7905746">)</span><span class="op" id="7905747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905752">}</span><span class="op" id="7905753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905757">}</span><span class="op" id="7905758">)</span><span class="op" id="7905759">.</span><span class="ident" id="7905760">Marshal</span><span class="op" id="7905767">(</span><span class="op" id="7905768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905772">if</span>&nbsp;<span class="ident" id="7905775"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7905779">!=</span>&nbsp;<span class="ident" id="7905782">nil</span>&nbsp;<span class="op" id="7905786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905791"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7905792">.</span><span class="ident" id="7905793">Fatalf</span><span class="op" id="7905799">(</span><span class="string" id="7905800">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7905832">,</span>&nbsp;<span class="ident" id="7905834"><a href="/net/ipraw_test.go.html#7905162">err</a></span><span class="op" id="7905837">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905845">if</span>&nbsp;<span class="ident" id="7905848">_</span><span class="op" id="7905849">,</span>&nbsp;<span class="ident" id="7905851">err</span>&nbsp;<span class="op" id="7905855">:=</span>&nbsp;<span class="ident" id="7905858"><a href="/net/ipraw_test.go.html#7905312">c</a></span><span class="op" id="7905859">.</span><span class="ident" id="7905860">Write</span><span class="op" id="7905865">(</span><span class="ident" id="7905866"><a href="/net/ipraw_test.go.html#7905597">wb</a></span><span class="op" id="7905868">)</span><span class="op" id="7905869">;</span>&nbsp;<span class="ident" id="7905871"><a href="/net/ipraw_test.go.html#7905851">err</a></span>&nbsp;<span class="op" id="7905875">!=</span>&nbsp;<span class="ident" id="7905878">nil</span>&nbsp;<span class="op" id="7905882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905887"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7905888">.</span><span class="ident" id="7905889">Fatalf</span><span class="op" id="7905895">(</span><span class="string" id="7905896">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7905919">,</span>&nbsp;<span class="ident" id="7905921"><a href="/net/ipraw_test.go.html#7905851">err</a></span><span class="op" id="7905924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7905928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905932">var</span>&nbsp;<span class="ident" id="7905936">m</span>&nbsp;<span class="op" id="7905938">*</span><span class="ident" id="7905939"><a href="/net/mockicmp_test.go.html#7921437">icmpMessage</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7905953">rb</span>&nbsp;<span class="op" id="7905956">:=</span>&nbsp;<span class="builtinfunc" id="7905959">make</span><span class="op" id="7905963">(</span><span class="op" id="7905964">[</span><span class="op" id="7905965">]</span><span class="builtintype" id="7905966">byte</span><span class="op" id="7905970">,</span>&nbsp;<span class="num" id="7905972">20</span><span class="op" id="7905974">+</span><span class="builtinfunc" id="7905975">len</span><span class="op" id="7905978">(</span><span class="ident" id="7905979"><a href="/net/ipraw_test.go.html#7905597">wb</a></span><span class="op" id="7905981">)</span><span class="op" id="7905982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905986">for</span>&nbsp;<span class="op" id="7905990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7905995">if</span>&nbsp;<span class="ident" id="7905998">_</span><span class="op" id="7905999">,</span>&nbsp;<span class="ident" id="7906001">err</span>&nbsp;<span class="op" id="7906005">:=</span>&nbsp;<span class="ident" id="7906008"><a href="/net/ipraw_test.go.html#7905312">c</a></span><span class="op" id="7906009">.</span><span class="ident" id="7906010">Read</span><span class="op" id="7906014">(</span><span class="ident" id="7906015"><a href="/net/ipraw_test.go.html#7905953">rb</a></span><span class="op" id="7906017">)</span><span class="op" id="7906018">;</span>&nbsp;<span class="ident" id="7906020"><a href="/net/ipraw_test.go.html#7906001">err</a></span>&nbsp;<span class="op" id="7906024">!=</span>&nbsp;<span class="ident" id="7906027">nil</span>&nbsp;<span class="op" id="7906031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906037"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7906038">.</span><span class="ident" id="7906039">Fatalf</span><span class="op" id="7906045">(</span><span class="string" id="7906046">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7906068">,</span>&nbsp;<span class="ident" id="7906070"><a href="/net/ipraw_test.go.html#7906001">err</a></span><span class="op" id="7906073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906078">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906083">if</span>&nbsp;<span class="ident" id="7906086"><a href="/net/ipraw_test.go.html#7905154">net</a></span>&nbsp;<span class="op" id="7906090">==</span>&nbsp;<span class="string" id="7906093">&#34;ip4&#34;</span>&nbsp;<span class="op" id="7906099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906105"><a href="/net/ipraw_test.go.html#7905953">rb</a></span>&nbsp;<span class="op" id="7906108">=</span>&nbsp;<span class="ident" id="7906110"><a href="/net/ipraw_test.go.html#7908427">ipv4Payload</a></span><span class="op" id="7906121">(</span><span class="ident" id="7906122"><a href="/net/ipraw_test.go.html#7905953">rb</a></span><span class="op" id="7906124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906134">if</span>&nbsp;<span class="ident" id="7906137"><a href="/net/ipraw_test.go.html#7905936">m</a></span><span class="op" id="7906138">,</span>&nbsp;<span class="ident" id="7906140"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7906144">=</span>&nbsp;<span class="ident" id="7906146"><a href="/net/mockicmp_test.go.html#7922561">parseICMPMessage</a></span><span class="op" id="7906162">(</span><span class="ident" id="7906163"><a href="/net/ipraw_test.go.html#7905953">rb</a></span><span class="op" id="7906165">)</span><span class="op" id="7906166">;</span>&nbsp;<span class="ident" id="7906168"><a href="/net/ipraw_test.go.html#7905162">err</a></span>&nbsp;<span class="op" id="7906172">!=</span>&nbsp;<span class="ident" id="7906175">nil</span>&nbsp;<span class="op" id="7906179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906185"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7906186">.</span><span class="ident" id="7906187">Fatalf</span><span class="op" id="7906193">(</span><span class="string" id="7906194">&#34;parseICMPMessage&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7906223">,</span>&nbsp;<span class="ident" id="7906225"><a href="/net/ipraw_test.go.html#7905162">err</a></span><span class="op" id="7906228">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906238">switch</span>&nbsp;<span class="ident" id="7906245"><a href="/net/ipraw_test.go.html#7905936">m</a></span><span class="op" id="7906246">.</span><span class="ident" id="7906247">Type</span>&nbsp;<span class="op" id="7906252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906257">case</span>&nbsp;<span class="ident" id="7906262"><a href="/net/mockicmp_test.go.html#7921291">icmpv4EchoRequest</a></span><span class="op" id="7906279">,</span>&nbsp;<span class="ident" id="7906281"><a href="/net/mockicmp_test.go.html#7921337">icmpv6EchoRequest</a></span><span class="op" id="7906298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906304">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906316">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906321">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906333">switch</span>&nbsp;<span class="ident" id="7906340">p</span>&nbsp;<span class="op" id="7906342">:=</span>&nbsp;<span class="ident" id="7906345"><a href="/net/ipraw_test.go.html#7905936">m</a></span><span class="op" id="7906346">.</span><span class="ident" id="7906347">Body</span><span class="op" id="7906351">.</span><span class="op" id="7906352">(</span><span class="keyword" id="7906353">type</span><span class="op" id="7906357">)</span>&nbsp;<span class="op" id="7906359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906363">case</span>&nbsp;<span class="op" id="7906368">*</span><span class="ident" id="7906369"><a href="/net/mockicmp_test.go.html#7923095">icmpEcho</a></span><span class="op" id="7906377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906382">if</span>&nbsp;<span class="ident" id="7906385"><a href="/net/ipraw_test.go.html#7906340">p</a></span><span class="op" id="7906386">.</span><span class="ident" id="7906387">ID</span>&nbsp;<span class="op" id="7906390">!=</span>&nbsp;<span class="ident" id="7906393"><a href="/net/ipraw_test.go.html#7905558">xid</a></span>&nbsp;<span class="op" id="7906397">||</span>&nbsp;<span class="ident" id="7906400"><a href="/net/ipraw_test.go.html#7906340">p</a></span><span class="op" id="7906401">.</span><span class="ident" id="7906402">Seq</span>&nbsp;<span class="op" id="7906406">!=</span>&nbsp;<span class="ident" id="7906409"><a href="/net/ipraw_test.go.html#7905563">xseq</a></span>&nbsp;<span class="op" id="7906414">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906420"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7906421">.</span><span class="ident" id="7906422">Fatalf</span><span class="op" id="7906428">(</span><span class="string" id="7906429">&#34;got&nbsp;id=%v,&nbsp;seqnum=%v;&nbsp;expected&nbsp;id=%v,&nbsp;seqnum=%v&#34;</span><span class="op" id="7906478">,</span>&nbsp;<span class="ident" id="7906480"><a href="/net/ipraw_test.go.html#7906340">p</a></span><span class="op" id="7906481">.</span><span class="ident" id="7906482">ID</span><span class="op" id="7906484">,</span>&nbsp;<span class="ident" id="7906486"><a href="/net/ipraw_test.go.html#7906340">p</a></span><span class="op" id="7906487">.</span><span class="ident" id="7906488">Seq</span><span class="op" id="7906491">,</span>&nbsp;<span class="ident" id="7906493"><a href="/net/ipraw_test.go.html#7905558">xid</a></span><span class="op" id="7906496">,</span>&nbsp;<span class="ident" id="7906498"><a href="/net/ipraw_test.go.html#7905563">xseq</a></span><span class="op" id="7906502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906511">default</span><span class="op" id="7906518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906523"><a href="/net/ipraw_test.go.html#7905028">t</a></span><span class="op" id="7906524">.</span><span class="ident" id="7906525">Fatalf</span><span class="op" id="7906531">(</span><span class="string" id="7906532">&#34;got&nbsp;type=%v,&nbsp;code=%v;&nbsp;expected&nbsp;type=%v,&nbsp;code=%v&#34;</span><span class="op" id="7906581">,</span>&nbsp;<span class="ident" id="7906583"><a href="/net/ipraw_test.go.html#7905936">m</a></span><span class="op" id="7906584">.</span><span class="ident" id="7906585">Type</span><span class="op" id="7906589">,</span>&nbsp;<span class="ident" id="7906591"><a href="/net/ipraw_test.go.html#7905936">m</a></span><span class="op" id="7906592">.</span><span class="ident" id="7906593">Code</span><span class="op" id="7906597">,</span>&nbsp;<span class="ident" id="7906599"><a href="/net/ipraw_test.go.html#7905480">typ</a></span><span class="op" id="7906602">,</span>&nbsp;<span class="num" id="7906604">0</span><span class="op" id="7906605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906609">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906612">}</span><br>
<span class="lineno"></span><span class="op" id="7906614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7906617">func</span>&nbsp;<span class="ident" id="7906622">TestPacketConnICMPEcho</span><span class="op" id="7906644">(</span><span class="ident" id="7906645">t</span>&nbsp;<span class="op" id="7906647">*</span><span class="ident" id="7906648"><a href="/net/ipraw_test.go.html#7902438">testing</a></span><span class="op" id="7906655">.</span><span class="ident" id="7906656">T</span><span class="op" id="7906657">)</span>&nbsp;<span class="op" id="7906659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906662">if</span>&nbsp;<span class="ident" id="7906665">skip</span><span class="op" id="7906669">,</span>&nbsp;<span class="ident" id="7906671">skipmsg</span>&nbsp;<span class="op" id="7906679">:=</span>&nbsp;<span class="ident" id="7906682"><a href="/net/ipraw_test.go.html#7904256">skipRawSocketTest</a></span><span class="op" id="7906699">(</span><span class="ident" id="7906700"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7906701">)</span><span class="op" id="7906702">;</span>&nbsp;<span class="ident" id="7906704"><a href="/net/ipraw_test.go.html#7906665">skip</a></span>&nbsp;<span class="op" id="7906709">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906713"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7906714">.</span><span class="ident" id="7906715">Skip</span><span class="op" id="7906719">(</span><span class="ident" id="7906720"><a href="/net/ipraw_test.go.html#7906671">skipmsg</a></span><span class="op" id="7906727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906734">for</span>&nbsp;<span class="ident" id="7906738">i</span><span class="op" id="7906739">,</span>&nbsp;<span class="ident" id="7906741">tt</span>&nbsp;<span class="op" id="7906744">:=</span>&nbsp;<span class="keyword" id="7906747">range</span>&nbsp;<span class="ident" id="7906753"><a href="/net/ipraw_test.go.html#7904859">icmpEchoTests</a></span>&nbsp;<span class="op" id="7906767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906771">net</span><span class="op" id="7906774">,</span>&nbsp;<span class="ident" id="7906776">_</span><span class="op" id="7906777">,</span>&nbsp;<span class="ident" id="7906779">err</span>&nbsp;<span class="op" id="7906783">:=</span>&nbsp;<span class="ident" id="7906786"><a href="/net/dial.go.html#1332358">parseNetwork</a></span><span class="op" id="7906798">(</span><span class="ident" id="7906799"><a href="/net/ipraw_test.go.html#7906741">tt</a></span><span class="op" id="7906801">.</span><span class="ident" id="7906802">net</span><span class="op" id="7906805">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906809">if</span>&nbsp;<span class="ident" id="7906812"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7906816">!=</span>&nbsp;<span class="ident" id="7906819">nil</span>&nbsp;<span class="op" id="7906823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906828"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7906829">.</span><span class="ident" id="7906830">Fatalf</span><span class="op" id="7906836">(</span><span class="string" id="7906837">&#34;parseNetwork&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7906862">,</span>&nbsp;<span class="ident" id="7906864"><a href="/net/ipraw_test.go.html#7906779">err</a></span><span class="op" id="7906867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906875">if</span>&nbsp;<span class="ident" id="7906878"><a href="/net/ipraw_test.go.html#7906771">net</a></span>&nbsp;<span class="op" id="7906882">==</span>&nbsp;<span class="string" id="7906885">&#34;ip6&#34;</span>&nbsp;<span class="op" id="7906891">&amp;&amp;</span>&nbsp;<span class="op" id="7906894">!</span><span class="ident" id="7906895"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7906908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906913">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7906924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906929">c</span><span class="op" id="7906930">,</span>&nbsp;<span class="ident" id="7906932"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7906936">:=</span>&nbsp;<span class="ident" id="7906939"><a href="/net/dial.go.html#1338827">ListenPacket</a></span><span class="op" id="7906951">(</span><span class="ident" id="7906952"><a href="/net/ipraw_test.go.html#7906741">tt</a></span><span class="op" id="7906954">.</span><span class="ident" id="7906955">net</span><span class="op" id="7906958">,</span>&nbsp;<span class="ident" id="7906960"><a href="/net/ipraw_test.go.html#7906741">tt</a></span><span class="op" id="7906962">.</span><span class="ident" id="7906963">laddr</span><span class="op" id="7906968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7906972">if</span>&nbsp;<span class="ident" id="7906975"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7906979">!=</span>&nbsp;<span class="ident" id="7906982">nil</span>&nbsp;<span class="op" id="7906986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7906991"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7906992">.</span><span class="ident" id="7906993">Fatalf</span><span class="op" id="7906999">(</span><span class="string" id="7907000">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7907025">,</span>&nbsp;<span class="ident" id="7907027"><a href="/net/ipraw_test.go.html#7906779">err</a></span><span class="op" id="7907030">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907038"><a href="/net/ipraw_test.go.html#7906929">c</a></span><span class="op" id="7907039">.</span><span class="ident" id="7907040">SetDeadline</span><span class="op" id="7907051">(</span><span class="ident" id="7907052"><a href="/net/ipraw_test.go.html#7902449">time</a></span><span class="op" id="7907056">.</span><span class="ident" id="7907057">Now</span><span class="op" id="7907060">(</span><span class="op" id="7907061">)</span><span class="op" id="7907062">.</span><span class="ident" id="7907063">Add</span><span class="op" id="7907066">(</span><span class="num" id="7907067">100</span>&nbsp;<span class="op" id="7907071">*</span>&nbsp;<span class="ident" id="7907073"><a href="/net/ipraw_test.go.html#7902449">time</a></span><span class="op" id="7907077">.</span><span class="ident" id="7907078">Millisecond</span><span class="op" id="7907089">)</span><span class="op" id="7907090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907094">defer</span>&nbsp;<span class="ident" id="7907100"><a href="/net/ipraw_test.go.html#7906929">c</a></span><span class="op" id="7907101">.</span><span class="ident" id="7907102">Close</span><span class="op" id="7907107">(</span><span class="op" id="7907108">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907113">ra</span><span class="op" id="7907115">,</span>&nbsp;<span class="ident" id="7907117"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7907121">:=</span>&nbsp;<span class="ident" id="7907124"><a href="/net/iprawsock.go.html#1432625">ResolveIPAddr</a></span><span class="op" id="7907137">(</span><span class="ident" id="7907138"><a href="/net/ipraw_test.go.html#7906741">tt</a></span><span class="op" id="7907140">.</span><span class="ident" id="7907141">net</span><span class="op" id="7907144">,</span>&nbsp;<span class="ident" id="7907146"><a href="/net/ipraw_test.go.html#7906741">tt</a></span><span class="op" id="7907148">.</span><span class="ident" id="7907149">raddr</span><span class="op" id="7907154">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907158">if</span>&nbsp;<span class="ident" id="7907161"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7907165">!=</span>&nbsp;<span class="ident" id="7907168">nil</span>&nbsp;<span class="op" id="7907172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907177"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7907178">.</span><span class="ident" id="7907179">Fatalf</span><span class="op" id="7907185">(</span><span class="string" id="7907186">&#34;ResolveIPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7907212">,</span>&nbsp;<span class="ident" id="7907214"><a href="/net/ipraw_test.go.html#7906779">err</a></span><span class="op" id="7907217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907225">typ</span>&nbsp;<span class="op" id="7907229">:=</span>&nbsp;<span class="ident" id="7907232"><a href="/net/mockicmp_test.go.html#7921291">icmpv4EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907252">if</span>&nbsp;<span class="ident" id="7907255"><a href="/net/ipraw_test.go.html#7906771">net</a></span>&nbsp;<span class="op" id="7907259">==</span>&nbsp;<span class="string" id="7907262">&#34;ip6&#34;</span>&nbsp;<span class="op" id="7907268">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907273"><a href="/net/ipraw_test.go.html#7907225">typ</a></span>&nbsp;<span class="op" id="7907277">=</span>&nbsp;<span class="ident" id="7907279"><a href="/net/mockicmp_test.go.html#7921337">icmpv6EchoRequest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907303">xid</span><span class="op" id="7907306">,</span>&nbsp;<span class="ident" id="7907308">xseq</span>&nbsp;<span class="op" id="7907313">:=</span>&nbsp;<span class="ident" id="7907316"><a href="/net/ipraw_test.go.html#7902410">os</a></span><span class="op" id="7907318">.</span><span class="ident" id="7907319">Getpid</span><span class="op" id="7907325">(</span><span class="op" id="7907326">)</span><span class="op" id="7907327">&amp;</span><span class="num" id="7907328">0xffff</span><span class="op" id="7907334">,</span>&nbsp;<span class="ident" id="7907336"><a href="/net/ipraw_test.go.html#7906738">i</a></span><span class="op" id="7907337">+</span><span class="num" id="7907338">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907342">wb</span><span class="op" id="7907344">,</span>&nbsp;<span class="ident" id="7907346"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7907350">:=</span>&nbsp;<span class="op" id="7907353">(</span><span class="op" id="7907354">&amp;</span><span class="ident" id="7907355"><a href="/net/mockicmp_test.go.html#7921437">icmpMessage</a></span><span class="op" id="7907366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907371">Type</span><span class="op" id="7907375">:</span>&nbsp;<span class="ident" id="7907377"><a href="/net/ipraw_test.go.html#7907225">typ</a></span><span class="op" id="7907380">,</span>&nbsp;<span class="ident" id="7907382">Code</span><span class="op" id="7907386">:</span>&nbsp;<span class="num" id="7907388">0</span><span class="op" id="7907389">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907394">Body</span><span class="op" id="7907398">:</span>&nbsp;<span class="op" id="7907400">&amp;</span><span class="ident" id="7907401"><a href="/net/mockicmp_test.go.html#7923095">icmpEcho</a></span><span class="op" id="7907409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907415">ID</span><span class="op" id="7907417">:</span>&nbsp;<span class="ident" id="7907419"><a href="/net/ipraw_test.go.html#7907303">xid</a></span><span class="op" id="7907422">,</span>&nbsp;<span class="ident" id="7907424">Seq</span><span class="op" id="7907427">:</span>&nbsp;<span class="ident" id="7907429"><a href="/net/ipraw_test.go.html#7907308">xseq</a></span><span class="op" id="7907433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907439">Data</span><span class="op" id="7907443">:</span>&nbsp;<span class="ident" id="7907445"><a href="/net/ipraw_test.go.html#7902394">bytes</a></span><span class="op" id="7907450">.</span><span class="ident" id="7907451">Repeat</span><span class="op" id="7907457">(</span><span class="op" id="7907458">[</span><span class="op" id="7907459">]</span><span class="builtintype" id="7907460">byte</span><span class="op" id="7907464">(</span><span class="string" id="7907465">&#34;Go&nbsp;Go&nbsp;Gadget&nbsp;Ping!!!&#34;</span><span class="op" id="7907487">)</span><span class="op" id="7907488">,</span>&nbsp;<span class="num" id="7907490">3</span><span class="op" id="7907491">)</span><span class="op" id="7907492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907497">}</span><span class="op" id="7907498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907502">}</span><span class="op" id="7907503">)</span><span class="op" id="7907504">.</span><span class="ident" id="7907505">Marshal</span><span class="op" id="7907512">(</span><span class="op" id="7907513">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907517">if</span>&nbsp;<span class="ident" id="7907520"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7907524">!=</span>&nbsp;<span class="ident" id="7907527">nil</span>&nbsp;<span class="op" id="7907531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907536"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7907537">.</span><span class="ident" id="7907538">Fatalf</span><span class="op" id="7907544">(</span><span class="string" id="7907545">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7907577">,</span>&nbsp;<span class="ident" id="7907579"><a href="/net/ipraw_test.go.html#7906779">err</a></span><span class="op" id="7907582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907590">if</span>&nbsp;<span class="ident" id="7907593">_</span><span class="op" id="7907594">,</span>&nbsp;<span class="ident" id="7907596">err</span>&nbsp;<span class="op" id="7907600">:=</span>&nbsp;<span class="ident" id="7907603"><a href="/net/ipraw_test.go.html#7906929">c</a></span><span class="op" id="7907604">.</span><span class="ident" id="7907605">WriteTo</span><span class="op" id="7907612">(</span><span class="ident" id="7907613"><a href="/net/ipraw_test.go.html#7907342">wb</a></span><span class="op" id="7907615">,</span>&nbsp;<span class="ident" id="7907617"><a href="/net/ipraw_test.go.html#7907113">ra</a></span><span class="op" id="7907619">)</span><span class="op" id="7907620">;</span>&nbsp;<span class="ident" id="7907622"><a href="/net/ipraw_test.go.html#7907596">err</a></span>&nbsp;<span class="op" id="7907626">!=</span>&nbsp;<span class="ident" id="7907629">nil</span>&nbsp;<span class="op" id="7907633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907638"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7907639">.</span><span class="ident" id="7907640">Fatalf</span><span class="op" id="7907646">(</span><span class="string" id="7907647">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7907678">,</span>&nbsp;<span class="ident" id="7907680"><a href="/net/ipraw_test.go.html#7907596">err</a></span><span class="op" id="7907683">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907691">var</span>&nbsp;<span class="ident" id="7907695">m</span>&nbsp;<span class="op" id="7907697">*</span><span class="ident" id="7907698"><a href="/net/mockicmp_test.go.html#7921437">icmpMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907712">rb</span>&nbsp;<span class="op" id="7907715">:=</span>&nbsp;<span class="builtinfunc" id="7907718">make</span><span class="op" id="7907722">(</span><span class="op" id="7907723">[</span><span class="op" id="7907724">]</span><span class="builtintype" id="7907725">byte</span><span class="op" id="7907729">,</span>&nbsp;<span class="num" id="7907731">20</span><span class="op" id="7907733">+</span><span class="builtinfunc" id="7907734">len</span><span class="op" id="7907737">(</span><span class="ident" id="7907738"><a href="/net/ipraw_test.go.html#7907342">wb</a></span><span class="op" id="7907740">)</span><span class="op" id="7907741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907745">for</span>&nbsp;<span class="op" id="7907749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907754">if</span>&nbsp;<span class="ident" id="7907757">_</span><span class="op" id="7907758">,</span>&nbsp;<span class="ident" id="7907760">_</span><span class="op" id="7907761">,</span>&nbsp;<span class="ident" id="7907763">err</span>&nbsp;<span class="op" id="7907767">:=</span>&nbsp;<span class="ident" id="7907770"><a href="/net/ipraw_test.go.html#7906929">c</a></span><span class="op" id="7907771">.</span><span class="ident" id="7907772">ReadFrom</span><span class="op" id="7907780">(</span><span class="ident" id="7907781"><a href="/net/ipraw_test.go.html#7907712">rb</a></span><span class="op" id="7907783">)</span><span class="op" id="7907784">;</span>&nbsp;<span class="ident" id="7907786"><a href="/net/ipraw_test.go.html#7907763">err</a></span>&nbsp;<span class="op" id="7907790">!=</span>&nbsp;<span class="ident" id="7907793">nil</span>&nbsp;<span class="op" id="7907797">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907803"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7907804">.</span><span class="ident" id="7907805">Fatalf</span><span class="op" id="7907811">(</span><span class="string" id="7907812">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7907844">,</span>&nbsp;<span class="ident" id="7907846"><a href="/net/ipraw_test.go.html#7907763">err</a></span><span class="op" id="7907849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7907854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7907859">//&nbsp;See&nbsp;BUG&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7907882">//if&nbsp;net&nbsp;==&nbsp;&#34;ip4&#34;&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7907905">//&nbsp;&nbsp;&nbsp;&nbsprb&nbsp;=&nbsp;ipv4Payload(rb)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7907932">//}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7907939">if</span>&nbsp;<span class="ident" id="7907942"><a href="/net/ipraw_test.go.html#7907695">m</a></span><span class="op" id="7907943">,</span>&nbsp;<span class="ident" id="7907945"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7907949">=</span>&nbsp;<span class="ident" id="7907951"><a href="/net/mockicmp_test.go.html#7922561">parseICMPMessage</a></span><span class="op" id="7907967">(</span><span class="ident" id="7907968"><a href="/net/ipraw_test.go.html#7907712">rb</a></span><span class="op" id="7907970">)</span><span class="op" id="7907971">;</span>&nbsp;<span class="ident" id="7907973"><a href="/net/ipraw_test.go.html#7906779">err</a></span>&nbsp;<span class="op" id="7907977">!=</span>&nbsp;<span class="ident" id="7907980">nil</span>&nbsp;<span class="op" id="7907984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7907990"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7907991">.</span><span class="ident" id="7907992">Fatalf</span><span class="op" id="7907998">(</span><span class="string" id="7907999">&#34;parseICMPMessage&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7908028">,</span>&nbsp;<span class="ident" id="7908030"><a href="/net/ipraw_test.go.html#7906779">err</a></span><span class="op" id="7908033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908043">switch</span>&nbsp;<span class="ident" id="7908050"><a href="/net/ipraw_test.go.html#7907695">m</a></span><span class="op" id="7908051">.</span><span class="ident" id="7908052">Type</span>&nbsp;<span class="op" id="7908057">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908062">case</span>&nbsp;<span class="ident" id="7908067"><a href="/net/mockicmp_test.go.html#7921291">icmpv4EchoRequest</a></span><span class="op" id="7908084">,</span>&nbsp;<span class="ident" id="7908086"><a href="/net/mockicmp_test.go.html#7921337">icmpv6EchoRequest</a></span><span class="op" id="7908103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908109">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908126">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908134">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908138">switch</span>&nbsp;<span class="ident" id="7908145">p</span>&nbsp;<span class="op" id="7908147">:=</span>&nbsp;<span class="ident" id="7908150"><a href="/net/ipraw_test.go.html#7907695">m</a></span><span class="op" id="7908151">.</span><span class="ident" id="7908152">Body</span><span class="op" id="7908156">.</span><span class="op" id="7908157">(</span><span class="keyword" id="7908158">type</span><span class="op" id="7908162">)</span>&nbsp;<span class="op" id="7908164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908168">case</span>&nbsp;<span class="op" id="7908173">*</span><span class="ident" id="7908174"><a href="/net/mockicmp_test.go.html#7923095">icmpEcho</a></span><span class="op" id="7908182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908187">if</span>&nbsp;<span class="ident" id="7908190"><a href="/net/ipraw_test.go.html#7908145">p</a></span><span class="op" id="7908191">.</span><span class="ident" id="7908192">ID</span>&nbsp;<span class="op" id="7908195">!=</span>&nbsp;<span class="ident" id="7908198"><a href="/net/ipraw_test.go.html#7907303">xid</a></span>&nbsp;<span class="op" id="7908202">||</span>&nbsp;<span class="ident" id="7908205"><a href="/net/ipraw_test.go.html#7908145">p</a></span><span class="op" id="7908206">.</span><span class="ident" id="7908207">Seq</span>&nbsp;<span class="op" id="7908211">!=</span>&nbsp;<span class="ident" id="7908214"><a href="/net/ipraw_test.go.html#7907308">xseq</a></span>&nbsp;<span class="op" id="7908219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908225"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7908226">.</span><span class="ident" id="7908227">Fatalf</span><span class="op" id="7908233">(</span><span class="string" id="7908234">&#34;got&nbsp;id=%v,&nbsp;seqnum=%v;&nbsp;expected&nbsp;id=%v,&nbsp;seqnum=%v&#34;</span><span class="op" id="7908283">,</span>&nbsp;<span class="ident" id="7908285"><a href="/net/ipraw_test.go.html#7908145">p</a></span><span class="op" id="7908286">.</span><span class="ident" id="7908287">ID</span><span class="op" id="7908289">,</span>&nbsp;<span class="ident" id="7908291"><a href="/net/ipraw_test.go.html#7908145">p</a></span><span class="op" id="7908292">.</span><span class="ident" id="7908293">Seq</span><span class="op" id="7908296">,</span>&nbsp;<span class="ident" id="7908298"><a href="/net/ipraw_test.go.html#7907303">xid</a></span><span class="op" id="7908301">,</span>&nbsp;<span class="ident" id="7908303"><a href="/net/ipraw_test.go.html#7907308">xseq</a></span><span class="op" id="7908307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908312">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908316">default</span><span class="op" id="7908323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908328"><a href="/net/ipraw_test.go.html#7906645">t</a></span><span class="op" id="7908329">.</span><span class="ident" id="7908330">Fatalf</span><span class="op" id="7908336">(</span><span class="string" id="7908337">&#34;got&nbsp;type=%v,&nbsp;code=%v;&nbsp;expected&nbsp;type=%v,&nbsp;code=%v&#34;</span><span class="op" id="7908386">,</span>&nbsp;<span class="ident" id="7908388"><a href="/net/ipraw_test.go.html#7907695">m</a></span><span class="op" id="7908389">.</span><span class="ident" id="7908390">Type</span><span class="op" id="7908394">,</span>&nbsp;<span class="ident" id="7908396"><a href="/net/ipraw_test.go.html#7907695">m</a></span><span class="op" id="7908397">.</span><span class="ident" id="7908398">Code</span><span class="op" id="7908402">,</span>&nbsp;<span class="ident" id="7908404"><a href="/net/ipraw_test.go.html#7907225">typ</a></span><span class="op" id="7908407">,</span>&nbsp;<span class="num" id="7908409">0</span><span class="op" id="7908410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908417">}</span><br>
<span class="lineno"></span><span class="op" id="7908419">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="7908422">func</span>&nbsp;<span class="ident" id="7908427">ipv4Payload</span><span class="op" id="7908438">(</span><span class="ident" id="7908439">b</span>&nbsp;<span class="op" id="7908441">[</span><span class="op" id="7908442">]</span><span class="builtintype" id="7908443">byte</span><span class="op" id="7908447">)</span>&nbsp;<span class="op" id="7908449">[</span><span class="op" id="7908450">]</span><span class="builtintype" id="7908451">byte</span>&nbsp;<span class="op" id="7908456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908459">if</span>&nbsp;<span class="builtinfunc" id="7908462">len</span><span class="op" id="7908465">(</span><span class="ident" id="7908466"><a href="/net/ipraw_test.go.html#7908439">b</a></span><span class="op" id="7908467">)</span>&nbsp;<span class="op" id="7908469">&lt;</span>&nbsp;<span class="num" id="7908471">20</span>&nbsp;<span class="op" id="7908474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908478">return</span>&nbsp;<span class="ident" id="7908485"><a href="/net/ipraw_test.go.html#7908439">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908488">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908491">hdrlen</span>&nbsp;<span class="op" id="7908498">:=</span>&nbsp;<span class="builtintype" id="7908501">int</span><span class="op" id="7908504">(</span><span class="ident" id="7908505"><a href="/net/ipraw_test.go.html#7908439">b</a></span><span class="op" id="7908506">[</span><span class="num" id="7908507">0</span><span class="op" id="7908508">]</span><span class="op" id="7908509">&amp;</span><span class="num" id="7908510">0x0f</span><span class="op" id="7908514">)</span>&nbsp;<span class="op" id="7908516">&lt;&lt;</span>&nbsp;<span class="num" id="7908519">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908522">return</span>&nbsp;<span class="ident" id="7908529"><a href="/net/ipraw_test.go.html#7908439">b</a></span><span class="op" id="7908530">[</span><span class="ident" id="7908531"><a href="/net/ipraw_test.go.html#7908491">hdrlen</a></span><span class="op" id="7908537">:</span><span class="op" id="7908538">]</span><br>
<span class="lineno"></span><span class="op" id="7908540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7908543">var</span>&nbsp;<span class="ident" id="7908547">ipConnLocalNameTests</span>&nbsp;<span class="op" id="7908568">=</span>&nbsp;<span class="op" id="7908570">[</span><span class="op" id="7908571">]</span><span class="keyword" id="7908572">struct</span>&nbsp;<span class="op" id="7908579">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908582">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7908588">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908596">laddr</span>&nbsp;<span class="op" id="7908602">*</span><span class="ident" id="7908603"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><br>
<span class="lineno"></span><span class="op" id="7908610">}</span><span class="op" id="7908611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908614">{</span><span class="string" id="7908615">&#34;ip4:icmp&#34;</span><span class="op" id="7908625">,</span>&nbsp;<span class="op" id="7908627">&amp;</span><span class="ident" id="7908628"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7908634">{</span><span class="ident" id="7908635">IP</span><span class="op" id="7908637">:</span>&nbsp;<span class="ident" id="7908639"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7908643">(</span><span class="num" id="7908644">127</span><span class="op" id="7908647">,</span>&nbsp;<span class="num" id="7908649">0</span><span class="op" id="7908650">,</span>&nbsp;<span class="num" id="7908652">0</span><span class="op" id="7908653">,</span>&nbsp;<span class="num" id="7908655">1</span><span class="op" id="7908656">)</span><span class="op" id="7908657">}</span><span class="op" id="7908658">}</span><span class="op" id="7908659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908662">{</span><span class="string" id="7908663">&#34;ip4:icmp&#34;</span><span class="op" id="7908673">,</span>&nbsp;<span class="op" id="7908675">&amp;</span><span class="ident" id="7908676"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7908682">{</span><span class="op" id="7908683">}</span><span class="op" id="7908684">}</span><span class="op" id="7908685">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908688">{</span><span class="string" id="7908689">&#34;ip4:icmp&#34;</span><span class="op" id="7908699">,</span>&nbsp;<span class="ident" id="7908701">nil</span><span class="op" id="7908704">}</span><span class="op" id="7908705">,</span><br>
<span class="lineno"></span><span class="op" id="7908707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7908710">func</span>&nbsp;<span class="ident" id="7908715">TestIPConnLocalName</span><span class="op" id="7908734">(</span><span class="ident" id="7908735">t</span>&nbsp;<span class="op" id="7908737">*</span><span class="ident" id="7908738"><a href="/net/ipraw_test.go.html#7902438">testing</a></span><span class="op" id="7908745">.</span><span class="ident" id="7908746">T</span><span class="op" id="7908747">)</span>&nbsp;<span class="op" id="7908749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908752">switch</span>&nbsp;<span class="ident" id="7908759"><a href="/net/ipraw_test.go.html#7902427">runtime</a></span><span class="op" id="7908766">.</span><span class="ident" id="7908767">GOOS</span>&nbsp;<span class="op" id="7908772">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908775">case</span>&nbsp;<span class="string" id="7908780">&#34;nacl&#34;</span><span class="op" id="7908786">,</span>&nbsp;<span class="string" id="7908788">&#34;plan9&#34;</span><span class="op" id="7908795">,</span>&nbsp;<span class="string" id="7908797">&#34;windows&#34;</span><span class="op" id="7908806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908810"><a href="/net/ipraw_test.go.html#7908735">t</a></span><span class="op" id="7908811">.</span><span class="ident" id="7908812">Skipf</span><span class="op" id="7908817">(</span><span class="string" id="7908818">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7908839">,</span>&nbsp;<span class="ident" id="7908841"><a href="/net/ipraw_test.go.html#7902427">runtime</a></span><span class="op" id="7908848">.</span><span class="ident" id="7908849">GOOS</span><span class="op" id="7908853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908856">default</span><span class="op" id="7908863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908867">if</span>&nbsp;<span class="ident" id="7908870"><a href="/net/ipraw_test.go.html#7902410">os</a></span><span class="op" id="7908872">.</span><span class="ident" id="7908873">Getuid</span><span class="op" id="7908879">(</span><span class="op" id="7908880">)</span>&nbsp;<span class="op" id="7908882">!=</span>&nbsp;<span class="num" id="7908885">0</span>&nbsp;<span class="op" id="7908887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908892"><a href="/net/ipraw_test.go.html#7908735">t</a></span><span class="op" id="7908893">.</span><span class="ident" id="7908894">Skip</span><span class="op" id="7908898">(</span><span class="string" id="7908899">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="7908928">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7908935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7908939">for</span>&nbsp;<span class="ident" id="7908943">_</span><span class="op" id="7908944">,</span>&nbsp;<span class="ident" id="7908946">tt</span>&nbsp;<span class="op" id="7908949">:=</span>&nbsp;<span class="keyword" id="7908952">range</span>&nbsp;<span class="ident" id="7908958"><a href="/net/ipraw_test.go.html#7908547">ipConnLocalNameTests</a></span>&nbsp;<span class="op" id="7908979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7908983">c</span><span class="op" id="7908984">,</span>&nbsp;<span class="ident" id="7908986">err</span>&nbsp;<span class="op" id="7908990">:=</span>&nbsp;<span class="ident" id="7908993"><a href="/net/iprawsock_posix.go.html#1439614">ListenIP</a></span><span class="op" id="7909001">(</span><span class="ident" id="7909002"><a href="/net/ipraw_test.go.html#7908946">tt</a></span><span class="op" id="7909004">.</span><span class="ident" id="7909005">net</span><span class="op" id="7909008">,</span>&nbsp;<span class="ident" id="7909010"><a href="/net/ipraw_test.go.html#7908946">tt</a></span><span class="op" id="7909012">.</span><span class="ident" id="7909013">laddr</span><span class="op" id="7909018">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909022">if</span>&nbsp;<span class="ident" id="7909025"><a href="/net/ipraw_test.go.html#7908986">err</a></span>&nbsp;<span class="op" id="7909029">!=</span>&nbsp;<span class="ident" id="7909032">nil</span>&nbsp;<span class="op" id="7909036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909041"><a href="/net/ipraw_test.go.html#7908735">t</a></span><span class="op" id="7909042">.</span><span class="ident" id="7909043">Fatalf</span><span class="op" id="7909049">(</span><span class="string" id="7909050">&#34;ListenIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7909071">,</span>&nbsp;<span class="ident" id="7909073"><a href="/net/ipraw_test.go.html#7908986">err</a></span><span class="op" id="7909076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909084">defer</span>&nbsp;<span class="ident" id="7909090"><a href="/net/ipraw_test.go.html#7908983">c</a></span><span class="op" id="7909091">.</span><span class="ident" id="7909092">Close</span><span class="op" id="7909097">(</span><span class="op" id="7909098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909102">if</span>&nbsp;<span class="ident" id="7909105">la</span>&nbsp;<span class="op" id="7909108">:=</span>&nbsp;<span class="ident" id="7909111"><a href="/net/ipraw_test.go.html#7908983">c</a></span><span class="op" id="7909112">.</span><span class="ident" id="7909113">LocalAddr</span><span class="op" id="7909122">(</span><span class="op" id="7909123">)</span><span class="op" id="7909124">;</span>&nbsp;<span class="ident" id="7909126"><a href="/net/ipraw_test.go.html#7909105">la</a></span>&nbsp;<span class="op" id="7909129">==</span>&nbsp;<span class="ident" id="7909132">nil</span>&nbsp;<span class="op" id="7909136">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909141"><a href="/net/ipraw_test.go.html#7908735">t</a></span><span class="op" id="7909142">.</span><span class="ident" id="7909143">Fatal</span><span class="op" id="7909148">(</span><span class="string" id="7909149">&#34;IPConn.LocalAddr&nbsp;failed&#34;</span><span class="op" id="7909174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909181">}</span><br>
<span class="lineno"></span><span class="op" id="7909183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="7909186">func</span>&nbsp;<span class="ident" id="7909191">TestIPConnRemoteName</span><span class="op" id="7909211">(</span><span class="ident" id="7909212">t</span>&nbsp;<span class="op" id="7909214">*</span><span class="ident" id="7909215"><a href="/net/ipraw_test.go.html#7902438">testing</a></span><span class="op" id="7909222">.</span><span class="ident" id="7909223">T</span><span class="op" id="7909224">)</span>&nbsp;<span class="op" id="7909226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909229">switch</span>&nbsp;<span class="ident" id="7909236"><a href="/net/ipraw_test.go.html#7902427">runtime</a></span><span class="op" id="7909243">.</span><span class="ident" id="7909244">GOOS</span>&nbsp;<span class="op" id="7909249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909252">case</span>&nbsp;<span class="string" id="7909257">&#34;plan9&#34;</span><span class="op" id="7909264">,</span>&nbsp;<span class="string" id="7909266">&#34;windows&#34;</span><span class="op" id="7909275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909279"><a href="/net/ipraw_test.go.html#7909212">t</a></span><span class="op" id="7909280">.</span><span class="ident" id="7909281">Skipf</span><span class="op" id="7909286">(</span><span class="string" id="7909287">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7909308">,</span>&nbsp;<span class="ident" id="7909310"><a href="/net/ipraw_test.go.html#7902427">runtime</a></span><span class="op" id="7909317">.</span><span class="ident" id="7909318">GOOS</span><span class="op" id="7909322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909325">default</span><span class="op" id="7909332">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909336">if</span>&nbsp;<span class="ident" id="7909339"><a href="/net/ipraw_test.go.html#7902410">os</a></span><span class="op" id="7909341">.</span><span class="ident" id="7909342">Getuid</span><span class="op" id="7909348">(</span><span class="op" id="7909349">)</span>&nbsp;<span class="op" id="7909351">!=</span>&nbsp;<span class="num" id="7909354">0</span>&nbsp;<span class="op" id="7909356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909361"><a href="/net/ipraw_test.go.html#7909212">t</a></span><span class="op" id="7909362">.</span><span class="ident" id="7909363">Skip</span><span class="op" id="7909367">(</span><span class="string" id="7909368">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="7909397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909408">raddr</span>&nbsp;<span class="op" id="7909414">:=</span>&nbsp;<span class="op" id="7909417">&amp;</span><span class="ident" id="7909418"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7909424">{</span><span class="ident" id="7909425">IP</span><span class="op" id="7909427">:</span>&nbsp;<span class="ident" id="7909429"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7909433">(</span><span class="num" id="7909434">127</span><span class="op" id="7909437">,</span>&nbsp;<span class="num" id="7909439">0</span><span class="op" id="7909440">,</span>&nbsp;<span class="num" id="7909442">0</span><span class="op" id="7909443">,</span>&nbsp;<span class="num" id="7909445">1</span><span class="op" id="7909446">)</span><span class="op" id="7909447">.</span><span class="ident" id="7909448">To4</span><span class="op" id="7909451">(</span><span class="op" id="7909452">)</span><span class="op" id="7909453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909456">c</span><span class="op" id="7909457">,</span>&nbsp;<span class="ident" id="7909459">err</span>&nbsp;<span class="op" id="7909463">:=</span>&nbsp;<span class="ident" id="7909466"><a href="/net/iprawsock_posix.go.html#1438575">DialIP</a></span><span class="op" id="7909472">(</span><span class="string" id="7909473">&#34;ip:tcp&#34;</span><span class="op" id="7909481">,</span>&nbsp;<span class="op" id="7909483">&amp;</span><span class="ident" id="7909484"><a href="/net/iprawsock.go.html#1432036">IPAddr</a></span><span class="op" id="7909490">{</span><span class="ident" id="7909491">IP</span><span class="op" id="7909493">:</span>&nbsp;<span class="ident" id="7909495"><a href="/net/ip.go.html#1417459">IPv4</a></span><span class="op" id="7909499">(</span><span class="num" id="7909500">127</span><span class="op" id="7909503">,</span>&nbsp;<span class="num" id="7909505">0</span><span class="op" id="7909506">,</span>&nbsp;<span class="num" id="7909508">0</span><span class="op" id="7909509">,</span>&nbsp;<span class="num" id="7909511">1</span><span class="op" id="7909512">)</span><span class="op" id="7909513">}</span><span class="op" id="7909514">,</span>&nbsp;<span class="ident" id="7909516"><a href="/net/ipraw_test.go.html#7909408">raddr</a></span><span class="op" id="7909521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909524">if</span>&nbsp;<span class="ident" id="7909527"><a href="/net/ipraw_test.go.html#7909459">err</a></span>&nbsp;<span class="op" id="7909531">!=</span>&nbsp;<span class="ident" id="7909534">nil</span>&nbsp;<span class="op" id="7909538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909542"><a href="/net/ipraw_test.go.html#7909212">t</a></span><span class="op" id="7909543">.</span><span class="ident" id="7909544">Fatalf</span><span class="op" id="7909550">(</span><span class="string" id="7909551">&#34;DialIP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7909570">,</span>&nbsp;<span class="ident" id="7909572"><a href="/net/ipraw_test.go.html#7909459">err</a></span><span class="op" id="7909575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909578">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909581">defer</span>&nbsp;<span class="ident" id="7909587"><a href="/net/ipraw_test.go.html#7909456">c</a></span><span class="op" id="7909588">.</span><span class="ident" id="7909589">Close</span><span class="op" id="7909594">(</span><span class="op" id="7909595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7909598">if</span>&nbsp;<span class="op" id="7909601">!</span><span class="ident" id="7909602"><a href="/net/ipraw_test.go.html#7902416">reflect</a></span><span class="op" id="7909609">.</span><span class="ident" id="7909610">DeepEqual</span><span class="op" id="7909619">(</span><span class="ident" id="7909620"><a href="/net/ipraw_test.go.html#7909408">raddr</a></span><span class="op" id="7909625">,</span>&nbsp;<span class="ident" id="7909627"><a href="/net/ipraw_test.go.html#7909456">c</a></span><span class="op" id="7909628">.</span><span class="ident" id="7909629">RemoteAddr</span><span class="op" id="7909639">(</span><span class="op" id="7909640">)</span><span class="op" id="7909641">)</span>&nbsp;<span class="op" id="7909643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7909647"><a href="/net/ipraw_test.go.html#7909212">t</a></span><span class="op" id="7909648">.</span><span class="ident" id="7909649">Fatalf</span><span class="op" id="7909655">(</span><span class="string" id="7909656">&#34;got&nbsp;%#v,&nbsp;expected&nbsp;%#v&#34;</span><span class="op" id="7909679">,</span>&nbsp;<span class="ident" id="7909681"><a href="/net/ipraw_test.go.html#7909456">c</a></span><span class="op" id="7909682">.</span><span class="ident" id="7909683">RemoteAddr</span><span class="op" id="7909693">(</span><span class="op" id="7909694">)</span><span class="op" id="7909695">,</span>&nbsp;<span class="ident" id="7909697"><a href="/net/ipraw_test.go.html#7909408">raddr</a></span><span class="op" id="7909702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7909705">}</span><br>
<span class="lineno"></span><span class="op" id="7909707">}</span>
</div>
</body>
</html>
