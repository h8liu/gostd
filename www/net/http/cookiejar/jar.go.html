<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5165661">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5165716">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5165770">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5165821">//&nbsp;Package&nbsp;cookiejar&nbsp;implements&nbsp;an&nbsp;in-memory&nbsp;RFC&nbsp;6265-compliant&nbsp;http.CookieJar.</span><br>
<span class="lineno"></span><span class="keyword" id="5165901">package</span>&nbsp;<span class="ident" id="5165909">cookiejar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5165920">import</span>&nbsp;<span class="op" id="5165927">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165930">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165940">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165947">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165954">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165966">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165977">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165985">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5165996">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5166004">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5166011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5166014">//&nbsp;PublicSuffixList&nbsp;provides&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;a&nbsp;domain.&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="5166087">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;&#34;example.com&#34;&nbsp;is&nbsp;&#34;com&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="5166142">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;&#34;foo1.foo2.foo3.co.uk&#34;&nbsp;is&nbsp;&#34;co.uk&#34;,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5166212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;&#34;bar.pvt.k12.ma.us&#34;&nbsp;is&nbsp;&#34;pvt.k12.ma.us&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5166283">//</span><br>
<span class="lineno">25</span><span class="comment" id="5166286">//&nbsp;Implementations&nbsp;of&nbsp;PublicSuffixList&nbsp;must&nbsp;be&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5166360">//&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5166384">//</span><br>
<span class="lineno"></span><span class="comment" id="5166387">//&nbsp;An&nbsp;implementation&nbsp;that&nbsp;always&nbsp;returns&nbsp;&#34;&#34;&nbsp;is&nbsp;valid&nbsp;and&nbsp;may&nbsp;be&nbsp;useful&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="5166462">//&nbsp;testing&nbsp;but&nbsp;it&nbsp;is&nbsp;not&nbsp;secure:&nbsp;it&nbsp;means&nbsp;that&nbsp;the&nbsp;HTTP&nbsp;server&nbsp;for&nbsp;foo.com&nbsp;can</span><br>
<span class="lineno">30</span><span class="comment" id="5166541">//&nbsp;set&nbsp;a&nbsp;cookie&nbsp;for&nbsp;bar.com.</span><br>
<span class="lineno"></span><span class="comment" id="5166570">//</span><br>
<span class="lineno"></span><span class="comment" id="5166573">//&nbsp;A&nbsp;public&nbsp;suffix&nbsp;list&nbsp;implementation&nbsp;is&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5166630">//&nbsp;golang.org/x/net/publicsuffix.</span><br>
<span class="lineno"></span><span class="keyword" id="5166664">type</span>&nbsp;<span class="ident" id="5166669">PublicSuffixList</span>&nbsp;<span class="keyword" id="5166686">interface</span>&nbsp;<span class="op" id="5166696">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166699">//&nbsp;PublicSuffix&nbsp;returns&nbsp;the&nbsp;public&nbsp;suffix&nbsp;of&nbsp;domain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166753">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166757">//&nbsp;TODO:&nbsp;specify&nbsp;which&nbsp;of&nbsp;the&nbsp;caller&nbsp;and&nbsp;callee&nbsp;is&nbsp;responsible&nbsp;for&nbsp;IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166828">//&nbsp;addresses,&nbsp;for&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;dots,&nbsp;for&nbsp;case&nbsp;sensitivity,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166900">//&nbsp;for&nbsp;IDN/Punycode.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5166922">PublicSuffix</span><span class="op" id="5166934">(</span><span class="ident" id="5166935">domain</span>&nbsp;<span class="builtintype" id="5166942">string</span><span class="op" id="5166948">)</span>&nbsp;<span class="builtintype" id="5166950">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5166959">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;source&nbsp;of&nbsp;this&nbsp;public&nbsp;suffix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167028">//&nbsp;list.&nbsp;The&nbsp;description&nbsp;will&nbsp;typically&nbsp;contain&nbsp;something&nbsp;like&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167099">//&nbsp;stamp&nbsp;or&nbsp;version&nbsp;number.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167128">String</span><span class="op" id="5167134">(</span><span class="op" id="5167135">)</span>&nbsp;<span class="builtintype" id="5167137">string</span><br>
<span class="lineno"></span><span class="op" id="5167144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5167147">//&nbsp;Options&nbsp;are&nbsp;the&nbsp;options&nbsp;for&nbsp;creating&nbsp;a&nbsp;new&nbsp;Jar.</span><br>
<span class="lineno"></span><span class="keyword" id="5167198">type</span>&nbsp;<span class="ident" id="5167203">Options</span>&nbsp;<span class="keyword" id="5167211">struct</span>&nbsp;<span class="op" id="5167218">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167221">//&nbsp;PublicSuffixList&nbsp;is&nbsp;the&nbsp;public&nbsp;suffix&nbsp;list&nbsp;that&nbsp;determines&nbsp;whether</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167292">//&nbsp;an&nbsp;HTTP&nbsp;server&nbsp;can&nbsp;set&nbsp;a&nbsp;cookie&nbsp;for&nbsp;a&nbsp;domain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167342">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167346">//&nbsp;A&nbsp;nil&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;may&nbsp;be&nbsp;useful&nbsp;for&nbsp;testing&nbsp;but&nbsp;it&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167415">//&nbsp;secure:&nbsp;it&nbsp;means&nbsp;that&nbsp;the&nbsp;HTTP&nbsp;server&nbsp;for&nbsp;foo.co.uk&nbsp;can&nbsp;set&nbsp;a&nbsp;cookie</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167488">//&nbsp;for&nbsp;bar.co.uk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167507">PublicSuffixList</span>&nbsp;<span class="ident" id="5167524"><a href="/net/http/cookiejar/jar.go.html#5166669">PublicSuffixList</a></span><br>
<span class="lineno"></span><span class="op" id="5167541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5167544">//&nbsp;Jar&nbsp;implements&nbsp;the&nbsp;http.CookieJar&nbsp;interface&nbsp;from&nbsp;the&nbsp;net/http&nbsp;package.</span><br>
<span class="lineno">60</span><span class="keyword" id="5167618">type</span>&nbsp;<span class="ident" id="5167623">Jar</span>&nbsp;<span class="keyword" id="5167627">struct</span>&nbsp;<span class="op" id="5167634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167637">psList</span>&nbsp;<span class="ident" id="5167644"><a href="/net/http/cookiejar/jar.go.html#5166669">PublicSuffixList</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167663">//&nbsp;mu&nbsp;locks&nbsp;the&nbsp;remaining&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167698">mu</span>&nbsp;<span class="ident" id="5167701"><a href="/net/http/cookiejar/jar.go.html#5165996">sync</a></span><span class="op" id="5167705">.</span><span class="ident" id="5167706">Mutex</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167714">//&nbsp;entries&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;entries,&nbsp;keyed&nbsp;by&nbsp;their&nbsp;eTLD+1&nbsp;and&nbsp;subkeyed&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167785">//&nbsp;their&nbsp;name/domain/path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167813">entries</span>&nbsp;<span class="keyword" id="5167821">map</span><span class="op" id="5167824">[</span><span class="builtintype" id="5167825">string</span><span class="op" id="5167831">]</span><span class="keyword" id="5167832">map</span><span class="op" id="5167835">[</span><span class="builtintype" id="5167836">string</span><span class="op" id="5167842">]</span><span class="ident" id="5167843"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167851">//&nbsp;nextSeqNum&nbsp;is&nbsp;the&nbsp;next&nbsp;sequence&nbsp;number&nbsp;assigned&nbsp;to&nbsp;a&nbsp;new&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5167919">//&nbsp;created&nbsp;SetCookies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5167943">nextSeqNum</span>&nbsp;<span class="ident" id="5167954">uint64</span><br>
<span class="lineno"></span><span class="op" id="5167961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5167964">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;cookie&nbsp;jar.&nbsp;A&nbsp;nil&nbsp;*Options&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;a&nbsp;zero</span><br>
<span class="lineno"></span><span class="comment" id="5168036">//&nbsp;Options.</span><br>
<span class="lineno"></span><span class="keyword" id="5168048">func</span>&nbsp;<span class="ident" id="5168053">New</span><span class="op" id="5168056">(</span><span class="ident" id="5168057">o</span>&nbsp;<span class="op" id="5168059">*</span><span class="ident" id="5168060"><a href="/net/http/cookiejar/jar.go.html#5167203">Options</a></span><span class="op" id="5168067">)</span>&nbsp;<span class="op" id="5168069">(</span><span class="op" id="5168070">*</span><span class="ident" id="5168071"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5168074">,</span>&nbsp;<span class="builtintype" id="5168076">error</span><span class="op" id="5168081">)</span>&nbsp;<span class="op" id="5168083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168086">jar</span>&nbsp;<span class="op" id="5168090">:=</span>&nbsp;<span class="op" id="5168093">&amp;</span><span class="ident" id="5168094"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5168097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168101">entries</span><span class="op" id="5168108">:</span>&nbsp;<span class="builtinfunc" id="5168110">make</span><span class="op" id="5168114">(</span><span class="keyword" id="5168115">map</span><span class="op" id="5168118">[</span><span class="builtintype" id="5168119">string</span><span class="op" id="5168125">]</span><span class="keyword" id="5168126">map</span><span class="op" id="5168129">[</span><span class="builtintype" id="5168130">string</span><span class="op" id="5168136">]</span><span class="ident" id="5168137"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5168142">)</span><span class="op" id="5168143">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168149">if</span>&nbsp;<span class="ident" id="5168152"><a href="/net/http/cookiejar/jar.go.html#5168057">o</a></span>&nbsp;<span class="op" id="5168154">!=</span>&nbsp;<span class="ident" id="5168157">nil</span>&nbsp;<span class="op" id="5168161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168165"><a href="/net/http/cookiejar/jar.go.html#5168086">jar</a></span><span class="op" id="5168168">.</span><span class="ident" id="5168169">psList</span>&nbsp;<span class="op" id="5168176">=</span>&nbsp;<span class="ident" id="5168178"><a href="/net/http/cookiejar/jar.go.html#5168057">o</a></span><span class="op" id="5168179">.</span><span class="ident" id="5168180">PublicSuffixList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5168198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168201">return</span>&nbsp;<span class="ident" id="5168208"><a href="/net/http/cookiejar/jar.go.html#5168086">jar</a></span><span class="op" id="5168211">,</span>&nbsp;<span class="ident" id="5168213">nil</span><br>
<span class="lineno">85</span><span class="op" id="5168217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5168220">//&nbsp;entry&nbsp;is&nbsp;the&nbsp;internal&nbsp;representation&nbsp;of&nbsp;a&nbsp;cookie.</span><br>
<span class="lineno"></span><span class="comment" id="5168273">//</span><br>
<span class="lineno"></span><span class="comment" id="5168276">//&nbsp;This&nbsp;struct&nbsp;type&nbsp;is&nbsp;not&nbsp;used&nbsp;outside&nbsp;of&nbsp;this&nbsp;package&nbsp;per&nbsp;se,&nbsp;but&nbsp;the&nbsp;exported</span><br>
<span class="lineno">90</span><span class="comment" id="5168357">//&nbsp;fields&nbsp;are&nbsp;those&nbsp;of&nbsp;RFC&nbsp;6265.</span><br>
<span class="lineno"></span><span class="keyword" id="5168390">type</span>&nbsp;<span class="ident" id="5168395">entry</span>&nbsp;<span class="keyword" id="5168401">struct</span>&nbsp;<span class="op" id="5168408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168411">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168422">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168430">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168441">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168449">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168460">string</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168468">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168479">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168487">Secure</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168498">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168504">HttpOnly</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168515">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168521">Persistent</span>&nbsp;<span class="builtintype" id="5168532">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168538">HostOnly</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5168549">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168555">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5168566"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5168570">.</span><span class="ident" id="5168571">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168577">Creation</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5168588"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5168592">.</span><span class="ident" id="5168593">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168599">LastAccess</span>&nbsp;<span class="ident" id="5168610"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5168614">.</span><span class="ident" id="5168615">Time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168622">//&nbsp;seqNum&nbsp;is&nbsp;a&nbsp;sequence&nbsp;number&nbsp;so&nbsp;that&nbsp;Cookies&nbsp;returns&nbsp;cookies&nbsp;in&nbsp;a</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168691">//&nbsp;deterministic&nbsp;order,&nbsp;even&nbsp;for&nbsp;cookies&nbsp;that&nbsp;have&nbsp;equal&nbsp;Path&nbsp;length&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5168765">//&nbsp;equal&nbsp;Creation&nbsp;time.&nbsp;This&nbsp;simplifies&nbsp;testing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5168815">seqNum</span>&nbsp;<span class="ident" id="5168822">uint64</span><br>
<span class="lineno"></span><span class="op" id="5168829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="5168832">//&nbsp;Id&nbsp;returns&nbsp;the&nbsp;domain;path;name&nbsp;triple&nbsp;of&nbsp;e&nbsp;as&nbsp;an&nbsp;id.</span><br>
<span class="lineno"></span><span class="keyword" id="5168889">func</span>&nbsp;<span class="op" id="5168894">(</span><span class="ident" id="5168895">e</span>&nbsp;<span class="op" id="5168897">*</span><span class="ident" id="5168898"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5168903">)</span>&nbsp;<span class="ident" id="5168905">id</span><span class="op" id="5168907">(</span><span class="op" id="5168908">)</span>&nbsp;<span class="builtintype" id="5168910">string</span>&nbsp;<span class="op" id="5168917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5168920">return</span>&nbsp;<span class="ident" id="5168927"><a href="/net/http/cookiejar/jar.go.html#5165940">fmt</a></span><span class="op" id="5168930">.</span><span class="ident" id="5168931">Sprintf</span><span class="op" id="5168938">(</span><span class="string" id="5168939">&#34;%s;%s;%s&#34;</span><span class="op" id="5168949">,</span>&nbsp;<span class="ident" id="5168951"><a href="/net/http/cookiejar/jar.go.html#5168895">e</a></span><span class="op" id="5168952">.</span><span class="ident" id="5168953">Domain</span><span class="op" id="5168959">,</span>&nbsp;<span class="ident" id="5168961"><a href="/net/http/cookiejar/jar.go.html#5168895">e</a></span><span class="op" id="5168962">.</span><span class="ident" id="5168963">Path</span><span class="op" id="5168967">,</span>&nbsp;<span class="ident" id="5168969"><a href="/net/http/cookiejar/jar.go.html#5168895">e</a></span><span class="op" id="5168970">.</span><span class="ident" id="5168971">Name</span><span class="op" id="5168975">)</span><br>
<span class="lineno"></span><span class="op" id="5168977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5168980">//&nbsp;shouldSend&nbsp;determines&nbsp;whether&nbsp;e&#39;s&nbsp;cookie&nbsp;qualifies&nbsp;to&nbsp;be&nbsp;included&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5169054">//&nbsp;request&nbsp;to&nbsp;host/path.&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;check&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5169129">//&nbsp;cookie&nbsp;is&nbsp;expired.</span><br>
<span class="lineno"></span><span class="keyword" id="5169151">func</span>&nbsp;<span class="op" id="5169156">(</span><span class="ident" id="5169157">e</span>&nbsp;<span class="op" id="5169159">*</span><span class="ident" id="5169160"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5169165">)</span>&nbsp;<span class="ident" id="5169167">shouldSend</span><span class="op" id="5169177">(</span><span class="ident" id="5169178">https</span>&nbsp;<span class="builtintype" id="5169184">bool</span><span class="op" id="5169188">,</span>&nbsp;<span class="ident" id="5169190">host</span><span class="op" id="5169194">,</span>&nbsp;<span class="ident" id="5169196">path</span>&nbsp;<span class="builtintype" id="5169201">string</span><span class="op" id="5169207">)</span>&nbsp;<span class="builtintype" id="5169209">bool</span>&nbsp;<span class="op" id="5169214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169217">return</span>&nbsp;<span class="ident" id="5169224"><a href="/net/http/cookiejar/jar.go.html#5169157">e</a></span><span class="op" id="5169225">.</span><span class="ident" id="5169226">domainMatch</span><span class="op" id="5169237">(</span><span class="ident" id="5169238"><a href="/net/http/cookiejar/jar.go.html#5169190">host</a></span><span class="op" id="5169242">)</span>&nbsp;<span class="op" id="5169244">&amp;&amp;</span>&nbsp;<span class="ident" id="5169247"><a href="/net/http/cookiejar/jar.go.html#5169157">e</a></span><span class="op" id="5169248">.</span><span class="ident" id="5169249">pathMatch</span><span class="op" id="5169258">(</span><span class="ident" id="5169259"><a href="/net/http/cookiejar/jar.go.html#5169196">path</a></span><span class="op" id="5169263">)</span>&nbsp;<span class="op" id="5169265">&amp;&amp;</span>&nbsp;<span class="op" id="5169268">(</span><span class="ident" id="5169269"><a href="/net/http/cookiejar/jar.go.html#5169178">https</a></span>&nbsp;<span class="op" id="5169275">||</span>&nbsp;<span class="op" id="5169278">!</span><span class="ident" id="5169279"><a href="/net/http/cookiejar/jar.go.html#5169157">e</a></span><span class="op" id="5169280">.</span><span class="ident" id="5169281">Secure</span><span class="op" id="5169287">)</span><br>
<span class="lineno">120</span><span class="op" id="5169289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5169292">//&nbsp;domainMatch&nbsp;implements&nbsp;&#34;domain-match&#34;&nbsp;of&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.1.3.</span><br>
<span class="lineno"></span><span class="keyword" id="5169360">func</span>&nbsp;<span class="op" id="5169365">(</span><span class="ident" id="5169366">e</span>&nbsp;<span class="op" id="5169368">*</span><span class="ident" id="5169369"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5169374">)</span>&nbsp;<span class="ident" id="5169376">domainMatch</span><span class="op" id="5169387">(</span><span class="ident" id="5169388">host</span>&nbsp;<span class="builtintype" id="5169393">string</span><span class="op" id="5169399">)</span>&nbsp;<span class="builtintype" id="5169401">bool</span>&nbsp;<span class="op" id="5169406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169409">if</span>&nbsp;<span class="ident" id="5169412"><a href="/net/http/cookiejar/jar.go.html#5169366">e</a></span><span class="op" id="5169413">.</span><span class="ident" id="5169414">Domain</span>&nbsp;<span class="op" id="5169421">==</span>&nbsp;<span class="ident" id="5169424"><a href="/net/http/cookiejar/jar.go.html#5169388">host</a></span>&nbsp;<span class="op" id="5169429">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169433">return</span>&nbsp;<span class="ident" id="5169440">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169449">return</span>&nbsp;<span class="op" id="5169456">!</span><span class="ident" id="5169457"><a href="/net/http/cookiejar/jar.go.html#5169366">e</a></span><span class="op" id="5169458">.</span><span class="ident" id="5169459">HostOnly</span>&nbsp;<span class="op" id="5169468">&amp;&amp;</span>&nbsp;<span class="ident" id="5169471"><a href="/net/http/cookiejar/jar.go.html#5169996">hasDotSuffix</a></span><span class="op" id="5169483">(</span><span class="ident" id="5169484"><a href="/net/http/cookiejar/jar.go.html#5169388">host</a></span><span class="op" id="5169488">,</span>&nbsp;<span class="ident" id="5169490"><a href="/net/http/cookiejar/jar.go.html#5169366">e</a></span><span class="op" id="5169491">.</span><span class="ident" id="5169492">Domain</span><span class="op" id="5169498">)</span><br>
<span class="lineno"></span><span class="op" id="5169500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5169503">//&nbsp;pathMatch&nbsp;implements&nbsp;&#34;path-match&#34;&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.1.4.</span><br>
<span class="lineno"></span><span class="keyword" id="5169577">func</span>&nbsp;<span class="op" id="5169582">(</span><span class="ident" id="5169583">e</span>&nbsp;<span class="op" id="5169585">*</span><span class="ident" id="5169586"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5169591">)</span>&nbsp;<span class="ident" id="5169593">pathMatch</span><span class="op" id="5169602">(</span><span class="ident" id="5169603">requestPath</span>&nbsp;<span class="builtintype" id="5169615">string</span><span class="op" id="5169621">)</span>&nbsp;<span class="builtintype" id="5169623">bool</span>&nbsp;<span class="op" id="5169628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169631">if</span>&nbsp;<span class="ident" id="5169634"><a href="/net/http/cookiejar/jar.go.html#5169603">requestPath</a></span>&nbsp;<span class="op" id="5169646">==</span>&nbsp;<span class="ident" id="5169649"><a href="/net/http/cookiejar/jar.go.html#5169583">e</a></span><span class="op" id="5169650">.</span><span class="ident" id="5169651">Path</span>&nbsp;<span class="op" id="5169656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169660">return</span>&nbsp;<span class="ident" id="5169667">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169673">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169676">if</span>&nbsp;<span class="ident" id="5169679"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5169686">.</span><span class="ident" id="5169687">HasPrefix</span><span class="op" id="5169696">(</span><span class="ident" id="5169697"><a href="/net/http/cookiejar/jar.go.html#5169603">requestPath</a></span><span class="op" id="5169708">,</span>&nbsp;<span class="ident" id="5169710"><a href="/net/http/cookiejar/jar.go.html#5169583">e</a></span><span class="op" id="5169711">.</span><span class="ident" id="5169712">Path</span><span class="op" id="5169716">)</span>&nbsp;<span class="op" id="5169718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169722">if</span>&nbsp;<span class="ident" id="5169725"><a href="/net/http/cookiejar/jar.go.html#5169583">e</a></span><span class="op" id="5169726">.</span><span class="ident" id="5169727">Path</span><span class="op" id="5169731">[</span><span class="builtinfunc" id="5169732">len</span><span class="op" id="5169735">(</span><span class="ident" id="5169736"><a href="/net/http/cookiejar/jar.go.html#5169583">e</a></span><span class="op" id="5169737">.</span><span class="ident" id="5169738">Path</span><span class="op" id="5169742">)</span><span class="op" id="5169743">-</span><span class="num" id="5169744">1</span><span class="op" id="5169745">]</span>&nbsp;<span class="op" id="5169747">==</span>&nbsp;<span class="string" id="5169750">&#39;/&#39;</span>&nbsp;<span class="op" id="5169754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169759">return</span>&nbsp;<span class="ident" id="5169766">true</span>&nbsp;<span class="comment" id="5169771">//&nbsp;The&nbsp;&#34;/any/&#34;&nbsp;matches&nbsp;&#34;/any/path&#34;&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169814">}</span>&nbsp;<span class="keyword" id="5169816">else</span>&nbsp;<span class="keyword" id="5169821">if</span>&nbsp;<span class="ident" id="5169824"><a href="/net/http/cookiejar/jar.go.html#5169603">requestPath</a></span><span class="op" id="5169835">[</span><span class="builtinfunc" id="5169836">len</span><span class="op" id="5169839">(</span><span class="ident" id="5169840"><a href="/net/http/cookiejar/jar.go.html#5169583">e</a></span><span class="op" id="5169841">.</span><span class="ident" id="5169842">Path</span><span class="op" id="5169846">)</span><span class="op" id="5169847">]</span>&nbsp;<span class="op" id="5169849">==</span>&nbsp;<span class="string" id="5169852">&#39;/&#39;</span>&nbsp;<span class="op" id="5169856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169861">return</span>&nbsp;<span class="ident" id="5169868">true</span>&nbsp;<span class="comment" id="5169873">//&nbsp;The&nbsp;&#34;/any&#34;&nbsp;matches&nbsp;&#34;/any/path&#34;&nbsp;case.</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5169918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5169921">return</span>&nbsp;<span class="ident" id="5169928">false</span><br>
<span class="lineno"></span><span class="op" id="5169934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="5169937">//&nbsp;hasDotSuffix&nbsp;reports&nbsp;whether&nbsp;s&nbsp;ends&nbsp;in&nbsp;&#34;.&#34;+suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="5169991">func</span>&nbsp;<span class="ident" id="5169996">hasDotSuffix</span><span class="op" id="5170008">(</span><span class="ident" id="5170009">s</span><span class="op" id="5170010">,</span>&nbsp;<span class="ident" id="5170012">suffix</span>&nbsp;<span class="builtintype" id="5170019">string</span><span class="op" id="5170025">)</span>&nbsp;<span class="builtintype" id="5170027">bool</span>&nbsp;<span class="op" id="5170032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170035">return</span>&nbsp;<span class="builtinfunc" id="5170042">len</span><span class="op" id="5170045">(</span><span class="ident" id="5170046"><a href="/net/http/cookiejar/jar.go.html#5170009">s</a></span><span class="op" id="5170047">)</span>&nbsp;<span class="op" id="5170049">&gt;</span>&nbsp;<span class="builtinfunc" id="5170051">len</span><span class="op" id="5170054">(</span><span class="ident" id="5170055"><a href="/net/http/cookiejar/jar.go.html#5170012">suffix</a></span><span class="op" id="5170061">)</span>&nbsp;<span class="op" id="5170063">&amp;&amp;</span>&nbsp;<span class="ident" id="5170066"><a href="/net/http/cookiejar/jar.go.html#5170009">s</a></span><span class="op" id="5170067">[</span><span class="builtinfunc" id="5170068">len</span><span class="op" id="5170071">(</span><span class="ident" id="5170072"><a href="/net/http/cookiejar/jar.go.html#5170009">s</a></span><span class="op" id="5170073">)</span><span class="op" id="5170074">-</span><span class="builtinfunc" id="5170075">len</span><span class="op" id="5170078">(</span><span class="ident" id="5170079"><a href="/net/http/cookiejar/jar.go.html#5170012">suffix</a></span><span class="op" id="5170085">)</span><span class="op" id="5170086">-</span><span class="num" id="5170087">1</span><span class="op" id="5170088">]</span>&nbsp;<span class="op" id="5170090">==</span>&nbsp;<span class="string" id="5170093">&#39;.&#39;</span>&nbsp;<span class="op" id="5170097">&amp;&amp;</span>&nbsp;<span class="ident" id="5170100"><a href="/net/http/cookiejar/jar.go.html#5170009">s</a></span><span class="op" id="5170101">[</span><span class="builtinfunc" id="5170102">len</span><span class="op" id="5170105">(</span><span class="ident" id="5170106"><a href="/net/http/cookiejar/jar.go.html#5170009">s</a></span><span class="op" id="5170107">)</span><span class="op" id="5170108">-</span><span class="builtinfunc" id="5170109">len</span><span class="op" id="5170112">(</span><span class="ident" id="5170113"><a href="/net/http/cookiejar/jar.go.html#5170012">suffix</a></span><span class="op" id="5170119">)</span><span class="op" id="5170120">:</span><span class="op" id="5170121">]</span>&nbsp;<span class="op" id="5170123">==</span>&nbsp;<span class="ident" id="5170126"><a href="/net/http/cookiejar/jar.go.html#5170012">suffix</a></span><br>
<span class="lineno"></span><span class="op" id="5170133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="5170136">//&nbsp;byPathLength&nbsp;is&nbsp;a&nbsp;[]entry&nbsp;sort.Interface&nbsp;that&nbsp;sorts&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265</span><br>
<span class="lineno"></span><span class="comment" id="5170213">//&nbsp;section&nbsp;5.4&nbsp;point&nbsp;2:&nbsp;by&nbsp;longest&nbsp;path&nbsp;and&nbsp;then&nbsp;by&nbsp;earliest&nbsp;creation&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5170289">type</span>&nbsp;<span class="ident" id="5170294">byPathLength</span>&nbsp;<span class="op" id="5170307">[</span><span class="op" id="5170308">]</span><span class="ident" id="5170309"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5170316">func</span>&nbsp;<span class="op" id="5170321">(</span><span class="ident" id="5170322">s</span>&nbsp;<span class="ident" id="5170324"><a href="/net/http/cookiejar/jar.go.html#5170294">byPathLength</a></span><span class="op" id="5170336">)</span>&nbsp;<span class="ident" id="5170338">Len</span><span class="op" id="5170341">(</span><span class="op" id="5170342">)</span>&nbsp;<span class="builtintype" id="5170344">int</span>&nbsp;<span class="op" id="5170348">{</span>&nbsp;<span class="keyword" id="5170350">return</span>&nbsp;<span class="builtinfunc" id="5170357">len</span><span class="op" id="5170360">(</span><span class="ident" id="5170361"><a href="/net/http/cookiejar/jar.go.html#5170322">s</a></span><span class="op" id="5170362">)</span>&nbsp;<span class="op" id="5170364">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="5170367">func</span>&nbsp;<span class="op" id="5170372">(</span><span class="ident" id="5170373">s</span>&nbsp;<span class="ident" id="5170375"><a href="/net/http/cookiejar/jar.go.html#5170294">byPathLength</a></span><span class="op" id="5170387">)</span>&nbsp;<span class="ident" id="5170389">Less</span><span class="op" id="5170393">(</span><span class="ident" id="5170394">i</span><span class="op" id="5170395">,</span>&nbsp;<span class="ident" id="5170397">j</span>&nbsp;<span class="builtintype" id="5170399">int</span><span class="op" id="5170402">)</span>&nbsp;<span class="builtintype" id="5170404">bool</span>&nbsp;<span class="op" id="5170409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170412">if</span>&nbsp;<span class="builtinfunc" id="5170415">len</span><span class="op" id="5170418">(</span><span class="ident" id="5170419"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170420">[</span><span class="ident" id="5170421"><a href="/net/http/cookiejar/jar.go.html#5170394">i</a></span><span class="op" id="5170422">]</span><span class="op" id="5170423">.</span><span class="ident" id="5170424">Path</span><span class="op" id="5170428">)</span>&nbsp;<span class="op" id="5170430">!=</span>&nbsp;<span class="builtinfunc" id="5170433">len</span><span class="op" id="5170436">(</span><span class="ident" id="5170437"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170438">[</span><span class="ident" id="5170439"><a href="/net/http/cookiejar/jar.go.html#5170397">j</a></span><span class="op" id="5170440">]</span><span class="op" id="5170441">.</span><span class="ident" id="5170442">Path</span><span class="op" id="5170446">)</span>&nbsp;<span class="op" id="5170448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170452">return</span>&nbsp;<span class="builtinfunc" id="5170459">len</span><span class="op" id="5170462">(</span><span class="ident" id="5170463"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170464">[</span><span class="ident" id="5170465"><a href="/net/http/cookiejar/jar.go.html#5170394">i</a></span><span class="op" id="5170466">]</span><span class="op" id="5170467">.</span><span class="ident" id="5170468">Path</span><span class="op" id="5170472">)</span>&nbsp;<span class="op" id="5170474">&gt;</span>&nbsp;<span class="builtinfunc" id="5170476">len</span><span class="op" id="5170479">(</span><span class="ident" id="5170480"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170481">[</span><span class="ident" id="5170482"><a href="/net/http/cookiejar/jar.go.html#5170397">j</a></span><span class="op" id="5170483">]</span><span class="op" id="5170484">.</span><span class="ident" id="5170485">Path</span><span class="op" id="5170489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170492">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170495">if</span>&nbsp;<span class="op" id="5170498">!</span><span class="ident" id="5170499"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170500">[</span><span class="ident" id="5170501"><a href="/net/http/cookiejar/jar.go.html#5170394">i</a></span><span class="op" id="5170502">]</span><span class="op" id="5170503">.</span><span class="ident" id="5170504">Creation</span><span class="op" id="5170512">.</span><span class="ident" id="5170513">Equal</span><span class="op" id="5170518">(</span><span class="ident" id="5170519"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170520">[</span><span class="ident" id="5170521"><a href="/net/http/cookiejar/jar.go.html#5170397">j</a></span><span class="op" id="5170522">]</span><span class="op" id="5170523">.</span><span class="ident" id="5170524">Creation</span><span class="op" id="5170532">)</span>&nbsp;<span class="op" id="5170534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170538">return</span>&nbsp;<span class="ident" id="5170545"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170546">[</span><span class="ident" id="5170547"><a href="/net/http/cookiejar/jar.go.html#5170394">i</a></span><span class="op" id="5170548">]</span><span class="op" id="5170549">.</span><span class="ident" id="5170550">Creation</span><span class="op" id="5170558">.</span><span class="ident" id="5170559">Before</span><span class="op" id="5170565">(</span><span class="ident" id="5170566"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170567">[</span><span class="ident" id="5170568"><a href="/net/http/cookiejar/jar.go.html#5170397">j</a></span><span class="op" id="5170569">]</span><span class="op" id="5170570">.</span><span class="ident" id="5170571">Creation</span><span class="op" id="5170579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5170582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170585">return</span>&nbsp;<span class="ident" id="5170592"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170593">[</span><span class="ident" id="5170594"><a href="/net/http/cookiejar/jar.go.html#5170394">i</a></span><span class="op" id="5170595">]</span><span class="op" id="5170596">.</span><span class="ident" id="5170597">seqNum</span>&nbsp;<span class="op" id="5170604">&lt;</span>&nbsp;<span class="ident" id="5170606"><a href="/net/http/cookiejar/jar.go.html#5170373">s</a></span><span class="op" id="5170607">[</span><span class="ident" id="5170608"><a href="/net/http/cookiejar/jar.go.html#5170397">j</a></span><span class="op" id="5170609">]</span><span class="op" id="5170610">.</span><span class="ident" id="5170611">seqNum</span><br>
<span class="lineno"></span><span class="op" id="5170618">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="5170621">func</span>&nbsp;<span class="op" id="5170626">(</span><span class="ident" id="5170627">s</span>&nbsp;<span class="ident" id="5170629"><a href="/net/http/cookiejar/jar.go.html#5170294">byPathLength</a></span><span class="op" id="5170641">)</span>&nbsp;<span class="ident" id="5170643">Swap</span><span class="op" id="5170647">(</span><span class="ident" id="5170648">i</span><span class="op" id="5170649">,</span>&nbsp;<span class="ident" id="5170651">j</span>&nbsp;<span class="builtintype" id="5170653">int</span><span class="op" id="5170656">)</span>&nbsp;<span class="op" id="5170658">{</span>&nbsp;<span class="ident" id="5170660"><a href="/net/http/cookiejar/jar.go.html#5170627">s</a></span><span class="op" id="5170661">[</span><span class="ident" id="5170662"><a href="/net/http/cookiejar/jar.go.html#5170648">i</a></span><span class="op" id="5170663">]</span><span class="op" id="5170664">,</span>&nbsp;<span class="ident" id="5170666"><a href="/net/http/cookiejar/jar.go.html#5170627">s</a></span><span class="op" id="5170667">[</span><span class="ident" id="5170668"><a href="/net/http/cookiejar/jar.go.html#5170651">j</a></span><span class="op" id="5170669">]</span>&nbsp;<span class="op" id="5170671">=</span>&nbsp;<span class="ident" id="5170673"><a href="/net/http/cookiejar/jar.go.html#5170627">s</a></span><span class="op" id="5170674">[</span><span class="ident" id="5170675"><a href="/net/http/cookiejar/jar.go.html#5170651">j</a></span><span class="op" id="5170676">]</span><span class="op" id="5170677">,</span>&nbsp;<span class="ident" id="5170679"><a href="/net/http/cookiejar/jar.go.html#5170627">s</a></span><span class="op" id="5170680">[</span><span class="ident" id="5170681"><a href="/net/http/cookiejar/jar.go.html#5170648">i</a></span><span class="op" id="5170682">]</span>&nbsp;<span class="op" id="5170684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5170687">//&nbsp;Cookies&nbsp;implements&nbsp;the&nbsp;Cookies&nbsp;method&nbsp;of&nbsp;the&nbsp;http.CookieJar&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="5170761">//</span><br>
<span class="lineno">170</span><span class="comment" id="5170764">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;if&nbsp;the&nbsp;URL&#39;s&nbsp;scheme&nbsp;is&nbsp;not&nbsp;HTTP&nbsp;or&nbsp;HTTPS.</span><br>
<span class="lineno"></span><span class="keyword" id="5170835">func</span>&nbsp;<span class="op" id="5170840">(</span><span class="ident" id="5170841">j</span>&nbsp;<span class="op" id="5170843">*</span><span class="ident" id="5170844"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5170847">)</span>&nbsp;<span class="ident" id="5170849">Cookies</span><span class="op" id="5170856">(</span><span class="ident" id="5170857">u</span>&nbsp;<span class="op" id="5170859">*</span><span class="ident" id="5170860"><a href="/net/http/cookiejar/jar.go.html#5165966">url</a></span><span class="op" id="5170863">.</span><span class="ident" id="5170864">URL</span><span class="op" id="5170867">)</span>&nbsp;<span class="op" id="5170869">(</span><span class="ident" id="5170870">cookies</span>&nbsp;<span class="op" id="5170878">[</span><span class="op" id="5170879">]</span><span class="op" id="5170880">*</span><span class="ident" id="5170881"><a href="/net/http/cookiejar/jar.go.html#5165954">http</a></span><span class="op" id="5170885">.</span><span class="ident" id="5170886">Cookie</span><span class="op" id="5170892">)</span>&nbsp;<span class="op" id="5170894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5170897">return</span>&nbsp;<span class="ident" id="5170904"><a href="/net/http/cookiejar/jar.go.html#5170841">j</a></span><span class="op" id="5170905">.</span><span class="ident" id="5170906">cookies</span><span class="op" id="5170913">(</span><span class="ident" id="5170914"><a href="/net/http/cookiejar/jar.go.html#5170857">u</a></span><span class="op" id="5170915">,</span>&nbsp;<span class="ident" id="5170917"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5170921">.</span><span class="ident" id="5170922">Now</span><span class="op" id="5170925">(</span><span class="op" id="5170926">)</span><span class="op" id="5170927">)</span><br>
<span class="lineno"></span><span class="op" id="5170929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="5170932">//&nbsp;cookies&nbsp;is&nbsp;like&nbsp;Cookies&nbsp;but&nbsp;takes&nbsp;the&nbsp;current&nbsp;time&nbsp;as&nbsp;a&nbsp;parameter.</span><br>
<span class="lineno"></span><span class="keyword" id="5171002">func</span>&nbsp;<span class="op" id="5171007">(</span><span class="ident" id="5171008">j</span>&nbsp;<span class="op" id="5171010">*</span><span class="ident" id="5171011"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5171014">)</span>&nbsp;<span class="ident" id="5171016">cookies</span><span class="op" id="5171023">(</span><span class="ident" id="5171024">u</span>&nbsp;<span class="op" id="5171026">*</span><span class="ident" id="5171027"><a href="/net/http/cookiejar/jar.go.html#5165966">url</a></span><span class="op" id="5171030">.</span><span class="ident" id="5171031">URL</span><span class="op" id="5171034">,</span>&nbsp;<span class="ident" id="5171036">now</span>&nbsp;<span class="ident" id="5171040"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5171044">.</span><span class="ident" id="5171045">Time</span><span class="op" id="5171049">)</span>&nbsp;<span class="op" id="5171051">(</span><span class="ident" id="5171052">cookies</span>&nbsp;<span class="op" id="5171060">[</span><span class="op" id="5171061">]</span><span class="op" id="5171062">*</span><span class="ident" id="5171063"><a href="/net/http/cookiejar/jar.go.html#5165954">http</a></span><span class="op" id="5171067">.</span><span class="ident" id="5171068">Cookie</span><span class="op" id="5171074">)</span>&nbsp;<span class="op" id="5171076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171079">if</span>&nbsp;<span class="ident" id="5171082"><a href="/net/http/cookiejar/jar.go.html#5171024">u</a></span><span class="op" id="5171083">.</span><span class="ident" id="5171084">Scheme</span>&nbsp;<span class="op" id="5171091">!=</span>&nbsp;<span class="string" id="5171094">&#34;http&#34;</span>&nbsp;<span class="op" id="5171101">&amp;&amp;</span>&nbsp;<span class="ident" id="5171104"><a href="/net/http/cookiejar/jar.go.html#5171024">u</a></span><span class="op" id="5171105">.</span><span class="ident" id="5171106">Scheme</span>&nbsp;<span class="op" id="5171113">!=</span>&nbsp;<span class="string" id="5171116">&#34;https&#34;</span>&nbsp;<span class="op" id="5171124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171128">return</span>&nbsp;<span class="ident" id="5171135"><a href="/net/http/cookiejar/jar.go.html#5171052">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171144">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171147">host</span><span class="op" id="5171151">,</span>&nbsp;<span class="ident" id="5171153">err</span>&nbsp;<span class="op" id="5171157">:=</span>&nbsp;<span class="ident" id="5171160"><a href="/net/http/cookiejar/jar.go.html#5173513">canonicalHost</a></span><span class="op" id="5171173">(</span><span class="ident" id="5171174"><a href="/net/http/cookiejar/jar.go.html#5171024">u</a></span><span class="op" id="5171175">.</span><span class="ident" id="5171176">Host</span><span class="op" id="5171180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171183">if</span>&nbsp;<span class="ident" id="5171186"><a href="/net/http/cookiejar/jar.go.html#5171153">err</a></span>&nbsp;<span class="op" id="5171190">!=</span>&nbsp;<span class="ident" id="5171193">nil</span>&nbsp;<span class="op" id="5171197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171201">return</span>&nbsp;<span class="ident" id="5171208"><a href="/net/http/cookiejar/jar.go.html#5171052">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171220">key</span>&nbsp;<span class="op" id="5171224">:=</span>&nbsp;<span class="ident" id="5171227"><a href="/net/http/cookiejar/jar.go.html#5174216">jarKey</a></span><span class="op" id="5171233">(</span><span class="ident" id="5171234"><a href="/net/http/cookiejar/jar.go.html#5171147">host</a></span><span class="op" id="5171238">,</span>&nbsp;<span class="ident" id="5171240"><a href="/net/http/cookiejar/jar.go.html#5171008">j</a></span><span class="op" id="5171241">.</span><span class="ident" id="5171242">psList</span><span class="op" id="5171248">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171252"><a href="/net/http/cookiejar/jar.go.html#5171008">j</a></span><span class="op" id="5171253">.</span><span class="ident" id="5171254">mu</span><span class="op" id="5171256">.</span><span class="ident" id="5171257">Lock</span><span class="op" id="5171261">(</span><span class="op" id="5171262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171265">defer</span>&nbsp;<span class="ident" id="5171271"><a href="/net/http/cookiejar/jar.go.html#5171008">j</a></span><span class="op" id="5171272">.</span><span class="ident" id="5171273">mu</span><span class="op" id="5171275">.</span><span class="ident" id="5171276">Unlock</span><span class="op" id="5171282">(</span><span class="op" id="5171283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171287">submap</span>&nbsp;<span class="op" id="5171294">:=</span>&nbsp;<span class="ident" id="5171297"><a href="/net/http/cookiejar/jar.go.html#5171008">j</a></span><span class="op" id="5171298">.</span><span class="ident" id="5171299">entries</span><span class="op" id="5171306">[</span><span class="ident" id="5171307"><a href="/net/http/cookiejar/jar.go.html#5171220">key</a></span><span class="op" id="5171310">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171313">if</span>&nbsp;<span class="ident" id="5171316"><a href="/net/http/cookiejar/jar.go.html#5171287">submap</a></span>&nbsp;<span class="op" id="5171323">==</span>&nbsp;<span class="ident" id="5171326">nil</span>&nbsp;<span class="op" id="5171330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171334">return</span>&nbsp;<span class="ident" id="5171341"><a href="/net/http/cookiejar/jar.go.html#5171052">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171354">https</span>&nbsp;<span class="op" id="5171360">:=</span>&nbsp;<span class="ident" id="5171363"><a href="/net/http/cookiejar/jar.go.html#5171024">u</a></span><span class="op" id="5171364">.</span><span class="ident" id="5171365">Scheme</span>&nbsp;<span class="op" id="5171372">==</span>&nbsp;<span class="string" id="5171375">&#34;https&#34;</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171384">path</span>&nbsp;<span class="op" id="5171389">:=</span>&nbsp;<span class="ident" id="5171392"><a href="/net/http/cookiejar/jar.go.html#5171024">u</a></span><span class="op" id="5171393">.</span><span class="ident" id="5171394">Path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171400">if</span>&nbsp;<span class="ident" id="5171403"><a href="/net/http/cookiejar/jar.go.html#5171384">path</a></span>&nbsp;<span class="op" id="5171408">==</span>&nbsp;<span class="string" id="5171411">&#34;&#34;</span>&nbsp;<span class="op" id="5171414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171418"><a href="/net/http/cookiejar/jar.go.html#5171384">path</a></span>&nbsp;<span class="op" id="5171423">=</span>&nbsp;<span class="string" id="5171425">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171434">modified</span>&nbsp;<span class="op" id="5171443">:=</span>&nbsp;<span class="ident" id="5171446">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171453">var</span>&nbsp;<span class="ident" id="5171457">selected</span>&nbsp;<span class="op" id="5171466">[</span><span class="op" id="5171467">]</span><span class="ident" id="5171468"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171475">for</span>&nbsp;<span class="ident" id="5171479">id</span><span class="op" id="5171481">,</span>&nbsp;<span class="ident" id="5171483">e</span>&nbsp;<span class="op" id="5171485">:=</span>&nbsp;<span class="keyword" id="5171488">range</span>&nbsp;<span class="ident" id="5171494"><a href="/net/http/cookiejar/jar.go.html#5171287">submap</a></span>&nbsp;<span class="op" id="5171501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171505">if</span>&nbsp;<span class="ident" id="5171508"><a href="/net/http/cookiejar/jar.go.html#5171483">e</a></span><span class="op" id="5171509">.</span><span class="ident" id="5171510">Persistent</span>&nbsp;<span class="op" id="5171521">&amp;&amp;</span>&nbsp;<span class="op" id="5171524">!</span><span class="ident" id="5171525"><a href="/net/http/cookiejar/jar.go.html#5171483">e</a></span><span class="op" id="5171526">.</span><span class="ident" id="5171527">Expires</span><span class="op" id="5171534">.</span><span class="ident" id="5171535">After</span><span class="op" id="5171540">(</span><span class="ident" id="5171541"><a href="/net/http/cookiejar/jar.go.html#5171036">now</a></span><span class="op" id="5171544">)</span>&nbsp;<span class="op" id="5171546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5171551">delete</span><span class="op" id="5171557">(</span><span class="ident" id="5171558"><a href="/net/http/cookiejar/jar.go.html#5171287">submap</a></span><span class="op" id="5171564">,</span>&nbsp;<span class="ident" id="5171566"><a href="/net/http/cookiejar/jar.go.html#5171479">id</a></span><span class="op" id="5171568">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171573"><a href="/net/http/cookiejar/jar.go.html#5171434">modified</a></span>&nbsp;<span class="op" id="5171582">=</span>&nbsp;<span class="ident" id="5171584">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171592">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171607">if</span>&nbsp;<span class="op" id="5171610">!</span><span class="ident" id="5171611"><a href="/net/http/cookiejar/jar.go.html#5171483">e</a></span><span class="op" id="5171612">.</span><span class="ident" id="5171613">shouldSend</span><span class="op" id="5171623">(</span><span class="ident" id="5171624"><a href="/net/http/cookiejar/jar.go.html#5171354">https</a></span><span class="op" id="5171629">,</span>&nbsp;<span class="ident" id="5171631"><a href="/net/http/cookiejar/jar.go.html#5171147">host</a></span><span class="op" id="5171635">,</span>&nbsp;<span class="ident" id="5171637"><a href="/net/http/cookiejar/jar.go.html#5171384">path</a></span><span class="op" id="5171641">)</span>&nbsp;<span class="op" id="5171643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171648">continue</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171663"><a href="/net/http/cookiejar/jar.go.html#5171483">e</a></span><span class="op" id="5171664">.</span><span class="ident" id="5171665">LastAccess</span>&nbsp;<span class="op" id="5171676">=</span>&nbsp;<span class="ident" id="5171678"><a href="/net/http/cookiejar/jar.go.html#5171036">now</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171684"><a href="/net/http/cookiejar/jar.go.html#5171287">submap</a></span><span class="op" id="5171690">[</span><span class="ident" id="5171691"><a href="/net/http/cookiejar/jar.go.html#5171479">id</a></span><span class="op" id="5171693">]</span>&nbsp;<span class="op" id="5171695">=</span>&nbsp;<span class="ident" id="5171697"><a href="/net/http/cookiejar/jar.go.html#5171483">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171701"><a href="/net/http/cookiejar/jar.go.html#5171457">selected</a></span>&nbsp;<span class="op" id="5171710">=</span>&nbsp;<span class="builtinfunc" id="5171712">append</span><span class="op" id="5171718">(</span><span class="ident" id="5171719"><a href="/net/http/cookiejar/jar.go.html#5171457">selected</a></span><span class="op" id="5171727">,</span>&nbsp;<span class="ident" id="5171729"><a href="/net/http/cookiejar/jar.go.html#5171483">e</a></span><span class="op" id="5171730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171734"><a href="/net/http/cookiejar/jar.go.html#5171434">modified</a></span>&nbsp;<span class="op" id="5171743">=</span>&nbsp;<span class="ident" id="5171745">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171754">if</span>&nbsp;<span class="ident" id="5171757"><a href="/net/http/cookiejar/jar.go.html#5171434">modified</a></span>&nbsp;<span class="op" id="5171766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171770">if</span>&nbsp;<span class="builtinfunc" id="5171773">len</span><span class="op" id="5171776">(</span><span class="ident" id="5171777"><a href="/net/http/cookiejar/jar.go.html#5171287">submap</a></span><span class="op" id="5171783">)</span>&nbsp;<span class="op" id="5171785">==</span>&nbsp;<span class="num" id="5171788">0</span>&nbsp;<span class="op" id="5171790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5171795">delete</span><span class="op" id="5171801">(</span><span class="ident" id="5171802"><a href="/net/http/cookiejar/jar.go.html#5171008">j</a></span><span class="op" id="5171803">.</span><span class="ident" id="5171804">entries</span><span class="op" id="5171811">,</span>&nbsp;<span class="ident" id="5171813"><a href="/net/http/cookiejar/jar.go.html#5171220">key</a></span><span class="op" id="5171816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171820">}</span>&nbsp;<span class="keyword" id="5171822">else</span>&nbsp;<span class="op" id="5171827">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171832"><a href="/net/http/cookiejar/jar.go.html#5171008">j</a></span><span class="op" id="5171833">.</span><span class="ident" id="5171834">entries</span><span class="op" id="5171841">[</span><span class="ident" id="5171842"><a href="/net/http/cookiejar/jar.go.html#5171220">key</a></span><span class="op" id="5171845">]</span>&nbsp;<span class="op" id="5171847">=</span>&nbsp;<span class="ident" id="5171849"><a href="/net/http/cookiejar/jar.go.html#5171287">submap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5171861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171865"><a href="/net/http/cookiejar/jar.go.html#5165977">sort</a></span><span class="op" id="5171869">.</span><span class="ident" id="5171870">Sort</span><span class="op" id="5171874">(</span><span class="ident" id="5171875"><a href="/net/http/cookiejar/jar.go.html#5170294">byPathLength</a></span><span class="op" id="5171887">(</span><span class="ident" id="5171888"><a href="/net/http/cookiejar/jar.go.html#5171457">selected</a></span><span class="op" id="5171896">)</span><span class="op" id="5171897">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5171900">for</span>&nbsp;<span class="ident" id="5171904">_</span><span class="op" id="5171905">,</span>&nbsp;<span class="ident" id="5171907">e</span>&nbsp;<span class="op" id="5171909">:=</span>&nbsp;<span class="keyword" id="5171912">range</span>&nbsp;<span class="ident" id="5171918"><a href="/net/http/cookiejar/jar.go.html#5171457">selected</a></span>&nbsp;<span class="op" id="5171927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5171931"><a href="/net/http/cookiejar/jar.go.html#5171052">cookies</a></span>&nbsp;<span class="op" id="5171939">=</span>&nbsp;<span class="builtinfunc" id="5171941">append</span><span class="op" id="5171947">(</span><span class="ident" id="5171948"><a href="/net/http/cookiejar/jar.go.html#5171052">cookies</a></span><span class="op" id="5171955">,</span>&nbsp;<span class="op" id="5171957">&amp;</span><span class="ident" id="5171958"><a href="/net/http/cookiejar/jar.go.html#5165954">http</a></span><span class="op" id="5171962">.</span><span class="ident" id="5171963">Cookie</span><span class="op" id="5171969">{</span><span class="ident" id="5171970">Name</span><span class="op" id="5171974">:</span>&nbsp;<span class="ident" id="5171976"><a href="/net/http/cookiejar/jar.go.html#5171907">e</a></span><span class="op" id="5171977">.</span><span class="ident" id="5171978">Name</span><span class="op" id="5171982">,</span>&nbsp;<span class="ident" id="5171984">Value</span><span class="op" id="5171989">:</span>&nbsp;<span class="ident" id="5171991"><a href="/net/http/cookiejar/jar.go.html#5171907">e</a></span><span class="op" id="5171992">.</span><span class="ident" id="5171993">Value</span><span class="op" id="5171998">}</span><span class="op" id="5171999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172006">return</span>&nbsp;<span class="ident" id="5172013"><a href="/net/http/cookiejar/jar.go.html#5171052">cookies</a></span><br>
<span class="lineno">230</span><span class="op" id="5172021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5172024">//&nbsp;SetCookies&nbsp;implements&nbsp;the&nbsp;SetCookies&nbsp;method&nbsp;of&nbsp;the&nbsp;http.CookieJar&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="5172104">//</span><br>
<span class="lineno"></span><span class="comment" id="5172107">//&nbsp;It&nbsp;does&nbsp;nothing&nbsp;if&nbsp;the&nbsp;URL&#39;s&nbsp;scheme&nbsp;is&nbsp;not&nbsp;HTTP&nbsp;or&nbsp;HTTPS.</span><br>
<span class="lineno">235</span><span class="keyword" id="5172168">func</span>&nbsp;<span class="op" id="5172173">(</span><span class="ident" id="5172174">j</span>&nbsp;<span class="op" id="5172176">*</span><span class="ident" id="5172177"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5172180">)</span>&nbsp;<span class="ident" id="5172182">SetCookies</span><span class="op" id="5172192">(</span><span class="ident" id="5172193">u</span>&nbsp;<span class="op" id="5172195">*</span><span class="ident" id="5172196"><a href="/net/http/cookiejar/jar.go.html#5165966">url</a></span><span class="op" id="5172199">.</span><span class="ident" id="5172200">URL</span><span class="op" id="5172203">,</span>&nbsp;<span class="ident" id="5172205">cookies</span>&nbsp;<span class="op" id="5172213">[</span><span class="op" id="5172214">]</span><span class="op" id="5172215">*</span><span class="ident" id="5172216"><a href="/net/http/cookiejar/jar.go.html#5165954">http</a></span><span class="op" id="5172220">.</span><span class="ident" id="5172221">Cookie</span><span class="op" id="5172227">)</span>&nbsp;<span class="op" id="5172229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172232"><a href="/net/http/cookiejar/jar.go.html#5172174">j</a></span><span class="op" id="5172233">.</span><span class="ident" id="5172234">setCookies</span><span class="op" id="5172244">(</span><span class="ident" id="5172245"><a href="/net/http/cookiejar/jar.go.html#5172193">u</a></span><span class="op" id="5172246">,</span>&nbsp;<span class="ident" id="5172248"><a href="/net/http/cookiejar/jar.go.html#5172205">cookies</a></span><span class="op" id="5172255">,</span>&nbsp;<span class="ident" id="5172257"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5172261">.</span><span class="ident" id="5172262">Now</span><span class="op" id="5172265">(</span><span class="op" id="5172266">)</span><span class="op" id="5172267">)</span><br>
<span class="lineno"></span><span class="op" id="5172269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5172272">//&nbsp;setCookies&nbsp;is&nbsp;like&nbsp;SetCookies&nbsp;but&nbsp;takes&nbsp;the&nbsp;current&nbsp;time&nbsp;as&nbsp;parameter.</span><br>
<span class="lineno">240</span><span class="keyword" id="5172346">func</span>&nbsp;<span class="op" id="5172351">(</span><span class="ident" id="5172352">j</span>&nbsp;<span class="op" id="5172354">*</span><span class="ident" id="5172355"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5172358">)</span>&nbsp;<span class="ident" id="5172360">setCookies</span><span class="op" id="5172370">(</span><span class="ident" id="5172371">u</span>&nbsp;<span class="op" id="5172373">*</span><span class="ident" id="5172374"><a href="/net/http/cookiejar/jar.go.html#5165966">url</a></span><span class="op" id="5172377">.</span><span class="ident" id="5172378">URL</span><span class="op" id="5172381">,</span>&nbsp;<span class="ident" id="5172383">cookies</span>&nbsp;<span class="op" id="5172391">[</span><span class="op" id="5172392">]</span><span class="op" id="5172393">*</span><span class="ident" id="5172394"><a href="/net/http/cookiejar/jar.go.html#5165954">http</a></span><span class="op" id="5172398">.</span><span class="ident" id="5172399">Cookie</span><span class="op" id="5172405">,</span>&nbsp;<span class="ident" id="5172407">now</span>&nbsp;<span class="ident" id="5172411"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5172415">.</span><span class="ident" id="5172416">Time</span><span class="op" id="5172420">)</span>&nbsp;<span class="op" id="5172422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172425">if</span>&nbsp;<span class="builtinfunc" id="5172428">len</span><span class="op" id="5172431">(</span><span class="ident" id="5172432"><a href="/net/http/cookiejar/jar.go.html#5172383">cookies</a></span><span class="op" id="5172439">)</span>&nbsp;<span class="op" id="5172441">==</span>&nbsp;<span class="num" id="5172444">0</span>&nbsp;<span class="op" id="5172446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172450">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172461">if</span>&nbsp;<span class="ident" id="5172464"><a href="/net/http/cookiejar/jar.go.html#5172371">u</a></span><span class="op" id="5172465">.</span><span class="ident" id="5172466">Scheme</span>&nbsp;<span class="op" id="5172473">!=</span>&nbsp;<span class="string" id="5172476">&#34;http&#34;</span>&nbsp;<span class="op" id="5172483">&amp;&amp;</span>&nbsp;<span class="ident" id="5172486"><a href="/net/http/cookiejar/jar.go.html#5172371">u</a></span><span class="op" id="5172487">.</span><span class="ident" id="5172488">Scheme</span>&nbsp;<span class="op" id="5172495">!=</span>&nbsp;<span class="string" id="5172498">&#34;https&#34;</span>&nbsp;<span class="op" id="5172506">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172510">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172521">host</span><span class="op" id="5172525">,</span>&nbsp;<span class="ident" id="5172527">err</span>&nbsp;<span class="op" id="5172531">:=</span>&nbsp;<span class="ident" id="5172534"><a href="/net/http/cookiejar/jar.go.html#5173513">canonicalHost</a></span><span class="op" id="5172547">(</span><span class="ident" id="5172548"><a href="/net/http/cookiejar/jar.go.html#5172371">u</a></span><span class="op" id="5172549">.</span><span class="ident" id="5172550">Host</span><span class="op" id="5172554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172557">if</span>&nbsp;<span class="ident" id="5172560"><a href="/net/http/cookiejar/jar.go.html#5172527">err</a></span>&nbsp;<span class="op" id="5172564">!=</span>&nbsp;<span class="ident" id="5172567">nil</span>&nbsp;<span class="op" id="5172571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172575">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172586">key</span>&nbsp;<span class="op" id="5172590">:=</span>&nbsp;<span class="ident" id="5172593"><a href="/net/http/cookiejar/jar.go.html#5174216">jarKey</a></span><span class="op" id="5172599">(</span><span class="ident" id="5172600"><a href="/net/http/cookiejar/jar.go.html#5172521">host</a></span><span class="op" id="5172604">,</span>&nbsp;<span class="ident" id="5172606"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5172607">.</span><span class="ident" id="5172608">psList</span><span class="op" id="5172614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172617">defPath</span>&nbsp;<span class="op" id="5172625">:=</span>&nbsp;<span class="ident" id="5172628"><a href="/net/http/cookiejar/jar.go.html#5174968">defaultPath</a></span><span class="op" id="5172639">(</span><span class="ident" id="5172640"><a href="/net/http/cookiejar/jar.go.html#5172371">u</a></span><span class="op" id="5172641">.</span><span class="ident" id="5172642">Path</span><span class="op" id="5172646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172650"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5172651">.</span><span class="ident" id="5172652">mu</span><span class="op" id="5172654">.</span><span class="ident" id="5172655">Lock</span><span class="op" id="5172659">(</span><span class="op" id="5172660">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172663">defer</span>&nbsp;<span class="ident" id="5172669"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5172670">.</span><span class="ident" id="5172671">mu</span><span class="op" id="5172673">.</span><span class="ident" id="5172674">Unlock</span><span class="op" id="5172680">(</span><span class="op" id="5172681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172685">submap</span>&nbsp;<span class="op" id="5172692">:=</span>&nbsp;<span class="ident" id="5172695"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5172696">.</span><span class="ident" id="5172697">entries</span><span class="op" id="5172704">[</span><span class="ident" id="5172705"><a href="/net/http/cookiejar/jar.go.html#5172586">key</a></span><span class="op" id="5172708">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172712">modified</span>&nbsp;<span class="op" id="5172721">:=</span>&nbsp;<span class="ident" id="5172724">false</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172731">for</span>&nbsp;<span class="ident" id="5172735">_</span><span class="op" id="5172736">,</span>&nbsp;<span class="ident" id="5172738">cookie</span>&nbsp;<span class="op" id="5172745">:=</span>&nbsp;<span class="keyword" id="5172748">range</span>&nbsp;<span class="ident" id="5172754"><a href="/net/http/cookiejar/jar.go.html#5172383">cookies</a></span>&nbsp;<span class="op" id="5172762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172766">e</span><span class="op" id="5172767">,</span>&nbsp;<span class="ident" id="5172769">remove</span><span class="op" id="5172775">,</span>&nbsp;<span class="ident" id="5172777">err</span>&nbsp;<span class="op" id="5172781">:=</span>&nbsp;<span class="ident" id="5172784"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5172785">.</span><span class="ident" id="5172786">newEntry</span><span class="op" id="5172794">(</span><span class="ident" id="5172795"><a href="/net/http/cookiejar/jar.go.html#5172738">cookie</a></span><span class="op" id="5172801">,</span>&nbsp;<span class="ident" id="5172803"><a href="/net/http/cookiejar/jar.go.html#5172407">now</a></span><span class="op" id="5172806">,</span>&nbsp;<span class="ident" id="5172808"><a href="/net/http/cookiejar/jar.go.html#5172617">defPath</a></span><span class="op" id="5172815">,</span>&nbsp;<span class="ident" id="5172817"><a href="/net/http/cookiejar/jar.go.html#5172521">host</a></span><span class="op" id="5172821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172825">if</span>&nbsp;<span class="ident" id="5172828"><a href="/net/http/cookiejar/jar.go.html#5172777">err</a></span>&nbsp;<span class="op" id="5172832">!=</span>&nbsp;<span class="ident" id="5172835">nil</span>&nbsp;<span class="op" id="5172839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172844">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172855">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172859">id</span>&nbsp;<span class="op" id="5172862">:=</span>&nbsp;<span class="ident" id="5172865"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><span class="op" id="5172866">.</span><span class="ident" id="5172867">id</span><span class="op" id="5172869">(</span><span class="op" id="5172870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172874">if</span>&nbsp;<span class="ident" id="5172877"><a href="/net/http/cookiejar/jar.go.html#5172769">remove</a></span>&nbsp;<span class="op" id="5172884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172889">if</span>&nbsp;<span class="ident" id="5172892"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span>&nbsp;<span class="op" id="5172899">!=</span>&nbsp;<span class="ident" id="5172902">nil</span>&nbsp;<span class="op" id="5172906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172912">if</span>&nbsp;<span class="ident" id="5172915">_</span><span class="op" id="5172916">,</span>&nbsp;<span class="ident" id="5172918">ok</span>&nbsp;<span class="op" id="5172921">:=</span>&nbsp;<span class="ident" id="5172924"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span><span class="op" id="5172930">[</span><span class="ident" id="5172931"><a href="/net/http/cookiejar/jar.go.html#5172859">id</a></span><span class="op" id="5172933">]</span><span class="op" id="5172934">;</span>&nbsp;<span class="ident" id="5172936"><a href="/net/http/cookiejar/jar.go.html#5172918">ok</a></span>&nbsp;<span class="op" id="5172939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5172946">delete</span><span class="op" id="5172952">(</span><span class="ident" id="5172953"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span><span class="op" id="5172959">,</span>&nbsp;<span class="ident" id="5172961"><a href="/net/http/cookiejar/jar.go.html#5172859">id</a></span><span class="op" id="5172963">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172970"><a href="/net/http/cookiejar/jar.go.html#5172712">modified</a></span>&nbsp;<span class="op" id="5172979">=</span>&nbsp;<span class="ident" id="5172981">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173000">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173011">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173015">if</span>&nbsp;<span class="ident" id="5173018"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span>&nbsp;<span class="op" id="5173025">==</span>&nbsp;<span class="ident" id="5173028">nil</span>&nbsp;<span class="op" id="5173032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173037"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span>&nbsp;<span class="op" id="5173044">=</span>&nbsp;<span class="builtinfunc" id="5173046">make</span><span class="op" id="5173050">(</span><span class="keyword" id="5173051">map</span><span class="op" id="5173054">[</span><span class="builtintype" id="5173055">string</span><span class="op" id="5173061">]</span><span class="ident" id="5173062"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5173067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173076">if</span>&nbsp;<span class="ident" id="5173079">old</span><span class="op" id="5173082">,</span>&nbsp;<span class="ident" id="5173084">ok</span>&nbsp;<span class="op" id="5173087">:=</span>&nbsp;<span class="ident" id="5173090"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span><span class="op" id="5173096">[</span><span class="ident" id="5173097"><a href="/net/http/cookiejar/jar.go.html#5172859">id</a></span><span class="op" id="5173099">]</span><span class="op" id="5173100">;</span>&nbsp;<span class="ident" id="5173102"><a href="/net/http/cookiejar/jar.go.html#5173084">ok</a></span>&nbsp;<span class="op" id="5173105">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173110"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><span class="op" id="5173111">.</span><span class="ident" id="5173112">Creation</span>&nbsp;<span class="op" id="5173121">=</span>&nbsp;<span class="ident" id="5173123"><a href="/net/http/cookiejar/jar.go.html#5173079">old</a></span><span class="op" id="5173126">.</span><span class="ident" id="5173127">Creation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173139"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><span class="op" id="5173140">.</span><span class="ident" id="5173141">seqNum</span>&nbsp;<span class="op" id="5173148">=</span>&nbsp;<span class="ident" id="5173150"><a href="/net/http/cookiejar/jar.go.html#5173079">old</a></span><span class="op" id="5173153">.</span><span class="ident" id="5173154">seqNum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173163">}</span>&nbsp;<span class="keyword" id="5173165">else</span>&nbsp;<span class="op" id="5173170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173175"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><span class="op" id="5173176">.</span><span class="ident" id="5173177">Creation</span>&nbsp;<span class="op" id="5173186">=</span>&nbsp;<span class="ident" id="5173188"><a href="/net/http/cookiejar/jar.go.html#5172407">now</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173195"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><span class="op" id="5173196">.</span><span class="ident" id="5173197">seqNum</span>&nbsp;<span class="op" id="5173204">=</span>&nbsp;<span class="ident" id="5173206"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5173207">.</span><span class="ident" id="5173208">nextSeqNum</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173222"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5173223">.</span><span class="ident" id="5173224">nextSeqNum</span><span class="op" id="5173234">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173243"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><span class="op" id="5173244">.</span><span class="ident" id="5173245">LastAccess</span>&nbsp;<span class="op" id="5173256">=</span>&nbsp;<span class="ident" id="5173258"><a href="/net/http/cookiejar/jar.go.html#5172407">now</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173264"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span><span class="op" id="5173270">[</span><span class="ident" id="5173271"><a href="/net/http/cookiejar/jar.go.html#5172859">id</a></span><span class="op" id="5173273">]</span>&nbsp;<span class="op" id="5173275">=</span>&nbsp;<span class="ident" id="5173277"><a href="/net/http/cookiejar/jar.go.html#5172766">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173281"><a href="/net/http/cookiejar/jar.go.html#5172712">modified</a></span>&nbsp;<span class="op" id="5173290">=</span>&nbsp;<span class="ident" id="5173292">true</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173302">if</span>&nbsp;<span class="ident" id="5173305"><a href="/net/http/cookiejar/jar.go.html#5172712">modified</a></span>&nbsp;<span class="op" id="5173314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173318">if</span>&nbsp;<span class="builtinfunc" id="5173321">len</span><span class="op" id="5173324">(</span><span class="ident" id="5173325"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span><span class="op" id="5173331">)</span>&nbsp;<span class="op" id="5173333">==</span>&nbsp;<span class="num" id="5173336">0</span>&nbsp;<span class="op" id="5173338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5173343">delete</span><span class="op" id="5173349">(</span><span class="ident" id="5173350"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5173351">.</span><span class="ident" id="5173352">entries</span><span class="op" id="5173359">,</span>&nbsp;<span class="ident" id="5173361"><a href="/net/http/cookiejar/jar.go.html#5172586">key</a></span><span class="op" id="5173364">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173368">}</span>&nbsp;<span class="keyword" id="5173370">else</span>&nbsp;<span class="op" id="5173375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173380"><a href="/net/http/cookiejar/jar.go.html#5172352">j</a></span><span class="op" id="5173381">.</span><span class="ident" id="5173382">entries</span><span class="op" id="5173389">[</span><span class="ident" id="5173390"><a href="/net/http/cookiejar/jar.go.html#5172586">key</a></span><span class="op" id="5173393">]</span>&nbsp;<span class="op" id="5173395">=</span>&nbsp;<span class="ident" id="5173397"><a href="/net/http/cookiejar/jar.go.html#5172685">submap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173409">}</span><br>
<span class="lineno"></span><span class="op" id="5173411">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="5173414">//&nbsp;canonicalHost&nbsp;strips&nbsp;port&nbsp;from&nbsp;host&nbsp;if&nbsp;present&nbsp;and&nbsp;returns&nbsp;the&nbsp;canonicalized</span><br>
<span class="lineno"></span><span class="comment" id="5173494">//&nbsp;host&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5173508">func</span>&nbsp;<span class="ident" id="5173513">canonicalHost</span><span class="op" id="5173526">(</span><span class="ident" id="5173527">host</span>&nbsp;<span class="builtintype" id="5173532">string</span><span class="op" id="5173538">)</span>&nbsp;<span class="op" id="5173540">(</span><span class="builtintype" id="5173541">string</span><span class="op" id="5173547">,</span>&nbsp;<span class="builtintype" id="5173549">error</span><span class="op" id="5173554">)</span>&nbsp;<span class="op" id="5173556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173559">var</span>&nbsp;<span class="ident" id="5173563">err</span>&nbsp;<span class="builtintype" id="5173567">error</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173574"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span>&nbsp;<span class="op" id="5173579">=</span>&nbsp;<span class="ident" id="5173581"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5173588">.</span><span class="ident" id="5173589">ToLower</span><span class="op" id="5173596">(</span><span class="ident" id="5173597"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173604">if</span>&nbsp;<span class="ident" id="5173607"><a href="/net/http/cookiejar/jar.go.html#5173974">hasPort</a></span><span class="op" id="5173614">(</span><span class="ident" id="5173615"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173619">)</span>&nbsp;<span class="op" id="5173621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173625"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173629">,</span>&nbsp;<span class="ident" id="5173631">_</span><span class="op" id="5173632">,</span>&nbsp;<span class="ident" id="5173634"><a href="/net/http/cookiejar/jar.go.html#5173563">err</a></span>&nbsp;<span class="op" id="5173638">=</span>&nbsp;<span class="ident" id="5173640"><a href="/net/http/cookiejar/jar.go.html#5165947">net</a></span><span class="op" id="5173643">.</span><span class="ident" id="5173644">SplitHostPort</span><span class="op" id="5173657">(</span><span class="ident" id="5173658"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173666">if</span>&nbsp;<span class="ident" id="5173669"><a href="/net/http/cookiejar/jar.go.html#5173563">err</a></span>&nbsp;<span class="op" id="5173673">!=</span>&nbsp;<span class="ident" id="5173676">nil</span>&nbsp;<span class="op" id="5173680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173685">return</span>&nbsp;<span class="string" id="5173692">&#34;&#34;</span><span class="op" id="5173694">,</span>&nbsp;<span class="ident" id="5173696"><a href="/net/http/cookiejar/jar.go.html#5173563">err</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173708">if</span>&nbsp;<span class="ident" id="5173711"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5173718">.</span><span class="ident" id="5173719">HasSuffix</span><span class="op" id="5173728">(</span><span class="ident" id="5173729"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173733">,</span>&nbsp;<span class="string" id="5173735">&#34;.&#34;</span><span class="op" id="5173738">)</span>&nbsp;<span class="op" id="5173740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173744">//&nbsp;Strip&nbsp;trailing&nbsp;dot&nbsp;from&nbsp;fully&nbsp;qualified&nbsp;domain&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173803"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span>&nbsp;<span class="op" id="5173808">=</span>&nbsp;<span class="ident" id="5173810"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173814">[</span><span class="op" id="5173815">:</span><span class="builtinfunc" id="5173816">len</span><span class="op" id="5173819">(</span><span class="ident" id="5173820"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173824">)</span><span class="op" id="5173825">-</span><span class="num" id="5173826">1</span><span class="op" id="5173827">]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173833">return</span>&nbsp;<span class="ident" id="5173840"><a href="/net/http/cookiejar/punycode.go.html#5182088">toASCII</a></span><span class="op" id="5173847">(</span><span class="ident" id="5173848"><a href="/net/http/cookiejar/jar.go.html#5173527">host</a></span><span class="op" id="5173852">)</span><br>
<span class="lineno"></span><span class="op" id="5173854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5173857">//&nbsp;hasPort&nbsp;reports&nbsp;whether&nbsp;host&nbsp;contains&nbsp;a&nbsp;port&nbsp;number.&nbsp;host&nbsp;may&nbsp;be&nbsp;a&nbsp;host</span><br>
<span class="lineno">320</span><span class="comment" id="5173932">//&nbsp;name,&nbsp;an&nbsp;IPv4&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="5173969">func</span>&nbsp;<span class="ident" id="5173974">hasPort</span><span class="op" id="5173981">(</span><span class="ident" id="5173982">host</span>&nbsp;<span class="builtintype" id="5173987">string</span><span class="op" id="5173993">)</span>&nbsp;<span class="builtintype" id="5173995">bool</span>&nbsp;<span class="op" id="5174000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174003">colons</span>&nbsp;<span class="op" id="5174010">:=</span>&nbsp;<span class="ident" id="5174013"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5174020">.</span><span class="ident" id="5174021">Count</span><span class="op" id="5174026">(</span><span class="ident" id="5174027"><a href="/net/http/cookiejar/jar.go.html#5173982">host</a></span><span class="op" id="5174031">,</span>&nbsp;<span class="string" id="5174033">&#34;:&#34;</span><span class="op" id="5174036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174039">if</span>&nbsp;<span class="ident" id="5174042"><a href="/net/http/cookiejar/jar.go.html#5174003">colons</a></span>&nbsp;<span class="op" id="5174049">==</span>&nbsp;<span class="num" id="5174052">0</span>&nbsp;<span class="op" id="5174054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174058">return</span>&nbsp;<span class="ident" id="5174065">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174075">if</span>&nbsp;<span class="ident" id="5174078"><a href="/net/http/cookiejar/jar.go.html#5174003">colons</a></span>&nbsp;<span class="op" id="5174085">==</span>&nbsp;<span class="num" id="5174088">1</span>&nbsp;<span class="op" id="5174090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174094">return</span>&nbsp;<span class="ident" id="5174101">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174110">return</span>&nbsp;<span class="ident" id="5174117"><a href="/net/http/cookiejar/jar.go.html#5173982">host</a></span><span class="op" id="5174121">[</span><span class="num" id="5174122">0</span><span class="op" id="5174123">]</span>&nbsp;<span class="op" id="5174125">==</span>&nbsp;<span class="string" id="5174128">&#39;[&#39;</span>&nbsp;<span class="op" id="5174132">&amp;&amp;</span>&nbsp;<span class="ident" id="5174135"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5174142">.</span><span class="ident" id="5174143">Contains</span><span class="op" id="5174151">(</span><span class="ident" id="5174152"><a href="/net/http/cookiejar/jar.go.html#5173982">host</a></span><span class="op" id="5174156">,</span>&nbsp;<span class="string" id="5174158">&#34;]:&#34;</span><span class="op" id="5174162">)</span><br>
<span class="lineno">330</span><span class="op" id="5174164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5174167">//&nbsp;jarKey&nbsp;returns&nbsp;the&nbsp;key&nbsp;to&nbsp;use&nbsp;for&nbsp;a&nbsp;jar.</span><br>
<span class="lineno"></span><span class="keyword" id="5174211">func</span>&nbsp;<span class="ident" id="5174216">jarKey</span><span class="op" id="5174222">(</span><span class="ident" id="5174223">host</span>&nbsp;<span class="builtintype" id="5174228">string</span><span class="op" id="5174234">,</span>&nbsp;<span class="ident" id="5174236">psl</span>&nbsp;<span class="ident" id="5174240"><a href="/net/http/cookiejar/jar.go.html#5166669">PublicSuffixList</a></span><span class="op" id="5174256">)</span>&nbsp;<span class="builtintype" id="5174258">string</span>&nbsp;<span class="op" id="5174265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174268">if</span>&nbsp;<span class="ident" id="5174271"><a href="/net/http/cookiejar/jar.go.html#5174803">isIP</a></span><span class="op" id="5174275">(</span><span class="ident" id="5174276"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174280">)</span>&nbsp;<span class="op" id="5174282">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174286">return</span>&nbsp;<span class="ident" id="5174293"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174303">var</span>&nbsp;<span class="ident" id="5174307">i</span>&nbsp;<span class="builtintype" id="5174309">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174314">if</span>&nbsp;<span class="ident" id="5174317"><a href="/net/http/cookiejar/jar.go.html#5174236">psl</a></span>&nbsp;<span class="op" id="5174321">==</span>&nbsp;<span class="ident" id="5174324">nil</span>&nbsp;<span class="op" id="5174328">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174332"><a href="/net/http/cookiejar/jar.go.html#5174307">i</a></span>&nbsp;<span class="op" id="5174334">=</span>&nbsp;<span class="ident" id="5174336"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5174343">.</span><span class="ident" id="5174344">LastIndex</span><span class="op" id="5174353">(</span><span class="ident" id="5174354"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174358">,</span>&nbsp;<span class="string" id="5174360">&#34;.&#34;</span><span class="op" id="5174363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174367">if</span>&nbsp;<span class="ident" id="5174370"><a href="/net/http/cookiejar/jar.go.html#5174307">i</a></span>&nbsp;<span class="op" id="5174372">==</span>&nbsp;<span class="op" id="5174375">-</span><span class="num" id="5174376">1</span>&nbsp;<span class="op" id="5174378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174383">return</span>&nbsp;<span class="ident" id="5174390"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174400">}</span>&nbsp;<span class="keyword" id="5174402">else</span>&nbsp;<span class="op" id="5174407">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174411">suffix</span>&nbsp;<span class="op" id="5174418">:=</span>&nbsp;<span class="ident" id="5174421"><a href="/net/http/cookiejar/jar.go.html#5174236">psl</a></span><span class="op" id="5174424">.</span><span class="ident" id="5174425">PublicSuffix</span><span class="op" id="5174437">(</span><span class="ident" id="5174438"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174446">if</span>&nbsp;<span class="ident" id="5174449"><a href="/net/http/cookiejar/jar.go.html#5174411">suffix</a></span>&nbsp;<span class="op" id="5174456">==</span>&nbsp;<span class="ident" id="5174459"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span>&nbsp;<span class="op" id="5174464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174469">return</span>&nbsp;<span class="ident" id="5174476"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174487"><a href="/net/http/cookiejar/jar.go.html#5174307">i</a></span>&nbsp;<span class="op" id="5174489">=</span>&nbsp;<span class="builtinfunc" id="5174491">len</span><span class="op" id="5174494">(</span><span class="ident" id="5174495"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174499">)</span>&nbsp;<span class="op" id="5174501">-</span>&nbsp;<span class="builtinfunc" id="5174503">len</span><span class="op" id="5174506">(</span><span class="ident" id="5174507"><a href="/net/http/cookiejar/jar.go.html#5174411">suffix</a></span><span class="op" id="5174513">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174517">if</span>&nbsp;<span class="ident" id="5174520"><a href="/net/http/cookiejar/jar.go.html#5174307">i</a></span>&nbsp;<span class="op" id="5174522">&lt;=</span>&nbsp;<span class="num" id="5174525">0</span>&nbsp;<span class="op" id="5174527">||</span>&nbsp;<span class="ident" id="5174530"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174534">[</span><span class="ident" id="5174535"><a href="/net/http/cookiejar/jar.go.html#5174307">i</a></span><span class="op" id="5174536">-</span><span class="num" id="5174537">1</span><span class="op" id="5174538">]</span>&nbsp;<span class="op" id="5174540">!=</span>&nbsp;<span class="string" id="5174543">&#39;.&#39;</span>&nbsp;<span class="op" id="5174547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174552">//&nbsp;The&nbsp;provided&nbsp;public&nbsp;suffix&nbsp;list&nbsp;psl&nbsp;is&nbsp;broken.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174605">//&nbsp;Storing&nbsp;cookies&nbsp;under&nbsp;host&nbsp;is&nbsp;a&nbsp;safe&nbsp;stopgap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174657">return</span>&nbsp;<span class="ident" id="5174664"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174671">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174677">prevDot</span>&nbsp;<span class="op" id="5174685">:=</span>&nbsp;<span class="ident" id="5174688"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5174695">.</span><span class="ident" id="5174696">LastIndex</span><span class="op" id="5174705">(</span><span class="ident" id="5174706"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174710">[</span><span class="op" id="5174711">:</span><span class="ident" id="5174712"><a href="/net/http/cookiejar/jar.go.html#5174307">i</a></span><span class="op" id="5174713">-</span><span class="num" id="5174714">1</span><span class="op" id="5174715">]</span><span class="op" id="5174716">,</span>&nbsp;<span class="string" id="5174718">&#34;.&#34;</span><span class="op" id="5174721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174724">return</span>&nbsp;<span class="ident" id="5174731"><a href="/net/http/cookiejar/jar.go.html#5174223">host</a></span><span class="op" id="5174735">[</span><span class="ident" id="5174736"><a href="/net/http/cookiejar/jar.go.html#5174677">prevDot</a></span><span class="op" id="5174743">+</span><span class="num" id="5174744">1</span><span class="op" id="5174745">:</span><span class="op" id="5174746">]</span><br>
<span class="lineno"></span><span class="op" id="5174748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="5174751">//&nbsp;isIP&nbsp;reports&nbsp;whether&nbsp;host&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="5174798">func</span>&nbsp;<span class="ident" id="5174803">isIP</span><span class="op" id="5174807">(</span><span class="ident" id="5174808">host</span>&nbsp;<span class="builtintype" id="5174813">string</span><span class="op" id="5174819">)</span>&nbsp;<span class="builtintype" id="5174821">bool</span>&nbsp;<span class="op" id="5174826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174829">return</span>&nbsp;<span class="ident" id="5174836"><a href="/net/http/cookiejar/jar.go.html#5165947">net</a></span><span class="op" id="5174839">.</span><span class="ident" id="5174840">ParseIP</span><span class="op" id="5174847">(</span><span class="ident" id="5174848"><a href="/net/http/cookiejar/jar.go.html#5174808">host</a></span><span class="op" id="5174852">)</span>&nbsp;<span class="op" id="5174854">!=</span>&nbsp;<span class="ident" id="5174857">nil</span><br>
<span class="lineno"></span><span class="op" id="5174861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="5174864">//&nbsp;defaultPath&nbsp;returns&nbsp;the&nbsp;directory&nbsp;part&nbsp;of&nbsp;an&nbsp;URL&#39;s&nbsp;path&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5174936">//&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.1.4.</span><br>
<span class="lineno"></span><span class="keyword" id="5174963">func</span>&nbsp;<span class="ident" id="5174968">defaultPath</span><span class="op" id="5174979">(</span><span class="ident" id="5174980">path</span>&nbsp;<span class="builtintype" id="5174985">string</span><span class="op" id="5174991">)</span>&nbsp;<span class="builtintype" id="5174993">string</span>&nbsp;<span class="op" id="5175000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175003">if</span>&nbsp;<span class="builtinfunc" id="5175006">len</span><span class="op" id="5175009">(</span><span class="ident" id="5175010"><a href="/net/http/cookiejar/jar.go.html#5174980">path</a></span><span class="op" id="5175014">)</span>&nbsp;<span class="op" id="5175016">==</span>&nbsp;<span class="num" id="5175019">0</span>&nbsp;<span class="op" id="5175021">||</span>&nbsp;<span class="ident" id="5175024"><a href="/net/http/cookiejar/jar.go.html#5174980">path</a></span><span class="op" id="5175028">[</span><span class="num" id="5175029">0</span><span class="op" id="5175030">]</span>&nbsp;<span class="op" id="5175032">!=</span>&nbsp;<span class="string" id="5175035">&#39;/&#39;</span>&nbsp;<span class="op" id="5175039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175043">return</span>&nbsp;<span class="string" id="5175050">&#34;/&#34;</span>&nbsp;<span class="comment" id="5175054">//&nbsp;Path&nbsp;is&nbsp;empty&nbsp;or&nbsp;malformed.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175090">i</span>&nbsp;<span class="op" id="5175092">:=</span>&nbsp;<span class="ident" id="5175095"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5175102">.</span><span class="ident" id="5175103">LastIndex</span><span class="op" id="5175112">(</span><span class="ident" id="5175113"><a href="/net/http/cookiejar/jar.go.html#5174980">path</a></span><span class="op" id="5175117">,</span>&nbsp;<span class="string" id="5175119">&#34;/&#34;</span><span class="op" id="5175122">)</span>&nbsp;<span class="comment" id="5175124">//&nbsp;Path&nbsp;starts&nbsp;with&nbsp;&#34;/&#34;,&nbsp;so&nbsp;i&nbsp;!=&nbsp;-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175162">if</span>&nbsp;<span class="ident" id="5175165"><a href="/net/http/cookiejar/jar.go.html#5175090">i</a></span>&nbsp;<span class="op" id="5175167">==</span>&nbsp;<span class="num" id="5175170">0</span>&nbsp;<span class="op" id="5175172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175176">return</span>&nbsp;<span class="string" id="5175183">&#34;/&#34;</span>&nbsp;<span class="comment" id="5175187">//&nbsp;Path&nbsp;has&nbsp;the&nbsp;form&nbsp;&#34;/abc&#34;.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5175217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175220">return</span>&nbsp;<span class="ident" id="5175227"><a href="/net/http/cookiejar/jar.go.html#5174980">path</a></span><span class="op" id="5175231">[</span><span class="op" id="5175232">:</span><span class="ident" id="5175233"><a href="/net/http/cookiejar/jar.go.html#5175090">i</a></span><span class="op" id="5175234">]</span>&nbsp;<span class="comment" id="5175236">//&nbsp;Path&nbsp;is&nbsp;either&nbsp;of&nbsp;form&nbsp;&#34;/abc/xyz&#34;&nbsp;or&nbsp;&#34;/abc/xyz/&#34;.</span><br>
<span class="lineno"></span><span class="op" id="5175289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5175292">//&nbsp;newEntry&nbsp;creates&nbsp;an&nbsp;entry&nbsp;from&nbsp;a&nbsp;http.Cookie&nbsp;c.&nbsp;now&nbsp;is&nbsp;the&nbsp;current&nbsp;time&nbsp;and</span><br>
<span class="lineno">380</span><span class="comment" id="5175371">//&nbsp;is&nbsp;compared&nbsp;to&nbsp;c.Expires&nbsp;to&nbsp;determine&nbsp;deletion&nbsp;of&nbsp;c.&nbsp;defPath&nbsp;and&nbsp;host&nbsp;are&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5175452">//&nbsp;default-path&nbsp;and&nbsp;the&nbsp;canonical&nbsp;host&nbsp;name&nbsp;of&nbsp;the&nbsp;URL&nbsp;c&nbsp;was&nbsp;received&nbsp;from.</span><br>
<span class="lineno"></span><span class="comment" id="5175528">//</span><br>
<span class="lineno"></span><span class="comment" id="5175531">//&nbsp;remove&nbsp;records&nbsp;whether&nbsp;the&nbsp;jar&nbsp;should&nbsp;delete&nbsp;this&nbsp;cookie,&nbsp;as&nbsp;it&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="5175610">//&nbsp;expired&nbsp;with&nbsp;respect&nbsp;to&nbsp;now.&nbsp;In&nbsp;this&nbsp;case,&nbsp;e&nbsp;may&nbsp;be&nbsp;incomplete,&nbsp;but&nbsp;it&nbsp;will</span><br>
<span class="lineno">385</span><span class="comment" id="5175689">//&nbsp;be&nbsp;valid&nbsp;to&nbsp;call&nbsp;e.id&nbsp;(which&nbsp;depends&nbsp;on&nbsp;e&#39;s&nbsp;Name,&nbsp;Domain&nbsp;and&nbsp;Path).</span><br>
<span class="lineno"></span><span class="comment" id="5175760">//</span><br>
<span class="lineno"></span><span class="comment" id="5175763">//&nbsp;A&nbsp;malformed&nbsp;c.Domain&nbsp;will&nbsp;result&nbsp;in&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5175812">func</span>&nbsp;<span class="op" id="5175817">(</span><span class="ident" id="5175818">j</span>&nbsp;<span class="op" id="5175820">*</span><span class="ident" id="5175821"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5175824">)</span>&nbsp;<span class="ident" id="5175826">newEntry</span><span class="op" id="5175834">(</span><span class="ident" id="5175835">c</span>&nbsp;<span class="op" id="5175837">*</span><span class="ident" id="5175838"><a href="/net/http/cookiejar/jar.go.html#5165954">http</a></span><span class="op" id="5175842">.</span><span class="ident" id="5175843">Cookie</span><span class="op" id="5175849">,</span>&nbsp;<span class="ident" id="5175851">now</span>&nbsp;<span class="ident" id="5175855"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5175859">.</span><span class="ident" id="5175860">Time</span><span class="op" id="5175864">,</span>&nbsp;<span class="ident" id="5175866">defPath</span><span class="op" id="5175873">,</span>&nbsp;<span class="ident" id="5175875">host</span>&nbsp;<span class="builtintype" id="5175880">string</span><span class="op" id="5175886">)</span>&nbsp;<span class="op" id="5175888">(</span><span class="ident" id="5175889">e</span>&nbsp;<span class="ident" id="5175891"><a href="/net/http/cookiejar/jar.go.html#5168395">entry</a></span><span class="op" id="5175896">,</span>&nbsp;<span class="ident" id="5175898">remove</span>&nbsp;<span class="builtintype" id="5175905">bool</span><span class="op" id="5175909">,</span>&nbsp;<span class="ident" id="5175911">err</span>&nbsp;<span class="builtintype" id="5175915">error</span><span class="op" id="5175920">)</span>&nbsp;<span class="op" id="5175922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175925"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5175926">.</span><span class="ident" id="5175927">Name</span>&nbsp;<span class="op" id="5175932">=</span>&nbsp;<span class="ident" id="5175934"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5175935">.</span><span class="ident" id="5175936">Name</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5175943">if</span>&nbsp;<span class="ident" id="5175946"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5175947">.</span><span class="ident" id="5175948">Path</span>&nbsp;<span class="op" id="5175953">==</span>&nbsp;<span class="string" id="5175956">&#34;&#34;</span>&nbsp;<span class="op" id="5175959">||</span>&nbsp;<span class="ident" id="5175962"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5175963">.</span><span class="ident" id="5175964">Path</span><span class="op" id="5175968">[</span><span class="num" id="5175969">0</span><span class="op" id="5175970">]</span>&nbsp;<span class="op" id="5175972">!=</span>&nbsp;<span class="string" id="5175975">&#39;/&#39;</span>&nbsp;<span class="op" id="5175979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175983"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5175984">.</span><span class="ident" id="5175985">Path</span>&nbsp;<span class="op" id="5175990">=</span>&nbsp;<span class="ident" id="5175992"><a href="/net/http/cookiejar/jar.go.html#5175866">defPath</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176001">}</span>&nbsp;<span class="keyword" id="5176003">else</span>&nbsp;<span class="op" id="5176008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176012"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176013">.</span><span class="ident" id="5176014">Path</span>&nbsp;<span class="op" id="5176019">=</span>&nbsp;<span class="ident" id="5176021"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176022">.</span><span class="ident" id="5176023">Path</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176033"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176034">.</span><span class="ident" id="5176035">Domain</span><span class="op" id="5176041">,</span>&nbsp;<span class="ident" id="5176043"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176044">.</span><span class="ident" id="5176045">HostOnly</span><span class="op" id="5176053">,</span>&nbsp;<span class="ident" id="5176055"><a href="/net/http/cookiejar/jar.go.html#5175911">err</a></span>&nbsp;<span class="op" id="5176059">=</span>&nbsp;<span class="ident" id="5176061"><a href="/net/http/cookiejar/jar.go.html#5175818">j</a></span><span class="op" id="5176062">.</span><span class="ident" id="5176063">domainAndType</span><span class="op" id="5176076">(</span><span class="ident" id="5176077"><a href="/net/http/cookiejar/jar.go.html#5175875">host</a></span><span class="op" id="5176081">,</span>&nbsp;<span class="ident" id="5176083"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176084">.</span><span class="ident" id="5176085">Domain</span><span class="op" id="5176091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176094">if</span>&nbsp;<span class="ident" id="5176097"><a href="/net/http/cookiejar/jar.go.html#5175911">err</a></span>&nbsp;<span class="op" id="5176101">!=</span>&nbsp;<span class="ident" id="5176104">nil</span>&nbsp;<span class="op" id="5176108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176112">return</span>&nbsp;<span class="ident" id="5176119"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176120">,</span>&nbsp;<span class="ident" id="5176122">false</span><span class="op" id="5176127">,</span>&nbsp;<span class="ident" id="5176129"><a href="/net/http/cookiejar/jar.go.html#5175911">err</a></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176138">//&nbsp;MaxAge&nbsp;takes&nbsp;precedence&nbsp;over&nbsp;Expires.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176180">if</span>&nbsp;<span class="ident" id="5176183"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176184">.</span><span class="ident" id="5176185">MaxAge</span>&nbsp;<span class="op" id="5176192">&lt;</span>&nbsp;<span class="num" id="5176194">0</span>&nbsp;<span class="op" id="5176196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176200">return</span>&nbsp;<span class="ident" id="5176207"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176208">,</span>&nbsp;<span class="ident" id="5176210">true</span><span class="op" id="5176214">,</span>&nbsp;<span class="ident" id="5176216">nil</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176221">}</span>&nbsp;<span class="keyword" id="5176223">else</span>&nbsp;<span class="keyword" id="5176228">if</span>&nbsp;<span class="ident" id="5176231"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176232">.</span><span class="ident" id="5176233">MaxAge</span>&nbsp;<span class="op" id="5176240">&gt;</span>&nbsp;<span class="num" id="5176242">0</span>&nbsp;<span class="op" id="5176244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176248"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176249">.</span><span class="ident" id="5176250">Expires</span>&nbsp;<span class="op" id="5176258">=</span>&nbsp;<span class="ident" id="5176260"><a href="/net/http/cookiejar/jar.go.html#5175851">now</a></span><span class="op" id="5176263">.</span><span class="ident" id="5176264">Add</span><span class="op" id="5176267">(</span><span class="ident" id="5176268"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5176272">.</span><span class="ident" id="5176273">Duration</span><span class="op" id="5176281">(</span><span class="ident" id="5176282"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176283">.</span><span class="ident" id="5176284">MaxAge</span><span class="op" id="5176290">)</span>&nbsp;<span class="op" id="5176292">*</span>&nbsp;<span class="ident" id="5176294"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5176298">.</span><span class="ident" id="5176299">Second</span><span class="op" id="5176305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176309"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176310">.</span><span class="ident" id="5176311">Persistent</span>&nbsp;<span class="op" id="5176322">=</span>&nbsp;<span class="ident" id="5176324">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176330">}</span>&nbsp;<span class="keyword" id="5176332">else</span>&nbsp;<span class="op" id="5176337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176341">if</span>&nbsp;<span class="ident" id="5176344"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176345">.</span><span class="ident" id="5176346">Expires</span><span class="op" id="5176353">.</span><span class="ident" id="5176354">IsZero</span><span class="op" id="5176360">(</span><span class="op" id="5176361">)</span>&nbsp;<span class="op" id="5176363">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176368"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176369">.</span><span class="ident" id="5176370">Expires</span>&nbsp;<span class="op" id="5176378">=</span>&nbsp;<span class="ident" id="5176380"><a href="/net/http/cookiejar/jar.go.html#5177083">endOfTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176393"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176394">.</span><span class="ident" id="5176395">Persistent</span>&nbsp;<span class="op" id="5176406">=</span>&nbsp;<span class="ident" id="5176408">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176416">}</span>&nbsp;<span class="keyword" id="5176418">else</span>&nbsp;<span class="op" id="5176423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176428">if</span>&nbsp;<span class="op" id="5176431">!</span><span class="ident" id="5176432"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176433">.</span><span class="ident" id="5176434">Expires</span><span class="op" id="5176441">.</span><span class="ident" id="5176442">After</span><span class="op" id="5176447">(</span><span class="ident" id="5176448"><a href="/net/http/cookiejar/jar.go.html#5175851">now</a></span><span class="op" id="5176451">)</span>&nbsp;<span class="op" id="5176453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176459">return</span>&nbsp;<span class="ident" id="5176466"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176467">,</span>&nbsp;<span class="ident" id="5176469">true</span><span class="op" id="5176473">,</span>&nbsp;<span class="ident" id="5176475">nil</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176487"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176488">.</span><span class="ident" id="5176489">Expires</span>&nbsp;<span class="op" id="5176497">=</span>&nbsp;<span class="ident" id="5176499"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176500">.</span><span class="ident" id="5176501">Expires</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176512"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176513">.</span><span class="ident" id="5176514">Persistent</span>&nbsp;<span class="op" id="5176525">=</span>&nbsp;<span class="ident" id="5176527">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176537">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176541"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176542">.</span><span class="ident" id="5176543">Value</span>&nbsp;<span class="op" id="5176549">=</span>&nbsp;<span class="ident" id="5176551"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176552">.</span><span class="ident" id="5176553">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176560"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176561">.</span><span class="ident" id="5176562">Secure</span>&nbsp;<span class="op" id="5176569">=</span>&nbsp;<span class="ident" id="5176571"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176572">.</span><span class="ident" id="5176573">Secure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176581"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176582">.</span><span class="ident" id="5176583">HttpOnly</span>&nbsp;<span class="op" id="5176592">=</span>&nbsp;<span class="ident" id="5176594"><a href="/net/http/cookiejar/jar.go.html#5175835">c</a></span><span class="op" id="5176595">.</span><span class="ident" id="5176596">HttpOnly</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176607">return</span>&nbsp;<span class="ident" id="5176614"><a href="/net/http/cookiejar/jar.go.html#5175889">e</a></span><span class="op" id="5176615">,</span>&nbsp;<span class="ident" id="5176617">false</span><span class="op" id="5176622">,</span>&nbsp;<span class="ident" id="5176624">nil</span><br>
<span class="lineno"></span><span class="op" id="5176628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5176631">var</span>&nbsp;<span class="op" id="5176635">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176638">errIllegalDomain</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5176657">=</span>&nbsp;<span class="ident" id="5176659"><a href="/net/http/cookiejar/jar.go.html#5165930">errors</a></span><span class="op" id="5176665">.</span><span class="ident" id="5176666">New</span><span class="op" id="5176669">(</span><span class="string" id="5176670">&#34;cookiejar:&nbsp;illegal&nbsp;cookie&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="5176714">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176717">errMalformedDomain</span>&nbsp;<span class="op" id="5176736">=</span>&nbsp;<span class="ident" id="5176738"><a href="/net/http/cookiejar/jar.go.html#5165930">errors</a></span><span class="op" id="5176744">.</span><span class="ident" id="5176745">New</span><span class="op" id="5176748">(</span><span class="string" id="5176749">&#34;cookiejar:&nbsp;malformed&nbsp;cookie&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="5176795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176798">errNoHostname</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5176817">=</span>&nbsp;<span class="ident" id="5176819"><a href="/net/http/cookiejar/jar.go.html#5165930">errors</a></span><span class="op" id="5176825">.</span><span class="ident" id="5176826">New</span><span class="op" id="5176829">(</span><span class="string" id="5176830">&#34;cookiejar:&nbsp;no&nbsp;host&nbsp;name&nbsp;available&nbsp;(IP&nbsp;only)&#34;</span><span class="op" id="5176875">)</span><br>
<span class="lineno"></span><span class="op" id="5176877">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5176880">//&nbsp;endOfTime&nbsp;is&nbsp;the&nbsp;time&nbsp;when&nbsp;session&nbsp;(non-persistent)&nbsp;cookies&nbsp;expire.</span><br>
<span class="lineno">435</span><span class="comment" id="5176951">//&nbsp;This&nbsp;instant&nbsp;is&nbsp;representable&nbsp;in&nbsp;most&nbsp;date/time&nbsp;formats&nbsp;(not&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="5177020">//&nbsp;Go&#39;s&nbsp;time.Time)&nbsp;and&nbsp;should&nbsp;be&nbsp;far&nbsp;enough&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="keyword" id="5177079">var</span>&nbsp;<span class="ident" id="5177083">endOfTime</span>&nbsp;<span class="op" id="5177093">=</span>&nbsp;<span class="ident" id="5177095"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5177099">.</span><span class="ident" id="5177100">Date</span><span class="op" id="5177104">(</span><span class="num" id="5177105">9999</span><span class="op" id="5177109">,</span>&nbsp;<span class="num" id="5177111">12</span><span class="op" id="5177113">,</span>&nbsp;<span class="num" id="5177115">31</span><span class="op" id="5177117">,</span>&nbsp;<span class="num" id="5177119">23</span><span class="op" id="5177121">,</span>&nbsp;<span class="num" id="5177123">59</span><span class="op" id="5177125">,</span>&nbsp;<span class="num" id="5177127">59</span><span class="op" id="5177129">,</span>&nbsp;<span class="num" id="5177131">0</span><span class="op" id="5177132">,</span>&nbsp;<span class="ident" id="5177134"><a href="/net/http/cookiejar/jar.go.html#5166004">time</a></span><span class="op" id="5177138">.</span><span class="ident" id="5177139">UTC</span><span class="op" id="5177142">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5177145">//&nbsp;domainAndType&nbsp;determines&nbsp;the&nbsp;cookie&#39;s&nbsp;domain&nbsp;and&nbsp;hostOnly&nbsp;attribute.</span><br>
<span class="lineno">440</span><span class="keyword" id="5177217">func</span>&nbsp;<span class="op" id="5177222">(</span><span class="ident" id="5177223">j</span>&nbsp;<span class="op" id="5177225">*</span><span class="ident" id="5177226"><a href="/net/http/cookiejar/jar.go.html#5167623">Jar</a></span><span class="op" id="5177229">)</span>&nbsp;<span class="ident" id="5177231">domainAndType</span><span class="op" id="5177244">(</span><span class="ident" id="5177245">host</span><span class="op" id="5177249">,</span>&nbsp;<span class="ident" id="5177251">domain</span>&nbsp;<span class="builtintype" id="5177258">string</span><span class="op" id="5177264">)</span>&nbsp;<span class="op" id="5177266">(</span><span class="builtintype" id="5177267">string</span><span class="op" id="5177273">,</span>&nbsp;<span class="builtintype" id="5177275">bool</span><span class="op" id="5177279">,</span>&nbsp;<span class="builtintype" id="5177281">error</span><span class="op" id="5177286">)</span>&nbsp;<span class="op" id="5177288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177291">if</span>&nbsp;<span class="ident" id="5177294"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span>&nbsp;<span class="op" id="5177301">==</span>&nbsp;<span class="string" id="5177304">&#34;&#34;</span>&nbsp;<span class="op" id="5177307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177311">//&nbsp;No&nbsp;domain&nbsp;attribute&nbsp;in&nbsp;the&nbsp;SetCookie&nbsp;header&nbsp;indicates&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177372">//&nbsp;host&nbsp;cookie.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177390">return</span>&nbsp;<span class="ident" id="5177397"><a href="/net/http/cookiejar/jar.go.html#5177245">host</a></span><span class="op" id="5177401">,</span>&nbsp;<span class="ident" id="5177403">true</span><span class="op" id="5177407">,</span>&nbsp;<span class="ident" id="5177409">nil</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177418">if</span>&nbsp;<span class="ident" id="5177421"><a href="/net/http/cookiejar/jar.go.html#5174803">isIP</a></span><span class="op" id="5177425">(</span><span class="ident" id="5177426"><a href="/net/http/cookiejar/jar.go.html#5177245">host</a></span><span class="op" id="5177430">)</span>&nbsp;<span class="op" id="5177432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177436">//&nbsp;According&nbsp;to&nbsp;RFC&nbsp;6265&nbsp;domain-matching&nbsp;includes&nbsp;not&nbsp;being</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177498">//&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177518">//&nbsp;TODO:&nbsp;This&nbsp;might&nbsp;be&nbsp;relaxed&nbsp;as&nbsp;in&nbsp;common&nbsp;browsers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177574">return</span>&nbsp;<span class="string" id="5177581">&#34;&#34;</span><span class="op" id="5177583">,</span>&nbsp;<span class="ident" id="5177585">false</span><span class="op" id="5177590">,</span>&nbsp;<span class="ident" id="5177592"><a href="/net/http/cookiejar/jar.go.html#5176798">errNoHostname</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177611">//&nbsp;From&nbsp;here&nbsp;on:&nbsp;If&nbsp;the&nbsp;cookie&nbsp;is&nbsp;valid,&nbsp;it&nbsp;is&nbsp;a&nbsp;domain&nbsp;cookie&nbsp;(with</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177681">//&nbsp;the&nbsp;one&nbsp;exception&nbsp;of&nbsp;a&nbsp;public&nbsp;suffix&nbsp;below).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177730">//&nbsp;See&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.2.3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177762">if</span>&nbsp;<span class="ident" id="5177765"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5177771">[</span><span class="num" id="5177772">0</span><span class="op" id="5177773">]</span>&nbsp;<span class="op" id="5177775">==</span>&nbsp;<span class="string" id="5177778">&#39;.&#39;</span>&nbsp;<span class="op" id="5177782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177786"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span>&nbsp;<span class="op" id="5177793">=</span>&nbsp;<span class="ident" id="5177795"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5177801">[</span><span class="num" id="5177802">1</span><span class="op" id="5177803">:</span><span class="op" id="5177804">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177807">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177811">if</span>&nbsp;<span class="builtinfunc" id="5177814">len</span><span class="op" id="5177817">(</span><span class="ident" id="5177818"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5177824">)</span>&nbsp;<span class="op" id="5177826">==</span>&nbsp;<span class="num" id="5177829">0</span>&nbsp;<span class="op" id="5177831">||</span>&nbsp;<span class="ident" id="5177834"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5177840">[</span><span class="num" id="5177841">0</span><span class="op" id="5177842">]</span>&nbsp;<span class="op" id="5177844">==</span>&nbsp;<span class="string" id="5177847">&#39;.&#39;</span>&nbsp;<span class="op" id="5177851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177855">//&nbsp;Received&nbsp;either&nbsp;&#34;Domain=.&#34;&nbsp;or&nbsp;&#34;Domain=..some.thing&#34;,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177913">//&nbsp;both&nbsp;are&nbsp;illegal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177936">return</span>&nbsp;<span class="string" id="5177943">&#34;&#34;</span><span class="op" id="5177945">,</span>&nbsp;<span class="ident" id="5177947">false</span><span class="op" id="5177952">,</span>&nbsp;<span class="ident" id="5177954"><a href="/net/http/cookiejar/jar.go.html#5176717">errMalformedDomain</a></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177977"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span>&nbsp;<span class="op" id="5177984">=</span>&nbsp;<span class="ident" id="5177986"><a href="/net/http/cookiejar/jar.go.html#5165985">strings</a></span><span class="op" id="5177993">.</span><span class="ident" id="5177994">ToLower</span><span class="op" id="5178001">(</span><span class="ident" id="5178002"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178008">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178012">if</span>&nbsp;<span class="ident" id="5178015"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178021">[</span><span class="builtinfunc" id="5178022">len</span><span class="op" id="5178025">(</span><span class="ident" id="5178026"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178032">)</span><span class="op" id="5178033">-</span><span class="num" id="5178034">1</span><span class="op" id="5178035">]</span>&nbsp;<span class="op" id="5178037">==</span>&nbsp;<span class="string" id="5178040">&#39;.&#39;</span>&nbsp;<span class="op" id="5178044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178048">//&nbsp;We&nbsp;received&nbsp;stuff&nbsp;like&nbsp;&#34;Domain=www.example.com.&#34;.</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178103">//&nbsp;Browsers&nbsp;do&nbsp;handle&nbsp;such&nbsp;stuff&nbsp;(actually&nbsp;differently)&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178165">//&nbsp;RFC&nbsp;6265&nbsp;seems&nbsp;to&nbsp;be&nbsp;clear&nbsp;here&nbsp;(e.g.&nbsp;section&nbsp;4.1.2.3)&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178228">//&nbsp;requiring&nbsp;a&nbsp;reject.&nbsp;&nbsp;4.1.2.3&nbsp;is&nbsp;not&nbsp;normative,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178284">//&nbsp;&#34;Domain&nbsp;Matching&#34;&nbsp;(5.1.3)&nbsp;and&nbsp;&#34;Canonicalized&nbsp;Host&nbsp;Names&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178346">//&nbsp;(5.1.2)&nbsp;are.</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178364">return</span>&nbsp;<span class="string" id="5178371">&#34;&#34;</span><span class="op" id="5178373">,</span>&nbsp;<span class="ident" id="5178375">false</span><span class="op" id="5178380">,</span>&nbsp;<span class="ident" id="5178382"><a href="/net/http/cookiejar/jar.go.html#5176717">errMalformedDomain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178406">//&nbsp;See&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.3&nbsp;#5.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178439">if</span>&nbsp;<span class="ident" id="5178442"><a href="/net/http/cookiejar/jar.go.html#5177223">j</a></span><span class="op" id="5178443">.</span><span class="ident" id="5178444">psList</span>&nbsp;<span class="op" id="5178451">!=</span>&nbsp;<span class="ident" id="5178454">nil</span>&nbsp;<span class="op" id="5178458">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178462">if</span>&nbsp;<span class="ident" id="5178465">ps</span>&nbsp;<span class="op" id="5178468">:=</span>&nbsp;<span class="ident" id="5178471"><a href="/net/http/cookiejar/jar.go.html#5177223">j</a></span><span class="op" id="5178472">.</span><span class="ident" id="5178473">psList</span><span class="op" id="5178479">.</span><span class="ident" id="5178480">PublicSuffix</span><span class="op" id="5178492">(</span><span class="ident" id="5178493"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178499">)</span><span class="op" id="5178500">;</span>&nbsp;<span class="ident" id="5178502"><a href="/net/http/cookiejar/jar.go.html#5178465">ps</a></span>&nbsp;<span class="op" id="5178505">!=</span>&nbsp;<span class="string" id="5178508">&#34;&#34;</span>&nbsp;<span class="op" id="5178511">&amp;&amp;</span>&nbsp;<span class="op" id="5178514">!</span><span class="ident" id="5178515"><a href="/net/http/cookiejar/jar.go.html#5169996">hasDotSuffix</a></span><span class="op" id="5178527">(</span><span class="ident" id="5178528"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178534">,</span>&nbsp;<span class="ident" id="5178536"><a href="/net/http/cookiejar/jar.go.html#5178465">ps</a></span><span class="op" id="5178538">)</span>&nbsp;<span class="op" id="5178540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178545">if</span>&nbsp;<span class="ident" id="5178548"><a href="/net/http/cookiejar/jar.go.html#5177245">host</a></span>&nbsp;<span class="op" id="5178553">==</span>&nbsp;<span class="ident" id="5178556"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span>&nbsp;<span class="op" id="5178563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178569">//&nbsp;This&nbsp;is&nbsp;the&nbsp;one&nbsp;exception&nbsp;in&nbsp;which&nbsp;a&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178620">//&nbsp;with&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;is&nbsp;a&nbsp;host&nbsp;cookie.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178669">return</span>&nbsp;<span class="ident" id="5178676"><a href="/net/http/cookiejar/jar.go.html#5177245">host</a></span><span class="op" id="5178680">,</span>&nbsp;<span class="ident" id="5178682">true</span><span class="op" id="5178686">,</span>&nbsp;<span class="ident" id="5178688">nil</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178700">return</span>&nbsp;<span class="string" id="5178707">&#34;&#34;</span><span class="op" id="5178709">,</span>&nbsp;<span class="ident" id="5178711">false</span><span class="op" id="5178716">,</span>&nbsp;<span class="ident" id="5178718"><a href="/net/http/cookiejar/jar.go.html#5176638">errIllegalDomain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178744">//&nbsp;The&nbsp;domain&nbsp;must&nbsp;domain-match&nbsp;host:&nbsp;www.mycompany.com&nbsp;cannot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178808">//&nbsp;set&nbsp;cookies&nbsp;for&nbsp;.ourcompetitors.com.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178849">if</span>&nbsp;<span class="ident" id="5178852"><a href="/net/http/cookiejar/jar.go.html#5177245">host</a></span>&nbsp;<span class="op" id="5178857">!=</span>&nbsp;<span class="ident" id="5178860"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span>&nbsp;<span class="op" id="5178867">&amp;&amp;</span>&nbsp;<span class="op" id="5178870">!</span><span class="ident" id="5178871"><a href="/net/http/cookiejar/jar.go.html#5169996">hasDotSuffix</a></span><span class="op" id="5178883">(</span><span class="ident" id="5178884"><a href="/net/http/cookiejar/jar.go.html#5177245">host</a></span><span class="op" id="5178888">,</span>&nbsp;<span class="ident" id="5178890"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178896">)</span>&nbsp;<span class="op" id="5178898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178902">return</span>&nbsp;<span class="string" id="5178909">&#34;&#34;</span><span class="op" id="5178911">,</span>&nbsp;<span class="ident" id="5178913">false</span><span class="op" id="5178918">,</span>&nbsp;<span class="ident" id="5178920"><a href="/net/http/cookiejar/jar.go.html#5176638">errIllegalDomain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178938">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178942">return</span>&nbsp;<span class="ident" id="5178949"><a href="/net/http/cookiejar/jar.go.html#5177251">domain</a></span><span class="op" id="5178955">,</span>&nbsp;<span class="ident" id="5178957">false</span><span class="op" id="5178962">,</span>&nbsp;<span class="ident" id="5178964">nil</span><br>
<span class="lineno"></span><span class="op" id="5178968">}</span>
</div>
</body>
</html>
