<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7001957">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7002012">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7002066">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7002117">package</span>&nbsp;<span class="ident" id="7002125">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7002131">import</span>&nbsp;<span class="op" id="7002138">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002141">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002150">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002157">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002163">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002176">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002182">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7002192">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7002195">var</span>&nbsp;<span class="ident" id="7002199">filenames</span>&nbsp;<span class="op" id="7002209">=</span>&nbsp;<span class="op" id="7002211">[</span><span class="op" id="7002212">]</span><span class="builtintype" id="7002213">string</span><span class="op" id="7002219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002222">&#34;../testdata/e.txt&#34;</span><span class="op" id="7002241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002244">&#34;../testdata/pi.txt&#34;</span><span class="op" id="7002264">,</span><br>
<span class="lineno"></span><span class="op" id="7002266">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7002269">var</span>&nbsp;<span class="ident" id="7002273">data</span>&nbsp;<span class="op" id="7002278">=</span>&nbsp;<span class="op" id="7002280">[</span><span class="op" id="7002281">]</span><span class="builtintype" id="7002282">string</span><span class="op" id="7002288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7002291">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="7002346">,</span><br>
<span class="lineno"></span><span class="op" id="7002348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="7002351">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="7002461">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="7002510">func</span>&nbsp;<span class="ident" id="7002515">testFileLevelDict</span><span class="op" id="7002532">(</span><span class="ident" id="7002533">t</span>&nbsp;<span class="op" id="7002535">*</span><span class="ident" id="7002536">testing</span><span class="op" id="7002543">.</span><span class="ident" id="7002544">T</span><span class="op" id="7002545">,</span>&nbsp;<span class="ident" id="7002547">fn</span>&nbsp;<span class="builtintype" id="7002550">string</span><span class="op" id="7002556">,</span>&nbsp;<span class="ident" id="7002558">level</span>&nbsp;<span class="builtintype" id="7002564">int</span><span class="op" id="7002567">,</span>&nbsp;<span class="ident" id="7002569">d</span>&nbsp;<span class="builtintype" id="7002571">string</span><span class="op" id="7002577">)</span>&nbsp;<span class="op" id="7002579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7002582">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7002619">golden</span><span class="op" id="7002625">,</span>&nbsp;<span class="ident" id="7002627">err</span>&nbsp;<span class="op" id="7002631">:=</span>&nbsp;<span class="ident" id="7002634">os</span><span class="op" id="7002636">.</span><span class="ident" id="7002637">Open</span><span class="op" id="7002641">(</span><span class="ident" id="7002642">fn</span><span class="op" id="7002644">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7002647">if</span>&nbsp;<span class="ident" id="7002650">err</span>&nbsp;<span class="op" id="7002654">!=</span>&nbsp;<span class="ident" id="7002657">nil</span>&nbsp;<span class="op" id="7002661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7002665">t</span><span class="op" id="7002666">.</span><span class="ident" id="7002667">Errorf</span><span class="op" id="7002673">(</span><span class="string" id="7002674">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7002702">,</span>&nbsp;<span class="ident" id="7002704">fn</span><span class="op" id="7002706">,</span>&nbsp;<span class="ident" id="7002708">level</span><span class="op" id="7002713">,</span>&nbsp;<span class="ident" id="7002715">d</span><span class="op" id="7002716">,</span>&nbsp;<span class="ident" id="7002718">err</span><span class="op" id="7002721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7002725">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7002733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7002736">defer</span>&nbsp;<span class="ident" id="7002742">golden</span><span class="op" id="7002748">.</span><span class="ident" id="7002749">Close</span><span class="op" id="7002754">(</span><span class="op" id="7002755">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7002758">b0</span><span class="op" id="7002760">,</span>&nbsp;<span class="ident" id="7002762">err0</span>&nbsp;<span class="op" id="7002767">:=</span>&nbsp;<span class="ident" id="7002770">ioutil</span><span class="op" id="7002776">.</span><span class="ident" id="7002777">ReadAll</span><span class="op" id="7002784">(</span><span class="ident" id="7002785">golden</span><span class="op" id="7002791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7002794">if</span>&nbsp;<span class="ident" id="7002797">err0</span>&nbsp;<span class="op" id="7002802">!=</span>&nbsp;<span class="ident" id="7002805">nil</span>&nbsp;<span class="op" id="7002809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7002813">t</span><span class="op" id="7002814">.</span><span class="ident" id="7002815">Errorf</span><span class="op" id="7002821">(</span><span class="string" id="7002822">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7002850">,</span>&nbsp;<span class="ident" id="7002852">fn</span><span class="op" id="7002854">,</span>&nbsp;<span class="ident" id="7002856">level</span><span class="op" id="7002861">,</span>&nbsp;<span class="ident" id="7002863">d</span><span class="op" id="7002864">,</span>&nbsp;<span class="ident" id="7002866">err0</span><span class="op" id="7002870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7002874">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7002882">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7002885">testLevelDict</span><span class="op" id="7002898">(</span><span class="ident" id="7002899">t</span><span class="op" id="7002900">,</span>&nbsp;<span class="ident" id="7002902">fn</span><span class="op" id="7002904">,</span>&nbsp;<span class="ident" id="7002906">b0</span><span class="op" id="7002908">,</span>&nbsp;<span class="ident" id="7002910">level</span><span class="op" id="7002915">,</span>&nbsp;<span class="ident" id="7002917">d</span><span class="op" id="7002918">)</span><br>
<span class="lineno"></span><span class="op" id="7002920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7002923">func</span>&nbsp;<span class="ident" id="7002928">testLevelDict</span><span class="op" id="7002941">(</span><span class="ident" id="7002942">t</span>&nbsp;<span class="op" id="7002944">*</span><span class="ident" id="7002945">testing</span><span class="op" id="7002952">.</span><span class="ident" id="7002953">T</span><span class="op" id="7002954">,</span>&nbsp;<span class="ident" id="7002956">fn</span>&nbsp;<span class="builtintype" id="7002959">string</span><span class="op" id="7002965">,</span>&nbsp;<span class="ident" id="7002967">b0</span>&nbsp;<span class="op" id="7002970">[</span><span class="op" id="7002971">]</span><span class="builtintype" id="7002972">byte</span><span class="op" id="7002976">,</span>&nbsp;<span class="ident" id="7002978">level</span>&nbsp;<span class="builtintype" id="7002984">int</span><span class="op" id="7002987">,</span>&nbsp;<span class="ident" id="7002989">d</span>&nbsp;<span class="builtintype" id="7002991">string</span><span class="op" id="7002997">)</span>&nbsp;<span class="op" id="7002999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7003002">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003033">var</span>&nbsp;<span class="ident" id="7003037">dict</span>&nbsp;<span class="op" id="7003042">[</span><span class="op" id="7003043">]</span><span class="builtintype" id="7003044">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003050">if</span>&nbsp;<span class="ident" id="7003053">d</span>&nbsp;<span class="op" id="7003055">!=</span>&nbsp;<span class="string" id="7003058">&#34;&#34;</span>&nbsp;<span class="op" id="7003061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003065">dict</span>&nbsp;<span class="op" id="7003070">=</span>&nbsp;<span class="op" id="7003072">[</span><span class="op" id="7003073">]</span><span class="builtintype" id="7003074">byte</span><span class="op" id="7003078">(</span><span class="ident" id="7003079">d</span><span class="op" id="7003080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7003087">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003184">piper</span><span class="op" id="7003189">,</span>&nbsp;<span class="ident" id="7003191">pipew</span>&nbsp;<span class="op" id="7003197">:=</span>&nbsp;<span class="ident" id="7003200">io</span><span class="op" id="7003202">.</span><span class="ident" id="7003203">Pipe</span><span class="op" id="7003207">(</span><span class="op" id="7003208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003211">defer</span>&nbsp;<span class="ident" id="7003217">piper</span><span class="op" id="7003222">.</span><span class="ident" id="7003223">Close</span><span class="op" id="7003228">(</span><span class="op" id="7003229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003232">go</span>&nbsp;<span class="keyword" id="7003235">func</span><span class="op" id="7003239">(</span><span class="op" id="7003240">)</span>&nbsp;<span class="op" id="7003242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003246">defer</span>&nbsp;<span class="ident" id="7003252">pipew</span><span class="op" id="7003257">.</span><span class="ident" id="7003258">Close</span><span class="op" id="7003263">(</span><span class="op" id="7003264">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003268">zlibw</span><span class="op" id="7003273">,</span>&nbsp;<span class="ident" id="7003275">err</span>&nbsp;<span class="op" id="7003279">:=</span>&nbsp;<span class="ident" id="7003282">NewWriterLevelDict</span><span class="op" id="7003300">(</span><span class="ident" id="7003301">pipew</span><span class="op" id="7003306">,</span>&nbsp;<span class="ident" id="7003308">level</span><span class="op" id="7003313">,</span>&nbsp;<span class="ident" id="7003315">dict</span><span class="op" id="7003319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003323">if</span>&nbsp;<span class="ident" id="7003326">err</span>&nbsp;<span class="op" id="7003330">!=</span>&nbsp;<span class="ident" id="7003333">nil</span>&nbsp;<span class="op" id="7003337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003342">t</span><span class="op" id="7003343">.</span><span class="ident" id="7003344">Errorf</span><span class="op" id="7003350">(</span><span class="string" id="7003351">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7003379">,</span>&nbsp;<span class="ident" id="7003381">fn</span><span class="op" id="7003383">,</span>&nbsp;<span class="ident" id="7003385">level</span><span class="op" id="7003390">,</span>&nbsp;<span class="ident" id="7003392">d</span><span class="op" id="7003393">,</span>&nbsp;<span class="ident" id="7003395">err</span><span class="op" id="7003398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003403">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003412">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003416">defer</span>&nbsp;<span class="ident" id="7003422">zlibw</span><span class="op" id="7003427">.</span><span class="ident" id="7003428">Close</span><span class="op" id="7003433">(</span><span class="op" id="7003434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003438">_</span><span class="op" id="7003439">,</span>&nbsp;<span class="ident" id="7003441">err</span>&nbsp;<span class="op" id="7003445">=</span>&nbsp;<span class="ident" id="7003447">zlibw</span><span class="op" id="7003452">.</span><span class="ident" id="7003453">Write</span><span class="op" id="7003458">(</span><span class="ident" id="7003459">b0</span><span class="op" id="7003461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003465">if</span>&nbsp;<span class="ident" id="7003468">err</span>&nbsp;<span class="op" id="7003472">!=</span>&nbsp;<span class="ident" id="7003475">nil</span>&nbsp;<span class="op" id="7003479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003484">t</span><span class="op" id="7003485">.</span><span class="ident" id="7003486">Errorf</span><span class="op" id="7003492">(</span><span class="string" id="7003493">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7003521">,</span>&nbsp;<span class="ident" id="7003523">fn</span><span class="op" id="7003525">,</span>&nbsp;<span class="ident" id="7003527">level</span><span class="op" id="7003532">,</span>&nbsp;<span class="ident" id="7003534">d</span><span class="op" id="7003535">,</span>&nbsp;<span class="ident" id="7003537">err</span><span class="op" id="7003540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003545">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003557">}</span><span class="op" id="7003558">(</span><span class="op" id="7003559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003562">zlibr</span><span class="op" id="7003567">,</span>&nbsp;<span class="ident" id="7003569">err</span>&nbsp;<span class="op" id="7003573">:=</span>&nbsp;<span class="ident" id="7003576">NewReaderDict</span><span class="op" id="7003589">(</span><span class="ident" id="7003590">piper</span><span class="op" id="7003595">,</span>&nbsp;<span class="ident" id="7003597">dict</span><span class="op" id="7003601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003604">if</span>&nbsp;<span class="ident" id="7003607">err</span>&nbsp;<span class="op" id="7003611">!=</span>&nbsp;<span class="ident" id="7003614">nil</span>&nbsp;<span class="op" id="7003618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003622">t</span><span class="op" id="7003623">.</span><span class="ident" id="7003624">Errorf</span><span class="op" id="7003630">(</span><span class="string" id="7003631">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7003659">,</span>&nbsp;<span class="ident" id="7003661">fn</span><span class="op" id="7003663">,</span>&nbsp;<span class="ident" id="7003665">level</span><span class="op" id="7003670">,</span>&nbsp;<span class="ident" id="7003672">d</span><span class="op" id="7003673">,</span>&nbsp;<span class="ident" id="7003675">err</span><span class="op" id="7003678">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003682">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003693">defer</span>&nbsp;<span class="ident" id="7003699">zlibr</span><span class="op" id="7003704">.</span><span class="ident" id="7003705">Close</span><span class="op" id="7003710">(</span><span class="op" id="7003711">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7003715">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003750">b1</span><span class="op" id="7003752">,</span>&nbsp;<span class="ident" id="7003754">err1</span>&nbsp;<span class="op" id="7003759">:=</span>&nbsp;<span class="ident" id="7003762">ioutil</span><span class="op" id="7003768">.</span><span class="ident" id="7003769">ReadAll</span><span class="op" id="7003776">(</span><span class="ident" id="7003777">zlibr</span><span class="op" id="7003782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003785">if</span>&nbsp;<span class="ident" id="7003788">err1</span>&nbsp;<span class="op" id="7003793">!=</span>&nbsp;<span class="ident" id="7003796">nil</span>&nbsp;<span class="op" id="7003800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003804">t</span><span class="op" id="7003805">.</span><span class="ident" id="7003806">Errorf</span><span class="op" id="7003812">(</span><span class="string" id="7003813">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7003841">,</span>&nbsp;<span class="ident" id="7003843">fn</span><span class="op" id="7003845">,</span>&nbsp;<span class="ident" id="7003847">level</span><span class="op" id="7003852">,</span>&nbsp;<span class="ident" id="7003854">d</span><span class="op" id="7003855">,</span>&nbsp;<span class="ident" id="7003857">err1</span><span class="op" id="7003861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003865">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003873">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7003876">if</span>&nbsp;<span class="builtinfunc" id="7003879">len</span><span class="op" id="7003882">(</span><span class="ident" id="7003883">b0</span><span class="op" id="7003885">)</span>&nbsp;<span class="op" id="7003887">!=</span>&nbsp;<span class="builtinfunc" id="7003890">len</span><span class="op" id="7003893">(</span><span class="ident" id="7003894">b1</span><span class="op" id="7003896">)</span>&nbsp;<span class="op" id="7003898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003902">t</span><span class="op" id="7003903">.</span><span class="ident" id="7003904">Errorf</span><span class="op" id="7003910">(</span><span class="string" id="7003911">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="7003965">,</span>&nbsp;<span class="ident" id="7003967">fn</span><span class="op" id="7003969">,</span>&nbsp;<span class="ident" id="7003971">level</span><span class="op" id="7003976">,</span>&nbsp;<span class="ident" id="7003978">d</span><span class="op" id="7003979">,</span>&nbsp;<span class="builtinfunc" id="7003981">len</span><span class="op" id="7003984">(</span><span class="ident" id="7003985">b0</span><span class="op" id="7003987">)</span><span class="op" id="7003988">,</span>&nbsp;<span class="builtinfunc" id="7003990">len</span><span class="op" id="7003993">(</span><span class="ident" id="7003994">b1</span><span class="op" id="7003996">)</span><span class="op" id="7003997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004012">for</span>&nbsp;<span class="ident" id="7004016">i</span>&nbsp;<span class="op" id="7004018">:=</span>&nbsp;<span class="num" id="7004021">0</span><span class="op" id="7004022">;</span>&nbsp;<span class="ident" id="7004024">i</span>&nbsp;<span class="op" id="7004026">&lt;</span>&nbsp;<span class="builtinfunc" id="7004028">len</span><span class="op" id="7004031">(</span><span class="ident" id="7004032">b0</span><span class="op" id="7004034">)</span><span class="op" id="7004035">;</span>&nbsp;<span class="ident" id="7004037">i</span><span class="op" id="7004038">++</span>&nbsp;<span class="op" id="7004041">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004045">if</span>&nbsp;<span class="ident" id="7004048">b0</span><span class="op" id="7004050">[</span><span class="ident" id="7004051">i</span><span class="op" id="7004052">]</span>&nbsp;<span class="op" id="7004054">!=</span>&nbsp;<span class="ident" id="7004057">b1</span><span class="op" id="7004059">[</span><span class="ident" id="7004060">i</span><span class="op" id="7004061">]</span>&nbsp;<span class="op" id="7004063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004068">t</span><span class="op" id="7004069">.</span><span class="ident" id="7004070">Errorf</span><span class="op" id="7004076">(</span><span class="string" id="7004077">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="7004141">,</span>&nbsp;<span class="ident" id="7004143">fn</span><span class="op" id="7004145">,</span>&nbsp;<span class="ident" id="7004147">level</span><span class="op" id="7004152">,</span>&nbsp;<span class="ident" id="7004154">d</span><span class="op" id="7004155">,</span>&nbsp;<span class="ident" id="7004157">i</span><span class="op" id="7004158">,</span>&nbsp;<span class="ident" id="7004160">b0</span><span class="op" id="7004162">[</span><span class="ident" id="7004163">i</span><span class="op" id="7004164">]</span><span class="op" id="7004165">,</span>&nbsp;<span class="ident" id="7004167">b1</span><span class="op" id="7004169">[</span><span class="ident" id="7004170">i</span><span class="op" id="7004171">]</span><span class="op" id="7004172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004177">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004189">}</span><br>
<span class="lineno">90</span><span class="op" id="7004191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7004194">func</span>&nbsp;<span class="ident" id="7004199">testFileLevelDictReset</span><span class="op" id="7004221">(</span><span class="ident" id="7004222">t</span>&nbsp;<span class="op" id="7004224">*</span><span class="ident" id="7004225">testing</span><span class="op" id="7004232">.</span><span class="ident" id="7004233">T</span><span class="op" id="7004234">,</span>&nbsp;<span class="ident" id="7004236">fn</span>&nbsp;<span class="builtintype" id="7004239">string</span><span class="op" id="7004245">,</span>&nbsp;<span class="ident" id="7004247">level</span>&nbsp;<span class="builtintype" id="7004253">int</span><span class="op" id="7004256">,</span>&nbsp;<span class="ident" id="7004258">dict</span>&nbsp;<span class="op" id="7004263">[</span><span class="op" id="7004264">]</span><span class="builtintype" id="7004265">byte</span><span class="op" id="7004269">)</span>&nbsp;<span class="op" id="7004271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004274">var</span>&nbsp;<span class="ident" id="7004278">b0</span>&nbsp;<span class="op" id="7004281">[</span><span class="op" id="7004282">]</span><span class="builtintype" id="7004283">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004289">var</span>&nbsp;<span class="ident" id="7004293">err</span>&nbsp;<span class="builtintype" id="7004297">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004304">if</span>&nbsp;<span class="ident" id="7004307">fn</span>&nbsp;<span class="op" id="7004310">!=</span>&nbsp;<span class="string" id="7004313">&#34;&#34;</span>&nbsp;<span class="op" id="7004316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004320">b0</span><span class="op" id="7004322">,</span>&nbsp;<span class="ident" id="7004324">err</span>&nbsp;<span class="op" id="7004328">=</span>&nbsp;<span class="ident" id="7004330">ioutil</span><span class="op" id="7004336">.</span><span class="ident" id="7004337">ReadFile</span><span class="op" id="7004345">(</span><span class="ident" id="7004346">fn</span><span class="op" id="7004348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004352">if</span>&nbsp;<span class="ident" id="7004355">err</span>&nbsp;<span class="op" id="7004359">!=</span>&nbsp;<span class="ident" id="7004362">nil</span>&nbsp;<span class="op" id="7004366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004371">t</span><span class="op" id="7004372">.</span><span class="ident" id="7004373">Errorf</span><span class="op" id="7004379">(</span><span class="string" id="7004380">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7004399">,</span>&nbsp;<span class="ident" id="7004401">fn</span><span class="op" id="7004403">,</span>&nbsp;<span class="ident" id="7004405">level</span><span class="op" id="7004410">,</span>&nbsp;<span class="ident" id="7004412">err</span><span class="op" id="7004415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004420">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7004436">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004455">buf</span>&nbsp;<span class="op" id="7004459">:=</span>&nbsp;<span class="builtinfunc" id="7004462">new</span><span class="op" id="7004465">(</span><span class="ident" id="7004466">bytes</span><span class="op" id="7004471">.</span><span class="ident" id="7004472">Buffer</span><span class="op" id="7004478">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004481">var</span>&nbsp;<span class="ident" id="7004485">zlibw</span>&nbsp;<span class="op" id="7004491">*</span><span class="ident" id="7004492">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004500">if</span>&nbsp;<span class="ident" id="7004503">dict</span>&nbsp;<span class="op" id="7004508">==</span>&nbsp;<span class="ident" id="7004511">nil</span>&nbsp;<span class="op" id="7004515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004519">zlibw</span><span class="op" id="7004524">,</span>&nbsp;<span class="ident" id="7004526">err</span>&nbsp;<span class="op" id="7004530">=</span>&nbsp;<span class="ident" id="7004532">NewWriterLevel</span><span class="op" id="7004546">(</span><span class="ident" id="7004547">buf</span><span class="op" id="7004550">,</span>&nbsp;<span class="ident" id="7004552">level</span><span class="op" id="7004557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004560">}</span>&nbsp;<span class="keyword" id="7004562">else</span>&nbsp;<span class="op" id="7004567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004571">zlibw</span><span class="op" id="7004576">,</span>&nbsp;<span class="ident" id="7004578">err</span>&nbsp;<span class="op" id="7004582">=</span>&nbsp;<span class="ident" id="7004584">NewWriterLevelDict</span><span class="op" id="7004602">(</span><span class="ident" id="7004603">buf</span><span class="op" id="7004606">,</span>&nbsp;<span class="ident" id="7004608">level</span><span class="op" id="7004613">,</span>&nbsp;<span class="ident" id="7004615">dict</span><span class="op" id="7004619">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004625">if</span>&nbsp;<span class="ident" id="7004628">err</span>&nbsp;<span class="op" id="7004632">==</span>&nbsp;<span class="ident" id="7004635">nil</span>&nbsp;<span class="op" id="7004639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004643">_</span><span class="op" id="7004644">,</span>&nbsp;<span class="ident" id="7004646">err</span>&nbsp;<span class="op" id="7004650">=</span>&nbsp;<span class="ident" id="7004652">zlibw</span><span class="op" id="7004657">.</span><span class="ident" id="7004658">Write</span><span class="op" id="7004663">(</span><span class="ident" id="7004664">b0</span><span class="op" id="7004666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004672">if</span>&nbsp;<span class="ident" id="7004675">err</span>&nbsp;<span class="op" id="7004679">==</span>&nbsp;<span class="ident" id="7004682">nil</span>&nbsp;<span class="op" id="7004686">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004690">err</span>&nbsp;<span class="op" id="7004694">=</span>&nbsp;<span class="ident" id="7004696">zlibw</span><span class="op" id="7004701">.</span><span class="ident" id="7004702">Close</span><span class="op" id="7004707">(</span><span class="op" id="7004708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004714">if</span>&nbsp;<span class="ident" id="7004717">err</span>&nbsp;<span class="op" id="7004721">!=</span>&nbsp;<span class="ident" id="7004724">nil</span>&nbsp;<span class="op" id="7004728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004732">t</span><span class="op" id="7004733">.</span><span class="ident" id="7004734">Errorf</span><span class="op" id="7004740">(</span><span class="string" id="7004741">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7004760">,</span>&nbsp;<span class="ident" id="7004762">fn</span><span class="op" id="7004764">,</span>&nbsp;<span class="ident" id="7004766">level</span><span class="op" id="7004771">,</span>&nbsp;<span class="ident" id="7004773">err</span><span class="op" id="7004776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004780">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004791">out</span>&nbsp;<span class="op" id="7004795">:=</span>&nbsp;<span class="ident" id="7004798">buf</span><span class="op" id="7004801">.</span><span class="ident" id="7004802">String</span><span class="op" id="7004808">(</span><span class="op" id="7004809">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7004813">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004843">buf2</span>&nbsp;<span class="op" id="7004848">:=</span>&nbsp;<span class="builtinfunc" id="7004851">new</span><span class="op" id="7004854">(</span><span class="ident" id="7004855">bytes</span><span class="op" id="7004860">.</span><span class="ident" id="7004861">Buffer</span><span class="op" id="7004867">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004870">zlibw</span><span class="op" id="7004875">.</span><span class="ident" id="7004876">Reset</span><span class="op" id="7004881">(</span><span class="ident" id="7004882">buf2</span><span class="op" id="7004886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004889">_</span><span class="op" id="7004890">,</span>&nbsp;<span class="ident" id="7004892">err</span>&nbsp;<span class="op" id="7004896">=</span>&nbsp;<span class="ident" id="7004898">zlibw</span><span class="op" id="7004903">.</span><span class="ident" id="7004904">Write</span><span class="op" id="7004909">(</span><span class="ident" id="7004910">b0</span><span class="op" id="7004912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004915">if</span>&nbsp;<span class="ident" id="7004918">err</span>&nbsp;<span class="op" id="7004922">==</span>&nbsp;<span class="ident" id="7004925">nil</span>&nbsp;<span class="op" id="7004929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004933">err</span>&nbsp;<span class="op" id="7004937">=</span>&nbsp;<span class="ident" id="7004939">zlibw</span><span class="op" id="7004944">.</span><span class="ident" id="7004945">Close</span><span class="op" id="7004950">(</span><span class="op" id="7004951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004954">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004957">if</span>&nbsp;<span class="ident" id="7004960">err</span>&nbsp;<span class="op" id="7004964">!=</span>&nbsp;<span class="ident" id="7004967">nil</span>&nbsp;<span class="op" id="7004971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004975">t</span><span class="op" id="7004976">.</span><span class="ident" id="7004977">Errorf</span><span class="op" id="7004983">(</span><span class="string" id="7004984">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7005003">,</span>&nbsp;<span class="ident" id="7005005">fn</span><span class="op" id="7005007">,</span>&nbsp;<span class="ident" id="7005009">level</span><span class="op" id="7005014">,</span>&nbsp;<span class="ident" id="7005016">err</span><span class="op" id="7005019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005023">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005034">out2</span>&nbsp;<span class="op" id="7005039">:=</span>&nbsp;<span class="ident" id="7005042">buf2</span><span class="op" id="7005046">.</span><span class="ident" id="7005047">String</span><span class="op" id="7005053">(</span><span class="op" id="7005054">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005058">if</span>&nbsp;<span class="ident" id="7005061">out2</span>&nbsp;<span class="op" id="7005066">!=</span>&nbsp;<span class="ident" id="7005069">out</span>&nbsp;<span class="op" id="7005073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005077">t</span><span class="op" id="7005078">.</span><span class="ident" id="7005079">Errorf</span><span class="op" id="7005085">(</span><span class="string" id="7005086">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7005158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005163">fn</span><span class="op" id="7005165">,</span>&nbsp;<span class="ident" id="7005167">level</span><span class="op" id="7005172">,</span>&nbsp;<span class="builtinfunc" id="7005174">len</span><span class="op" id="7005177">(</span><span class="ident" id="7005178">out2</span><span class="op" id="7005182">)</span><span class="op" id="7005183">,</span>&nbsp;<span class="builtinfunc" id="7005185">len</span><span class="op" id="7005188">(</span><span class="ident" id="7005189">out</span><span class="op" id="7005192">)</span><span class="op" id="7005193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005196">}</span><br>
<span class="lineno">140</span><span class="op" id="7005198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7005201">func</span>&nbsp;<span class="ident" id="7005206">TestWriter</span><span class="op" id="7005216">(</span><span class="ident" id="7005217">t</span>&nbsp;<span class="op" id="7005219">*</span><span class="ident" id="7005220">testing</span><span class="op" id="7005227">.</span><span class="ident" id="7005228">T</span><span class="op" id="7005229">)</span>&nbsp;<span class="op" id="7005231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005234">for</span>&nbsp;<span class="ident" id="7005238">i</span><span class="op" id="7005239">,</span>&nbsp;<span class="ident" id="7005241">s</span>&nbsp;<span class="op" id="7005243">:=</span>&nbsp;<span class="keyword" id="7005246">range</span>&nbsp;<span class="ident" id="7005252">data</span>&nbsp;<span class="op" id="7005257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005261">b</span>&nbsp;<span class="op" id="7005263">:=</span>&nbsp;<span class="op" id="7005266">[</span><span class="op" id="7005267">]</span><span class="builtintype" id="7005268">byte</span><span class="op" id="7005272">(</span><span class="ident" id="7005273">s</span><span class="op" id="7005274">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005278">tag</span>&nbsp;<span class="op" id="7005282">:=</span>&nbsp;<span class="ident" id="7005285">fmt</span><span class="op" id="7005288">.</span><span class="ident" id="7005289">Sprintf</span><span class="op" id="7005296">(</span><span class="string" id="7005297">&#34;#%d&#34;</span><span class="op" id="7005302">,</span>&nbsp;<span class="ident" id="7005304">i</span><span class="op" id="7005305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005309">testLevelDict</span><span class="op" id="7005322">(</span><span class="ident" id="7005323">t</span><span class="op" id="7005324">,</span>&nbsp;<span class="ident" id="7005326">tag</span><span class="op" id="7005329">,</span>&nbsp;<span class="ident" id="7005331">b</span><span class="op" id="7005332">,</span>&nbsp;<span class="ident" id="7005334">DefaultCompression</span><span class="op" id="7005352">,</span>&nbsp;<span class="string" id="7005354">&#34;&#34;</span><span class="op" id="7005356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005360">testLevelDict</span><span class="op" id="7005373">(</span><span class="ident" id="7005374">t</span><span class="op" id="7005375">,</span>&nbsp;<span class="ident" id="7005377">tag</span><span class="op" id="7005380">,</span>&nbsp;<span class="ident" id="7005382">b</span><span class="op" id="7005383">,</span>&nbsp;<span class="ident" id="7005385">NoCompression</span><span class="op" id="7005398">,</span>&nbsp;<span class="string" id="7005400">&#34;&#34;</span><span class="op" id="7005402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005406">for</span>&nbsp;<span class="ident" id="7005410">level</span>&nbsp;<span class="op" id="7005416">:=</span>&nbsp;<span class="ident" id="7005419">BestSpeed</span><span class="op" id="7005428">;</span>&nbsp;<span class="ident" id="7005430">level</span>&nbsp;<span class="op" id="7005436">&lt;=</span>&nbsp;<span class="ident" id="7005439">BestCompression</span><span class="op" id="7005454">;</span>&nbsp;<span class="ident" id="7005456">level</span><span class="op" id="7005461">++</span>&nbsp;<span class="op" id="7005464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005469">testLevelDict</span><span class="op" id="7005482">(</span><span class="ident" id="7005483">t</span><span class="op" id="7005484">,</span>&nbsp;<span class="ident" id="7005486">tag</span><span class="op" id="7005489">,</span>&nbsp;<span class="ident" id="7005491">b</span><span class="op" id="7005492">,</span>&nbsp;<span class="ident" id="7005494">level</span><span class="op" id="7005499">,</span>&nbsp;<span class="string" id="7005501">&#34;&#34;</span><span class="op" id="7005503">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005510">}</span><br>
<span class="lineno"></span><span class="op" id="7005512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7005515">func</span>&nbsp;<span class="ident" id="7005520">TestWriterBig</span><span class="op" id="7005533">(</span><span class="ident" id="7005534">t</span>&nbsp;<span class="op" id="7005536">*</span><span class="ident" id="7005537">testing</span><span class="op" id="7005544">.</span><span class="ident" id="7005545">T</span><span class="op" id="7005546">)</span>&nbsp;<span class="op" id="7005548">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005551">for</span>&nbsp;<span class="ident" id="7005555">_</span><span class="op" id="7005556">,</span>&nbsp;<span class="ident" id="7005558">fn</span>&nbsp;<span class="op" id="7005561">:=</span>&nbsp;<span class="keyword" id="7005564">range</span>&nbsp;<span class="ident" id="7005570">filenames</span>&nbsp;<span class="op" id="7005580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005584">testFileLevelDict</span><span class="op" id="7005601">(</span><span class="ident" id="7005602">t</span><span class="op" id="7005603">,</span>&nbsp;<span class="ident" id="7005605">fn</span><span class="op" id="7005607">,</span>&nbsp;<span class="ident" id="7005609">DefaultCompression</span><span class="op" id="7005627">,</span>&nbsp;<span class="string" id="7005629">&#34;&#34;</span><span class="op" id="7005631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005635">testFileLevelDict</span><span class="op" id="7005652">(</span><span class="ident" id="7005653">t</span><span class="op" id="7005654">,</span>&nbsp;<span class="ident" id="7005656">fn</span><span class="op" id="7005658">,</span>&nbsp;<span class="ident" id="7005660">NoCompression</span><span class="op" id="7005673">,</span>&nbsp;<span class="string" id="7005675">&#34;&#34;</span><span class="op" id="7005677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005681">for</span>&nbsp;<span class="ident" id="7005685">level</span>&nbsp;<span class="op" id="7005691">:=</span>&nbsp;<span class="ident" id="7005694">BestSpeed</span><span class="op" id="7005703">;</span>&nbsp;<span class="ident" id="7005705">level</span>&nbsp;<span class="op" id="7005711">&lt;=</span>&nbsp;<span class="ident" id="7005714">BestCompression</span><span class="op" id="7005729">;</span>&nbsp;<span class="ident" id="7005731">level</span><span class="op" id="7005736">++</span>&nbsp;<span class="op" id="7005739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005744">testFileLevelDict</span><span class="op" id="7005761">(</span><span class="ident" id="7005762">t</span><span class="op" id="7005763">,</span>&nbsp;<span class="ident" id="7005765">fn</span><span class="op" id="7005767">,</span>&nbsp;<span class="ident" id="7005769">level</span><span class="op" id="7005774">,</span>&nbsp;<span class="string" id="7005776">&#34;&#34;</span><span class="op" id="7005778">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005785">}</span><br>
<span class="lineno"></span><span class="op" id="7005787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7005790">func</span>&nbsp;<span class="ident" id="7005795">TestWriterDict</span><span class="op" id="7005809">(</span><span class="ident" id="7005810">t</span>&nbsp;<span class="op" id="7005812">*</span><span class="ident" id="7005813">testing</span><span class="op" id="7005820">.</span><span class="ident" id="7005821">T</span><span class="op" id="7005822">)</span>&nbsp;<span class="op" id="7005824">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005827">const</span>&nbsp;<span class="ident" id="7005833">dictionary</span>&nbsp;<span class="op" id="7005844">=</span>&nbsp;<span class="string" id="7005846">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005861">for</span>&nbsp;<span class="ident" id="7005865">_</span><span class="op" id="7005866">,</span>&nbsp;<span class="ident" id="7005868">fn</span>&nbsp;<span class="op" id="7005871">:=</span>&nbsp;<span class="keyword" id="7005874">range</span>&nbsp;<span class="ident" id="7005880">filenames</span>&nbsp;<span class="op" id="7005890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005894">testFileLevelDict</span><span class="op" id="7005911">(</span><span class="ident" id="7005912">t</span><span class="op" id="7005913">,</span>&nbsp;<span class="ident" id="7005915">fn</span><span class="op" id="7005917">,</span>&nbsp;<span class="ident" id="7005919">DefaultCompression</span><span class="op" id="7005937">,</span>&nbsp;<span class="ident" id="7005939">dictionary</span><span class="op" id="7005949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005953">testFileLevelDict</span><span class="op" id="7005970">(</span><span class="ident" id="7005971">t</span><span class="op" id="7005972">,</span>&nbsp;<span class="ident" id="7005974">fn</span><span class="op" id="7005976">,</span>&nbsp;<span class="ident" id="7005978">NoCompression</span><span class="op" id="7005991">,</span>&nbsp;<span class="ident" id="7005993">dictionary</span><span class="op" id="7006003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006007">for</span>&nbsp;<span class="ident" id="7006011">level</span>&nbsp;<span class="op" id="7006017">:=</span>&nbsp;<span class="ident" id="7006020">BestSpeed</span><span class="op" id="7006029">;</span>&nbsp;<span class="ident" id="7006031">level</span>&nbsp;<span class="op" id="7006037">&lt;=</span>&nbsp;<span class="ident" id="7006040">BestCompression</span><span class="op" id="7006055">;</span>&nbsp;<span class="ident" id="7006057">level</span><span class="op" id="7006062">++</span>&nbsp;<span class="op" id="7006065">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006070">testFileLevelDict</span><span class="op" id="7006087">(</span><span class="ident" id="7006088">t</span><span class="op" id="7006089">,</span>&nbsp;<span class="ident" id="7006091">fn</span><span class="op" id="7006093">,</span>&nbsp;<span class="ident" id="7006095">level</span><span class="op" id="7006100">,</span>&nbsp;<span class="ident" id="7006102">dictionary</span><span class="op" id="7006112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006119">}</span><br>
<span class="lineno"></span><span class="op" id="7006121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7006124">func</span>&nbsp;<span class="ident" id="7006129">TestWriterReset</span><span class="op" id="7006144">(</span><span class="ident" id="7006145">t</span>&nbsp;<span class="op" id="7006147">*</span><span class="ident" id="7006148">testing</span><span class="op" id="7006155">.</span><span class="ident" id="7006156">T</span><span class="op" id="7006157">)</span>&nbsp;<span class="op" id="7006159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006162">const</span>&nbsp;<span class="ident" id="7006168">dictionary</span>&nbsp;<span class="op" id="7006179">=</span>&nbsp;<span class="string" id="7006181">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006196">for</span>&nbsp;<span class="ident" id="7006200">_</span><span class="op" id="7006201">,</span>&nbsp;<span class="ident" id="7006203">fn</span>&nbsp;<span class="op" id="7006206">:=</span>&nbsp;<span class="keyword" id="7006209">range</span>&nbsp;<span class="ident" id="7006215">filenames</span>&nbsp;<span class="op" id="7006225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006229">testFileLevelDictReset</span><span class="op" id="7006251">(</span><span class="ident" id="7006252">t</span><span class="op" id="7006253">,</span>&nbsp;<span class="ident" id="7006255">fn</span><span class="op" id="7006257">,</span>&nbsp;<span class="ident" id="7006259">NoCompression</span><span class="op" id="7006272">,</span>&nbsp;<span class="ident" id="7006274">nil</span><span class="op" id="7006277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006281">testFileLevelDictReset</span><span class="op" id="7006303">(</span><span class="ident" id="7006304">t</span><span class="op" id="7006305">,</span>&nbsp;<span class="ident" id="7006307">fn</span><span class="op" id="7006309">,</span>&nbsp;<span class="ident" id="7006311">DefaultCompression</span><span class="op" id="7006329">,</span>&nbsp;<span class="ident" id="7006331">nil</span><span class="op" id="7006334">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006338">testFileLevelDictReset</span><span class="op" id="7006360">(</span><span class="ident" id="7006361">t</span><span class="op" id="7006362">,</span>&nbsp;<span class="ident" id="7006364">fn</span><span class="op" id="7006366">,</span>&nbsp;<span class="ident" id="7006368">NoCompression</span><span class="op" id="7006381">,</span>&nbsp;<span class="op" id="7006383">[</span><span class="op" id="7006384">]</span><span class="builtintype" id="7006385">byte</span><span class="op" id="7006389">(</span><span class="ident" id="7006390">dictionary</span><span class="op" id="7006400">)</span><span class="op" id="7006401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006405">testFileLevelDictReset</span><span class="op" id="7006427">(</span><span class="ident" id="7006428">t</span><span class="op" id="7006429">,</span>&nbsp;<span class="ident" id="7006431">fn</span><span class="op" id="7006433">,</span>&nbsp;<span class="ident" id="7006435">DefaultCompression</span><span class="op" id="7006453">,</span>&nbsp;<span class="op" id="7006455">[</span><span class="op" id="7006456">]</span><span class="builtintype" id="7006457">byte</span><span class="op" id="7006461">(</span><span class="ident" id="7006462">dictionary</span><span class="op" id="7006472">)</span><span class="op" id="7006473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006477">if</span>&nbsp;<span class="op" id="7006480">!</span><span class="ident" id="7006481">testing</span><span class="op" id="7006488">.</span><span class="ident" id="7006489">Short</span><span class="op" id="7006494">(</span><span class="op" id="7006495">)</span>&nbsp;<span class="op" id="7006497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006502">for</span>&nbsp;<span class="ident" id="7006506">level</span>&nbsp;<span class="op" id="7006512">:=</span>&nbsp;<span class="ident" id="7006515">BestSpeed</span><span class="op" id="7006524">;</span>&nbsp;<span class="ident" id="7006526">level</span>&nbsp;<span class="op" id="7006532">&lt;=</span>&nbsp;<span class="ident" id="7006535">BestCompression</span><span class="op" id="7006550">;</span>&nbsp;<span class="ident" id="7006552">level</span><span class="op" id="7006557">++</span>&nbsp;<span class="op" id="7006560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006566">testFileLevelDictReset</span><span class="op" id="7006588">(</span><span class="ident" id="7006589">t</span><span class="op" id="7006590">,</span>&nbsp;<span class="ident" id="7006592">fn</span><span class="op" id="7006594">,</span>&nbsp;<span class="ident" id="7006596">level</span><span class="op" id="7006601">,</span>&nbsp;<span class="ident" id="7006603">nil</span><span class="op" id="7006606">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006618">}</span><br>
<span class="lineno"></span><span class="op" id="7006620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7006623">func</span>&nbsp;<span class="ident" id="7006628">TestWriterDictIsUsed</span><span class="op" id="7006648">(</span><span class="ident" id="7006649">t</span>&nbsp;<span class="op" id="7006651">*</span><span class="ident" id="7006652">testing</span><span class="op" id="7006659">.</span><span class="ident" id="7006660">T</span><span class="op" id="7006661">)</span>&nbsp;<span class="op" id="7006663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006666">var</span>&nbsp;<span class="ident" id="7006670">input</span>&nbsp;<span class="op" id="7006676">=</span>&nbsp;<span class="op" id="7006678">[</span><span class="op" id="7006679">]</span><span class="builtintype" id="7006680">byte</span><span class="op" id="7006684">(</span><span class="string" id="7006685">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="7006811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006814">var</span>&nbsp;<span class="ident" id="7006818">buf</span>&nbsp;<span class="ident" id="7006822">bytes</span><span class="op" id="7006827">.</span><span class="ident" id="7006828">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006836">compressor</span><span class="op" id="7006846">,</span>&nbsp;<span class="ident" id="7006848">err</span>&nbsp;<span class="op" id="7006852">:=</span>&nbsp;<span class="ident" id="7006855">NewWriterLevelDict</span><span class="op" id="7006873">(</span><span class="op" id="7006874">&amp;</span><span class="ident" id="7006875">buf</span><span class="op" id="7006878">,</span>&nbsp;<span class="ident" id="7006880">BestCompression</span><span class="op" id="7006895">,</span>&nbsp;<span class="ident" id="7006897">input</span><span class="op" id="7006902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006905">if</span>&nbsp;<span class="ident" id="7006908">err</span>&nbsp;<span class="op" id="7006912">!=</span>&nbsp;<span class="ident" id="7006915">nil</span>&nbsp;<span class="op" id="7006919">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006923">t</span><span class="op" id="7006924">.</span><span class="ident" id="7006925">Errorf</span><span class="op" id="7006931">(</span><span class="string" id="7006932">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="7006965">,</span>&nbsp;<span class="ident" id="7006967">err</span><span class="op" id="7006970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006974">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006985">compressor</span><span class="op" id="7006995">.</span><span class="ident" id="7006996">Write</span><span class="op" id="7007001">(</span><span class="ident" id="7007002">input</span><span class="op" id="7007007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007010">compressor</span><span class="op" id="7007020">.</span><span class="ident" id="7007021">Close</span><span class="op" id="7007026">(</span><span class="op" id="7007027">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007030">const</span>&nbsp;<span class="ident" id="7007036">expectedMaxSize</span>&nbsp;<span class="op" id="7007052">=</span>&nbsp;<span class="num" id="7007054">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007058">output</span>&nbsp;<span class="op" id="7007065">:=</span>&nbsp;<span class="ident" id="7007068">buf</span><span class="op" id="7007071">.</span><span class="ident" id="7007072">Bytes</span><span class="op" id="7007077">(</span><span class="op" id="7007078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007081">if</span>&nbsp;<span class="builtinfunc" id="7007084">len</span><span class="op" id="7007087">(</span><span class="ident" id="7007088">output</span><span class="op" id="7007094">)</span>&nbsp;<span class="op" id="7007096">&gt;</span>&nbsp;<span class="ident" id="7007098">expectedMaxSize</span>&nbsp;<span class="op" id="7007114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007118">t</span><span class="op" id="7007119">.</span><span class="ident" id="7007120">Errorf</span><span class="op" id="7007126">(</span><span class="string" id="7007127">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="7007203">,</span>&nbsp;<span class="builtinfunc" id="7007205">len</span><span class="op" id="7007208">(</span><span class="ident" id="7007209">output</span><span class="op" id="7007215">)</span><span class="op" id="7007216">,</span>&nbsp;<span class="ident" id="7007218">expectedMaxSize</span><span class="op" id="7007233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007236">}</span><br>
<span class="lineno">205</span><span class="op" id="7007238">}</span>
</div>
</body>
</html>
