<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4343042">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4343097">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4343151">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4343202">package</span>&nbsp;<span class="ident" id="4343210">flate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343217">import</span>&nbsp;<span class="op" id="4343224">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4343227">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4343235">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4343242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343245">type</span>&nbsp;<span class="ident" id="4343250">huffmanEncoder</span>&nbsp;<span class="keyword" id="4343265">struct</span>&nbsp;<span class="op" id="4343272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343275">codeBits</span>&nbsp;<span class="op" id="4343284">[</span><span class="op" id="4343285">]</span><span class="builtintype" id="4343286">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343293">code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4343302">[</span><span class="op" id="4343303">]</span><span class="builtintype" id="4343304">uint16</span><br>
<span class="lineno">15</span><span class="op" id="4343311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343314">type</span>&nbsp;<span class="ident" id="4343319">literalNode</span>&nbsp;<span class="keyword" id="4343331">struct</span>&nbsp;<span class="op" id="4343338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343341">literal</span>&nbsp;<span class="builtintype" id="4343349">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343357">freq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4343365">int32</span><br>
<span class="lineno">20</span><span class="op" id="4343371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4343374">//&nbsp;A&nbsp;levelInfo&nbsp;describes&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;constructed&nbsp;tree&nbsp;for&nbsp;a&nbsp;given&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="4343452">type</span>&nbsp;<span class="ident" id="4343457">levelInfo</span>&nbsp;<span class="keyword" id="4343467">struct</span>&nbsp;<span class="op" id="4343474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343477">//&nbsp;Our&nbsp;level.&nbsp;&nbsp;for&nbsp;better&nbsp;printing</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343513">level</span>&nbsp;<span class="builtintype" id="4343519">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343527">//&nbsp;The&nbsp;frequency&nbsp;of&nbsp;the&nbsp;last&nbsp;node&nbsp;at&nbsp;this&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343576">lastFreq</span>&nbsp;<span class="builtintype" id="4343585">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343593">//&nbsp;The&nbsp;frequency&nbsp;of&nbsp;the&nbsp;next&nbsp;character&nbsp;to&nbsp;add&nbsp;to&nbsp;this&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343654">nextCharFreq</span>&nbsp;<span class="builtintype" id="4343667">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343675">//&nbsp;The&nbsp;frequency&nbsp;of&nbsp;the&nbsp;next&nbsp;pair&nbsp;(from&nbsp;level&nbsp;below)&nbsp;to&nbsp;add&nbsp;to&nbsp;this&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343751">//&nbsp;Only&nbsp;valid&nbsp;if&nbsp;the&nbsp;&#34;needed&#34;&nbsp;value&nbsp;of&nbsp;the&nbsp;next&nbsp;lower&nbsp;level&nbsp;is&nbsp;0.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343818">nextPairFreq</span>&nbsp;<span class="builtintype" id="4343831">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343839">//&nbsp;The&nbsp;number&nbsp;of&nbsp;chains&nbsp;remaining&nbsp;to&nbsp;generate&nbsp;for&nbsp;this&nbsp;level&nbsp;before&nbsp;moving</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4343915">//&nbsp;up&nbsp;to&nbsp;the&nbsp;next&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343940">needed</span>&nbsp;<span class="builtintype" id="4343947">int32</span><br>
<span class="lineno">40</span><span class="op" id="4343953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343956">func</span>&nbsp;<span class="ident" id="4343961">maxNode</span><span class="op" id="4343968">(</span><span class="op" id="4343969">)</span>&nbsp;<span class="ident" id="4343971"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span>&nbsp;<span class="op" id="4343983">{</span>&nbsp;<span class="keyword" id="4343985">return</span>&nbsp;<span class="ident" id="4343992"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4344003">{</span><span class="ident" id="4344004"><a href="/compress/flate/huffman_code.go.html#4343227">math</a></span><span class="op" id="4344008">.</span><span class="ident" id="4344009">MaxUint16</span><span class="op" id="4344018">,</span>&nbsp;<span class="ident" id="4344020"><a href="/compress/flate/huffman_code.go.html#4343227">math</a></span><span class="op" id="4344024">.</span><span class="ident" id="4344025">MaxInt32</span><span class="op" id="4344033">}</span>&nbsp;<span class="op" id="4344035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4344038">func</span>&nbsp;<span class="ident" id="4344043">newHuffmanEncoder</span><span class="op" id="4344060">(</span><span class="ident" id="4344061">size</span>&nbsp;<span class="builtintype" id="4344066">int</span><span class="op" id="4344069">)</span>&nbsp;<span class="op" id="4344071">*</span><span class="ident" id="4344072"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span>&nbsp;<span class="op" id="4344087">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344090">return</span>&nbsp;<span class="op" id="4344097">&amp;</span><span class="ident" id="4344098"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span><span class="op" id="4344112">{</span><span class="builtinfunc" id="4344113">make</span><span class="op" id="4344117">(</span><span class="op" id="4344118">[</span><span class="op" id="4344119">]</span><span class="builtintype" id="4344120">uint8</span><span class="op" id="4344125">,</span>&nbsp;<span class="ident" id="4344127"><a href="/compress/flate/huffman_code.go.html#4344061">size</a></span><span class="op" id="4344131">)</span><span class="op" id="4344132">,</span>&nbsp;<span class="builtinfunc" id="4344134">make</span><span class="op" id="4344138">(</span><span class="op" id="4344139">[</span><span class="op" id="4344140">]</span><span class="builtintype" id="4344141">uint16</span><span class="op" id="4344147">,</span>&nbsp;<span class="ident" id="4344149"><a href="/compress/flate/huffman_code.go.html#4344061">size</a></span><span class="op" id="4344153">)</span><span class="op" id="4344154">}</span><br>
<span class="lineno"></span><span class="op" id="4344156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4344159">//&nbsp;Generates&nbsp;a&nbsp;HuffmanCode&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;fixed&nbsp;literal&nbsp;table</span><br>
<span class="lineno"></span><span class="keyword" id="4344227">func</span>&nbsp;<span class="ident" id="4344232">generateFixedLiteralEncoding</span><span class="op" id="4344260">(</span><span class="op" id="4344261">)</span>&nbsp;<span class="op" id="4344263">*</span><span class="ident" id="4344264"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span>&nbsp;<span class="op" id="4344279">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344282">h</span>&nbsp;<span class="op" id="4344284">:=</span>&nbsp;<span class="ident" id="4344287"><a href="/compress/flate/huffman_code.go.html#4344043">newHuffmanEncoder</a></span><span class="op" id="4344304">(</span><span class="ident" id="4344305"><a href="/compress/flate/inflate.go.html#4353010">maxLit</a></span><span class="op" id="4344311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344314">codeBits</span>&nbsp;<span class="op" id="4344323">:=</span>&nbsp;<span class="ident" id="4344326"><a href="/compress/flate/huffman_code.go.html#4344282">h</a></span><span class="op" id="4344327">.</span><span class="ident" id="4344328">codeBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344338">code</span>&nbsp;<span class="op" id="4344343">:=</span>&nbsp;<span class="ident" id="4344346"><a href="/compress/flate/huffman_code.go.html#4344282">h</a></span><span class="op" id="4344347">.</span><span class="ident" id="4344348">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344354">var</span>&nbsp;<span class="ident" id="4344358">ch</span>&nbsp;<span class="builtintype" id="4344361">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344369">for</span>&nbsp;<span class="ident" id="4344373"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344376">=</span>&nbsp;<span class="num" id="4344378">0</span><span class="op" id="4344379">;</span>&nbsp;<span class="ident" id="4344381"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344384">&lt;</span>&nbsp;<span class="ident" id="4344386"><a href="/compress/flate/inflate.go.html#4353010">maxLit</a></span><span class="op" id="4344392">;</span>&nbsp;<span class="ident" id="4344394"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span><span class="op" id="4344396">++</span>&nbsp;<span class="op" id="4344399">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344403">var</span>&nbsp;<span class="ident" id="4344407">bits</span>&nbsp;<span class="builtintype" id="4344412">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344421">var</span>&nbsp;<span class="ident" id="4344425">size</span>&nbsp;<span class="builtintype" id="4344430">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344438">switch</span>&nbsp;<span class="op" id="4344445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344449">case</span>&nbsp;<span class="ident" id="4344454"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344457">&lt;</span>&nbsp;<span class="num" id="4344459">144</span><span class="op" id="4344462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4344467">//&nbsp;size&nbsp;8,&nbsp;000110000&nbsp;&nbsp;..&nbsp;10111111</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344504"><a href="/compress/flate/huffman_code.go.html#4344407">bits</a></span>&nbsp;<span class="op" id="4344509">=</span>&nbsp;<span class="ident" id="4344511"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344514">+</span>&nbsp;<span class="num" id="4344516">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344522"><a href="/compress/flate/huffman_code.go.html#4344425">size</a></span>&nbsp;<span class="op" id="4344527">=</span>&nbsp;<span class="num" id="4344529">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344534">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344542">case</span>&nbsp;<span class="ident" id="4344547"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344550">&lt;</span>&nbsp;<span class="num" id="4344552">256</span><span class="op" id="4344555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4344560">//&nbsp;size&nbsp;9,&nbsp;110010000&nbsp;..&nbsp;111111111</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344597"><a href="/compress/flate/huffman_code.go.html#4344407">bits</a></span>&nbsp;<span class="op" id="4344602">=</span>&nbsp;<span class="ident" id="4344604"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344607">+</span>&nbsp;<span class="num" id="4344609">400</span>&nbsp;<span class="op" id="4344613">-</span>&nbsp;<span class="num" id="4344615">144</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344622"><a href="/compress/flate/huffman_code.go.html#4344425">size</a></span>&nbsp;<span class="op" id="4344627">=</span>&nbsp;<span class="num" id="4344629">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344634">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344642">case</span>&nbsp;<span class="ident" id="4344647"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344650">&lt;</span>&nbsp;<span class="num" id="4344652">280</span><span class="op" id="4344655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4344660">//&nbsp;size&nbsp;7,&nbsp;0000000&nbsp;..&nbsp;0010111</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344693"><a href="/compress/flate/huffman_code.go.html#4344407">bits</a></span>&nbsp;<span class="op" id="4344698">=</span>&nbsp;<span class="ident" id="4344700"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344703">-</span>&nbsp;<span class="num" id="4344705">256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344712"><a href="/compress/flate/huffman_code.go.html#4344425">size</a></span>&nbsp;<span class="op" id="4344717">=</span>&nbsp;<span class="num" id="4344719">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344724">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344732">default</span><span class="op" id="4344739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4344744">//&nbsp;size&nbsp;8,&nbsp;11000000&nbsp;..&nbsp;11000111</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344779"><a href="/compress/flate/huffman_code.go.html#4344407">bits</a></span>&nbsp;<span class="op" id="4344784">=</span>&nbsp;<span class="ident" id="4344786"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span>&nbsp;<span class="op" id="4344789">+</span>&nbsp;<span class="num" id="4344791">192</span>&nbsp;<span class="op" id="4344795">-</span>&nbsp;<span class="num" id="4344797">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344804"><a href="/compress/flate/huffman_code.go.html#4344425">size</a></span>&nbsp;<span class="op" id="4344809">=</span>&nbsp;<span class="num" id="4344811">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4344815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344819"><a href="/compress/flate/huffman_code.go.html#4344314">codeBits</a></span><span class="op" id="4344827">[</span><span class="ident" id="4344828"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span><span class="op" id="4344830">]</span>&nbsp;<span class="op" id="4344832">=</span>&nbsp;<span class="ident" id="4344834"><a href="/compress/flate/huffman_code.go.html#4344425">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344841"><a href="/compress/flate/huffman_code.go.html#4344338">code</a></span><span class="op" id="4344845">[</span><span class="ident" id="4344846"><a href="/compress/flate/huffman_code.go.html#4344358">ch</a></span><span class="op" id="4344848">]</span>&nbsp;<span class="op" id="4344850">=</span>&nbsp;<span class="ident" id="4344852"><a href="/compress/flate/reverse_bits.go.html#4371219">reverseBits</a></span><span class="op" id="4344863">(</span><span class="ident" id="4344864"><a href="/compress/flate/huffman_code.go.html#4344407">bits</a></span><span class="op" id="4344868">,</span>&nbsp;<span class="ident" id="4344870"><a href="/compress/flate/huffman_code.go.html#4344425">size</a></span><span class="op" id="4344874">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4344877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4344880">return</span>&nbsp;<span class="ident" id="4344887"><a href="/compress/flate/huffman_code.go.html#4344282">h</a></span><br>
<span class="lineno"></span><span class="op" id="4344889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4344892">func</span>&nbsp;<span class="ident" id="4344897">generateFixedOffsetEncoding</span><span class="op" id="4344924">(</span><span class="op" id="4344925">)</span>&nbsp;<span class="op" id="4344927">*</span><span class="ident" id="4344928"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span>&nbsp;<span class="op" id="4344943">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344946">h</span>&nbsp;<span class="op" id="4344948">:=</span>&nbsp;<span class="ident" id="4344951"><a href="/compress/flate/huffman_code.go.html#4344043">newHuffmanEncoder</a></span><span class="op" id="4344968">(</span><span class="num" id="4344969">30</span><span class="op" id="4344971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344974">codeBits</span>&nbsp;<span class="op" id="4344983">:=</span>&nbsp;<span class="ident" id="4344986"><a href="/compress/flate/huffman_code.go.html#4344946">h</a></span><span class="op" id="4344987">.</span><span class="ident" id="4344988">codeBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344998">code</span>&nbsp;<span class="op" id="4345003">:=</span>&nbsp;<span class="ident" id="4345006"><a href="/compress/flate/huffman_code.go.html#4344946">h</a></span><span class="op" id="4345007">.</span><span class="ident" id="4345008">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345014">for</span>&nbsp;<span class="ident" id="4345018">ch</span>&nbsp;<span class="op" id="4345021">:=</span>&nbsp;<span class="builtintype" id="4345024">uint16</span><span class="op" id="4345030">(</span><span class="num" id="4345031">0</span><span class="op" id="4345032">)</span><span class="op" id="4345033">;</span>&nbsp;<span class="ident" id="4345035"><a href="/compress/flate/huffman_code.go.html#4345018">ch</a></span>&nbsp;<span class="op" id="4345038">&lt;</span>&nbsp;<span class="num" id="4345040">30</span><span class="op" id="4345042">;</span>&nbsp;<span class="ident" id="4345044"><a href="/compress/flate/huffman_code.go.html#4345018">ch</a></span><span class="op" id="4345046">++</span>&nbsp;<span class="op" id="4345049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345053"><a href="/compress/flate/huffman_code.go.html#4344974">codeBits</a></span><span class="op" id="4345061">[</span><span class="ident" id="4345062"><a href="/compress/flate/huffman_code.go.html#4345018">ch</a></span><span class="op" id="4345064">]</span>&nbsp;<span class="op" id="4345066">=</span>&nbsp;<span class="num" id="4345068">5</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345072"><a href="/compress/flate/huffman_code.go.html#4344998">code</a></span><span class="op" id="4345076">[</span><span class="ident" id="4345077"><a href="/compress/flate/huffman_code.go.html#4345018">ch</a></span><span class="op" id="4345079">]</span>&nbsp;<span class="op" id="4345081">=</span>&nbsp;<span class="ident" id="4345083"><a href="/compress/flate/reverse_bits.go.html#4371219">reverseBits</a></span><span class="op" id="4345094">(</span><span class="ident" id="4345095"><a href="/compress/flate/huffman_code.go.html#4345018">ch</a></span><span class="op" id="4345097">,</span>&nbsp;<span class="num" id="4345099">5</span><span class="op" id="4345100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345106">return</span>&nbsp;<span class="ident" id="4345113"><a href="/compress/flate/huffman_code.go.html#4344946">h</a></span><br>
<span class="lineno"></span><span class="op" id="4345115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4345118">var</span>&nbsp;<span class="ident" id="4345122">fixedLiteralEncoding</span>&nbsp;<span class="op" id="4345143">*</span><span class="ident" id="4345144"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span>&nbsp;<span class="op" id="4345159">=</span>&nbsp;<span class="ident" id="4345161"><a href="/compress/flate/huffman_code.go.html#4344232">generateFixedLiteralEncoding</a></span><span class="op" id="4345189">(</span><span class="op" id="4345190">)</span><br>
<span class="lineno"></span><span class="keyword" id="4345192">var</span>&nbsp;<span class="ident" id="4345196">fixedOffsetEncoding</span>&nbsp;<span class="op" id="4345216">*</span><span class="ident" id="4345217"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span>&nbsp;<span class="op" id="4345232">=</span>&nbsp;<span class="ident" id="4345234"><a href="/compress/flate/huffman_code.go.html#4344897">generateFixedOffsetEncoding</a></span><span class="op" id="4345261">(</span><span class="op" id="4345262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4345265">func</span>&nbsp;<span class="op" id="4345270">(</span><span class="ident" id="4345271">h</span>&nbsp;<span class="op" id="4345273">*</span><span class="ident" id="4345274"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span><span class="op" id="4345288">)</span>&nbsp;<span class="ident" id="4345290">bitLength</span><span class="op" id="4345299">(</span><span class="ident" id="4345300">freq</span>&nbsp;<span class="op" id="4345305">[</span><span class="op" id="4345306">]</span><span class="builtintype" id="4345307">int32</span><span class="op" id="4345312">)</span>&nbsp;<span class="ident" id="4345314">int64</span>&nbsp;<span class="op" id="4345320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345323">var</span>&nbsp;<span class="ident" id="4345327">total</span>&nbsp;<span class="ident" id="4345333">int64</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345340">for</span>&nbsp;<span class="ident" id="4345344">i</span><span class="op" id="4345345">,</span>&nbsp;<span class="ident" id="4345347">f</span>&nbsp;<span class="op" id="4345349">:=</span>&nbsp;<span class="keyword" id="4345352">range</span>&nbsp;<span class="ident" id="4345358"><a href="/compress/flate/huffman_code.go.html#4345300">freq</a></span>&nbsp;<span class="op" id="4345363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345367">if</span>&nbsp;<span class="ident" id="4345370"><a href="/compress/flate/huffman_code.go.html#4345347">f</a></span>&nbsp;<span class="op" id="4345372">!=</span>&nbsp;<span class="num" id="4345375">0</span>&nbsp;<span class="op" id="4345377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345382"><a href="/compress/flate/huffman_code.go.html#4345327">total</a></span>&nbsp;<span class="op" id="4345388">+=</span>&nbsp;<span class="ident" id="4345391">int64</span><span class="op" id="4345396">(</span><span class="ident" id="4345397"><a href="/compress/flate/huffman_code.go.html#4345347">f</a></span><span class="op" id="4345398">)</span>&nbsp;<span class="op" id="4345400">*</span>&nbsp;<span class="ident" id="4345402">int64</span><span class="op" id="4345407">(</span><span class="ident" id="4345408"><a href="/compress/flate/huffman_code.go.html#4345271">h</a></span><span class="op" id="4345409">.</span><span class="ident" id="4345410">codeBits</span><span class="op" id="4345418">[</span><span class="ident" id="4345419"><a href="/compress/flate/huffman_code.go.html#4345344">i</a></span><span class="op" id="4345420">]</span><span class="op" id="4345421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4345428">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4345431">return</span>&nbsp;<span class="ident" id="4345438"><a href="/compress/flate/huffman_code.go.html#4345327">total</a></span><br>
<span class="lineno"></span><span class="op" id="4345444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4345447">const</span>&nbsp;<span class="ident" id="4345453">maxBitsLimit</span>&nbsp;<span class="op" id="4345466">=</span>&nbsp;<span class="num" id="4345468">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="4345472">//&nbsp;Return&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;assigned&nbsp;to&nbsp;each&nbsp;bit&nbsp;size&nbsp;in&nbsp;the&nbsp;Huffman&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="4345555">//</span><br>
<span class="lineno"></span><span class="comment" id="4345558">//&nbsp;This&nbsp;method&nbsp;is&nbsp;only&nbsp;called&nbsp;when&nbsp;list.length&nbsp;&gt;=&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="4345610">//&nbsp;The&nbsp;cases&nbsp;of&nbsp;0,&nbsp;1,&nbsp;and&nbsp;2&nbsp;literals&nbsp;are&nbsp;handled&nbsp;by&nbsp;special&nbsp;case&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4345681">//</span><br>
<span class="lineno">115</span><span class="comment" id="4345684">//&nbsp;list&nbsp;&nbsp;An&nbsp;array&nbsp;of&nbsp;the&nbsp;literals&nbsp;with&nbsp;non-zero&nbsp;frequencies</span><br>
<span class="lineno"></span><span class="comment" id="4345744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;their&nbsp;associated&nbsp;frequencies.&nbsp;&nbsp;The&nbsp;array&nbsp;is&nbsp;in&nbsp;order&nbsp;of&nbsp;increasing</span><br>
<span class="lineno"></span><span class="comment" id="4345830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequency,&nbsp;and&nbsp;has&nbsp;as&nbsp;its&nbsp;last&nbsp;element&nbsp;a&nbsp;special&nbsp;element&nbsp;with&nbsp;frequency</span><br>
<span class="lineno"></span><span class="comment" id="4345917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MaxInt32</span><br>
<span class="lineno"></span><span class="comment" id="4345941">//&nbsp;maxBits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bits&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to&nbsp;encode&nbsp;any&nbsp;literal.</span><br>
<span class="lineno">120</span><span class="comment" id="4346026">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Must&nbsp;be&nbsp;less&nbsp;than&nbsp;16.</span><br>
<span class="lineno"></span><span class="comment" id="4346063">//&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An&nbsp;integer&nbsp;array&nbsp;in&nbsp;which&nbsp;array[i]&nbsp;indicates&nbsp;the&nbsp;number&nbsp;of&nbsp;literals</span><br>
<span class="lineno"></span><span class="comment" id="4346146">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;should&nbsp;be&nbsp;encoded&nbsp;in&nbsp;i&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4346195">func</span>&nbsp;<span class="op" id="4346200">(</span><span class="ident" id="4346201">h</span>&nbsp;<span class="op" id="4346203">*</span><span class="ident" id="4346204"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span><span class="op" id="4346218">)</span>&nbsp;<span class="ident" id="4346220">bitCounts</span><span class="op" id="4346229">(</span><span class="ident" id="4346230">list</span>&nbsp;<span class="op" id="4346235">[</span><span class="op" id="4346236">]</span><span class="ident" id="4346237"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4346248">,</span>&nbsp;<span class="ident" id="4346250">maxBits</span>&nbsp;<span class="builtintype" id="4346258">int32</span><span class="op" id="4346263">)</span>&nbsp;<span class="op" id="4346265">[</span><span class="op" id="4346266">]</span><span class="builtintype" id="4346267">int32</span>&nbsp;<span class="op" id="4346273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346276">if</span>&nbsp;<span class="ident" id="4346279"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span>&nbsp;<span class="op" id="4346287">&gt;=</span>&nbsp;<span class="ident" id="4346290"><a href="/compress/flate/huffman_code.go.html#4345453">maxBitsLimit</a></span>&nbsp;<span class="op" id="4346303">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4346307">panic</span><span class="op" id="4346312">(</span><span class="string" id="4346313">&#34;flate:&nbsp;maxBits&nbsp;too&nbsp;large&#34;</span><span class="op" id="4346339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346345">n</span>&nbsp;<span class="op" id="4346347">:=</span>&nbsp;<span class="builtintype" id="4346350">int32</span><span class="op" id="4346355">(</span><span class="builtinfunc" id="4346356">len</span><span class="op" id="4346359">(</span><span class="ident" id="4346360"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4346364">)</span><span class="op" id="4346365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346368"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span>&nbsp;<span class="op" id="4346373">=</span>&nbsp;<span class="ident" id="4346375"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4346379">[</span><span class="num" id="4346380">0</span>&nbsp;<span class="op" id="4346382">:</span>&nbsp;<span class="ident" id="4346384"><a href="/compress/flate/huffman_code.go.html#4346345">n</a></span><span class="op" id="4346385">+</span><span class="num" id="4346386">1</span><span class="op" id="4346387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346390"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4346394">[</span><span class="ident" id="4346395"><a href="/compress/flate/huffman_code.go.html#4346345">n</a></span><span class="op" id="4346396">]</span>&nbsp;<span class="op" id="4346398">=</span>&nbsp;<span class="ident" id="4346400"><a href="/compress/flate/huffman_code.go.html#4343961">maxNode</a></span><span class="op" id="4346407">(</span><span class="op" id="4346408">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346412">//&nbsp;The&nbsp;tree&nbsp;can&#39;t&nbsp;have&nbsp;greater&nbsp;depth&nbsp;than&nbsp;n&nbsp;-&nbsp;1,&nbsp;no&nbsp;matter&nbsp;what.&nbsp;&nbsp;This</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346484">//&nbsp;saves&nbsp;a&nbsp;little&nbsp;bit&nbsp;of&nbsp;work&nbsp;in&nbsp;some&nbsp;small&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346535">if</span>&nbsp;<span class="ident" id="4346538"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span>&nbsp;<span class="op" id="4346546">&gt;</span>&nbsp;<span class="ident" id="4346548"><a href="/compress/flate/huffman_code.go.html#4346345">n</a></span><span class="op" id="4346549">-</span><span class="num" id="4346550">1</span>&nbsp;<span class="op" id="4346552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346556"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span>&nbsp;<span class="op" id="4346564">=</span>&nbsp;<span class="ident" id="4346566"><a href="/compress/flate/huffman_code.go.html#4346345">n</a></span>&nbsp;<span class="op" id="4346568">-</span>&nbsp;<span class="num" id="4346570">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346577">//&nbsp;Create&nbsp;information&nbsp;about&nbsp;each&nbsp;of&nbsp;the&nbsp;levels.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346626">//&nbsp;A&nbsp;bogus&nbsp;&#34;Level&nbsp;0&#34;&nbsp;whose&nbsp;sole&nbsp;purpose&nbsp;is&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346678">//&nbsp;level1.prev.needed==0.&nbsp;&nbsp;This&nbsp;makes&nbsp;level1.nextPairFreq</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346737">//&nbsp;be&nbsp;a&nbsp;legitimate&nbsp;value&nbsp;that&nbsp;never&nbsp;gets&nbsp;chosen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4346787">var</span>&nbsp;<span class="ident" id="4346791">levels</span>&nbsp;<span class="op" id="4346798">[</span><span class="ident" id="4346799"><a href="/compress/flate/huffman_code.go.html#4345453">maxBitsLimit</a></span><span class="op" id="4346811">]</span><span class="ident" id="4346812"><a href="/compress/flate/huffman_code.go.html#4343457">levelInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346823">//&nbsp;leafCounts[i]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;at&nbsp;the&nbsp;left</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346883">//&nbsp;of&nbsp;ancestors&nbsp;of&nbsp;the&nbsp;rightmost&nbsp;node&nbsp;at&nbsp;level&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346934">//&nbsp;leafCounts[i][j]&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;at&nbsp;the&nbsp;left</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4346993">//&nbsp;of&nbsp;the&nbsp;level&nbsp;j&nbsp;ancestor.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347022">var</span>&nbsp;<span class="ident" id="4347026">leafCounts</span>&nbsp;<span class="op" id="4347037">[</span><span class="ident" id="4347038"><a href="/compress/flate/huffman_code.go.html#4345453">maxBitsLimit</a></span><span class="op" id="4347050">]</span><span class="op" id="4347051">[</span><span class="ident" id="4347052"><a href="/compress/flate/huffman_code.go.html#4345453">maxBitsLimit</a></span><span class="op" id="4347064">]</span><span class="builtintype" id="4347065">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347073">for</span>&nbsp;<span class="ident" id="4347077">level</span>&nbsp;<span class="op" id="4347083">:=</span>&nbsp;<span class="builtintype" id="4347086">int32</span><span class="op" id="4347091">(</span><span class="num" id="4347092">1</span><span class="op" id="4347093">)</span><span class="op" id="4347094">;</span>&nbsp;<span class="ident" id="4347096"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span>&nbsp;<span class="op" id="4347102">&lt;=</span>&nbsp;<span class="ident" id="4347105"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4347112">;</span>&nbsp;<span class="ident" id="4347114"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span><span class="op" id="4347119">++</span>&nbsp;<span class="op" id="4347122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347126">//&nbsp;For&nbsp;every&nbsp;level,&nbsp;the&nbsp;first&nbsp;two&nbsp;items&nbsp;are&nbsp;the&nbsp;first&nbsp;two&nbsp;characters.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347198">//&nbsp;We&nbsp;initialize&nbsp;the&nbsp;levels&nbsp;as&nbsp;if&nbsp;we&nbsp;had&nbsp;already&nbsp;figured&nbsp;this&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347267"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4347273">[</span><span class="ident" id="4347274"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span><span class="op" id="4347279">]</span>&nbsp;<span class="op" id="4347281">=</span>&nbsp;<span class="ident" id="4347283"><a href="/compress/flate/huffman_code.go.html#4343457">levelInfo</a></span><span class="op" id="4347292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347297">level</span><span class="op" id="4347302">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347311"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span><span class="op" id="4347316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347321">lastFreq</span><span class="op" id="4347329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347335"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4347339">[</span><span class="num" id="4347340">1</span><span class="op" id="4347341">]</span><span class="op" id="4347342">.</span><span class="ident" id="4347343">freq</span><span class="op" id="4347347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347352">nextCharFreq</span><span class="op" id="4347364">:</span>&nbsp;<span class="ident" id="4347366"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4347370">[</span><span class="num" id="4347371">2</span><span class="op" id="4347372">]</span><span class="op" id="4347373">.</span><span class="ident" id="4347374">freq</span><span class="op" id="4347378">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347383">nextPairFreq</span><span class="op" id="4347395">:</span>&nbsp;<span class="ident" id="4347397"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4347401">[</span><span class="num" id="4347402">0</span><span class="op" id="4347403">]</span><span class="op" id="4347404">.</span><span class="ident" id="4347405">freq</span>&nbsp;<span class="op" id="4347410">+</span>&nbsp;<span class="ident" id="4347412"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4347416">[</span><span class="num" id="4347417">1</span><span class="op" id="4347418">]</span><span class="op" id="4347419">.</span><span class="ident" id="4347420">freq</span><span class="op" id="4347424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347432"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4347442">[</span><span class="ident" id="4347443"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span><span class="op" id="4347448">]</span><span class="op" id="4347449">[</span><span class="ident" id="4347450"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span><span class="op" id="4347455">]</span>&nbsp;<span class="op" id="4347457">=</span>&nbsp;<span class="num" id="4347459">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347463">if</span>&nbsp;<span class="ident" id="4347466"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span>&nbsp;<span class="op" id="4347472">==</span>&nbsp;<span class="num" id="4347475">1</span>&nbsp;<span class="op" id="4347477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347482"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4347488">[</span><span class="ident" id="4347489"><a href="/compress/flate/huffman_code.go.html#4347077">level</a></span><span class="op" id="4347494">]</span><span class="op" id="4347495">.</span><span class="ident" id="4347496">nextPairFreq</span>&nbsp;<span class="op" id="4347509">=</span>&nbsp;<span class="ident" id="4347511"><a href="/compress/flate/huffman_code.go.html#4343227">math</a></span><span class="op" id="4347515">.</span><span class="ident" id="4347516">MaxInt32</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347534">//&nbsp;We&nbsp;need&nbsp;a&nbsp;total&nbsp;of&nbsp;2*n&nbsp;-&nbsp;2&nbsp;items&nbsp;at&nbsp;top&nbsp;level&nbsp;and&nbsp;have&nbsp;already&nbsp;generated&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347614"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4347620">[</span><span class="ident" id="4347621"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4347628">]</span><span class="op" id="4347629">.</span><span class="ident" id="4347630">needed</span>&nbsp;<span class="op" id="4347637">=</span>&nbsp;<span class="num" id="4347639">2</span><span class="op" id="4347640">*</span><span class="ident" id="4347641"><a href="/compress/flate/huffman_code.go.html#4346345">n</a></span>&nbsp;<span class="op" id="4347643">-</span>&nbsp;<span class="num" id="4347645">4</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347649">level</span>&nbsp;<span class="op" id="4347655">:=</span>&nbsp;<span class="ident" id="4347658"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347667">for</span>&nbsp;<span class="op" id="4347671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347675">l</span>&nbsp;<span class="op" id="4347677">:=</span>&nbsp;<span class="op" id="4347680">&amp;</span><span class="ident" id="4347681"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4347687">[</span><span class="ident" id="4347688"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4347693">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347697">if</span>&nbsp;<span class="ident" id="4347700"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4347701">.</span><span class="ident" id="4347702">nextPairFreq</span>&nbsp;<span class="op" id="4347715">==</span>&nbsp;<span class="ident" id="4347718"><a href="/compress/flate/huffman_code.go.html#4343227">math</a></span><span class="op" id="4347722">.</span><span class="ident" id="4347723">MaxInt32</span>&nbsp;<span class="op" id="4347732">&amp;&amp;</span>&nbsp;<span class="ident" id="4347735"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4347736">.</span><span class="ident" id="4347737">nextCharFreq</span>&nbsp;<span class="op" id="4347750">==</span>&nbsp;<span class="ident" id="4347753"><a href="/compress/flate/huffman_code.go.html#4343227">math</a></span><span class="op" id="4347757">.</span><span class="ident" id="4347758">MaxInt32</span>&nbsp;<span class="op" id="4347767">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347772">//&nbsp;We&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;both&nbsp;leafs&nbsp;and&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347817">//&nbsp;End&nbsp;all&nbsp;calculations&nbsp;for&nbsp;this&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347860">//&nbsp;To&nbsp;make&nbsp;sure&nbsp;we&nbsp;never&nbsp;come&nbsp;back&nbsp;to&nbsp;this&nbsp;level&nbsp;or&nbsp;any&nbsp;lower&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4347932">//&nbsp;set&nbsp;nextPairFreq&nbsp;impossibly&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347973"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4347974">.</span><span class="ident" id="4347975">needed</span>&nbsp;<span class="op" id="4347982">=</span>&nbsp;<span class="num" id="4347984">0</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347989"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4347995">[</span><span class="ident" id="4347996"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348001">+</span><span class="num" id="4348002">1</span><span class="op" id="4348003">]</span><span class="op" id="4348004">.</span><span class="ident" id="4348005">nextPairFreq</span>&nbsp;<span class="op" id="4348018">=</span>&nbsp;<span class="ident" id="4348020"><a href="/compress/flate/huffman_code.go.html#4343227">math</a></span><span class="op" id="4348024">.</span><span class="ident" id="4348025">MaxInt32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348037"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348042">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348048">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348064">prevFreq</span>&nbsp;<span class="op" id="4348073">:=</span>&nbsp;<span class="ident" id="4348076"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348077">.</span><span class="ident" id="4348078">lastFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348089">if</span>&nbsp;<span class="ident" id="4348092"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348093">.</span><span class="ident" id="4348094">nextCharFreq</span>&nbsp;<span class="op" id="4348107">&lt;</span>&nbsp;<span class="ident" id="4348109"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348110">.</span><span class="ident" id="4348111">nextPairFreq</span>&nbsp;<span class="op" id="4348124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348129">//&nbsp;The&nbsp;next&nbsp;item&nbsp;on&nbsp;this&nbsp;row&nbsp;is&nbsp;a&nbsp;leaf&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348177">n</span>&nbsp;<span class="op" id="4348179">:=</span>&nbsp;<span class="ident" id="4348182"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4348192">[</span><span class="ident" id="4348193"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348198">]</span><span class="op" id="4348199">[</span><span class="ident" id="4348200"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348205">]</span>&nbsp;<span class="op" id="4348207">+</span>&nbsp;<span class="num" id="4348209">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348214"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348215">.</span><span class="ident" id="4348216">lastFreq</span>&nbsp;<span class="op" id="4348225">=</span>&nbsp;<span class="ident" id="4348227"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348228">.</span><span class="ident" id="4348229">nextCharFreq</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348245">//&nbsp;Lower&nbsp;leafCounts&nbsp;are&nbsp;the&nbsp;same&nbsp;of&nbsp;the&nbsp;previous&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348303"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4348313">[</span><span class="ident" id="4348314"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348319">]</span><span class="op" id="4348320">[</span><span class="ident" id="4348321"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348326">]</span>&nbsp;<span class="op" id="4348328">=</span>&nbsp;<span class="ident" id="4348330"><a href="/compress/flate/huffman_code.go.html#4348177">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348335"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348336">.</span><span class="ident" id="4348337">nextCharFreq</span>&nbsp;<span class="op" id="4348350">=</span>&nbsp;<span class="ident" id="4348352"><a href="/compress/flate/huffman_code.go.html#4346230">list</a></span><span class="op" id="4348356">[</span><span class="ident" id="4348357"><a href="/compress/flate/huffman_code.go.html#4348177">n</a></span><span class="op" id="4348358">]</span><span class="op" id="4348359">.</span><span class="ident" id="4348360">freq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348367">}</span>&nbsp;<span class="keyword" id="4348369">else</span>&nbsp;<span class="op" id="4348374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348379">//&nbsp;The&nbsp;next&nbsp;item&nbsp;on&nbsp;this&nbsp;row&nbsp;is&nbsp;a&nbsp;pair&nbsp;from&nbsp;the&nbsp;previous&nbsp;row.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348444">//&nbsp;nextPairFreq&nbsp;isn&#39;t&nbsp;valid&nbsp;until&nbsp;we&nbsp;generate&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348497">//&nbsp;more&nbsp;values&nbsp;in&nbsp;the&nbsp;level&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348534"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348535">.</span><span class="ident" id="4348536">lastFreq</span>&nbsp;<span class="op" id="4348545">=</span>&nbsp;<span class="ident" id="4348547"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348548">.</span><span class="ident" id="4348549">nextPairFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348565">//&nbsp;Take&nbsp;leaf&nbsp;counts&nbsp;from&nbsp;the&nbsp;lower&nbsp;level,&nbsp;except&nbsp;counts[level]&nbsp;remains&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4348649">copy</span><span class="op" id="4348653">(</span><span class="ident" id="4348654"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4348664">[</span><span class="ident" id="4348665"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348670">]</span><span class="op" id="4348671">[</span><span class="op" id="4348672">:</span><span class="ident" id="4348673"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348678">]</span><span class="op" id="4348679">,</span>&nbsp;<span class="ident" id="4348681"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4348691">[</span><span class="ident" id="4348692"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348697">-</span><span class="num" id="4348698">1</span><span class="op" id="4348699">]</span><span class="op" id="4348700">[</span><span class="op" id="4348701">:</span><span class="ident" id="4348702"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4348707">]</span><span class="op" id="4348708">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348713"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4348719">[</span><span class="ident" id="4348720"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348721">.</span><span class="ident" id="4348722">level</span><span class="op" id="4348727">-</span><span class="num" id="4348728">1</span><span class="op" id="4348729">]</span><span class="op" id="4348730">.</span><span class="ident" id="4348731">needed</span>&nbsp;<span class="op" id="4348738">=</span>&nbsp;<span class="num" id="4348740">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4348744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348749">if</span>&nbsp;<span class="ident" id="4348752"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348753">.</span><span class="ident" id="4348754">needed</span><span class="op" id="4348760">--</span><span class="op" id="4348762">;</span>&nbsp;<span class="ident" id="4348764"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4348765">.</span><span class="ident" id="4348766">needed</span>&nbsp;<span class="op" id="4348773">==</span>&nbsp;<span class="num" id="4348776">0</span>&nbsp;<span class="op" id="4348778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348783">//&nbsp;We&#39;ve&nbsp;done&nbsp;everything&nbsp;we&nbsp;need&nbsp;to&nbsp;do&nbsp;for&nbsp;this&nbsp;level.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348841">//&nbsp;Continue&nbsp;calculating&nbsp;one&nbsp;level&nbsp;up.&nbsp;&nbsp;Fill&nbsp;in&nbsp;nextPairFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348904">//&nbsp;of&nbsp;that&nbsp;level&nbsp;with&nbsp;the&nbsp;sum&nbsp;of&nbsp;the&nbsp;two&nbsp;nodes&nbsp;we&#39;ve&nbsp;just&nbsp;calculated&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348979">//&nbsp;this&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4348997">if</span>&nbsp;<span class="ident" id="4349000"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4349001">.</span><span class="ident" id="4349002">level</span>&nbsp;<span class="op" id="4349008">==</span>&nbsp;<span class="ident" id="4349011"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span>&nbsp;<span class="op" id="4349019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349025">//&nbsp;All&nbsp;done!</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349042">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349056"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4349062">[</span><span class="ident" id="4349063"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4349064">.</span><span class="ident" id="4349065">level</span><span class="op" id="4349070">+</span><span class="num" id="4349071">1</span><span class="op" id="4349072">]</span><span class="op" id="4349073">.</span><span class="ident" id="4349074">nextPairFreq</span>&nbsp;<span class="op" id="4349087">=</span>&nbsp;<span class="ident" id="4349089"><a href="/compress/flate/huffman_code.go.html#4348064">prevFreq</a></span>&nbsp;<span class="op" id="4349098">+</span>&nbsp;<span class="ident" id="4349100"><a href="/compress/flate/huffman_code.go.html#4347675">l</a></span><span class="op" id="4349101">.</span><span class="ident" id="4349102">lastFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349114"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4349119">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349124">}</span>&nbsp;<span class="keyword" id="4349126">else</span>&nbsp;<span class="op" id="4349131">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349136">//&nbsp;If&nbsp;we&nbsp;stole&nbsp;from&nbsp;below,&nbsp;move&nbsp;down&nbsp;temporarily&nbsp;to&nbsp;replenish&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349205">for</span>&nbsp;<span class="ident" id="4349209"><a href="/compress/flate/huffman_code.go.html#4346791">levels</a></span><span class="op" id="4349215">[</span><span class="ident" id="4349216"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4349221">-</span><span class="num" id="4349222">1</span><span class="op" id="4349223">]</span><span class="op" id="4349224">.</span><span class="ident" id="4349225">needed</span>&nbsp;<span class="op" id="4349232">&gt;</span>&nbsp;<span class="num" id="4349234">0</span>&nbsp;<span class="op" id="4349236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349242"><a href="/compress/flate/huffman_code.go.html#4347649">level</a></span><span class="op" id="4349247">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349257">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349264">//&nbsp;Somethings&nbsp;is&nbsp;wrong&nbsp;if&nbsp;at&nbsp;the&nbsp;end,&nbsp;the&nbsp;top&nbsp;level&nbsp;is&nbsp;null&nbsp;or&nbsp;hasn&#39;t&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349340">//&nbsp;all&nbsp;of&nbsp;the&nbsp;leaves.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349363">if</span>&nbsp;<span class="ident" id="4349366"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4349376">[</span><span class="ident" id="4349377"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4349384">]</span><span class="op" id="4349385">[</span><span class="ident" id="4349386"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4349393">]</span>&nbsp;<span class="op" id="4349395">!=</span>&nbsp;<span class="ident" id="4349398"><a href="/compress/flate/huffman_code.go.html#4346345">n</a></span>&nbsp;<span class="op" id="4349400">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4349404">panic</span><span class="op" id="4349409">(</span><span class="string" id="4349410">&#34;leafCounts[maxBits][maxBits]&nbsp;!=&nbsp;n&#34;</span><span class="op" id="4349445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349452">bitCount</span>&nbsp;<span class="op" id="4349461">:=</span>&nbsp;<span class="builtinfunc" id="4349464">make</span><span class="op" id="4349468">(</span><span class="op" id="4349469">[</span><span class="op" id="4349470">]</span><span class="builtintype" id="4349471">int32</span><span class="op" id="4349476">,</span>&nbsp;<span class="ident" id="4349478"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4349485">+</span><span class="num" id="4349486">1</span><span class="op" id="4349487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349490">bits</span>&nbsp;<span class="op" id="4349495">:=</span>&nbsp;<span class="num" id="4349498">1</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349501">counts</span>&nbsp;<span class="op" id="4349508">:=</span>&nbsp;<span class="op" id="4349511">&amp;</span><span class="ident" id="4349512"><a href="/compress/flate/huffman_code.go.html#4347026">leafCounts</a></span><span class="op" id="4349522">[</span><span class="ident" id="4349523"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4349530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349533">for</span>&nbsp;<span class="ident" id="4349537">level</span>&nbsp;<span class="op" id="4349543">:=</span>&nbsp;<span class="ident" id="4349546"><a href="/compress/flate/huffman_code.go.html#4346250">maxBits</a></span><span class="op" id="4349553">;</span>&nbsp;<span class="ident" id="4349555"><a href="/compress/flate/huffman_code.go.html#4349537">level</a></span>&nbsp;<span class="op" id="4349561">&gt;</span>&nbsp;<span class="num" id="4349563">0</span><span class="op" id="4349564">;</span>&nbsp;<span class="ident" id="4349566"><a href="/compress/flate/huffman_code.go.html#4349537">level</a></span><span class="op" id="4349571">--</span>&nbsp;<span class="op" id="4349574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349578">//&nbsp;chain.leafCount&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;requiring&nbsp;at&nbsp;least&nbsp;&#34;bits&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349654">//&nbsp;bits&nbsp;to&nbsp;encode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349675"><a href="/compress/flate/huffman_code.go.html#4349452">bitCount</a></span><span class="op" id="4349683">[</span><span class="ident" id="4349684"><a href="/compress/flate/huffman_code.go.html#4349490">bits</a></span><span class="op" id="4349688">]</span>&nbsp;<span class="op" id="4349690">=</span>&nbsp;<span class="ident" id="4349692"><a href="/compress/flate/huffman_code.go.html#4349501">counts</a></span><span class="op" id="4349698">[</span><span class="ident" id="4349699"><a href="/compress/flate/huffman_code.go.html#4349537">level</a></span><span class="op" id="4349704">]</span>&nbsp;<span class="op" id="4349706">-</span>&nbsp;<span class="ident" id="4349708"><a href="/compress/flate/huffman_code.go.html#4349501">counts</a></span><span class="op" id="4349714">[</span><span class="ident" id="4349715"><a href="/compress/flate/huffman_code.go.html#4349537">level</a></span><span class="op" id="4349720">-</span><span class="num" id="4349721">1</span><span class="op" id="4349722">]</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349726"><a href="/compress/flate/huffman_code.go.html#4349490">bits</a></span><span class="op" id="4349730">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4349734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349737">return</span>&nbsp;<span class="ident" id="4349744"><a href="/compress/flate/huffman_code.go.html#4349452">bitCount</a></span><br>
<span class="lineno"></span><span class="op" id="4349753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="4349756">//&nbsp;Look&nbsp;at&nbsp;the&nbsp;leaves&nbsp;and&nbsp;assign&nbsp;them&nbsp;a&nbsp;bit&nbsp;count&nbsp;and&nbsp;an&nbsp;encoding&nbsp;as&nbsp;specified</span><br>
<span class="lineno"></span><span class="comment" id="4349835">//&nbsp;in&nbsp;RFC&nbsp;1951&nbsp;3.2.2</span><br>
<span class="lineno"></span><span class="keyword" id="4349856">func</span>&nbsp;<span class="op" id="4349861">(</span><span class="ident" id="4349862">h</span>&nbsp;<span class="op" id="4349864">*</span><span class="ident" id="4349865"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span><span class="op" id="4349879">)</span>&nbsp;<span class="ident" id="4349881">assignEncodingAndSize</span><span class="op" id="4349902">(</span><span class="ident" id="4349903">bitCount</span>&nbsp;<span class="op" id="4349912">[</span><span class="op" id="4349913">]</span><span class="builtintype" id="4349914">int32</span><span class="op" id="4349919">,</span>&nbsp;<span class="ident" id="4349921">list</span>&nbsp;<span class="op" id="4349926">[</span><span class="op" id="4349927">]</span><span class="ident" id="4349928"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4349939">)</span>&nbsp;<span class="op" id="4349941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349944">code</span>&nbsp;<span class="op" id="4349949">:=</span>&nbsp;<span class="builtintype" id="4349952">uint16</span><span class="op" id="4349958">(</span><span class="num" id="4349959">0</span><span class="op" id="4349960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4349963">for</span>&nbsp;<span class="ident" id="4349967">n</span><span class="op" id="4349968">,</span>&nbsp;<span class="ident" id="4349970">bits</span>&nbsp;<span class="op" id="4349975">:=</span>&nbsp;<span class="keyword" id="4349978">range</span>&nbsp;<span class="ident" id="4349984"><a href="/compress/flate/huffman_code.go.html#4349903">bitCount</a></span>&nbsp;<span class="op" id="4349993">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349997"><a href="/compress/flate/huffman_code.go.html#4349944">code</a></span>&nbsp;<span class="op" id="4350002">&lt;&lt;=</span>&nbsp;<span class="num" id="4350006">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350010">if</span>&nbsp;<span class="ident" id="4350013"><a href="/compress/flate/huffman_code.go.html#4349967">n</a></span>&nbsp;<span class="op" id="4350015">==</span>&nbsp;<span class="num" id="4350018">0</span>&nbsp;<span class="op" id="4350020">||</span>&nbsp;<span class="ident" id="4350023"><a href="/compress/flate/huffman_code.go.html#4349970">bits</a></span>&nbsp;<span class="op" id="4350028">==</span>&nbsp;<span class="num" id="4350031">0</span>&nbsp;<span class="op" id="4350033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350038">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350053">//&nbsp;The&nbsp;literals&nbsp;list[len(list)-bits]&nbsp;..&nbsp;list[len(list)-bits]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350116">//&nbsp;are&nbsp;encoded&nbsp;using&nbsp;&#34;bits&#34;&nbsp;bits,&nbsp;and&nbsp;get&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350171">//&nbsp;code,&nbsp;code&nbsp;+&nbsp;1,&nbsp;....&nbsp;&nbsp;The&nbsp;code&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350218">//&nbsp;assigned&nbsp;in&nbsp;literal&nbsp;order&nbsp;(not&nbsp;frequency&nbsp;order).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350272">chunk</span>&nbsp;<span class="op" id="4350278">:=</span>&nbsp;<span class="ident" id="4350281"><a href="/compress/flate/huffman_code.go.html#4349921">list</a></span><span class="op" id="4350285">[</span><span class="builtinfunc" id="4350286">len</span><span class="op" id="4350289">(</span><span class="ident" id="4350290"><a href="/compress/flate/huffman_code.go.html#4349921">list</a></span><span class="op" id="4350294">)</span><span class="op" id="4350295">-</span><span class="builtintype" id="4350296">int</span><span class="op" id="4350299">(</span><span class="ident" id="4350300"><a href="/compress/flate/huffman_code.go.html#4349970">bits</a></span><span class="op" id="4350304">)</span><span class="op" id="4350305">:</span><span class="op" id="4350306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350310"><a href="/compress/flate/huffman_code.go.html#4352276">sortByLiteral</a></span><span class="op" id="4350323">(</span><span class="ident" id="4350324"><a href="/compress/flate/huffman_code.go.html#4350272">chunk</a></span><span class="op" id="4350329">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350333">for</span>&nbsp;<span class="ident" id="4350337">_</span><span class="op" id="4350338">,</span>&nbsp;<span class="ident" id="4350340">node</span>&nbsp;<span class="op" id="4350345">:=</span>&nbsp;<span class="keyword" id="4350348">range</span>&nbsp;<span class="ident" id="4350354"><a href="/compress/flate/huffman_code.go.html#4350272">chunk</a></span>&nbsp;<span class="op" id="4350360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350365"><a href="/compress/flate/huffman_code.go.html#4349862">h</a></span><span class="op" id="4350366">.</span><span class="ident" id="4350367">codeBits</span><span class="op" id="4350375">[</span><span class="ident" id="4350376"><a href="/compress/flate/huffman_code.go.html#4350340">node</a></span><span class="op" id="4350380">.</span><span class="ident" id="4350381">literal</span><span class="op" id="4350388">]</span>&nbsp;<span class="op" id="4350390">=</span>&nbsp;<span class="builtintype" id="4350392">uint8</span><span class="op" id="4350397">(</span><span class="ident" id="4350398"><a href="/compress/flate/huffman_code.go.html#4349967">n</a></span><span class="op" id="4350399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350404"><a href="/compress/flate/huffman_code.go.html#4349862">h</a></span><span class="op" id="4350405">.</span><span class="ident" id="4350406">code</span><span class="op" id="4350410">[</span><span class="ident" id="4350411"><a href="/compress/flate/huffman_code.go.html#4350340">node</a></span><span class="op" id="4350415">.</span><span class="ident" id="4350416">literal</span><span class="op" id="4350423">]</span>&nbsp;<span class="op" id="4350425">=</span>&nbsp;<span class="ident" id="4350427"><a href="/compress/flate/reverse_bits.go.html#4371219">reverseBits</a></span><span class="op" id="4350438">(</span><span class="ident" id="4350439"><a href="/compress/flate/huffman_code.go.html#4349944">code</a></span><span class="op" id="4350443">,</span>&nbsp;<span class="builtintype" id="4350445">uint8</span><span class="op" id="4350450">(</span><span class="ident" id="4350451"><a href="/compress/flate/huffman_code.go.html#4349967">n</a></span><span class="op" id="4350452">)</span><span class="op" id="4350453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350458"><a href="/compress/flate/huffman_code.go.html#4349944">code</a></span><span class="op" id="4350462">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350467">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350471"><a href="/compress/flate/huffman_code.go.html#4349921">list</a></span>&nbsp;<span class="op" id="4350476">=</span>&nbsp;<span class="ident" id="4350478"><a href="/compress/flate/huffman_code.go.html#4349921">list</a></span><span class="op" id="4350482">[</span><span class="num" id="4350483">0</span>&nbsp;<span class="op" id="4350485">:</span>&nbsp;<span class="builtinfunc" id="4350487">len</span><span class="op" id="4350490">(</span><span class="ident" id="4350491"><a href="/compress/flate/huffman_code.go.html#4349921">list</a></span><span class="op" id="4350495">)</span><span class="op" id="4350496">-</span><span class="builtintype" id="4350497">int</span><span class="op" id="4350500">(</span><span class="ident" id="4350501"><a href="/compress/flate/huffman_code.go.html#4349970">bits</a></span><span class="op" id="4350505">)</span><span class="op" id="4350506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4350509">}</span><br>
<span class="lineno"></span><span class="op" id="4350511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4350514">//&nbsp;Update&nbsp;this&nbsp;Huffman&nbsp;Code&nbsp;object&nbsp;to&nbsp;be&nbsp;the&nbsp;minimum&nbsp;code&nbsp;for&nbsp;the&nbsp;specified&nbsp;frequency&nbsp;count.</span><br>
<span class="lineno">260</span><span class="comment" id="4350607">//</span><br>
<span class="lineno"></span><span class="comment" id="4350610">//&nbsp;freq&nbsp;&nbsp;An&nbsp;array&nbsp;of&nbsp;frequencies,&nbsp;in&nbsp;which&nbsp;frequency[i]&nbsp;gives&nbsp;the&nbsp;frequency&nbsp;of&nbsp;literal&nbsp;i.</span><br>
<span class="lineno"></span><span class="comment" id="4350700">//&nbsp;maxBits&nbsp;&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bits&nbsp;to&nbsp;use&nbsp;for&nbsp;any&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="4350763">func</span>&nbsp;<span class="op" id="4350768">(</span><span class="ident" id="4350769">h</span>&nbsp;<span class="op" id="4350771">*</span><span class="ident" id="4350772"><a href="/compress/flate/huffman_code.go.html#4343250">huffmanEncoder</a></span><span class="op" id="4350786">)</span>&nbsp;<span class="ident" id="4350788">generate</span><span class="op" id="4350796">(</span><span class="ident" id="4350797">freq</span>&nbsp;<span class="op" id="4350802">[</span><span class="op" id="4350803">]</span><span class="builtintype" id="4350804">int32</span><span class="op" id="4350809">,</span>&nbsp;<span class="ident" id="4350811">maxBits</span>&nbsp;<span class="builtintype" id="4350819">int32</span><span class="op" id="4350824">)</span>&nbsp;<span class="op" id="4350826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350829">list</span>&nbsp;<span class="op" id="4350834">:=</span>&nbsp;<span class="builtinfunc" id="4350837">make</span><span class="op" id="4350841">(</span><span class="op" id="4350842">[</span><span class="op" id="4350843">]</span><span class="ident" id="4350844"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4350855">,</span>&nbsp;<span class="builtinfunc" id="4350857">len</span><span class="op" id="4350860">(</span><span class="ident" id="4350861"><a href="/compress/flate/huffman_code.go.html#4350797">freq</a></span><span class="op" id="4350865">)</span><span class="op" id="4350866">+</span><span class="num" id="4350867">1</span><span class="op" id="4350868">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350871">//&nbsp;Number&nbsp;of&nbsp;non-zero&nbsp;literals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350903">count</span>&nbsp;<span class="op" id="4350909">:=</span>&nbsp;<span class="num" id="4350912">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350915">//&nbsp;Set&nbsp;list&nbsp;to&nbsp;be&nbsp;the&nbsp;set&nbsp;of&nbsp;all&nbsp;non-zero&nbsp;literals&nbsp;and&nbsp;their&nbsp;frequencies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350989">for</span>&nbsp;<span class="ident" id="4350993">i</span><span class="op" id="4350994">,</span>&nbsp;<span class="ident" id="4350996">f</span>&nbsp;<span class="op" id="4350998">:=</span>&nbsp;<span class="keyword" id="4351001">range</span>&nbsp;<span class="ident" id="4351007"><a href="/compress/flate/huffman_code.go.html#4350797">freq</a></span>&nbsp;<span class="op" id="4351012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351016">if</span>&nbsp;<span class="ident" id="4351019"><a href="/compress/flate/huffman_code.go.html#4350996">f</a></span>&nbsp;<span class="op" id="4351021">!=</span>&nbsp;<span class="num" id="4351024">0</span>&nbsp;<span class="op" id="4351026">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351031"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span><span class="op" id="4351035">[</span><span class="ident" id="4351036"><a href="/compress/flate/huffman_code.go.html#4350903">count</a></span><span class="op" id="4351041">]</span>&nbsp;<span class="op" id="4351043">=</span>&nbsp;<span class="ident" id="4351045"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4351056">{</span><span class="builtintype" id="4351057">uint16</span><span class="op" id="4351063">(</span><span class="ident" id="4351064"><a href="/compress/flate/huffman_code.go.html#4350993">i</a></span><span class="op" id="4351065">)</span><span class="op" id="4351066">,</span>&nbsp;<span class="ident" id="4351068"><a href="/compress/flate/huffman_code.go.html#4350996">f</a></span><span class="op" id="4351069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351074"><a href="/compress/flate/huffman_code.go.html#4350903">count</a></span><span class="op" id="4351079">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351084">}</span>&nbsp;<span class="keyword" id="4351086">else</span>&nbsp;<span class="op" id="4351091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351096"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351097">.</span><span class="ident" id="4351098">codeBits</span><span class="op" id="4351106">[</span><span class="ident" id="4351107"><a href="/compress/flate/huffman_code.go.html#4350993">i</a></span><span class="op" id="4351108">]</span>&nbsp;<span class="op" id="4351110">=</span>&nbsp;<span class="num" id="4351112">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351116">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4351122">//&nbsp;If&nbsp;freq[]&nbsp;is&nbsp;shorter&nbsp;than&nbsp;codeBits[],&nbsp;fill&nbsp;rest&nbsp;of&nbsp;codeBits[]&nbsp;with&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351199"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351200">.</span><span class="ident" id="4351201">codeBits</span>&nbsp;<span class="op" id="4351210">=</span>&nbsp;<span class="ident" id="4351212"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351213">.</span><span class="ident" id="4351214">codeBits</span><span class="op" id="4351222">[</span><span class="num" id="4351223">0</span><span class="op" id="4351224">:</span><span class="builtinfunc" id="4351225">len</span><span class="op" id="4351228">(</span><span class="ident" id="4351229"><a href="/compress/flate/huffman_code.go.html#4350797">freq</a></span><span class="op" id="4351233">)</span><span class="op" id="4351234">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351237"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span>&nbsp;<span class="op" id="4351242">=</span>&nbsp;<span class="ident" id="4351244"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span><span class="op" id="4351248">[</span><span class="num" id="4351249">0</span><span class="op" id="4351250">:</span><span class="ident" id="4351251"><a href="/compress/flate/huffman_code.go.html#4350903">count</a></span><span class="op" id="4351256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351259">if</span>&nbsp;<span class="ident" id="4351262"><a href="/compress/flate/huffman_code.go.html#4350903">count</a></span>&nbsp;<span class="op" id="4351268">&lt;=</span>&nbsp;<span class="num" id="4351271">2</span>&nbsp;<span class="op" id="4351273">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4351277">//&nbsp;Handle&nbsp;the&nbsp;small&nbsp;cases&nbsp;here,&nbsp;because&nbsp;they&nbsp;are&nbsp;awkward&nbsp;for&nbsp;the&nbsp;general&nbsp;case&nbsp;code.&nbsp;&nbsp;With</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4351369">//&nbsp;two&nbsp;or&nbsp;fewer&nbsp;literals,&nbsp;everything&nbsp;has&nbsp;bit&nbsp;length&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351426">for</span>&nbsp;<span class="ident" id="4351430">i</span><span class="op" id="4351431">,</span>&nbsp;<span class="ident" id="4351433">node</span>&nbsp;<span class="op" id="4351438">:=</span>&nbsp;<span class="keyword" id="4351441">range</span>&nbsp;<span class="ident" id="4351447"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span>&nbsp;<span class="op" id="4351452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4351457">//&nbsp;&#34;list&#34;&nbsp;is&nbsp;in&nbsp;order&nbsp;of&nbsp;increasing&nbsp;literal&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351511"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351512">.</span><span class="ident" id="4351513">codeBits</span><span class="op" id="4351521">[</span><span class="ident" id="4351522"><a href="/compress/flate/huffman_code.go.html#4351433">node</a></span><span class="op" id="4351526">.</span><span class="ident" id="4351527">literal</span><span class="op" id="4351534">]</span>&nbsp;<span class="op" id="4351536">=</span>&nbsp;<span class="num" id="4351538">1</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351543"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351544">.</span><span class="ident" id="4351545">code</span><span class="op" id="4351549">[</span><span class="ident" id="4351550"><a href="/compress/flate/huffman_code.go.html#4351433">node</a></span><span class="op" id="4351554">.</span><span class="ident" id="4351555">literal</span><span class="op" id="4351562">]</span>&nbsp;<span class="op" id="4351564">=</span>&nbsp;<span class="builtintype" id="4351566">uint16</span><span class="op" id="4351572">(</span><span class="ident" id="4351573"><a href="/compress/flate/huffman_code.go.html#4351430">i</a></span><span class="op" id="4351574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351582">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4351590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351593"><a href="/compress/flate/huffman_code.go.html#4352067">sortByFreq</a></span><span class="op" id="4351603">(</span><span class="ident" id="4351604"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span><span class="op" id="4351608">)</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4351612">//&nbsp;Get&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;for&nbsp;each&nbsp;bit&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351662">bitCount</span>&nbsp;<span class="op" id="4351671">:=</span>&nbsp;<span class="ident" id="4351674"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351675">.</span><span class="ident" id="4351676">bitCounts</span><span class="op" id="4351685">(</span><span class="ident" id="4351686"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span><span class="op" id="4351690">,</span>&nbsp;<span class="ident" id="4351692"><a href="/compress/flate/huffman_code.go.html#4350811">maxBits</a></span><span class="op" id="4351699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4351702">//&nbsp;And&nbsp;do&nbsp;the&nbsp;assignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351728"><a href="/compress/flate/huffman_code.go.html#4350769">h</a></span><span class="op" id="4351729">.</span><span class="ident" id="4351730">assignEncodingAndSize</span><span class="op" id="4351751">(</span><span class="ident" id="4351752"><a href="/compress/flate/huffman_code.go.html#4351662">bitCount</a></span><span class="op" id="4351760">,</span>&nbsp;<span class="ident" id="4351762"><a href="/compress/flate/huffman_code.go.html#4350829">list</a></span><span class="op" id="4351766">)</span><br>
<span class="lineno">295</span><span class="op" id="4351768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4351771">type</span>&nbsp;<span class="ident" id="4351776">literalNodeSorter</span>&nbsp;<span class="keyword" id="4351794">struct</span>&nbsp;<span class="op" id="4351801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351804">a</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4351809">[</span><span class="op" id="4351810">]</span><span class="ident" id="4351811"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4351824">less</span>&nbsp;<span class="keyword" id="4351829">func</span><span class="op" id="4351833">(</span><span class="ident" id="4351834">i</span><span class="op" id="4351835">,</span>&nbsp;<span class="ident" id="4351837">j</span>&nbsp;<span class="builtintype" id="4351839">int</span><span class="op" id="4351842">)</span>&nbsp;<span class="builtintype" id="4351844">bool</span><br>
<span class="lineno">300</span><span class="op" id="4351849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4351852">func</span>&nbsp;<span class="op" id="4351857">(</span><span class="ident" id="4351858">s</span>&nbsp;<span class="ident" id="4351860"><a href="/compress/flate/huffman_code.go.html#4351776">literalNodeSorter</a></span><span class="op" id="4351877">)</span>&nbsp;<span class="ident" id="4351879">Len</span><span class="op" id="4351882">(</span><span class="op" id="4351883">)</span>&nbsp;<span class="builtintype" id="4351885">int</span>&nbsp;<span class="op" id="4351889">{</span>&nbsp;<span class="keyword" id="4351891">return</span>&nbsp;<span class="builtinfunc" id="4351898">len</span><span class="op" id="4351901">(</span><span class="ident" id="4351902"><a href="/compress/flate/huffman_code.go.html#4351858">s</a></span><span class="op" id="4351903">.</span><span class="ident" id="4351904">a</span><span class="op" id="4351905">)</span>&nbsp;<span class="op" id="4351907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4351910">func</span>&nbsp;<span class="op" id="4351915">(</span><span class="ident" id="4351916">s</span>&nbsp;<span class="ident" id="4351918"><a href="/compress/flate/huffman_code.go.html#4351776">literalNodeSorter</a></span><span class="op" id="4351935">)</span>&nbsp;<span class="ident" id="4351937">Less</span><span class="op" id="4351941">(</span><span class="ident" id="4351942">i</span><span class="op" id="4351943">,</span>&nbsp;<span class="ident" id="4351945">j</span>&nbsp;<span class="builtintype" id="4351947">int</span><span class="op" id="4351950">)</span>&nbsp;<span class="builtintype" id="4351952">bool</span>&nbsp;<span class="op" id="4351957">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4351960">return</span>&nbsp;<span class="ident" id="4351967"><a href="/compress/flate/huffman_code.go.html#4351916">s</a></span><span class="op" id="4351968">.</span><span class="ident" id="4351969">less</span><span class="op" id="4351973">(</span><span class="ident" id="4351974"><a href="/compress/flate/huffman_code.go.html#4351942">i</a></span><span class="op" id="4351975">,</span>&nbsp;<span class="ident" id="4351977"><a href="/compress/flate/huffman_code.go.html#4351945">j</a></span><span class="op" id="4351978">)</span><br>
<span class="lineno"></span><span class="op" id="4351980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4351983">func</span>&nbsp;<span class="op" id="4351988">(</span><span class="ident" id="4351989">s</span>&nbsp;<span class="ident" id="4351991"><a href="/compress/flate/huffman_code.go.html#4351776">literalNodeSorter</a></span><span class="op" id="4352008">)</span>&nbsp;<span class="ident" id="4352010">Swap</span><span class="op" id="4352014">(</span><span class="ident" id="4352015">i</span><span class="op" id="4352016">,</span>&nbsp;<span class="ident" id="4352018">j</span>&nbsp;<span class="builtintype" id="4352020">int</span><span class="op" id="4352023">)</span>&nbsp;<span class="op" id="4352025">{</span>&nbsp;<span class="ident" id="4352027"><a href="/compress/flate/huffman_code.go.html#4351989">s</a></span><span class="op" id="4352028">.</span><span class="ident" id="4352029">a</span><span class="op" id="4352030">[</span><span class="ident" id="4352031"><a href="/compress/flate/huffman_code.go.html#4352015">i</a></span><span class="op" id="4352032">]</span><span class="op" id="4352033">,</span>&nbsp;<span class="ident" id="4352035"><a href="/compress/flate/huffman_code.go.html#4351989">s</a></span><span class="op" id="4352036">.</span><span class="ident" id="4352037">a</span><span class="op" id="4352038">[</span><span class="ident" id="4352039"><a href="/compress/flate/huffman_code.go.html#4352018">j</a></span><span class="op" id="4352040">]</span>&nbsp;<span class="op" id="4352042">=</span>&nbsp;<span class="ident" id="4352044"><a href="/compress/flate/huffman_code.go.html#4351989">s</a></span><span class="op" id="4352045">.</span><span class="ident" id="4352046">a</span><span class="op" id="4352047">[</span><span class="ident" id="4352048"><a href="/compress/flate/huffman_code.go.html#4352018">j</a></span><span class="op" id="4352049">]</span><span class="op" id="4352050">,</span>&nbsp;<span class="ident" id="4352052"><a href="/compress/flate/huffman_code.go.html#4351989">s</a></span><span class="op" id="4352053">.</span><span class="ident" id="4352054">a</span><span class="op" id="4352055">[</span><span class="ident" id="4352056"><a href="/compress/flate/huffman_code.go.html#4352015">i</a></span><span class="op" id="4352057">]</span>&nbsp;<span class="op" id="4352059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="keyword" id="4352062">func</span>&nbsp;<span class="ident" id="4352067">sortByFreq</span><span class="op" id="4352077">(</span><span class="ident" id="4352078">a</span>&nbsp;<span class="op" id="4352080">[</span><span class="op" id="4352081">]</span><span class="ident" id="4352082"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4352093">)</span>&nbsp;<span class="op" id="4352095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352098">s</span>&nbsp;<span class="op" id="4352100">:=</span>&nbsp;<span class="op" id="4352103">&amp;</span><span class="ident" id="4352104"><a href="/compress/flate/huffman_code.go.html#4351776">literalNodeSorter</a></span><span class="op" id="4352121">{</span><span class="ident" id="4352122"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352123">,</span>&nbsp;<span class="keyword" id="4352125">func</span><span class="op" id="4352129">(</span><span class="ident" id="4352130">i</span><span class="op" id="4352131">,</span>&nbsp;<span class="ident" id="4352133">j</span>&nbsp;<span class="builtintype" id="4352135">int</span><span class="op" id="4352138">)</span>&nbsp;<span class="builtintype" id="4352140">bool</span>&nbsp;<span class="op" id="4352145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352149">if</span>&nbsp;<span class="ident" id="4352152"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352153">[</span><span class="ident" id="4352154"><a href="/compress/flate/huffman_code.go.html#4352130">i</a></span><span class="op" id="4352155">]</span><span class="op" id="4352156">.</span><span class="ident" id="4352157">freq</span>&nbsp;<span class="op" id="4352162">==</span>&nbsp;<span class="ident" id="4352165"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352166">[</span><span class="ident" id="4352167"><a href="/compress/flate/huffman_code.go.html#4352133">j</a></span><span class="op" id="4352168">]</span><span class="op" id="4352169">.</span><span class="ident" id="4352170">freq</span>&nbsp;<span class="op" id="4352175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352180">return</span>&nbsp;<span class="ident" id="4352187"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352188">[</span><span class="ident" id="4352189"><a href="/compress/flate/huffman_code.go.html#4352130">i</a></span><span class="op" id="4352190">]</span><span class="op" id="4352191">.</span><span class="ident" id="4352192">literal</span>&nbsp;<span class="op" id="4352200">&lt;</span>&nbsp;<span class="ident" id="4352202"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352203">[</span><span class="ident" id="4352204"><a href="/compress/flate/huffman_code.go.html#4352133">j</a></span><span class="op" id="4352205">]</span><span class="op" id="4352206">.</span><span class="ident" id="4352207">literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352217">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4352221">return</span>&nbsp;<span class="ident" id="4352228"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352229">[</span><span class="ident" id="4352230"><a href="/compress/flate/huffman_code.go.html#4352130">i</a></span><span class="op" id="4352231">]</span><span class="op" id="4352232">.</span><span class="ident" id="4352233">freq</span>&nbsp;<span class="op" id="4352238">&lt;</span>&nbsp;<span class="ident" id="4352240"><a href="/compress/flate/huffman_code.go.html#4352078">a</a></span><span class="op" id="4352241">[</span><span class="ident" id="4352242"><a href="/compress/flate/huffman_code.go.html#4352133">j</a></span><span class="op" id="4352243">]</span><span class="op" id="4352244">.</span><span class="ident" id="4352245">freq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4352251">}</span><span class="op" id="4352252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352255"><a href="/compress/flate/huffman_code.go.html#4343235">sort</a></span><span class="op" id="4352259">.</span><span class="ident" id="4352260">Sort</span><span class="op" id="4352264">(</span><span class="ident" id="4352265"><a href="/compress/flate/huffman_code.go.html#4352098">s</a></span><span class="op" id="4352266">)</span><br>
<span class="lineno"></span><span class="op" id="4352268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="4352271">func</span>&nbsp;<span class="ident" id="4352276">sortByLiteral</span><span class="op" id="4352289">(</span><span class="ident" id="4352290">a</span>&nbsp;<span class="op" id="4352292">[</span><span class="op" id="4352293">]</span><span class="ident" id="4352294"><a href="/compress/flate/huffman_code.go.html#4343319">literalNode</a></span><span class="op" id="4352305">)</span>&nbsp;<span class="op" id="4352307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352310">s</span>&nbsp;<span class="op" id="4352312">:=</span>&nbsp;<span class="op" id="4352315">&amp;</span><span class="ident" id="4352316"><a href="/compress/flate/huffman_code.go.html#4351776">literalNodeSorter</a></span><span class="op" id="4352333">{</span><span class="ident" id="4352334"><a href="/compress/flate/huffman_code.go.html#4352290">a</a></span><span class="op" id="4352335">,</span>&nbsp;<span class="keyword" id="4352337">func</span><span class="op" id="4352341">(</span><span class="ident" id="4352342">i</span><span class="op" id="4352343">,</span>&nbsp;<span class="ident" id="4352345">j</span>&nbsp;<span class="builtintype" id="4352347">int</span><span class="op" id="4352350">)</span>&nbsp;<span class="builtintype" id="4352352">bool</span>&nbsp;<span class="op" id="4352357">{</span>&nbsp;<span class="keyword" id="4352359">return</span>&nbsp;<span class="ident" id="4352366"><a href="/compress/flate/huffman_code.go.html#4352290">a</a></span><span class="op" id="4352367">[</span><span class="ident" id="4352368"><a href="/compress/flate/huffman_code.go.html#4352342">i</a></span><span class="op" id="4352369">]</span><span class="op" id="4352370">.</span><span class="ident" id="4352371">literal</span>&nbsp;<span class="op" id="4352379">&lt;</span>&nbsp;<span class="ident" id="4352381"><a href="/compress/flate/huffman_code.go.html#4352290">a</a></span><span class="op" id="4352382">[</span><span class="ident" id="4352383"><a href="/compress/flate/huffman_code.go.html#4352345">j</a></span><span class="op" id="4352384">]</span><span class="op" id="4352385">.</span><span class="ident" id="4352386">literal</span>&nbsp;<span class="op" id="4352394">}</span><span class="op" id="4352395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4352398"><a href="/compress/flate/huffman_code.go.html#4343235">sort</a></span><span class="op" id="4352402">.</span><span class="ident" id="4352403">Sort</span><span class="op" id="4352407">(</span><span class="ident" id="4352408"><a href="/compress/flate/huffman_code.go.html#4352310">s</a></span><span class="op" id="4352409">)</span><br>
<span class="lineno"></span><span class="op" id="4352411">}</span>
</div>
</body>
</html>
