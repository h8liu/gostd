<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4124387">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4124442">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4124496">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4124547">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspstatus,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4125450">package</span>&nbsp;<span class="ident" id="4125458">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4125463">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="4125477">//&nbsp;&nbsp;&nbsp;&nbspsupport&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4125514">import</span>&nbsp;<span class="op" id="4125521">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4125524">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4125534">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4125540">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4125546">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4125557">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="4125564">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4125567">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4125615">type</span>&nbsp;<span class="ident" id="4125620">Addr</span>&nbsp;<span class="keyword" id="4125625">interface</span>&nbsp;<span class="op" id="4125635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125638">Network</span><span class="op" id="4125645">(</span><span class="op" id="4125646">)</span>&nbsp;<span class="builtintype" id="4125648">string</span>&nbsp;<span class="comment" id="4125655">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4125679">String</span><span class="op" id="4125685">(</span><span class="op" id="4125686">)</span>&nbsp;<span class="builtintype" id="4125688">string</span>&nbsp;&nbsp;<span class="comment" id="4125696">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="4125722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4125725">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4125782">//</span><br>
<span class="lineno">60</span><span class="comment" id="4125785">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="4125853">type</span>&nbsp;<span class="ident" id="4125858">Conn</span>&nbsp;<span class="keyword" id="4125863">interface</span>&nbsp;<span class="op" id="4125873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125876">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125917">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4125992">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126059">Read</span><span class="op" id="4126063">(</span><span class="ident" id="4126064">b</span>&nbsp;<span class="op" id="4126066">[</span><span class="op" id="4126067">]</span><span class="builtintype" id="4126068">byte</span><span class="op" id="4126072">)</span>&nbsp;<span class="op" id="4126074">(</span><span class="ident" id="4126075">n</span>&nbsp;<span class="builtintype" id="4126077">int</span><span class="op" id="4126080">,</span>&nbsp;<span class="ident" id="4126082">err</span>&nbsp;<span class="builtintype" id="4126086">error</span><span class="op" id="4126091">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126095">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126136">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126212">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126280">Write</span><span class="op" id="4126285">(</span><span class="ident" id="4126286">b</span>&nbsp;<span class="op" id="4126288">[</span><span class="op" id="4126289">]</span><span class="builtintype" id="4126290">byte</span><span class="op" id="4126294">)</span>&nbsp;<span class="op" id="4126296">(</span><span class="ident" id="4126297">n</span>&nbsp;<span class="builtintype" id="4126299">int</span><span class="op" id="4126302">,</span>&nbsp;<span class="ident" id="4126304">err</span>&nbsp;<span class="builtintype" id="4126308">error</span><span class="op" id="4126313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126317">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126350">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126428">Close</span><span class="op" id="4126433">(</span><span class="op" id="4126434">)</span>&nbsp;<span class="builtintype" id="4126436">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126444">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126493">LocalAddr</span><span class="op" id="4126502">(</span><span class="op" id="4126503">)</span>&nbsp;<span class="ident" id="4126505">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126512">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4126563">RemoteAddr</span><span class="op" id="4126573">(</span><span class="op" id="4126574">)</span>&nbsp;<span class="ident" id="4126576">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126583">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126644">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126702">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126744">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126748">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126810">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126862">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126925">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126978">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4126982">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127045">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127100">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127104">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127167">SetDeadline</span><span class="op" id="4127178">(</span><span class="ident" id="4127179">t</span>&nbsp;<span class="ident" id="4127181">time</span><span class="op" id="4127185">.</span><span class="ident" id="4127186">Time</span><span class="op" id="4127190">)</span>&nbsp;<span class="builtintype" id="4127192">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127200">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127261">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127314">SetReadDeadline</span><span class="op" id="4127329">(</span><span class="ident" id="4127330">t</span>&nbsp;<span class="ident" id="4127332">time</span><span class="op" id="4127336">.</span><span class="ident" id="4127337">Time</span><span class="op" id="4127341">)</span>&nbsp;<span class="builtintype" id="4127343">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127351">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127414">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127480">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4127527">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127581">SetWriteDeadline</span><span class="op" id="4127597">(</span><span class="ident" id="4127598">t</span>&nbsp;<span class="ident" id="4127600">time</span><span class="op" id="4127604">.</span><span class="ident" id="4127605">Time</span><span class="op" id="4127609">)</span>&nbsp;<span class="builtintype" id="4127611">error</span><br>
<span class="lineno"></span><span class="op" id="4127617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4127620">type</span>&nbsp;<span class="ident" id="4127625">conn</span>&nbsp;<span class="keyword" id="4127630">struct</span>&nbsp;<span class="op" id="4127637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4127640">fd</span>&nbsp;<span class="op" id="4127643">*</span><span class="ident" id="4127644">netFD</span><br>
<span class="lineno">110</span><span class="op" id="4127650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4127653">func</span>&nbsp;<span class="op" id="4127658">(</span><span class="ident" id="4127659">c</span>&nbsp;<span class="op" id="4127661">*</span><span class="ident" id="4127662">conn</span><span class="op" id="4127666">)</span>&nbsp;<span class="ident" id="4127668">ok</span><span class="op" id="4127670">(</span><span class="op" id="4127671">)</span>&nbsp;<span class="builtintype" id="4127673">bool</span>&nbsp;<span class="op" id="4127678">{</span>&nbsp;<span class="keyword" id="4127680">return</span>&nbsp;<span class="ident" id="4127687">c</span>&nbsp;<span class="op" id="4127689">!=</span>&nbsp;<span class="ident" id="4127692">nil</span>&nbsp;<span class="op" id="4127696">&amp;&amp;</span>&nbsp;<span class="ident" id="4127699">c</span><span class="op" id="4127700">.</span><span class="ident" id="4127701">fd</span>&nbsp;<span class="op" id="4127704">!=</span>&nbsp;<span class="ident" id="4127707">nil</span>&nbsp;<span class="op" id="4127711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4127714">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="4127756">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4127797">func</span>&nbsp;<span class="op" id="4127802">(</span><span class="ident" id="4127803">c</span>&nbsp;<span class="op" id="4127805">*</span><span class="ident" id="4127806">conn</span><span class="op" id="4127810">)</span>&nbsp;<span class="ident" id="4127812">Read</span><span class="op" id="4127816">(</span><span class="ident" id="4127817">b</span>&nbsp;<span class="op" id="4127819">[</span><span class="op" id="4127820">]</span><span class="builtintype" id="4127821">byte</span><span class="op" id="4127825">)</span>&nbsp;<span class="op" id="4127827">(</span><span class="builtintype" id="4127828">int</span><span class="op" id="4127831">,</span>&nbsp;<span class="builtintype" id="4127833">error</span><span class="op" id="4127838">)</span>&nbsp;<span class="op" id="4127840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127843">if</span>&nbsp;<span class="op" id="4127846">!</span><span class="ident" id="4127847">c</span><span class="op" id="4127848">.</span><span class="ident" id="4127849">ok</span><span class="op" id="4127851">(</span><span class="op" id="4127852">)</span>&nbsp;<span class="op" id="4127854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127858">return</span>&nbsp;<span class="num" id="4127865">0</span><span class="op" id="4127866">,</span>&nbsp;<span class="ident" id="4127868">syscall</span><span class="op" id="4127875">.</span><span class="ident" id="4127876">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4127884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4127887">return</span>&nbsp;<span class="ident" id="4127894">c</span><span class="op" id="4127895">.</span><span class="ident" id="4127896">fd</span><span class="op" id="4127898">.</span><span class="ident" id="4127899">Read</span><span class="op" id="4127903">(</span><span class="ident" id="4127904">b</span><span class="op" id="4127905">)</span><br>
<span class="lineno"></span><span class="op" id="4127907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4127910">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="4127953">func</span>&nbsp;<span class="op" id="4127958">(</span><span class="ident" id="4127959">c</span>&nbsp;<span class="op" id="4127961">*</span><span class="ident" id="4127962">conn</span><span class="op" id="4127966">)</span>&nbsp;<span class="ident" id="4127968">Write</span><span class="op" id="4127973">(</span><span class="ident" id="4127974">b</span>&nbsp;<span class="op" id="4127976">[</span><span class="op" id="4127977">]</span><span class="builtintype" id="4127978">byte</span><span class="op" id="4127982">)</span>&nbsp;<span class="op" id="4127984">(</span><span class="builtintype" id="4127985">int</span><span class="op" id="4127988">,</span>&nbsp;<span class="builtintype" id="4127990">error</span><span class="op" id="4127995">)</span>&nbsp;<span class="op" id="4127997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128000">if</span>&nbsp;<span class="op" id="4128003">!</span><span class="ident" id="4128004">c</span><span class="op" id="4128005">.</span><span class="ident" id="4128006">ok</span><span class="op" id="4128008">(</span><span class="op" id="4128009">)</span>&nbsp;<span class="op" id="4128011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128015">return</span>&nbsp;<span class="num" id="4128022">0</span><span class="op" id="4128023">,</span>&nbsp;<span class="ident" id="4128025">syscall</span><span class="op" id="4128032">.</span><span class="ident" id="4128033">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128044">return</span>&nbsp;<span class="ident" id="4128051">c</span><span class="op" id="4128052">.</span><span class="ident" id="4128053">fd</span><span class="op" id="4128055">.</span><span class="ident" id="4128056">Write</span><span class="op" id="4128061">(</span><span class="ident" id="4128062">b</span><span class="op" id="4128063">)</span><br>
<span class="lineno">130</span><span class="op" id="4128065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4128068">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4128100">func</span>&nbsp;<span class="op" id="4128105">(</span><span class="ident" id="4128106">c</span>&nbsp;<span class="op" id="4128108">*</span><span class="ident" id="4128109">conn</span><span class="op" id="4128113">)</span>&nbsp;<span class="ident" id="4128115">Close</span><span class="op" id="4128120">(</span><span class="op" id="4128121">)</span>&nbsp;<span class="builtintype" id="4128123">error</span>&nbsp;<span class="op" id="4128129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128132">if</span>&nbsp;<span class="op" id="4128135">!</span><span class="ident" id="4128136">c</span><span class="op" id="4128137">.</span><span class="ident" id="4128138">ok</span><span class="op" id="4128140">(</span><span class="op" id="4128141">)</span>&nbsp;<span class="op" id="4128143">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128147">return</span>&nbsp;<span class="ident" id="4128154">syscall</span><span class="op" id="4128161">.</span><span class="ident" id="4128162">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128173">return</span>&nbsp;<span class="ident" id="4128180">c</span><span class="op" id="4128181">.</span><span class="ident" id="4128182">fd</span><span class="op" id="4128184">.</span><span class="ident" id="4128185">Close</span><span class="op" id="4128190">(</span><span class="op" id="4128191">)</span><br>
<span class="lineno"></span><span class="op" id="4128193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="4128196">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4128244">func</span>&nbsp;<span class="op" id="4128249">(</span><span class="ident" id="4128250">c</span>&nbsp;<span class="op" id="4128252">*</span><span class="ident" id="4128253">conn</span><span class="op" id="4128257">)</span>&nbsp;<span class="ident" id="4128259">LocalAddr</span><span class="op" id="4128268">(</span><span class="op" id="4128269">)</span>&nbsp;<span class="ident" id="4128271">Addr</span>&nbsp;<span class="op" id="4128276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128279">if</span>&nbsp;<span class="op" id="4128282">!</span><span class="ident" id="4128283">c</span><span class="op" id="4128284">.</span><span class="ident" id="4128285">ok</span><span class="op" id="4128287">(</span><span class="op" id="4128288">)</span>&nbsp;<span class="op" id="4128290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128294">return</span>&nbsp;<span class="ident" id="4128301">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128306">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128309">return</span>&nbsp;<span class="ident" id="4128316">c</span><span class="op" id="4128317">.</span><span class="ident" id="4128318">fd</span><span class="op" id="4128320">.</span><span class="ident" id="4128321">laddr</span><br>
<span class="lineno"></span><span class="op" id="4128327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4128330">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4128380">func</span>&nbsp;<span class="op" id="4128385">(</span><span class="ident" id="4128386">c</span>&nbsp;<span class="op" id="4128388">*</span><span class="ident" id="4128389">conn</span><span class="op" id="4128393">)</span>&nbsp;<span class="ident" id="4128395">RemoteAddr</span><span class="op" id="4128405">(</span><span class="op" id="4128406">)</span>&nbsp;<span class="ident" id="4128408">Addr</span>&nbsp;<span class="op" id="4128413">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128416">if</span>&nbsp;<span class="op" id="4128419">!</span><span class="ident" id="4128420">c</span><span class="op" id="4128421">.</span><span class="ident" id="4128422">ok</span><span class="op" id="4128424">(</span><span class="op" id="4128425">)</span>&nbsp;<span class="op" id="4128427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128431">return</span>&nbsp;<span class="ident" id="4128438">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128446">return</span>&nbsp;<span class="ident" id="4128453">c</span><span class="op" id="4128454">.</span><span class="ident" id="4128455">fd</span><span class="op" id="4128457">.</span><span class="ident" id="4128458">raddr</span><br>
<span class="lineno"></span><span class="op" id="4128464">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4128467">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4128522">func</span>&nbsp;<span class="op" id="4128527">(</span><span class="ident" id="4128528">c</span>&nbsp;<span class="op" id="4128530">*</span><span class="ident" id="4128531">conn</span><span class="op" id="4128535">)</span>&nbsp;<span class="ident" id="4128537">SetDeadline</span><span class="op" id="4128548">(</span><span class="ident" id="4128549">t</span>&nbsp;<span class="ident" id="4128551">time</span><span class="op" id="4128555">.</span><span class="ident" id="4128556">Time</span><span class="op" id="4128560">)</span>&nbsp;<span class="builtintype" id="4128562">error</span>&nbsp;<span class="op" id="4128568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128571">if</span>&nbsp;<span class="op" id="4128574">!</span><span class="ident" id="4128575">c</span><span class="op" id="4128576">.</span><span class="ident" id="4128577">ok</span><span class="op" id="4128579">(</span><span class="op" id="4128580">)</span>&nbsp;<span class="op" id="4128582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128586">return</span>&nbsp;<span class="ident" id="4128593">syscall</span><span class="op" id="4128600">.</span><span class="ident" id="4128601">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128612">return</span>&nbsp;<span class="ident" id="4128619">c</span><span class="op" id="4128620">.</span><span class="ident" id="4128621">fd</span><span class="op" id="4128623">.</span><span class="ident" id="4128624">setDeadline</span><span class="op" id="4128635">(</span><span class="ident" id="4128636">t</span><span class="op" id="4128637">)</span><br>
<span class="lineno"></span><span class="op" id="4128639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4128642">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="4128705">func</span>&nbsp;<span class="op" id="4128710">(</span><span class="ident" id="4128711">c</span>&nbsp;<span class="op" id="4128713">*</span><span class="ident" id="4128714">conn</span><span class="op" id="4128718">)</span>&nbsp;<span class="ident" id="4128720">SetReadDeadline</span><span class="op" id="4128735">(</span><span class="ident" id="4128736">t</span>&nbsp;<span class="ident" id="4128738">time</span><span class="op" id="4128742">.</span><span class="ident" id="4128743">Time</span><span class="op" id="4128747">)</span>&nbsp;<span class="builtintype" id="4128749">error</span>&nbsp;<span class="op" id="4128755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128758">if</span>&nbsp;<span class="op" id="4128761">!</span><span class="ident" id="4128762">c</span><span class="op" id="4128763">.</span><span class="ident" id="4128764">ok</span><span class="op" id="4128766">(</span><span class="op" id="4128767">)</span>&nbsp;<span class="op" id="4128769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128773">return</span>&nbsp;<span class="ident" id="4128780">syscall</span><span class="op" id="4128787">.</span><span class="ident" id="4128788">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128799">return</span>&nbsp;<span class="ident" id="4128806">c</span><span class="op" id="4128807">.</span><span class="ident" id="4128808">fd</span><span class="op" id="4128810">.</span><span class="ident" id="4128811">setReadDeadline</span><span class="op" id="4128826">(</span><span class="ident" id="4128827">t</span><span class="op" id="4128828">)</span><br>
<span class="lineno">170</span><span class="op" id="4128830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4128833">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4128898">func</span>&nbsp;<span class="op" id="4128903">(</span><span class="ident" id="4128904">c</span>&nbsp;<span class="op" id="4128906">*</span><span class="ident" id="4128907">conn</span><span class="op" id="4128911">)</span>&nbsp;<span class="ident" id="4128913">SetWriteDeadline</span><span class="op" id="4128929">(</span><span class="ident" id="4128930">t</span>&nbsp;<span class="ident" id="4128932">time</span><span class="op" id="4128936">.</span><span class="ident" id="4128937">Time</span><span class="op" id="4128941">)</span>&nbsp;<span class="builtintype" id="4128943">error</span>&nbsp;<span class="op" id="4128949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128952">if</span>&nbsp;<span class="op" id="4128955">!</span><span class="ident" id="4128956">c</span><span class="op" id="4128957">.</span><span class="ident" id="4128958">ok</span><span class="op" id="4128960">(</span><span class="op" id="4128961">)</span>&nbsp;<span class="op" id="4128963">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128967">return</span>&nbsp;<span class="ident" id="4128974">syscall</span><span class="op" id="4128981">.</span><span class="ident" id="4128982">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4128990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4128993">return</span>&nbsp;<span class="ident" id="4129000">c</span><span class="op" id="4129001">.</span><span class="ident" id="4129002">fd</span><span class="op" id="4129004">.</span><span class="ident" id="4129005">setWriteDeadline</span><span class="op" id="4129021">(</span><span class="ident" id="4129022">t</span><span class="op" id="4129023">)</span><br>
<span class="lineno"></span><span class="op" id="4129025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4129028">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4129085">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4129135">func</span>&nbsp;<span class="op" id="4129140">(</span><span class="ident" id="4129141">c</span>&nbsp;<span class="op" id="4129143">*</span><span class="ident" id="4129144">conn</span><span class="op" id="4129148">)</span>&nbsp;<span class="ident" id="4129150">SetReadBuffer</span><span class="op" id="4129163">(</span><span class="ident" id="4129164">bytes</span>&nbsp;<span class="builtintype" id="4129170">int</span><span class="op" id="4129173">)</span>&nbsp;<span class="builtintype" id="4129175">error</span>&nbsp;<span class="op" id="4129181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129184">if</span>&nbsp;<span class="op" id="4129187">!</span><span class="ident" id="4129188">c</span><span class="op" id="4129189">.</span><span class="ident" id="4129190">ok</span><span class="op" id="4129192">(</span><span class="op" id="4129193">)</span>&nbsp;<span class="op" id="4129195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129199">return</span>&nbsp;<span class="ident" id="4129206">syscall</span><span class="op" id="4129213">.</span><span class="ident" id="4129214">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129225">return</span>&nbsp;<span class="ident" id="4129232">setReadBuffer</span><span class="op" id="4129245">(</span><span class="ident" id="4129246">c</span><span class="op" id="4129247">.</span><span class="ident" id="4129248">fd</span><span class="op" id="4129250">,</span>&nbsp;<span class="ident" id="4129252">bytes</span><span class="op" id="4129257">)</span><br>
<span class="lineno"></span><span class="op" id="4129259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4129262">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="4129320">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4129371">func</span>&nbsp;<span class="op" id="4129376">(</span><span class="ident" id="4129377">c</span>&nbsp;<span class="op" id="4129379">*</span><span class="ident" id="4129380">conn</span><span class="op" id="4129384">)</span>&nbsp;<span class="ident" id="4129386">SetWriteBuffer</span><span class="op" id="4129400">(</span><span class="ident" id="4129401">bytes</span>&nbsp;<span class="builtintype" id="4129407">int</span><span class="op" id="4129410">)</span>&nbsp;<span class="builtintype" id="4129412">error</span>&nbsp;<span class="op" id="4129418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129421">if</span>&nbsp;<span class="op" id="4129424">!</span><span class="ident" id="4129425">c</span><span class="op" id="4129426">.</span><span class="ident" id="4129427">ok</span><span class="op" id="4129429">(</span><span class="op" id="4129430">)</span>&nbsp;<span class="op" id="4129432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129436">return</span>&nbsp;<span class="ident" id="4129443">syscall</span><span class="op" id="4129450">.</span><span class="ident" id="4129451">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4129459">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4129462">return</span>&nbsp;<span class="ident" id="4129469">setWriteBuffer</span><span class="op" id="4129483">(</span><span class="ident" id="4129484">c</span><span class="op" id="4129485">.</span><span class="ident" id="4129486">fd</span><span class="op" id="4129488">,</span>&nbsp;<span class="ident" id="4129490">bytes</span><span class="op" id="4129495">)</span><br>
<span class="lineno"></span><span class="op" id="4129497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4129500">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="4129573">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="4129636">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="4129701">//</span><br>
<span class="lineno"></span><span class="comment" id="4129704">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="4129782">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="4129854">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="4129897">func</span>&nbsp;<span class="op" id="4129902">(</span><span class="ident" id="4129903">c</span>&nbsp;<span class="op" id="4129905">*</span><span class="ident" id="4129906">conn</span><span class="op" id="4129910">)</span>&nbsp;<span class="ident" id="4129912">File</span><span class="op" id="4129916">(</span><span class="op" id="4129917">)</span>&nbsp;<span class="op" id="4129919">(</span><span class="ident" id="4129920">f</span>&nbsp;<span class="op" id="4129922">*</span><span class="ident" id="4129923">os</span><span class="op" id="4129925">.</span><span class="ident" id="4129926">File</span><span class="op" id="4129930">,</span>&nbsp;<span class="ident" id="4129932">err</span>&nbsp;<span class="builtintype" id="4129936">error</span><span class="op" id="4129941">)</span>&nbsp;<span class="op" id="4129943">{</span>&nbsp;<span class="keyword" id="4129945">return</span>&nbsp;<span class="ident" id="4129952">c</span><span class="op" id="4129953">.</span><span class="ident" id="4129954">fd</span><span class="op" id="4129956">.</span><span class="ident" id="4129957">dup</span><span class="op" id="4129960">(</span><span class="op" id="4129961">)</span>&nbsp;<span class="op" id="4129963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4129966">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4130006">type</span>&nbsp;<span class="ident" id="4130011">Error</span>&nbsp;<span class="keyword" id="4130017">interface</span>&nbsp;<span class="op" id="4130027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4130030">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130037">Timeout</span><span class="op" id="4130044">(</span><span class="op" id="4130045">)</span>&nbsp;<span class="builtintype" id="4130047">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4130054">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130082">Temporary</span><span class="op" id="4130091">(</span><span class="op" id="4130092">)</span>&nbsp;<span class="builtintype" id="4130094">bool</span>&nbsp;<span class="comment" id="4130099">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="4130126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4130129">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="4130192">//</span><br>
<span class="lineno"></span><span class="comment" id="4130195">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="4130269">type</span>&nbsp;<span class="ident" id="4130274">PacketConn</span>&nbsp;<span class="keyword" id="4130285">interface</span>&nbsp;<span class="op" id="4130295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130298">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130347">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130405">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130457">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130480">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130528">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130590">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130631">ReadFrom</span><span class="op" id="4130639">(</span><span class="ident" id="4130640">b</span>&nbsp;<span class="op" id="4130642">[</span><span class="op" id="4130643">]</span><span class="builtintype" id="4130644">byte</span><span class="op" id="4130648">)</span>&nbsp;<span class="op" id="4130650">(</span><span class="ident" id="4130651">n</span>&nbsp;<span class="builtintype" id="4130653">int</span><span class="op" id="4130656">,</span>&nbsp;<span class="ident" id="4130658">addr</span>&nbsp;<span class="ident" id="4130663">Addr</span><span class="op" id="4130667">,</span>&nbsp;<span class="ident" id="4130669">err</span>&nbsp;<span class="builtintype" id="4130673">error</span><span class="op" id="4130678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130682">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130734">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130781">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130843">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130885">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130946">WriteTo</span><span class="op" id="4130953">(</span><span class="ident" id="4130954">b</span>&nbsp;<span class="op" id="4130956">[</span><span class="op" id="4130957">]</span><span class="builtintype" id="4130958">byte</span><span class="op" id="4130962">,</span>&nbsp;<span class="ident" id="4130964">addr</span>&nbsp;<span class="ident" id="4130969">Addr</span><span class="op" id="4130973">)</span>&nbsp;<span class="op" id="4130975">(</span><span class="ident" id="4130976">n</span>&nbsp;<span class="builtintype" id="4130978">int</span><span class="op" id="4130981">,</span>&nbsp;<span class="ident" id="4130983">err</span>&nbsp;<span class="builtintype" id="4130987">error</span><span class="op" id="4130992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4130996">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131029">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131113">Close</span><span class="op" id="4131118">(</span><span class="op" id="4131119">)</span>&nbsp;<span class="builtintype" id="4131121">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131129">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131178">LocalAddr</span><span class="op" id="4131187">(</span><span class="op" id="4131188">)</span>&nbsp;<span class="ident" id="4131190">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131197">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131258">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131283">SetDeadline</span><span class="op" id="4131294">(</span><span class="ident" id="4131295">t</span>&nbsp;<span class="ident" id="4131297">time</span><span class="op" id="4131301">.</span><span class="ident" id="4131302">Time</span><span class="op" id="4131306">)</span>&nbsp;<span class="builtintype" id="4131308">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131316">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131377">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131439">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131481">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131534">SetReadDeadline</span><span class="op" id="4131549">(</span><span class="ident" id="4131550">t</span>&nbsp;<span class="ident" id="4131552">time</span><span class="op" id="4131556">.</span><span class="ident" id="4131557">Time</span><span class="op" id="4131561">)</span>&nbsp;<span class="builtintype" id="4131563">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131571">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131634">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131697">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131739">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131793">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131859">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131906">SetWriteDeadline</span><span class="op" id="4131922">(</span><span class="ident" id="4131923">t</span>&nbsp;<span class="ident" id="4131925">time</span><span class="op" id="4131929">.</span><span class="ident" id="4131930">Time</span><span class="op" id="4131934">)</span>&nbsp;<span class="builtintype" id="4131936">error</span><br>
<span class="lineno"></span><span class="op" id="4131942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="4131945">var</span>&nbsp;<span class="ident" id="4131949">listenerBacklog</span>&nbsp;<span class="op" id="4131965">=</span>&nbsp;<span class="ident" id="4131967">maxListenerBacklog</span><span class="op" id="4131985">(</span><span class="op" id="4131986">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4131989">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="4132064">//</span><br>
<span class="lineno"></span><span class="comment" id="4132067">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="4132139">type</span>&nbsp;<span class="ident" id="4132144">Listener</span>&nbsp;<span class="keyword" id="4132153">interface</span>&nbsp;<span class="op" id="4132163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132166">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132236">Accept</span><span class="op" id="4132242">(</span><span class="op" id="4132243">)</span>&nbsp;<span class="op" id="4132245">(</span><span class="ident" id="4132246">c</span>&nbsp;<span class="ident" id="4132248">Conn</span><span class="op" id="4132252">,</span>&nbsp;<span class="ident" id="4132254">err</span>&nbsp;<span class="builtintype" id="4132258">error</span><span class="op" id="4132263">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132267">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132298">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132369">Close</span><span class="op" id="4132374">(</span><span class="op" id="4132375">)</span>&nbsp;<span class="builtintype" id="4132377">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132385">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132434">Addr</span><span class="op" id="4132438">(</span><span class="op" id="4132439">)</span>&nbsp;<span class="ident" id="4132441">Addr</span><br>
<span class="lineno">275</span><span class="op" id="4132446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4132449">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="4132489">var</span>&nbsp;<span class="op" id="4132493">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132496">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132543">errMissingAddress</span>&nbsp;<span class="op" id="4132561">=</span>&nbsp;<span class="ident" id="4132563">errors</span><span class="op" id="4132569">.</span><span class="ident" id="4132570">New</span><span class="op" id="4132573">(</span><span class="string" id="4132574">&#34;missing&nbsp;address&#34;</span><span class="op" id="4132591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4132595">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132635">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4132655">error</span>&nbsp;<span class="op" id="4132661">=</span>&nbsp;<span class="op" id="4132663">&amp;</span><span class="ident" id="4132664">timeoutError</span><span class="op" id="4132676">{</span><span class="op" id="4132677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132680">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4132706">=</span>&nbsp;<span class="ident" id="4132708">errors</span><span class="op" id="4132714">.</span><span class="ident" id="4132715">New</span><span class="op" id="4132718">(</span><span class="string" id="4132719">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="4132753">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132756">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4132782">=</span>&nbsp;<span class="ident" id="4132784">errors</span><span class="op" id="4132790">.</span><span class="ident" id="4132791">New</span><span class="op" id="4132794">(</span><span class="string" id="4132795">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="4132841">)</span><br>
<span class="lineno"></span><span class="op" id="4132843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4132846">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="4132916">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="4132985">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4132998">type</span>&nbsp;<span class="ident" id="4133003">OpError</span>&nbsp;<span class="keyword" id="4133011">struct</span>&nbsp;<span class="op" id="4133018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133021">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133077">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133100">Op</span>&nbsp;<span class="builtintype" id="4133103">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133112">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133170">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133199">Net</span>&nbsp;<span class="builtintype" id="4133203">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133212">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133274">Addr</span>&nbsp;<span class="ident" id="4133279">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4133286">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133343">Err</span>&nbsp;<span class="builtintype" id="4133347">error</span><br>
<span class="lineno">305</span><span class="op" id="4133353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133356">func</span>&nbsp;<span class="op" id="4133361">(</span><span class="ident" id="4133362">e</span>&nbsp;<span class="op" id="4133364">*</span><span class="ident" id="4133365">OpError</span><span class="op" id="4133372">)</span>&nbsp;<span class="ident" id="4133374">Error</span><span class="op" id="4133379">(</span><span class="op" id="4133380">)</span>&nbsp;<span class="builtintype" id="4133382">string</span>&nbsp;<span class="op" id="4133389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133392">if</span>&nbsp;<span class="ident" id="4133395">e</span>&nbsp;<span class="op" id="4133397">==</span>&nbsp;<span class="ident" id="4133400">nil</span>&nbsp;<span class="op" id="4133404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133408">return</span>&nbsp;<span class="string" id="4133415">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133427">s</span>&nbsp;<span class="op" id="4133429">:=</span>&nbsp;<span class="ident" id="4133432">e</span><span class="op" id="4133433">.</span><span class="ident" id="4133434">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133438">if</span>&nbsp;<span class="ident" id="4133441">e</span><span class="op" id="4133442">.</span><span class="ident" id="4133443">Net</span>&nbsp;<span class="op" id="4133447">!=</span>&nbsp;<span class="string" id="4133450">&#34;&#34;</span>&nbsp;<span class="op" id="4133453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133457">s</span>&nbsp;<span class="op" id="4133459">+=</span>&nbsp;<span class="string" id="4133462">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4133466">+</span>&nbsp;<span class="ident" id="4133468">e</span><span class="op" id="4133469">.</span><span class="ident" id="4133470">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133475">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133478">if</span>&nbsp;<span class="ident" id="4133481">e</span><span class="op" id="4133482">.</span><span class="ident" id="4133483">Addr</span>&nbsp;<span class="op" id="4133488">!=</span>&nbsp;<span class="ident" id="4133491">nil</span>&nbsp;<span class="op" id="4133495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133499">s</span>&nbsp;<span class="op" id="4133501">+=</span>&nbsp;<span class="string" id="4133504">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4133508">+</span>&nbsp;<span class="ident" id="4133510">e</span><span class="op" id="4133511">.</span><span class="ident" id="4133512">Addr</span><span class="op" id="4133516">.</span><span class="ident" id="4133517">String</span><span class="op" id="4133523">(</span><span class="op" id="4133524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133530">s</span>&nbsp;<span class="op" id="4133532">+=</span>&nbsp;<span class="string" id="4133535">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4133540">+</span>&nbsp;<span class="ident" id="4133542">e</span><span class="op" id="4133543">.</span><span class="ident" id="4133544">Err</span><span class="op" id="4133547">.</span><span class="ident" id="4133548">Error</span><span class="op" id="4133553">(</span><span class="op" id="4133554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133557">return</span>&nbsp;<span class="ident" id="4133564">s</span><br>
<span class="lineno">320</span><span class="op" id="4133566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133569">type</span>&nbsp;<span class="ident" id="4133574">temporary</span>&nbsp;<span class="keyword" id="4133584">interface</span>&nbsp;<span class="op" id="4133594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133597">Temporary</span><span class="op" id="4133606">(</span><span class="op" id="4133607">)</span>&nbsp;<span class="builtintype" id="4133609">bool</span><br>
<span class="lineno"></span><span class="op" id="4133614">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4133617">func</span>&nbsp;<span class="op" id="4133622">(</span><span class="ident" id="4133623">e</span>&nbsp;<span class="op" id="4133625">*</span><span class="ident" id="4133626">OpError</span><span class="op" id="4133633">)</span>&nbsp;<span class="ident" id="4133635">Temporary</span><span class="op" id="4133644">(</span><span class="op" id="4133645">)</span>&nbsp;<span class="builtintype" id="4133647">bool</span>&nbsp;<span class="op" id="4133652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133655">t</span><span class="op" id="4133656">,</span>&nbsp;<span class="ident" id="4133658">ok</span>&nbsp;<span class="op" id="4133661">:=</span>&nbsp;<span class="ident" id="4133664">e</span><span class="op" id="4133665">.</span><span class="ident" id="4133666">Err</span><span class="op" id="4133669">.</span><span class="op" id="4133670">(</span><span class="ident" id="4133671">temporary</span><span class="op" id="4133680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133683">return</span>&nbsp;<span class="ident" id="4133690">ok</span>&nbsp;<span class="op" id="4133693">&amp;&amp;</span>&nbsp;<span class="ident" id="4133696">t</span><span class="op" id="4133697">.</span><span class="ident" id="4133698">Temporary</span><span class="op" id="4133707">(</span><span class="op" id="4133708">)</span><br>
<span class="lineno"></span><span class="op" id="4133710">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="4133713">var</span>&nbsp;<span class="ident" id="4133717">noDeadline</span>&nbsp;<span class="op" id="4133728">=</span>&nbsp;<span class="ident" id="4133730">time</span><span class="op" id="4133734">.</span><span class="ident" id="4133735">Time</span><span class="op" id="4133739">{</span><span class="op" id="4133740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133743">type</span>&nbsp;<span class="ident" id="4133748">timeout</span>&nbsp;<span class="keyword" id="4133756">interface</span>&nbsp;<span class="op" id="4133766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133769">Timeout</span><span class="op" id="4133776">(</span><span class="op" id="4133777">)</span>&nbsp;<span class="builtintype" id="4133779">bool</span><br>
<span class="lineno">335</span><span class="op" id="4133784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133787">func</span>&nbsp;<span class="op" id="4133792">(</span><span class="ident" id="4133793">e</span>&nbsp;<span class="op" id="4133795">*</span><span class="ident" id="4133796">OpError</span><span class="op" id="4133803">)</span>&nbsp;<span class="ident" id="4133805">Timeout</span><span class="op" id="4133812">(</span><span class="op" id="4133813">)</span>&nbsp;<span class="builtintype" id="4133815">bool</span>&nbsp;<span class="op" id="4133820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133823">t</span><span class="op" id="4133824">,</span>&nbsp;<span class="ident" id="4133826">ok</span>&nbsp;<span class="op" id="4133829">:=</span>&nbsp;<span class="ident" id="4133832">e</span><span class="op" id="4133833">.</span><span class="ident" id="4133834">Err</span><span class="op" id="4133837">.</span><span class="op" id="4133838">(</span><span class="ident" id="4133839">timeout</span><span class="op" id="4133846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133849">return</span>&nbsp;<span class="ident" id="4133856">ok</span>&nbsp;<span class="op" id="4133859">&amp;&amp;</span>&nbsp;<span class="ident" id="4133862">t</span><span class="op" id="4133863">.</span><span class="ident" id="4133864">Timeout</span><span class="op" id="4133871">(</span><span class="op" id="4133872">)</span><br>
<span class="lineno">340</span><span class="op" id="4133874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133877">type</span>&nbsp;<span class="ident" id="4133882">timeoutError</span>&nbsp;<span class="keyword" id="4133895">struct</span><span class="op" id="4133901">{</span><span class="op" id="4133902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133905">func</span>&nbsp;<span class="op" id="4133910">(</span><span class="ident" id="4133911">e</span>&nbsp;<span class="op" id="4133913">*</span><span class="ident" id="4133914">timeoutError</span><span class="op" id="4133926">)</span>&nbsp;<span class="ident" id="4133928">Error</span><span class="op" id="4133933">(</span><span class="op" id="4133934">)</span>&nbsp;<span class="builtintype" id="4133936">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4133945">{</span>&nbsp;<span class="keyword" id="4133947">return</span>&nbsp;<span class="string" id="4133954">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="4133968">}</span><br>
<span class="lineno">345</span><span class="keyword" id="4133970">func</span>&nbsp;<span class="op" id="4133975">(</span><span class="ident" id="4133976">e</span>&nbsp;<span class="op" id="4133978">*</span><span class="ident" id="4133979">timeoutError</span><span class="op" id="4133991">)</span>&nbsp;<span class="ident" id="4133993">Timeout</span><span class="op" id="4134000">(</span><span class="op" id="4134001">)</span>&nbsp;<span class="builtintype" id="4134003">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4134010">{</span>&nbsp;<span class="keyword" id="4134012">return</span>&nbsp;<span class="builtintype" id="4134019">true</span>&nbsp;<span class="op" id="4134024">}</span><br>
<span class="lineno"></span><span class="keyword" id="4134026">func</span>&nbsp;<span class="op" id="4134031">(</span><span class="ident" id="4134032">e</span>&nbsp;<span class="op" id="4134034">*</span><span class="ident" id="4134035">timeoutError</span><span class="op" id="4134047">)</span>&nbsp;<span class="ident" id="4134049">Temporary</span><span class="op" id="4134058">(</span><span class="op" id="4134059">)</span>&nbsp;<span class="builtintype" id="4134061">bool</span>&nbsp;<span class="op" id="4134066">{</span>&nbsp;<span class="keyword" id="4134068">return</span>&nbsp;<span class="builtintype" id="4134075">true</span>&nbsp;<span class="op" id="4134080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134083">type</span>&nbsp;<span class="ident" id="4134088">AddrError</span>&nbsp;<span class="keyword" id="4134098">struct</span>&nbsp;<span class="op" id="4134105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134108">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4134113">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134121">Addr</span>&nbsp;<span class="builtintype" id="4134126">string</span><br>
<span class="lineno"></span><span class="op" id="4134133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134136">func</span>&nbsp;<span class="op" id="4134141">(</span><span class="ident" id="4134142">e</span>&nbsp;<span class="op" id="4134144">*</span><span class="ident" id="4134145">AddrError</span><span class="op" id="4134154">)</span>&nbsp;<span class="ident" id="4134156">Error</span><span class="op" id="4134161">(</span><span class="op" id="4134162">)</span>&nbsp;<span class="builtintype" id="4134164">string</span>&nbsp;<span class="op" id="4134171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134174">if</span>&nbsp;<span class="ident" id="4134177">e</span>&nbsp;<span class="op" id="4134179">==</span>&nbsp;<span class="ident" id="4134182">nil</span>&nbsp;<span class="op" id="4134186">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134190">return</span>&nbsp;<span class="string" id="4134197">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134209">s</span>&nbsp;<span class="op" id="4134211">:=</span>&nbsp;<span class="ident" id="4134214">e</span><span class="op" id="4134215">.</span><span class="ident" id="4134216">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134221">if</span>&nbsp;<span class="ident" id="4134224">e</span><span class="op" id="4134225">.</span><span class="ident" id="4134226">Addr</span>&nbsp;<span class="op" id="4134231">!=</span>&nbsp;<span class="string" id="4134234">&#34;&#34;</span>&nbsp;<span class="op" id="4134237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134241">s</span>&nbsp;<span class="op" id="4134243">+=</span>&nbsp;<span class="string" id="4134246">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4134250">+</span>&nbsp;<span class="ident" id="4134252">e</span><span class="op" id="4134253">.</span><span class="ident" id="4134254">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134263">return</span>&nbsp;<span class="ident" id="4134270">s</span><br>
<span class="lineno"></span><span class="op" id="4134272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134275">func</span>&nbsp;<span class="op" id="4134280">(</span><span class="ident" id="4134281">e</span>&nbsp;<span class="op" id="4134283">*</span><span class="ident" id="4134284">AddrError</span><span class="op" id="4134293">)</span>&nbsp;<span class="ident" id="4134295">Temporary</span><span class="op" id="4134304">(</span><span class="op" id="4134305">)</span>&nbsp;<span class="builtintype" id="4134307">bool</span>&nbsp;<span class="op" id="4134312">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134315">return</span>&nbsp;<span class="builtintype" id="4134322">false</span><br>
<span class="lineno"></span><span class="op" id="4134328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134331">func</span>&nbsp;<span class="op" id="4134336">(</span><span class="ident" id="4134337">e</span>&nbsp;<span class="op" id="4134339">*</span><span class="ident" id="4134340">AddrError</span><span class="op" id="4134349">)</span>&nbsp;<span class="ident" id="4134351">Timeout</span><span class="op" id="4134358">(</span><span class="op" id="4134359">)</span>&nbsp;<span class="builtintype" id="4134361">bool</span>&nbsp;<span class="op" id="4134366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134369">return</span>&nbsp;<span class="builtintype" id="4134376">false</span><br>
<span class="lineno">370</span><span class="op" id="4134382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134385">type</span>&nbsp;<span class="ident" id="4134390">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="4134410">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134418">func</span>&nbsp;<span class="op" id="4134423">(</span><span class="ident" id="4134424">e</span>&nbsp;<span class="ident" id="4134426">UnknownNetworkError</span><span class="op" id="4134445">)</span>&nbsp;<span class="ident" id="4134447">Error</span><span class="op" id="4134452">(</span><span class="op" id="4134453">)</span>&nbsp;<span class="builtintype" id="4134455">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4134464">{</span>&nbsp;<span class="keyword" id="4134466">return</span>&nbsp;<span class="string" id="4134473">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="4134492">+</span>&nbsp;<span class="builtintype" id="4134494">string</span><span class="op" id="4134500">(</span><span class="ident" id="4134501">e</span><span class="op" id="4134502">)</span>&nbsp;<span class="op" id="4134504">}</span><br>
<span class="lineno">375</span><span class="keyword" id="4134506">func</span>&nbsp;<span class="op" id="4134511">(</span><span class="ident" id="4134512">e</span>&nbsp;<span class="ident" id="4134514">UnknownNetworkError</span><span class="op" id="4134533">)</span>&nbsp;<span class="ident" id="4134535">Temporary</span><span class="op" id="4134544">(</span><span class="op" id="4134545">)</span>&nbsp;<span class="builtintype" id="4134547">bool</span>&nbsp;<span class="op" id="4134552">{</span>&nbsp;<span class="keyword" id="4134554">return</span>&nbsp;<span class="builtintype" id="4134561">false</span>&nbsp;<span class="op" id="4134567">}</span><br>
<span class="lineno"></span><span class="keyword" id="4134569">func</span>&nbsp;<span class="op" id="4134574">(</span><span class="ident" id="4134575">e</span>&nbsp;<span class="ident" id="4134577">UnknownNetworkError</span><span class="op" id="4134596">)</span>&nbsp;<span class="ident" id="4134598">Timeout</span><span class="op" id="4134605">(</span><span class="op" id="4134606">)</span>&nbsp;<span class="builtintype" id="4134608">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4134615">{</span>&nbsp;<span class="keyword" id="4134617">return</span>&nbsp;<span class="builtintype" id="4134624">false</span>&nbsp;<span class="op" id="4134630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134633">type</span>&nbsp;<span class="ident" id="4134638">InvalidAddrError</span>&nbsp;<span class="builtintype" id="4134655">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="4134663">func</span>&nbsp;<span class="op" id="4134668">(</span><span class="ident" id="4134669">e</span>&nbsp;<span class="ident" id="4134671">InvalidAddrError</span><span class="op" id="4134687">)</span>&nbsp;<span class="ident" id="4134689">Error</span><span class="op" id="4134694">(</span><span class="op" id="4134695">)</span>&nbsp;<span class="builtintype" id="4134697">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4134706">{</span>&nbsp;<span class="keyword" id="4134708">return</span>&nbsp;<span class="builtintype" id="4134715">string</span><span class="op" id="4134721">(</span><span class="ident" id="4134722">e</span><span class="op" id="4134723">)</span>&nbsp;<span class="op" id="4134725">}</span><br>
<span class="lineno"></span><span class="keyword" id="4134727">func</span>&nbsp;<span class="op" id="4134732">(</span><span class="ident" id="4134733">e</span>&nbsp;<span class="ident" id="4134735">InvalidAddrError</span><span class="op" id="4134751">)</span>&nbsp;<span class="ident" id="4134753">Timeout</span><span class="op" id="4134760">(</span><span class="op" id="4134761">)</span>&nbsp;<span class="builtintype" id="4134763">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4134770">{</span>&nbsp;<span class="keyword" id="4134772">return</span>&nbsp;<span class="builtintype" id="4134779">false</span>&nbsp;<span class="op" id="4134785">}</span><br>
<span class="lineno"></span><span class="keyword" id="4134787">func</span>&nbsp;<span class="op" id="4134792">(</span><span class="ident" id="4134793">e</span>&nbsp;<span class="ident" id="4134795">InvalidAddrError</span><span class="op" id="4134811">)</span>&nbsp;<span class="ident" id="4134813">Temporary</span><span class="op" id="4134822">(</span><span class="op" id="4134823">)</span>&nbsp;<span class="builtintype" id="4134825">bool</span>&nbsp;<span class="op" id="4134830">{</span>&nbsp;<span class="keyword" id="4134832">return</span>&nbsp;<span class="builtintype" id="4134839">false</span>&nbsp;<span class="op" id="4134845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4134848">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="4134927">type</span>&nbsp;<span class="ident" id="4134932">DNSConfigError</span>&nbsp;<span class="keyword" id="4134947">struct</span>&nbsp;<span class="op" id="4134954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134957">Err</span>&nbsp;<span class="builtintype" id="4134961">error</span><br>
<span class="lineno"></span><span class="op" id="4134967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4134970">func</span>&nbsp;<span class="op" id="4134975">(</span><span class="ident" id="4134976">e</span>&nbsp;<span class="op" id="4134978">*</span><span class="ident" id="4134979">DNSConfigError</span><span class="op" id="4134993">)</span>&nbsp;<span class="ident" id="4134995">Error</span><span class="op" id="4135000">(</span><span class="op" id="4135001">)</span>&nbsp;<span class="builtintype" id="4135003">string</span>&nbsp;<span class="op" id="4135010">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135013">return</span>&nbsp;<span class="string" id="4135020">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="4135049">+</span>&nbsp;<span class="ident" id="4135051">e</span><span class="op" id="4135052">.</span><span class="ident" id="4135053">Err</span><span class="op" id="4135056">.</span><span class="ident" id="4135057">Error</span><span class="op" id="4135062">(</span><span class="op" id="4135063">)</span><br>
<span class="lineno"></span><span class="op" id="4135065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4135068">func</span>&nbsp;<span class="op" id="4135073">(</span><span class="ident" id="4135074">e</span>&nbsp;<span class="op" id="4135076">*</span><span class="ident" id="4135077">DNSConfigError</span><span class="op" id="4135091">)</span>&nbsp;<span class="ident" id="4135093">Timeout</span><span class="op" id="4135100">(</span><span class="op" id="4135101">)</span>&nbsp;<span class="builtintype" id="4135103">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4135110">{</span>&nbsp;<span class="keyword" id="4135112">return</span>&nbsp;<span class="builtintype" id="4135119">false</span>&nbsp;<span class="op" id="4135125">}</span><br>
<span class="lineno"></span><span class="keyword" id="4135127">func</span>&nbsp;<span class="op" id="4135132">(</span><span class="ident" id="4135133">e</span>&nbsp;<span class="op" id="4135135">*</span><span class="ident" id="4135136">DNSConfigError</span><span class="op" id="4135150">)</span>&nbsp;<span class="ident" id="4135152">Temporary</span><span class="op" id="4135161">(</span><span class="op" id="4135162">)</span>&nbsp;<span class="builtintype" id="4135164">bool</span>&nbsp;<span class="op" id="4135169">{</span>&nbsp;<span class="keyword" id="4135171">return</span>&nbsp;<span class="builtintype" id="4135178">false</span>&nbsp;<span class="op" id="4135184">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="4135187">type</span>&nbsp;<span class="ident" id="4135192">writerOnly</span>&nbsp;<span class="keyword" id="4135203">struct</span>&nbsp;<span class="op" id="4135210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135213">io</span><span class="op" id="4135215">.</span><span class="ident" id="4135216">Writer</span><br>
<span class="lineno"></span><span class="op" id="4135223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="4135226">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="4135302">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="4135317">func</span>&nbsp;<span class="ident" id="4135322">genericReadFrom</span><span class="op" id="4135337">(</span><span class="ident" id="4135338">w</span>&nbsp;<span class="ident" id="4135340">io</span><span class="op" id="4135342">.</span><span class="ident" id="4135343">Writer</span><span class="op" id="4135349">,</span>&nbsp;<span class="ident" id="4135351">r</span>&nbsp;<span class="ident" id="4135353">io</span><span class="op" id="4135355">.</span><span class="ident" id="4135356">Reader</span><span class="op" id="4135362">)</span>&nbsp;<span class="op" id="4135364">(</span><span class="ident" id="4135365">n</span>&nbsp;<span class="ident" id="4135367">int64</span><span class="op" id="4135372">,</span>&nbsp;<span class="ident" id="4135374">err</span>&nbsp;<span class="builtintype" id="4135378">error</span><span class="op" id="4135383">)</span>&nbsp;<span class="op" id="4135385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4135388">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4135446">return</span>&nbsp;<span class="ident" id="4135453">io</span><span class="op" id="4135455">.</span><span class="ident" id="4135456">Copy</span><span class="op" id="4135460">(</span><span class="ident" id="4135461">writerOnly</span><span class="op" id="4135471">{</span><span class="ident" id="4135472">w</span><span class="op" id="4135473">}</span><span class="op" id="4135474">,</span>&nbsp;<span class="ident" id="4135476">r</span><span class="op" id="4135477">)</span><br>
<span class="lineno">405</span><span class="op" id="4135479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4135482">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="4135546">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="4135618">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="4135684">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="4135756">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4135819">var</span>&nbsp;<span class="ident" id="4135823">threadLimit</span>&nbsp;<span class="op" id="4135835">=</span>&nbsp;<span class="builtinfunc" id="4135837">make</span><span class="op" id="4135841">(</span><span class="keyword" id="4135842">chan</span>&nbsp;<span class="keyword" id="4135847">struct</span><span class="op" id="4135853">{</span><span class="op" id="4135854">}</span><span class="op" id="4135855">,</span>&nbsp;<span class="num" id="4135857">500</span><span class="op" id="4135860">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="4135863">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4135932">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="4136004">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4136032">func</span>&nbsp;<span class="ident" id="4136037">acquireThread</span><span class="op" id="4136050">(</span><span class="op" id="4136051">)</span>&nbsp;<span class="op" id="4136053">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136056">threadLimit</span>&nbsp;<span class="op" id="4136068">&lt;-</span>&nbsp;<span class="keyword" id="4136071">struct</span><span class="op" id="4136077">{</span><span class="op" id="4136078">}</span><span class="op" id="4136079">{</span><span class="op" id="4136080">}</span><br>
<span class="lineno"></span><span class="op" id="4136082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4136085">func</span>&nbsp;<span class="ident" id="4136090">releaseThread</span><span class="op" id="4136103">(</span><span class="op" id="4136104">)</span>&nbsp;<span class="op" id="4136106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136109">&lt;-</span><span class="ident" id="4136111">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="4136123">}</span>
</div>
</body>
</html>
