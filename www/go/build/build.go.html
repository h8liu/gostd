<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6158513">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6158569">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6158623">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6158674">package</span>&nbsp;<span class="ident" id="6158682">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6158689">import</span>&nbsp;<span class="op" id="6158696">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158699">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158708">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158718">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158725">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158735">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158745">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158758">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158770">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158776">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158789">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158796">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158802">pathpkg</span>&nbsp;<span class="string" id="6158810">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158818">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158835">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158846">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158854">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158865">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158876">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6158887">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6158902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6158905">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="6158964">type</span>&nbsp;<span class="ident" id="6158969">Context</span>&nbsp;<span class="keyword" id="6158977">struct</span>&nbsp;<span class="op" id="6158984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6158987">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6158999">string</span>&nbsp;<span class="comment" id="6159006">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159030">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6159042">string</span>&nbsp;<span class="comment" id="6159049">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159077">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6159089">string</span>&nbsp;<span class="comment" id="6159096">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159108">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6159120">string</span>&nbsp;<span class="comment" id="6159127">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159139">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="6159151">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6159158">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159186">UseAllFiles</span>&nbsp;<span class="builtintype" id="6159198">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6159205">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159258">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6159270">string</span>&nbsp;<span class="comment" id="6159277">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159329">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159386">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159456">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159522">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159598">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159684">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159752">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159814">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6159826">[</span><span class="op" id="6159827">]</span><span class="builtintype" id="6159828">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6159836">ReleaseTags</span>&nbsp;<span class="op" id="6159848">[</span><span class="op" id="6159849">]</span><span class="builtintype" id="6159850">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159859">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6159940">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160015">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160092">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160168">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160242">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160297">InstallSuffix</span>&nbsp;<span class="builtintype" id="6160311">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160320">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160389">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160453">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160521">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160592">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160648">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160718">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160769">JoinPath</span>&nbsp;<span class="keyword" id="6160778">func</span><span class="op" id="6160782">(</span><span class="ident" id="6160783">elem</span>&nbsp;<span class="op" id="6160788">...</span><span class="builtintype" id="6160791">string</span><span class="op" id="6160797">)</span>&nbsp;<span class="builtintype" id="6160799">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160808">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160881">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6160942">SplitPathList</span>&nbsp;<span class="keyword" id="6160956">func</span><span class="op" id="6160960">(</span><span class="ident" id="6160961">list</span>&nbsp;<span class="builtintype" id="6160966">string</span><span class="op" id="6160972">)</span>&nbsp;<span class="op" id="6160974">[</span><span class="op" id="6160975">]</span><span class="builtintype" id="6160976">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6160985">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161041">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161094">IsAbsPath</span>&nbsp;<span class="keyword" id="6161104">func</span><span class="op" id="6161108">(</span><span class="ident" id="6161109">path</span>&nbsp;<span class="builtintype" id="6161114">string</span><span class="op" id="6161120">)</span>&nbsp;<span class="builtintype" id="6161122">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161129">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161183">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161261">IsDir</span>&nbsp;<span class="keyword" id="6161267">func</span><span class="op" id="6161271">(</span><span class="ident" id="6161272">path</span>&nbsp;<span class="builtintype" id="6161277">string</span><span class="op" id="6161283">)</span>&nbsp;<span class="builtintype" id="6161285">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161292">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161347">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161389">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161450">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161513">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161577">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161604">HasSubdir</span>&nbsp;<span class="keyword" id="6161614">func</span><span class="op" id="6161618">(</span><span class="ident" id="6161619">root</span><span class="op" id="6161623">,</span>&nbsp;<span class="ident" id="6161625">dir</span>&nbsp;<span class="builtintype" id="6161629">string</span><span class="op" id="6161635">)</span>&nbsp;<span class="op" id="6161637">(</span><span class="ident" id="6161638">rel</span>&nbsp;<span class="builtintype" id="6161642">string</span><span class="op" id="6161648">,</span>&nbsp;<span class="ident" id="6161650">ok</span>&nbsp;<span class="builtintype" id="6161653">bool</span><span class="op" id="6161657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161661">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161721">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161772">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161823">ReadDir</span>&nbsp;<span class="keyword" id="6161831">func</span><span class="op" id="6161835">(</span><span class="ident" id="6161836">dir</span>&nbsp;<span class="builtintype" id="6161840">string</span><span class="op" id="6161846">)</span>&nbsp;<span class="op" id="6161848">(</span><span class="ident" id="6161849">fi</span>&nbsp;<span class="op" id="6161852">[</span><span class="op" id="6161853">]</span><span class="ident" id="6161854">os</span><span class="op" id="6161856">.</span><span class="ident" id="6161857">FileInfo</span><span class="op" id="6161865">,</span>&nbsp;<span class="ident" id="6161867">err</span>&nbsp;<span class="builtintype" id="6161871">error</span><span class="op" id="6161876">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161880">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6161937">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6161982">OpenFile</span>&nbsp;<span class="keyword" id="6161991">func</span><span class="op" id="6161995">(</span><span class="ident" id="6161996">path</span>&nbsp;<span class="builtintype" id="6162001">string</span><span class="op" id="6162007">)</span>&nbsp;<span class="op" id="6162009">(</span><span class="ident" id="6162010">r</span>&nbsp;<span class="ident" id="6162012">io</span><span class="op" id="6162014">.</span><span class="ident" id="6162015">ReadCloser</span><span class="op" id="6162025">,</span>&nbsp;<span class="ident" id="6162027">err</span>&nbsp;<span class="builtintype" id="6162031">error</span><span class="op" id="6162036">)</span><br>
<span class="lineno">95</span><span class="op" id="6162038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6162041">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="6162109">func</span>&nbsp;<span class="op" id="6162114">(</span><span class="ident" id="6162115">ctxt</span>&nbsp;<span class="op" id="6162120">*</span><span class="ident" id="6162121">Context</span><span class="op" id="6162128">)</span>&nbsp;<span class="ident" id="6162130">joinPath</span><span class="op" id="6162138">(</span><span class="ident" id="6162139">elem</span>&nbsp;<span class="op" id="6162144">...</span><span class="builtintype" id="6162147">string</span><span class="op" id="6162153">)</span>&nbsp;<span class="builtintype" id="6162155">string</span>&nbsp;<span class="op" id="6162162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162165">if</span>&nbsp;<span class="ident" id="6162168">f</span>&nbsp;<span class="op" id="6162170">:=</span>&nbsp;<span class="ident" id="6162173">ctxt</span><span class="op" id="6162177">.</span><span class="ident" id="6162178">JoinPath</span><span class="op" id="6162186">;</span>&nbsp;<span class="ident" id="6162188">f</span>&nbsp;<span class="op" id="6162190">!=</span>&nbsp;<span class="ident" id="6162193">nil</span>&nbsp;<span class="op" id="6162197">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162201">return</span>&nbsp;<span class="ident" id="6162208">f</span><span class="op" id="6162209">(</span><span class="ident" id="6162210">elem</span><span class="op" id="6162214">...</span><span class="op" id="6162217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162223">return</span>&nbsp;<span class="ident" id="6162230">filepath</span><span class="op" id="6162238">.</span><span class="ident" id="6162239">Join</span><span class="op" id="6162243">(</span><span class="ident" id="6162244">elem</span><span class="op" id="6162248">...</span><span class="op" id="6162251">)</span><br>
<span class="lineno"></span><span class="op" id="6162253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6162256">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="6162339">func</span>&nbsp;<span class="op" id="6162344">(</span><span class="ident" id="6162345">ctxt</span>&nbsp;<span class="op" id="6162350">*</span><span class="ident" id="6162351">Context</span><span class="op" id="6162358">)</span>&nbsp;<span class="ident" id="6162360">splitPathList</span><span class="op" id="6162373">(</span><span class="ident" id="6162374">s</span>&nbsp;<span class="builtintype" id="6162376">string</span><span class="op" id="6162382">)</span>&nbsp;<span class="op" id="6162384">[</span><span class="op" id="6162385">]</span><span class="builtintype" id="6162386">string</span>&nbsp;<span class="op" id="6162393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162396">if</span>&nbsp;<span class="ident" id="6162399">f</span>&nbsp;<span class="op" id="6162401">:=</span>&nbsp;<span class="ident" id="6162404">ctxt</span><span class="op" id="6162408">.</span><span class="ident" id="6162409">SplitPathList</span><span class="op" id="6162422">;</span>&nbsp;<span class="ident" id="6162424">f</span>&nbsp;<span class="op" id="6162426">!=</span>&nbsp;<span class="ident" id="6162429">nil</span>&nbsp;<span class="op" id="6162433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162437">return</span>&nbsp;<span class="ident" id="6162444">f</span><span class="op" id="6162445">(</span><span class="ident" id="6162446">s</span><span class="op" id="6162447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162450">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162453">return</span>&nbsp;<span class="ident" id="6162460">filepath</span><span class="op" id="6162468">.</span><span class="ident" id="6162469">SplitList</span><span class="op" id="6162478">(</span><span class="ident" id="6162479">s</span><span class="op" id="6162480">)</span><br>
<span class="lineno"></span><span class="op" id="6162482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6162485">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="6162557">func</span>&nbsp;<span class="op" id="6162562">(</span><span class="ident" id="6162563">ctxt</span>&nbsp;<span class="op" id="6162568">*</span><span class="ident" id="6162569">Context</span><span class="op" id="6162576">)</span>&nbsp;<span class="ident" id="6162578">isAbsPath</span><span class="op" id="6162587">(</span><span class="ident" id="6162588">path</span>&nbsp;<span class="builtintype" id="6162593">string</span><span class="op" id="6162599">)</span>&nbsp;<span class="builtintype" id="6162601">bool</span>&nbsp;<span class="op" id="6162606">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162609">if</span>&nbsp;<span class="ident" id="6162612">f</span>&nbsp;<span class="op" id="6162614">:=</span>&nbsp;<span class="ident" id="6162617">ctxt</span><span class="op" id="6162621">.</span><span class="ident" id="6162622">IsAbsPath</span><span class="op" id="6162631">;</span>&nbsp;<span class="ident" id="6162633">f</span>&nbsp;<span class="op" id="6162635">!=</span>&nbsp;<span class="ident" id="6162638">nil</span>&nbsp;<span class="op" id="6162642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162646">return</span>&nbsp;<span class="ident" id="6162653">f</span><span class="op" id="6162654">(</span><span class="ident" id="6162655">path</span><span class="op" id="6162659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162665">return</span>&nbsp;<span class="ident" id="6162672">filepath</span><span class="op" id="6162680">.</span><span class="ident" id="6162681">IsAbs</span><span class="op" id="6162686">(</span><span class="ident" id="6162687">path</span><span class="op" id="6162691">)</span><br>
<span class="lineno"></span><span class="op" id="6162693">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="6162696">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="6162757">func</span>&nbsp;<span class="op" id="6162762">(</span><span class="ident" id="6162763">ctxt</span>&nbsp;<span class="op" id="6162768">*</span><span class="ident" id="6162769">Context</span><span class="op" id="6162776">)</span>&nbsp;<span class="ident" id="6162778">isDir</span><span class="op" id="6162783">(</span><span class="ident" id="6162784">path</span>&nbsp;<span class="builtintype" id="6162789">string</span><span class="op" id="6162795">)</span>&nbsp;<span class="builtintype" id="6162797">bool</span>&nbsp;<span class="op" id="6162802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162805">if</span>&nbsp;<span class="ident" id="6162808">f</span>&nbsp;<span class="op" id="6162810">:=</span>&nbsp;<span class="ident" id="6162813">ctxt</span><span class="op" id="6162817">.</span><span class="ident" id="6162818">IsDir</span><span class="op" id="6162823">;</span>&nbsp;<span class="ident" id="6162825">f</span>&nbsp;<span class="op" id="6162827">!=</span>&nbsp;<span class="ident" id="6162830">nil</span>&nbsp;<span class="op" id="6162834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162838">return</span>&nbsp;<span class="ident" id="6162845">f</span><span class="op" id="6162846">(</span><span class="ident" id="6162847">path</span><span class="op" id="6162851">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6162854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6162857">fi</span><span class="op" id="6162859">,</span>&nbsp;<span class="ident" id="6162861">err</span>&nbsp;<span class="op" id="6162865">:=</span>&nbsp;<span class="ident" id="6162868">os</span><span class="op" id="6162870">.</span><span class="ident" id="6162871">Stat</span><span class="op" id="6162875">(</span><span class="ident" id="6162876">path</span><span class="op" id="6162880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6162883">return</span>&nbsp;<span class="ident" id="6162890">err</span>&nbsp;<span class="op" id="6162894">==</span>&nbsp;<span class="ident" id="6162897">nil</span>&nbsp;<span class="op" id="6162901">&amp;&amp;</span>&nbsp;<span class="ident" id="6162904">fi</span><span class="op" id="6162906">.</span><span class="ident" id="6162907">IsDir</span><span class="op" id="6162912">(</span><span class="op" id="6162913">)</span><br>
<span class="lineno"></span><span class="op" id="6162915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6162918">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="6162978">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="6163027">func</span>&nbsp;<span class="op" id="6163032">(</span><span class="ident" id="6163033">ctxt</span>&nbsp;<span class="op" id="6163038">*</span><span class="ident" id="6163039">Context</span><span class="op" id="6163046">)</span>&nbsp;<span class="ident" id="6163048">hasSubdir</span><span class="op" id="6163057">(</span><span class="ident" id="6163058">root</span><span class="op" id="6163062">,</span>&nbsp;<span class="ident" id="6163064">dir</span>&nbsp;<span class="builtintype" id="6163068">string</span><span class="op" id="6163074">)</span>&nbsp;<span class="op" id="6163076">(</span><span class="ident" id="6163077">rel</span>&nbsp;<span class="builtintype" id="6163081">string</span><span class="op" id="6163087">,</span>&nbsp;<span class="ident" id="6163089">ok</span>&nbsp;<span class="builtintype" id="6163092">bool</span><span class="op" id="6163096">)</span>&nbsp;<span class="op" id="6163098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163101">if</span>&nbsp;<span class="ident" id="6163104">f</span>&nbsp;<span class="op" id="6163106">:=</span>&nbsp;<span class="ident" id="6163109">ctxt</span><span class="op" id="6163113">.</span><span class="ident" id="6163114">HasSubdir</span><span class="op" id="6163123">;</span>&nbsp;<span class="ident" id="6163125">f</span>&nbsp;<span class="op" id="6163127">!=</span>&nbsp;<span class="ident" id="6163130">nil</span>&nbsp;<span class="op" id="6163134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163138">return</span>&nbsp;<span class="ident" id="6163145">f</span><span class="op" id="6163146">(</span><span class="ident" id="6163147">root</span><span class="op" id="6163151">,</span>&nbsp;<span class="ident" id="6163153">dir</span><span class="op" id="6163156">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163163">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163196">if</span>&nbsp;<span class="ident" id="6163199">rel</span><span class="op" id="6163202">,</span>&nbsp;<span class="ident" id="6163204">ok</span>&nbsp;<span class="op" id="6163207">=</span>&nbsp;<span class="ident" id="6163209">hasSubdir</span><span class="op" id="6163218">(</span><span class="ident" id="6163219">root</span><span class="op" id="6163223">,</span>&nbsp;<span class="ident" id="6163225">dir</span><span class="op" id="6163228">)</span><span class="op" id="6163229">;</span>&nbsp;<span class="ident" id="6163231">ok</span>&nbsp;<span class="op" id="6163234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163238">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163250">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163291">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6163327">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163358">rootSym</span><span class="op" id="6163365">,</span>&nbsp;<span class="ident" id="6163367">_</span>&nbsp;<span class="op" id="6163369">:=</span>&nbsp;<span class="ident" id="6163372">filepath</span><span class="op" id="6163380">.</span><span class="ident" id="6163381">EvalSymlinks</span><span class="op" id="6163393">(</span><span class="ident" id="6163394">root</span><span class="op" id="6163398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163401">dirSym</span><span class="op" id="6163407">,</span>&nbsp;<span class="ident" id="6163409">_</span>&nbsp;<span class="op" id="6163411">:=</span>&nbsp;<span class="ident" id="6163414">filepath</span><span class="op" id="6163422">.</span><span class="ident" id="6163423">EvalSymlinks</span><span class="op" id="6163435">(</span><span class="ident" id="6163436">dir</span><span class="op" id="6163439">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163443">if</span>&nbsp;<span class="ident" id="6163446">rel</span><span class="op" id="6163449">,</span>&nbsp;<span class="ident" id="6163451">ok</span>&nbsp;<span class="op" id="6163454">=</span>&nbsp;<span class="ident" id="6163456">hasSubdir</span><span class="op" id="6163465">(</span><span class="ident" id="6163466">rootSym</span><span class="op" id="6163473">,</span>&nbsp;<span class="ident" id="6163475">dir</span><span class="op" id="6163478">)</span><span class="op" id="6163479">;</span>&nbsp;<span class="ident" id="6163481">ok</span>&nbsp;<span class="op" id="6163484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163488">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163499">if</span>&nbsp;<span class="ident" id="6163502">rel</span><span class="op" id="6163505">,</span>&nbsp;<span class="ident" id="6163507">ok</span>&nbsp;<span class="op" id="6163510">=</span>&nbsp;<span class="ident" id="6163512">hasSubdir</span><span class="op" id="6163521">(</span><span class="ident" id="6163522">root</span><span class="op" id="6163526">,</span>&nbsp;<span class="ident" id="6163528">dirSym</span><span class="op" id="6163534">)</span><span class="op" id="6163535">;</span>&nbsp;<span class="ident" id="6163537">ok</span>&nbsp;<span class="op" id="6163540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163555">return</span>&nbsp;<span class="ident" id="6163562">hasSubdir</span><span class="op" id="6163571">(</span><span class="ident" id="6163572">rootSym</span><span class="op" id="6163579">,</span>&nbsp;<span class="ident" id="6163581">dirSym</span><span class="op" id="6163587">)</span><br>
<span class="lineno">155</span><span class="op" id="6163589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6163592">func</span>&nbsp;<span class="ident" id="6163597">hasSubdir</span><span class="op" id="6163606">(</span><span class="ident" id="6163607">root</span><span class="op" id="6163611">,</span>&nbsp;<span class="ident" id="6163613">dir</span>&nbsp;<span class="builtintype" id="6163617">string</span><span class="op" id="6163623">)</span>&nbsp;<span class="op" id="6163625">(</span><span class="ident" id="6163626">rel</span>&nbsp;<span class="builtintype" id="6163630">string</span><span class="op" id="6163636">,</span>&nbsp;<span class="ident" id="6163638">ok</span>&nbsp;<span class="builtintype" id="6163641">bool</span><span class="op" id="6163645">)</span>&nbsp;<span class="op" id="6163647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163650">const</span>&nbsp;<span class="ident" id="6163656">sep</span>&nbsp;<span class="op" id="6163660">=</span>&nbsp;<span class="builtintype" id="6163662">string</span><span class="op" id="6163668">(</span><span class="ident" id="6163669">filepath</span><span class="op" id="6163677">.</span><span class="ident" id="6163678">Separator</span><span class="op" id="6163687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163690">root</span>&nbsp;<span class="op" id="6163695">=</span>&nbsp;<span class="ident" id="6163697">filepath</span><span class="op" id="6163705">.</span><span class="ident" id="6163706">Clean</span><span class="op" id="6163711">(</span><span class="ident" id="6163712">root</span><span class="op" id="6163716">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163719">if</span>&nbsp;<span class="op" id="6163722">!</span><span class="ident" id="6163723">strings</span><span class="op" id="6163730">.</span><span class="ident" id="6163731">HasSuffix</span><span class="op" id="6163740">(</span><span class="ident" id="6163741">root</span><span class="op" id="6163745">,</span>&nbsp;<span class="ident" id="6163747">sep</span><span class="op" id="6163750">)</span>&nbsp;<span class="op" id="6163752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163756">root</span>&nbsp;<span class="op" id="6163761">+=</span>&nbsp;<span class="ident" id="6163764">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6163772">dir</span>&nbsp;<span class="op" id="6163776">=</span>&nbsp;<span class="ident" id="6163778">filepath</span><span class="op" id="6163786">.</span><span class="ident" id="6163787">Clean</span><span class="op" id="6163792">(</span><span class="ident" id="6163793">dir</span><span class="op" id="6163796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163799">if</span>&nbsp;<span class="op" id="6163802">!</span><span class="ident" id="6163803">strings</span><span class="op" id="6163810">.</span><span class="ident" id="6163811">HasPrefix</span><span class="op" id="6163820">(</span><span class="ident" id="6163821">dir</span><span class="op" id="6163824">,</span>&nbsp;<span class="ident" id="6163826">root</span><span class="op" id="6163830">)</span>&nbsp;<span class="op" id="6163832">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163836">return</span>&nbsp;<span class="string" id="6163843">&#34;&#34;</span><span class="op" id="6163845">,</span>&nbsp;<span class="ident" id="6163847">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6163854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6163857">return</span>&nbsp;<span class="ident" id="6163864">filepath</span><span class="op" id="6163872">.</span><span class="ident" id="6163873">ToSlash</span><span class="op" id="6163880">(</span><span class="ident" id="6163881">dir</span><span class="op" id="6163884">[</span><span class="builtinfunc" id="6163885">len</span><span class="op" id="6163888">(</span><span class="ident" id="6163889">root</span><span class="op" id="6163893">)</span><span class="op" id="6163894">:</span><span class="op" id="6163895">]</span><span class="op" id="6163896">)</span><span class="op" id="6163897">,</span>&nbsp;<span class="ident" id="6163899">true</span><br>
<span class="lineno"></span><span class="op" id="6163904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="6163907">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6163974">func</span>&nbsp;<span class="op" id="6163979">(</span><span class="ident" id="6163980">ctxt</span>&nbsp;<span class="op" id="6163985">*</span><span class="ident" id="6163986">Context</span><span class="op" id="6163993">)</span>&nbsp;<span class="ident" id="6163995">readDir</span><span class="op" id="6164002">(</span><span class="ident" id="6164003">path</span>&nbsp;<span class="builtintype" id="6164008">string</span><span class="op" id="6164014">)</span>&nbsp;<span class="op" id="6164016">(</span><span class="op" id="6164017">[</span><span class="op" id="6164018">]</span><span class="ident" id="6164019">os</span><span class="op" id="6164021">.</span><span class="ident" id="6164022">FileInfo</span><span class="op" id="6164030">,</span>&nbsp;<span class="builtintype" id="6164032">error</span><span class="op" id="6164037">)</span>&nbsp;<span class="op" id="6164039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164042">if</span>&nbsp;<span class="ident" id="6164045">f</span>&nbsp;<span class="op" id="6164047">:=</span>&nbsp;<span class="ident" id="6164050">ctxt</span><span class="op" id="6164054">.</span><span class="ident" id="6164055">ReadDir</span><span class="op" id="6164062">;</span>&nbsp;<span class="ident" id="6164064">f</span>&nbsp;<span class="op" id="6164066">!=</span>&nbsp;<span class="ident" id="6164069">nil</span>&nbsp;<span class="op" id="6164073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164077">return</span>&nbsp;<span class="ident" id="6164084">f</span><span class="op" id="6164085">(</span><span class="ident" id="6164086">path</span><span class="op" id="6164090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164093">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164096">return</span>&nbsp;<span class="ident" id="6164103">ioutil</span><span class="op" id="6164109">.</span><span class="ident" id="6164110">ReadDir</span><span class="op" id="6164117">(</span><span class="ident" id="6164118">path</span><span class="op" id="6164122">)</span><br>
<span class="lineno"></span><span class="op" id="6164124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6164127">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="6164189">func</span>&nbsp;<span class="op" id="6164194">(</span><span class="ident" id="6164195">ctxt</span>&nbsp;<span class="op" id="6164200">*</span><span class="ident" id="6164201">Context</span><span class="op" id="6164208">)</span>&nbsp;<span class="ident" id="6164210">openFile</span><span class="op" id="6164218">(</span><span class="ident" id="6164219">path</span>&nbsp;<span class="builtintype" id="6164224">string</span><span class="op" id="6164230">)</span>&nbsp;<span class="op" id="6164232">(</span><span class="ident" id="6164233">io</span><span class="op" id="6164235">.</span><span class="ident" id="6164236">ReadCloser</span><span class="op" id="6164246">,</span>&nbsp;<span class="builtintype" id="6164248">error</span><span class="op" id="6164253">)</span>&nbsp;<span class="op" id="6164255">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164258">if</span>&nbsp;<span class="ident" id="6164261">fn</span>&nbsp;<span class="op" id="6164264">:=</span>&nbsp;<span class="ident" id="6164267">ctxt</span><span class="op" id="6164271">.</span><span class="ident" id="6164272">OpenFile</span><span class="op" id="6164280">;</span>&nbsp;<span class="ident" id="6164282">fn</span>&nbsp;<span class="op" id="6164285">!=</span>&nbsp;<span class="ident" id="6164288">nil</span>&nbsp;<span class="op" id="6164292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164296">return</span>&nbsp;<span class="ident" id="6164303">fn</span><span class="op" id="6164305">(</span><span class="ident" id="6164306">path</span><span class="op" id="6164310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164317">f</span><span class="op" id="6164318">,</span>&nbsp;<span class="ident" id="6164320">err</span>&nbsp;<span class="op" id="6164324">:=</span>&nbsp;<span class="ident" id="6164327">os</span><span class="op" id="6164329">.</span><span class="ident" id="6164330">Open</span><span class="op" id="6164334">(</span><span class="ident" id="6164335">path</span><span class="op" id="6164339">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164342">if</span>&nbsp;<span class="ident" id="6164345">err</span>&nbsp;<span class="op" id="6164349">!=</span>&nbsp;<span class="ident" id="6164352">nil</span>&nbsp;<span class="op" id="6164356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164360">return</span>&nbsp;<span class="ident" id="6164367">nil</span><span class="op" id="6164370">,</span>&nbsp;<span class="ident" id="6164372">err</span>&nbsp;<span class="comment" id="6164376">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164397">return</span>&nbsp;<span class="ident" id="6164404">f</span><span class="op" id="6164405">,</span>&nbsp;<span class="ident" id="6164407">nil</span><br>
<span class="lineno"></span><span class="op" id="6164411">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6164414">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6164480">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6164544">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="6164564">func</span>&nbsp;<span class="op" id="6164569">(</span><span class="ident" id="6164570">ctxt</span>&nbsp;<span class="op" id="6164575">*</span><span class="ident" id="6164576">Context</span><span class="op" id="6164583">)</span>&nbsp;<span class="ident" id="6164585">isFile</span><span class="op" id="6164591">(</span><span class="ident" id="6164592">path</span>&nbsp;<span class="builtintype" id="6164597">string</span><span class="op" id="6164603">)</span>&nbsp;<span class="builtintype" id="6164605">bool</span>&nbsp;<span class="op" id="6164610">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164613">f</span><span class="op" id="6164614">,</span>&nbsp;<span class="ident" id="6164616">err</span>&nbsp;<span class="op" id="6164620">:=</span>&nbsp;<span class="ident" id="6164623">ctxt</span><span class="op" id="6164627">.</span><span class="ident" id="6164628">openFile</span><span class="op" id="6164636">(</span><span class="ident" id="6164637">path</span><span class="op" id="6164641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164644">if</span>&nbsp;<span class="ident" id="6164647">err</span>&nbsp;<span class="op" id="6164651">!=</span>&nbsp;<span class="ident" id="6164654">nil</span>&nbsp;<span class="op" id="6164658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164662">return</span>&nbsp;<span class="ident" id="6164669">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6164676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6164679">f</span><span class="op" id="6164680">.</span><span class="ident" id="6164681">Close</span><span class="op" id="6164686">(</span><span class="op" id="6164687">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164690">return</span>&nbsp;<span class="ident" id="6164697">true</span><br>
<span class="lineno"></span><span class="op" id="6164702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6164705">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="6164756">func</span>&nbsp;<span class="op" id="6164761">(</span><span class="ident" id="6164762">ctxt</span>&nbsp;<span class="op" id="6164767">*</span><span class="ident" id="6164768">Context</span><span class="op" id="6164775">)</span>&nbsp;<span class="ident" id="6164777">gopath</span><span class="op" id="6164783">(</span><span class="op" id="6164784">)</span>&nbsp;<span class="op" id="6164786">[</span><span class="op" id="6164787">]</span><span class="builtintype" id="6164788">string</span>&nbsp;<span class="op" id="6164795">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164798">var</span>&nbsp;<span class="ident" id="6164802">all</span>&nbsp;<span class="op" id="6164806">[</span><span class="op" id="6164807">]</span><span class="builtintype" id="6164808">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164816">for</span>&nbsp;<span class="ident" id="6164820">_</span><span class="op" id="6164821">,</span>&nbsp;<span class="ident" id="6164823">p</span>&nbsp;<span class="op" id="6164825">:=</span>&nbsp;<span class="keyword" id="6164828">range</span>&nbsp;<span class="ident" id="6164834">ctxt</span><span class="op" id="6164838">.</span><span class="ident" id="6164839">splitPathList</span><span class="op" id="6164852">(</span><span class="ident" id="6164853">ctxt</span><span class="op" id="6164857">.</span><span class="ident" id="6164858">GOPATH</span><span class="op" id="6164864">)</span>&nbsp;<span class="op" id="6164866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6164870">if</span>&nbsp;<span class="ident" id="6164873">p</span>&nbsp;<span class="op" id="6164875">==</span>&nbsp;<span class="string" id="6164878">&#34;&#34;</span>&nbsp;<span class="op" id="6164881">||</span>&nbsp;<span class="ident" id="6164884">p</span>&nbsp;<span class="op" id="6164886">==</span>&nbsp;<span class="ident" id="6164889">ctxt</span><span class="op" id="6164893">.</span><span class="ident" id="6164894">GOROOT</span>&nbsp;<span class="op" id="6164901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164906">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164943">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6164987">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165030">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165080">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165095">if</span>&nbsp;<span class="ident" id="6165098">strings</span><span class="op" id="6165105">.</span><span class="ident" id="6165106">HasPrefix</span><span class="op" id="6165115">(</span><span class="ident" id="6165116">p</span><span class="op" id="6165117">,</span>&nbsp;<span class="string" id="6165119">&#34;~&#34;</span><span class="op" id="6165122">)</span>&nbsp;<span class="op" id="6165124">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165129">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165191">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165255">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165300">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165360">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165418">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165485">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165548">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165614">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165673">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165693">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6165757">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165785">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6165800">all</span>&nbsp;<span class="op" id="6165804">=</span>&nbsp;<span class="builtinfunc" id="6165806">append</span><span class="op" id="6165812">(</span><span class="ident" id="6165813">all</span><span class="op" id="6165816">,</span>&nbsp;<span class="ident" id="6165818">p</span><span class="op" id="6165819">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6165822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6165825">return</span>&nbsp;<span class="ident" id="6165832">all</span><br>
<span class="lineno"></span><span class="op" id="6165836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6165839">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="6165901">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="6165972">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="6165994">func</span>&nbsp;<span class="op" id="6165999">(</span><span class="ident" id="6166000">ctxt</span>&nbsp;<span class="op" id="6166005">*</span><span class="ident" id="6166006">Context</span><span class="op" id="6166013">)</span>&nbsp;<span class="ident" id="6166015">SrcDirs</span><span class="op" id="6166022">(</span><span class="op" id="6166023">)</span>&nbsp;<span class="op" id="6166025">[</span><span class="op" id="6166026">]</span><span class="builtintype" id="6166027">string</span>&nbsp;<span class="op" id="6166034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166037">var</span>&nbsp;<span class="ident" id="6166041">all</span>&nbsp;<span class="op" id="6166045">[</span><span class="op" id="6166046">]</span><span class="builtintype" id="6166047">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166055">if</span>&nbsp;<span class="ident" id="6166058">ctxt</span><span class="op" id="6166062">.</span><span class="ident" id="6166063">GOROOT</span>&nbsp;<span class="op" id="6166070">!=</span>&nbsp;<span class="string" id="6166073">&#34;&#34;</span>&nbsp;<span class="op" id="6166076">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166080">dir</span>&nbsp;<span class="op" id="6166084">:=</span>&nbsp;<span class="ident" id="6166087">ctxt</span><span class="op" id="6166091">.</span><span class="ident" id="6166092">joinPath</span><span class="op" id="6166100">(</span><span class="ident" id="6166101">ctxt</span><span class="op" id="6166105">.</span><span class="ident" id="6166106">GOROOT</span><span class="op" id="6166112">,</span>&nbsp;<span class="string" id="6166114">&#34;src&#34;</span><span class="op" id="6166119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166123">if</span>&nbsp;<span class="ident" id="6166126">ctxt</span><span class="op" id="6166130">.</span><span class="ident" id="6166131">isDir</span><span class="op" id="6166136">(</span><span class="ident" id="6166137">dir</span><span class="op" id="6166140">)</span>&nbsp;<span class="op" id="6166142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166147">all</span>&nbsp;<span class="op" id="6166151">=</span>&nbsp;<span class="builtinfunc" id="6166153">append</span><span class="op" id="6166159">(</span><span class="ident" id="6166160">all</span><span class="op" id="6166163">,</span>&nbsp;<span class="ident" id="6166165">dir</span><span class="op" id="6166168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166175">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166178">for</span>&nbsp;<span class="ident" id="6166182">_</span><span class="op" id="6166183">,</span>&nbsp;<span class="ident" id="6166185">p</span>&nbsp;<span class="op" id="6166187">:=</span>&nbsp;<span class="keyword" id="6166190">range</span>&nbsp;<span class="ident" id="6166196">ctxt</span><span class="op" id="6166200">.</span><span class="ident" id="6166201">gopath</span><span class="op" id="6166207">(</span><span class="op" id="6166208">)</span>&nbsp;<span class="op" id="6166210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166214">dir</span>&nbsp;<span class="op" id="6166218">:=</span>&nbsp;<span class="ident" id="6166221">ctxt</span><span class="op" id="6166225">.</span><span class="ident" id="6166226">joinPath</span><span class="op" id="6166234">(</span><span class="ident" id="6166235">p</span><span class="op" id="6166236">,</span>&nbsp;<span class="string" id="6166238">&#34;src&#34;</span><span class="op" id="6166243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166247">if</span>&nbsp;<span class="ident" id="6166250">ctxt</span><span class="op" id="6166254">.</span><span class="ident" id="6166255">isDir</span><span class="op" id="6166260">(</span><span class="ident" id="6166261">dir</span><span class="op" id="6166264">)</span>&nbsp;<span class="op" id="6166266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6166271">all</span>&nbsp;<span class="op" id="6166275">=</span>&nbsp;<span class="builtinfunc" id="6166277">append</span><span class="op" id="6166283">(</span><span class="ident" id="6166284">all</span><span class="op" id="6166287">,</span>&nbsp;<span class="ident" id="6166289">dir</span><span class="op" id="6166292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166296">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6166299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6166302">return</span>&nbsp;<span class="ident" id="6166309">all</span><br>
<span class="lineno"></span><span class="op" id="6166313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6166316">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="6166362">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="6166432">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="6166497">var</span>&nbsp;<span class="ident" id="6166501">Default</span>&nbsp;<span class="ident" id="6166509">Context</span>&nbsp;<span class="op" id="6166517">=</span>&nbsp;<span class="ident" id="6166519">defaultContext</span><span class="op" id="6166533">(</span><span class="op" id="6166534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6166537">var</span>&nbsp;<span class="ident" id="6166541">cgoEnabled</span>&nbsp;<span class="op" id="6166552">=</span>&nbsp;<span class="keyword" id="6166554">map</span><span class="op" id="6166557">[</span><span class="builtintype" id="6166558">string</span><span class="op" id="6166564">]</span><span class="builtintype" id="6166565">bool</span><span class="op" id="6166569">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166572">&#34;darwin/386&#34;</span><span class="op" id="6166584">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166591">true</span><span class="op" id="6166595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166598">&#34;darwin/amd64&#34;</span><span class="op" id="6166612">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166617">true</span><span class="op" id="6166621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166624">&#34;dragonfly/386&#34;</span><span class="op" id="6166639">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6166643">true</span><span class="op" id="6166647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166650">&#34;dragonfly/amd64&#34;</span><span class="op" id="6166667">:</span>&nbsp;<span class="ident" id="6166669">true</span><span class="op" id="6166673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166676">&#34;freebsd/386&#34;</span><span class="op" id="6166689">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166695">true</span><span class="op" id="6166699">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166702">&#34;freebsd/amd64&#34;</span><span class="op" id="6166717">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6166721">true</span><span class="op" id="6166725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166728">&#34;freebsd/arm&#34;</span><span class="op" id="6166741">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166747">true</span><span class="op" id="6166751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166754">&#34;linux/386&#34;</span><span class="op" id="6166765">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166773">true</span><span class="op" id="6166777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166780">&#34;linux/amd64&#34;</span><span class="op" id="6166793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166799">true</span><span class="op" id="6166803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166806">&#34;linux/arm&#34;</span><span class="op" id="6166817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166825">true</span><span class="op" id="6166829">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166832">&#34;android/386&#34;</span><span class="op" id="6166845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166851">true</span><span class="op" id="6166855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166858">&#34;android/amd64&#34;</span><span class="op" id="6166873">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6166877">true</span><span class="op" id="6166881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166884">&#34;android/arm&#34;</span><span class="op" id="6166897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166903">true</span><span class="op" id="6166907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166910">&#34;netbsd/386&#34;</span><span class="op" id="6166922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166929">true</span><span class="op" id="6166933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166936">&#34;netbsd/amd64&#34;</span><span class="op" id="6166950">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166955">true</span><span class="op" id="6166959">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166962">&#34;netbsd/arm&#34;</span><span class="op" id="6166974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6166981">true</span><span class="op" id="6166985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6166988">&#34;openbsd/386&#34;</span><span class="op" id="6167001">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6167007">true</span><span class="op" id="6167011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6167014">&#34;openbsd/amd64&#34;</span><span class="op" id="6167029">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6167033">true</span><span class="op" id="6167037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6167040">&#34;windows/386&#34;</span><span class="op" id="6167053">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6167059">true</span><span class="op" id="6167063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6167066">&#34;windows/amd64&#34;</span><span class="op" id="6167081">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6167085">true</span><span class="op" id="6167089">,</span><br>
<span class="lineno">280</span><span class="op" id="6167091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6167094">func</span>&nbsp;<span class="ident" id="6167099">defaultContext</span><span class="op" id="6167113">(</span><span class="op" id="6167114">)</span>&nbsp;<span class="ident" id="6167116">Context</span>&nbsp;<span class="op" id="6167124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167127">var</span>&nbsp;<span class="ident" id="6167131">c</span>&nbsp;<span class="ident" id="6167133">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167143">c</span><span class="op" id="6167144">.</span><span class="ident" id="6167145">GOARCH</span>&nbsp;<span class="op" id="6167152">=</span>&nbsp;<span class="ident" id="6167154">envOr</span><span class="op" id="6167159">(</span><span class="string" id="6167160">&#34;GOARCH&#34;</span><span class="op" id="6167168">,</span>&nbsp;<span class="ident" id="6167170">runtime</span><span class="op" id="6167177">.</span><span class="ident" id="6167178">GOARCH</span><span class="op" id="6167184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167187">c</span><span class="op" id="6167188">.</span><span class="ident" id="6167189">GOOS</span>&nbsp;<span class="op" id="6167194">=</span>&nbsp;<span class="ident" id="6167196">envOr</span><span class="op" id="6167201">(</span><span class="string" id="6167202">&#34;GOOS&#34;</span><span class="op" id="6167208">,</span>&nbsp;<span class="ident" id="6167210">runtime</span><span class="op" id="6167217">.</span><span class="ident" id="6167218">GOOS</span><span class="op" id="6167222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167225">c</span><span class="op" id="6167226">.</span><span class="ident" id="6167227">GOROOT</span>&nbsp;<span class="op" id="6167234">=</span>&nbsp;<span class="ident" id="6167236">runtime</span><span class="op" id="6167243">.</span><span class="ident" id="6167244">GOROOT</span><span class="op" id="6167250">(</span><span class="op" id="6167251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167254">c</span><span class="op" id="6167255">.</span><span class="ident" id="6167256">GOPATH</span>&nbsp;<span class="op" id="6167263">=</span>&nbsp;<span class="ident" id="6167265">envOr</span><span class="op" id="6167270">(</span><span class="string" id="6167271">&#34;GOPATH&#34;</span><span class="op" id="6167279">,</span>&nbsp;<span class="string" id="6167281">&#34;&#34;</span><span class="op" id="6167283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167286">c</span><span class="op" id="6167287">.</span><span class="ident" id="6167288">Compiler</span>&nbsp;<span class="op" id="6167297">=</span>&nbsp;<span class="ident" id="6167299">runtime</span><span class="op" id="6167306">.</span><span class="ident" id="6167307">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167318">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167388">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167458">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167531">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167604">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167681">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167685">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167729">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167803">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167818">c</span><span class="op" id="6167819">.</span><span class="ident" id="6167820">ReleaseTags</span>&nbsp;<span class="op" id="6167832">=</span>&nbsp;<span class="op" id="6167834">[</span><span class="op" id="6167835">]</span><span class="builtintype" id="6167836">string</span><span class="op" id="6167842">{</span><span class="string" id="6167843">&#34;go1.1&#34;</span><span class="op" id="6167850">,</span>&nbsp;<span class="string" id="6167852">&#34;go1.2&#34;</span><span class="op" id="6167859">,</span>&nbsp;<span class="string" id="6167861">&#34;go1.3&#34;</span><span class="op" id="6167868">,</span>&nbsp;<span class="string" id="6167870">&#34;go1.4&#34;</span><span class="op" id="6167877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167881">switch</span>&nbsp;<span class="ident" id="6167888">os</span><span class="op" id="6167890">.</span><span class="ident" id="6167891">Getenv</span><span class="op" id="6167897">(</span><span class="string" id="6167898">&#34;CGO_ENABLED&#34;</span><span class="op" id="6167911">)</span>&nbsp;<span class="op" id="6167913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167916">case</span>&nbsp;<span class="string" id="6167921">&#34;1&#34;</span><span class="op" id="6167924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167928">c</span><span class="op" id="6167929">.</span><span class="ident" id="6167930">CgoEnabled</span>&nbsp;<span class="op" id="6167941">=</span>&nbsp;<span class="ident" id="6167943">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167949">case</span>&nbsp;<span class="string" id="6167954">&#34;0&#34;</span><span class="op" id="6167957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6167961">c</span><span class="op" id="6167962">.</span><span class="ident" id="6167963">CgoEnabled</span>&nbsp;<span class="op" id="6167974">=</span>&nbsp;<span class="ident" id="6167976">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6167983">default</span><span class="op" id="6167990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6167994">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168059">if</span>&nbsp;<span class="ident" id="6168062">runtime</span><span class="op" id="6168069">.</span><span class="ident" id="6168070">GOARCH</span>&nbsp;<span class="op" id="6168077">==</span>&nbsp;<span class="ident" id="6168080">c</span><span class="op" id="6168081">.</span><span class="ident" id="6168082">GOARCH</span>&nbsp;<span class="op" id="6168089">&amp;&amp;</span>&nbsp;<span class="ident" id="6168092">runtime</span><span class="op" id="6168099">.</span><span class="ident" id="6168100">GOOS</span>&nbsp;<span class="op" id="6168105">==</span>&nbsp;<span class="ident" id="6168108">c</span><span class="op" id="6168109">.</span><span class="ident" id="6168110">GOOS</span>&nbsp;<span class="op" id="6168115">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168120">c</span><span class="op" id="6168121">.</span><span class="ident" id="6168122">CgoEnabled</span>&nbsp;<span class="op" id="6168133">=</span>&nbsp;<span class="ident" id="6168135">cgoEnabled</span><span class="op" id="6168145">[</span><span class="ident" id="6168146">c</span><span class="op" id="6168147">.</span><span class="ident" id="6168148">GOOS</span><span class="op" id="6168152">+</span><span class="string" id="6168153">&#34;/&#34;</span><span class="op" id="6168156">+</span><span class="ident" id="6168157">c</span><span class="op" id="6168158">.</span><span class="ident" id="6168159">GOARCH</span><span class="op" id="6168165">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168170">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168182">c</span><span class="op" id="6168183">.</span><span class="ident" id="6168184">CgoEnabled</span>&nbsp;<span class="op" id="6168195">=</span>&nbsp;<span class="ident" id="6168197">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168204">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168208">return</span>&nbsp;<span class="ident" id="6168215">c</span><br>
<span class="lineno"></span><span class="op" id="6168217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6168220">func</span>&nbsp;<span class="ident" id="6168225">envOr</span><span class="op" id="6168230">(</span><span class="ident" id="6168231">name</span><span class="op" id="6168235">,</span>&nbsp;<span class="ident" id="6168237">def</span>&nbsp;<span class="builtintype" id="6168241">string</span><span class="op" id="6168247">)</span>&nbsp;<span class="builtintype" id="6168249">string</span>&nbsp;<span class="op" id="6168256">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168259">s</span>&nbsp;<span class="op" id="6168261">:=</span>&nbsp;<span class="ident" id="6168264">os</span><span class="op" id="6168266">.</span><span class="ident" id="6168267">Getenv</span><span class="op" id="6168273">(</span><span class="ident" id="6168274">name</span><span class="op" id="6168278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168281">if</span>&nbsp;<span class="ident" id="6168284">s</span>&nbsp;<span class="op" id="6168286">==</span>&nbsp;<span class="string" id="6168289">&#34;&#34;</span>&nbsp;<span class="op" id="6168292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168296">return</span>&nbsp;<span class="ident" id="6168303">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6168308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6168311">return</span>&nbsp;<span class="ident" id="6168318">s</span><br>
<span class="lineno">325</span><span class="op" id="6168320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6168323">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="6168384">type</span>&nbsp;<span class="ident" id="6168389">ImportMode</span>&nbsp;<span class="builtintype" id="6168400">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="6168406">const</span>&nbsp;<span class="op" id="6168412">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168415">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168481">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168545">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168582">FindOnly</span>&nbsp;<span class="ident" id="6168591">ImportMode</span>&nbsp;<span class="op" id="6168602">=</span>&nbsp;<span class="num" id="6168604">1</span>&nbsp;<span class="op" id="6168606">&lt;&lt;</span>&nbsp;<span class="ident" id="6168609">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168616">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168681">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6168731">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168745">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168819">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168890">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6168950">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169010">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="6169024">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6169027">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="6169087">type</span>&nbsp;<span class="ident" id="6169092">Package</span>&nbsp;<span class="keyword" id="6169100">struct</span>&nbsp;<span class="op" id="6169107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169110">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169124">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169133">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169174">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169188">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169197">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169214">ImportComment</span>&nbsp;<span class="builtintype" id="6169228">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169237">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169285">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169299">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169308">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169335">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169349">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169358">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169401">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169415">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169424">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169469">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169483">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169492">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169542">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169556">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169565">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169616">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169630">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169639">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169685">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169699">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6169708">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169737">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169751">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169760">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169782">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6169796">[</span><span class="op" id="6169797">]</span><span class="builtintype" id="6169798">string</span>&nbsp;<span class="comment" id="6169805">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169866">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6169880">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6169889">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6169932">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6169949">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6169964">[</span><span class="op" id="6169965">]</span><span class="builtintype" id="6169966">string</span>&nbsp;<span class="comment" id="6169973">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170042">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170057">[</span><span class="op" id="6170058">]</span><span class="builtintype" id="6170059">string</span>&nbsp;<span class="comment" id="6170066">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170103">IgnoredGoFiles</span>&nbsp;<span class="op" id="6170118">[</span><span class="op" id="6170119">]</span><span class="builtintype" id="6170120">string</span>&nbsp;<span class="comment" id="6170127">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170171">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170186">[</span><span class="op" id="6170187">]</span><span class="builtintype" id="6170188">string</span>&nbsp;<span class="comment" id="6170195">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170215">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170230">[</span><span class="op" id="6170231">]</span><span class="builtintype" id="6170232">string</span>&nbsp;<span class="comment" id="6170239">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170275">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170290">[</span><span class="op" id="6170291">]</span><span class="builtintype" id="6170292">string</span>&nbsp;<span class="comment" id="6170299">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170333">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170348">[</span><span class="op" id="6170349">]</span><span class="builtintype" id="6170350">string</span>&nbsp;<span class="comment" id="6170357">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170397">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170412">[</span><span class="op" id="6170413">]</span><span class="builtintype" id="6170414">string</span>&nbsp;<span class="comment" id="6170421">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170441">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170456">[</span><span class="op" id="6170457">]</span><span class="builtintype" id="6170458">string</span>&nbsp;<span class="comment" id="6170465">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170481">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6170496">[</span><span class="op" id="6170497">]</span><span class="builtintype" id="6170498">string</span>&nbsp;<span class="comment" id="6170505">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170524">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170539">[</span><span class="op" id="6170540">]</span><span class="builtintype" id="6170541">string</span>&nbsp;<span class="comment" id="6170548">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170597">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170616">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6170629">[</span><span class="op" id="6170630">]</span><span class="builtintype" id="6170631">string</span>&nbsp;<span class="comment" id="6170638">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170664">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="6170677">[</span><span class="op" id="6170678">]</span><span class="builtintype" id="6170679">string</span>&nbsp;<span class="comment" id="6170686">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170714">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="6170727">[</span><span class="op" id="6170728">]</span><span class="builtintype" id="6170729">string</span>&nbsp;<span class="comment" id="6170736">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170764">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6170777">[</span><span class="op" id="6170778">]</span><span class="builtintype" id="6170779">string</span>&nbsp;<span class="comment" id="6170786">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170813">CgoPkgConfig</span>&nbsp;<span class="op" id="6170826">[</span><span class="op" id="6170827">]</span><span class="builtintype" id="6170828">string</span>&nbsp;<span class="comment" id="6170835">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6170866">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170893">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6170903">[</span><span class="op" id="6170904">]</span><span class="builtintype" id="6170905">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6170931">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6170966">ImportPos</span>&nbsp;<span class="keyword" id="6170976">map</span><span class="op" id="6170979">[</span><span class="builtintype" id="6170980">string</span><span class="op" id="6170986">]</span><span class="op" id="6170987">[</span><span class="op" id="6170988">]</span><span class="ident" id="6170989">token</span><span class="op" id="6170994">.</span><span class="ident" id="6170995">Position</span>&nbsp;<span class="comment" id="6171004">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6171038">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171059">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6171074">[</span><span class="op" id="6171075">]</span><span class="builtintype" id="6171076">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6171102">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171132">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6171147">[</span><span class="op" id="6171148">]</span><span class="builtintype" id="6171149">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6171175">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171204">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="6171219">map</span><span class="op" id="6171222">[</span><span class="builtintype" id="6171223">string</span><span class="op" id="6171229">]</span><span class="op" id="6171230">[</span><span class="op" id="6171231">]</span><span class="ident" id="6171232">token</span><span class="op" id="6171237">.</span><span class="ident" id="6171238">Position</span>&nbsp;<span class="comment" id="6171247">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171284">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6171299">[</span><span class="op" id="6171300">]</span><span class="builtintype" id="6171301">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6171327">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171362">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6171377">[</span><span class="op" id="6171378">]</span><span class="builtintype" id="6171379">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6171405">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6171435">XTestImportPos</span>&nbsp;<span class="keyword" id="6171450">map</span><span class="op" id="6171453">[</span><span class="builtintype" id="6171454">string</span><span class="op" id="6171460">]</span><span class="op" id="6171461">[</span><span class="op" id="6171462">]</span><span class="ident" id="6171463">token</span><span class="op" id="6171468">.</span><span class="ident" id="6171469">Position</span>&nbsp;<span class="comment" id="6171478">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="6171515">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="6171518">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6171575">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="6171624">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="6171674">func</span>&nbsp;<span class="op" id="6171679">(</span><span class="ident" id="6171680">p</span>&nbsp;<span class="op" id="6171682">*</span><span class="ident" id="6171683">Package</span><span class="op" id="6171690">)</span>&nbsp;<span class="ident" id="6171692">IsCommand</span><span class="op" id="6171701">(</span><span class="op" id="6171702">)</span>&nbsp;<span class="builtintype" id="6171704">bool</span>&nbsp;<span class="op" id="6171709">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171712">return</span>&nbsp;<span class="ident" id="6171719">p</span><span class="op" id="6171720">.</span><span class="ident" id="6171721">Name</span>&nbsp;<span class="op" id="6171726">==</span>&nbsp;<span class="string" id="6171729">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="6171736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171739">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6171805">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="6171829">func</span>&nbsp;<span class="op" id="6171834">(</span><span class="ident" id="6171835">ctxt</span>&nbsp;<span class="op" id="6171840">*</span><span class="ident" id="6171841">Context</span><span class="op" id="6171848">)</span>&nbsp;<span class="ident" id="6171850">ImportDir</span><span class="op" id="6171859">(</span><span class="ident" id="6171860">dir</span>&nbsp;<span class="builtintype" id="6171864">string</span><span class="op" id="6171870">,</span>&nbsp;<span class="ident" id="6171872">mode</span>&nbsp;<span class="ident" id="6171877">ImportMode</span><span class="op" id="6171887">)</span>&nbsp;<span class="op" id="6171889">(</span><span class="op" id="6171890">*</span><span class="ident" id="6171891">Package</span><span class="op" id="6171898">,</span>&nbsp;<span class="builtintype" id="6171900">error</span><span class="op" id="6171905">)</span>&nbsp;<span class="op" id="6171907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6171910">return</span>&nbsp;<span class="ident" id="6171917">ctxt</span><span class="op" id="6171921">.</span><span class="ident" id="6171922">Import</span><span class="op" id="6171928">(</span><span class="string" id="6171929">&#34;.&#34;</span><span class="op" id="6171932">,</span>&nbsp;<span class="ident" id="6171934">dir</span><span class="op" id="6171937">,</span>&nbsp;<span class="ident" id="6171939">mode</span><span class="op" id="6171943">)</span><br>
<span class="lineno"></span><span class="op" id="6171945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6171948">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="6172013">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="6172079">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="6172134">type</span>&nbsp;<span class="ident" id="6172139">NoGoError</span>&nbsp;<span class="keyword" id="6172149">struct</span>&nbsp;<span class="op" id="6172156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172159">Dir</span>&nbsp;<span class="builtintype" id="6172163">string</span><br>
<span class="lineno"></span><span class="op" id="6172170">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="6172173">func</span>&nbsp;<span class="op" id="6172178">(</span><span class="ident" id="6172179">e</span>&nbsp;<span class="op" id="6172181">*</span><span class="ident" id="6172182">NoGoError</span><span class="op" id="6172191">)</span>&nbsp;<span class="ident" id="6172193">Error</span><span class="op" id="6172198">(</span><span class="op" id="6172199">)</span>&nbsp;<span class="builtintype" id="6172201">string</span>&nbsp;<span class="op" id="6172208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172211">return</span>&nbsp;<span class="string" id="6172218">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="6172253">+</span>&nbsp;<span class="ident" id="6172255">e</span><span class="op" id="6172256">.</span><span class="ident" id="6172257">Dir</span><br>
<span class="lineno"></span><span class="op" id="6172261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="6172264">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="6172321">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="6172382">type</span>&nbsp;<span class="ident" id="6172387">MultiplePackageError</span>&nbsp;<span class="keyword" id="6172408">struct</span>&nbsp;<span class="op" id="6172415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172418">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6172427">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6172436">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172467">Packages</span>&nbsp;<span class="op" id="6172476">[</span><span class="op" id="6172477">]</span><span class="builtintype" id="6172478">string</span>&nbsp;<span class="comment" id="6172485">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172509">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6172518">[</span><span class="op" id="6172519">]</span><span class="builtintype" id="6172520">string</span>&nbsp;<span class="comment" id="6172527">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="6172589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6172592">func</span>&nbsp;<span class="op" id="6172597">(</span><span class="ident" id="6172598">e</span>&nbsp;<span class="op" id="6172600">*</span><span class="ident" id="6172601">MultiplePackageError</span><span class="op" id="6172621">)</span>&nbsp;<span class="ident" id="6172623">Error</span><span class="op" id="6172628">(</span><span class="op" id="6172629">)</span>&nbsp;<span class="builtintype" id="6172631">string</span>&nbsp;<span class="op" id="6172638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6172641">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172700">return</span>&nbsp;<span class="ident" id="6172707">fmt</span><span class="op" id="6172710">.</span><span class="ident" id="6172711">Sprintf</span><span class="op" id="6172718">(</span><span class="string" id="6172719">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6172761">,</span>&nbsp;<span class="ident" id="6172763">e</span><span class="op" id="6172764">.</span><span class="ident" id="6172765">Packages</span><span class="op" id="6172773">[</span><span class="num" id="6172774">0</span><span class="op" id="6172775">]</span><span class="op" id="6172776">,</span>&nbsp;<span class="ident" id="6172778">e</span><span class="op" id="6172779">.</span><span class="ident" id="6172780">Files</span><span class="op" id="6172785">[</span><span class="num" id="6172786">0</span><span class="op" id="6172787">]</span><span class="op" id="6172788">,</span>&nbsp;<span class="ident" id="6172790">e</span><span class="op" id="6172791">.</span><span class="ident" id="6172792">Packages</span><span class="op" id="6172800">[</span><span class="num" id="6172801">1</span><span class="op" id="6172802">]</span><span class="op" id="6172803">,</span>&nbsp;<span class="ident" id="6172805">e</span><span class="op" id="6172806">.</span><span class="ident" id="6172807">Files</span><span class="op" id="6172812">[</span><span class="num" id="6172813">1</span><span class="op" id="6172814">]</span><span class="op" id="6172815">,</span>&nbsp;<span class="ident" id="6172817">e</span><span class="op" id="6172818">.</span><span class="ident" id="6172819">Dir</span><span class="op" id="6172822">)</span><br>
<span class="lineno"></span><span class="op" id="6172824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6172827">func</span>&nbsp;<span class="ident" id="6172832">nameExt</span><span class="op" id="6172839">(</span><span class="ident" id="6172840">name</span>&nbsp;<span class="builtintype" id="6172845">string</span><span class="op" id="6172851">)</span>&nbsp;<span class="builtintype" id="6172853">string</span>&nbsp;<span class="op" id="6172860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6172863">i</span>&nbsp;<span class="op" id="6172865">:=</span>&nbsp;<span class="ident" id="6172868">strings</span><span class="op" id="6172875">.</span><span class="ident" id="6172876">LastIndex</span><span class="op" id="6172885">(</span><span class="ident" id="6172886">name</span><span class="op" id="6172890">,</span>&nbsp;<span class="string" id="6172892">&#34;.&#34;</span><span class="op" id="6172895">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172898">if</span>&nbsp;<span class="ident" id="6172901">i</span>&nbsp;<span class="op" id="6172903">&lt;</span>&nbsp;<span class="num" id="6172905">0</span>&nbsp;<span class="op" id="6172907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172911">return</span>&nbsp;<span class="string" id="6172918">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6172922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6172925">return</span>&nbsp;<span class="ident" id="6172932">name</span><span class="op" id="6172936">[</span><span class="ident" id="6172937">i</span><span class="op" id="6172938">:</span><span class="op" id="6172939">]</span><br>
<span class="lineno"></span><span class="op" id="6172941">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="6172944">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="6173017">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6173086">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="6173162">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="6173238">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="6173255">//</span><br>
<span class="lineno"></span><span class="comment" id="6173258">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="6173332">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="6173378">//</span><br>
<span class="lineno">450</span><span class="comment" id="6173381">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="6173421">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="6173485">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="6173548">//</span><br>
<span class="lineno"></span><span class="comment" id="6173551">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="6173619">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="6173663">//</span><br>
<span class="lineno"></span><span class="keyword" id="6173666">func</span>&nbsp;<span class="op" id="6173671">(</span><span class="ident" id="6173672">ctxt</span>&nbsp;<span class="op" id="6173677">*</span><span class="ident" id="6173678">Context</span><span class="op" id="6173685">)</span>&nbsp;<span class="ident" id="6173687">Import</span><span class="op" id="6173693">(</span><span class="ident" id="6173694">path</span>&nbsp;<span class="builtintype" id="6173699">string</span><span class="op" id="6173705">,</span>&nbsp;<span class="ident" id="6173707">srcDir</span>&nbsp;<span class="builtintype" id="6173714">string</span><span class="op" id="6173720">,</span>&nbsp;<span class="ident" id="6173722">mode</span>&nbsp;<span class="ident" id="6173727">ImportMode</span><span class="op" id="6173737">)</span>&nbsp;<span class="op" id="6173739">(</span><span class="op" id="6173740">*</span><span class="ident" id="6173741">Package</span><span class="op" id="6173748">,</span>&nbsp;<span class="builtintype" id="6173750">error</span><span class="op" id="6173755">)</span>&nbsp;<span class="op" id="6173757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173760">p</span>&nbsp;<span class="op" id="6173762">:=</span>&nbsp;<span class="op" id="6173765">&amp;</span><span class="ident" id="6173766">Package</span><span class="op" id="6173773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173777">ImportPath</span><span class="op" id="6173787">:</span>&nbsp;<span class="ident" id="6173789">path</span><span class="op" id="6173793">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173799">if</span>&nbsp;<span class="ident" id="6173802">path</span>&nbsp;<span class="op" id="6173807">==</span>&nbsp;<span class="string" id="6173810">&#34;&#34;</span>&nbsp;<span class="op" id="6173813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173817">return</span>&nbsp;<span class="ident" id="6173824">p</span><span class="op" id="6173825">,</span>&nbsp;<span class="ident" id="6173827">fmt</span><span class="op" id="6173830">.</span><span class="ident" id="6173831">Errorf</span><span class="op" id="6173837">(</span><span class="string" id="6173838">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="6173870">,</span>&nbsp;<span class="ident" id="6173872">path</span><span class="op" id="6173876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6173879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173883">var</span>&nbsp;<span class="ident" id="6173887">pkga</span>&nbsp;<span class="builtintype" id="6173892">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173900">var</span>&nbsp;<span class="ident" id="6173904">pkgerr</span>&nbsp;<span class="builtintype" id="6173911">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173918">switch</span>&nbsp;<span class="ident" id="6173925">ctxt</span><span class="op" id="6173929">.</span><span class="ident" id="6173930">Compiler</span>&nbsp;<span class="op" id="6173939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6173942">case</span>&nbsp;<span class="string" id="6173947">&#34;gccgo&#34;</span><span class="op" id="6173954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6173958">dir</span><span class="op" id="6173961">,</span>&nbsp;<span class="ident" id="6173963">elem</span>&nbsp;<span class="op" id="6173968">:=</span>&nbsp;<span class="ident" id="6173971">pathpkg</span><span class="op" id="6173978">.</span><span class="ident" id="6173979">Split</span><span class="op" id="6173984">(</span><span class="ident" id="6173985">p</span><span class="op" id="6173986">.</span><span class="ident" id="6173987">ImportPath</span><span class="op" id="6173997">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174001">pkga</span>&nbsp;<span class="op" id="6174006">=</span>&nbsp;<span class="string" id="6174008">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="6174021">+</span>&nbsp;<span class="ident" id="6174023">ctxt</span><span class="op" id="6174027">.</span><span class="ident" id="6174028">GOOS</span>&nbsp;<span class="op" id="6174033">+</span>&nbsp;<span class="string" id="6174035">&#34;_&#34;</span>&nbsp;<span class="op" id="6174039">+</span>&nbsp;<span class="ident" id="6174041">ctxt</span><span class="op" id="6174045">.</span><span class="ident" id="6174046">GOARCH</span>&nbsp;<span class="op" id="6174053">+</span>&nbsp;<span class="string" id="6174055">&#34;/&#34;</span>&nbsp;<span class="op" id="6174059">+</span>&nbsp;<span class="ident" id="6174061">dir</span>&nbsp;<span class="op" id="6174065">+</span>&nbsp;<span class="string" id="6174067">&#34;lib&#34;</span>&nbsp;<span class="op" id="6174073">+</span>&nbsp;<span class="ident" id="6174075">elem</span>&nbsp;<span class="op" id="6174080">+</span>&nbsp;<span class="string" id="6174082">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174088">case</span>&nbsp;<span class="string" id="6174093">&#34;gc&#34;</span><span class="op" id="6174097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174101">suffix</span>&nbsp;<span class="op" id="6174108">:=</span>&nbsp;<span class="string" id="6174111">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174116">if</span>&nbsp;<span class="ident" id="6174119">ctxt</span><span class="op" id="6174123">.</span><span class="ident" id="6174124">InstallSuffix</span>&nbsp;<span class="op" id="6174138">!=</span>&nbsp;<span class="string" id="6174141">&#34;&#34;</span>&nbsp;<span class="op" id="6174144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174149">suffix</span>&nbsp;<span class="op" id="6174156">=</span>&nbsp;<span class="string" id="6174158">&#34;_&#34;</span>&nbsp;<span class="op" id="6174162">+</span>&nbsp;<span class="ident" id="6174164">ctxt</span><span class="op" id="6174168">.</span><span class="ident" id="6174169">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174189">pkga</span>&nbsp;<span class="op" id="6174194">=</span>&nbsp;<span class="string" id="6174196">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="6174203">+</span>&nbsp;<span class="ident" id="6174205">ctxt</span><span class="op" id="6174209">.</span><span class="ident" id="6174210">GOOS</span>&nbsp;<span class="op" id="6174215">+</span>&nbsp;<span class="string" id="6174217">&#34;_&#34;</span>&nbsp;<span class="op" id="6174221">+</span>&nbsp;<span class="ident" id="6174223">ctxt</span><span class="op" id="6174227">.</span><span class="ident" id="6174228">GOARCH</span>&nbsp;<span class="op" id="6174235">+</span>&nbsp;<span class="ident" id="6174237">suffix</span>&nbsp;<span class="op" id="6174244">+</span>&nbsp;<span class="string" id="6174246">&#34;/&#34;</span>&nbsp;<span class="op" id="6174250">+</span>&nbsp;<span class="ident" id="6174252">p</span><span class="op" id="6174253">.</span><span class="ident" id="6174254">ImportPath</span>&nbsp;<span class="op" id="6174265">+</span>&nbsp;<span class="string" id="6174267">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174273">default</span><span class="op" id="6174280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6174284">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174321">pkgerr</span>&nbsp;<span class="op" id="6174328">=</span>&nbsp;<span class="ident" id="6174330">fmt</span><span class="op" id="6174333">.</span><span class="ident" id="6174334">Errorf</span><span class="op" id="6174340">(</span><span class="string" id="6174341">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="6174373">,</span>&nbsp;<span class="ident" id="6174375">path</span><span class="op" id="6174379">,</span>&nbsp;<span class="ident" id="6174381">ctxt</span><span class="op" id="6174385">.</span><span class="ident" id="6174386">Compiler</span><span class="op" id="6174394">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174401">binaryOnly</span>&nbsp;<span class="op" id="6174412">:=</span>&nbsp;<span class="ident" id="6174415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174422">if</span>&nbsp;<span class="ident" id="6174425">IsLocalImport</span><span class="op" id="6174438">(</span><span class="ident" id="6174439">path</span><span class="op" id="6174443">)</span>&nbsp;<span class="op" id="6174445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174449">pkga</span>&nbsp;<span class="op" id="6174454">=</span>&nbsp;<span class="string" id="6174456">&#34;&#34;</span>&nbsp;<span class="comment" id="6174459">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174501">if</span>&nbsp;<span class="ident" id="6174504">srcDir</span>&nbsp;<span class="op" id="6174511">==</span>&nbsp;<span class="string" id="6174514">&#34;&#34;</span>&nbsp;<span class="op" id="6174517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174522">return</span>&nbsp;<span class="ident" id="6174529">p</span><span class="op" id="6174530">,</span>&nbsp;<span class="ident" id="6174532">fmt</span><span class="op" id="6174535">.</span><span class="ident" id="6174536">Errorf</span><span class="op" id="6174542">(</span><span class="string" id="6174543">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="6174592">,</span>&nbsp;<span class="ident" id="6174594">path</span><span class="op" id="6174598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174606">if</span>&nbsp;<span class="op" id="6174609">!</span><span class="ident" id="6174610">ctxt</span><span class="op" id="6174614">.</span><span class="ident" id="6174615">isAbsPath</span><span class="op" id="6174624">(</span><span class="ident" id="6174625">path</span><span class="op" id="6174629">)</span>&nbsp;<span class="op" id="6174631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174636">p</span><span class="op" id="6174637">.</span><span class="ident" id="6174638">Dir</span>&nbsp;<span class="op" id="6174642">=</span>&nbsp;<span class="ident" id="6174644">ctxt</span><span class="op" id="6174648">.</span><span class="ident" id="6174649">joinPath</span><span class="op" id="6174657">(</span><span class="ident" id="6174658">srcDir</span><span class="op" id="6174664">,</span>&nbsp;<span class="ident" id="6174666">path</span><span class="op" id="6174670">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6174678">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174724">if</span>&nbsp;<span class="ident" id="6174727">ctxt</span><span class="op" id="6174731">.</span><span class="ident" id="6174732">GOROOT</span>&nbsp;<span class="op" id="6174739">!=</span>&nbsp;<span class="string" id="6174742">&#34;&#34;</span>&nbsp;<span class="op" id="6174745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174750">root</span>&nbsp;<span class="op" id="6174755">:=</span>&nbsp;<span class="ident" id="6174758">ctxt</span><span class="op" id="6174762">.</span><span class="ident" id="6174763">joinPath</span><span class="op" id="6174771">(</span><span class="ident" id="6174772">ctxt</span><span class="op" id="6174776">.</span><span class="ident" id="6174777">GOROOT</span><span class="op" id="6174783">,</span>&nbsp;<span class="string" id="6174785">&#34;src&#34;</span><span class="op" id="6174790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174795">if</span>&nbsp;<span class="ident" id="6174798">sub</span><span class="op" id="6174801">,</span>&nbsp;<span class="ident" id="6174803">ok</span>&nbsp;<span class="op" id="6174806">:=</span>&nbsp;<span class="ident" id="6174809">ctxt</span><span class="op" id="6174813">.</span><span class="ident" id="6174814">hasSubdir</span><span class="op" id="6174823">(</span><span class="ident" id="6174824">root</span><span class="op" id="6174828">,</span>&nbsp;<span class="ident" id="6174830">p</span><span class="op" id="6174831">.</span><span class="ident" id="6174832">Dir</span><span class="op" id="6174835">)</span><span class="op" id="6174836">;</span>&nbsp;<span class="ident" id="6174838">ok</span>&nbsp;<span class="op" id="6174841">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174847">p</span><span class="op" id="6174848">.</span><span class="ident" id="6174849">Goroot</span>&nbsp;<span class="op" id="6174856">=</span>&nbsp;<span class="ident" id="6174858">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174867">p</span><span class="op" id="6174868">.</span><span class="ident" id="6174869">ImportPath</span>&nbsp;<span class="op" id="6174880">=</span>&nbsp;<span class="ident" id="6174882">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174890">p</span><span class="op" id="6174891">.</span><span class="ident" id="6174892">Root</span>&nbsp;<span class="op" id="6174897">=</span>&nbsp;<span class="ident" id="6174899">ctxt</span><span class="op" id="6174903">.</span><span class="ident" id="6174904">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174915">goto</span>&nbsp;<span class="ident" id="6174920">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174929">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6174933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174937">all</span>&nbsp;<span class="op" id="6174941">:=</span>&nbsp;<span class="ident" id="6174944">ctxt</span><span class="op" id="6174948">.</span><span class="ident" id="6174949">gopath</span><span class="op" id="6174955">(</span><span class="op" id="6174956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6174960">for</span>&nbsp;<span class="ident" id="6174964">i</span><span class="op" id="6174965">,</span>&nbsp;<span class="ident" id="6174967">root</span>&nbsp;<span class="op" id="6174972">:=</span>&nbsp;<span class="keyword" id="6174975">range</span>&nbsp;<span class="ident" id="6174981">all</span>&nbsp;<span class="op" id="6174985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6174990">rootsrc</span>&nbsp;<span class="op" id="6174998">:=</span>&nbsp;<span class="ident" id="6175001">ctxt</span><span class="op" id="6175005">.</span><span class="ident" id="6175006">joinPath</span><span class="op" id="6175014">(</span><span class="ident" id="6175015">root</span><span class="op" id="6175019">,</span>&nbsp;<span class="string" id="6175021">&#34;src&#34;</span><span class="op" id="6175026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175031">if</span>&nbsp;<span class="ident" id="6175034">sub</span><span class="op" id="6175037">,</span>&nbsp;<span class="ident" id="6175039">ok</span>&nbsp;<span class="op" id="6175042">:=</span>&nbsp;<span class="ident" id="6175045">ctxt</span><span class="op" id="6175049">.</span><span class="ident" id="6175050">hasSubdir</span><span class="op" id="6175059">(</span><span class="ident" id="6175060">rootsrc</span><span class="op" id="6175067">,</span>&nbsp;<span class="ident" id="6175069">p</span><span class="op" id="6175070">.</span><span class="ident" id="6175071">Dir</span><span class="op" id="6175074">)</span><span class="op" id="6175075">;</span>&nbsp;<span class="ident" id="6175077">ok</span>&nbsp;<span class="op" id="6175080">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175086">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175135">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175190">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175209">if</span>&nbsp;<span class="ident" id="6175212">ctxt</span><span class="op" id="6175216">.</span><span class="ident" id="6175217">GOROOT</span>&nbsp;<span class="op" id="6175224">!=</span>&nbsp;<span class="string" id="6175227">&#34;&#34;</span>&nbsp;<span class="op" id="6175230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175237">if</span>&nbsp;<span class="ident" id="6175240">dir</span>&nbsp;<span class="op" id="6175244">:=</span>&nbsp;<span class="ident" id="6175247">ctxt</span><span class="op" id="6175251">.</span><span class="ident" id="6175252">joinPath</span><span class="op" id="6175260">(</span><span class="ident" id="6175261">ctxt</span><span class="op" id="6175265">.</span><span class="ident" id="6175266">GOROOT</span><span class="op" id="6175272">,</span>&nbsp;<span class="string" id="6175274">&#34;src&#34;</span><span class="op" id="6175279">,</span>&nbsp;<span class="ident" id="6175281">sub</span><span class="op" id="6175284">)</span><span class="op" id="6175285">;</span>&nbsp;<span class="ident" id="6175287">ctxt</span><span class="op" id="6175291">.</span><span class="ident" id="6175292">isDir</span><span class="op" id="6175297">(</span><span class="ident" id="6175298">dir</span><span class="op" id="6175301">)</span>&nbsp;<span class="op" id="6175303">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175311">p</span><span class="op" id="6175312">.</span><span class="ident" id="6175313">ConflictDir</span>&nbsp;<span class="op" id="6175325">=</span>&nbsp;<span class="ident" id="6175327">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175337">goto</span>&nbsp;<span class="ident" id="6175342">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175365">for</span>&nbsp;<span class="ident" id="6175369">_</span><span class="op" id="6175370">,</span>&nbsp;<span class="ident" id="6175372">earlyRoot</span>&nbsp;<span class="op" id="6175382">:=</span>&nbsp;<span class="keyword" id="6175385">range</span>&nbsp;<span class="ident" id="6175391">all</span><span class="op" id="6175394">[</span><span class="op" id="6175395">:</span><span class="ident" id="6175396">i</span><span class="op" id="6175397">]</span>&nbsp;<span class="op" id="6175399">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175406">if</span>&nbsp;<span class="ident" id="6175409">dir</span>&nbsp;<span class="op" id="6175413">:=</span>&nbsp;<span class="ident" id="6175416">ctxt</span><span class="op" id="6175420">.</span><span class="ident" id="6175421">joinPath</span><span class="op" id="6175429">(</span><span class="ident" id="6175430">earlyRoot</span><span class="op" id="6175439">,</span>&nbsp;<span class="string" id="6175441">&#34;src&#34;</span><span class="op" id="6175446">,</span>&nbsp;<span class="ident" id="6175448">sub</span><span class="op" id="6175451">)</span><span class="op" id="6175452">;</span>&nbsp;<span class="ident" id="6175454">ctxt</span><span class="op" id="6175458">.</span><span class="ident" id="6175459">isDir</span><span class="op" id="6175464">(</span><span class="ident" id="6175465">dir</span><span class="op" id="6175468">)</span>&nbsp;<span class="op" id="6175470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175478">p</span><span class="op" id="6175479">.</span><span class="ident" id="6175480">ConflictDir</span>&nbsp;<span class="op" id="6175492">=</span>&nbsp;<span class="ident" id="6175494">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175504">goto</span>&nbsp;<span class="ident" id="6175509">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175526">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175533">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175601">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175619">p</span><span class="op" id="6175620">.</span><span class="ident" id="6175621">ImportPath</span>&nbsp;<span class="op" id="6175632">=</span>&nbsp;<span class="ident" id="6175634">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175642">p</span><span class="op" id="6175643">.</span><span class="ident" id="6175644">Root</span>&nbsp;<span class="op" id="6175649">=</span>&nbsp;<span class="ident" id="6175651">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175660">goto</span>&nbsp;<span class="ident" id="6175665">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175682">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175740">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175785">}</span>&nbsp;<span class="keyword" id="6175787">else</span>&nbsp;<span class="op" id="6175792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175796">if</span>&nbsp;<span class="ident" id="6175799">strings</span><span class="op" id="6175806">.</span><span class="ident" id="6175807">HasPrefix</span><span class="op" id="6175816">(</span><span class="ident" id="6175817">path</span><span class="op" id="6175821">,</span>&nbsp;<span class="string" id="6175823">&#34;/&#34;</span><span class="op" id="6175826">)</span>&nbsp;<span class="op" id="6175828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175833">return</span>&nbsp;<span class="ident" id="6175840">p</span><span class="op" id="6175841">,</span>&nbsp;<span class="ident" id="6175843">fmt</span><span class="op" id="6175846">.</span><span class="ident" id="6175847">Errorf</span><span class="op" id="6175853">(</span><span class="string" id="6175854">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="6175894">,</span>&nbsp;<span class="ident" id="6175896">path</span><span class="op" id="6175900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6175904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6175909">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6175973">var</span>&nbsp;<span class="ident" id="6175977">tried</span>&nbsp;<span class="keyword" id="6175983">struct</span>&nbsp;<span class="op" id="6175990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6175995">goroot</span>&nbsp;<span class="builtintype" id="6176002">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176012">gopath</span>&nbsp;<span class="op" id="6176019">[</span><span class="op" id="6176020">]</span><span class="builtintype" id="6176021">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176030">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6176035">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176078">if</span>&nbsp;<span class="ident" id="6176081">ctxt</span><span class="op" id="6176085">.</span><span class="ident" id="6176086">GOROOT</span>&nbsp;<span class="op" id="6176093">!=</span>&nbsp;<span class="string" id="6176096">&#34;&#34;</span>&nbsp;<span class="op" id="6176099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176104">dir</span>&nbsp;<span class="op" id="6176108">:=</span>&nbsp;<span class="ident" id="6176111">ctxt</span><span class="op" id="6176115">.</span><span class="ident" id="6176116">joinPath</span><span class="op" id="6176124">(</span><span class="ident" id="6176125">ctxt</span><span class="op" id="6176129">.</span><span class="ident" id="6176130">GOROOT</span><span class="op" id="6176136">,</span>&nbsp;<span class="string" id="6176138">&#34;src&#34;</span><span class="op" id="6176143">,</span>&nbsp;<span class="ident" id="6176145">path</span><span class="op" id="6176149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176154">isDir</span>&nbsp;<span class="op" id="6176160">:=</span>&nbsp;<span class="ident" id="6176163">ctxt</span><span class="op" id="6176167">.</span><span class="ident" id="6176168">isDir</span><span class="op" id="6176173">(</span><span class="ident" id="6176174">dir</span><span class="op" id="6176177">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176182">binaryOnly</span>&nbsp;<span class="op" id="6176193">=</span>&nbsp;<span class="op" id="6176195">!</span><span class="ident" id="6176196">isDir</span>&nbsp;<span class="op" id="6176202">&amp;&amp;</span>&nbsp;<span class="ident" id="6176205">mode</span><span class="op" id="6176209">&amp;</span><span class="ident" id="6176210">AllowBinary</span>&nbsp;<span class="op" id="6176222">!=</span>&nbsp;<span class="num" id="6176225">0</span>&nbsp;<span class="op" id="6176227">&amp;&amp;</span>&nbsp;<span class="ident" id="6176230">pkga</span>&nbsp;<span class="op" id="6176235">!=</span>&nbsp;<span class="string" id="6176238">&#34;&#34;</span>&nbsp;<span class="op" id="6176241">&amp;&amp;</span>&nbsp;<span class="ident" id="6176244">ctxt</span><span class="op" id="6176248">.</span><span class="ident" id="6176249">isFile</span><span class="op" id="6176255">(</span><span class="ident" id="6176256">ctxt</span><span class="op" id="6176260">.</span><span class="ident" id="6176261">joinPath</span><span class="op" id="6176269">(</span><span class="ident" id="6176270">ctxt</span><span class="op" id="6176274">.</span><span class="ident" id="6176275">GOROOT</span><span class="op" id="6176281">,</span>&nbsp;<span class="ident" id="6176283">pkga</span><span class="op" id="6176287">)</span><span class="op" id="6176288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176293">if</span>&nbsp;<span class="ident" id="6176296">isDir</span>&nbsp;<span class="op" id="6176302">||</span>&nbsp;<span class="ident" id="6176305">binaryOnly</span>&nbsp;<span class="op" id="6176316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176322">p</span><span class="op" id="6176323">.</span><span class="ident" id="6176324">Dir</span>&nbsp;<span class="op" id="6176328">=</span>&nbsp;<span class="ident" id="6176330">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176338">p</span><span class="op" id="6176339">.</span><span class="ident" id="6176340">Goroot</span>&nbsp;<span class="op" id="6176347">=</span>&nbsp;<span class="ident" id="6176349">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176358">p</span><span class="op" id="6176359">.</span><span class="ident" id="6176360">Root</span>&nbsp;<span class="op" id="6176365">=</span>&nbsp;<span class="ident" id="6176367">ctxt</span><span class="op" id="6176371">.</span><span class="ident" id="6176372">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176383">goto</span>&nbsp;<span class="ident" id="6176388">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176402">tried</span><span class="op" id="6176407">.</span><span class="ident" id="6176408">goroot</span>&nbsp;<span class="op" id="6176415">=</span>&nbsp;<span class="ident" id="6176417">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176427">for</span>&nbsp;<span class="ident" id="6176431">_</span><span class="op" id="6176432">,</span>&nbsp;<span class="ident" id="6176434">root</span>&nbsp;<span class="op" id="6176439">:=</span>&nbsp;<span class="keyword" id="6176442">range</span>&nbsp;<span class="ident" id="6176448">ctxt</span><span class="op" id="6176452">.</span><span class="ident" id="6176453">gopath</span><span class="op" id="6176459">(</span><span class="op" id="6176460">)</span>&nbsp;<span class="op" id="6176462">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176467">dir</span>&nbsp;<span class="op" id="6176471">:=</span>&nbsp;<span class="ident" id="6176474">ctxt</span><span class="op" id="6176478">.</span><span class="ident" id="6176479">joinPath</span><span class="op" id="6176487">(</span><span class="ident" id="6176488">root</span><span class="op" id="6176492">,</span>&nbsp;<span class="string" id="6176494">&#34;src&#34;</span><span class="op" id="6176499">,</span>&nbsp;<span class="ident" id="6176501">path</span><span class="op" id="6176505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176510">isDir</span>&nbsp;<span class="op" id="6176516">:=</span>&nbsp;<span class="ident" id="6176519">ctxt</span><span class="op" id="6176523">.</span><span class="ident" id="6176524">isDir</span><span class="op" id="6176529">(</span><span class="ident" id="6176530">dir</span><span class="op" id="6176533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176538">binaryOnly</span>&nbsp;<span class="op" id="6176549">=</span>&nbsp;<span class="op" id="6176551">!</span><span class="ident" id="6176552">isDir</span>&nbsp;<span class="op" id="6176558">&amp;&amp;</span>&nbsp;<span class="ident" id="6176561">mode</span><span class="op" id="6176565">&amp;</span><span class="ident" id="6176566">AllowBinary</span>&nbsp;<span class="op" id="6176578">!=</span>&nbsp;<span class="num" id="6176581">0</span>&nbsp;<span class="op" id="6176583">&amp;&amp;</span>&nbsp;<span class="ident" id="6176586">pkga</span>&nbsp;<span class="op" id="6176591">!=</span>&nbsp;<span class="string" id="6176594">&#34;&#34;</span>&nbsp;<span class="op" id="6176597">&amp;&amp;</span>&nbsp;<span class="ident" id="6176600">ctxt</span><span class="op" id="6176604">.</span><span class="ident" id="6176605">isFile</span><span class="op" id="6176611">(</span><span class="ident" id="6176612">ctxt</span><span class="op" id="6176616">.</span><span class="ident" id="6176617">joinPath</span><span class="op" id="6176625">(</span><span class="ident" id="6176626">root</span><span class="op" id="6176630">,</span>&nbsp;<span class="ident" id="6176632">pkga</span><span class="op" id="6176636">)</span><span class="op" id="6176637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176642">if</span>&nbsp;<span class="ident" id="6176645">isDir</span>&nbsp;<span class="op" id="6176651">||</span>&nbsp;<span class="ident" id="6176654">binaryOnly</span>&nbsp;<span class="op" id="6176665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176671">p</span><span class="op" id="6176672">.</span><span class="ident" id="6176673">Dir</span>&nbsp;<span class="op" id="6176677">=</span>&nbsp;<span class="ident" id="6176679">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176687">p</span><span class="op" id="6176688">.</span><span class="ident" id="6176689">Root</span>&nbsp;<span class="op" id="6176694">=</span>&nbsp;<span class="ident" id="6176696">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176705">goto</span>&nbsp;<span class="ident" id="6176710">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176724">tried</span><span class="op" id="6176729">.</span><span class="ident" id="6176730">gopath</span>&nbsp;<span class="op" id="6176737">=</span>&nbsp;<span class="builtinfunc" id="6176739">append</span><span class="op" id="6176745">(</span><span class="ident" id="6176746">tried</span><span class="op" id="6176751">.</span><span class="ident" id="6176752">gopath</span><span class="op" id="6176758">,</span>&nbsp;<span class="ident" id="6176760">dir</span><span class="op" id="6176763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176767">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6176772">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176799">var</span>&nbsp;<span class="ident" id="6176803">paths</span>&nbsp;<span class="op" id="6176809">[</span><span class="op" id="6176810">]</span><span class="builtintype" id="6176811">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176820">if</span>&nbsp;<span class="ident" id="6176823">tried</span><span class="op" id="6176828">.</span><span class="ident" id="6176829">goroot</span>&nbsp;<span class="op" id="6176836">!=</span>&nbsp;<span class="string" id="6176839">&#34;&#34;</span>&nbsp;<span class="op" id="6176842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176847">paths</span>&nbsp;<span class="op" id="6176853">=</span>&nbsp;<span class="builtinfunc" id="6176855">append</span><span class="op" id="6176861">(</span><span class="ident" id="6176862">paths</span><span class="op" id="6176867">,</span>&nbsp;<span class="ident" id="6176869">fmt</span><span class="op" id="6176872">.</span><span class="ident" id="6176873">Sprintf</span><span class="op" id="6176880">(</span><span class="string" id="6176881">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="6176902">,</span>&nbsp;<span class="ident" id="6176904">tried</span><span class="op" id="6176909">.</span><span class="ident" id="6176910">goroot</span><span class="op" id="6176916">)</span><span class="op" id="6176917">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176921">}</span>&nbsp;<span class="keyword" id="6176923">else</span>&nbsp;<span class="op" id="6176928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6176933">paths</span>&nbsp;<span class="op" id="6176939">=</span>&nbsp;<span class="builtinfunc" id="6176941">append</span><span class="op" id="6176947">(</span><span class="ident" id="6176948">paths</span><span class="op" id="6176953">,</span>&nbsp;<span class="string" id="6176955">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6176976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6176980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176984">var</span>&nbsp;<span class="ident" id="6176988">i</span>&nbsp;<span class="builtintype" id="6176990">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6176996">var</span>&nbsp;<span class="ident" id="6177000">format</span>&nbsp;<span class="op" id="6177007">=</span>&nbsp;<span class="string" id="6177009">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177033">for</span>&nbsp;<span class="op" id="6177037">;</span>&nbsp;<span class="ident" id="6177039">i</span>&nbsp;<span class="op" id="6177041">&lt;</span>&nbsp;<span class="builtinfunc" id="6177043">len</span><span class="op" id="6177046">(</span><span class="ident" id="6177047">tried</span><span class="op" id="6177052">.</span><span class="ident" id="6177053">gopath</span><span class="op" id="6177059">)</span><span class="op" id="6177060">;</span>&nbsp;<span class="ident" id="6177062">i</span><span class="op" id="6177063">++</span>&nbsp;<span class="op" id="6177066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177071">if</span>&nbsp;<span class="ident" id="6177074">i</span>&nbsp;<span class="op" id="6177076">&gt;</span>&nbsp;<span class="num" id="6177078">0</span>&nbsp;<span class="op" id="6177080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177086">format</span>&nbsp;<span class="op" id="6177093">=</span>&nbsp;<span class="string" id="6177095">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177110">paths</span>&nbsp;<span class="op" id="6177116">=</span>&nbsp;<span class="builtinfunc" id="6177118">append</span><span class="op" id="6177124">(</span><span class="ident" id="6177125">paths</span><span class="op" id="6177130">,</span>&nbsp;<span class="ident" id="6177132">fmt</span><span class="op" id="6177135">.</span><span class="ident" id="6177136">Sprintf</span><span class="op" id="6177143">(</span><span class="ident" id="6177144">format</span><span class="op" id="6177150">,</span>&nbsp;<span class="ident" id="6177152">tried</span><span class="op" id="6177157">.</span><span class="ident" id="6177158">gopath</span><span class="op" id="6177164">[</span><span class="ident" id="6177165">i</span><span class="op" id="6177166">]</span><span class="op" id="6177167">)</span><span class="op" id="6177168">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177176">if</span>&nbsp;<span class="ident" id="6177179">i</span>&nbsp;<span class="op" id="6177181">==</span>&nbsp;<span class="num" id="6177184">0</span>&nbsp;<span class="op" id="6177186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177191">paths</span>&nbsp;<span class="op" id="6177197">=</span>&nbsp;<span class="builtinfunc" id="6177199">append</span><span class="op" id="6177205">(</span><span class="ident" id="6177206">paths</span><span class="op" id="6177211">,</span>&nbsp;<span class="string" id="6177213">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6177234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177242">return</span>&nbsp;<span class="ident" id="6177249">p</span><span class="op" id="6177250">,</span>&nbsp;<span class="ident" id="6177252">fmt</span><span class="op" id="6177255">.</span><span class="ident" id="6177256">Errorf</span><span class="op" id="6177262">(</span><span class="string" id="6177263">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="6177302">,</span>&nbsp;<span class="ident" id="6177304">path</span><span class="op" id="6177308">,</span>&nbsp;<span class="ident" id="6177310">strings</span><span class="op" id="6177317">.</span><span class="ident" id="6177318">Join</span><span class="op" id="6177322">(</span><span class="ident" id="6177323">paths</span><span class="op" id="6177328">,</span>&nbsp;<span class="string" id="6177330">&#34;\n&#34;</span><span class="op" id="6177334">)</span><span class="op" id="6177335">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6177341">Found</span><span class="op" id="6177346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177349">if</span>&nbsp;<span class="ident" id="6177352">p</span><span class="op" id="6177353">.</span><span class="ident" id="6177354">Root</span>&nbsp;<span class="op" id="6177359">!=</span>&nbsp;<span class="string" id="6177362">&#34;&#34;</span>&nbsp;<span class="op" id="6177365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177369">p</span><span class="op" id="6177370">.</span><span class="ident" id="6177371">SrcRoot</span>&nbsp;<span class="op" id="6177379">=</span>&nbsp;<span class="ident" id="6177381">ctxt</span><span class="op" id="6177385">.</span><span class="ident" id="6177386">joinPath</span><span class="op" id="6177394">(</span><span class="ident" id="6177395">p</span><span class="op" id="6177396">.</span><span class="ident" id="6177397">Root</span><span class="op" id="6177401">,</span>&nbsp;<span class="string" id="6177403">&#34;src&#34;</span><span class="op" id="6177408">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177412">p</span><span class="op" id="6177413">.</span><span class="ident" id="6177414">PkgRoot</span>&nbsp;<span class="op" id="6177422">=</span>&nbsp;<span class="ident" id="6177424">ctxt</span><span class="op" id="6177428">.</span><span class="ident" id="6177429">joinPath</span><span class="op" id="6177437">(</span><span class="ident" id="6177438">p</span><span class="op" id="6177439">.</span><span class="ident" id="6177440">Root</span><span class="op" id="6177444">,</span>&nbsp;<span class="string" id="6177446">&#34;pkg&#34;</span><span class="op" id="6177451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177455">p</span><span class="op" id="6177456">.</span><span class="ident" id="6177457">BinDir</span>&nbsp;<span class="op" id="6177464">=</span>&nbsp;<span class="ident" id="6177466">ctxt</span><span class="op" id="6177470">.</span><span class="ident" id="6177471">joinPath</span><span class="op" id="6177479">(</span><span class="ident" id="6177480">p</span><span class="op" id="6177481">.</span><span class="ident" id="6177482">Root</span><span class="op" id="6177486">,</span>&nbsp;<span class="string" id="6177488">&#34;bin&#34;</span><span class="op" id="6177493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177497">if</span>&nbsp;<span class="ident" id="6177500">pkga</span>&nbsp;<span class="op" id="6177505">!=</span>&nbsp;<span class="string" id="6177508">&#34;&#34;</span>&nbsp;<span class="op" id="6177511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177516">p</span><span class="op" id="6177517">.</span><span class="ident" id="6177518">PkgObj</span>&nbsp;<span class="op" id="6177525">=</span>&nbsp;<span class="ident" id="6177527">ctxt</span><span class="op" id="6177531">.</span><span class="ident" id="6177532">joinPath</span><span class="op" id="6177540">(</span><span class="ident" id="6177541">p</span><span class="op" id="6177542">.</span><span class="ident" id="6177543">Root</span><span class="op" id="6177547">,</span>&nbsp;<span class="ident" id="6177549">pkga</span><span class="op" id="6177553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177557">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177564">if</span>&nbsp;<span class="ident" id="6177567">mode</span><span class="op" id="6177571">&amp;</span><span class="ident" id="6177572">FindOnly</span>&nbsp;<span class="op" id="6177581">!=</span>&nbsp;<span class="num" id="6177584">0</span>&nbsp;<span class="op" id="6177586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177590">return</span>&nbsp;<span class="ident" id="6177597">p</span><span class="op" id="6177598">,</span>&nbsp;<span class="ident" id="6177600">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177608">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177611">if</span>&nbsp;<span class="ident" id="6177614">binaryOnly</span>&nbsp;<span class="op" id="6177625">&amp;&amp;</span>&nbsp;<span class="op" id="6177628">(</span><span class="ident" id="6177629">mode</span><span class="op" id="6177633">&amp;</span><span class="ident" id="6177634">AllowBinary</span><span class="op" id="6177645">)</span>&nbsp;<span class="op" id="6177647">!=</span>&nbsp;<span class="num" id="6177650">0</span>&nbsp;<span class="op" id="6177652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177656">return</span>&nbsp;<span class="ident" id="6177663">p</span><span class="op" id="6177664">,</span>&nbsp;<span class="ident" id="6177666">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177678">dirs</span><span class="op" id="6177682">,</span>&nbsp;<span class="ident" id="6177684">err</span>&nbsp;<span class="op" id="6177688">:=</span>&nbsp;<span class="ident" id="6177691">ctxt</span><span class="op" id="6177695">.</span><span class="ident" id="6177696">readDir</span><span class="op" id="6177703">(</span><span class="ident" id="6177704">p</span><span class="op" id="6177705">.</span><span class="ident" id="6177706">Dir</span><span class="op" id="6177709">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177712">if</span>&nbsp;<span class="ident" id="6177715">err</span>&nbsp;<span class="op" id="6177719">!=</span>&nbsp;<span class="ident" id="6177722">nil</span>&nbsp;<span class="op" id="6177726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177730">return</span>&nbsp;<span class="ident" id="6177737">p</span><span class="op" id="6177738">,</span>&nbsp;<span class="ident" id="6177740">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6177745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177749">var</span>&nbsp;<span class="ident" id="6177753">Sfiles</span>&nbsp;<span class="op" id="6177760">[</span><span class="op" id="6177761">]</span><span class="builtintype" id="6177762">string</span>&nbsp;<span class="comment" id="6177769">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6177801">var</span>&nbsp;<span class="ident" id="6177805">firstFile</span><span class="op" id="6177814">,</span>&nbsp;<span class="ident" id="6177816">firstCommentFile</span>&nbsp;<span class="builtintype" id="6177833">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177841">imported</span>&nbsp;<span class="op" id="6177850">:=</span>&nbsp;<span class="builtinfunc" id="6177853">make</span><span class="op" id="6177857">(</span><span class="keyword" id="6177858">map</span><span class="op" id="6177861">[</span><span class="builtintype" id="6177862">string</span><span class="op" id="6177868">]</span><span class="op" id="6177869">[</span><span class="op" id="6177870">]</span><span class="ident" id="6177871">token</span><span class="op" id="6177876">.</span><span class="ident" id="6177877">Position</span><span class="op" id="6177885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177888">testImported</span>&nbsp;<span class="op" id="6177901">:=</span>&nbsp;<span class="builtinfunc" id="6177904">make</span><span class="op" id="6177908">(</span><span class="keyword" id="6177909">map</span><span class="op" id="6177912">[</span><span class="builtintype" id="6177913">string</span><span class="op" id="6177919">]</span><span class="op" id="6177920">[</span><span class="op" id="6177921">]</span><span class="ident" id="6177922">token</span><span class="op" id="6177927">.</span><span class="ident" id="6177928">Position</span><span class="op" id="6177936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177939">xTestImported</span>&nbsp;<span class="op" id="6177953">:=</span>&nbsp;<span class="builtinfunc" id="6177956">make</span><span class="op" id="6177960">(</span><span class="keyword" id="6177961">map</span><span class="op" id="6177964">[</span><span class="builtintype" id="6177965">string</span><span class="op" id="6177971">]</span><span class="op" id="6177972">[</span><span class="op" id="6177973">]</span><span class="ident" id="6177974">token</span><span class="op" id="6177979">.</span><span class="ident" id="6177980">Position</span><span class="op" id="6177988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6177991">allTags</span>&nbsp;<span class="op" id="6177999">:=</span>&nbsp;<span class="builtinfunc" id="6178002">make</span><span class="op" id="6178006">(</span><span class="keyword" id="6178007">map</span><span class="op" id="6178010">[</span><span class="builtintype" id="6178011">string</span><span class="op" id="6178017">]</span><span class="builtintype" id="6178018">bool</span><span class="op" id="6178022">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178025">fset</span>&nbsp;<span class="op" id="6178030">:=</span>&nbsp;<span class="ident" id="6178033">token</span><span class="op" id="6178038">.</span><span class="ident" id="6178039">NewFileSet</span><span class="op" id="6178049">(</span><span class="op" id="6178050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178053">for</span>&nbsp;<span class="ident" id="6178057">_</span><span class="op" id="6178058">,</span>&nbsp;<span class="ident" id="6178060">d</span>&nbsp;<span class="op" id="6178062">:=</span>&nbsp;<span class="keyword" id="6178065">range</span>&nbsp;<span class="ident" id="6178071">dirs</span>&nbsp;<span class="op" id="6178076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178080">if</span>&nbsp;<span class="ident" id="6178083">d</span><span class="op" id="6178084">.</span><span class="ident" id="6178085">IsDir</span><span class="op" id="6178090">(</span><span class="op" id="6178091">)</span>&nbsp;<span class="op" id="6178093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178098">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6178109">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178114">name</span>&nbsp;<span class="op" id="6178119">:=</span>&nbsp;<span class="ident" id="6178122">d</span><span class="op" id="6178123">.</span><span class="ident" id="6178124">Name</span><span class="op" id="6178128">(</span><span class="op" id="6178129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178133">ext</span>&nbsp;<span class="op" id="6178137">:=</span>&nbsp;<span class="ident" id="6178140">nameExt</span><span class="op" id="6178147">(</span><span class="ident" id="6178148">name</span><span class="op" id="6178152">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178157">match</span><span class="op" id="6178162">,</span>&nbsp;<span class="ident" id="6178164">data</span><span class="op" id="6178168">,</span>&nbsp;<span class="ident" id="6178170">filename</span><span class="op" id="6178178">,</span>&nbsp;<span class="ident" id="6178180">err</span>&nbsp;<span class="op" id="6178184">:=</span>&nbsp;<span class="ident" id="6178187">ctxt</span><span class="op" id="6178191">.</span><span class="ident" id="6178192">matchFile</span><span class="op" id="6178201">(</span><span class="ident" id="6178202">p</span><span class="op" id="6178203">.</span><span class="ident" id="6178204">Dir</span><span class="op" id="6178207">,</span>&nbsp;<span class="ident" id="6178209">name</span><span class="op" id="6178213">,</span>&nbsp;<span class="ident" id="6178215">true</span><span class="op" id="6178219">,</span>&nbsp;<span class="ident" id="6178221">allTags</span><span class="op" id="6178228">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178232">if</span>&nbsp;<span class="ident" id="6178235">err</span>&nbsp;<span class="op" id="6178239">!=</span>&nbsp;<span class="ident" id="6178242">nil</span>&nbsp;<span class="op" id="6178246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178251">return</span>&nbsp;<span class="ident" id="6178258">p</span><span class="op" id="6178259">,</span>&nbsp;<span class="ident" id="6178261">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6178267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178271">if</span>&nbsp;<span class="op" id="6178274">!</span><span class="ident" id="6178275">match</span>&nbsp;<span class="op" id="6178281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178286">if</span>&nbsp;<span class="ident" id="6178289">ext</span>&nbsp;<span class="op" id="6178293">==</span>&nbsp;<span class="string" id="6178296">&#34;.go&#34;</span>&nbsp;<span class="op" id="6178302">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178308">p</span><span class="op" id="6178309">.</span><span class="ident" id="6178310">IgnoredGoFiles</span>&nbsp;<span class="op" id="6178325">=</span>&nbsp;<span class="builtinfunc" id="6178327">append</span><span class="op" id="6178333">(</span><span class="ident" id="6178334">p</span><span class="op" id="6178335">.</span><span class="ident" id="6178336">IgnoredGoFiles</span><span class="op" id="6178350">,</span>&nbsp;<span class="ident" id="6178352">name</span><span class="op" id="6178356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6178361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178366">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6178377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6178382">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178445">switch</span>&nbsp;<span class="ident" id="6178452">ext</span>&nbsp;<span class="op" id="6178456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178460">case</span>&nbsp;<span class="string" id="6178465">&#34;.c&#34;</span><span class="op" id="6178469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178474">p</span><span class="op" id="6178475">.</span><span class="ident" id="6178476">CFiles</span>&nbsp;<span class="op" id="6178483">=</span>&nbsp;<span class="builtinfunc" id="6178485">append</span><span class="op" id="6178491">(</span><span class="ident" id="6178492">p</span><span class="op" id="6178493">.</span><span class="ident" id="6178494">CFiles</span><span class="op" id="6178500">,</span>&nbsp;<span class="ident" id="6178502">name</span><span class="op" id="6178506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178511">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178522">case</span>&nbsp;<span class="string" id="6178527">&#34;.cc&#34;</span><span class="op" id="6178532">,</span>&nbsp;<span class="string" id="6178534">&#34;.cpp&#34;</span><span class="op" id="6178540">,</span>&nbsp;<span class="string" id="6178542">&#34;.cxx&#34;</span><span class="op" id="6178548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178553">p</span><span class="op" id="6178554">.</span><span class="ident" id="6178555">CXXFiles</span>&nbsp;<span class="op" id="6178564">=</span>&nbsp;<span class="builtinfunc" id="6178566">append</span><span class="op" id="6178572">(</span><span class="ident" id="6178573">p</span><span class="op" id="6178574">.</span><span class="ident" id="6178575">CXXFiles</span><span class="op" id="6178583">,</span>&nbsp;<span class="ident" id="6178585">name</span><span class="op" id="6178589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178594">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178605">case</span>&nbsp;<span class="string" id="6178610">&#34;.m&#34;</span><span class="op" id="6178614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178619">p</span><span class="op" id="6178620">.</span><span class="ident" id="6178621">MFiles</span>&nbsp;<span class="op" id="6178628">=</span>&nbsp;<span class="builtinfunc" id="6178630">append</span><span class="op" id="6178636">(</span><span class="ident" id="6178637">p</span><span class="op" id="6178638">.</span><span class="ident" id="6178639">MFiles</span><span class="op" id="6178645">,</span>&nbsp;<span class="ident" id="6178647">name</span><span class="op" id="6178651">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178656">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178667">case</span>&nbsp;<span class="string" id="6178672">&#34;.h&#34;</span><span class="op" id="6178676">,</span>&nbsp;<span class="string" id="6178678">&#34;.hh&#34;</span><span class="op" id="6178683">,</span>&nbsp;<span class="string" id="6178685">&#34;.hpp&#34;</span><span class="op" id="6178691">,</span>&nbsp;<span class="string" id="6178693">&#34;.hxx&#34;</span><span class="op" id="6178699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178704">p</span><span class="op" id="6178705">.</span><span class="ident" id="6178706">HFiles</span>&nbsp;<span class="op" id="6178713">=</span>&nbsp;<span class="builtinfunc" id="6178715">append</span><span class="op" id="6178721">(</span><span class="ident" id="6178722">p</span><span class="op" id="6178723">.</span><span class="ident" id="6178724">HFiles</span><span class="op" id="6178730">,</span>&nbsp;<span class="ident" id="6178732">name</span><span class="op" id="6178736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178741">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178752">case</span>&nbsp;<span class="string" id="6178757">&#34;.s&#34;</span><span class="op" id="6178761">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178766">p</span><span class="op" id="6178767">.</span><span class="ident" id="6178768">SFiles</span>&nbsp;<span class="op" id="6178775">=</span>&nbsp;<span class="builtinfunc" id="6178777">append</span><span class="op" id="6178783">(</span><span class="ident" id="6178784">p</span><span class="op" id="6178785">.</span><span class="ident" id="6178786">SFiles</span><span class="op" id="6178792">,</span>&nbsp;<span class="ident" id="6178794">name</span><span class="op" id="6178798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178803">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178814">case</span>&nbsp;<span class="string" id="6178819">&#34;.S&#34;</span><span class="op" id="6178823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178828">Sfiles</span>&nbsp;<span class="op" id="6178835">=</span>&nbsp;<span class="builtinfunc" id="6178837">append</span><span class="op" id="6178843">(</span><span class="ident" id="6178844">Sfiles</span><span class="op" id="6178850">,</span>&nbsp;<span class="ident" id="6178852">name</span><span class="op" id="6178856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178861">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178872">case</span>&nbsp;<span class="string" id="6178877">&#34;.swig&#34;</span><span class="op" id="6178884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178889">p</span><span class="op" id="6178890">.</span><span class="ident" id="6178891">SwigFiles</span>&nbsp;<span class="op" id="6178901">=</span>&nbsp;<span class="builtinfunc" id="6178903">append</span><span class="op" id="6178909">(</span><span class="ident" id="6178910">p</span><span class="op" id="6178911">.</span><span class="ident" id="6178912">SwigFiles</span><span class="op" id="6178921">,</span>&nbsp;<span class="ident" id="6178923">name</span><span class="op" id="6178927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178932">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6178943">case</span>&nbsp;<span class="string" id="6178948">&#34;.swigcxx&#34;</span><span class="op" id="6178958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6178963">p</span><span class="op" id="6178964">.</span><span class="ident" id="6178965">SwigCXXFiles</span>&nbsp;<span class="op" id="6178978">=</span>&nbsp;<span class="builtinfunc" id="6178980">append</span><span class="op" id="6178986">(</span><span class="ident" id="6178987">p</span><span class="op" id="6178988">.</span><span class="ident" id="6178989">SwigCXXFiles</span><span class="op" id="6179001">,</span>&nbsp;<span class="ident" id="6179003">name</span><span class="op" id="6179007">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179012">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179023">case</span>&nbsp;<span class="string" id="6179028">&#34;.syso&#34;</span><span class="op" id="6179035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6179040">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6179087">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6179134">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179187">p</span><span class="op" id="6179188">.</span><span class="ident" id="6179189">SysoFiles</span>&nbsp;<span class="op" id="6179199">=</span>&nbsp;<span class="builtinfunc" id="6179201">append</span><span class="op" id="6179207">(</span><span class="ident" id="6179208">p</span><span class="op" id="6179209">.</span><span class="ident" id="6179210">SysoFiles</span><span class="op" id="6179219">,</span>&nbsp;<span class="ident" id="6179221">name</span><span class="op" id="6179225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179230">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179246">pf</span><span class="op" id="6179248">,</span>&nbsp;<span class="ident" id="6179250">err</span>&nbsp;<span class="op" id="6179254">:=</span>&nbsp;<span class="ident" id="6179257">parser</span><span class="op" id="6179263">.</span><span class="ident" id="6179264">ParseFile</span><span class="op" id="6179273">(</span><span class="ident" id="6179274">fset</span><span class="op" id="6179278">,</span>&nbsp;<span class="ident" id="6179280">filename</span><span class="op" id="6179288">,</span>&nbsp;<span class="ident" id="6179290">data</span><span class="op" id="6179294">,</span>&nbsp;<span class="ident" id="6179296">parser</span><span class="op" id="6179302">.</span><span class="ident" id="6179303">ImportsOnly</span><span class="op" id="6179314">|</span><span class="ident" id="6179315">parser</span><span class="op" id="6179321">.</span><span class="ident" id="6179322">ParseComments</span><span class="op" id="6179335">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179339">if</span>&nbsp;<span class="ident" id="6179342">err</span>&nbsp;<span class="op" id="6179346">!=</span>&nbsp;<span class="ident" id="6179349">nil</span>&nbsp;<span class="op" id="6179353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179358">return</span>&nbsp;<span class="ident" id="6179365">p</span><span class="op" id="6179366">,</span>&nbsp;<span class="ident" id="6179368">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179379">pkg</span>&nbsp;<span class="op" id="6179383">:=</span>&nbsp;<span class="ident" id="6179386">pf</span><span class="op" id="6179388">.</span><span class="ident" id="6179389">Name</span><span class="op" id="6179393">.</span><span class="ident" id="6179394">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179401">if</span>&nbsp;<span class="ident" id="6179404">pkg</span>&nbsp;<span class="op" id="6179408">==</span>&nbsp;<span class="string" id="6179411">&#34;documentation&#34;</span>&nbsp;<span class="op" id="6179427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179432">p</span><span class="op" id="6179433">.</span><span class="ident" id="6179434">IgnoredGoFiles</span>&nbsp;<span class="op" id="6179449">=</span>&nbsp;<span class="builtinfunc" id="6179451">append</span><span class="op" id="6179457">(</span><span class="ident" id="6179458">p</span><span class="op" id="6179459">.</span><span class="ident" id="6179460">IgnoredGoFiles</span><span class="op" id="6179474">,</span>&nbsp;<span class="ident" id="6179476">name</span><span class="op" id="6179480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179485">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179501">isTest</span>&nbsp;<span class="op" id="6179508">:=</span>&nbsp;<span class="ident" id="6179511">strings</span><span class="op" id="6179518">.</span><span class="ident" id="6179519">HasSuffix</span><span class="op" id="6179528">(</span><span class="ident" id="6179529">name</span><span class="op" id="6179533">,</span>&nbsp;<span class="string" id="6179535">&#34;_test.go&#34;</span><span class="op" id="6179545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179549">isXTest</span>&nbsp;<span class="op" id="6179557">:=</span>&nbsp;<span class="ident" id="6179560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179568">if</span>&nbsp;<span class="ident" id="6179571">isTest</span>&nbsp;<span class="op" id="6179578">&amp;&amp;</span>&nbsp;<span class="ident" id="6179581">strings</span><span class="op" id="6179588">.</span><span class="ident" id="6179589">HasSuffix</span><span class="op" id="6179598">(</span><span class="ident" id="6179599">pkg</span><span class="op" id="6179602">,</span>&nbsp;<span class="string" id="6179604">&#34;_test&#34;</span><span class="op" id="6179611">)</span>&nbsp;<span class="op" id="6179613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179618">isXTest</span>&nbsp;<span class="op" id="6179626">=</span>&nbsp;<span class="ident" id="6179628">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179636">pkg</span>&nbsp;<span class="op" id="6179640">=</span>&nbsp;<span class="ident" id="6179642">pkg</span><span class="op" id="6179645">[</span><span class="op" id="6179646">:</span><span class="builtinfunc" id="6179647">len</span><span class="op" id="6179650">(</span><span class="ident" id="6179651">pkg</span><span class="op" id="6179654">)</span><span class="op" id="6179655">-</span><span class="builtinfunc" id="6179656">len</span><span class="op" id="6179659">(</span><span class="string" id="6179660">&#34;_test&#34;</span><span class="op" id="6179667">)</span><span class="op" id="6179668">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179677">if</span>&nbsp;<span class="ident" id="6179680">p</span><span class="op" id="6179681">.</span><span class="ident" id="6179682">Name</span>&nbsp;<span class="op" id="6179687">==</span>&nbsp;<span class="string" id="6179690">&#34;&#34;</span>&nbsp;<span class="op" id="6179693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179698">p</span><span class="op" id="6179699">.</span><span class="ident" id="6179700">Name</span>&nbsp;<span class="op" id="6179705">=</span>&nbsp;<span class="ident" id="6179707">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179714">firstFile</span>&nbsp;<span class="op" id="6179724">=</span>&nbsp;<span class="ident" id="6179726">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179733">}</span>&nbsp;<span class="keyword" id="6179735">else</span>&nbsp;<span class="keyword" id="6179740">if</span>&nbsp;<span class="ident" id="6179743">pkg</span>&nbsp;<span class="op" id="6179747">!=</span>&nbsp;<span class="ident" id="6179750">p</span><span class="op" id="6179751">.</span><span class="ident" id="6179752">Name</span>&nbsp;<span class="op" id="6179757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179762">return</span>&nbsp;<span class="ident" id="6179769">p</span><span class="op" id="6179770">,</span>&nbsp;<span class="op" id="6179772">&amp;</span><span class="ident" id="6179773">MultiplePackageError</span><span class="op" id="6179793">{</span><span class="ident" id="6179794">p</span><span class="op" id="6179795">.</span><span class="ident" id="6179796">Dir</span><span class="op" id="6179799">,</span>&nbsp;<span class="op" id="6179801">[</span><span class="op" id="6179802">]</span><span class="builtintype" id="6179803">string</span><span class="op" id="6179809">{</span><span class="ident" id="6179810">firstFile</span><span class="op" id="6179819">,</span>&nbsp;<span class="ident" id="6179821">name</span><span class="op" id="6179825">}</span><span class="op" id="6179826">,</span>&nbsp;<span class="op" id="6179828">[</span><span class="op" id="6179829">]</span><span class="builtintype" id="6179830">string</span><span class="op" id="6179836">{</span><span class="ident" id="6179837">p</span><span class="op" id="6179838">.</span><span class="ident" id="6179839">Name</span><span class="op" id="6179843">,</span>&nbsp;<span class="ident" id="6179845">pkg</span><span class="op" id="6179848">}</span><span class="op" id="6179849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179857">if</span>&nbsp;<span class="ident" id="6179860">pf</span><span class="op" id="6179862">.</span><span class="ident" id="6179863">Doc</span>&nbsp;<span class="op" id="6179867">!=</span>&nbsp;<span class="ident" id="6179870">nil</span>&nbsp;<span class="op" id="6179874">&amp;&amp;</span>&nbsp;<span class="ident" id="6179877">p</span><span class="op" id="6179878">.</span><span class="ident" id="6179879">Doc</span>&nbsp;<span class="op" id="6179883">==</span>&nbsp;<span class="string" id="6179886">&#34;&#34;</span>&nbsp;<span class="op" id="6179889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179894">p</span><span class="op" id="6179895">.</span><span class="ident" id="6179896">Doc</span>&nbsp;<span class="op" id="6179900">=</span>&nbsp;<span class="ident" id="6179902">doc</span><span class="op" id="6179905">.</span><span class="ident" id="6179906">Synopsis</span><span class="op" id="6179914">(</span><span class="ident" id="6179915">pf</span><span class="op" id="6179917">.</span><span class="ident" id="6179918">Doc</span><span class="op" id="6179921">.</span><span class="ident" id="6179922">Text</span><span class="op" id="6179926">(</span><span class="op" id="6179927">)</span><span class="op" id="6179928">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6179932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6179937">if</span>&nbsp;<span class="ident" id="6179940">mode</span><span class="op" id="6179944">&amp;</span><span class="ident" id="6179945">ImportComment</span>&nbsp;<span class="op" id="6179959">!=</span>&nbsp;<span class="num" id="6179962">0</span>&nbsp;<span class="op" id="6179964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6179969">qcom</span><span class="op" id="6179973">,</span>&nbsp;<span class="ident" id="6179975">line</span>&nbsp;<span class="op" id="6179980">:=</span>&nbsp;<span class="ident" id="6179983">findImportComment</span><span class="op" id="6180000">(</span><span class="ident" id="6180001">data</span><span class="op" id="6180005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180010">if</span>&nbsp;<span class="ident" id="6180013">line</span>&nbsp;<span class="op" id="6180018">!=</span>&nbsp;<span class="num" id="6180021">0</span>&nbsp;<span class="op" id="6180023">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180029">com</span><span class="op" id="6180032">,</span>&nbsp;<span class="ident" id="6180034">err</span>&nbsp;<span class="op" id="6180038">:=</span>&nbsp;<span class="ident" id="6180041">strconv</span><span class="op" id="6180048">.</span><span class="ident" id="6180049">Unquote</span><span class="op" id="6180056">(</span><span class="ident" id="6180057">qcom</span><span class="op" id="6180061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180067">if</span>&nbsp;<span class="ident" id="6180070">err</span>&nbsp;<span class="op" id="6180074">!=</span>&nbsp;<span class="ident" id="6180077">nil</span>&nbsp;<span class="op" id="6180081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180088">return</span>&nbsp;<span class="ident" id="6180095">p</span><span class="op" id="6180096">,</span>&nbsp;<span class="ident" id="6180098">fmt</span><span class="op" id="6180101">.</span><span class="ident" id="6180102">Errorf</span><span class="op" id="6180108">(</span><span class="string" id="6180109">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="6180145">,</span>&nbsp;<span class="ident" id="6180147">filename</span><span class="op" id="6180155">,</span>&nbsp;<span class="ident" id="6180157">line</span><span class="op" id="6180161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180173">if</span>&nbsp;<span class="ident" id="6180176">p</span><span class="op" id="6180177">.</span><span class="ident" id="6180178">ImportComment</span>&nbsp;<span class="op" id="6180192">==</span>&nbsp;<span class="string" id="6180195">&#34;&#34;</span>&nbsp;<span class="op" id="6180198">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180205">p</span><span class="op" id="6180206">.</span><span class="ident" id="6180207">ImportComment</span>&nbsp;<span class="op" id="6180221">=</span>&nbsp;<span class="ident" id="6180223">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180232">firstCommentFile</span>&nbsp;<span class="op" id="6180249">=</span>&nbsp;<span class="ident" id="6180251">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180260">}</span>&nbsp;<span class="keyword" id="6180262">else</span>&nbsp;<span class="keyword" id="6180267">if</span>&nbsp;<span class="ident" id="6180270">p</span><span class="op" id="6180271">.</span><span class="ident" id="6180272">ImportComment</span>&nbsp;<span class="op" id="6180286">!=</span>&nbsp;<span class="ident" id="6180289">com</span>&nbsp;<span class="op" id="6180293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180300">return</span>&nbsp;<span class="ident" id="6180307">p</span><span class="op" id="6180308">,</span>&nbsp;<span class="ident" id="6180310">fmt</span><span class="op" id="6180313">.</span><span class="ident" id="6180314">Errorf</span><span class="op" id="6180320">(</span><span class="string" id="6180321">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6180370">,</span>&nbsp;<span class="ident" id="6180372">p</span><span class="op" id="6180373">.</span><span class="ident" id="6180374">ImportComment</span><span class="op" id="6180387">,</span>&nbsp;<span class="ident" id="6180389">firstCommentFile</span><span class="op" id="6180405">,</span>&nbsp;<span class="ident" id="6180407">com</span><span class="op" id="6180410">,</span>&nbsp;<span class="ident" id="6180412">name</span><span class="op" id="6180416">,</span>&nbsp;<span class="ident" id="6180418">p</span><span class="op" id="6180419">.</span><span class="ident" id="6180420">Dir</span><span class="op" id="6180423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180429">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6180443">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180490">isCgo</span>&nbsp;<span class="op" id="6180496">:=</span>&nbsp;<span class="ident" id="6180499">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180507">for</span>&nbsp;<span class="ident" id="6180511">_</span><span class="op" id="6180512">,</span>&nbsp;<span class="ident" id="6180514">decl</span>&nbsp;<span class="op" id="6180519">:=</span>&nbsp;<span class="keyword" id="6180522">range</span>&nbsp;<span class="ident" id="6180528">pf</span><span class="op" id="6180530">.</span><span class="ident" id="6180531">Decls</span>&nbsp;<span class="op" id="6180537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180542">d</span><span class="op" id="6180543">,</span>&nbsp;<span class="ident" id="6180545">ok</span>&nbsp;<span class="op" id="6180548">:=</span>&nbsp;<span class="ident" id="6180551">decl</span><span class="op" id="6180555">.</span><span class="op" id="6180556">(</span><span class="op" id="6180557">*</span><span class="ident" id="6180558">ast</span><span class="op" id="6180561">.</span><span class="ident" id="6180562">GenDecl</span><span class="op" id="6180569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180574">if</span>&nbsp;<span class="op" id="6180577">!</span><span class="ident" id="6180578">ok</span>&nbsp;<span class="op" id="6180581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180587">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180599">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180604">for</span>&nbsp;<span class="ident" id="6180608">_</span><span class="op" id="6180609">,</span>&nbsp;<span class="ident" id="6180611">dspec</span>&nbsp;<span class="op" id="6180617">:=</span>&nbsp;<span class="keyword" id="6180620">range</span>&nbsp;<span class="ident" id="6180626">d</span><span class="op" id="6180627">.</span><span class="ident" id="6180628">Specs</span>&nbsp;<span class="op" id="6180634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180640">spec</span><span class="op" id="6180644">,</span>&nbsp;<span class="ident" id="6180646">ok</span>&nbsp;<span class="op" id="6180649">:=</span>&nbsp;<span class="ident" id="6180652">dspec</span><span class="op" id="6180657">.</span><span class="op" id="6180658">(</span><span class="op" id="6180659">*</span><span class="ident" id="6180660">ast</span><span class="op" id="6180663">.</span><span class="ident" id="6180664">ImportSpec</span><span class="op" id="6180674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180680">if</span>&nbsp;<span class="op" id="6180683">!</span><span class="ident" id="6180684">ok</span>&nbsp;<span class="op" id="6180687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180694">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180707">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180713">quoted</span>&nbsp;<span class="op" id="6180720">:=</span>&nbsp;<span class="ident" id="6180723">spec</span><span class="op" id="6180727">.</span><span class="ident" id="6180728">Path</span><span class="op" id="6180732">.</span><span class="ident" id="6180733">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180743">path</span><span class="op" id="6180747">,</span>&nbsp;<span class="ident" id="6180749">err</span>&nbsp;<span class="op" id="6180753">:=</span>&nbsp;<span class="ident" id="6180756">strconv</span><span class="op" id="6180763">.</span><span class="ident" id="6180764">Unquote</span><span class="op" id="6180771">(</span><span class="ident" id="6180772">quoted</span><span class="op" id="6180778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180784">if</span>&nbsp;<span class="ident" id="6180787">err</span>&nbsp;<span class="op" id="6180791">!=</span>&nbsp;<span class="ident" id="6180794">nil</span>&nbsp;<span class="op" id="6180798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180805">log</span><span class="op" id="6180808">.</span><span class="ident" id="6180809">Panicf</span><span class="op" id="6180815">(</span><span class="string" id="6180816">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6180865">,</span>&nbsp;<span class="ident" id="6180867">filename</span><span class="op" id="6180875">,</span>&nbsp;<span class="ident" id="6180877">quoted</span><span class="op" id="6180883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180889">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6180895">if</span>&nbsp;<span class="ident" id="6180898">isXTest</span>&nbsp;<span class="op" id="6180906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6180913">xTestImported</span><span class="op" id="6180926">[</span><span class="ident" id="6180927">path</span><span class="op" id="6180931">]</span>&nbsp;<span class="op" id="6180933">=</span>&nbsp;<span class="builtinfunc" id="6180935">append</span><span class="op" id="6180941">(</span><span class="ident" id="6180942">xTestImported</span><span class="op" id="6180955">[</span><span class="ident" id="6180956">path</span><span class="op" id="6180960">]</span><span class="op" id="6180961">,</span>&nbsp;<span class="ident" id="6180963">fset</span><span class="op" id="6180967">.</span><span class="ident" id="6180968">Position</span><span class="op" id="6180976">(</span><span class="ident" id="6180977">spec</span><span class="op" id="6180981">.</span><span class="ident" id="6180982">Pos</span><span class="op" id="6180985">(</span><span class="op" id="6180986">)</span><span class="op" id="6180987">)</span><span class="op" id="6180988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6180994">}</span>&nbsp;<span class="keyword" id="6180996">else</span>&nbsp;<span class="keyword" id="6181001">if</span>&nbsp;<span class="ident" id="6181004">isTest</span>&nbsp;<span class="op" id="6181011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181018">testImported</span><span class="op" id="6181030">[</span><span class="ident" id="6181031">path</span><span class="op" id="6181035">]</span>&nbsp;<span class="op" id="6181037">=</span>&nbsp;<span class="builtinfunc" id="6181039">append</span><span class="op" id="6181045">(</span><span class="ident" id="6181046">testImported</span><span class="op" id="6181058">[</span><span class="ident" id="6181059">path</span><span class="op" id="6181063">]</span><span class="op" id="6181064">,</span>&nbsp;<span class="ident" id="6181066">fset</span><span class="op" id="6181070">.</span><span class="ident" id="6181071">Position</span><span class="op" id="6181079">(</span><span class="ident" id="6181080">spec</span><span class="op" id="6181084">.</span><span class="ident" id="6181085">Pos</span><span class="op" id="6181088">(</span><span class="op" id="6181089">)</span><span class="op" id="6181090">)</span><span class="op" id="6181091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181097">}</span>&nbsp;<span class="keyword" id="6181099">else</span>&nbsp;<span class="op" id="6181104">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181111">imported</span><span class="op" id="6181119">[</span><span class="ident" id="6181120">path</span><span class="op" id="6181124">]</span>&nbsp;<span class="op" id="6181126">=</span>&nbsp;<span class="builtinfunc" id="6181128">append</span><span class="op" id="6181134">(</span><span class="ident" id="6181135">imported</span><span class="op" id="6181143">[</span><span class="ident" id="6181144">path</span><span class="op" id="6181148">]</span><span class="op" id="6181149">,</span>&nbsp;<span class="ident" id="6181151">fset</span><span class="op" id="6181155">.</span><span class="ident" id="6181156">Position</span><span class="op" id="6181164">(</span><span class="ident" id="6181165">spec</span><span class="op" id="6181169">.</span><span class="ident" id="6181170">Pos</span><span class="op" id="6181173">(</span><span class="op" id="6181174">)</span><span class="op" id="6181175">)</span><span class="op" id="6181176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181188">if</span>&nbsp;<span class="ident" id="6181191">path</span>&nbsp;<span class="op" id="6181196">==</span>&nbsp;<span class="string" id="6181199">&#34;C&#34;</span>&nbsp;<span class="op" id="6181203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181210">if</span>&nbsp;<span class="ident" id="6181213">isTest</span>&nbsp;<span class="op" id="6181220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181228">return</span>&nbsp;<span class="ident" id="6181235">p</span><span class="op" id="6181236">,</span>&nbsp;<span class="ident" id="6181238">fmt</span><span class="op" id="6181241">.</span><span class="ident" id="6181242">Errorf</span><span class="op" id="6181248">(</span><span class="string" id="6181249">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6181286">,</span>&nbsp;<span class="ident" id="6181288">filename</span><span class="op" id="6181296">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181310">cg</span>&nbsp;<span class="op" id="6181313">:=</span>&nbsp;<span class="ident" id="6181316">spec</span><span class="op" id="6181320">.</span><span class="ident" id="6181321">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181330">if</span>&nbsp;<span class="ident" id="6181333">cg</span>&nbsp;<span class="op" id="6181336">==</span>&nbsp;<span class="ident" id="6181339">nil</span>&nbsp;<span class="op" id="6181343">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6181346">len</span><span class="op" id="6181349">(</span><span class="ident" id="6181350">d</span><span class="op" id="6181351">.</span><span class="ident" id="6181352">Specs</span><span class="op" id="6181357">)</span>&nbsp;<span class="op" id="6181359">==</span>&nbsp;<span class="num" id="6181362">1</span>&nbsp;<span class="op" id="6181364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181372">cg</span>&nbsp;<span class="op" id="6181375">=</span>&nbsp;<span class="ident" id="6181377">d</span><span class="op" id="6181378">.</span><span class="ident" id="6181379">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181388">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181395">if</span>&nbsp;<span class="ident" id="6181398">cg</span>&nbsp;<span class="op" id="6181401">!=</span>&nbsp;<span class="ident" id="6181404">nil</span>&nbsp;<span class="op" id="6181408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181416">if</span>&nbsp;<span class="ident" id="6181419">err</span>&nbsp;<span class="op" id="6181423">:=</span>&nbsp;<span class="ident" id="6181426">ctxt</span><span class="op" id="6181430">.</span><span class="ident" id="6181431">saveCgo</span><span class="op" id="6181438">(</span><span class="ident" id="6181439">filename</span><span class="op" id="6181447">,</span>&nbsp;<span class="ident" id="6181449">p</span><span class="op" id="6181450">,</span>&nbsp;<span class="ident" id="6181452">cg</span><span class="op" id="6181454">)</span><span class="op" id="6181455">;</span>&nbsp;<span class="ident" id="6181457">err</span>&nbsp;<span class="op" id="6181461">!=</span>&nbsp;<span class="ident" id="6181464">nil</span>&nbsp;<span class="op" id="6181468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181477">return</span>&nbsp;<span class="ident" id="6181484">p</span><span class="op" id="6181485">,</span>&nbsp;<span class="ident" id="6181487">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181504">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181511">isCgo</span>&nbsp;<span class="op" id="6181517">=</span>&nbsp;<span class="ident" id="6181519">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181541">if</span>&nbsp;<span class="ident" id="6181544">isCgo</span>&nbsp;<span class="op" id="6181550">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181555">allTags</span><span class="op" id="6181562">[</span><span class="string" id="6181563">&#34;cgo&#34;</span><span class="op" id="6181568">]</span>&nbsp;<span class="op" id="6181570">=</span>&nbsp;<span class="ident" id="6181572">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181580">if</span>&nbsp;<span class="ident" id="6181583">ctxt</span><span class="op" id="6181587">.</span><span class="ident" id="6181588">CgoEnabled</span>&nbsp;<span class="op" id="6181599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181605">p</span><span class="op" id="6181606">.</span><span class="ident" id="6181607">CgoFiles</span>&nbsp;<span class="op" id="6181616">=</span>&nbsp;<span class="builtinfunc" id="6181618">append</span><span class="op" id="6181624">(</span><span class="ident" id="6181625">p</span><span class="op" id="6181626">.</span><span class="ident" id="6181627">CgoFiles</span><span class="op" id="6181635">,</span>&nbsp;<span class="ident" id="6181637">name</span><span class="op" id="6181641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181646">}</span>&nbsp;<span class="keyword" id="6181648">else</span>&nbsp;<span class="op" id="6181653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181659">p</span><span class="op" id="6181660">.</span><span class="ident" id="6181661">IgnoredGoFiles</span>&nbsp;<span class="op" id="6181676">=</span>&nbsp;<span class="builtinfunc" id="6181678">append</span><span class="op" id="6181684">(</span><span class="ident" id="6181685">p</span><span class="op" id="6181686">.</span><span class="ident" id="6181687">IgnoredGoFiles</span><span class="op" id="6181701">,</span>&nbsp;<span class="ident" id="6181703">name</span><span class="op" id="6181707">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181716">}</span>&nbsp;<span class="keyword" id="6181718">else</span>&nbsp;<span class="keyword" id="6181723">if</span>&nbsp;<span class="ident" id="6181726">isXTest</span>&nbsp;<span class="op" id="6181734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181739">p</span><span class="op" id="6181740">.</span><span class="ident" id="6181741">XTestGoFiles</span>&nbsp;<span class="op" id="6181754">=</span>&nbsp;<span class="builtinfunc" id="6181756">append</span><span class="op" id="6181762">(</span><span class="ident" id="6181763">p</span><span class="op" id="6181764">.</span><span class="ident" id="6181765">XTestGoFiles</span><span class="op" id="6181777">,</span>&nbsp;<span class="ident" id="6181779">name</span><span class="op" id="6181783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181787">}</span>&nbsp;<span class="keyword" id="6181789">else</span>&nbsp;<span class="keyword" id="6181794">if</span>&nbsp;<span class="ident" id="6181797">isTest</span>&nbsp;<span class="op" id="6181804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181809">p</span><span class="op" id="6181810">.</span><span class="ident" id="6181811">TestGoFiles</span>&nbsp;<span class="op" id="6181823">=</span>&nbsp;<span class="builtinfunc" id="6181825">append</span><span class="op" id="6181831">(</span><span class="ident" id="6181832">p</span><span class="op" id="6181833">.</span><span class="ident" id="6181834">TestGoFiles</span><span class="op" id="6181845">,</span>&nbsp;<span class="ident" id="6181847">name</span><span class="op" id="6181851">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181855">}</span>&nbsp;<span class="keyword" id="6181857">else</span>&nbsp;<span class="op" id="6181862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6181867">p</span><span class="op" id="6181868">.</span><span class="ident" id="6181869">GoFiles</span>&nbsp;<span class="op" id="6181877">=</span>&nbsp;<span class="builtinfunc" id="6181879">append</span><span class="op" id="6181885">(</span><span class="ident" id="6181886">p</span><span class="op" id="6181887">.</span><span class="ident" id="6181888">GoFiles</span><span class="op" id="6181895">,</span>&nbsp;<span class="ident" id="6181897">name</span><span class="op" id="6181901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6181908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181911">if</span>&nbsp;<span class="builtinfunc" id="6181914">len</span><span class="op" id="6181917">(</span><span class="ident" id="6181918">p</span><span class="op" id="6181919">.</span><span class="ident" id="6181920">GoFiles</span><span class="op" id="6181927">)</span><span class="op" id="6181928">+</span><span class="builtinfunc" id="6181929">len</span><span class="op" id="6181932">(</span><span class="ident" id="6181933">p</span><span class="op" id="6181934">.</span><span class="ident" id="6181935">CgoFiles</span><span class="op" id="6181943">)</span><span class="op" id="6181944">+</span><span class="builtinfunc" id="6181945">len</span><span class="op" id="6181948">(</span><span class="ident" id="6181949">p</span><span class="op" id="6181950">.</span><span class="ident" id="6181951">TestGoFiles</span><span class="op" id="6181962">)</span><span class="op" id="6181963">+</span><span class="builtinfunc" id="6181964">len</span><span class="op" id="6181967">(</span><span class="ident" id="6181968">p</span><span class="op" id="6181969">.</span><span class="ident" id="6181970">XTestGoFiles</span><span class="op" id="6181982">)</span>&nbsp;<span class="op" id="6181984">==</span>&nbsp;<span class="num" id="6181987">0</span>&nbsp;<span class="op" id="6181989">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6181993">return</span>&nbsp;<span class="ident" id="6182000">p</span><span class="op" id="6182001">,</span>&nbsp;<span class="op" id="6182003">&amp;</span><span class="ident" id="6182004">NoGoError</span><span class="op" id="6182013">{</span><span class="ident" id="6182014">p</span><span class="op" id="6182015">.</span><span class="ident" id="6182016">Dir</span><span class="op" id="6182019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6182022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182026">for</span>&nbsp;<span class="ident" id="6182030">tag</span>&nbsp;<span class="op" id="6182034">:=</span>&nbsp;<span class="keyword" id="6182037">range</span>&nbsp;<span class="ident" id="6182043">allTags</span>&nbsp;<span class="op" id="6182051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182055">p</span><span class="op" id="6182056">.</span><span class="ident" id="6182057">AllTags</span>&nbsp;<span class="op" id="6182065">=</span>&nbsp;<span class="builtinfunc" id="6182067">append</span><span class="op" id="6182073">(</span><span class="ident" id="6182074">p</span><span class="op" id="6182075">.</span><span class="ident" id="6182076">AllTags</span><span class="op" id="6182083">,</span>&nbsp;<span class="ident" id="6182085">tag</span><span class="op" id="6182088">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6182091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182094">sort</span><span class="op" id="6182098">.</span><span class="ident" id="6182099">Strings</span><span class="op" id="6182106">(</span><span class="ident" id="6182107">p</span><span class="op" id="6182108">.</span><span class="ident" id="6182109">AllTags</span><span class="op" id="6182116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182120">p</span><span class="op" id="6182121">.</span><span class="ident" id="6182122">Imports</span><span class="op" id="6182129">,</span>&nbsp;<span class="ident" id="6182131">p</span><span class="op" id="6182132">.</span><span class="ident" id="6182133">ImportPos</span>&nbsp;<span class="op" id="6182143">=</span>&nbsp;<span class="ident" id="6182145">cleanImports</span><span class="op" id="6182157">(</span><span class="ident" id="6182158">imported</span><span class="op" id="6182166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182169">p</span><span class="op" id="6182170">.</span><span class="ident" id="6182171">TestImports</span><span class="op" id="6182182">,</span>&nbsp;<span class="ident" id="6182184">p</span><span class="op" id="6182185">.</span><span class="ident" id="6182186">TestImportPos</span>&nbsp;<span class="op" id="6182200">=</span>&nbsp;<span class="ident" id="6182202">cleanImports</span><span class="op" id="6182214">(</span><span class="ident" id="6182215">testImported</span><span class="op" id="6182227">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182230">p</span><span class="op" id="6182231">.</span><span class="ident" id="6182232">XTestImports</span><span class="op" id="6182244">,</span>&nbsp;<span class="ident" id="6182246">p</span><span class="op" id="6182247">.</span><span class="ident" id="6182248">XTestImportPos</span>&nbsp;<span class="op" id="6182263">=</span>&nbsp;<span class="ident" id="6182265">cleanImports</span><span class="op" id="6182277">(</span><span class="ident" id="6182278">xTestImported</span><span class="op" id="6182291">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182295">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182341">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182382">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182427">if</span>&nbsp;<span class="builtinfunc" id="6182430">len</span><span class="op" id="6182433">(</span><span class="ident" id="6182434">p</span><span class="op" id="6182435">.</span><span class="ident" id="6182436">CgoFiles</span><span class="op" id="6182444">)</span>&nbsp;<span class="op" id="6182446">&gt;</span>&nbsp;<span class="num" id="6182448">0</span>&nbsp;<span class="op" id="6182450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182454">p</span><span class="op" id="6182455">.</span><span class="ident" id="6182456">SFiles</span>&nbsp;<span class="op" id="6182463">=</span>&nbsp;<span class="builtinfunc" id="6182465">append</span><span class="op" id="6182471">(</span><span class="ident" id="6182472">p</span><span class="op" id="6182473">.</span><span class="ident" id="6182474">SFiles</span><span class="op" id="6182480">,</span>&nbsp;<span class="ident" id="6182482">Sfiles</span><span class="op" id="6182488">...</span><span class="op" id="6182491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182495">sort</span><span class="op" id="6182499">.</span><span class="ident" id="6182500">Strings</span><span class="op" id="6182507">(</span><span class="ident" id="6182508">p</span><span class="op" id="6182509">.</span><span class="ident" id="6182510">SFiles</span><span class="op" id="6182516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6182519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182523">return</span>&nbsp;<span class="ident" id="6182530">p</span><span class="op" id="6182531">,</span>&nbsp;<span class="ident" id="6182533">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="6182540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6182543">func</span>&nbsp;<span class="ident" id="6182548">findImportComment</span><span class="op" id="6182565">(</span><span class="ident" id="6182566">data</span>&nbsp;<span class="op" id="6182571">[</span><span class="op" id="6182572">]</span><span class="builtintype" id="6182573">byte</span><span class="op" id="6182577">)</span>&nbsp;<span class="op" id="6182579">(</span><span class="ident" id="6182580">s</span>&nbsp;<span class="builtintype" id="6182582">string</span><span class="op" id="6182588">,</span>&nbsp;<span class="ident" id="6182590">line</span>&nbsp;<span class="builtintype" id="6182595">int</span><span class="op" id="6182598">)</span>&nbsp;<span class="op" id="6182600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182603">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182630">word</span><span class="op" id="6182634">,</span>&nbsp;<span class="ident" id="6182636">data</span>&nbsp;<span class="op" id="6182641">:=</span>&nbsp;<span class="ident" id="6182644">parseWord</span><span class="op" id="6182653">(</span><span class="ident" id="6182654">data</span><span class="op" id="6182658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182661">if</span>&nbsp;<span class="builtintype" id="6182664">string</span><span class="op" id="6182670">(</span><span class="ident" id="6182671">word</span><span class="op" id="6182675">)</span>&nbsp;<span class="op" id="6182677">!=</span>&nbsp;<span class="string" id="6182680">&#34;package&#34;</span>&nbsp;<span class="op" id="6182690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182694">return</span>&nbsp;<span class="string" id="6182701">&#34;&#34;</span><span class="op" id="6182703">,</span>&nbsp;<span class="num" id="6182705">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6182708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182712">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182736">_</span><span class="op" id="6182737">,</span>&nbsp;<span class="ident" id="6182739">data</span>&nbsp;<span class="op" id="6182744">=</span>&nbsp;<span class="ident" id="6182746">parseWord</span><span class="op" id="6182755">(</span><span class="ident" id="6182756">data</span><span class="op" id="6182760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182764">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6182820">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182866">for</span>&nbsp;<span class="builtinfunc" id="6182870">len</span><span class="op" id="6182873">(</span><span class="ident" id="6182874">data</span><span class="op" id="6182878">)</span>&nbsp;<span class="op" id="6182880">&gt;</span>&nbsp;<span class="num" id="6182882">0</span>&nbsp;<span class="op" id="6182884">&amp;&amp;</span>&nbsp;<span class="op" id="6182887">(</span><span class="ident" id="6182888">data</span><span class="op" id="6182892">[</span><span class="num" id="6182893">0</span><span class="op" id="6182894">]</span>&nbsp;<span class="op" id="6182896">==</span>&nbsp;<span class="string" id="6182899">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6182903">||</span>&nbsp;<span class="ident" id="6182906">data</span><span class="op" id="6182910">[</span><span class="num" id="6182911">0</span><span class="op" id="6182912">]</span>&nbsp;<span class="op" id="6182914">==</span>&nbsp;<span class="string" id="6182917">&#39;\t&#39;</span>&nbsp;<span class="op" id="6182922">||</span>&nbsp;<span class="ident" id="6182925">data</span><span class="op" id="6182929">[</span><span class="num" id="6182930">0</span><span class="op" id="6182931">]</span>&nbsp;<span class="op" id="6182933">==</span>&nbsp;<span class="string" id="6182936">&#39;\r&#39;</span><span class="op" id="6182940">)</span>&nbsp;<span class="op" id="6182942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6182946">data</span>&nbsp;<span class="op" id="6182951">=</span>&nbsp;<span class="ident" id="6182953">data</span><span class="op" id="6182957">[</span><span class="num" id="6182958">1</span><span class="op" id="6182959">:</span><span class="op" id="6182960">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6182963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182967">var</span>&nbsp;<span class="ident" id="6182971">comment</span>&nbsp;<span class="op" id="6182979">[</span><span class="op" id="6182980">]</span><span class="builtintype" id="6182981">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182987">switch</span>&nbsp;<span class="op" id="6182994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6182997">case</span>&nbsp;<span class="ident" id="6183002">bytes</span><span class="op" id="6183007">.</span><span class="ident" id="6183008">HasPrefix</span><span class="op" id="6183017">(</span><span class="ident" id="6183018">data</span><span class="op" id="6183022">,</span>&nbsp;<span class="ident" id="6183024">slashSlash</span><span class="op" id="6183034">)</span><span class="op" id="6183035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183039">i</span>&nbsp;<span class="op" id="6183041">:=</span>&nbsp;<span class="ident" id="6183044">bytes</span><span class="op" id="6183049">.</span><span class="ident" id="6183050">Index</span><span class="op" id="6183055">(</span><span class="ident" id="6183056">data</span><span class="op" id="6183060">,</span>&nbsp;<span class="ident" id="6183062">newline</span><span class="op" id="6183069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183073">if</span>&nbsp;<span class="ident" id="6183076">i</span>&nbsp;<span class="op" id="6183078">&lt;</span>&nbsp;<span class="num" id="6183080">0</span>&nbsp;<span class="op" id="6183082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183087">i</span>&nbsp;<span class="op" id="6183089">=</span>&nbsp;<span class="builtinfunc" id="6183091">len</span><span class="op" id="6183094">(</span><span class="ident" id="6183095">data</span><span class="op" id="6183099">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183107">comment</span>&nbsp;<span class="op" id="6183115">=</span>&nbsp;<span class="ident" id="6183117">data</span><span class="op" id="6183121">[</span><span class="num" id="6183122">2</span><span class="op" id="6183123">:</span><span class="ident" id="6183124">i</span><span class="op" id="6183125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183128">case</span>&nbsp;<span class="ident" id="6183133">bytes</span><span class="op" id="6183138">.</span><span class="ident" id="6183139">HasPrefix</span><span class="op" id="6183148">(</span><span class="ident" id="6183149">data</span><span class="op" id="6183153">,</span>&nbsp;<span class="ident" id="6183155">slashStar</span><span class="op" id="6183164">)</span><span class="op" id="6183165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183169">data</span>&nbsp;<span class="op" id="6183174">=</span>&nbsp;<span class="ident" id="6183176">data</span><span class="op" id="6183180">[</span><span class="num" id="6183181">2</span><span class="op" id="6183182">:</span><span class="op" id="6183183">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183187">i</span>&nbsp;<span class="op" id="6183189">:=</span>&nbsp;<span class="ident" id="6183192">bytes</span><span class="op" id="6183197">.</span><span class="ident" id="6183198">Index</span><span class="op" id="6183203">(</span><span class="ident" id="6183204">data</span><span class="op" id="6183208">,</span>&nbsp;<span class="ident" id="6183210">starSlash</span><span class="op" id="6183219">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183223">if</span>&nbsp;<span class="ident" id="6183226">i</span>&nbsp;<span class="op" id="6183228">&lt;</span>&nbsp;<span class="num" id="6183230">0</span>&nbsp;<span class="op" id="6183232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6183237">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183261">return</span>&nbsp;<span class="string" id="6183268">&#34;&#34;</span><span class="op" id="6183270">,</span>&nbsp;<span class="num" id="6183272">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183280">comment</span>&nbsp;<span class="op" id="6183288">=</span>&nbsp;<span class="ident" id="6183290">data</span><span class="op" id="6183294">[</span><span class="op" id="6183295">:</span><span class="ident" id="6183296">i</span><span class="op" id="6183297">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183301">if</span>&nbsp;<span class="ident" id="6183304">bytes</span><span class="op" id="6183309">.</span><span class="ident" id="6183310">Contains</span><span class="op" id="6183318">(</span><span class="ident" id="6183319">comment</span><span class="op" id="6183326">,</span>&nbsp;<span class="ident" id="6183328">newline</span><span class="op" id="6183335">)</span>&nbsp;<span class="op" id="6183337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183342">return</span>&nbsp;<span class="string" id="6183349">&#34;&#34;</span><span class="op" id="6183351">,</span>&nbsp;<span class="num" id="6183353">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183363">comment</span>&nbsp;<span class="op" id="6183371">=</span>&nbsp;<span class="ident" id="6183373">bytes</span><span class="op" id="6183378">.</span><span class="ident" id="6183379">TrimSpace</span><span class="op" id="6183388">(</span><span class="ident" id="6183389">comment</span><span class="op" id="6183396">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6183400">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183441">word</span><span class="op" id="6183445">,</span>&nbsp;<span class="ident" id="6183447">arg</span>&nbsp;<span class="op" id="6183451">:=</span>&nbsp;<span class="ident" id="6183454">parseWord</span><span class="op" id="6183463">(</span><span class="ident" id="6183464">comment</span><span class="op" id="6183471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183474">if</span>&nbsp;<span class="builtintype" id="6183477">string</span><span class="op" id="6183483">(</span><span class="ident" id="6183484">word</span><span class="op" id="6183488">)</span>&nbsp;<span class="op" id="6183490">!=</span>&nbsp;<span class="string" id="6183493">&#34;import&#34;</span>&nbsp;<span class="op" id="6183502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183506">return</span>&nbsp;<span class="string" id="6183513">&#34;&#34;</span><span class="op" id="6183515">,</span>&nbsp;<span class="num" id="6183517">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6183520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183524">line</span>&nbsp;<span class="op" id="6183529">=</span>&nbsp;<span class="num" id="6183531">1</span>&nbsp;<span class="op" id="6183533">+</span>&nbsp;<span class="ident" id="6183535">bytes</span><span class="op" id="6183540">.</span><span class="ident" id="6183541">Count</span><span class="op" id="6183546">(</span><span class="ident" id="6183547">data</span><span class="op" id="6183551">[</span><span class="op" id="6183552">:</span><span class="builtinfunc" id="6183553">cap</span><span class="op" id="6183556">(</span><span class="ident" id="6183557">data</span><span class="op" id="6183561">)</span><span class="op" id="6183562">-</span><span class="builtinfunc" id="6183563">cap</span><span class="op" id="6183566">(</span><span class="ident" id="6183567">arg</span><span class="op" id="6183570">)</span><span class="op" id="6183571">]</span><span class="op" id="6183572">,</span>&nbsp;<span class="ident" id="6183574">newline</span><span class="op" id="6183581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183584">return</span>&nbsp;<span class="ident" id="6183591">strings</span><span class="op" id="6183598">.</span><span class="ident" id="6183599">TrimSpace</span><span class="op" id="6183608">(</span><span class="builtintype" id="6183609">string</span><span class="op" id="6183615">(</span><span class="ident" id="6183616">arg</span><span class="op" id="6183619">)</span><span class="op" id="6183620">)</span><span class="op" id="6183621">,</span>&nbsp;<span class="ident" id="6183623">line</span><br>
<span class="lineno"></span><span class="op" id="6183628">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="6183631">var</span>&nbsp;<span class="op" id="6183635">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183638">slashSlash</span>&nbsp;<span class="op" id="6183649">=</span>&nbsp;<span class="op" id="6183651">[</span><span class="op" id="6183652">]</span><span class="builtintype" id="6183653">byte</span><span class="op" id="6183657">(</span><span class="string" id="6183658">&#34;//&#34;</span><span class="op" id="6183662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183665">slashStar</span>&nbsp;&nbsp;<span class="op" id="6183676">=</span>&nbsp;<span class="op" id="6183678">[</span><span class="op" id="6183679">]</span><span class="builtintype" id="6183680">byte</span><span class="op" id="6183684">(</span><span class="string" id="6183685">&#34;/*&#34;</span><span class="op" id="6183689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183692">starSlash</span>&nbsp;&nbsp;<span class="op" id="6183703">=</span>&nbsp;<span class="op" id="6183705">[</span><span class="op" id="6183706">]</span><span class="builtintype" id="6183707">byte</span><span class="op" id="6183711">(</span><span class="string" id="6183712">&#34;*/&#34;</span><span class="op" id="6183716">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183719">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6183730">=</span>&nbsp;<span class="op" id="6183732">[</span><span class="op" id="6183733">]</span><span class="builtintype" id="6183734">byte</span><span class="op" id="6183738">(</span><span class="string" id="6183739">&#34;\n&#34;</span><span class="op" id="6183743">)</span><br>
<span class="lineno"></span><span class="op" id="6183745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6183748">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="6183828">func</span>&nbsp;<span class="ident" id="6183833">skipSpaceOrComment</span><span class="op" id="6183851">(</span><span class="ident" id="6183852">data</span>&nbsp;<span class="op" id="6183857">[</span><span class="op" id="6183858">]</span><span class="builtintype" id="6183859">byte</span><span class="op" id="6183863">)</span>&nbsp;<span class="op" id="6183865">[</span><span class="op" id="6183866">]</span><span class="builtintype" id="6183867">byte</span>&nbsp;<span class="op" id="6183872">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183875">for</span>&nbsp;<span class="builtinfunc" id="6183879">len</span><span class="op" id="6183882">(</span><span class="ident" id="6183883">data</span><span class="op" id="6183887">)</span>&nbsp;<span class="op" id="6183889">&gt;</span>&nbsp;<span class="num" id="6183891">0</span>&nbsp;<span class="op" id="6183893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183897">switch</span>&nbsp;<span class="ident" id="6183904">data</span><span class="op" id="6183908">[</span><span class="num" id="6183909">0</span><span class="op" id="6183910">]</span>&nbsp;<span class="op" id="6183912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183916">case</span>&nbsp;<span class="string" id="6183921">&#39;&nbsp;&#39;</span><span class="op" id="6183924">,</span>&nbsp;<span class="string" id="6183926">&#39;\t&#39;</span><span class="op" id="6183930">,</span>&nbsp;<span class="string" id="6183932">&#39;\r&#39;</span><span class="op" id="6183936">,</span>&nbsp;<span class="string" id="6183938">&#39;\n&#39;</span><span class="op" id="6183942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6183947">data</span>&nbsp;<span class="op" id="6183952">=</span>&nbsp;<span class="ident" id="6183954">data</span><span class="op" id="6183958">[</span><span class="num" id="6183959">1</span><span class="op" id="6183960">:</span><span class="op" id="6183961">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183966">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183977">case</span>&nbsp;<span class="string" id="6183982">&#39;/&#39;</span><span class="op" id="6183985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6183990">if</span>&nbsp;<span class="ident" id="6183993">bytes</span><span class="op" id="6183998">.</span><span class="ident" id="6183999">HasPrefix</span><span class="op" id="6184008">(</span><span class="ident" id="6184009">data</span><span class="op" id="6184013">,</span>&nbsp;<span class="ident" id="6184015">slashSlash</span><span class="op" id="6184025">)</span>&nbsp;<span class="op" id="6184027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184033">i</span>&nbsp;<span class="op" id="6184035">:=</span>&nbsp;<span class="ident" id="6184038">bytes</span><span class="op" id="6184043">.</span><span class="ident" id="6184044">Index</span><span class="op" id="6184049">(</span><span class="ident" id="6184050">data</span><span class="op" id="6184054">,</span>&nbsp;<span class="ident" id="6184056">newline</span><span class="op" id="6184063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184069">if</span>&nbsp;<span class="ident" id="6184072">i</span>&nbsp;<span class="op" id="6184074">&lt;</span>&nbsp;<span class="num" id="6184076">0</span>&nbsp;<span class="op" id="6184078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184085">return</span>&nbsp;<span class="ident" id="6184092">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184106">data</span>&nbsp;<span class="op" id="6184111">=</span>&nbsp;<span class="ident" id="6184113">data</span><span class="op" id="6184117">[</span><span class="ident" id="6184118">i</span><span class="op" id="6184119">+</span><span class="num" id="6184120">1</span><span class="op" id="6184121">:</span><span class="op" id="6184122">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184128">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184145">if</span>&nbsp;<span class="ident" id="6184148">bytes</span><span class="op" id="6184153">.</span><span class="ident" id="6184154">HasPrefix</span><span class="op" id="6184163">(</span><span class="ident" id="6184164">data</span><span class="op" id="6184168">,</span>&nbsp;<span class="ident" id="6184170">slashStar</span><span class="op" id="6184179">)</span>&nbsp;<span class="op" id="6184181">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184187">data</span>&nbsp;<span class="op" id="6184192">=</span>&nbsp;<span class="ident" id="6184194">data</span><span class="op" id="6184198">[</span><span class="num" id="6184199">2</span><span class="op" id="6184200">:</span><span class="op" id="6184201">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184207">i</span>&nbsp;<span class="op" id="6184209">:=</span>&nbsp;<span class="ident" id="6184212">bytes</span><span class="op" id="6184217">.</span><span class="ident" id="6184218">Index</span><span class="op" id="6184223">(</span><span class="ident" id="6184224">data</span><span class="op" id="6184228">,</span>&nbsp;<span class="ident" id="6184230">starSlash</span><span class="op" id="6184239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184245">if</span>&nbsp;<span class="ident" id="6184248">i</span>&nbsp;<span class="op" id="6184250">&lt;</span>&nbsp;<span class="num" id="6184252">0</span>&nbsp;<span class="op" id="6184254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184261">return</span>&nbsp;<span class="ident" id="6184268">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184276">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184282">data</span>&nbsp;<span class="op" id="6184287">=</span>&nbsp;<span class="ident" id="6184289">data</span><span class="op" id="6184293">[</span><span class="ident" id="6184294">i</span><span class="op" id="6184295">+</span><span class="num" id="6184296">2</span><span class="op" id="6184297">:</span><span class="op" id="6184298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184304">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184324">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184334">return</span>&nbsp;<span class="ident" id="6184341">data</span><br>
<span class="lineno"></span><span class="op" id="6184346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6184349">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="6184407">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="6184477">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="6184533">func</span>&nbsp;<span class="ident" id="6184538">parseWord</span><span class="op" id="6184547">(</span><span class="ident" id="6184548">data</span>&nbsp;<span class="op" id="6184553">[</span><span class="op" id="6184554">]</span><span class="builtintype" id="6184555">byte</span><span class="op" id="6184559">)</span>&nbsp;<span class="op" id="6184561">(</span><span class="ident" id="6184562">word</span><span class="op" id="6184566">,</span>&nbsp;<span class="ident" id="6184568">rest</span>&nbsp;<span class="op" id="6184573">[</span><span class="op" id="6184574">]</span><span class="builtintype" id="6184575">byte</span><span class="op" id="6184579">)</span>&nbsp;<span class="op" id="6184581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184584">data</span>&nbsp;<span class="op" id="6184589">=</span>&nbsp;<span class="ident" id="6184591">skipSpaceOrComment</span><span class="op" id="6184609">(</span><span class="ident" id="6184610">data</span><span class="op" id="6184614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6184618">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184658">rest</span>&nbsp;<span class="op" id="6184663">=</span>&nbsp;<span class="ident" id="6184665">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184671">for</span>&nbsp;<span class="op" id="6184675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184679">r</span><span class="op" id="6184680">,</span>&nbsp;<span class="ident" id="6184682">size</span>&nbsp;<span class="op" id="6184687">:=</span>&nbsp;<span class="ident" id="6184690">utf8</span><span class="op" id="6184694">.</span><span class="ident" id="6184695">DecodeRune</span><span class="op" id="6184705">(</span><span class="ident" id="6184706">rest</span><span class="op" id="6184710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184714">if</span>&nbsp;<span class="ident" id="6184717">unicode</span><span class="op" id="6184724">.</span><span class="ident" id="6184725">IsLetter</span><span class="op" id="6184733">(</span><span class="ident" id="6184734">r</span><span class="op" id="6184735">)</span>&nbsp;<span class="op" id="6184737">||</span>&nbsp;<span class="string" id="6184740">&#39;0&#39;</span>&nbsp;<span class="op" id="6184744">&lt;=</span>&nbsp;<span class="ident" id="6184747">r</span>&nbsp;<span class="op" id="6184749">&amp;&amp;</span>&nbsp;<span class="ident" id="6184752">r</span>&nbsp;<span class="op" id="6184754">&lt;=</span>&nbsp;<span class="string" id="6184757">&#39;9&#39;</span>&nbsp;<span class="op" id="6184761">||</span>&nbsp;<span class="ident" id="6184764">r</span>&nbsp;<span class="op" id="6184766">==</span>&nbsp;<span class="string" id="6184769">&#39;_&#39;</span>&nbsp;<span class="op" id="6184773">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184778">rest</span>&nbsp;<span class="op" id="6184783">=</span>&nbsp;<span class="ident" id="6184785">rest</span><span class="op" id="6184789">[</span><span class="ident" id="6184790">size</span><span class="op" id="6184794">:</span><span class="op" id="6184795">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184800">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184815">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184822">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6184826">word</span>&nbsp;<span class="op" id="6184831">=</span>&nbsp;<span class="ident" id="6184833">data</span><span class="op" id="6184837">[</span><span class="op" id="6184838">:</span><span class="builtinfunc" id="6184839">len</span><span class="op" id="6184842">(</span><span class="ident" id="6184843">data</span><span class="op" id="6184847">)</span><span class="op" id="6184848">-</span><span class="builtinfunc" id="6184849">len</span><span class="op" id="6184852">(</span><span class="ident" id="6184853">rest</span><span class="op" id="6184857">)</span><span class="op" id="6184858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184861">if</span>&nbsp;<span class="builtinfunc" id="6184864">len</span><span class="op" id="6184867">(</span><span class="ident" id="6184868">word</span><span class="op" id="6184872">)</span>&nbsp;<span class="op" id="6184874">==</span>&nbsp;<span class="num" id="6184877">0</span>&nbsp;<span class="op" id="6184879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184883">return</span>&nbsp;<span class="ident" id="6184890">nil</span><span class="op" id="6184893">,</span>&nbsp;<span class="ident" id="6184895">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6184900">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6184904">return</span>&nbsp;<span class="ident" id="6184911">word</span><span class="op" id="6184915">,</span>&nbsp;<span class="ident" id="6184917">rest</span><br>
<span class="lineno"></span><span class="op" id="6184922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6184925">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="6185006">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="6185085">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6185107">//</span><br>
<span class="lineno"></span><span class="comment" id="6185110">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6185183">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="6185226">func</span>&nbsp;<span class="op" id="6185231">(</span><span class="ident" id="6185232">ctxt</span>&nbsp;<span class="op" id="6185237">*</span><span class="ident" id="6185238">Context</span><span class="op" id="6185245">)</span>&nbsp;<span class="ident" id="6185247">MatchFile</span><span class="op" id="6185256">(</span><span class="ident" id="6185257">dir</span><span class="op" id="6185260">,</span>&nbsp;<span class="ident" id="6185262">name</span>&nbsp;<span class="builtintype" id="6185267">string</span><span class="op" id="6185273">)</span>&nbsp;<span class="op" id="6185275">(</span><span class="ident" id="6185276">match</span>&nbsp;<span class="builtintype" id="6185282">bool</span><span class="op" id="6185286">,</span>&nbsp;<span class="ident" id="6185288">err</span>&nbsp;<span class="builtintype" id="6185292">error</span><span class="op" id="6185297">)</span>&nbsp;<span class="op" id="6185299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6185302">match</span><span class="op" id="6185307">,</span>&nbsp;<span class="ident" id="6185309">_</span><span class="op" id="6185310">,</span>&nbsp;<span class="ident" id="6185312">_</span><span class="op" id="6185313">,</span>&nbsp;<span class="ident" id="6185315">err</span>&nbsp;<span class="op" id="6185319">=</span>&nbsp;<span class="ident" id="6185321">ctxt</span><span class="op" id="6185325">.</span><span class="ident" id="6185326">matchFile</span><span class="op" id="6185335">(</span><span class="ident" id="6185336">dir</span><span class="op" id="6185339">,</span>&nbsp;<span class="ident" id="6185341">name</span><span class="op" id="6185345">,</span>&nbsp;<span class="ident" id="6185347">false</span><span class="op" id="6185352">,</span>&nbsp;<span class="ident" id="6185354">nil</span><span class="op" id="6185357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6185360">return</span><br>
<span class="lineno"></span><span class="op" id="6185367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="6185370">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="6185454">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="6185510">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6185553">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="6185628">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="6185704">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="6185751">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="6185821">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="6185856">func</span>&nbsp;<span class="op" id="6185861">(</span><span class="ident" id="6185862">ctxt</span>&nbsp;<span class="op" id="6185867">*</span><span class="ident" id="6185868">Context</span><span class="op" id="6185875">)</span>&nbsp;<span class="ident" id="6185877">matchFile</span><span class="op" id="6185886">(</span><span class="ident" id="6185887">dir</span><span class="op" id="6185890">,</span>&nbsp;<span class="ident" id="6185892">name</span>&nbsp;<span class="builtintype" id="6185897">string</span><span class="op" id="6185903">,</span>&nbsp;<span class="ident" id="6185905">returnImports</span>&nbsp;<span class="builtintype" id="6185919">bool</span><span class="op" id="6185923">,</span>&nbsp;<span class="ident" id="6185925">allTags</span>&nbsp;<span class="keyword" id="6185933">map</span><span class="op" id="6185936">[</span><span class="builtintype" id="6185937">string</span><span class="op" id="6185943">]</span><span class="builtintype" id="6185944">bool</span><span class="op" id="6185948">)</span>&nbsp;<span class="op" id="6185950">(</span><span class="ident" id="6185951">match</span>&nbsp;<span class="builtintype" id="6185957">bool</span><span class="op" id="6185961">,</span>&nbsp;<span class="ident" id="6185963">data</span>&nbsp;<span class="op" id="6185968">[</span><span class="op" id="6185969">]</span><span class="builtintype" id="6185970">byte</span><span class="op" id="6185974">,</span>&nbsp;<span class="ident" id="6185976">filename</span>&nbsp;<span class="builtintype" id="6185985">string</span><span class="op" id="6185991">,</span>&nbsp;<span class="ident" id="6185993">err</span>&nbsp;<span class="builtintype" id="6185997">error</span><span class="op" id="6186002">)</span>&nbsp;<span class="op" id="6186004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186007">if</span>&nbsp;<span class="ident" id="6186010">strings</span><span class="op" id="6186017">.</span><span class="ident" id="6186018">HasPrefix</span><span class="op" id="6186027">(</span><span class="ident" id="6186028">name</span><span class="op" id="6186032">,</span>&nbsp;<span class="string" id="6186034">&#34;_&#34;</span><span class="op" id="6186037">)</span>&nbsp;<span class="op" id="6186039">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186044">strings</span><span class="op" id="6186051">.</span><span class="ident" id="6186052">HasPrefix</span><span class="op" id="6186061">(</span><span class="ident" id="6186062">name</span><span class="op" id="6186066">,</span>&nbsp;<span class="string" id="6186068">&#34;.&#34;</span><span class="op" id="6186071">)</span>&nbsp;<span class="op" id="6186073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186077">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186089">i</span>&nbsp;<span class="op" id="6186091">:=</span>&nbsp;<span class="ident" id="6186094">strings</span><span class="op" id="6186101">.</span><span class="ident" id="6186102">LastIndex</span><span class="op" id="6186111">(</span><span class="ident" id="6186112">name</span><span class="op" id="6186116">,</span>&nbsp;<span class="string" id="6186118">&#34;.&#34;</span><span class="op" id="6186121">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186124">if</span>&nbsp;<span class="ident" id="6186127">i</span>&nbsp;<span class="op" id="6186129">&lt;</span>&nbsp;<span class="num" id="6186131">0</span>&nbsp;<span class="op" id="6186133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186137">i</span>&nbsp;<span class="op" id="6186139">=</span>&nbsp;<span class="builtinfunc" id="6186141">len</span><span class="op" id="6186144">(</span><span class="ident" id="6186145">name</span><span class="op" id="6186149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186155">ext</span>&nbsp;<span class="op" id="6186159">:=</span>&nbsp;<span class="ident" id="6186162">name</span><span class="op" id="6186166">[</span><span class="ident" id="6186167">i</span><span class="op" id="6186168">:</span><span class="op" id="6186169">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186173">if</span>&nbsp;<span class="op" id="6186176">!</span><span class="ident" id="6186177">ctxt</span><span class="op" id="6186181">.</span><span class="ident" id="6186182">goodOSArchFile</span><span class="op" id="6186196">(</span><span class="ident" id="6186197">name</span><span class="op" id="6186201">,</span>&nbsp;<span class="ident" id="6186203">allTags</span><span class="op" id="6186210">)</span>&nbsp;<span class="op" id="6186212">&amp;&amp;</span>&nbsp;<span class="op" id="6186215">!</span><span class="ident" id="6186216">ctxt</span><span class="op" id="6186220">.</span><span class="ident" id="6186221">UseAllFiles</span>&nbsp;<span class="op" id="6186233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186237">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186249">switch</span>&nbsp;<span class="ident" id="6186256">ext</span>&nbsp;<span class="op" id="6186260">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186263">case</span>&nbsp;<span class="string" id="6186268">&#34;.go&#34;</span><span class="op" id="6186273">,</span>&nbsp;<span class="string" id="6186275">&#34;.c&#34;</span><span class="op" id="6186279">,</span>&nbsp;<span class="string" id="6186281">&#34;.cc&#34;</span><span class="op" id="6186286">,</span>&nbsp;<span class="string" id="6186288">&#34;.cxx&#34;</span><span class="op" id="6186294">,</span>&nbsp;<span class="string" id="6186296">&#34;.cpp&#34;</span><span class="op" id="6186302">,</span>&nbsp;<span class="string" id="6186304">&#34;.m&#34;</span><span class="op" id="6186308">,</span>&nbsp;<span class="string" id="6186310">&#34;.s&#34;</span><span class="op" id="6186314">,</span>&nbsp;<span class="string" id="6186316">&#34;.h&#34;</span><span class="op" id="6186320">,</span>&nbsp;<span class="string" id="6186322">&#34;.hh&#34;</span><span class="op" id="6186327">,</span>&nbsp;<span class="string" id="6186329">&#34;.hpp&#34;</span><span class="op" id="6186335">,</span>&nbsp;<span class="string" id="6186337">&#34;.hxx&#34;</span><span class="op" id="6186343">,</span>&nbsp;<span class="string" id="6186345">&#34;.S&#34;</span><span class="op" id="6186349">,</span>&nbsp;<span class="string" id="6186351">&#34;.swig&#34;</span><span class="op" id="6186358">,</span>&nbsp;<span class="string" id="6186360">&#34;.swigcxx&#34;</span><span class="op" id="6186370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186374">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186415">case</span>&nbsp;<span class="string" id="6186420">&#34;.syso&#34;</span><span class="op" id="6186427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186431">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186455">match</span>&nbsp;<span class="op" id="6186461">=</span>&nbsp;<span class="ident" id="6186463">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186470">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186478">default</span><span class="op" id="6186485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186489">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186499">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186507">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186511">filename</span>&nbsp;<span class="op" id="6186520">=</span>&nbsp;<span class="ident" id="6186522">ctxt</span><span class="op" id="6186526">.</span><span class="ident" id="6186527">joinPath</span><span class="op" id="6186535">(</span><span class="ident" id="6186536">dir</span><span class="op" id="6186539">,</span>&nbsp;<span class="ident" id="6186541">name</span><span class="op" id="6186545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186548">f</span><span class="op" id="6186549">,</span>&nbsp;<span class="ident" id="6186551">err</span>&nbsp;<span class="op" id="6186555">:=</span>&nbsp;<span class="ident" id="6186558">ctxt</span><span class="op" id="6186562">.</span><span class="ident" id="6186563">openFile</span><span class="op" id="6186571">(</span><span class="ident" id="6186572">filename</span><span class="op" id="6186580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186583">if</span>&nbsp;<span class="ident" id="6186586">err</span>&nbsp;<span class="op" id="6186590">!=</span>&nbsp;<span class="ident" id="6186593">nil</span>&nbsp;<span class="op" id="6186597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186601">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186613">if</span>&nbsp;<span class="ident" id="6186616">strings</span><span class="op" id="6186623">.</span><span class="ident" id="6186624">HasSuffix</span><span class="op" id="6186633">(</span><span class="ident" id="6186634">filename</span><span class="op" id="6186642">,</span>&nbsp;<span class="string" id="6186644">&#34;.go&#34;</span><span class="op" id="6186649">)</span>&nbsp;<span class="op" id="6186651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186655">data</span><span class="op" id="6186659">,</span>&nbsp;<span class="ident" id="6186661">err</span>&nbsp;<span class="op" id="6186665">=</span>&nbsp;<span class="ident" id="6186667">readImports</span><span class="op" id="6186678">(</span><span class="ident" id="6186679">f</span><span class="op" id="6186680">,</span>&nbsp;<span class="ident" id="6186682">false</span><span class="op" id="6186687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186690">}</span>&nbsp;<span class="keyword" id="6186692">else</span>&nbsp;<span class="op" id="6186697">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186701">data</span><span class="op" id="6186705">,</span>&nbsp;<span class="ident" id="6186707">err</span>&nbsp;<span class="op" id="6186711">=</span>&nbsp;<span class="ident" id="6186713">readComments</span><span class="op" id="6186725">(</span><span class="ident" id="6186726">f</span><span class="op" id="6186727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186733">f</span><span class="op" id="6186734">.</span><span class="ident" id="6186735">Close</span><span class="op" id="6186740">(</span><span class="op" id="6186741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186744">if</span>&nbsp;<span class="ident" id="6186747">err</span>&nbsp;<span class="op" id="6186751">!=</span>&nbsp;<span class="ident" id="6186754">nil</span>&nbsp;<span class="op" id="6186758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186762">err</span>&nbsp;<span class="op" id="6186766">=</span>&nbsp;<span class="ident" id="6186768">fmt</span><span class="op" id="6186771">.</span><span class="ident" id="6186772">Errorf</span><span class="op" id="6186778">(</span><span class="string" id="6186779">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6186792">,</span>&nbsp;<span class="ident" id="6186794">filename</span><span class="op" id="6186802">,</span>&nbsp;<span class="ident" id="6186804">err</span><span class="op" id="6186807">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186811">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6186823">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186882">if</span>&nbsp;<span class="op" id="6186885">!</span><span class="ident" id="6186886">ctxt</span><span class="op" id="6186890">.</span><span class="ident" id="6186891">shouldBuild</span><span class="op" id="6186902">(</span><span class="ident" id="6186903">data</span><span class="op" id="6186907">,</span>&nbsp;<span class="ident" id="6186909">allTags</span><span class="op" id="6186916">)</span>&nbsp;<span class="op" id="6186918">&amp;&amp;</span>&nbsp;<span class="op" id="6186921">!</span><span class="ident" id="6186922">ctxt</span><span class="op" id="6186926">.</span><span class="ident" id="6186927">UseAllFiles</span>&nbsp;<span class="op" id="6186939">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186943">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6186951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6186955">match</span>&nbsp;<span class="op" id="6186961">=</span>&nbsp;<span class="ident" id="6186963">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6186969">return</span><br>
<span class="lineno">975</span><span class="op" id="6186976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6186979">func</span>&nbsp;<span class="ident" id="6186984">cleanImports</span><span class="op" id="6186996">(</span><span class="ident" id="6186997">m</span>&nbsp;<span class="keyword" id="6186999">map</span><span class="op" id="6187002">[</span><span class="builtintype" id="6187003">string</span><span class="op" id="6187009">]</span><span class="op" id="6187010">[</span><span class="op" id="6187011">]</span><span class="ident" id="6187012">token</span><span class="op" id="6187017">.</span><span class="ident" id="6187018">Position</span><span class="op" id="6187026">)</span>&nbsp;<span class="op" id="6187028">(</span><span class="op" id="6187029">[</span><span class="op" id="6187030">]</span><span class="builtintype" id="6187031">string</span><span class="op" id="6187037">,</span>&nbsp;<span class="keyword" id="6187039">map</span><span class="op" id="6187042">[</span><span class="builtintype" id="6187043">string</span><span class="op" id="6187049">]</span><span class="op" id="6187050">[</span><span class="op" id="6187051">]</span><span class="ident" id="6187052">token</span><span class="op" id="6187057">.</span><span class="ident" id="6187058">Position</span><span class="op" id="6187066">)</span>&nbsp;<span class="op" id="6187068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187071">all</span>&nbsp;<span class="op" id="6187075">:=</span>&nbsp;<span class="builtinfunc" id="6187078">make</span><span class="op" id="6187082">(</span><span class="op" id="6187083">[</span><span class="op" id="6187084">]</span><span class="builtintype" id="6187085">string</span><span class="op" id="6187091">,</span>&nbsp;<span class="num" id="6187093">0</span><span class="op" id="6187094">,</span>&nbsp;<span class="builtinfunc" id="6187096">len</span><span class="op" id="6187099">(</span><span class="ident" id="6187100">m</span><span class="op" id="6187101">)</span><span class="op" id="6187102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6187105">for</span>&nbsp;<span class="ident" id="6187109">path</span>&nbsp;<span class="op" id="6187114">:=</span>&nbsp;<span class="keyword" id="6187117">range</span>&nbsp;<span class="ident" id="6187123">m</span>&nbsp;<span class="op" id="6187125">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187129">all</span>&nbsp;<span class="op" id="6187133">=</span>&nbsp;<span class="builtinfunc" id="6187135">append</span><span class="op" id="6187141">(</span><span class="ident" id="6187142">all</span><span class="op" id="6187145">,</span>&nbsp;<span class="ident" id="6187147">path</span><span class="op" id="6187151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6187154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6187157">sort</span><span class="op" id="6187161">.</span><span class="ident" id="6187162">Strings</span><span class="op" id="6187169">(</span><span class="ident" id="6187170">all</span><span class="op" id="6187173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6187176">return</span>&nbsp;<span class="ident" id="6187183">all</span><span class="op" id="6187186">,</span>&nbsp;<span class="ident" id="6187188">m</span><br>
<span class="lineno"></span><span class="op" id="6187190">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="6187193">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="6187236">func</span>&nbsp;<span class="ident" id="6187241">Import</span><span class="op" id="6187247">(</span><span class="ident" id="6187248">path</span><span class="op" id="6187252">,</span>&nbsp;<span class="ident" id="6187254">srcDir</span>&nbsp;<span class="builtintype" id="6187261">string</span><span class="op" id="6187267">,</span>&nbsp;<span class="ident" id="6187269">mode</span>&nbsp;<span class="ident" id="6187274">ImportMode</span><span class="op" id="6187284">)</span>&nbsp;<span class="op" id="6187286">(</span><span class="op" id="6187287">*</span><span class="ident" id="6187288">Package</span><span class="op" id="6187295">,</span>&nbsp;<span class="builtintype" id="6187297">error</span><span class="op" id="6187302">)</span>&nbsp;<span class="op" id="6187304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6187307">return</span>&nbsp;<span class="ident" id="6187314">Default</span><span class="op" id="6187321">.</span><span class="ident" id="6187322">Import</span><span class="op" id="6187328">(</span><span class="ident" id="6187329">path</span><span class="op" id="6187333">,</span>&nbsp;<span class="ident" id="6187335">srcDir</span><span class="op" id="6187341">,</span>&nbsp;<span class="ident" id="6187343">mode</span><span class="op" id="6187347">)</span><br>
<span class="lineno"></span><span class="op" id="6187349">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="6187352">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6187401">func</span>&nbsp;<span class="ident" id="6187406">ImportDir</span><span class="op" id="6187415">(</span><span class="ident" id="6187416">dir</span>&nbsp;<span class="builtintype" id="6187420">string</span><span class="op" id="6187426">,</span>&nbsp;<span class="ident" id="6187428">mode</span>&nbsp;<span class="ident" id="6187433">ImportMode</span><span class="op" id="6187443">)</span>&nbsp;<span class="op" id="6187445">(</span><span class="op" id="6187446">*</span><span class="ident" id="6187447">Package</span><span class="op" id="6187454">,</span>&nbsp;<span class="builtintype" id="6187456">error</span><span class="op" id="6187461">)</span>&nbsp;<span class="op" id="6187463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6187466">return</span>&nbsp;<span class="ident" id="6187473">Default</span><span class="op" id="6187480">.</span><span class="ident" id="6187481">ImportDir</span><span class="op" id="6187490">(</span><span class="ident" id="6187491">dir</span><span class="op" id="6187494">,</span>&nbsp;<span class="ident" id="6187496">mode</span><span class="op" id="6187500">)</span><br>
<span class="lineno"></span><span class="op" id="6187502">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="6187505">var</span>&nbsp;<span class="ident" id="6187509">slashslash</span>&nbsp;<span class="op" id="6187520">=</span>&nbsp;<span class="op" id="6187522">[</span><span class="op" id="6187523">]</span><span class="builtintype" id="6187524">byte</span><span class="op" id="6187528">(</span><span class="string" id="6187529">&#34;//&#34;</span><span class="op" id="6187533">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6187536">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="6187596">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="6187657">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="6187716">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="6187773">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="6187840">//</span><br>
<span class="lineno"></span><span class="comment" id="6187843">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="6187906">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6187942">//</span><br>
<span class="lineno"></span><span class="comment" id="6187945">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="6187972">//</span><br>
<span class="lineno"></span><span class="comment" id="6187975">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="6188034">//</span><br>
<span class="lineno"></span><span class="keyword" id="6188037">func</span>&nbsp;<span class="op" id="6188042">(</span><span class="ident" id="6188043">ctxt</span>&nbsp;<span class="op" id="6188048">*</span><span class="ident" id="6188049">Context</span><span class="op" id="6188056">)</span>&nbsp;<span class="ident" id="6188058">shouldBuild</span><span class="op" id="6188069">(</span><span class="ident" id="6188070">content</span>&nbsp;<span class="op" id="6188078">[</span><span class="op" id="6188079">]</span><span class="builtintype" id="6188080">byte</span><span class="op" id="6188084">,</span>&nbsp;<span class="ident" id="6188086">allTags</span>&nbsp;<span class="keyword" id="6188094">map</span><span class="op" id="6188097">[</span><span class="builtintype" id="6188098">string</span><span class="op" id="6188104">]</span><span class="builtintype" id="6188105">bool</span><span class="op" id="6188109">)</span>&nbsp;<span class="builtintype" id="6188111">bool</span>&nbsp;<span class="op" id="6188116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188119">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188184">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188228">end</span>&nbsp;<span class="op" id="6188232">:=</span>&nbsp;<span class="num" id="6188235">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188238">p</span>&nbsp;<span class="op" id="6188240">:=</span>&nbsp;<span class="ident" id="6188243">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188252">for</span>&nbsp;<span class="builtinfunc" id="6188256">len</span><span class="op" id="6188259">(</span><span class="ident" id="6188260">p</span><span class="op" id="6188261">)</span>&nbsp;<span class="op" id="6188263">&gt;</span>&nbsp;<span class="num" id="6188265">0</span>&nbsp;<span class="op" id="6188267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188271">line</span>&nbsp;<span class="op" id="6188276">:=</span>&nbsp;<span class="ident" id="6188279">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188283">if</span>&nbsp;<span class="ident" id="6188286">i</span>&nbsp;<span class="op" id="6188288">:=</span>&nbsp;<span class="ident" id="6188291">bytes</span><span class="op" id="6188296">.</span><span class="ident" id="6188297">IndexByte</span><span class="op" id="6188306">(</span><span class="ident" id="6188307">line</span><span class="op" id="6188311">,</span>&nbsp;<span class="string" id="6188313">&#39;\n&#39;</span><span class="op" id="6188317">)</span><span class="op" id="6188318">;</span>&nbsp;<span class="ident" id="6188320">i</span>&nbsp;<span class="op" id="6188322">&gt;=</span>&nbsp;<span class="num" id="6188325">0</span>&nbsp;<span class="op" id="6188327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188332">line</span><span class="op" id="6188336">,</span>&nbsp;<span class="ident" id="6188338">p</span>&nbsp;<span class="op" id="6188340">=</span>&nbsp;<span class="ident" id="6188342">line</span><span class="op" id="6188346">[</span><span class="op" id="6188347">:</span><span class="ident" id="6188348">i</span><span class="op" id="6188349">]</span><span class="op" id="6188350">,</span>&nbsp;<span class="ident" id="6188352">p</span><span class="op" id="6188353">[</span><span class="ident" id="6188354">i</span><span class="op" id="6188355">+</span><span class="num" id="6188356">1</span><span class="op" id="6188357">:</span><span class="op" id="6188358">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188362">}</span>&nbsp;<span class="keyword" id="6188364">else</span>&nbsp;<span class="op" id="6188369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188374">p</span>&nbsp;<span class="op" id="6188376">=</span>&nbsp;<span class="ident" id="6188378">p</span><span class="op" id="6188379">[</span><span class="builtinfunc" id="6188380">len</span><span class="op" id="6188383">(</span><span class="ident" id="6188384">p</span><span class="op" id="6188385">)</span><span class="op" id="6188386">:</span><span class="op" id="6188387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188395">line</span>&nbsp;<span class="op" id="6188400">=</span>&nbsp;<span class="ident" id="6188402">bytes</span><span class="op" id="6188407">.</span><span class="ident" id="6188408">TrimSpace</span><span class="op" id="6188417">(</span><span class="ident" id="6188418">line</span><span class="op" id="6188422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188426">if</span>&nbsp;<span class="builtinfunc" id="6188429">len</span><span class="op" id="6188432">(</span><span class="ident" id="6188433">line</span><span class="op" id="6188437">)</span>&nbsp;<span class="op" id="6188439">==</span>&nbsp;<span class="num" id="6188442">0</span>&nbsp;<span class="op" id="6188444">{</span>&nbsp;<span class="comment" id="6188446">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188463">end</span>&nbsp;<span class="op" id="6188467">=</span>&nbsp;<span class="builtinfunc" id="6188469">len</span><span class="op" id="6188472">(</span><span class="ident" id="6188473">content</span><span class="op" id="6188480">)</span>&nbsp;<span class="op" id="6188482">-</span>&nbsp;<span class="builtinfunc" id="6188484">len</span><span class="op" id="6188487">(</span><span class="ident" id="6188488">p</span><span class="op" id="6188489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188494">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188509">if</span>&nbsp;<span class="op" id="6188512">!</span><span class="ident" id="6188513">bytes</span><span class="op" id="6188518">.</span><span class="ident" id="6188519">HasPrefix</span><span class="op" id="6188528">(</span><span class="ident" id="6188529">line</span><span class="op" id="6188533">,</span>&nbsp;<span class="ident" id="6188535">slashslash</span><span class="op" id="6188545">)</span>&nbsp;<span class="op" id="6188547">{</span>&nbsp;<span class="comment" id="6188549">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188572">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188586">content</span>&nbsp;<span class="op" id="6188594">=</span>&nbsp;<span class="ident" id="6188596">content</span><span class="op" id="6188603">[</span><span class="op" id="6188604">:</span><span class="ident" id="6188605">end</span><span class="op" id="6188608">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188612">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188655">p</span>&nbsp;<span class="op" id="6188657">=</span>&nbsp;<span class="ident" id="6188659">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188668">allok</span>&nbsp;<span class="op" id="6188674">:=</span>&nbsp;<span class="ident" id="6188677">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188683">for</span>&nbsp;<span class="builtinfunc" id="6188687">len</span><span class="op" id="6188690">(</span><span class="ident" id="6188691">p</span><span class="op" id="6188692">)</span>&nbsp;<span class="op" id="6188694">&gt;</span>&nbsp;<span class="num" id="6188696">0</span>&nbsp;<span class="op" id="6188698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188702">line</span>&nbsp;<span class="op" id="6188707">:=</span>&nbsp;<span class="ident" id="6188710">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188714">if</span>&nbsp;<span class="ident" id="6188717">i</span>&nbsp;<span class="op" id="6188719">:=</span>&nbsp;<span class="ident" id="6188722">bytes</span><span class="op" id="6188727">.</span><span class="ident" id="6188728">IndexByte</span><span class="op" id="6188737">(</span><span class="ident" id="6188738">line</span><span class="op" id="6188742">,</span>&nbsp;<span class="string" id="6188744">&#39;\n&#39;</span><span class="op" id="6188748">)</span><span class="op" id="6188749">;</span>&nbsp;<span class="ident" id="6188751">i</span>&nbsp;<span class="op" id="6188753">&gt;=</span>&nbsp;<span class="num" id="6188756">0</span>&nbsp;<span class="op" id="6188758">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188763">line</span><span class="op" id="6188767">,</span>&nbsp;<span class="ident" id="6188769">p</span>&nbsp;<span class="op" id="6188771">=</span>&nbsp;<span class="ident" id="6188773">line</span><span class="op" id="6188777">[</span><span class="op" id="6188778">:</span><span class="ident" id="6188779">i</span><span class="op" id="6188780">]</span><span class="op" id="6188781">,</span>&nbsp;<span class="ident" id="6188783">p</span><span class="op" id="6188784">[</span><span class="ident" id="6188785">i</span><span class="op" id="6188786">+</span><span class="num" id="6188787">1</span><span class="op" id="6188788">:</span><span class="op" id="6188789">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188793">}</span>&nbsp;<span class="keyword" id="6188795">else</span>&nbsp;<span class="op" id="6188800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188805">p</span>&nbsp;<span class="op" id="6188807">=</span>&nbsp;<span class="ident" id="6188809">p</span><span class="op" id="6188810">[</span><span class="builtinfunc" id="6188811">len</span><span class="op" id="6188814">(</span><span class="ident" id="6188815">p</span><span class="op" id="6188816">)</span><span class="op" id="6188817">:</span><span class="op" id="6188818">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6188822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188826">line</span>&nbsp;<span class="op" id="6188831">=</span>&nbsp;<span class="ident" id="6188833">bytes</span><span class="op" id="6188838">.</span><span class="ident" id="6188839">TrimSpace</span><span class="op" id="6188848">(</span><span class="ident" id="6188849">line</span><span class="op" id="6188853">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188857">if</span>&nbsp;<span class="ident" id="6188860">bytes</span><span class="op" id="6188865">.</span><span class="ident" id="6188866">HasPrefix</span><span class="op" id="6188875">(</span><span class="ident" id="6188876">line</span><span class="op" id="6188880">,</span>&nbsp;<span class="ident" id="6188882">slashslash</span><span class="op" id="6188892">)</span>&nbsp;<span class="op" id="6188894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6188899">line</span>&nbsp;<span class="op" id="6188904">=</span>&nbsp;<span class="ident" id="6188906">bytes</span><span class="op" id="6188911">.</span><span class="ident" id="6188912">TrimSpace</span><span class="op" id="6188921">(</span><span class="ident" id="6188922">line</span><span class="op" id="6188926">[</span><span class="builtinfunc" id="6188927">len</span><span class="op" id="6188930">(</span><span class="ident" id="6188931">slashslash</span><span class="op" id="6188941">)</span><span class="op" id="6188942">:</span><span class="op" id="6188943">]</span><span class="op" id="6188944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6188949">if</span>&nbsp;<span class="builtinfunc" id="6188952">len</span><span class="op" id="6188955">(</span><span class="ident" id="6188956">line</span><span class="op" id="6188960">)</span>&nbsp;<span class="op" id="6188962">&gt;</span>&nbsp;<span class="num" id="6188964">0</span>&nbsp;<span class="op" id="6188966">&amp;&amp;</span>&nbsp;<span class="ident" id="6188969">line</span><span class="op" id="6188973">[</span><span class="num" id="6188974">0</span><span class="op" id="6188975">]</span>&nbsp;<span class="op" id="6188977">==</span>&nbsp;<span class="string" id="6188980">&#39;+&#39;</span>&nbsp;<span class="op" id="6188984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6188990">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189025">f</span>&nbsp;<span class="op" id="6189027">:=</span>&nbsp;<span class="ident" id="6189030">strings</span><span class="op" id="6189037">.</span><span class="ident" id="6189038">Fields</span><span class="op" id="6189044">(</span><span class="builtintype" id="6189045">string</span><span class="op" id="6189051">(</span><span class="ident" id="6189052">line</span><span class="op" id="6189056">)</span><span class="op" id="6189057">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189063">if</span>&nbsp;<span class="ident" id="6189066">f</span><span class="op" id="6189067">[</span><span class="num" id="6189068">0</span><span class="op" id="6189069">]</span>&nbsp;<span class="op" id="6189071">==</span>&nbsp;<span class="string" id="6189074">&#34;+build&#34;</span>&nbsp;<span class="op" id="6189083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189090">ok</span>&nbsp;<span class="op" id="6189093">:=</span>&nbsp;<span class="ident" id="6189096">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189107">for</span>&nbsp;<span class="ident" id="6189111">_</span><span class="op" id="6189112">,</span>&nbsp;<span class="ident" id="6189114">tok</span>&nbsp;<span class="op" id="6189118">:=</span>&nbsp;<span class="keyword" id="6189121">range</span>&nbsp;<span class="ident" id="6189127">f</span><span class="op" id="6189128">[</span><span class="num" id="6189129">1</span><span class="op" id="6189130">:</span><span class="op" id="6189131">]</span>&nbsp;<span class="op" id="6189133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189141">if</span>&nbsp;<span class="ident" id="6189144">ctxt</span><span class="op" id="6189148">.</span><span class="ident" id="6189149">match</span><span class="op" id="6189154">(</span><span class="ident" id="6189155">tok</span><span class="op" id="6189158">,</span>&nbsp;<span class="ident" id="6189160">allTags</span><span class="op" id="6189167">)</span>&nbsp;<span class="op" id="6189169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189178">ok</span>&nbsp;<span class="op" id="6189181">=</span>&nbsp;<span class="ident" id="6189183">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189208">if</span>&nbsp;<span class="op" id="6189211">!</span><span class="ident" id="6189212">ok</span>&nbsp;<span class="op" id="6189215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189223">allok</span>&nbsp;<span class="op" id="6189229">=</span>&nbsp;<span class="ident" id="6189231">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189242">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189264">return</span>&nbsp;<span class="ident" id="6189271">allok</span><br>
<span class="lineno"></span><span class="op" id="6189277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6189280">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="6189360">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="6189444">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="6189490">//</span><br>
<span class="lineno"></span><span class="comment" id="6189493">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="6189536">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="6189589">func</span>&nbsp;<span class="op" id="6189594">(</span><span class="ident" id="6189595">ctxt</span>&nbsp;<span class="op" id="6189600">*</span><span class="ident" id="6189601">Context</span><span class="op" id="6189608">)</span>&nbsp;<span class="ident" id="6189610">saveCgo</span><span class="op" id="6189617">(</span><span class="ident" id="6189618">filename</span>&nbsp;<span class="builtintype" id="6189627">string</span><span class="op" id="6189633">,</span>&nbsp;<span class="ident" id="6189635">di</span>&nbsp;<span class="op" id="6189638">*</span><span class="ident" id="6189639">Package</span><span class="op" id="6189646">,</span>&nbsp;<span class="ident" id="6189648">cg</span>&nbsp;<span class="op" id="6189651">*</span><span class="ident" id="6189652">ast</span><span class="op" id="6189655">.</span><span class="ident" id="6189656">CommentGroup</span><span class="op" id="6189668">)</span>&nbsp;<span class="builtintype" id="6189670">error</span>&nbsp;<span class="op" id="6189676">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189679">text</span>&nbsp;<span class="op" id="6189684">:=</span>&nbsp;<span class="ident" id="6189687">cg</span><span class="op" id="6189689">.</span><span class="ident" id="6189690">Text</span><span class="op" id="6189694">(</span><span class="op" id="6189695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189698">for</span>&nbsp;<span class="ident" id="6189702">_</span><span class="op" id="6189703">,</span>&nbsp;<span class="ident" id="6189705">line</span>&nbsp;<span class="op" id="6189710">:=</span>&nbsp;<span class="keyword" id="6189713">range</span>&nbsp;<span class="ident" id="6189719">strings</span><span class="op" id="6189726">.</span><span class="ident" id="6189727">Split</span><span class="op" id="6189732">(</span><span class="ident" id="6189733">text</span><span class="op" id="6189737">,</span>&nbsp;<span class="string" id="6189739">&#34;\n&#34;</span><span class="op" id="6189743">)</span>&nbsp;<span class="op" id="6189745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189749">orig</span>&nbsp;<span class="op" id="6189754">:=</span>&nbsp;<span class="ident" id="6189757">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189765">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189778">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189820">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189825">line</span>&nbsp;<span class="op" id="6189830">=</span>&nbsp;<span class="ident" id="6189832">strings</span><span class="op" id="6189839">.</span><span class="ident" id="6189840">TrimSpace</span><span class="op" id="6189849">(</span><span class="ident" id="6189850">line</span><span class="op" id="6189854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189858">if</span>&nbsp;<span class="builtinfunc" id="6189861">len</span><span class="op" id="6189864">(</span><span class="ident" id="6189865">line</span><span class="op" id="6189869">)</span>&nbsp;<span class="op" id="6189871">&lt;</span>&nbsp;<span class="num" id="6189873">5</span>&nbsp;<span class="op" id="6189875">||</span>&nbsp;<span class="ident" id="6189878">line</span><span class="op" id="6189882">[</span><span class="op" id="6189883">:</span><span class="num" id="6189884">4</span><span class="op" id="6189885">]</span>&nbsp;<span class="op" id="6189887">!=</span>&nbsp;<span class="string" id="6189890">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="6189897">||</span>&nbsp;<span class="op" id="6189900">(</span><span class="ident" id="6189901">line</span><span class="op" id="6189905">[</span><span class="num" id="6189906">4</span><span class="op" id="6189907">]</span>&nbsp;<span class="op" id="6189909">!=</span>&nbsp;<span class="string" id="6189912">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6189916">&amp;&amp;</span>&nbsp;<span class="ident" id="6189919">line</span><span class="op" id="6189923">[</span><span class="num" id="6189924">4</span><span class="op" id="6189925">]</span>&nbsp;<span class="op" id="6189927">!=</span>&nbsp;<span class="string" id="6189930">&#39;\t&#39;</span><span class="op" id="6189934">)</span>&nbsp;<span class="op" id="6189936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6189941">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6189952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6189957">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6189978">line</span>&nbsp;<span class="op" id="6189983">=</span>&nbsp;<span class="ident" id="6189985">strings</span><span class="op" id="6189992">.</span><span class="ident" id="6189993">TrimSpace</span><span class="op" id="6190002">(</span><span class="ident" id="6190003">line</span><span class="op" id="6190007">[</span><span class="num" id="6190008">4</span><span class="op" id="6190009">:</span><span class="op" id="6190010">]</span><span class="op" id="6190011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190015">i</span>&nbsp;<span class="op" id="6190017">:=</span>&nbsp;<span class="ident" id="6190020">strings</span><span class="op" id="6190027">.</span><span class="ident" id="6190028">Index</span><span class="op" id="6190033">(</span><span class="ident" id="6190034">line</span><span class="op" id="6190038">,</span>&nbsp;<span class="string" id="6190040">&#34;:&#34;</span><span class="op" id="6190043">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190047">if</span>&nbsp;<span class="ident" id="6190050">i</span>&nbsp;<span class="op" id="6190052">&lt;</span>&nbsp;<span class="num" id="6190054">0</span>&nbsp;<span class="op" id="6190056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190061">return</span>&nbsp;<span class="ident" id="6190068">fmt</span><span class="op" id="6190071">.</span><span class="ident" id="6190072">Errorf</span><span class="op" id="6190078">(</span><span class="string" id="6190079">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6190106">,</span>&nbsp;<span class="ident" id="6190108">filename</span><span class="op" id="6190116">,</span>&nbsp;<span class="ident" id="6190118">orig</span><span class="op" id="6190122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190130">line</span><span class="op" id="6190134">,</span>&nbsp;<span class="ident" id="6190136">argstr</span>&nbsp;<span class="op" id="6190143">:=</span>&nbsp;<span class="ident" id="6190146">line</span><span class="op" id="6190150">[</span><span class="op" id="6190151">:</span><span class="ident" id="6190152">i</span><span class="op" id="6190153">]</span><span class="op" id="6190154">,</span>&nbsp;<span class="ident" id="6190156">line</span><span class="op" id="6190160">[</span><span class="ident" id="6190161">i</span><span class="op" id="6190162">+</span><span class="num" id="6190163">1</span><span class="op" id="6190164">:</span><span class="op" id="6190165">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6190170">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190200">f</span>&nbsp;<span class="op" id="6190202">:=</span>&nbsp;<span class="ident" id="6190205">strings</span><span class="op" id="6190212">.</span><span class="ident" id="6190213">Fields</span><span class="op" id="6190219">(</span><span class="ident" id="6190220">line</span><span class="op" id="6190224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190228">if</span>&nbsp;<span class="builtinfunc" id="6190231">len</span><span class="op" id="6190234">(</span><span class="ident" id="6190235">f</span><span class="op" id="6190236">)</span>&nbsp;<span class="op" id="6190238">&lt;</span>&nbsp;<span class="num" id="6190240">1</span>&nbsp;<span class="op" id="6190242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190247">return</span>&nbsp;<span class="ident" id="6190254">fmt</span><span class="op" id="6190257">.</span><span class="ident" id="6190258">Errorf</span><span class="op" id="6190264">(</span><span class="string" id="6190265">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6190292">,</span>&nbsp;<span class="ident" id="6190294">filename</span><span class="op" id="6190302">,</span>&nbsp;<span class="ident" id="6190304">orig</span><span class="op" id="6190308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190312">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190317">cond</span><span class="op" id="6190321">,</span>&nbsp;<span class="ident" id="6190323">verb</span>&nbsp;<span class="op" id="6190328">:=</span>&nbsp;<span class="ident" id="6190331">f</span><span class="op" id="6190332">[</span><span class="op" id="6190333">:</span><span class="builtinfunc" id="6190334">len</span><span class="op" id="6190337">(</span><span class="ident" id="6190338">f</span><span class="op" id="6190339">)</span><span class="op" id="6190340">-</span><span class="num" id="6190341">1</span><span class="op" id="6190342">]</span><span class="op" id="6190343">,</span>&nbsp;<span class="ident" id="6190345">f</span><span class="op" id="6190346">[</span><span class="builtinfunc" id="6190347">len</span><span class="op" id="6190350">(</span><span class="ident" id="6190351">f</span><span class="op" id="6190352">)</span><span class="op" id="6190353">-</span><span class="num" id="6190354">1</span><span class="op" id="6190355">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190359">if</span>&nbsp;<span class="builtinfunc" id="6190362">len</span><span class="op" id="6190365">(</span><span class="ident" id="6190366">cond</span><span class="op" id="6190370">)</span>&nbsp;<span class="op" id="6190372">&gt;</span>&nbsp;<span class="num" id="6190374">0</span>&nbsp;<span class="op" id="6190376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190381">ok</span>&nbsp;<span class="op" id="6190384">:=</span>&nbsp;<span class="ident" id="6190387">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190396">for</span>&nbsp;<span class="ident" id="6190400">_</span><span class="op" id="6190401">,</span>&nbsp;<span class="ident" id="6190403">c</span>&nbsp;<span class="op" id="6190405">:=</span>&nbsp;<span class="keyword" id="6190408">range</span>&nbsp;<span class="ident" id="6190414">cond</span>&nbsp;<span class="op" id="6190419">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190425">if</span>&nbsp;<span class="ident" id="6190428">ctxt</span><span class="op" id="6190432">.</span><span class="ident" id="6190433">match</span><span class="op" id="6190438">(</span><span class="ident" id="6190439">c</span><span class="op" id="6190440">,</span>&nbsp;<span class="ident" id="6190442">nil</span><span class="op" id="6190445">)</span>&nbsp;<span class="op" id="6190447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190454">ok</span>&nbsp;<span class="op" id="6190457">=</span>&nbsp;<span class="ident" id="6190459">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190469">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190484">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190489">if</span>&nbsp;<span class="op" id="6190492">!</span><span class="ident" id="6190493">ok</span>&nbsp;<span class="op" id="6190496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190502">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190523">args</span><span class="op" id="6190527">,</span>&nbsp;<span class="ident" id="6190529">err</span>&nbsp;<span class="op" id="6190533">:=</span>&nbsp;<span class="ident" id="6190536">splitQuoted</span><span class="op" id="6190547">(</span><span class="ident" id="6190548">argstr</span><span class="op" id="6190554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190558">if</span>&nbsp;<span class="ident" id="6190561">err</span>&nbsp;<span class="op" id="6190565">!=</span>&nbsp;<span class="ident" id="6190568">nil</span>&nbsp;<span class="op" id="6190572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190577">return</span>&nbsp;<span class="ident" id="6190584">fmt</span><span class="op" id="6190587">.</span><span class="ident" id="6190588">Errorf</span><span class="op" id="6190594">(</span><span class="string" id="6190595">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6190622">,</span>&nbsp;<span class="ident" id="6190624">filename</span><span class="op" id="6190632">,</span>&nbsp;<span class="ident" id="6190634">orig</span><span class="op" id="6190638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190646">for</span>&nbsp;<span class="ident" id="6190650">_</span><span class="op" id="6190651">,</span>&nbsp;<span class="ident" id="6190653">arg</span>&nbsp;<span class="op" id="6190657">:=</span>&nbsp;<span class="keyword" id="6190660">range</span>&nbsp;<span class="ident" id="6190666">args</span>&nbsp;<span class="op" id="6190671">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190676">if</span>&nbsp;<span class="op" id="6190679">!</span><span class="ident" id="6190680">safeCgoName</span><span class="op" id="6190691">(</span><span class="ident" id="6190692">arg</span><span class="op" id="6190695">)</span>&nbsp;<span class="op" id="6190697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190703">return</span>&nbsp;<span class="ident" id="6190710">fmt</span><span class="op" id="6190713">.</span><span class="ident" id="6190714">Errorf</span><span class="op" id="6190720">(</span><span class="string" id="6190721">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="6190754">,</span>&nbsp;<span class="ident" id="6190756">filename</span><span class="op" id="6190764">,</span>&nbsp;<span class="ident" id="6190766">arg</span><span class="op" id="6190769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6190778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190783">switch</span>&nbsp;<span class="ident" id="6190790">verb</span>&nbsp;<span class="op" id="6190795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190799">case</span>&nbsp;<span class="string" id="6190804">&#34;CFLAGS&#34;</span><span class="op" id="6190812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190817">di</span><span class="op" id="6190819">.</span><span class="ident" id="6190820">CgoCFLAGS</span>&nbsp;<span class="op" id="6190830">=</span>&nbsp;<span class="builtinfunc" id="6190832">append</span><span class="op" id="6190838">(</span><span class="ident" id="6190839">di</span><span class="op" id="6190841">.</span><span class="ident" id="6190842">CgoCFLAGS</span><span class="op" id="6190851">,</span>&nbsp;<span class="ident" id="6190853">args</span><span class="op" id="6190857">...</span><span class="op" id="6190860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190864">case</span>&nbsp;<span class="string" id="6190869">&#34;CPPFLAGS&#34;</span><span class="op" id="6190879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190884">di</span><span class="op" id="6190886">.</span><span class="ident" id="6190887">CgoCPPFLAGS</span>&nbsp;<span class="op" id="6190899">=</span>&nbsp;<span class="builtinfunc" id="6190901">append</span><span class="op" id="6190907">(</span><span class="ident" id="6190908">di</span><span class="op" id="6190910">.</span><span class="ident" id="6190911">CgoCPPFLAGS</span><span class="op" id="6190922">,</span>&nbsp;<span class="ident" id="6190924">args</span><span class="op" id="6190928">...</span><span class="op" id="6190931">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6190935">case</span>&nbsp;<span class="string" id="6190940">&#34;CXXFLAGS&#34;</span><span class="op" id="6190950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6190955">di</span><span class="op" id="6190957">.</span><span class="ident" id="6190958">CgoCXXFLAGS</span>&nbsp;<span class="op" id="6190970">=</span>&nbsp;<span class="builtinfunc" id="6190972">append</span><span class="op" id="6190978">(</span><span class="ident" id="6190979">di</span><span class="op" id="6190981">.</span><span class="ident" id="6190982">CgoCXXFLAGS</span><span class="op" id="6190993">,</span>&nbsp;<span class="ident" id="6190995">args</span><span class="op" id="6190999">...</span><span class="op" id="6191002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191006">case</span>&nbsp;<span class="string" id="6191011">&#34;LDFLAGS&#34;</span><span class="op" id="6191020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191025">di</span><span class="op" id="6191027">.</span><span class="ident" id="6191028">CgoLDFLAGS</span>&nbsp;<span class="op" id="6191039">=</span>&nbsp;<span class="builtinfunc" id="6191041">append</span><span class="op" id="6191047">(</span><span class="ident" id="6191048">di</span><span class="op" id="6191050">.</span><span class="ident" id="6191051">CgoLDFLAGS</span><span class="op" id="6191061">,</span>&nbsp;<span class="ident" id="6191063">args</span><span class="op" id="6191067">...</span><span class="op" id="6191070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191074">case</span>&nbsp;<span class="string" id="6191079">&#34;pkg-config&#34;</span><span class="op" id="6191091">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6191096">di</span><span class="op" id="6191098">.</span><span class="ident" id="6191099">CgoPkgConfig</span>&nbsp;<span class="op" id="6191112">=</span>&nbsp;<span class="builtinfunc" id="6191114">append</span><span class="op" id="6191120">(</span><span class="ident" id="6191121">di</span><span class="op" id="6191123">.</span><span class="ident" id="6191124">CgoPkgConfig</span><span class="op" id="6191136">,</span>&nbsp;<span class="ident" id="6191138">args</span><span class="op" id="6191142">...</span><span class="op" id="6191145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191149">default</span><span class="op" id="6191156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191161">return</span>&nbsp;<span class="ident" id="6191168">fmt</span><span class="op" id="6191171">.</span><span class="ident" id="6191172">Errorf</span><span class="op" id="6191178">(</span><span class="string" id="6191179">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="6191206">,</span>&nbsp;<span class="ident" id="6191208">filename</span><span class="op" id="6191216">,</span>&nbsp;<span class="ident" id="6191218">orig</span><span class="op" id="6191222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6191226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6191229">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191232">return</span>&nbsp;<span class="ident" id="6191239">nil</span><br>
<span class="lineno"></span><span class="op" id="6191243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6191246">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="6191351">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="6191461">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="6191491">var</span>&nbsp;<span class="ident" id="6191495">safeBytes</span>&nbsp;<span class="op" id="6191505">=</span>&nbsp;<span class="op" id="6191507">[</span><span class="op" id="6191508">]</span><span class="builtintype" id="6191509">byte</span><span class="op" id="6191513">(</span><span class="string" id="6191514">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="6191587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6191590">func</span>&nbsp;<span class="ident" id="6191595">safeCgoName</span><span class="op" id="6191606">(</span><span class="ident" id="6191607">s</span>&nbsp;<span class="builtintype" id="6191609">string</span><span class="op" id="6191615">)</span>&nbsp;<span class="builtintype" id="6191617">bool</span>&nbsp;<span class="op" id="6191622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191625">if</span>&nbsp;<span class="ident" id="6191628">s</span>&nbsp;<span class="op" id="6191630">==</span>&nbsp;<span class="string" id="6191633">&#34;&#34;</span>&nbsp;<span class="op" id="6191636">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191640">return</span>&nbsp;<span class="ident" id="6191647">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6191654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191657">for</span>&nbsp;<span class="ident" id="6191661">i</span>&nbsp;<span class="op" id="6191663">:=</span>&nbsp;<span class="num" id="6191666">0</span><span class="op" id="6191667">;</span>&nbsp;<span class="ident" id="6191669">i</span>&nbsp;<span class="op" id="6191671">&lt;</span>&nbsp;<span class="builtinfunc" id="6191673">len</span><span class="op" id="6191676">(</span><span class="ident" id="6191677">s</span><span class="op" id="6191678">)</span><span class="op" id="6191679">;</span>&nbsp;<span class="ident" id="6191681">i</span><span class="op" id="6191682">++</span>&nbsp;<span class="op" id="6191685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191689">if</span>&nbsp;<span class="ident" id="6191692">c</span>&nbsp;<span class="op" id="6191694">:=</span>&nbsp;<span class="ident" id="6191697">s</span><span class="op" id="6191698">[</span><span class="ident" id="6191699">i</span><span class="op" id="6191700">]</span><span class="op" id="6191701">;</span>&nbsp;<span class="ident" id="6191703">c</span>&nbsp;<span class="op" id="6191705">&lt;</span>&nbsp;<span class="num" id="6191707">0x80</span>&nbsp;<span class="op" id="6191712">&amp;&amp;</span>&nbsp;<span class="ident" id="6191715">bytes</span><span class="op" id="6191720">.</span><span class="ident" id="6191721">IndexByte</span><span class="op" id="6191730">(</span><span class="ident" id="6191731">safeBytes</span><span class="op" id="6191740">,</span>&nbsp;<span class="ident" id="6191742">c</span><span class="op" id="6191743">)</span>&nbsp;<span class="op" id="6191745">&lt;</span>&nbsp;<span class="num" id="6191747">0</span>&nbsp;<span class="op" id="6191749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191754">return</span>&nbsp;<span class="ident" id="6191761">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6191769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6191772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6191775">return</span>&nbsp;<span class="ident" id="6191782">true</span><br>
<span class="lineno"></span><span class="op" id="6191787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="6191790">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="6191873">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6191950">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="6192038">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6192120">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="6192201">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6192278">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="6192332">//</span><br>
<span class="lineno"></span><span class="comment" id="6192335">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="6192373">//</span><br>
<span class="lineno">1170</span><span class="comment" id="6192376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6192407">//</span><br>
<span class="lineno"></span><span class="comment" id="6192410">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="6192433">//</span><br>
<span class="lineno"></span><span class="comment" id="6192436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="6192478">//</span><br>
<span class="lineno"></span><span class="keyword" id="6192481">func</span>&nbsp;<span class="ident" id="6192486">splitQuoted</span><span class="op" id="6192497">(</span><span class="ident" id="6192498">s</span>&nbsp;<span class="builtintype" id="6192500">string</span><span class="op" id="6192506">)</span>&nbsp;<span class="op" id="6192508">(</span><span class="ident" id="6192509">r</span>&nbsp;<span class="op" id="6192511">[</span><span class="op" id="6192512">]</span><span class="builtintype" id="6192513">string</span><span class="op" id="6192519">,</span>&nbsp;<span class="ident" id="6192521">err</span>&nbsp;<span class="builtintype" id="6192525">error</span><span class="op" id="6192530">)</span>&nbsp;<span class="op" id="6192532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192535">var</span>&nbsp;<span class="ident" id="6192539">args</span>&nbsp;<span class="op" id="6192544">[</span><span class="op" id="6192545">]</span><span class="builtintype" id="6192546">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192554">arg</span>&nbsp;<span class="op" id="6192558">:=</span>&nbsp;<span class="builtinfunc" id="6192561">make</span><span class="op" id="6192565">(</span><span class="op" id="6192566">[</span><span class="op" id="6192567">]</span><span class="builtintype" id="6192568">rune</span><span class="op" id="6192572">,</span>&nbsp;<span class="builtinfunc" id="6192574">len</span><span class="op" id="6192577">(</span><span class="ident" id="6192578">s</span><span class="op" id="6192579">)</span><span class="op" id="6192580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192583">escaped</span>&nbsp;<span class="op" id="6192591">:=</span>&nbsp;<span class="ident" id="6192594">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192601">quoted</span>&nbsp;<span class="op" id="6192608">:=</span>&nbsp;<span class="ident" id="6192611">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192618">quote</span>&nbsp;<span class="op" id="6192624">:=</span>&nbsp;<span class="string" id="6192627">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192635">i</span>&nbsp;<span class="op" id="6192637">:=</span>&nbsp;<span class="num" id="6192640">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192643">for</span>&nbsp;<span class="ident" id="6192647">_</span><span class="op" id="6192648">,</span>&nbsp;<span class="builtintype" id="6192650">rune</span>&nbsp;<span class="op" id="6192655">:=</span>&nbsp;<span class="keyword" id="6192658">range</span>&nbsp;<span class="ident" id="6192664">s</span>&nbsp;<span class="op" id="6192666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192670">switch</span>&nbsp;<span class="op" id="6192677">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192681">case</span>&nbsp;<span class="ident" id="6192686">escaped</span><span class="op" id="6192693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192698">escaped</span>&nbsp;<span class="op" id="6192706">=</span>&nbsp;<span class="ident" id="6192708">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192716">case</span>&nbsp;<span class="builtintype" id="6192721">rune</span>&nbsp;<span class="op" id="6192726">==</span>&nbsp;<span class="string" id="6192729">&#39;\\&#39;</span><span class="op" id="6192733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192738">escaped</span>&nbsp;<span class="op" id="6192746">=</span>&nbsp;<span class="ident" id="6192748">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192756">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192767">case</span>&nbsp;<span class="ident" id="6192772">quote</span>&nbsp;<span class="op" id="6192778">!=</span>&nbsp;<span class="string" id="6192781">&#39;\x00&#39;</span><span class="op" id="6192787">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192792">if</span>&nbsp;<span class="builtintype" id="6192795">rune</span>&nbsp;<span class="op" id="6192800">==</span>&nbsp;<span class="ident" id="6192803">quote</span>&nbsp;<span class="op" id="6192809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192815">quote</span>&nbsp;<span class="op" id="6192821">=</span>&nbsp;<span class="string" id="6192823">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192834">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6192846">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192850">case</span>&nbsp;<span class="builtintype" id="6192855">rune</span>&nbsp;<span class="op" id="6192860">==</span>&nbsp;<span class="string" id="6192863">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6192867">||</span>&nbsp;<span class="builtintype" id="6192870">rune</span>&nbsp;<span class="op" id="6192875">==</span>&nbsp;<span class="string" id="6192878">&#39;\&#39;&#39;</span><span class="op" id="6192882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192887">quoted</span>&nbsp;<span class="op" id="6192894">=</span>&nbsp;<span class="ident" id="6192896">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192904">quote</span>&nbsp;<span class="op" id="6192910">=</span>&nbsp;<span class="builtintype" id="6192912">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192920">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192931">case</span>&nbsp;<span class="ident" id="6192936">unicode</span><span class="op" id="6192943">.</span><span class="ident" id="6192944">IsSpace</span><span class="op" id="6192951">(</span><span class="builtintype" id="6192952">rune</span><span class="op" id="6192956">)</span><span class="op" id="6192957">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6192962">if</span>&nbsp;<span class="ident" id="6192965">quoted</span>&nbsp;<span class="op" id="6192972">||</span>&nbsp;<span class="ident" id="6192975">i</span>&nbsp;<span class="op" id="6192977">&gt;</span>&nbsp;<span class="num" id="6192979">0</span>&nbsp;<span class="op" id="6192981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6192987">quoted</span>&nbsp;<span class="op" id="6192994">=</span>&nbsp;<span class="ident" id="6192996">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193006">args</span>&nbsp;<span class="op" id="6193011">=</span>&nbsp;<span class="builtinfunc" id="6193013">append</span><span class="op" id="6193019">(</span><span class="ident" id="6193020">args</span><span class="op" id="6193024">,</span>&nbsp;<span class="builtintype" id="6193026">string</span><span class="op" id="6193032">(</span><span class="ident" id="6193033">arg</span><span class="op" id="6193036">[</span><span class="op" id="6193037">:</span><span class="ident" id="6193038">i</span><span class="op" id="6193039">]</span><span class="op" id="6193040">)</span><span class="op" id="6193041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193047">i</span>&nbsp;<span class="op" id="6193049">=</span>&nbsp;<span class="num" id="6193051">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193056">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193061">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193076">arg</span><span class="op" id="6193079">[</span><span class="ident" id="6193080">i</span><span class="op" id="6193081">]</span>&nbsp;<span class="op" id="6193083">=</span>&nbsp;<span class="builtintype" id="6193085">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193092">i</span><span class="op" id="6193093">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193097">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193100">if</span>&nbsp;<span class="ident" id="6193103">quoted</span>&nbsp;<span class="op" id="6193110">||</span>&nbsp;<span class="ident" id="6193113">i</span>&nbsp;<span class="op" id="6193115">&gt;</span>&nbsp;<span class="num" id="6193117">0</span>&nbsp;<span class="op" id="6193119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193123">args</span>&nbsp;<span class="op" id="6193128">=</span>&nbsp;<span class="builtinfunc" id="6193130">append</span><span class="op" id="6193136">(</span><span class="ident" id="6193137">args</span><span class="op" id="6193141">,</span>&nbsp;<span class="builtintype" id="6193143">string</span><span class="op" id="6193149">(</span><span class="ident" id="6193150">arg</span><span class="op" id="6193153">[</span><span class="op" id="6193154">:</span><span class="ident" id="6193155">i</span><span class="op" id="6193156">]</span><span class="op" id="6193157">)</span><span class="op" id="6193158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193164">if</span>&nbsp;<span class="ident" id="6193167">quote</span>&nbsp;<span class="op" id="6193173">!=</span>&nbsp;<span class="num" id="6193176">0</span>&nbsp;<span class="op" id="6193178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193182">err</span>&nbsp;<span class="op" id="6193186">=</span>&nbsp;<span class="ident" id="6193188">errors</span><span class="op" id="6193194">.</span><span class="ident" id="6193195">New</span><span class="op" id="6193198">(</span><span class="string" id="6193199">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="6193215">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193218">}</span>&nbsp;<span class="keyword" id="6193220">else</span>&nbsp;<span class="keyword" id="6193225">if</span>&nbsp;<span class="ident" id="6193228">escaped</span>&nbsp;<span class="op" id="6193236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193240">err</span>&nbsp;<span class="op" id="6193244">=</span>&nbsp;<span class="ident" id="6193246">errors</span><span class="op" id="6193252">.</span><span class="ident" id="6193253">New</span><span class="op" id="6193256">(</span><span class="string" id="6193257">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="6193278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193284">return</span>&nbsp;<span class="ident" id="6193291">args</span><span class="op" id="6193295">,</span>&nbsp;<span class="ident" id="6193297">err</span><br>
<span class="lineno"></span><span class="op" id="6193301">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="6193304">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="6193349">//</span><br>
<span class="lineno"></span><span class="comment" id="6193352">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="6193361">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="6193372">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="6193399">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="6193428">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6193445">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6193463">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="6193527">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="6193596">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="6193638">//</span><br>
<span class="lineno"></span><span class="keyword" id="6193641">func</span>&nbsp;<span class="op" id="6193646">(</span><span class="ident" id="6193647">ctxt</span>&nbsp;<span class="op" id="6193652">*</span><span class="ident" id="6193653">Context</span><span class="op" id="6193660">)</span>&nbsp;<span class="ident" id="6193662">match</span><span class="op" id="6193667">(</span><span class="ident" id="6193668">name</span>&nbsp;<span class="builtintype" id="6193673">string</span><span class="op" id="6193679">,</span>&nbsp;<span class="ident" id="6193681">allTags</span>&nbsp;<span class="keyword" id="6193689">map</span><span class="op" id="6193692">[</span><span class="builtintype" id="6193693">string</span><span class="op" id="6193699">]</span><span class="builtintype" id="6193700">bool</span><span class="op" id="6193704">)</span>&nbsp;<span class="builtintype" id="6193706">bool</span>&nbsp;<span class="op" id="6193711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193714">if</span>&nbsp;<span class="ident" id="6193717">name</span>&nbsp;<span class="op" id="6193722">==</span>&nbsp;<span class="string" id="6193725">&#34;&#34;</span>&nbsp;<span class="op" id="6193728">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193732">if</span>&nbsp;<span class="ident" id="6193735">allTags</span>&nbsp;<span class="op" id="6193743">!=</span>&nbsp;<span class="ident" id="6193746">nil</span>&nbsp;<span class="op" id="6193750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193755">allTags</span><span class="op" id="6193762">[</span><span class="ident" id="6193763">name</span><span class="op" id="6193767">]</span>&nbsp;<span class="op" id="6193769">=</span>&nbsp;<span class="ident" id="6193771">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193782">return</span>&nbsp;<span class="ident" id="6193789">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193796">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193799">if</span>&nbsp;<span class="ident" id="6193802">i</span>&nbsp;<span class="op" id="6193804">:=</span>&nbsp;<span class="ident" id="6193807">strings</span><span class="op" id="6193814">.</span><span class="ident" id="6193815">Index</span><span class="op" id="6193820">(</span><span class="ident" id="6193821">name</span><span class="op" id="6193825">,</span>&nbsp;<span class="string" id="6193827">&#34;,&#34;</span><span class="op" id="6193830">)</span><span class="op" id="6193831">;</span>&nbsp;<span class="ident" id="6193833">i</span>&nbsp;<span class="op" id="6193835">&gt;=</span>&nbsp;<span class="num" id="6193838">0</span>&nbsp;<span class="op" id="6193840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6193844">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193870">ok1</span>&nbsp;<span class="op" id="6193874">:=</span>&nbsp;<span class="ident" id="6193877">ctxt</span><span class="op" id="6193881">.</span><span class="ident" id="6193882">match</span><span class="op" id="6193887">(</span><span class="ident" id="6193888">name</span><span class="op" id="6193892">[</span><span class="op" id="6193893">:</span><span class="ident" id="6193894">i</span><span class="op" id="6193895">]</span><span class="op" id="6193896">,</span>&nbsp;<span class="ident" id="6193898">allTags</span><span class="op" id="6193905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193909">ok2</span>&nbsp;<span class="op" id="6193913">:=</span>&nbsp;<span class="ident" id="6193916">ctxt</span><span class="op" id="6193920">.</span><span class="ident" id="6193921">match</span><span class="op" id="6193926">(</span><span class="ident" id="6193927">name</span><span class="op" id="6193931">[</span><span class="ident" id="6193932">i</span><span class="op" id="6193933">+</span><span class="num" id="6193934">1</span><span class="op" id="6193935">:</span><span class="op" id="6193936">]</span><span class="op" id="6193937">,</span>&nbsp;<span class="ident" id="6193939">allTags</span><span class="op" id="6193946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193950">return</span>&nbsp;<span class="ident" id="6193957">ok1</span>&nbsp;<span class="op" id="6193961">&amp;&amp;</span>&nbsp;<span class="ident" id="6193964">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6193969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6193972">if</span>&nbsp;<span class="ident" id="6193975">strings</span><span class="op" id="6193982">.</span><span class="ident" id="6193983">HasPrefix</span><span class="op" id="6193992">(</span><span class="ident" id="6193993">name</span><span class="op" id="6193997">,</span>&nbsp;<span class="string" id="6193999">&#34;!!&#34;</span><span class="op" id="6194003">)</span>&nbsp;<span class="op" id="6194005">{</span>&nbsp;<span class="comment" id="6194007">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194038">return</span>&nbsp;<span class="ident" id="6194045">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194055">if</span>&nbsp;<span class="ident" id="6194058">strings</span><span class="op" id="6194065">.</span><span class="ident" id="6194066">HasPrefix</span><span class="op" id="6194075">(</span><span class="ident" id="6194076">name</span><span class="op" id="6194080">,</span>&nbsp;<span class="string" id="6194082">&#34;!&#34;</span><span class="op" id="6194085">)</span>&nbsp;<span class="op" id="6194087">{</span>&nbsp;<span class="comment" id="6194089">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194103">return</span>&nbsp;<span class="builtinfunc" id="6194110">len</span><span class="op" id="6194113">(</span><span class="ident" id="6194114">name</span><span class="op" id="6194118">)</span>&nbsp;<span class="op" id="6194120">&gt;</span>&nbsp;<span class="num" id="6194122">1</span>&nbsp;<span class="op" id="6194124">&amp;&amp;</span>&nbsp;<span class="op" id="6194127">!</span><span class="ident" id="6194128">ctxt</span><span class="op" id="6194132">.</span><span class="ident" id="6194133">match</span><span class="op" id="6194138">(</span><span class="ident" id="6194139">name</span><span class="op" id="6194143">[</span><span class="num" id="6194144">1</span><span class="op" id="6194145">:</span><span class="op" id="6194146">]</span><span class="op" id="6194147">,</span>&nbsp;<span class="ident" id="6194149">allTags</span><span class="op" id="6194156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194163">if</span>&nbsp;<span class="ident" id="6194166">allTags</span>&nbsp;<span class="op" id="6194174">!=</span>&nbsp;<span class="ident" id="6194177">nil</span>&nbsp;<span class="op" id="6194181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194185">allTags</span><span class="op" id="6194192">[</span><span class="ident" id="6194193">name</span><span class="op" id="6194197">]</span>&nbsp;<span class="op" id="6194199">=</span>&nbsp;<span class="ident" id="6194201">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6194211">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6194266">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194331">for</span>&nbsp;<span class="ident" id="6194335">_</span><span class="op" id="6194336">,</span>&nbsp;<span class="ident" id="6194338">c</span>&nbsp;<span class="op" id="6194340">:=</span>&nbsp;<span class="keyword" id="6194343">range</span>&nbsp;<span class="ident" id="6194349">name</span>&nbsp;<span class="op" id="6194354">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194358">if</span>&nbsp;<span class="op" id="6194361">!</span><span class="ident" id="6194362">unicode</span><span class="op" id="6194369">.</span><span class="ident" id="6194370">IsLetter</span><span class="op" id="6194378">(</span><span class="ident" id="6194379">c</span><span class="op" id="6194380">)</span>&nbsp;<span class="op" id="6194382">&amp;&amp;</span>&nbsp;<span class="op" id="6194385">!</span><span class="ident" id="6194386">unicode</span><span class="op" id="6194393">.</span><span class="ident" id="6194394">IsDigit</span><span class="op" id="6194401">(</span><span class="ident" id="6194402">c</span><span class="op" id="6194403">)</span>&nbsp;<span class="op" id="6194405">&amp;&amp;</span>&nbsp;<span class="ident" id="6194408">c</span>&nbsp;<span class="op" id="6194410">!=</span>&nbsp;<span class="string" id="6194413">&#39;_&#39;</span>&nbsp;<span class="op" id="6194417">&amp;&amp;</span>&nbsp;<span class="ident" id="6194420">c</span>&nbsp;<span class="op" id="6194422">!=</span>&nbsp;<span class="string" id="6194425">&#39;.&#39;</span>&nbsp;<span class="op" id="6194429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194434">return</span>&nbsp;<span class="ident" id="6194441">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6194456">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194473">if</span>&nbsp;<span class="ident" id="6194476">ctxt</span><span class="op" id="6194480">.</span><span class="ident" id="6194481">CgoEnabled</span>&nbsp;<span class="op" id="6194492">&amp;&amp;</span>&nbsp;<span class="ident" id="6194495">name</span>&nbsp;<span class="op" id="6194500">==</span>&nbsp;<span class="string" id="6194503">&#34;cgo&#34;</span>&nbsp;<span class="op" id="6194509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194513">return</span>&nbsp;<span class="ident" id="6194520">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194529">if</span>&nbsp;<span class="ident" id="6194532">name</span>&nbsp;<span class="op" id="6194537">==</span>&nbsp;<span class="ident" id="6194540">ctxt</span><span class="op" id="6194544">.</span><span class="ident" id="6194545">GOOS</span>&nbsp;<span class="op" id="6194550">||</span>&nbsp;<span class="ident" id="6194553">name</span>&nbsp;<span class="op" id="6194558">==</span>&nbsp;<span class="ident" id="6194561">ctxt</span><span class="op" id="6194565">.</span><span class="ident" id="6194566">GOARCH</span>&nbsp;<span class="op" id="6194573">||</span>&nbsp;<span class="ident" id="6194576">name</span>&nbsp;<span class="op" id="6194581">==</span>&nbsp;<span class="ident" id="6194584">ctxt</span><span class="op" id="6194588">.</span><span class="ident" id="6194589">Compiler</span>&nbsp;<span class="op" id="6194598">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194602">return</span>&nbsp;<span class="ident" id="6194609">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194618">if</span>&nbsp;<span class="ident" id="6194621">ctxt</span><span class="op" id="6194625">.</span><span class="ident" id="6194626">GOOS</span>&nbsp;<span class="op" id="6194631">==</span>&nbsp;<span class="string" id="6194634">&#34;android&#34;</span>&nbsp;<span class="op" id="6194644">&amp;&amp;</span>&nbsp;<span class="ident" id="6194647">name</span>&nbsp;<span class="op" id="6194652">==</span>&nbsp;<span class="string" id="6194655">&#34;linux&#34;</span>&nbsp;<span class="op" id="6194663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194667">return</span>&nbsp;<span class="ident" id="6194674">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194680">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6194684">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194699">for</span>&nbsp;<span class="ident" id="6194703">_</span><span class="op" id="6194704">,</span>&nbsp;<span class="ident" id="6194706">tag</span>&nbsp;<span class="op" id="6194710">:=</span>&nbsp;<span class="keyword" id="6194713">range</span>&nbsp;<span class="ident" id="6194719">ctxt</span><span class="op" id="6194723">.</span><span class="ident" id="6194724">BuildTags</span>&nbsp;<span class="op" id="6194734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194738">if</span>&nbsp;<span class="ident" id="6194741">tag</span>&nbsp;<span class="op" id="6194745">==</span>&nbsp;<span class="ident" id="6194748">name</span>&nbsp;<span class="op" id="6194753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194758">return</span>&nbsp;<span class="ident" id="6194765">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194778">for</span>&nbsp;<span class="ident" id="6194782">_</span><span class="op" id="6194783">,</span>&nbsp;<span class="ident" id="6194785">tag</span>&nbsp;<span class="op" id="6194789">:=</span>&nbsp;<span class="keyword" id="6194792">range</span>&nbsp;<span class="ident" id="6194798">ctxt</span><span class="op" id="6194802">.</span><span class="ident" id="6194803">ReleaseTags</span>&nbsp;<span class="op" id="6194815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194819">if</span>&nbsp;<span class="ident" id="6194822">tag</span>&nbsp;<span class="op" id="6194826">==</span>&nbsp;<span class="ident" id="6194829">name</span>&nbsp;<span class="op" id="6194834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194839">return</span>&nbsp;<span class="ident" id="6194846">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6194856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6194860">return</span>&nbsp;<span class="ident" id="6194867">false</span><br>
<span class="lineno"></span><span class="op" id="6194873">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="6194876">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="6194948">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="6194999">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6195035">//</span><br>
<span class="lineno">1295</span><span class="comment" id="6195038">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="6195060">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6195084">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6195116">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6195143">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="6195172">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6195209">//</span><br>
<span class="lineno"></span><span class="comment" id="6195212">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="6195291">func</span>&nbsp;<span class="op" id="6195296">(</span><span class="ident" id="6195297">ctxt</span>&nbsp;<span class="op" id="6195302">*</span><span class="ident" id="6195303">Context</span><span class="op" id="6195310">)</span>&nbsp;<span class="ident" id="6195312">goodOSArchFile</span><span class="op" id="6195326">(</span><span class="ident" id="6195327">name</span>&nbsp;<span class="builtintype" id="6195332">string</span><span class="op" id="6195338">,</span>&nbsp;<span class="ident" id="6195340">allTags</span>&nbsp;<span class="keyword" id="6195348">map</span><span class="op" id="6195351">[</span><span class="builtintype" id="6195352">string</span><span class="op" id="6195358">]</span><span class="builtintype" id="6195359">bool</span><span class="op" id="6195363">)</span>&nbsp;<span class="builtintype" id="6195365">bool</span>&nbsp;<span class="op" id="6195370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195373">if</span>&nbsp;<span class="ident" id="6195376">dot</span>&nbsp;<span class="op" id="6195380">:=</span>&nbsp;<span class="ident" id="6195383">strings</span><span class="op" id="6195390">.</span><span class="ident" id="6195391">Index</span><span class="op" id="6195396">(</span><span class="ident" id="6195397">name</span><span class="op" id="6195401">,</span>&nbsp;<span class="string" id="6195403">&#34;.&#34;</span><span class="op" id="6195406">)</span><span class="op" id="6195407">;</span>&nbsp;<span class="ident" id="6195409">dot</span>&nbsp;<span class="op" id="6195413">!=</span>&nbsp;<span class="op" id="6195416">-</span><span class="num" id="6195417">1</span>&nbsp;<span class="op" id="6195419">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195423">name</span>&nbsp;<span class="op" id="6195428">=</span>&nbsp;<span class="ident" id="6195430">name</span><span class="op" id="6195434">[</span><span class="op" id="6195435">:</span><span class="ident" id="6195436">dot</span><span class="op" id="6195439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195446">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195522">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195597">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195665">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195743">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195818">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6195893">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195931">i</span>&nbsp;<span class="op" id="6195933">:=</span>&nbsp;<span class="ident" id="6195936">strings</span><span class="op" id="6195943">.</span><span class="ident" id="6195944">Index</span><span class="op" id="6195949">(</span><span class="ident" id="6195950">name</span><span class="op" id="6195954">,</span>&nbsp;<span class="string" id="6195956">&#34;_&#34;</span><span class="op" id="6195959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195962">if</span>&nbsp;<span class="ident" id="6195965">i</span>&nbsp;<span class="op" id="6195967">&lt;</span>&nbsp;<span class="num" id="6195969">0</span>&nbsp;<span class="op" id="6195971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6195975">return</span>&nbsp;<span class="ident" id="6195982">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6195988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195991">name</span>&nbsp;<span class="op" id="6195996">=</span>&nbsp;<span class="ident" id="6195998">name</span><span class="op" id="6196002">[</span><span class="ident" id="6196003">i</span><span class="op" id="6196004">:</span><span class="op" id="6196005">]</span>&nbsp;<span class="comment" id="6196007">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196045">l</span>&nbsp;<span class="op" id="6196047">:=</span>&nbsp;<span class="ident" id="6196050">strings</span><span class="op" id="6196057">.</span><span class="ident" id="6196058">Split</span><span class="op" id="6196063">(</span><span class="ident" id="6196064">name</span><span class="op" id="6196068">,</span>&nbsp;<span class="string" id="6196070">&#34;_&#34;</span><span class="op" id="6196073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196076">if</span>&nbsp;<span class="ident" id="6196079">n</span>&nbsp;<span class="op" id="6196081">:=</span>&nbsp;<span class="builtinfunc" id="6196084">len</span><span class="op" id="6196087">(</span><span class="ident" id="6196088">l</span><span class="op" id="6196089">)</span><span class="op" id="6196090">;</span>&nbsp;<span class="ident" id="6196092">n</span>&nbsp;<span class="op" id="6196094">&gt;</span>&nbsp;<span class="num" id="6196096">0</span>&nbsp;<span class="op" id="6196098">&amp;&amp;</span>&nbsp;<span class="ident" id="6196101">l</span><span class="op" id="6196102">[</span><span class="ident" id="6196103">n</span><span class="op" id="6196104">-</span><span class="num" id="6196105">1</span><span class="op" id="6196106">]</span>&nbsp;<span class="op" id="6196108">==</span>&nbsp;<span class="string" id="6196111">&#34;test&#34;</span>&nbsp;<span class="op" id="6196118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196122">l</span>&nbsp;<span class="op" id="6196124">=</span>&nbsp;<span class="ident" id="6196126">l</span><span class="op" id="6196127">[</span><span class="op" id="6196128">:</span><span class="ident" id="6196129">n</span><span class="op" id="6196130">-</span><span class="num" id="6196131">1</span><span class="op" id="6196132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196135">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196138">n</span>&nbsp;<span class="op" id="6196140">:=</span>&nbsp;<span class="builtinfunc" id="6196143">len</span><span class="op" id="6196146">(</span><span class="ident" id="6196147">l</span><span class="op" id="6196148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196151">if</span>&nbsp;<span class="ident" id="6196154">n</span>&nbsp;<span class="op" id="6196156">&gt;=</span>&nbsp;<span class="num" id="6196159">2</span>&nbsp;<span class="op" id="6196161">&amp;&amp;</span>&nbsp;<span class="ident" id="6196164">knownOS</span><span class="op" id="6196171">[</span><span class="ident" id="6196172">l</span><span class="op" id="6196173">[</span><span class="ident" id="6196174">n</span><span class="op" id="6196175">-</span><span class="num" id="6196176">2</span><span class="op" id="6196177">]</span><span class="op" id="6196178">]</span>&nbsp;<span class="op" id="6196180">&amp;&amp;</span>&nbsp;<span class="ident" id="6196183">knownArch</span><span class="op" id="6196192">[</span><span class="ident" id="6196193">l</span><span class="op" id="6196194">[</span><span class="ident" id="6196195">n</span><span class="op" id="6196196">-</span><span class="num" id="6196197">1</span><span class="op" id="6196198">]</span><span class="op" id="6196199">]</span>&nbsp;<span class="op" id="6196201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196205">if</span>&nbsp;<span class="ident" id="6196208">allTags</span>&nbsp;<span class="op" id="6196216">!=</span>&nbsp;<span class="ident" id="6196219">nil</span>&nbsp;<span class="op" id="6196223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196228">allTags</span><span class="op" id="6196235">[</span><span class="ident" id="6196236">l</span><span class="op" id="6196237">[</span><span class="ident" id="6196238">n</span><span class="op" id="6196239">-</span><span class="num" id="6196240">2</span><span class="op" id="6196241">]</span><span class="op" id="6196242">]</span>&nbsp;<span class="op" id="6196244">=</span>&nbsp;<span class="ident" id="6196246">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196254">allTags</span><span class="op" id="6196261">[</span><span class="ident" id="6196262">l</span><span class="op" id="6196263">[</span><span class="ident" id="6196264">n</span><span class="op" id="6196265">-</span><span class="num" id="6196266">1</span><span class="op" id="6196267">]</span><span class="op" id="6196268">]</span>&nbsp;<span class="op" id="6196270">=</span>&nbsp;<span class="ident" id="6196272">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196283">if</span>&nbsp;<span class="ident" id="6196286">l</span><span class="op" id="6196287">[</span><span class="ident" id="6196288">n</span><span class="op" id="6196289">-</span><span class="num" id="6196290">1</span><span class="op" id="6196291">]</span>&nbsp;<span class="op" id="6196293">!=</span>&nbsp;<span class="ident" id="6196296">ctxt</span><span class="op" id="6196300">.</span><span class="ident" id="6196301">GOARCH</span>&nbsp;<span class="op" id="6196308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196313">return</span>&nbsp;<span class="ident" id="6196320">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196332">if</span>&nbsp;<span class="ident" id="6196335">ctxt</span><span class="op" id="6196339">.</span><span class="ident" id="6196340">GOOS</span>&nbsp;<span class="op" id="6196345">==</span>&nbsp;<span class="string" id="6196348">&#34;android&#34;</span>&nbsp;<span class="op" id="6196358">&amp;&amp;</span>&nbsp;<span class="ident" id="6196361">l</span><span class="op" id="6196362">[</span><span class="ident" id="6196363">n</span><span class="op" id="6196364">-</span><span class="num" id="6196365">2</span><span class="op" id="6196366">]</span>&nbsp;<span class="op" id="6196368">==</span>&nbsp;<span class="string" id="6196371">&#34;linux&#34;</span>&nbsp;<span class="op" id="6196379">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196384">return</span>&nbsp;<span class="ident" id="6196391">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196402">return</span>&nbsp;<span class="ident" id="6196409">l</span><span class="op" id="6196410">[</span><span class="ident" id="6196411">n</span><span class="op" id="6196412">-</span><span class="num" id="6196413">2</span><span class="op" id="6196414">]</span>&nbsp;<span class="op" id="6196416">==</span>&nbsp;<span class="ident" id="6196419">ctxt</span><span class="op" id="6196423">.</span><span class="ident" id="6196424">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196433">if</span>&nbsp;<span class="ident" id="6196436">n</span>&nbsp;<span class="op" id="6196438">&gt;=</span>&nbsp;<span class="num" id="6196441">1</span>&nbsp;<span class="op" id="6196443">&amp;&amp;</span>&nbsp;<span class="ident" id="6196446">knownOS</span><span class="op" id="6196453">[</span><span class="ident" id="6196454">l</span><span class="op" id="6196455">[</span><span class="ident" id="6196456">n</span><span class="op" id="6196457">-</span><span class="num" id="6196458">1</span><span class="op" id="6196459">]</span><span class="op" id="6196460">]</span>&nbsp;<span class="op" id="6196462">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196466">if</span>&nbsp;<span class="ident" id="6196469">allTags</span>&nbsp;<span class="op" id="6196477">!=</span>&nbsp;<span class="ident" id="6196480">nil</span>&nbsp;<span class="op" id="6196484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196489">allTags</span><span class="op" id="6196496">[</span><span class="ident" id="6196497">l</span><span class="op" id="6196498">[</span><span class="ident" id="6196499">n</span><span class="op" id="6196500">-</span><span class="num" id="6196501">1</span><span class="op" id="6196502">]</span><span class="op" id="6196503">]</span>&nbsp;<span class="op" id="6196505">=</span>&nbsp;<span class="ident" id="6196507">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196518">if</span>&nbsp;<span class="ident" id="6196521">ctxt</span><span class="op" id="6196525">.</span><span class="ident" id="6196526">GOOS</span>&nbsp;<span class="op" id="6196531">==</span>&nbsp;<span class="string" id="6196534">&#34;android&#34;</span>&nbsp;<span class="op" id="6196544">&amp;&amp;</span>&nbsp;<span class="ident" id="6196547">l</span><span class="op" id="6196548">[</span><span class="ident" id="6196549">n</span><span class="op" id="6196550">-</span><span class="num" id="6196551">1</span><span class="op" id="6196552">]</span>&nbsp;<span class="op" id="6196554">==</span>&nbsp;<span class="string" id="6196557">&#34;linux&#34;</span>&nbsp;<span class="op" id="6196565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196570">return</span>&nbsp;<span class="ident" id="6196577">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196588">return</span>&nbsp;<span class="ident" id="6196595">l</span><span class="op" id="6196596">[</span><span class="ident" id="6196597">n</span><span class="op" id="6196598">-</span><span class="num" id="6196599">1</span><span class="op" id="6196600">]</span>&nbsp;<span class="op" id="6196602">==</span>&nbsp;<span class="ident" id="6196605">ctxt</span><span class="op" id="6196609">.</span><span class="ident" id="6196610">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196619">if</span>&nbsp;<span class="ident" id="6196622">n</span>&nbsp;<span class="op" id="6196624">&gt;=</span>&nbsp;<span class="num" id="6196627">1</span>&nbsp;<span class="op" id="6196629">&amp;&amp;</span>&nbsp;<span class="ident" id="6196632">knownArch</span><span class="op" id="6196641">[</span><span class="ident" id="6196642">l</span><span class="op" id="6196643">[</span><span class="ident" id="6196644">n</span><span class="op" id="6196645">-</span><span class="num" id="6196646">1</span><span class="op" id="6196647">]</span><span class="op" id="6196648">]</span>&nbsp;<span class="op" id="6196650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196654">if</span>&nbsp;<span class="ident" id="6196657">allTags</span>&nbsp;<span class="op" id="6196665">!=</span>&nbsp;<span class="ident" id="6196668">nil</span>&nbsp;<span class="op" id="6196672">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196677">allTags</span><span class="op" id="6196684">[</span><span class="ident" id="6196685">l</span><span class="op" id="6196686">[</span><span class="ident" id="6196687">n</span><span class="op" id="6196688">-</span><span class="num" id="6196689">1</span><span class="op" id="6196690">]</span><span class="op" id="6196691">]</span>&nbsp;<span class="op" id="6196693">=</span>&nbsp;<span class="ident" id="6196695">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196706">return</span>&nbsp;<span class="ident" id="6196713">l</span><span class="op" id="6196714">[</span><span class="ident" id="6196715">n</span><span class="op" id="6196716">-</span><span class="num" id="6196717">1</span><span class="op" id="6196718">]</span>&nbsp;<span class="op" id="6196720">==</span>&nbsp;<span class="ident" id="6196723">ctxt</span><span class="op" id="6196727">.</span><span class="ident" id="6196728">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196739">return</span>&nbsp;<span class="ident" id="6196746">true</span><br>
<span class="lineno">1355</span><span class="op" id="6196751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6196754">var</span>&nbsp;<span class="ident" id="6196758">knownOS</span>&nbsp;<span class="op" id="6196766">=</span>&nbsp;<span class="builtinfunc" id="6196768">make</span><span class="op" id="6196772">(</span><span class="keyword" id="6196773">map</span><span class="op" id="6196776">[</span><span class="builtintype" id="6196777">string</span><span class="op" id="6196783">]</span><span class="builtintype" id="6196784">bool</span><span class="op" id="6196788">)</span><br>
<span class="lineno"></span><span class="keyword" id="6196790">var</span>&nbsp;<span class="ident" id="6196794">knownArch</span>&nbsp;<span class="op" id="6196804">=</span>&nbsp;<span class="builtinfunc" id="6196806">make</span><span class="op" id="6196810">(</span><span class="keyword" id="6196811">map</span><span class="op" id="6196814">[</span><span class="builtintype" id="6196815">string</span><span class="op" id="6196821">]</span><span class="builtintype" id="6196822">bool</span><span class="op" id="6196826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="6196829">func</span>&nbsp;<span class="ident" id="6196834">init</span><span class="op" id="6196838">(</span><span class="op" id="6196839">)</span>&nbsp;<span class="op" id="6196841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196844">for</span>&nbsp;<span class="ident" id="6196848">_</span><span class="op" id="6196849">,</span>&nbsp;<span class="ident" id="6196851">v</span>&nbsp;<span class="op" id="6196853">:=</span>&nbsp;<span class="keyword" id="6196856">range</span>&nbsp;<span class="ident" id="6196862">strings</span><span class="op" id="6196869">.</span><span class="ident" id="6196870">Fields</span><span class="op" id="6196876">(</span><span class="ident" id="6196877">goosList</span><span class="op" id="6196885">)</span>&nbsp;<span class="op" id="6196887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196891">knownOS</span><span class="op" id="6196898">[</span><span class="ident" id="6196899">v</span><span class="op" id="6196900">]</span>&nbsp;<span class="op" id="6196902">=</span>&nbsp;<span class="ident" id="6196904">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196913">for</span>&nbsp;<span class="ident" id="6196917">_</span><span class="op" id="6196918">,</span>&nbsp;<span class="ident" id="6196920">v</span>&nbsp;<span class="op" id="6196922">:=</span>&nbsp;<span class="keyword" id="6196925">range</span>&nbsp;<span class="ident" id="6196931">strings</span><span class="op" id="6196938">.</span><span class="ident" id="6196939">Fields</span><span class="op" id="6196945">(</span><span class="ident" id="6196946">goarchList</span><span class="op" id="6196956">)</span>&nbsp;<span class="op" id="6196958">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196962">knownArch</span><span class="op" id="6196971">[</span><span class="ident" id="6196972">v</span><span class="op" id="6196973">]</span>&nbsp;<span class="op" id="6196975">=</span>&nbsp;<span class="ident" id="6196977">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196983">}</span><br>
<span class="lineno"></span><span class="op" id="6196985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6196988">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="6197040">var</span>&nbsp;<span class="ident" id="6197044">ToolDir</span>&nbsp;<span class="op" id="6197052">=</span>&nbsp;<span class="ident" id="6197054">filepath</span><span class="op" id="6197062">.</span><span class="ident" id="6197063">Join</span><span class="op" id="6197067">(</span><span class="ident" id="6197068">runtime</span><span class="op" id="6197075">.</span><span class="ident" id="6197076">GOROOT</span><span class="op" id="6197082">(</span><span class="op" id="6197083">)</span><span class="op" id="6197084">,</span>&nbsp;<span class="string" id="6197086">&#34;pkg/tool/&#34;</span><span class="op" id="6197097">+</span><span class="ident" id="6197098">runtime</span><span class="op" id="6197105">.</span><span class="ident" id="6197106">GOOS</span><span class="op" id="6197110">+</span><span class="string" id="6197111">&#34;_&#34;</span><span class="op" id="6197114">+</span><span class="ident" id="6197115">runtime</span><span class="op" id="6197122">.</span><span class="ident" id="6197123">GOARCH</span><span class="op" id="6197129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6197132">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6197184">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6197246">func</span>&nbsp;<span class="ident" id="6197251">IsLocalImport</span><span class="op" id="6197264">(</span><span class="ident" id="6197265">path</span>&nbsp;<span class="builtintype" id="6197270">string</span><span class="op" id="6197276">)</span>&nbsp;<span class="builtintype" id="6197278">bool</span>&nbsp;<span class="op" id="6197283">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197286">return</span>&nbsp;<span class="ident" id="6197293">path</span>&nbsp;<span class="op" id="6197298">==</span>&nbsp;<span class="string" id="6197301">&#34;.&#34;</span>&nbsp;<span class="op" id="6197305">||</span>&nbsp;<span class="ident" id="6197308">path</span>&nbsp;<span class="op" id="6197313">==</span>&nbsp;<span class="string" id="6197316">&#34;..&#34;</span>&nbsp;<span class="op" id="6197321">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197326">strings</span><span class="op" id="6197333">.</span><span class="ident" id="6197334">HasPrefix</span><span class="op" id="6197343">(</span><span class="ident" id="6197344">path</span><span class="op" id="6197348">,</span>&nbsp;<span class="string" id="6197350">&#34;./&#34;</span><span class="op" id="6197354">)</span>&nbsp;<span class="op" id="6197356">||</span>&nbsp;<span class="ident" id="6197359">strings</span><span class="op" id="6197366">.</span><span class="ident" id="6197367">HasPrefix</span><span class="op" id="6197376">(</span><span class="ident" id="6197377">path</span><span class="op" id="6197381">,</span>&nbsp;<span class="string" id="6197383">&#34;../&#34;</span><span class="op" id="6197388">)</span><br>
<span class="lineno"></span><span class="op" id="6197390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6197393">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="6197462">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6197509">func</span>&nbsp;<span class="ident" id="6197514">ArchChar</span><span class="op" id="6197522">(</span><span class="ident" id="6197523">goarch</span>&nbsp;<span class="builtintype" id="6197530">string</span><span class="op" id="6197536">)</span>&nbsp;<span class="op" id="6197538">(</span><span class="builtintype" id="6197539">string</span><span class="op" id="6197545">,</span>&nbsp;<span class="builtintype" id="6197547">error</span><span class="op" id="6197552">)</span>&nbsp;<span class="op" id="6197554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197557">switch</span>&nbsp;<span class="ident" id="6197564">goarch</span>&nbsp;<span class="op" id="6197571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197574">case</span>&nbsp;<span class="string" id="6197579">&#34;386&#34;</span><span class="op" id="6197584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197588">return</span>&nbsp;<span class="string" id="6197595">&#34;8&#34;</span><span class="op" id="6197598">,</span>&nbsp;<span class="ident" id="6197600">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197605">case</span>&nbsp;<span class="string" id="6197610">&#34;amd64&#34;</span><span class="op" id="6197617">,</span>&nbsp;<span class="string" id="6197619">&#34;amd64p32&#34;</span><span class="op" id="6197629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197633">return</span>&nbsp;<span class="string" id="6197640">&#34;6&#34;</span><span class="op" id="6197643">,</span>&nbsp;<span class="ident" id="6197645">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197650">case</span>&nbsp;<span class="string" id="6197655">&#34;arm&#34;</span><span class="op" id="6197660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197664">return</span>&nbsp;<span class="string" id="6197671">&#34;5&#34;</span><span class="op" id="6197674">,</span>&nbsp;<span class="ident" id="6197676">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197681">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197684">return</span>&nbsp;<span class="string" id="6197691">&#34;&#34;</span><span class="op" id="6197693">,</span>&nbsp;<span class="ident" id="6197695">errors</span><span class="op" id="6197701">.</span><span class="ident" id="6197702">New</span><span class="op" id="6197705">(</span><span class="string" id="6197706">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="6197728">+</span>&nbsp;<span class="ident" id="6197730">goarch</span><span class="op" id="6197736">)</span><br>
<span class="lineno"></span><span class="op" id="6197738">}</span>
</div>
</body>
</html>
