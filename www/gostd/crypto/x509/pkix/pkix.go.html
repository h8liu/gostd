<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4884352">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4884407">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4884461">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4884512">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4884589">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4884647">package</span>&nbsp;<span class="ident" id="4884655">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4884661">import</span>&nbsp;<span class="op" id="4884668">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4884671">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4884688">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4884700">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4884707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4884710">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4884790">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4884816">type</span>&nbsp;<span class="ident" id="4884821">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4884841">struct</span>&nbsp;<span class="op" id="4884848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884851">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4884862">asn1</span><span class="op" id="4884866">.</span><span class="ident" id="4884867">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4884885">Parameters</span>&nbsp;<span class="ident" id="4884896">asn1</span><span class="op" id="4884900">.</span><span class="ident" id="4884901">RawValue</span>&nbsp;<span class="string" id="4884910">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4884928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4884931">type</span>&nbsp;<span class="ident" id="4884936">RDNSequence</span>&nbsp;<span class="op" id="4884948">[</span><span class="op" id="4884949">]</span><span class="ident" id="4884950">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4884980">type</span>&nbsp;<span class="ident" id="4884985">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4885014">[</span><span class="op" id="4885015">]</span><span class="ident" id="4885016">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4885039">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4885112">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4885166">type</span>&nbsp;<span class="ident" id="4885171">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4885193">struct</span>&nbsp;<span class="op" id="4885200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885203">Type</span>&nbsp;&nbsp;<span class="ident" id="4885209">asn1</span><span class="op" id="4885213">.</span><span class="ident" id="4885214">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885232">Value</span>&nbsp;<span class="keyword" id="4885238">interface</span><span class="op" id="4885247">{</span><span class="op" id="4885248">}</span><br>
<span class="lineno"></span><span class="op" id="4885250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4885253">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4885320">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4885381">type</span>&nbsp;<span class="ident" id="4885386">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4885411">struct</span>&nbsp;<span class="op" id="4885418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885421">Type</span>&nbsp;&nbsp;<span class="ident" id="4885427">asn1</span><span class="op" id="4885431">.</span><span class="ident" id="4885432">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885450">Value</span>&nbsp;<span class="op" id="4885456">[</span><span class="op" id="4885457">]</span><span class="op" id="4885458">[</span><span class="op" id="4885459">]</span><span class="ident" id="4885460">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4885482">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4885495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4885498">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4885568">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4885590">type</span>&nbsp;<span class="ident" id="4885595">Extension</span>&nbsp;<span class="keyword" id="4885605">struct</span>&nbsp;<span class="op" id="4885612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885615">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4885624">asn1</span><span class="op" id="4885628">.</span><span class="ident" id="4885629">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885647">Critical</span>&nbsp;<span class="builtintype" id="4885656">bool</span>&nbsp;<span class="string" id="4885661">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885680">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4885689">[</span><span class="op" id="4885690">]</span><span class="builtintype" id="4885691">byte</span><br>
<span class="lineno"></span><span class="op" id="4885696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4885699">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4885777">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4885844">type</span>&nbsp;<span class="ident" id="4885849">Name</span>&nbsp;<span class="keyword" id="4885854">struct</span>&nbsp;<span class="op" id="4885861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885864">Country</span><span class="op" id="4885871">,</span>&nbsp;<span class="ident" id="4885873">Organization</span><span class="op" id="4885885">,</span>&nbsp;<span class="ident" id="4885887">OrganizationalUnit</span>&nbsp;<span class="op" id="4885906">[</span><span class="op" id="4885907">]</span><span class="builtintype" id="4885908">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885916">Locality</span><span class="op" id="4885924">,</span>&nbsp;<span class="ident" id="4885926">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4885958">[</span><span class="op" id="4885959">]</span><span class="builtintype" id="4885960">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4885968">StreetAddress</span><span class="op" id="4885981">,</span>&nbsp;<span class="ident" id="4885983">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4886010">[</span><span class="op" id="4886011">]</span><span class="builtintype" id="4886012">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886020">SerialNumber</span><span class="op" id="4886032">,</span>&nbsp;<span class="ident" id="4886034">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4886062">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886071">Names</span>&nbsp;<span class="op" id="4886077">[</span><span class="op" id="4886078">]</span><span class="ident" id="4886079">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4886101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4886104">func</span>&nbsp;<span class="op" id="4886109">(</span><span class="ident" id="4886110">n</span>&nbsp;<span class="op" id="4886112">*</span><span class="ident" id="4886113">Name</span><span class="op" id="4886117">)</span>&nbsp;<span class="ident" id="4886119">FillFromRDNSequence</span><span class="op" id="4886138">(</span><span class="ident" id="4886139">rdns</span>&nbsp;<span class="op" id="4886144">*</span><span class="ident" id="4886145">RDNSequence</span><span class="op" id="4886156">)</span>&nbsp;<span class="op" id="4886158">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886161">for</span>&nbsp;<span class="ident" id="4886165">_</span><span class="op" id="4886166">,</span>&nbsp;<span class="ident" id="4886168">rdn</span>&nbsp;<span class="op" id="4886172">:=</span>&nbsp;<span class="keyword" id="4886175">range</span>&nbsp;<span class="op" id="4886181">*</span><span class="ident" id="4886182">rdns</span>&nbsp;<span class="op" id="4886187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886191">if</span>&nbsp;<span class="builtinfunc" id="4886194">len</span><span class="op" id="4886197">(</span><span class="ident" id="4886198">rdn</span><span class="op" id="4886201">)</span>&nbsp;<span class="op" id="4886203">==</span>&nbsp;<span class="num" id="4886206">0</span>&nbsp;<span class="op" id="4886208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886213">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886228">atv</span>&nbsp;<span class="op" id="4886232">:=</span>&nbsp;<span class="ident" id="4886235">rdn</span><span class="op" id="4886238">[</span><span class="num" id="4886239">0</span><span class="op" id="4886240">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886244">n</span><span class="op" id="4886245">.</span><span class="ident" id="4886246">Names</span>&nbsp;<span class="op" id="4886252">=</span>&nbsp;<span class="builtinfunc" id="4886254">append</span><span class="op" id="4886260">(</span><span class="ident" id="4886261">n</span><span class="op" id="4886262">.</span><span class="ident" id="4886263">Names</span><span class="op" id="4886268">,</span>&nbsp;<span class="ident" id="4886270">atv</span><span class="op" id="4886273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886277">value</span><span class="op" id="4886282">,</span>&nbsp;<span class="ident" id="4886284">ok</span>&nbsp;<span class="op" id="4886287">:=</span>&nbsp;<span class="ident" id="4886290">atv</span><span class="op" id="4886293">.</span><span class="ident" id="4886294">Value</span><span class="op" id="4886299">.</span><span class="op" id="4886300">(</span><span class="builtintype" id="4886301">string</span><span class="op" id="4886307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886311">if</span>&nbsp;<span class="op" id="4886314">!</span><span class="ident" id="4886315">ok</span>&nbsp;<span class="op" id="4886318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886323">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886334">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886339">t</span>&nbsp;<span class="op" id="4886341">:=</span>&nbsp;<span class="ident" id="4886344">atv</span><span class="op" id="4886347">.</span><span class="ident" id="4886348">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886355">if</span>&nbsp;<span class="builtinfunc" id="4886358">len</span><span class="op" id="4886361">(</span><span class="ident" id="4886362">t</span><span class="op" id="4886363">)</span>&nbsp;<span class="op" id="4886365">==</span>&nbsp;<span class="num" id="4886368">4</span>&nbsp;<span class="op" id="4886370">&amp;&amp;</span>&nbsp;<span class="ident" id="4886373">t</span><span class="op" id="4886374">[</span><span class="num" id="4886375">0</span><span class="op" id="4886376">]</span>&nbsp;<span class="op" id="4886378">==</span>&nbsp;<span class="num" id="4886381">2</span>&nbsp;<span class="op" id="4886383">&amp;&amp;</span>&nbsp;<span class="ident" id="4886386">t</span><span class="op" id="4886387">[</span><span class="num" id="4886388">1</span><span class="op" id="4886389">]</span>&nbsp;<span class="op" id="4886391">==</span>&nbsp;<span class="num" id="4886394">5</span>&nbsp;<span class="op" id="4886396">&amp;&amp;</span>&nbsp;<span class="ident" id="4886399">t</span><span class="op" id="4886400">[</span><span class="num" id="4886401">2</span><span class="op" id="4886402">]</span>&nbsp;<span class="op" id="4886404">==</span>&nbsp;<span class="num" id="4886407">4</span>&nbsp;<span class="op" id="4886409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886414">switch</span>&nbsp;<span class="ident" id="4886421">t</span><span class="op" id="4886422">[</span><span class="num" id="4886423">3</span><span class="op" id="4886424">]</span>&nbsp;<span class="op" id="4886426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886431">case</span>&nbsp;<span class="num" id="4886436">3</span><span class="op" id="4886437">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886443">n</span><span class="op" id="4886444">.</span><span class="ident" id="4886445">CommonName</span>&nbsp;<span class="op" id="4886456">=</span>&nbsp;<span class="ident" id="4886458">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886467">case</span>&nbsp;<span class="num" id="4886472">5</span><span class="op" id="4886473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886479">n</span><span class="op" id="4886480">.</span><span class="ident" id="4886481">SerialNumber</span>&nbsp;<span class="op" id="4886494">=</span>&nbsp;<span class="ident" id="4886496">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886505">case</span>&nbsp;<span class="num" id="4886510">6</span><span class="op" id="4886511">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886517">n</span><span class="op" id="4886518">.</span><span class="ident" id="4886519">Country</span>&nbsp;<span class="op" id="4886527">=</span>&nbsp;<span class="builtinfunc" id="4886529">append</span><span class="op" id="4886535">(</span><span class="ident" id="4886536">n</span><span class="op" id="4886537">.</span><span class="ident" id="4886538">Country</span><span class="op" id="4886545">,</span>&nbsp;<span class="ident" id="4886547">value</span><span class="op" id="4886552">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886557">case</span>&nbsp;<span class="num" id="4886562">7</span><span class="op" id="4886563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886569">n</span><span class="op" id="4886570">.</span><span class="ident" id="4886571">Locality</span>&nbsp;<span class="op" id="4886580">=</span>&nbsp;<span class="builtinfunc" id="4886582">append</span><span class="op" id="4886588">(</span><span class="ident" id="4886589">n</span><span class="op" id="4886590">.</span><span class="ident" id="4886591">Locality</span><span class="op" id="4886599">,</span>&nbsp;<span class="ident" id="4886601">value</span><span class="op" id="4886606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886611">case</span>&nbsp;<span class="num" id="4886616">8</span><span class="op" id="4886617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886623">n</span><span class="op" id="4886624">.</span><span class="ident" id="4886625">Province</span>&nbsp;<span class="op" id="4886634">=</span>&nbsp;<span class="builtinfunc" id="4886636">append</span><span class="op" id="4886642">(</span><span class="ident" id="4886643">n</span><span class="op" id="4886644">.</span><span class="ident" id="4886645">Province</span><span class="op" id="4886653">,</span>&nbsp;<span class="ident" id="4886655">value</span><span class="op" id="4886660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886665">case</span>&nbsp;<span class="num" id="4886670">9</span><span class="op" id="4886671">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886677">n</span><span class="op" id="4886678">.</span><span class="ident" id="4886679">StreetAddress</span>&nbsp;<span class="op" id="4886693">=</span>&nbsp;<span class="builtinfunc" id="4886695">append</span><span class="op" id="4886701">(</span><span class="ident" id="4886702">n</span><span class="op" id="4886703">.</span><span class="ident" id="4886704">StreetAddress</span><span class="op" id="4886717">,</span>&nbsp;<span class="ident" id="4886719">value</span><span class="op" id="4886724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886729">case</span>&nbsp;<span class="num" id="4886734">10</span><span class="op" id="4886736">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886742">n</span><span class="op" id="4886743">.</span><span class="ident" id="4886744">Organization</span>&nbsp;<span class="op" id="4886757">=</span>&nbsp;<span class="builtinfunc" id="4886759">append</span><span class="op" id="4886765">(</span><span class="ident" id="4886766">n</span><span class="op" id="4886767">.</span><span class="ident" id="4886768">Organization</span><span class="op" id="4886780">,</span>&nbsp;<span class="ident" id="4886782">value</span><span class="op" id="4886787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886792">case</span>&nbsp;<span class="num" id="4886797">11</span><span class="op" id="4886799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886805">n</span><span class="op" id="4886806">.</span><span class="ident" id="4886807">OrganizationalUnit</span>&nbsp;<span class="op" id="4886826">=</span>&nbsp;<span class="builtinfunc" id="4886828">append</span><span class="op" id="4886834">(</span><span class="ident" id="4886835">n</span><span class="op" id="4886836">.</span><span class="ident" id="4886837">OrganizationalUnit</span><span class="op" id="4886855">,</span>&nbsp;<span class="ident" id="4886857">value</span><span class="op" id="4886862">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4886867">case</span>&nbsp;<span class="num" id="4886872">17</span><span class="op" id="4886874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886880">n</span><span class="op" id="4886881">.</span><span class="ident" id="4886882">PostalCode</span>&nbsp;<span class="op" id="4886893">=</span>&nbsp;<span class="builtinfunc" id="4886895">append</span><span class="op" id="4886901">(</span><span class="ident" id="4886902">n</span><span class="op" id="4886903">.</span><span class="ident" id="4886904">PostalCode</span><span class="op" id="4886914">,</span>&nbsp;<span class="ident" id="4886916">value</span><span class="op" id="4886921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4886933">}</span><br>
<span class="lineno">95</span><span class="op" id="4886935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4886938">var</span>&nbsp;<span class="op" id="4886942">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886945">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4886967">=</span>&nbsp;<span class="op" id="4886969">[</span><span class="op" id="4886970">]</span><span class="builtintype" id="4886971">int</span><span class="op" id="4886974">{</span><span class="num" id="4886975">2</span><span class="op" id="4886976">,</span>&nbsp;<span class="num" id="4886978">5</span><span class="op" id="4886979">,</span>&nbsp;<span class="num" id="4886981">4</span><span class="op" id="4886982">,</span>&nbsp;<span class="num" id="4886984">6</span><span class="op" id="4886985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4886988">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887010">=</span>&nbsp;<span class="op" id="4887012">[</span><span class="op" id="4887013">]</span><span class="builtintype" id="4887014">int</span><span class="op" id="4887017">{</span><span class="num" id="4887018">2</span><span class="op" id="4887019">,</span>&nbsp;<span class="num" id="4887021">5</span><span class="op" id="4887022">,</span>&nbsp;<span class="num" id="4887024">4</span><span class="op" id="4887025">,</span>&nbsp;<span class="num" id="4887027">10</span><span class="op" id="4887029">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887032">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4887054">=</span>&nbsp;<span class="op" id="4887056">[</span><span class="op" id="4887057">]</span><span class="builtintype" id="4887058">int</span><span class="op" id="4887061">{</span><span class="num" id="4887062">2</span><span class="op" id="4887063">,</span>&nbsp;<span class="num" id="4887065">5</span><span class="op" id="4887066">,</span>&nbsp;<span class="num" id="4887068">4</span><span class="op" id="4887069">,</span>&nbsp;<span class="num" id="4887071">11</span><span class="op" id="4887073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887076">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887098">=</span>&nbsp;<span class="op" id="4887100">[</span><span class="op" id="4887101">]</span><span class="builtintype" id="4887102">int</span><span class="op" id="4887105">{</span><span class="num" id="4887106">2</span><span class="op" id="4887107">,</span>&nbsp;<span class="num" id="4887109">5</span><span class="op" id="4887110">,</span>&nbsp;<span class="num" id="4887112">4</span><span class="op" id="4887113">,</span>&nbsp;<span class="num" id="4887115">3</span><span class="op" id="4887116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887119">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887141">=</span>&nbsp;<span class="op" id="4887143">[</span><span class="op" id="4887144">]</span><span class="builtintype" id="4887145">int</span><span class="op" id="4887148">{</span><span class="num" id="4887149">2</span><span class="op" id="4887150">,</span>&nbsp;<span class="num" id="4887152">5</span><span class="op" id="4887153">,</span>&nbsp;<span class="num" id="4887155">4</span><span class="op" id="4887156">,</span>&nbsp;<span class="num" id="4887158">5</span><span class="op" id="4887159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887162">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887184">=</span>&nbsp;<span class="op" id="4887186">[</span><span class="op" id="4887187">]</span><span class="builtintype" id="4887188">int</span><span class="op" id="4887191">{</span><span class="num" id="4887192">2</span><span class="op" id="4887193">,</span>&nbsp;<span class="num" id="4887195">5</span><span class="op" id="4887196">,</span>&nbsp;<span class="num" id="4887198">4</span><span class="op" id="4887199">,</span>&nbsp;<span class="num" id="4887201">7</span><span class="op" id="4887202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887205">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887227">=</span>&nbsp;<span class="op" id="4887229">[</span><span class="op" id="4887230">]</span><span class="builtintype" id="4887231">int</span><span class="op" id="4887234">{</span><span class="num" id="4887235">2</span><span class="op" id="4887236">,</span>&nbsp;<span class="num" id="4887238">5</span><span class="op" id="4887239">,</span>&nbsp;<span class="num" id="4887241">4</span><span class="op" id="4887242">,</span>&nbsp;<span class="num" id="4887244">8</span><span class="op" id="4887245">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887248">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887270">=</span>&nbsp;<span class="op" id="4887272">[</span><span class="op" id="4887273">]</span><span class="builtintype" id="4887274">int</span><span class="op" id="4887277">{</span><span class="num" id="4887278">2</span><span class="op" id="4887279">,</span>&nbsp;<span class="num" id="4887281">5</span><span class="op" id="4887282">,</span>&nbsp;<span class="num" id="4887284">4</span><span class="op" id="4887285">,</span>&nbsp;<span class="num" id="4887287">9</span><span class="op" id="4887288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887291">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4887313">=</span>&nbsp;<span class="op" id="4887315">[</span><span class="op" id="4887316">]</span><span class="builtintype" id="4887317">int</span><span class="op" id="4887320">{</span><span class="num" id="4887321">2</span><span class="op" id="4887322">,</span>&nbsp;<span class="num" id="4887324">5</span><span class="op" id="4887325">,</span>&nbsp;<span class="num" id="4887327">4</span><span class="op" id="4887328">,</span>&nbsp;<span class="num" id="4887330">17</span><span class="op" id="4887332">}</span><br>
<span class="lineno"></span><span class="op" id="4887334">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4887337">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4887415">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4887490">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4887568">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4887605">func</span>&nbsp;<span class="ident" id="4887610">appendRDNs</span><span class="op" id="4887620">(</span><span class="ident" id="4887621">in</span>&nbsp;<span class="ident" id="4887624">RDNSequence</span><span class="op" id="4887635">,</span>&nbsp;<span class="ident" id="4887637">values</span>&nbsp;<span class="op" id="4887644">[</span><span class="op" id="4887645">]</span><span class="builtintype" id="4887646">string</span><span class="op" id="4887652">,</span>&nbsp;<span class="ident" id="4887654">oid</span>&nbsp;<span class="ident" id="4887658">asn1</span><span class="op" id="4887662">.</span><span class="ident" id="4887663">ObjectIdentifier</span><span class="op" id="4887679">)</span>&nbsp;<span class="ident" id="4887681">RDNSequence</span>&nbsp;<span class="op" id="4887693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4887696">if</span>&nbsp;<span class="builtinfunc" id="4887699">len</span><span class="op" id="4887702">(</span><span class="ident" id="4887703">values</span><span class="op" id="4887709">)</span>&nbsp;<span class="op" id="4887711">==</span>&nbsp;<span class="num" id="4887714">0</span>&nbsp;<span class="op" id="4887716">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4887720">return</span>&nbsp;<span class="ident" id="4887727">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4887731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887735">s</span>&nbsp;<span class="op" id="4887737">:=</span>&nbsp;<span class="builtinfunc" id="4887740">make</span><span class="op" id="4887744">(</span><span class="op" id="4887745">[</span><span class="op" id="4887746">]</span><span class="ident" id="4887747">AttributeTypeAndValue</span><span class="op" id="4887768">,</span>&nbsp;<span class="builtinfunc" id="4887770">len</span><span class="op" id="4887773">(</span><span class="ident" id="4887774">values</span><span class="op" id="4887780">)</span><span class="op" id="4887781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4887784">for</span>&nbsp;<span class="ident" id="4887788">i</span><span class="op" id="4887789">,</span>&nbsp;<span class="ident" id="4887791">value</span>&nbsp;<span class="op" id="4887797">:=</span>&nbsp;<span class="keyword" id="4887800">range</span>&nbsp;<span class="ident" id="4887806">values</span>&nbsp;<span class="op" id="4887813">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887817">s</span><span class="op" id="4887818">[</span><span class="ident" id="4887819">i</span><span class="op" id="4887820">]</span><span class="op" id="4887821">.</span><span class="ident" id="4887822">Type</span>&nbsp;<span class="op" id="4887827">=</span>&nbsp;<span class="ident" id="4887829">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887835">s</span><span class="op" id="4887836">[</span><span class="ident" id="4887837">i</span><span class="op" id="4887838">]</span><span class="op" id="4887839">.</span><span class="ident" id="4887840">Value</span>&nbsp;<span class="op" id="4887846">=</span>&nbsp;<span class="ident" id="4887848">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4887855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4887859">return</span>&nbsp;<span class="builtinfunc" id="4887866">append</span><span class="op" id="4887872">(</span><span class="ident" id="4887873">in</span><span class="op" id="4887875">,</span>&nbsp;<span class="ident" id="4887877">s</span><span class="op" id="4887878">)</span><br>
<span class="lineno">125</span><span class="op" id="4887880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4887883">func</span>&nbsp;<span class="op" id="4887888">(</span><span class="ident" id="4887889">n</span>&nbsp;<span class="ident" id="4887891">Name</span><span class="op" id="4887895">)</span>&nbsp;<span class="ident" id="4887897">ToRDNSequence</span><span class="op" id="4887910">(</span><span class="op" id="4887911">)</span>&nbsp;<span class="op" id="4887913">(</span><span class="ident" id="4887914">ret</span>&nbsp;<span class="ident" id="4887918">RDNSequence</span><span class="op" id="4887929">)</span>&nbsp;<span class="op" id="4887931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887934">ret</span>&nbsp;<span class="op" id="4887938">=</span>&nbsp;<span class="ident" id="4887940">appendRDNs</span><span class="op" id="4887950">(</span><span class="ident" id="4887951">ret</span><span class="op" id="4887954">,</span>&nbsp;<span class="ident" id="4887956">n</span><span class="op" id="4887957">.</span><span class="ident" id="4887958">Country</span><span class="op" id="4887965">,</span>&nbsp;<span class="ident" id="4887967">oidCountry</span><span class="op" id="4887977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4887980">ret</span>&nbsp;<span class="op" id="4887984">=</span>&nbsp;<span class="ident" id="4887986">appendRDNs</span><span class="op" id="4887996">(</span><span class="ident" id="4887997">ret</span><span class="op" id="4888000">,</span>&nbsp;<span class="ident" id="4888002">n</span><span class="op" id="4888003">.</span><span class="ident" id="4888004">Organization</span><span class="op" id="4888016">,</span>&nbsp;<span class="ident" id="4888018">oidOrganization</span><span class="op" id="4888033">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888036">ret</span>&nbsp;<span class="op" id="4888040">=</span>&nbsp;<span class="ident" id="4888042">appendRDNs</span><span class="op" id="4888052">(</span><span class="ident" id="4888053">ret</span><span class="op" id="4888056">,</span>&nbsp;<span class="ident" id="4888058">n</span><span class="op" id="4888059">.</span><span class="ident" id="4888060">OrganizationalUnit</span><span class="op" id="4888078">,</span>&nbsp;<span class="ident" id="4888080">oidOrganizationalUnit</span><span class="op" id="4888101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888104">ret</span>&nbsp;<span class="op" id="4888108">=</span>&nbsp;<span class="ident" id="4888110">appendRDNs</span><span class="op" id="4888120">(</span><span class="ident" id="4888121">ret</span><span class="op" id="4888124">,</span>&nbsp;<span class="ident" id="4888126">n</span><span class="op" id="4888127">.</span><span class="ident" id="4888128">Locality</span><span class="op" id="4888136">,</span>&nbsp;<span class="ident" id="4888138">oidLocality</span><span class="op" id="4888149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888152">ret</span>&nbsp;<span class="op" id="4888156">=</span>&nbsp;<span class="ident" id="4888158">appendRDNs</span><span class="op" id="4888168">(</span><span class="ident" id="4888169">ret</span><span class="op" id="4888172">,</span>&nbsp;<span class="ident" id="4888174">n</span><span class="op" id="4888175">.</span><span class="ident" id="4888176">Province</span><span class="op" id="4888184">,</span>&nbsp;<span class="ident" id="4888186">oidProvince</span><span class="op" id="4888197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888200">ret</span>&nbsp;<span class="op" id="4888204">=</span>&nbsp;<span class="ident" id="4888206">appendRDNs</span><span class="op" id="4888216">(</span><span class="ident" id="4888217">ret</span><span class="op" id="4888220">,</span>&nbsp;<span class="ident" id="4888222">n</span><span class="op" id="4888223">.</span><span class="ident" id="4888224">StreetAddress</span><span class="op" id="4888237">,</span>&nbsp;<span class="ident" id="4888239">oidStreetAddress</span><span class="op" id="4888255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888258">ret</span>&nbsp;<span class="op" id="4888262">=</span>&nbsp;<span class="ident" id="4888264">appendRDNs</span><span class="op" id="4888274">(</span><span class="ident" id="4888275">ret</span><span class="op" id="4888278">,</span>&nbsp;<span class="ident" id="4888280">n</span><span class="op" id="4888281">.</span><span class="ident" id="4888282">PostalCode</span><span class="op" id="4888292">,</span>&nbsp;<span class="ident" id="4888294">oidPostalCode</span><span class="op" id="4888307">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4888310">if</span>&nbsp;<span class="builtinfunc" id="4888313">len</span><span class="op" id="4888316">(</span><span class="ident" id="4888317">n</span><span class="op" id="4888318">.</span><span class="ident" id="4888319">CommonName</span><span class="op" id="4888329">)</span>&nbsp;<span class="op" id="4888331">&gt;</span>&nbsp;<span class="num" id="4888333">0</span>&nbsp;<span class="op" id="4888335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888339">ret</span>&nbsp;<span class="op" id="4888343">=</span>&nbsp;<span class="ident" id="4888345">appendRDNs</span><span class="op" id="4888355">(</span><span class="ident" id="4888356">ret</span><span class="op" id="4888359">,</span>&nbsp;<span class="op" id="4888361">[</span><span class="op" id="4888362">]</span><span class="builtintype" id="4888363">string</span><span class="op" id="4888369">{</span><span class="ident" id="4888370">n</span><span class="op" id="4888371">.</span><span class="ident" id="4888372">CommonName</span><span class="op" id="4888382">}</span><span class="op" id="4888383">,</span>&nbsp;<span class="ident" id="4888385">oidCommonName</span><span class="op" id="4888398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4888401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4888404">if</span>&nbsp;<span class="builtinfunc" id="4888407">len</span><span class="op" id="4888410">(</span><span class="ident" id="4888411">n</span><span class="op" id="4888412">.</span><span class="ident" id="4888413">SerialNumber</span><span class="op" id="4888425">)</span>&nbsp;<span class="op" id="4888427">&gt;</span>&nbsp;<span class="num" id="4888429">0</span>&nbsp;<span class="op" id="4888431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888435">ret</span>&nbsp;<span class="op" id="4888439">=</span>&nbsp;<span class="ident" id="4888441">appendRDNs</span><span class="op" id="4888451">(</span><span class="ident" id="4888452">ret</span><span class="op" id="4888455">,</span>&nbsp;<span class="op" id="4888457">[</span><span class="op" id="4888458">]</span><span class="builtintype" id="4888459">string</span><span class="op" id="4888465">{</span><span class="ident" id="4888466">n</span><span class="op" id="4888467">.</span><span class="ident" id="4888468">SerialNumber</span><span class="op" id="4888480">}</span><span class="op" id="4888481">,</span>&nbsp;<span class="ident" id="4888483">oidSerialNumber</span><span class="op" id="4888498">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4888501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4888505">return</span>&nbsp;<span class="ident" id="4888512">ret</span><br>
<span class="lineno"></span><span class="op" id="4888516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4888519">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4888595">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4888665">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4888679">type</span>&nbsp;<span class="ident" id="4888684">CertificateList</span>&nbsp;<span class="keyword" id="4888700">struct</span>&nbsp;<span class="op" id="4888707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888710">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888729">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888749">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4888768">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4888789">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4888808">asn1</span><span class="op" id="4888812">.</span><span class="ident" id="4888813">BitString</span><br>
<span class="lineno"></span><span class="op" id="4888823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4888826">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4888897">func</span>&nbsp;<span class="op" id="4888902">(</span><span class="ident" id="4888903">certList</span>&nbsp;<span class="op" id="4888912">*</span><span class="ident" id="4888913">CertificateList</span><span class="op" id="4888928">)</span>&nbsp;<span class="ident" id="4888930">HasExpired</span><span class="op" id="4888940">(</span><span class="ident" id="4888941">now</span>&nbsp;<span class="ident" id="4888945">time</span><span class="op" id="4888949">.</span><span class="ident" id="4888950">Time</span><span class="op" id="4888954">)</span>&nbsp;<span class="builtintype" id="4888956">bool</span>&nbsp;<span class="op" id="4888961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4888964">return</span>&nbsp;<span class="ident" id="4888971">now</span><span class="op" id="4888974">.</span><span class="ident" id="4888975">After</span><span class="op" id="4888980">(</span><span class="ident" id="4888981">certList</span><span class="op" id="4888989">.</span><span class="ident" id="4888990">TBSCertList</span><span class="op" id="4889001">.</span><span class="ident" id="4889002">NextUpdate</span><span class="op" id="4889012">)</span><br>
<span class="lineno"></span><span class="op" id="4889014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4889017">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4889096">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4889118">type</span>&nbsp;<span class="ident" id="4889123">TBSCertificateList</span>&nbsp;<span class="keyword" id="4889142">struct</span>&nbsp;<span class="op" id="4889149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889152">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889172">asn1</span><span class="op" id="4889176">.</span><span class="ident" id="4889177">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889189">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4889209">int</span>&nbsp;<span class="string" id="4889213">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889242">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889262">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889283">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889303">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889316">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889336">time</span><span class="op" id="4889340">.</span><span class="ident" id="4889341">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889347">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4889367">time</span><span class="op" id="4889371">.</span><span class="ident" id="4889372">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4889388">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889407">RevokedCertificates</span>&nbsp;<span class="op" id="4889427">[</span><span class="op" id="4889428">]</span><span class="ident" id="4889429">RevokedCertificate</span>&nbsp;<span class="string" id="4889448">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889467">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4889487">[</span><span class="op" id="4889488">]</span><span class="ident" id="4889489">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4889508">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4889541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4889544">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4889623">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4889645">type</span>&nbsp;<span class="ident" id="4889650">RevokedCertificate</span>&nbsp;<span class="keyword" id="4889669">struct</span>&nbsp;<span class="op" id="4889676">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889679">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4889694">*</span><span class="ident" id="4889695">big</span><span class="op" id="4889698">.</span><span class="ident" id="4889699">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889704">RevocationTime</span>&nbsp;<span class="ident" id="4889719">time</span><span class="op" id="4889723">.</span><span class="ident" id="4889724">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4889730">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4889745">[</span><span class="op" id="4889746">]</span><span class="ident" id="4889747">Extension</span>&nbsp;<span class="string" id="4889757">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4889775">}</span>
</div>
</body>
</html>
