<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html" class="current">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6752071">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6752126">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6752180">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6752231">package</span>&nbsp;<span class="ident" id="6752239">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6752245">import</span>&nbsp;<span class="op" id="6752252">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6752255">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6752266">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6752276">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6752279">func</span>&nbsp;<span class="ident" id="6752284">TestConsumeToken</span><span class="op" id="6752300">(</span><span class="ident" id="6752301">t</span>&nbsp;<span class="op" id="6752303">*</span><span class="ident" id="6752304">testing</span><span class="op" id="6752311">.</span><span class="ident" id="6752312">T</span><span class="op" id="6752313">)</span>&nbsp;<span class="op" id="6752315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752318">tests</span>&nbsp;<span class="op" id="6752324">:=</span>&nbsp;<span class="op" id="6752327">[</span><span class="op" id="6752328">...</span><span class="op" id="6752331">]</span><span class="op" id="6752332">[</span><span class="num" id="6752333">3</span><span class="op" id="6752334">]</span><span class="builtintype" id="6752335">string</span><span class="op" id="6752341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752345">{</span><span class="string" id="6752346">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6752355">,</span>&nbsp;<span class="string" id="6752357">&#34;foo&#34;</span><span class="op" id="6752362">,</span>&nbsp;<span class="string" id="6752364">&#34;&nbsp;bar&#34;</span><span class="op" id="6752370">}</span><span class="op" id="6752371">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752375">{</span><span class="string" id="6752376">&#34;bar&#34;</span><span class="op" id="6752381">,</span>&nbsp;<span class="string" id="6752383">&#34;bar&#34;</span><span class="op" id="6752388">,</span>&nbsp;<span class="string" id="6752390">&#34;&#34;</span><span class="op" id="6752392">}</span><span class="op" id="6752393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752397">{</span><span class="string" id="6752398">&#34;&#34;</span><span class="op" id="6752400">,</span>&nbsp;<span class="string" id="6752402">&#34;&#34;</span><span class="op" id="6752404">,</span>&nbsp;<span class="string" id="6752406">&#34;&#34;</span><span class="op" id="6752408">}</span><span class="op" id="6752409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752413">{</span><span class="string" id="6752414">&#34;&nbsp;foo&#34;</span><span class="op" id="6752420">,</span>&nbsp;<span class="string" id="6752422">&#34;&#34;</span><span class="op" id="6752424">,</span>&nbsp;<span class="string" id="6752426">&#34;&nbsp;foo&#34;</span><span class="op" id="6752432">}</span><span class="op" id="6752433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752439">for</span>&nbsp;<span class="ident" id="6752443">_</span><span class="op" id="6752444">,</span>&nbsp;<span class="ident" id="6752446">test</span>&nbsp;<span class="op" id="6752451">:=</span>&nbsp;<span class="keyword" id="6752454">range</span>&nbsp;<span class="ident" id="6752460">tests</span>&nbsp;<span class="op" id="6752466">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752470">token</span><span class="op" id="6752475">,</span>&nbsp;<span class="ident" id="6752477">rest</span>&nbsp;<span class="op" id="6752482">:=</span>&nbsp;<span class="ident" id="6752485">consumeToken</span><span class="op" id="6752497">(</span><span class="ident" id="6752498">test</span><span class="op" id="6752502">[</span><span class="num" id="6752503">0</span><span class="op" id="6752504">]</span><span class="op" id="6752505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752509">expectedToken</span>&nbsp;<span class="op" id="6752523">:=</span>&nbsp;<span class="ident" id="6752526">test</span><span class="op" id="6752530">[</span><span class="num" id="6752531">1</span><span class="op" id="6752532">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752536">expectedRest</span>&nbsp;<span class="op" id="6752549">:=</span>&nbsp;<span class="ident" id="6752552">test</span><span class="op" id="6752556">[</span><span class="num" id="6752557">2</span><span class="op" id="6752558">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6752562">if</span>&nbsp;<span class="ident" id="6752565">token</span>&nbsp;<span class="op" id="6752571">!=</span>&nbsp;<span class="ident" id="6752574">expectedToken</span>&nbsp;<span class="op" id="6752588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752593">t</span><span class="op" id="6752594">.</span><span class="ident" id="6752595">Errorf</span><span class="op" id="6752601">(</span><span class="string" id="6752602">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="6752654">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752660">expectedToken</span><span class="op" id="6752673">,</span>&nbsp;<span class="ident" id="6752675">token</span><span class="op" id="6752680">,</span>&nbsp;<span class="ident" id="6752682">test</span><span class="op" id="6752686">[</span><span class="num" id="6752687">0</span><span class="op" id="6752688">]</span><span class="op" id="6752689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752693">}</span>&nbsp;<span class="keyword" id="6752695">else</span>&nbsp;<span class="keyword" id="6752700">if</span>&nbsp;<span class="ident" id="6752703">rest</span>&nbsp;<span class="op" id="6752708">!=</span>&nbsp;<span class="ident" id="6752711">expectedRest</span>&nbsp;<span class="op" id="6752724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752729">t</span><span class="op" id="6752730">.</span><span class="ident" id="6752731">Errorf</span><span class="op" id="6752737">(</span><span class="string" id="6752738">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="6752811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752817">expectedRest</span><span class="op" id="6752829">,</span>&nbsp;<span class="ident" id="6752831">rest</span><span class="op" id="6752835">,</span>&nbsp;<span class="ident" id="6752837">token</span><span class="op" id="6752842">,</span>&nbsp;<span class="ident" id="6752844">test</span><span class="op" id="6752848">[</span><span class="num" id="6752849">0</span><span class="op" id="6752850">]</span><span class="op" id="6752851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752855">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752858">}</span><br>
<span class="lineno"></span><span class="op" id="6752860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6752863">func</span>&nbsp;<span class="ident" id="6752868">TestConsumeValue</span><span class="op" id="6752884">(</span><span class="ident" id="6752885">t</span>&nbsp;<span class="op" id="6752887">*</span><span class="ident" id="6752888">testing</span><span class="op" id="6752895">.</span><span class="ident" id="6752896">T</span><span class="op" id="6752897">)</span>&nbsp;<span class="op" id="6752899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6752902">tests</span>&nbsp;<span class="op" id="6752908">:=</span>&nbsp;<span class="op" id="6752911">[</span><span class="op" id="6752912">...</span><span class="op" id="6752915">]</span><span class="op" id="6752916">[</span><span class="num" id="6752917">3</span><span class="op" id="6752918">]</span><span class="builtintype" id="6752919">string</span><span class="op" id="6752925">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752929">{</span><span class="string" id="6752930">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6752939">,</span>&nbsp;<span class="string" id="6752941">&#34;foo&#34;</span><span class="op" id="6752946">,</span>&nbsp;<span class="string" id="6752948">&#34;&nbsp;bar&#34;</span><span class="op" id="6752954">}</span><span class="op" id="6752955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752959">{</span><span class="string" id="6752960">&#34;bar&#34;</span><span class="op" id="6752965">,</span>&nbsp;<span class="string" id="6752967">&#34;bar&#34;</span><span class="op" id="6752972">,</span>&nbsp;<span class="string" id="6752974">&#34;&#34;</span><span class="op" id="6752976">}</span><span class="op" id="6752977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6752981">{</span><span class="string" id="6752982">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="6752989">,</span>&nbsp;<span class="string" id="6752991">&#34;&#34;</span><span class="op" id="6752993">,</span>&nbsp;<span class="string" id="6752995">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="6753002">}</span><span class="op" id="6753003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753007">{</span><span class="string" id="6753008">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="6753023">,</span>&nbsp;<span class="string" id="6753025">&#34;My&nbsp;value&#34;</span><span class="op" id="6753035">,</span>&nbsp;<span class="string" id="6753037">&#34;end&#34;</span><span class="op" id="6753042">}</span><span class="op" id="6753043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753047">{</span><span class="string" id="6753048">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="6753064">,</span>&nbsp;<span class="string" id="6753066">&#34;My&nbsp;value&#34;</span><span class="op" id="6753076">,</span>&nbsp;<span class="string" id="6753078">&#34;&nbsp;end&#34;</span><span class="op" id="6753084">}</span><span class="op" id="6753085">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753089">{</span><span class="string" id="6753090">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="6753101">,</span>&nbsp;<span class="string" id="6753103">&#34;\\&#34;</span><span class="op" id="6753107">,</span>&nbsp;<span class="string" id="6753109">&#34;&nbsp;rest&#34;</span><span class="op" id="6753116">}</span><span class="op" id="6753117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753121">{</span><span class="string" id="6753122">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="6753140">,</span>&nbsp;<span class="string" id="6753142">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="6753155">,</span>&nbsp;<span class="string" id="6753157">&#34;end&#34;</span><span class="op" id="6753162">}</span><span class="op" id="6753163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753167">{</span><span class="string" id="6753168">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="6753178">,</span>&nbsp;<span class="string" id="6753180">&#34;&#34;</span><span class="op" id="6753182">,</span>&nbsp;<span class="string" id="6753184">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="6753194">}</span><span class="op" id="6753195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753201">for</span>&nbsp;<span class="ident" id="6753205">_</span><span class="op" id="6753206">,</span>&nbsp;<span class="ident" id="6753208">test</span>&nbsp;<span class="op" id="6753213">:=</span>&nbsp;<span class="keyword" id="6753216">range</span>&nbsp;<span class="ident" id="6753222">tests</span>&nbsp;<span class="op" id="6753228">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753232">value</span><span class="op" id="6753237">,</span>&nbsp;<span class="ident" id="6753239">rest</span>&nbsp;<span class="op" id="6753244">:=</span>&nbsp;<span class="ident" id="6753247">consumeValue</span><span class="op" id="6753259">(</span><span class="ident" id="6753260">test</span><span class="op" id="6753264">[</span><span class="num" id="6753265">0</span><span class="op" id="6753266">]</span><span class="op" id="6753267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753271">expectedValue</span>&nbsp;<span class="op" id="6753285">:=</span>&nbsp;<span class="ident" id="6753288">test</span><span class="op" id="6753292">[</span><span class="num" id="6753293">1</span><span class="op" id="6753294">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753298">expectedRest</span>&nbsp;<span class="op" id="6753311">:=</span>&nbsp;<span class="ident" id="6753314">test</span><span class="op" id="6753318">[</span><span class="num" id="6753319">2</span><span class="op" id="6753320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6753324">if</span>&nbsp;<span class="ident" id="6753327">value</span>&nbsp;<span class="op" id="6753333">!=</span>&nbsp;<span class="ident" id="6753336">expectedValue</span>&nbsp;<span class="op" id="6753350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753355">t</span><span class="op" id="6753356">.</span><span class="ident" id="6753357">Errorf</span><span class="op" id="6753363">(</span><span class="string" id="6753364">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6753416">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753422">expectedValue</span><span class="op" id="6753435">,</span>&nbsp;<span class="ident" id="6753437">value</span><span class="op" id="6753442">,</span>&nbsp;<span class="ident" id="6753444">test</span><span class="op" id="6753448">[</span><span class="num" id="6753449">0</span><span class="op" id="6753450">]</span><span class="op" id="6753451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753455">}</span>&nbsp;<span class="keyword" id="6753457">else</span>&nbsp;<span class="keyword" id="6753462">if</span>&nbsp;<span class="ident" id="6753465">rest</span>&nbsp;<span class="op" id="6753470">!=</span>&nbsp;<span class="ident" id="6753473">expectedRest</span>&nbsp;<span class="op" id="6753486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753491">t</span><span class="op" id="6753492">.</span><span class="ident" id="6753493">Errorf</span><span class="op" id="6753499">(</span><span class="string" id="6753500">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6753573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753579">expectedRest</span><span class="op" id="6753591">,</span>&nbsp;<span class="ident" id="6753593">rest</span><span class="op" id="6753597">,</span>&nbsp;<span class="ident" id="6753599">value</span><span class="op" id="6753604">,</span>&nbsp;<span class="ident" id="6753606">test</span><span class="op" id="6753610">[</span><span class="num" id="6753611">0</span><span class="op" id="6753612">]</span><span class="op" id="6753613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753617">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753620">}</span><br>
<span class="lineno"></span><span class="op" id="6753622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6753625">func</span>&nbsp;<span class="ident" id="6753630">TestConsumeMediaParam</span><span class="op" id="6753651">(</span><span class="ident" id="6753652">t</span>&nbsp;<span class="op" id="6753654">*</span><span class="ident" id="6753655">testing</span><span class="op" id="6753662">.</span><span class="ident" id="6753663">T</span><span class="op" id="6753664">)</span>&nbsp;<span class="op" id="6753666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6753669">tests</span>&nbsp;<span class="op" id="6753675">:=</span>&nbsp;<span class="op" id="6753678">[</span><span class="op" id="6753679">...</span><span class="op" id="6753682">]</span><span class="op" id="6753683">[</span><span class="num" id="6753684">4</span><span class="op" id="6753685">]</span><span class="builtintype" id="6753686">string</span><span class="op" id="6753692">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753696">{</span><span class="string" id="6753697">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="6753709">,</span>&nbsp;<span class="string" id="6753711">&#34;foo&#34;</span><span class="op" id="6753716">,</span>&nbsp;<span class="string" id="6753718">&#34;bar&#34;</span><span class="op" id="6753723">,</span>&nbsp;<span class="string" id="6753725">&#34;&#34;</span><span class="op" id="6753727">}</span><span class="op" id="6753728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753732">{</span><span class="string" id="6753733">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="6753744">,</span>&nbsp;<span class="string" id="6753746">&#34;foo&#34;</span><span class="op" id="6753751">,</span>&nbsp;<span class="string" id="6753753">&#34;bar&#34;</span><span class="op" id="6753758">,</span>&nbsp;<span class="string" id="6753760">&#34;&#34;</span><span class="op" id="6753762">}</span><span class="op" id="6753763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753767">{</span><span class="string" id="6753768">&#34;;foo=bar&#34;</span><span class="op" id="6753778">,</span>&nbsp;<span class="string" id="6753780">&#34;foo&#34;</span><span class="op" id="6753785">,</span>&nbsp;<span class="string" id="6753787">&#34;bar&#34;</span><span class="op" id="6753792">,</span>&nbsp;<span class="string" id="6753794">&#34;&#34;</span><span class="op" id="6753796">}</span><span class="op" id="6753797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753801">{</span><span class="string" id="6753802">&#34;;FOO=bar&#34;</span><span class="op" id="6753812">,</span>&nbsp;<span class="string" id="6753814">&#34;foo&#34;</span><span class="op" id="6753819">,</span>&nbsp;<span class="string" id="6753821">&#34;bar&#34;</span><span class="op" id="6753826">,</span>&nbsp;<span class="string" id="6753828">&#34;&#34;</span><span class="op" id="6753830">}</span><span class="op" id="6753831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753835">{</span><span class="string" id="6753836">`;foo=&#34;bar&#34;`</span><span class="op" id="6753848">,</span>&nbsp;<span class="string" id="6753850">&#34;foo&#34;</span><span class="op" id="6753855">,</span>&nbsp;<span class="string" id="6753857">&#34;bar&#34;</span><span class="op" id="6753862">,</span>&nbsp;<span class="string" id="6753864">&#34;&#34;</span><span class="op" id="6753866">}</span><span class="op" id="6753867">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753871">{</span><span class="string" id="6753872">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="6753886">,</span>&nbsp;<span class="string" id="6753888">&#34;foo&#34;</span><span class="op" id="6753893">,</span>&nbsp;<span class="string" id="6753895">&#34;bar&#34;</span><span class="op" id="6753900">,</span>&nbsp;<span class="string" id="6753902">&#34;;&nbsp;&#34;</span><span class="op" id="6753906">}</span><span class="op" id="6753907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753911">{</span><span class="string" id="6753912">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="6753933">,</span>&nbsp;<span class="string" id="6753935">&#34;foo&#34;</span><span class="op" id="6753940">,</span>&nbsp;<span class="string" id="6753942">&#34;bar&#34;</span><span class="op" id="6753947">,</span>&nbsp;<span class="string" id="6753949">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="6753960">}</span><span class="op" id="6753961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6753965">{</span><span class="string" id="6753966">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="6753988">,</span>&nbsp;<span class="string" id="6753990">&#34;boundary&#34;</span><span class="op" id="6754000">,</span>&nbsp;<span class="string" id="6754002">&#34;----CUT&#34;</span><span class="op" id="6754011">,</span>&nbsp;<span class="string" id="6754013">&#34;;&#34;</span><span class="op" id="6754016">}</span><span class="op" id="6754017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754021">{</span><span class="string" id="6754022">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6754063">,</span>&nbsp;<span class="string" id="6754065">&#34;key&#34;</span><span class="op" id="6754070">,</span>&nbsp;<span class="string" id="6754072">&#34;value&#34;</span><span class="op" id="6754079">,</span>&nbsp;<span class="string" id="6754081">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6754110">}</span><span class="op" id="6754111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754115">{</span><span class="string" id="6754116">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6754145">,</span>&nbsp;<span class="string" id="6754147">&#34;blah&#34;</span><span class="op" id="6754153">,</span>&nbsp;<span class="string" id="6754155">&#34;value&#34;</span><span class="op" id="6754162">,</span>&nbsp;<span class="string" id="6754164">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6754178">}</span><span class="op" id="6754179">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754183">{</span><span class="string" id="6754184">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6754198">,</span>&nbsp;<span class="string" id="6754200">&#34;name&#34;</span><span class="op" id="6754206">,</span>&nbsp;<span class="string" id="6754208">&#34;foo&#34;</span><span class="op" id="6754213">,</span>&nbsp;<span class="string" id="6754215">`&nbsp;`</span><span class="op" id="6754218">}</span><span class="op" id="6754219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754225">for</span>&nbsp;<span class="ident" id="6754229">_</span><span class="op" id="6754230">,</span>&nbsp;<span class="ident" id="6754232">test</span>&nbsp;<span class="op" id="6754237">:=</span>&nbsp;<span class="keyword" id="6754240">range</span>&nbsp;<span class="ident" id="6754246">tests</span>&nbsp;<span class="op" id="6754252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754256">param</span><span class="op" id="6754261">,</span>&nbsp;<span class="ident" id="6754263">value</span><span class="op" id="6754268">,</span>&nbsp;<span class="ident" id="6754270">rest</span>&nbsp;<span class="op" id="6754275">:=</span>&nbsp;<span class="ident" id="6754278">consumeMediaParam</span><span class="op" id="6754295">(</span><span class="ident" id="6754296">test</span><span class="op" id="6754300">[</span><span class="num" id="6754301">0</span><span class="op" id="6754302">]</span><span class="op" id="6754303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754307">expectedParam</span>&nbsp;<span class="op" id="6754321">:=</span>&nbsp;<span class="ident" id="6754324">test</span><span class="op" id="6754328">[</span><span class="num" id="6754329">1</span><span class="op" id="6754330">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754334">expectedValue</span>&nbsp;<span class="op" id="6754348">:=</span>&nbsp;<span class="ident" id="6754351">test</span><span class="op" id="6754355">[</span><span class="num" id="6754356">2</span><span class="op" id="6754357">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754361">expectedRest</span>&nbsp;<span class="op" id="6754374">:=</span>&nbsp;<span class="ident" id="6754377">test</span><span class="op" id="6754381">[</span><span class="num" id="6754382">3</span><span class="op" id="6754383">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6754387">if</span>&nbsp;<span class="ident" id="6754390">param</span>&nbsp;<span class="op" id="6754396">!=</span>&nbsp;<span class="ident" id="6754399">expectedParam</span>&nbsp;<span class="op" id="6754413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754418">t</span><span class="op" id="6754419">.</span><span class="ident" id="6754420">Errorf</span><span class="op" id="6754426">(</span><span class="string" id="6754427">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6754479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754485">expectedParam</span><span class="op" id="6754498">,</span>&nbsp;<span class="ident" id="6754500">param</span><span class="op" id="6754505">,</span>&nbsp;<span class="ident" id="6754507">test</span><span class="op" id="6754511">[</span><span class="num" id="6754512">0</span><span class="op" id="6754513">]</span><span class="op" id="6754514">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754518">}</span>&nbsp;<span class="keyword" id="6754520">else</span>&nbsp;<span class="keyword" id="6754525">if</span>&nbsp;<span class="ident" id="6754528">value</span>&nbsp;<span class="op" id="6754534">!=</span>&nbsp;<span class="ident" id="6754537">expectedValue</span>&nbsp;<span class="op" id="6754551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754556">t</span><span class="op" id="6754557">.</span><span class="ident" id="6754558">Errorf</span><span class="op" id="6754564">(</span><span class="string" id="6754565">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6754617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754623">expectedValue</span><span class="op" id="6754636">,</span>&nbsp;<span class="ident" id="6754638">value</span><span class="op" id="6754643">,</span>&nbsp;<span class="ident" id="6754645">test</span><span class="op" id="6754649">[</span><span class="num" id="6754650">0</span><span class="op" id="6754651">]</span><span class="op" id="6754652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754656">}</span>&nbsp;<span class="keyword" id="6754658">else</span>&nbsp;<span class="keyword" id="6754663">if</span>&nbsp;<span class="ident" id="6754666">rest</span>&nbsp;<span class="op" id="6754671">!=</span>&nbsp;<span class="ident" id="6754674">expectedRest</span>&nbsp;<span class="op" id="6754687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754692">t</span><span class="op" id="6754693">.</span><span class="ident" id="6754694">Errorf</span><span class="op" id="6754700">(</span><span class="string" id="6754701">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="6754771">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754777">expectedRest</span><span class="op" id="6754789">,</span>&nbsp;<span class="ident" id="6754791">rest</span><span class="op" id="6754795">,</span>&nbsp;<span class="ident" id="6754797">param</span><span class="op" id="6754802">,</span>&nbsp;<span class="ident" id="6754804">value</span><span class="op" id="6754809">,</span>&nbsp;<span class="ident" id="6754811">test</span><span class="op" id="6754815">[</span><span class="num" id="6754816">0</span><span class="op" id="6754817">]</span><span class="op" id="6754818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6754825">}</span><br>
<span class="lineno"></span><span class="op" id="6754827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6754830">type</span>&nbsp;<span class="ident" id="6754835">mediaTypeTest</span>&nbsp;<span class="keyword" id="6754849">struct</span>&nbsp;<span class="op" id="6754856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754859">in</span>&nbsp;<span class="builtintype" id="6754862">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754870">t</span>&nbsp;&nbsp;<span class="builtintype" id="6754873">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754881">p</span>&nbsp;&nbsp;<span class="keyword" id="6754884">map</span><span class="op" id="6754887">[</span><span class="builtintype" id="6754888">string</span><span class="op" id="6754894">]</span><span class="builtintype" id="6754895">string</span><br>
<span class="lineno"></span><span class="op" id="6754902">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="6754905">func</span>&nbsp;<span class="ident" id="6754910">TestParseMediaType</span><span class="op" id="6754928">(</span><span class="ident" id="6754929">t</span>&nbsp;<span class="op" id="6754931">*</span><span class="ident" id="6754932">testing</span><span class="op" id="6754939">.</span><span class="ident" id="6754940">T</span><span class="op" id="6754941">)</span>&nbsp;<span class="op" id="6754943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6754946">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6754978">m</span>&nbsp;<span class="op" id="6754980">:=</span>&nbsp;<span class="keyword" id="6754983">func</span><span class="op" id="6754987">(</span><span class="ident" id="6754988">s</span>&nbsp;<span class="op" id="6754990">...</span><span class="builtintype" id="6754993">string</span><span class="op" id="6754999">)</span>&nbsp;<span class="keyword" id="6755001">map</span><span class="op" id="6755004">[</span><span class="builtintype" id="6755005">string</span><span class="op" id="6755011">]</span><span class="builtintype" id="6755012">string</span>&nbsp;<span class="op" id="6755019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755023">sm</span>&nbsp;<span class="op" id="6755026">:=</span>&nbsp;<span class="builtinfunc" id="6755029">make</span><span class="op" id="6755033">(</span><span class="keyword" id="6755034">map</span><span class="op" id="6755037">[</span><span class="builtintype" id="6755038">string</span><span class="op" id="6755044">]</span><span class="builtintype" id="6755045">string</span><span class="op" id="6755051">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755055">for</span>&nbsp;<span class="ident" id="6755059">i</span>&nbsp;<span class="op" id="6755061">:=</span>&nbsp;<span class="num" id="6755064">0</span><span class="op" id="6755065">;</span>&nbsp;<span class="ident" id="6755067">i</span>&nbsp;<span class="op" id="6755069">&lt;</span>&nbsp;<span class="builtinfunc" id="6755071">len</span><span class="op" id="6755074">(</span><span class="ident" id="6755075">s</span><span class="op" id="6755076">)</span><span class="op" id="6755077">;</span>&nbsp;<span class="ident" id="6755079">i</span>&nbsp;<span class="op" id="6755081">+=</span>&nbsp;<span class="num" id="6755084">2</span>&nbsp;<span class="op" id="6755086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755091">sm</span><span class="op" id="6755093">[</span><span class="ident" id="6755094">s</span><span class="op" id="6755095">[</span><span class="ident" id="6755096">i</span><span class="op" id="6755097">]</span><span class="op" id="6755098">]</span>&nbsp;<span class="op" id="6755100">=</span>&nbsp;<span class="ident" id="6755102">s</span><span class="op" id="6755103">[</span><span class="ident" id="6755104">i</span><span class="op" id="6755105">+</span><span class="num" id="6755106">1</span><span class="op" id="6755107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6755115">return</span>&nbsp;<span class="ident" id="6755122">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755126">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755130">nameFoo</span>&nbsp;<span class="op" id="6755138">:=</span>&nbsp;<span class="keyword" id="6755141">map</span><span class="op" id="6755144">[</span><span class="builtintype" id="6755145">string</span><span class="op" id="6755151">]</span><span class="builtintype" id="6755152">string</span><span class="op" id="6755158">{</span><span class="string" id="6755159">&#34;name&#34;</span><span class="op" id="6755165">:</span>&nbsp;<span class="string" id="6755167">&#34;foo&#34;</span><span class="op" id="6755172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755175">tests</span>&nbsp;<span class="op" id="6755181">:=</span>&nbsp;<span class="op" id="6755184">[</span><span class="op" id="6755185">]</span><span class="ident" id="6755186">mediaTypeTest</span><span class="op" id="6755199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755203">{</span><span class="string" id="6755204">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="6755227">,</span>&nbsp;<span class="string" id="6755229">&#34;form-data&#34;</span><span class="op" id="6755240">,</span>&nbsp;<span class="ident" id="6755242">nameFoo</span><span class="op" id="6755249">}</span><span class="op" id="6755250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755254">{</span><span class="string" id="6755255">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="6755278">,</span>&nbsp;<span class="string" id="6755280">&#34;form-data&#34;</span><span class="op" id="6755291">,</span>&nbsp;<span class="ident" id="6755293">nameFoo</span><span class="op" id="6755300">}</span><span class="op" id="6755301">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755305">{</span><span class="string" id="6755306">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="6755328">,</span>&nbsp;<span class="string" id="6755330">&#34;form-data&#34;</span><span class="op" id="6755341">,</span>&nbsp;<span class="ident" id="6755343">nameFoo</span><span class="op" id="6755350">}</span><span class="op" id="6755351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755355">{</span><span class="string" id="6755356">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="6755381">,</span>&nbsp;<span class="string" id="6755383">&#34;form-data&#34;</span><span class="op" id="6755394">,</span>&nbsp;<span class="ident" id="6755396">nameFoo</span><span class="op" id="6755403">}</span><span class="op" id="6755404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755408">{</span><span class="string" id="6755409">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="6755434">,</span>&nbsp;<span class="string" id="6755436">&#34;form-data&#34;</span><span class="op" id="6755447">,</span>&nbsp;<span class="ident" id="6755449">nameFoo</span><span class="op" id="6755456">}</span><span class="op" id="6755457">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755462">{</span><span class="string" id="6755463">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="6755512">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6755517">&#34;form-data&#34;</span><span class="op" id="6755528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755533">m</span><span class="op" id="6755534">(</span><span class="string" id="6755535">&#34;key&#34;</span><span class="op" id="6755540">,</span>&nbsp;<span class="string" id="6755542">&#34;value&#34;</span><span class="op" id="6755549">,</span>&nbsp;<span class="string" id="6755551">&#34;blah&#34;</span><span class="op" id="6755557">,</span>&nbsp;<span class="string" id="6755559">&#34;value&#34;</span><span class="op" id="6755566">,</span>&nbsp;<span class="string" id="6755568">&#34;name&#34;</span><span class="op" id="6755574">,</span>&nbsp;<span class="string" id="6755576">&#34;foo&#34;</span><span class="op" id="6755581">)</span><span class="op" id="6755582">}</span><span class="op" id="6755583">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755588">{</span><span class="string" id="6755589">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="6755646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6755651">&#34;&#34;</span><span class="op" id="6755653">,</span>&nbsp;<span class="ident" id="6755655">m</span><span class="op" id="6755656">(</span><span class="op" id="6755657">)</span><span class="op" id="6755658">}</span><span class="op" id="6755659">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6755664">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755684">{</span><span class="string" id="6755685">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="6755763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6755768">&#34;application/x-stuff&#34;</span><span class="op" id="6755789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755794">m</span><span class="op" id="6755795">(</span><span class="string" id="6755796">&#34;title&#34;</span><span class="op" id="6755803">,</span>&nbsp;<span class="string" id="6755805">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="6755824">)</span><span class="op" id="6755825">}</span><span class="op" id="6755826">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6755831">{</span><span class="string" id="6755832">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="6755875">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6755880">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="6755898">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6755903">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="6755961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6755966">&#34;message/external-body&#34;</span><span class="op" id="6755989">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6755994">m</span><span class="op" id="6755995">(</span><span class="string" id="6755996">&#34;access-type&#34;</span><span class="op" id="6756009">,</span>&nbsp;<span class="string" id="6756011">&#34;URL&#34;</span><span class="op" id="6756016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756022">&#34;url&#34;</span><span class="op" id="6756027">,</span>&nbsp;<span class="string" id="6756029">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="6756085">)</span><span class="op" id="6756086">}</span><span class="op" id="6756087">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756092">{</span><span class="string" id="6756093">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="6756117">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756122">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="6756174">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756179">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="6756217">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756222">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="6756243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756248">&#34;application/x-stuff&#34;</span><span class="op" id="6756269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756274">m</span><span class="op" id="6756275">(</span><span class="string" id="6756276">&#34;title&#34;</span><span class="op" id="6756283">,</span>&nbsp;<span class="string" id="6756285">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="6756324">)</span><span class="op" id="6756325">}</span><span class="op" id="6756326">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6756331">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6756381">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756444">{</span><span class="string" id="6756445">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="6756479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756484">&#34;attachment&#34;</span><span class="op" id="6756496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756501">m</span><span class="op" id="6756502">(</span><span class="string" id="6756503">&#34;filename&#34;</span><span class="op" id="6756513">,</span>&nbsp;<span class="string" id="6756515">&#34;foo.html&#34;</span><span class="op" id="6756525">)</span><span class="op" id="6756526">}</span><span class="op" id="6756527">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756531">{</span><span class="string" id="6756532">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="6756580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756585">&#34;attachment&#34;</span><span class="op" id="6756597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756602">m</span><span class="op" id="6756603">(</span><span class="string" id="6756604">&#34;filename&#34;</span><span class="op" id="6756614">,</span>&nbsp;<span class="string" id="6756616">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="6756639">)</span><span class="op" id="6756640">}</span><span class="op" id="6756641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756645">{</span><span class="string" id="6756646">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="6756695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756700">&#34;attachment&#34;</span><span class="op" id="6756712">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756717">m</span><span class="op" id="6756718">(</span><span class="string" id="6756719">&#34;filename&#34;</span><span class="op" id="6756729">,</span>&nbsp;<span class="string" id="6756731">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="6756757">)</span><span class="op" id="6756758">}</span><span class="op" id="6756759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756763">{</span><span class="string" id="6756764">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="6756808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756813">&#34;attachment&#34;</span><span class="op" id="6756825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756830">m</span><span class="op" id="6756831">(</span><span class="string" id="6756832">&#34;foo&#34;</span><span class="op" id="6756837">,</span>&nbsp;<span class="string" id="6756839">&#34;\&#34;\\&#34;</span><span class="op" id="6756845">,</span>&nbsp;<span class="string" id="6756847">&#34;filename&#34;</span><span class="op" id="6756857">,</span>&nbsp;<span class="string" id="6756859">&#34;foo.html&#34;</span><span class="op" id="6756869">)</span><span class="op" id="6756870">}</span><span class="op" id="6756871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756875">{</span><span class="string" id="6756876">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="6756907">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756912">&#34;attachment&#34;</span><span class="op" id="6756924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6756929">m</span><span class="op" id="6756930">(</span><span class="string" id="6756931">&#34;filename&#34;</span><span class="op" id="6756941">,</span>&nbsp;<span class="string" id="6756943">&#34;foo.html&#34;</span><span class="op" id="6756953">)</span><span class="op" id="6756954">}</span><span class="op" id="6756955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6756959">{</span><span class="string" id="6756960">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="6756993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6756998">&#34;attachment&#34;</span><span class="op" id="6757010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757015">m</span><span class="op" id="6757016">(</span><span class="string" id="6757017">&#34;filename&#34;</span><span class="op" id="6757027">,</span>&nbsp;<span class="string" id="6757029">&#34;foo.html&#34;</span><span class="op" id="6757039">)</span><span class="op" id="6757040">}</span><span class="op" id="6757041">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757045">{</span><span class="string" id="6757046">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="6757079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757084">&#34;attachment&#34;</span><span class="op" id="6757096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757101">m</span><span class="op" id="6757102">(</span><span class="string" id="6757103">&#34;filename&#34;</span><span class="op" id="6757113">,</span>&nbsp;<span class="string" id="6757115">&#34;foo.html&#34;</span><span class="op" id="6757125">)</span><span class="op" id="6757126">}</span><span class="op" id="6757127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757131">{</span><span class="string" id="6757132">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="6757169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757174">&#34;attachment&#34;</span><span class="op" id="6757186">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757191">m</span><span class="op" id="6757192">(</span><span class="string" id="6757193">&#34;filename&#34;</span><span class="op" id="6757203">,</span>&nbsp;<span class="string" id="6757205">&#34;foo-%41.html&#34;</span><span class="op" id="6757219">)</span><span class="op" id="6757220">}</span><span class="op" id="6757221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757225">{</span><span class="string" id="6757226">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="6757264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757269">&#34;attachment&#34;</span><span class="op" id="6757281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757286">m</span><span class="op" id="6757287">(</span><span class="string" id="6757288">&#34;filename&#34;</span><span class="op" id="6757298">,</span>&nbsp;<span class="string" id="6757300">&#34;foo-%41.html&#34;</span><span class="op" id="6757314">)</span><span class="op" id="6757315">}</span><span class="op" id="6757316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757320">{</span><span class="string" id="6757321">`filename=foo.html`</span><span class="op" id="6757340">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757345">&#34;&#34;</span><span class="op" id="6757347">,</span>&nbsp;<span class="ident" id="6757349">m</span><span class="op" id="6757350">(</span><span class="op" id="6757351">)</span><span class="op" id="6757352">}</span><span class="op" id="6757353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757357">{</span><span class="string" id="6757358">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="6757382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757387">&#34;&#34;</span><span class="op" id="6757389">,</span>&nbsp;<span class="ident" id="6757391">m</span><span class="op" id="6757392">(</span><span class="op" id="6757393">)</span><span class="op" id="6757394">}</span><span class="op" id="6757395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757399">{</span><span class="string" id="6757400">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="6757439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757444">&#34;&#34;</span><span class="op" id="6757446">,</span>&nbsp;<span class="ident" id="6757448">m</span><span class="op" id="6757449">(</span><span class="op" id="6757450">)</span><span class="op" id="6757451">}</span><span class="op" id="6757452">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757456">{</span><span class="string" id="6757457">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="6757496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757501">&#34;&#34;</span><span class="op" id="6757503">,</span>&nbsp;<span class="ident" id="6757505">m</span><span class="op" id="6757506">(</span><span class="op" id="6757507">)</span><span class="op" id="6757508">}</span><span class="op" id="6757509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757513">{</span><span class="string" id="6757514">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="6757551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757556">&#34;&#34;</span><span class="op" id="6757558">,</span>&nbsp;<span class="ident" id="6757560">m</span><span class="op" id="6757561">(</span><span class="op" id="6757562">)</span><span class="op" id="6757563">}</span><span class="op" id="6757564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757568">{</span><span class="string" id="6757569">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="6757596">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757601">&#34;&#34;</span><span class="op" id="6757603">,</span>&nbsp;<span class="ident" id="6757605">m</span><span class="op" id="6757606">(</span><span class="op" id="6757607">)</span><span class="op" id="6757608">}</span><span class="op" id="6757609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757613">{</span><span class="string" id="6757614">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="6757675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757680">&#34;attachment&#34;</span><span class="op" id="6757692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757697">m</span><span class="op" id="6757698">(</span><span class="string" id="6757699">&#34;creation-date&#34;</span><span class="op" id="6757714">,</span>&nbsp;<span class="string" id="6757716">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="6757749">)</span><span class="op" id="6757750">}</span><span class="op" id="6757751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757755">{</span><span class="string" id="6757756">`foobar`</span><span class="op" id="6757764">,</span>&nbsp;<span class="string" id="6757766">&#34;foobar&#34;</span><span class="op" id="6757774">,</span>&nbsp;<span class="ident" id="6757776">m</span><span class="op" id="6757777">(</span><span class="op" id="6757778">)</span><span class="op" id="6757779">}</span><span class="op" id="6757780">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757784">{</span><span class="string" id="6757785">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="6757832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757837">&#34;attachment&#34;</span><span class="op" id="6757849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757854">m</span><span class="op" id="6757855">(</span><span class="string" id="6757856">&#34;filename&#34;</span><span class="op" id="6757866">,</span>&nbsp;<span class="string" id="6757868">&#34;foo-ä.html&#34;</span><span class="op" id="6757881">)</span><span class="op" id="6757882">}</span><span class="op" id="6757883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757887">{</span><span class="string" id="6757888">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="6757931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6757936">&#34;attachment&#34;</span><span class="op" id="6757948">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6757953">m</span><span class="op" id="6757954">(</span><span class="string" id="6757955">&#34;filename&#34;</span><span class="op" id="6757965">,</span>&nbsp;<span class="string" id="6757967">&#34;A-%41.html&#34;</span><span class="op" id="6757979">)</span><span class="op" id="6757980">}</span><span class="op" id="6757981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6757985">{</span><span class="string" id="6757986">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="6758036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758041">&#34;attachment&#34;</span><span class="op" id="6758053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758058">m</span><span class="op" id="6758059">(</span><span class="string" id="6758060">&#34;filename&#34;</span><span class="op" id="6758070">,</span>&nbsp;<span class="string" id="6758072">&#34;foo.html&#34;</span><span class="op" id="6758082">)</span><span class="op" id="6758083">}</span><span class="op" id="6758084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758088">{</span><span class="string" id="6758089">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="6758152">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758157">&#34;attachment&#34;</span><span class="op" id="6758169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758174">m</span><span class="op" id="6758175">(</span><span class="string" id="6758176">&#34;filename&#34;</span><span class="op" id="6758186">,</span>&nbsp;<span class="string" id="6758188">&#34;foo-ä.html&#34;</span><span class="op" id="6758201">)</span><span class="op" id="6758202">}</span><span class="op" id="6758203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758207">{</span><span class="string" id="6758208">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="6758257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758262">&#34;attachment&#34;</span><span class="op" id="6758274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758279">m</span><span class="op" id="6758280">(</span><span class="string" id="6758281">&#34;filename&#34;</span><span class="op" id="6758291">,</span>&nbsp;<span class="string" id="6758293">&#34;foo&#34;</span><span class="op" id="6758298">)</span><span class="op" id="6758299">}</span><span class="op" id="6758300">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758304">{</span><span class="string" id="6758305">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="6758353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758358">&#34;attachment&#34;</span><span class="op" id="6758370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758375">m</span><span class="op" id="6758376">(</span><span class="string" id="6758377">&#34;filename&#34;</span><span class="op" id="6758387">,</span>&nbsp;<span class="string" id="6758389">&#34;foo&#34;</span><span class="op" id="6758394">)</span><span class="op" id="6758395">}</span><span class="op" id="6758396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758400">{</span><span class="string" id="6758401">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="6758449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758454">&#34;attachment&#34;</span><span class="op" id="6758466">,</span>&nbsp;<span class="ident" id="6758468">m</span><span class="op" id="6758469">(</span><span class="op" id="6758470">)</span><span class="op" id="6758471">}</span><span class="op" id="6758472">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758476">{</span><span class="string" id="6758477">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="6758525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758530">&#34;attachment&#34;</span><span class="op" id="6758542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758547">m</span><span class="op" id="6758548">(</span><span class="string" id="6758549">&#34;filename&#34;</span><span class="op" id="6758559">,</span>&nbsp;<span class="string" id="6758561">&#34;foobar&#34;</span><span class="op" id="6758569">)</span><span class="op" id="6758570">}</span><span class="op" id="6758571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758575">{</span><span class="string" id="6758576">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="6758646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758651">&#34;attachment&#34;</span><span class="op" id="6758663">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758668">m</span><span class="op" id="6758669">(</span><span class="string" id="6758670">&#34;filename&#34;</span><span class="op" id="6758680">,</span>&nbsp;<span class="string" id="6758682">&#34;foo-ä.html&#34;</span><span class="op" id="6758695">)</span><span class="op" id="6758696">}</span><span class="op" id="6758697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758701">{</span><span class="string" id="6758702">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="6758772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6758777">&#34;attachment&#34;</span><span class="op" id="6758789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6758794">m</span><span class="op" id="6758795">(</span><span class="string" id="6758796">&#34;filename&#34;</span><span class="op" id="6758806">,</span>&nbsp;<span class="string" id="6758808">&#34;foo-ä.html&#34;</span><span class="op" id="6758821">)</span><span class="op" id="6758822">}</span><span class="op" id="6758823">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6758828">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6758890">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6758947">{</span><span class="string" id="6758948">`form-data;&nbsp;firstname=&#34;Брэд&#34;;&nbsp;lastname=&#34;Фицпатрик&#34;`</span><span class="op" id="6759012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6759017">&#34;form-data&#34;</span><span class="op" id="6759028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759033">m</span><span class="op" id="6759034">(</span><span class="string" id="6759035">&#34;firstname&#34;</span><span class="op" id="6759046">,</span>&nbsp;<span class="string" id="6759048">&#34;Брэд&#34;</span><span class="op" id="6759058">,</span>&nbsp;<span class="string" id="6759060">&#34;lastname&#34;</span><span class="op" id="6759070">,</span>&nbsp;<span class="string" id="6759072">&#34;Фицпатрик&#34;</span><span class="op" id="6759092">)</span><span class="op" id="6759093">}</span><span class="op" id="6759094">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759100">for</span>&nbsp;<span class="ident" id="6759104">_</span><span class="op" id="6759105">,</span>&nbsp;<span class="ident" id="6759107">test</span>&nbsp;<span class="op" id="6759112">:=</span>&nbsp;<span class="keyword" id="6759115">range</span>&nbsp;<span class="ident" id="6759121">tests</span>&nbsp;<span class="op" id="6759127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759131">mt</span><span class="op" id="6759133">,</span>&nbsp;<span class="ident" id="6759135">params</span><span class="op" id="6759141">,</span>&nbsp;<span class="ident" id="6759143">err</span>&nbsp;<span class="op" id="6759147">:=</span>&nbsp;<span class="ident" id="6759150">ParseMediaType</span><span class="op" id="6759164">(</span><span class="ident" id="6759165">test</span><span class="op" id="6759169">.</span><span class="ident" id="6759170">in</span><span class="op" id="6759172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759176">if</span>&nbsp;<span class="ident" id="6759179">err</span>&nbsp;<span class="op" id="6759183">!=</span>&nbsp;<span class="builtintype" id="6759186">nil</span>&nbsp;<span class="op" id="6759190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759195">if</span>&nbsp;<span class="ident" id="6759198">test</span><span class="op" id="6759202">.</span><span class="ident" id="6759203">t</span>&nbsp;<span class="op" id="6759205">!=</span>&nbsp;<span class="string" id="6759208">&#34;&#34;</span>&nbsp;<span class="op" id="6759211">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759217">t</span><span class="op" id="6759218">.</span><span class="ident" id="6759219">Errorf</span><span class="op" id="6759225">(</span><span class="string" id="6759226">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6759262">,</span>&nbsp;<span class="ident" id="6759264">test</span><span class="op" id="6759268">.</span><span class="ident" id="6759269">in</span><span class="op" id="6759271">,</span>&nbsp;<span class="ident" id="6759273">err</span><span class="op" id="6759276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759282">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759299">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759310">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759314">if</span>&nbsp;<span class="ident" id="6759317">g</span><span class="op" id="6759318">,</span>&nbsp;<span class="ident" id="6759320">e</span>&nbsp;<span class="op" id="6759322">:=</span>&nbsp;<span class="ident" id="6759325">mt</span><span class="op" id="6759327">,</span>&nbsp;<span class="ident" id="6759329">test</span><span class="op" id="6759333">.</span><span class="ident" id="6759334">t</span><span class="op" id="6759335">;</span>&nbsp;<span class="ident" id="6759337">g</span>&nbsp;<span class="op" id="6759339">!=</span>&nbsp;<span class="ident" id="6759342">e</span>&nbsp;<span class="op" id="6759344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759349">t</span><span class="op" id="6759350">.</span><span class="ident" id="6759351">Errorf</span><span class="op" id="6759357">(</span><span class="string" id="6759358">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6759398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759404">test</span><span class="op" id="6759408">.</span><span class="ident" id="6759409">in</span><span class="op" id="6759411">,</span>&nbsp;<span class="ident" id="6759413">e</span><span class="op" id="6759414">,</span>&nbsp;<span class="ident" id="6759416">g</span><span class="op" id="6759417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759422">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759433">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759437">if</span>&nbsp;<span class="builtinfunc" id="6759440">len</span><span class="op" id="6759443">(</span><span class="ident" id="6759444">params</span><span class="op" id="6759450">)</span>&nbsp;<span class="op" id="6759452">==</span>&nbsp;<span class="num" id="6759455">0</span>&nbsp;<span class="op" id="6759457">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6759460">len</span><span class="op" id="6759463">(</span><span class="ident" id="6759464">test</span><span class="op" id="6759468">.</span><span class="ident" id="6759469">p</span><span class="op" id="6759470">)</span>&nbsp;<span class="op" id="6759472">==</span>&nbsp;<span class="num" id="6759475">0</span>&nbsp;<span class="op" id="6759477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759482">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6759497">if</span>&nbsp;<span class="op" id="6759500">!</span><span class="ident" id="6759501">reflect</span><span class="op" id="6759508">.</span><span class="ident" id="6759509">DeepEqual</span><span class="op" id="6759518">(</span><span class="ident" id="6759519">params</span><span class="op" id="6759525">,</span>&nbsp;<span class="ident" id="6759527">test</span><span class="op" id="6759531">.</span><span class="ident" id="6759532">p</span><span class="op" id="6759533">)</span>&nbsp;<span class="op" id="6759535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759540">t</span><span class="op" id="6759541">.</span><span class="ident" id="6759542">Errorf</span><span class="op" id="6759548">(</span><span class="string" id="6759549">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="6759580">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6759586">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="6759603">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6759609">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="6759624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759630">test</span><span class="op" id="6759634">.</span><span class="ident" id="6759635">in</span><span class="op" id="6759637">,</span>&nbsp;<span class="ident" id="6759639">test</span><span class="op" id="6759643">.</span><span class="ident" id="6759644">p</span><span class="op" id="6759645">,</span>&nbsp;<span class="ident" id="6759647">params</span><span class="op" id="6759653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759660">}</span><br>
<span class="lineno">245</span><span class="op" id="6759662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6759665">type</span>&nbsp;<span class="ident" id="6759670">badMediaTypeTest</span>&nbsp;<span class="keyword" id="6759687">struct</span>&nbsp;<span class="op" id="6759694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759697">in</span>&nbsp;&nbsp;<span class="builtintype" id="6759701">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6759709">err</span>&nbsp;<span class="builtintype" id="6759713">string</span><br>
<span class="lineno">250</span><span class="op" id="6759720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6759723">var</span>&nbsp;<span class="ident" id="6759727">badMediaTypeTests</span>&nbsp;<span class="op" id="6759745">=</span>&nbsp;<span class="op" id="6759747">[</span><span class="op" id="6759748">]</span><span class="ident" id="6759749">badMediaTypeTest</span><span class="op" id="6759765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759768">{</span><span class="string" id="6759769">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="6759787">,</span>&nbsp;<span class="string" id="6759789">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="6759820">}</span><span class="op" id="6759821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759824">{</span><span class="string" id="6759825">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="6759855">,</span>&nbsp;<span class="string" id="6759857">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="6759891">}</span><span class="op" id="6759892">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6759895">{</span><span class="string" id="6759896">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="6759931">,</span>&nbsp;<span class="string" id="6759933">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="6759979">}</span><span class="op" id="6759980">,</span><br>
<span class="lineno"></span><span class="op" id="6759982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6759985">func</span>&nbsp;<span class="ident" id="6759990">TestParseMediaTypeBogus</span><span class="op" id="6760013">(</span><span class="ident" id="6760014">t</span>&nbsp;<span class="op" id="6760016">*</span><span class="ident" id="6760017">testing</span><span class="op" id="6760024">.</span><span class="ident" id="6760025">T</span><span class="op" id="6760026">)</span>&nbsp;<span class="op" id="6760028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760031">for</span>&nbsp;<span class="ident" id="6760035">_</span><span class="op" id="6760036">,</span>&nbsp;<span class="ident" id="6760038">tt</span>&nbsp;<span class="op" id="6760041">:=</span>&nbsp;<span class="keyword" id="6760044">range</span>&nbsp;<span class="ident" id="6760050">badMediaTypeTests</span>&nbsp;<span class="op" id="6760068">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760072">mt</span><span class="op" id="6760074">,</span>&nbsp;<span class="ident" id="6760076">params</span><span class="op" id="6760082">,</span>&nbsp;<span class="ident" id="6760084">err</span>&nbsp;<span class="op" id="6760088">:=</span>&nbsp;<span class="ident" id="6760091">ParseMediaType</span><span class="op" id="6760105">(</span><span class="ident" id="6760106">tt</span><span class="op" id="6760108">.</span><span class="ident" id="6760109">in</span><span class="op" id="6760111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760115">if</span>&nbsp;<span class="ident" id="6760118">err</span>&nbsp;<span class="op" id="6760122">==</span>&nbsp;<span class="builtintype" id="6760125">nil</span>&nbsp;<span class="op" id="6760129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760134">t</span><span class="op" id="6760135">.</span><span class="ident" id="6760136">Errorf</span><span class="op" id="6760142">(</span><span class="string" id="6760143">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="6760193">,</span>&nbsp;<span class="ident" id="6760195">tt</span><span class="op" id="6760197">.</span><span class="ident" id="6760198">in</span><span class="op" id="6760200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760205">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760216">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760220">if</span>&nbsp;<span class="ident" id="6760223">err</span><span class="op" id="6760226">.</span><span class="ident" id="6760227">Error</span><span class="op" id="6760232">(</span><span class="op" id="6760233">)</span>&nbsp;<span class="op" id="6760235">!=</span>&nbsp;<span class="ident" id="6760238">tt</span><span class="op" id="6760240">.</span><span class="ident" id="6760241">err</span>&nbsp;<span class="op" id="6760245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760250">t</span><span class="op" id="6760251">.</span><span class="ident" id="6760252">Errorf</span><span class="op" id="6760258">(</span><span class="string" id="6760259">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6760297">,</span>&nbsp;<span class="ident" id="6760299">tt</span><span class="op" id="6760301">.</span><span class="ident" id="6760302">in</span><span class="op" id="6760304">,</span>&nbsp;<span class="ident" id="6760306">err</span><span class="op" id="6760309">.</span><span class="ident" id="6760310">Error</span><span class="op" id="6760315">(</span><span class="op" id="6760316">)</span><span class="op" id="6760317">,</span>&nbsp;<span class="ident" id="6760319">tt</span><span class="op" id="6760321">.</span><span class="ident" id="6760322">err</span><span class="op" id="6760325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760333">if</span>&nbsp;<span class="ident" id="6760336">params</span>&nbsp;<span class="op" id="6760343">!=</span>&nbsp;<span class="builtintype" id="6760346">nil</span>&nbsp;<span class="op" id="6760350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760355">t</span><span class="op" id="6760356">.</span><span class="ident" id="6760357">Errorf</span><span class="op" id="6760363">(</span><span class="string" id="6760364">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="6760413">,</span>&nbsp;<span class="ident" id="6760415">tt</span><span class="op" id="6760417">.</span><span class="ident" id="6760418">in</span><span class="op" id="6760420">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6760428">if</span>&nbsp;<span class="ident" id="6760431">mt</span>&nbsp;<span class="op" id="6760434">!=</span>&nbsp;<span class="string" id="6760437">&#34;&#34;</span>&nbsp;<span class="op" id="6760440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760445">t</span><span class="op" id="6760446">.</span><span class="ident" id="6760447">Errorf</span><span class="op" id="6760453">(</span><span class="string" id="6760454">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="6760516">,</span>&nbsp;<span class="ident" id="6760518">tt</span><span class="op" id="6760520">.</span><span class="ident" id="6760521">in</span><span class="op" id="6760523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760530">}</span><br>
<span class="lineno">275</span><span class="op" id="6760532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6760535">type</span>&nbsp;<span class="ident" id="6760540">formatTest</span>&nbsp;<span class="keyword" id="6760551">struct</span>&nbsp;<span class="op" id="6760558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760561">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6760568">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760576">params</span>&nbsp;<span class="keyword" id="6760583">map</span><span class="op" id="6760586">[</span><span class="builtintype" id="6760587">string</span><span class="op" id="6760593">]</span><span class="builtintype" id="6760594">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6760602">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6760609">string</span><br>
<span class="lineno"></span><span class="op" id="6760616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6760619">var</span>&nbsp;<span class="ident" id="6760623">formatTests</span>&nbsp;<span class="op" id="6760635">=</span>&nbsp;<span class="op" id="6760637">[</span><span class="op" id="6760638">]</span><span class="ident" id="6760639">formatTest</span><span class="op" id="6760649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760652">{</span><span class="string" id="6760653">&#34;noslash&#34;</span><span class="op" id="6760662">,</span>&nbsp;<span class="builtintype" id="6760664">nil</span><span class="op" id="6760667">,</span>&nbsp;<span class="string" id="6760669">&#34;&#34;</span><span class="op" id="6760671">}</span><span class="op" id="6760672">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760675">{</span><span class="string" id="6760676">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="6760689">,</span>&nbsp;<span class="builtintype" id="6760691">nil</span><span class="op" id="6760694">,</span>&nbsp;<span class="string" id="6760696">&#34;&#34;</span><span class="op" id="6760698">}</span><span class="op" id="6760699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760702">{</span><span class="string" id="6760703">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="6760716">,</span>&nbsp;<span class="builtintype" id="6760718">nil</span><span class="op" id="6760721">,</span>&nbsp;<span class="string" id="6760723">&#34;&#34;</span><span class="op" id="6760725">}</span><span class="op" id="6760726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760729">{</span><span class="string" id="6760730">&#34;foo/BAR&#34;</span><span class="op" id="6760739">,</span>&nbsp;<span class="builtintype" id="6760741">nil</span><span class="op" id="6760744">,</span>&nbsp;<span class="string" id="6760746">&#34;foo/bar&#34;</span><span class="op" id="6760755">}</span><span class="op" id="6760756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760759">{</span><span class="string" id="6760760">&#34;foo/BAR&#34;</span><span class="op" id="6760769">,</span>&nbsp;<span class="keyword" id="6760771">map</span><span class="op" id="6760774">[</span><span class="builtintype" id="6760775">string</span><span class="op" id="6760781">]</span><span class="builtintype" id="6760782">string</span><span class="op" id="6760788">{</span><span class="string" id="6760789">&#34;X&#34;</span><span class="op" id="6760792">:</span>&nbsp;<span class="string" id="6760794">&#34;Y&#34;</span><span class="op" id="6760797">}</span><span class="op" id="6760798">,</span>&nbsp;<span class="string" id="6760800">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="6760814">}</span><span class="op" id="6760815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760818">{</span><span class="string" id="6760819">&#34;foo/BAR&#34;</span><span class="op" id="6760828">,</span>&nbsp;<span class="keyword" id="6760830">map</span><span class="op" id="6760833">[</span><span class="builtintype" id="6760834">string</span><span class="op" id="6760840">]</span><span class="builtintype" id="6760841">string</span><span class="op" id="6760847">{</span><span class="string" id="6760848">&#34;space&#34;</span><span class="op" id="6760855">:</span>&nbsp;<span class="string" id="6760857">&#34;With&nbsp;space&#34;</span><span class="op" id="6760869">}</span><span class="op" id="6760870">,</span>&nbsp;<span class="string" id="6760872">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="6760901">}</span><span class="op" id="6760902">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760905">{</span><span class="string" id="6760906">&#34;foo/BAR&#34;</span><span class="op" id="6760915">,</span>&nbsp;<span class="keyword" id="6760917">map</span><span class="op" id="6760920">[</span><span class="builtintype" id="6760921">string</span><span class="op" id="6760927">]</span><span class="builtintype" id="6760928">string</span><span class="op" id="6760934">{</span><span class="string" id="6760935">&#34;quote&#34;</span><span class="op" id="6760942">:</span>&nbsp;<span class="string" id="6760944">`With&nbsp;&#34;quote`</span><span class="op" id="6760957">}</span><span class="op" id="6760958">,</span>&nbsp;<span class="string" id="6760960">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="6760991">}</span><span class="op" id="6760992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6760995">{</span><span class="string" id="6760996">&#34;foo/BAR&#34;</span><span class="op" id="6761005">,</span>&nbsp;<span class="keyword" id="6761007">map</span><span class="op" id="6761010">[</span><span class="builtintype" id="6761011">string</span><span class="op" id="6761017">]</span><span class="builtintype" id="6761018">string</span><span class="op" id="6761024">{</span><span class="string" id="6761025">&#34;bslash&#34;</span><span class="op" id="6761033">:</span>&nbsp;<span class="string" id="6761035">`With&nbsp;\backslash`</span><span class="op" id="6761052">}</span><span class="op" id="6761053">,</span>&nbsp;<span class="string" id="6761055">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="6761091">}</span><span class="op" id="6761092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761095">{</span><span class="string" id="6761096">&#34;foo/BAR&#34;</span><span class="op" id="6761105">,</span>&nbsp;<span class="keyword" id="6761107">map</span><span class="op" id="6761110">[</span><span class="builtintype" id="6761111">string</span><span class="op" id="6761117">]</span><span class="builtintype" id="6761118">string</span><span class="op" id="6761124">{</span><span class="string" id="6761125">&#34;both&#34;</span><span class="op" id="6761131">:</span>&nbsp;<span class="string" id="6761133">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="6761161">}</span><span class="op" id="6761162">,</span>&nbsp;<span class="string" id="6761164">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="6761210">}</span><span class="op" id="6761211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761214">{</span><span class="string" id="6761215">&#34;foo/BAR&#34;</span><span class="op" id="6761224">,</span>&nbsp;<span class="keyword" id="6761226">map</span><span class="op" id="6761229">[</span><span class="builtintype" id="6761230">string</span><span class="op" id="6761236">]</span><span class="builtintype" id="6761237">string</span><span class="op" id="6761243">{</span><span class="string" id="6761244">&#34;&#34;</span><span class="op" id="6761246">:</span>&nbsp;<span class="string" id="6761248">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="6761265">}</span><span class="op" id="6761266">,</span>&nbsp;<span class="string" id="6761268">&#34;&#34;</span><span class="op" id="6761270">}</span><span class="op" id="6761271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761274">{</span><span class="string" id="6761275">&#34;foo/BAR&#34;</span><span class="op" id="6761284">,</span>&nbsp;<span class="keyword" id="6761286">map</span><span class="op" id="6761289">[</span><span class="builtintype" id="6761290">string</span><span class="op" id="6761296">]</span><span class="builtintype" id="6761297">string</span><span class="op" id="6761303">{</span><span class="string" id="6761304">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="6761319">:</span>&nbsp;<span class="string" id="6761321">&#34;baz&#34;</span><span class="op" id="6761326">}</span><span class="op" id="6761327">,</span>&nbsp;<span class="string" id="6761329">&#34;&#34;</span><span class="op" id="6761331">}</span><span class="op" id="6761332">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761335">{</span><span class="string" id="6761336">&#34;foo/BAR&#34;</span><span class="op" id="6761345">,</span>&nbsp;<span class="keyword" id="6761347">map</span><span class="op" id="6761350">[</span><span class="builtintype" id="6761351">string</span><span class="op" id="6761357">]</span><span class="builtintype" id="6761358">string</span><span class="op" id="6761364">{</span><span class="string" id="6761365">&#34;nonascii&#34;</span><span class="op" id="6761375">:</span>&nbsp;<span class="string" id="6761377">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;ä&#34;</span><span class="op" id="6761405">}</span><span class="op" id="6761406">,</span>&nbsp;<span class="string" id="6761408">&#34;&#34;</span><span class="op" id="6761410">}</span><span class="op" id="6761411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761414">{</span><span class="string" id="6761415">&#34;foo/bar&#34;</span><span class="op" id="6761424">,</span>&nbsp;<span class="keyword" id="6761426">map</span><span class="op" id="6761429">[</span><span class="builtintype" id="6761430">string</span><span class="op" id="6761436">]</span><span class="builtintype" id="6761437">string</span><span class="op" id="6761443">{</span><span class="string" id="6761444">&#34;a&#34;</span><span class="op" id="6761447">:</span>&nbsp;<span class="string" id="6761449">&#34;av&#34;</span><span class="op" id="6761453">,</span>&nbsp;<span class="string" id="6761455">&#34;b&#34;</span><span class="op" id="6761458">:</span>&nbsp;<span class="string" id="6761460">&#34;bv&#34;</span><span class="op" id="6761464">,</span>&nbsp;<span class="string" id="6761466">&#34;c&#34;</span><span class="op" id="6761469">:</span>&nbsp;<span class="string" id="6761471">&#34;cv&#34;</span><span class="op" id="6761475">}</span><span class="op" id="6761476">,</span>&nbsp;<span class="string" id="6761478">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="6761505">}</span><span class="op" id="6761506">,</span><br>
<span class="lineno"></span><span class="op" id="6761508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6761511">func</span>&nbsp;<span class="ident" id="6761516">TestFormatMediaType</span><span class="op" id="6761535">(</span><span class="ident" id="6761536">t</span>&nbsp;<span class="op" id="6761538">*</span><span class="ident" id="6761539">testing</span><span class="op" id="6761546">.</span><span class="ident" id="6761547">T</span><span class="op" id="6761548">)</span>&nbsp;<span class="op" id="6761550">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6761553">for</span>&nbsp;<span class="ident" id="6761557">i</span><span class="op" id="6761558">,</span>&nbsp;<span class="ident" id="6761560">tt</span>&nbsp;<span class="op" id="6761563">:=</span>&nbsp;<span class="keyword" id="6761566">range</span>&nbsp;<span class="ident" id="6761572">formatTests</span>&nbsp;<span class="op" id="6761584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761588">got</span>&nbsp;<span class="op" id="6761592">:=</span>&nbsp;<span class="ident" id="6761595">FormatMediaType</span><span class="op" id="6761610">(</span><span class="ident" id="6761611">tt</span><span class="op" id="6761613">.</span><span class="ident" id="6761614">typ</span><span class="op" id="6761617">,</span>&nbsp;<span class="ident" id="6761619">tt</span><span class="op" id="6761621">.</span><span class="ident" id="6761622">params</span><span class="op" id="6761628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6761632">if</span>&nbsp;<span class="ident" id="6761635">got</span>&nbsp;<span class="op" id="6761639">!=</span>&nbsp;<span class="ident" id="6761642">tt</span><span class="op" id="6761644">.</span><span class="ident" id="6761645">want</span>&nbsp;<span class="op" id="6761650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6761655">t</span><span class="op" id="6761656">.</span><span class="ident" id="6761657">Errorf</span><span class="op" id="6761663">(</span><span class="string" id="6761664">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6761707">,</span>&nbsp;<span class="ident" id="6761709">i</span><span class="op" id="6761710">,</span>&nbsp;<span class="ident" id="6761712">tt</span><span class="op" id="6761714">.</span><span class="ident" id="6761715">typ</span><span class="op" id="6761718">,</span>&nbsp;<span class="ident" id="6761720">tt</span><span class="op" id="6761722">.</span><span class="ident" id="6761723">params</span><span class="op" id="6761729">,</span>&nbsp;<span class="ident" id="6761731">got</span><span class="op" id="6761734">,</span>&nbsp;<span class="ident" id="6761736">tt</span><span class="op" id="6761738">.</span><span class="ident" id="6761739">want</span><span class="op" id="6761743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761747">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6761750">}</span><br>
<span class="lineno"></span><span class="op" id="6761752">}</span>
</div>
</body>
</html>
