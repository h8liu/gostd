<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html" class="current">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5125616">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5125671">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5125725">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5125776">package</span>&nbsp;<span class="ident" id="5125784">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5125794">import</span>&nbsp;<span class="op" id="5125801">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5125804">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5125813">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5125820">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5125831">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5125846">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5125849">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5125913">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="5125962">func</span>&nbsp;<span class="ident" id="5125967">endsWithCSSKeyword</span><span class="op" id="5125985">(</span><span class="ident" id="5125986">b</span>&nbsp;<span class="op" id="5125988">[</span><span class="op" id="5125989">]</span><span class="builtintype" id="5125990">byte</span><span class="op" id="5125994">,</span>&nbsp;<span class="ident" id="5125996">kw</span>&nbsp;<span class="builtintype" id="5125999">string</span><span class="op" id="5126005">)</span>&nbsp;<span class="builtintype" id="5126007">bool</span>&nbsp;<span class="op" id="5126012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5126015">i</span>&nbsp;<span class="op" id="5126017">:=</span>&nbsp;<span class="builtinfunc" id="5126020">len</span><span class="op" id="5126023">(</span><span class="ident" id="5126024">b</span><span class="op" id="5126025">)</span>&nbsp;<span class="op" id="5126027">-</span>&nbsp;<span class="builtinfunc" id="5126029">len</span><span class="op" id="5126032">(</span><span class="ident" id="5126033">kw</span><span class="op" id="5126035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126038">if</span>&nbsp;<span class="ident" id="5126041">i</span>&nbsp;<span class="op" id="5126043">&lt;</span>&nbsp;<span class="num" id="5126045">0</span>&nbsp;<span class="op" id="5126047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126051">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126067">return</span>&nbsp;<span class="builtintype" id="5126074">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5126081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126084">if</span>&nbsp;<span class="ident" id="5126087">i</span>&nbsp;<span class="op" id="5126089">!=</span>&nbsp;<span class="num" id="5126092">0</span>&nbsp;<span class="op" id="5126094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5126098">r</span><span class="op" id="5126099">,</span>&nbsp;<span class="ident" id="5126101">_</span>&nbsp;<span class="op" id="5126103">:=</span>&nbsp;<span class="ident" id="5126106">utf8</span><span class="op" id="5126110">.</span><span class="ident" id="5126111">DecodeLastRune</span><span class="op" id="5126125">(</span><span class="ident" id="5126126">b</span><span class="op" id="5126127">[</span><span class="op" id="5126128">:</span><span class="ident" id="5126129">i</span><span class="op" id="5126130">]</span><span class="op" id="5126131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126135">if</span>&nbsp;<span class="ident" id="5126138">isCSSNmchar</span><span class="op" id="5126149">(</span><span class="ident" id="5126150">r</span><span class="op" id="5126151">)</span>&nbsp;<span class="op" id="5126153">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126158">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126174">return</span>&nbsp;<span class="builtintype" id="5126181">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5126189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5126192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126195">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126268">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126328">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126374">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126444">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126495">return</span>&nbsp;<span class="builtintype" id="5126502">string</span><span class="op" id="5126508">(</span><span class="ident" id="5126509">bytes</span><span class="op" id="5126514">.</span><span class="ident" id="5126515">ToLower</span><span class="op" id="5126522">(</span><span class="ident" id="5126523">b</span><span class="op" id="5126524">[</span><span class="ident" id="5126525">i</span><span class="op" id="5126526">:</span><span class="op" id="5126527">]</span><span class="op" id="5126528">)</span><span class="op" id="5126529">)</span>&nbsp;<span class="op" id="5126531">==</span>&nbsp;<span class="ident" id="5126534">kw</span><br>
<span class="lineno">35</span><span class="op" id="5126537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5126540">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="5126617">func</span>&nbsp;<span class="ident" id="5126622">isCSSNmchar</span><span class="op" id="5126633">(</span><span class="ident" id="5126634">r</span>&nbsp;<span class="builtintype" id="5126636">rune</span><span class="op" id="5126640">)</span>&nbsp;<span class="builtintype" id="5126642">bool</span>&nbsp;<span class="op" id="5126647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126650">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126720">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126735">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5126787">return</span>&nbsp;<span class="string" id="5126794">&#39;a&#39;</span>&nbsp;<span class="op" id="5126798">&lt;=</span>&nbsp;<span class="ident" id="5126801">r</span>&nbsp;<span class="op" id="5126803">&amp;&amp;</span>&nbsp;<span class="ident" id="5126806">r</span>&nbsp;<span class="op" id="5126808">&lt;=</span>&nbsp;<span class="string" id="5126811">&#39;z&#39;</span>&nbsp;<span class="op" id="5126815">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5126820">&#39;A&#39;</span>&nbsp;<span class="op" id="5126824">&lt;=</span>&nbsp;<span class="ident" id="5126827">r</span>&nbsp;<span class="op" id="5126829">&amp;&amp;</span>&nbsp;<span class="ident" id="5126832">r</span>&nbsp;<span class="op" id="5126834">&lt;=</span>&nbsp;<span class="string" id="5126837">&#39;Z&#39;</span>&nbsp;<span class="op" id="5126841">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5126846">&#39;0&#39;</span>&nbsp;<span class="op" id="5126850">&lt;=</span>&nbsp;<span class="ident" id="5126853">r</span>&nbsp;<span class="op" id="5126855">&amp;&amp;</span>&nbsp;<span class="ident" id="5126858">r</span>&nbsp;<span class="op" id="5126860">&lt;=</span>&nbsp;<span class="string" id="5126863">&#39;9&#39;</span>&nbsp;<span class="op" id="5126867">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5126872">r</span>&nbsp;<span class="op" id="5126874">==</span>&nbsp;<span class="string" id="5126877">&#39;-&#39;</span>&nbsp;<span class="op" id="5126881">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5126886">r</span>&nbsp;<span class="op" id="5126888">==</span>&nbsp;<span class="string" id="5126891">&#39;_&#39;</span>&nbsp;<span class="op" id="5126895">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5126900">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5126928">0x80</span>&nbsp;<span class="op" id="5126933">&lt;=</span>&nbsp;<span class="ident" id="5126936">r</span>&nbsp;<span class="op" id="5126938">&amp;&amp;</span>&nbsp;<span class="ident" id="5126941">r</span>&nbsp;<span class="op" id="5126943">&lt;=</span>&nbsp;<span class="num" id="5126946">0xd7ff</span>&nbsp;<span class="op" id="5126953">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5126958">0xe000</span>&nbsp;<span class="op" id="5126965">&lt;=</span>&nbsp;<span class="ident" id="5126968">r</span>&nbsp;<span class="op" id="5126970">&amp;&amp;</span>&nbsp;<span class="ident" id="5126973">r</span>&nbsp;<span class="op" id="5126975">&lt;=</span>&nbsp;<span class="num" id="5126978">0xfffd</span>&nbsp;<span class="op" id="5126985">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="5126990">0x10000</span>&nbsp;<span class="op" id="5126998">&lt;=</span>&nbsp;<span class="ident" id="5127001">r</span>&nbsp;<span class="op" id="5127003">&amp;&amp;</span>&nbsp;<span class="ident" id="5127006">r</span>&nbsp;<span class="op" id="5127008">&lt;=</span>&nbsp;<span class="num" id="5127011">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="5127020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5127023">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="5127090">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="5127167">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="5127193">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="5127268">func</span>&nbsp;<span class="ident" id="5127273">decodeCSS</span><span class="op" id="5127282">(</span><span class="ident" id="5127283">s</span>&nbsp;<span class="op" id="5127285">[</span><span class="op" id="5127286">]</span><span class="builtintype" id="5127287">byte</span><span class="op" id="5127291">)</span>&nbsp;<span class="op" id="5127293">[</span><span class="op" id="5127294">]</span><span class="builtintype" id="5127295">byte</span>&nbsp;<span class="op" id="5127300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127303">i</span>&nbsp;<span class="op" id="5127305">:=</span>&nbsp;<span class="ident" id="5127308">bytes</span><span class="op" id="5127313">.</span><span class="ident" id="5127314">IndexByte</span><span class="op" id="5127323">(</span><span class="ident" id="5127324">s</span><span class="op" id="5127325">,</span>&nbsp;<span class="string" id="5127327">&#39;\\&#39;</span><span class="op" id="5127331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127334">if</span>&nbsp;<span class="ident" id="5127337">i</span>&nbsp;<span class="op" id="5127339">==</span>&nbsp;<span class="op" id="5127342">-</span><span class="num" id="5127343">1</span>&nbsp;<span class="op" id="5127345">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127349">return</span>&nbsp;<span class="ident" id="5127356">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127362">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127430">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127502">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127540">b</span>&nbsp;<span class="op" id="5127542">:=</span>&nbsp;<span class="builtinfunc" id="5127545">make</span><span class="op" id="5127549">(</span><span class="op" id="5127550">[</span><span class="op" id="5127551">]</span><span class="builtintype" id="5127552">byte</span><span class="op" id="5127556">,</span>&nbsp;<span class="num" id="5127558">0</span><span class="op" id="5127559">,</span>&nbsp;<span class="builtinfunc" id="5127561">len</span><span class="op" id="5127564">(</span><span class="ident" id="5127565">s</span><span class="op" id="5127566">)</span><span class="op" id="5127567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127570">for</span>&nbsp;<span class="builtinfunc" id="5127574">len</span><span class="op" id="5127577">(</span><span class="ident" id="5127578">s</span><span class="op" id="5127579">)</span>&nbsp;<span class="op" id="5127581">!=</span>&nbsp;<span class="num" id="5127584">0</span>&nbsp;<span class="op" id="5127586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127590">i</span>&nbsp;<span class="op" id="5127592">:=</span>&nbsp;<span class="ident" id="5127595">bytes</span><span class="op" id="5127600">.</span><span class="ident" id="5127601">IndexByte</span><span class="op" id="5127610">(</span><span class="ident" id="5127611">s</span><span class="op" id="5127612">,</span>&nbsp;<span class="string" id="5127614">&#39;\\&#39;</span><span class="op" id="5127618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127622">if</span>&nbsp;<span class="ident" id="5127625">i</span>&nbsp;<span class="op" id="5127627">==</span>&nbsp;<span class="op" id="5127630">-</span><span class="num" id="5127631">1</span>&nbsp;<span class="op" id="5127633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127638">i</span>&nbsp;<span class="op" id="5127640">=</span>&nbsp;<span class="builtinfunc" id="5127642">len</span><span class="op" id="5127645">(</span><span class="ident" id="5127646">s</span><span class="op" id="5127647">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127655">b</span><span class="op" id="5127656">,</span>&nbsp;<span class="ident" id="5127658">s</span>&nbsp;<span class="op" id="5127660">=</span>&nbsp;<span class="builtinfunc" id="5127662">append</span><span class="op" id="5127668">(</span><span class="ident" id="5127669">b</span><span class="op" id="5127670">,</span>&nbsp;<span class="ident" id="5127672">s</span><span class="op" id="5127673">[</span><span class="op" id="5127674">:</span><span class="ident" id="5127675">i</span><span class="op" id="5127676">]</span><span class="op" id="5127677">...</span><span class="op" id="5127680">)</span><span class="op" id="5127681">,</span>&nbsp;<span class="ident" id="5127683">s</span><span class="op" id="5127684">[</span><span class="ident" id="5127685">i</span><span class="op" id="5127686">:</span><span class="op" id="5127687">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127691">if</span>&nbsp;<span class="builtinfunc" id="5127694">len</span><span class="op" id="5127697">(</span><span class="ident" id="5127698">s</span><span class="op" id="5127699">)</span>&nbsp;<span class="op" id="5127701">&lt;</span>&nbsp;<span class="num" id="5127703">2</span>&nbsp;<span class="op" id="5127705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127710">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127718">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127722">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127775">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127857">if</span>&nbsp;<span class="ident" id="5127860">isHex</span><span class="op" id="5127865">(</span><span class="ident" id="5127866">s</span><span class="op" id="5127867">[</span><span class="num" id="5127868">1</span><span class="op" id="5127869">]</span><span class="op" id="5127870">)</span>&nbsp;<span class="op" id="5127872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127877">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5127932">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127977">j</span>&nbsp;<span class="op" id="5127979">:=</span>&nbsp;<span class="num" id="5127982">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5127987">for</span>&nbsp;<span class="ident" id="5127991">j</span>&nbsp;<span class="op" id="5127993">&lt;</span>&nbsp;<span class="builtinfunc" id="5127995">len</span><span class="op" id="5127998">(</span><span class="ident" id="5127999">s</span><span class="op" id="5128000">)</span>&nbsp;<span class="op" id="5128002">&amp;&amp;</span>&nbsp;<span class="ident" id="5128005">j</span>&nbsp;<span class="op" id="5128007">&lt;</span>&nbsp;<span class="num" id="5128009">7</span>&nbsp;<span class="op" id="5128011">&amp;&amp;</span>&nbsp;<span class="ident" id="5128014">isHex</span><span class="op" id="5128019">(</span><span class="ident" id="5128020">s</span><span class="op" id="5128021">[</span><span class="ident" id="5128022">j</span><span class="op" id="5128023">]</span><span class="op" id="5128024">)</span>&nbsp;<span class="op" id="5128026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128032">j</span><span class="op" id="5128033">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128044">r</span>&nbsp;<span class="op" id="5128046">:=</span>&nbsp;<span class="ident" id="5128049">hexDecode</span><span class="op" id="5128058">(</span><span class="ident" id="5128059">s</span><span class="op" id="5128060">[</span><span class="num" id="5128061">1</span><span class="op" id="5128062">:</span><span class="ident" id="5128063">j</span><span class="op" id="5128064">]</span><span class="op" id="5128065">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128070">if</span>&nbsp;<span class="ident" id="5128073">r</span>&nbsp;<span class="op" id="5128075">&gt;</span>&nbsp;<span class="ident" id="5128077">unicode</span><span class="op" id="5128084">.</span><span class="ident" id="5128085">MaxRune</span>&nbsp;<span class="op" id="5128093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128099">r</span><span class="op" id="5128100">,</span>&nbsp;<span class="ident" id="5128102">j</span>&nbsp;<span class="op" id="5128104">=</span>&nbsp;<span class="ident" id="5128106">r</span><span class="op" id="5128107">/</span><span class="num" id="5128108">16</span><span class="op" id="5128110">,</span>&nbsp;<span class="ident" id="5128112">j</span><span class="op" id="5128113">-</span><span class="num" id="5128114">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128124">n</span>&nbsp;<span class="op" id="5128126">:=</span>&nbsp;<span class="ident" id="5128129">utf8</span><span class="op" id="5128133">.</span><span class="ident" id="5128134">EncodeRune</span><span class="op" id="5128144">(</span><span class="ident" id="5128145">b</span><span class="op" id="5128146">[</span><span class="builtinfunc" id="5128147">len</span><span class="op" id="5128150">(</span><span class="ident" id="5128151">b</span><span class="op" id="5128152">)</span><span class="op" id="5128153">:</span><span class="builtinfunc" id="5128154">cap</span><span class="op" id="5128157">(</span><span class="ident" id="5128158">b</span><span class="op" id="5128159">)</span><span class="op" id="5128160">]</span><span class="op" id="5128161">,</span>&nbsp;<span class="ident" id="5128163">r</span><span class="op" id="5128164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5128169">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5128218">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5128266">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128315">b</span><span class="op" id="5128316">,</span>&nbsp;<span class="ident" id="5128318">s</span>&nbsp;<span class="op" id="5128320">=</span>&nbsp;<span class="ident" id="5128322">b</span><span class="op" id="5128323">[</span><span class="op" id="5128324">:</span><span class="builtinfunc" id="5128325">len</span><span class="op" id="5128328">(</span><span class="ident" id="5128329">b</span><span class="op" id="5128330">)</span><span class="op" id="5128331">+</span><span class="ident" id="5128332">n</span><span class="op" id="5128333">]</span><span class="op" id="5128334">,</span>&nbsp;<span class="ident" id="5128336">skipCSSSpace</span><span class="op" id="5128348">(</span><span class="ident" id="5128349">s</span><span class="op" id="5128350">[</span><span class="ident" id="5128351">j</span><span class="op" id="5128352">:</span><span class="op" id="5128353">]</span><span class="op" id="5128354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128358">}</span>&nbsp;<span class="keyword" id="5128360">else</span>&nbsp;<span class="op" id="5128365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5128370">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128413">_</span><span class="op" id="5128414">,</span>&nbsp;<span class="ident" id="5128416">n</span>&nbsp;<span class="op" id="5128418">:=</span>&nbsp;<span class="ident" id="5128421">utf8</span><span class="op" id="5128425">.</span><span class="ident" id="5128426">DecodeRune</span><span class="op" id="5128436">(</span><span class="ident" id="5128437">s</span><span class="op" id="5128438">[</span><span class="num" id="5128439">1</span><span class="op" id="5128440">:</span><span class="op" id="5128441">]</span><span class="op" id="5128442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128447">b</span><span class="op" id="5128448">,</span>&nbsp;<span class="ident" id="5128450">s</span>&nbsp;<span class="op" id="5128452">=</span>&nbsp;<span class="builtinfunc" id="5128454">append</span><span class="op" id="5128460">(</span><span class="ident" id="5128461">b</span><span class="op" id="5128462">,</span>&nbsp;<span class="ident" id="5128464">s</span><span class="op" id="5128465">[</span><span class="num" id="5128466">1</span><span class="op" id="5128467">:</span><span class="num" id="5128468">1</span><span class="op" id="5128469">+</span><span class="ident" id="5128470">n</span><span class="op" id="5128471">]</span><span class="op" id="5128472">...</span><span class="op" id="5128475">)</span><span class="op" id="5128476">,</span>&nbsp;<span class="ident" id="5128478">s</span><span class="op" id="5128479">[</span><span class="num" id="5128480">1</span><span class="op" id="5128481">+</span><span class="ident" id="5128482">n</span><span class="op" id="5128483">:</span><span class="op" id="5128484">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5128491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128494">return</span>&nbsp;<span class="ident" id="5128501">b</span><br>
<span class="lineno">100</span><span class="op" id="5128503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5128506">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="5128567">func</span>&nbsp;<span class="ident" id="5128572">isHex</span><span class="op" id="5128577">(</span><span class="ident" id="5128578">c</span>&nbsp;<span class="builtintype" id="5128580">byte</span><span class="op" id="5128584">)</span>&nbsp;<span class="builtintype" id="5128586">bool</span>&nbsp;<span class="op" id="5128591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128594">return</span>&nbsp;<span class="string" id="5128601">&#39;0&#39;</span>&nbsp;<span class="op" id="5128605">&lt;=</span>&nbsp;<span class="ident" id="5128608">c</span>&nbsp;<span class="op" id="5128610">&amp;&amp;</span>&nbsp;<span class="ident" id="5128613">c</span>&nbsp;<span class="op" id="5128615">&lt;=</span>&nbsp;<span class="string" id="5128618">&#39;9&#39;</span>&nbsp;<span class="op" id="5128622">||</span>&nbsp;<span class="string" id="5128625">&#39;a&#39;</span>&nbsp;<span class="op" id="5128629">&lt;=</span>&nbsp;<span class="ident" id="5128632">c</span>&nbsp;<span class="op" id="5128634">&amp;&amp;</span>&nbsp;<span class="ident" id="5128637">c</span>&nbsp;<span class="op" id="5128639">&lt;=</span>&nbsp;<span class="string" id="5128642">&#39;f&#39;</span>&nbsp;<span class="op" id="5128646">||</span>&nbsp;<span class="string" id="5128649">&#39;A&#39;</span>&nbsp;<span class="op" id="5128653">&lt;=</span>&nbsp;<span class="ident" id="5128656">c</span>&nbsp;<span class="op" id="5128658">&amp;&amp;</span>&nbsp;<span class="ident" id="5128661">c</span>&nbsp;<span class="op" id="5128663">&lt;=</span>&nbsp;<span class="string" id="5128666">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="5128670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5128673">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5128734">func</span>&nbsp;<span class="ident" id="5128739">hexDecode</span><span class="op" id="5128748">(</span><span class="ident" id="5128749">s</span>&nbsp;<span class="op" id="5128751">[</span><span class="op" id="5128752">]</span><span class="builtintype" id="5128753">byte</span><span class="op" id="5128757">)</span>&nbsp;<span class="builtintype" id="5128759">rune</span>&nbsp;<span class="op" id="5128764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128767">n</span>&nbsp;<span class="op" id="5128769">:=</span>&nbsp;<span class="string" id="5128772">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128780">for</span>&nbsp;<span class="ident" id="5128784">_</span><span class="op" id="5128785">,</span>&nbsp;<span class="ident" id="5128787">c</span>&nbsp;<span class="op" id="5128789">:=</span>&nbsp;<span class="keyword" id="5128792">range</span>&nbsp;<span class="ident" id="5128798">s</span>&nbsp;<span class="op" id="5128800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128804">n</span>&nbsp;<span class="op" id="5128806">&lt;&lt;=</span>&nbsp;<span class="num" id="5128810">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128814">switch</span>&nbsp;<span class="op" id="5128821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128825">case</span>&nbsp;<span class="string" id="5128830">&#39;0&#39;</span>&nbsp;<span class="op" id="5128834">&lt;=</span>&nbsp;<span class="ident" id="5128837">c</span>&nbsp;<span class="op" id="5128839">&amp;&amp;</span>&nbsp;<span class="ident" id="5128842">c</span>&nbsp;<span class="op" id="5128844">&lt;=</span>&nbsp;<span class="string" id="5128847">&#39;9&#39;</span><span class="op" id="5128850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128855">n</span>&nbsp;<span class="op" id="5128857">|=</span>&nbsp;<span class="builtintype" id="5128860">rune</span><span class="op" id="5128864">(</span><span class="ident" id="5128865">c</span>&nbsp;<span class="op" id="5128867">-</span>&nbsp;<span class="string" id="5128869">&#39;0&#39;</span><span class="op" id="5128872">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128876">case</span>&nbsp;<span class="string" id="5128881">&#39;a&#39;</span>&nbsp;<span class="op" id="5128885">&lt;=</span>&nbsp;<span class="ident" id="5128888">c</span>&nbsp;<span class="op" id="5128890">&amp;&amp;</span>&nbsp;<span class="ident" id="5128893">c</span>&nbsp;<span class="op" id="5128895">&lt;=</span>&nbsp;<span class="string" id="5128898">&#39;f&#39;</span><span class="op" id="5128901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128906">n</span>&nbsp;<span class="op" id="5128908">|=</span>&nbsp;<span class="builtintype" id="5128911">rune</span><span class="op" id="5128915">(</span><span class="ident" id="5128916">c</span><span class="op" id="5128917">-</span><span class="string" id="5128918">&#39;a&#39;</span><span class="op" id="5128921">)</span>&nbsp;<span class="op" id="5128923">+</span>&nbsp;<span class="num" id="5128925">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128930">case</span>&nbsp;<span class="string" id="5128935">&#39;A&#39;</span>&nbsp;<span class="op" id="5128939">&lt;=</span>&nbsp;<span class="ident" id="5128942">c</span>&nbsp;<span class="op" id="5128944">&amp;&amp;</span>&nbsp;<span class="ident" id="5128947">c</span>&nbsp;<span class="op" id="5128949">&lt;=</span>&nbsp;<span class="string" id="5128952">&#39;F&#39;</span><span class="op" id="5128955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5128960">n</span>&nbsp;<span class="op" id="5128962">|=</span>&nbsp;<span class="builtintype" id="5128965">rune</span><span class="op" id="5128969">(</span><span class="ident" id="5128970">c</span><span class="op" id="5128971">-</span><span class="string" id="5128972">&#39;A&#39;</span><span class="op" id="5128975">)</span>&nbsp;<span class="op" id="5128977">+</span>&nbsp;<span class="num" id="5128979">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5128984">default</span><span class="op" id="5128991">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5128996">panic</span><span class="op" id="5129001">(</span><span class="ident" id="5129002">fmt</span><span class="op" id="5129005">.</span><span class="ident" id="5129006">Sprintf</span><span class="op" id="5129013">(</span><span class="string" id="5129014">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="5129035">,</span>&nbsp;<span class="ident" id="5129037">s</span><span class="op" id="5129038">)</span><span class="op" id="5129039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129049">return</span>&nbsp;<span class="ident" id="5129056">n</span><br>
<span class="lineno"></span><span class="op" id="5129058">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5129061">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5129130">func</span>&nbsp;<span class="ident" id="5129135">skipCSSSpace</span><span class="op" id="5129147">(</span><span class="ident" id="5129148">c</span>&nbsp;<span class="op" id="5129150">[</span><span class="op" id="5129151">]</span><span class="builtintype" id="5129152">byte</span><span class="op" id="5129156">)</span>&nbsp;<span class="op" id="5129158">[</span><span class="op" id="5129159">]</span><span class="builtintype" id="5129160">byte</span>&nbsp;<span class="op" id="5129165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129168">if</span>&nbsp;<span class="builtinfunc" id="5129171">len</span><span class="op" id="5129174">(</span><span class="ident" id="5129175">c</span><span class="op" id="5129176">)</span>&nbsp;<span class="op" id="5129178">==</span>&nbsp;<span class="num" id="5129181">0</span>&nbsp;<span class="op" id="5129183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129187">return</span>&nbsp;<span class="ident" id="5129194">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129200">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129240">switch</span>&nbsp;<span class="ident" id="5129247">c</span><span class="op" id="5129248">[</span><span class="num" id="5129249">0</span><span class="op" id="5129250">]</span>&nbsp;<span class="op" id="5129252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129255">case</span>&nbsp;<span class="string" id="5129260">&#39;\t&#39;</span><span class="op" id="5129264">,</span>&nbsp;<span class="string" id="5129266">&#39;\n&#39;</span><span class="op" id="5129270">,</span>&nbsp;<span class="string" id="5129272">&#39;\f&#39;</span><span class="op" id="5129276">,</span>&nbsp;<span class="string" id="5129278">&#39;&nbsp;&#39;</span><span class="op" id="5129281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129285">return</span>&nbsp;<span class="ident" id="5129292">c</span><span class="op" id="5129293">[</span><span class="num" id="5129294">1</span><span class="op" id="5129295">:</span><span class="op" id="5129296">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129299">case</span>&nbsp;<span class="string" id="5129304">&#39;\r&#39;</span><span class="op" id="5129308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129312">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129378">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5129443">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129488">if</span>&nbsp;<span class="builtinfunc" id="5129491">len</span><span class="op" id="5129494">(</span><span class="ident" id="5129495">c</span><span class="op" id="5129496">)</span>&nbsp;<span class="op" id="5129498">&gt;=</span>&nbsp;<span class="num" id="5129501">2</span>&nbsp;<span class="op" id="5129503">&amp;&amp;</span>&nbsp;<span class="ident" id="5129506">c</span><span class="op" id="5129507">[</span><span class="num" id="5129508">1</span><span class="op" id="5129509">]</span>&nbsp;<span class="op" id="5129511">==</span>&nbsp;<span class="string" id="5129514">&#39;\n&#39;</span>&nbsp;<span class="op" id="5129519">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129524">return</span>&nbsp;<span class="ident" id="5129531">c</span><span class="op" id="5129532">[</span><span class="num" id="5129533">2</span><span class="op" id="5129534">:</span><span class="op" id="5129535">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129543">return</span>&nbsp;<span class="ident" id="5129550">c</span><span class="op" id="5129551">[</span><span class="num" id="5129552">1</span><span class="op" id="5129553">:</span><span class="op" id="5129554">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129560">return</span>&nbsp;<span class="ident" id="5129567">c</span><br>
<span class="lineno">145</span><span class="op" id="5129569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5129572">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="5129642">func</span>&nbsp;<span class="ident" id="5129647">isCSSSpace</span><span class="op" id="5129657">(</span><span class="ident" id="5129658">b</span>&nbsp;<span class="builtintype" id="5129660">byte</span><span class="op" id="5129664">)</span>&nbsp;<span class="builtintype" id="5129666">bool</span>&nbsp;<span class="op" id="5129671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129674">switch</span>&nbsp;<span class="ident" id="5129681">b</span>&nbsp;<span class="op" id="5129683">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129686">case</span>&nbsp;<span class="string" id="5129691">&#39;\t&#39;</span><span class="op" id="5129695">,</span>&nbsp;<span class="string" id="5129697">&#39;\n&#39;</span><span class="op" id="5129701">,</span>&nbsp;<span class="string" id="5129703">&#39;\f&#39;</span><span class="op" id="5129707">,</span>&nbsp;<span class="string" id="5129709">&#39;\r&#39;</span><span class="op" id="5129713">,</span>&nbsp;<span class="string" id="5129715">&#39;&nbsp;&#39;</span><span class="op" id="5129718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129722">return</span>&nbsp;<span class="builtintype" id="5129729">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5129735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129738">return</span>&nbsp;<span class="builtintype" id="5129745">false</span><br>
<span class="lineno"></span><span class="op" id="5129751">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5129754">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="5129831">func</span>&nbsp;<span class="ident" id="5129836">cssEscaper</span><span class="op" id="5129846">(</span><span class="ident" id="5129847">args</span>&nbsp;<span class="op" id="5129852">...</span><span class="keyword" id="5129855">interface</span><span class="op" id="5129864">{</span><span class="op" id="5129865">}</span><span class="op" id="5129866">)</span>&nbsp;<span class="builtintype" id="5129868">string</span>&nbsp;<span class="op" id="5129875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129878">s</span><span class="op" id="5129879">,</span>&nbsp;<span class="ident" id="5129881">_</span>&nbsp;<span class="op" id="5129883">:=</span>&nbsp;<span class="ident" id="5129886">stringify</span><span class="op" id="5129895">(</span><span class="ident" id="5129896">args</span><span class="op" id="5129900">...</span><span class="op" id="5129903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129906">var</span>&nbsp;<span class="ident" id="5129910">b</span>&nbsp;<span class="ident" id="5129912">bytes</span><span class="op" id="5129917">.</span><span class="ident" id="5129918">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5129926">written</span>&nbsp;<span class="op" id="5129934">:=</span>&nbsp;<span class="num" id="5129937">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129940">for</span>&nbsp;<span class="ident" id="5129944">i</span><span class="op" id="5129945">,</span>&nbsp;<span class="ident" id="5129947">r</span>&nbsp;<span class="op" id="5129949">:=</span>&nbsp;<span class="keyword" id="5129952">range</span>&nbsp;<span class="ident" id="5129958">s</span>&nbsp;<span class="op" id="5129960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129964">var</span>&nbsp;<span class="ident" id="5129968">repl</span>&nbsp;<span class="builtintype" id="5129973">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129982">switch</span>&nbsp;<span class="ident" id="5129989">r</span>&nbsp;<span class="op" id="5129991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5129995">case</span>&nbsp;<span class="num" id="5130000">0</span><span class="op" id="5130001">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130006">repl</span>&nbsp;<span class="op" id="5130011">=</span>&nbsp;<span class="string" id="5130013">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130020">case</span>&nbsp;<span class="string" id="5130025">&#39;\t&#39;</span><span class="op" id="5130029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130034">repl</span>&nbsp;<span class="op" id="5130039">=</span>&nbsp;<span class="string" id="5130041">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130048">case</span>&nbsp;<span class="string" id="5130053">&#39;\n&#39;</span><span class="op" id="5130057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130062">repl</span>&nbsp;<span class="op" id="5130067">=</span>&nbsp;<span class="string" id="5130069">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130076">case</span>&nbsp;<span class="string" id="5130081">&#39;\f&#39;</span><span class="op" id="5130085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130090">repl</span>&nbsp;<span class="op" id="5130095">=</span>&nbsp;<span class="string" id="5130097">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130104">case</span>&nbsp;<span class="string" id="5130109">&#39;\r&#39;</span><span class="op" id="5130113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130118">repl</span>&nbsp;<span class="op" id="5130123">=</span>&nbsp;<span class="string" id="5130125">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130132">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5130195">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130245">case</span>&nbsp;<span class="string" id="5130250">&#39;&#34;&#39;</span><span class="op" id="5130253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130258">repl</span>&nbsp;<span class="op" id="5130263">=</span>&nbsp;<span class="string" id="5130265">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130273">case</span>&nbsp;<span class="string" id="5130278">&#39;&amp;&#39;</span><span class="op" id="5130281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130286">repl</span>&nbsp;<span class="op" id="5130291">=</span>&nbsp;<span class="string" id="5130293">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130301">case</span>&nbsp;<span class="string" id="5130306">&#39;\&#39;&#39;</span><span class="op" id="5130310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130315">repl</span>&nbsp;<span class="op" id="5130320">=</span>&nbsp;<span class="string" id="5130322">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130330">case</span>&nbsp;<span class="string" id="5130335">&#39;(&#39;</span><span class="op" id="5130338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130343">repl</span>&nbsp;<span class="op" id="5130348">=</span>&nbsp;<span class="string" id="5130350">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130358">case</span>&nbsp;<span class="string" id="5130363">&#39;)&#39;</span><span class="op" id="5130366">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130371">repl</span>&nbsp;<span class="op" id="5130376">=</span>&nbsp;<span class="string" id="5130378">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130386">case</span>&nbsp;<span class="string" id="5130391">&#39;+&#39;</span><span class="op" id="5130394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130399">repl</span>&nbsp;<span class="op" id="5130404">=</span>&nbsp;<span class="string" id="5130406">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130414">case</span>&nbsp;<span class="string" id="5130419">&#39;/&#39;</span><span class="op" id="5130422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130427">repl</span>&nbsp;<span class="op" id="5130432">=</span>&nbsp;<span class="string" id="5130434">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130442">case</span>&nbsp;<span class="string" id="5130447">&#39;:&#39;</span><span class="op" id="5130450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130455">repl</span>&nbsp;<span class="op" id="5130460">=</span>&nbsp;<span class="string" id="5130462">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130470">case</span>&nbsp;<span class="string" id="5130475">&#39;;&#39;</span><span class="op" id="5130478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130483">repl</span>&nbsp;<span class="op" id="5130488">=</span>&nbsp;<span class="string" id="5130490">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130498">case</span>&nbsp;<span class="string" id="5130503">&#39;&lt;&#39;</span><span class="op" id="5130506">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130511">repl</span>&nbsp;<span class="op" id="5130516">=</span>&nbsp;<span class="string" id="5130518">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130526">case</span>&nbsp;<span class="string" id="5130531">&#39;&gt;&#39;</span><span class="op" id="5130534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130539">repl</span>&nbsp;<span class="op" id="5130544">=</span>&nbsp;<span class="string" id="5130546">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130554">case</span>&nbsp;<span class="string" id="5130559">&#39;\\&#39;</span><span class="op" id="5130563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130568">repl</span>&nbsp;<span class="op" id="5130573">=</span>&nbsp;<span class="string" id="5130575">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130582">case</span>&nbsp;<span class="string" id="5130587">&#39;{&#39;</span><span class="op" id="5130590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130595">repl</span>&nbsp;<span class="op" id="5130600">=</span>&nbsp;<span class="string" id="5130602">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130610">case</span>&nbsp;<span class="string" id="5130615">&#39;}&#39;</span><span class="op" id="5130618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130623">repl</span>&nbsp;<span class="op" id="5130628">=</span>&nbsp;<span class="string" id="5130630">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130638">default</span><span class="op" id="5130645">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130650">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130665">b</span><span class="op" id="5130666">.</span><span class="ident" id="5130667">WriteString</span><span class="op" id="5130678">(</span><span class="ident" id="5130679">s</span><span class="op" id="5130680">[</span><span class="ident" id="5130681">written</span><span class="op" id="5130688">:</span><span class="ident" id="5130689">i</span><span class="op" id="5130690">]</span><span class="op" id="5130691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130695">b</span><span class="op" id="5130696">.</span><span class="ident" id="5130697">WriteString</span><span class="op" id="5130708">(</span><span class="ident" id="5130709">repl</span><span class="op" id="5130713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130717">written</span>&nbsp;<span class="op" id="5130725">=</span>&nbsp;<span class="ident" id="5130727">i</span>&nbsp;<span class="op" id="5130729">+</span>&nbsp;<span class="ident" id="5130731">utf8</span><span class="op" id="5130735">.</span><span class="ident" id="5130736">RuneLen</span><span class="op" id="5130743">(</span><span class="ident" id="5130744">r</span><span class="op" id="5130745">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130749">if</span>&nbsp;<span class="ident" id="5130752">repl</span>&nbsp;<span class="op" id="5130757">!=</span>&nbsp;<span class="string" id="5130760">`\\`</span>&nbsp;<span class="op" id="5130765">&amp;&amp;</span>&nbsp;<span class="op" id="5130768">(</span><span class="ident" id="5130769">written</span>&nbsp;<span class="op" id="5130777">==</span>&nbsp;<span class="builtinfunc" id="5130780">len</span><span class="op" id="5130783">(</span><span class="ident" id="5130784">s</span><span class="op" id="5130785">)</span>&nbsp;<span class="op" id="5130787">||</span>&nbsp;<span class="ident" id="5130790">isHex</span><span class="op" id="5130795">(</span><span class="ident" id="5130796">s</span><span class="op" id="5130797">[</span><span class="ident" id="5130798">written</span><span class="op" id="5130805">]</span><span class="op" id="5130806">)</span>&nbsp;<span class="op" id="5130808">||</span>&nbsp;<span class="ident" id="5130811">isCSSSpace</span><span class="op" id="5130821">(</span><span class="ident" id="5130822">s</span><span class="op" id="5130823">[</span><span class="ident" id="5130824">written</span><span class="op" id="5130831">]</span><span class="op" id="5130832">)</span><span class="op" id="5130833">)</span>&nbsp;<span class="op" id="5130835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130840">b</span><span class="op" id="5130841">.</span><span class="ident" id="5130842">WriteByte</span><span class="op" id="5130851">(</span><span class="string" id="5130852">&#39;&nbsp;&#39;</span><span class="op" id="5130855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130865">if</span>&nbsp;<span class="ident" id="5130868">written</span>&nbsp;<span class="op" id="5130876">==</span>&nbsp;<span class="num" id="5130879">0</span>&nbsp;<span class="op" id="5130881">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130885">return</span>&nbsp;<span class="ident" id="5130892">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5130895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5130898">b</span><span class="op" id="5130899">.</span><span class="ident" id="5130900">WriteString</span><span class="op" id="5130911">(</span><span class="ident" id="5130912">s</span><span class="op" id="5130913">[</span><span class="ident" id="5130914">written</span><span class="op" id="5130921">:</span><span class="op" id="5130922">]</span><span class="op" id="5130923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5130926">return</span>&nbsp;<span class="ident" id="5130933">b</span><span class="op" id="5130934">.</span><span class="ident" id="5130935">String</span><span class="op" id="5130941">(</span><span class="op" id="5130942">)</span><br>
<span class="lineno"></span><span class="op" id="5130944">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="5130947">var</span>&nbsp;<span class="ident" id="5130951">expressionBytes</span>&nbsp;<span class="op" id="5130967">=</span>&nbsp;<span class="op" id="5130969">[</span><span class="op" id="5130970">]</span><span class="builtintype" id="5130971">byte</span><span class="op" id="5130975">(</span><span class="string" id="5130976">&#34;expression&#34;</span><span class="op" id="5130988">)</span><br>
<span class="lineno"></span><span class="keyword" id="5130990">var</span>&nbsp;<span class="ident" id="5130994">mozBindingBytes</span>&nbsp;<span class="op" id="5131010">=</span>&nbsp;<span class="op" id="5131012">[</span><span class="op" id="5131013">]</span><span class="builtintype" id="5131014">byte</span><span class="op" id="5131018">(</span><span class="string" id="5131019">&#34;mozbinding&#34;</span><span class="op" id="5131031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5131034">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="5131108">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5131187">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="5131226">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="5131303">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="5131347">func</span>&nbsp;<span class="ident" id="5131352">cssValueFilter</span><span class="op" id="5131366">(</span><span class="ident" id="5131367">args</span>&nbsp;<span class="op" id="5131372">...</span><span class="keyword" id="5131375">interface</span><span class="op" id="5131384">{</span><span class="op" id="5131385">}</span><span class="op" id="5131386">)</span>&nbsp;<span class="builtintype" id="5131388">string</span>&nbsp;<span class="op" id="5131395">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131398">s</span><span class="op" id="5131399">,</span>&nbsp;<span class="ident" id="5131401">t</span>&nbsp;<span class="op" id="5131403">:=</span>&nbsp;<span class="ident" id="5131406">stringify</span><span class="op" id="5131415">(</span><span class="ident" id="5131416">args</span><span class="op" id="5131420">...</span><span class="op" id="5131423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5131426">if</span>&nbsp;<span class="ident" id="5131429">t</span>&nbsp;<span class="op" id="5131431">==</span>&nbsp;<span class="ident" id="5131434">contentTypeCSS</span>&nbsp;<span class="op" id="5131449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5131453">return</span>&nbsp;<span class="ident" id="5131460">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5131463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5131466">b</span><span class="op" id="5131467">,</span>&nbsp;<span class="ident" id="5131469">id</span>&nbsp;<span class="op" id="5131472">:=</span>&nbsp;<span class="ident" id="5131475">decodeCSS</span><span class="op" id="5131484">(</span><span class="op" id="5131485">[</span><span class="op" id="5131486">]</span><span class="builtintype" id="5131487">byte</span><span class="op" id="5131491">(</span><span class="ident" id="5131492">s</span><span class="op" id="5131493">)</span><span class="op" id="5131494">)</span><span class="op" id="5131495">,</span>&nbsp;<span class="builtinfunc" id="5131497">make</span><span class="op" id="5131501">(</span><span class="op" id="5131502">[</span><span class="op" id="5131503">]</span><span class="builtintype" id="5131504">byte</span><span class="op" id="5131508">,</span>&nbsp;<span class="num" id="5131510">0</span><span class="op" id="5131511">,</span>&nbsp;<span class="num" id="5131513">64</span><span class="op" id="5131515">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131519">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131590">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131645">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131712">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131850">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131923">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5131994">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132032">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132103">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132174">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132230">for</span>&nbsp;<span class="ident" id="5132234">i</span><span class="op" id="5132235">,</span>&nbsp;<span class="ident" id="5132237">c</span>&nbsp;<span class="op" id="5132239">:=</span>&nbsp;<span class="keyword" id="5132242">range</span>&nbsp;<span class="ident" id="5132248">b</span>&nbsp;<span class="op" id="5132250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132254">switch</span>&nbsp;<span class="ident" id="5132261">c</span>&nbsp;<span class="op" id="5132263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132267">case</span>&nbsp;<span class="num" id="5132272">0</span><span class="op" id="5132273">,</span>&nbsp;<span class="string" id="5132275">&#39;&#34;&#39;</span><span class="op" id="5132278">,</span>&nbsp;<span class="string" id="5132280">&#39;\&#39;&#39;</span><span class="op" id="5132284">,</span>&nbsp;<span class="string" id="5132286">&#39;(&#39;</span><span class="op" id="5132289">,</span>&nbsp;<span class="string" id="5132291">&#39;)&#39;</span><span class="op" id="5132294">,</span>&nbsp;<span class="string" id="5132296">&#39;/&#39;</span><span class="op" id="5132299">,</span>&nbsp;<span class="string" id="5132301">&#39;;&#39;</span><span class="op" id="5132304">,</span>&nbsp;<span class="string" id="5132306">&#39;@&#39;</span><span class="op" id="5132309">,</span>&nbsp;<span class="string" id="5132311">&#39;[&#39;</span><span class="op" id="5132314">,</span>&nbsp;<span class="string" id="5132316">&#39;\\&#39;</span><span class="op" id="5132320">,</span>&nbsp;<span class="string" id="5132322">&#39;]&#39;</span><span class="op" id="5132325">,</span>&nbsp;<span class="string" id="5132327">&#39;`&#39;</span><span class="op" id="5132330">,</span>&nbsp;<span class="string" id="5132332">&#39;{&#39;</span><span class="op" id="5132335">,</span>&nbsp;<span class="string" id="5132337">&#39;}&#39;</span><span class="op" id="5132340">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132345">return</span>&nbsp;<span class="ident" id="5132352">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132369">case</span>&nbsp;<span class="string" id="5132374">&#39;-&#39;</span><span class="op" id="5132377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132382">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5132410">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132459">if</span>&nbsp;<span class="ident" id="5132462">i</span>&nbsp;<span class="op" id="5132464">!=</span>&nbsp;<span class="num" id="5132467">0</span>&nbsp;<span class="op" id="5132469">&amp;&amp;</span>&nbsp;<span class="ident" id="5132472">b</span><span class="op" id="5132473">[</span><span class="ident" id="5132474">i</span><span class="op" id="5132475">-</span><span class="num" id="5132476">1</span><span class="op" id="5132477">]</span>&nbsp;<span class="op" id="5132479">==</span>&nbsp;<span class="string" id="5132482">&#39;-&#39;</span>&nbsp;<span class="op" id="5132486">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132492">return</span>&nbsp;<span class="ident" id="5132499">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132521">default</span><span class="op" id="5132528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132533">if</span>&nbsp;<span class="ident" id="5132536">c</span>&nbsp;<span class="op" id="5132538">&lt;</span>&nbsp;<span class="num" id="5132540">0x80</span>&nbsp;<span class="op" id="5132545">&amp;&amp;</span>&nbsp;<span class="ident" id="5132548">isCSSNmchar</span><span class="op" id="5132559">(</span><span class="builtintype" id="5132560">rune</span><span class="op" id="5132564">(</span><span class="ident" id="5132565">c</span><span class="op" id="5132566">)</span><span class="op" id="5132567">)</span>&nbsp;<span class="op" id="5132569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132575">id</span>&nbsp;<span class="op" id="5132578">=</span>&nbsp;<span class="builtinfunc" id="5132580">append</span><span class="op" id="5132586">(</span><span class="ident" id="5132587">id</span><span class="op" id="5132589">,</span>&nbsp;<span class="ident" id="5132591">c</span><span class="op" id="5132592">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5132607">id</span>&nbsp;<span class="op" id="5132610">=</span>&nbsp;<span class="ident" id="5132612">bytes</span><span class="op" id="5132617">.</span><span class="ident" id="5132618">ToLower</span><span class="op" id="5132625">(</span><span class="ident" id="5132626">id</span><span class="op" id="5132628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132631">if</span>&nbsp;<span class="ident" id="5132634">bytes</span><span class="op" id="5132639">.</span><span class="ident" id="5132640">Index</span><span class="op" id="5132645">(</span><span class="ident" id="5132646">id</span><span class="op" id="5132648">,</span>&nbsp;<span class="ident" id="5132650">expressionBytes</span><span class="op" id="5132665">)</span>&nbsp;<span class="op" id="5132667">!=</span>&nbsp;<span class="op" id="5132670">-</span><span class="num" id="5132671">1</span>&nbsp;<span class="op" id="5132673">||</span>&nbsp;<span class="ident" id="5132676">bytes</span><span class="op" id="5132681">.</span><span class="ident" id="5132682">Index</span><span class="op" id="5132687">(</span><span class="ident" id="5132688">id</span><span class="op" id="5132690">,</span>&nbsp;<span class="ident" id="5132692">mozBindingBytes</span><span class="op" id="5132707">)</span>&nbsp;<span class="op" id="5132709">!=</span>&nbsp;<span class="op" id="5132712">-</span><span class="num" id="5132713">1</span>&nbsp;<span class="op" id="5132715">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132719">return</span>&nbsp;<span class="ident" id="5132726">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5132742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5132745">return</span>&nbsp;<span class="builtintype" id="5132752">string</span><span class="op" id="5132758">(</span><span class="ident" id="5132759">b</span><span class="op" id="5132760">)</span><br>
<span class="lineno"></span><span class="op" id="5132762">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
