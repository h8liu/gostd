<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp</h2>
<ul>
<li><a href="/gostd/regexp/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/regexp/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/regexp/exec.go.html">exec.go</a></li>
<li><a href="/gostd/regexp/exec2_test.go.html">exec2_test.go</a></li>
<li><a href="/gostd/regexp/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/regexp/find_test.go.html">find_test.go</a></li>
<li><a href="/gostd/regexp/onepass.go.html">onepass.go</a></li>
<li><a href="/gostd/regexp/onepass_test.go.html">onepass_test.go</a></li>
<li><a href="/gostd/regexp/regexp.go.html" class="current">regexp.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3418457">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3418512">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3418566">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3418617">//&nbsp;Package&nbsp;regexp&nbsp;implements&nbsp;regular&nbsp;expression&nbsp;search.</span><br>
<span class="lineno"></span><span class="comment" id="3418673">//</span><br>
<span class="lineno"></span><span class="comment" id="3418676">//&nbsp;The&nbsp;syntax&nbsp;of&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;accepted&nbsp;is&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="3418738">//&nbsp;general&nbsp;syntax&nbsp;used&nbsp;by&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;languages.</span><br>
<span class="lineno"></span><span class="comment" id="3418799">//&nbsp;More&nbsp;precisely,&nbsp;it&nbsp;is&nbsp;the&nbsp;syntax&nbsp;accepted&nbsp;by&nbsp;RE2&nbsp;and&nbsp;described&nbsp;at</span><br>
<span class="lineno">10</span><span class="comment" id="3418868">//&nbsp;http://code.google.com/p/re2/wiki/Syntax,&nbsp;except&nbsp;for&nbsp;\C.</span><br>
<span class="lineno"></span><span class="comment" id="3418928">//&nbsp;For&nbsp;an&nbsp;overview&nbsp;of&nbsp;the&nbsp;syntax,&nbsp;run</span><br>
<span class="lineno"></span><span class="comment" id="3418966">//&nbsp;&nbsp;&nbsp;godoc&nbsp;regexp/syntax</span><br>
<span class="lineno"></span><span class="comment" id="3418991">//</span><br>
<span class="lineno"></span><span class="comment" id="3418994">//&nbsp;The&nbsp;regexp&nbsp;implementation&nbsp;provided&nbsp;by&nbsp;this&nbsp;package&nbsp;is</span><br>
<span class="lineno">15</span><span class="comment" id="3419051">//&nbsp;guaranteed&nbsp;to&nbsp;run&nbsp;in&nbsp;time&nbsp;linear&nbsp;in&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3419113">//&nbsp;(This&nbsp;is&nbsp;a&nbsp;property&nbsp;not&nbsp;guaranteed&nbsp;by&nbsp;most&nbsp;open&nbsp;source</span><br>
<span class="lineno"></span><span class="comment" id="3419171">//&nbsp;implementations&nbsp;of&nbsp;regular&nbsp;expressions.)&nbsp;For&nbsp;more&nbsp;information</span><br>
<span class="lineno"></span><span class="comment" id="3419236">//&nbsp;about&nbsp;this&nbsp;property,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="3419264">//&nbsp;&nbsp;&nbsp;&nbsp;http://swtch.com/~rsc/regexp/regexp1.html</span><br>
<span class="lineno">20</span><span class="comment" id="3419309">//&nbsp;or&nbsp;any&nbsp;book&nbsp;about&nbsp;automata&nbsp;theory.</span><br>
<span class="lineno"></span><span class="comment" id="3419347">//</span><br>
<span class="lineno"></span><span class="comment" id="3419350">//&nbsp;All&nbsp;characters&nbsp;are&nbsp;UTF-8-encoded&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="3419399">//</span><br>
<span class="lineno"></span><span class="comment" id="3419402">//&nbsp;There&nbsp;are&nbsp;16&nbsp;methods&nbsp;of&nbsp;Regexp&nbsp;that&nbsp;match&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;identify</span><br>
<span class="lineno">25</span><span class="comment" id="3419481">//&nbsp;the&nbsp;matched&nbsp;text.&nbsp;&nbsp;Their&nbsp;names&nbsp;are&nbsp;matched&nbsp;by&nbsp;this&nbsp;regular&nbsp;expression:</span><br>
<span class="lineno"></span><span class="comment" id="3419555">//</span><br>
<span class="lineno"></span><span class="comment" id="3419558">//&nbsp;&nbsp;&nbsp;&nbsp;Find(All)?(String)?(Submatch)?(Index)?</span><br>
<span class="lineno"></span><span class="comment" id="3419600">//</span><br>
<span class="lineno"></span><span class="comment" id="3419603">//&nbsp;If&nbsp;&#39;All&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;routine&nbsp;matches&nbsp;successive&nbsp;non-overlapping</span><br>
<span class="lineno">30</span><span class="comment" id="3419674">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression.&nbsp;&nbsp;Empty&nbsp;matches&nbsp;abutting&nbsp;a&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="3419747">//&nbsp;match&nbsp;are&nbsp;ignored.&nbsp;&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;containing&nbsp;the&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="3419824">//&nbsp;return&nbsp;values&nbsp;of&nbsp;the&nbsp;corresponding&nbsp;non-&#39;All&#39;&nbsp;routine.&nbsp;&nbsp;These&nbsp;routines&nbsp;take</span><br>
<span class="lineno"></span><span class="comment" id="3419902">//&nbsp;an&nbsp;extra&nbsp;integer&nbsp;argument,&nbsp;n;&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;function&nbsp;returns&nbsp;at&nbsp;most&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="3419977">//&nbsp;matches/submatches.</span><br>
<span class="lineno">35</span><span class="comment" id="3420000">//</span><br>
<span class="lineno"></span><span class="comment" id="3420003">//&nbsp;If&nbsp;&#39;String&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;argument&nbsp;is&nbsp;a&nbsp;string;&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3420080">//&nbsp;of&nbsp;bytes;&nbsp;return&nbsp;values&nbsp;are&nbsp;adjusted&nbsp;as&nbsp;appropriate.</span><br>
<span class="lineno"></span><span class="comment" id="3420136">//</span><br>
<span class="lineno"></span><span class="comment" id="3420139">//&nbsp;If&nbsp;&#39;Submatch&#39;&nbsp;is&nbsp;present,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;a&nbsp;slice&nbsp;identifying&nbsp;the</span><br>
<span class="lineno">40</span><span class="comment" id="3420212">//&nbsp;successive&nbsp;submatches&nbsp;of&nbsp;the&nbsp;expression.&nbsp;Submatches&nbsp;are&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3420282">//&nbsp;parenthesized&nbsp;subexpressions&nbsp;(also&nbsp;known&nbsp;as&nbsp;capturing&nbsp;groups)&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3420358">//&nbsp;regular&nbsp;expression,&nbsp;numbered&nbsp;from&nbsp;left&nbsp;to&nbsp;right&nbsp;in&nbsp;order&nbsp;of&nbsp;opening</span><br>
<span class="lineno"></span><span class="comment" id="3420429">//&nbsp;parenthesis.&nbsp;Submatch&nbsp;0&nbsp;is&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire&nbsp;expression,&nbsp;submatch&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="3420506">//&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;first&nbsp;parenthesized&nbsp;subexpression,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">45</span><span class="comment" id="3420572">//</span><br>
<span class="lineno"></span><span class="comment" id="3420575">//&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;present,&nbsp;matches&nbsp;and&nbsp;submatches&nbsp;are&nbsp;identified&nbsp;by&nbsp;byte&nbsp;index</span><br>
<span class="lineno"></span><span class="comment" id="3420653">//&nbsp;pairs&nbsp;within&nbsp;the&nbsp;input&nbsp;string:&nbsp;result[2*n:2*n+1]&nbsp;identifies&nbsp;the&nbsp;indexes&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3420731">//&nbsp;the&nbsp;nth&nbsp;submatch.&nbsp;&nbsp;The&nbsp;pair&nbsp;for&nbsp;n==0&nbsp;identifies&nbsp;the&nbsp;match&nbsp;of&nbsp;the&nbsp;entire</span><br>
<span class="lineno"></span><span class="comment" id="3420806">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;&#39;Index&#39;&nbsp;is&nbsp;not&nbsp;present,&nbsp;the&nbsp;match&nbsp;is&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno">50</span><span class="comment" id="3420880">//&nbsp;text&nbsp;of&nbsp;the&nbsp;match/submatch.&nbsp;&nbsp;If&nbsp;an&nbsp;index&nbsp;is&nbsp;negative,&nbsp;it&nbsp;means&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3420951">//&nbsp;subexpression&nbsp;did&nbsp;not&nbsp;match&nbsp;any&nbsp;string&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3421007">//</span><br>
<span class="lineno"></span><span class="comment" id="3421010">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;subset&nbsp;of&nbsp;the&nbsp;methods&nbsp;that&nbsp;can&nbsp;be&nbsp;applied&nbsp;to&nbsp;text&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="3421084">//&nbsp;from&nbsp;a&nbsp;RuneReader:</span><br>
<span class="lineno">55</span><span class="comment" id="3421106">//</span><br>
<span class="lineno"></span><span class="comment" id="3421109">//&nbsp;&nbsp;&nbsp;&nbsp;MatchReader,&nbsp;FindReaderIndex,&nbsp;FindReaderSubmatchIndex</span><br>
<span class="lineno"></span><span class="comment" id="3421166">//</span><br>
<span class="lineno"></span><span class="comment" id="3421169">//&nbsp;This&nbsp;set&nbsp;may&nbsp;grow.&nbsp;&nbsp;Note&nbsp;that&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;may&nbsp;need&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3421241">//&nbsp;examine&nbsp;text&nbsp;beyond&nbsp;the&nbsp;text&nbsp;returned&nbsp;by&nbsp;a&nbsp;match,&nbsp;so&nbsp;the&nbsp;methods&nbsp;that</span><br>
<span class="lineno">60</span><span class="comment" id="3421314">//&nbsp;match&nbsp;text&nbsp;from&nbsp;a&nbsp;RuneReader&nbsp;may&nbsp;read&nbsp;arbitrarily&nbsp;far&nbsp;into&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3421386">//&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="comment" id="3421407">//</span><br>
<span class="lineno"></span><span class="comment" id="3421410">//&nbsp;(There&nbsp;are&nbsp;a&nbsp;few&nbsp;other&nbsp;methods&nbsp;that&nbsp;do&nbsp;not&nbsp;match&nbsp;this&nbsp;pattern.)</span><br>
<span class="lineno"></span><span class="comment" id="3421477">//</span><br>
<span class="lineno">65</span><span class="keyword" id="3421480">package</span>&nbsp;<span class="ident" id="3421488">regexp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421496">import</span>&nbsp;<span class="op" id="3421503">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421506">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421515">&#34;io&#34;</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421521">&#34;regexp/syntax&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421538">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421549">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421560">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421568">&#34;unicode&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3421579">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3421594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421597">var</span>&nbsp;<span class="ident" id="3421601">debug</span>&nbsp;<span class="op" id="3421607">=</span>&nbsp;<span class="builtintype" id="3421609">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3421616">//&nbsp;Regexp&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="3421682">//&nbsp;A&nbsp;Regexp&nbsp;is&nbsp;safe&nbsp;for&nbsp;concurrent&nbsp;use&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="keyword" id="3421745">type</span>&nbsp;<span class="ident" id="3421750">Regexp</span>&nbsp;<span class="keyword" id="3421757">struct</span>&nbsp;<span class="op" id="3421764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3421767">//&nbsp;read-only&nbsp;after&nbsp;Compile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421795">expr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3421810">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3421825">//&nbsp;as&nbsp;passed&nbsp;to&nbsp;Compile</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421850">prog</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421865">*</span><span class="ident" id="3421866">syntax</span><span class="op" id="3421872">.</span><span class="ident" id="3421873">Prog</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3421880">//&nbsp;compiled&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421901">onepass</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3421916">*</span><span class="ident" id="3421917">onePassProg</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3421931">//&nbsp;onpass&nbsp;program&nbsp;or&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3421957">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3421972">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3421987">//&nbsp;required&nbsp;prefix&nbsp;in&nbsp;unanchored&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422029">prefixBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422044">[</span><span class="op" id="3422045">]</span><span class="builtintype" id="3422046">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422059">//&nbsp;prefix,&nbsp;as&nbsp;a&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422083">prefixComplete</span>&nbsp;<span class="builtintype" id="3422098">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422113">//&nbsp;prefix&nbsp;is&nbsp;the&nbsp;entire&nbsp;regexp</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422145">prefixRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3422160">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422175">//&nbsp;first&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422200">prefixEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3422215">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422230">//&nbsp;pc&nbsp;for&nbsp;last&nbsp;rune&nbsp;in&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422261">cond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422276">syntax</span><span class="op" id="3422282">.</span><span class="ident" id="3422283">EmptyOp</span>&nbsp;<span class="comment" id="3422291">//&nbsp;empty-width&nbsp;conditions&nbsp;required&nbsp;at&nbsp;start&nbsp;of&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422345">numSubexp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3422360">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422365">subexpNames</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3422380">[</span><span class="op" id="3422381">]</span><span class="builtintype" id="3422382">string</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422390">longest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3422405">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3422412">//&nbsp;cache&nbsp;of&nbsp;machines&nbsp;for&nbsp;running&nbsp;regexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422453">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422461">sync</span><span class="op" id="3422465">.</span><span class="ident" id="3422466">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3422473">machine</span>&nbsp;<span class="op" id="3422481">[</span><span class="op" id="3422482">]</span><span class="op" id="3422483">*</span><span class="ident" id="3422484">machine</span><br>
<span class="lineno">100</span><span class="op" id="3422492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3422495">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;source&nbsp;text&nbsp;used&nbsp;to&nbsp;compile&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="3422569">func</span>&nbsp;<span class="op" id="3422574">(</span><span class="ident" id="3422575">re</span>&nbsp;<span class="op" id="3422578">*</span><span class="ident" id="3422579">Regexp</span><span class="op" id="3422585">)</span>&nbsp;<span class="ident" id="3422587">String</span><span class="op" id="3422593">(</span><span class="op" id="3422594">)</span>&nbsp;<span class="builtintype" id="3422596">string</span>&nbsp;<span class="op" id="3422603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3422606">return</span>&nbsp;<span class="ident" id="3422613">re</span><span class="op" id="3422615">.</span><span class="ident" id="3422616">expr</span><br>
<span class="lineno">105</span><span class="op" id="3422621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3422624">//&nbsp;Compile&nbsp;parses&nbsp;a&nbsp;regular&nbsp;expression&nbsp;and&nbsp;returns,&nbsp;if&nbsp;successful,</span><br>
<span class="lineno"></span><span class="comment" id="3422691">//&nbsp;a&nbsp;Regexp&nbsp;object&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;match&nbsp;against&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="3422750">//</span><br>
<span class="lineno">110</span><span class="comment" id="3422753">//&nbsp;When&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3422816">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3422888">//&nbsp;it&nbsp;chooses&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first.</span><br>
<span class="lineno"></span><span class="comment" id="3422961">//&nbsp;This&nbsp;so-called&nbsp;leftmost-first&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="3423025">//&nbsp;that&nbsp;Perl,&nbsp;Python,&nbsp;and&nbsp;other&nbsp;implementations&nbsp;use,&nbsp;although&nbsp;this</span><br>
<span class="lineno">115</span><span class="comment" id="3423092">//&nbsp;package&nbsp;implements&nbsp;it&nbsp;without&nbsp;the&nbsp;expense&nbsp;of&nbsp;backtracking.</span><br>
<span class="lineno"></span><span class="comment" id="3423154">//&nbsp;For&nbsp;POSIX&nbsp;leftmost-longest&nbsp;matching,&nbsp;see&nbsp;CompilePOSIX.</span><br>
<span class="lineno"></span><span class="keyword" id="3423212">func</span>&nbsp;<span class="ident" id="3423217">Compile</span><span class="op" id="3423224">(</span><span class="ident" id="3423225">expr</span>&nbsp;<span class="builtintype" id="3423230">string</span><span class="op" id="3423236">)</span>&nbsp;<span class="op" id="3423238">(</span><span class="op" id="3423239">*</span><span class="ident" id="3423240">Regexp</span><span class="op" id="3423246">,</span>&nbsp;<span class="builtintype" id="3423248">error</span><span class="op" id="3423253">)</span>&nbsp;<span class="op" id="3423255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3423258">return</span>&nbsp;<span class="ident" id="3423265">compile</span><span class="op" id="3423272">(</span><span class="ident" id="3423273">expr</span><span class="op" id="3423277">,</span>&nbsp;<span class="ident" id="3423279">syntax</span><span class="op" id="3423285">.</span><span class="ident" id="3423286">Perl</span><span class="op" id="3423290">,</span>&nbsp;<span class="builtintype" id="3423292">false</span><span class="op" id="3423297">)</span><br>
<span class="lineno"></span><span class="op" id="3423299">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="3423302">//&nbsp;CompilePOSIX&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;restricts&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="3423371">//&nbsp;to&nbsp;POSIX&nbsp;ERE&nbsp;(egrep)&nbsp;syntax&nbsp;and&nbsp;changes&nbsp;the&nbsp;match&nbsp;semantics&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3423437">//&nbsp;leftmost-longest.</span><br>
<span class="lineno"></span><span class="comment" id="3423458">//</span><br>
<span class="lineno">125</span><span class="comment" id="3423461">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3423533">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3423605">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="comment" id="3423656">//&nbsp;This&nbsp;so-called&nbsp;leftmost-longest&nbsp;matching&nbsp;is&nbsp;the&nbsp;same&nbsp;semantics</span><br>
<span class="lineno"></span><span class="comment" id="3423722">//&nbsp;that&nbsp;early&nbsp;regular&nbsp;expression&nbsp;implementations&nbsp;used&nbsp;and&nbsp;that&nbsp;POSIX</span><br>
<span class="lineno">130</span><span class="comment" id="3423791">//&nbsp;specifies.</span><br>
<span class="lineno"></span><span class="comment" id="3423805">//</span><br>
<span class="lineno"></span><span class="comment" id="3423808">//&nbsp;However,&nbsp;there&nbsp;can&nbsp;be&nbsp;multiple&nbsp;leftmost-longest&nbsp;matches,&nbsp;with&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="3423883">//&nbsp;submatch&nbsp;choices,&nbsp;and&nbsp;here&nbsp;this&nbsp;package&nbsp;diverges&nbsp;from&nbsp;POSIX.</span><br>
<span class="lineno"></span><span class="comment" id="3423947">//&nbsp;Among&nbsp;the&nbsp;possible&nbsp;leftmost-longest&nbsp;matches,&nbsp;this&nbsp;package&nbsp;chooses</span><br>
<span class="lineno">135</span><span class="comment" id="3424016">//&nbsp;the&nbsp;one&nbsp;that&nbsp;a&nbsp;backtracking&nbsp;search&nbsp;would&nbsp;have&nbsp;found&nbsp;first,&nbsp;while&nbsp;POSIX</span><br>
<span class="lineno"></span><span class="comment" id="3424090">//&nbsp;specifies&nbsp;that&nbsp;the&nbsp;match&nbsp;be&nbsp;chosen&nbsp;to&nbsp;maximize&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="3424164">//&nbsp;subexpression,&nbsp;then&nbsp;the&nbsp;second,&nbsp;and&nbsp;so&nbsp;on&nbsp;from&nbsp;left&nbsp;to&nbsp;right.</span><br>
<span class="lineno"></span><span class="comment" id="3424229">//&nbsp;The&nbsp;POSIX&nbsp;rule&nbsp;is&nbsp;computationally&nbsp;prohibitive&nbsp;and&nbsp;not&nbsp;even&nbsp;well-defined.</span><br>
<span class="lineno"></span><span class="comment" id="3424305">//&nbsp;See&nbsp;http://swtch.com/~rsc/regexp/regexp2.html#posix&nbsp;for&nbsp;details.</span><br>
<span class="lineno">140</span><span class="keyword" id="3424373">func</span>&nbsp;<span class="ident" id="3424378">CompilePOSIX</span><span class="op" id="3424390">(</span><span class="ident" id="3424391">expr</span>&nbsp;<span class="builtintype" id="3424396">string</span><span class="op" id="3424402">)</span>&nbsp;<span class="op" id="3424404">(</span><span class="op" id="3424405">*</span><span class="ident" id="3424406">Regexp</span><span class="op" id="3424412">,</span>&nbsp;<span class="builtintype" id="3424414">error</span><span class="op" id="3424419">)</span>&nbsp;<span class="op" id="3424421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3424424">return</span>&nbsp;<span class="ident" id="3424431">compile</span><span class="op" id="3424438">(</span><span class="ident" id="3424439">expr</span><span class="op" id="3424443">,</span>&nbsp;<span class="ident" id="3424445">syntax</span><span class="op" id="3424451">.</span><span class="ident" id="3424452">POSIX</span><span class="op" id="3424457">,</span>&nbsp;<span class="builtintype" id="3424459">true</span><span class="op" id="3424463">)</span><br>
<span class="lineno"></span><span class="op" id="3424465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3424468">//&nbsp;Longest&nbsp;makes&nbsp;future&nbsp;searches&nbsp;prefer&nbsp;the&nbsp;leftmost-longest&nbsp;match.</span><br>
<span class="lineno">145</span><span class="comment" id="3424536">//&nbsp;That&nbsp;is,&nbsp;when&nbsp;matching&nbsp;against&nbsp;text,&nbsp;the&nbsp;regexp&nbsp;returns&nbsp;a&nbsp;match&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3424608">//&nbsp;begins&nbsp;as&nbsp;early&nbsp;as&nbsp;possible&nbsp;in&nbsp;the&nbsp;input&nbsp;(leftmost),&nbsp;and&nbsp;among&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3424680">//&nbsp;it&nbsp;chooses&nbsp;a&nbsp;match&nbsp;that&nbsp;is&nbsp;as&nbsp;long&nbsp;as&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="3424731">func</span>&nbsp;<span class="op" id="3424736">(</span><span class="ident" id="3424737">re</span>&nbsp;<span class="op" id="3424740">*</span><span class="ident" id="3424741">Regexp</span><span class="op" id="3424747">)</span>&nbsp;<span class="ident" id="3424749">Longest</span><span class="op" id="3424756">(</span><span class="op" id="3424757">)</span>&nbsp;<span class="op" id="3424759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3424762">re</span><span class="op" id="3424764">.</span><span class="ident" id="3424765">longest</span>&nbsp;<span class="op" id="3424773">=</span>&nbsp;<span class="builtintype" id="3424775">true</span><br>
<span class="lineno">150</span><span class="op" id="3424780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3424783">func</span>&nbsp;<span class="ident" id="3424788">compile</span><span class="op" id="3424795">(</span><span class="ident" id="3424796">expr</span>&nbsp;<span class="builtintype" id="3424801">string</span><span class="op" id="3424807">,</span>&nbsp;<span class="ident" id="3424809">mode</span>&nbsp;<span class="ident" id="3424814">syntax</span><span class="op" id="3424820">.</span><span class="ident" id="3424821">Flags</span><span class="op" id="3424826">,</span>&nbsp;<span class="ident" id="3424828">longest</span>&nbsp;<span class="builtintype" id="3424836">bool</span><span class="op" id="3424840">)</span>&nbsp;<span class="op" id="3424842">(</span><span class="op" id="3424843">*</span><span class="ident" id="3424844">Regexp</span><span class="op" id="3424850">,</span>&nbsp;<span class="builtintype" id="3424852">error</span><span class="op" id="3424857">)</span>&nbsp;<span class="op" id="3424859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3424862">re</span><span class="op" id="3424864">,</span>&nbsp;<span class="ident" id="3424866">err</span>&nbsp;<span class="op" id="3424870">:=</span>&nbsp;<span class="ident" id="3424873">syntax</span><span class="op" id="3424879">.</span><span class="ident" id="3424880">Parse</span><span class="op" id="3424885">(</span><span class="ident" id="3424886">expr</span><span class="op" id="3424890">,</span>&nbsp;<span class="ident" id="3424892">mode</span><span class="op" id="3424896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3424899">if</span>&nbsp;<span class="ident" id="3424902">err</span>&nbsp;<span class="op" id="3424906">!=</span>&nbsp;<span class="builtintype" id="3424909">nil</span>&nbsp;<span class="op" id="3424913">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3424917">return</span>&nbsp;<span class="builtintype" id="3424924">nil</span><span class="op" id="3424927">,</span>&nbsp;<span class="ident" id="3424929">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3424934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3424937">maxCap</span>&nbsp;<span class="op" id="3424944">:=</span>&nbsp;<span class="ident" id="3424947">re</span><span class="op" id="3424949">.</span><span class="ident" id="3424950">MaxCap</span><span class="op" id="3424956">(</span><span class="op" id="3424957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3424960">capNames</span>&nbsp;<span class="op" id="3424969">:=</span>&nbsp;<span class="ident" id="3424972">re</span><span class="op" id="3424974">.</span><span class="ident" id="3424975">CapNames</span><span class="op" id="3424983">(</span><span class="op" id="3424984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3424988">re</span>&nbsp;<span class="op" id="3424991">=</span>&nbsp;<span class="ident" id="3424993">re</span><span class="op" id="3424995">.</span><span class="ident" id="3424996">Simplify</span><span class="op" id="3425004">(</span><span class="op" id="3425005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425008">prog</span><span class="op" id="3425012">,</span>&nbsp;<span class="ident" id="3425014">err</span>&nbsp;<span class="op" id="3425018">:=</span>&nbsp;<span class="ident" id="3425021">syntax</span><span class="op" id="3425027">.</span><span class="ident" id="3425028">Compile</span><span class="op" id="3425035">(</span><span class="ident" id="3425036">re</span><span class="op" id="3425038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3425041">if</span>&nbsp;<span class="ident" id="3425044">err</span>&nbsp;<span class="op" id="3425048">!=</span>&nbsp;<span class="builtintype" id="3425051">nil</span>&nbsp;<span class="op" id="3425055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3425059">return</span>&nbsp;<span class="builtintype" id="3425066">nil</span><span class="op" id="3425069">,</span>&nbsp;<span class="ident" id="3425071">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3425076">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425079">regexp</span>&nbsp;<span class="op" id="3425086">:=</span>&nbsp;<span class="op" id="3425089">&amp;</span><span class="ident" id="3425090">Regexp</span><span class="op" id="3425096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425100">expr</span><span class="op" id="3425104">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425113">expr</span><span class="op" id="3425117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425121">prog</span><span class="op" id="3425125">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425134">prog</span><span class="op" id="3425138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425142">onepass</span><span class="op" id="3425149">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425155">compileOnePass</span><span class="op" id="3425169">(</span><span class="ident" id="3425170">prog</span><span class="op" id="3425174">)</span><span class="op" id="3425175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425179">numSubexp</span><span class="op" id="3425188">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3425192">maxCap</span><span class="op" id="3425198">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425202">subexpNames</span><span class="op" id="3425213">:</span>&nbsp;<span class="ident" id="3425215">capNames</span><span class="op" id="3425223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425227">cond</span><span class="op" id="3425231">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425240">prog</span><span class="op" id="3425244">.</span><span class="ident" id="3425245">StartCond</span><span class="op" id="3425254">(</span><span class="op" id="3425255">)</span><span class="op" id="3425256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425260">longest</span><span class="op" id="3425267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425273">longest</span><span class="op" id="3425280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3425283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3425286">if</span>&nbsp;<span class="ident" id="3425289">regexp</span><span class="op" id="3425295">.</span><span class="ident" id="3425296">onepass</span>&nbsp;<span class="op" id="3425304">==</span>&nbsp;<span class="ident" id="3425307">notOnePass</span>&nbsp;<span class="op" id="3425318">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425322">regexp</span><span class="op" id="3425328">.</span><span class="ident" id="3425329">prefix</span><span class="op" id="3425335">,</span>&nbsp;<span class="ident" id="3425337">regexp</span><span class="op" id="3425343">.</span><span class="ident" id="3425344">prefixComplete</span>&nbsp;<span class="op" id="3425359">=</span>&nbsp;<span class="ident" id="3425361">prog</span><span class="op" id="3425365">.</span><span class="ident" id="3425366">Prefix</span><span class="op" id="3425372">(</span><span class="op" id="3425373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3425376">}</span>&nbsp;<span class="keyword" id="3425378">else</span>&nbsp;<span class="op" id="3425383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425387">regexp</span><span class="op" id="3425393">.</span><span class="ident" id="3425394">prefix</span><span class="op" id="3425400">,</span>&nbsp;<span class="ident" id="3425402">regexp</span><span class="op" id="3425408">.</span><span class="ident" id="3425409">prefixComplete</span><span class="op" id="3425423">,</span>&nbsp;<span class="ident" id="3425425">regexp</span><span class="op" id="3425431">.</span><span class="ident" id="3425432">prefixEnd</span>&nbsp;<span class="op" id="3425442">=</span>&nbsp;<span class="ident" id="3425444">onePassPrefix</span><span class="op" id="3425457">(</span><span class="ident" id="3425458">prog</span><span class="op" id="3425462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3425465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3425468">if</span>&nbsp;<span class="ident" id="3425471">regexp</span><span class="op" id="3425477">.</span><span class="ident" id="3425478">prefix</span>&nbsp;<span class="op" id="3425485">!=</span>&nbsp;<span class="string" id="3425488">&#34;&#34;</span>&nbsp;<span class="op" id="3425491">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3425495">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;this&nbsp;allocation&nbsp;by&nbsp;adding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3425544">//&nbsp;IndexString&nbsp;to&nbsp;package&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425579">regexp</span><span class="op" id="3425585">.</span><span class="ident" id="3425586">prefixBytes</span>&nbsp;<span class="op" id="3425598">=</span>&nbsp;<span class="op" id="3425600">[</span><span class="op" id="3425601">]</span><span class="builtintype" id="3425602">byte</span><span class="op" id="3425606">(</span><span class="ident" id="3425607">regexp</span><span class="op" id="3425613">.</span><span class="ident" id="3425614">prefix</span><span class="op" id="3425620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425624">regexp</span><span class="op" id="3425630">.</span><span class="ident" id="3425631">prefixRune</span><span class="op" id="3425641">,</span>&nbsp;<span class="ident" id="3425643">_</span>&nbsp;<span class="op" id="3425645">=</span>&nbsp;<span class="ident" id="3425647">utf8</span><span class="op" id="3425651">.</span><span class="ident" id="3425652">DecodeRuneInString</span><span class="op" id="3425670">(</span><span class="ident" id="3425671">regexp</span><span class="op" id="3425677">.</span><span class="ident" id="3425678">prefix</span><span class="op" id="3425684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3425687">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3425690">return</span>&nbsp;<span class="ident" id="3425697">regexp</span><span class="op" id="3425703">,</span>&nbsp;<span class="builtintype" id="3425705">nil</span><br>
<span class="lineno"></span><span class="op" id="3425709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3425712">//&nbsp;get&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;use&nbsp;for&nbsp;matching&nbsp;re.</span><br>
<span class="lineno"></span><span class="comment" id="3425761">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache&nbsp;if&nbsp;possible,&nbsp;to&nbsp;avoid</span><br>
<span class="lineno">190</span><span class="comment" id="3425817">//&nbsp;unnecessary&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3425844">func</span>&nbsp;<span class="op" id="3425849">(</span><span class="ident" id="3425850">re</span>&nbsp;<span class="op" id="3425853">*</span><span class="ident" id="3425854">Regexp</span><span class="op" id="3425860">)</span>&nbsp;<span class="ident" id="3425862">get</span><span class="op" id="3425865">(</span><span class="op" id="3425866">)</span>&nbsp;<span class="op" id="3425868">*</span><span class="ident" id="3425869">machine</span>&nbsp;<span class="op" id="3425877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425880">re</span><span class="op" id="3425882">.</span><span class="ident" id="3425883">mu</span><span class="op" id="3425885">.</span><span class="ident" id="3425886">Lock</span><span class="op" id="3425890">(</span><span class="op" id="3425891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3425894">if</span>&nbsp;<span class="ident" id="3425897">n</span>&nbsp;<span class="op" id="3425899">:=</span>&nbsp;<span class="builtinfunc" id="3425902">len</span><span class="op" id="3425905">(</span><span class="ident" id="3425906">re</span><span class="op" id="3425908">.</span><span class="ident" id="3425909">machine</span><span class="op" id="3425916">)</span><span class="op" id="3425917">;</span>&nbsp;<span class="ident" id="3425919">n</span>&nbsp;<span class="op" id="3425921">&gt;</span>&nbsp;<span class="num" id="3425923">0</span>&nbsp;<span class="op" id="3425925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425929">z</span>&nbsp;<span class="op" id="3425931">:=</span>&nbsp;<span class="ident" id="3425934">re</span><span class="op" id="3425936">.</span><span class="ident" id="3425937">machine</span><span class="op" id="3425944">[</span><span class="ident" id="3425945">n</span><span class="op" id="3425946">-</span><span class="num" id="3425947">1</span><span class="op" id="3425948">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425952">re</span><span class="op" id="3425954">.</span><span class="ident" id="3425955">machine</span>&nbsp;<span class="op" id="3425963">=</span>&nbsp;<span class="ident" id="3425965">re</span><span class="op" id="3425967">.</span><span class="ident" id="3425968">machine</span><span class="op" id="3425975">[</span><span class="op" id="3425976">:</span><span class="ident" id="3425977">n</span><span class="op" id="3425978">-</span><span class="num" id="3425979">1</span><span class="op" id="3425980">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3425984">re</span><span class="op" id="3425986">.</span><span class="ident" id="3425987">mu</span><span class="op" id="3425989">.</span><span class="ident" id="3425990">Unlock</span><span class="op" id="3425996">(</span><span class="op" id="3425997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3426001">return</span>&nbsp;<span class="ident" id="3426008">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3426011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426014">re</span><span class="op" id="3426016">.</span><span class="ident" id="3426017">mu</span><span class="op" id="3426019">.</span><span class="ident" id="3426020">Unlock</span><span class="op" id="3426026">(</span><span class="op" id="3426027">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426030">z</span>&nbsp;<span class="op" id="3426032">:=</span>&nbsp;<span class="ident" id="3426035">progMachine</span><span class="op" id="3426046">(</span><span class="ident" id="3426047">re</span><span class="op" id="3426049">.</span><span class="ident" id="3426050">prog</span><span class="op" id="3426054">,</span>&nbsp;<span class="ident" id="3426056">re</span><span class="op" id="3426058">.</span><span class="ident" id="3426059">onepass</span><span class="op" id="3426066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426069">z</span><span class="op" id="3426070">.</span><span class="ident" id="3426071">re</span>&nbsp;<span class="op" id="3426074">=</span>&nbsp;<span class="ident" id="3426076">re</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3426080">return</span>&nbsp;<span class="ident" id="3426087">z</span><br>
<span class="lineno"></span><span class="op" id="3426089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3426092">//&nbsp;put&nbsp;returns&nbsp;a&nbsp;machine&nbsp;to&nbsp;the&nbsp;re&#39;s&nbsp;machine&nbsp;cache.</span><br>
<span class="lineno"></span><span class="comment" id="3426144">//&nbsp;There&nbsp;is&nbsp;no&nbsp;attempt&nbsp;to&nbsp;limit&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;cache,&nbsp;so&nbsp;it&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3426210">//&nbsp;grow&nbsp;to&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;simultaneous&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="3426264">//&nbsp;run&nbsp;using&nbsp;re.&nbsp;&nbsp;(The&nbsp;cache&nbsp;empties&nbsp;when&nbsp;re&nbsp;gets&nbsp;garbage&nbsp;collected.)</span><br>
<span class="lineno"></span><span class="keyword" id="3426334">func</span>&nbsp;<span class="op" id="3426339">(</span><span class="ident" id="3426340">re</span>&nbsp;<span class="op" id="3426343">*</span><span class="ident" id="3426344">Regexp</span><span class="op" id="3426350">)</span>&nbsp;<span class="ident" id="3426352">put</span><span class="op" id="3426355">(</span><span class="ident" id="3426356">z</span>&nbsp;<span class="op" id="3426358">*</span><span class="ident" id="3426359">machine</span><span class="op" id="3426366">)</span>&nbsp;<span class="op" id="3426368">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426371">re</span><span class="op" id="3426373">.</span><span class="ident" id="3426374">mu</span><span class="op" id="3426376">.</span><span class="ident" id="3426377">Lock</span><span class="op" id="3426381">(</span><span class="op" id="3426382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426385">re</span><span class="op" id="3426387">.</span><span class="ident" id="3426388">machine</span>&nbsp;<span class="op" id="3426396">=</span>&nbsp;<span class="builtinfunc" id="3426398">append</span><span class="op" id="3426404">(</span><span class="ident" id="3426405">re</span><span class="op" id="3426407">.</span><span class="ident" id="3426408">machine</span><span class="op" id="3426415">,</span>&nbsp;<span class="ident" id="3426417">z</span><span class="op" id="3426418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426421">re</span><span class="op" id="3426423">.</span><span class="ident" id="3426424">mu</span><span class="op" id="3426426">.</span><span class="ident" id="3426427">Unlock</span><span class="op" id="3426433">(</span><span class="op" id="3426434">)</span><br>
<span class="lineno"></span><span class="op" id="3426436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="3426439">//&nbsp;MustCompile&nbsp;is&nbsp;like&nbsp;Compile&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="3426517">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="3426599">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="3426615">func</span>&nbsp;<span class="ident" id="3426620">MustCompile</span><span class="op" id="3426631">(</span><span class="ident" id="3426632">str</span>&nbsp;<span class="builtintype" id="3426636">string</span><span class="op" id="3426642">)</span>&nbsp;<span class="op" id="3426644">*</span><span class="ident" id="3426645">Regexp</span>&nbsp;<span class="op" id="3426652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3426655">regexp</span><span class="op" id="3426661">,</span>&nbsp;<span class="builtintype" id="3426663">error</span>&nbsp;<span class="op" id="3426669">:=</span>&nbsp;<span class="ident" id="3426672">Compile</span><span class="op" id="3426679">(</span><span class="ident" id="3426680">str</span><span class="op" id="3426683">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3426686">if</span>&nbsp;<span class="builtintype" id="3426689">error</span>&nbsp;<span class="op" id="3426695">!=</span>&nbsp;<span class="builtintype" id="3426698">nil</span>&nbsp;<span class="op" id="3426702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3426706">panic</span><span class="op" id="3426711">(</span><span class="string" id="3426712">`regexp:&nbsp;Compile(`</span>&nbsp;<span class="op" id="3426731">+</span>&nbsp;<span class="ident" id="3426733">quote</span><span class="op" id="3426738">(</span><span class="ident" id="3426739">str</span><span class="op" id="3426742">)</span>&nbsp;<span class="op" id="3426744">+</span>&nbsp;<span class="string" id="3426746">`):&nbsp;`</span>&nbsp;<span class="op" id="3426752">+</span>&nbsp;<span class="builtintype" id="3426754">error</span><span class="op" id="3426759">.</span><span class="ident" id="3426760">Error</span><span class="op" id="3426765">(</span><span class="op" id="3426766">)</span><span class="op" id="3426767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3426770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3426773">return</span>&nbsp;<span class="ident" id="3426780">regexp</span><br>
<span class="lineno"></span><span class="op" id="3426787">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3426790">//&nbsp;MustCompilePOSIX&nbsp;is&nbsp;like&nbsp;CompilePOSIX&nbsp;but&nbsp;panics&nbsp;if&nbsp;the&nbsp;expression&nbsp;cannot&nbsp;be&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="3426878">//&nbsp;It&nbsp;simplifies&nbsp;safe&nbsp;initialization&nbsp;of&nbsp;global&nbsp;variables&nbsp;holding&nbsp;compiled&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="3426960">//&nbsp;expressions.</span><br>
<span class="lineno"></span><span class="keyword" id="3426976">func</span>&nbsp;<span class="ident" id="3426981">MustCompilePOSIX</span><span class="op" id="3426997">(</span><span class="ident" id="3426998">str</span>&nbsp;<span class="builtintype" id="3427002">string</span><span class="op" id="3427008">)</span>&nbsp;<span class="op" id="3427010">*</span><span class="ident" id="3427011">Regexp</span>&nbsp;<span class="op" id="3427018">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3427021">regexp</span><span class="op" id="3427027">,</span>&nbsp;<span class="builtintype" id="3427029">error</span>&nbsp;<span class="op" id="3427035">:=</span>&nbsp;<span class="ident" id="3427038">CompilePOSIX</span><span class="op" id="3427050">(</span><span class="ident" id="3427051">str</span><span class="op" id="3427054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427057">if</span>&nbsp;<span class="builtintype" id="3427060">error</span>&nbsp;<span class="op" id="3427066">!=</span>&nbsp;<span class="builtintype" id="3427069">nil</span>&nbsp;<span class="op" id="3427073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3427077">panic</span><span class="op" id="3427082">(</span><span class="string" id="3427083">`regexp:&nbsp;CompilePOSIX(`</span>&nbsp;<span class="op" id="3427107">+</span>&nbsp;<span class="ident" id="3427109">quote</span><span class="op" id="3427114">(</span><span class="ident" id="3427115">str</span><span class="op" id="3427118">)</span>&nbsp;<span class="op" id="3427120">+</span>&nbsp;<span class="string" id="3427122">`):&nbsp;`</span>&nbsp;<span class="op" id="3427128">+</span>&nbsp;<span class="builtintype" id="3427130">error</span><span class="op" id="3427135">.</span><span class="ident" id="3427136">Error</span><span class="op" id="3427141">(</span><span class="op" id="3427142">)</span><span class="op" id="3427143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3427146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427149">return</span>&nbsp;<span class="ident" id="3427156">regexp</span><br>
<span class="lineno">235</span><span class="op" id="3427163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3427166">func</span>&nbsp;<span class="ident" id="3427171">quote</span><span class="op" id="3427176">(</span><span class="ident" id="3427177">s</span>&nbsp;<span class="builtintype" id="3427179">string</span><span class="op" id="3427185">)</span>&nbsp;<span class="builtintype" id="3427187">string</span>&nbsp;<span class="op" id="3427194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427197">if</span>&nbsp;<span class="ident" id="3427200">strconv</span><span class="op" id="3427207">.</span><span class="ident" id="3427208">CanBackquote</span><span class="op" id="3427220">(</span><span class="ident" id="3427221">s</span><span class="op" id="3427222">)</span>&nbsp;<span class="op" id="3427224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427228">return</span>&nbsp;<span class="string" id="3427235">&#34;`&#34;</span>&nbsp;<span class="op" id="3427239">+</span>&nbsp;<span class="ident" id="3427241">s</span>&nbsp;<span class="op" id="3427243">+</span>&nbsp;<span class="string" id="3427245">&#34;`&#34;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3427250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427253">return</span>&nbsp;<span class="ident" id="3427260">strconv</span><span class="op" id="3427267">.</span><span class="ident" id="3427268">Quote</span><span class="op" id="3427273">(</span><span class="ident" id="3427274">s</span><span class="op" id="3427275">)</span><br>
<span class="lineno"></span><span class="op" id="3427277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3427280">//&nbsp;NumSubexp&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;parenthesized&nbsp;subexpressions&nbsp;in&nbsp;this&nbsp;Regexp.</span><br>
<span class="lineno">245</span><span class="keyword" id="3427360">func</span>&nbsp;<span class="op" id="3427365">(</span><span class="ident" id="3427366">re</span>&nbsp;<span class="op" id="3427369">*</span><span class="ident" id="3427370">Regexp</span><span class="op" id="3427376">)</span>&nbsp;<span class="ident" id="3427378">NumSubexp</span><span class="op" id="3427387">(</span><span class="op" id="3427388">)</span>&nbsp;<span class="builtintype" id="3427390">int</span>&nbsp;<span class="op" id="3427394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427397">return</span>&nbsp;<span class="ident" id="3427404">re</span><span class="op" id="3427406">.</span><span class="ident" id="3427407">numSubexp</span><br>
<span class="lineno"></span><span class="op" id="3427417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3427420">//&nbsp;SubexpNames&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;parenthesized&nbsp;subexpressions</span><br>
<span class="lineno">250</span><span class="comment" id="3427489">//&nbsp;in&nbsp;this&nbsp;Regexp.&nbsp;&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;first&nbsp;sub-expression&nbsp;is&nbsp;names[1],</span><br>
<span class="lineno"></span><span class="comment" id="3427560">//&nbsp;so&nbsp;that&nbsp;if&nbsp;m&nbsp;is&nbsp;a&nbsp;match&nbsp;slice,&nbsp;the&nbsp;name&nbsp;for&nbsp;m[i]&nbsp;is&nbsp;SubexpNames()[i].</span><br>
<span class="lineno"></span><span class="comment" id="3427633">//&nbsp;Since&nbsp;the&nbsp;Regexp&nbsp;as&nbsp;a&nbsp;whole&nbsp;cannot&nbsp;be&nbsp;named,&nbsp;names[0]&nbsp;is&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3427700">//&nbsp;the&nbsp;empty&nbsp;string.&nbsp;&nbsp;The&nbsp;slice&nbsp;should&nbsp;not&nbsp;be&nbsp;modified.</span><br>
<span class="lineno"></span><span class="keyword" id="3427756">func</span>&nbsp;<span class="op" id="3427761">(</span><span class="ident" id="3427762">re</span>&nbsp;<span class="op" id="3427765">*</span><span class="ident" id="3427766">Regexp</span><span class="op" id="3427772">)</span>&nbsp;<span class="ident" id="3427774">SubexpNames</span><span class="op" id="3427785">(</span><span class="op" id="3427786">)</span>&nbsp;<span class="op" id="3427788">[</span><span class="op" id="3427789">]</span><span class="builtintype" id="3427790">string</span>&nbsp;<span class="op" id="3427797">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3427800">return</span>&nbsp;<span class="ident" id="3427807">re</span><span class="op" id="3427809">.</span><span class="ident" id="3427810">subexpNames</span><br>
<span class="lineno"></span><span class="op" id="3427822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3427825">const</span>&nbsp;<span class="ident" id="3427831">endOfText</span>&nbsp;<span class="builtintype" id="3427841">rune</span>&nbsp;<span class="op" id="3427846">=</span>&nbsp;<span class="op" id="3427848">-</span><span class="num" id="3427849">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3427852">//&nbsp;input&nbsp;abstracts&nbsp;different&nbsp;representations&nbsp;of&nbsp;the&nbsp;input&nbsp;text.&nbsp;It&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="3427928">//&nbsp;one-character&nbsp;lookahead.</span><br>
<span class="lineno"></span><span class="keyword" id="3427956">type</span>&nbsp;<span class="ident" id="3427961">input</span>&nbsp;<span class="keyword" id="3427967">interface</span>&nbsp;<span class="op" id="3427977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3427980">step</span><span class="op" id="3427984">(</span><span class="ident" id="3427985">pos</span>&nbsp;<span class="builtintype" id="3427989">int</span><span class="op" id="3427992">)</span>&nbsp;<span class="op" id="3427994">(</span><span class="ident" id="3427995">r</span>&nbsp;<span class="builtintype" id="3427997">rune</span><span class="op" id="3428001">,</span>&nbsp;<span class="ident" id="3428003">width</span>&nbsp;<span class="builtintype" id="3428009">int</span><span class="op" id="3428012">)</span>&nbsp;<span class="comment" id="3428014">//&nbsp;advance&nbsp;one&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428035">canCheckPrefix</span><span class="op" id="3428049">(</span><span class="op" id="3428050">)</span>&nbsp;<span class="builtintype" id="3428052">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3428069">//&nbsp;can&nbsp;we&nbsp;look&nbsp;ahead&nbsp;without&nbsp;losing&nbsp;info?</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428112">hasPrefix</span><span class="op" id="3428121">(</span><span class="ident" id="3428122">re</span>&nbsp;<span class="op" id="3428125">*</span><span class="ident" id="3428126">Regexp</span><span class="op" id="3428132">)</span>&nbsp;<span class="builtintype" id="3428134">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428140">index</span><span class="op" id="3428145">(</span><span class="ident" id="3428146">re</span>&nbsp;<span class="op" id="3428149">*</span><span class="ident" id="3428150">Regexp</span><span class="op" id="3428156">,</span>&nbsp;<span class="ident" id="3428158">pos</span>&nbsp;<span class="builtintype" id="3428162">int</span><span class="op" id="3428165">)</span>&nbsp;<span class="builtintype" id="3428167">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428172">context</span><span class="op" id="3428179">(</span><span class="ident" id="3428180">pos</span>&nbsp;<span class="builtintype" id="3428184">int</span><span class="op" id="3428187">)</span>&nbsp;<span class="ident" id="3428189">syntax</span><span class="op" id="3428195">.</span><span class="ident" id="3428196">EmptyOp</span><br>
<span class="lineno"></span><span class="op" id="3428204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="comment" id="3428207">//&nbsp;inputString&nbsp;scans&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3428238">type</span>&nbsp;<span class="ident" id="3428243">inputString</span>&nbsp;<span class="keyword" id="3428255">struct</span>&nbsp;<span class="op" id="3428262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428265">str</span>&nbsp;<span class="builtintype" id="3428269">string</span><br>
<span class="lineno"></span><span class="op" id="3428276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="3428279">func</span>&nbsp;<span class="op" id="3428284">(</span><span class="ident" id="3428285">i</span>&nbsp;<span class="op" id="3428287">*</span><span class="ident" id="3428288">inputString</span><span class="op" id="3428299">)</span>&nbsp;<span class="ident" id="3428301">step</span><span class="op" id="3428305">(</span><span class="ident" id="3428306">pos</span>&nbsp;<span class="builtintype" id="3428310">int</span><span class="op" id="3428313">)</span>&nbsp;<span class="op" id="3428315">(</span><span class="builtintype" id="3428316">rune</span><span class="op" id="3428320">,</span>&nbsp;<span class="builtintype" id="3428322">int</span><span class="op" id="3428325">)</span>&nbsp;<span class="op" id="3428327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428330">if</span>&nbsp;<span class="ident" id="3428333">pos</span>&nbsp;<span class="op" id="3428337">&lt;</span>&nbsp;<span class="builtinfunc" id="3428339">len</span><span class="op" id="3428342">(</span><span class="ident" id="3428343">i</span><span class="op" id="3428344">.</span><span class="ident" id="3428345">str</span><span class="op" id="3428348">)</span>&nbsp;<span class="op" id="3428350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428354">c</span>&nbsp;<span class="op" id="3428356">:=</span>&nbsp;<span class="ident" id="3428359">i</span><span class="op" id="3428360">.</span><span class="ident" id="3428361">str</span><span class="op" id="3428364">[</span><span class="ident" id="3428365">pos</span><span class="op" id="3428368">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428372">if</span>&nbsp;<span class="ident" id="3428375">c</span>&nbsp;<span class="op" id="3428377">&lt;</span>&nbsp;<span class="ident" id="3428379">utf8</span><span class="op" id="3428383">.</span><span class="ident" id="3428384">RuneSelf</span>&nbsp;<span class="op" id="3428393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428398">return</span>&nbsp;<span class="builtintype" id="3428405">rune</span><span class="op" id="3428409">(</span><span class="ident" id="3428410">c</span><span class="op" id="3428411">)</span><span class="op" id="3428412">,</span>&nbsp;<span class="num" id="3428414">1</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3428418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428422">return</span>&nbsp;<span class="ident" id="3428429">utf8</span><span class="op" id="3428433">.</span><span class="ident" id="3428434">DecodeRuneInString</span><span class="op" id="3428452">(</span><span class="ident" id="3428453">i</span><span class="op" id="3428454">.</span><span class="ident" id="3428455">str</span><span class="op" id="3428458">[</span><span class="ident" id="3428459">pos</span><span class="op" id="3428462">:</span><span class="op" id="3428463">]</span><span class="op" id="3428464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3428467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428470">return</span>&nbsp;<span class="ident" id="3428477">endOfText</span><span class="op" id="3428486">,</span>&nbsp;<span class="num" id="3428488">0</span><br>
<span class="lineno"></span><span class="op" id="3428490">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="3428493">func</span>&nbsp;<span class="op" id="3428498">(</span><span class="ident" id="3428499">i</span>&nbsp;<span class="op" id="3428501">*</span><span class="ident" id="3428502">inputString</span><span class="op" id="3428513">)</span>&nbsp;<span class="ident" id="3428515">canCheckPrefix</span><span class="op" id="3428529">(</span><span class="op" id="3428530">)</span>&nbsp;<span class="builtintype" id="3428532">bool</span>&nbsp;<span class="op" id="3428537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428540">return</span>&nbsp;<span class="builtintype" id="3428547">true</span><br>
<span class="lineno"></span><span class="op" id="3428552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="3428555">func</span>&nbsp;<span class="op" id="3428560">(</span><span class="ident" id="3428561">i</span>&nbsp;<span class="op" id="3428563">*</span><span class="ident" id="3428564">inputString</span><span class="op" id="3428575">)</span>&nbsp;<span class="ident" id="3428577">hasPrefix</span><span class="op" id="3428586">(</span><span class="ident" id="3428587">re</span>&nbsp;<span class="op" id="3428590">*</span><span class="ident" id="3428591">Regexp</span><span class="op" id="3428597">)</span>&nbsp;<span class="builtintype" id="3428599">bool</span>&nbsp;<span class="op" id="3428604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428607">return</span>&nbsp;<span class="ident" id="3428614">strings</span><span class="op" id="3428621">.</span><span class="ident" id="3428622">HasPrefix</span><span class="op" id="3428631">(</span><span class="ident" id="3428632">i</span><span class="op" id="3428633">.</span><span class="ident" id="3428634">str</span><span class="op" id="3428637">,</span>&nbsp;<span class="ident" id="3428639">re</span><span class="op" id="3428641">.</span><span class="ident" id="3428642">prefix</span><span class="op" id="3428648">)</span><br>
<span class="lineno"></span><span class="op" id="3428650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3428653">func</span>&nbsp;<span class="op" id="3428658">(</span><span class="ident" id="3428659">i</span>&nbsp;<span class="op" id="3428661">*</span><span class="ident" id="3428662">inputString</span><span class="op" id="3428673">)</span>&nbsp;<span class="ident" id="3428675">index</span><span class="op" id="3428680">(</span><span class="ident" id="3428681">re</span>&nbsp;<span class="op" id="3428684">*</span><span class="ident" id="3428685">Regexp</span><span class="op" id="3428691">,</span>&nbsp;<span class="ident" id="3428693">pos</span>&nbsp;<span class="builtintype" id="3428697">int</span><span class="op" id="3428700">)</span>&nbsp;<span class="builtintype" id="3428702">int</span>&nbsp;<span class="op" id="3428706">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428709">return</span>&nbsp;<span class="ident" id="3428716">strings</span><span class="op" id="3428723">.</span><span class="ident" id="3428724">Index</span><span class="op" id="3428729">(</span><span class="ident" id="3428730">i</span><span class="op" id="3428731">.</span><span class="ident" id="3428732">str</span><span class="op" id="3428735">[</span><span class="ident" id="3428736">pos</span><span class="op" id="3428739">:</span><span class="op" id="3428740">]</span><span class="op" id="3428741">,</span>&nbsp;<span class="ident" id="3428743">re</span><span class="op" id="3428745">.</span><span class="ident" id="3428746">prefix</span><span class="op" id="3428752">)</span><br>
<span class="lineno"></span><span class="op" id="3428754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3428757">func</span>&nbsp;<span class="op" id="3428762">(</span><span class="ident" id="3428763">i</span>&nbsp;<span class="op" id="3428765">*</span><span class="ident" id="3428766">inputString</span><span class="op" id="3428777">)</span>&nbsp;<span class="ident" id="3428779">context</span><span class="op" id="3428786">(</span><span class="ident" id="3428787">pos</span>&nbsp;<span class="builtintype" id="3428791">int</span><span class="op" id="3428794">)</span>&nbsp;<span class="ident" id="3428796">syntax</span><span class="op" id="3428802">.</span><span class="ident" id="3428803">EmptyOp</span>&nbsp;<span class="op" id="3428811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428814">r1</span><span class="op" id="3428816">,</span>&nbsp;<span class="ident" id="3428818">r2</span>&nbsp;<span class="op" id="3428821">:=</span>&nbsp;<span class="ident" id="3428824">endOfText</span><span class="op" id="3428833">,</span>&nbsp;<span class="ident" id="3428835">endOfText</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428846">if</span>&nbsp;<span class="ident" id="3428849">pos</span>&nbsp;<span class="op" id="3428853">&gt;</span>&nbsp;<span class="num" id="3428855">0</span>&nbsp;<span class="op" id="3428857">&amp;&amp;</span>&nbsp;<span class="ident" id="3428860">pos</span>&nbsp;<span class="op" id="3428864">&lt;=</span>&nbsp;<span class="builtinfunc" id="3428867">len</span><span class="op" id="3428870">(</span><span class="ident" id="3428871">i</span><span class="op" id="3428872">.</span><span class="ident" id="3428873">str</span><span class="op" id="3428876">)</span>&nbsp;<span class="op" id="3428878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428882">r1</span><span class="op" id="3428884">,</span>&nbsp;<span class="ident" id="3428886">_</span>&nbsp;<span class="op" id="3428888">=</span>&nbsp;<span class="ident" id="3428890">utf8</span><span class="op" id="3428894">.</span><span class="ident" id="3428895">DecodeLastRuneInString</span><span class="op" id="3428917">(</span><span class="ident" id="3428918">i</span><span class="op" id="3428919">.</span><span class="ident" id="3428920">str</span><span class="op" id="3428923">[</span><span class="op" id="3428924">:</span><span class="ident" id="3428925">pos</span><span class="op" id="3428928">]</span><span class="op" id="3428929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3428932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3428935">if</span>&nbsp;<span class="ident" id="3428938">pos</span>&nbsp;<span class="op" id="3428942">&lt;</span>&nbsp;<span class="builtinfunc" id="3428944">len</span><span class="op" id="3428947">(</span><span class="ident" id="3428948">i</span><span class="op" id="3428949">.</span><span class="ident" id="3428950">str</span><span class="op" id="3428953">)</span>&nbsp;<span class="op" id="3428955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3428959">r2</span><span class="op" id="3428961">,</span>&nbsp;<span class="ident" id="3428963">_</span>&nbsp;<span class="op" id="3428965">=</span>&nbsp;<span class="ident" id="3428967">utf8</span><span class="op" id="3428971">.</span><span class="ident" id="3428972">DecodeRuneInString</span><span class="op" id="3428990">(</span><span class="ident" id="3428991">i</span><span class="op" id="3428992">.</span><span class="ident" id="3428993">str</span><span class="op" id="3428996">[</span><span class="ident" id="3428997">pos</span><span class="op" id="3429000">:</span><span class="op" id="3429001">]</span><span class="op" id="3429002">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3429005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429008">return</span>&nbsp;<span class="ident" id="3429015">syntax</span><span class="op" id="3429021">.</span><span class="ident" id="3429022">EmptyOpContext</span><span class="op" id="3429036">(</span><span class="ident" id="3429037">r1</span><span class="op" id="3429039">,</span>&nbsp;<span class="ident" id="3429041">r2</span><span class="op" id="3429043">)</span><br>
<span class="lineno"></span><span class="op" id="3429045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3429048">//&nbsp;inputBytes&nbsp;scans&nbsp;a&nbsp;byte&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="3429082">type</span>&nbsp;<span class="ident" id="3429087">inputBytes</span>&nbsp;<span class="keyword" id="3429098">struct</span>&nbsp;<span class="op" id="3429105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429108">str</span>&nbsp;<span class="op" id="3429112">[</span><span class="op" id="3429113">]</span><span class="builtintype" id="3429114">byte</span><br>
<span class="lineno"></span><span class="op" id="3429119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429122">func</span>&nbsp;<span class="op" id="3429127">(</span><span class="ident" id="3429128">i</span>&nbsp;<span class="op" id="3429130">*</span><span class="ident" id="3429131">inputBytes</span><span class="op" id="3429141">)</span>&nbsp;<span class="ident" id="3429143">step</span><span class="op" id="3429147">(</span><span class="ident" id="3429148">pos</span>&nbsp;<span class="builtintype" id="3429152">int</span><span class="op" id="3429155">)</span>&nbsp;<span class="op" id="3429157">(</span><span class="builtintype" id="3429158">rune</span><span class="op" id="3429162">,</span>&nbsp;<span class="builtintype" id="3429164">int</span><span class="op" id="3429167">)</span>&nbsp;<span class="op" id="3429169">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429172">if</span>&nbsp;<span class="ident" id="3429175">pos</span>&nbsp;<span class="op" id="3429179">&lt;</span>&nbsp;<span class="builtinfunc" id="3429181">len</span><span class="op" id="3429184">(</span><span class="ident" id="3429185">i</span><span class="op" id="3429186">.</span><span class="ident" id="3429187">str</span><span class="op" id="3429190">)</span>&nbsp;<span class="op" id="3429192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429196">c</span>&nbsp;<span class="op" id="3429198">:=</span>&nbsp;<span class="ident" id="3429201">i</span><span class="op" id="3429202">.</span><span class="ident" id="3429203">str</span><span class="op" id="3429206">[</span><span class="ident" id="3429207">pos</span><span class="op" id="3429210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429214">if</span>&nbsp;<span class="ident" id="3429217">c</span>&nbsp;<span class="op" id="3429219">&lt;</span>&nbsp;<span class="ident" id="3429221">utf8</span><span class="op" id="3429225">.</span><span class="ident" id="3429226">RuneSelf</span>&nbsp;<span class="op" id="3429235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429240">return</span>&nbsp;<span class="builtintype" id="3429247">rune</span><span class="op" id="3429251">(</span><span class="ident" id="3429252">c</span><span class="op" id="3429253">)</span><span class="op" id="3429254">,</span>&nbsp;<span class="num" id="3429256">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3429260">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429264">return</span>&nbsp;<span class="ident" id="3429271">utf8</span><span class="op" id="3429275">.</span><span class="ident" id="3429276">DecodeRune</span><span class="op" id="3429286">(</span><span class="ident" id="3429287">i</span><span class="op" id="3429288">.</span><span class="ident" id="3429289">str</span><span class="op" id="3429292">[</span><span class="ident" id="3429293">pos</span><span class="op" id="3429296">:</span><span class="op" id="3429297">]</span><span class="op" id="3429298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3429301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429304">return</span>&nbsp;<span class="ident" id="3429311">endOfText</span><span class="op" id="3429320">,</span>&nbsp;<span class="num" id="3429322">0</span><br>
<span class="lineno"></span><span class="op" id="3429324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="3429327">func</span>&nbsp;<span class="op" id="3429332">(</span><span class="ident" id="3429333">i</span>&nbsp;<span class="op" id="3429335">*</span><span class="ident" id="3429336">inputBytes</span><span class="op" id="3429346">)</span>&nbsp;<span class="ident" id="3429348">canCheckPrefix</span><span class="op" id="3429362">(</span><span class="op" id="3429363">)</span>&nbsp;<span class="builtintype" id="3429365">bool</span>&nbsp;<span class="op" id="3429370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429373">return</span>&nbsp;<span class="builtintype" id="3429380">true</span><br>
<span class="lineno"></span><span class="op" id="3429385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429388">func</span>&nbsp;<span class="op" id="3429393">(</span><span class="ident" id="3429394">i</span>&nbsp;<span class="op" id="3429396">*</span><span class="ident" id="3429397">inputBytes</span><span class="op" id="3429407">)</span>&nbsp;<span class="ident" id="3429409">hasPrefix</span><span class="op" id="3429418">(</span><span class="ident" id="3429419">re</span>&nbsp;<span class="op" id="3429422">*</span><span class="ident" id="3429423">Regexp</span><span class="op" id="3429429">)</span>&nbsp;<span class="builtintype" id="3429431">bool</span>&nbsp;<span class="op" id="3429436">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429439">return</span>&nbsp;<span class="ident" id="3429446">bytes</span><span class="op" id="3429451">.</span><span class="ident" id="3429452">HasPrefix</span><span class="op" id="3429461">(</span><span class="ident" id="3429462">i</span><span class="op" id="3429463">.</span><span class="ident" id="3429464">str</span><span class="op" id="3429467">,</span>&nbsp;<span class="ident" id="3429469">re</span><span class="op" id="3429471">.</span><span class="ident" id="3429472">prefixBytes</span><span class="op" id="3429483">)</span><br>
<span class="lineno"></span><span class="op" id="3429485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429488">func</span>&nbsp;<span class="op" id="3429493">(</span><span class="ident" id="3429494">i</span>&nbsp;<span class="op" id="3429496">*</span><span class="ident" id="3429497">inputBytes</span><span class="op" id="3429507">)</span>&nbsp;<span class="ident" id="3429509">index</span><span class="op" id="3429514">(</span><span class="ident" id="3429515">re</span>&nbsp;<span class="op" id="3429518">*</span><span class="ident" id="3429519">Regexp</span><span class="op" id="3429525">,</span>&nbsp;<span class="ident" id="3429527">pos</span>&nbsp;<span class="builtintype" id="3429531">int</span><span class="op" id="3429534">)</span>&nbsp;<span class="builtintype" id="3429536">int</span>&nbsp;<span class="op" id="3429540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429543">return</span>&nbsp;<span class="ident" id="3429550">bytes</span><span class="op" id="3429555">.</span><span class="ident" id="3429556">Index</span><span class="op" id="3429561">(</span><span class="ident" id="3429562">i</span><span class="op" id="3429563">.</span><span class="ident" id="3429564">str</span><span class="op" id="3429567">[</span><span class="ident" id="3429568">pos</span><span class="op" id="3429571">:</span><span class="op" id="3429572">]</span><span class="op" id="3429573">,</span>&nbsp;<span class="ident" id="3429575">re</span><span class="op" id="3429577">.</span><span class="ident" id="3429578">prefixBytes</span><span class="op" id="3429589">)</span><br>
<span class="lineno">335</span><span class="op" id="3429591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429594">func</span>&nbsp;<span class="op" id="3429599">(</span><span class="ident" id="3429600">i</span>&nbsp;<span class="op" id="3429602">*</span><span class="ident" id="3429603">inputBytes</span><span class="op" id="3429613">)</span>&nbsp;<span class="ident" id="3429615">context</span><span class="op" id="3429622">(</span><span class="ident" id="3429623">pos</span>&nbsp;<span class="builtintype" id="3429627">int</span><span class="op" id="3429630">)</span>&nbsp;<span class="ident" id="3429632">syntax</span><span class="op" id="3429638">.</span><span class="ident" id="3429639">EmptyOp</span>&nbsp;<span class="op" id="3429647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429650">r1</span><span class="op" id="3429652">,</span>&nbsp;<span class="ident" id="3429654">r2</span>&nbsp;<span class="op" id="3429657">:=</span>&nbsp;<span class="ident" id="3429660">endOfText</span><span class="op" id="3429669">,</span>&nbsp;<span class="ident" id="3429671">endOfText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429682">if</span>&nbsp;<span class="ident" id="3429685">pos</span>&nbsp;<span class="op" id="3429689">&gt;</span>&nbsp;<span class="num" id="3429691">0</span>&nbsp;<span class="op" id="3429693">&amp;&amp;</span>&nbsp;<span class="ident" id="3429696">pos</span>&nbsp;<span class="op" id="3429700">&lt;=</span>&nbsp;<span class="builtinfunc" id="3429703">len</span><span class="op" id="3429706">(</span><span class="ident" id="3429707">i</span><span class="op" id="3429708">.</span><span class="ident" id="3429709">str</span><span class="op" id="3429712">)</span>&nbsp;<span class="op" id="3429714">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429718">r1</span><span class="op" id="3429720">,</span>&nbsp;<span class="ident" id="3429722">_</span>&nbsp;<span class="op" id="3429724">=</span>&nbsp;<span class="ident" id="3429726">utf8</span><span class="op" id="3429730">.</span><span class="ident" id="3429731">DecodeLastRune</span><span class="op" id="3429745">(</span><span class="ident" id="3429746">i</span><span class="op" id="3429747">.</span><span class="ident" id="3429748">str</span><span class="op" id="3429751">[</span><span class="op" id="3429752">:</span><span class="ident" id="3429753">pos</span><span class="op" id="3429756">]</span><span class="op" id="3429757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3429760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429763">if</span>&nbsp;<span class="ident" id="3429766">pos</span>&nbsp;<span class="op" id="3429770">&lt;</span>&nbsp;<span class="builtinfunc" id="3429772">len</span><span class="op" id="3429775">(</span><span class="ident" id="3429776">i</span><span class="op" id="3429777">.</span><span class="ident" id="3429778">str</span><span class="op" id="3429781">)</span>&nbsp;<span class="op" id="3429783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429787">r2</span><span class="op" id="3429789">,</span>&nbsp;<span class="ident" id="3429791">_</span>&nbsp;<span class="op" id="3429793">=</span>&nbsp;<span class="ident" id="3429795">utf8</span><span class="op" id="3429799">.</span><span class="ident" id="3429800">DecodeRune</span><span class="op" id="3429810">(</span><span class="ident" id="3429811">i</span><span class="op" id="3429812">.</span><span class="ident" id="3429813">str</span><span class="op" id="3429816">[</span><span class="ident" id="3429817">pos</span><span class="op" id="3429820">:</span><span class="op" id="3429821">]</span><span class="op" id="3429822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3429825">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3429828">return</span>&nbsp;<span class="ident" id="3429835">syntax</span><span class="op" id="3429841">.</span><span class="ident" id="3429842">EmptyOpContext</span><span class="op" id="3429856">(</span><span class="ident" id="3429857">r1</span><span class="op" id="3429859">,</span>&nbsp;<span class="ident" id="3429861">r2</span><span class="op" id="3429863">)</span><br>
<span class="lineno"></span><span class="op" id="3429865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3429868">//&nbsp;inputReader&nbsp;scans&nbsp;a&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="3429903">type</span>&nbsp;<span class="ident" id="3429908">inputReader</span>&nbsp;<span class="keyword" id="3429920">struct</span>&nbsp;<span class="op" id="3429927">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429930">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429936">io</span><span class="op" id="3429938">.</span><span class="ident" id="3429939">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429951">atEOT</span>&nbsp;<span class="builtintype" id="3429957">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3429963">pos</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3429969">int</span><br>
<span class="lineno"></span><span class="op" id="3429973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="3429976">func</span>&nbsp;<span class="op" id="3429981">(</span><span class="ident" id="3429982">i</span>&nbsp;<span class="op" id="3429984">*</span><span class="ident" id="3429985">inputReader</span><span class="op" id="3429996">)</span>&nbsp;<span class="ident" id="3429998">step</span><span class="op" id="3430002">(</span><span class="ident" id="3430003">pos</span>&nbsp;<span class="builtintype" id="3430007">int</span><span class="op" id="3430010">)</span>&nbsp;<span class="op" id="3430012">(</span><span class="builtintype" id="3430013">rune</span><span class="op" id="3430017">,</span>&nbsp;<span class="builtintype" id="3430019">int</span><span class="op" id="3430022">)</span>&nbsp;<span class="op" id="3430024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430027">if</span>&nbsp;<span class="op" id="3430030">!</span><span class="ident" id="3430031">i</span><span class="op" id="3430032">.</span><span class="ident" id="3430033">atEOT</span>&nbsp;<span class="op" id="3430039">&amp;&amp;</span>&nbsp;<span class="ident" id="3430042">pos</span>&nbsp;<span class="op" id="3430046">!=</span>&nbsp;<span class="ident" id="3430049">i</span><span class="op" id="3430050">.</span><span class="ident" id="3430051">pos</span>&nbsp;<span class="op" id="3430055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430059">return</span>&nbsp;<span class="ident" id="3430066">endOfText</span><span class="op" id="3430075">,</span>&nbsp;<span class="num" id="3430077">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3430081">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3430084">r</span><span class="op" id="3430085">,</span>&nbsp;<span class="ident" id="3430087">w</span><span class="op" id="3430088">,</span>&nbsp;<span class="ident" id="3430090">err</span>&nbsp;<span class="op" id="3430094">:=</span>&nbsp;<span class="ident" id="3430097">i</span><span class="op" id="3430098">.</span><span class="ident" id="3430099">r</span><span class="op" id="3430100">.</span><span class="ident" id="3430101">ReadRune</span><span class="op" id="3430109">(</span><span class="op" id="3430110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430113">if</span>&nbsp;<span class="ident" id="3430116">err</span>&nbsp;<span class="op" id="3430120">!=</span>&nbsp;<span class="builtintype" id="3430123">nil</span>&nbsp;<span class="op" id="3430127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3430131">i</span><span class="op" id="3430132">.</span><span class="ident" id="3430133">atEOT</span>&nbsp;<span class="op" id="3430139">=</span>&nbsp;<span class="builtintype" id="3430141">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430148">return</span>&nbsp;<span class="ident" id="3430155">endOfText</span><span class="op" id="3430164">,</span>&nbsp;<span class="num" id="3430166">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3430169">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3430172">i</span><span class="op" id="3430173">.</span><span class="ident" id="3430174">pos</span>&nbsp;<span class="op" id="3430178">+=</span>&nbsp;<span class="ident" id="3430181">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430184">return</span>&nbsp;<span class="ident" id="3430191">r</span><span class="op" id="3430192">,</span>&nbsp;<span class="ident" id="3430194">w</span><br>
<span class="lineno"></span><span class="op" id="3430196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3430199">func</span>&nbsp;<span class="op" id="3430204">(</span><span class="ident" id="3430205">i</span>&nbsp;<span class="op" id="3430207">*</span><span class="ident" id="3430208">inputReader</span><span class="op" id="3430219">)</span>&nbsp;<span class="ident" id="3430221">canCheckPrefix</span><span class="op" id="3430235">(</span><span class="op" id="3430236">)</span>&nbsp;<span class="builtintype" id="3430238">bool</span>&nbsp;<span class="op" id="3430243">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430246">return</span>&nbsp;<span class="builtintype" id="3430253">false</span><br>
<span class="lineno"></span><span class="op" id="3430259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3430262">func</span>&nbsp;<span class="op" id="3430267">(</span><span class="ident" id="3430268">i</span>&nbsp;<span class="op" id="3430270">*</span><span class="ident" id="3430271">inputReader</span><span class="op" id="3430282">)</span>&nbsp;<span class="ident" id="3430284">hasPrefix</span><span class="op" id="3430293">(</span><span class="ident" id="3430294">re</span>&nbsp;<span class="op" id="3430297">*</span><span class="ident" id="3430298">Regexp</span><span class="op" id="3430304">)</span>&nbsp;<span class="builtintype" id="3430306">bool</span>&nbsp;<span class="op" id="3430311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430314">return</span>&nbsp;<span class="builtintype" id="3430321">false</span><br>
<span class="lineno">375</span><span class="op" id="3430327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3430330">func</span>&nbsp;<span class="op" id="3430335">(</span><span class="ident" id="3430336">i</span>&nbsp;<span class="op" id="3430338">*</span><span class="ident" id="3430339">inputReader</span><span class="op" id="3430350">)</span>&nbsp;<span class="ident" id="3430352">index</span><span class="op" id="3430357">(</span><span class="ident" id="3430358">re</span>&nbsp;<span class="op" id="3430361">*</span><span class="ident" id="3430362">Regexp</span><span class="op" id="3430368">,</span>&nbsp;<span class="ident" id="3430370">pos</span>&nbsp;<span class="builtintype" id="3430374">int</span><span class="op" id="3430377">)</span>&nbsp;<span class="builtintype" id="3430379">int</span>&nbsp;<span class="op" id="3430383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430386">return</span>&nbsp;<span class="op" id="3430393">-</span><span class="num" id="3430394">1</span><br>
<span class="lineno"></span><span class="op" id="3430396">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="keyword" id="3430399">func</span>&nbsp;<span class="op" id="3430404">(</span><span class="ident" id="3430405">i</span>&nbsp;<span class="op" id="3430407">*</span><span class="ident" id="3430408">inputReader</span><span class="op" id="3430419">)</span>&nbsp;<span class="ident" id="3430421">context</span><span class="op" id="3430428">(</span><span class="ident" id="3430429">pos</span>&nbsp;<span class="builtintype" id="3430433">int</span><span class="op" id="3430436">)</span>&nbsp;<span class="ident" id="3430438">syntax</span><span class="op" id="3430444">.</span><span class="ident" id="3430445">EmptyOp</span>&nbsp;<span class="op" id="3430453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430456">return</span>&nbsp;<span class="num" id="3430463">0</span><br>
<span class="lineno"></span><span class="op" id="3430465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="3430468">//&nbsp;LiteralPrefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;must&nbsp;begin&nbsp;any&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="3430536">//&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;re.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;boolean&nbsp;true&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3430605">//&nbsp;literal&nbsp;string&nbsp;comprises&nbsp;the&nbsp;entire&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="3430664">func</span>&nbsp;<span class="op" id="3430669">(</span><span class="ident" id="3430670">re</span>&nbsp;<span class="op" id="3430673">*</span><span class="ident" id="3430674">Regexp</span><span class="op" id="3430680">)</span>&nbsp;<span class="ident" id="3430682">LiteralPrefix</span><span class="op" id="3430695">(</span><span class="op" id="3430696">)</span>&nbsp;<span class="op" id="3430698">(</span><span class="ident" id="3430699">prefix</span>&nbsp;<span class="builtintype" id="3430706">string</span><span class="op" id="3430712">,</span>&nbsp;<span class="ident" id="3430714">complete</span>&nbsp;<span class="builtintype" id="3430723">bool</span><span class="op" id="3430727">)</span>&nbsp;<span class="op" id="3430729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430732">return</span>&nbsp;<span class="ident" id="3430739">re</span><span class="op" id="3430741">.</span><span class="ident" id="3430742">prefix</span><span class="op" id="3430748">,</span>&nbsp;<span class="ident" id="3430750">re</span><span class="op" id="3430752">.</span><span class="ident" id="3430753">prefixComplete</span><br>
<span class="lineno">390</span><span class="op" id="3430768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3430771">//&nbsp;MatchReader&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;text&nbsp;read&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3430842">//&nbsp;RuneReader.</span><br>
<span class="lineno"></span><span class="keyword" id="3430857">func</span>&nbsp;<span class="op" id="3430862">(</span><span class="ident" id="3430863">re</span>&nbsp;<span class="op" id="3430866">*</span><span class="ident" id="3430867">Regexp</span><span class="op" id="3430873">)</span>&nbsp;<span class="ident" id="3430875">MatchReader</span><span class="op" id="3430886">(</span><span class="ident" id="3430887">r</span>&nbsp;<span class="ident" id="3430889">io</span><span class="op" id="3430891">.</span><span class="ident" id="3430892">RuneReader</span><span class="op" id="3430902">)</span>&nbsp;<span class="builtintype" id="3430904">bool</span>&nbsp;<span class="op" id="3430909">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3430912">return</span>&nbsp;<span class="ident" id="3430919">re</span><span class="op" id="3430921">.</span><span class="ident" id="3430922">doExecute</span><span class="op" id="3430931">(</span><span class="ident" id="3430932">r</span><span class="op" id="3430933">,</span>&nbsp;<span class="builtintype" id="3430935">nil</span><span class="op" id="3430938">,</span>&nbsp;<span class="string" id="3430940">&#34;&#34;</span><span class="op" id="3430942">,</span>&nbsp;<span class="num" id="3430944">0</span><span class="op" id="3430945">,</span>&nbsp;<span class="num" id="3430947">0</span><span class="op" id="3430948">)</span>&nbsp;<span class="op" id="3430950">!=</span>&nbsp;<span class="builtintype" id="3430953">nil</span><br>
<span class="lineno"></span><span class="op" id="3430957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3430960">//&nbsp;MatchString&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3431024">func</span>&nbsp;<span class="op" id="3431029">(</span><span class="ident" id="3431030">re</span>&nbsp;<span class="op" id="3431033">*</span><span class="ident" id="3431034">Regexp</span><span class="op" id="3431040">)</span>&nbsp;<span class="ident" id="3431042">MatchString</span><span class="op" id="3431053">(</span><span class="ident" id="3431054">s</span>&nbsp;<span class="builtintype" id="3431056">string</span><span class="op" id="3431062">)</span>&nbsp;<span class="builtintype" id="3431064">bool</span>&nbsp;<span class="op" id="3431069">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431072">return</span>&nbsp;<span class="ident" id="3431079">re</span><span class="op" id="3431081">.</span><span class="ident" id="3431082">doExecute</span><span class="op" id="3431091">(</span><span class="builtintype" id="3431092">nil</span><span class="op" id="3431095">,</span>&nbsp;<span class="builtintype" id="3431097">nil</span><span class="op" id="3431100">,</span>&nbsp;<span class="ident" id="3431102">s</span><span class="op" id="3431103">,</span>&nbsp;<span class="num" id="3431105">0</span><span class="op" id="3431106">,</span>&nbsp;<span class="num" id="3431108">0</span><span class="op" id="3431109">)</span>&nbsp;<span class="op" id="3431111">!=</span>&nbsp;<span class="builtintype" id="3431114">nil</span><br>
<span class="lineno"></span><span class="op" id="3431118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3431121">//&nbsp;Match&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Regexp&nbsp;matches&nbsp;the&nbsp;byte&nbsp;slice&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3431183">func</span>&nbsp;<span class="op" id="3431188">(</span><span class="ident" id="3431189">re</span>&nbsp;<span class="op" id="3431192">*</span><span class="ident" id="3431193">Regexp</span><span class="op" id="3431199">)</span>&nbsp;<span class="ident" id="3431201">Match</span><span class="op" id="3431206">(</span><span class="ident" id="3431207">b</span>&nbsp;<span class="op" id="3431209">[</span><span class="op" id="3431210">]</span><span class="builtintype" id="3431211">byte</span><span class="op" id="3431215">)</span>&nbsp;<span class="builtintype" id="3431217">bool</span>&nbsp;<span class="op" id="3431222">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431225">return</span>&nbsp;<span class="ident" id="3431232">re</span><span class="op" id="3431234">.</span><span class="ident" id="3431235">doExecute</span><span class="op" id="3431244">(</span><span class="builtintype" id="3431245">nil</span><span class="op" id="3431248">,</span>&nbsp;<span class="ident" id="3431250">b</span><span class="op" id="3431251">,</span>&nbsp;<span class="string" id="3431253">&#34;&#34;</span><span class="op" id="3431255">,</span>&nbsp;<span class="num" id="3431257">0</span><span class="op" id="3431258">,</span>&nbsp;<span class="num" id="3431260">0</span><span class="op" id="3431261">)</span>&nbsp;<span class="op" id="3431263">!=</span>&nbsp;<span class="builtintype" id="3431266">nil</span><br>
<span class="lineno"></span><span class="op" id="3431270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3431273">//&nbsp;MatchReader&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression&nbsp;matches&nbsp;the&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="3431349">//&nbsp;read&nbsp;by&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and</span><br>
<span class="lineno">410</span><span class="comment" id="3431426">//&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3431456">func</span>&nbsp;<span class="ident" id="3431461">MatchReader</span><span class="op" id="3431472">(</span><span class="ident" id="3431473">pattern</span>&nbsp;<span class="builtintype" id="3431481">string</span><span class="op" id="3431487">,</span>&nbsp;<span class="ident" id="3431489">r</span>&nbsp;<span class="ident" id="3431491">io</span><span class="op" id="3431493">.</span><span class="ident" id="3431494">RuneReader</span><span class="op" id="3431504">)</span>&nbsp;<span class="op" id="3431506">(</span><span class="ident" id="3431507">matched</span>&nbsp;<span class="builtintype" id="3431515">bool</span><span class="op" id="3431519">,</span>&nbsp;<span class="ident" id="3431521">err</span>&nbsp;<span class="builtintype" id="3431525">error</span><span class="op" id="3431530">)</span>&nbsp;<span class="op" id="3431532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431535">re</span><span class="op" id="3431537">,</span>&nbsp;<span class="ident" id="3431539">err</span>&nbsp;<span class="op" id="3431543">:=</span>&nbsp;<span class="ident" id="3431546">Compile</span><span class="op" id="3431553">(</span><span class="ident" id="3431554">pattern</span><span class="op" id="3431561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431564">if</span>&nbsp;<span class="ident" id="3431567">err</span>&nbsp;<span class="op" id="3431571">!=</span>&nbsp;<span class="builtintype" id="3431574">nil</span>&nbsp;<span class="op" id="3431578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431582">return</span>&nbsp;<span class="builtintype" id="3431589">false</span><span class="op" id="3431594">,</span>&nbsp;<span class="ident" id="3431596">err</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3431601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431604">return</span>&nbsp;<span class="ident" id="3431611">re</span><span class="op" id="3431613">.</span><span class="ident" id="3431614">MatchReader</span><span class="op" id="3431625">(</span><span class="ident" id="3431626">r</span><span class="op" id="3431627">)</span><span class="op" id="3431628">,</span>&nbsp;<span class="builtintype" id="3431630">nil</span><br>
<span class="lineno"></span><span class="op" id="3431634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3431637">//&nbsp;MatchString&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno">420</span><span class="comment" id="3431696">//&nbsp;matches&nbsp;a&nbsp;string.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3431748">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3431797">func</span>&nbsp;<span class="ident" id="3431802">MatchString</span><span class="op" id="3431813">(</span><span class="ident" id="3431814">pattern</span>&nbsp;<span class="builtintype" id="3431822">string</span><span class="op" id="3431828">,</span>&nbsp;<span class="ident" id="3431830">s</span>&nbsp;<span class="builtintype" id="3431832">string</span><span class="op" id="3431838">)</span>&nbsp;<span class="op" id="3431840">(</span><span class="ident" id="3431841">matched</span>&nbsp;<span class="builtintype" id="3431849">bool</span><span class="op" id="3431853">,</span>&nbsp;<span class="ident" id="3431855">err</span>&nbsp;<span class="builtintype" id="3431859">error</span><span class="op" id="3431864">)</span>&nbsp;<span class="op" id="3431866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3431869">re</span><span class="op" id="3431871">,</span>&nbsp;<span class="ident" id="3431873">err</span>&nbsp;<span class="op" id="3431877">:=</span>&nbsp;<span class="ident" id="3431880">Compile</span><span class="op" id="3431887">(</span><span class="ident" id="3431888">pattern</span><span class="op" id="3431895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431898">if</span>&nbsp;<span class="ident" id="3431901">err</span>&nbsp;<span class="op" id="3431905">!=</span>&nbsp;<span class="builtintype" id="3431908">nil</span>&nbsp;<span class="op" id="3431912">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431916">return</span>&nbsp;<span class="builtintype" id="3431923">false</span><span class="op" id="3431928">,</span>&nbsp;<span class="ident" id="3431930">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3431935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3431938">return</span>&nbsp;<span class="ident" id="3431945">re</span><span class="op" id="3431947">.</span><span class="ident" id="3431948">MatchString</span><span class="op" id="3431959">(</span><span class="ident" id="3431960">s</span><span class="op" id="3431961">)</span><span class="op" id="3431962">,</span>&nbsp;<span class="builtintype" id="3431964">nil</span><br>
<span class="lineno"></span><span class="op" id="3431968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="3431971">//&nbsp;Match&nbsp;checks&nbsp;whether&nbsp;a&nbsp;textual&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="3432024">//&nbsp;matches&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;&nbsp;More&nbsp;complicated&nbsp;queries&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3432080">//&nbsp;to&nbsp;use&nbsp;Compile&nbsp;and&nbsp;the&nbsp;full&nbsp;Regexp&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3432129">func</span>&nbsp;<span class="ident" id="3432134">Match</span><span class="op" id="3432139">(</span><span class="ident" id="3432140">pattern</span>&nbsp;<span class="builtintype" id="3432148">string</span><span class="op" id="3432154">,</span>&nbsp;<span class="ident" id="3432156">b</span>&nbsp;<span class="op" id="3432158">[</span><span class="op" id="3432159">]</span><span class="builtintype" id="3432160">byte</span><span class="op" id="3432164">)</span>&nbsp;<span class="op" id="3432166">(</span><span class="ident" id="3432167">matched</span>&nbsp;<span class="builtintype" id="3432175">bool</span><span class="op" id="3432179">,</span>&nbsp;<span class="ident" id="3432181">err</span>&nbsp;<span class="builtintype" id="3432185">error</span><span class="op" id="3432190">)</span>&nbsp;<span class="op" id="3432192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432195">re</span><span class="op" id="3432197">,</span>&nbsp;<span class="ident" id="3432199">err</span>&nbsp;<span class="op" id="3432203">:=</span>&nbsp;<span class="ident" id="3432206">Compile</span><span class="op" id="3432213">(</span><span class="ident" id="3432214">pattern</span><span class="op" id="3432221">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432224">if</span>&nbsp;<span class="ident" id="3432227">err</span>&nbsp;<span class="op" id="3432231">!=</span>&nbsp;<span class="builtintype" id="3432234">nil</span>&nbsp;<span class="op" id="3432238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432242">return</span>&nbsp;<span class="builtintype" id="3432249">false</span><span class="op" id="3432254">,</span>&nbsp;<span class="ident" id="3432256">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432264">return</span>&nbsp;<span class="ident" id="3432271">re</span><span class="op" id="3432273">.</span><span class="ident" id="3432274">Match</span><span class="op" id="3432279">(</span><span class="ident" id="3432280">b</span><span class="op" id="3432281">)</span><span class="op" id="3432282">,</span>&nbsp;<span class="builtintype" id="3432284">nil</span><br>
<span class="lineno"></span><span class="op" id="3432288">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="3432291">//&nbsp;ReplaceAllString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="3432366">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3432444">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="3432520">func</span>&nbsp;<span class="op" id="3432525">(</span><span class="ident" id="3432526">re</span>&nbsp;<span class="op" id="3432529">*</span><span class="ident" id="3432530">Regexp</span><span class="op" id="3432536">)</span>&nbsp;<span class="ident" id="3432538">ReplaceAllString</span><span class="op" id="3432554">(</span><span class="ident" id="3432555">src</span><span class="op" id="3432558">,</span>&nbsp;<span class="ident" id="3432560">repl</span>&nbsp;<span class="builtintype" id="3432565">string</span><span class="op" id="3432571">)</span>&nbsp;<span class="builtintype" id="3432573">string</span>&nbsp;<span class="op" id="3432580">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432583">n</span>&nbsp;<span class="op" id="3432585">:=</span>&nbsp;<span class="num" id="3432588">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432591">if</span>&nbsp;<span class="ident" id="3432594">strings</span><span class="op" id="3432601">.</span><span class="ident" id="3432602">Index</span><span class="op" id="3432607">(</span><span class="ident" id="3432608">repl</span><span class="op" id="3432612">,</span>&nbsp;<span class="string" id="3432614">&#34;$&#34;</span><span class="op" id="3432617">)</span>&nbsp;<span class="op" id="3432619">&gt;=</span>&nbsp;<span class="num" id="3432622">0</span>&nbsp;<span class="op" id="3432624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432628">n</span>&nbsp;<span class="op" id="3432630">=</span>&nbsp;<span class="num" id="3432632">2</span>&nbsp;<span class="op" id="3432634">*</span>&nbsp;<span class="op" id="3432636">(</span><span class="ident" id="3432637">re</span><span class="op" id="3432639">.</span><span class="ident" id="3432640">numSubexp</span>&nbsp;<span class="op" id="3432650">+</span>&nbsp;<span class="num" id="3432652">1</span><span class="op" id="3432653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3432659">b</span>&nbsp;<span class="op" id="3432661">:=</span>&nbsp;<span class="ident" id="3432664">re</span><span class="op" id="3432666">.</span><span class="ident" id="3432667">replaceAll</span><span class="op" id="3432677">(</span><span class="builtintype" id="3432678">nil</span><span class="op" id="3432681">,</span>&nbsp;<span class="ident" id="3432683">src</span><span class="op" id="3432686">,</span>&nbsp;<span class="ident" id="3432688">n</span><span class="op" id="3432689">,</span>&nbsp;<span class="keyword" id="3432691">func</span><span class="op" id="3432695">(</span><span class="ident" id="3432696">dst</span>&nbsp;<span class="op" id="3432700">[</span><span class="op" id="3432701">]</span><span class="builtintype" id="3432702">byte</span><span class="op" id="3432706">,</span>&nbsp;<span class="ident" id="3432708">match</span>&nbsp;<span class="op" id="3432714">[</span><span class="op" id="3432715">]</span><span class="builtintype" id="3432716">int</span><span class="op" id="3432719">)</span>&nbsp;<span class="op" id="3432721">[</span><span class="op" id="3432722">]</span><span class="builtintype" id="3432723">byte</span>&nbsp;<span class="op" id="3432728">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432732">return</span>&nbsp;<span class="ident" id="3432739">re</span><span class="op" id="3432741">.</span><span class="ident" id="3432742">expand</span><span class="op" id="3432748">(</span><span class="ident" id="3432749">dst</span><span class="op" id="3432752">,</span>&nbsp;<span class="ident" id="3432754">repl</span><span class="op" id="3432758">,</span>&nbsp;<span class="builtintype" id="3432760">nil</span><span class="op" id="3432763">,</span>&nbsp;<span class="ident" id="3432765">src</span><span class="op" id="3432768">,</span>&nbsp;<span class="ident" id="3432770">match</span><span class="op" id="3432775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432778">}</span><span class="op" id="3432779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3432782">return</span>&nbsp;<span class="builtintype" id="3432789">string</span><span class="op" id="3432795">(</span><span class="ident" id="3432796">b</span><span class="op" id="3432797">)</span><br>
<span class="lineno"></span><span class="op" id="3432799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="3432802">//&nbsp;ReplaceAllLiteralString&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="3432884">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;string&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno"></span><span class="comment" id="3432968">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="3432993">func</span>&nbsp;<span class="op" id="3432998">(</span><span class="ident" id="3432999">re</span>&nbsp;<span class="op" id="3433002">*</span><span class="ident" id="3433003">Regexp</span><span class="op" id="3433009">)</span>&nbsp;<span class="ident" id="3433011">ReplaceAllLiteralString</span><span class="op" id="3433034">(</span><span class="ident" id="3433035">src</span><span class="op" id="3433038">,</span>&nbsp;<span class="ident" id="3433040">repl</span>&nbsp;<span class="builtintype" id="3433045">string</span><span class="op" id="3433051">)</span>&nbsp;<span class="builtintype" id="3433053">string</span>&nbsp;<span class="op" id="3433060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433063">return</span>&nbsp;<span class="builtintype" id="3433070">string</span><span class="op" id="3433076">(</span><span class="ident" id="3433077">re</span><span class="op" id="3433079">.</span><span class="ident" id="3433080">replaceAll</span><span class="op" id="3433090">(</span><span class="builtintype" id="3433091">nil</span><span class="op" id="3433094">,</span>&nbsp;<span class="ident" id="3433096">src</span><span class="op" id="3433099">,</span>&nbsp;<span class="num" id="3433101">2</span><span class="op" id="3433102">,</span>&nbsp;<span class="keyword" id="3433104">func</span><span class="op" id="3433108">(</span><span class="ident" id="3433109">dst</span>&nbsp;<span class="op" id="3433113">[</span><span class="op" id="3433114">]</span><span class="builtintype" id="3433115">byte</span><span class="op" id="3433119">,</span>&nbsp;<span class="ident" id="3433121">match</span>&nbsp;<span class="op" id="3433127">[</span><span class="op" id="3433128">]</span><span class="builtintype" id="3433129">int</span><span class="op" id="3433132">)</span>&nbsp;<span class="op" id="3433134">[</span><span class="op" id="3433135">]</span><span class="builtintype" id="3433136">byte</span>&nbsp;<span class="op" id="3433141">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433145">return</span>&nbsp;<span class="builtinfunc" id="3433152">append</span><span class="op" id="3433158">(</span><span class="ident" id="3433159">dst</span><span class="op" id="3433162">,</span>&nbsp;<span class="ident" id="3433164">repl</span><span class="op" id="3433168">...</span><span class="op" id="3433171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433174">}</span><span class="op" id="3433175">)</span><span class="op" id="3433176">)</span><br>
<span class="lineno"></span><span class="op" id="3433178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3433181">//&nbsp;ReplaceAllStringFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno">465</span><span class="comment" id="3433255">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="3433329">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;substring.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno"></span><span class="comment" id="3433407">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="3433442">func</span>&nbsp;<span class="op" id="3433447">(</span><span class="ident" id="3433448">re</span>&nbsp;<span class="op" id="3433451">*</span><span class="ident" id="3433452">Regexp</span><span class="op" id="3433458">)</span>&nbsp;<span class="ident" id="3433460">ReplaceAllStringFunc</span><span class="op" id="3433480">(</span><span class="ident" id="3433481">src</span>&nbsp;<span class="builtintype" id="3433485">string</span><span class="op" id="3433491">,</span>&nbsp;<span class="ident" id="3433493">repl</span>&nbsp;<span class="keyword" id="3433498">func</span><span class="op" id="3433502">(</span><span class="builtintype" id="3433503">string</span><span class="op" id="3433509">)</span>&nbsp;<span class="builtintype" id="3433511">string</span><span class="op" id="3433517">)</span>&nbsp;<span class="builtintype" id="3433519">string</span>&nbsp;<span class="op" id="3433526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433529">b</span>&nbsp;<span class="op" id="3433531">:=</span>&nbsp;<span class="ident" id="3433534">re</span><span class="op" id="3433536">.</span><span class="ident" id="3433537">replaceAll</span><span class="op" id="3433547">(</span><span class="builtintype" id="3433548">nil</span><span class="op" id="3433551">,</span>&nbsp;<span class="ident" id="3433553">src</span><span class="op" id="3433556">,</span>&nbsp;<span class="num" id="3433558">2</span><span class="op" id="3433559">,</span>&nbsp;<span class="keyword" id="3433561">func</span><span class="op" id="3433565">(</span><span class="ident" id="3433566">dst</span>&nbsp;<span class="op" id="3433570">[</span><span class="op" id="3433571">]</span><span class="builtintype" id="3433572">byte</span><span class="op" id="3433576">,</span>&nbsp;<span class="ident" id="3433578">match</span>&nbsp;<span class="op" id="3433584">[</span><span class="op" id="3433585">]</span><span class="builtintype" id="3433586">int</span><span class="op" id="3433589">)</span>&nbsp;<span class="op" id="3433591">[</span><span class="op" id="3433592">]</span><span class="builtintype" id="3433593">byte</span>&nbsp;<span class="op" id="3433598">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433602">return</span>&nbsp;<span class="builtinfunc" id="3433609">append</span><span class="op" id="3433615">(</span><span class="ident" id="3433616">dst</span><span class="op" id="3433619">,</span>&nbsp;<span class="ident" id="3433621">repl</span><span class="op" id="3433625">(</span><span class="ident" id="3433626">src</span><span class="op" id="3433629">[</span><span class="ident" id="3433630">match</span><span class="op" id="3433635">[</span><span class="num" id="3433636">0</span><span class="op" id="3433637">]</span><span class="op" id="3433638">:</span><span class="ident" id="3433639">match</span><span class="op" id="3433644">[</span><span class="num" id="3433645">1</span><span class="op" id="3433646">]</span><span class="op" id="3433647">]</span><span class="op" id="3433648">)</span><span class="op" id="3433649">...</span><span class="op" id="3433652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433655">}</span><span class="op" id="3433656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433659">return</span>&nbsp;<span class="builtintype" id="3433666">string</span><span class="op" id="3433672">(</span><span class="ident" id="3433673">b</span><span class="op" id="3433674">)</span><br>
<span class="lineno"></span><span class="op" id="3433676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="3433679">func</span>&nbsp;<span class="op" id="3433684">(</span><span class="ident" id="3433685">re</span>&nbsp;<span class="op" id="3433688">*</span><span class="ident" id="3433689">Regexp</span><span class="op" id="3433695">)</span>&nbsp;<span class="ident" id="3433697">replaceAll</span><span class="op" id="3433707">(</span><span class="ident" id="3433708">bsrc</span>&nbsp;<span class="op" id="3433713">[</span><span class="op" id="3433714">]</span><span class="builtintype" id="3433715">byte</span><span class="op" id="3433719">,</span>&nbsp;<span class="ident" id="3433721">src</span>&nbsp;<span class="builtintype" id="3433725">string</span><span class="op" id="3433731">,</span>&nbsp;<span class="ident" id="3433733">nmatch</span>&nbsp;<span class="builtintype" id="3433740">int</span><span class="op" id="3433743">,</span>&nbsp;<span class="ident" id="3433745">repl</span>&nbsp;<span class="keyword" id="3433750">func</span><span class="op" id="3433754">(</span><span class="ident" id="3433755">dst</span>&nbsp;<span class="op" id="3433759">[</span><span class="op" id="3433760">]</span><span class="builtintype" id="3433761">byte</span><span class="op" id="3433765">,</span>&nbsp;<span class="ident" id="3433767">m</span>&nbsp;<span class="op" id="3433769">[</span><span class="op" id="3433770">]</span><span class="builtintype" id="3433771">int</span><span class="op" id="3433774">)</span>&nbsp;<span class="op" id="3433776">[</span><span class="op" id="3433777">]</span><span class="builtintype" id="3433778">byte</span><span class="op" id="3433782">)</span>&nbsp;<span class="op" id="3433784">[</span><span class="op" id="3433785">]</span><span class="builtintype" id="3433786">byte</span>&nbsp;<span class="op" id="3433791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433794">lastMatchEnd</span>&nbsp;<span class="op" id="3433807">:=</span>&nbsp;<span class="num" id="3433810">0</span>&nbsp;<span class="comment" id="3433812">//&nbsp;end&nbsp;position&nbsp;of&nbsp;the&nbsp;most&nbsp;recent&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433854">searchPos</span>&nbsp;<span class="op" id="3433864">:=</span>&nbsp;<span class="num" id="3433867">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3433872">//&nbsp;position&nbsp;where&nbsp;we&nbsp;next&nbsp;look&nbsp;for&nbsp;a&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433916">var</span>&nbsp;<span class="ident" id="3433920">buf</span>&nbsp;<span class="op" id="3433924">[</span><span class="op" id="3433925">]</span><span class="builtintype" id="3433926">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433932">var</span>&nbsp;<span class="ident" id="3433936">endPos</span>&nbsp;<span class="builtintype" id="3433943">int</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3433948">if</span>&nbsp;<span class="ident" id="3433951">bsrc</span>&nbsp;<span class="op" id="3433956">!=</span>&nbsp;<span class="builtintype" id="3433959">nil</span>&nbsp;<span class="op" id="3433963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433967">endPos</span>&nbsp;<span class="op" id="3433974">=</span>&nbsp;<span class="builtinfunc" id="3433976">len</span><span class="op" id="3433979">(</span><span class="ident" id="3433980">bsrc</span><span class="op" id="3433984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3433987">}</span>&nbsp;<span class="keyword" id="3433989">else</span>&nbsp;<span class="op" id="3433994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3433998">endPos</span>&nbsp;<span class="op" id="3434005">=</span>&nbsp;<span class="builtinfunc" id="3434007">len</span><span class="op" id="3434010">(</span><span class="ident" id="3434011">src</span><span class="op" id="3434014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434017">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434020">for</span>&nbsp;<span class="ident" id="3434024">searchPos</span>&nbsp;<span class="op" id="3434034">&lt;=</span>&nbsp;<span class="ident" id="3434037">endPos</span>&nbsp;<span class="op" id="3434044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434048">a</span>&nbsp;<span class="op" id="3434050">:=</span>&nbsp;<span class="ident" id="3434053">re</span><span class="op" id="3434055">.</span><span class="ident" id="3434056">doExecute</span><span class="op" id="3434065">(</span><span class="builtintype" id="3434066">nil</span><span class="op" id="3434069">,</span>&nbsp;<span class="ident" id="3434071">bsrc</span><span class="op" id="3434075">,</span>&nbsp;<span class="ident" id="3434077">src</span><span class="op" id="3434080">,</span>&nbsp;<span class="ident" id="3434082">searchPos</span><span class="op" id="3434091">,</span>&nbsp;<span class="ident" id="3434093">nmatch</span><span class="op" id="3434099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434103">if</span>&nbsp;<span class="builtinfunc" id="3434106">len</span><span class="op" id="3434109">(</span><span class="ident" id="3434110">a</span><span class="op" id="3434111">)</span>&nbsp;<span class="op" id="3434113">==</span>&nbsp;<span class="num" id="3434116">0</span>&nbsp;<span class="op" id="3434118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434123">break</span>&nbsp;<span class="comment" id="3434129">//&nbsp;no&nbsp;more&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434150">}</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434155">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;before&nbsp;this&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434209">if</span>&nbsp;<span class="ident" id="3434212">bsrc</span>&nbsp;<span class="op" id="3434217">!=</span>&nbsp;<span class="builtintype" id="3434220">nil</span>&nbsp;<span class="op" id="3434224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434229">buf</span>&nbsp;<span class="op" id="3434233">=</span>&nbsp;<span class="builtinfunc" id="3434235">append</span><span class="op" id="3434241">(</span><span class="ident" id="3434242">buf</span><span class="op" id="3434245">,</span>&nbsp;<span class="ident" id="3434247">bsrc</span><span class="op" id="3434251">[</span><span class="ident" id="3434252">lastMatchEnd</span><span class="op" id="3434264">:</span><span class="ident" id="3434265">a</span><span class="op" id="3434266">[</span><span class="num" id="3434267">0</span><span class="op" id="3434268">]</span><span class="op" id="3434269">]</span><span class="op" id="3434270">...</span><span class="op" id="3434273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434277">}</span>&nbsp;<span class="keyword" id="3434279">else</span>&nbsp;<span class="op" id="3434284">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434289">buf</span>&nbsp;<span class="op" id="3434293">=</span>&nbsp;<span class="builtinfunc" id="3434295">append</span><span class="op" id="3434301">(</span><span class="ident" id="3434302">buf</span><span class="op" id="3434305">,</span>&nbsp;<span class="ident" id="3434307">src</span><span class="op" id="3434310">[</span><span class="ident" id="3434311">lastMatchEnd</span><span class="op" id="3434323">:</span><span class="ident" id="3434324">a</span><span class="op" id="3434325">[</span><span class="num" id="3434326">0</span><span class="op" id="3434327">]</span><span class="op" id="3434328">]</span><span class="op" id="3434329">...</span><span class="op" id="3434332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434341">//&nbsp;Now&nbsp;insert&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;replacement&nbsp;string,&nbsp;but&nbsp;not&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434405">//&nbsp;match&nbsp;of&nbsp;the&nbsp;empty&nbsp;string&nbsp;immediately&nbsp;after&nbsp;another&nbsp;match.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434469">//&nbsp;(Otherwise,&nbsp;we&nbsp;get&nbsp;double&nbsp;replacement&nbsp;for&nbsp;patterns&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434530">//&nbsp;match&nbsp;both&nbsp;empty&nbsp;and&nbsp;nonempty&nbsp;strings.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434575">if</span>&nbsp;<span class="ident" id="3434578">a</span><span class="op" id="3434579">[</span><span class="num" id="3434580">1</span><span class="op" id="3434581">]</span>&nbsp;<span class="op" id="3434583">&gt;</span>&nbsp;<span class="ident" id="3434585">lastMatchEnd</span>&nbsp;<span class="op" id="3434598">||</span>&nbsp;<span class="ident" id="3434601">a</span><span class="op" id="3434602">[</span><span class="num" id="3434603">0</span><span class="op" id="3434604">]</span>&nbsp;<span class="op" id="3434606">==</span>&nbsp;<span class="num" id="3434609">0</span>&nbsp;<span class="op" id="3434611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434616">buf</span>&nbsp;<span class="op" id="3434620">=</span>&nbsp;<span class="ident" id="3434622">repl</span><span class="op" id="3434626">(</span><span class="ident" id="3434627">buf</span><span class="op" id="3434630">,</span>&nbsp;<span class="ident" id="3434632">a</span><span class="op" id="3434633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434637">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434641">lastMatchEnd</span>&nbsp;<span class="op" id="3434654">=</span>&nbsp;<span class="ident" id="3434656">a</span><span class="op" id="3434657">[</span><span class="num" id="3434658">1</span><span class="op" id="3434659">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434664">//&nbsp;Advance&nbsp;past&nbsp;this&nbsp;match;&nbsp;always&nbsp;advance&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434733">var</span>&nbsp;<span class="ident" id="3434737">width</span>&nbsp;<span class="builtintype" id="3434743">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434749">if</span>&nbsp;<span class="ident" id="3434752">bsrc</span>&nbsp;<span class="op" id="3434757">!=</span>&nbsp;<span class="builtintype" id="3434760">nil</span>&nbsp;<span class="op" id="3434764">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434769">_</span><span class="op" id="3434770">,</span>&nbsp;<span class="ident" id="3434772">width</span>&nbsp;<span class="op" id="3434778">=</span>&nbsp;<span class="ident" id="3434780">utf8</span><span class="op" id="3434784">.</span><span class="ident" id="3434785">DecodeRune</span><span class="op" id="3434795">(</span><span class="ident" id="3434796">bsrc</span><span class="op" id="3434800">[</span><span class="ident" id="3434801">searchPos</span><span class="op" id="3434810">:</span><span class="op" id="3434811">]</span><span class="op" id="3434812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434816">}</span>&nbsp;<span class="keyword" id="3434818">else</span>&nbsp;<span class="op" id="3434823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434828">_</span><span class="op" id="3434829">,</span>&nbsp;<span class="ident" id="3434831">width</span>&nbsp;<span class="op" id="3434837">=</span>&nbsp;<span class="ident" id="3434839">utf8</span><span class="op" id="3434843">.</span><span class="ident" id="3434844">DecodeRuneInString</span><span class="op" id="3434862">(</span><span class="ident" id="3434863">src</span><span class="op" id="3434866">[</span><span class="ident" id="3434867">searchPos</span><span class="op" id="3434876">:</span><span class="op" id="3434877">]</span><span class="op" id="3434878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3434886">if</span>&nbsp;<span class="ident" id="3434889">searchPos</span><span class="op" id="3434898">+</span><span class="ident" id="3434899">width</span>&nbsp;<span class="op" id="3434905">&gt;</span>&nbsp;<span class="ident" id="3434907">a</span><span class="op" id="3434908">[</span><span class="num" id="3434909">1</span><span class="op" id="3434910">]</span>&nbsp;<span class="op" id="3434912">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434917">searchPos</span>&nbsp;<span class="op" id="3434927">+=</span>&nbsp;<span class="ident" id="3434930">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3434938">}</span>&nbsp;<span class="keyword" id="3434940">else</span>&nbsp;<span class="keyword" id="3434945">if</span>&nbsp;<span class="ident" id="3434948">searchPos</span><span class="op" id="3434957">+</span><span class="num" id="3434958">1</span>&nbsp;<span class="op" id="3434960">&gt;</span>&nbsp;<span class="ident" id="3434962">a</span><span class="op" id="3434963">[</span><span class="num" id="3434964">1</span><span class="op" id="3434965">]</span>&nbsp;<span class="op" id="3434967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3434972">//&nbsp;This&nbsp;clause&nbsp;is&nbsp;only&nbsp;needed&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3435029">//&nbsp;string.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;DecodeRuneInString&nbsp;returns&nbsp;width=0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435094">searchPos</span><span class="op" id="3435103">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435108">}</span>&nbsp;<span class="keyword" id="3435110">else</span>&nbsp;<span class="op" id="3435115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435120">searchPos</span>&nbsp;<span class="op" id="3435130">=</span>&nbsp;<span class="ident" id="3435132">a</span><span class="op" id="3435133">[</span><span class="num" id="3435134">1</span><span class="op" id="3435135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3435146">//&nbsp;Copy&nbsp;the&nbsp;unmatched&nbsp;characters&nbsp;after&nbsp;the&nbsp;last&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435202">if</span>&nbsp;<span class="ident" id="3435205">bsrc</span>&nbsp;<span class="op" id="3435210">!=</span>&nbsp;<span class="builtintype" id="3435213">nil</span>&nbsp;<span class="op" id="3435217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435221">buf</span>&nbsp;<span class="op" id="3435225">=</span>&nbsp;<span class="builtinfunc" id="3435227">append</span><span class="op" id="3435233">(</span><span class="ident" id="3435234">buf</span><span class="op" id="3435237">,</span>&nbsp;<span class="ident" id="3435239">bsrc</span><span class="op" id="3435243">[</span><span class="ident" id="3435244">lastMatchEnd</span><span class="op" id="3435256">:</span><span class="op" id="3435257">]</span><span class="op" id="3435258">...</span><span class="op" id="3435261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435264">}</span>&nbsp;<span class="keyword" id="3435266">else</span>&nbsp;<span class="op" id="3435271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435275">buf</span>&nbsp;<span class="op" id="3435279">=</span>&nbsp;<span class="builtinfunc" id="3435281">append</span><span class="op" id="3435287">(</span><span class="ident" id="3435288">buf</span><span class="op" id="3435291">,</span>&nbsp;<span class="ident" id="3435293">src</span><span class="op" id="3435296">[</span><span class="ident" id="3435297">lastMatchEnd</span><span class="op" id="3435309">:</span><span class="op" id="3435310">]</span><span class="op" id="3435311">...</span><span class="op" id="3435314">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435321">return</span>&nbsp;<span class="ident" id="3435328">buf</span><br>
<span class="lineno"></span><span class="op" id="3435332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="3435335">//&nbsp;ReplaceAll&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="3435404">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;text&nbsp;repl.&nbsp;&nbsp;Inside&nbsp;repl,&nbsp;$&nbsp;signs&nbsp;are&nbsp;interpreted&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3435480">//&nbsp;in&nbsp;Expand,&nbsp;so&nbsp;for&nbsp;instance&nbsp;$1&nbsp;represents&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;first&nbsp;submatch.</span><br>
<span class="lineno"></span><span class="keyword" id="3435556">func</span>&nbsp;<span class="op" id="3435561">(</span><span class="ident" id="3435562">re</span>&nbsp;<span class="op" id="3435565">*</span><span class="ident" id="3435566">Regexp</span><span class="op" id="3435572">)</span>&nbsp;<span class="ident" id="3435574">ReplaceAll</span><span class="op" id="3435584">(</span><span class="ident" id="3435585">src</span><span class="op" id="3435588">,</span>&nbsp;<span class="ident" id="3435590">repl</span>&nbsp;<span class="op" id="3435595">[</span><span class="op" id="3435596">]</span><span class="builtintype" id="3435597">byte</span><span class="op" id="3435601">)</span>&nbsp;<span class="op" id="3435603">[</span><span class="op" id="3435604">]</span><span class="builtintype" id="3435605">byte</span>&nbsp;<span class="op" id="3435610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435613">n</span>&nbsp;<span class="op" id="3435615">:=</span>&nbsp;<span class="num" id="3435618">2</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435621">if</span>&nbsp;<span class="ident" id="3435624">bytes</span><span class="op" id="3435629">.</span><span class="ident" id="3435630">IndexByte</span><span class="op" id="3435639">(</span><span class="ident" id="3435640">repl</span><span class="op" id="3435644">,</span>&nbsp;<span class="string" id="3435646">&#39;$&#39;</span><span class="op" id="3435649">)</span>&nbsp;<span class="op" id="3435651">&gt;=</span>&nbsp;<span class="num" id="3435654">0</span>&nbsp;<span class="op" id="3435656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435660">n</span>&nbsp;<span class="op" id="3435662">=</span>&nbsp;<span class="num" id="3435664">2</span>&nbsp;<span class="op" id="3435666">*</span>&nbsp;<span class="op" id="3435668">(</span><span class="ident" id="3435669">re</span><span class="op" id="3435671">.</span><span class="ident" id="3435672">numSubexp</span>&nbsp;<span class="op" id="3435682">+</span>&nbsp;<span class="num" id="3435684">1</span><span class="op" id="3435685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435691">srepl</span>&nbsp;<span class="op" id="3435697">:=</span>&nbsp;<span class="string" id="3435700">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435704">b</span>&nbsp;<span class="op" id="3435706">:=</span>&nbsp;<span class="ident" id="3435709">re</span><span class="op" id="3435711">.</span><span class="ident" id="3435712">replaceAll</span><span class="op" id="3435722">(</span><span class="ident" id="3435723">src</span><span class="op" id="3435726">,</span>&nbsp;<span class="string" id="3435728">&#34;&#34;</span><span class="op" id="3435730">,</span>&nbsp;<span class="ident" id="3435732">n</span><span class="op" id="3435733">,</span>&nbsp;<span class="keyword" id="3435735">func</span><span class="op" id="3435739">(</span><span class="ident" id="3435740">dst</span>&nbsp;<span class="op" id="3435744">[</span><span class="op" id="3435745">]</span><span class="builtintype" id="3435746">byte</span><span class="op" id="3435750">,</span>&nbsp;<span class="ident" id="3435752">match</span>&nbsp;<span class="op" id="3435758">[</span><span class="op" id="3435759">]</span><span class="builtintype" id="3435760">int</span><span class="op" id="3435763">)</span>&nbsp;<span class="op" id="3435765">[</span><span class="op" id="3435766">]</span><span class="builtintype" id="3435767">byte</span>&nbsp;<span class="op" id="3435772">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435776">if</span>&nbsp;<span class="builtinfunc" id="3435779">len</span><span class="op" id="3435782">(</span><span class="ident" id="3435783">srepl</span><span class="op" id="3435788">)</span>&nbsp;<span class="op" id="3435790">!=</span>&nbsp;<span class="builtinfunc" id="3435793">len</span><span class="op" id="3435796">(</span><span class="ident" id="3435797">repl</span><span class="op" id="3435801">)</span>&nbsp;<span class="op" id="3435803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3435808">srepl</span>&nbsp;<span class="op" id="3435814">=</span>&nbsp;<span class="builtintype" id="3435816">string</span><span class="op" id="3435822">(</span><span class="ident" id="3435823">repl</span><span class="op" id="3435827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435835">return</span>&nbsp;<span class="ident" id="3435842">re</span><span class="op" id="3435844">.</span><span class="ident" id="3435845">expand</span><span class="op" id="3435851">(</span><span class="ident" id="3435852">dst</span><span class="op" id="3435855">,</span>&nbsp;<span class="ident" id="3435857">srepl</span><span class="op" id="3435862">,</span>&nbsp;<span class="ident" id="3435864">src</span><span class="op" id="3435867">,</span>&nbsp;<span class="string" id="3435869">&#34;&#34;</span><span class="op" id="3435871">,</span>&nbsp;<span class="ident" id="3435873">match</span><span class="op" id="3435878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3435881">}</span><span class="op" id="3435882">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3435885">return</span>&nbsp;<span class="ident" id="3435892">b</span><br>
<span class="lineno"></span><span class="op" id="3435894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3435897">//&nbsp;ReplaceAllLiteral&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src,&nbsp;replacing&nbsp;matches&nbsp;of&nbsp;the&nbsp;Regexp</span><br>
<span class="lineno"></span><span class="comment" id="3435973">//&nbsp;with&nbsp;the&nbsp;replacement&nbsp;bytes&nbsp;repl.&nbsp;&nbsp;The&nbsp;replacement&nbsp;repl&nbsp;is&nbsp;substituted&nbsp;directly,</span><br>
<span class="lineno">555</span><span class="comment" id="3436056">//&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="3436081">func</span>&nbsp;<span class="op" id="3436086">(</span><span class="ident" id="3436087">re</span>&nbsp;<span class="op" id="3436090">*</span><span class="ident" id="3436091">Regexp</span><span class="op" id="3436097">)</span>&nbsp;<span class="ident" id="3436099">ReplaceAllLiteral</span><span class="op" id="3436116">(</span><span class="ident" id="3436117">src</span><span class="op" id="3436120">,</span>&nbsp;<span class="ident" id="3436122">repl</span>&nbsp;<span class="op" id="3436127">[</span><span class="op" id="3436128">]</span><span class="builtintype" id="3436129">byte</span><span class="op" id="3436133">)</span>&nbsp;<span class="op" id="3436135">[</span><span class="op" id="3436136">]</span><span class="builtintype" id="3436137">byte</span>&nbsp;<span class="op" id="3436142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436145">return</span>&nbsp;<span class="ident" id="3436152">re</span><span class="op" id="3436154">.</span><span class="ident" id="3436155">replaceAll</span><span class="op" id="3436165">(</span><span class="ident" id="3436166">src</span><span class="op" id="3436169">,</span>&nbsp;<span class="string" id="3436171">&#34;&#34;</span><span class="op" id="3436173">,</span>&nbsp;<span class="num" id="3436175">2</span><span class="op" id="3436176">,</span>&nbsp;<span class="keyword" id="3436178">func</span><span class="op" id="3436182">(</span><span class="ident" id="3436183">dst</span>&nbsp;<span class="op" id="3436187">[</span><span class="op" id="3436188">]</span><span class="builtintype" id="3436189">byte</span><span class="op" id="3436193">,</span>&nbsp;<span class="ident" id="3436195">match</span>&nbsp;<span class="op" id="3436201">[</span><span class="op" id="3436202">]</span><span class="builtintype" id="3436203">int</span><span class="op" id="3436206">)</span>&nbsp;<span class="op" id="3436208">[</span><span class="op" id="3436209">]</span><span class="builtintype" id="3436210">byte</span>&nbsp;<span class="op" id="3436215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436219">return</span>&nbsp;<span class="builtinfunc" id="3436226">append</span><span class="op" id="3436232">(</span><span class="ident" id="3436233">dst</span><span class="op" id="3436236">,</span>&nbsp;<span class="ident" id="3436238">repl</span><span class="op" id="3436242">...</span><span class="op" id="3436245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436248">}</span><span class="op" id="3436249">)</span><br>
<span class="lineno">560</span><span class="op" id="3436251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3436254">//&nbsp;ReplaceAllFunc&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;src&nbsp;in&nbsp;which&nbsp;all&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3436322">//&nbsp;Regexp&nbsp;have&nbsp;been&nbsp;replaced&nbsp;by&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;function&nbsp;repl&nbsp;applied</span><br>
<span class="lineno"></span><span class="comment" id="3436396">//&nbsp;to&nbsp;the&nbsp;matched&nbsp;byte&nbsp;slice.&nbsp;&nbsp;The&nbsp;replacement&nbsp;returned&nbsp;by&nbsp;repl&nbsp;is&nbsp;substituted</span><br>
<span class="lineno">565</span><span class="comment" id="3436475">//&nbsp;directly,&nbsp;without&nbsp;using&nbsp;Expand.</span><br>
<span class="lineno"></span><span class="keyword" id="3436510">func</span>&nbsp;<span class="op" id="3436515">(</span><span class="ident" id="3436516">re</span>&nbsp;<span class="op" id="3436519">*</span><span class="ident" id="3436520">Regexp</span><span class="op" id="3436526">)</span>&nbsp;<span class="ident" id="3436528">ReplaceAllFunc</span><span class="op" id="3436542">(</span><span class="ident" id="3436543">src</span>&nbsp;<span class="op" id="3436547">[</span><span class="op" id="3436548">]</span><span class="builtintype" id="3436549">byte</span><span class="op" id="3436553">,</span>&nbsp;<span class="ident" id="3436555">repl</span>&nbsp;<span class="keyword" id="3436560">func</span><span class="op" id="3436564">(</span><span class="op" id="3436565">[</span><span class="op" id="3436566">]</span><span class="builtintype" id="3436567">byte</span><span class="op" id="3436571">)</span>&nbsp;<span class="op" id="3436573">[</span><span class="op" id="3436574">]</span><span class="builtintype" id="3436575">byte</span><span class="op" id="3436579">)</span>&nbsp;<span class="op" id="3436581">[</span><span class="op" id="3436582">]</span><span class="builtintype" id="3436583">byte</span>&nbsp;<span class="op" id="3436588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436591">return</span>&nbsp;<span class="ident" id="3436598">re</span><span class="op" id="3436600">.</span><span class="ident" id="3436601">replaceAll</span><span class="op" id="3436611">(</span><span class="ident" id="3436612">src</span><span class="op" id="3436615">,</span>&nbsp;<span class="string" id="3436617">&#34;&#34;</span><span class="op" id="3436619">,</span>&nbsp;<span class="num" id="3436621">2</span><span class="op" id="3436622">,</span>&nbsp;<span class="keyword" id="3436624">func</span><span class="op" id="3436628">(</span><span class="ident" id="3436629">dst</span>&nbsp;<span class="op" id="3436633">[</span><span class="op" id="3436634">]</span><span class="builtintype" id="3436635">byte</span><span class="op" id="3436639">,</span>&nbsp;<span class="ident" id="3436641">match</span>&nbsp;<span class="op" id="3436647">[</span><span class="op" id="3436648">]</span><span class="builtintype" id="3436649">int</span><span class="op" id="3436652">)</span>&nbsp;<span class="op" id="3436654">[</span><span class="op" id="3436655">]</span><span class="builtintype" id="3436656">byte</span>&nbsp;<span class="op" id="3436661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436665">return</span>&nbsp;<span class="builtinfunc" id="3436672">append</span><span class="op" id="3436678">(</span><span class="ident" id="3436679">dst</span><span class="op" id="3436682">,</span>&nbsp;<span class="ident" id="3436684">repl</span><span class="op" id="3436688">(</span><span class="ident" id="3436689">src</span><span class="op" id="3436692">[</span><span class="ident" id="3436693">match</span><span class="op" id="3436698">[</span><span class="num" id="3436699">0</span><span class="op" id="3436700">]</span><span class="op" id="3436701">:</span><span class="ident" id="3436702">match</span><span class="op" id="3436707">[</span><span class="num" id="3436708">1</span><span class="op" id="3436709">]</span><span class="op" id="3436710">]</span><span class="op" id="3436711">)</span><span class="op" id="3436712">...</span><span class="op" id="3436715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3436718">}</span><span class="op" id="3436719">)</span><br>
<span class="lineno">570</span><span class="op" id="3436721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3436724">var</span>&nbsp;<span class="ident" id="3436728">specialBytes</span>&nbsp;<span class="op" id="3436741">=</span>&nbsp;<span class="op" id="3436743">[</span><span class="op" id="3436744">]</span><span class="builtintype" id="3436745">byte</span><span class="op" id="3436749">(</span><span class="string" id="3436750">`\.+*?()|[]{}^$`</span><span class="op" id="3436766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3436769">func</span>&nbsp;<span class="ident" id="3436774">special</span><span class="op" id="3436781">(</span><span class="ident" id="3436782">b</span>&nbsp;<span class="builtintype" id="3436784">byte</span><span class="op" id="3436788">)</span>&nbsp;<span class="builtintype" id="3436790">bool</span>&nbsp;<span class="op" id="3436795">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3436798">return</span>&nbsp;<span class="ident" id="3436805">bytes</span><span class="op" id="3436810">.</span><span class="ident" id="3436811">IndexByte</span><span class="op" id="3436820">(</span><span class="ident" id="3436821">specialBytes</span><span class="op" id="3436833">,</span>&nbsp;<span class="ident" id="3436835">b</span><span class="op" id="3436836">)</span>&nbsp;<span class="op" id="3436838">&gt;=</span>&nbsp;<span class="num" id="3436841">0</span><br>
<span class="lineno"></span><span class="op" id="3436843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3436846">//&nbsp;QuoteMeta&nbsp;returns&nbsp;a&nbsp;string&nbsp;that&nbsp;quotes&nbsp;all&nbsp;regular&nbsp;expression&nbsp;metacharacters</span><br>
<span class="lineno"></span><span class="comment" id="3436926">//&nbsp;inside&nbsp;the&nbsp;argument&nbsp;text;&nbsp;the&nbsp;returned&nbsp;string&nbsp;is&nbsp;a&nbsp;regular&nbsp;expression&nbsp;matching</span><br>
<span class="lineno">580</span><span class="comment" id="3437008">//&nbsp;the&nbsp;literal&nbsp;text.&nbsp;&nbsp;For&nbsp;example,&nbsp;QuoteMeta(`[foo]`)&nbsp;returns&nbsp;`\[foo\]`.</span><br>
<span class="lineno"></span><span class="keyword" id="3437081">func</span>&nbsp;<span class="ident" id="3437086">QuoteMeta</span><span class="op" id="3437095">(</span><span class="ident" id="3437096">s</span>&nbsp;<span class="builtintype" id="3437098">string</span><span class="op" id="3437104">)</span>&nbsp;<span class="builtintype" id="3437106">string</span>&nbsp;<span class="op" id="3437113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437116">b</span>&nbsp;<span class="op" id="3437118">:=</span>&nbsp;<span class="builtinfunc" id="3437121">make</span><span class="op" id="3437125">(</span><span class="op" id="3437126">[</span><span class="op" id="3437127">]</span><span class="builtintype" id="3437128">byte</span><span class="op" id="3437132">,</span>&nbsp;<span class="num" id="3437134">2</span><span class="op" id="3437135">*</span><span class="builtinfunc" id="3437136">len</span><span class="op" id="3437139">(</span><span class="ident" id="3437140">s</span><span class="op" id="3437141">)</span><span class="op" id="3437142">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3437146">//&nbsp;A&nbsp;byte&nbsp;loop&nbsp;is&nbsp;correct&nbsp;because&nbsp;all&nbsp;metacharacters&nbsp;are&nbsp;ASCII.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437211">j</span>&nbsp;<span class="op" id="3437213">:=</span>&nbsp;<span class="num" id="3437216">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437219">for</span>&nbsp;<span class="ident" id="3437223">i</span>&nbsp;<span class="op" id="3437225">:=</span>&nbsp;<span class="num" id="3437228">0</span><span class="op" id="3437229">;</span>&nbsp;<span class="ident" id="3437231">i</span>&nbsp;<span class="op" id="3437233">&lt;</span>&nbsp;<span class="builtinfunc" id="3437235">len</span><span class="op" id="3437238">(</span><span class="ident" id="3437239">s</span><span class="op" id="3437240">)</span><span class="op" id="3437241">;</span>&nbsp;<span class="ident" id="3437243">i</span><span class="op" id="3437244">++</span>&nbsp;<span class="op" id="3437247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437251">if</span>&nbsp;<span class="ident" id="3437254">special</span><span class="op" id="3437261">(</span><span class="ident" id="3437262">s</span><span class="op" id="3437263">[</span><span class="ident" id="3437264">i</span><span class="op" id="3437265">]</span><span class="op" id="3437266">)</span>&nbsp;<span class="op" id="3437268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437273">b</span><span class="op" id="3437274">[</span><span class="ident" id="3437275">j</span><span class="op" id="3437276">]</span>&nbsp;<span class="op" id="3437278">=</span>&nbsp;<span class="string" id="3437280">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437288">j</span><span class="op" id="3437289">++</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437298">b</span><span class="op" id="3437299">[</span><span class="ident" id="3437300">j</span><span class="op" id="3437301">]</span>&nbsp;<span class="op" id="3437303">=</span>&nbsp;<span class="ident" id="3437305">s</span><span class="op" id="3437306">[</span><span class="ident" id="3437307">i</span><span class="op" id="3437308">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437312">j</span><span class="op" id="3437313">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437320">return</span>&nbsp;<span class="builtintype" id="3437327">string</span><span class="op" id="3437333">(</span><span class="ident" id="3437334">b</span><span class="op" id="3437335">[</span><span class="num" id="3437336">0</span><span class="op" id="3437337">:</span><span class="ident" id="3437338">j</span><span class="op" id="3437339">]</span><span class="op" id="3437340">)</span><br>
<span class="lineno">595</span><span class="op" id="3437342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3437345">//&nbsp;The&nbsp;number&nbsp;of&nbsp;capture&nbsp;values&nbsp;in&nbsp;the&nbsp;program&nbsp;may&nbsp;correspond</span><br>
<span class="lineno"></span><span class="comment" id="3437407">//&nbsp;to&nbsp;fewer&nbsp;capturing&nbsp;expressions&nbsp;than&nbsp;are&nbsp;in&nbsp;the&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="comment" id="3437465">//&nbsp;For&nbsp;example,&nbsp;&#34;(a){0}&#34;&nbsp;turns&nbsp;into&nbsp;an&nbsp;empty&nbsp;program,&nbsp;so&nbsp;the</span><br>
<span class="lineno">600</span><span class="comment" id="3437526">//&nbsp;maximum&nbsp;capture&nbsp;in&nbsp;the&nbsp;program&nbsp;is&nbsp;0&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3437587">//&nbsp;an&nbsp;expression&nbsp;for&nbsp;\1.&nbsp;&nbsp;Pad&nbsp;appends&nbsp;-1s&nbsp;to&nbsp;the&nbsp;slice&nbsp;a&nbsp;as&nbsp;needed.</span><br>
<span class="lineno"></span><span class="keyword" id="3437655">func</span>&nbsp;<span class="op" id="3437660">(</span><span class="ident" id="3437661">re</span>&nbsp;<span class="op" id="3437664">*</span><span class="ident" id="3437665">Regexp</span><span class="op" id="3437671">)</span>&nbsp;<span class="ident" id="3437673">pad</span><span class="op" id="3437676">(</span><span class="ident" id="3437677">a</span>&nbsp;<span class="op" id="3437679">[</span><span class="op" id="3437680">]</span><span class="builtintype" id="3437681">int</span><span class="op" id="3437684">)</span>&nbsp;<span class="op" id="3437686">[</span><span class="op" id="3437687">]</span><span class="builtintype" id="3437688">int</span>&nbsp;<span class="op" id="3437692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437695">if</span>&nbsp;<span class="ident" id="3437698">a</span>&nbsp;<span class="op" id="3437700">==</span>&nbsp;<span class="builtintype" id="3437703">nil</span>&nbsp;<span class="op" id="3437707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3437711">//&nbsp;No&nbsp;match.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437726">return</span>&nbsp;<span class="builtintype" id="3437733">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437741">n</span>&nbsp;<span class="op" id="3437743">:=</span>&nbsp;<span class="op" id="3437746">(</span><span class="num" id="3437747">1</span>&nbsp;<span class="op" id="3437749">+</span>&nbsp;<span class="ident" id="3437751">re</span><span class="op" id="3437753">.</span><span class="ident" id="3437754">numSubexp</span><span class="op" id="3437763">)</span>&nbsp;<span class="op" id="3437765">*</span>&nbsp;<span class="num" id="3437767">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437770">for</span>&nbsp;<span class="builtinfunc" id="3437774">len</span><span class="op" id="3437777">(</span><span class="ident" id="3437778">a</span><span class="op" id="3437779">)</span>&nbsp;<span class="op" id="3437781">&lt;</span>&nbsp;<span class="ident" id="3437783">n</span>&nbsp;<span class="op" id="3437785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3437789">a</span>&nbsp;<span class="op" id="3437791">=</span>&nbsp;<span class="builtinfunc" id="3437793">append</span><span class="op" id="3437799">(</span><span class="ident" id="3437800">a</span><span class="op" id="3437801">,</span>&nbsp;<span class="op" id="3437803">-</span><span class="num" id="3437804">1</span><span class="op" id="3437805">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3437808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437811">return</span>&nbsp;<span class="ident" id="3437818">a</span><br>
<span class="lineno"></span><span class="op" id="3437820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3437823">//&nbsp;Find&nbsp;matches&nbsp;in&nbsp;slice&nbsp;b&nbsp;if&nbsp;b&nbsp;is&nbsp;non-nil,&nbsp;otherwise&nbsp;find&nbsp;matches&nbsp;in&nbsp;string&nbsp;s.</span><br>
<span class="lineno">615</span><span class="keyword" id="3437903">func</span>&nbsp;<span class="op" id="3437908">(</span><span class="ident" id="3437909">re</span>&nbsp;<span class="op" id="3437912">*</span><span class="ident" id="3437913">Regexp</span><span class="op" id="3437919">)</span>&nbsp;<span class="ident" id="3437921">allMatches</span><span class="op" id="3437931">(</span><span class="ident" id="3437932">s</span>&nbsp;<span class="builtintype" id="3437934">string</span><span class="op" id="3437940">,</span>&nbsp;<span class="ident" id="3437942">b</span>&nbsp;<span class="op" id="3437944">[</span><span class="op" id="3437945">]</span><span class="builtintype" id="3437946">byte</span><span class="op" id="3437950">,</span>&nbsp;<span class="ident" id="3437952">n</span>&nbsp;<span class="builtintype" id="3437954">int</span><span class="op" id="3437957">,</span>&nbsp;<span class="ident" id="3437959">deliver</span>&nbsp;<span class="keyword" id="3437967">func</span><span class="op" id="3437971">(</span><span class="op" id="3437972">[</span><span class="op" id="3437973">]</span><span class="builtintype" id="3437974">int</span><span class="op" id="3437977">)</span><span class="op" id="3437978">)</span>&nbsp;<span class="op" id="3437980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437983">var</span>&nbsp;<span class="ident" id="3437987">end</span>&nbsp;<span class="builtintype" id="3437991">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3437996">if</span>&nbsp;<span class="ident" id="3437999">b</span>&nbsp;<span class="op" id="3438001">==</span>&nbsp;<span class="builtintype" id="3438004">nil</span>&nbsp;<span class="op" id="3438008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438012">end</span>&nbsp;<span class="op" id="3438016">=</span>&nbsp;<span class="builtinfunc" id="3438018">len</span><span class="op" id="3438021">(</span><span class="ident" id="3438022">s</span><span class="op" id="3438023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438026">}</span>&nbsp;<span class="keyword" id="3438028">else</span>&nbsp;<span class="op" id="3438033">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438037">end</span>&nbsp;<span class="op" id="3438041">=</span>&nbsp;<span class="builtinfunc" id="3438043">len</span><span class="op" id="3438046">(</span><span class="ident" id="3438047">b</span><span class="op" id="3438048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438055">for</span>&nbsp;<span class="ident" id="3438059">pos</span><span class="op" id="3438062">,</span>&nbsp;<span class="ident" id="3438064">i</span><span class="op" id="3438065">,</span>&nbsp;<span class="ident" id="3438067">prevMatchEnd</span>&nbsp;<span class="op" id="3438080">:=</span>&nbsp;<span class="num" id="3438083">0</span><span class="op" id="3438084">,</span>&nbsp;<span class="num" id="3438086">0</span><span class="op" id="3438087">,</span>&nbsp;<span class="op" id="3438089">-</span><span class="num" id="3438090">1</span><span class="op" id="3438091">;</span>&nbsp;<span class="ident" id="3438093">i</span>&nbsp;<span class="op" id="3438095">&lt;</span>&nbsp;<span class="ident" id="3438097">n</span>&nbsp;<span class="op" id="3438099">&amp;&amp;</span>&nbsp;<span class="ident" id="3438102">pos</span>&nbsp;<span class="op" id="3438106">&lt;=</span>&nbsp;<span class="ident" id="3438109">end</span><span class="op" id="3438112">;</span>&nbsp;<span class="op" id="3438114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438118">matches</span>&nbsp;<span class="op" id="3438126">:=</span>&nbsp;<span class="ident" id="3438129">re</span><span class="op" id="3438131">.</span><span class="ident" id="3438132">doExecute</span><span class="op" id="3438141">(</span><span class="builtintype" id="3438142">nil</span><span class="op" id="3438145">,</span>&nbsp;<span class="ident" id="3438147">b</span><span class="op" id="3438148">,</span>&nbsp;<span class="ident" id="3438150">s</span><span class="op" id="3438151">,</span>&nbsp;<span class="ident" id="3438153">pos</span><span class="op" id="3438156">,</span>&nbsp;<span class="ident" id="3438158">re</span><span class="op" id="3438160">.</span><span class="ident" id="3438161">prog</span><span class="op" id="3438165">.</span><span class="ident" id="3438166">NumCap</span><span class="op" id="3438172">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438176">if</span>&nbsp;<span class="builtinfunc" id="3438179">len</span><span class="op" id="3438182">(</span><span class="ident" id="3438183">matches</span><span class="op" id="3438190">)</span>&nbsp;<span class="op" id="3438192">==</span>&nbsp;<span class="num" id="3438195">0</span>&nbsp;<span class="op" id="3438197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438202">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438215">accept</span>&nbsp;<span class="op" id="3438222">:=</span>&nbsp;<span class="builtintype" id="3438225">true</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438232">if</span>&nbsp;<span class="ident" id="3438235">matches</span><span class="op" id="3438242">[</span><span class="num" id="3438243">1</span><span class="op" id="3438244">]</span>&nbsp;<span class="op" id="3438246">==</span>&nbsp;<span class="ident" id="3438249">pos</span>&nbsp;<span class="op" id="3438253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3438258">//&nbsp;We&#39;ve&nbsp;found&nbsp;an&nbsp;empty&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438292">if</span>&nbsp;<span class="ident" id="3438295">matches</span><span class="op" id="3438302">[</span><span class="num" id="3438303">0</span><span class="op" id="3438304">]</span>&nbsp;<span class="op" id="3438306">==</span>&nbsp;<span class="ident" id="3438309">prevMatchEnd</span>&nbsp;<span class="op" id="3438322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3438328">//&nbsp;We&nbsp;don&#39;t&nbsp;allow&nbsp;an&nbsp;empty&nbsp;match&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3438371">//&nbsp;after&nbsp;a&nbsp;previous&nbsp;match,&nbsp;so&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438416">accept</span>&nbsp;<span class="op" id="3438423">=</span>&nbsp;<span class="builtintype" id="3438425">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438439">var</span>&nbsp;<span class="ident" id="3438443">width</span>&nbsp;<span class="builtintype" id="3438449">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3438456">//&nbsp;TODO:&nbsp;use&nbsp;step()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438479">if</span>&nbsp;<span class="ident" id="3438482">b</span>&nbsp;<span class="op" id="3438484">==</span>&nbsp;<span class="builtintype" id="3438487">nil</span>&nbsp;<span class="op" id="3438491">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438497">_</span><span class="op" id="3438498">,</span>&nbsp;<span class="ident" id="3438500">width</span>&nbsp;<span class="op" id="3438506">=</span>&nbsp;<span class="ident" id="3438508">utf8</span><span class="op" id="3438512">.</span><span class="ident" id="3438513">DecodeRuneInString</span><span class="op" id="3438531">(</span><span class="ident" id="3438532">s</span><span class="op" id="3438533">[</span><span class="ident" id="3438534">pos</span><span class="op" id="3438537">:</span><span class="ident" id="3438538">end</span><span class="op" id="3438541">]</span><span class="op" id="3438542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438547">}</span>&nbsp;<span class="keyword" id="3438549">else</span>&nbsp;<span class="op" id="3438554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438560">_</span><span class="op" id="3438561">,</span>&nbsp;<span class="ident" id="3438563">width</span>&nbsp;<span class="op" id="3438569">=</span>&nbsp;<span class="ident" id="3438571">utf8</span><span class="op" id="3438575">.</span><span class="ident" id="3438576">DecodeRune</span><span class="op" id="3438586">(</span><span class="ident" id="3438587">b</span><span class="op" id="3438588">[</span><span class="ident" id="3438589">pos</span><span class="op" id="3438592">:</span><span class="ident" id="3438593">end</span><span class="op" id="3438596">]</span><span class="op" id="3438597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438607">if</span>&nbsp;<span class="ident" id="3438610">width</span>&nbsp;<span class="op" id="3438616">&gt;</span>&nbsp;<span class="num" id="3438618">0</span>&nbsp;<span class="op" id="3438620">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438626">pos</span>&nbsp;<span class="op" id="3438630">+=</span>&nbsp;<span class="ident" id="3438633">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438642">}</span>&nbsp;<span class="keyword" id="3438644">else</span>&nbsp;<span class="op" id="3438649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438655">pos</span>&nbsp;<span class="op" id="3438659">=</span>&nbsp;<span class="ident" id="3438661">end</span>&nbsp;<span class="op" id="3438665">+</span>&nbsp;<span class="num" id="3438667">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438676">}</span>&nbsp;<span class="keyword" id="3438678">else</span>&nbsp;<span class="op" id="3438683">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438688">pos</span>&nbsp;<span class="op" id="3438692">=</span>&nbsp;<span class="ident" id="3438694">matches</span><span class="op" id="3438701">[</span><span class="num" id="3438702">1</span><span class="op" id="3438703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438711">prevMatchEnd</span>&nbsp;<span class="op" id="3438724">=</span>&nbsp;<span class="ident" id="3438726">matches</span><span class="op" id="3438733">[</span><span class="num" id="3438734">1</span><span class="op" id="3438735">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3438740">if</span>&nbsp;<span class="ident" id="3438743">accept</span>&nbsp;<span class="op" id="3438750">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438755">deliver</span><span class="op" id="3438762">(</span><span class="ident" id="3438763">re</span><span class="op" id="3438765">.</span><span class="ident" id="3438766">pad</span><span class="op" id="3438769">(</span><span class="ident" id="3438770">matches</span><span class="op" id="3438777">)</span><span class="op" id="3438778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438783">i</span><span class="op" id="3438784">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3438792">}</span><br>
<span class="lineno"></span><span class="op" id="3438794">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="3438797">//&nbsp;Find&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="comment" id="3438892">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3438937">func</span>&nbsp;<span class="op" id="3438942">(</span><span class="ident" id="3438943">re</span>&nbsp;<span class="op" id="3438946">*</span><span class="ident" id="3438947">Regexp</span><span class="op" id="3438953">)</span>&nbsp;<span class="ident" id="3438955">Find</span><span class="op" id="3438959">(</span><span class="ident" id="3438960">b</span>&nbsp;<span class="op" id="3438962">[</span><span class="op" id="3438963">]</span><span class="builtintype" id="3438964">byte</span><span class="op" id="3438968">)</span>&nbsp;<span class="op" id="3438970">[</span><span class="op" id="3438971">]</span><span class="builtintype" id="3438972">byte</span>&nbsp;<span class="op" id="3438977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3438980">a</span>&nbsp;<span class="op" id="3438982">:=</span>&nbsp;<span class="ident" id="3438985">re</span><span class="op" id="3438987">.</span><span class="ident" id="3438988">doExecute</span><span class="op" id="3438997">(</span><span class="builtintype" id="3438998">nil</span><span class="op" id="3439001">,</span>&nbsp;<span class="ident" id="3439003">b</span><span class="op" id="3439004">,</span>&nbsp;<span class="string" id="3439006">&#34;&#34;</span><span class="op" id="3439008">,</span>&nbsp;<span class="num" id="3439010">0</span><span class="op" id="3439011">,</span>&nbsp;<span class="num" id="3439013">2</span><span class="op" id="3439014">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439017">if</span>&nbsp;<span class="ident" id="3439020">a</span>&nbsp;<span class="op" id="3439022">==</span>&nbsp;<span class="builtintype" id="3439025">nil</span>&nbsp;<span class="op" id="3439029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439033">return</span>&nbsp;<span class="builtintype" id="3439040">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439048">return</span>&nbsp;<span class="ident" id="3439055">b</span><span class="op" id="3439056">[</span><span class="ident" id="3439057">a</span><span class="op" id="3439058">[</span><span class="num" id="3439059">0</span><span class="op" id="3439060">]</span><span class="op" id="3439061">:</span><span class="ident" id="3439062">a</span><span class="op" id="3439063">[</span><span class="num" id="3439064">1</span><span class="op" id="3439065">]</span><span class="op" id="3439066">]</span><br>
<span class="lineno"></span><span class="op" id="3439068">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="3439071">//&nbsp;FindIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the&nbsp;location&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3439149">//&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;b&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match&nbsp;itself&nbsp;is&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="3439227">//&nbsp;b[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="3439248">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">675</span><span class="keyword" id="3439293">func</span>&nbsp;<span class="op" id="3439298">(</span><span class="ident" id="3439299">re</span>&nbsp;<span class="op" id="3439302">*</span><span class="ident" id="3439303">Regexp</span><span class="op" id="3439309">)</span>&nbsp;<span class="ident" id="3439311">FindIndex</span><span class="op" id="3439320">(</span><span class="ident" id="3439321">b</span>&nbsp;<span class="op" id="3439323">[</span><span class="op" id="3439324">]</span><span class="builtintype" id="3439325">byte</span><span class="op" id="3439329">)</span>&nbsp;<span class="op" id="3439331">(</span><span class="ident" id="3439332">loc</span>&nbsp;<span class="op" id="3439336">[</span><span class="op" id="3439337">]</span><span class="builtintype" id="3439338">int</span><span class="op" id="3439341">)</span>&nbsp;<span class="op" id="3439343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439346">a</span>&nbsp;<span class="op" id="3439348">:=</span>&nbsp;<span class="ident" id="3439351">re</span><span class="op" id="3439353">.</span><span class="ident" id="3439354">doExecute</span><span class="op" id="3439363">(</span><span class="builtintype" id="3439364">nil</span><span class="op" id="3439367">,</span>&nbsp;<span class="ident" id="3439369">b</span><span class="op" id="3439370">,</span>&nbsp;<span class="string" id="3439372">&#34;&#34;</span><span class="op" id="3439374">,</span>&nbsp;<span class="num" id="3439376">0</span><span class="op" id="3439377">,</span>&nbsp;<span class="num" id="3439379">2</span><span class="op" id="3439380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439383">if</span>&nbsp;<span class="ident" id="3439386">a</span>&nbsp;<span class="op" id="3439388">==</span>&nbsp;<span class="builtintype" id="3439391">nil</span>&nbsp;<span class="op" id="3439395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439399">return</span>&nbsp;<span class="builtintype" id="3439406">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439411">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439414">return</span>&nbsp;<span class="ident" id="3439421">a</span><span class="op" id="3439422">[</span><span class="num" id="3439423">0</span><span class="op" id="3439424">:</span><span class="num" id="3439425">2</span><span class="op" id="3439426">]</span><br>
<span class="lineno"></span><span class="op" id="3439428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3439431">//&nbsp;FindString&nbsp;returns&nbsp;a&nbsp;string&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular</span><br>
<span class="lineno"></span><span class="comment" id="3439521">//&nbsp;expression.&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;match,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,</span><br>
<span class="lineno">685</span><span class="comment" id="3439596">//&nbsp;but&nbsp;it&nbsp;will&nbsp;also&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;regular&nbsp;expression&nbsp;successfully&nbsp;matches</span><br>
<span class="lineno"></span><span class="comment" id="3439672">//&nbsp;an&nbsp;empty&nbsp;string.&nbsp;&nbsp;Use&nbsp;FindStringIndex&nbsp;or&nbsp;FindStringSubmatch&nbsp;if&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3439744">//&nbsp;necessary&nbsp;to&nbsp;distinguish&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span><span class="keyword" id="3439785">func</span>&nbsp;<span class="op" id="3439790">(</span><span class="ident" id="3439791">re</span>&nbsp;<span class="op" id="3439794">*</span><span class="ident" id="3439795">Regexp</span><span class="op" id="3439801">)</span>&nbsp;<span class="ident" id="3439803">FindString</span><span class="op" id="3439813">(</span><span class="ident" id="3439814">s</span>&nbsp;<span class="builtintype" id="3439816">string</span><span class="op" id="3439822">)</span>&nbsp;<span class="builtintype" id="3439824">string</span>&nbsp;<span class="op" id="3439831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3439834">a</span>&nbsp;<span class="op" id="3439836">:=</span>&nbsp;<span class="ident" id="3439839">re</span><span class="op" id="3439841">.</span><span class="ident" id="3439842">doExecute</span><span class="op" id="3439851">(</span><span class="builtintype" id="3439852">nil</span><span class="op" id="3439855">,</span>&nbsp;<span class="builtintype" id="3439857">nil</span><span class="op" id="3439860">,</span>&nbsp;<span class="ident" id="3439862">s</span><span class="op" id="3439863">,</span>&nbsp;<span class="num" id="3439865">0</span><span class="op" id="3439866">,</span>&nbsp;<span class="num" id="3439868">2</span><span class="op" id="3439869">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439872">if</span>&nbsp;<span class="ident" id="3439875">a</span>&nbsp;<span class="op" id="3439877">==</span>&nbsp;<span class="builtintype" id="3439880">nil</span>&nbsp;<span class="op" id="3439884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439888">return</span>&nbsp;<span class="string" id="3439895">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3439899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3439902">return</span>&nbsp;<span class="ident" id="3439909">s</span><span class="op" id="3439910">[</span><span class="ident" id="3439911">a</span><span class="op" id="3439912">[</span><span class="num" id="3439913">0</span><span class="op" id="3439914">]</span><span class="op" id="3439915">:</span><span class="ident" id="3439916">a</span><span class="op" id="3439917">[</span><span class="num" id="3439918">1</span><span class="op" id="3439919">]</span><span class="op" id="3439920">]</span><br>
<span class="lineno"></span><span class="op" id="3439922">}</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span><span class="comment" id="3439925">//&nbsp;FindStringIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3439997">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression.&nbsp;&nbsp;The&nbsp;match</span><br>
<span class="lineno"></span><span class="comment" id="3440074">//&nbsp;itself&nbsp;is&nbsp;at&nbsp;s[loc[0]:loc[1]].</span><br>
<span class="lineno"></span><span class="comment" id="3440108">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">700</span><span class="keyword" id="3440153">func</span>&nbsp;<span class="op" id="3440158">(</span><span class="ident" id="3440159">re</span>&nbsp;<span class="op" id="3440162">*</span><span class="ident" id="3440163">Regexp</span><span class="op" id="3440169">)</span>&nbsp;<span class="ident" id="3440171">FindStringIndex</span><span class="op" id="3440186">(</span><span class="ident" id="3440187">s</span>&nbsp;<span class="builtintype" id="3440189">string</span><span class="op" id="3440195">)</span>&nbsp;<span class="op" id="3440197">(</span><span class="ident" id="3440198">loc</span>&nbsp;<span class="op" id="3440202">[</span><span class="op" id="3440203">]</span><span class="builtintype" id="3440204">int</span><span class="op" id="3440207">)</span>&nbsp;<span class="op" id="3440209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3440212">a</span>&nbsp;<span class="op" id="3440214">:=</span>&nbsp;<span class="ident" id="3440217">re</span><span class="op" id="3440219">.</span><span class="ident" id="3440220">doExecute</span><span class="op" id="3440229">(</span><span class="builtintype" id="3440230">nil</span><span class="op" id="3440233">,</span>&nbsp;<span class="builtintype" id="3440235">nil</span><span class="op" id="3440238">,</span>&nbsp;<span class="ident" id="3440240">s</span><span class="op" id="3440241">,</span>&nbsp;<span class="num" id="3440243">0</span><span class="op" id="3440244">,</span>&nbsp;<span class="num" id="3440246">2</span><span class="op" id="3440247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3440250">if</span>&nbsp;<span class="ident" id="3440253">a</span>&nbsp;<span class="op" id="3440255">==</span>&nbsp;<span class="builtintype" id="3440258">nil</span>&nbsp;<span class="op" id="3440262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3440266">return</span>&nbsp;<span class="builtintype" id="3440273">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3440278">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3440281">return</span>&nbsp;<span class="ident" id="3440288">a</span><span class="op" id="3440289">[</span><span class="num" id="3440290">0</span><span class="op" id="3440291">:</span><span class="num" id="3440292">2</span><span class="op" id="3440293">]</span><br>
<span class="lineno"></span><span class="op" id="3440295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3440298">//&nbsp;FindReaderIndex&nbsp;returns&nbsp;a&nbsp;two-element&nbsp;slice&nbsp;of&nbsp;integers&nbsp;defining&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3440370">//&nbsp;location&nbsp;of&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;text&nbsp;read&nbsp;from</span><br>
<span class="lineno">710</span><span class="comment" id="3440448">//&nbsp;the&nbsp;RuneReader.&nbsp;&nbsp;The&nbsp;match&nbsp;text&nbsp;was&nbsp;found&nbsp;in&nbsp;the&nbsp;input&nbsp;stream&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="3440516">//&nbsp;byte&nbsp;offset&nbsp;loc[0]&nbsp;through&nbsp;loc[1]-1.</span><br>
<span class="lineno"></span><span class="comment" id="3440556">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3440601">func</span>&nbsp;<span class="op" id="3440606">(</span><span class="ident" id="3440607">re</span>&nbsp;<span class="op" id="3440610">*</span><span class="ident" id="3440611">Regexp</span><span class="op" id="3440617">)</span>&nbsp;<span class="ident" id="3440619">FindReaderIndex</span><span class="op" id="3440634">(</span><span class="ident" id="3440635">r</span>&nbsp;<span class="ident" id="3440637">io</span><span class="op" id="3440639">.</span><span class="ident" id="3440640">RuneReader</span><span class="op" id="3440650">)</span>&nbsp;<span class="op" id="3440652">(</span><span class="ident" id="3440653">loc</span>&nbsp;<span class="op" id="3440657">[</span><span class="op" id="3440658">]</span><span class="builtintype" id="3440659">int</span><span class="op" id="3440662">)</span>&nbsp;<span class="op" id="3440664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3440667">a</span>&nbsp;<span class="op" id="3440669">:=</span>&nbsp;<span class="ident" id="3440672">re</span><span class="op" id="3440674">.</span><span class="ident" id="3440675">doExecute</span><span class="op" id="3440684">(</span><span class="ident" id="3440685">r</span><span class="op" id="3440686">,</span>&nbsp;<span class="builtintype" id="3440688">nil</span><span class="op" id="3440691">,</span>&nbsp;<span class="string" id="3440693">&#34;&#34;</span><span class="op" id="3440695">,</span>&nbsp;<span class="num" id="3440697">0</span><span class="op" id="3440698">,</span>&nbsp;<span class="num" id="3440700">2</span><span class="op" id="3440701">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3440704">if</span>&nbsp;<span class="ident" id="3440707">a</span>&nbsp;<span class="op" id="3440709">==</span>&nbsp;<span class="builtintype" id="3440712">nil</span>&nbsp;<span class="op" id="3440716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3440720">return</span>&nbsp;<span class="builtintype" id="3440727">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3440732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3440735">return</span>&nbsp;<span class="ident" id="3440742">a</span><span class="op" id="3440743">[</span><span class="num" id="3440744">0</span><span class="op" id="3440745">:</span><span class="num" id="3440746">2</span><span class="op" id="3440747">]</span><br>
<span class="lineno"></span><span class="op" id="3440749">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="comment" id="3440752">//&nbsp;FindSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;slices&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;leftmost</span><br>
<span class="lineno"></span><span class="comment" id="3440827">//&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="3440899">//&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="3440975">//&nbsp;comment.</span><br>
<span class="lineno">725</span><span class="comment" id="3440987">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3441032">func</span>&nbsp;<span class="op" id="3441037">(</span><span class="ident" id="3441038">re</span>&nbsp;<span class="op" id="3441041">*</span><span class="ident" id="3441042">Regexp</span><span class="op" id="3441048">)</span>&nbsp;<span class="ident" id="3441050">FindSubmatch</span><span class="op" id="3441062">(</span><span class="ident" id="3441063">b</span>&nbsp;<span class="op" id="3441065">[</span><span class="op" id="3441066">]</span><span class="builtintype" id="3441067">byte</span><span class="op" id="3441071">)</span>&nbsp;<span class="op" id="3441073">[</span><span class="op" id="3441074">]</span><span class="op" id="3441075">[</span><span class="op" id="3441076">]</span><span class="builtintype" id="3441077">byte</span>&nbsp;<span class="op" id="3441082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3441085">a</span>&nbsp;<span class="op" id="3441087">:=</span>&nbsp;<span class="ident" id="3441090">re</span><span class="op" id="3441092">.</span><span class="ident" id="3441093">doExecute</span><span class="op" id="3441102">(</span><span class="builtintype" id="3441103">nil</span><span class="op" id="3441106">,</span>&nbsp;<span class="ident" id="3441108">b</span><span class="op" id="3441109">,</span>&nbsp;<span class="string" id="3441111">&#34;&#34;</span><span class="op" id="3441113">,</span>&nbsp;<span class="num" id="3441115">0</span><span class="op" id="3441116">,</span>&nbsp;<span class="ident" id="3441118">re</span><span class="op" id="3441120">.</span><span class="ident" id="3441121">prog</span><span class="op" id="3441125">.</span><span class="ident" id="3441126">NumCap</span><span class="op" id="3441132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3441135">if</span>&nbsp;<span class="ident" id="3441138">a</span>&nbsp;<span class="op" id="3441140">==</span>&nbsp;<span class="builtintype" id="3441143">nil</span>&nbsp;<span class="op" id="3441147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3441151">return</span>&nbsp;<span class="builtintype" id="3441158">nil</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3441163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3441166">ret</span>&nbsp;<span class="op" id="3441170">:=</span>&nbsp;<span class="builtinfunc" id="3441173">make</span><span class="op" id="3441177">(</span><span class="op" id="3441178">[</span><span class="op" id="3441179">]</span><span class="op" id="3441180">[</span><span class="op" id="3441181">]</span><span class="builtintype" id="3441182">byte</span><span class="op" id="3441186">,</span>&nbsp;<span class="num" id="3441188">1</span><span class="op" id="3441189">+</span><span class="ident" id="3441190">re</span><span class="op" id="3441192">.</span><span class="ident" id="3441193">numSubexp</span><span class="op" id="3441202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3441205">for</span>&nbsp;<span class="ident" id="3441209">i</span>&nbsp;<span class="op" id="3441211">:=</span>&nbsp;<span class="keyword" id="3441214">range</span>&nbsp;<span class="ident" id="3441220">ret</span>&nbsp;<span class="op" id="3441224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3441228">if</span>&nbsp;<span class="num" id="3441231">2</span><span class="op" id="3441232">*</span><span class="ident" id="3441233">i</span>&nbsp;<span class="op" id="3441235">&lt;</span>&nbsp;<span class="builtinfunc" id="3441237">len</span><span class="op" id="3441240">(</span><span class="ident" id="3441241">a</span><span class="op" id="3441242">)</span>&nbsp;<span class="op" id="3441244">&amp;&amp;</span>&nbsp;<span class="ident" id="3441247">a</span><span class="op" id="3441248">[</span><span class="num" id="3441249">2</span><span class="op" id="3441250">*</span><span class="ident" id="3441251">i</span><span class="op" id="3441252">]</span>&nbsp;<span class="op" id="3441254">&gt;=</span>&nbsp;<span class="num" id="3441257">0</span>&nbsp;<span class="op" id="3441259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3441264">ret</span><span class="op" id="3441267">[</span><span class="ident" id="3441268">i</span><span class="op" id="3441269">]</span>&nbsp;<span class="op" id="3441271">=</span>&nbsp;<span class="ident" id="3441273">b</span><span class="op" id="3441274">[</span><span class="ident" id="3441275">a</span><span class="op" id="3441276">[</span><span class="num" id="3441277">2</span><span class="op" id="3441278">*</span><span class="ident" id="3441279">i</span><span class="op" id="3441280">]</span><span class="op" id="3441281">:</span><span class="ident" id="3441282">a</span><span class="op" id="3441283">[</span><span class="num" id="3441284">2</span><span class="op" id="3441285">*</span><span class="ident" id="3441286">i</span><span class="op" id="3441287">+</span><span class="num" id="3441288">1</span><span class="op" id="3441289">]</span><span class="op" id="3441290">]</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3441294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3441297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3441300">return</span>&nbsp;<span class="ident" id="3441307">ret</span><br>
<span class="lineno"></span><span class="op" id="3441311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="comment" id="3441314">//&nbsp;Expand&nbsp;appends&nbsp;template&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;result;&nbsp;during&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3441383">//&nbsp;append,&nbsp;Expand&nbsp;replaces&nbsp;variables&nbsp;in&nbsp;the&nbsp;template&nbsp;with&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3441455">//&nbsp;matches&nbsp;drawn&nbsp;from&nbsp;src.&nbsp;&nbsp;The&nbsp;match&nbsp;slice&nbsp;should&nbsp;have&nbsp;been&nbsp;returned&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3441528">//&nbsp;FindSubmatchIndex.</span><br>
<span class="lineno"></span><span class="comment" id="3441550">//</span><br>
<span class="lineno">745</span><span class="comment" id="3441553">//&nbsp;In&nbsp;the&nbsp;template,&nbsp;a&nbsp;variable&nbsp;is&nbsp;denoted&nbsp;by&nbsp;a&nbsp;substring&nbsp;of&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="3441622">//&nbsp;$name&nbsp;or&nbsp;${name},&nbsp;where&nbsp;name&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;sequence&nbsp;of&nbsp;letters,</span><br>
<span class="lineno"></span><span class="comment" id="3441690">//&nbsp;digits,&nbsp;and&nbsp;underscores.&nbsp;&nbsp;A&nbsp;purely&nbsp;numeric&nbsp;name&nbsp;like&nbsp;$1&nbsp;refers&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3441759">//&nbsp;the&nbsp;submatch&nbsp;with&nbsp;the&nbsp;corresponding&nbsp;index;&nbsp;other&nbsp;names&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3441826">//&nbsp;capturing&nbsp;parentheses&nbsp;named&nbsp;with&nbsp;the&nbsp;(?P&lt;name&gt;...)&nbsp;syntax.&nbsp;&nbsp;A</span><br>
<span class="lineno">750</span><span class="comment" id="3441891">//&nbsp;reference&nbsp;to&nbsp;an&nbsp;out&nbsp;of&nbsp;range&nbsp;or&nbsp;unmatched&nbsp;index&nbsp;or&nbsp;a&nbsp;name&nbsp;that&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3441964">//&nbsp;present&nbsp;in&nbsp;the&nbsp;regular&nbsp;expression&nbsp;is&nbsp;replaced&nbsp;with&nbsp;an&nbsp;empty&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="3442034">//</span><br>
<span class="lineno"></span><span class="comment" id="3442037">//&nbsp;In&nbsp;the&nbsp;$name&nbsp;form,&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;as&nbsp;long&nbsp;as&nbsp;possible:&nbsp;$1x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3442107">//&nbsp;equivalent&nbsp;to&nbsp;${1x},&nbsp;not&nbsp;${1}x,&nbsp;and,&nbsp;$10&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;${10},&nbsp;not&nbsp;${1}0.</span><br>
<span class="lineno">755</span><span class="comment" id="3442186">//</span><br>
<span class="lineno"></span><span class="comment" id="3442189">//&nbsp;To&nbsp;insert&nbsp;a&nbsp;literal&nbsp;$&nbsp;in&nbsp;the&nbsp;output,&nbsp;use&nbsp;$$&nbsp;in&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3442253">func</span>&nbsp;<span class="op" id="3442258">(</span><span class="ident" id="3442259">re</span>&nbsp;<span class="op" id="3442262">*</span><span class="ident" id="3442263">Regexp</span><span class="op" id="3442269">)</span>&nbsp;<span class="ident" id="3442271">Expand</span><span class="op" id="3442277">(</span><span class="ident" id="3442278">dst</span>&nbsp;<span class="op" id="3442282">[</span><span class="op" id="3442283">]</span><span class="builtintype" id="3442284">byte</span><span class="op" id="3442288">,</span>&nbsp;<span class="ident" id="3442290">template</span>&nbsp;<span class="op" id="3442299">[</span><span class="op" id="3442300">]</span><span class="builtintype" id="3442301">byte</span><span class="op" id="3442305">,</span>&nbsp;<span class="ident" id="3442307">src</span>&nbsp;<span class="op" id="3442311">[</span><span class="op" id="3442312">]</span><span class="builtintype" id="3442313">byte</span><span class="op" id="3442317">,</span>&nbsp;<span class="ident" id="3442319">match</span>&nbsp;<span class="op" id="3442325">[</span><span class="op" id="3442326">]</span><span class="builtintype" id="3442327">int</span><span class="op" id="3442330">)</span>&nbsp;<span class="op" id="3442332">[</span><span class="op" id="3442333">]</span><span class="builtintype" id="3442334">byte</span>&nbsp;<span class="op" id="3442339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442342">return</span>&nbsp;<span class="ident" id="3442349">re</span><span class="op" id="3442351">.</span><span class="ident" id="3442352">expand</span><span class="op" id="3442358">(</span><span class="ident" id="3442359">dst</span><span class="op" id="3442362">,</span>&nbsp;<span class="builtintype" id="3442364">string</span><span class="op" id="3442370">(</span><span class="ident" id="3442371">template</span><span class="op" id="3442379">)</span><span class="op" id="3442380">,</span>&nbsp;<span class="ident" id="3442382">src</span><span class="op" id="3442385">,</span>&nbsp;<span class="string" id="3442387">&#34;&#34;</span><span class="op" id="3442389">,</span>&nbsp;<span class="ident" id="3442391">match</span><span class="op" id="3442396">)</span><br>
<span class="lineno"></span><span class="op" id="3442398">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="3442401">//&nbsp;ExpandString&nbsp;is&nbsp;like&nbsp;Expand&nbsp;but&nbsp;the&nbsp;template&nbsp;and&nbsp;source&nbsp;are&nbsp;strings.</span><br>
<span class="lineno"></span><span class="comment" id="3442473">//&nbsp;It&nbsp;appends&nbsp;to&nbsp;and&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;in&nbsp;order&nbsp;to&nbsp;give&nbsp;the&nbsp;calling</span><br>
<span class="lineno"></span><span class="comment" id="3442544">//&nbsp;code&nbsp;control&nbsp;over&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3442577">func</span>&nbsp;<span class="op" id="3442582">(</span><span class="ident" id="3442583">re</span>&nbsp;<span class="op" id="3442586">*</span><span class="ident" id="3442587">Regexp</span><span class="op" id="3442593">)</span>&nbsp;<span class="ident" id="3442595">ExpandString</span><span class="op" id="3442607">(</span><span class="ident" id="3442608">dst</span>&nbsp;<span class="op" id="3442612">[</span><span class="op" id="3442613">]</span><span class="builtintype" id="3442614">byte</span><span class="op" id="3442618">,</span>&nbsp;<span class="ident" id="3442620">template</span>&nbsp;<span class="builtintype" id="3442629">string</span><span class="op" id="3442635">,</span>&nbsp;<span class="ident" id="3442637">src</span>&nbsp;<span class="builtintype" id="3442641">string</span><span class="op" id="3442647">,</span>&nbsp;<span class="ident" id="3442649">match</span>&nbsp;<span class="op" id="3442655">[</span><span class="op" id="3442656">]</span><span class="builtintype" id="3442657">int</span><span class="op" id="3442660">)</span>&nbsp;<span class="op" id="3442662">[</span><span class="op" id="3442663">]</span><span class="builtintype" id="3442664">byte</span>&nbsp;<span class="op" id="3442669">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442672">return</span>&nbsp;<span class="ident" id="3442679">re</span><span class="op" id="3442681">.</span><span class="ident" id="3442682">expand</span><span class="op" id="3442688">(</span><span class="ident" id="3442689">dst</span><span class="op" id="3442692">,</span>&nbsp;<span class="ident" id="3442694">template</span><span class="op" id="3442702">,</span>&nbsp;<span class="builtintype" id="3442704">nil</span><span class="op" id="3442707">,</span>&nbsp;<span class="ident" id="3442709">src</span><span class="op" id="3442712">,</span>&nbsp;<span class="ident" id="3442714">match</span><span class="op" id="3442719">)</span><br>
<span class="lineno"></span><span class="op" id="3442721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3442724">func</span>&nbsp;<span class="op" id="3442729">(</span><span class="ident" id="3442730">re</span>&nbsp;<span class="op" id="3442733">*</span><span class="ident" id="3442734">Regexp</span><span class="op" id="3442740">)</span>&nbsp;<span class="ident" id="3442742">expand</span><span class="op" id="3442748">(</span><span class="ident" id="3442749">dst</span>&nbsp;<span class="op" id="3442753">[</span><span class="op" id="3442754">]</span><span class="builtintype" id="3442755">byte</span><span class="op" id="3442759">,</span>&nbsp;<span class="ident" id="3442761">template</span>&nbsp;<span class="builtintype" id="3442770">string</span><span class="op" id="3442776">,</span>&nbsp;<span class="ident" id="3442778">bsrc</span>&nbsp;<span class="op" id="3442783">[</span><span class="op" id="3442784">]</span><span class="builtintype" id="3442785">byte</span><span class="op" id="3442789">,</span>&nbsp;<span class="ident" id="3442791">src</span>&nbsp;<span class="builtintype" id="3442795">string</span><span class="op" id="3442801">,</span>&nbsp;<span class="ident" id="3442803">match</span>&nbsp;<span class="op" id="3442809">[</span><span class="op" id="3442810">]</span><span class="builtintype" id="3442811">int</span><span class="op" id="3442814">)</span>&nbsp;<span class="op" id="3442816">[</span><span class="op" id="3442817">]</span><span class="builtintype" id="3442818">byte</span>&nbsp;<span class="op" id="3442823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442826">for</span>&nbsp;<span class="builtinfunc" id="3442830">len</span><span class="op" id="3442833">(</span><span class="ident" id="3442834">template</span><span class="op" id="3442842">)</span>&nbsp;<span class="op" id="3442844">&gt;</span>&nbsp;<span class="num" id="3442846">0</span>&nbsp;<span class="op" id="3442848">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3442852">i</span>&nbsp;<span class="op" id="3442854">:=</span>&nbsp;<span class="ident" id="3442857">strings</span><span class="op" id="3442864">.</span><span class="ident" id="3442865">Index</span><span class="op" id="3442870">(</span><span class="ident" id="3442871">template</span><span class="op" id="3442879">,</span>&nbsp;<span class="string" id="3442881">&#34;$&#34;</span><span class="op" id="3442884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442888">if</span>&nbsp;<span class="ident" id="3442891">i</span>&nbsp;<span class="op" id="3442893">&lt;</span>&nbsp;<span class="num" id="3442895">0</span>&nbsp;<span class="op" id="3442897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442902">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3442910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3442914">dst</span>&nbsp;<span class="op" id="3442918">=</span>&nbsp;<span class="builtinfunc" id="3442920">append</span><span class="op" id="3442926">(</span><span class="ident" id="3442927">dst</span><span class="op" id="3442930">,</span>&nbsp;<span class="ident" id="3442932">template</span><span class="op" id="3442940">[</span><span class="op" id="3442941">:</span><span class="ident" id="3442942">i</span><span class="op" id="3442943">]</span><span class="op" id="3442944">...</span><span class="op" id="3442947">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3442951">template</span>&nbsp;<span class="op" id="3442960">=</span>&nbsp;<span class="ident" id="3442962">template</span><span class="op" id="3442970">[</span><span class="ident" id="3442971">i</span><span class="op" id="3442972">:</span><span class="op" id="3442973">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3442977">if</span>&nbsp;<span class="builtinfunc" id="3442980">len</span><span class="op" id="3442983">(</span><span class="ident" id="3442984">template</span><span class="op" id="3442992">)</span>&nbsp;<span class="op" id="3442994">&gt;</span>&nbsp;<span class="num" id="3442996">1</span>&nbsp;<span class="op" id="3442998">&amp;&amp;</span>&nbsp;<span class="ident" id="3443001">template</span><span class="op" id="3443009">[</span><span class="num" id="3443010">1</span><span class="op" id="3443011">]</span>&nbsp;<span class="op" id="3443013">==</span>&nbsp;<span class="string" id="3443016">&#39;$&#39;</span>&nbsp;<span class="op" id="3443020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443025">//&nbsp;Treat&nbsp;$$&nbsp;as&nbsp;$.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443046">dst</span>&nbsp;<span class="op" id="3443050">=</span>&nbsp;<span class="builtinfunc" id="3443052">append</span><span class="op" id="3443058">(</span><span class="ident" id="3443059">dst</span><span class="op" id="3443062">,</span>&nbsp;<span class="string" id="3443064">&#39;$&#39;</span><span class="op" id="3443067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443072">template</span>&nbsp;<span class="op" id="3443081">=</span>&nbsp;<span class="ident" id="3443083">template</span><span class="op" id="3443091">[</span><span class="num" id="3443092">2</span><span class="op" id="3443093">:</span><span class="op" id="3443094">]</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443099">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443114">name</span><span class="op" id="3443118">,</span>&nbsp;<span class="ident" id="3443120">num</span><span class="op" id="3443123">,</span>&nbsp;<span class="ident" id="3443125">rest</span><span class="op" id="3443129">,</span>&nbsp;<span class="ident" id="3443131">ok</span>&nbsp;<span class="op" id="3443134">:=</span>&nbsp;<span class="ident" id="3443137">extract</span><span class="op" id="3443144">(</span><span class="ident" id="3443145">template</span><span class="op" id="3443153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443157">if</span>&nbsp;<span class="op" id="3443160">!</span><span class="ident" id="3443161">ok</span>&nbsp;<span class="op" id="3443164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3443169">//&nbsp;Malformed;&nbsp;treat&nbsp;$&nbsp;as&nbsp;raw&nbsp;text.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443207">dst</span>&nbsp;<span class="op" id="3443211">=</span>&nbsp;<span class="builtinfunc" id="3443213">append</span><span class="op" id="3443219">(</span><span class="ident" id="3443220">dst</span><span class="op" id="3443223">,</span>&nbsp;<span class="string" id="3443225">&#39;$&#39;</span><span class="op" id="3443228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443233">template</span>&nbsp;<span class="op" id="3443242">=</span>&nbsp;<span class="ident" id="3443244">template</span><span class="op" id="3443252">[</span><span class="num" id="3443253">1</span><span class="op" id="3443254">:</span><span class="op" id="3443255">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443260">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443275">template</span>&nbsp;<span class="op" id="3443284">=</span>&nbsp;<span class="ident" id="3443286">rest</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443293">if</span>&nbsp;<span class="ident" id="3443296">num</span>&nbsp;<span class="op" id="3443300">&gt;=</span>&nbsp;<span class="num" id="3443303">0</span>&nbsp;<span class="op" id="3443305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443310">if</span>&nbsp;<span class="num" id="3443313">2</span><span class="op" id="3443314">*</span><span class="ident" id="3443315">num</span><span class="op" id="3443318">+</span><span class="num" id="3443319">1</span>&nbsp;<span class="op" id="3443321">&lt;</span>&nbsp;<span class="builtinfunc" id="3443323">len</span><span class="op" id="3443326">(</span><span class="ident" id="3443327">match</span><span class="op" id="3443332">)</span>&nbsp;<span class="op" id="3443334">&amp;&amp;</span>&nbsp;<span class="ident" id="3443337">match</span><span class="op" id="3443342">[</span><span class="num" id="3443343">2</span><span class="op" id="3443344">*</span><span class="ident" id="3443345">num</span><span class="op" id="3443348">]</span>&nbsp;<span class="op" id="3443350">&gt;=</span>&nbsp;<span class="num" id="3443353">0</span>&nbsp;<span class="op" id="3443355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443361">if</span>&nbsp;<span class="ident" id="3443364">bsrc</span>&nbsp;<span class="op" id="3443369">!=</span>&nbsp;<span class="builtintype" id="3443372">nil</span>&nbsp;<span class="op" id="3443376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443383">dst</span>&nbsp;<span class="op" id="3443387">=</span>&nbsp;<span class="builtinfunc" id="3443389">append</span><span class="op" id="3443395">(</span><span class="ident" id="3443396">dst</span><span class="op" id="3443399">,</span>&nbsp;<span class="ident" id="3443401">bsrc</span><span class="op" id="3443405">[</span><span class="ident" id="3443406">match</span><span class="op" id="3443411">[</span><span class="num" id="3443412">2</span><span class="op" id="3443413">*</span><span class="ident" id="3443414">num</span><span class="op" id="3443417">]</span><span class="op" id="3443418">:</span><span class="ident" id="3443419">match</span><span class="op" id="3443424">[</span><span class="num" id="3443425">2</span><span class="op" id="3443426">*</span><span class="ident" id="3443427">num</span><span class="op" id="3443430">+</span><span class="num" id="3443431">1</span><span class="op" id="3443432">]</span><span class="op" id="3443433">]</span><span class="op" id="3443434">...</span><span class="op" id="3443437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443443">}</span>&nbsp;<span class="keyword" id="3443445">else</span>&nbsp;<span class="op" id="3443450">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443457">dst</span>&nbsp;<span class="op" id="3443461">=</span>&nbsp;<span class="builtinfunc" id="3443463">append</span><span class="op" id="3443469">(</span><span class="ident" id="3443470">dst</span><span class="op" id="3443473">,</span>&nbsp;<span class="ident" id="3443475">src</span><span class="op" id="3443478">[</span><span class="ident" id="3443479">match</span><span class="op" id="3443484">[</span><span class="num" id="3443485">2</span><span class="op" id="3443486">*</span><span class="ident" id="3443487">num</span><span class="op" id="3443490">]</span><span class="op" id="3443491">:</span><span class="ident" id="3443492">match</span><span class="op" id="3443497">[</span><span class="num" id="3443498">2</span><span class="op" id="3443499">*</span><span class="ident" id="3443500">num</span><span class="op" id="3443503">+</span><span class="num" id="3443504">1</span><span class="op" id="3443505">]</span><span class="op" id="3443506">]</span><span class="op" id="3443507">...</span><span class="op" id="3443510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443525">}</span>&nbsp;<span class="keyword" id="3443527">else</span>&nbsp;<span class="op" id="3443532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443537">for</span>&nbsp;<span class="ident" id="3443541">i</span><span class="op" id="3443542">,</span>&nbsp;<span class="ident" id="3443544">namei</span>&nbsp;<span class="op" id="3443550">:=</span>&nbsp;<span class="keyword" id="3443553">range</span>&nbsp;<span class="ident" id="3443559">re</span><span class="op" id="3443561">.</span><span class="ident" id="3443562">subexpNames</span>&nbsp;<span class="op" id="3443574">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443580">if</span>&nbsp;<span class="ident" id="3443583">name</span>&nbsp;<span class="op" id="3443588">==</span>&nbsp;<span class="ident" id="3443591">namei</span>&nbsp;<span class="op" id="3443597">&amp;&amp;</span>&nbsp;<span class="num" id="3443600">2</span><span class="op" id="3443601">*</span><span class="ident" id="3443602">i</span><span class="op" id="3443603">+</span><span class="num" id="3443604">1</span>&nbsp;<span class="op" id="3443606">&lt;</span>&nbsp;<span class="builtinfunc" id="3443608">len</span><span class="op" id="3443611">(</span><span class="ident" id="3443612">match</span><span class="op" id="3443617">)</span>&nbsp;<span class="op" id="3443619">&amp;&amp;</span>&nbsp;<span class="ident" id="3443622">match</span><span class="op" id="3443627">[</span><span class="num" id="3443628">2</span><span class="op" id="3443629">*</span><span class="ident" id="3443630">i</span><span class="op" id="3443631">]</span>&nbsp;<span class="op" id="3443633">&gt;=</span>&nbsp;<span class="num" id="3443636">0</span>&nbsp;<span class="op" id="3443638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443645">if</span>&nbsp;<span class="ident" id="3443648">bsrc</span>&nbsp;<span class="op" id="3443653">!=</span>&nbsp;<span class="builtintype" id="3443656">nil</span>&nbsp;<span class="op" id="3443660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443668">dst</span>&nbsp;<span class="op" id="3443672">=</span>&nbsp;<span class="builtinfunc" id="3443674">append</span><span class="op" id="3443680">(</span><span class="ident" id="3443681">dst</span><span class="op" id="3443684">,</span>&nbsp;<span class="ident" id="3443686">bsrc</span><span class="op" id="3443690">[</span><span class="ident" id="3443691">match</span><span class="op" id="3443696">[</span><span class="num" id="3443697">2</span><span class="op" id="3443698">*</span><span class="ident" id="3443699">i</span><span class="op" id="3443700">]</span><span class="op" id="3443701">:</span><span class="ident" id="3443702">match</span><span class="op" id="3443707">[</span><span class="num" id="3443708">2</span><span class="op" id="3443709">*</span><span class="ident" id="3443710">i</span><span class="op" id="3443711">+</span><span class="num" id="3443712">1</span><span class="op" id="3443713">]</span><span class="op" id="3443714">]</span><span class="op" id="3443715">...</span><span class="op" id="3443718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443725">}</span>&nbsp;<span class="keyword" id="3443727">else</span>&nbsp;<span class="op" id="3443732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443740">dst</span>&nbsp;<span class="op" id="3443744">=</span>&nbsp;<span class="builtinfunc" id="3443746">append</span><span class="op" id="3443752">(</span><span class="ident" id="3443753">dst</span><span class="op" id="3443756">,</span>&nbsp;<span class="ident" id="3443758">src</span><span class="op" id="3443761">[</span><span class="ident" id="3443762">match</span><span class="op" id="3443767">[</span><span class="num" id="3443768">2</span><span class="op" id="3443769">*</span><span class="ident" id="3443770">i</span><span class="op" id="3443771">]</span><span class="op" id="3443772">:</span><span class="ident" id="3443773">match</span><span class="op" id="3443778">[</span><span class="num" id="3443779">2</span><span class="op" id="3443780">*</span><span class="ident" id="3443781">i</span><span class="op" id="3443782">+</span><span class="num" id="3443783">1</span><span class="op" id="3443784">]</span><span class="op" id="3443785">]</span><span class="op" id="3443786">...</span><span class="op" id="3443789">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443803">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443822">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3443825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3443828">dst</span>&nbsp;<span class="op" id="3443832">=</span>&nbsp;<span class="builtinfunc" id="3443834">append</span><span class="op" id="3443840">(</span><span class="ident" id="3443841">dst</span><span class="op" id="3443844">,</span>&nbsp;<span class="ident" id="3443846">template</span><span class="op" id="3443854">...</span><span class="op" id="3443857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3443860">return</span>&nbsp;<span class="ident" id="3443867">dst</span><br>
<span class="lineno"></span><span class="op" id="3443871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span><span class="comment" id="3443874">//&nbsp;extract&nbsp;returns&nbsp;the&nbsp;name&nbsp;from&nbsp;a&nbsp;leading&nbsp;&#34;$name&#34;&nbsp;or&nbsp;&#34;${name}&#34;&nbsp;in&nbsp;str.</span><br>
<span class="lineno"></span><span class="comment" id="3443946">//&nbsp;If&nbsp;it&nbsp;is&nbsp;a&nbsp;number,&nbsp;extract&nbsp;returns&nbsp;num&nbsp;set&nbsp;to&nbsp;that&nbsp;number;&nbsp;otherwise&nbsp;num&nbsp;=&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="3444028">func</span>&nbsp;<span class="ident" id="3444033">extract</span><span class="op" id="3444040">(</span><span class="ident" id="3444041">str</span>&nbsp;<span class="builtintype" id="3444045">string</span><span class="op" id="3444051">)</span>&nbsp;<span class="op" id="3444053">(</span><span class="ident" id="3444054">name</span>&nbsp;<span class="builtintype" id="3444059">string</span><span class="op" id="3444065">,</span>&nbsp;<span class="ident" id="3444067">num</span>&nbsp;<span class="builtintype" id="3444071">int</span><span class="op" id="3444074">,</span>&nbsp;<span class="ident" id="3444076">rest</span>&nbsp;<span class="builtintype" id="3444081">string</span><span class="op" id="3444087">,</span>&nbsp;<span class="ident" id="3444089">ok</span>&nbsp;<span class="builtintype" id="3444092">bool</span><span class="op" id="3444096">)</span>&nbsp;<span class="op" id="3444098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444101">if</span>&nbsp;<span class="builtinfunc" id="3444104">len</span><span class="op" id="3444107">(</span><span class="ident" id="3444108">str</span><span class="op" id="3444111">)</span>&nbsp;<span class="op" id="3444113">&lt;</span>&nbsp;<span class="num" id="3444115">2</span>&nbsp;<span class="op" id="3444117">||</span>&nbsp;<span class="ident" id="3444120">str</span><span class="op" id="3444123">[</span><span class="num" id="3444124">0</span><span class="op" id="3444125">]</span>&nbsp;<span class="op" id="3444127">!=</span>&nbsp;<span class="string" id="3444130">&#39;$&#39;</span>&nbsp;<span class="op" id="3444134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444138">return</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444149">brace</span>&nbsp;<span class="op" id="3444155">:=</span>&nbsp;<span class="builtintype" id="3444158">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444165">if</span>&nbsp;<span class="ident" id="3444168">str</span><span class="op" id="3444171">[</span><span class="num" id="3444172">1</span><span class="op" id="3444173">]</span>&nbsp;<span class="op" id="3444175">==</span>&nbsp;<span class="string" id="3444178">&#39;{&#39;</span>&nbsp;<span class="op" id="3444182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444186">brace</span>&nbsp;<span class="op" id="3444192">=</span>&nbsp;<span class="builtintype" id="3444194">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444201">str</span>&nbsp;<span class="op" id="3444205">=</span>&nbsp;<span class="ident" id="3444207">str</span><span class="op" id="3444210">[</span><span class="num" id="3444211">2</span><span class="op" id="3444212">:</span><span class="op" id="3444213">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444216">}</span>&nbsp;<span class="keyword" id="3444218">else</span>&nbsp;<span class="op" id="3444223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444227">str</span>&nbsp;<span class="op" id="3444231">=</span>&nbsp;<span class="ident" id="3444233">str</span><span class="op" id="3444236">[</span><span class="num" id="3444237">1</span><span class="op" id="3444238">:</span><span class="op" id="3444239">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444245">i</span>&nbsp;<span class="op" id="3444247">:=</span>&nbsp;<span class="num" id="3444250">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444253">for</span>&nbsp;<span class="ident" id="3444257">i</span>&nbsp;<span class="op" id="3444259">&lt;</span>&nbsp;<span class="builtinfunc" id="3444261">len</span><span class="op" id="3444264">(</span><span class="ident" id="3444265">str</span><span class="op" id="3444268">)</span>&nbsp;<span class="op" id="3444270">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3444274">rune</span><span class="op" id="3444278">,</span>&nbsp;<span class="ident" id="3444280">size</span>&nbsp;<span class="op" id="3444285">:=</span>&nbsp;<span class="ident" id="3444288">utf8</span><span class="op" id="3444292">.</span><span class="ident" id="3444293">DecodeRuneInString</span><span class="op" id="3444311">(</span><span class="ident" id="3444312">str</span><span class="op" id="3444315">[</span><span class="ident" id="3444316">i</span><span class="op" id="3444317">:</span><span class="op" id="3444318">]</span><span class="op" id="3444319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444323">if</span>&nbsp;<span class="op" id="3444326">!</span><span class="ident" id="3444327">unicode</span><span class="op" id="3444334">.</span><span class="ident" id="3444335">IsLetter</span><span class="op" id="3444343">(</span><span class="builtintype" id="3444344">rune</span><span class="op" id="3444348">)</span>&nbsp;<span class="op" id="3444350">&amp;&amp;</span>&nbsp;<span class="op" id="3444353">!</span><span class="ident" id="3444354">unicode</span><span class="op" id="3444361">.</span><span class="ident" id="3444362">IsDigit</span><span class="op" id="3444369">(</span><span class="builtintype" id="3444370">rune</span><span class="op" id="3444374">)</span>&nbsp;<span class="op" id="3444376">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3444379">rune</span>&nbsp;<span class="op" id="3444384">!=</span>&nbsp;<span class="string" id="3444387">&#39;_&#39;</span>&nbsp;<span class="op" id="3444391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444396">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444408">i</span>&nbsp;<span class="op" id="3444410">+=</span>&nbsp;<span class="ident" id="3444413">size</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444422">if</span>&nbsp;<span class="ident" id="3444425">i</span>&nbsp;<span class="op" id="3444427">==</span>&nbsp;<span class="num" id="3444430">0</span>&nbsp;<span class="op" id="3444432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3444436">//&nbsp;empty&nbsp;name&nbsp;is&nbsp;not&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444464">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444472">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444475">name</span>&nbsp;<span class="op" id="3444480">=</span>&nbsp;<span class="ident" id="3444482">str</span><span class="op" id="3444485">[</span><span class="op" id="3444486">:</span><span class="ident" id="3444487">i</span><span class="op" id="3444488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444491">if</span>&nbsp;<span class="ident" id="3444494">brace</span>&nbsp;<span class="op" id="3444500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444504">if</span>&nbsp;<span class="ident" id="3444507">i</span>&nbsp;<span class="op" id="3444509">&gt;=</span>&nbsp;<span class="builtinfunc" id="3444512">len</span><span class="op" id="3444515">(</span><span class="ident" id="3444516">str</span><span class="op" id="3444519">)</span>&nbsp;<span class="op" id="3444521">||</span>&nbsp;<span class="ident" id="3444524">str</span><span class="op" id="3444527">[</span><span class="ident" id="3444528">i</span><span class="op" id="3444529">]</span>&nbsp;<span class="op" id="3444531">!=</span>&nbsp;<span class="string" id="3444534">&#39;}&#39;</span>&nbsp;<span class="op" id="3444538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3444543">//&nbsp;missing&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444571">return</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444584">i</span><span class="op" id="3444585">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3444593">//&nbsp;Parse&nbsp;number.</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444611">num</span>&nbsp;<span class="op" id="3444615">=</span>&nbsp;<span class="num" id="3444617">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444620">for</span>&nbsp;<span class="ident" id="3444624">i</span>&nbsp;<span class="op" id="3444626">:=</span>&nbsp;<span class="num" id="3444629">0</span><span class="op" id="3444630">;</span>&nbsp;<span class="ident" id="3444632">i</span>&nbsp;<span class="op" id="3444634">&lt;</span>&nbsp;<span class="builtinfunc" id="3444636">len</span><span class="op" id="3444639">(</span><span class="ident" id="3444640">name</span><span class="op" id="3444644">)</span><span class="op" id="3444645">;</span>&nbsp;<span class="ident" id="3444647">i</span><span class="op" id="3444648">++</span>&nbsp;<span class="op" id="3444651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444655">if</span>&nbsp;<span class="ident" id="3444658">name</span><span class="op" id="3444662">[</span><span class="ident" id="3444663">i</span><span class="op" id="3444664">]</span>&nbsp;<span class="op" id="3444666">&lt;</span>&nbsp;<span class="string" id="3444668">&#39;0&#39;</span>&nbsp;<span class="op" id="3444672">||</span>&nbsp;<span class="string" id="3444675">&#39;9&#39;</span>&nbsp;<span class="op" id="3444679">&lt;</span>&nbsp;<span class="ident" id="3444681">name</span><span class="op" id="3444685">[</span><span class="ident" id="3444686">i</span><span class="op" id="3444687">]</span>&nbsp;<span class="op" id="3444689">||</span>&nbsp;<span class="ident" id="3444692">num</span>&nbsp;<span class="op" id="3444696">&gt;=</span>&nbsp;<span class="num" id="3444699">1e8</span>&nbsp;<span class="op" id="3444703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444708">num</span>&nbsp;<span class="op" id="3444712">=</span>&nbsp;<span class="op" id="3444714">-</span><span class="num" id="3444715">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444720">break</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444732">num</span>&nbsp;<span class="op" id="3444736">=</span>&nbsp;<span class="ident" id="3444738">num</span><span class="op" id="3444741">*</span><span class="num" id="3444742">10</span>&nbsp;<span class="op" id="3444745">+</span>&nbsp;<span class="builtintype" id="3444747">int</span><span class="op" id="3444750">(</span><span class="ident" id="3444751">name</span><span class="op" id="3444755">[</span><span class="ident" id="3444756">i</span><span class="op" id="3444757">]</span><span class="op" id="3444758">)</span>&nbsp;<span class="op" id="3444760">-</span>&nbsp;<span class="string" id="3444762">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3444770">//&nbsp;Disallow&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444798">if</span>&nbsp;<span class="ident" id="3444801">name</span><span class="op" id="3444805">[</span><span class="num" id="3444806">0</span><span class="op" id="3444807">]</span>&nbsp;<span class="op" id="3444809">==</span>&nbsp;<span class="string" id="3444812">&#39;0&#39;</span>&nbsp;<span class="op" id="3444816">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3444819">len</span><span class="op" id="3444822">(</span><span class="ident" id="3444823">name</span><span class="op" id="3444827">)</span>&nbsp;<span class="op" id="3444829">&gt;</span>&nbsp;<span class="num" id="3444831">1</span>&nbsp;<span class="op" id="3444833">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444837">num</span>&nbsp;<span class="op" id="3444841">=</span>&nbsp;<span class="op" id="3444843">-</span><span class="num" id="3444844">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3444847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444851">rest</span>&nbsp;<span class="op" id="3444856">=</span>&nbsp;<span class="ident" id="3444858">str</span><span class="op" id="3444861">[</span><span class="ident" id="3444862">i</span><span class="op" id="3444863">:</span><span class="op" id="3444864">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3444867">ok</span>&nbsp;<span class="op" id="3444870">=</span>&nbsp;<span class="builtintype" id="3444872">true</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3444878">return</span><br>
<span class="lineno"></span><span class="op" id="3444885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3444888">//&nbsp;FindSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs&nbsp;identifying&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3444965">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;b&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno">870</span><span class="comment" id="3445042">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions</span><br>
<span class="lineno"></span><span class="comment" id="3445119">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3445146">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3445191">func</span>&nbsp;<span class="op" id="3445196">(</span><span class="ident" id="3445197">re</span>&nbsp;<span class="op" id="3445200">*</span><span class="ident" id="3445201">Regexp</span><span class="op" id="3445207">)</span>&nbsp;<span class="ident" id="3445209">FindSubmatchIndex</span><span class="op" id="3445226">(</span><span class="ident" id="3445227">b</span>&nbsp;<span class="op" id="3445229">[</span><span class="op" id="3445230">]</span><span class="builtintype" id="3445231">byte</span><span class="op" id="3445235">)</span>&nbsp;<span class="op" id="3445237">[</span><span class="op" id="3445238">]</span><span class="builtintype" id="3445239">int</span>&nbsp;<span class="op" id="3445243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445246">return</span>&nbsp;<span class="ident" id="3445253">re</span><span class="op" id="3445255">.</span><span class="ident" id="3445256">pad</span><span class="op" id="3445259">(</span><span class="ident" id="3445260">re</span><span class="op" id="3445262">.</span><span class="ident" id="3445263">doExecute</span><span class="op" id="3445272">(</span><span class="builtintype" id="3445273">nil</span><span class="op" id="3445276">,</span>&nbsp;<span class="ident" id="3445278">b</span><span class="op" id="3445279">,</span>&nbsp;<span class="string" id="3445281">&#34;&#34;</span><span class="op" id="3445283">,</span>&nbsp;<span class="num" id="3445285">0</span><span class="op" id="3445286">,</span>&nbsp;<span class="ident" id="3445288">re</span><span class="op" id="3445290">.</span><span class="ident" id="3445291">prog</span><span class="op" id="3445295">.</span><span class="ident" id="3445296">NumCap</span><span class="op" id="3445302">)</span><span class="op" id="3445303">)</span><br>
<span class="lineno">875</span><span class="op" id="3445305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3445308">//&nbsp;FindStringSubmatch&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;strings&nbsp;holding&nbsp;the&nbsp;text&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3445381">//&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3445458">//&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno">880</span><span class="comment" id="3445529">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3445549">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3445594">func</span>&nbsp;<span class="op" id="3445599">(</span><span class="ident" id="3445600">re</span>&nbsp;<span class="op" id="3445603">*</span><span class="ident" id="3445604">Regexp</span><span class="op" id="3445610">)</span>&nbsp;<span class="ident" id="3445612">FindStringSubmatch</span><span class="op" id="3445630">(</span><span class="ident" id="3445631">s</span>&nbsp;<span class="builtintype" id="3445633">string</span><span class="op" id="3445639">)</span>&nbsp;<span class="op" id="3445641">[</span><span class="op" id="3445642">]</span><span class="builtintype" id="3445643">string</span>&nbsp;<span class="op" id="3445650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3445653">a</span>&nbsp;<span class="op" id="3445655">:=</span>&nbsp;<span class="ident" id="3445658">re</span><span class="op" id="3445660">.</span><span class="ident" id="3445661">doExecute</span><span class="op" id="3445670">(</span><span class="builtintype" id="3445671">nil</span><span class="op" id="3445674">,</span>&nbsp;<span class="builtintype" id="3445676">nil</span><span class="op" id="3445679">,</span>&nbsp;<span class="ident" id="3445681">s</span><span class="op" id="3445682">,</span>&nbsp;<span class="num" id="3445684">0</span><span class="op" id="3445685">,</span>&nbsp;<span class="ident" id="3445687">re</span><span class="op" id="3445689">.</span><span class="ident" id="3445690">prog</span><span class="op" id="3445694">.</span><span class="ident" id="3445695">NumCap</span><span class="op" id="3445701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445704">if</span>&nbsp;<span class="ident" id="3445707">a</span>&nbsp;<span class="op" id="3445709">==</span>&nbsp;<span class="builtintype" id="3445712">nil</span>&nbsp;<span class="op" id="3445716">{</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445720">return</span>&nbsp;<span class="builtintype" id="3445727">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3445732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3445735">ret</span>&nbsp;<span class="op" id="3445739">:=</span>&nbsp;<span class="builtinfunc" id="3445742">make</span><span class="op" id="3445746">(</span><span class="op" id="3445747">[</span><span class="op" id="3445748">]</span><span class="builtintype" id="3445749">string</span><span class="op" id="3445755">,</span>&nbsp;<span class="num" id="3445757">1</span><span class="op" id="3445758">+</span><span class="ident" id="3445759">re</span><span class="op" id="3445761">.</span><span class="ident" id="3445762">numSubexp</span><span class="op" id="3445771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445774">for</span>&nbsp;<span class="ident" id="3445778">i</span>&nbsp;<span class="op" id="3445780">:=</span>&nbsp;<span class="keyword" id="3445783">range</span>&nbsp;<span class="ident" id="3445789">ret</span>&nbsp;<span class="op" id="3445793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445797">if</span>&nbsp;<span class="num" id="3445800">2</span><span class="op" id="3445801">*</span><span class="ident" id="3445802">i</span>&nbsp;<span class="op" id="3445804">&lt;</span>&nbsp;<span class="builtinfunc" id="3445806">len</span><span class="op" id="3445809">(</span><span class="ident" id="3445810">a</span><span class="op" id="3445811">)</span>&nbsp;<span class="op" id="3445813">&amp;&amp;</span>&nbsp;<span class="ident" id="3445816">a</span><span class="op" id="3445817">[</span><span class="num" id="3445818">2</span><span class="op" id="3445819">*</span><span class="ident" id="3445820">i</span><span class="op" id="3445821">]</span>&nbsp;<span class="op" id="3445823">&gt;=</span>&nbsp;<span class="num" id="3445826">0</span>&nbsp;<span class="op" id="3445828">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3445833">ret</span><span class="op" id="3445836">[</span><span class="ident" id="3445837">i</span><span class="op" id="3445838">]</span>&nbsp;<span class="op" id="3445840">=</span>&nbsp;<span class="ident" id="3445842">s</span><span class="op" id="3445843">[</span><span class="ident" id="3445844">a</span><span class="op" id="3445845">[</span><span class="num" id="3445846">2</span><span class="op" id="3445847">*</span><span class="ident" id="3445848">i</span><span class="op" id="3445849">]</span><span class="op" id="3445850">:</span><span class="ident" id="3445851">a</span><span class="op" id="3445852">[</span><span class="num" id="3445853">2</span><span class="op" id="3445854">*</span><span class="ident" id="3445855">i</span><span class="op" id="3445856">+</span><span class="num" id="3445857">1</span><span class="op" id="3445858">]</span><span class="op" id="3445859">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3445863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3445866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3445869">return</span>&nbsp;<span class="ident" id="3445876">ret</span><br>
<span class="lineno"></span><span class="op" id="3445880">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="comment" id="3445883">//&nbsp;FindStringSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="3445950">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3446023">//&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3446099">//&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">900</span><span class="comment" id="3446147">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3446192">func</span>&nbsp;<span class="op" id="3446197">(</span><span class="ident" id="3446198">re</span>&nbsp;<span class="op" id="3446201">*</span><span class="ident" id="3446202">Regexp</span><span class="op" id="3446208">)</span>&nbsp;<span class="ident" id="3446210">FindStringSubmatchIndex</span><span class="op" id="3446233">(</span><span class="ident" id="3446234">s</span>&nbsp;<span class="builtintype" id="3446236">string</span><span class="op" id="3446242">)</span>&nbsp;<span class="op" id="3446244">[</span><span class="op" id="3446245">]</span><span class="builtintype" id="3446246">int</span>&nbsp;<span class="op" id="3446250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3446253">return</span>&nbsp;<span class="ident" id="3446260">re</span><span class="op" id="3446262">.</span><span class="ident" id="3446263">pad</span><span class="op" id="3446266">(</span><span class="ident" id="3446267">re</span><span class="op" id="3446269">.</span><span class="ident" id="3446270">doExecute</span><span class="op" id="3446279">(</span><span class="builtintype" id="3446280">nil</span><span class="op" id="3446283">,</span>&nbsp;<span class="builtintype" id="3446285">nil</span><span class="op" id="3446288">,</span>&nbsp;<span class="ident" id="3446290">s</span><span class="op" id="3446291">,</span>&nbsp;<span class="num" id="3446293">0</span><span class="op" id="3446294">,</span>&nbsp;<span class="ident" id="3446296">re</span><span class="op" id="3446298">.</span><span class="ident" id="3446299">prog</span><span class="op" id="3446303">.</span><span class="ident" id="3446304">NumCap</span><span class="op" id="3446310">)</span><span class="op" id="3446311">)</span><br>
<span class="lineno"></span><span class="op" id="3446313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="comment" id="3446316">//&nbsp;FindReaderSubmatchIndex&nbsp;returns&nbsp;a&nbsp;slice&nbsp;holding&nbsp;the&nbsp;index&nbsp;pairs</span><br>
<span class="lineno"></span><span class="comment" id="3446383">//&nbsp;identifying&nbsp;the&nbsp;leftmost&nbsp;match&nbsp;of&nbsp;the&nbsp;regular&nbsp;expression&nbsp;of&nbsp;text&nbsp;read&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3446459">//&nbsp;the&nbsp;RuneReader,&nbsp;and&nbsp;the&nbsp;matches,&nbsp;if&nbsp;any,&nbsp;of&nbsp;its&nbsp;subexpressions,&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3446537">//&nbsp;by&nbsp;the&nbsp;&#39;Submatch&#39;&nbsp;and&nbsp;&#39;Index&#39;&nbsp;descriptions&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.&nbsp;&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="3446610">//&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">910</span><span class="keyword" id="3446653">func</span>&nbsp;<span class="op" id="3446658">(</span><span class="ident" id="3446659">re</span>&nbsp;<span class="op" id="3446662">*</span><span class="ident" id="3446663">Regexp</span><span class="op" id="3446669">)</span>&nbsp;<span class="ident" id="3446671">FindReaderSubmatchIndex</span><span class="op" id="3446694">(</span><span class="ident" id="3446695">r</span>&nbsp;<span class="ident" id="3446697">io</span><span class="op" id="3446699">.</span><span class="ident" id="3446700">RuneReader</span><span class="op" id="3446710">)</span>&nbsp;<span class="op" id="3446712">[</span><span class="op" id="3446713">]</span><span class="builtintype" id="3446714">int</span>&nbsp;<span class="op" id="3446718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3446721">return</span>&nbsp;<span class="ident" id="3446728">re</span><span class="op" id="3446730">.</span><span class="ident" id="3446731">pad</span><span class="op" id="3446734">(</span><span class="ident" id="3446735">re</span><span class="op" id="3446737">.</span><span class="ident" id="3446738">doExecute</span><span class="op" id="3446747">(</span><span class="ident" id="3446748">r</span><span class="op" id="3446749">,</span>&nbsp;<span class="builtintype" id="3446751">nil</span><span class="op" id="3446754">,</span>&nbsp;<span class="string" id="3446756">&#34;&#34;</span><span class="op" id="3446758">,</span>&nbsp;<span class="num" id="3446760">0</span><span class="op" id="3446761">,</span>&nbsp;<span class="ident" id="3446763">re</span><span class="op" id="3446765">.</span><span class="ident" id="3446766">prog</span><span class="op" id="3446770">.</span><span class="ident" id="3446771">NumCap</span><span class="op" id="3446777">)</span><span class="op" id="3446778">)</span><br>
<span class="lineno"></span><span class="op" id="3446780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3446783">const</span>&nbsp;<span class="ident" id="3446789">startSize</span>&nbsp;<span class="op" id="3446799">=</span>&nbsp;<span class="num" id="3446801">10</span>&nbsp;<span class="comment" id="3446804">//&nbsp;The&nbsp;size&nbsp;at&nbsp;which&nbsp;to&nbsp;start&nbsp;a&nbsp;slice&nbsp;in&nbsp;the&nbsp;&#39;All&#39;&nbsp;routines.</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="3446866">//&nbsp;FindAll&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;Find;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="3446944">//&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3447017">//&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3447037">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno">920</span><span class="keyword" id="3447082">func</span>&nbsp;<span class="op" id="3447087">(</span><span class="ident" id="3447088">re</span>&nbsp;<span class="op" id="3447091">*</span><span class="ident" id="3447092">Regexp</span><span class="op" id="3447098">)</span>&nbsp;<span class="ident" id="3447100">FindAll</span><span class="op" id="3447107">(</span><span class="ident" id="3447108">b</span>&nbsp;<span class="op" id="3447110">[</span><span class="op" id="3447111">]</span><span class="builtintype" id="3447112">byte</span><span class="op" id="3447116">,</span>&nbsp;<span class="ident" id="3447118">n</span>&nbsp;<span class="builtintype" id="3447120">int</span><span class="op" id="3447123">)</span>&nbsp;<span class="op" id="3447125">[</span><span class="op" id="3447126">]</span><span class="op" id="3447127">[</span><span class="op" id="3447128">]</span><span class="builtintype" id="3447129">byte</span>&nbsp;<span class="op" id="3447134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447137">if</span>&nbsp;<span class="ident" id="3447140">n</span>&nbsp;<span class="op" id="3447142">&lt;</span>&nbsp;<span class="num" id="3447144">0</span>&nbsp;<span class="op" id="3447146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447150">n</span>&nbsp;<span class="op" id="3447152">=</span>&nbsp;<span class="builtinfunc" id="3447154">len</span><span class="op" id="3447157">(</span><span class="ident" id="3447158">b</span><span class="op" id="3447159">)</span>&nbsp;<span class="op" id="3447161">+</span>&nbsp;<span class="num" id="3447163">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447169">result</span>&nbsp;<span class="op" id="3447176">:=</span>&nbsp;<span class="builtinfunc" id="3447179">make</span><span class="op" id="3447183">(</span><span class="op" id="3447184">[</span><span class="op" id="3447185">]</span><span class="op" id="3447186">[</span><span class="op" id="3447187">]</span><span class="builtintype" id="3447188">byte</span><span class="op" id="3447192">,</span>&nbsp;<span class="num" id="3447194">0</span><span class="op" id="3447195">,</span>&nbsp;<span class="ident" id="3447197">startSize</span><span class="op" id="3447206">)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447209">re</span><span class="op" id="3447211">.</span><span class="ident" id="3447212">allMatches</span><span class="op" id="3447222">(</span><span class="string" id="3447223">&#34;&#34;</span><span class="op" id="3447225">,</span>&nbsp;<span class="ident" id="3447227">b</span><span class="op" id="3447228">,</span>&nbsp;<span class="ident" id="3447230">n</span><span class="op" id="3447231">,</span>&nbsp;<span class="keyword" id="3447233">func</span><span class="op" id="3447237">(</span><span class="ident" id="3447238">match</span>&nbsp;<span class="op" id="3447244">[</span><span class="op" id="3447245">]</span><span class="builtintype" id="3447246">int</span><span class="op" id="3447249">)</span>&nbsp;<span class="op" id="3447251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447255">result</span>&nbsp;<span class="op" id="3447262">=</span>&nbsp;<span class="builtinfunc" id="3447264">append</span><span class="op" id="3447270">(</span><span class="ident" id="3447271">result</span><span class="op" id="3447277">,</span>&nbsp;<span class="ident" id="3447279">b</span><span class="op" id="3447280">[</span><span class="ident" id="3447281">match</span><span class="op" id="3447286">[</span><span class="num" id="3447287">0</span><span class="op" id="3447288">]</span><span class="op" id="3447289">:</span><span class="ident" id="3447290">match</span><span class="op" id="3447295">[</span><span class="num" id="3447296">1</span><span class="op" id="3447297">]</span><span class="op" id="3447298">]</span><span class="op" id="3447299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447302">}</span><span class="op" id="3447303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447306">if</span>&nbsp;<span class="builtinfunc" id="3447309">len</span><span class="op" id="3447312">(</span><span class="ident" id="3447313">result</span><span class="op" id="3447319">)</span>&nbsp;<span class="op" id="3447321">==</span>&nbsp;<span class="num" id="3447324">0</span>&nbsp;<span class="op" id="3447326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447330">return</span>&nbsp;<span class="builtintype" id="3447337">nil</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447345">return</span>&nbsp;<span class="ident" id="3447352">result</span><br>
<span class="lineno"></span><span class="op" id="3447359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3447362">//&nbsp;FindAllIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno">935</span><span class="comment" id="3447439">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="3447516">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3447543">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3447588">func</span>&nbsp;<span class="op" id="3447593">(</span><span class="ident" id="3447594">re</span>&nbsp;<span class="op" id="3447597">*</span><span class="ident" id="3447598">Regexp</span><span class="op" id="3447604">)</span>&nbsp;<span class="ident" id="3447606">FindAllIndex</span><span class="op" id="3447618">(</span><span class="ident" id="3447619">b</span>&nbsp;<span class="op" id="3447621">[</span><span class="op" id="3447622">]</span><span class="builtintype" id="3447623">byte</span><span class="op" id="3447627">,</span>&nbsp;<span class="ident" id="3447629">n</span>&nbsp;<span class="builtintype" id="3447631">int</span><span class="op" id="3447634">)</span>&nbsp;<span class="op" id="3447636">[</span><span class="op" id="3447637">]</span><span class="op" id="3447638">[</span><span class="op" id="3447639">]</span><span class="builtintype" id="3447640">int</span>&nbsp;<span class="op" id="3447644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447647">if</span>&nbsp;<span class="ident" id="3447650">n</span>&nbsp;<span class="op" id="3447652">&lt;</span>&nbsp;<span class="num" id="3447654">0</span>&nbsp;<span class="op" id="3447656">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447660">n</span>&nbsp;<span class="op" id="3447662">=</span>&nbsp;<span class="builtinfunc" id="3447664">len</span><span class="op" id="3447667">(</span><span class="ident" id="3447668">b</span><span class="op" id="3447669">)</span>&nbsp;<span class="op" id="3447671">+</span>&nbsp;<span class="num" id="3447673">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447679">result</span>&nbsp;<span class="op" id="3447686">:=</span>&nbsp;<span class="builtinfunc" id="3447689">make</span><span class="op" id="3447693">(</span><span class="op" id="3447694">[</span><span class="op" id="3447695">]</span><span class="op" id="3447696">[</span><span class="op" id="3447697">]</span><span class="builtintype" id="3447698">int</span><span class="op" id="3447701">,</span>&nbsp;<span class="num" id="3447703">0</span><span class="op" id="3447704">,</span>&nbsp;<span class="ident" id="3447706">startSize</span><span class="op" id="3447715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447718">re</span><span class="op" id="3447720">.</span><span class="ident" id="3447721">allMatches</span><span class="op" id="3447731">(</span><span class="string" id="3447732">&#34;&#34;</span><span class="op" id="3447734">,</span>&nbsp;<span class="ident" id="3447736">b</span><span class="op" id="3447737">,</span>&nbsp;<span class="ident" id="3447739">n</span><span class="op" id="3447740">,</span>&nbsp;<span class="keyword" id="3447742">func</span><span class="op" id="3447746">(</span><span class="ident" id="3447747">match</span>&nbsp;<span class="op" id="3447753">[</span><span class="op" id="3447754">]</span><span class="builtintype" id="3447755">int</span><span class="op" id="3447758">)</span>&nbsp;<span class="op" id="3447760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3447764">result</span>&nbsp;<span class="op" id="3447771">=</span>&nbsp;<span class="builtinfunc" id="3447773">append</span><span class="op" id="3447779">(</span><span class="ident" id="3447780">result</span><span class="op" id="3447786">,</span>&nbsp;<span class="ident" id="3447788">match</span><span class="op" id="3447793">[</span><span class="num" id="3447794">0</span><span class="op" id="3447795">:</span><span class="num" id="3447796">2</span><span class="op" id="3447797">]</span><span class="op" id="3447798">)</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447801">}</span><span class="op" id="3447802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447805">if</span>&nbsp;<span class="builtinfunc" id="3447808">len</span><span class="op" id="3447811">(</span><span class="ident" id="3447812">result</span><span class="op" id="3447818">)</span>&nbsp;<span class="op" id="3447820">==</span>&nbsp;<span class="num" id="3447823">0</span>&nbsp;<span class="op" id="3447825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447829">return</span>&nbsp;<span class="builtintype" id="3447836">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3447844">return</span>&nbsp;<span class="ident" id="3447851">result</span><br>
<span class="lineno">950</span><span class="op" id="3447858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3447861">//&nbsp;FindAllString&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindString;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3447940">//&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description</span><br>
<span class="lineno"></span><span class="comment" id="3448017">//&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">955</span><span class="comment" id="3448044">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3448089">func</span>&nbsp;<span class="op" id="3448094">(</span><span class="ident" id="3448095">re</span>&nbsp;<span class="op" id="3448098">*</span><span class="ident" id="3448099">Regexp</span><span class="op" id="3448105">)</span>&nbsp;<span class="ident" id="3448107">FindAllString</span><span class="op" id="3448120">(</span><span class="ident" id="3448121">s</span>&nbsp;<span class="builtintype" id="3448123">string</span><span class="op" id="3448129">,</span>&nbsp;<span class="ident" id="3448131">n</span>&nbsp;<span class="builtintype" id="3448133">int</span><span class="op" id="3448136">)</span>&nbsp;<span class="op" id="3448138">[</span><span class="op" id="3448139">]</span><span class="builtintype" id="3448140">string</span>&nbsp;<span class="op" id="3448147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448150">if</span>&nbsp;<span class="ident" id="3448153">n</span>&nbsp;<span class="op" id="3448155">&lt;</span>&nbsp;<span class="num" id="3448157">0</span>&nbsp;<span class="op" id="3448159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448163">n</span>&nbsp;<span class="op" id="3448165">=</span>&nbsp;<span class="builtinfunc" id="3448167">len</span><span class="op" id="3448170">(</span><span class="ident" id="3448171">s</span><span class="op" id="3448172">)</span>&nbsp;<span class="op" id="3448174">+</span>&nbsp;<span class="num" id="3448176">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448179">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448182">result</span>&nbsp;<span class="op" id="3448189">:=</span>&nbsp;<span class="builtinfunc" id="3448192">make</span><span class="op" id="3448196">(</span><span class="op" id="3448197">[</span><span class="op" id="3448198">]</span><span class="builtintype" id="3448199">string</span><span class="op" id="3448205">,</span>&nbsp;<span class="num" id="3448207">0</span><span class="op" id="3448208">,</span>&nbsp;<span class="ident" id="3448210">startSize</span><span class="op" id="3448219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448222">re</span><span class="op" id="3448224">.</span><span class="ident" id="3448225">allMatches</span><span class="op" id="3448235">(</span><span class="ident" id="3448236">s</span><span class="op" id="3448237">,</span>&nbsp;<span class="builtintype" id="3448239">nil</span><span class="op" id="3448242">,</span>&nbsp;<span class="ident" id="3448244">n</span><span class="op" id="3448245">,</span>&nbsp;<span class="keyword" id="3448247">func</span><span class="op" id="3448251">(</span><span class="ident" id="3448252">match</span>&nbsp;<span class="op" id="3448258">[</span><span class="op" id="3448259">]</span><span class="builtintype" id="3448260">int</span><span class="op" id="3448263">)</span>&nbsp;<span class="op" id="3448265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448269">result</span>&nbsp;<span class="op" id="3448276">=</span>&nbsp;<span class="builtinfunc" id="3448278">append</span><span class="op" id="3448284">(</span><span class="ident" id="3448285">result</span><span class="op" id="3448291">,</span>&nbsp;<span class="ident" id="3448293">s</span><span class="op" id="3448294">[</span><span class="ident" id="3448295">match</span><span class="op" id="3448300">[</span><span class="num" id="3448301">0</span><span class="op" id="3448302">]</span><span class="op" id="3448303">:</span><span class="ident" id="3448304">match</span><span class="op" id="3448309">[</span><span class="num" id="3448310">1</span><span class="op" id="3448311">]</span><span class="op" id="3448312">]</span><span class="op" id="3448313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448316">}</span><span class="op" id="3448317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448320">if</span>&nbsp;<span class="builtinfunc" id="3448323">len</span><span class="op" id="3448326">(</span><span class="ident" id="3448327">result</span><span class="op" id="3448333">)</span>&nbsp;<span class="op" id="3448335">==</span>&nbsp;<span class="num" id="3448338">0</span>&nbsp;<span class="op" id="3448340">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448344">return</span>&nbsp;<span class="builtintype" id="3448351">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448359">return</span>&nbsp;<span class="ident" id="3448366">result</span><br>
<span class="lineno"></span><span class="op" id="3448373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="comment" id="3448376">//&nbsp;FindAllStringIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringIndex;&nbsp;it&nbsp;returns&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3448452">//&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3448530">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3448569">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3448614">func</span>&nbsp;<span class="op" id="3448619">(</span><span class="ident" id="3448620">re</span>&nbsp;<span class="op" id="3448623">*</span><span class="ident" id="3448624">Regexp</span><span class="op" id="3448630">)</span>&nbsp;<span class="ident" id="3448632">FindAllStringIndex</span><span class="op" id="3448650">(</span><span class="ident" id="3448651">s</span>&nbsp;<span class="builtintype" id="3448653">string</span><span class="op" id="3448659">,</span>&nbsp;<span class="ident" id="3448661">n</span>&nbsp;<span class="builtintype" id="3448663">int</span><span class="op" id="3448666">)</span>&nbsp;<span class="op" id="3448668">[</span><span class="op" id="3448669">]</span><span class="op" id="3448670">[</span><span class="op" id="3448671">]</span><span class="builtintype" id="3448672">int</span>&nbsp;<span class="op" id="3448676">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448679">if</span>&nbsp;<span class="ident" id="3448682">n</span>&nbsp;<span class="op" id="3448684">&lt;</span>&nbsp;<span class="num" id="3448686">0</span>&nbsp;<span class="op" id="3448688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448692">n</span>&nbsp;<span class="op" id="3448694">=</span>&nbsp;<span class="builtinfunc" id="3448696">len</span><span class="op" id="3448699">(</span><span class="ident" id="3448700">s</span><span class="op" id="3448701">)</span>&nbsp;<span class="op" id="3448703">+</span>&nbsp;<span class="num" id="3448705">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448711">result</span>&nbsp;<span class="op" id="3448718">:=</span>&nbsp;<span class="builtinfunc" id="3448721">make</span><span class="op" id="3448725">(</span><span class="op" id="3448726">[</span><span class="op" id="3448727">]</span><span class="op" id="3448728">[</span><span class="op" id="3448729">]</span><span class="builtintype" id="3448730">int</span><span class="op" id="3448733">,</span>&nbsp;<span class="num" id="3448735">0</span><span class="op" id="3448736">,</span>&nbsp;<span class="ident" id="3448738">startSize</span><span class="op" id="3448747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448750">re</span><span class="op" id="3448752">.</span><span class="ident" id="3448753">allMatches</span><span class="op" id="3448763">(</span><span class="ident" id="3448764">s</span><span class="op" id="3448765">,</span>&nbsp;<span class="builtintype" id="3448767">nil</span><span class="op" id="3448770">,</span>&nbsp;<span class="ident" id="3448772">n</span><span class="op" id="3448773">,</span>&nbsp;<span class="keyword" id="3448775">func</span><span class="op" id="3448779">(</span><span class="ident" id="3448780">match</span>&nbsp;<span class="op" id="3448786">[</span><span class="op" id="3448787">]</span><span class="builtintype" id="3448788">int</span><span class="op" id="3448791">)</span>&nbsp;<span class="op" id="3448793">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448797">result</span>&nbsp;<span class="op" id="3448804">=</span>&nbsp;<span class="builtinfunc" id="3448806">append</span><span class="op" id="3448812">(</span><span class="ident" id="3448813">result</span><span class="op" id="3448819">,</span>&nbsp;<span class="ident" id="3448821">match</span><span class="op" id="3448826">[</span><span class="num" id="3448827">0</span><span class="op" id="3448828">:</span><span class="num" id="3448829">2</span><span class="op" id="3448830">]</span><span class="op" id="3448831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448834">}</span><span class="op" id="3448835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448838">if</span>&nbsp;<span class="builtinfunc" id="3448841">len</span><span class="op" id="3448844">(</span><span class="ident" id="3448845">result</span><span class="op" id="3448851">)</span>&nbsp;<span class="op" id="3448853">==</span>&nbsp;<span class="num" id="3448856">0</span>&nbsp;<span class="op" id="3448858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448862">return</span>&nbsp;<span class="builtintype" id="3448869">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448874">}</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448877">return</span>&nbsp;<span class="ident" id="3448884">result</span><br>
<span class="lineno"></span><span class="op" id="3448891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3448894">//&nbsp;FindAllSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatch;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="3448970">//&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;</span><br>
<span class="lineno">990</span><span class="comment" id="3449042">//&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3449081">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3449126">func</span>&nbsp;<span class="op" id="3449131">(</span><span class="ident" id="3449132">re</span>&nbsp;<span class="op" id="3449135">*</span><span class="ident" id="3449136">Regexp</span><span class="op" id="3449142">)</span>&nbsp;<span class="ident" id="3449144">FindAllSubmatch</span><span class="op" id="3449159">(</span><span class="ident" id="3449160">b</span>&nbsp;<span class="op" id="3449162">[</span><span class="op" id="3449163">]</span><span class="builtintype" id="3449164">byte</span><span class="op" id="3449168">,</span>&nbsp;<span class="ident" id="3449170">n</span>&nbsp;<span class="builtintype" id="3449172">int</span><span class="op" id="3449175">)</span>&nbsp;<span class="op" id="3449177">[</span><span class="op" id="3449178">]</span><span class="op" id="3449179">[</span><span class="op" id="3449180">]</span><span class="op" id="3449181">[</span><span class="op" id="3449182">]</span><span class="builtintype" id="3449183">byte</span>&nbsp;<span class="op" id="3449188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449191">if</span>&nbsp;<span class="ident" id="3449194">n</span>&nbsp;<span class="op" id="3449196">&lt;</span>&nbsp;<span class="num" id="3449198">0</span>&nbsp;<span class="op" id="3449200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449204">n</span>&nbsp;<span class="op" id="3449206">=</span>&nbsp;<span class="builtinfunc" id="3449208">len</span><span class="op" id="3449211">(</span><span class="ident" id="3449212">b</span><span class="op" id="3449213">)</span>&nbsp;<span class="op" id="3449215">+</span>&nbsp;<span class="num" id="3449217">1</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449223">result</span>&nbsp;<span class="op" id="3449230">:=</span>&nbsp;<span class="builtinfunc" id="3449233">make</span><span class="op" id="3449237">(</span><span class="op" id="3449238">[</span><span class="op" id="3449239">]</span><span class="op" id="3449240">[</span><span class="op" id="3449241">]</span><span class="op" id="3449242">[</span><span class="op" id="3449243">]</span><span class="builtintype" id="3449244">byte</span><span class="op" id="3449248">,</span>&nbsp;<span class="num" id="3449250">0</span><span class="op" id="3449251">,</span>&nbsp;<span class="ident" id="3449253">startSize</span><span class="op" id="3449262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449265">re</span><span class="op" id="3449267">.</span><span class="ident" id="3449268">allMatches</span><span class="op" id="3449278">(</span><span class="string" id="3449279">&#34;&#34;</span><span class="op" id="3449281">,</span>&nbsp;<span class="ident" id="3449283">b</span><span class="op" id="3449284">,</span>&nbsp;<span class="ident" id="3449286">n</span><span class="op" id="3449287">,</span>&nbsp;<span class="keyword" id="3449289">func</span><span class="op" id="3449293">(</span><span class="ident" id="3449294">match</span>&nbsp;<span class="op" id="3449300">[</span><span class="op" id="3449301">]</span><span class="builtintype" id="3449302">int</span><span class="op" id="3449305">)</span>&nbsp;<span class="op" id="3449307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449311">slice</span>&nbsp;<span class="op" id="3449317">:=</span>&nbsp;<span class="builtinfunc" id="3449320">make</span><span class="op" id="3449324">(</span><span class="op" id="3449325">[</span><span class="op" id="3449326">]</span><span class="op" id="3449327">[</span><span class="op" id="3449328">]</span><span class="builtintype" id="3449329">byte</span><span class="op" id="3449333">,</span>&nbsp;<span class="builtinfunc" id="3449335">len</span><span class="op" id="3449338">(</span><span class="ident" id="3449339">match</span><span class="op" id="3449344">)</span><span class="op" id="3449345">/</span><span class="num" id="3449346">2</span><span class="op" id="3449347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449351">for</span>&nbsp;<span class="ident" id="3449355">j</span>&nbsp;<span class="op" id="3449357">:=</span>&nbsp;<span class="keyword" id="3449360">range</span>&nbsp;<span class="ident" id="3449366">slice</span>&nbsp;<span class="op" id="3449372">{</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449377">if</span>&nbsp;<span class="ident" id="3449380">match</span><span class="op" id="3449385">[</span><span class="num" id="3449386">2</span><span class="op" id="3449387">*</span><span class="ident" id="3449388">j</span><span class="op" id="3449389">]</span>&nbsp;<span class="op" id="3449391">&gt;=</span>&nbsp;<span class="num" id="3449394">0</span>&nbsp;<span class="op" id="3449396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449402">slice</span><span class="op" id="3449407">[</span><span class="ident" id="3449408">j</span><span class="op" id="3449409">]</span>&nbsp;<span class="op" id="3449411">=</span>&nbsp;<span class="ident" id="3449413">b</span><span class="op" id="3449414">[</span><span class="ident" id="3449415">match</span><span class="op" id="3449420">[</span><span class="num" id="3449421">2</span><span class="op" id="3449422">*</span><span class="ident" id="3449423">j</span><span class="op" id="3449424">]</span><span class="op" id="3449425">:</span><span class="ident" id="3449426">match</span><span class="op" id="3449431">[</span><span class="num" id="3449432">2</span><span class="op" id="3449433">*</span><span class="ident" id="3449434">j</span><span class="op" id="3449435">+</span><span class="num" id="3449436">1</span><span class="op" id="3449437">]</span><span class="op" id="3449438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449451">result</span>&nbsp;<span class="op" id="3449458">=</span>&nbsp;<span class="builtinfunc" id="3449460">append</span><span class="op" id="3449466">(</span><span class="ident" id="3449467">result</span><span class="op" id="3449473">,</span>&nbsp;<span class="ident" id="3449475">slice</span><span class="op" id="3449480">)</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449483">}</span><span class="op" id="3449484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449487">if</span>&nbsp;<span class="builtinfunc" id="3449490">len</span><span class="op" id="3449493">(</span><span class="ident" id="3449494">result</span><span class="op" id="3449500">)</span>&nbsp;<span class="op" id="3449502">==</span>&nbsp;<span class="num" id="3449505">0</span>&nbsp;<span class="op" id="3449507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449511">return</span>&nbsp;<span class="builtintype" id="3449518">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449526">return</span>&nbsp;<span class="ident" id="3449533">result</span><br>
<span class="lineno">1010</span><span class="op" id="3449540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3449543">//&nbsp;FindAllSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindSubmatchIndex;&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3449621">//&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3449695">//&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno">1015</span><span class="comment" id="3449740">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3449785">func</span>&nbsp;<span class="op" id="3449790">(</span><span class="ident" id="3449791">re</span>&nbsp;<span class="op" id="3449794">*</span><span class="ident" id="3449795">Regexp</span><span class="op" id="3449801">)</span>&nbsp;<span class="ident" id="3449803">FindAllSubmatchIndex</span><span class="op" id="3449823">(</span><span class="ident" id="3449824">b</span>&nbsp;<span class="op" id="3449826">[</span><span class="op" id="3449827">]</span><span class="builtintype" id="3449828">byte</span><span class="op" id="3449832">,</span>&nbsp;<span class="ident" id="3449834">n</span>&nbsp;<span class="builtintype" id="3449836">int</span><span class="op" id="3449839">)</span>&nbsp;<span class="op" id="3449841">[</span><span class="op" id="3449842">]</span><span class="op" id="3449843">[</span><span class="op" id="3449844">]</span><span class="builtintype" id="3449845">int</span>&nbsp;<span class="op" id="3449849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449852">if</span>&nbsp;<span class="ident" id="3449855">n</span>&nbsp;<span class="op" id="3449857">&lt;</span>&nbsp;<span class="num" id="3449859">0</span>&nbsp;<span class="op" id="3449861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449865">n</span>&nbsp;<span class="op" id="3449867">=</span>&nbsp;<span class="builtinfunc" id="3449869">len</span><span class="op" id="3449872">(</span><span class="ident" id="3449873">b</span><span class="op" id="3449874">)</span>&nbsp;<span class="op" id="3449876">+</span>&nbsp;<span class="num" id="3449878">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449881">}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449884">result</span>&nbsp;<span class="op" id="3449891">:=</span>&nbsp;<span class="builtinfunc" id="3449894">make</span><span class="op" id="3449898">(</span><span class="op" id="3449899">[</span><span class="op" id="3449900">]</span><span class="op" id="3449901">[</span><span class="op" id="3449902">]</span><span class="builtintype" id="3449903">int</span><span class="op" id="3449906">,</span>&nbsp;<span class="num" id="3449908">0</span><span class="op" id="3449909">,</span>&nbsp;<span class="ident" id="3449911">startSize</span><span class="op" id="3449920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449923">re</span><span class="op" id="3449925">.</span><span class="ident" id="3449926">allMatches</span><span class="op" id="3449936">(</span><span class="string" id="3449937">&#34;&#34;</span><span class="op" id="3449939">,</span>&nbsp;<span class="ident" id="3449941">b</span><span class="op" id="3449942">,</span>&nbsp;<span class="ident" id="3449944">n</span><span class="op" id="3449945">,</span>&nbsp;<span class="keyword" id="3449947">func</span><span class="op" id="3449951">(</span><span class="ident" id="3449952">match</span>&nbsp;<span class="op" id="3449958">[</span><span class="op" id="3449959">]</span><span class="builtintype" id="3449960">int</span><span class="op" id="3449963">)</span>&nbsp;<span class="op" id="3449965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449969">result</span>&nbsp;<span class="op" id="3449976">=</span>&nbsp;<span class="builtinfunc" id="3449978">append</span><span class="op" id="3449984">(</span><span class="ident" id="3449985">result</span><span class="op" id="3449991">,</span>&nbsp;<span class="ident" id="3449993">match</span><span class="op" id="3449998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450001">}</span><span class="op" id="3450002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450005">if</span>&nbsp;<span class="builtinfunc" id="3450008">len</span><span class="op" id="3450011">(</span><span class="ident" id="3450012">result</span><span class="op" id="3450018">)</span>&nbsp;<span class="op" id="3450020">==</span>&nbsp;<span class="num" id="3450023">0</span>&nbsp;<span class="op" id="3450025">{</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450029">return</span>&nbsp;<span class="builtintype" id="3450036">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450044">return</span>&nbsp;<span class="ident" id="3450051">result</span><br>
<span class="lineno"></span><span class="op" id="3450058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1030</span><span class="comment" id="3450061">//&nbsp;FindAllStringSubmatch&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of&nbsp;FindStringSubmatch;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3450133">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3450211">//&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3450260">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3450305">func</span>&nbsp;<span class="op" id="3450310">(</span><span class="ident" id="3450311">re</span>&nbsp;<span class="op" id="3450314">*</span><span class="ident" id="3450315">Regexp</span><span class="op" id="3450321">)</span>&nbsp;<span class="ident" id="3450323">FindAllStringSubmatch</span><span class="op" id="3450344">(</span><span class="ident" id="3450345">s</span>&nbsp;<span class="builtintype" id="3450347">string</span><span class="op" id="3450353">,</span>&nbsp;<span class="ident" id="3450355">n</span>&nbsp;<span class="builtintype" id="3450357">int</span><span class="op" id="3450360">)</span>&nbsp;<span class="op" id="3450362">[</span><span class="op" id="3450363">]</span><span class="op" id="3450364">[</span><span class="op" id="3450365">]</span><span class="builtintype" id="3450366">string</span>&nbsp;<span class="op" id="3450373">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450376">if</span>&nbsp;<span class="ident" id="3450379">n</span>&nbsp;<span class="op" id="3450381">&lt;</span>&nbsp;<span class="num" id="3450383">0</span>&nbsp;<span class="op" id="3450385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450389">n</span>&nbsp;<span class="op" id="3450391">=</span>&nbsp;<span class="builtinfunc" id="3450393">len</span><span class="op" id="3450396">(</span><span class="ident" id="3450397">s</span><span class="op" id="3450398">)</span>&nbsp;<span class="op" id="3450400">+</span>&nbsp;<span class="num" id="3450402">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450408">result</span>&nbsp;<span class="op" id="3450415">:=</span>&nbsp;<span class="builtinfunc" id="3450418">make</span><span class="op" id="3450422">(</span><span class="op" id="3450423">[</span><span class="op" id="3450424">]</span><span class="op" id="3450425">[</span><span class="op" id="3450426">]</span><span class="builtintype" id="3450427">string</span><span class="op" id="3450433">,</span>&nbsp;<span class="num" id="3450435">0</span><span class="op" id="3450436">,</span>&nbsp;<span class="ident" id="3450438">startSize</span><span class="op" id="3450447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450450">re</span><span class="op" id="3450452">.</span><span class="ident" id="3450453">allMatches</span><span class="op" id="3450463">(</span><span class="ident" id="3450464">s</span><span class="op" id="3450465">,</span>&nbsp;<span class="builtintype" id="3450467">nil</span><span class="op" id="3450470">,</span>&nbsp;<span class="ident" id="3450472">n</span><span class="op" id="3450473">,</span>&nbsp;<span class="keyword" id="3450475">func</span><span class="op" id="3450479">(</span><span class="ident" id="3450480">match</span>&nbsp;<span class="op" id="3450486">[</span><span class="op" id="3450487">]</span><span class="builtintype" id="3450488">int</span><span class="op" id="3450491">)</span>&nbsp;<span class="op" id="3450493">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450497">slice</span>&nbsp;<span class="op" id="3450503">:=</span>&nbsp;<span class="builtinfunc" id="3450506">make</span><span class="op" id="3450510">(</span><span class="op" id="3450511">[</span><span class="op" id="3450512">]</span><span class="builtintype" id="3450513">string</span><span class="op" id="3450519">,</span>&nbsp;<span class="builtinfunc" id="3450521">len</span><span class="op" id="3450524">(</span><span class="ident" id="3450525">match</span><span class="op" id="3450530">)</span><span class="op" id="3450531">/</span><span class="num" id="3450532">2</span><span class="op" id="3450533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450537">for</span>&nbsp;<span class="ident" id="3450541">j</span>&nbsp;<span class="op" id="3450543">:=</span>&nbsp;<span class="keyword" id="3450546">range</span>&nbsp;<span class="ident" id="3450552">slice</span>&nbsp;<span class="op" id="3450558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450563">if</span>&nbsp;<span class="ident" id="3450566">match</span><span class="op" id="3450571">[</span><span class="num" id="3450572">2</span><span class="op" id="3450573">*</span><span class="ident" id="3450574">j</span><span class="op" id="3450575">]</span>&nbsp;<span class="op" id="3450577">&gt;=</span>&nbsp;<span class="num" id="3450580">0</span>&nbsp;<span class="op" id="3450582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450588">slice</span><span class="op" id="3450593">[</span><span class="ident" id="3450594">j</span><span class="op" id="3450595">]</span>&nbsp;<span class="op" id="3450597">=</span>&nbsp;<span class="ident" id="3450599">s</span><span class="op" id="3450600">[</span><span class="ident" id="3450601">match</span><span class="op" id="3450606">[</span><span class="num" id="3450607">2</span><span class="op" id="3450608">*</span><span class="ident" id="3450609">j</span><span class="op" id="3450610">]</span><span class="op" id="3450611">:</span><span class="ident" id="3450612">match</span><span class="op" id="3450617">[</span><span class="num" id="3450618">2</span><span class="op" id="3450619">*</span><span class="ident" id="3450620">j</span><span class="op" id="3450621">+</span><span class="num" id="3450622">1</span><span class="op" id="3450623">]</span><span class="op" id="3450624">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450629">}</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3450637">result</span>&nbsp;<span class="op" id="3450644">=</span>&nbsp;<span class="builtinfunc" id="3450646">append</span><span class="op" id="3450652">(</span><span class="ident" id="3450653">result</span><span class="op" id="3450659">,</span>&nbsp;<span class="ident" id="3450661">slice</span><span class="op" id="3450666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450669">}</span><span class="op" id="3450670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450673">if</span>&nbsp;<span class="builtinfunc" id="3450676">len</span><span class="op" id="3450679">(</span><span class="ident" id="3450680">result</span><span class="op" id="3450686">)</span>&nbsp;<span class="op" id="3450688">==</span>&nbsp;<span class="num" id="3450691">0</span>&nbsp;<span class="op" id="3450693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450697">return</span>&nbsp;<span class="builtintype" id="3450704">nil</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3450709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3450712">return</span>&nbsp;<span class="ident" id="3450719">result</span><br>
<span class="lineno"></span><span class="op" id="3450726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3450729">//&nbsp;FindAllStringSubmatchIndex&nbsp;is&nbsp;the&nbsp;&#39;All&#39;&nbsp;version&nbsp;of</span><br>
<span class="lineno">1055</span><span class="comment" id="3450783">//&nbsp;FindStringSubmatchIndex;&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;successive&nbsp;matches&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3450859">//&nbsp;the&nbsp;expression,&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;&#39;All&#39;&nbsp;description&nbsp;in&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="3450929">//&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="3450941">//&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;nil&nbsp;indicates&nbsp;no&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3450986">func</span>&nbsp;<span class="op" id="3450991">(</span><span class="ident" id="3450992">re</span>&nbsp;<span class="op" id="3450995">*</span><span class="ident" id="3450996">Regexp</span><span class="op" id="3451002">)</span>&nbsp;<span class="ident" id="3451004">FindAllStringSubmatchIndex</span><span class="op" id="3451030">(</span><span class="ident" id="3451031">s</span>&nbsp;<span class="builtintype" id="3451033">string</span><span class="op" id="3451039">,</span>&nbsp;<span class="ident" id="3451041">n</span>&nbsp;<span class="builtintype" id="3451043">int</span><span class="op" id="3451046">)</span>&nbsp;<span class="op" id="3451048">[</span><span class="op" id="3451049">]</span><span class="op" id="3451050">[</span><span class="op" id="3451051">]</span><span class="builtintype" id="3451052">int</span>&nbsp;<span class="op" id="3451056">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451059">if</span>&nbsp;<span class="ident" id="3451062">n</span>&nbsp;<span class="op" id="3451064">&lt;</span>&nbsp;<span class="num" id="3451066">0</span>&nbsp;<span class="op" id="3451068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451072">n</span>&nbsp;<span class="op" id="3451074">=</span>&nbsp;<span class="builtinfunc" id="3451076">len</span><span class="op" id="3451079">(</span><span class="ident" id="3451080">s</span><span class="op" id="3451081">)</span>&nbsp;<span class="op" id="3451083">+</span>&nbsp;<span class="num" id="3451085">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451091">result</span>&nbsp;<span class="op" id="3451098">:=</span>&nbsp;<span class="builtinfunc" id="3451101">make</span><span class="op" id="3451105">(</span><span class="op" id="3451106">[</span><span class="op" id="3451107">]</span><span class="op" id="3451108">[</span><span class="op" id="3451109">]</span><span class="builtintype" id="3451110">int</span><span class="op" id="3451113">,</span>&nbsp;<span class="num" id="3451115">0</span><span class="op" id="3451116">,</span>&nbsp;<span class="ident" id="3451118">startSize</span><span class="op" id="3451127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451130">re</span><span class="op" id="3451132">.</span><span class="ident" id="3451133">allMatches</span><span class="op" id="3451143">(</span><span class="ident" id="3451144">s</span><span class="op" id="3451145">,</span>&nbsp;<span class="builtintype" id="3451147">nil</span><span class="op" id="3451150">,</span>&nbsp;<span class="ident" id="3451152">n</span><span class="op" id="3451153">,</span>&nbsp;<span class="keyword" id="3451155">func</span><span class="op" id="3451159">(</span><span class="ident" id="3451160">match</span>&nbsp;<span class="op" id="3451166">[</span><span class="op" id="3451167">]</span><span class="builtintype" id="3451168">int</span><span class="op" id="3451171">)</span>&nbsp;<span class="op" id="3451173">{</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3451177">result</span>&nbsp;<span class="op" id="3451184">=</span>&nbsp;<span class="builtinfunc" id="3451186">append</span><span class="op" id="3451192">(</span><span class="ident" id="3451193">result</span><span class="op" id="3451199">,</span>&nbsp;<span class="ident" id="3451201">match</span><span class="op" id="3451206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451209">}</span><span class="op" id="3451210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451213">if</span>&nbsp;<span class="builtinfunc" id="3451216">len</span><span class="op" id="3451219">(</span><span class="ident" id="3451220">result</span><span class="op" id="3451226">)</span>&nbsp;<span class="op" id="3451228">==</span>&nbsp;<span class="num" id="3451231">0</span>&nbsp;<span class="op" id="3451233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451237">return</span>&nbsp;<span class="builtintype" id="3451244">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3451249">}</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3451252">return</span>&nbsp;<span class="ident" id="3451259">result</span><br>
<span class="lineno"></span><span class="op" id="3451266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3451269">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;substrings&nbsp;separated&nbsp;by&nbsp;the&nbsp;expression&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3451354">//&nbsp;the&nbsp;substrings&nbsp;between&nbsp;those&nbsp;expression&nbsp;matches.</span><br>
<span class="lineno">1075</span><span class="comment" id="3451406">//</span><br>
<span class="lineno"></span><span class="comment" id="3451409">//&nbsp;The&nbsp;slice&nbsp;returned&nbsp;by&nbsp;this&nbsp;method&nbsp;consists&nbsp;of&nbsp;all&nbsp;the&nbsp;substrings&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="3451482">//&nbsp;not&nbsp;contained&nbsp;in&nbsp;the&nbsp;slice&nbsp;returned&nbsp;by&nbsp;FindAllString.&nbsp;When&nbsp;called&nbsp;on&nbsp;an&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="3451568">//&nbsp;that&nbsp;contains&nbsp;no&nbsp;metacharacters,&nbsp;it&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;strings.SplitN.</span><br>
<span class="lineno"></span><span class="comment" id="3451640">//</span><br>
<span class="lineno">1080</span><span class="comment" id="3451643">//&nbsp;Example:</span><br>
<span class="lineno"></span><span class="comment" id="3451655">//&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;regexp.MustCompile(&#34;a*&#34;).Split(&#34;abaabaccadaaae&#34;,&nbsp;5)</span><br>
<span class="lineno"></span><span class="comment" id="3451717">//&nbsp;&nbsp;&nbsp;//&nbsp;s:&nbsp;[&#34;&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;b&#34;,&nbsp;&#34;c&#34;,&nbsp;&#34;cadaaae&#34;]</span><br>
<span class="lineno"></span><span class="comment" id="3451759">//</span><br>
<span class="lineno"></span><span class="comment" id="3451762">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;substrings&nbsp;to&nbsp;return:</span><br>
<span class="lineno">1085</span><span class="comment" id="3451822">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;substrings;&nbsp;the&nbsp;last&nbsp;substring&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="3451906">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;substrings)</span><br>
<span class="lineno"></span><span class="comment" id="3451955">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;substrings</span><br>
<span class="lineno"></span><span class="keyword" id="3451982">func</span>&nbsp;<span class="op" id="3451987">(</span><span class="ident" id="3451988">re</span>&nbsp;<span class="op" id="3451991">*</span><span class="ident" id="3451992">Regexp</span><span class="op" id="3451998">)</span>&nbsp;<span class="ident" id="3452000">Split</span><span class="op" id="3452005">(</span><span class="ident" id="3452006">s</span>&nbsp;<span class="builtintype" id="3452008">string</span><span class="op" id="3452014">,</span>&nbsp;<span class="ident" id="3452016">n</span>&nbsp;<span class="builtintype" id="3452018">int</span><span class="op" id="3452021">)</span>&nbsp;<span class="op" id="3452023">[</span><span class="op" id="3452024">]</span><span class="builtintype" id="3452025">string</span>&nbsp;<span class="op" id="3452032">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452036">if</span>&nbsp;<span class="ident" id="3452039">n</span>&nbsp;<span class="op" id="3452041">==</span>&nbsp;<span class="num" id="3452044">0</span>&nbsp;<span class="op" id="3452046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452050">return</span>&nbsp;<span class="builtintype" id="3452057">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3452062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452066">if</span>&nbsp;<span class="builtinfunc" id="3452069">len</span><span class="op" id="3452072">(</span><span class="ident" id="3452073">re</span><span class="op" id="3452075">.</span><span class="ident" id="3452076">expr</span><span class="op" id="3452080">)</span>&nbsp;<span class="op" id="3452082">&gt;</span>&nbsp;<span class="num" id="3452084">0</span>&nbsp;<span class="op" id="3452086">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3452089">len</span><span class="op" id="3452092">(</span><span class="ident" id="3452093">s</span><span class="op" id="3452094">)</span>&nbsp;<span class="op" id="3452096">==</span>&nbsp;<span class="num" id="3452099">0</span>&nbsp;<span class="op" id="3452101">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452105">return</span>&nbsp;<span class="op" id="3452112">[</span><span class="op" id="3452113">]</span><span class="builtintype" id="3452114">string</span><span class="op" id="3452120">{</span><span class="string" id="3452121">&#34;&#34;</span><span class="op" id="3452123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3452126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452130">matches</span>&nbsp;<span class="op" id="3452138">:=</span>&nbsp;<span class="ident" id="3452141">re</span><span class="op" id="3452143">.</span><span class="ident" id="3452144">FindAllStringIndex</span><span class="op" id="3452162">(</span><span class="ident" id="3452163">s</span><span class="op" id="3452164">,</span>&nbsp;<span class="ident" id="3452166">n</span><span class="op" id="3452167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452170">strings</span>&nbsp;<span class="op" id="3452178">:=</span>&nbsp;<span class="builtinfunc" id="3452181">make</span><span class="op" id="3452185">(</span><span class="op" id="3452186">[</span><span class="op" id="3452187">]</span><span class="builtintype" id="3452188">string</span><span class="op" id="3452194">,</span>&nbsp;<span class="num" id="3452196">0</span><span class="op" id="3452197">,</span>&nbsp;<span class="builtinfunc" id="3452199">len</span><span class="op" id="3452202">(</span><span class="ident" id="3452203">matches</span><span class="op" id="3452210">)</span><span class="op" id="3452211">)</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452215">beg</span>&nbsp;<span class="op" id="3452219">:=</span>&nbsp;<span class="num" id="3452222">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452225">end</span>&nbsp;<span class="op" id="3452229">:=</span>&nbsp;<span class="num" id="3452232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452235">for</span>&nbsp;<span class="ident" id="3452239">_</span><span class="op" id="3452240">,</span>&nbsp;<span class="ident" id="3452242">match</span>&nbsp;<span class="op" id="3452248">:=</span>&nbsp;<span class="keyword" id="3452251">range</span>&nbsp;<span class="ident" id="3452257">matches</span>&nbsp;<span class="op" id="3452265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452269">if</span>&nbsp;<span class="ident" id="3452272">n</span>&nbsp;<span class="op" id="3452274">&gt;</span>&nbsp;<span class="num" id="3452276">0</span>&nbsp;<span class="op" id="3452278">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3452281">len</span><span class="op" id="3452284">(</span><span class="ident" id="3452285">strings</span><span class="op" id="3452292">)</span>&nbsp;<span class="op" id="3452294">&gt;=</span>&nbsp;<span class="ident" id="3452297">n</span><span class="op" id="3452298">-</span><span class="num" id="3452299">1</span>&nbsp;<span class="op" id="3452301">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452306">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3452314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452319">end</span>&nbsp;<span class="op" id="3452323">=</span>&nbsp;<span class="ident" id="3452325">match</span><span class="op" id="3452330">[</span><span class="num" id="3452331">0</span><span class="op" id="3452332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452336">if</span>&nbsp;<span class="ident" id="3452339">match</span><span class="op" id="3452344">[</span><span class="num" id="3452345">1</span><span class="op" id="3452346">]</span>&nbsp;<span class="op" id="3452348">!=</span>&nbsp;<span class="num" id="3452351">0</span>&nbsp;<span class="op" id="3452353">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452358">strings</span>&nbsp;<span class="op" id="3452366">=</span>&nbsp;<span class="builtinfunc" id="3452368">append</span><span class="op" id="3452374">(</span><span class="ident" id="3452375">strings</span><span class="op" id="3452382">,</span>&nbsp;<span class="ident" id="3452384">s</span><span class="op" id="3452385">[</span><span class="ident" id="3452386">beg</span><span class="op" id="3452389">:</span><span class="ident" id="3452390">end</span><span class="op" id="3452393">]</span><span class="op" id="3452394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3452398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452402">beg</span>&nbsp;<span class="op" id="3452406">=</span>&nbsp;<span class="ident" id="3452408">match</span><span class="op" id="3452413">[</span><span class="num" id="3452414">1</span><span class="op" id="3452415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3452418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452422">if</span>&nbsp;<span class="ident" id="3452425">end</span>&nbsp;<span class="op" id="3452429">!=</span>&nbsp;<span class="builtinfunc" id="3452432">len</span><span class="op" id="3452435">(</span><span class="ident" id="3452436">s</span><span class="op" id="3452437">)</span>&nbsp;<span class="op" id="3452439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3452443">strings</span>&nbsp;<span class="op" id="3452451">=</span>&nbsp;<span class="builtinfunc" id="3452453">append</span><span class="op" id="3452459">(</span><span class="ident" id="3452460">strings</span><span class="op" id="3452467">,</span>&nbsp;<span class="ident" id="3452469">s</span><span class="op" id="3452470">[</span><span class="ident" id="3452471">beg</span><span class="op" id="3452474">:</span><span class="op" id="3452475">]</span><span class="op" id="3452476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3452479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3452483">return</span>&nbsp;<span class="ident" id="3452490">strings</span><br>
<span class="lineno">1120</span><span class="op" id="3452498">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
