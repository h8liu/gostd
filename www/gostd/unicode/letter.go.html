<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html" class="current">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1767807">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1767862">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1767916">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1767967">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1768041">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1768065">package</span>&nbsp;<span class="ident" id="1768073">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1768082">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1768149">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1768215">const</span>&nbsp;<span class="op" id="1768221">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768224">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1768240">=</span>&nbsp;<span class="string" id="1768242">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1768255">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768293">ReplacementChar</span>&nbsp;<span class="op" id="1768309">=</span>&nbsp;<span class="string" id="1768311">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1768324">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768360">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1768376">=</span>&nbsp;<span class="string" id="1768378">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1768391">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768416">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1768432">=</span>&nbsp;<span class="string" id="1768434">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1768447">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1768473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1768476">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1768552">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1768619">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1768692">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1768755">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1768815">type</span>&nbsp;<span class="ident" id="1768820">RangeTable</span>&nbsp;<span class="keyword" id="1768831">struct</span>&nbsp;<span class="op" id="1768838">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768841">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1768853">[</span><span class="op" id="1768854">]</span><span class="ident" id="1768855">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768864">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1768876">[</span><span class="op" id="1768877">]</span><span class="ident" id="1768878">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1768887">LatinOffset</span>&nbsp;<span class="builtintype" id="1768899">int</span>&nbsp;<span class="comment" id="1768903">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1768952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1768955">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1769049">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1769092">type</span>&nbsp;<span class="ident" id="1769097">Range16</span>&nbsp;<span class="keyword" id="1769105">struct</span>&nbsp;<span class="op" id="1769112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769115">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769122">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769130">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769137">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769145">Stride</span>&nbsp;<span class="builtintype" id="1769152">uint16</span><br>
<span class="lineno"></span><span class="op" id="1769159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1769162">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1769242">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1769319">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1769397">type</span>&nbsp;<span class="ident" id="1769402">Range32</span>&nbsp;<span class="keyword" id="1769410">struct</span>&nbsp;<span class="op" id="1769417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769420">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769427">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769435">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1769442">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1769450">Stride</span>&nbsp;<span class="builtintype" id="1769457">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1769464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1769467">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1769538">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1769588">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1769665">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1769738">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1769812">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1769884">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1769960">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1770004">//&nbsp;&nbsp;&nbsp;&nbsp;{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1770044">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1770112">type</span>&nbsp;<span class="ident" id="1770117">CaseRange</span>&nbsp;<span class="keyword" id="1770127">struct</span>&nbsp;<span class="op" id="1770134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770137">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1770143">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770151">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1770157">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770165">Delta</span>&nbsp;<span class="ident" id="1770171">d</span><br>
<span class="lineno"></span><span class="op" id="1770173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1770176">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1770251">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1770326">type</span>&nbsp;<span class="ident" id="1770331">SpecialCase</span>&nbsp;<span class="op" id="1770343">[</span><span class="op" id="1770344">]</span><span class="ident" id="1770345">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1770356">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1770425">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1770492">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1770561">const</span>&nbsp;<span class="op" id="1770567">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770570">UpperCase</span>&nbsp;<span class="op" id="1770580">=</span>&nbsp;<span class="ident" id="1770582">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770588">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770599">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770610">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1770618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1770621">type</span>&nbsp;<span class="ident" id="1770626">d</span>&nbsp;<span class="op" id="1770628">[</span><span class="ident" id="1770629">MaxCase</span><span class="op" id="1770636">]</span><span class="builtintype" id="1770637">rune</span>&nbsp;<span class="comment" id="1770642">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1770682">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1770743">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1770801">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1770829">const</span>&nbsp;<span class="op" id="1770835">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1770838">UpperLower</span>&nbsp;<span class="op" id="1770849">=</span>&nbsp;<span class="ident" id="1770851">MaxRune</span>&nbsp;<span class="op" id="1770859">+</span>&nbsp;<span class="num" id="1770861">1</span>&nbsp;<span class="comment" id="1770863">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1770893">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1770896">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1770974">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1771018">const</span>&nbsp;<span class="ident" id="1771024">linearMax</span>&nbsp;<span class="op" id="1771034">=</span>&nbsp;<span class="num" id="1771036">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1771040">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1771107">func</span>&nbsp;<span class="ident" id="1771112">is16</span><span class="op" id="1771116">(</span><span class="ident" id="1771117">ranges</span>&nbsp;<span class="op" id="1771124">[</span><span class="op" id="1771125">]</span><span class="ident" id="1771126">Range16</span><span class="op" id="1771133">,</span>&nbsp;<span class="ident" id="1771135">r</span>&nbsp;<span class="builtintype" id="1771137">uint16</span><span class="op" id="1771143">)</span>&nbsp;<span class="builtintype" id="1771145">bool</span>&nbsp;<span class="op" id="1771150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771153">if</span>&nbsp;<span class="builtinfunc" id="1771156">len</span><span class="op" id="1771159">(</span><span class="ident" id="1771160">ranges</span><span class="op" id="1771166">)</span>&nbsp;<span class="op" id="1771168">&lt;=</span>&nbsp;<span class="ident" id="1771171">linearMax</span>&nbsp;<span class="op" id="1771181">||</span>&nbsp;<span class="ident" id="1771184">r</span>&nbsp;<span class="op" id="1771186">&lt;=</span>&nbsp;<span class="ident" id="1771189">MaxLatin1</span>&nbsp;<span class="op" id="1771199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771203">for</span>&nbsp;<span class="ident" id="1771207">i</span>&nbsp;<span class="op" id="1771209">:=</span>&nbsp;<span class="keyword" id="1771212">range</span>&nbsp;<span class="ident" id="1771218">ranges</span>&nbsp;<span class="op" id="1771225">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771230">range_</span>&nbsp;<span class="op" id="1771237">:=</span>&nbsp;<span class="op" id="1771240">&amp;</span><span class="ident" id="1771241">ranges</span><span class="op" id="1771247">[</span><span class="ident" id="1771248">i</span><span class="op" id="1771249">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771254">if</span>&nbsp;<span class="ident" id="1771257">r</span>&nbsp;<span class="op" id="1771259">&lt;</span>&nbsp;<span class="ident" id="1771261">range_</span><span class="op" id="1771267">.</span><span class="ident" id="1771268">Lo</span>&nbsp;<span class="op" id="1771271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771277">return</span>&nbsp;<span class="builtintype" id="1771284">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771298">if</span>&nbsp;<span class="ident" id="1771301">r</span>&nbsp;<span class="op" id="1771303">&lt;=</span>&nbsp;<span class="ident" id="1771306">range_</span><span class="op" id="1771312">.</span><span class="ident" id="1771313">Hi</span>&nbsp;<span class="op" id="1771316">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771322">return</span>&nbsp;<span class="op" id="1771329">(</span><span class="ident" id="1771330">r</span><span class="op" id="1771331">-</span><span class="ident" id="1771332">range_</span><span class="op" id="1771338">.</span><span class="ident" id="1771339">Lo</span><span class="op" id="1771341">)</span><span class="op" id="1771342">%</span><span class="ident" id="1771343">range_</span><span class="op" id="1771349">.</span><span class="ident" id="1771350">Stride</span>&nbsp;<span class="op" id="1771357">==</span>&nbsp;<span class="num" id="1771360">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771373">return</span>&nbsp;<span class="builtintype" id="1771380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771387">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1771391">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771421">lo</span>&nbsp;<span class="op" id="1771424">:=</span>&nbsp;<span class="num" id="1771427">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771430">hi</span>&nbsp;<span class="op" id="1771433">:=</span>&nbsp;<span class="builtinfunc" id="1771436">len</span><span class="op" id="1771439">(</span><span class="ident" id="1771440">ranges</span><span class="op" id="1771446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771449">for</span>&nbsp;<span class="ident" id="1771453">lo</span>&nbsp;<span class="op" id="1771456">&lt;</span>&nbsp;<span class="ident" id="1771458">hi</span>&nbsp;<span class="op" id="1771461">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771465">m</span>&nbsp;<span class="op" id="1771467">:=</span>&nbsp;<span class="ident" id="1771470">lo</span>&nbsp;<span class="op" id="1771473">+</span>&nbsp;<span class="op" id="1771475">(</span><span class="ident" id="1771476">hi</span><span class="op" id="1771478">-</span><span class="ident" id="1771479">lo</span><span class="op" id="1771481">)</span><span class="op" id="1771482">/</span><span class="num" id="1771483">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771487">range_</span>&nbsp;<span class="op" id="1771494">:=</span>&nbsp;<span class="op" id="1771497">&amp;</span><span class="ident" id="1771498">ranges</span><span class="op" id="1771504">[</span><span class="ident" id="1771505">m</span><span class="op" id="1771506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771510">if</span>&nbsp;<span class="ident" id="1771513">range_</span><span class="op" id="1771519">.</span><span class="ident" id="1771520">Lo</span>&nbsp;<span class="op" id="1771523">&lt;=</span>&nbsp;<span class="ident" id="1771526">r</span>&nbsp;<span class="op" id="1771528">&amp;&amp;</span>&nbsp;<span class="ident" id="1771531">r</span>&nbsp;<span class="op" id="1771533">&lt;=</span>&nbsp;<span class="ident" id="1771536">range_</span><span class="op" id="1771542">.</span><span class="ident" id="1771543">Hi</span>&nbsp;<span class="op" id="1771546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771551">return</span>&nbsp;<span class="op" id="1771558">(</span><span class="ident" id="1771559">r</span><span class="op" id="1771560">-</span><span class="ident" id="1771561">range_</span><span class="op" id="1771567">.</span><span class="ident" id="1771568">Lo</span><span class="op" id="1771570">)</span><span class="op" id="1771571">%</span><span class="ident" id="1771572">range_</span><span class="op" id="1771578">.</span><span class="ident" id="1771579">Stride</span>&nbsp;<span class="op" id="1771586">==</span>&nbsp;<span class="num" id="1771589">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771593">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771597">if</span>&nbsp;<span class="ident" id="1771600">r</span>&nbsp;<span class="op" id="1771602">&lt;</span>&nbsp;<span class="ident" id="1771604">range_</span><span class="op" id="1771610">.</span><span class="ident" id="1771611">Lo</span>&nbsp;<span class="op" id="1771614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771619">hi</span>&nbsp;<span class="op" id="1771622">=</span>&nbsp;<span class="ident" id="1771624">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771628">}</span>&nbsp;<span class="keyword" id="1771630">else</span>&nbsp;<span class="op" id="1771635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771640">lo</span>&nbsp;<span class="op" id="1771643">=</span>&nbsp;<span class="ident" id="1771645">m</span>&nbsp;<span class="op" id="1771647">+</span>&nbsp;<span class="num" id="1771649">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771653">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771659">return</span>&nbsp;<span class="builtintype" id="1771666">false</span><br>
<span class="lineno"></span><span class="op" id="1771672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1771675">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1771742">func</span>&nbsp;<span class="ident" id="1771747">is32</span><span class="op" id="1771751">(</span><span class="ident" id="1771752">ranges</span>&nbsp;<span class="op" id="1771759">[</span><span class="op" id="1771760">]</span><span class="ident" id="1771761">Range32</span><span class="op" id="1771768">,</span>&nbsp;<span class="ident" id="1771770">r</span>&nbsp;<span class="builtintype" id="1771772">uint32</span><span class="op" id="1771778">)</span>&nbsp;<span class="builtintype" id="1771780">bool</span>&nbsp;<span class="op" id="1771785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771788">if</span>&nbsp;<span class="builtinfunc" id="1771791">len</span><span class="op" id="1771794">(</span><span class="ident" id="1771795">ranges</span><span class="op" id="1771801">)</span>&nbsp;<span class="op" id="1771803">&lt;=</span>&nbsp;<span class="ident" id="1771806">linearMax</span>&nbsp;<span class="op" id="1771816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771820">for</span>&nbsp;<span class="ident" id="1771824">i</span>&nbsp;<span class="op" id="1771826">:=</span>&nbsp;<span class="keyword" id="1771829">range</span>&nbsp;<span class="ident" id="1771835">ranges</span>&nbsp;<span class="op" id="1771842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1771847">range_</span>&nbsp;<span class="op" id="1771854">:=</span>&nbsp;<span class="op" id="1771857">&amp;</span><span class="ident" id="1771858">ranges</span><span class="op" id="1771864">[</span><span class="ident" id="1771865">i</span><span class="op" id="1771866">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771871">if</span>&nbsp;<span class="ident" id="1771874">r</span>&nbsp;<span class="op" id="1771876">&lt;</span>&nbsp;<span class="ident" id="1771878">range_</span><span class="op" id="1771884">.</span><span class="ident" id="1771885">Lo</span>&nbsp;<span class="op" id="1771888">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771894">return</span>&nbsp;<span class="builtintype" id="1771901">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771915">if</span>&nbsp;<span class="ident" id="1771918">r</span>&nbsp;<span class="op" id="1771920">&lt;=</span>&nbsp;<span class="ident" id="1771923">range_</span><span class="op" id="1771929">.</span><span class="ident" id="1771930">Hi</span>&nbsp;<span class="op" id="1771933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771939">return</span>&nbsp;<span class="op" id="1771946">(</span><span class="ident" id="1771947">r</span><span class="op" id="1771948">-</span><span class="ident" id="1771949">range_</span><span class="op" id="1771955">.</span><span class="ident" id="1771956">Lo</span><span class="op" id="1771958">)</span><span class="op" id="1771959">%</span><span class="ident" id="1771960">range_</span><span class="op" id="1771966">.</span><span class="ident" id="1771967">Stride</span>&nbsp;<span class="op" id="1771974">==</span>&nbsp;<span class="num" id="1771977">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771982">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1771986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1771990">return</span>&nbsp;<span class="builtintype" id="1771997">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1772008">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772038">lo</span>&nbsp;<span class="op" id="1772041">:=</span>&nbsp;<span class="num" id="1772044">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772047">hi</span>&nbsp;<span class="op" id="1772050">:=</span>&nbsp;<span class="builtinfunc" id="1772053">len</span><span class="op" id="1772056">(</span><span class="ident" id="1772057">ranges</span><span class="op" id="1772063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772066">for</span>&nbsp;<span class="ident" id="1772070">lo</span>&nbsp;<span class="op" id="1772073">&lt;</span>&nbsp;<span class="ident" id="1772075">hi</span>&nbsp;<span class="op" id="1772078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772082">m</span>&nbsp;<span class="op" id="1772084">:=</span>&nbsp;<span class="ident" id="1772087">lo</span>&nbsp;<span class="op" id="1772090">+</span>&nbsp;<span class="op" id="1772092">(</span><span class="ident" id="1772093">hi</span><span class="op" id="1772095">-</span><span class="ident" id="1772096">lo</span><span class="op" id="1772098">)</span><span class="op" id="1772099">/</span><span class="num" id="1772100">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772104">range_</span>&nbsp;<span class="op" id="1772111">:=</span>&nbsp;<span class="ident" id="1772114">ranges</span><span class="op" id="1772120">[</span><span class="ident" id="1772121">m</span><span class="op" id="1772122">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772126">if</span>&nbsp;<span class="ident" id="1772129">range_</span><span class="op" id="1772135">.</span><span class="ident" id="1772136">Lo</span>&nbsp;<span class="op" id="1772139">&lt;=</span>&nbsp;<span class="ident" id="1772142">r</span>&nbsp;<span class="op" id="1772144">&amp;&amp;</span>&nbsp;<span class="ident" id="1772147">r</span>&nbsp;<span class="op" id="1772149">&lt;=</span>&nbsp;<span class="ident" id="1772152">range_</span><span class="op" id="1772158">.</span><span class="ident" id="1772159">Hi</span>&nbsp;<span class="op" id="1772162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772167">return</span>&nbsp;<span class="op" id="1772174">(</span><span class="ident" id="1772175">r</span><span class="op" id="1772176">-</span><span class="ident" id="1772177">range_</span><span class="op" id="1772183">.</span><span class="ident" id="1772184">Lo</span><span class="op" id="1772186">)</span><span class="op" id="1772187">%</span><span class="ident" id="1772188">range_</span><span class="op" id="1772194">.</span><span class="ident" id="1772195">Stride</span>&nbsp;<span class="op" id="1772202">==</span>&nbsp;<span class="num" id="1772205">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772213">if</span>&nbsp;<span class="ident" id="1772216">r</span>&nbsp;<span class="op" id="1772218">&lt;</span>&nbsp;<span class="ident" id="1772220">range_</span><span class="op" id="1772226">.</span><span class="ident" id="1772227">Lo</span>&nbsp;<span class="op" id="1772230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772235">hi</span>&nbsp;<span class="op" id="1772238">=</span>&nbsp;<span class="ident" id="1772240">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772244">}</span>&nbsp;<span class="keyword" id="1772246">else</span>&nbsp;<span class="op" id="1772251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772256">lo</span>&nbsp;<span class="op" id="1772259">=</span>&nbsp;<span class="ident" id="1772261">m</span>&nbsp;<span class="op" id="1772263">+</span>&nbsp;<span class="num" id="1772265">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772275">return</span>&nbsp;<span class="builtintype" id="1772282">false</span><br>
<span class="lineno">155</span><span class="op" id="1772288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1772291">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1772359">func</span>&nbsp;<span class="ident" id="1772364">Is</span><span class="op" id="1772366">(</span><span class="ident" id="1772367">rangeTab</span>&nbsp;<span class="op" id="1772376">*</span><span class="ident" id="1772377">RangeTable</span><span class="op" id="1772387">,</span>&nbsp;<span class="ident" id="1772389">r</span>&nbsp;<span class="builtintype" id="1772391">rune</span><span class="op" id="1772395">)</span>&nbsp;<span class="builtintype" id="1772397">bool</span>&nbsp;<span class="op" id="1772402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772405">r16</span>&nbsp;<span class="op" id="1772409">:=</span>&nbsp;<span class="ident" id="1772412">rangeTab</span><span class="op" id="1772420">.</span><span class="ident" id="1772421">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772426">if</span>&nbsp;<span class="builtinfunc" id="1772429">len</span><span class="op" id="1772432">(</span><span class="ident" id="1772433">r16</span><span class="op" id="1772436">)</span>&nbsp;<span class="op" id="1772438">&gt;</span>&nbsp;<span class="num" id="1772440">0</span>&nbsp;<span class="op" id="1772442">&amp;&amp;</span>&nbsp;<span class="ident" id="1772445">r</span>&nbsp;<span class="op" id="1772447">&lt;=</span>&nbsp;<span class="builtintype" id="1772450">rune</span><span class="op" id="1772454">(</span><span class="ident" id="1772455">r16</span><span class="op" id="1772458">[</span><span class="builtinfunc" id="1772459">len</span><span class="op" id="1772462">(</span><span class="ident" id="1772463">r16</span><span class="op" id="1772466">)</span><span class="op" id="1772467">-</span><span class="num" id="1772468">1</span><span class="op" id="1772469">]</span><span class="op" id="1772470">.</span><span class="ident" id="1772471">Hi</span><span class="op" id="1772473">)</span>&nbsp;<span class="op" id="1772475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772479">return</span>&nbsp;<span class="ident" id="1772486">is16</span><span class="op" id="1772490">(</span><span class="ident" id="1772491">r16</span><span class="op" id="1772494">,</span>&nbsp;<span class="builtintype" id="1772496">uint16</span><span class="op" id="1772502">(</span><span class="ident" id="1772503">r</span><span class="op" id="1772504">)</span><span class="op" id="1772505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772511">r32</span>&nbsp;<span class="op" id="1772515">:=</span>&nbsp;<span class="ident" id="1772518">rangeTab</span><span class="op" id="1772526">.</span><span class="ident" id="1772527">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772532">if</span>&nbsp;<span class="builtinfunc" id="1772535">len</span><span class="op" id="1772538">(</span><span class="ident" id="1772539">r32</span><span class="op" id="1772542">)</span>&nbsp;<span class="op" id="1772544">&gt;</span>&nbsp;<span class="num" id="1772546">0</span>&nbsp;<span class="op" id="1772548">&amp;&amp;</span>&nbsp;<span class="ident" id="1772551">r</span>&nbsp;<span class="op" id="1772553">&gt;=</span>&nbsp;<span class="builtintype" id="1772556">rune</span><span class="op" id="1772560">(</span><span class="ident" id="1772561">r32</span><span class="op" id="1772564">[</span><span class="num" id="1772565">0</span><span class="op" id="1772566">]</span><span class="op" id="1772567">.</span><span class="ident" id="1772568">Lo</span><span class="op" id="1772570">)</span>&nbsp;<span class="op" id="1772572">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772576">return</span>&nbsp;<span class="ident" id="1772583">is32</span><span class="op" id="1772587">(</span><span class="ident" id="1772588">r32</span><span class="op" id="1772591">,</span>&nbsp;<span class="builtintype" id="1772593">uint32</span><span class="op" id="1772599">(</span><span class="ident" id="1772600">r</span><span class="op" id="1772601">)</span><span class="op" id="1772602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772608">return</span>&nbsp;<span class="builtintype" id="1772615">false</span><br>
<span class="lineno"></span><span class="op" id="1772621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1772624">func</span>&nbsp;<span class="ident" id="1772629">isExcludingLatin</span><span class="op" id="1772645">(</span><span class="ident" id="1772646">rangeTab</span>&nbsp;<span class="op" id="1772655">*</span><span class="ident" id="1772656">RangeTable</span><span class="op" id="1772666">,</span>&nbsp;<span class="ident" id="1772668">r</span>&nbsp;<span class="builtintype" id="1772670">rune</span><span class="op" id="1772674">)</span>&nbsp;<span class="builtintype" id="1772676">bool</span>&nbsp;<span class="op" id="1772681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772684">r16</span>&nbsp;<span class="op" id="1772688">:=</span>&nbsp;<span class="ident" id="1772691">rangeTab</span><span class="op" id="1772699">.</span><span class="ident" id="1772700">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772705">if</span>&nbsp;<span class="ident" id="1772708">off</span>&nbsp;<span class="op" id="1772712">:=</span>&nbsp;<span class="ident" id="1772715">rangeTab</span><span class="op" id="1772723">.</span><span class="ident" id="1772724">LatinOffset</span><span class="op" id="1772735">;</span>&nbsp;<span class="builtinfunc" id="1772737">len</span><span class="op" id="1772740">(</span><span class="ident" id="1772741">r16</span><span class="op" id="1772744">)</span>&nbsp;<span class="op" id="1772746">&gt;</span>&nbsp;<span class="ident" id="1772748">off</span>&nbsp;<span class="op" id="1772752">&amp;&amp;</span>&nbsp;<span class="ident" id="1772755">r</span>&nbsp;<span class="op" id="1772757">&lt;=</span>&nbsp;<span class="builtintype" id="1772760">rune</span><span class="op" id="1772764">(</span><span class="ident" id="1772765">r16</span><span class="op" id="1772768">[</span><span class="builtinfunc" id="1772769">len</span><span class="op" id="1772772">(</span><span class="ident" id="1772773">r16</span><span class="op" id="1772776">)</span><span class="op" id="1772777">-</span><span class="num" id="1772778">1</span><span class="op" id="1772779">]</span><span class="op" id="1772780">.</span><span class="ident" id="1772781">Hi</span><span class="op" id="1772783">)</span>&nbsp;<span class="op" id="1772785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772789">return</span>&nbsp;<span class="ident" id="1772796">is16</span><span class="op" id="1772800">(</span><span class="ident" id="1772801">r16</span><span class="op" id="1772804">[</span><span class="ident" id="1772805">off</span><span class="op" id="1772808">:</span><span class="op" id="1772809">]</span><span class="op" id="1772810">,</span>&nbsp;<span class="builtintype" id="1772812">uint16</span><span class="op" id="1772818">(</span><span class="ident" id="1772819">r</span><span class="op" id="1772820">)</span><span class="op" id="1772821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772824">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1772827">r32</span>&nbsp;<span class="op" id="1772831">:=</span>&nbsp;<span class="ident" id="1772834">rangeTab</span><span class="op" id="1772842">.</span><span class="ident" id="1772843">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772848">if</span>&nbsp;<span class="builtinfunc" id="1772851">len</span><span class="op" id="1772854">(</span><span class="ident" id="1772855">r32</span><span class="op" id="1772858">)</span>&nbsp;<span class="op" id="1772860">&gt;</span>&nbsp;<span class="num" id="1772862">0</span>&nbsp;<span class="op" id="1772864">&amp;&amp;</span>&nbsp;<span class="ident" id="1772867">r</span>&nbsp;<span class="op" id="1772869">&gt;=</span>&nbsp;<span class="builtintype" id="1772872">rune</span><span class="op" id="1772876">(</span><span class="ident" id="1772877">r32</span><span class="op" id="1772880">[</span><span class="num" id="1772881">0</span><span class="op" id="1772882">]</span><span class="op" id="1772883">.</span><span class="ident" id="1772884">Lo</span><span class="op" id="1772886">)</span>&nbsp;<span class="op" id="1772888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772892">return</span>&nbsp;<span class="ident" id="1772899">is32</span><span class="op" id="1772903">(</span><span class="ident" id="1772904">r32</span><span class="op" id="1772907">,</span>&nbsp;<span class="builtintype" id="1772909">uint32</span><span class="op" id="1772915">(</span><span class="ident" id="1772916">r</span><span class="op" id="1772917">)</span><span class="op" id="1772918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1772921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1772924">return</span>&nbsp;<span class="builtintype" id="1772931">false</span><br>
<span class="lineno">180</span><span class="op" id="1772937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1772940">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1773001">func</span>&nbsp;<span class="ident" id="1773006">IsUpper</span><span class="op" id="1773013">(</span><span class="ident" id="1773014">r</span>&nbsp;<span class="builtintype" id="1773016">rune</span><span class="op" id="1773020">)</span>&nbsp;<span class="builtintype" id="1773022">bool</span>&nbsp;<span class="op" id="1773027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1773030">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773060">if</span>&nbsp;<span class="builtintype" id="1773063">uint32</span><span class="op" id="1773069">(</span><span class="ident" id="1773070">r</span><span class="op" id="1773071">)</span>&nbsp;<span class="op" id="1773073">&lt;=</span>&nbsp;<span class="ident" id="1773076">MaxLatin1</span>&nbsp;<span class="op" id="1773086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773090">return</span>&nbsp;<span class="ident" id="1773097">properties</span><span class="op" id="1773107">[</span><span class="builtintype" id="1773108">uint8</span><span class="op" id="1773113">(</span><span class="ident" id="1773114">r</span><span class="op" id="1773115">)</span><span class="op" id="1773116">]</span><span class="op" id="1773117">&amp;</span><span class="ident" id="1773118">pLmask</span>&nbsp;<span class="op" id="1773125">==</span>&nbsp;<span class="ident" id="1773128">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1773133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773136">return</span>&nbsp;<span class="ident" id="1773143">isExcludingLatin</span><span class="op" id="1773159">(</span><span class="ident" id="1773160">Upper</span><span class="op" id="1773165">,</span>&nbsp;<span class="ident" id="1773167">r</span><span class="op" id="1773168">)</span><br>
<span class="lineno"></span><span class="op" id="1773170">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1773173">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1773233">func</span>&nbsp;<span class="ident" id="1773238">IsLower</span><span class="op" id="1773245">(</span><span class="ident" id="1773246">r</span>&nbsp;<span class="builtintype" id="1773248">rune</span><span class="op" id="1773252">)</span>&nbsp;<span class="builtintype" id="1773254">bool</span>&nbsp;<span class="op" id="1773259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1773262">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773292">if</span>&nbsp;<span class="builtintype" id="1773295">uint32</span><span class="op" id="1773301">(</span><span class="ident" id="1773302">r</span><span class="op" id="1773303">)</span>&nbsp;<span class="op" id="1773305">&lt;=</span>&nbsp;<span class="ident" id="1773308">MaxLatin1</span>&nbsp;<span class="op" id="1773318">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773322">return</span>&nbsp;<span class="ident" id="1773329">properties</span><span class="op" id="1773339">[</span><span class="builtintype" id="1773340">uint8</span><span class="op" id="1773345">(</span><span class="ident" id="1773346">r</span><span class="op" id="1773347">)</span><span class="op" id="1773348">]</span><span class="op" id="1773349">&amp;</span><span class="ident" id="1773350">pLmask</span>&nbsp;<span class="op" id="1773357">==</span>&nbsp;<span class="ident" id="1773360">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1773365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773368">return</span>&nbsp;<span class="ident" id="1773375">isExcludingLatin</span><span class="op" id="1773391">(</span><span class="ident" id="1773392">Lower</span><span class="op" id="1773397">,</span>&nbsp;<span class="ident" id="1773399">r</span><span class="op" id="1773400">)</span><br>
<span class="lineno"></span><span class="op" id="1773402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1773405">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1773465">func</span>&nbsp;<span class="ident" id="1773470">IsTitle</span><span class="op" id="1773477">(</span><span class="ident" id="1773478">r</span>&nbsp;<span class="builtintype" id="1773480">rune</span><span class="op" id="1773484">)</span>&nbsp;<span class="builtintype" id="1773486">bool</span>&nbsp;<span class="op" id="1773491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773494">if</span>&nbsp;<span class="ident" id="1773497">r</span>&nbsp;<span class="op" id="1773499">&lt;=</span>&nbsp;<span class="ident" id="1773502">MaxLatin1</span>&nbsp;<span class="op" id="1773512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773516">return</span>&nbsp;<span class="builtintype" id="1773523">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1773530">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773533">return</span>&nbsp;<span class="ident" id="1773540">isExcludingLatin</span><span class="op" id="1773556">(</span><span class="ident" id="1773557">Title</span><span class="op" id="1773562">,</span>&nbsp;<span class="ident" id="1773564">r</span><span class="op" id="1773565">)</span><br>
<span class="lineno"></span><span class="op" id="1773567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1773570">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1773624">func</span>&nbsp;<span class="ident" id="1773629">to</span><span class="op" id="1773631">(</span><span class="ident" id="1773632">_case</span>&nbsp;<span class="builtintype" id="1773638">int</span><span class="op" id="1773641">,</span>&nbsp;<span class="ident" id="1773643">r</span>&nbsp;<span class="builtintype" id="1773645">rune</span><span class="op" id="1773649">,</span>&nbsp;<span class="ident" id="1773651">caseRange</span>&nbsp;<span class="op" id="1773661">[</span><span class="op" id="1773662">]</span><span class="ident" id="1773663">CaseRange</span><span class="op" id="1773672">)</span>&nbsp;<span class="builtintype" id="1773674">rune</span>&nbsp;<span class="op" id="1773679">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773682">if</span>&nbsp;<span class="ident" id="1773685">_case</span>&nbsp;<span class="op" id="1773691">&lt;</span>&nbsp;<span class="num" id="1773693">0</span>&nbsp;<span class="op" id="1773695">||</span>&nbsp;<span class="ident" id="1773698">MaxCase</span>&nbsp;<span class="op" id="1773706">&lt;=</span>&nbsp;<span class="ident" id="1773709">_case</span>&nbsp;<span class="op" id="1773715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773719">return</span>&nbsp;<span class="ident" id="1773726">ReplacementChar</span>&nbsp;<span class="comment" id="1773742">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1773776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1773779">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1773809">lo</span>&nbsp;<span class="op" id="1773812">:=</span>&nbsp;<span class="num" id="1773815">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1773818">hi</span>&nbsp;<span class="op" id="1773821">:=</span>&nbsp;<span class="builtinfunc" id="1773824">len</span><span class="op" id="1773827">(</span><span class="ident" id="1773828">caseRange</span><span class="op" id="1773837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773840">for</span>&nbsp;<span class="ident" id="1773844">lo</span>&nbsp;<span class="op" id="1773847">&lt;</span>&nbsp;<span class="ident" id="1773849">hi</span>&nbsp;<span class="op" id="1773852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1773856">m</span>&nbsp;<span class="op" id="1773858">:=</span>&nbsp;<span class="ident" id="1773861">lo</span>&nbsp;<span class="op" id="1773864">+</span>&nbsp;<span class="op" id="1773866">(</span><span class="ident" id="1773867">hi</span><span class="op" id="1773869">-</span><span class="ident" id="1773870">lo</span><span class="op" id="1773872">)</span><span class="op" id="1773873">/</span><span class="num" id="1773874">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1773878">cr</span>&nbsp;<span class="op" id="1773881">:=</span>&nbsp;<span class="ident" id="1773884">caseRange</span><span class="op" id="1773893">[</span><span class="ident" id="1773894">m</span><span class="op" id="1773895">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773899">if</span>&nbsp;<span class="builtintype" id="1773902">rune</span><span class="op" id="1773906">(</span><span class="ident" id="1773907">cr</span><span class="op" id="1773909">.</span><span class="ident" id="1773910">Lo</span><span class="op" id="1773912">)</span>&nbsp;<span class="op" id="1773914">&lt;=</span>&nbsp;<span class="ident" id="1773917">r</span>&nbsp;<span class="op" id="1773919">&amp;&amp;</span>&nbsp;<span class="ident" id="1773922">r</span>&nbsp;<span class="op" id="1773924">&lt;=</span>&nbsp;<span class="builtintype" id="1773927">rune</span><span class="op" id="1773931">(</span><span class="ident" id="1773932">cr</span><span class="op" id="1773934">.</span><span class="ident" id="1773935">Hi</span><span class="op" id="1773937">)</span>&nbsp;<span class="op" id="1773939">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1773944">delta</span>&nbsp;<span class="op" id="1773950">:=</span>&nbsp;<span class="builtintype" id="1773953">rune</span><span class="op" id="1773957">(</span><span class="ident" id="1773958">cr</span><span class="op" id="1773960">.</span><span class="ident" id="1773961">Delta</span><span class="op" id="1773966">[</span><span class="ident" id="1773967">_case</span><span class="op" id="1773972">]</span><span class="op" id="1773973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1773978">if</span>&nbsp;<span class="ident" id="1773981">delta</span>&nbsp;<span class="op" id="1773987">&gt;</span>&nbsp;<span class="ident" id="1773989">MaxRune</span>&nbsp;<span class="op" id="1773997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774003">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774063">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774125">//&nbsp;&nbsp;&nbsp;&nbsp;{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774171">//&nbsp;&nbsp;&nbsp;&nbsp;{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774229">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774293">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774360">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774430">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774465">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1774535">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774584">return</span>&nbsp;<span class="builtintype" id="1774591">rune</span><span class="op" id="1774595">(</span><span class="ident" id="1774596">cr</span><span class="op" id="1774598">.</span><span class="ident" id="1774599">Lo</span><span class="op" id="1774601">)</span>&nbsp;<span class="op" id="1774603">+</span>&nbsp;<span class="op" id="1774605">(</span><span class="op" id="1774606">(</span><span class="ident" id="1774607">r</span><span class="op" id="1774608">-</span><span class="builtintype" id="1774609">rune</span><span class="op" id="1774613">(</span><span class="ident" id="1774614">cr</span><span class="op" id="1774616">.</span><span class="ident" id="1774617">Lo</span><span class="op" id="1774619">)</span><span class="op" id="1774620">)</span><span class="op" id="1774621">&amp;^</span><span class="num" id="1774623">1</span>&nbsp;<span class="op" id="1774625">|</span>&nbsp;<span class="builtintype" id="1774627">rune</span><span class="op" id="1774631">(</span><span class="ident" id="1774632">_case</span><span class="op" id="1774637">&amp;</span><span class="num" id="1774638">1</span><span class="op" id="1774639">)</span><span class="op" id="1774640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1774645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774650">return</span>&nbsp;<span class="ident" id="1774657">r</span>&nbsp;<span class="op" id="1774659">+</span>&nbsp;<span class="ident" id="1774661">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1774669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774673">if</span>&nbsp;<span class="ident" id="1774676">r</span>&nbsp;<span class="op" id="1774678">&lt;</span>&nbsp;<span class="builtintype" id="1774680">rune</span><span class="op" id="1774684">(</span><span class="ident" id="1774685">cr</span><span class="op" id="1774687">.</span><span class="ident" id="1774688">Lo</span><span class="op" id="1774690">)</span>&nbsp;<span class="op" id="1774692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1774697">hi</span>&nbsp;<span class="op" id="1774700">=</span>&nbsp;<span class="ident" id="1774702">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1774706">}</span>&nbsp;<span class="keyword" id="1774708">else</span>&nbsp;<span class="op" id="1774713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1774718">lo</span>&nbsp;<span class="op" id="1774721">=</span>&nbsp;<span class="ident" id="1774723">m</span>&nbsp;<span class="op" id="1774725">+</span>&nbsp;<span class="num" id="1774727">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1774731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1774734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774737">return</span>&nbsp;<span class="ident" id="1774744">r</span><br>
<span class="lineno"></span><span class="op" id="1774746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1774749">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1774828">func</span>&nbsp;<span class="ident" id="1774833">To</span><span class="op" id="1774835">(</span><span class="ident" id="1774836">_case</span>&nbsp;<span class="builtintype" id="1774842">int</span><span class="op" id="1774845">,</span>&nbsp;<span class="ident" id="1774847">r</span>&nbsp;<span class="builtintype" id="1774849">rune</span><span class="op" id="1774853">)</span>&nbsp;<span class="builtintype" id="1774855">rune</span>&nbsp;<span class="op" id="1774860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774863">return</span>&nbsp;<span class="ident" id="1774870">to</span><span class="op" id="1774872">(</span><span class="ident" id="1774873">_case</span><span class="op" id="1774878">,</span>&nbsp;<span class="ident" id="1774880">r</span><span class="op" id="1774881">,</span>&nbsp;<span class="ident" id="1774883">CaseRanges</span><span class="op" id="1774893">)</span><br>
<span class="lineno"></span><span class="op" id="1774895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1774898">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1774938">func</span>&nbsp;<span class="ident" id="1774943">ToUpper</span><span class="op" id="1774950">(</span><span class="ident" id="1774951">r</span>&nbsp;<span class="builtintype" id="1774953">rune</span><span class="op" id="1774957">)</span>&nbsp;<span class="builtintype" id="1774959">rune</span>&nbsp;<span class="op" id="1774964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774967">if</span>&nbsp;<span class="ident" id="1774970">r</span>&nbsp;<span class="op" id="1774972">&lt;=</span>&nbsp;<span class="ident" id="1774975">MaxASCII</span>&nbsp;<span class="op" id="1774984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1774988">if</span>&nbsp;<span class="string" id="1774991">&#39;a&#39;</span>&nbsp;<span class="op" id="1774995">&lt;=</span>&nbsp;<span class="ident" id="1774998">r</span>&nbsp;<span class="op" id="1775000">&amp;&amp;</span>&nbsp;<span class="ident" id="1775003">r</span>&nbsp;<span class="op" id="1775005">&lt;=</span>&nbsp;<span class="string" id="1775008">&#39;z&#39;</span>&nbsp;<span class="op" id="1775012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775017">r</span>&nbsp;<span class="op" id="1775019">-=</span>&nbsp;<span class="string" id="1775022">&#39;a&#39;</span>&nbsp;<span class="op" id="1775026">-</span>&nbsp;<span class="string" id="1775028">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775038">return</span>&nbsp;<span class="ident" id="1775045">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775051">return</span>&nbsp;<span class="ident" id="1775058">To</span><span class="op" id="1775060">(</span><span class="ident" id="1775061">UpperCase</span><span class="op" id="1775070">,</span>&nbsp;<span class="ident" id="1775072">r</span><span class="op" id="1775073">)</span><br>
<span class="lineno"></span><span class="op" id="1775075">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1775078">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1775118">func</span>&nbsp;<span class="ident" id="1775123">ToLower</span><span class="op" id="1775130">(</span><span class="ident" id="1775131">r</span>&nbsp;<span class="builtintype" id="1775133">rune</span><span class="op" id="1775137">)</span>&nbsp;<span class="builtintype" id="1775139">rune</span>&nbsp;<span class="op" id="1775144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775147">if</span>&nbsp;<span class="ident" id="1775150">r</span>&nbsp;<span class="op" id="1775152">&lt;=</span>&nbsp;<span class="ident" id="1775155">MaxASCII</span>&nbsp;<span class="op" id="1775164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775168">if</span>&nbsp;<span class="string" id="1775171">&#39;A&#39;</span>&nbsp;<span class="op" id="1775175">&lt;=</span>&nbsp;<span class="ident" id="1775178">r</span>&nbsp;<span class="op" id="1775180">&amp;&amp;</span>&nbsp;<span class="ident" id="1775183">r</span>&nbsp;<span class="op" id="1775185">&lt;=</span>&nbsp;<span class="string" id="1775188">&#39;Z&#39;</span>&nbsp;<span class="op" id="1775192">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775197">r</span>&nbsp;<span class="op" id="1775199">+=</span>&nbsp;<span class="string" id="1775202">&#39;a&#39;</span>&nbsp;<span class="op" id="1775206">-</span>&nbsp;<span class="string" id="1775208">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775218">return</span>&nbsp;<span class="ident" id="1775225">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775231">return</span>&nbsp;<span class="ident" id="1775238">To</span><span class="op" id="1775240">(</span><span class="ident" id="1775241">LowerCase</span><span class="op" id="1775250">,</span>&nbsp;<span class="ident" id="1775252">r</span><span class="op" id="1775253">)</span><br>
<span class="lineno">270</span><span class="op" id="1775255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1775258">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1775298">func</span>&nbsp;<span class="ident" id="1775303">ToTitle</span><span class="op" id="1775310">(</span><span class="ident" id="1775311">r</span>&nbsp;<span class="builtintype" id="1775313">rune</span><span class="op" id="1775317">)</span>&nbsp;<span class="builtintype" id="1775319">rune</span>&nbsp;<span class="op" id="1775324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775327">if</span>&nbsp;<span class="ident" id="1775330">r</span>&nbsp;<span class="op" id="1775332">&lt;=</span>&nbsp;<span class="ident" id="1775335">MaxASCII</span>&nbsp;<span class="op" id="1775344">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775348">if</span>&nbsp;<span class="string" id="1775351">&#39;a&#39;</span>&nbsp;<span class="op" id="1775355">&lt;=</span>&nbsp;<span class="ident" id="1775358">r</span>&nbsp;<span class="op" id="1775360">&amp;&amp;</span>&nbsp;<span class="ident" id="1775363">r</span>&nbsp;<span class="op" id="1775365">&lt;=</span>&nbsp;<span class="string" id="1775368">&#39;z&#39;</span>&nbsp;<span class="op" id="1775372">{</span>&nbsp;<span class="comment" id="1775374">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775415">r</span>&nbsp;<span class="op" id="1775417">-=</span>&nbsp;<span class="string" id="1775420">&#39;a&#39;</span>&nbsp;<span class="op" id="1775424">-</span>&nbsp;<span class="string" id="1775426">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775436">return</span>&nbsp;<span class="ident" id="1775443">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775446">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775449">return</span>&nbsp;<span class="ident" id="1775456">To</span><span class="op" id="1775458">(</span><span class="ident" id="1775459">TitleCase</span><span class="op" id="1775468">,</span>&nbsp;<span class="ident" id="1775470">r</span><span class="op" id="1775471">)</span><br>
<span class="lineno"></span><span class="op" id="1775473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1775476">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1775555">func</span>&nbsp;<span class="op" id="1775560">(</span><span class="ident" id="1775561">special</span>&nbsp;<span class="ident" id="1775569">SpecialCase</span><span class="op" id="1775580">)</span>&nbsp;<span class="ident" id="1775582">ToUpper</span><span class="op" id="1775589">(</span><span class="ident" id="1775590">r</span>&nbsp;<span class="builtintype" id="1775592">rune</span><span class="op" id="1775596">)</span>&nbsp;<span class="builtintype" id="1775598">rune</span>&nbsp;<span class="op" id="1775603">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775606">r1</span>&nbsp;<span class="op" id="1775609">:=</span>&nbsp;<span class="ident" id="1775612">to</span><span class="op" id="1775614">(</span><span class="ident" id="1775615">UpperCase</span><span class="op" id="1775624">,</span>&nbsp;<span class="ident" id="1775626">r</span><span class="op" id="1775627">,</span>&nbsp;<span class="op" id="1775629">[</span><span class="op" id="1775630">]</span><span class="ident" id="1775631">CaseRange</span><span class="op" id="1775640">(</span><span class="ident" id="1775641">special</span><span class="op" id="1775648">)</span><span class="op" id="1775649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775652">if</span>&nbsp;<span class="ident" id="1775655">r1</span>&nbsp;<span class="op" id="1775658">==</span>&nbsp;<span class="ident" id="1775661">r</span>&nbsp;<span class="op" id="1775663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775667">r1</span>&nbsp;<span class="op" id="1775670">=</span>&nbsp;<span class="ident" id="1775672">ToUpper</span><span class="op" id="1775679">(</span><span class="ident" id="1775680">r</span><span class="op" id="1775681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775687">return</span>&nbsp;<span class="ident" id="1775694">r1</span><br>
<span class="lineno">290</span><span class="op" id="1775697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1775700">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1775779">func</span>&nbsp;<span class="op" id="1775784">(</span><span class="ident" id="1775785">special</span>&nbsp;<span class="ident" id="1775793">SpecialCase</span><span class="op" id="1775804">)</span>&nbsp;<span class="ident" id="1775806">ToTitle</span><span class="op" id="1775813">(</span><span class="ident" id="1775814">r</span>&nbsp;<span class="builtintype" id="1775816">rune</span><span class="op" id="1775820">)</span>&nbsp;<span class="builtintype" id="1775822">rune</span>&nbsp;<span class="op" id="1775827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775830">r1</span>&nbsp;<span class="op" id="1775833">:=</span>&nbsp;<span class="ident" id="1775836">to</span><span class="op" id="1775838">(</span><span class="ident" id="1775839">TitleCase</span><span class="op" id="1775848">,</span>&nbsp;<span class="ident" id="1775850">r</span><span class="op" id="1775851">,</span>&nbsp;<span class="op" id="1775853">[</span><span class="op" id="1775854">]</span><span class="ident" id="1775855">CaseRange</span><span class="op" id="1775864">(</span><span class="ident" id="1775865">special</span><span class="op" id="1775872">)</span><span class="op" id="1775873">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775876">if</span>&nbsp;<span class="ident" id="1775879">r1</span>&nbsp;<span class="op" id="1775882">==</span>&nbsp;<span class="ident" id="1775885">r</span>&nbsp;<span class="op" id="1775887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1775891">r1</span>&nbsp;<span class="op" id="1775894">=</span>&nbsp;<span class="ident" id="1775896">ToTitle</span><span class="op" id="1775903">(</span><span class="ident" id="1775904">r</span><span class="op" id="1775905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1775908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1775911">return</span>&nbsp;<span class="ident" id="1775918">r1</span><br>
<span class="lineno"></span><span class="op" id="1775921">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1775924">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1776003">func</span>&nbsp;<span class="op" id="1776008">(</span><span class="ident" id="1776009">special</span>&nbsp;<span class="ident" id="1776017">SpecialCase</span><span class="op" id="1776028">)</span>&nbsp;<span class="ident" id="1776030">ToLower</span><span class="op" id="1776037">(</span><span class="ident" id="1776038">r</span>&nbsp;<span class="builtintype" id="1776040">rune</span><span class="op" id="1776044">)</span>&nbsp;<span class="builtintype" id="1776046">rune</span>&nbsp;<span class="op" id="1776051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1776054">r1</span>&nbsp;<span class="op" id="1776057">:=</span>&nbsp;<span class="ident" id="1776060">to</span><span class="op" id="1776062">(</span><span class="ident" id="1776063">LowerCase</span><span class="op" id="1776072">,</span>&nbsp;<span class="ident" id="1776074">r</span><span class="op" id="1776075">,</span>&nbsp;<span class="op" id="1776077">[</span><span class="op" id="1776078">]</span><span class="ident" id="1776079">CaseRange</span><span class="op" id="1776088">(</span><span class="ident" id="1776089">special</span><span class="op" id="1776096">)</span><span class="op" id="1776097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1776100">if</span>&nbsp;<span class="ident" id="1776103">r1</span>&nbsp;<span class="op" id="1776106">==</span>&nbsp;<span class="ident" id="1776109">r</span>&nbsp;<span class="op" id="1776111">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1776115">r1</span>&nbsp;<span class="op" id="1776118">=</span>&nbsp;<span class="ident" id="1776120">ToLower</span><span class="op" id="1776127">(</span><span class="ident" id="1776128">r</span><span class="op" id="1776129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1776132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1776135">return</span>&nbsp;<span class="ident" id="1776142">r1</span><br>
<span class="lineno"></span><span class="op" id="1776145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1776148">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1776219">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1776290">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1776367">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1776411">type</span>&nbsp;<span class="ident" id="1776416">foldPair</span>&nbsp;<span class="keyword" id="1776425">struct</span>&nbsp;<span class="op" id="1776432">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1776435">From</span>&nbsp;<span class="builtintype" id="1776440">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1776448">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1776453">uint16</span><br>
<span class="lineno"></span><span class="op" id="1776460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1776463">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1776528">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1776595">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1776665">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1776733">//</span><br>
<span class="lineno"></span><span class="comment" id="1776736">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1776752">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1776777">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1776802">//</span><br>
<span class="lineno"></span><span class="comment" id="1776805">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1776830">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;K)</span><br>
<span class="lineno">330</span><span class="comment" id="1776881">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1776911">//</span><br>
<span class="lineno"></span><span class="comment" id="1776914">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1776939">//</span><br>
<span class="lineno"></span><span class="keyword" id="1776942">func</span>&nbsp;<span class="ident" id="1776947">SimpleFold</span><span class="op" id="1776957">(</span><span class="ident" id="1776958">r</span>&nbsp;<span class="builtintype" id="1776960">rune</span><span class="op" id="1776964">)</span>&nbsp;<span class="builtintype" id="1776966">rune</span>&nbsp;<span class="op" id="1776971">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1776974">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1777021">lo</span>&nbsp;<span class="op" id="1777024">:=</span>&nbsp;<span class="num" id="1777027">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1777030">hi</span>&nbsp;<span class="op" id="1777033">:=</span>&nbsp;<span class="builtinfunc" id="1777036">len</span><span class="op" id="1777039">(</span><span class="ident" id="1777040">caseOrbit</span><span class="op" id="1777049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777052">for</span>&nbsp;<span class="ident" id="1777056">lo</span>&nbsp;<span class="op" id="1777059">&lt;</span>&nbsp;<span class="ident" id="1777061">hi</span>&nbsp;<span class="op" id="1777064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1777068">m</span>&nbsp;<span class="op" id="1777070">:=</span>&nbsp;<span class="ident" id="1777073">lo</span>&nbsp;<span class="op" id="1777076">+</span>&nbsp;<span class="op" id="1777078">(</span><span class="ident" id="1777079">hi</span><span class="op" id="1777081">-</span><span class="ident" id="1777082">lo</span><span class="op" id="1777084">)</span><span class="op" id="1777085">/</span><span class="num" id="1777086">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777090">if</span>&nbsp;<span class="builtintype" id="1777093">rune</span><span class="op" id="1777097">(</span><span class="ident" id="1777098">caseOrbit</span><span class="op" id="1777107">[</span><span class="ident" id="1777108">m</span><span class="op" id="1777109">]</span><span class="op" id="1777110">.</span><span class="ident" id="1777111">From</span><span class="op" id="1777115">)</span>&nbsp;<span class="op" id="1777117">&lt;</span>&nbsp;<span class="ident" id="1777119">r</span>&nbsp;<span class="op" id="1777121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1777126">lo</span>&nbsp;<span class="op" id="1777129">=</span>&nbsp;<span class="ident" id="1777131">m</span>&nbsp;<span class="op" id="1777133">+</span>&nbsp;<span class="num" id="1777135">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777139">}</span>&nbsp;<span class="keyword" id="1777141">else</span>&nbsp;<span class="op" id="1777146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1777151">hi</span>&nbsp;<span class="op" id="1777154">=</span>&nbsp;<span class="ident" id="1777156">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777160">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777166">if</span>&nbsp;<span class="ident" id="1777169">lo</span>&nbsp;<span class="op" id="1777172">&lt;</span>&nbsp;<span class="builtinfunc" id="1777174">len</span><span class="op" id="1777177">(</span><span class="ident" id="1777178">caseOrbit</span><span class="op" id="1777187">)</span>&nbsp;<span class="op" id="1777189">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1777192">rune</span><span class="op" id="1777196">(</span><span class="ident" id="1777197">caseOrbit</span><span class="op" id="1777206">[</span><span class="ident" id="1777207">lo</span><span class="op" id="1777209">]</span><span class="op" id="1777210">.</span><span class="ident" id="1777211">From</span><span class="op" id="1777215">)</span>&nbsp;<span class="op" id="1777217">==</span>&nbsp;<span class="ident" id="1777220">r</span>&nbsp;<span class="op" id="1777222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777226">return</span>&nbsp;<span class="builtintype" id="1777233">rune</span><span class="op" id="1777237">(</span><span class="ident" id="1777238">caseOrbit</span><span class="op" id="1777247">[</span><span class="ident" id="1777248">lo</span><span class="op" id="1777250">]</span><span class="op" id="1777251">.</span><span class="ident" id="1777252">To</span><span class="op" id="1777254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1777261">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1777318">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1777374">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777429">if</span>&nbsp;<span class="ident" id="1777432">l</span>&nbsp;<span class="op" id="1777434">:=</span>&nbsp;<span class="ident" id="1777437">ToLower</span><span class="op" id="1777444">(</span><span class="ident" id="1777445">r</span><span class="op" id="1777446">)</span><span class="op" id="1777447">;</span>&nbsp;<span class="ident" id="1777449">l</span>&nbsp;<span class="op" id="1777451">!=</span>&nbsp;<span class="ident" id="1777454">r</span>&nbsp;<span class="op" id="1777456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777460">return</span>&nbsp;<span class="ident" id="1777467">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1777470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1777473">return</span>&nbsp;<span class="ident" id="1777480">ToUpper</span><span class="op" id="1777487">(</span><span class="ident" id="1777488">r</span><span class="op" id="1777489">)</span><br>
<span class="lineno"></span><span class="op" id="1777491">}</span>
</div>
</body>
</html>
