<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5693602">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5693657">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5693711">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5693762">package</span>&nbsp;<span class="ident" id="5693770">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5693775">import</span>&nbsp;<span class="op" id="5693782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5693785">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5693803">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5693813">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5693819">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5693832">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="5693839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5693842">//&nbsp;A&nbsp;Compressor&nbsp;returns&nbsp;a&nbsp;compressing&nbsp;writer,&nbsp;writing&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5693903">//&nbsp;provided&nbsp;writer.&nbsp;On&nbsp;Close,&nbsp;any&nbsp;pending&nbsp;data&nbsp;should&nbsp;be&nbsp;flushed.</span><br>
<span class="lineno"></span><span class="keyword" id="5693969">type</span>&nbsp;<span class="ident" id="5693974">Compressor</span>&nbsp;<span class="keyword" id="5693985">func</span><span class="op" id="5693989">(</span><span class="ident" id="5693990"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5693992">.</span><span class="ident" id="5693993">Writer</span><span class="op" id="5693999">)</span>&nbsp;<span class="op" id="5694001">(</span><span class="ident" id="5694002"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5694004">.</span><span class="ident" id="5694005">WriteCloser</span><span class="op" id="5694016">,</span>&nbsp;<span class="builtintype" id="5694018">error</span><span class="op" id="5694023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5694026">//&nbsp;Decompressor&nbsp;is&nbsp;a&nbsp;function&nbsp;that&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;with&nbsp;a&nbsp;decompressing&nbsp;Reader.</span><br>
<span class="lineno">20</span><span class="comment" id="5694105">//&nbsp;The&nbsp;decompressed&nbsp;ReadCloser&nbsp;is&nbsp;returned&nbsp;to&nbsp;callers&nbsp;who&nbsp;open&nbsp;files&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5694179">//&nbsp;within&nbsp;the&nbsp;archive.&nbsp;&nbsp;These&nbsp;callers&nbsp;are&nbsp;responsible&nbsp;for&nbsp;closing&nbsp;this&nbsp;reader</span><br>
<span class="lineno"></span><span class="comment" id="5694257">//&nbsp;when&nbsp;they&#39;re&nbsp;finished&nbsp;reading.</span><br>
<span class="lineno"></span><span class="keyword" id="5694291">type</span>&nbsp;<span class="ident" id="5694296">Decompressor</span>&nbsp;<span class="keyword" id="5694309">func</span><span class="op" id="5694313">(</span><span class="ident" id="5694314"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5694316">.</span><span class="ident" id="5694317">Reader</span><span class="op" id="5694323">)</span>&nbsp;<span class="ident" id="5694325"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5694327">.</span><span class="ident" id="5694328">ReadCloser</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="5694340">var</span>&nbsp;<span class="ident" id="5694344">flateWriterPool</span>&nbsp;<span class="ident" id="5694360"><a href="/archive/zip/register.go.html#5693832">sync</a></span><span class="op" id="5694364">.</span><span class="ident" id="5694365">Pool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694371">func</span>&nbsp;<span class="ident" id="5694376">newFlateWriter</span><span class="op" id="5694390">(</span><span class="ident" id="5694391">w</span>&nbsp;<span class="ident" id="5694393"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5694395">.</span><span class="ident" id="5694396">Writer</span><span class="op" id="5694402">)</span>&nbsp;<span class="ident" id="5694404"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5694406">.</span><span class="ident" id="5694407">WriteCloser</span>&nbsp;<span class="op" id="5694419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694422">fw</span><span class="op" id="5694424">,</span>&nbsp;<span class="ident" id="5694426">ok</span>&nbsp;<span class="op" id="5694429">:=</span>&nbsp;<span class="ident" id="5694432"><a href="/archive/zip/register.go.html#5694344">flateWriterPool</a></span><span class="op" id="5694447">.</span><span class="ident" id="5694448">Get</span><span class="op" id="5694451">(</span><span class="op" id="5694452">)</span><span class="op" id="5694453">.</span><span class="op" id="5694454">(</span><span class="op" id="5694455">*</span><span class="ident" id="5694456"><a href="/archive/zip/register.go.html#5693785">flate</a></span><span class="op" id="5694461">.</span><span class="ident" id="5694462">Writer</span><span class="op" id="5694468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694471">if</span>&nbsp;<span class="ident" id="5694474"><a href="/archive/zip/register.go.html#5694426">ok</a></span>&nbsp;<span class="op" id="5694477">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694481"><a href="/archive/zip/register.go.html#5694422">fw</a></span><span class="op" id="5694483">.</span><span class="ident" id="5694484">Reset</span><span class="op" id="5694489">(</span><span class="ident" id="5694490"><a href="/archive/zip/register.go.html#5694391">w</a></span><span class="op" id="5694491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694494">}</span>&nbsp;<span class="keyword" id="5694496">else</span>&nbsp;<span class="op" id="5694501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694505"><a href="/archive/zip/register.go.html#5694422">fw</a></span><span class="op" id="5694507">,</span>&nbsp;<span class="ident" id="5694509">_</span>&nbsp;<span class="op" id="5694511">=</span>&nbsp;<span class="ident" id="5694513"><a href="/archive/zip/register.go.html#5693785">flate</a></span><span class="op" id="5694518">.</span><span class="ident" id="5694519">NewWriter</span><span class="op" id="5694528">(</span><span class="ident" id="5694529"><a href="/archive/zip/register.go.html#5694391">w</a></span><span class="op" id="5694530">,</span>&nbsp;<span class="num" id="5694532">5</span><span class="op" id="5694533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694539">return</span>&nbsp;<span class="op" id="5694546">&amp;</span><span class="ident" id="5694547"><a href="/archive/zip/register.go.html#5694581">pooledFlateWriter</a></span><span class="op" id="5694564">{</span><span class="ident" id="5694565">fw</span><span class="op" id="5694567">:</span>&nbsp;<span class="ident" id="5694569"><a href="/archive/zip/register.go.html#5694422">fw</a></span><span class="op" id="5694571">}</span><br>
<span class="lineno">35</span><span class="op" id="5694573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694576">type</span>&nbsp;<span class="ident" id="5694581">pooledFlateWriter</span>&nbsp;<span class="keyword" id="5694599">struct</span>&nbsp;<span class="op" id="5694606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694609">mu</span>&nbsp;<span class="ident" id="5694612"><a href="/archive/zip/register.go.html#5693832">sync</a></span><span class="op" id="5694616">.</span><span class="ident" id="5694617">Mutex</span>&nbsp;<span class="comment" id="5694623">//&nbsp;guards&nbsp;Close&nbsp;and&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694650">fw</span>&nbsp;<span class="op" id="5694653">*</span><span class="ident" id="5694654"><a href="/archive/zip/register.go.html#5693785">flate</a></span><span class="op" id="5694659">.</span><span class="ident" id="5694660">Writer</span><br>
<span class="lineno">40</span><span class="op" id="5694667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5694670">func</span>&nbsp;<span class="op" id="5694675">(</span><span class="ident" id="5694676">w</span>&nbsp;<span class="op" id="5694678">*</span><span class="ident" id="5694679"><a href="/archive/zip/register.go.html#5694581">pooledFlateWriter</a></span><span class="op" id="5694696">)</span>&nbsp;<span class="ident" id="5694698">Write</span><span class="op" id="5694703">(</span><span class="ident" id="5694704">p</span>&nbsp;<span class="op" id="5694706">[</span><span class="op" id="5694707">]</span><span class="builtintype" id="5694708">byte</span><span class="op" id="5694712">)</span>&nbsp;<span class="op" id="5694714">(</span><span class="ident" id="5694715">n</span>&nbsp;<span class="builtintype" id="5694717">int</span><span class="op" id="5694720">,</span>&nbsp;<span class="ident" id="5694722">err</span>&nbsp;<span class="builtintype" id="5694726">error</span><span class="op" id="5694731">)</span>&nbsp;<span class="op" id="5694733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694736"><a href="/archive/zip/register.go.html#5694676">w</a></span><span class="op" id="5694737">.</span><span class="ident" id="5694738">mu</span><span class="op" id="5694740">.</span><span class="ident" id="5694741">Lock</span><span class="op" id="5694745">(</span><span class="op" id="5694746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694749">defer</span>&nbsp;<span class="ident" id="5694755"><a href="/archive/zip/register.go.html#5694676">w</a></span><span class="op" id="5694756">.</span><span class="ident" id="5694757">mu</span><span class="op" id="5694759">.</span><span class="ident" id="5694760">Unlock</span><span class="op" id="5694766">(</span><span class="op" id="5694767">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694770">if</span>&nbsp;<span class="ident" id="5694773"><a href="/archive/zip/register.go.html#5694676">w</a></span><span class="op" id="5694774">.</span><span class="ident" id="5694775">fw</span>&nbsp;<span class="op" id="5694778">==</span>&nbsp;<span class="ident" id="5694781">nil</span>&nbsp;<span class="op" id="5694785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694789">return</span>&nbsp;<span class="num" id="5694796">0</span><span class="op" id="5694797">,</span>&nbsp;<span class="ident" id="5694799"><a href="/archive/zip/register.go.html#5693803">errors</a></span><span class="op" id="5694805">.</span><span class="ident" id="5694806">New</span><span class="op" id="5694809">(</span><span class="string" id="5694810">&#34;Write&nbsp;after&nbsp;Close&#34;</span><span class="op" id="5694829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5694832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694835">return</span>&nbsp;<span class="ident" id="5694842"><a href="/archive/zip/register.go.html#5694676">w</a></span><span class="op" id="5694843">.</span><span class="ident" id="5694844">fw</span><span class="op" id="5694846">.</span><span class="ident" id="5694847">Write</span><span class="op" id="5694852">(</span><span class="ident" id="5694853"><a href="/archive/zip/register.go.html#5694704">p</a></span><span class="op" id="5694854">)</span><br>
<span class="lineno"></span><span class="op" id="5694856">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="5694859">func</span>&nbsp;<span class="op" id="5694864">(</span><span class="ident" id="5694865">w</span>&nbsp;<span class="op" id="5694867">*</span><span class="ident" id="5694868"><a href="/archive/zip/register.go.html#5694581">pooledFlateWriter</a></span><span class="op" id="5694885">)</span>&nbsp;<span class="ident" id="5694887">Close</span><span class="op" id="5694892">(</span><span class="op" id="5694893">)</span>&nbsp;<span class="builtintype" id="5694895">error</span>&nbsp;<span class="op" id="5694901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694904"><a href="/archive/zip/register.go.html#5694865">w</a></span><span class="op" id="5694905">.</span><span class="ident" id="5694906">mu</span><span class="op" id="5694908">.</span><span class="ident" id="5694909">Lock</span><span class="op" id="5694913">(</span><span class="op" id="5694914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694917">defer</span>&nbsp;<span class="ident" id="5694923"><a href="/archive/zip/register.go.html#5694865">w</a></span><span class="op" id="5694924">.</span><span class="ident" id="5694925">mu</span><span class="op" id="5694927">.</span><span class="ident" id="5694928">Unlock</span><span class="op" id="5694934">(</span><span class="op" id="5694935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694938">var</span>&nbsp;<span class="ident" id="5694942">err</span>&nbsp;<span class="builtintype" id="5694946">error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5694953">if</span>&nbsp;<span class="ident" id="5694956"><a href="/archive/zip/register.go.html#5694865">w</a></span><span class="op" id="5694957">.</span><span class="ident" id="5694958">fw</span>&nbsp;<span class="op" id="5694961">!=</span>&nbsp;<span class="ident" id="5694964">nil</span>&nbsp;<span class="op" id="5694968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694972"><a href="/archive/zip/register.go.html#5694942">err</a></span>&nbsp;<span class="op" id="5694976">=</span>&nbsp;<span class="ident" id="5694978"><a href="/archive/zip/register.go.html#5694865">w</a></span><span class="op" id="5694979">.</span><span class="ident" id="5694980">fw</span><span class="op" id="5694982">.</span><span class="ident" id="5694983">Close</span><span class="op" id="5694988">(</span><span class="op" id="5694989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5694993"><a href="/archive/zip/register.go.html#5694344">flateWriterPool</a></span><span class="op" id="5695008">.</span><span class="ident" id="5695009">Put</span><span class="op" id="5695012">(</span><span class="ident" id="5695013"><a href="/archive/zip/register.go.html#5694865">w</a></span><span class="op" id="5695014">.</span><span class="ident" id="5695015">fw</span><span class="op" id="5695017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695021"><a href="/archive/zip/register.go.html#5694865">w</a></span><span class="op" id="5695022">.</span><span class="ident" id="5695023">fw</span>&nbsp;<span class="op" id="5695026">=</span>&nbsp;<span class="ident" id="5695028">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695033">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695036">return</span>&nbsp;<span class="ident" id="5695043"><a href="/archive/zip/register.go.html#5694942">err</a></span><br>
<span class="lineno"></span><span class="op" id="5695047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695050">var</span>&nbsp;<span class="op" id="5695054">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695057">mu</span>&nbsp;<span class="ident" id="5695060"><a href="/archive/zip/register.go.html#5693832">sync</a></span><span class="op" id="5695064">.</span><span class="ident" id="5695065">RWMutex</span>&nbsp;<span class="comment" id="5695073">//&nbsp;guards&nbsp;compressor&nbsp;and&nbsp;decompressor&nbsp;maps</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695118">compressors</span>&nbsp;<span class="op" id="5695130">=</span>&nbsp;<span class="keyword" id="5695132">map</span><span class="op" id="5695135">[</span><span class="builtintype" id="5695136">uint16</span><span class="op" id="5695142">]</span><span class="ident" id="5695143"><a href="/archive/zip/register.go.html#5693974">Compressor</a></span><span class="op" id="5695153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695157"><a href="/archive/zip/struct.go.html#5697026">Store</a></span><span class="op" id="5695162">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="5695166">func</span><span class="op" id="5695170">(</span><span class="ident" id="5695171">w</span>&nbsp;<span class="ident" id="5695173"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5695175">.</span><span class="ident" id="5695176">Writer</span><span class="op" id="5695182">)</span>&nbsp;<span class="op" id="5695184">(</span><span class="ident" id="5695185"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5695187">.</span><span class="ident" id="5695188">WriteCloser</span><span class="op" id="5695199">,</span>&nbsp;<span class="builtintype" id="5695201">error</span><span class="op" id="5695206">)</span>&nbsp;<span class="op" id="5695208">{</span>&nbsp;<span class="keyword" id="5695210">return</span>&nbsp;<span class="op" id="5695217">&amp;</span><span class="ident" id="5695218"><a href="/archive/zip/writer.go.html#5713975">nopCloser</a></span><span class="op" id="5695227">{</span><span class="ident" id="5695228"><a href="/archive/zip/register.go.html#5695171">w</a></span><span class="op" id="5695229">}</span><span class="op" id="5695230">,</span>&nbsp;<span class="ident" id="5695232">nil</span>&nbsp;<span class="op" id="5695236">}</span><span class="op" id="5695237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695241"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="5695248">:</span>&nbsp;<span class="keyword" id="5695250">func</span><span class="op" id="5695254">(</span><span class="ident" id="5695255">w</span>&nbsp;<span class="ident" id="5695257"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5695259">.</span><span class="ident" id="5695260">Writer</span><span class="op" id="5695266">)</span>&nbsp;<span class="op" id="5695268">(</span><span class="ident" id="5695269"><a href="/archive/zip/register.go.html#5693813">io</a></span><span class="op" id="5695271">.</span><span class="ident" id="5695272">WriteCloser</span><span class="op" id="5695283">,</span>&nbsp;<span class="builtintype" id="5695285">error</span><span class="op" id="5695290">)</span>&nbsp;<span class="op" id="5695292">{</span>&nbsp;<span class="keyword" id="5695294">return</span>&nbsp;<span class="ident" id="5695301"><a href="/archive/zip/register.go.html#5694376">newFlateWriter</a></span><span class="op" id="5695315">(</span><span class="ident" id="5695316"><a href="/archive/zip/register.go.html#5695255">w</a></span><span class="op" id="5695317">)</span><span class="op" id="5695318">,</span>&nbsp;<span class="ident" id="5695320">nil</span>&nbsp;<span class="op" id="5695324">}</span><span class="op" id="5695325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695328">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695332">decompressors</span>&nbsp;<span class="op" id="5695346">=</span>&nbsp;<span class="keyword" id="5695348">map</span><span class="op" id="5695351">[</span><span class="builtintype" id="5695352">uint16</span><span class="op" id="5695358">]</span><span class="ident" id="5695359"><a href="/archive/zip/register.go.html#5694296">Decompressor</a></span><span class="op" id="5695371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695375"><a href="/archive/zip/struct.go.html#5697026">Store</a></span><span class="op" id="5695380">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5695384"><a href="/archive/zip/register.go.html#5693819">ioutil</a></span><span class="op" id="5695390">.</span><span class="ident" id="5695391">NopCloser</span><span class="op" id="5695400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695404"><a href="/archive/zip/struct.go.html#5697046">Deflate</a></span><span class="op" id="5695411">:</span>&nbsp;<span class="ident" id="5695413"><a href="/archive/zip/register.go.html#5693785">flate</a></span><span class="op" id="5695418">.</span><span class="ident" id="5695419">NewReader</span><span class="op" id="5695428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695431">}</span><br>
<span class="lineno">75</span><span class="op" id="5695433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5695436">//&nbsp;RegisterDecompressor&nbsp;allows&nbsp;custom&nbsp;decompressors&nbsp;for&nbsp;a&nbsp;specified&nbsp;method&nbsp;ID.</span><br>
<span class="lineno"></span><span class="keyword" id="5695515">func</span>&nbsp;<span class="ident" id="5695520">RegisterDecompressor</span><span class="op" id="5695540">(</span><span class="ident" id="5695541">method</span>&nbsp;<span class="builtintype" id="5695548">uint16</span><span class="op" id="5695554">,</span>&nbsp;<span class="ident" id="5695556">d</span>&nbsp;<span class="ident" id="5695558"><a href="/archive/zip/register.go.html#5694296">Decompressor</a></span><span class="op" id="5695570">)</span>&nbsp;<span class="op" id="5695572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695575"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5695577">.</span><span class="ident" id="5695578">Lock</span><span class="op" id="5695582">(</span><span class="op" id="5695583">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695586">defer</span>&nbsp;<span class="ident" id="5695592"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5695594">.</span><span class="ident" id="5695595">Unlock</span><span class="op" id="5695601">(</span><span class="op" id="5695602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695606">if</span>&nbsp;<span class="ident" id="5695609">_</span><span class="op" id="5695610">,</span>&nbsp;<span class="ident" id="5695612">ok</span>&nbsp;<span class="op" id="5695615">:=</span>&nbsp;<span class="ident" id="5695618"><a href="/archive/zip/register.go.html#5695332">decompressors</a></span><span class="op" id="5695631">[</span><span class="ident" id="5695632"><a href="/archive/zip/register.go.html#5695541">method</a></span><span class="op" id="5695638">]</span><span class="op" id="5695639">;</span>&nbsp;<span class="ident" id="5695641"><a href="/archive/zip/register.go.html#5695612">ok</a></span>&nbsp;<span class="op" id="5695644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5695648">panic</span><span class="op" id="5695653">(</span><span class="string" id="5695654">&#34;decompressor&nbsp;already&nbsp;registered&#34;</span><span class="op" id="5695687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5695690">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695693"><a href="/archive/zip/register.go.html#5695332">decompressors</a></span><span class="op" id="5695706">[</span><span class="ident" id="5695707"><a href="/archive/zip/register.go.html#5695541">method</a></span><span class="op" id="5695713">]</span>&nbsp;<span class="op" id="5695715">=</span>&nbsp;<span class="ident" id="5695717"><a href="/archive/zip/register.go.html#5695556">d</a></span><br>
<span class="lineno"></span><span class="op" id="5695719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5695722">//&nbsp;RegisterCompressor&nbsp;registers&nbsp;custom&nbsp;compressors&nbsp;for&nbsp;a&nbsp;specified&nbsp;method&nbsp;ID.</span><br>
<span class="lineno"></span><span class="comment" id="5695800">//&nbsp;The&nbsp;common&nbsp;methods&nbsp;Store&nbsp;and&nbsp;Deflate&nbsp;are&nbsp;built&nbsp;in.</span><br>
<span class="lineno">90</span><span class="keyword" id="5695854">func</span>&nbsp;<span class="ident" id="5695859">RegisterCompressor</span><span class="op" id="5695877">(</span><span class="ident" id="5695878">method</span>&nbsp;<span class="builtintype" id="5695885">uint16</span><span class="op" id="5695891">,</span>&nbsp;<span class="ident" id="5695893">comp</span>&nbsp;<span class="ident" id="5695898"><a href="/archive/zip/register.go.html#5693974">Compressor</a></span><span class="op" id="5695908">)</span>&nbsp;<span class="op" id="5695910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5695913"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5695915">.</span><span class="ident" id="5695916">Lock</span><span class="op" id="5695920">(</span><span class="op" id="5695921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695924">defer</span>&nbsp;<span class="ident" id="5695930"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5695932">.</span><span class="ident" id="5695933">Unlock</span><span class="op" id="5695939">(</span><span class="op" id="5695940">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5695944">if</span>&nbsp;<span class="ident" id="5695947">_</span><span class="op" id="5695948">,</span>&nbsp;<span class="ident" id="5695950">ok</span>&nbsp;<span class="op" id="5695953">:=</span>&nbsp;<span class="ident" id="5695956"><a href="/archive/zip/register.go.html#5695118">compressors</a></span><span class="op" id="5695967">[</span><span class="ident" id="5695968"><a href="/archive/zip/register.go.html#5695878">method</a></span><span class="op" id="5695974">]</span><span class="op" id="5695975">;</span>&nbsp;<span class="ident" id="5695977"><a href="/archive/zip/register.go.html#5695950">ok</a></span>&nbsp;<span class="op" id="5695980">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5695984">panic</span><span class="op" id="5695989">(</span><span class="string" id="5695990">&#34;compressor&nbsp;already&nbsp;registered&#34;</span><span class="op" id="5696021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5696024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696027"><a href="/archive/zip/register.go.html#5695118">compressors</a></span><span class="op" id="5696038">[</span><span class="ident" id="5696039"><a href="/archive/zip/register.go.html#5695878">method</a></span><span class="op" id="5696045">]</span>&nbsp;<span class="op" id="5696047">=</span>&nbsp;<span class="ident" id="5696049"><a href="/archive/zip/register.go.html#5695893">comp</a></span><br>
<span class="lineno"></span><span class="op" id="5696054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5696057">func</span>&nbsp;<span class="ident" id="5696062">compressor</span><span class="op" id="5696072">(</span><span class="ident" id="5696073">method</span>&nbsp;<span class="builtintype" id="5696080">uint16</span><span class="op" id="5696086">)</span>&nbsp;<span class="ident" id="5696088"><a href="/archive/zip/register.go.html#5693974">Compressor</a></span>&nbsp;<span class="op" id="5696099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696102"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5696104">.</span><span class="ident" id="5696105">RLock</span><span class="op" id="5696110">(</span><span class="op" id="5696111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696114">defer</span>&nbsp;<span class="ident" id="5696120"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5696122">.</span><span class="ident" id="5696123">RUnlock</span><span class="op" id="5696130">(</span><span class="op" id="5696131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696134">return</span>&nbsp;<span class="ident" id="5696141"><a href="/archive/zip/register.go.html#5695118">compressors</a></span><span class="op" id="5696152">[</span><span class="ident" id="5696153"><a href="/archive/zip/register.go.html#5696073">method</a></span><span class="op" id="5696159">]</span><br>
<span class="lineno"></span><span class="op" id="5696161">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="5696164">func</span>&nbsp;<span class="ident" id="5696169">decompressor</span><span class="op" id="5696181">(</span><span class="ident" id="5696182">method</span>&nbsp;<span class="builtintype" id="5696189">uint16</span><span class="op" id="5696195">)</span>&nbsp;<span class="ident" id="5696197"><a href="/archive/zip/register.go.html#5694296">Decompressor</a></span>&nbsp;<span class="op" id="5696210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5696213"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5696215">.</span><span class="ident" id="5696216">RLock</span><span class="op" id="5696221">(</span><span class="op" id="5696222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696225">defer</span>&nbsp;<span class="ident" id="5696231"><a href="/archive/zip/register.go.html#5695057">mu</a></span><span class="op" id="5696233">.</span><span class="ident" id="5696234">RUnlock</span><span class="op" id="5696241">(</span><span class="op" id="5696242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5696245">return</span>&nbsp;<span class="ident" id="5696252"><a href="/archive/zip/register.go.html#5695332">decompressors</a></span><span class="op" id="5696265">[</span><span class="ident" id="5696266"><a href="/archive/zip/register.go.html#5696182">method</a></span><span class="op" id="5696272">]</span><br>
<span class="lineno">110</span><span class="op" id="5696274">}</span>
</div>
</body>
</html>
