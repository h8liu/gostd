<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2637140">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2637195">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2637249">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2637300">package</span>&nbsp;<span class="ident" id="2637308">strings</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2637317">import</span>&nbsp;<span class="op" id="2637324">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2637327">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2637337">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2637343">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2637358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2637361">//&nbsp;A&nbsp;Reader&nbsp;implements&nbsp;the&nbsp;io.Reader,&nbsp;io.ReaderAt,&nbsp;io.Seeker,&nbsp;io.WriterTo,</span><br>
<span class="lineno"></span><span class="comment" id="2637436">//&nbsp;io.ByteScanner,&nbsp;and&nbsp;io.RuneScanner&nbsp;interfaces&nbsp;by&nbsp;reading</span><br>
<span class="lineno">15</span><span class="comment" id="2637496">//&nbsp;from&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2637514">type</span>&nbsp;<span class="ident" id="2637519">Reader</span>&nbsp;<span class="keyword" id="2637526">struct</span>&nbsp;<span class="op" id="2637533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637536">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2637545">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637553">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2637562">int64</span>&nbsp;<span class="comment" id="2637568">//&nbsp;current&nbsp;reading&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637594">prevRune</span>&nbsp;<span class="builtintype" id="2637603">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2637609">//&nbsp;index&nbsp;of&nbsp;previous&nbsp;rune;&nbsp;or&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">20</span><span class="op" id="2637643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2637646">//&nbsp;Len&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;the&nbsp;unread&nbsp;portion&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2637710">//&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2637721">func</span>&nbsp;<span class="op" id="2637726">(</span><span class="ident" id="2637727">r</span>&nbsp;<span class="op" id="2637729">*</span><span class="ident" id="2637730">Reader</span><span class="op" id="2637736">)</span>&nbsp;<span class="ident" id="2637738">Len</span><span class="op" id="2637741">(</span><span class="op" id="2637742">)</span>&nbsp;<span class="builtintype" id="2637744">int</span>&nbsp;<span class="op" id="2637748">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637751">if</span>&nbsp;<span class="ident" id="2637754">r</span><span class="op" id="2637755">.</span><span class="ident" id="2637756">i</span>&nbsp;<span class="op" id="2637758">&gt;=</span>&nbsp;<span class="ident" id="2637761">int64</span><span class="op" id="2637766">(</span><span class="builtinfunc" id="2637767">len</span><span class="op" id="2637770">(</span><span class="ident" id="2637771">r</span><span class="op" id="2637772">.</span><span class="ident" id="2637773">s</span><span class="op" id="2637774">)</span><span class="op" id="2637775">)</span>&nbsp;<span class="op" id="2637777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637781">return</span>&nbsp;<span class="num" id="2637788">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637794">return</span>&nbsp;<span class="builtintype" id="2637801">int</span><span class="op" id="2637804">(</span><span class="ident" id="2637805">int64</span><span class="op" id="2637810">(</span><span class="builtinfunc" id="2637811">len</span><span class="op" id="2637814">(</span><span class="ident" id="2637815">r</span><span class="op" id="2637816">.</span><span class="ident" id="2637817">s</span><span class="op" id="2637818">)</span><span class="op" id="2637819">)</span>&nbsp;<span class="op" id="2637821">-</span>&nbsp;<span class="ident" id="2637823">r</span><span class="op" id="2637824">.</span><span class="ident" id="2637825">i</span><span class="op" id="2637826">)</span><br>
<span class="lineno"></span><span class="op" id="2637828">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2637831">func</span>&nbsp;<span class="op" id="2637836">(</span><span class="ident" id="2637837">r</span>&nbsp;<span class="op" id="2637839">*</span><span class="ident" id="2637840">Reader</span><span class="op" id="2637846">)</span>&nbsp;<span class="ident" id="2637848">Read</span><span class="op" id="2637852">(</span><span class="ident" id="2637853">b</span>&nbsp;<span class="op" id="2637855">[</span><span class="op" id="2637856">]</span><span class="builtintype" id="2637857">byte</span><span class="op" id="2637861">)</span>&nbsp;<span class="op" id="2637863">(</span><span class="ident" id="2637864">n</span>&nbsp;<span class="builtintype" id="2637866">int</span><span class="op" id="2637869">,</span>&nbsp;<span class="ident" id="2637871">err</span>&nbsp;<span class="builtintype" id="2637875">error</span><span class="op" id="2637880">)</span>&nbsp;<span class="op" id="2637882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637885">if</span>&nbsp;<span class="builtinfunc" id="2637888">len</span><span class="op" id="2637891">(</span><span class="ident" id="2637892">b</span><span class="op" id="2637893">)</span>&nbsp;<span class="op" id="2637895">==</span>&nbsp;<span class="num" id="2637898">0</span>&nbsp;<span class="op" id="2637900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637904">return</span>&nbsp;<span class="num" id="2637911">0</span><span class="op" id="2637912">,</span>&nbsp;<span class="ident" id="2637914">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637919">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637922">if</span>&nbsp;<span class="ident" id="2637925">r</span><span class="op" id="2637926">.</span><span class="ident" id="2637927">i</span>&nbsp;<span class="op" id="2637929">&gt;=</span>&nbsp;<span class="ident" id="2637932">int64</span><span class="op" id="2637937">(</span><span class="builtinfunc" id="2637938">len</span><span class="op" id="2637941">(</span><span class="ident" id="2637942">r</span><span class="op" id="2637943">.</span><span class="ident" id="2637944">s</span><span class="op" id="2637945">)</span><span class="op" id="2637946">)</span>&nbsp;<span class="op" id="2637948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2637952">return</span>&nbsp;<span class="num" id="2637959">0</span><span class="op" id="2637960">,</span>&nbsp;<span class="ident" id="2637962">io</span><span class="op" id="2637964">.</span><span class="ident" id="2637965">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2637970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637973">r</span><span class="op" id="2637974">.</span><span class="ident" id="2637975">prevRune</span>&nbsp;<span class="op" id="2637984">=</span>&nbsp;<span class="op" id="2637986">-</span><span class="num" id="2637987">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2637990">n</span>&nbsp;<span class="op" id="2637992">=</span>&nbsp;<span class="builtinfunc" id="2637994">copy</span><span class="op" id="2637998">(</span><span class="ident" id="2637999">b</span><span class="op" id="2638000">,</span>&nbsp;<span class="ident" id="2638002">r</span><span class="op" id="2638003">.</span><span class="ident" id="2638004">s</span><span class="op" id="2638005">[</span><span class="ident" id="2638006">r</span><span class="op" id="2638007">.</span><span class="ident" id="2638008">i</span><span class="op" id="2638009">:</span><span class="op" id="2638010">]</span><span class="op" id="2638011">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638014">r</span><span class="op" id="2638015">.</span><span class="ident" id="2638016">i</span>&nbsp;<span class="op" id="2638018">+=</span>&nbsp;<span class="ident" id="2638021">int64</span><span class="op" id="2638026">(</span><span class="ident" id="2638027">n</span><span class="op" id="2638028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638031">return</span><br>
<span class="lineno"></span><span class="op" id="2638038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638041">func</span>&nbsp;<span class="op" id="2638046">(</span><span class="ident" id="2638047">r</span>&nbsp;<span class="op" id="2638049">*</span><span class="ident" id="2638050">Reader</span><span class="op" id="2638056">)</span>&nbsp;<span class="ident" id="2638058">ReadAt</span><span class="op" id="2638064">(</span><span class="ident" id="2638065">b</span>&nbsp;<span class="op" id="2638067">[</span><span class="op" id="2638068">]</span><span class="builtintype" id="2638069">byte</span><span class="op" id="2638073">,</span>&nbsp;<span class="ident" id="2638075">off</span>&nbsp;<span class="ident" id="2638079">int64</span><span class="op" id="2638084">)</span>&nbsp;<span class="op" id="2638086">(</span><span class="ident" id="2638087">n</span>&nbsp;<span class="builtintype" id="2638089">int</span><span class="op" id="2638092">,</span>&nbsp;<span class="ident" id="2638094">err</span>&nbsp;<span class="builtintype" id="2638098">error</span><span class="op" id="2638103">)</span>&nbsp;<span class="op" id="2638105">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2638108">//&nbsp;cannot&nbsp;modify&nbsp;state&nbsp;-&nbsp;see&nbsp;io.ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638150">if</span>&nbsp;<span class="ident" id="2638153">off</span>&nbsp;<span class="op" id="2638157">&lt;</span>&nbsp;<span class="num" id="2638159">0</span>&nbsp;<span class="op" id="2638161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638165">return</span>&nbsp;<span class="num" id="2638172">0</span><span class="op" id="2638173">,</span>&nbsp;<span class="ident" id="2638175">errors</span><span class="op" id="2638181">.</span><span class="ident" id="2638182">New</span><span class="op" id="2638185">(</span><span class="string" id="2638186">&#34;strings.Reader.ReadAt:&nbsp;negative&nbsp;offset&#34;</span><span class="op" id="2638226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638232">if</span>&nbsp;<span class="ident" id="2638235">off</span>&nbsp;<span class="op" id="2638239">&gt;=</span>&nbsp;<span class="ident" id="2638242">int64</span><span class="op" id="2638247">(</span><span class="builtinfunc" id="2638248">len</span><span class="op" id="2638251">(</span><span class="ident" id="2638252">r</span><span class="op" id="2638253">.</span><span class="ident" id="2638254">s</span><span class="op" id="2638255">)</span><span class="op" id="2638256">)</span>&nbsp;<span class="op" id="2638258">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638262">return</span>&nbsp;<span class="num" id="2638269">0</span><span class="op" id="2638270">,</span>&nbsp;<span class="ident" id="2638272">io</span><span class="op" id="2638274">.</span><span class="ident" id="2638275">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638283">n</span>&nbsp;<span class="op" id="2638285">=</span>&nbsp;<span class="builtinfunc" id="2638287">copy</span><span class="op" id="2638291">(</span><span class="ident" id="2638292">b</span><span class="op" id="2638293">,</span>&nbsp;<span class="ident" id="2638295">r</span><span class="op" id="2638296">.</span><span class="ident" id="2638297">s</span><span class="op" id="2638298">[</span><span class="ident" id="2638299">off</span><span class="op" id="2638302">:</span><span class="op" id="2638303">]</span><span class="op" id="2638304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638307">if</span>&nbsp;<span class="ident" id="2638310">n</span>&nbsp;<span class="op" id="2638312">&lt;</span>&nbsp;<span class="builtinfunc" id="2638314">len</span><span class="op" id="2638317">(</span><span class="ident" id="2638318">b</span><span class="op" id="2638319">)</span>&nbsp;<span class="op" id="2638321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638325">err</span>&nbsp;<span class="op" id="2638329">=</span>&nbsp;<span class="ident" id="2638331">io</span><span class="op" id="2638333">.</span><span class="ident" id="2638334">EOF</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638342">return</span><br>
<span class="lineno"></span><span class="op" id="2638349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638352">func</span>&nbsp;<span class="op" id="2638357">(</span><span class="ident" id="2638358">r</span>&nbsp;<span class="op" id="2638360">*</span><span class="ident" id="2638361">Reader</span><span class="op" id="2638367">)</span>&nbsp;<span class="ident" id="2638369">ReadByte</span><span class="op" id="2638377">(</span><span class="op" id="2638378">)</span>&nbsp;<span class="op" id="2638380">(</span><span class="ident" id="2638381">b</span>&nbsp;<span class="builtintype" id="2638383">byte</span><span class="op" id="2638387">,</span>&nbsp;<span class="ident" id="2638389">err</span>&nbsp;<span class="builtintype" id="2638393">error</span><span class="op" id="2638398">)</span>&nbsp;<span class="op" id="2638400">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638403">r</span><span class="op" id="2638404">.</span><span class="ident" id="2638405">prevRune</span>&nbsp;<span class="op" id="2638414">=</span>&nbsp;<span class="op" id="2638416">-</span><span class="num" id="2638417">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638420">if</span>&nbsp;<span class="ident" id="2638423">r</span><span class="op" id="2638424">.</span><span class="ident" id="2638425">i</span>&nbsp;<span class="op" id="2638427">&gt;=</span>&nbsp;<span class="ident" id="2638430">int64</span><span class="op" id="2638435">(</span><span class="builtinfunc" id="2638436">len</span><span class="op" id="2638439">(</span><span class="ident" id="2638440">r</span><span class="op" id="2638441">.</span><span class="ident" id="2638442">s</span><span class="op" id="2638443">)</span><span class="op" id="2638444">)</span>&nbsp;<span class="op" id="2638446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638450">return</span>&nbsp;<span class="num" id="2638457">0</span><span class="op" id="2638458">,</span>&nbsp;<span class="ident" id="2638460">io</span><span class="op" id="2638462">.</span><span class="ident" id="2638463">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638471">b</span>&nbsp;<span class="op" id="2638473">=</span>&nbsp;<span class="ident" id="2638475">r</span><span class="op" id="2638476">.</span><span class="ident" id="2638477">s</span><span class="op" id="2638478">[</span><span class="ident" id="2638479">r</span><span class="op" id="2638480">.</span><span class="ident" id="2638481">i</span><span class="op" id="2638482">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638485">r</span><span class="op" id="2638486">.</span><span class="ident" id="2638487">i</span><span class="op" id="2638488">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638492">return</span><br>
<span class="lineno"></span><span class="op" id="2638499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638502">func</span>&nbsp;<span class="op" id="2638507">(</span><span class="ident" id="2638508">r</span>&nbsp;<span class="op" id="2638510">*</span><span class="ident" id="2638511">Reader</span><span class="op" id="2638517">)</span>&nbsp;<span class="ident" id="2638519">UnreadByte</span><span class="op" id="2638529">(</span><span class="op" id="2638530">)</span>&nbsp;<span class="builtintype" id="2638532">error</span>&nbsp;<span class="op" id="2638538">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638541">r</span><span class="op" id="2638542">.</span><span class="ident" id="2638543">prevRune</span>&nbsp;<span class="op" id="2638552">=</span>&nbsp;<span class="op" id="2638554">-</span><span class="num" id="2638555">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638558">if</span>&nbsp;<span class="ident" id="2638561">r</span><span class="op" id="2638562">.</span><span class="ident" id="2638563">i</span>&nbsp;<span class="op" id="2638565">&lt;=</span>&nbsp;<span class="num" id="2638568">0</span>&nbsp;<span class="op" id="2638570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638574">return</span>&nbsp;<span class="ident" id="2638581">errors</span><span class="op" id="2638587">.</span><span class="ident" id="2638588">New</span><span class="op" id="2638591">(</span><span class="string" id="2638592">&#34;strings.Reader.UnreadByte:&nbsp;at&nbsp;beginning&nbsp;of&nbsp;string&#34;</span><span class="op" id="2638643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638649">r</span><span class="op" id="2638650">.</span><span class="ident" id="2638651">i</span><span class="op" id="2638652">--</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638656">return</span>&nbsp;<span class="ident" id="2638663">nil</span><br>
<span class="lineno"></span><span class="op" id="2638667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638670">func</span>&nbsp;<span class="op" id="2638675">(</span><span class="ident" id="2638676">r</span>&nbsp;<span class="op" id="2638678">*</span><span class="ident" id="2638679">Reader</span><span class="op" id="2638685">)</span>&nbsp;<span class="ident" id="2638687">ReadRune</span><span class="op" id="2638695">(</span><span class="op" id="2638696">)</span>&nbsp;<span class="op" id="2638698">(</span><span class="ident" id="2638699">ch</span>&nbsp;<span class="builtintype" id="2638702">rune</span><span class="op" id="2638706">,</span>&nbsp;<span class="ident" id="2638708">size</span>&nbsp;<span class="builtintype" id="2638713">int</span><span class="op" id="2638716">,</span>&nbsp;<span class="ident" id="2638718">err</span>&nbsp;<span class="builtintype" id="2638722">error</span><span class="op" id="2638727">)</span>&nbsp;<span class="op" id="2638729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638732">if</span>&nbsp;<span class="ident" id="2638735">r</span><span class="op" id="2638736">.</span><span class="ident" id="2638737">i</span>&nbsp;<span class="op" id="2638739">&gt;=</span>&nbsp;<span class="ident" id="2638742">int64</span><span class="op" id="2638747">(</span><span class="builtinfunc" id="2638748">len</span><span class="op" id="2638751">(</span><span class="ident" id="2638752">r</span><span class="op" id="2638753">.</span><span class="ident" id="2638754">s</span><span class="op" id="2638755">)</span><span class="op" id="2638756">)</span>&nbsp;<span class="op" id="2638758">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638762">r</span><span class="op" id="2638763">.</span><span class="ident" id="2638764">prevRune</span>&nbsp;<span class="op" id="2638773">=</span>&nbsp;<span class="op" id="2638775">-</span><span class="num" id="2638776">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638780">return</span>&nbsp;<span class="num" id="2638787">0</span><span class="op" id="2638788">,</span>&nbsp;<span class="num" id="2638790">0</span><span class="op" id="2638791">,</span>&nbsp;<span class="ident" id="2638793">io</span><span class="op" id="2638795">.</span><span class="ident" id="2638796">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638804">r</span><span class="op" id="2638805">.</span><span class="ident" id="2638806">prevRune</span>&nbsp;<span class="op" id="2638815">=</span>&nbsp;<span class="builtintype" id="2638817">int</span><span class="op" id="2638820">(</span><span class="ident" id="2638821">r</span><span class="op" id="2638822">.</span><span class="ident" id="2638823">i</span><span class="op" id="2638824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638827">if</span>&nbsp;<span class="ident" id="2638830">c</span>&nbsp;<span class="op" id="2638832">:=</span>&nbsp;<span class="ident" id="2638835">r</span><span class="op" id="2638836">.</span><span class="ident" id="2638837">s</span><span class="op" id="2638838">[</span><span class="ident" id="2638839">r</span><span class="op" id="2638840">.</span><span class="ident" id="2638841">i</span><span class="op" id="2638842">]</span><span class="op" id="2638843">;</span>&nbsp;<span class="ident" id="2638845">c</span>&nbsp;<span class="op" id="2638847">&lt;</span>&nbsp;<span class="ident" id="2638849">utf8</span><span class="op" id="2638853">.</span><span class="ident" id="2638854">RuneSelf</span>&nbsp;<span class="op" id="2638863">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638867">r</span><span class="op" id="2638868">.</span><span class="ident" id="2638869">i</span><span class="op" id="2638870">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638875">return</span>&nbsp;<span class="builtintype" id="2638882">rune</span><span class="op" id="2638886">(</span><span class="ident" id="2638887">c</span><span class="op" id="2638888">)</span><span class="op" id="2638889">,</span>&nbsp;<span class="num" id="2638891">1</span><span class="op" id="2638892">,</span>&nbsp;<span class="ident" id="2638894">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2638899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638902">ch</span><span class="op" id="2638904">,</span>&nbsp;<span class="ident" id="2638906">size</span>&nbsp;<span class="op" id="2638911">=</span>&nbsp;<span class="ident" id="2638913">utf8</span><span class="op" id="2638917">.</span><span class="ident" id="2638918">DecodeRuneInString</span><span class="op" id="2638936">(</span><span class="ident" id="2638937">r</span><span class="op" id="2638938">.</span><span class="ident" id="2638939">s</span><span class="op" id="2638940">[</span><span class="ident" id="2638941">r</span><span class="op" id="2638942">.</span><span class="ident" id="2638943">i</span><span class="op" id="2638944">:</span><span class="op" id="2638945">]</span><span class="op" id="2638946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2638949">r</span><span class="op" id="2638950">.</span><span class="ident" id="2638951">i</span>&nbsp;<span class="op" id="2638953">+=</span>&nbsp;<span class="ident" id="2638956">int64</span><span class="op" id="2638961">(</span><span class="ident" id="2638962">size</span><span class="op" id="2638966">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2638969">return</span><br>
<span class="lineno"></span><span class="op" id="2638976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638979">func</span>&nbsp;<span class="op" id="2638984">(</span><span class="ident" id="2638985">r</span>&nbsp;<span class="op" id="2638987">*</span><span class="ident" id="2638988">Reader</span><span class="op" id="2638994">)</span>&nbsp;<span class="ident" id="2638996">UnreadRune</span><span class="op" id="2639006">(</span><span class="op" id="2639007">)</span>&nbsp;<span class="builtintype" id="2639009">error</span>&nbsp;<span class="op" id="2639015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639018">if</span>&nbsp;<span class="ident" id="2639021">r</span><span class="op" id="2639022">.</span><span class="ident" id="2639023">prevRune</span>&nbsp;<span class="op" id="2639032">&lt;</span>&nbsp;<span class="num" id="2639034">0</span>&nbsp;<span class="op" id="2639036">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639040">return</span>&nbsp;<span class="ident" id="2639047">errors</span><span class="op" id="2639053">.</span><span class="ident" id="2639054">New</span><span class="op" id="2639057">(</span><span class="string" id="2639058">&#34;strings.Reader.UnreadRune:&nbsp;previous&nbsp;operation&nbsp;was&nbsp;not&nbsp;ReadRune&#34;</span><span class="op" id="2639122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639128">r</span><span class="op" id="2639129">.</span><span class="ident" id="2639130">i</span>&nbsp;<span class="op" id="2639132">=</span>&nbsp;<span class="ident" id="2639134">int64</span><span class="op" id="2639139">(</span><span class="ident" id="2639140">r</span><span class="op" id="2639141">.</span><span class="ident" id="2639142">prevRune</span><span class="op" id="2639150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639153">r</span><span class="op" id="2639154">.</span><span class="ident" id="2639155">prevRune</span>&nbsp;<span class="op" id="2639164">=</span>&nbsp;<span class="op" id="2639166">-</span><span class="num" id="2639167">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639170">return</span>&nbsp;<span class="ident" id="2639177">nil</span><br>
<span class="lineno">100</span><span class="op" id="2639181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639184">//&nbsp;Seek&nbsp;implements&nbsp;the&nbsp;io.Seeker&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2639228">func</span>&nbsp;<span class="op" id="2639233">(</span><span class="ident" id="2639234">r</span>&nbsp;<span class="op" id="2639236">*</span><span class="ident" id="2639237">Reader</span><span class="op" id="2639243">)</span>&nbsp;<span class="ident" id="2639245">Seek</span><span class="op" id="2639249">(</span><span class="ident" id="2639250">offset</span>&nbsp;<span class="ident" id="2639257">int64</span><span class="op" id="2639262">,</span>&nbsp;<span class="ident" id="2639264">whence</span>&nbsp;<span class="builtintype" id="2639271">int</span><span class="op" id="2639274">)</span>&nbsp;<span class="op" id="2639276">(</span><span class="ident" id="2639277">int64</span><span class="op" id="2639282">,</span>&nbsp;<span class="builtintype" id="2639284">error</span><span class="op" id="2639289">)</span>&nbsp;<span class="op" id="2639291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639294">r</span><span class="op" id="2639295">.</span><span class="ident" id="2639296">prevRune</span>&nbsp;<span class="op" id="2639305">=</span>&nbsp;<span class="op" id="2639307">-</span><span class="num" id="2639308">1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639311">var</span>&nbsp;<span class="ident" id="2639315">abs</span>&nbsp;<span class="ident" id="2639319">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639326">switch</span>&nbsp;<span class="ident" id="2639333">whence</span>&nbsp;<span class="op" id="2639340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639343">case</span>&nbsp;<span class="num" id="2639348">0</span><span class="op" id="2639349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639353">abs</span>&nbsp;<span class="op" id="2639357">=</span>&nbsp;<span class="ident" id="2639359">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639367">case</span>&nbsp;<span class="num" id="2639372">1</span><span class="op" id="2639373">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639377">abs</span>&nbsp;<span class="op" id="2639381">=</span>&nbsp;<span class="ident" id="2639383">int64</span><span class="op" id="2639388">(</span><span class="ident" id="2639389">r</span><span class="op" id="2639390">.</span><span class="ident" id="2639391">i</span><span class="op" id="2639392">)</span>&nbsp;<span class="op" id="2639394">+</span>&nbsp;<span class="ident" id="2639396">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639404">case</span>&nbsp;<span class="num" id="2639409">2</span><span class="op" id="2639410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639414">abs</span>&nbsp;<span class="op" id="2639418">=</span>&nbsp;<span class="ident" id="2639420">int64</span><span class="op" id="2639425">(</span><span class="builtinfunc" id="2639426">len</span><span class="op" id="2639429">(</span><span class="ident" id="2639430">r</span><span class="op" id="2639431">.</span><span class="ident" id="2639432">s</span><span class="op" id="2639433">)</span><span class="op" id="2639434">)</span>&nbsp;<span class="op" id="2639436">+</span>&nbsp;<span class="ident" id="2639438">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639446">default</span><span class="op" id="2639453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639457">return</span>&nbsp;<span class="num" id="2639464">0</span><span class="op" id="2639465">,</span>&nbsp;<span class="ident" id="2639467">errors</span><span class="op" id="2639473">.</span><span class="ident" id="2639474">New</span><span class="op" id="2639477">(</span><span class="string" id="2639478">&#34;strings.Reader.Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="2639515">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639521">if</span>&nbsp;<span class="ident" id="2639524">abs</span>&nbsp;<span class="op" id="2639528">&lt;</span>&nbsp;<span class="num" id="2639530">0</span>&nbsp;<span class="op" id="2639532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639536">return</span>&nbsp;<span class="num" id="2639543">0</span><span class="op" id="2639544">,</span>&nbsp;<span class="ident" id="2639546">errors</span><span class="op" id="2639552">.</span><span class="ident" id="2639553">New</span><span class="op" id="2639556">(</span><span class="string" id="2639557">&#34;strings.Reader.Seek:&nbsp;negative&nbsp;position&#34;</span><span class="op" id="2639597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639603">r</span><span class="op" id="2639604">.</span><span class="ident" id="2639605">i</span>&nbsp;<span class="op" id="2639607">=</span>&nbsp;<span class="ident" id="2639609">abs</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639614">return</span>&nbsp;<span class="ident" id="2639621">abs</span><span class="op" id="2639624">,</span>&nbsp;<span class="ident" id="2639626">nil</span><br>
<span class="lineno"></span><span class="op" id="2639630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2639633">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;io.WriterTo&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2639682">func</span>&nbsp;<span class="op" id="2639687">(</span><span class="ident" id="2639688">r</span>&nbsp;<span class="op" id="2639690">*</span><span class="ident" id="2639691">Reader</span><span class="op" id="2639697">)</span>&nbsp;<span class="ident" id="2639699">WriteTo</span><span class="op" id="2639706">(</span><span class="ident" id="2639707">w</span>&nbsp;<span class="ident" id="2639709">io</span><span class="op" id="2639711">.</span><span class="ident" id="2639712">Writer</span><span class="op" id="2639718">)</span>&nbsp;<span class="op" id="2639720">(</span><span class="ident" id="2639721">n</span>&nbsp;<span class="ident" id="2639723">int64</span><span class="op" id="2639728">,</span>&nbsp;<span class="ident" id="2639730">err</span>&nbsp;<span class="builtintype" id="2639734">error</span><span class="op" id="2639739">)</span>&nbsp;<span class="op" id="2639741">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639744">r</span><span class="op" id="2639745">.</span><span class="ident" id="2639746">prevRune</span>&nbsp;<span class="op" id="2639755">=</span>&nbsp;<span class="op" id="2639757">-</span><span class="num" id="2639758">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639761">if</span>&nbsp;<span class="ident" id="2639764">r</span><span class="op" id="2639765">.</span><span class="ident" id="2639766">i</span>&nbsp;<span class="op" id="2639768">&gt;=</span>&nbsp;<span class="ident" id="2639771">int64</span><span class="op" id="2639776">(</span><span class="builtinfunc" id="2639777">len</span><span class="op" id="2639780">(</span><span class="ident" id="2639781">r</span><span class="op" id="2639782">.</span><span class="ident" id="2639783">s</span><span class="op" id="2639784">)</span><span class="op" id="2639785">)</span>&nbsp;<span class="op" id="2639787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639791">return</span>&nbsp;<span class="num" id="2639798">0</span><span class="op" id="2639799">,</span>&nbsp;<span class="ident" id="2639801">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639809">s</span>&nbsp;<span class="op" id="2639811">:=</span>&nbsp;<span class="ident" id="2639814">r</span><span class="op" id="2639815">.</span><span class="ident" id="2639816">s</span><span class="op" id="2639817">[</span><span class="ident" id="2639818">r</span><span class="op" id="2639819">.</span><span class="ident" id="2639820">i</span><span class="op" id="2639821">:</span><span class="op" id="2639822">]</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639825">m</span><span class="op" id="2639826">,</span>&nbsp;<span class="ident" id="2639828">err</span>&nbsp;<span class="op" id="2639832">:=</span>&nbsp;<span class="ident" id="2639835">io</span><span class="op" id="2639837">.</span><span class="ident" id="2639838">WriteString</span><span class="op" id="2639849">(</span><span class="ident" id="2639850">w</span><span class="op" id="2639851">,</span>&nbsp;<span class="ident" id="2639853">s</span><span class="op" id="2639854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639857">if</span>&nbsp;<span class="ident" id="2639860">m</span>&nbsp;<span class="op" id="2639862">&gt;</span>&nbsp;<span class="builtinfunc" id="2639864">len</span><span class="op" id="2639867">(</span><span class="ident" id="2639868">s</span><span class="op" id="2639869">)</span>&nbsp;<span class="op" id="2639871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2639875">panic</span><span class="op" id="2639880">(</span><span class="string" id="2639881">&#34;strings.Reader.WriteTo:&nbsp;invalid&nbsp;WriteString&nbsp;count&#34;</span><span class="op" id="2639932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2639935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639938">r</span><span class="op" id="2639939">.</span><span class="ident" id="2639940">i</span>&nbsp;<span class="op" id="2639942">+=</span>&nbsp;<span class="ident" id="2639945">int64</span><span class="op" id="2639950">(</span><span class="ident" id="2639951">m</span><span class="op" id="2639952">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2639955">n</span>&nbsp;<span class="op" id="2639957">=</span>&nbsp;<span class="ident" id="2639959">int64</span><span class="op" id="2639964">(</span><span class="ident" id="2639965">m</span><span class="op" id="2639966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2639969">if</span>&nbsp;<span class="ident" id="2639972">m</span>&nbsp;<span class="op" id="2639974">!=</span>&nbsp;<span class="builtinfunc" id="2639977">len</span><span class="op" id="2639980">(</span><span class="ident" id="2639981">s</span><span class="op" id="2639982">)</span>&nbsp;<span class="op" id="2639984">&amp;&amp;</span>&nbsp;<span class="ident" id="2639987">err</span>&nbsp;<span class="op" id="2639991">==</span>&nbsp;<span class="ident" id="2639994">nil</span>&nbsp;<span class="op" id="2639998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2640002">err</span>&nbsp;<span class="op" id="2640006">=</span>&nbsp;<span class="ident" id="2640008">io</span><span class="op" id="2640010">.</span><span class="ident" id="2640011">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2640026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2640029">return</span><br>
<span class="lineno">140</span><span class="op" id="2640036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2640039">//&nbsp;NewReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2640089">//&nbsp;It&nbsp;is&nbsp;similar&nbsp;to&nbsp;bytes.NewBufferString&nbsp;but&nbsp;more&nbsp;efficient&nbsp;and&nbsp;read-only.</span><br>
<span class="lineno"></span><span class="keyword" id="2640165">func</span>&nbsp;<span class="ident" id="2640170">NewReader</span><span class="op" id="2640179">(</span><span class="ident" id="2640180">s</span>&nbsp;<span class="builtintype" id="2640182">string</span><span class="op" id="2640188">)</span>&nbsp;<span class="op" id="2640190">*</span><span class="ident" id="2640191">Reader</span>&nbsp;<span class="op" id="2640198">{</span>&nbsp;<span class="keyword" id="2640200">return</span>&nbsp;<span class="op" id="2640207">&amp;</span><span class="ident" id="2640208">Reader</span><span class="op" id="2640214">{</span><span class="ident" id="2640215">s</span><span class="op" id="2640216">,</span>&nbsp;<span class="num" id="2640218">0</span><span class="op" id="2640219">,</span>&nbsp;<span class="op" id="2640221">-</span><span class="num" id="2640222">1</span><span class="op" id="2640223">}</span>&nbsp;<span class="op" id="2640225">}</span>
</div>
</body>
</html>
