<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html" class="current">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3991816">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3991871">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3991925">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3991976">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3991993">package</span>&nbsp;<span class="ident" id="3992001">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3992006">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3992034">func</span>&nbsp;<span class="ident" id="3992039">hasAsm</span><span class="op" id="3992045">(</span><span class="op" id="3992046">)</span>&nbsp;<span class="builtintype" id="3992048">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3992053">func</span>&nbsp;<span class="ident" id="3992058">encryptBlockAsm</span><span class="op" id="3992073">(</span><span class="ident" id="3992074">nr</span>&nbsp;<span class="builtintype" id="3992077">int</span><span class="op" id="3992080">,</span>&nbsp;<span class="ident" id="3992082">xk</span>&nbsp;<span class="op" id="3992085">*</span><span class="builtintype" id="3992086">uint32</span><span class="op" id="3992092">,</span>&nbsp;<span class="ident" id="3992094">dst</span><span class="op" id="3992097">,</span>&nbsp;<span class="ident" id="3992099">src</span>&nbsp;<span class="op" id="3992103">*</span><span class="builtintype" id="3992104">byte</span><span class="op" id="3992108">)</span><br>
<span class="lineno"></span><span class="keyword" id="3992110">func</span>&nbsp;<span class="ident" id="3992115">decryptBlockAsm</span><span class="op" id="3992130">(</span><span class="ident" id="3992131">nr</span>&nbsp;<span class="builtintype" id="3992134">int</span><span class="op" id="3992137">,</span>&nbsp;<span class="ident" id="3992139">xk</span>&nbsp;<span class="op" id="3992142">*</span><span class="builtintype" id="3992143">uint32</span><span class="op" id="3992149">,</span>&nbsp;<span class="ident" id="3992151">dst</span><span class="op" id="3992154">,</span>&nbsp;<span class="ident" id="3992156">src</span>&nbsp;<span class="op" id="3992160">*</span><span class="builtintype" id="3992161">byte</span><span class="op" id="3992165">)</span><br>
<span class="lineno"></span><span class="keyword" id="3992167">func</span>&nbsp;<span class="ident" id="3992172">expandKeyAsm</span><span class="op" id="3992184">(</span><span class="ident" id="3992185">nr</span>&nbsp;<span class="builtintype" id="3992188">int</span><span class="op" id="3992191">,</span>&nbsp;<span class="ident" id="3992193">key</span>&nbsp;<span class="op" id="3992197">*</span><span class="builtintype" id="3992198">byte</span><span class="op" id="3992202">,</span>&nbsp;<span class="ident" id="3992204">enc</span>&nbsp;<span class="op" id="3992208">*</span><span class="builtintype" id="3992209">uint32</span><span class="op" id="3992215">,</span>&nbsp;<span class="ident" id="3992217">dec</span>&nbsp;<span class="op" id="3992221">*</span><span class="builtintype" id="3992222">uint32</span><span class="op" id="3992228">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3992231">var</span>&nbsp;<span class="ident" id="3992235">useAsm</span>&nbsp;<span class="op" id="3992242">=</span>&nbsp;<span class="ident" id="3992244">hasAsm</span><span class="op" id="3992250">(</span><span class="op" id="3992251">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3992254">func</span>&nbsp;<span class="ident" id="3992259">encryptBlock</span><span class="op" id="3992271">(</span><span class="ident" id="3992272">xk</span>&nbsp;<span class="op" id="3992275">[</span><span class="op" id="3992276">]</span><span class="builtintype" id="3992277">uint32</span><span class="op" id="3992283">,</span>&nbsp;<span class="ident" id="3992285">dst</span><span class="op" id="3992288">,</span>&nbsp;<span class="ident" id="3992290">src</span>&nbsp;<span class="op" id="3992294">[</span><span class="op" id="3992295">]</span><span class="builtintype" id="3992296">byte</span><span class="op" id="3992300">)</span>&nbsp;<span class="op" id="3992302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992305">if</span>&nbsp;<span class="ident" id="3992308">useAsm</span>&nbsp;<span class="op" id="3992315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992319">encryptBlockAsm</span><span class="op" id="3992334">(</span><span class="builtinfunc" id="3992335">len</span><span class="op" id="3992338">(</span><span class="ident" id="3992339">xk</span><span class="op" id="3992341">)</span><span class="op" id="3992342">/</span><span class="num" id="3992343">4</span><span class="op" id="3992344">-</span><span class="num" id="3992345">1</span><span class="op" id="3992346">,</span>&nbsp;<span class="op" id="3992348">&amp;</span><span class="ident" id="3992349">xk</span><span class="op" id="3992351">[</span><span class="num" id="3992352">0</span><span class="op" id="3992353">]</span><span class="op" id="3992354">,</span>&nbsp;<span class="op" id="3992356">&amp;</span><span class="ident" id="3992357">dst</span><span class="op" id="3992360">[</span><span class="num" id="3992361">0</span><span class="op" id="3992362">]</span><span class="op" id="3992363">,</span>&nbsp;<span class="op" id="3992365">&amp;</span><span class="ident" id="3992366">src</span><span class="op" id="3992369">[</span><span class="num" id="3992370">0</span><span class="op" id="3992371">]</span><span class="op" id="3992372">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992375">}</span>&nbsp;<span class="keyword" id="3992377">else</span>&nbsp;<span class="op" id="3992382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992386">encryptBlockGo</span><span class="op" id="3992400">(</span><span class="ident" id="3992401">xk</span><span class="op" id="3992403">,</span>&nbsp;<span class="ident" id="3992405">dst</span><span class="op" id="3992408">,</span>&nbsp;<span class="ident" id="3992410">src</span><span class="op" id="3992413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992416">}</span><br>
<span class="lineno"></span><span class="op" id="3992418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3992421">func</span>&nbsp;<span class="ident" id="3992426">decryptBlock</span><span class="op" id="3992438">(</span><span class="ident" id="3992439">xk</span>&nbsp;<span class="op" id="3992442">[</span><span class="op" id="3992443">]</span><span class="builtintype" id="3992444">uint32</span><span class="op" id="3992450">,</span>&nbsp;<span class="ident" id="3992452">dst</span><span class="op" id="3992455">,</span>&nbsp;<span class="ident" id="3992457">src</span>&nbsp;<span class="op" id="3992461">[</span><span class="op" id="3992462">]</span><span class="builtintype" id="3992463">byte</span><span class="op" id="3992467">)</span>&nbsp;<span class="op" id="3992469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992472">if</span>&nbsp;<span class="ident" id="3992475">useAsm</span>&nbsp;<span class="op" id="3992482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992486">decryptBlockAsm</span><span class="op" id="3992501">(</span><span class="builtinfunc" id="3992502">len</span><span class="op" id="3992505">(</span><span class="ident" id="3992506">xk</span><span class="op" id="3992508">)</span><span class="op" id="3992509">/</span><span class="num" id="3992510">4</span><span class="op" id="3992511">-</span><span class="num" id="3992512">1</span><span class="op" id="3992513">,</span>&nbsp;<span class="op" id="3992515">&amp;</span><span class="ident" id="3992516">xk</span><span class="op" id="3992518">[</span><span class="num" id="3992519">0</span><span class="op" id="3992520">]</span><span class="op" id="3992521">,</span>&nbsp;<span class="op" id="3992523">&amp;</span><span class="ident" id="3992524">dst</span><span class="op" id="3992527">[</span><span class="num" id="3992528">0</span><span class="op" id="3992529">]</span><span class="op" id="3992530">,</span>&nbsp;<span class="op" id="3992532">&amp;</span><span class="ident" id="3992533">src</span><span class="op" id="3992536">[</span><span class="num" id="3992537">0</span><span class="op" id="3992538">]</span><span class="op" id="3992539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992542">}</span>&nbsp;<span class="keyword" id="3992544">else</span>&nbsp;<span class="op" id="3992549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992553">decryptBlockGo</span><span class="op" id="3992567">(</span><span class="ident" id="3992568">xk</span><span class="op" id="3992570">,</span>&nbsp;<span class="ident" id="3992572">dst</span><span class="op" id="3992575">,</span>&nbsp;<span class="ident" id="3992577">src</span><span class="op" id="3992580">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992583">}</span><br>
<span class="lineno"></span><span class="op" id="3992585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3992588">func</span>&nbsp;<span class="ident" id="3992593">expandKey</span><span class="op" id="3992602">(</span><span class="ident" id="3992603">key</span>&nbsp;<span class="op" id="3992607">[</span><span class="op" id="3992608">]</span><span class="builtintype" id="3992609">byte</span><span class="op" id="3992613">,</span>&nbsp;<span class="ident" id="3992615">enc</span><span class="op" id="3992618">,</span>&nbsp;<span class="ident" id="3992620">dec</span>&nbsp;<span class="op" id="3992624">[</span><span class="op" id="3992625">]</span><span class="builtintype" id="3992626">uint32</span><span class="op" id="3992632">)</span>&nbsp;<span class="op" id="3992634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992637">if</span>&nbsp;<span class="ident" id="3992640">useAsm</span>&nbsp;<span class="op" id="3992647">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992651">rounds</span>&nbsp;<span class="op" id="3992658">:=</span>&nbsp;<span class="num" id="3992661">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992666">switch</span>&nbsp;<span class="builtinfunc" id="3992673">len</span><span class="op" id="3992676">(</span><span class="ident" id="3992677">key</span><span class="op" id="3992680">)</span>&nbsp;<span class="op" id="3992682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992686">case</span>&nbsp;<span class="num" id="3992691">128</span>&nbsp;<span class="op" id="3992695">/</span>&nbsp;<span class="num" id="3992697">8</span><span class="op" id="3992698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992703">rounds</span>&nbsp;<span class="op" id="3992710">=</span>&nbsp;<span class="num" id="3992712">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992717">case</span>&nbsp;<span class="num" id="3992722">192</span>&nbsp;<span class="op" id="3992726">/</span>&nbsp;<span class="num" id="3992728">8</span><span class="op" id="3992729">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992734">rounds</span>&nbsp;<span class="op" id="3992741">=</span>&nbsp;<span class="num" id="3992743">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3992748">case</span>&nbsp;<span class="num" id="3992753">256</span>&nbsp;<span class="op" id="3992757">/</span>&nbsp;<span class="num" id="3992759">8</span><span class="op" id="3992760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992765">rounds</span>&nbsp;<span class="op" id="3992772">=</span>&nbsp;<span class="num" id="3992774">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992783">expandKeyAsm</span><span class="op" id="3992795">(</span><span class="ident" id="3992796">rounds</span><span class="op" id="3992802">,</span>&nbsp;<span class="op" id="3992804">&amp;</span><span class="ident" id="3992805">key</span><span class="op" id="3992808">[</span><span class="num" id="3992809">0</span><span class="op" id="3992810">]</span><span class="op" id="3992811">,</span>&nbsp;<span class="op" id="3992813">&amp;</span><span class="ident" id="3992814">enc</span><span class="op" id="3992817">[</span><span class="num" id="3992818">0</span><span class="op" id="3992819">]</span><span class="op" id="3992820">,</span>&nbsp;<span class="op" id="3992822">&amp;</span><span class="ident" id="3992823">dec</span><span class="op" id="3992826">[</span><span class="num" id="3992827">0</span><span class="op" id="3992828">]</span><span class="op" id="3992829">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992832">}</span>&nbsp;<span class="keyword" id="3992834">else</span>&nbsp;<span class="op" id="3992839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3992843">expandKeyGo</span><span class="op" id="3992854">(</span><span class="ident" id="3992855">key</span><span class="op" id="3992858">,</span>&nbsp;<span class="ident" id="3992860">enc</span><span class="op" id="3992863">,</span>&nbsp;<span class="ident" id="3992865">dec</span><span class="op" id="3992868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3992871">}</span><br>
<span class="lineno"></span><span class="op" id="3992873">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
