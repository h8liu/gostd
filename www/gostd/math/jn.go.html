<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2161205">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2161260">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2161314">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2161365">package</span>&nbsp;<span class="ident" id="2161373">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2161379">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2161445">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2161499">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2161550">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2161605">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2161635">//</span><br>
<span class="lineno"></span><span class="comment" id="2161638">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2161694">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2161763">//</span><br>
<span class="lineno"></span><span class="comment" id="2161766">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2161825">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2161881">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2161938">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2161955">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2162011">//</span><br>
<span class="lineno">25</span><span class="comment" id="2162014">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2162056">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2162116">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2162130">//</span><br>
<span class="lineno"></span><span class="comment" id="2162133">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2162151">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2162216">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2162279">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2162313">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2162347">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2162381">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2162433">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2162473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2162528">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2162583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2162640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2162693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2162747">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2162781">//</span><br>
<span class="lineno"></span><span class="comment" id="2162784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2162835">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2162882">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2162906">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2162967">//</span><br>
<span class="lineno">50</span><span class="comment" id="2162970">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2162992">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2163012">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2163032">func</span>&nbsp;<span class="ident" id="2163037">Jn</span><span class="op" id="2163039">(</span><span class="ident" id="2163040">n</span>&nbsp;<span class="builtintype" id="2163042">int</span><span class="op" id="2163045">,</span>&nbsp;<span class="ident" id="2163047">x</span>&nbsp;<span class="builtintype" id="2163049">float64</span><span class="op" id="2163056">)</span>&nbsp;<span class="builtintype" id="2163058">float64</span>&nbsp;<span class="op" id="2163066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163069">const</span>&nbsp;<span class="op" id="2163075">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2163079">TwoM29</span>&nbsp;<span class="op" id="2163086">=</span>&nbsp;<span class="num" id="2163088">1.0</span>&nbsp;<span class="op" id="2163092">/</span>&nbsp;<span class="op" id="2163094">(</span><span class="num" id="2163095">1</span>&nbsp;<span class="op" id="2163097">&lt;&lt;</span>&nbsp;<span class="num" id="2163100">29</span><span class="op" id="2163102">)</span>&nbsp;<span class="comment" id="2163104">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2163135">Two302</span>&nbsp;<span class="op" id="2163142">=</span>&nbsp;<span class="num" id="2163144">1</span>&nbsp;<span class="op" id="2163146">&lt;&lt;</span>&nbsp;<span class="num" id="2163149">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2163160">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163193">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163211">switch</span>&nbsp;<span class="op" id="2163218">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163221">case</span>&nbsp;<span class="ident" id="2163226">IsNaN</span><span class="op" id="2163231">(</span><span class="ident" id="2163232">x</span><span class="op" id="2163233">)</span><span class="op" id="2163234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163238">return</span>&nbsp;<span class="ident" id="2163245">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163248">case</span>&nbsp;<span class="ident" id="2163253">IsInf</span><span class="op" id="2163258">(</span><span class="ident" id="2163259">x</span><span class="op" id="2163260">,</span>&nbsp;<span class="num" id="2163262">0</span><span class="op" id="2163263">)</span><span class="op" id="2163264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163268">return</span>&nbsp;<span class="num" id="2163275">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163278">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163281">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163344">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163375">if</span>&nbsp;<span class="ident" id="2163378">n</span>&nbsp;<span class="op" id="2163380">==</span>&nbsp;<span class="num" id="2163383">0</span>&nbsp;<span class="op" id="2163385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163389">return</span>&nbsp;<span class="ident" id="2163396">J0</span><span class="op" id="2163398">(</span><span class="ident" id="2163399">x</span><span class="op" id="2163400">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163406">if</span>&nbsp;<span class="ident" id="2163409">x</span>&nbsp;<span class="op" id="2163411">==</span>&nbsp;<span class="num" id="2163414">0</span>&nbsp;<span class="op" id="2163416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163420">return</span>&nbsp;<span class="num" id="2163427">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163433">if</span>&nbsp;<span class="ident" id="2163436">n</span>&nbsp;<span class="op" id="2163438">&lt;</span>&nbsp;<span class="num" id="2163440">0</span>&nbsp;<span class="op" id="2163442">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2163446">n</span><span class="op" id="2163447">,</span>&nbsp;<span class="ident" id="2163449">x</span>&nbsp;<span class="op" id="2163451">=</span>&nbsp;<span class="op" id="2163453">-</span><span class="ident" id="2163454">n</span><span class="op" id="2163455">,</span>&nbsp;<span class="op" id="2163457">-</span><span class="ident" id="2163458">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163464">if</span>&nbsp;<span class="ident" id="2163467">n</span>&nbsp;<span class="op" id="2163469">==</span>&nbsp;<span class="num" id="2163472">1</span>&nbsp;<span class="op" id="2163474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163478">return</span>&nbsp;<span class="ident" id="2163485">J1</span><span class="op" id="2163487">(</span><span class="ident" id="2163488">x</span><span class="op" id="2163489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163492">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2163495">sign</span>&nbsp;<span class="op" id="2163500">:=</span>&nbsp;<span class="builtintype" id="2163503">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163510">if</span>&nbsp;<span class="ident" id="2163513">x</span>&nbsp;<span class="op" id="2163515">&lt;</span>&nbsp;<span class="num" id="2163517">0</span>&nbsp;<span class="op" id="2163519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2163523">x</span>&nbsp;<span class="op" id="2163525">=</span>&nbsp;<span class="op" id="2163527">-</span><span class="ident" id="2163528">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163532">if</span>&nbsp;<span class="ident" id="2163535">n</span><span class="op" id="2163536">&amp;</span><span class="num" id="2163537">1</span>&nbsp;<span class="op" id="2163539">==</span>&nbsp;<span class="num" id="2163542">1</span>&nbsp;<span class="op" id="2163544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2163549">sign</span>&nbsp;<span class="op" id="2163554">=</span>&nbsp;<span class="builtintype" id="2163556">true</span>&nbsp;<span class="comment" id="2163561">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2163590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163593">var</span>&nbsp;<span class="ident" id="2163597">b</span>&nbsp;<span class="builtintype" id="2163599">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163608">if</span>&nbsp;<span class="builtintype" id="2163611">float64</span><span class="op" id="2163618">(</span><span class="ident" id="2163619">n</span><span class="op" id="2163620">)</span>&nbsp;<span class="op" id="2163622">&lt;=</span>&nbsp;<span class="ident" id="2163625">x</span>&nbsp;<span class="op" id="2163627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163631">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2163679">if</span>&nbsp;<span class="ident" id="2163682">x</span>&nbsp;<span class="op" id="2163684">&gt;=</span>&nbsp;<span class="ident" id="2163687">Two302</span>&nbsp;<span class="op" id="2163694">{</span>&nbsp;<span class="comment" id="2163696">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163714">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163732">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163787">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163842">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163938">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2163944">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164054">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164102">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164150">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164247">var</span>&nbsp;<span class="ident" id="2164251">temp</span>&nbsp;<span class="builtintype" id="2164256">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164267">switch</span>&nbsp;<span class="ident" id="2164274">n</span>&nbsp;<span class="op" id="2164276">&amp;</span>&nbsp;<span class="num" id="2164278">3</span>&nbsp;<span class="op" id="2164280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164285">case</span>&nbsp;<span class="num" id="2164290">0</span><span class="op" id="2164291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164297">temp</span>&nbsp;<span class="op" id="2164302">=</span>&nbsp;<span class="ident" id="2164304">Cos</span><span class="op" id="2164307">(</span><span class="ident" id="2164308">x</span><span class="op" id="2164309">)</span>&nbsp;<span class="op" id="2164311">+</span>&nbsp;<span class="ident" id="2164313">Sin</span><span class="op" id="2164316">(</span><span class="ident" id="2164317">x</span><span class="op" id="2164318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164323">case</span>&nbsp;<span class="num" id="2164328">1</span><span class="op" id="2164329">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164335">temp</span>&nbsp;<span class="op" id="2164340">=</span>&nbsp;<span class="op" id="2164342">-</span><span class="ident" id="2164343">Cos</span><span class="op" id="2164346">(</span><span class="ident" id="2164347">x</span><span class="op" id="2164348">)</span>&nbsp;<span class="op" id="2164350">+</span>&nbsp;<span class="ident" id="2164352">Sin</span><span class="op" id="2164355">(</span><span class="ident" id="2164356">x</span><span class="op" id="2164357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164362">case</span>&nbsp;<span class="num" id="2164367">2</span><span class="op" id="2164368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164374">temp</span>&nbsp;<span class="op" id="2164379">=</span>&nbsp;<span class="op" id="2164381">-</span><span class="ident" id="2164382">Cos</span><span class="op" id="2164385">(</span><span class="ident" id="2164386">x</span><span class="op" id="2164387">)</span>&nbsp;<span class="op" id="2164389">-</span>&nbsp;<span class="ident" id="2164391">Sin</span><span class="op" id="2164394">(</span><span class="ident" id="2164395">x</span><span class="op" id="2164396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164401">case</span>&nbsp;<span class="num" id="2164406">3</span><span class="op" id="2164407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164413">temp</span>&nbsp;<span class="op" id="2164418">=</span>&nbsp;<span class="ident" id="2164420">Cos</span><span class="op" id="2164423">(</span><span class="ident" id="2164424">x</span><span class="op" id="2164425">)</span>&nbsp;<span class="op" id="2164427">-</span>&nbsp;<span class="ident" id="2164429">Sin</span><span class="op" id="2164432">(</span><span class="ident" id="2164433">x</span><span class="op" id="2164434">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164444">b</span>&nbsp;<span class="op" id="2164446">=</span>&nbsp;<span class="op" id="2164448">(</span><span class="num" id="2164449">1</span>&nbsp;<span class="op" id="2164451">/</span>&nbsp;<span class="ident" id="2164453">SqrtPi</span><span class="op" id="2164459">)</span>&nbsp;<span class="op" id="2164461">*</span>&nbsp;<span class="ident" id="2164463">temp</span>&nbsp;<span class="op" id="2164468">/</span>&nbsp;<span class="ident" id="2164470">Sqrt</span><span class="op" id="2164474">(</span><span class="ident" id="2164475">x</span><span class="op" id="2164476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164480">}</span>&nbsp;<span class="keyword" id="2164482">else</span>&nbsp;<span class="op" id="2164487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164492">b</span>&nbsp;<span class="op" id="2164494">=</span>&nbsp;<span class="ident" id="2164496">J1</span><span class="op" id="2164498">(</span><span class="ident" id="2164499">x</span><span class="op" id="2164500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164505">for</span>&nbsp;<span class="ident" id="2164509">i</span><span class="op" id="2164510">,</span>&nbsp;<span class="ident" id="2164512">a</span>&nbsp;<span class="op" id="2164514">:=</span>&nbsp;<span class="num" id="2164517">1</span><span class="op" id="2164518">,</span>&nbsp;<span class="ident" id="2164520">J0</span><span class="op" id="2164522">(</span><span class="ident" id="2164523">x</span><span class="op" id="2164524">)</span><span class="op" id="2164525">;</span>&nbsp;<span class="ident" id="2164527">i</span>&nbsp;<span class="op" id="2164529">&lt;</span>&nbsp;<span class="ident" id="2164531">n</span><span class="op" id="2164532">;</span>&nbsp;<span class="ident" id="2164534">i</span><span class="op" id="2164535">++</span>&nbsp;<span class="op" id="2164538">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164544">a</span><span class="op" id="2164545">,</span>&nbsp;<span class="ident" id="2164547">b</span>&nbsp;<span class="op" id="2164549">=</span>&nbsp;<span class="ident" id="2164551">b</span><span class="op" id="2164552">,</span>&nbsp;<span class="ident" id="2164554">b</span><span class="op" id="2164555">*</span><span class="op" id="2164556">(</span><span class="builtintype" id="2164557">float64</span><span class="op" id="2164564">(</span><span class="ident" id="2164565">i</span><span class="op" id="2164566">+</span><span class="ident" id="2164567">i</span><span class="op" id="2164568">)</span><span class="op" id="2164569">/</span><span class="ident" id="2164570">x</span><span class="op" id="2164571">)</span><span class="op" id="2164572">-</span><span class="ident" id="2164573">a</span>&nbsp;<span class="comment" id="2164575">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164604">}</span>&nbsp;<span class="keyword" id="2164606">else</span>&nbsp;<span class="op" id="2164611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164615">if</span>&nbsp;<span class="ident" id="2164618">x</span>&nbsp;<span class="op" id="2164620">&lt;</span>&nbsp;<span class="ident" id="2164622">TwoM29</span>&nbsp;<span class="op" id="2164629">{</span>&nbsp;<span class="comment" id="2164631">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164648">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164709">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164746">if</span>&nbsp;<span class="ident" id="2164749">n</span>&nbsp;<span class="op" id="2164751">&gt;</span>&nbsp;<span class="num" id="2164753">33</span>&nbsp;<span class="op" id="2164756">{</span>&nbsp;<span class="comment" id="2164758">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164775">b</span>&nbsp;<span class="op" id="2164777">=</span>&nbsp;<span class="num" id="2164779">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164784">}</span>&nbsp;<span class="keyword" id="2164786">else</span>&nbsp;<span class="op" id="2164791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164797">temp</span>&nbsp;<span class="op" id="2164802">:=</span>&nbsp;<span class="ident" id="2164805">x</span>&nbsp;<span class="op" id="2164807">*</span>&nbsp;<span class="num" id="2164809">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164817">b</span>&nbsp;<span class="op" id="2164819">=</span>&nbsp;<span class="ident" id="2164821">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164830">a</span>&nbsp;<span class="op" id="2164832">:=</span>&nbsp;<span class="num" id="2164835">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2164843">for</span>&nbsp;<span class="ident" id="2164847">i</span>&nbsp;<span class="op" id="2164849">:=</span>&nbsp;<span class="num" id="2164852">2</span><span class="op" id="2164853">;</span>&nbsp;<span class="ident" id="2164855">i</span>&nbsp;<span class="op" id="2164857">&lt;=</span>&nbsp;<span class="ident" id="2164860">n</span><span class="op" id="2164861">;</span>&nbsp;<span class="ident" id="2164863">i</span><span class="op" id="2164864">++</span>&nbsp;<span class="op" id="2164867">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164874">a</span>&nbsp;<span class="op" id="2164876">*=</span>&nbsp;<span class="builtintype" id="2164879">float64</span><span class="op" id="2164886">(</span><span class="ident" id="2164887">i</span><span class="op" id="2164888">)</span>&nbsp;<span class="comment" id="2164890">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164905">b</span>&nbsp;<span class="op" id="2164907">*=</span>&nbsp;<span class="ident" id="2164910">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2164921">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2164947">b</span>&nbsp;<span class="op" id="2164949">/=</span>&nbsp;<span class="ident" id="2164952">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164957">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2164961">}</span>&nbsp;<span class="keyword" id="2164963">else</span>&nbsp;<span class="op" id="2164968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2164973">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165052">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165109">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165158">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165164">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165209">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165313">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165363">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165409">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165415">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165469">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165511">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165536">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165573">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165601">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165637">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165668">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165740">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165746">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165792">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165827">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165865">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165903">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165941">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2165984">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166002">w</span>&nbsp;<span class="op" id="2166004">:=</span>&nbsp;<span class="builtintype" id="2166007">float64</span><span class="op" id="2166014">(</span><span class="ident" id="2166015">n</span><span class="op" id="2166016">+</span><span class="ident" id="2166017">n</span><span class="op" id="2166018">)</span>&nbsp;<span class="op" id="2166020">/</span>&nbsp;<span class="ident" id="2166022">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166027">h</span>&nbsp;<span class="op" id="2166029">:=</span>&nbsp;<span class="num" id="2166032">2</span>&nbsp;<span class="op" id="2166034">/</span>&nbsp;<span class="ident" id="2166036">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166041">q0</span>&nbsp;<span class="op" id="2166044">:=</span>&nbsp;<span class="ident" id="2166047">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166052">z</span>&nbsp;<span class="op" id="2166054">:=</span>&nbsp;<span class="ident" id="2166057">w</span>&nbsp;<span class="op" id="2166059">+</span>&nbsp;<span class="ident" id="2166061">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166066">q1</span>&nbsp;<span class="op" id="2166069">:=</span>&nbsp;<span class="ident" id="2166072">w</span><span class="op" id="2166073">*</span><span class="ident" id="2166074">z</span>&nbsp;<span class="op" id="2166076">-</span>&nbsp;<span class="num" id="2166078">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166083">k</span>&nbsp;<span class="op" id="2166085">:=</span>&nbsp;<span class="num" id="2166088">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166093">for</span>&nbsp;<span class="ident" id="2166097">q1</span>&nbsp;<span class="op" id="2166100">&lt;</span>&nbsp;<span class="num" id="2166102">1e9</span>&nbsp;<span class="op" id="2166106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166112">k</span>&nbsp;<span class="op" id="2166114">+=</span>&nbsp;<span class="num" id="2166117">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166123">z</span>&nbsp;<span class="op" id="2166125">+=</span>&nbsp;<span class="ident" id="2166128">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166134">q0</span><span class="op" id="2166136">,</span>&nbsp;<span class="ident" id="2166138">q1</span>&nbsp;<span class="op" id="2166141">=</span>&nbsp;<span class="ident" id="2166143">q1</span><span class="op" id="2166145">,</span>&nbsp;<span class="ident" id="2166147">z</span><span class="op" id="2166148">*</span><span class="ident" id="2166149">q1</span><span class="op" id="2166151">-</span><span class="ident" id="2166152">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166163">m</span>&nbsp;<span class="op" id="2166165">:=</span>&nbsp;<span class="ident" id="2166168">n</span>&nbsp;<span class="op" id="2166170">+</span>&nbsp;<span class="ident" id="2166172">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166177">t</span>&nbsp;<span class="op" id="2166179">:=</span>&nbsp;<span class="num" id="2166182">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166189">for</span>&nbsp;<span class="ident" id="2166193">i</span>&nbsp;<span class="op" id="2166195">:=</span>&nbsp;<span class="num" id="2166198">2</span>&nbsp;<span class="op" id="2166200">*</span>&nbsp;<span class="op" id="2166202">(</span><span class="ident" id="2166203">n</span>&nbsp;<span class="op" id="2166205">+</span>&nbsp;<span class="ident" id="2166207">k</span><span class="op" id="2166208">)</span><span class="op" id="2166209">;</span>&nbsp;<span class="ident" id="2166211">i</span>&nbsp;<span class="op" id="2166213">&gt;=</span>&nbsp;<span class="ident" id="2166216">m</span><span class="op" id="2166217">;</span>&nbsp;<span class="ident" id="2166219">i</span>&nbsp;<span class="op" id="2166221">-=</span>&nbsp;<span class="num" id="2166224">2</span>&nbsp;<span class="op" id="2166226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166232">t</span>&nbsp;<span class="op" id="2166234">=</span>&nbsp;<span class="num" id="2166236">1</span>&nbsp;<span class="op" id="2166238">/</span>&nbsp;<span class="op" id="2166240">(</span><span class="builtintype" id="2166241">float64</span><span class="op" id="2166248">(</span><span class="ident" id="2166249">i</span><span class="op" id="2166250">)</span><span class="op" id="2166251">/</span><span class="ident" id="2166252">x</span>&nbsp;<span class="op" id="2166254">-</span>&nbsp;<span class="ident" id="2166256">t</span><span class="op" id="2166257">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166267">a</span>&nbsp;<span class="op" id="2166269">:=</span>&nbsp;<span class="ident" id="2166272">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166277">b</span>&nbsp;<span class="op" id="2166279">=</span>&nbsp;<span class="num" id="2166281">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166286">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166340">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166377">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166408">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166449">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166515">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166574">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166607">tmp</span>&nbsp;<span class="op" id="2166611">:=</span>&nbsp;<span class="builtintype" id="2166614">float64</span><span class="op" id="2166621">(</span><span class="ident" id="2166622">n</span><span class="op" id="2166623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166628">v</span>&nbsp;<span class="op" id="2166630">:=</span>&nbsp;<span class="num" id="2166633">2</span>&nbsp;<span class="op" id="2166635">/</span>&nbsp;<span class="ident" id="2166637">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166642">tmp</span>&nbsp;<span class="op" id="2166646">=</span>&nbsp;<span class="ident" id="2166648">tmp</span>&nbsp;<span class="op" id="2166652">*</span>&nbsp;<span class="ident" id="2166654">Log</span><span class="op" id="2166657">(</span><span class="ident" id="2166658">Abs</span><span class="op" id="2166661">(</span><span class="ident" id="2166662">v</span><span class="op" id="2166663">*</span><span class="ident" id="2166664">tmp</span><span class="op" id="2166667">)</span><span class="op" id="2166668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166673">if</span>&nbsp;<span class="ident" id="2166676">tmp</span>&nbsp;<span class="op" id="2166680">&lt;</span>&nbsp;<span class="num" id="2166682">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2166709">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166715">for</span>&nbsp;<span class="ident" id="2166719">i</span>&nbsp;<span class="op" id="2166721">:=</span>&nbsp;<span class="ident" id="2166724">n</span>&nbsp;<span class="op" id="2166726">-</span>&nbsp;<span class="num" id="2166728">1</span><span class="op" id="2166729">;</span>&nbsp;<span class="ident" id="2166731">i</span>&nbsp;<span class="op" id="2166733">&gt;</span>&nbsp;<span class="num" id="2166735">0</span><span class="op" id="2166736">;</span>&nbsp;<span class="ident" id="2166738">i</span><span class="op" id="2166739">--</span>&nbsp;<span class="op" id="2166742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166749">di</span>&nbsp;<span class="op" id="2166752">:=</span>&nbsp;<span class="builtintype" id="2166755">float64</span><span class="op" id="2166762">(</span><span class="ident" id="2166763">i</span>&nbsp;<span class="op" id="2166765">+</span>&nbsp;<span class="ident" id="2166767">i</span><span class="op" id="2166768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166775">a</span><span class="op" id="2166776">,</span>&nbsp;<span class="ident" id="2166778">b</span>&nbsp;<span class="op" id="2166780">=</span>&nbsp;<span class="ident" id="2166782">b</span><span class="op" id="2166783">,</span>&nbsp;<span class="ident" id="2166785">b</span><span class="op" id="2166786">*</span><span class="ident" id="2166787">di</span><span class="op" id="2166789">/</span><span class="ident" id="2166790">x</span><span class="op" id="2166791">-</span><span class="ident" id="2166792">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166799">di</span>&nbsp;<span class="op" id="2166802">-=</span>&nbsp;<span class="num" id="2166805">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166811">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2166816">}</span>&nbsp;<span class="keyword" id="2166818">else</span>&nbsp;<span class="op" id="2166823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166829">for</span>&nbsp;<span class="ident" id="2166833">i</span>&nbsp;<span class="op" id="2166835">:=</span>&nbsp;<span class="ident" id="2166838">n</span>&nbsp;<span class="op" id="2166840">-</span>&nbsp;<span class="num" id="2166842">1</span><span class="op" id="2166843">;</span>&nbsp;<span class="ident" id="2166845">i</span>&nbsp;<span class="op" id="2166847">&gt;</span>&nbsp;<span class="num" id="2166849">0</span><span class="op" id="2166850">;</span>&nbsp;<span class="ident" id="2166852">i</span><span class="op" id="2166853">--</span>&nbsp;<span class="op" id="2166856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166863">di</span>&nbsp;<span class="op" id="2166866">:=</span>&nbsp;<span class="builtintype" id="2166869">float64</span><span class="op" id="2166876">(</span><span class="ident" id="2166877">i</span>&nbsp;<span class="op" id="2166879">+</span>&nbsp;<span class="ident" id="2166881">i</span><span class="op" id="2166882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166889">a</span><span class="op" id="2166890">,</span>&nbsp;<span class="ident" id="2166892">b</span>&nbsp;<span class="op" id="2166894">=</span>&nbsp;<span class="ident" id="2166896">b</span><span class="op" id="2166897">,</span>&nbsp;<span class="ident" id="2166899">b</span><span class="op" id="2166900">*</span><span class="ident" id="2166901">di</span><span class="op" id="2166903">/</span><span class="ident" id="2166904">x</span><span class="op" id="2166905">-</span><span class="ident" id="2166906">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166913">di</span>&nbsp;<span class="op" id="2166916">-=</span>&nbsp;<span class="num" id="2166919">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2166926">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2166969">if</span>&nbsp;<span class="ident" id="2166972">b</span>&nbsp;<span class="op" id="2166974">&gt;</span>&nbsp;<span class="num" id="2166976">1e100</span>&nbsp;<span class="op" id="2166982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2166990">a</span>&nbsp;<span class="op" id="2166992">/=</span>&nbsp;<span class="ident" id="2166995">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167003">t</span>&nbsp;<span class="op" id="2167005">/=</span>&nbsp;<span class="ident" id="2167008">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167016">b</span>&nbsp;<span class="op" id="2167018">=</span>&nbsp;<span class="num" id="2167020">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167043">b</span>&nbsp;<span class="op" id="2167045">=</span>&nbsp;<span class="ident" id="2167047">t</span>&nbsp;<span class="op" id="2167049">*</span>&nbsp;<span class="ident" id="2167051">J0</span><span class="op" id="2167053">(</span><span class="ident" id="2167054">x</span><span class="op" id="2167055">)</span>&nbsp;<span class="op" id="2167057">/</span>&nbsp;<span class="ident" id="2167059">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167063">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167069">if</span>&nbsp;<span class="ident" id="2167072">sign</span>&nbsp;<span class="op" id="2167077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167081">return</span>&nbsp;<span class="op" id="2167088">-</span><span class="ident" id="2167089">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167095">return</span>&nbsp;<span class="ident" id="2167102">b</span><br>
<span class="lineno">225</span><span class="op" id="2167104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2167107">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2167169">//</span><br>
<span class="lineno"></span><span class="comment" id="2167172">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2167194">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2167213">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2167236">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2167290">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2167312">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2167332">func</span>&nbsp;<span class="ident" id="2167337">Yn</span><span class="op" id="2167339">(</span><span class="ident" id="2167340">n</span>&nbsp;<span class="builtintype" id="2167342">int</span><span class="op" id="2167345">,</span>&nbsp;<span class="ident" id="2167347">x</span>&nbsp;<span class="builtintype" id="2167349">float64</span><span class="op" id="2167356">)</span>&nbsp;<span class="builtintype" id="2167358">float64</span>&nbsp;<span class="op" id="2167366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167369">const</span>&nbsp;<span class="ident" id="2167375">Two302</span>&nbsp;<span class="op" id="2167382">=</span>&nbsp;<span class="num" id="2167384">1</span>&nbsp;<span class="op" id="2167386">&lt;&lt;</span>&nbsp;<span class="num" id="2167389">302</span>&nbsp;<span class="comment" id="2167393">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167423">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167441">switch</span>&nbsp;<span class="op" id="2167448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167451">case</span>&nbsp;<span class="ident" id="2167456">x</span>&nbsp;<span class="op" id="2167458">&lt;</span>&nbsp;<span class="num" id="2167460">0</span>&nbsp;<span class="op" id="2167462">||</span>&nbsp;<span class="ident" id="2167465">IsNaN</span><span class="op" id="2167470">(</span><span class="ident" id="2167471">x</span><span class="op" id="2167472">)</span><span class="op" id="2167473">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167477">return</span>&nbsp;<span class="ident" id="2167484">NaN</span><span class="op" id="2167487">(</span><span class="op" id="2167488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167491">case</span>&nbsp;<span class="ident" id="2167496">IsInf</span><span class="op" id="2167501">(</span><span class="ident" id="2167502">x</span><span class="op" id="2167503">,</span>&nbsp;<span class="num" id="2167505">1</span><span class="op" id="2167506">)</span><span class="op" id="2167507">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167511">return</span>&nbsp;<span class="num" id="2167518">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167525">if</span>&nbsp;<span class="ident" id="2167528">n</span>&nbsp;<span class="op" id="2167530">==</span>&nbsp;<span class="num" id="2167533">0</span>&nbsp;<span class="op" id="2167535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167539">return</span>&nbsp;<span class="ident" id="2167546">Y0</span><span class="op" id="2167548">(</span><span class="ident" id="2167549">x</span><span class="op" id="2167550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167556">if</span>&nbsp;<span class="ident" id="2167559">x</span>&nbsp;<span class="op" id="2167561">==</span>&nbsp;<span class="num" id="2167564">0</span>&nbsp;<span class="op" id="2167566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167570">if</span>&nbsp;<span class="ident" id="2167573">n</span>&nbsp;<span class="op" id="2167575">&lt;</span>&nbsp;<span class="num" id="2167577">0</span>&nbsp;<span class="op" id="2167579">&amp;&amp;</span>&nbsp;<span class="ident" id="2167582">n</span><span class="op" id="2167583">&amp;</span><span class="num" id="2167584">1</span>&nbsp;<span class="op" id="2167586">==</span>&nbsp;<span class="num" id="2167589">1</span>&nbsp;<span class="op" id="2167591">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167596">return</span>&nbsp;<span class="ident" id="2167603">Inf</span><span class="op" id="2167606">(</span><span class="num" id="2167607">1</span><span class="op" id="2167608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167616">return</span>&nbsp;<span class="ident" id="2167623">Inf</span><span class="op" id="2167626">(</span><span class="op" id="2167627">-</span><span class="num" id="2167628">1</span><span class="op" id="2167629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167635">sign</span>&nbsp;<span class="op" id="2167640">:=</span>&nbsp;<span class="builtintype" id="2167643">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167650">if</span>&nbsp;<span class="ident" id="2167653">n</span>&nbsp;<span class="op" id="2167655">&lt;</span>&nbsp;<span class="num" id="2167657">0</span>&nbsp;<span class="op" id="2167659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167663">n</span>&nbsp;<span class="op" id="2167665">=</span>&nbsp;<span class="op" id="2167667">-</span><span class="ident" id="2167668">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167672">if</span>&nbsp;<span class="ident" id="2167675">n</span><span class="op" id="2167676">&amp;</span><span class="num" id="2167677">1</span>&nbsp;<span class="op" id="2167679">==</span>&nbsp;<span class="num" id="2167682">1</span>&nbsp;<span class="op" id="2167684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2167689">sign</span>&nbsp;<span class="op" id="2167694">=</span>&nbsp;<span class="builtintype" id="2167696">true</span>&nbsp;<span class="comment" id="2167701">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167736">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167742">if</span>&nbsp;<span class="ident" id="2167745">n</span>&nbsp;<span class="op" id="2167747">==</span>&nbsp;<span class="num" id="2167750">1</span>&nbsp;<span class="op" id="2167752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167756">if</span>&nbsp;<span class="ident" id="2167759">sign</span>&nbsp;<span class="op" id="2167764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167769">return</span>&nbsp;<span class="op" id="2167776">-</span><span class="ident" id="2167777">Y1</span><span class="op" id="2167779">(</span><span class="ident" id="2167780">x</span><span class="op" id="2167781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167785">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167789">return</span>&nbsp;<span class="ident" id="2167796">Y1</span><span class="op" id="2167798">(</span><span class="ident" id="2167799">x</span><span class="op" id="2167800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2167803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167806">var</span>&nbsp;<span class="ident" id="2167810">b</span>&nbsp;<span class="builtintype" id="2167812">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2167821">if</span>&nbsp;<span class="ident" id="2167824">x</span>&nbsp;<span class="op" id="2167826">&gt;=</span>&nbsp;<span class="ident" id="2167829">Two302</span>&nbsp;<span class="op" id="2167836">{</span>&nbsp;<span class="comment" id="2167838">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167854">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167871">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167920">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2167969">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168002">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168046">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168051">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168088">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168129">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168151">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168174">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168196">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168219">var</span>&nbsp;<span class="ident" id="2168223">temp</span>&nbsp;<span class="builtintype" id="2168228">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168238">switch</span>&nbsp;<span class="ident" id="2168245">n</span>&nbsp;<span class="op" id="2168247">&amp;</span>&nbsp;<span class="num" id="2168249">3</span>&nbsp;<span class="op" id="2168251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168255">case</span>&nbsp;<span class="num" id="2168260">0</span><span class="op" id="2168261">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168266">temp</span>&nbsp;<span class="op" id="2168271">=</span>&nbsp;<span class="ident" id="2168273">Sin</span><span class="op" id="2168276">(</span><span class="ident" id="2168277">x</span><span class="op" id="2168278">)</span>&nbsp;<span class="op" id="2168280">-</span>&nbsp;<span class="ident" id="2168282">Cos</span><span class="op" id="2168285">(</span><span class="ident" id="2168286">x</span><span class="op" id="2168287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168291">case</span>&nbsp;<span class="num" id="2168296">1</span><span class="op" id="2168297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168302">temp</span>&nbsp;<span class="op" id="2168307">=</span>&nbsp;<span class="op" id="2168309">-</span><span class="ident" id="2168310">Sin</span><span class="op" id="2168313">(</span><span class="ident" id="2168314">x</span><span class="op" id="2168315">)</span>&nbsp;<span class="op" id="2168317">-</span>&nbsp;<span class="ident" id="2168319">Cos</span><span class="op" id="2168322">(</span><span class="ident" id="2168323">x</span><span class="op" id="2168324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168328">case</span>&nbsp;<span class="num" id="2168333">2</span><span class="op" id="2168334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168339">temp</span>&nbsp;<span class="op" id="2168344">=</span>&nbsp;<span class="op" id="2168346">-</span><span class="ident" id="2168347">Sin</span><span class="op" id="2168350">(</span><span class="ident" id="2168351">x</span><span class="op" id="2168352">)</span>&nbsp;<span class="op" id="2168354">+</span>&nbsp;<span class="ident" id="2168356">Cos</span><span class="op" id="2168359">(</span><span class="ident" id="2168360">x</span><span class="op" id="2168361">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168365">case</span>&nbsp;<span class="num" id="2168370">3</span><span class="op" id="2168371">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168376">temp</span>&nbsp;<span class="op" id="2168381">=</span>&nbsp;<span class="ident" id="2168383">Sin</span><span class="op" id="2168386">(</span><span class="ident" id="2168387">x</span><span class="op" id="2168388">)</span>&nbsp;<span class="op" id="2168390">+</span>&nbsp;<span class="ident" id="2168392">Cos</span><span class="op" id="2168395">(</span><span class="ident" id="2168396">x</span><span class="op" id="2168397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168405">b</span>&nbsp;<span class="op" id="2168407">=</span>&nbsp;<span class="op" id="2168409">(</span><span class="num" id="2168410">1</span>&nbsp;<span class="op" id="2168412">/</span>&nbsp;<span class="ident" id="2168414">SqrtPi</span><span class="op" id="2168420">)</span>&nbsp;<span class="op" id="2168422">*</span>&nbsp;<span class="ident" id="2168424">temp</span>&nbsp;<span class="op" id="2168429">/</span>&nbsp;<span class="ident" id="2168431">Sqrt</span><span class="op" id="2168435">(</span><span class="ident" id="2168436">x</span><span class="op" id="2168437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168440">}</span>&nbsp;<span class="keyword" id="2168442">else</span>&nbsp;<span class="op" id="2168447">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168451">a</span>&nbsp;<span class="op" id="2168453">:=</span>&nbsp;<span class="ident" id="2168456">Y0</span><span class="op" id="2168458">(</span><span class="ident" id="2168459">x</span><span class="op" id="2168460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168464">b</span>&nbsp;<span class="op" id="2168466">=</span>&nbsp;<span class="ident" id="2168468">Y1</span><span class="op" id="2168470">(</span><span class="ident" id="2168471">x</span><span class="op" id="2168472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2168476">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168499">for</span>&nbsp;<span class="ident" id="2168503">i</span>&nbsp;<span class="op" id="2168505">:=</span>&nbsp;<span class="num" id="2168508">1</span><span class="op" id="2168509">;</span>&nbsp;<span class="ident" id="2168511">i</span>&nbsp;<span class="op" id="2168513">&lt;</span>&nbsp;<span class="ident" id="2168515">n</span>&nbsp;<span class="op" id="2168517">&amp;&amp;</span>&nbsp;<span class="op" id="2168520">!</span><span class="ident" id="2168521">IsInf</span><span class="op" id="2168526">(</span><span class="ident" id="2168527">b</span><span class="op" id="2168528">,</span>&nbsp;<span class="op" id="2168530">-</span><span class="num" id="2168531">1</span><span class="op" id="2168532">)</span><span class="op" id="2168533">;</span>&nbsp;<span class="ident" id="2168535">i</span><span class="op" id="2168536">++</span>&nbsp;<span class="op" id="2168539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2168544">a</span><span class="op" id="2168545">,</span>&nbsp;<span class="ident" id="2168547">b</span>&nbsp;<span class="op" id="2168549">=</span>&nbsp;<span class="ident" id="2168551">b</span><span class="op" id="2168552">,</span>&nbsp;<span class="op" id="2168554">(</span><span class="builtintype" id="2168555">float64</span><span class="op" id="2168562">(</span><span class="ident" id="2168563">i</span><span class="op" id="2168564">+</span><span class="ident" id="2168565">i</span><span class="op" id="2168566">)</span><span class="op" id="2168567">/</span><span class="ident" id="2168568">x</span><span class="op" id="2168569">)</span><span class="op" id="2168570">*</span><span class="ident" id="2168571">b</span><span class="op" id="2168572">-</span><span class="ident" id="2168573">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168583">if</span>&nbsp;<span class="ident" id="2168586">sign</span>&nbsp;<span class="op" id="2168591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168595">return</span>&nbsp;<span class="op" id="2168602">-</span><span class="ident" id="2168603">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2168606">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2168609">return</span>&nbsp;<span class="ident" id="2168616">b</span><br>
<span class="lineno"></span><span class="op" id="2168618">}</span>
</div>
</body>
</html>
