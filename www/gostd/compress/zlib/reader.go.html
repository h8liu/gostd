<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5126267">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5126322">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5126376">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5126427">/*<br>
<span class="lineno"></span>Package&nbsp;zlib&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;zlib&nbsp;format&nbsp;compressed&nbsp;data,<br>
<span class="lineno"></span>as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1950.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>The&nbsp;implementation&nbsp;provides&nbsp;filters&nbsp;that&nbsp;uncompress&nbsp;during&nbsp;reading<br>
<span class="lineno">10</span>and&nbsp;compress&nbsp;during&nbsp;writing.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;write&nbsp;compressed&nbsp;data<br>
<span class="lineno"></span>to&nbsp;a&nbsp;buffer:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;b&nbsp;bytes.Buffer<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw&nbsp;:=&nbsp;zlib.NewWriter(&amp;b)<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbspw.Write([]byte(&#34;hello,&nbsp;world\n&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspw.Close()<br>
<span class="lineno"></span><br>
<span class="lineno"></span>and&nbsp;to&nbsp;read&nbsp;that&nbsp;data&nbsp;back:<br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbspr,&nbsp;err&nbsp;:=&nbsp;zlib.NewReader(&amp;b)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspio.Copy(os.Stdout,&nbsp;r)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspr.Close()<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="5126870">package</span>&nbsp;<span class="ident" id="5126878">zlib</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5126884">import</span>&nbsp;<span class="op" id="5126891">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126894">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126903">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126921">&#34;errors&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126931">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126939">&#34;hash/adler32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5126955">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5126960">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="5126963">const</span>&nbsp;<span class="ident" id="5126969">zlibDeflate</span>&nbsp;<span class="op" id="5126981">=</span>&nbsp;<span class="num" id="5126983">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5126986">var</span>&nbsp;<span class="op" id="5126990">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5126993">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127074">ErrChecksum</span>&nbsp;<span class="op" id="5127086">=</span>&nbsp;<span class="ident" id="5127088">errors</span><span class="op" id="5127094">.</span><span class="ident" id="5127095">New</span><span class="op" id="5127098">(</span><span class="string" id="5127099">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="5127123">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5127126">//&nbsp;ErrDictionary&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;dictionary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127211">ErrDictionary</span>&nbsp;<span class="op" id="5127225">=</span>&nbsp;<span class="ident" id="5127227">errors</span><span class="op" id="5127233">.</span><span class="ident" id="5127234">New</span><span class="op" id="5127237">(</span><span class="string" id="5127238">&#34;zlib:&nbsp;invalid&nbsp;dictionary&#34;</span><span class="op" id="5127264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5127267">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127344">ErrHeader</span>&nbsp;<span class="op" id="5127354">=</span>&nbsp;<span class="ident" id="5127356">errors</span><span class="op" id="5127362">.</span><span class="ident" id="5127363">New</span><span class="op" id="5127366">(</span><span class="string" id="5127367">&#34;zlib:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="5127389">)</span><br>
<span class="lineno"></span><span class="op" id="5127391">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="5127394">type</span>&nbsp;<span class="ident" id="5127399">reader</span>&nbsp;<span class="keyword" id="5127406">struct</span>&nbsp;<span class="op" id="5127413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127416">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127429">flate</span><span class="op" id="5127434">.</span><span class="ident" id="5127435">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127443">decompressor</span>&nbsp;<span class="ident" id="5127456">io</span><span class="op" id="5127458">.</span><span class="ident" id="5127459">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127471">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5127484">hash</span><span class="op" id="5127488">.</span><span class="ident" id="5127489">Hash32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127497">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5127510">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127517">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5127530">[</span><span class="num" id="5127531">4</span><span class="op" id="5127532">]</span><span class="builtintype" id="5127533">byte</span><br>
<span class="lineno"></span><span class="op" id="5127538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5127541">//&nbsp;Resetter&nbsp;resets&nbsp;a&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;or&nbsp;NewReaderDict&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="5127615">//&nbsp;to&nbsp;switch&nbsp;to&nbsp;a&nbsp;new&nbsp;underlying&nbsp;Reader.&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;ReadCloser</span><br>
<span class="lineno"></span><span class="comment" id="5127690">//&nbsp;instead&nbsp;of&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="5127726">type</span>&nbsp;<span class="ident" id="5127731">Resetter</span>&nbsp;<span class="keyword" id="5127740">interface</span>&nbsp;<span class="op" id="5127750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5127753">//&nbsp;Reset&nbsp;discards&nbsp;any&nbsp;buffered&nbsp;data&nbsp;and&nbsp;resets&nbsp;the&nbsp;Resetter&nbsp;as&nbsp;if&nbsp;it&nbsp;was</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5127827">//&nbsp;newly&nbsp;initialized&nbsp;with&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5127872">Reset</span><span class="op" id="5127877">(</span><span class="ident" id="5127878">r</span>&nbsp;<span class="ident" id="5127880">io</span><span class="op" id="5127882">.</span><span class="ident" id="5127883">Reader</span><span class="op" id="5127889">,</span>&nbsp;<span class="ident" id="5127891">dict</span>&nbsp;<span class="op" id="5127896">[</span><span class="op" id="5127897">]</span><span class="builtintype" id="5127898">byte</span><span class="op" id="5127902">)</span>&nbsp;<span class="builtintype" id="5127904">error</span><br>
<span class="lineno"></span><span class="op" id="5127910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5127913">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="5127952">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">65</span><span class="comment" id="5128023">//&nbsp;The&nbsp;implementation&nbsp;buffers&nbsp;input&nbsp;and&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5128105">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="comment" id="5128185">//</span><br>
<span class="lineno"></span><span class="comment" id="5128188">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="5128254">func</span>&nbsp;<span class="ident" id="5128259">NewReader</span><span class="op" id="5128268">(</span><span class="ident" id="5128269">r</span>&nbsp;<span class="ident" id="5128271">io</span><span class="op" id="5128273">.</span><span class="ident" id="5128274">Reader</span><span class="op" id="5128280">)</span>&nbsp;<span class="op" id="5128282">(</span><span class="ident" id="5128283">io</span><span class="op" id="5128285">.</span><span class="ident" id="5128286">ReadCloser</span><span class="op" id="5128296">,</span>&nbsp;<span class="builtintype" id="5128298">error</span><span class="op" id="5128303">)</span>&nbsp;<span class="op" id="5128305">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128308">return</span>&nbsp;<span class="ident" id="5128315">NewReaderDict</span><span class="op" id="5128328">(</span><span class="ident" id="5128329">r</span><span class="op" id="5128330">,</span>&nbsp;<span class="ident" id="5128332">nil</span><span class="op" id="5128335">)</span><br>
<span class="lineno"></span><span class="op" id="5128337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5128340">//&nbsp;NewReaderDict&nbsp;is&nbsp;like&nbsp;NewReader&nbsp;but&nbsp;uses&nbsp;a&nbsp;preset&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="comment" id="5128405">//&nbsp;NewReaderDict&nbsp;ignores&nbsp;the&nbsp;dictionary&nbsp;if&nbsp;the&nbsp;compressed&nbsp;data&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;it.</span><br>
<span class="lineno">75</span><span class="comment" id="5128490">//&nbsp;If&nbsp;the&nbsp;compressed&nbsp;data&nbsp;refers&nbsp;to&nbsp;a&nbsp;different&nbsp;dictionary,&nbsp;NewReaderDict&nbsp;returns&nbsp;ErrDictionary.</span><br>
<span class="lineno"></span><span class="comment" id="5128587">//</span><br>
<span class="lineno"></span><span class="comment" id="5128590">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReaderDict&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="5128660">func</span>&nbsp;<span class="ident" id="5128665">NewReaderDict</span><span class="op" id="5128678">(</span><span class="ident" id="5128679">r</span>&nbsp;<span class="ident" id="5128681">io</span><span class="op" id="5128683">.</span><span class="ident" id="5128684">Reader</span><span class="op" id="5128690">,</span>&nbsp;<span class="ident" id="5128692">dict</span>&nbsp;<span class="op" id="5128697">[</span><span class="op" id="5128698">]</span><span class="builtintype" id="5128699">byte</span><span class="op" id="5128703">)</span>&nbsp;<span class="op" id="5128705">(</span><span class="ident" id="5128706">io</span><span class="op" id="5128708">.</span><span class="ident" id="5128709">ReadCloser</span><span class="op" id="5128719">,</span>&nbsp;<span class="builtintype" id="5128721">error</span><span class="op" id="5128726">)</span>&nbsp;<span class="op" id="5128728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128731">z</span>&nbsp;<span class="op" id="5128733">:=</span>&nbsp;<span class="builtinfunc" id="5128736">new</span><span class="op" id="5128739">(</span><span class="ident" id="5128740">reader</span><span class="op" id="5128746">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128749">err</span>&nbsp;<span class="op" id="5128753">:=</span>&nbsp;<span class="ident" id="5128756">z</span><span class="op" id="5128757">.</span><span class="ident" id="5128758">Reset</span><span class="op" id="5128763">(</span><span class="ident" id="5128764">r</span><span class="op" id="5128765">,</span>&nbsp;<span class="ident" id="5128767">dict</span><span class="op" id="5128771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128774">if</span>&nbsp;<span class="ident" id="5128777">err</span>&nbsp;<span class="op" id="5128781">!=</span>&nbsp;<span class="ident" id="5128784">nil</span>&nbsp;<span class="op" id="5128788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128792">return</span>&nbsp;<span class="ident" id="5128799">nil</span><span class="op" id="5128802">,</span>&nbsp;<span class="ident" id="5128804">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5128809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128812">return</span>&nbsp;<span class="ident" id="5128819">z</span><span class="op" id="5128820">,</span>&nbsp;<span class="ident" id="5128822">nil</span><br>
<span class="lineno">85</span><span class="op" id="5128826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5128829">func</span>&nbsp;<span class="op" id="5128834">(</span><span class="ident" id="5128835">z</span>&nbsp;<span class="op" id="5128837">*</span><span class="ident" id="5128838">reader</span><span class="op" id="5128844">)</span>&nbsp;<span class="ident" id="5128846">Read</span><span class="op" id="5128850">(</span><span class="ident" id="5128851">p</span>&nbsp;<span class="op" id="5128853">[</span><span class="op" id="5128854">]</span><span class="builtintype" id="5128855">byte</span><span class="op" id="5128859">)</span>&nbsp;<span class="op" id="5128861">(</span><span class="ident" id="5128862">n</span>&nbsp;<span class="builtintype" id="5128864">int</span><span class="op" id="5128867">,</span>&nbsp;<span class="ident" id="5128869">err</span>&nbsp;<span class="builtintype" id="5128873">error</span><span class="op" id="5128878">)</span>&nbsp;<span class="op" id="5128880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128883">if</span>&nbsp;<span class="ident" id="5128886">z</span><span class="op" id="5128887">.</span><span class="ident" id="5128888">err</span>&nbsp;<span class="op" id="5128892">!=</span>&nbsp;<span class="ident" id="5128895">nil</span>&nbsp;<span class="op" id="5128899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128903">return</span>&nbsp;<span class="num" id="5128910">0</span><span class="op" id="5128911">,</span>&nbsp;<span class="ident" id="5128913">z</span><span class="op" id="5128914">.</span><span class="ident" id="5128915">err</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5128920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128923">if</span>&nbsp;<span class="builtinfunc" id="5128926">len</span><span class="op" id="5128929">(</span><span class="ident" id="5128930">p</span><span class="op" id="5128931">)</span>&nbsp;<span class="op" id="5128933">==</span>&nbsp;<span class="num" id="5128936">0</span>&nbsp;<span class="op" id="5128938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5128942">return</span>&nbsp;<span class="num" id="5128949">0</span><span class="op" id="5128950">,</span>&nbsp;<span class="ident" id="5128952">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5128957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128961">n</span><span class="op" id="5128962">,</span>&nbsp;<span class="ident" id="5128964">err</span>&nbsp;<span class="op" id="5128968">=</span>&nbsp;<span class="ident" id="5128970">z</span><span class="op" id="5128971">.</span><span class="ident" id="5128972">decompressor</span><span class="op" id="5128984">.</span><span class="ident" id="5128985">Read</span><span class="op" id="5128989">(</span><span class="ident" id="5128990">p</span><span class="op" id="5128991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5128994">z</span><span class="op" id="5128995">.</span><span class="ident" id="5128996">digest</span><span class="op" id="5129002">.</span><span class="ident" id="5129003">Write</span><span class="op" id="5129008">(</span><span class="ident" id="5129009">p</span><span class="op" id="5129010">[</span><span class="num" id="5129011">0</span><span class="op" id="5129012">:</span><span class="ident" id="5129013">n</span><span class="op" id="5129014">]</span><span class="op" id="5129015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129018">if</span>&nbsp;<span class="ident" id="5129021">n</span>&nbsp;<span class="op" id="5129023">!=</span>&nbsp;<span class="num" id="5129026">0</span>&nbsp;<span class="op" id="5129028">||</span>&nbsp;<span class="ident" id="5129031">err</span>&nbsp;<span class="op" id="5129035">!=</span>&nbsp;<span class="ident" id="5129038">io</span><span class="op" id="5129040">.</span><span class="ident" id="5129041">EOF</span>&nbsp;<span class="op" id="5129045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129049">z</span><span class="op" id="5129050">.</span><span class="ident" id="5129051">err</span>&nbsp;<span class="op" id="5129055">=</span>&nbsp;<span class="ident" id="5129057">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129063">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129075">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129110">if</span>&nbsp;<span class="ident" id="5129113">_</span><span class="op" id="5129114">,</span>&nbsp;<span class="ident" id="5129116">err</span>&nbsp;<span class="op" id="5129120">:=</span>&nbsp;<span class="ident" id="5129123">io</span><span class="op" id="5129125">.</span><span class="ident" id="5129126">ReadFull</span><span class="op" id="5129134">(</span><span class="ident" id="5129135">z</span><span class="op" id="5129136">.</span><span class="ident" id="5129137">r</span><span class="op" id="5129138">,</span>&nbsp;<span class="ident" id="5129140">z</span><span class="op" id="5129141">.</span><span class="ident" id="5129142">scratch</span><span class="op" id="5129149">[</span><span class="num" id="5129150">0</span><span class="op" id="5129151">:</span><span class="num" id="5129152">4</span><span class="op" id="5129153">]</span><span class="op" id="5129154">)</span><span class="op" id="5129155">;</span>&nbsp;<span class="ident" id="5129157">err</span>&nbsp;<span class="op" id="5129161">!=</span>&nbsp;<span class="ident" id="5129164">nil</span>&nbsp;<span class="op" id="5129168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129172">z</span><span class="op" id="5129173">.</span><span class="ident" id="5129174">err</span>&nbsp;<span class="op" id="5129178">=</span>&nbsp;<span class="ident" id="5129180">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129186">return</span>&nbsp;<span class="num" id="5129193">0</span><span class="op" id="5129194">,</span>&nbsp;<span class="ident" id="5129196">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129204">//&nbsp;ZLIB&nbsp;(RFC&nbsp;1950)&nbsp;is&nbsp;big-endian,&nbsp;unlike&nbsp;GZIP&nbsp;(RFC&nbsp;1952).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129263">checksum</span>&nbsp;<span class="op" id="5129272">:=</span>&nbsp;<span class="builtintype" id="5129275">uint32</span><span class="op" id="5129281">(</span><span class="ident" id="5129282">z</span><span class="op" id="5129283">.</span><span class="ident" id="5129284">scratch</span><span class="op" id="5129291">[</span><span class="num" id="5129292">0</span><span class="op" id="5129293">]</span><span class="op" id="5129294">)</span><span class="op" id="5129295">&lt;&lt;</span><span class="num" id="5129297">24</span>&nbsp;<span class="op" id="5129300">|</span>&nbsp;<span class="builtintype" id="5129302">uint32</span><span class="op" id="5129308">(</span><span class="ident" id="5129309">z</span><span class="op" id="5129310">.</span><span class="ident" id="5129311">scratch</span><span class="op" id="5129318">[</span><span class="num" id="5129319">1</span><span class="op" id="5129320">]</span><span class="op" id="5129321">)</span><span class="op" id="5129322">&lt;&lt;</span><span class="num" id="5129324">16</span>&nbsp;<span class="op" id="5129327">|</span>&nbsp;<span class="builtintype" id="5129329">uint32</span><span class="op" id="5129335">(</span><span class="ident" id="5129336">z</span><span class="op" id="5129337">.</span><span class="ident" id="5129338">scratch</span><span class="op" id="5129345">[</span><span class="num" id="5129346">2</span><span class="op" id="5129347">]</span><span class="op" id="5129348">)</span><span class="op" id="5129349">&lt;&lt;</span><span class="num" id="5129351">8</span>&nbsp;<span class="op" id="5129353">|</span>&nbsp;<span class="builtintype" id="5129355">uint32</span><span class="op" id="5129361">(</span><span class="ident" id="5129362">z</span><span class="op" id="5129363">.</span><span class="ident" id="5129364">scratch</span><span class="op" id="5129371">[</span><span class="num" id="5129372">3</span><span class="op" id="5129373">]</span><span class="op" id="5129374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129377">if</span>&nbsp;<span class="ident" id="5129380">checksum</span>&nbsp;<span class="op" id="5129389">!=</span>&nbsp;<span class="ident" id="5129392">z</span><span class="op" id="5129393">.</span><span class="ident" id="5129394">digest</span><span class="op" id="5129400">.</span><span class="ident" id="5129401">Sum32</span><span class="op" id="5129406">(</span><span class="op" id="5129407">)</span>&nbsp;<span class="op" id="5129409">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129413">z</span><span class="op" id="5129414">.</span><span class="ident" id="5129415">err</span>&nbsp;<span class="op" id="5129419">=</span>&nbsp;<span class="ident" id="5129421">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129435">return</span>&nbsp;<span class="num" id="5129442">0</span><span class="op" id="5129443">,</span>&nbsp;<span class="ident" id="5129445">z</span><span class="op" id="5129446">.</span><span class="ident" id="5129447">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129455">return</span><br>
<span class="lineno"></span><span class="op" id="5129462">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="5129465">//&nbsp;Calling&nbsp;Close&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;wrapped&nbsp;io.Reader&nbsp;originally&nbsp;passed&nbsp;to&nbsp;NewReader.</span><br>
<span class="lineno"></span><span class="keyword" id="5129551">func</span>&nbsp;<span class="op" id="5129556">(</span><span class="ident" id="5129557">z</span>&nbsp;<span class="op" id="5129559">*</span><span class="ident" id="5129560">reader</span><span class="op" id="5129566">)</span>&nbsp;<span class="ident" id="5129568">Close</span><span class="op" id="5129573">(</span><span class="op" id="5129574">)</span>&nbsp;<span class="builtintype" id="5129576">error</span>&nbsp;<span class="op" id="5129582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129585">if</span>&nbsp;<span class="ident" id="5129588">z</span><span class="op" id="5129589">.</span><span class="ident" id="5129590">err</span>&nbsp;<span class="op" id="5129594">!=</span>&nbsp;<span class="ident" id="5129597">nil</span>&nbsp;<span class="op" id="5129601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129605">return</span>&nbsp;<span class="ident" id="5129612">z</span><span class="op" id="5129613">.</span><span class="ident" id="5129614">err</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129622">z</span><span class="op" id="5129623">.</span><span class="ident" id="5129624">err</span>&nbsp;<span class="op" id="5129628">=</span>&nbsp;<span class="ident" id="5129630">z</span><span class="op" id="5129631">.</span><span class="ident" id="5129632">decompressor</span><span class="op" id="5129644">.</span><span class="ident" id="5129645">Close</span><span class="op" id="5129650">(</span><span class="op" id="5129651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129654">return</span>&nbsp;<span class="ident" id="5129661">z</span><span class="op" id="5129662">.</span><span class="ident" id="5129663">err</span><br>
<span class="lineno"></span><span class="op" id="5129667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="5129670">func</span>&nbsp;<span class="op" id="5129675">(</span><span class="ident" id="5129676">z</span>&nbsp;<span class="op" id="5129678">*</span><span class="ident" id="5129679">reader</span><span class="op" id="5129685">)</span>&nbsp;<span class="ident" id="5129687">Reset</span><span class="op" id="5129692">(</span><span class="ident" id="5129693">r</span>&nbsp;<span class="ident" id="5129695">io</span><span class="op" id="5129697">.</span><span class="ident" id="5129698">Reader</span><span class="op" id="5129704">,</span>&nbsp;<span class="ident" id="5129706">dict</span>&nbsp;<span class="op" id="5129711">[</span><span class="op" id="5129712">]</span><span class="builtintype" id="5129713">byte</span><span class="op" id="5129717">)</span>&nbsp;<span class="builtintype" id="5129719">error</span>&nbsp;<span class="op" id="5129725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129728">if</span>&nbsp;<span class="ident" id="5129731">fr</span><span class="op" id="5129733">,</span>&nbsp;<span class="ident" id="5129735">ok</span>&nbsp;<span class="op" id="5129738">:=</span>&nbsp;<span class="ident" id="5129741">r</span><span class="op" id="5129742">.</span><span class="op" id="5129743">(</span><span class="ident" id="5129744">flate</span><span class="op" id="5129749">.</span><span class="ident" id="5129750">Reader</span><span class="op" id="5129756">)</span><span class="op" id="5129757">;</span>&nbsp;<span class="ident" id="5129759">ok</span>&nbsp;<span class="op" id="5129762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129766">z</span><span class="op" id="5129767">.</span><span class="ident" id="5129768">r</span>&nbsp;<span class="op" id="5129770">=</span>&nbsp;<span class="ident" id="5129772">fr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129776">}</span>&nbsp;<span class="keyword" id="5129778">else</span>&nbsp;<span class="op" id="5129783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129787">z</span><span class="op" id="5129788">.</span><span class="ident" id="5129789">r</span>&nbsp;<span class="op" id="5129791">=</span>&nbsp;<span class="ident" id="5129793">bufio</span><span class="op" id="5129798">.</span><span class="ident" id="5129799">NewReader</span><span class="op" id="5129808">(</span><span class="ident" id="5129809">r</span><span class="op" id="5129810">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129816">_</span><span class="op" id="5129817">,</span>&nbsp;<span class="ident" id="5129819">err</span>&nbsp;<span class="op" id="5129823">:=</span>&nbsp;<span class="ident" id="5129826">io</span><span class="op" id="5129828">.</span><span class="ident" id="5129829">ReadFull</span><span class="op" id="5129837">(</span><span class="ident" id="5129838">z</span><span class="op" id="5129839">.</span><span class="ident" id="5129840">r</span><span class="op" id="5129841">,</span>&nbsp;<span class="ident" id="5129843">z</span><span class="op" id="5129844">.</span><span class="ident" id="5129845">scratch</span><span class="op" id="5129852">[</span><span class="num" id="5129853">0</span><span class="op" id="5129854">:</span><span class="num" id="5129855">2</span><span class="op" id="5129856">]</span><span class="op" id="5129857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129860">if</span>&nbsp;<span class="ident" id="5129863">err</span>&nbsp;<span class="op" id="5129867">!=</span>&nbsp;<span class="ident" id="5129870">nil</span>&nbsp;<span class="op" id="5129874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129878">return</span>&nbsp;<span class="ident" id="5129885">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129890">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129893">h</span>&nbsp;<span class="op" id="5129895">:=</span>&nbsp;<span class="builtintype" id="5129898">uint</span><span class="op" id="5129902">(</span><span class="ident" id="5129903">z</span><span class="op" id="5129904">.</span><span class="ident" id="5129905">scratch</span><span class="op" id="5129912">[</span><span class="num" id="5129913">0</span><span class="op" id="5129914">]</span><span class="op" id="5129915">)</span><span class="op" id="5129916">&lt;&lt;</span><span class="num" id="5129918">8</span>&nbsp;<span class="op" id="5129920">|</span>&nbsp;<span class="builtintype" id="5129922">uint</span><span class="op" id="5129926">(</span><span class="ident" id="5129927">z</span><span class="op" id="5129928">.</span><span class="ident" id="5129929">scratch</span><span class="op" id="5129936">[</span><span class="num" id="5129937">1</span><span class="op" id="5129938">]</span><span class="op" id="5129939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129942">if</span>&nbsp;<span class="op" id="5129945">(</span><span class="ident" id="5129946">z</span><span class="op" id="5129947">.</span><span class="ident" id="5129948">scratch</span><span class="op" id="5129955">[</span><span class="num" id="5129956">0</span><span class="op" id="5129957">]</span><span class="op" id="5129958">&amp;</span><span class="num" id="5129959">0x0f</span>&nbsp;<span class="op" id="5129964">!=</span>&nbsp;<span class="ident" id="5129967">zlibDeflate</span><span class="op" id="5129978">)</span>&nbsp;<span class="op" id="5129980">||</span>&nbsp;<span class="op" id="5129983">(</span><span class="ident" id="5129984">h</span><span class="op" id="5129985">%</span><span class="num" id="5129986">31</span>&nbsp;<span class="op" id="5129989">!=</span>&nbsp;<span class="num" id="5129992">0</span><span class="op" id="5129993">)</span>&nbsp;<span class="op" id="5129995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129999">return</span>&nbsp;<span class="ident" id="5130006">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130020">haveDict</span>&nbsp;<span class="op" id="5130029">:=</span>&nbsp;<span class="ident" id="5130032">z</span><span class="op" id="5130033">.</span><span class="ident" id="5130034">scratch</span><span class="op" id="5130041">[</span><span class="num" id="5130042">1</span><span class="op" id="5130043">]</span><span class="op" id="5130044">&amp;</span><span class="num" id="5130045">0x20</span>&nbsp;<span class="op" id="5130050">!=</span>&nbsp;<span class="num" id="5130053">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130056">if</span>&nbsp;<span class="ident" id="5130059">haveDict</span>&nbsp;<span class="op" id="5130068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130072">_</span><span class="op" id="5130073">,</span>&nbsp;<span class="ident" id="5130075">err</span>&nbsp;<span class="op" id="5130079">=</span>&nbsp;<span class="ident" id="5130081">io</span><span class="op" id="5130083">.</span><span class="ident" id="5130084">ReadFull</span><span class="op" id="5130092">(</span><span class="ident" id="5130093">z</span><span class="op" id="5130094">.</span><span class="ident" id="5130095">r</span><span class="op" id="5130096">,</span>&nbsp;<span class="ident" id="5130098">z</span><span class="op" id="5130099">.</span><span class="ident" id="5130100">scratch</span><span class="op" id="5130107">[</span><span class="num" id="5130108">0</span><span class="op" id="5130109">:</span><span class="num" id="5130110">4</span><span class="op" id="5130111">]</span><span class="op" id="5130112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130116">if</span>&nbsp;<span class="ident" id="5130119">err</span>&nbsp;<span class="op" id="5130123">!=</span>&nbsp;<span class="ident" id="5130126">nil</span>&nbsp;<span class="op" id="5130130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130135">return</span>&nbsp;<span class="ident" id="5130142">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130148">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130152">checksum</span>&nbsp;<span class="op" id="5130161">:=</span>&nbsp;<span class="builtintype" id="5130164">uint32</span><span class="op" id="5130170">(</span><span class="ident" id="5130171">z</span><span class="op" id="5130172">.</span><span class="ident" id="5130173">scratch</span><span class="op" id="5130180">[</span><span class="num" id="5130181">0</span><span class="op" id="5130182">]</span><span class="op" id="5130183">)</span><span class="op" id="5130184">&lt;&lt;</span><span class="num" id="5130186">24</span>&nbsp;<span class="op" id="5130189">|</span>&nbsp;<span class="builtintype" id="5130191">uint32</span><span class="op" id="5130197">(</span><span class="ident" id="5130198">z</span><span class="op" id="5130199">.</span><span class="ident" id="5130200">scratch</span><span class="op" id="5130207">[</span><span class="num" id="5130208">1</span><span class="op" id="5130209">]</span><span class="op" id="5130210">)</span><span class="op" id="5130211">&lt;&lt;</span><span class="num" id="5130213">16</span>&nbsp;<span class="op" id="5130216">|</span>&nbsp;<span class="builtintype" id="5130218">uint32</span><span class="op" id="5130224">(</span><span class="ident" id="5130225">z</span><span class="op" id="5130226">.</span><span class="ident" id="5130227">scratch</span><span class="op" id="5130234">[</span><span class="num" id="5130235">2</span><span class="op" id="5130236">]</span><span class="op" id="5130237">)</span><span class="op" id="5130238">&lt;&lt;</span><span class="num" id="5130240">8</span>&nbsp;<span class="op" id="5130242">|</span>&nbsp;<span class="builtintype" id="5130244">uint32</span><span class="op" id="5130250">(</span><span class="ident" id="5130251">z</span><span class="op" id="5130252">.</span><span class="ident" id="5130253">scratch</span><span class="op" id="5130260">[</span><span class="num" id="5130261">3</span><span class="op" id="5130262">]</span><span class="op" id="5130263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130267">if</span>&nbsp;<span class="ident" id="5130270">checksum</span>&nbsp;<span class="op" id="5130279">!=</span>&nbsp;<span class="ident" id="5130282">adler32</span><span class="op" id="5130289">.</span><span class="ident" id="5130290">Checksum</span><span class="op" id="5130298">(</span><span class="ident" id="5130299">dict</span><span class="op" id="5130303">)</span>&nbsp;<span class="op" id="5130305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130310">return</span>&nbsp;<span class="ident" id="5130317">ErrDictionary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130336">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130339">if</span>&nbsp;<span class="ident" id="5130342">z</span><span class="op" id="5130343">.</span><span class="ident" id="5130344">decompressor</span>&nbsp;<span class="op" id="5130357">==</span>&nbsp;<span class="ident" id="5130360">nil</span>&nbsp;<span class="op" id="5130364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130368">if</span>&nbsp;<span class="ident" id="5130371">haveDict</span>&nbsp;<span class="op" id="5130380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130385">z</span><span class="op" id="5130386">.</span><span class="ident" id="5130387">decompressor</span>&nbsp;<span class="op" id="5130400">=</span>&nbsp;<span class="ident" id="5130402">flate</span><span class="op" id="5130407">.</span><span class="ident" id="5130408">NewReaderDict</span><span class="op" id="5130421">(</span><span class="ident" id="5130422">z</span><span class="op" id="5130423">.</span><span class="ident" id="5130424">r</span><span class="op" id="5130425">,</span>&nbsp;<span class="ident" id="5130427">dict</span><span class="op" id="5130431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130435">}</span>&nbsp;<span class="keyword" id="5130437">else</span>&nbsp;<span class="op" id="5130442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130447">z</span><span class="op" id="5130448">.</span><span class="ident" id="5130449">decompressor</span>&nbsp;<span class="op" id="5130462">=</span>&nbsp;<span class="ident" id="5130464">flate</span><span class="op" id="5130469">.</span><span class="ident" id="5130470">NewReader</span><span class="op" id="5130479">(</span><span class="ident" id="5130480">z</span><span class="op" id="5130481">.</span><span class="ident" id="5130482">r</span><span class="op" id="5130483">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130490">}</span>&nbsp;<span class="keyword" id="5130492">else</span>&nbsp;<span class="op" id="5130497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130501">z</span><span class="op" id="5130502">.</span><span class="ident" id="5130503">decompressor</span><span class="op" id="5130515">.</span><span class="op" id="5130516">(</span><span class="ident" id="5130517">flate</span><span class="op" id="5130522">.</span><span class="ident" id="5130523">Resetter</span><span class="op" id="5130531">)</span><span class="op" id="5130532">.</span><span class="ident" id="5130533">Reset</span><span class="op" id="5130538">(</span><span class="ident" id="5130539">z</span><span class="op" id="5130540">.</span><span class="ident" id="5130541">r</span><span class="op" id="5130542">,</span>&nbsp;<span class="ident" id="5130544">dict</span><span class="op" id="5130548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5130551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5130554">z</span><span class="op" id="5130555">.</span><span class="ident" id="5130556">digest</span>&nbsp;<span class="op" id="5130563">=</span>&nbsp;<span class="ident" id="5130565">adler32</span><span class="op" id="5130572">.</span><span class="ident" id="5130573">New</span><span class="op" id="5130576">(</span><span class="op" id="5130577">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5130580">return</span>&nbsp;<span class="ident" id="5130587">nil</span><br>
<span class="lineno"></span><span class="op" id="5130591">}</span>
</div>
</body>
</html>
