<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4267758">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4267813">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4267867">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4267918">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4267978">package</span>&nbsp;<span class="ident" id="4267986">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4267992">import</span>&nbsp;<span class="op" id="4267999">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268002">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268011">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268021">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268035">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268051">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268070">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268084">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268099">_</span>&nbsp;<span class="string" id="4268101">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268118">_</span>&nbsp;<span class="string" id="4268120">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268137">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268157">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268174">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268190">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268200">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268206">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268218">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268225">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4268236">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4268243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4268246">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4268326">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4268342">type</span>&nbsp;<span class="ident" id="4268347">pkixPublicKey</span>&nbsp;<span class="keyword" id="4268361">struct</span>&nbsp;<span class="op" id="4268368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268371">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268381">pkix</span><span class="op" id="4268385">.</span><span class="ident" id="4268386">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268407">BitString</span>&nbsp;<span class="ident" id="4268417">asn1</span><span class="op" id="4268421">.</span><span class="ident" id="4268422">BitString</span><br>
<span class="lineno"></span><span class="op" id="4268432">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4268435">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4268507">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4268565">func</span>&nbsp;<span class="ident" id="4268570">ParsePKIXPublicKey</span><span class="op" id="4268588">(</span><span class="ident" id="4268589">derBytes</span>&nbsp;<span class="op" id="4268598">[</span><span class="op" id="4268599">]</span><span class="builtintype" id="4268600">byte</span><span class="op" id="4268604">)</span>&nbsp;<span class="op" id="4268606">(</span><span class="ident" id="4268607">pub</span>&nbsp;<span class="keyword" id="4268611">interface</span><span class="op" id="4268620">{</span><span class="op" id="4268621">}</span><span class="op" id="4268622">,</span>&nbsp;<span class="ident" id="4268624">err</span>&nbsp;<span class="builtintype" id="4268628">error</span><span class="op" id="4268633">)</span>&nbsp;<span class="op" id="4268635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268638">var</span>&nbsp;<span class="ident" id="4268642">pki</span>&nbsp;<span class="ident" id="4268646">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268661">if</span>&nbsp;<span class="ident" id="4268664">_</span><span class="op" id="4268665">,</span>&nbsp;<span class="ident" id="4268667">err</span>&nbsp;<span class="op" id="4268671">=</span>&nbsp;<span class="ident" id="4268673">asn1</span><span class="op" id="4268677">.</span><span class="ident" id="4268678">Unmarshal</span><span class="op" id="4268687">(</span><span class="ident" id="4268688">derBytes</span><span class="op" id="4268696">,</span>&nbsp;<span class="op" id="4268698">&amp;</span><span class="ident" id="4268699">pki</span><span class="op" id="4268702">)</span><span class="op" id="4268703">;</span>&nbsp;<span class="ident" id="4268705">err</span>&nbsp;<span class="op" id="4268709">!=</span>&nbsp;<span class="ident" id="4268712">nil</span>&nbsp;<span class="op" id="4268716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268720">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4268731">algo</span>&nbsp;<span class="op" id="4268736">:=</span>&nbsp;<span class="ident" id="4268739">getPublicKeyAlgorithmFromOID</span><span class="op" id="4268767">(</span><span class="ident" id="4268768">pki</span><span class="op" id="4268771">.</span><span class="ident" id="4268772">Algorithm</span><span class="op" id="4268781">.</span><span class="ident" id="4268782">Algorithm</span><span class="op" id="4268791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268794">if</span>&nbsp;<span class="ident" id="4268797">algo</span>&nbsp;<span class="op" id="4268802">==</span>&nbsp;<span class="ident" id="4268805">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4268831">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268835">return</span>&nbsp;<span class="ident" id="4268842">nil</span><span class="op" id="4268845">,</span>&nbsp;<span class="ident" id="4268847">errors</span><span class="op" id="4268853">.</span><span class="ident" id="4268854">New</span><span class="op" id="4268857">(</span><span class="string" id="4268858">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4268894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4268897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4268900">return</span>&nbsp;<span class="ident" id="4268907">parsePublicKey</span><span class="op" id="4268921">(</span><span class="ident" id="4268922">algo</span><span class="op" id="4268926">,</span>&nbsp;<span class="op" id="4268928">&amp;</span><span class="ident" id="4268929">pki</span><span class="op" id="4268932">)</span><br>
<span class="lineno"></span><span class="op" id="4268934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4268937">func</span>&nbsp;<span class="ident" id="4268942">marshalPublicKey</span><span class="op" id="4268958">(</span><span class="ident" id="4268959">pub</span>&nbsp;<span class="keyword" id="4268963">interface</span><span class="op" id="4268972">{</span><span class="op" id="4268973">}</span><span class="op" id="4268974">)</span>&nbsp;<span class="op" id="4268976">(</span><span class="ident" id="4268977">publicKeyBytes</span>&nbsp;<span class="op" id="4268992">[</span><span class="op" id="4268993">]</span><span class="builtintype" id="4268994">byte</span><span class="op" id="4268998">,</span>&nbsp;<span class="ident" id="4269000">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4269019">pkix</span><span class="op" id="4269023">.</span><span class="ident" id="4269024">AlgorithmIdentifier</span><span class="op" id="4269043">,</span>&nbsp;<span class="ident" id="4269045">err</span>&nbsp;<span class="builtintype" id="4269049">error</span><span class="op" id="4269054">)</span>&nbsp;<span class="op" id="4269056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269059">switch</span>&nbsp;<span class="ident" id="4269066">pub</span>&nbsp;<span class="op" id="4269070">:=</span>&nbsp;<span class="ident" id="4269073">pub</span><span class="op" id="4269076">.</span><span class="op" id="4269077">(</span><span class="keyword" id="4269078">type</span><span class="op" id="4269082">)</span>&nbsp;<span class="op" id="4269084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269087">case</span>&nbsp;<span class="op" id="4269092">*</span><span class="ident" id="4269093">rsa</span><span class="op" id="4269096">.</span><span class="ident" id="4269097">PublicKey</span><span class="op" id="4269106">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269110">publicKeyBytes</span><span class="op" id="4269124">,</span>&nbsp;<span class="ident" id="4269126">err</span>&nbsp;<span class="op" id="4269130">=</span>&nbsp;<span class="ident" id="4269132">asn1</span><span class="op" id="4269136">.</span><span class="ident" id="4269137">Marshal</span><span class="op" id="4269144">(</span><span class="ident" id="4269145">rsaPublicKey</span><span class="op" id="4269157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269162">N</span><span class="op" id="4269163">:</span>&nbsp;<span class="ident" id="4269165">pub</span><span class="op" id="4269168">.</span><span class="ident" id="4269169">N</span><span class="op" id="4269170">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269175">E</span><span class="op" id="4269176">:</span>&nbsp;<span class="ident" id="4269178">pub</span><span class="op" id="4269181">.</span><span class="ident" id="4269182">E</span><span class="op" id="4269183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269187">}</span><span class="op" id="4269188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269192">publicKeyAlgorithm</span><span class="op" id="4269210">.</span><span class="ident" id="4269211">Algorithm</span>&nbsp;<span class="op" id="4269221">=</span>&nbsp;<span class="ident" id="4269223">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4269241">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4269299">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4269357">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269408">publicKeyAlgorithm</span><span class="op" id="4269426">.</span><span class="ident" id="4269427">Parameters</span>&nbsp;<span class="op" id="4269438">=</span>&nbsp;<span class="ident" id="4269440">asn1</span><span class="op" id="4269444">.</span><span class="ident" id="4269445">RawValue</span><span class="op" id="4269453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269458">Tag</span><span class="op" id="4269461">:</span>&nbsp;<span class="num" id="4269463">5</span><span class="op" id="4269464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269471">case</span>&nbsp;<span class="op" id="4269476">*</span><span class="ident" id="4269477">ecdsa</span><span class="op" id="4269482">.</span><span class="ident" id="4269483">PublicKey</span><span class="op" id="4269492">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269496">publicKeyBytes</span>&nbsp;<span class="op" id="4269511">=</span>&nbsp;<span class="ident" id="4269513">elliptic</span><span class="op" id="4269521">.</span><span class="ident" id="4269522">Marshal</span><span class="op" id="4269529">(</span><span class="ident" id="4269530">pub</span><span class="op" id="4269533">.</span><span class="ident" id="4269534">Curve</span><span class="op" id="4269539">,</span>&nbsp;<span class="ident" id="4269541">pub</span><span class="op" id="4269544">.</span><span class="ident" id="4269545">X</span><span class="op" id="4269546">,</span>&nbsp;<span class="ident" id="4269548">pub</span><span class="op" id="4269551">.</span><span class="ident" id="4269552">Y</span><span class="op" id="4269553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269557">oid</span><span class="op" id="4269560">,</span>&nbsp;<span class="ident" id="4269562">ok</span>&nbsp;<span class="op" id="4269565">:=</span>&nbsp;<span class="ident" id="4269568">oidFromNamedCurve</span><span class="op" id="4269585">(</span><span class="ident" id="4269586">pub</span><span class="op" id="4269589">.</span><span class="ident" id="4269590">Curve</span><span class="op" id="4269595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269599">if</span>&nbsp;<span class="op" id="4269602">!</span><span class="ident" id="4269603">ok</span>&nbsp;<span class="op" id="4269606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269611">return</span>&nbsp;<span class="ident" id="4269618">nil</span><span class="op" id="4269621">,</span>&nbsp;<span class="ident" id="4269623">pkix</span><span class="op" id="4269627">.</span><span class="ident" id="4269628">AlgorithmIdentifier</span><span class="op" id="4269647">{</span><span class="op" id="4269648">}</span><span class="op" id="4269649">,</span>&nbsp;<span class="ident" id="4269651">errors</span><span class="op" id="4269657">.</span><span class="ident" id="4269658">New</span><span class="op" id="4269661">(</span><span class="string" id="4269662">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4269696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269700">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269704">publicKeyAlgorithm</span><span class="op" id="4269722">.</span><span class="ident" id="4269723">Algorithm</span>&nbsp;<span class="op" id="4269733">=</span>&nbsp;<span class="ident" id="4269735">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269755">var</span>&nbsp;<span class="ident" id="4269759">paramBytes</span>&nbsp;<span class="op" id="4269770">[</span><span class="op" id="4269771">]</span><span class="builtintype" id="4269772">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269779">paramBytes</span><span class="op" id="4269789">,</span>&nbsp;<span class="ident" id="4269791">err</span>&nbsp;<span class="op" id="4269795">=</span>&nbsp;<span class="ident" id="4269797">asn1</span><span class="op" id="4269801">.</span><span class="ident" id="4269802">Marshal</span><span class="op" id="4269809">(</span><span class="ident" id="4269810">oid</span><span class="op" id="4269813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269817">if</span>&nbsp;<span class="ident" id="4269820">err</span>&nbsp;<span class="op" id="4269824">!=</span>&nbsp;<span class="ident" id="4269827">nil</span>&nbsp;<span class="op" id="4269831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269836">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4269845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4269849">publicKeyAlgorithm</span><span class="op" id="4269867">.</span><span class="ident" id="4269868">Parameters</span><span class="op" id="4269878">.</span><span class="ident" id="4269879">FullBytes</span>&nbsp;<span class="op" id="4269889">=</span>&nbsp;<span class="ident" id="4269891">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269903">default</span><span class="op" id="4269910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4269914">return</span>&nbsp;<span class="ident" id="4269921">nil</span><span class="op" id="4269924">,</span>&nbsp;<span class="ident" id="4269926">pkix</span><span class="op" id="4269930">.</span><span class="ident" id="4269931">AlgorithmIdentifier</span><span class="op" id="4269950">{</span><span class="op" id="4269951">}</span><span class="op" id="4269952">,</span>&nbsp;<span class="ident" id="4269954">errors</span><span class="op" id="4269960">.</span><span class="ident" id="4269961">New</span><span class="op" id="4269964">(</span><span class="string" id="4269965">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4270013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270016">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270020">return</span>&nbsp;<span class="ident" id="4270027">publicKeyBytes</span><span class="op" id="4270041">,</span>&nbsp;<span class="ident" id="4270043">publicKeyAlgorithm</span><span class="op" id="4270061">,</span>&nbsp;<span class="ident" id="4270063">nil</span><br>
<span class="lineno"></span><span class="op" id="4270067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4270070">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4270146">func</span>&nbsp;<span class="ident" id="4270151">MarshalPKIXPublicKey</span><span class="op" id="4270171">(</span><span class="ident" id="4270172">pub</span>&nbsp;<span class="keyword" id="4270176">interface</span><span class="op" id="4270185">{</span><span class="op" id="4270186">}</span><span class="op" id="4270187">)</span>&nbsp;<span class="op" id="4270189">(</span><span class="op" id="4270190">[</span><span class="op" id="4270191">]</span><span class="builtintype" id="4270192">byte</span><span class="op" id="4270196">,</span>&nbsp;<span class="builtintype" id="4270198">error</span><span class="op" id="4270203">)</span>&nbsp;<span class="op" id="4270205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270208">var</span>&nbsp;<span class="ident" id="4270212">publicKeyBytes</span>&nbsp;<span class="op" id="4270227">[</span><span class="op" id="4270228">]</span><span class="builtintype" id="4270229">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270235">var</span>&nbsp;<span class="ident" id="4270239">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4270258">pkix</span><span class="op" id="4270262">.</span><span class="ident" id="4270263">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270284">var</span>&nbsp;<span class="ident" id="4270288">err</span>&nbsp;<span class="builtintype" id="4270292">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270300">if</span>&nbsp;<span class="ident" id="4270303">publicKeyBytes</span><span class="op" id="4270317">,</span>&nbsp;<span class="ident" id="4270319">publicKeyAlgorithm</span><span class="op" id="4270337">,</span>&nbsp;<span class="ident" id="4270339">err</span>&nbsp;<span class="op" id="4270343">=</span>&nbsp;<span class="ident" id="4270345">marshalPublicKey</span><span class="op" id="4270361">(</span><span class="ident" id="4270362">pub</span><span class="op" id="4270365">)</span><span class="op" id="4270366">;</span>&nbsp;<span class="ident" id="4270368">err</span>&nbsp;<span class="op" id="4270372">!=</span>&nbsp;<span class="ident" id="4270375">nil</span>&nbsp;<span class="op" id="4270379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270383">return</span>&nbsp;<span class="ident" id="4270390">nil</span><span class="op" id="4270393">,</span>&nbsp;<span class="ident" id="4270395">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270404">pkix</span>&nbsp;<span class="op" id="4270409">:=</span>&nbsp;<span class="ident" id="4270412">pkixPublicKey</span><span class="op" id="4270425">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270429">Algo</span><span class="op" id="4270433">:</span>&nbsp;<span class="ident" id="4270435">publicKeyAlgorithm</span><span class="op" id="4270453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270457">BitString</span><span class="op" id="4270466">:</span>&nbsp;<span class="ident" id="4270468">asn1</span><span class="op" id="4270472">.</span><span class="ident" id="4270473">BitString</span><span class="op" id="4270482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270487">Bytes</span><span class="op" id="4270492">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270498">publicKeyBytes</span><span class="op" id="4270512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270517">BitLength</span><span class="op" id="4270526">:</span>&nbsp;<span class="num" id="4270528">8</span>&nbsp;<span class="op" id="4270530">*</span>&nbsp;<span class="builtinfunc" id="4270532">len</span><span class="op" id="4270535">(</span><span class="ident" id="4270536">publicKeyBytes</span><span class="op" id="4270550">)</span><span class="op" id="4270551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270555">}</span><span class="op" id="4270556">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4270559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270563">ret</span><span class="op" id="4270566">,</span>&nbsp;<span class="ident" id="4270568">_</span>&nbsp;<span class="op" id="4270570">:=</span>&nbsp;<span class="ident" id="4270573">asn1</span><span class="op" id="4270577">.</span><span class="ident" id="4270578">Marshal</span><span class="op" id="4270585">(</span><span class="ident" id="4270586">pkix</span><span class="op" id="4270590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4270593">return</span>&nbsp;<span class="ident" id="4270600">ret</span><span class="op" id="4270603">,</span>&nbsp;<span class="ident" id="4270605">nil</span><br>
<span class="lineno"></span><span class="op" id="4270609">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4270612">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4270685">type</span>&nbsp;<span class="ident" id="4270690">certificate</span>&nbsp;<span class="keyword" id="4270702">struct</span>&nbsp;<span class="op" id="4270709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270712">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270731">asn1</span><span class="op" id="4270735">.</span><span class="ident" id="4270736">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270748">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270767">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270783">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4270802">pkix</span><span class="op" id="4270806">.</span><span class="ident" id="4270807">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270828">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270847">asn1</span><span class="op" id="4270851">.</span><span class="ident" id="4270852">BitString</span><br>
<span class="lineno"></span><span class="op" id="4270862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4270865">type</span>&nbsp;<span class="ident" id="4270870">tbsCertificate</span>&nbsp;<span class="keyword" id="4270885">struct</span>&nbsp;<span class="op" id="4270892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270895">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270914">asn1</span><span class="op" id="4270918">.</span><span class="ident" id="4270919">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270931">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4270950">int</span>&nbsp;<span class="string" id="4270954">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4270998">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4271017">*</span><span class="ident" id="4271018">big</span><span class="op" id="4271021">.</span><span class="ident" id="4271022">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271027">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4271046">pkix</span><span class="op" id="4271050">.</span><span class="ident" id="4271051">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271072">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271091">asn1</span><span class="op" id="4271095">.</span><span class="ident" id="4271096">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271106">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271125">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271135">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271154">asn1</span><span class="op" id="4271158">.</span><span class="ident" id="4271159">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271169">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271188">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271203">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271222">asn1</span><span class="op" id="4271226">.</span><span class="ident" id="4271227">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4271239">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271264">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271283">asn1</span><span class="op" id="4271287">.</span><span class="ident" id="4271288">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4271300">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271325">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4271344">[</span><span class="op" id="4271345">]</span><span class="ident" id="4271346">pkix</span><span class="op" id="4271350">.</span><span class="ident" id="4271351">Extension</span>&nbsp;<span class="string" id="4271361">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4271394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271397">type</span>&nbsp;<span class="ident" id="4271402">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4271425">struct</span>&nbsp;<span class="op" id="4271432">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271435">P</span><span class="op" id="4271436">,</span>&nbsp;<span class="ident" id="4271438">Q</span><span class="op" id="4271439">,</span>&nbsp;<span class="ident" id="4271441">G</span>&nbsp;<span class="op" id="4271443">*</span><span class="ident" id="4271444">big</span><span class="op" id="4271447">.</span><span class="ident" id="4271448">Int</span><br>
<span class="lineno"></span><span class="op" id="4271452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271455">type</span>&nbsp;<span class="ident" id="4271460">dsaSignature</span>&nbsp;<span class="keyword" id="4271473">struct</span>&nbsp;<span class="op" id="4271480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271483">R</span><span class="op" id="4271484">,</span>&nbsp;<span class="ident" id="4271486">S</span>&nbsp;<span class="op" id="4271488">*</span><span class="ident" id="4271489">big</span><span class="op" id="4271492">.</span><span class="ident" id="4271493">Int</span><br>
<span class="lineno">135</span><span class="op" id="4271497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271500">type</span>&nbsp;<span class="ident" id="4271505">ecdsaSignature</span>&nbsp;<span class="ident" id="4271520">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271534">type</span>&nbsp;<span class="ident" id="4271539">validity</span>&nbsp;<span class="keyword" id="4271548">struct</span>&nbsp;<span class="op" id="4271555">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271558">NotBefore</span><span class="op" id="4271567">,</span>&nbsp;<span class="ident" id="4271569">NotAfter</span>&nbsp;<span class="ident" id="4271578">time</span><span class="op" id="4271582">.</span><span class="ident" id="4271583">Time</span><br>
<span class="lineno"></span><span class="op" id="4271588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271591">type</span>&nbsp;<span class="ident" id="4271596">publicKeyInfo</span>&nbsp;<span class="keyword" id="4271610">struct</span>&nbsp;<span class="op" id="4271617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271620">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4271630">asn1</span><span class="op" id="4271634">.</span><span class="ident" id="4271635">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271647">Algorithm</span>&nbsp;<span class="ident" id="4271657">pkix</span><span class="op" id="4271661">.</span><span class="ident" id="4271662">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271683">PublicKey</span>&nbsp;<span class="ident" id="4271693">asn1</span><span class="op" id="4271697">.</span><span class="ident" id="4271698">BitString</span><br>
<span class="lineno"></span><span class="op" id="4271708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4271711">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4271733">type</span>&nbsp;<span class="ident" id="4271738">authKeyId</span>&nbsp;<span class="keyword" id="4271748">struct</span>&nbsp;<span class="op" id="4271755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271758">Id</span>&nbsp;<span class="op" id="4271761">[</span><span class="op" id="4271762">]</span><span class="builtintype" id="4271763">byte</span>&nbsp;<span class="string" id="4271768">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4271792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4271795">type</span>&nbsp;<span class="ident" id="4271800">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4271819">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4271824">const</span>&nbsp;<span class="op" id="4271830">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271833">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4271859">SignatureAlgorithm</span>&nbsp;<span class="op" id="4271878">=</span>&nbsp;<span class="ident" id="4271880">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271886">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271898">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271910">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271923">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271938">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271953">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271968">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271981">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4271996">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272011">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272028">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272045">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4272061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4272064">type</span>&nbsp;<span class="ident" id="4272069">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4272088">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4272093">const</span>&nbsp;<span class="op" id="4272099">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272102">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4272128">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4272147">=</span>&nbsp;<span class="ident" id="4272149">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272155">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272160">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4272165">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4272171">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4272174">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4272207">//</span><br>
<span class="lineno"></span><span class="comment" id="4272210">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4272244">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4272307">//</span><br>
<span class="lineno"></span><span class="comment" id="4272310">//</span><br>
<span class="lineno"></span><span class="comment" id="4272313">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4272356">//</span><br>
<span class="lineno"></span><span class="comment" id="4272359">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4272418">//</span><br>
<span class="lineno"></span><span class="comment" id="4272421">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4272480">//</span><br>
<span class="lineno"></span><span class="comment" id="4272483">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4272544">//</span><br>
<span class="lineno">195</span><span class="comment" id="4272547">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4272586">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4272647">//</span><br>
<span class="lineno"></span><span class="comment" id="4272650">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4272694">//</span><br>
<span class="lineno">200</span><span class="comment" id="4272697">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4272740">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4272793">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4272833">//</span><br>
<span class="lineno"></span><span class="comment" id="4272836">//</span><br>
<span class="lineno">205</span><span class="comment" id="4272839">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4272873">//</span><br>
<span class="lineno"></span><span class="comment" id="4272876">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4272939">//</span><br>
<span class="lineno"></span><span class="comment" id="4272942">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4273005">//</span><br>
<span class="lineno"></span><span class="comment" id="4273008">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4273071">//</span><br>
<span class="lineno"></span><span class="comment" id="4273074">//</span><br>
<span class="lineno"></span><span class="comment" id="4273077">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4273118">//</span><br>
<span class="lineno"></span><span class="comment" id="4273121">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4273162">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4273232">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4273283">//</span><br>
<span class="lineno">220</span><span class="comment" id="4273286">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4273328">//</span><br>
<span class="lineno"></span><span class="comment" id="4273331">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4273398">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4273467">//</span><br>
<span class="lineno">225</span><span class="comment" id="4273470">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4273537">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4273606">//</span><br>
<span class="lineno"></span><span class="comment" id="4273609">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4273676">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4273746">var</span>&nbsp;<span class="op" id="4273750">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273753">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4273781">=</span>&nbsp;<span class="ident" id="4273783">asn1</span><span class="op" id="4273787">.</span><span class="ident" id="4273788">ObjectIdentifier</span><span class="op" id="4273804">{</span><span class="num" id="4273805">1</span><span class="op" id="4273806">,</span>&nbsp;<span class="num" id="4273808">2</span><span class="op" id="4273809">,</span>&nbsp;<span class="num" id="4273811">840</span><span class="op" id="4273814">,</span>&nbsp;<span class="num" id="4273816">113549</span><span class="op" id="4273822">,</span>&nbsp;<span class="num" id="4273824">1</span><span class="op" id="4273825">,</span>&nbsp;<span class="num" id="4273827">1</span><span class="op" id="4273828">,</span>&nbsp;<span class="num" id="4273830">2</span><span class="op" id="4273831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273834">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4273862">=</span>&nbsp;<span class="ident" id="4273864">asn1</span><span class="op" id="4273868">.</span><span class="ident" id="4273869">ObjectIdentifier</span><span class="op" id="4273885">{</span><span class="num" id="4273886">1</span><span class="op" id="4273887">,</span>&nbsp;<span class="num" id="4273889">2</span><span class="op" id="4273890">,</span>&nbsp;<span class="num" id="4273892">840</span><span class="op" id="4273895">,</span>&nbsp;<span class="num" id="4273897">113549</span><span class="op" id="4273903">,</span>&nbsp;<span class="num" id="4273905">1</span><span class="op" id="4273906">,</span>&nbsp;<span class="num" id="4273908">1</span><span class="op" id="4273909">,</span>&nbsp;<span class="num" id="4273911">4</span><span class="op" id="4273912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273915">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4273943">=</span>&nbsp;<span class="ident" id="4273945">asn1</span><span class="op" id="4273949">.</span><span class="ident" id="4273950">ObjectIdentifier</span><span class="op" id="4273966">{</span><span class="num" id="4273967">1</span><span class="op" id="4273968">,</span>&nbsp;<span class="num" id="4273970">2</span><span class="op" id="4273971">,</span>&nbsp;<span class="num" id="4273973">840</span><span class="op" id="4273976">,</span>&nbsp;<span class="num" id="4273978">113549</span><span class="op" id="4273984">,</span>&nbsp;<span class="num" id="4273986">1</span><span class="op" id="4273987">,</span>&nbsp;<span class="num" id="4273989">1</span><span class="op" id="4273990">,</span>&nbsp;<span class="num" id="4273992">5</span><span class="op" id="4273993">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4273996">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4274024">=</span>&nbsp;<span class="ident" id="4274026">asn1</span><span class="op" id="4274030">.</span><span class="ident" id="4274031">ObjectIdentifier</span><span class="op" id="4274047">{</span><span class="num" id="4274048">1</span><span class="op" id="4274049">,</span>&nbsp;<span class="num" id="4274051">2</span><span class="op" id="4274052">,</span>&nbsp;<span class="num" id="4274054">840</span><span class="op" id="4274057">,</span>&nbsp;<span class="num" id="4274059">113549</span><span class="op" id="4274065">,</span>&nbsp;<span class="num" id="4274067">1</span><span class="op" id="4274068">,</span>&nbsp;<span class="num" id="4274070">1</span><span class="op" id="4274071">,</span>&nbsp;<span class="num" id="4274073">11</span><span class="op" id="4274075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274078">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4274106">=</span>&nbsp;<span class="ident" id="4274108">asn1</span><span class="op" id="4274112">.</span><span class="ident" id="4274113">ObjectIdentifier</span><span class="op" id="4274129">{</span><span class="num" id="4274130">1</span><span class="op" id="4274131">,</span>&nbsp;<span class="num" id="4274133">2</span><span class="op" id="4274134">,</span>&nbsp;<span class="num" id="4274136">840</span><span class="op" id="4274139">,</span>&nbsp;<span class="num" id="4274141">113549</span><span class="op" id="4274147">,</span>&nbsp;<span class="num" id="4274149">1</span><span class="op" id="4274150">,</span>&nbsp;<span class="num" id="4274152">1</span><span class="op" id="4274153">,</span>&nbsp;<span class="num" id="4274155">12</span><span class="op" id="4274157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274160">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4274188">=</span>&nbsp;<span class="ident" id="4274190">asn1</span><span class="op" id="4274194">.</span><span class="ident" id="4274195">ObjectIdentifier</span><span class="op" id="4274211">{</span><span class="num" id="4274212">1</span><span class="op" id="4274213">,</span>&nbsp;<span class="num" id="4274215">2</span><span class="op" id="4274216">,</span>&nbsp;<span class="num" id="4274218">840</span><span class="op" id="4274221">,</span>&nbsp;<span class="num" id="4274223">113549</span><span class="op" id="4274229">,</span>&nbsp;<span class="num" id="4274231">1</span><span class="op" id="4274232">,</span>&nbsp;<span class="num" id="4274234">1</span><span class="op" id="4274235">,</span>&nbsp;<span class="num" id="4274237">13</span><span class="op" id="4274239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274242">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4274270">=</span>&nbsp;<span class="ident" id="4274272">asn1</span><span class="op" id="4274276">.</span><span class="ident" id="4274277">ObjectIdentifier</span><span class="op" id="4274293">{</span><span class="num" id="4274294">1</span><span class="op" id="4274295">,</span>&nbsp;<span class="num" id="4274297">2</span><span class="op" id="4274298">,</span>&nbsp;<span class="num" id="4274300">840</span><span class="op" id="4274303">,</span>&nbsp;<span class="num" id="4274305">10040</span><span class="op" id="4274310">,</span>&nbsp;<span class="num" id="4274312">4</span><span class="op" id="4274313">,</span>&nbsp;<span class="num" id="4274315">3</span><span class="op" id="4274316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274319">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4274347">=</span>&nbsp;<span class="ident" id="4274349">asn1</span><span class="op" id="4274353">.</span><span class="ident" id="4274354">ObjectIdentifier</span><span class="op" id="4274370">{</span><span class="num" id="4274371">2</span><span class="op" id="4274372">,</span>&nbsp;<span class="num" id="4274374">16</span><span class="op" id="4274376">,</span>&nbsp;<span class="num" id="4274378">840</span><span class="op" id="4274381">,</span>&nbsp;<span class="num" id="4274383">1</span><span class="op" id="4274384">,</span>&nbsp;<span class="num" id="4274386">101</span><span class="op" id="4274389">,</span>&nbsp;<span class="num" id="4274391">4</span><span class="op" id="4274392">,</span>&nbsp;<span class="num" id="4274394">3</span><span class="op" id="4274395">,</span>&nbsp;<span class="num" id="4274397">2</span><span class="op" id="4274398">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274401">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4274429">=</span>&nbsp;<span class="ident" id="4274431">asn1</span><span class="op" id="4274435">.</span><span class="ident" id="4274436">ObjectIdentifier</span><span class="op" id="4274452">{</span><span class="num" id="4274453">1</span><span class="op" id="4274454">,</span>&nbsp;<span class="num" id="4274456">2</span><span class="op" id="4274457">,</span>&nbsp;<span class="num" id="4274459">840</span><span class="op" id="4274462">,</span>&nbsp;<span class="num" id="4274464">10045</span><span class="op" id="4274469">,</span>&nbsp;<span class="num" id="4274471">4</span><span class="op" id="4274472">,</span>&nbsp;<span class="num" id="4274474">1</span><span class="op" id="4274475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274478">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4274506">=</span>&nbsp;<span class="ident" id="4274508">asn1</span><span class="op" id="4274512">.</span><span class="ident" id="4274513">ObjectIdentifier</span><span class="op" id="4274529">{</span><span class="num" id="4274530">1</span><span class="op" id="4274531">,</span>&nbsp;<span class="num" id="4274533">2</span><span class="op" id="4274534">,</span>&nbsp;<span class="num" id="4274536">840</span><span class="op" id="4274539">,</span>&nbsp;<span class="num" id="4274541">10045</span><span class="op" id="4274546">,</span>&nbsp;<span class="num" id="4274548">4</span><span class="op" id="4274549">,</span>&nbsp;<span class="num" id="4274551">3</span><span class="op" id="4274552">,</span>&nbsp;<span class="num" id="4274554">2</span><span class="op" id="4274555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274558">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4274586">=</span>&nbsp;<span class="ident" id="4274588">asn1</span><span class="op" id="4274592">.</span><span class="ident" id="4274593">ObjectIdentifier</span><span class="op" id="4274609">{</span><span class="num" id="4274610">1</span><span class="op" id="4274611">,</span>&nbsp;<span class="num" id="4274613">2</span><span class="op" id="4274614">,</span>&nbsp;<span class="num" id="4274616">840</span><span class="op" id="4274619">,</span>&nbsp;<span class="num" id="4274621">10045</span><span class="op" id="4274626">,</span>&nbsp;<span class="num" id="4274628">4</span><span class="op" id="4274629">,</span>&nbsp;<span class="num" id="4274631">3</span><span class="op" id="4274632">,</span>&nbsp;<span class="num" id="4274634">3</span><span class="op" id="4274635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274638">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4274666">=</span>&nbsp;<span class="ident" id="4274668">asn1</span><span class="op" id="4274672">.</span><span class="ident" id="4274673">ObjectIdentifier</span><span class="op" id="4274689">{</span><span class="num" id="4274690">1</span><span class="op" id="4274691">,</span>&nbsp;<span class="num" id="4274693">2</span><span class="op" id="4274694">,</span>&nbsp;<span class="num" id="4274696">840</span><span class="op" id="4274699">,</span>&nbsp;<span class="num" id="4274701">10045</span><span class="op" id="4274706">,</span>&nbsp;<span class="num" id="4274708">4</span><span class="op" id="4274709">,</span>&nbsp;<span class="num" id="4274711">3</span><span class="op" id="4274712">,</span>&nbsp;<span class="num" id="4274714">4</span><span class="op" id="4274715">}</span><br>
<span class="lineno"></span><span class="op" id="4274717">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4274720">var</span>&nbsp;<span class="ident" id="4274724">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4274750">=</span>&nbsp;<span class="op" id="4274752">[</span><span class="op" id="4274753">]</span><span class="keyword" id="4274754">struct</span>&nbsp;<span class="op" id="4274761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274764">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4274775">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274795">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4274806">asn1</span><span class="op" id="4274810">.</span><span class="ident" id="4274811">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274829">pubKeyAlgo</span>&nbsp;<span class="ident" id="4274840">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4274860">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4274871">crypto</span><span class="op" id="4274877">.</span><span class="ident" id="4274878">Hash</span><br>
<span class="lineno"></span><span class="op" id="4274883">}</span><span class="op" id="4274884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274887">{</span><span class="ident" id="4274888">MD2WithRSA</span><span class="op" id="4274898">,</span>&nbsp;<span class="ident" id="4274900">oidSignatureMD2WithRSA</span><span class="op" id="4274922">,</span>&nbsp;<span class="ident" id="4274924">RSA</span><span class="op" id="4274927">,</span>&nbsp;<span class="ident" id="4274929">crypto</span><span class="op" id="4274935">.</span><span class="ident" id="4274936">Hash</span><span class="op" id="4274940">(</span><span class="num" id="4274941">0</span><span class="op" id="4274942">)</span>&nbsp;<span class="comment" id="4274944">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4274966">}</span><span class="op" id="4274967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4274970">{</span><span class="ident" id="4274971">MD5WithRSA</span><span class="op" id="4274981">,</span>&nbsp;<span class="ident" id="4274983">oidSignatureMD5WithRSA</span><span class="op" id="4275005">,</span>&nbsp;<span class="ident" id="4275007">RSA</span><span class="op" id="4275010">,</span>&nbsp;<span class="ident" id="4275012">crypto</span><span class="op" id="4275018">.</span><span class="ident" id="4275019">MD5</span><span class="op" id="4275022">}</span><span class="op" id="4275023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275026">{</span><span class="ident" id="4275027">SHA1WithRSA</span><span class="op" id="4275038">,</span>&nbsp;<span class="ident" id="4275040">oidSignatureSHA1WithRSA</span><span class="op" id="4275063">,</span>&nbsp;<span class="ident" id="4275065">RSA</span><span class="op" id="4275068">,</span>&nbsp;<span class="ident" id="4275070">crypto</span><span class="op" id="4275076">.</span><span class="ident" id="4275077">SHA1</span><span class="op" id="4275081">}</span><span class="op" id="4275082">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275085">{</span><span class="ident" id="4275086">SHA256WithRSA</span><span class="op" id="4275099">,</span>&nbsp;<span class="ident" id="4275101">oidSignatureSHA256WithRSA</span><span class="op" id="4275126">,</span>&nbsp;<span class="ident" id="4275128">RSA</span><span class="op" id="4275131">,</span>&nbsp;<span class="ident" id="4275133">crypto</span><span class="op" id="4275139">.</span><span class="ident" id="4275140">SHA256</span><span class="op" id="4275146">}</span><span class="op" id="4275147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275150">{</span><span class="ident" id="4275151">SHA384WithRSA</span><span class="op" id="4275164">,</span>&nbsp;<span class="ident" id="4275166">oidSignatureSHA384WithRSA</span><span class="op" id="4275191">,</span>&nbsp;<span class="ident" id="4275193">RSA</span><span class="op" id="4275196">,</span>&nbsp;<span class="ident" id="4275198">crypto</span><span class="op" id="4275204">.</span><span class="ident" id="4275205">SHA384</span><span class="op" id="4275211">}</span><span class="op" id="4275212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275215">{</span><span class="ident" id="4275216">SHA512WithRSA</span><span class="op" id="4275229">,</span>&nbsp;<span class="ident" id="4275231">oidSignatureSHA512WithRSA</span><span class="op" id="4275256">,</span>&nbsp;<span class="ident" id="4275258">RSA</span><span class="op" id="4275261">,</span>&nbsp;<span class="ident" id="4275263">crypto</span><span class="op" id="4275269">.</span><span class="ident" id="4275270">SHA512</span><span class="op" id="4275276">}</span><span class="op" id="4275277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275280">{</span><span class="ident" id="4275281">DSAWithSHA1</span><span class="op" id="4275292">,</span>&nbsp;<span class="ident" id="4275294">oidSignatureDSAWithSHA1</span><span class="op" id="4275317">,</span>&nbsp;<span class="ident" id="4275319">DSA</span><span class="op" id="4275322">,</span>&nbsp;<span class="ident" id="4275324">crypto</span><span class="op" id="4275330">.</span><span class="ident" id="4275331">SHA1</span><span class="op" id="4275335">}</span><span class="op" id="4275336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275339">{</span><span class="ident" id="4275340">DSAWithSHA256</span><span class="op" id="4275353">,</span>&nbsp;<span class="ident" id="4275355">oidSignatureDSAWithSHA256</span><span class="op" id="4275380">,</span>&nbsp;<span class="ident" id="4275382">DSA</span><span class="op" id="4275385">,</span>&nbsp;<span class="ident" id="4275387">crypto</span><span class="op" id="4275393">.</span><span class="ident" id="4275394">SHA256</span><span class="op" id="4275400">}</span><span class="op" id="4275401">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275404">{</span><span class="ident" id="4275405">ECDSAWithSHA1</span><span class="op" id="4275418">,</span>&nbsp;<span class="ident" id="4275420">oidSignatureECDSAWithSHA1</span><span class="op" id="4275445">,</span>&nbsp;<span class="ident" id="4275447">ECDSA</span><span class="op" id="4275452">,</span>&nbsp;<span class="ident" id="4275454">crypto</span><span class="op" id="4275460">.</span><span class="ident" id="4275461">SHA1</span><span class="op" id="4275465">}</span><span class="op" id="4275466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275469">{</span><span class="ident" id="4275470">ECDSAWithSHA256</span><span class="op" id="4275485">,</span>&nbsp;<span class="ident" id="4275487">oidSignatureECDSAWithSHA256</span><span class="op" id="4275514">,</span>&nbsp;<span class="ident" id="4275516">ECDSA</span><span class="op" id="4275521">,</span>&nbsp;<span class="ident" id="4275523">crypto</span><span class="op" id="4275529">.</span><span class="ident" id="4275530">SHA256</span><span class="op" id="4275536">}</span><span class="op" id="4275537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275540">{</span><span class="ident" id="4275541">ECDSAWithSHA384</span><span class="op" id="4275556">,</span>&nbsp;<span class="ident" id="4275558">oidSignatureECDSAWithSHA384</span><span class="op" id="4275585">,</span>&nbsp;<span class="ident" id="4275587">ECDSA</span><span class="op" id="4275592">,</span>&nbsp;<span class="ident" id="4275594">crypto</span><span class="op" id="4275600">.</span><span class="ident" id="4275601">SHA384</span><span class="op" id="4275607">}</span><span class="op" id="4275608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275611">{</span><span class="ident" id="4275612">ECDSAWithSHA512</span><span class="op" id="4275627">,</span>&nbsp;<span class="ident" id="4275629">oidSignatureECDSAWithSHA512</span><span class="op" id="4275656">,</span>&nbsp;<span class="ident" id="4275658">ECDSA</span><span class="op" id="4275663">,</span>&nbsp;<span class="ident" id="4275665">crypto</span><span class="op" id="4275671">.</span><span class="ident" id="4275672">SHA512</span><span class="op" id="4275678">}</span><span class="op" id="4275679">,</span><br>
<span class="lineno"></span><span class="op" id="4275681">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4275684">func</span>&nbsp;<span class="ident" id="4275689">getSignatureAlgorithmFromOID</span><span class="op" id="4275717">(</span><span class="ident" id="4275718">oid</span>&nbsp;<span class="ident" id="4275722">asn1</span><span class="op" id="4275726">.</span><span class="ident" id="4275727">ObjectIdentifier</span><span class="op" id="4275743">)</span>&nbsp;<span class="ident" id="4275745">SignatureAlgorithm</span>&nbsp;<span class="op" id="4275764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275767">for</span>&nbsp;<span class="ident" id="4275771">_</span><span class="op" id="4275772">,</span>&nbsp;<span class="ident" id="4275774">details</span>&nbsp;<span class="op" id="4275782">:=</span>&nbsp;<span class="keyword" id="4275785">range</span>&nbsp;<span class="ident" id="4275791">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4275817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275821">if</span>&nbsp;<span class="ident" id="4275824">oid</span><span class="op" id="4275827">.</span><span class="ident" id="4275828">Equal</span><span class="op" id="4275833">(</span><span class="ident" id="4275834">details</span><span class="op" id="4275841">.</span><span class="ident" id="4275842">oid</span><span class="op" id="4275845">)</span>&nbsp;<span class="op" id="4275847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275852">return</span>&nbsp;<span class="ident" id="4275859">details</span><span class="op" id="4275866">.</span><span class="ident" id="4275867">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4275877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4275880">return</span>&nbsp;<span class="ident" id="4275887">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4275913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4275916">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4275955">//</span><br>
<span class="lineno"></span><span class="comment" id="4275958">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4276023">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4276056">//</span><br>
<span class="lineno">280</span><span class="comment" id="4276059">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4276113">//</span><br>
<span class="lineno"></span><span class="comment" id="4276116">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4276181">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4276212">//</span><br>
<span class="lineno">285</span><span class="comment" id="4276215">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4276283">//</span><br>
<span class="lineno"></span><span class="comment" id="4276286">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4276328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4276400">var</span>&nbsp;<span class="op" id="4276404">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276407">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4276425">=</span>&nbsp;<span class="ident" id="4276427">asn1</span><span class="op" id="4276431">.</span><span class="ident" id="4276432">ObjectIdentifier</span><span class="op" id="4276448">{</span><span class="num" id="4276449">1</span><span class="op" id="4276450">,</span>&nbsp;<span class="num" id="4276452">2</span><span class="op" id="4276453">,</span>&nbsp;<span class="num" id="4276455">840</span><span class="op" id="4276458">,</span>&nbsp;<span class="num" id="4276460">113549</span><span class="op" id="4276466">,</span>&nbsp;<span class="num" id="4276468">1</span><span class="op" id="4276469">,</span>&nbsp;<span class="num" id="4276471">1</span><span class="op" id="4276472">,</span>&nbsp;<span class="num" id="4276474">1</span><span class="op" id="4276475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276478">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4276496">=</span>&nbsp;<span class="ident" id="4276498">asn1</span><span class="op" id="4276502">.</span><span class="ident" id="4276503">ObjectIdentifier</span><span class="op" id="4276519">{</span><span class="num" id="4276520">1</span><span class="op" id="4276521">,</span>&nbsp;<span class="num" id="4276523">2</span><span class="op" id="4276524">,</span>&nbsp;<span class="num" id="4276526">840</span><span class="op" id="4276529">,</span>&nbsp;<span class="num" id="4276531">10040</span><span class="op" id="4276536">,</span>&nbsp;<span class="num" id="4276538">4</span><span class="op" id="4276539">,</span>&nbsp;<span class="num" id="4276541">1</span><span class="op" id="4276542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4276545">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4276563">=</span>&nbsp;<span class="ident" id="4276565">asn1</span><span class="op" id="4276569">.</span><span class="ident" id="4276570">ObjectIdentifier</span><span class="op" id="4276586">{</span><span class="num" id="4276587">1</span><span class="op" id="4276588">,</span>&nbsp;<span class="num" id="4276590">2</span><span class="op" id="4276591">,</span>&nbsp;<span class="num" id="4276593">840</span><span class="op" id="4276596">,</span>&nbsp;<span class="num" id="4276598">10045</span><span class="op" id="4276603">,</span>&nbsp;<span class="num" id="4276605">2</span><span class="op" id="4276606">,</span>&nbsp;<span class="num" id="4276608">1</span><span class="op" id="4276609">}</span><br>
<span class="lineno"></span><span class="op" id="4276611">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4276614">func</span>&nbsp;<span class="ident" id="4276619">getPublicKeyAlgorithmFromOID</span><span class="op" id="4276647">(</span><span class="ident" id="4276648">oid</span>&nbsp;<span class="ident" id="4276652">asn1</span><span class="op" id="4276656">.</span><span class="ident" id="4276657">ObjectIdentifier</span><span class="op" id="4276673">)</span>&nbsp;<span class="ident" id="4276675">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4276694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276697">switch</span>&nbsp;<span class="op" id="4276704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276707">case</span>&nbsp;<span class="ident" id="4276712">oid</span><span class="op" id="4276715">.</span><span class="ident" id="4276716">Equal</span><span class="op" id="4276721">(</span><span class="ident" id="4276722">oidPublicKeyRSA</span><span class="op" id="4276737">)</span><span class="op" id="4276738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276742">return</span>&nbsp;<span class="ident" id="4276749">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276754">case</span>&nbsp;<span class="ident" id="4276759">oid</span><span class="op" id="4276762">.</span><span class="ident" id="4276763">Equal</span><span class="op" id="4276768">(</span><span class="ident" id="4276769">oidPublicKeyDSA</span><span class="op" id="4276784">)</span><span class="op" id="4276785">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276789">return</span>&nbsp;<span class="ident" id="4276796">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276801">case</span>&nbsp;<span class="ident" id="4276806">oid</span><span class="op" id="4276809">.</span><span class="ident" id="4276810">Equal</span><span class="op" id="4276815">(</span><span class="ident" id="4276816">oidPublicKeyECDSA</span><span class="op" id="4276833">)</span><span class="op" id="4276834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276838">return</span>&nbsp;<span class="ident" id="4276845">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4276852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4276855">return</span>&nbsp;<span class="ident" id="4276862">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4276888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4276891">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4276925">//</span><br>
<span class="lineno"></span><span class="comment" id="4276928">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4276965">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4277032">//</span><br>
<span class="lineno"></span><span class="comment" id="4277035">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4277072">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4277135">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4277153">//</span><br>
<span class="lineno"></span><span class="comment" id="4277156">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4277193">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4277260">//</span><br>
<span class="lineno"></span><span class="comment" id="4277263">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4277300">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4277367">//</span><br>
<span class="lineno"></span><span class="comment" id="4277370">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4277415">var</span>&nbsp;<span class="op" id="4277419">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277422">oidNamedCurveP224</span>&nbsp;<span class="op" id="4277440">=</span>&nbsp;<span class="ident" id="4277442">asn1</span><span class="op" id="4277446">.</span><span class="ident" id="4277447">ObjectIdentifier</span><span class="op" id="4277463">{</span><span class="num" id="4277464">1</span><span class="op" id="4277465">,</span>&nbsp;<span class="num" id="4277467">3</span><span class="op" id="4277468">,</span>&nbsp;<span class="num" id="4277470">132</span><span class="op" id="4277473">,</span>&nbsp;<span class="num" id="4277475">0</span><span class="op" id="4277476">,</span>&nbsp;<span class="num" id="4277478">33</span><span class="op" id="4277480">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277483">oidNamedCurveP256</span>&nbsp;<span class="op" id="4277501">=</span>&nbsp;<span class="ident" id="4277503">asn1</span><span class="op" id="4277507">.</span><span class="ident" id="4277508">ObjectIdentifier</span><span class="op" id="4277524">{</span><span class="num" id="4277525">1</span><span class="op" id="4277526">,</span>&nbsp;<span class="num" id="4277528">2</span><span class="op" id="4277529">,</span>&nbsp;<span class="num" id="4277531">840</span><span class="op" id="4277534">,</span>&nbsp;<span class="num" id="4277536">10045</span><span class="op" id="4277541">,</span>&nbsp;<span class="num" id="4277543">3</span><span class="op" id="4277544">,</span>&nbsp;<span class="num" id="4277546">1</span><span class="op" id="4277547">,</span>&nbsp;<span class="num" id="4277549">7</span><span class="op" id="4277550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277553">oidNamedCurveP384</span>&nbsp;<span class="op" id="4277571">=</span>&nbsp;<span class="ident" id="4277573">asn1</span><span class="op" id="4277577">.</span><span class="ident" id="4277578">ObjectIdentifier</span><span class="op" id="4277594">{</span><span class="num" id="4277595">1</span><span class="op" id="4277596">,</span>&nbsp;<span class="num" id="4277598">3</span><span class="op" id="4277599">,</span>&nbsp;<span class="num" id="4277601">132</span><span class="op" id="4277604">,</span>&nbsp;<span class="num" id="4277606">0</span><span class="op" id="4277607">,</span>&nbsp;<span class="num" id="4277609">34</span><span class="op" id="4277611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4277614">oidNamedCurveP521</span>&nbsp;<span class="op" id="4277632">=</span>&nbsp;<span class="ident" id="4277634">asn1</span><span class="op" id="4277638">.</span><span class="ident" id="4277639">ObjectIdentifier</span><span class="op" id="4277655">{</span><span class="num" id="4277656">1</span><span class="op" id="4277657">,</span>&nbsp;<span class="num" id="4277659">3</span><span class="op" id="4277660">,</span>&nbsp;<span class="num" id="4277662">132</span><span class="op" id="4277665">,</span>&nbsp;<span class="num" id="4277667">0</span><span class="op" id="4277668">,</span>&nbsp;<span class="num" id="4277670">35</span><span class="op" id="4277672">}</span><br>
<span class="lineno"></span><span class="op" id="4277674">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4277677">func</span>&nbsp;<span class="ident" id="4277682">namedCurveFromOID</span><span class="op" id="4277699">(</span><span class="ident" id="4277700">oid</span>&nbsp;<span class="ident" id="4277704">asn1</span><span class="op" id="4277708">.</span><span class="ident" id="4277709">ObjectIdentifier</span><span class="op" id="4277725">)</span>&nbsp;<span class="ident" id="4277727">elliptic</span><span class="op" id="4277735">.</span><span class="ident" id="4277736">Curve</span>&nbsp;<span class="op" id="4277742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277745">switch</span>&nbsp;<span class="op" id="4277752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277755">case</span>&nbsp;<span class="ident" id="4277760">oid</span><span class="op" id="4277763">.</span><span class="ident" id="4277764">Equal</span><span class="op" id="4277769">(</span><span class="ident" id="4277770">oidNamedCurveP224</span><span class="op" id="4277787">)</span><span class="op" id="4277788">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277792">return</span>&nbsp;<span class="ident" id="4277799">elliptic</span><span class="op" id="4277807">.</span><span class="ident" id="4277808">P224</span><span class="op" id="4277812">(</span><span class="op" id="4277813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277816">case</span>&nbsp;<span class="ident" id="4277821">oid</span><span class="op" id="4277824">.</span><span class="ident" id="4277825">Equal</span><span class="op" id="4277830">(</span><span class="ident" id="4277831">oidNamedCurveP256</span><span class="op" id="4277848">)</span><span class="op" id="4277849">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277853">return</span>&nbsp;<span class="ident" id="4277860">elliptic</span><span class="op" id="4277868">.</span><span class="ident" id="4277869">P256</span><span class="op" id="4277873">(</span><span class="op" id="4277874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277877">case</span>&nbsp;<span class="ident" id="4277882">oid</span><span class="op" id="4277885">.</span><span class="ident" id="4277886">Equal</span><span class="op" id="4277891">(</span><span class="ident" id="4277892">oidNamedCurveP384</span><span class="op" id="4277909">)</span><span class="op" id="4277910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277914">return</span>&nbsp;<span class="ident" id="4277921">elliptic</span><span class="op" id="4277929">.</span><span class="ident" id="4277930">P384</span><span class="op" id="4277934">(</span><span class="op" id="4277935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277938">case</span>&nbsp;<span class="ident" id="4277943">oid</span><span class="op" id="4277946">.</span><span class="ident" id="4277947">Equal</span><span class="op" id="4277952">(</span><span class="ident" id="4277953">oidNamedCurveP521</span><span class="op" id="4277970">)</span><span class="op" id="4277971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4277975">return</span>&nbsp;<span class="ident" id="4277982">elliptic</span><span class="op" id="4277990">.</span><span class="ident" id="4277991">P521</span><span class="op" id="4277995">(</span><span class="op" id="4277996">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4277999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278002">return</span>&nbsp;<span class="ident" id="4278009">nil</span><br>
<span class="lineno"></span><span class="op" id="4278013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4278016">func</span>&nbsp;<span class="ident" id="4278021">oidFromNamedCurve</span><span class="op" id="4278038">(</span><span class="ident" id="4278039">curve</span>&nbsp;<span class="ident" id="4278045">elliptic</span><span class="op" id="4278053">.</span><span class="ident" id="4278054">Curve</span><span class="op" id="4278059">)</span>&nbsp;<span class="op" id="4278061">(</span><span class="ident" id="4278062">asn1</span><span class="op" id="4278066">.</span><span class="ident" id="4278067">ObjectIdentifier</span><span class="op" id="4278083">,</span>&nbsp;<span class="builtintype" id="4278085">bool</span><span class="op" id="4278089">)</span>&nbsp;<span class="op" id="4278091">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278094">switch</span>&nbsp;<span class="ident" id="4278101">curve</span>&nbsp;<span class="op" id="4278107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278110">case</span>&nbsp;<span class="ident" id="4278115">elliptic</span><span class="op" id="4278123">.</span><span class="ident" id="4278124">P224</span><span class="op" id="4278128">(</span><span class="op" id="4278129">)</span><span class="op" id="4278130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278134">return</span>&nbsp;<span class="ident" id="4278141">oidNamedCurveP224</span><span class="op" id="4278158">,</span>&nbsp;<span class="builtintype" id="4278160">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278166">case</span>&nbsp;<span class="ident" id="4278171">elliptic</span><span class="op" id="4278179">.</span><span class="ident" id="4278180">P256</span><span class="op" id="4278184">(</span><span class="op" id="4278185">)</span><span class="op" id="4278186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278190">return</span>&nbsp;<span class="ident" id="4278197">oidNamedCurveP256</span><span class="op" id="4278214">,</span>&nbsp;<span class="builtintype" id="4278216">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278222">case</span>&nbsp;<span class="ident" id="4278227">elliptic</span><span class="op" id="4278235">.</span><span class="ident" id="4278236">P384</span><span class="op" id="4278240">(</span><span class="op" id="4278241">)</span><span class="op" id="4278242">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278246">return</span>&nbsp;<span class="ident" id="4278253">oidNamedCurveP384</span><span class="op" id="4278270">,</span>&nbsp;<span class="builtintype" id="4278272">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278278">case</span>&nbsp;<span class="ident" id="4278283">elliptic</span><span class="op" id="4278291">.</span><span class="ident" id="4278292">P521</span><span class="op" id="4278296">(</span><span class="op" id="4278297">)</span><span class="op" id="4278298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278302">return</span>&nbsp;<span class="ident" id="4278309">oidNamedCurveP521</span><span class="op" id="4278326">,</span>&nbsp;<span class="builtintype" id="4278328">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4278334">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4278338">return</span>&nbsp;<span class="ident" id="4278345">nil</span><span class="op" id="4278348">,</span>&nbsp;<span class="builtintype" id="4278350">false</span><br>
<span class="lineno"></span><span class="op" id="4278356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4278359">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4278438">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4278478">type</span>&nbsp;<span class="ident" id="4278483">KeyUsage</span>&nbsp;<span class="builtintype" id="4278492">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4278497">const</span>&nbsp;<span class="op" id="4278503">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278506">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4278531">KeyUsage</span>&nbsp;<span class="op" id="4278540">=</span>&nbsp;<span class="num" id="4278542">1</span>&nbsp;<span class="op" id="4278544">&lt;&lt;</span>&nbsp;<span class="ident" id="4278547">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278553">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278580">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278605">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278631">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278653">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278671">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278688">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4278710">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4278731">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4278734">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4278776">//</span><br>
<span class="lineno"></span><span class="comment" id="4278779">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4278848">//</span><br>
<span class="lineno"></span><span class="comment" id="4278851">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4278896">//</span><br>
<span class="lineno"></span><span class="comment" id="4278899">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4278965">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4279031">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4279097">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4279163">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4279229">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4279295">var</span>&nbsp;<span class="op" id="4279299">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279302">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279343">=</span>&nbsp;<span class="ident" id="4279345">asn1</span><span class="op" id="4279349">.</span><span class="ident" id="4279350">ObjectIdentifier</span><span class="op" id="4279366">{</span><span class="num" id="4279367">2</span><span class="op" id="4279368">,</span>&nbsp;<span class="num" id="4279370">5</span><span class="op" id="4279371">,</span>&nbsp;<span class="num" id="4279373">29</span><span class="op" id="4279375">,</span>&nbsp;<span class="num" id="4279377">37</span><span class="op" id="4279379">,</span>&nbsp;<span class="num" id="4279381">0</span><span class="op" id="4279382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279385">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279426">=</span>&nbsp;<span class="ident" id="4279428">asn1</span><span class="op" id="4279432">.</span><span class="ident" id="4279433">ObjectIdentifier</span><span class="op" id="4279449">{</span><span class="num" id="4279450">1</span><span class="op" id="4279451">,</span>&nbsp;<span class="num" id="4279453">3</span><span class="op" id="4279454">,</span>&nbsp;<span class="num" id="4279456">6</span><span class="op" id="4279457">,</span>&nbsp;<span class="num" id="4279459">1</span><span class="op" id="4279460">,</span>&nbsp;<span class="num" id="4279462">5</span><span class="op" id="4279463">,</span>&nbsp;<span class="num" id="4279465">5</span><span class="op" id="4279466">,</span>&nbsp;<span class="num" id="4279468">7</span><span class="op" id="4279469">,</span>&nbsp;<span class="num" id="4279471">3</span><span class="op" id="4279472">,</span>&nbsp;<span class="num" id="4279474">1</span><span class="op" id="4279475">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279478">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279519">=</span>&nbsp;<span class="ident" id="4279521">asn1</span><span class="op" id="4279525">.</span><span class="ident" id="4279526">ObjectIdentifier</span><span class="op" id="4279542">{</span><span class="num" id="4279543">1</span><span class="op" id="4279544">,</span>&nbsp;<span class="num" id="4279546">3</span><span class="op" id="4279547">,</span>&nbsp;<span class="num" id="4279549">6</span><span class="op" id="4279550">,</span>&nbsp;<span class="num" id="4279552">1</span><span class="op" id="4279553">,</span>&nbsp;<span class="num" id="4279555">5</span><span class="op" id="4279556">,</span>&nbsp;<span class="num" id="4279558">5</span><span class="op" id="4279559">,</span>&nbsp;<span class="num" id="4279561">7</span><span class="op" id="4279562">,</span>&nbsp;<span class="num" id="4279564">3</span><span class="op" id="4279565">,</span>&nbsp;<span class="num" id="4279567">2</span><span class="op" id="4279568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279571">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279612">=</span>&nbsp;<span class="ident" id="4279614">asn1</span><span class="op" id="4279618">.</span><span class="ident" id="4279619">ObjectIdentifier</span><span class="op" id="4279635">{</span><span class="num" id="4279636">1</span><span class="op" id="4279637">,</span>&nbsp;<span class="num" id="4279639">3</span><span class="op" id="4279640">,</span>&nbsp;<span class="num" id="4279642">6</span><span class="op" id="4279643">,</span>&nbsp;<span class="num" id="4279645">1</span><span class="op" id="4279646">,</span>&nbsp;<span class="num" id="4279648">5</span><span class="op" id="4279649">,</span>&nbsp;<span class="num" id="4279651">5</span><span class="op" id="4279652">,</span>&nbsp;<span class="num" id="4279654">7</span><span class="op" id="4279655">,</span>&nbsp;<span class="num" id="4279657">3</span><span class="op" id="4279658">,</span>&nbsp;<span class="num" id="4279660">3</span><span class="op" id="4279661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279664">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279705">=</span>&nbsp;<span class="ident" id="4279707">asn1</span><span class="op" id="4279711">.</span><span class="ident" id="4279712">ObjectIdentifier</span><span class="op" id="4279728">{</span><span class="num" id="4279729">1</span><span class="op" id="4279730">,</span>&nbsp;<span class="num" id="4279732">3</span><span class="op" id="4279733">,</span>&nbsp;<span class="num" id="4279735">6</span><span class="op" id="4279736">,</span>&nbsp;<span class="num" id="4279738">1</span><span class="op" id="4279739">,</span>&nbsp;<span class="num" id="4279741">5</span><span class="op" id="4279742">,</span>&nbsp;<span class="num" id="4279744">5</span><span class="op" id="4279745">,</span>&nbsp;<span class="num" id="4279747">7</span><span class="op" id="4279748">,</span>&nbsp;<span class="num" id="4279750">3</span><span class="op" id="4279751">,</span>&nbsp;<span class="num" id="4279753">4</span><span class="op" id="4279754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279757">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279798">=</span>&nbsp;<span class="ident" id="4279800">asn1</span><span class="op" id="4279804">.</span><span class="ident" id="4279805">ObjectIdentifier</span><span class="op" id="4279821">{</span><span class="num" id="4279822">1</span><span class="op" id="4279823">,</span>&nbsp;<span class="num" id="4279825">3</span><span class="op" id="4279826">,</span>&nbsp;<span class="num" id="4279828">6</span><span class="op" id="4279829">,</span>&nbsp;<span class="num" id="4279831">1</span><span class="op" id="4279832">,</span>&nbsp;<span class="num" id="4279834">5</span><span class="op" id="4279835">,</span>&nbsp;<span class="num" id="4279837">5</span><span class="op" id="4279838">,</span>&nbsp;<span class="num" id="4279840">7</span><span class="op" id="4279841">,</span>&nbsp;<span class="num" id="4279843">3</span><span class="op" id="4279844">,</span>&nbsp;<span class="num" id="4279846">5</span><span class="op" id="4279847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279850">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279891">=</span>&nbsp;<span class="ident" id="4279893">asn1</span><span class="op" id="4279897">.</span><span class="ident" id="4279898">ObjectIdentifier</span><span class="op" id="4279914">{</span><span class="num" id="4279915">1</span><span class="op" id="4279916">,</span>&nbsp;<span class="num" id="4279918">3</span><span class="op" id="4279919">,</span>&nbsp;<span class="num" id="4279921">6</span><span class="op" id="4279922">,</span>&nbsp;<span class="num" id="4279924">1</span><span class="op" id="4279925">,</span>&nbsp;<span class="num" id="4279927">5</span><span class="op" id="4279928">,</span>&nbsp;<span class="num" id="4279930">5</span><span class="op" id="4279931">,</span>&nbsp;<span class="num" id="4279933">7</span><span class="op" id="4279934">,</span>&nbsp;<span class="num" id="4279936">3</span><span class="op" id="4279937">,</span>&nbsp;<span class="num" id="4279939">6</span><span class="op" id="4279940">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4279943">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4279984">=</span>&nbsp;<span class="ident" id="4279986">asn1</span><span class="op" id="4279990">.</span><span class="ident" id="4279991">ObjectIdentifier</span><span class="op" id="4280007">{</span><span class="num" id="4280008">1</span><span class="op" id="4280009">,</span>&nbsp;<span class="num" id="4280011">3</span><span class="op" id="4280012">,</span>&nbsp;<span class="num" id="4280014">6</span><span class="op" id="4280015">,</span>&nbsp;<span class="num" id="4280017">1</span><span class="op" id="4280018">,</span>&nbsp;<span class="num" id="4280020">5</span><span class="op" id="4280021">,</span>&nbsp;<span class="num" id="4280023">5</span><span class="op" id="4280024">,</span>&nbsp;<span class="num" id="4280026">7</span><span class="op" id="4280027">,</span>&nbsp;<span class="num" id="4280029">3</span><span class="op" id="4280030">,</span>&nbsp;<span class="num" id="4280032">7</span><span class="op" id="4280033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280036">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4280077">=</span>&nbsp;<span class="ident" id="4280079">asn1</span><span class="op" id="4280083">.</span><span class="ident" id="4280084">ObjectIdentifier</span><span class="op" id="4280100">{</span><span class="num" id="4280101">1</span><span class="op" id="4280102">,</span>&nbsp;<span class="num" id="4280104">3</span><span class="op" id="4280105">,</span>&nbsp;<span class="num" id="4280107">6</span><span class="op" id="4280108">,</span>&nbsp;<span class="num" id="4280110">1</span><span class="op" id="4280111">,</span>&nbsp;<span class="num" id="4280113">5</span><span class="op" id="4280114">,</span>&nbsp;<span class="num" id="4280116">5</span><span class="op" id="4280117">,</span>&nbsp;<span class="num" id="4280119">7</span><span class="op" id="4280120">,</span>&nbsp;<span class="num" id="4280122">3</span><span class="op" id="4280123">,</span>&nbsp;<span class="num" id="4280125">8</span><span class="op" id="4280126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280129">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4280170">=</span>&nbsp;<span class="ident" id="4280172">asn1</span><span class="op" id="4280176">.</span><span class="ident" id="4280177">ObjectIdentifier</span><span class="op" id="4280193">{</span><span class="num" id="4280194">1</span><span class="op" id="4280195">,</span>&nbsp;<span class="num" id="4280197">3</span><span class="op" id="4280198">,</span>&nbsp;<span class="num" id="4280200">6</span><span class="op" id="4280201">,</span>&nbsp;<span class="num" id="4280203">1</span><span class="op" id="4280204">,</span>&nbsp;<span class="num" id="4280206">5</span><span class="op" id="4280207">,</span>&nbsp;<span class="num" id="4280209">5</span><span class="op" id="4280210">,</span>&nbsp;<span class="num" id="4280212">7</span><span class="op" id="4280213">,</span>&nbsp;<span class="num" id="4280215">3</span><span class="op" id="4280216">,</span>&nbsp;<span class="num" id="4280218">9</span><span class="op" id="4280219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280222">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4280263">=</span>&nbsp;<span class="ident" id="4280265">asn1</span><span class="op" id="4280269">.</span><span class="ident" id="4280270">ObjectIdentifier</span><span class="op" id="4280286">{</span><span class="num" id="4280287">1</span><span class="op" id="4280288">,</span>&nbsp;<span class="num" id="4280290">3</span><span class="op" id="4280291">,</span>&nbsp;<span class="num" id="4280293">6</span><span class="op" id="4280294">,</span>&nbsp;<span class="num" id="4280296">1</span><span class="op" id="4280297">,</span>&nbsp;<span class="num" id="4280299">4</span><span class="op" id="4280300">,</span>&nbsp;<span class="num" id="4280302">1</span><span class="op" id="4280303">,</span>&nbsp;<span class="num" id="4280305">311</span><span class="op" id="4280308">,</span>&nbsp;<span class="num" id="4280310">10</span><span class="op" id="4280312">,</span>&nbsp;<span class="num" id="4280314">3</span><span class="op" id="4280315">,</span>&nbsp;<span class="num" id="4280317">3</span><span class="op" id="4280318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280321">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4280362">=</span>&nbsp;<span class="ident" id="4280364">asn1</span><span class="op" id="4280368">.</span><span class="ident" id="4280369">ObjectIdentifier</span><span class="op" id="4280385">{</span><span class="num" id="4280386">2</span><span class="op" id="4280387">,</span>&nbsp;<span class="num" id="4280389">16</span><span class="op" id="4280391">,</span>&nbsp;<span class="num" id="4280393">840</span><span class="op" id="4280396">,</span>&nbsp;<span class="num" id="4280398">1</span><span class="op" id="4280399">,</span>&nbsp;<span class="num" id="4280401">113730</span><span class="op" id="4280407">,</span>&nbsp;<span class="num" id="4280409">4</span><span class="op" id="4280410">,</span>&nbsp;<span class="num" id="4280412">1</span><span class="op" id="4280413">}</span><br>
<span class="lineno">400</span><span class="op" id="4280415">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4280418">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4280503">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4280565">type</span>&nbsp;<span class="ident" id="4280570">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4280582">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4280587">const</span>&nbsp;<span class="op" id="4280593">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280596">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4280611">ExtKeyUsage</span>&nbsp;<span class="op" id="4280623">=</span>&nbsp;<span class="ident" id="4280625">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280631">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280654">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280677">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280701">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280729">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280756">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280780">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280802">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280827">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280851">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4280890">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4280927">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4280930">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4281006">var</span>&nbsp;<span class="ident" id="4281010">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4281026">=</span>&nbsp;<span class="op" id="4281028">[</span><span class="op" id="4281029">]</span><span class="keyword" id="4281030">struct</span>&nbsp;<span class="op" id="4281037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281040">extKeyUsage</span>&nbsp;<span class="ident" id="4281052">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4281065">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4281077">asn1</span><span class="op" id="4281081">.</span><span class="ident" id="4281082">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4281099">}</span><span class="op" id="4281100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281103">{</span><span class="ident" id="4281104">ExtKeyUsageAny</span><span class="op" id="4281118">,</span>&nbsp;<span class="ident" id="4281120">oidExtKeyUsageAny</span><span class="op" id="4281137">}</span><span class="op" id="4281138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281141">{</span><span class="ident" id="4281142">ExtKeyUsageServerAuth</span><span class="op" id="4281163">,</span>&nbsp;<span class="ident" id="4281165">oidExtKeyUsageServerAuth</span><span class="op" id="4281189">}</span><span class="op" id="4281190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281193">{</span><span class="ident" id="4281194">ExtKeyUsageClientAuth</span><span class="op" id="4281215">,</span>&nbsp;<span class="ident" id="4281217">oidExtKeyUsageClientAuth</span><span class="op" id="4281241">}</span><span class="op" id="4281242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281245">{</span><span class="ident" id="4281246">ExtKeyUsageCodeSigning</span><span class="op" id="4281268">,</span>&nbsp;<span class="ident" id="4281270">oidExtKeyUsageCodeSigning</span><span class="op" id="4281295">}</span><span class="op" id="4281296">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281299">{</span><span class="ident" id="4281300">ExtKeyUsageEmailProtection</span><span class="op" id="4281326">,</span>&nbsp;<span class="ident" id="4281328">oidExtKeyUsageEmailProtection</span><span class="op" id="4281357">}</span><span class="op" id="4281358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281361">{</span><span class="ident" id="4281362">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4281387">,</span>&nbsp;<span class="ident" id="4281389">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4281417">}</span><span class="op" id="4281418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281421">{</span><span class="ident" id="4281422">ExtKeyUsageIPSECTunnel</span><span class="op" id="4281444">,</span>&nbsp;<span class="ident" id="4281446">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4281471">}</span><span class="op" id="4281472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281475">{</span><span class="ident" id="4281476">ExtKeyUsageIPSECUser</span><span class="op" id="4281496">,</span>&nbsp;<span class="ident" id="4281498">oidExtKeyUsageIPSECUser</span><span class="op" id="4281521">}</span><span class="op" id="4281522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281525">{</span><span class="ident" id="4281526">ExtKeyUsageTimeStamping</span><span class="op" id="4281549">,</span>&nbsp;<span class="ident" id="4281551">oidExtKeyUsageTimeStamping</span><span class="op" id="4281577">}</span><span class="op" id="4281578">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281581">{</span><span class="ident" id="4281582">ExtKeyUsageOCSPSigning</span><span class="op" id="4281604">,</span>&nbsp;<span class="ident" id="4281606">oidExtKeyUsageOCSPSigning</span><span class="op" id="4281631">}</span><span class="op" id="4281632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281635">{</span><span class="ident" id="4281636">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4281673">,</span>&nbsp;<span class="ident" id="4281675">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4281715">}</span><span class="op" id="4281716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281719">{</span><span class="ident" id="4281720">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4281756">,</span>&nbsp;<span class="ident" id="4281758">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4281797">}</span><span class="op" id="4281798">,</span><br>
<span class="lineno"></span><span class="op" id="4281800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4281803">func</span>&nbsp;<span class="ident" id="4281808">extKeyUsageFromOID</span><span class="op" id="4281826">(</span><span class="ident" id="4281827">oid</span>&nbsp;<span class="ident" id="4281831">asn1</span><span class="op" id="4281835">.</span><span class="ident" id="4281836">ObjectIdentifier</span><span class="op" id="4281852">)</span>&nbsp;<span class="op" id="4281854">(</span><span class="ident" id="4281855">eku</span>&nbsp;<span class="ident" id="4281859">ExtKeyUsage</span><span class="op" id="4281870">,</span>&nbsp;<span class="ident" id="4281872">ok</span>&nbsp;<span class="builtintype" id="4281875">bool</span><span class="op" id="4281879">)</span>&nbsp;<span class="op" id="4281881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281884">for</span>&nbsp;<span class="ident" id="4281888">_</span><span class="op" id="4281889">,</span>&nbsp;<span class="ident" id="4281891">pair</span>&nbsp;<span class="op" id="4281896">:=</span>&nbsp;<span class="keyword" id="4281899">range</span>&nbsp;<span class="ident" id="4281905">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4281921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281925">if</span>&nbsp;<span class="ident" id="4281928">oid</span><span class="op" id="4281931">.</span><span class="ident" id="4281932">Equal</span><span class="op" id="4281937">(</span><span class="ident" id="4281938">pair</span><span class="op" id="4281942">.</span><span class="ident" id="4281943">oid</span><span class="op" id="4281946">)</span>&nbsp;<span class="op" id="4281948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281953">return</span>&nbsp;<span class="ident" id="4281960">pair</span><span class="op" id="4281964">.</span><span class="ident" id="4281965">extKeyUsage</span><span class="op" id="4281976">,</span>&nbsp;<span class="builtintype" id="4281978">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281985">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4281988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4281991">return</span><br>
<span class="lineno"></span><span class="op" id="4281998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4282001">func</span>&nbsp;<span class="ident" id="4282006">oidFromExtKeyUsage</span><span class="op" id="4282024">(</span><span class="ident" id="4282025">eku</span>&nbsp;<span class="ident" id="4282029">ExtKeyUsage</span><span class="op" id="4282040">)</span>&nbsp;<span class="op" id="4282042">(</span><span class="ident" id="4282043">oid</span>&nbsp;<span class="ident" id="4282047">asn1</span><span class="op" id="4282051">.</span><span class="ident" id="4282052">ObjectIdentifier</span><span class="op" id="4282068">,</span>&nbsp;<span class="ident" id="4282070">ok</span>&nbsp;<span class="builtintype" id="4282073">bool</span><span class="op" id="4282077">)</span>&nbsp;<span class="op" id="4282079">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282082">for</span>&nbsp;<span class="ident" id="4282086">_</span><span class="op" id="4282087">,</span>&nbsp;<span class="ident" id="4282089">pair</span>&nbsp;<span class="op" id="4282094">:=</span>&nbsp;<span class="keyword" id="4282097">range</span>&nbsp;<span class="ident" id="4282103">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4282119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282123">if</span>&nbsp;<span class="ident" id="4282126">eku</span>&nbsp;<span class="op" id="4282130">==</span>&nbsp;<span class="ident" id="4282133">pair</span><span class="op" id="4282137">.</span><span class="ident" id="4282138">extKeyUsage</span>&nbsp;<span class="op" id="4282150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282155">return</span>&nbsp;<span class="ident" id="4282162">pair</span><span class="op" id="4282166">.</span><span class="ident" id="4282167">oid</span><span class="op" id="4282170">,</span>&nbsp;<span class="builtintype" id="4282172">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4282182">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4282185">return</span><br>
<span class="lineno"></span><span class="op" id="4282192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4282195">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4282245">type</span>&nbsp;<span class="ident" id="4282250">Certificate</span>&nbsp;<span class="keyword" id="4282262">struct</span>&nbsp;<span class="op" id="4282269">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282272">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4282296">[</span><span class="op" id="4282297">]</span><span class="builtintype" id="4282298">byte</span>&nbsp;<span class="comment" id="4282303">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282384">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4282408">[</span><span class="op" id="4282409">]</span><span class="builtintype" id="4282410">byte</span>&nbsp;<span class="comment" id="4282415">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282462">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4282486">[</span><span class="op" id="4282487">]</span><span class="builtintype" id="4282488">byte</span>&nbsp;<span class="comment" id="4282493">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282531">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4282555">[</span><span class="op" id="4282556">]</span><span class="builtintype" id="4282557">byte</span>&nbsp;<span class="comment" id="4282562">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282586">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4282610">[</span><span class="op" id="4282611">]</span><span class="builtintype" id="4282612">byte</span>&nbsp;<span class="comment" id="4282617">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282641">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4282660">[</span><span class="op" id="4282661">]</span><span class="builtintype" id="4282662">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282668">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4282687">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282708">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4282727">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282747">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4282766">interface</span><span class="op" id="4282775">{</span><span class="op" id="4282776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282780">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4282800">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282805">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4282825">*</span><span class="ident" id="4282826">big</span><span class="op" id="4282829">.</span><span class="ident" id="4282830">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282835">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4282855">pkix</span><span class="op" id="4282859">.</span><span class="ident" id="4282860">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282866">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4282886">pkix</span><span class="op" id="4282890">.</span><span class="ident" id="4282891">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282897">NotBefore</span><span class="op" id="4282906">,</span>&nbsp;<span class="ident" id="4282908">NotAfter</span>&nbsp;<span class="ident" id="4282917">time</span><span class="op" id="4282921">.</span><span class="ident" id="4282922">Time</span>&nbsp;<span class="comment" id="4282927">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4282948">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4282968">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4282979">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283052">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283121">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283194">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283237">Extensions</span>&nbsp;<span class="op" id="4283248">[</span><span class="op" id="4283249">]</span><span class="ident" id="4283250">pkix</span><span class="op" id="4283254">.</span><span class="ident" id="4283255">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283267">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283335">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283405">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283478">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283548">ExtraExtensions</span>&nbsp;<span class="op" id="4283564">[</span><span class="op" id="4283565">]</span><span class="ident" id="4283566">pkix</span><span class="op" id="4283570">.</span><span class="ident" id="4283571">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283583">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4283602">[</span><span class="op" id="4283603">]</span><span class="ident" id="4283604">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4283626">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283663">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4283682">[</span><span class="op" id="4283683">]</span><span class="ident" id="4283684">asn1</span><span class="op" id="4283688">.</span><span class="ident" id="4283689">ObjectIdentifier</span>&nbsp;<span class="comment" id="4283706">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283768">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4283790">bool</span>&nbsp;<span class="comment" id="4283795">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283843">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4283865">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4283871">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4283893">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283898">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4283964">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284037">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284107">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284126">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4284141">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284148">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4284163">[</span><span class="op" id="4284164">]</span><span class="builtintype" id="4284165">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284171">AuthorityKeyId</span>&nbsp;<span class="op" id="4284186">[</span><span class="op" id="4284187">]</span><span class="builtintype" id="4284188">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284195">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284248">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4284270">[</span><span class="op" id="4284271">]</span><span class="builtintype" id="4284272">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284280">IssuingCertificateURL</span>&nbsp;<span class="op" id="4284302">[</span><span class="op" id="4284303">]</span><span class="builtintype" id="4284304">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284313">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284347">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4284362">[</span><span class="op" id="4284363">]</span><span class="builtintype" id="4284364">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284372">EmailAddresses</span>&nbsp;<span class="op" id="4284387">[</span><span class="op" id="4284388">]</span><span class="builtintype" id="4284389">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284397">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4284412">[</span><span class="op" id="4284413">]</span><span class="ident" id="4284414">net</span><span class="op" id="4284417">.</span><span class="ident" id="4284418">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284423">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284444">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4284472">bool</span>&nbsp;<span class="comment" id="4284477">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284536">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4284564">[</span><span class="op" id="4284565">]</span><span class="builtintype" id="4284566">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4284575">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284603">CRLDistributionPoints</span>&nbsp;<span class="op" id="4284625">[</span><span class="op" id="4284626">]</span><span class="builtintype" id="4284627">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4284636">PolicyIdentifiers</span>&nbsp;<span class="op" id="4284654">[</span><span class="op" id="4284655">]</span><span class="ident" id="4284656">asn1</span><span class="op" id="4284660">.</span><span class="ident" id="4284661">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4284678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4284681">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4284761">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4284820">var</span>&nbsp;<span class="ident" id="4284824">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4284848">=</span>&nbsp;<span class="ident" id="4284850">errors</span><span class="op" id="4284856">.</span><span class="ident" id="4284857">New</span><span class="op" id="4284860">(</span><span class="string" id="4284861">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4284917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4284920">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4284999">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4285079">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4285107">type</span>&nbsp;<span class="ident" id="4285112">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4285137">struct</span><span class="op" id="4285143">{</span><span class="op" id="4285144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4285147">func</span>&nbsp;<span class="op" id="4285152">(</span><span class="ident" id="4285153">ConstraintViolationError</span><span class="op" id="4285177">)</span>&nbsp;<span class="ident" id="4285179">Error</span><span class="op" id="4285184">(</span><span class="op" id="4285185">)</span>&nbsp;<span class="builtintype" id="4285187">string</span>&nbsp;<span class="op" id="4285194">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285197">return</span>&nbsp;<span class="string" id="4285204">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4285287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4285290">func</span>&nbsp;<span class="op" id="4285295">(</span><span class="ident" id="4285296">c</span>&nbsp;<span class="op" id="4285298">*</span><span class="ident" id="4285299">Certificate</span><span class="op" id="4285310">)</span>&nbsp;<span class="ident" id="4285312">Equal</span><span class="op" id="4285317">(</span><span class="ident" id="4285318">other</span>&nbsp;<span class="op" id="4285324">*</span><span class="ident" id="4285325">Certificate</span><span class="op" id="4285336">)</span>&nbsp;<span class="builtintype" id="4285338">bool</span>&nbsp;<span class="op" id="4285343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4285346">return</span>&nbsp;<span class="ident" id="4285353">bytes</span><span class="op" id="4285358">.</span><span class="ident" id="4285359">Equal</span><span class="op" id="4285364">(</span><span class="ident" id="4285365">c</span><span class="op" id="4285366">.</span><span class="ident" id="4285367">Raw</span><span class="op" id="4285370">,</span>&nbsp;<span class="ident" id="4285372">other</span><span class="op" id="4285377">.</span><span class="ident" id="4285378">Raw</span><span class="op" id="4285381">)</span><br>
<span class="lineno">540</span><span class="op" id="4285383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4285386">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4285458">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4285538">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4285560">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4285635">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4285678">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4285744">//</span><br>
<span class="lineno"></span><span class="comment" id="4285747">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4285819">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4285834">var</span>&nbsp;<span class="ident" id="4285838">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4285856">=</span>&nbsp;<span class="op" id="4285858">[</span><span class="op" id="4285859">]</span><span class="builtintype" id="4285860">byte</span><span class="op" id="4285864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4285867">0x30</span><span class="op" id="4285871">,</span>&nbsp;<span class="num" id="4285873">0x82</span><span class="op" id="4285877">,</span>&nbsp;<span class="num" id="4285879">0x01</span><span class="op" id="4285883">,</span>&nbsp;<span class="num" id="4285885">0x22</span><span class="op" id="4285889">,</span>&nbsp;<span class="num" id="4285891">0x30</span><span class="op" id="4285895">,</span>&nbsp;<span class="num" id="4285897">0x0d</span><span class="op" id="4285901">,</span>&nbsp;<span class="num" id="4285903">0x06</span><span class="op" id="4285907">,</span>&nbsp;<span class="num" id="4285909">0x09</span><span class="op" id="4285913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4285916">0x2a</span><span class="op" id="4285920">,</span>&nbsp;<span class="num" id="4285922">0x86</span><span class="op" id="4285926">,</span>&nbsp;<span class="num" id="4285928">0x48</span><span class="op" id="4285932">,</span>&nbsp;<span class="num" id="4285934">0x86</span><span class="op" id="4285938">,</span>&nbsp;<span class="num" id="4285940">0xf7</span><span class="op" id="4285944">,</span>&nbsp;<span class="num" id="4285946">0x0d</span><span class="op" id="4285950">,</span>&nbsp;<span class="num" id="4285952">0x01</span><span class="op" id="4285956">,</span>&nbsp;<span class="num" id="4285958">0x01</span><span class="op" id="4285962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4285965">0x01</span><span class="op" id="4285969">,</span>&nbsp;<span class="num" id="4285971">0x05</span><span class="op" id="4285975">,</span>&nbsp;<span class="num" id="4285977">0x00</span><span class="op" id="4285981">,</span>&nbsp;<span class="num" id="4285983">0x03</span><span class="op" id="4285987">,</span>&nbsp;<span class="num" id="4285989">0x82</span><span class="op" id="4285993">,</span>&nbsp;<span class="num" id="4285995">0x01</span><span class="op" id="4285999">,</span>&nbsp;<span class="num" id="4286001">0x0f</span><span class="op" id="4286005">,</span>&nbsp;<span class="num" id="4286007">0x00</span><span class="op" id="4286011">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286014">0x30</span><span class="op" id="4286018">,</span>&nbsp;<span class="num" id="4286020">0x82</span><span class="op" id="4286024">,</span>&nbsp;<span class="num" id="4286026">0x01</span><span class="op" id="4286030">,</span>&nbsp;<span class="num" id="4286032">0x0a</span><span class="op" id="4286036">,</span>&nbsp;<span class="num" id="4286038">0x02</span><span class="op" id="4286042">,</span>&nbsp;<span class="num" id="4286044">0x82</span><span class="op" id="4286048">,</span>&nbsp;<span class="num" id="4286050">0x01</span><span class="op" id="4286054">,</span>&nbsp;<span class="num" id="4286056">0x01</span><span class="op" id="4286060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286063">0x00</span><span class="op" id="4286067">,</span>&nbsp;<span class="num" id="4286069">0x97</span><span class="op" id="4286073">,</span>&nbsp;<span class="num" id="4286075">0xa3</span><span class="op" id="4286079">,</span>&nbsp;<span class="num" id="4286081">0x2d</span><span class="op" id="4286085">,</span>&nbsp;<span class="num" id="4286087">0x3c</span><span class="op" id="4286091">,</span>&nbsp;<span class="num" id="4286093">0x9e</span><span class="op" id="4286097">,</span>&nbsp;<span class="num" id="4286099">0xde</span><span class="op" id="4286103">,</span>&nbsp;<span class="num" id="4286105">0x05</span><span class="op" id="4286109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286112">0xda</span><span class="op" id="4286116">,</span>&nbsp;<span class="num" id="4286118">0x13</span><span class="op" id="4286122">,</span>&nbsp;<span class="num" id="4286124">0xc2</span><span class="op" id="4286128">,</span>&nbsp;<span class="num" id="4286130">0x11</span><span class="op" id="4286134">,</span>&nbsp;<span class="num" id="4286136">0x8d</span><span class="op" id="4286140">,</span>&nbsp;<span class="num" id="4286142">0x9d</span><span class="op" id="4286146">,</span>&nbsp;<span class="num" id="4286148">0x8e</span><span class="op" id="4286152">,</span>&nbsp;<span class="num" id="4286154">0xe3</span><span class="op" id="4286158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286161">0x7f</span><span class="op" id="4286165">,</span>&nbsp;<span class="num" id="4286167">0xc7</span><span class="op" id="4286171">,</span>&nbsp;<span class="num" id="4286173">0x4b</span><span class="op" id="4286177">,</span>&nbsp;<span class="num" id="4286179">0x7e</span><span class="op" id="4286183">,</span>&nbsp;<span class="num" id="4286185">0x5a</span><span class="op" id="4286189">,</span>&nbsp;<span class="num" id="4286191">0x9f</span><span class="op" id="4286195">,</span>&nbsp;<span class="num" id="4286197">0xb3</span><span class="op" id="4286201">,</span>&nbsp;<span class="num" id="4286203">0xff</span><span class="op" id="4286207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286210">0x62</span><span class="op" id="4286214">,</span>&nbsp;<span class="num" id="4286216">0xab</span><span class="op" id="4286220">,</span>&nbsp;<span class="num" id="4286222">0x73</span><span class="op" id="4286226">,</span>&nbsp;<span class="num" id="4286228">0xc8</span><span class="op" id="4286232">,</span>&nbsp;<span class="num" id="4286234">0x28</span><span class="op" id="4286238">,</span>&nbsp;<span class="num" id="4286240">0x6b</span><span class="op" id="4286244">,</span>&nbsp;<span class="num" id="4286246">0xba</span><span class="op" id="4286250">,</span>&nbsp;<span class="num" id="4286252">0x10</span><span class="op" id="4286256">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286259">0x64</span><span class="op" id="4286263">,</span>&nbsp;<span class="num" id="4286265">0x82</span><span class="op" id="4286269">,</span>&nbsp;<span class="num" id="4286271">0x87</span><span class="op" id="4286275">,</span>&nbsp;<span class="num" id="4286277">0x13</span><span class="op" id="4286281">,</span>&nbsp;<span class="num" id="4286283">0xcd</span><span class="op" id="4286287">,</span>&nbsp;<span class="num" id="4286289">0x57</span><span class="op" id="4286293">,</span>&nbsp;<span class="num" id="4286295">0x18</span><span class="op" id="4286299">,</span>&nbsp;<span class="num" id="4286301">0xff</span><span class="op" id="4286305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286308">0x28</span><span class="op" id="4286312">,</span>&nbsp;<span class="num" id="4286314">0xce</span><span class="op" id="4286318">,</span>&nbsp;<span class="num" id="4286320">0xc0</span><span class="op" id="4286324">,</span>&nbsp;<span class="num" id="4286326">0xe6</span><span class="op" id="4286330">,</span>&nbsp;<span class="num" id="4286332">0x0e</span><span class="op" id="4286336">,</span>&nbsp;<span class="num" id="4286338">0x06</span><span class="op" id="4286342">,</span>&nbsp;<span class="num" id="4286344">0x91</span><span class="op" id="4286348">,</span>&nbsp;<span class="num" id="4286350">0x50</span><span class="op" id="4286354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286357">0x29</span><span class="op" id="4286361">,</span>&nbsp;<span class="num" id="4286363">0x83</span><span class="op" id="4286367">,</span>&nbsp;<span class="num" id="4286369">0xd1</span><span class="op" id="4286373">,</span>&nbsp;<span class="num" id="4286375">0xf2</span><span class="op" id="4286379">,</span>&nbsp;<span class="num" id="4286381">0xc3</span><span class="op" id="4286385">,</span>&nbsp;<span class="num" id="4286387">0x2a</span><span class="op" id="4286391">,</span>&nbsp;<span class="num" id="4286393">0xdb</span><span class="op" id="4286397">,</span>&nbsp;<span class="num" id="4286399">0xd8</span><span class="op" id="4286403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286406">0xdb</span><span class="op" id="4286410">,</span>&nbsp;<span class="num" id="4286412">0x4e</span><span class="op" id="4286416">,</span>&nbsp;<span class="num" id="4286418">0x04</span><span class="op" id="4286422">,</span>&nbsp;<span class="num" id="4286424">0xcc</span><span class="op" id="4286428">,</span>&nbsp;<span class="num" id="4286430">0x00</span><span class="op" id="4286434">,</span>&nbsp;<span class="num" id="4286436">0xeb</span><span class="op" id="4286440">,</span>&nbsp;<span class="num" id="4286442">0x8b</span><span class="op" id="4286446">,</span>&nbsp;<span class="num" id="4286448">0xb6</span><span class="op" id="4286452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286455">0x96</span><span class="op" id="4286459">,</span>&nbsp;<span class="num" id="4286461">0xdc</span><span class="op" id="4286465">,</span>&nbsp;<span class="num" id="4286467">0xbc</span><span class="op" id="4286471">,</span>&nbsp;<span class="num" id="4286473">0xaa</span><span class="op" id="4286477">,</span>&nbsp;<span class="num" id="4286479">0xfa</span><span class="op" id="4286483">,</span>&nbsp;<span class="num" id="4286485">0x52</span><span class="op" id="4286489">,</span>&nbsp;<span class="num" id="4286491">0x77</span><span class="op" id="4286495">,</span>&nbsp;<span class="num" id="4286497">0x04</span><span class="op" id="4286501">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286504">0xc1</span><span class="op" id="4286508">,</span>&nbsp;<span class="num" id="4286510">0xdb</span><span class="op" id="4286514">,</span>&nbsp;<span class="num" id="4286516">0x19</span><span class="op" id="4286520">,</span>&nbsp;<span class="num" id="4286522">0xe4</span><span class="op" id="4286526">,</span>&nbsp;<span class="num" id="4286528">0xae</span><span class="op" id="4286532">,</span>&nbsp;<span class="num" id="4286534">0x9c</span><span class="op" id="4286538">,</span>&nbsp;<span class="num" id="4286540">0xfd</span><span class="op" id="4286544">,</span>&nbsp;<span class="num" id="4286546">0x3c</span><span class="op" id="4286550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286553">0x8b</span><span class="op" id="4286557">,</span>&nbsp;<span class="num" id="4286559">0x03</span><span class="op" id="4286563">,</span>&nbsp;<span class="num" id="4286565">0xef</span><span class="op" id="4286569">,</span>&nbsp;<span class="num" id="4286571">0x4d</span><span class="op" id="4286575">,</span>&nbsp;<span class="num" id="4286577">0xbc</span><span class="op" id="4286581">,</span>&nbsp;<span class="num" id="4286583">0x1a</span><span class="op" id="4286587">,</span>&nbsp;<span class="num" id="4286589">0x03</span><span class="op" id="4286593">,</span>&nbsp;<span class="num" id="4286595">0x65</span><span class="op" id="4286599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286602">0xf9</span><span class="op" id="4286606">,</span>&nbsp;<span class="num" id="4286608">0xc1</span><span class="op" id="4286612">,</span>&nbsp;<span class="num" id="4286614">0xb1</span><span class="op" id="4286618">,</span>&nbsp;<span class="num" id="4286620">0x3f</span><span class="op" id="4286624">,</span>&nbsp;<span class="num" id="4286626">0x72</span><span class="op" id="4286630">,</span>&nbsp;<span class="num" id="4286632">0x86</span><span class="op" id="4286636">,</span>&nbsp;<span class="num" id="4286638">0xf2</span><span class="op" id="4286642">,</span>&nbsp;<span class="num" id="4286644">0x38</span><span class="op" id="4286648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286651">0xaa</span><span class="op" id="4286655">,</span>&nbsp;<span class="num" id="4286657">0x19</span><span class="op" id="4286661">,</span>&nbsp;<span class="num" id="4286663">0xae</span><span class="op" id="4286667">,</span>&nbsp;<span class="num" id="4286669">0x10</span><span class="op" id="4286673">,</span>&nbsp;<span class="num" id="4286675">0x88</span><span class="op" id="4286679">,</span>&nbsp;<span class="num" id="4286681">0x78</span><span class="op" id="4286685">,</span>&nbsp;<span class="num" id="4286687">0x28</span><span class="op" id="4286691">,</span>&nbsp;<span class="num" id="4286693">0xda</span><span class="op" id="4286697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286700">0x75</span><span class="op" id="4286704">,</span>&nbsp;<span class="num" id="4286706">0xc3</span><span class="op" id="4286710">,</span>&nbsp;<span class="num" id="4286712">0x3d</span><span class="op" id="4286716">,</span>&nbsp;<span class="num" id="4286718">0x02</span><span class="op" id="4286722">,</span>&nbsp;<span class="num" id="4286724">0x82</span><span class="op" id="4286728">,</span>&nbsp;<span class="num" id="4286730">0x02</span><span class="op" id="4286734">,</span>&nbsp;<span class="num" id="4286736">0x9c</span><span class="op" id="4286740">,</span>&nbsp;<span class="num" id="4286742">0xb9</span><span class="op" id="4286746">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286749">0xc1</span><span class="op" id="4286753">,</span>&nbsp;<span class="num" id="4286755">0x65</span><span class="op" id="4286759">,</span>&nbsp;<span class="num" id="4286761">0x77</span><span class="op" id="4286765">,</span>&nbsp;<span class="num" id="4286767">0x76</span><span class="op" id="4286771">,</span>&nbsp;<span class="num" id="4286773">0x24</span><span class="op" id="4286777">,</span>&nbsp;<span class="num" id="4286779">0x4c</span><span class="op" id="4286783">,</span>&nbsp;<span class="num" id="4286785">0x98</span><span class="op" id="4286789">,</span>&nbsp;<span class="num" id="4286791">0xf7</span><span class="op" id="4286795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286798">0x6d</span><span class="op" id="4286802">,</span>&nbsp;<span class="num" id="4286804">0x31</span><span class="op" id="4286808">,</span>&nbsp;<span class="num" id="4286810">0x38</span><span class="op" id="4286814">,</span>&nbsp;<span class="num" id="4286816">0xfb</span><span class="op" id="4286820">,</span>&nbsp;<span class="num" id="4286822">0xdb</span><span class="op" id="4286826">,</span>&nbsp;<span class="num" id="4286828">0xfe</span><span class="op" id="4286832">,</span>&nbsp;<span class="num" id="4286834">0xdb</span><span class="op" id="4286838">,</span>&nbsp;<span class="num" id="4286840">0x37</span><span class="op" id="4286844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286847">0x02</span><span class="op" id="4286851">,</span>&nbsp;<span class="num" id="4286853">0x76</span><span class="op" id="4286857">,</span>&nbsp;<span class="num" id="4286859">0xa1</span><span class="op" id="4286863">,</span>&nbsp;<span class="num" id="4286865">0x18</span><span class="op" id="4286869">,</span>&nbsp;<span class="num" id="4286871">0x97</span><span class="op" id="4286875">,</span>&nbsp;<span class="num" id="4286877">0xa6</span><span class="op" id="4286881">,</span>&nbsp;<span class="num" id="4286883">0xcc</span><span class="op" id="4286887">,</span>&nbsp;<span class="num" id="4286889">0xde</span><span class="op" id="4286893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286896">0x20</span><span class="op" id="4286900">,</span>&nbsp;<span class="num" id="4286902">0x09</span><span class="op" id="4286906">,</span>&nbsp;<span class="num" id="4286908">0x49</span><span class="op" id="4286912">,</span>&nbsp;<span class="num" id="4286914">0x36</span><span class="op" id="4286918">,</span>&nbsp;<span class="num" id="4286920">0x24</span><span class="op" id="4286924">,</span>&nbsp;<span class="num" id="4286926">0x69</span><span class="op" id="4286930">,</span>&nbsp;<span class="num" id="4286932">0x42</span><span class="op" id="4286936">,</span>&nbsp;<span class="num" id="4286938">0xf6</span><span class="op" id="4286942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286945">0xe4</span><span class="op" id="4286949">,</span>&nbsp;<span class="num" id="4286951">0x37</span><span class="op" id="4286955">,</span>&nbsp;<span class="num" id="4286957">0x62</span><span class="op" id="4286961">,</span>&nbsp;<span class="num" id="4286963">0xf1</span><span class="op" id="4286967">,</span>&nbsp;<span class="num" id="4286969">0x59</span><span class="op" id="4286973">,</span>&nbsp;<span class="num" id="4286975">0x6d</span><span class="op" id="4286979">,</span>&nbsp;<span class="num" id="4286981">0xa9</span><span class="op" id="4286985">,</span>&nbsp;<span class="num" id="4286987">0x3c</span><span class="op" id="4286991">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4286994">0xed</span><span class="op" id="4286998">,</span>&nbsp;<span class="num" id="4287000">0x34</span><span class="op" id="4287004">,</span>&nbsp;<span class="num" id="4287006">0x9c</span><span class="op" id="4287010">,</span>&nbsp;<span class="num" id="4287012">0xa3</span><span class="op" id="4287016">,</span>&nbsp;<span class="num" id="4287018">0x8e</span><span class="op" id="4287022">,</span>&nbsp;<span class="num" id="4287024">0xdb</span><span class="op" id="4287028">,</span>&nbsp;<span class="num" id="4287030">0xdc</span><span class="op" id="4287034">,</span>&nbsp;<span class="num" id="4287036">0x3a</span><span class="op" id="4287040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287043">0xd7</span><span class="op" id="4287047">,</span>&nbsp;<span class="num" id="4287049">0xf7</span><span class="op" id="4287053">,</span>&nbsp;<span class="num" id="4287055">0x0a</span><span class="op" id="4287059">,</span>&nbsp;<span class="num" id="4287061">0x6f</span><span class="op" id="4287065">,</span>&nbsp;<span class="num" id="4287067">0xef</span><span class="op" id="4287071">,</span>&nbsp;<span class="num" id="4287073">0x2e</span><span class="op" id="4287077">,</span>&nbsp;<span class="num" id="4287079">0xd8</span><span class="op" id="4287083">,</span>&nbsp;<span class="num" id="4287085">0xd5</span><span class="op" id="4287089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287092">0x93</span><span class="op" id="4287096">,</span>&nbsp;<span class="num" id="4287098">0x5a</span><span class="op" id="4287102">,</span>&nbsp;<span class="num" id="4287104">0x7a</span><span class="op" id="4287108">,</span>&nbsp;<span class="num" id="4287110">0xed</span><span class="op" id="4287114">,</span>&nbsp;<span class="num" id="4287116">0x08</span><span class="op" id="4287120">,</span>&nbsp;<span class="num" id="4287122">0x49</span><span class="op" id="4287126">,</span>&nbsp;<span class="num" id="4287128">0x68</span><span class="op" id="4287132">,</span>&nbsp;<span class="num" id="4287134">0xe2</span><span class="op" id="4287138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287141">0x41</span><span class="op" id="4287145">,</span>&nbsp;<span class="num" id="4287147">0xe3</span><span class="op" id="4287151">,</span>&nbsp;<span class="num" id="4287153">0x5a</span><span class="op" id="4287157">,</span>&nbsp;<span class="num" id="4287159">0x90</span><span class="op" id="4287163">,</span>&nbsp;<span class="num" id="4287165">0xc1</span><span class="op" id="4287169">,</span>&nbsp;<span class="num" id="4287171">0x86</span><span class="op" id="4287175">,</span>&nbsp;<span class="num" id="4287177">0x55</span><span class="op" id="4287181">,</span>&nbsp;<span class="num" id="4287183">0xfc</span><span class="op" id="4287187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287190">0x51</span><span class="op" id="4287194">,</span>&nbsp;<span class="num" id="4287196">0x43</span><span class="op" id="4287200">,</span>&nbsp;<span class="num" id="4287202">0x9d</span><span class="op" id="4287206">,</span>&nbsp;<span class="num" id="4287208">0xe0</span><span class="op" id="4287212">,</span>&nbsp;<span class="num" id="4287214">0xb2</span><span class="op" id="4287218">,</span>&nbsp;<span class="num" id="4287220">0xc4</span><span class="op" id="4287224">,</span>&nbsp;<span class="num" id="4287226">0x67</span><span class="op" id="4287230">,</span>&nbsp;<span class="num" id="4287232">0xb4</span><span class="op" id="4287236">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287239">0xcb</span><span class="op" id="4287243">,</span>&nbsp;<span class="num" id="4287245">0x32</span><span class="op" id="4287249">,</span>&nbsp;<span class="num" id="4287251">0x31</span><span class="op" id="4287255">,</span>&nbsp;<span class="num" id="4287257">0x25</span><span class="op" id="4287261">,</span>&nbsp;<span class="num" id="4287263">0xf0</span><span class="op" id="4287267">,</span>&nbsp;<span class="num" id="4287269">0x54</span><span class="op" id="4287273">,</span>&nbsp;<span class="num" id="4287275">0x9f</span><span class="op" id="4287279">,</span>&nbsp;<span class="num" id="4287281">0x4b</span><span class="op" id="4287285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287288">0xd1</span><span class="op" id="4287292">,</span>&nbsp;<span class="num" id="4287294">0x6f</span><span class="op" id="4287298">,</span>&nbsp;<span class="num" id="4287300">0xdb</span><span class="op" id="4287304">,</span>&nbsp;<span class="num" id="4287306">0xd4</span><span class="op" id="4287310">,</span>&nbsp;<span class="num" id="4287312">0xdd</span><span class="op" id="4287316">,</span>&nbsp;<span class="num" id="4287318">0xfc</span><span class="op" id="4287322">,</span>&nbsp;<span class="num" id="4287324">0xaf</span><span class="op" id="4287328">,</span>&nbsp;<span class="num" id="4287330">0x5e</span><span class="op" id="4287334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287337">0x6c</span><span class="op" id="4287341">,</span>&nbsp;<span class="num" id="4287343">0x78</span><span class="op" id="4287347">,</span>&nbsp;<span class="num" id="4287349">0x90</span><span class="op" id="4287353">,</span>&nbsp;<span class="num" id="4287355">0x95</span><span class="op" id="4287359">,</span>&nbsp;<span class="num" id="4287361">0xde</span><span class="op" id="4287365">,</span>&nbsp;<span class="num" id="4287367">0xca</span><span class="op" id="4287371">,</span>&nbsp;<span class="num" id="4287373">0x3a</span><span class="op" id="4287377">,</span>&nbsp;<span class="num" id="4287379">0x48</span><span class="op" id="4287383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287386">0xb9</span><span class="op" id="4287390">,</span>&nbsp;<span class="num" id="4287392">0x79</span><span class="op" id="4287396">,</span>&nbsp;<span class="num" id="4287398">0x3c</span><span class="op" id="4287402">,</span>&nbsp;<span class="num" id="4287404">0x9b</span><span class="op" id="4287408">,</span>&nbsp;<span class="num" id="4287410">0x19</span><span class="op" id="4287414">,</span>&nbsp;<span class="num" id="4287416">0xd6</span><span class="op" id="4287420">,</span>&nbsp;<span class="num" id="4287422">0x75</span><span class="op" id="4287426">,</span>&nbsp;<span class="num" id="4287428">0x05</span><span class="op" id="4287432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287435">0xa0</span><span class="op" id="4287439">,</span>&nbsp;<span class="num" id="4287441">0xf9</span><span class="op" id="4287445">,</span>&nbsp;<span class="num" id="4287447">0x88</span><span class="op" id="4287451">,</span>&nbsp;<span class="num" id="4287453">0xd7</span><span class="op" id="4287457">,</span>&nbsp;<span class="num" id="4287459">0xc1</span><span class="op" id="4287463">,</span>&nbsp;<span class="num" id="4287465">0xe8</span><span class="op" id="4287469">,</span>&nbsp;<span class="num" id="4287471">0xa5</span><span class="op" id="4287475">,</span>&nbsp;<span class="num" id="4287477">0x09</span><span class="op" id="4287481">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287484">0xe4</span><span class="op" id="4287488">,</span>&nbsp;<span class="num" id="4287490">0x1a</span><span class="op" id="4287494">,</span>&nbsp;<span class="num" id="4287496">0x15</span><span class="op" id="4287500">,</span>&nbsp;<span class="num" id="4287502">0xdc</span><span class="op" id="4287506">,</span>&nbsp;<span class="num" id="4287508">0x87</span><span class="op" id="4287512">,</span>&nbsp;<span class="num" id="4287514">0x23</span><span class="op" id="4287518">,</span>&nbsp;<span class="num" id="4287520">0xaa</span><span class="op" id="4287524">,</span>&nbsp;<span class="num" id="4287526">0xb2</span><span class="op" id="4287530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287533">0x75</span><span class="op" id="4287537">,</span>&nbsp;<span class="num" id="4287539">0x8c</span><span class="op" id="4287543">,</span>&nbsp;<span class="num" id="4287545">0x63</span><span class="op" id="4287549">,</span>&nbsp;<span class="num" id="4287551">0x25</span><span class="op" id="4287555">,</span>&nbsp;<span class="num" id="4287557">0x87</span><span class="op" id="4287561">,</span>&nbsp;<span class="num" id="4287563">0xd8</span><span class="op" id="4287567">,</span>&nbsp;<span class="num" id="4287569">0xf8</span><span class="op" id="4287573">,</span>&nbsp;<span class="num" id="4287575">0x3d</span><span class="op" id="4287579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287582">0xa6</span><span class="op" id="4287586">,</span>&nbsp;<span class="num" id="4287588">0xc2</span><span class="op" id="4287592">,</span>&nbsp;<span class="num" id="4287594">0xcc</span><span class="op" id="4287598">,</span>&nbsp;<span class="num" id="4287600">0x66</span><span class="op" id="4287604">,</span>&nbsp;<span class="num" id="4287606">0xff</span><span class="op" id="4287610">,</span>&nbsp;<span class="num" id="4287612">0xa5</span><span class="op" id="4287616">,</span>&nbsp;<span class="num" id="4287618">0x66</span><span class="op" id="4287622">,</span>&nbsp;<span class="num" id="4287624">0x68</span><span class="op" id="4287628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4287631">0x55</span><span class="op" id="4287635">,</span>&nbsp;<span class="num" id="4287637">0x02</span><span class="op" id="4287641">,</span>&nbsp;<span class="num" id="4287643">0x03</span><span class="op" id="4287647">,</span>&nbsp;<span class="num" id="4287649">0x01</span><span class="op" id="4287653">,</span>&nbsp;<span class="num" id="4287655">0x00</span><span class="op" id="4287659">,</span>&nbsp;<span class="num" id="4287661">0x01</span><span class="op" id="4287665">,</span><br>
<span class="lineno"></span><span class="op" id="4287667">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4287670">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4287746">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4287762">func</span>&nbsp;<span class="op" id="4287767">(</span><span class="ident" id="4287768">c</span>&nbsp;<span class="op" id="4287770">*</span><span class="ident" id="4287771">Certificate</span><span class="op" id="4287782">)</span>&nbsp;<span class="ident" id="4287784">CheckSignatureFrom</span><span class="op" id="4287802">(</span><span class="ident" id="4287803">parent</span>&nbsp;<span class="op" id="4287810">*</span><span class="ident" id="4287811">Certificate</span><span class="op" id="4287822">)</span>&nbsp;<span class="op" id="4287824">(</span><span class="ident" id="4287825">err</span>&nbsp;<span class="builtintype" id="4287829">error</span><span class="op" id="4287834">)</span>&nbsp;<span class="op" id="4287836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287839">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287862">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4287932">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4288003">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4288074">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4288103">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288165">if</span>&nbsp;<span class="op" id="4288168">(</span><span class="ident" id="4288169">parent</span><span class="op" id="4288175">.</span><span class="ident" id="4288176">Version</span>&nbsp;<span class="op" id="4288184">==</span>&nbsp;<span class="num" id="4288187">3</span>&nbsp;<span class="op" id="4288189">&amp;&amp;</span>&nbsp;<span class="op" id="4288192">!</span><span class="ident" id="4288193">parent</span><span class="op" id="4288199">.</span><span class="ident" id="4288200">BasicConstraintsValid</span>&nbsp;<span class="op" id="4288222">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288227">parent</span><span class="op" id="4288233">.</span><span class="ident" id="4288234">BasicConstraintsValid</span>&nbsp;<span class="op" id="4288256">&amp;&amp;</span>&nbsp;<span class="op" id="4288259">!</span><span class="ident" id="4288260">parent</span><span class="op" id="4288266">.</span><span class="ident" id="4288267">IsCA</span><span class="op" id="4288271">)</span>&nbsp;<span class="op" id="4288273">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4288278">!</span><span class="ident" id="4288279">bytes</span><span class="op" id="4288284">.</span><span class="ident" id="4288285">Equal</span><span class="op" id="4288290">(</span><span class="ident" id="4288291">c</span><span class="op" id="4288292">.</span><span class="ident" id="4288293">RawSubjectPublicKeyInfo</span><span class="op" id="4288316">,</span>&nbsp;<span class="ident" id="4288318">entrustBrokenSPKI</span><span class="op" id="4288335">)</span>&nbsp;<span class="op" id="4288337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288341">return</span>&nbsp;<span class="ident" id="4288348">ConstraintViolationError</span><span class="op" id="4288372">{</span><span class="op" id="4288373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4288376">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288380">if</span>&nbsp;<span class="ident" id="4288383">parent</span><span class="op" id="4288389">.</span><span class="ident" id="4288390">KeyUsage</span>&nbsp;<span class="op" id="4288399">!=</span>&nbsp;<span class="num" id="4288402">0</span>&nbsp;<span class="op" id="4288404">&amp;&amp;</span>&nbsp;<span class="ident" id="4288407">parent</span><span class="op" id="4288413">.</span><span class="ident" id="4288414">KeyUsage</span><span class="op" id="4288422">&amp;</span><span class="ident" id="4288423">KeyUsageCertSign</span>&nbsp;<span class="op" id="4288440">==</span>&nbsp;<span class="num" id="4288443">0</span>&nbsp;<span class="op" id="4288445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288449">return</span>&nbsp;<span class="ident" id="4288456">ConstraintViolationError</span><span class="op" id="4288480">{</span><span class="op" id="4288481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4288484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288488">if</span>&nbsp;<span class="ident" id="4288491">parent</span><span class="op" id="4288497">.</span><span class="ident" id="4288498">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4288517">==</span>&nbsp;<span class="ident" id="4288520">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4288546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288550">return</span>&nbsp;<span class="ident" id="4288557">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4288582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4288586">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288643">return</span>&nbsp;<span class="ident" id="4288650">parent</span><span class="op" id="4288656">.</span><span class="ident" id="4288657">CheckSignature</span><span class="op" id="4288671">(</span><span class="ident" id="4288672">c</span><span class="op" id="4288673">.</span><span class="ident" id="4288674">SignatureAlgorithm</span><span class="op" id="4288692">,</span>&nbsp;<span class="ident" id="4288694">c</span><span class="op" id="4288695">.</span><span class="ident" id="4288696">RawTBSCertificate</span><span class="op" id="4288713">,</span>&nbsp;<span class="ident" id="4288715">c</span><span class="op" id="4288716">.</span><span class="ident" id="4288717">Signature</span><span class="op" id="4288726">)</span><br>
<span class="lineno"></span><span class="op" id="4288728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4288731">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4288811">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4288830">func</span>&nbsp;<span class="op" id="4288835">(</span><span class="ident" id="4288836">c</span>&nbsp;<span class="op" id="4288838">*</span><span class="ident" id="4288839">Certificate</span><span class="op" id="4288850">)</span>&nbsp;<span class="ident" id="4288852">CheckSignature</span><span class="op" id="4288866">(</span><span class="ident" id="4288867">algo</span>&nbsp;<span class="ident" id="4288872">SignatureAlgorithm</span><span class="op" id="4288890">,</span>&nbsp;<span class="ident" id="4288892">signed</span><span class="op" id="4288898">,</span>&nbsp;<span class="ident" id="4288900">signature</span>&nbsp;<span class="op" id="4288910">[</span><span class="op" id="4288911">]</span><span class="builtintype" id="4288912">byte</span><span class="op" id="4288916">)</span>&nbsp;<span class="op" id="4288918">(</span><span class="ident" id="4288919">err</span>&nbsp;<span class="builtintype" id="4288923">error</span><span class="op" id="4288928">)</span>&nbsp;<span class="op" id="4288930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288933">var</span>&nbsp;<span class="ident" id="4288937">hashType</span>&nbsp;<span class="ident" id="4288946">crypto</span><span class="op" id="4288952">.</span><span class="ident" id="4288953">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288960">switch</span>&nbsp;<span class="ident" id="4288967">algo</span>&nbsp;<span class="op" id="4288972">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4288975">case</span>&nbsp;<span class="ident" id="4288980">SHA1WithRSA</span><span class="op" id="4288991">,</span>&nbsp;<span class="ident" id="4288993">DSAWithSHA1</span><span class="op" id="4289004">,</span>&nbsp;<span class="ident" id="4289006">ECDSAWithSHA1</span><span class="op" id="4289019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289023">hashType</span>&nbsp;<span class="op" id="4289032">=</span>&nbsp;<span class="ident" id="4289034">crypto</span><span class="op" id="4289040">.</span><span class="ident" id="4289041">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289047">case</span>&nbsp;<span class="ident" id="4289052">SHA256WithRSA</span><span class="op" id="4289065">,</span>&nbsp;<span class="ident" id="4289067">DSAWithSHA256</span><span class="op" id="4289080">,</span>&nbsp;<span class="ident" id="4289082">ECDSAWithSHA256</span><span class="op" id="4289097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289101">hashType</span>&nbsp;<span class="op" id="4289110">=</span>&nbsp;<span class="ident" id="4289112">crypto</span><span class="op" id="4289118">.</span><span class="ident" id="4289119">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289127">case</span>&nbsp;<span class="ident" id="4289132">SHA384WithRSA</span><span class="op" id="4289145">,</span>&nbsp;<span class="ident" id="4289147">ECDSAWithSHA384</span><span class="op" id="4289162">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289166">hashType</span>&nbsp;<span class="op" id="4289175">=</span>&nbsp;<span class="ident" id="4289177">crypto</span><span class="op" id="4289183">.</span><span class="ident" id="4289184">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289192">case</span>&nbsp;<span class="ident" id="4289197">SHA512WithRSA</span><span class="op" id="4289210">,</span>&nbsp;<span class="ident" id="4289212">ECDSAWithSHA512</span><span class="op" id="4289227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289231">hashType</span>&nbsp;<span class="op" id="4289240">=</span>&nbsp;<span class="ident" id="4289242">crypto</span><span class="op" id="4289248">.</span><span class="ident" id="4289249">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289257">default</span><span class="op" id="4289264">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289268">return</span>&nbsp;<span class="ident" id="4289275">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4289300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289304">if</span>&nbsp;<span class="op" id="4289307">!</span><span class="ident" id="4289308">hashType</span><span class="op" id="4289316">.</span><span class="ident" id="4289317">Available</span><span class="op" id="4289326">(</span><span class="op" id="4289327">)</span>&nbsp;<span class="op" id="4289329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289333">return</span>&nbsp;<span class="ident" id="4289340">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4289365">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289368">h</span>&nbsp;<span class="op" id="4289370">:=</span>&nbsp;<span class="ident" id="4289373">hashType</span><span class="op" id="4289381">.</span><span class="ident" id="4289382">New</span><span class="op" id="4289385">(</span><span class="op" id="4289386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289390">h</span><span class="op" id="4289391">.</span><span class="ident" id="4289392">Write</span><span class="op" id="4289397">(</span><span class="ident" id="4289398">signed</span><span class="op" id="4289404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289407">digest</span>&nbsp;<span class="op" id="4289414">:=</span>&nbsp;<span class="ident" id="4289417">h</span><span class="op" id="4289418">.</span><span class="ident" id="4289419">Sum</span><span class="op" id="4289422">(</span><span class="ident" id="4289423">nil</span><span class="op" id="4289426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289430">switch</span>&nbsp;<span class="ident" id="4289437">pub</span>&nbsp;<span class="op" id="4289441">:=</span>&nbsp;<span class="ident" id="4289444">c</span><span class="op" id="4289445">.</span><span class="ident" id="4289446">PublicKey</span><span class="op" id="4289455">.</span><span class="op" id="4289456">(</span><span class="keyword" id="4289457">type</span><span class="op" id="4289461">)</span>&nbsp;<span class="op" id="4289463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289466">case</span>&nbsp;<span class="op" id="4289471">*</span><span class="ident" id="4289472">rsa</span><span class="op" id="4289475">.</span><span class="ident" id="4289476">PublicKey</span><span class="op" id="4289485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289489">return</span>&nbsp;<span class="ident" id="4289496">rsa</span><span class="op" id="4289499">.</span><span class="ident" id="4289500">VerifyPKCS1v15</span><span class="op" id="4289514">(</span><span class="ident" id="4289515">pub</span><span class="op" id="4289518">,</span>&nbsp;<span class="ident" id="4289520">hashType</span><span class="op" id="4289528">,</span>&nbsp;<span class="ident" id="4289530">digest</span><span class="op" id="4289536">,</span>&nbsp;<span class="ident" id="4289538">signature</span><span class="op" id="4289547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289550">case</span>&nbsp;<span class="op" id="4289555">*</span><span class="ident" id="4289556">dsa</span><span class="op" id="4289559">.</span><span class="ident" id="4289560">PublicKey</span><span class="op" id="4289569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289573">dsaSig</span>&nbsp;<span class="op" id="4289580">:=</span>&nbsp;<span class="builtinfunc" id="4289583">new</span><span class="op" id="4289586">(</span><span class="ident" id="4289587">dsaSignature</span><span class="op" id="4289599">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289603">if</span>&nbsp;<span class="ident" id="4289606">_</span><span class="op" id="4289607">,</span>&nbsp;<span class="ident" id="4289609">err</span>&nbsp;<span class="op" id="4289613">:=</span>&nbsp;<span class="ident" id="4289616">asn1</span><span class="op" id="4289620">.</span><span class="ident" id="4289621">Unmarshal</span><span class="op" id="4289630">(</span><span class="ident" id="4289631">signature</span><span class="op" id="4289640">,</span>&nbsp;<span class="ident" id="4289642">dsaSig</span><span class="op" id="4289648">)</span><span class="op" id="4289649">;</span>&nbsp;<span class="ident" id="4289651">err</span>&nbsp;<span class="op" id="4289655">!=</span>&nbsp;<span class="ident" id="4289658">nil</span>&nbsp;<span class="op" id="4289662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289667">return</span>&nbsp;<span class="ident" id="4289674">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4289680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289684">if</span>&nbsp;<span class="ident" id="4289687">dsaSig</span><span class="op" id="4289693">.</span><span class="ident" id="4289694">R</span><span class="op" id="4289695">.</span><span class="ident" id="4289696">Sign</span><span class="op" id="4289700">(</span><span class="op" id="4289701">)</span>&nbsp;<span class="op" id="4289703">&lt;=</span>&nbsp;<span class="num" id="4289706">0</span>&nbsp;<span class="op" id="4289708">||</span>&nbsp;<span class="ident" id="4289711">dsaSig</span><span class="op" id="4289717">.</span><span class="ident" id="4289718">S</span><span class="op" id="4289719">.</span><span class="ident" id="4289720">Sign</span><span class="op" id="4289724">(</span><span class="op" id="4289725">)</span>&nbsp;<span class="op" id="4289727">&lt;=</span>&nbsp;<span class="num" id="4289730">0</span>&nbsp;<span class="op" id="4289732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289737">return</span>&nbsp;<span class="ident" id="4289744">errors</span><span class="op" id="4289750">.</span><span class="ident" id="4289751">New</span><span class="op" id="4289754">(</span><span class="string" id="4289755">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4289810">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4289814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289818">if</span>&nbsp;<span class="op" id="4289821">!</span><span class="ident" id="4289822">dsa</span><span class="op" id="4289825">.</span><span class="ident" id="4289826">Verify</span><span class="op" id="4289832">(</span><span class="ident" id="4289833">pub</span><span class="op" id="4289836">,</span>&nbsp;<span class="ident" id="4289838">digest</span><span class="op" id="4289844">,</span>&nbsp;<span class="ident" id="4289846">dsaSig</span><span class="op" id="4289852">.</span><span class="ident" id="4289853">R</span><span class="op" id="4289854">,</span>&nbsp;<span class="ident" id="4289856">dsaSig</span><span class="op" id="4289862">.</span><span class="ident" id="4289863">S</span><span class="op" id="4289864">)</span>&nbsp;<span class="op" id="4289866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289871">return</span>&nbsp;<span class="ident" id="4289878">errors</span><span class="op" id="4289884">.</span><span class="ident" id="4289885">New</span><span class="op" id="4289888">(</span><span class="string" id="4289889">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4289921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4289925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289929">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289937">case</span>&nbsp;<span class="op" id="4289942">*</span><span class="ident" id="4289943">ecdsa</span><span class="op" id="4289948">.</span><span class="ident" id="4289949">PublicKey</span><span class="op" id="4289958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289962">ecdsaSig</span>&nbsp;<span class="op" id="4289971">:=</span>&nbsp;<span class="builtinfunc" id="4289974">new</span><span class="op" id="4289977">(</span><span class="ident" id="4289978">ecdsaSignature</span><span class="op" id="4289992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289996">if</span>&nbsp;<span class="ident" id="4289999">_</span><span class="op" id="4290000">,</span>&nbsp;<span class="ident" id="4290002">err</span>&nbsp;<span class="op" id="4290006">:=</span>&nbsp;<span class="ident" id="4290009">asn1</span><span class="op" id="4290013">.</span><span class="ident" id="4290014">Unmarshal</span><span class="op" id="4290023">(</span><span class="ident" id="4290024">signature</span><span class="op" id="4290033">,</span>&nbsp;<span class="ident" id="4290035">ecdsaSig</span><span class="op" id="4290043">)</span><span class="op" id="4290044">;</span>&nbsp;<span class="ident" id="4290046">err</span>&nbsp;<span class="op" id="4290050">!=</span>&nbsp;<span class="ident" id="4290053">nil</span>&nbsp;<span class="op" id="4290057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290062">return</span>&nbsp;<span class="ident" id="4290069">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290075">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290079">if</span>&nbsp;<span class="ident" id="4290082">ecdsaSig</span><span class="op" id="4290090">.</span><span class="ident" id="4290091">R</span><span class="op" id="4290092">.</span><span class="ident" id="4290093">Sign</span><span class="op" id="4290097">(</span><span class="op" id="4290098">)</span>&nbsp;<span class="op" id="4290100">&lt;=</span>&nbsp;<span class="num" id="4290103">0</span>&nbsp;<span class="op" id="4290105">||</span>&nbsp;<span class="ident" id="4290108">ecdsaSig</span><span class="op" id="4290116">.</span><span class="ident" id="4290117">S</span><span class="op" id="4290118">.</span><span class="ident" id="4290119">Sign</span><span class="op" id="4290123">(</span><span class="op" id="4290124">)</span>&nbsp;<span class="op" id="4290126">&lt;=</span>&nbsp;<span class="num" id="4290129">0</span>&nbsp;<span class="op" id="4290131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290136">return</span>&nbsp;<span class="ident" id="4290143">errors</span><span class="op" id="4290149">.</span><span class="ident" id="4290150">New</span><span class="op" id="4290153">(</span><span class="string" id="4290154">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4290211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290219">if</span>&nbsp;<span class="op" id="4290222">!</span><span class="ident" id="4290223">ecdsa</span><span class="op" id="4290228">.</span><span class="ident" id="4290229">Verify</span><span class="op" id="4290235">(</span><span class="ident" id="4290236">pub</span><span class="op" id="4290239">,</span>&nbsp;<span class="ident" id="4290241">digest</span><span class="op" id="4290247">,</span>&nbsp;<span class="ident" id="4290249">ecdsaSig</span><span class="op" id="4290257">.</span><span class="ident" id="4290258">R</span><span class="op" id="4290259">,</span>&nbsp;<span class="ident" id="4290261">ecdsaSig</span><span class="op" id="4290269">.</span><span class="ident" id="4290270">S</span><span class="op" id="4290271">)</span>&nbsp;<span class="op" id="4290273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290278">return</span>&nbsp;<span class="ident" id="4290285">errors</span><span class="op" id="4290291">.</span><span class="ident" id="4290292">New</span><span class="op" id="4290295">(</span><span class="string" id="4290296">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4290330">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290338">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290349">return</span>&nbsp;<span class="ident" id="4290356">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4290380">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4290383">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4290448">func</span>&nbsp;<span class="op" id="4290453">(</span><span class="ident" id="4290454">c</span>&nbsp;<span class="op" id="4290456">*</span><span class="ident" id="4290457">Certificate</span><span class="op" id="4290468">)</span>&nbsp;<span class="ident" id="4290470">CheckCRLSignature</span><span class="op" id="4290487">(</span><span class="ident" id="4290488">crl</span>&nbsp;<span class="op" id="4290492">*</span><span class="ident" id="4290493">pkix</span><span class="op" id="4290497">.</span><span class="ident" id="4290498">CertificateList</span><span class="op" id="4290513">)</span>&nbsp;<span class="op" id="4290515">(</span><span class="ident" id="4290516">err</span>&nbsp;<span class="builtintype" id="4290520">error</span><span class="op" id="4290525">)</span>&nbsp;<span class="op" id="4290527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290530">algo</span>&nbsp;<span class="op" id="4290535">:=</span>&nbsp;<span class="ident" id="4290538">getSignatureAlgorithmFromOID</span><span class="op" id="4290566">(</span><span class="ident" id="4290567">crl</span><span class="op" id="4290570">.</span><span class="ident" id="4290571">SignatureAlgorithm</span><span class="op" id="4290589">.</span><span class="ident" id="4290590">Algorithm</span><span class="op" id="4290599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290602">return</span>&nbsp;<span class="ident" id="4290609">c</span><span class="op" id="4290610">.</span><span class="ident" id="4290611">CheckSignature</span><span class="op" id="4290625">(</span><span class="ident" id="4290626">algo</span><span class="op" id="4290630">,</span>&nbsp;<span class="ident" id="4290632">crl</span><span class="op" id="4290635">.</span><span class="ident" id="4290636">TBSCertList</span><span class="op" id="4290647">.</span><span class="ident" id="4290648">Raw</span><span class="op" id="4290651">,</span>&nbsp;<span class="ident" id="4290653">crl</span><span class="op" id="4290656">.</span><span class="ident" id="4290657">SignatureValue</span><span class="op" id="4290671">.</span><span class="ident" id="4290672">RightAlign</span><span class="op" id="4290682">(</span><span class="op" id="4290683">)</span><span class="op" id="4290684">)</span><br>
<span class="lineno">680</span><span class="op" id="4290686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4290689">type</span>&nbsp;<span class="ident" id="4290694">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4290721">struct</span><span class="op" id="4290727">{</span><span class="op" id="4290728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4290731">func</span>&nbsp;<span class="op" id="4290736">(</span><span class="ident" id="4290737">h</span>&nbsp;<span class="ident" id="4290739">UnhandledCriticalExtension</span><span class="op" id="4290765">)</span>&nbsp;<span class="ident" id="4290767">Error</span><span class="op" id="4290772">(</span><span class="op" id="4290773">)</span>&nbsp;<span class="builtintype" id="4290775">string</span>&nbsp;<span class="op" id="4290782">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290785">return</span>&nbsp;<span class="string" id="4290792">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4290829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4290832">type</span>&nbsp;<span class="ident" id="4290837">basicConstraints</span>&nbsp;<span class="keyword" id="4290854">struct</span>&nbsp;<span class="op" id="4290861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290864">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4290875">bool</span>&nbsp;<span class="string" id="4290880">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290899">MaxPathLen</span>&nbsp;<span class="builtintype" id="4290910">int</span>&nbsp;&nbsp;<span class="string" id="4290915">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4290944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4290947">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4290967">type</span>&nbsp;<span class="ident" id="4290972">policyInformation</span>&nbsp;<span class="keyword" id="4290990">struct</span>&nbsp;<span class="op" id="4290997">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291000">Policy</span>&nbsp;<span class="ident" id="4291007">asn1</span><span class="op" id="4291011">.</span><span class="ident" id="4291012">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4291030">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4291058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4291061">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4291083">type</span>&nbsp;<span class="ident" id="4291088">nameConstraints</span>&nbsp;<span class="keyword" id="4291104">struct</span>&nbsp;<span class="op" id="4291111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291114">Permitted</span>&nbsp;<span class="op" id="4291124">[</span><span class="op" id="4291125">]</span><span class="ident" id="4291126">generalSubtree</span>&nbsp;<span class="string" id="4291141">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291166">Excluded</span>&nbsp;&nbsp;<span class="op" id="4291176">[</span><span class="op" id="4291177">]</span><span class="ident" id="4291178">generalSubtree</span>&nbsp;<span class="string" id="4291193">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4291217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4291220">type</span>&nbsp;<span class="ident" id="4291225">generalSubtree</span>&nbsp;<span class="keyword" id="4291240">struct</span>&nbsp;<span class="op" id="4291247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291250">Name</span>&nbsp;<span class="builtintype" id="4291255">string</span>&nbsp;<span class="string" id="4291262">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4291290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4291293">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4291314">type</span>&nbsp;<span class="ident" id="4291319">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4291339">struct</span>&nbsp;<span class="op" id="4291346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291349">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4291358">asn1</span><span class="op" id="4291362">.</span><span class="ident" id="4291363">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291381">Location</span>&nbsp;<span class="ident" id="4291390">asn1</span><span class="op" id="4291394">.</span><span class="ident" id="4291395">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4291404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4291407">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4291429">type</span>&nbsp;<span class="ident" id="4291434">distributionPoint</span>&nbsp;<span class="keyword" id="4291452">struct</span>&nbsp;<span class="op" id="4291459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291462">DistributionPoint</span>&nbsp;<span class="ident" id="4291480">distributionPointName</span>&nbsp;<span class="string" id="4291502">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291527">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4291545">asn1</span><span class="op" id="4291549">.</span><span class="ident" id="4291550">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4291567">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291592">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4291610">asn1</span><span class="op" id="4291614">.</span><span class="ident" id="4291615">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4291632">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4291656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4291659">type</span>&nbsp;<span class="ident" id="4291664">distributionPointName</span>&nbsp;<span class="keyword" id="4291686">struct</span>&nbsp;<span class="op" id="4291693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291696">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4291709">asn1</span><span class="op" id="4291713">.</span><span class="ident" id="4291714">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4291726">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291751">RelativeName</span>&nbsp;<span class="ident" id="4291764">pkix</span><span class="op" id="4291768">.</span><span class="ident" id="4291769">RDNSequence</span>&nbsp;<span class="string" id="4291781">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4291805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4291808">func</span>&nbsp;<span class="ident" id="4291813">parsePublicKey</span><span class="op" id="4291827">(</span><span class="ident" id="4291828">algo</span>&nbsp;<span class="ident" id="4291833">PublicKeyAlgorithm</span><span class="op" id="4291851">,</span>&nbsp;<span class="ident" id="4291853">keyData</span>&nbsp;<span class="op" id="4291861">*</span><span class="ident" id="4291862">publicKeyInfo</span><span class="op" id="4291875">)</span>&nbsp;<span class="op" id="4291877">(</span><span class="keyword" id="4291878">interface</span><span class="op" id="4291887">{</span><span class="op" id="4291888">}</span><span class="op" id="4291889">,</span>&nbsp;<span class="builtintype" id="4291891">error</span><span class="op" id="4291896">)</span>&nbsp;<span class="op" id="4291898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291901">asn1Data</span>&nbsp;<span class="op" id="4291910">:=</span>&nbsp;<span class="ident" id="4291913">keyData</span><span class="op" id="4291920">.</span><span class="ident" id="4291921">PublicKey</span><span class="op" id="4291930">.</span><span class="ident" id="4291931">RightAlign</span><span class="op" id="4291941">(</span><span class="op" id="4291942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291945">switch</span>&nbsp;<span class="ident" id="4291952">algo</span>&nbsp;<span class="op" id="4291957">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291960">case</span>&nbsp;<span class="ident" id="4291965">RSA</span><span class="op" id="4291968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291972">p</span>&nbsp;<span class="op" id="4291974">:=</span>&nbsp;<span class="builtinfunc" id="4291977">new</span><span class="op" id="4291980">(</span><span class="ident" id="4291981">rsaPublicKey</span><span class="op" id="4291993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291997">_</span><span class="op" id="4291998">,</span>&nbsp;<span class="ident" id="4292000">err</span>&nbsp;<span class="op" id="4292004">:=</span>&nbsp;<span class="ident" id="4292007">asn1</span><span class="op" id="4292011">.</span><span class="ident" id="4292012">Unmarshal</span><span class="op" id="4292021">(</span><span class="ident" id="4292022">asn1Data</span><span class="op" id="4292030">,</span>&nbsp;<span class="ident" id="4292032">p</span><span class="op" id="4292033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292037">if</span>&nbsp;<span class="ident" id="4292040">err</span>&nbsp;<span class="op" id="4292044">!=</span>&nbsp;<span class="ident" id="4292047">nil</span>&nbsp;<span class="op" id="4292051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292056">return</span>&nbsp;<span class="ident" id="4292063">nil</span><span class="op" id="4292066">,</span>&nbsp;<span class="ident" id="4292068">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292079">if</span>&nbsp;<span class="ident" id="4292082">p</span><span class="op" id="4292083">.</span><span class="ident" id="4292084">N</span><span class="op" id="4292085">.</span><span class="ident" id="4292086">Sign</span><span class="op" id="4292090">(</span><span class="op" id="4292091">)</span>&nbsp;<span class="op" id="4292093">&lt;=</span>&nbsp;<span class="num" id="4292096">0</span>&nbsp;<span class="op" id="4292098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292103">return</span>&nbsp;<span class="ident" id="4292110">nil</span><span class="op" id="4292113">,</span>&nbsp;<span class="ident" id="4292115">errors</span><span class="op" id="4292121">.</span><span class="ident" id="4292122">New</span><span class="op" id="4292125">(</span><span class="string" id="4292126">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4292170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292174">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292178">if</span>&nbsp;<span class="ident" id="4292181">p</span><span class="op" id="4292182">.</span><span class="ident" id="4292183">E</span>&nbsp;<span class="op" id="4292185">&lt;=</span>&nbsp;<span class="num" id="4292188">0</span>&nbsp;<span class="op" id="4292190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292195">return</span>&nbsp;<span class="ident" id="4292202">nil</span><span class="op" id="4292205">,</span>&nbsp;<span class="ident" id="4292207">errors</span><span class="op" id="4292213">.</span><span class="ident" id="4292214">New</span><span class="op" id="4292217">(</span><span class="string" id="4292218">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4292270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292279">pub</span>&nbsp;<span class="op" id="4292283">:=</span>&nbsp;<span class="op" id="4292286">&amp;</span><span class="ident" id="4292287">rsa</span><span class="op" id="4292290">.</span><span class="ident" id="4292291">PublicKey</span><span class="op" id="4292300">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292305">E</span><span class="op" id="4292306">:</span>&nbsp;<span class="ident" id="4292308">p</span><span class="op" id="4292309">.</span><span class="ident" id="4292310">E</span><span class="op" id="4292311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292316">N</span><span class="op" id="4292317">:</span>&nbsp;<span class="ident" id="4292319">p</span><span class="op" id="4292320">.</span><span class="ident" id="4292321">N</span><span class="op" id="4292322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292330">return</span>&nbsp;<span class="ident" id="4292337">pub</span><span class="op" id="4292340">,</span>&nbsp;<span class="ident" id="4292342">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292347">case</span>&nbsp;<span class="ident" id="4292352">DSA</span><span class="op" id="4292355">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292359">var</span>&nbsp;<span class="ident" id="4292363">p</span>&nbsp;<span class="op" id="4292365">*</span><span class="ident" id="4292366">big</span><span class="op" id="4292369">.</span><span class="ident" id="4292370">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292376">_</span><span class="op" id="4292377">,</span>&nbsp;<span class="ident" id="4292379">err</span>&nbsp;<span class="op" id="4292383">:=</span>&nbsp;<span class="ident" id="4292386">asn1</span><span class="op" id="4292390">.</span><span class="ident" id="4292391">Unmarshal</span><span class="op" id="4292400">(</span><span class="ident" id="4292401">asn1Data</span><span class="op" id="4292409">,</span>&nbsp;<span class="op" id="4292411">&amp;</span><span class="ident" id="4292412">p</span><span class="op" id="4292413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292417">if</span>&nbsp;<span class="ident" id="4292420">err</span>&nbsp;<span class="op" id="4292424">!=</span>&nbsp;<span class="ident" id="4292427">nil</span>&nbsp;<span class="op" id="4292431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292436">return</span>&nbsp;<span class="ident" id="4292443">nil</span><span class="op" id="4292446">,</span>&nbsp;<span class="ident" id="4292448">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292454">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292458">paramsData</span>&nbsp;<span class="op" id="4292469">:=</span>&nbsp;<span class="ident" id="4292472">keyData</span><span class="op" id="4292479">.</span><span class="ident" id="4292480">Algorithm</span><span class="op" id="4292489">.</span><span class="ident" id="4292490">Parameters</span><span class="op" id="4292500">.</span><span class="ident" id="4292501">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292513">params</span>&nbsp;<span class="op" id="4292520">:=</span>&nbsp;<span class="builtinfunc" id="4292523">new</span><span class="op" id="4292526">(</span><span class="ident" id="4292527">dsaAlgorithmParameters</span><span class="op" id="4292549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292553">_</span><span class="op" id="4292554">,</span>&nbsp;<span class="ident" id="4292556">err</span>&nbsp;<span class="op" id="4292560">=</span>&nbsp;<span class="ident" id="4292562">asn1</span><span class="op" id="4292566">.</span><span class="ident" id="4292567">Unmarshal</span><span class="op" id="4292576">(</span><span class="ident" id="4292577">paramsData</span><span class="op" id="4292587">,</span>&nbsp;<span class="ident" id="4292589">params</span><span class="op" id="4292595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292599">if</span>&nbsp;<span class="ident" id="4292602">err</span>&nbsp;<span class="op" id="4292606">!=</span>&nbsp;<span class="ident" id="4292609">nil</span>&nbsp;<span class="op" id="4292613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292618">return</span>&nbsp;<span class="ident" id="4292625">nil</span><span class="op" id="4292628">,</span>&nbsp;<span class="ident" id="4292630">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292640">if</span>&nbsp;<span class="ident" id="4292643">p</span><span class="op" id="4292644">.</span><span class="ident" id="4292645">Sign</span><span class="op" id="4292649">(</span><span class="op" id="4292650">)</span>&nbsp;<span class="op" id="4292652">&lt;=</span>&nbsp;<span class="num" id="4292655">0</span>&nbsp;<span class="op" id="4292657">||</span>&nbsp;<span class="ident" id="4292660">params</span><span class="op" id="4292666">.</span><span class="ident" id="4292667">P</span><span class="op" id="4292668">.</span><span class="ident" id="4292669">Sign</span><span class="op" id="4292673">(</span><span class="op" id="4292674">)</span>&nbsp;<span class="op" id="4292676">&lt;=</span>&nbsp;<span class="num" id="4292679">0</span>&nbsp;<span class="op" id="4292681">||</span>&nbsp;<span class="ident" id="4292684">params</span><span class="op" id="4292690">.</span><span class="ident" id="4292691">Q</span><span class="op" id="4292692">.</span><span class="ident" id="4292693">Sign</span><span class="op" id="4292697">(</span><span class="op" id="4292698">)</span>&nbsp;<span class="op" id="4292700">&lt;=</span>&nbsp;<span class="num" id="4292703">0</span>&nbsp;<span class="op" id="4292705">||</span>&nbsp;<span class="ident" id="4292708">params</span><span class="op" id="4292714">.</span><span class="ident" id="4292715">G</span><span class="op" id="4292716">.</span><span class="ident" id="4292717">Sign</span><span class="op" id="4292721">(</span><span class="op" id="4292722">)</span>&nbsp;<span class="op" id="4292724">&lt;=</span>&nbsp;<span class="num" id="4292727">0</span>&nbsp;<span class="op" id="4292729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292734">return</span>&nbsp;<span class="ident" id="4292741">nil</span><span class="op" id="4292744">,</span>&nbsp;<span class="ident" id="4292746">errors</span><span class="op" id="4292752">.</span><span class="ident" id="4292753">New</span><span class="op" id="4292756">(</span><span class="string" id="4292757">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4292795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292803">pub</span>&nbsp;<span class="op" id="4292807">:=</span>&nbsp;<span class="op" id="4292810">&amp;</span><span class="ident" id="4292811">dsa</span><span class="op" id="4292814">.</span><span class="ident" id="4292815">PublicKey</span><span class="op" id="4292824">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292829">Parameters</span><span class="op" id="4292839">:</span>&nbsp;<span class="ident" id="4292841">dsa</span><span class="op" id="4292844">.</span><span class="ident" id="4292845">Parameters</span><span class="op" id="4292855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292861">P</span><span class="op" id="4292862">:</span>&nbsp;<span class="ident" id="4292864">params</span><span class="op" id="4292870">.</span><span class="ident" id="4292871">P</span><span class="op" id="4292872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292878">Q</span><span class="op" id="4292879">:</span>&nbsp;<span class="ident" id="4292881">params</span><span class="op" id="4292887">.</span><span class="ident" id="4292888">Q</span><span class="op" id="4292889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292895">G</span><span class="op" id="4292896">:</span>&nbsp;<span class="ident" id="4292898">params</span><span class="op" id="4292904">.</span><span class="ident" id="4292905">G</span><span class="op" id="4292906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292911">}</span><span class="op" id="4292912">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292917">Y</span><span class="op" id="4292918">:</span>&nbsp;<span class="ident" id="4292920">p</span><span class="op" id="4292921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292929">return</span>&nbsp;<span class="ident" id="4292936">pub</span><span class="op" id="4292939">,</span>&nbsp;<span class="ident" id="4292941">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292946">case</span>&nbsp;<span class="ident" id="4292951">ECDSA</span><span class="op" id="4292956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292960">paramsData</span>&nbsp;<span class="op" id="4292971">:=</span>&nbsp;<span class="ident" id="4292974">keyData</span><span class="op" id="4292981">.</span><span class="ident" id="4292982">Algorithm</span><span class="op" id="4292991">.</span><span class="ident" id="4292992">Parameters</span><span class="op" id="4293002">.</span><span class="ident" id="4293003">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293015">namedCurveOID</span>&nbsp;<span class="op" id="4293029">:=</span>&nbsp;<span class="builtinfunc" id="4293032">new</span><span class="op" id="4293035">(</span><span class="ident" id="4293036">asn1</span><span class="op" id="4293040">.</span><span class="ident" id="4293041">ObjectIdentifier</span><span class="op" id="4293057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293061">_</span><span class="op" id="4293062">,</span>&nbsp;<span class="ident" id="4293064">err</span>&nbsp;<span class="op" id="4293068">:=</span>&nbsp;<span class="ident" id="4293071">asn1</span><span class="op" id="4293075">.</span><span class="ident" id="4293076">Unmarshal</span><span class="op" id="4293085">(</span><span class="ident" id="4293086">paramsData</span><span class="op" id="4293096">,</span>&nbsp;<span class="ident" id="4293098">namedCurveOID</span><span class="op" id="4293111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293115">if</span>&nbsp;<span class="ident" id="4293118">err</span>&nbsp;<span class="op" id="4293122">!=</span>&nbsp;<span class="ident" id="4293125">nil</span>&nbsp;<span class="op" id="4293129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293134">return</span>&nbsp;<span class="ident" id="4293141">nil</span><span class="op" id="4293144">,</span>&nbsp;<span class="ident" id="4293146">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293152">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293156">namedCurve</span>&nbsp;<span class="op" id="4293167">:=</span>&nbsp;<span class="ident" id="4293170">namedCurveFromOID</span><span class="op" id="4293187">(</span><span class="op" id="4293188">*</span><span class="ident" id="4293189">namedCurveOID</span><span class="op" id="4293202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293206">if</span>&nbsp;<span class="ident" id="4293209">namedCurve</span>&nbsp;<span class="op" id="4293220">==</span>&nbsp;<span class="ident" id="4293223">nil</span>&nbsp;<span class="op" id="4293227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293232">return</span>&nbsp;<span class="ident" id="4293239">nil</span><span class="op" id="4293242">,</span>&nbsp;<span class="ident" id="4293244">errors</span><span class="op" id="4293250">.</span><span class="ident" id="4293251">New</span><span class="op" id="4293254">(</span><span class="string" id="4293255">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4293289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293297">x</span><span class="op" id="4293298">,</span>&nbsp;<span class="ident" id="4293300">y</span>&nbsp;<span class="op" id="4293302">:=</span>&nbsp;<span class="ident" id="4293305">elliptic</span><span class="op" id="4293313">.</span><span class="ident" id="4293314">Unmarshal</span><span class="op" id="4293323">(</span><span class="ident" id="4293324">namedCurve</span><span class="op" id="4293334">,</span>&nbsp;<span class="ident" id="4293336">asn1Data</span><span class="op" id="4293344">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293348">if</span>&nbsp;<span class="ident" id="4293351">x</span>&nbsp;<span class="op" id="4293353">==</span>&nbsp;<span class="ident" id="4293356">nil</span>&nbsp;<span class="op" id="4293360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293365">return</span>&nbsp;<span class="ident" id="4293372">nil</span><span class="op" id="4293375">,</span>&nbsp;<span class="ident" id="4293377">errors</span><span class="op" id="4293383">.</span><span class="ident" id="4293384">New</span><span class="op" id="4293387">(</span><span class="string" id="4293388">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4293436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293444">pub</span>&nbsp;<span class="op" id="4293448">:=</span>&nbsp;<span class="op" id="4293451">&amp;</span><span class="ident" id="4293452">ecdsa</span><span class="op" id="4293457">.</span><span class="ident" id="4293458">PublicKey</span><span class="op" id="4293467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293472">Curve</span><span class="op" id="4293477">:</span>&nbsp;<span class="ident" id="4293479">namedCurve</span><span class="op" id="4293489">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293494">X</span><span class="op" id="4293495">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4293501">x</span><span class="op" id="4293502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293507">Y</span><span class="op" id="4293508">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4293514">y</span><span class="op" id="4293515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293523">return</span>&nbsp;<span class="ident" id="4293530">pub</span><span class="op" id="4293533">,</span>&nbsp;<span class="ident" id="4293535">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293540">default</span><span class="op" id="4293547">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293551">return</span>&nbsp;<span class="ident" id="4293558">nil</span><span class="op" id="4293561">,</span>&nbsp;<span class="ident" id="4293563">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293568">}</span><br>
<span class="lineno"></span><span class="op" id="4293570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4293573">func</span>&nbsp;<span class="ident" id="4293578">parseSANExtension</span><span class="op" id="4293595">(</span><span class="ident" id="4293596">value</span>&nbsp;<span class="op" id="4293602">[</span><span class="op" id="4293603">]</span><span class="builtintype" id="4293604">byte</span><span class="op" id="4293608">)</span>&nbsp;<span class="op" id="4293610">(</span><span class="ident" id="4293611">dnsNames</span><span class="op" id="4293619">,</span>&nbsp;<span class="ident" id="4293621">emailAddresses</span>&nbsp;<span class="op" id="4293636">[</span><span class="op" id="4293637">]</span><span class="builtintype" id="4293638">string</span><span class="op" id="4293644">,</span>&nbsp;<span class="ident" id="4293646">ipAddresses</span>&nbsp;<span class="op" id="4293658">[</span><span class="op" id="4293659">]</span><span class="ident" id="4293660">net</span><span class="op" id="4293663">.</span><span class="ident" id="4293664">IP</span><span class="op" id="4293666">,</span>&nbsp;<span class="ident" id="4293668">err</span>&nbsp;<span class="builtintype" id="4293672">error</span><span class="op" id="4293677">)</span>&nbsp;<span class="op" id="4293679">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293682">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293705">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293741">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293745">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293804">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293808">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293897">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4293957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294077">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294255">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4294318">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294387">var</span>&nbsp;<span class="ident" id="4294391">seq</span>&nbsp;<span class="ident" id="4294395">asn1</span><span class="op" id="4294399">.</span><span class="ident" id="4294400">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294410">if</span>&nbsp;<span class="ident" id="4294413">_</span><span class="op" id="4294414">,</span>&nbsp;<span class="ident" id="4294416">err</span>&nbsp;<span class="op" id="4294420">=</span>&nbsp;<span class="ident" id="4294422">asn1</span><span class="op" id="4294426">.</span><span class="ident" id="4294427">Unmarshal</span><span class="op" id="4294436">(</span><span class="ident" id="4294437">value</span><span class="op" id="4294442">,</span>&nbsp;<span class="op" id="4294444">&amp;</span><span class="ident" id="4294445">seq</span><span class="op" id="4294448">)</span><span class="op" id="4294449">;</span>&nbsp;<span class="ident" id="4294451">err</span>&nbsp;<span class="op" id="4294455">!=</span>&nbsp;<span class="ident" id="4294458">nil</span>&nbsp;<span class="op" id="4294462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294466">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294474">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294477">if</span>&nbsp;<span class="op" id="4294480">!</span><span class="ident" id="4294481">seq</span><span class="op" id="4294484">.</span><span class="ident" id="4294485">IsCompound</span>&nbsp;<span class="op" id="4294496">||</span>&nbsp;<span class="ident" id="4294499">seq</span><span class="op" id="4294502">.</span><span class="ident" id="4294503">Tag</span>&nbsp;<span class="op" id="4294507">!=</span>&nbsp;<span class="num" id="4294510">16</span>&nbsp;<span class="op" id="4294513">||</span>&nbsp;<span class="ident" id="4294516">seq</span><span class="op" id="4294519">.</span><span class="ident" id="4294520">Class</span>&nbsp;<span class="op" id="4294526">!=</span>&nbsp;<span class="num" id="4294529">0</span>&nbsp;<span class="op" id="4294531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294535">err</span>&nbsp;<span class="op" id="4294539">=</span>&nbsp;<span class="ident" id="4294541">asn1</span><span class="op" id="4294545">.</span><span class="ident" id="4294546">StructuralError</span><span class="op" id="4294561">{</span><span class="ident" id="4294562">Msg</span><span class="op" id="4294565">:</span>&nbsp;<span class="string" id="4294567">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4294585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294589">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294601">rest</span>&nbsp;<span class="op" id="4294606">:=</span>&nbsp;<span class="ident" id="4294609">seq</span><span class="op" id="4294612">.</span><span class="ident" id="4294613">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294620">for</span>&nbsp;<span class="builtinfunc" id="4294624">len</span><span class="op" id="4294627">(</span><span class="ident" id="4294628">rest</span><span class="op" id="4294632">)</span>&nbsp;<span class="op" id="4294634">&gt;</span>&nbsp;<span class="num" id="4294636">0</span>&nbsp;<span class="op" id="4294638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294642">var</span>&nbsp;<span class="ident" id="4294646">v</span>&nbsp;<span class="ident" id="4294648">asn1</span><span class="op" id="4294652">.</span><span class="ident" id="4294653">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294664">rest</span><span class="op" id="4294668">,</span>&nbsp;<span class="ident" id="4294670">err</span>&nbsp;<span class="op" id="4294674">=</span>&nbsp;<span class="ident" id="4294676">asn1</span><span class="op" id="4294680">.</span><span class="ident" id="4294681">Unmarshal</span><span class="op" id="4294690">(</span><span class="ident" id="4294691">rest</span><span class="op" id="4294695">,</span>&nbsp;<span class="op" id="4294697">&amp;</span><span class="ident" id="4294698">v</span><span class="op" id="4294699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294703">if</span>&nbsp;<span class="ident" id="4294706">err</span>&nbsp;<span class="op" id="4294710">!=</span>&nbsp;<span class="ident" id="4294713">nil</span>&nbsp;<span class="op" id="4294717">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294722">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4294731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294735">switch</span>&nbsp;<span class="ident" id="4294742">v</span><span class="op" id="4294743">.</span><span class="ident" id="4294744">Tag</span>&nbsp;<span class="op" id="4294748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294752">case</span>&nbsp;<span class="num" id="4294757">1</span><span class="op" id="4294758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294763">emailAddresses</span>&nbsp;<span class="op" id="4294778">=</span>&nbsp;<span class="builtinfunc" id="4294780">append</span><span class="op" id="4294786">(</span><span class="ident" id="4294787">emailAddresses</span><span class="op" id="4294801">,</span>&nbsp;<span class="builtintype" id="4294803">string</span><span class="op" id="4294809">(</span><span class="ident" id="4294810">v</span><span class="op" id="4294811">.</span><span class="ident" id="4294812">Bytes</span><span class="op" id="4294817">)</span><span class="op" id="4294818">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294822">case</span>&nbsp;<span class="num" id="4294827">2</span><span class="op" id="4294828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294833">dnsNames</span>&nbsp;<span class="op" id="4294842">=</span>&nbsp;<span class="builtinfunc" id="4294844">append</span><span class="op" id="4294850">(</span><span class="ident" id="4294851">dnsNames</span><span class="op" id="4294859">,</span>&nbsp;<span class="builtintype" id="4294861">string</span><span class="op" id="4294867">(</span><span class="ident" id="4294868">v</span><span class="op" id="4294869">.</span><span class="ident" id="4294870">Bytes</span><span class="op" id="4294875">)</span><span class="op" id="4294876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294880">case</span>&nbsp;<span class="num" id="4294885">7</span><span class="op" id="4294886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294891">switch</span>&nbsp;<span class="builtinfunc" id="4294898">len</span><span class="op" id="4294901">(</span><span class="ident" id="4294902">v</span><span class="op" id="4294903">.</span><span class="ident" id="4294904">Bytes</span><span class="op" id="4294909">)</span>&nbsp;<span class="op" id="4294911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294916">case</span>&nbsp;<span class="ident" id="4294921">net</span><span class="op" id="4294924">.</span><span class="ident" id="4294925">IPv4len</span><span class="op" id="4294932">,</span>&nbsp;<span class="ident" id="4294934">net</span><span class="op" id="4294937">.</span><span class="ident" id="4294938">IPv6len</span><span class="op" id="4294945">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4294951">ipAddresses</span>&nbsp;<span class="op" id="4294963">=</span>&nbsp;<span class="builtinfunc" id="4294965">append</span><span class="op" id="4294971">(</span><span class="ident" id="4294972">ipAddresses</span><span class="op" id="4294983">,</span>&nbsp;<span class="ident" id="4294985">v</span><span class="op" id="4294986">.</span><span class="ident" id="4294987">Bytes</span><span class="op" id="4294992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4294997">default</span><span class="op" id="4295004">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295010">err</span>&nbsp;<span class="op" id="4295014">=</span>&nbsp;<span class="ident" id="4295016">errors</span><span class="op" id="4295022">.</span><span class="ident" id="4295023">New</span><span class="op" id="4295026">(</span><span class="string" id="4295027">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4295079">+</span>&nbsp;<span class="ident" id="4295081">strconv</span><span class="op" id="4295088">.</span><span class="ident" id="4295089">Itoa</span><span class="op" id="4295093">(</span><span class="builtinfunc" id="4295094">len</span><span class="op" id="4295097">(</span><span class="ident" id="4295098">v</span><span class="op" id="4295099">.</span><span class="ident" id="4295100">Bytes</span><span class="op" id="4295105">)</span><span class="op" id="4295106">)</span><span class="op" id="4295107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295113">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295123">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295134">return</span><br>
<span class="lineno"></span><span class="op" id="4295141">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4295144">func</span>&nbsp;<span class="ident" id="4295149">parseCertificate</span><span class="op" id="4295165">(</span><span class="ident" id="4295166">in</span>&nbsp;<span class="op" id="4295169">*</span><span class="ident" id="4295170">certificate</span><span class="op" id="4295181">)</span>&nbsp;<span class="op" id="4295183">(</span><span class="op" id="4295184">*</span><span class="ident" id="4295185">Certificate</span><span class="op" id="4295196">,</span>&nbsp;<span class="builtintype" id="4295198">error</span><span class="op" id="4295203">)</span>&nbsp;<span class="op" id="4295205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295208">out</span>&nbsp;<span class="op" id="4295212">:=</span>&nbsp;<span class="builtinfunc" id="4295215">new</span><span class="op" id="4295218">(</span><span class="ident" id="4295219">Certificate</span><span class="op" id="4295230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295233">out</span><span class="op" id="4295236">.</span><span class="ident" id="4295237">Raw</span>&nbsp;<span class="op" id="4295241">=</span>&nbsp;<span class="ident" id="4295243">in</span><span class="op" id="4295245">.</span><span class="ident" id="4295246">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295251">out</span><span class="op" id="4295254">.</span><span class="ident" id="4295255">RawTBSCertificate</span>&nbsp;<span class="op" id="4295273">=</span>&nbsp;<span class="ident" id="4295275">in</span><span class="op" id="4295277">.</span><span class="ident" id="4295278">TBSCertificate</span><span class="op" id="4295292">.</span><span class="ident" id="4295293">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295298">out</span><span class="op" id="4295301">.</span><span class="ident" id="4295302">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4295326">=</span>&nbsp;<span class="ident" id="4295328">in</span><span class="op" id="4295330">.</span><span class="ident" id="4295331">TBSCertificate</span><span class="op" id="4295345">.</span><span class="ident" id="4295346">PublicKey</span><span class="op" id="4295355">.</span><span class="ident" id="4295356">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295361">out</span><span class="op" id="4295364">.</span><span class="ident" id="4295365">RawSubject</span>&nbsp;<span class="op" id="4295376">=</span>&nbsp;<span class="ident" id="4295378">in</span><span class="op" id="4295380">.</span><span class="ident" id="4295381">TBSCertificate</span><span class="op" id="4295395">.</span><span class="ident" id="4295396">Subject</span><span class="op" id="4295403">.</span><span class="ident" id="4295404">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295415">out</span><span class="op" id="4295418">.</span><span class="ident" id="4295419">RawIssuer</span>&nbsp;<span class="op" id="4295429">=</span>&nbsp;<span class="ident" id="4295431">in</span><span class="op" id="4295433">.</span><span class="ident" id="4295434">TBSCertificate</span><span class="op" id="4295448">.</span><span class="ident" id="4295449">Issuer</span><span class="op" id="4295455">.</span><span class="ident" id="4295456">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295468">out</span><span class="op" id="4295471">.</span><span class="ident" id="4295472">Signature</span>&nbsp;<span class="op" id="4295482">=</span>&nbsp;<span class="ident" id="4295484">in</span><span class="op" id="4295486">.</span><span class="ident" id="4295487">SignatureValue</span><span class="op" id="4295501">.</span><span class="ident" id="4295502">RightAlign</span><span class="op" id="4295512">(</span><span class="op" id="4295513">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295516">out</span><span class="op" id="4295519">.</span><span class="ident" id="4295520">SignatureAlgorithm</span>&nbsp;<span class="op" id="4295539">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295543">getSignatureAlgorithmFromOID</span><span class="op" id="4295571">(</span><span class="ident" id="4295572">in</span><span class="op" id="4295574">.</span><span class="ident" id="4295575">TBSCertificate</span><span class="op" id="4295589">.</span><span class="ident" id="4295590">SignatureAlgorithm</span><span class="op" id="4295608">.</span><span class="ident" id="4295609">Algorithm</span><span class="op" id="4295618">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295622">out</span><span class="op" id="4295625">.</span><span class="ident" id="4295626">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4295645">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295649">getPublicKeyAlgorithmFromOID</span><span class="op" id="4295677">(</span><span class="ident" id="4295678">in</span><span class="op" id="4295680">.</span><span class="ident" id="4295681">TBSCertificate</span><span class="op" id="4295695">.</span><span class="ident" id="4295696">PublicKey</span><span class="op" id="4295705">.</span><span class="ident" id="4295706">Algorithm</span><span class="op" id="4295715">.</span><span class="ident" id="4295716">Algorithm</span><span class="op" id="4295725">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295728">var</span>&nbsp;<span class="ident" id="4295732">err</span>&nbsp;<span class="builtintype" id="4295736">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295743">out</span><span class="op" id="4295746">.</span><span class="ident" id="4295747">PublicKey</span><span class="op" id="4295756">,</span>&nbsp;<span class="ident" id="4295758">err</span>&nbsp;<span class="op" id="4295762">=</span>&nbsp;<span class="ident" id="4295764">parsePublicKey</span><span class="op" id="4295778">(</span><span class="ident" id="4295779">out</span><span class="op" id="4295782">.</span><span class="ident" id="4295783">PublicKeyAlgorithm</span><span class="op" id="4295801">,</span>&nbsp;<span class="op" id="4295803">&amp;</span><span class="ident" id="4295804">in</span><span class="op" id="4295806">.</span><span class="ident" id="4295807">TBSCertificate</span><span class="op" id="4295821">.</span><span class="ident" id="4295822">PublicKey</span><span class="op" id="4295831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295834">if</span>&nbsp;<span class="ident" id="4295837">err</span>&nbsp;<span class="op" id="4295841">!=</span>&nbsp;<span class="ident" id="4295844">nil</span>&nbsp;<span class="op" id="4295848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295852">return</span>&nbsp;<span class="ident" id="4295859">nil</span><span class="op" id="4295862">,</span>&nbsp;<span class="ident" id="4295864">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295869">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295873">if</span>&nbsp;<span class="ident" id="4295876">in</span><span class="op" id="4295878">.</span><span class="ident" id="4295879">TBSCertificate</span><span class="op" id="4295893">.</span><span class="ident" id="4295894">SerialNumber</span><span class="op" id="4295906">.</span><span class="ident" id="4295907">Sign</span><span class="op" id="4295911">(</span><span class="op" id="4295912">)</span>&nbsp;<span class="op" id="4295914">&lt;</span>&nbsp;<span class="num" id="4295916">0</span>&nbsp;<span class="op" id="4295918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4295922">return</span>&nbsp;<span class="ident" id="4295929">nil</span><span class="op" id="4295932">,</span>&nbsp;<span class="ident" id="4295934">errors</span><span class="op" id="4295940">.</span><span class="ident" id="4295941">New</span><span class="op" id="4295944">(</span><span class="string" id="4295945">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4295975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4295978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4295982">out</span><span class="op" id="4295985">.</span><span class="ident" id="4295986">Version</span>&nbsp;<span class="op" id="4295994">=</span>&nbsp;<span class="ident" id="4295996">in</span><span class="op" id="4295998">.</span><span class="ident" id="4295999">TBSCertificate</span><span class="op" id="4296013">.</span><span class="ident" id="4296014">Version</span>&nbsp;<span class="op" id="4296022">+</span>&nbsp;<span class="num" id="4296024">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296027">out</span><span class="op" id="4296030">.</span><span class="ident" id="4296031">SerialNumber</span>&nbsp;<span class="op" id="4296044">=</span>&nbsp;<span class="ident" id="4296046">in</span><span class="op" id="4296048">.</span><span class="ident" id="4296049">TBSCertificate</span><span class="op" id="4296063">.</span><span class="ident" id="4296064">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296079">var</span>&nbsp;<span class="ident" id="4296083">issuer</span><span class="op" id="4296089">,</span>&nbsp;<span class="ident" id="4296091">subject</span>&nbsp;<span class="ident" id="4296099">pkix</span><span class="op" id="4296103">.</span><span class="ident" id="4296104">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296117">if</span>&nbsp;<span class="ident" id="4296120">_</span><span class="op" id="4296121">,</span>&nbsp;<span class="ident" id="4296123">err</span>&nbsp;<span class="op" id="4296127">:=</span>&nbsp;<span class="ident" id="4296130">asn1</span><span class="op" id="4296134">.</span><span class="ident" id="4296135">Unmarshal</span><span class="op" id="4296144">(</span><span class="ident" id="4296145">in</span><span class="op" id="4296147">.</span><span class="ident" id="4296148">TBSCertificate</span><span class="op" id="4296162">.</span><span class="ident" id="4296163">Subject</span><span class="op" id="4296170">.</span><span class="ident" id="4296171">FullBytes</span><span class="op" id="4296180">,</span>&nbsp;<span class="op" id="4296182">&amp;</span><span class="ident" id="4296183">subject</span><span class="op" id="4296190">)</span><span class="op" id="4296191">;</span>&nbsp;<span class="ident" id="4296193">err</span>&nbsp;<span class="op" id="4296197">!=</span>&nbsp;<span class="ident" id="4296200">nil</span>&nbsp;<span class="op" id="4296204">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296208">return</span>&nbsp;<span class="ident" id="4296215">nil</span><span class="op" id="4296218">,</span>&nbsp;<span class="ident" id="4296220">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4296225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296228">if</span>&nbsp;<span class="ident" id="4296231">_</span><span class="op" id="4296232">,</span>&nbsp;<span class="ident" id="4296234">err</span>&nbsp;<span class="op" id="4296238">:=</span>&nbsp;<span class="ident" id="4296241">asn1</span><span class="op" id="4296245">.</span><span class="ident" id="4296246">Unmarshal</span><span class="op" id="4296255">(</span><span class="ident" id="4296256">in</span><span class="op" id="4296258">.</span><span class="ident" id="4296259">TBSCertificate</span><span class="op" id="4296273">.</span><span class="ident" id="4296274">Issuer</span><span class="op" id="4296280">.</span><span class="ident" id="4296281">FullBytes</span><span class="op" id="4296290">,</span>&nbsp;<span class="op" id="4296292">&amp;</span><span class="ident" id="4296293">issuer</span><span class="op" id="4296299">)</span><span class="op" id="4296300">;</span>&nbsp;<span class="ident" id="4296302">err</span>&nbsp;<span class="op" id="4296306">!=</span>&nbsp;<span class="ident" id="4296309">nil</span>&nbsp;<span class="op" id="4296313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296317">return</span>&nbsp;<span class="ident" id="4296324">nil</span><span class="op" id="4296327">,</span>&nbsp;<span class="ident" id="4296329">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4296334">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296338">out</span><span class="op" id="4296341">.</span><span class="ident" id="4296342">Issuer</span><span class="op" id="4296348">.</span><span class="ident" id="4296349">FillFromRDNSequence</span><span class="op" id="4296368">(</span><span class="op" id="4296369">&amp;</span><span class="ident" id="4296370">issuer</span><span class="op" id="4296376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296379">out</span><span class="op" id="4296382">.</span><span class="ident" id="4296383">Subject</span><span class="op" id="4296390">.</span><span class="ident" id="4296391">FillFromRDNSequence</span><span class="op" id="4296410">(</span><span class="op" id="4296411">&amp;</span><span class="ident" id="4296412">subject</span><span class="op" id="4296419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296423">out</span><span class="op" id="4296426">.</span><span class="ident" id="4296427">NotBefore</span>&nbsp;<span class="op" id="4296437">=</span>&nbsp;<span class="ident" id="4296439">in</span><span class="op" id="4296441">.</span><span class="ident" id="4296442">TBSCertificate</span><span class="op" id="4296456">.</span><span class="ident" id="4296457">Validity</span><span class="op" id="4296465">.</span><span class="ident" id="4296466">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296477">out</span><span class="op" id="4296480">.</span><span class="ident" id="4296481">NotAfter</span>&nbsp;<span class="op" id="4296490">=</span>&nbsp;<span class="ident" id="4296492">in</span><span class="op" id="4296494">.</span><span class="ident" id="4296495">TBSCertificate</span><span class="op" id="4296509">.</span><span class="ident" id="4296510">Validity</span><span class="op" id="4296518">.</span><span class="ident" id="4296519">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296530">for</span>&nbsp;<span class="ident" id="4296534">_</span><span class="op" id="4296535">,</span>&nbsp;<span class="ident" id="4296537">e</span>&nbsp;<span class="op" id="4296539">:=</span>&nbsp;<span class="keyword" id="4296542">range</span>&nbsp;<span class="ident" id="4296548">in</span><span class="op" id="4296550">.</span><span class="ident" id="4296551">TBSCertificate</span><span class="op" id="4296565">.</span><span class="ident" id="4296566">Extensions</span>&nbsp;<span class="op" id="4296577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296581">out</span><span class="op" id="4296584">.</span><span class="ident" id="4296585">Extensions</span>&nbsp;<span class="op" id="4296596">=</span>&nbsp;<span class="builtinfunc" id="4296598">append</span><span class="op" id="4296604">(</span><span class="ident" id="4296605">out</span><span class="op" id="4296608">.</span><span class="ident" id="4296609">Extensions</span><span class="op" id="4296619">,</span>&nbsp;<span class="ident" id="4296621">e</span><span class="op" id="4296622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296627">if</span>&nbsp;<span class="builtinfunc" id="4296630">len</span><span class="op" id="4296633">(</span><span class="ident" id="4296634">e</span><span class="op" id="4296635">.</span><span class="ident" id="4296636">Id</span><span class="op" id="4296638">)</span>&nbsp;<span class="op" id="4296640">==</span>&nbsp;<span class="num" id="4296643">4</span>&nbsp;<span class="op" id="4296645">&amp;&amp;</span>&nbsp;<span class="ident" id="4296648">e</span><span class="op" id="4296649">.</span><span class="ident" id="4296650">Id</span><span class="op" id="4296652">[</span><span class="num" id="4296653">0</span><span class="op" id="4296654">]</span>&nbsp;<span class="op" id="4296656">==</span>&nbsp;<span class="num" id="4296659">2</span>&nbsp;<span class="op" id="4296661">&amp;&amp;</span>&nbsp;<span class="ident" id="4296664">e</span><span class="op" id="4296665">.</span><span class="ident" id="4296666">Id</span><span class="op" id="4296668">[</span><span class="num" id="4296669">1</span><span class="op" id="4296670">]</span>&nbsp;<span class="op" id="4296672">==</span>&nbsp;<span class="num" id="4296675">5</span>&nbsp;<span class="op" id="4296677">&amp;&amp;</span>&nbsp;<span class="ident" id="4296680">e</span><span class="op" id="4296681">.</span><span class="ident" id="4296682">Id</span><span class="op" id="4296684">[</span><span class="num" id="4296685">2</span><span class="op" id="4296686">]</span>&nbsp;<span class="op" id="4296688">==</span>&nbsp;<span class="num" id="4296691">29</span>&nbsp;<span class="op" id="4296694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296699">switch</span>&nbsp;<span class="ident" id="4296706">e</span><span class="op" id="4296707">.</span><span class="ident" id="4296708">Id</span><span class="op" id="4296710">[</span><span class="num" id="4296711">3</span><span class="op" id="4296712">]</span>&nbsp;<span class="op" id="4296714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296719">case</span>&nbsp;<span class="num" id="4296724">15</span><span class="op" id="4296726">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4296732">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296757">var</span>&nbsp;<span class="ident" id="4296761">usageBits</span>&nbsp;<span class="ident" id="4296771">asn1</span><span class="op" id="4296775">.</span><span class="ident" id="4296776">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296790">_</span><span class="op" id="4296791">,</span>&nbsp;<span class="ident" id="4296793">err</span>&nbsp;<span class="op" id="4296797">:=</span>&nbsp;<span class="ident" id="4296800">asn1</span><span class="op" id="4296804">.</span><span class="ident" id="4296805">Unmarshal</span><span class="op" id="4296814">(</span><span class="ident" id="4296815">e</span><span class="op" id="4296816">.</span><span class="ident" id="4296817">Value</span><span class="op" id="4296822">,</span>&nbsp;<span class="op" id="4296824">&amp;</span><span class="ident" id="4296825">usageBits</span><span class="op" id="4296834">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296841">if</span>&nbsp;<span class="ident" id="4296844">err</span>&nbsp;<span class="op" id="4296848">==</span>&nbsp;<span class="ident" id="4296851">nil</span>&nbsp;<span class="op" id="4296855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296862">var</span>&nbsp;<span class="ident" id="4296866">usage</span>&nbsp;<span class="builtintype" id="4296872">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296881">for</span>&nbsp;<span class="ident" id="4296885">i</span>&nbsp;<span class="op" id="4296887">:=</span>&nbsp;<span class="num" id="4296890">0</span><span class="op" id="4296891">;</span>&nbsp;<span class="ident" id="4296893">i</span>&nbsp;<span class="op" id="4296895">&lt;</span>&nbsp;<span class="num" id="4296897">9</span><span class="op" id="4296898">;</span>&nbsp;<span class="ident" id="4296900">i</span><span class="op" id="4296901">++</span>&nbsp;<span class="op" id="4296904">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4296912">if</span>&nbsp;<span class="ident" id="4296915">usageBits</span><span class="op" id="4296924">.</span><span class="ident" id="4296925">At</span><span class="op" id="4296927">(</span><span class="ident" id="4296928">i</span><span class="op" id="4296929">)</span>&nbsp;<span class="op" id="4296931">!=</span>&nbsp;<span class="num" id="4296934">0</span>&nbsp;<span class="op" id="4296936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296945">usage</span>&nbsp;<span class="op" id="4296951">|=</span>&nbsp;<span class="num" id="4296954">1</span>&nbsp;<span class="op" id="4296956">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4296959">uint</span><span class="op" id="4296963">(</span><span class="ident" id="4296964">i</span><span class="op" id="4296965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4296973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4296980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4296987">out</span><span class="op" id="4296990">.</span><span class="ident" id="4296991">KeyUsage</span>&nbsp;<span class="op" id="4297000">=</span>&nbsp;<span class="ident" id="4297002">KeyUsage</span><span class="op" id="4297010">(</span><span class="ident" id="4297011">usage</span><span class="op" id="4297016">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297023">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297041">case</span>&nbsp;<span class="num" id="4297046">19</span><span class="op" id="4297048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297054">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297079">var</span>&nbsp;<span class="ident" id="4297083">constraints</span>&nbsp;<span class="ident" id="4297095">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297116">_</span><span class="op" id="4297117">,</span>&nbsp;<span class="ident" id="4297119">err</span>&nbsp;<span class="op" id="4297123">:=</span>&nbsp;<span class="ident" id="4297126">asn1</span><span class="op" id="4297130">.</span><span class="ident" id="4297131">Unmarshal</span><span class="op" id="4297140">(</span><span class="ident" id="4297141">e</span><span class="op" id="4297142">.</span><span class="ident" id="4297143">Value</span><span class="op" id="4297148">,</span>&nbsp;<span class="op" id="4297150">&amp;</span><span class="ident" id="4297151">constraints</span><span class="op" id="4297162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297169">if</span>&nbsp;<span class="ident" id="4297172">err</span>&nbsp;<span class="op" id="4297176">==</span>&nbsp;<span class="ident" id="4297179">nil</span>&nbsp;<span class="op" id="4297183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297190">out</span><span class="op" id="4297193">.</span><span class="ident" id="4297194">BasicConstraintsValid</span>&nbsp;<span class="op" id="4297216">=</span>&nbsp;<span class="builtintype" id="4297218">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297228">out</span><span class="op" id="4297231">.</span><span class="ident" id="4297232">IsCA</span>&nbsp;<span class="op" id="4297237">=</span>&nbsp;<span class="ident" id="4297239">constraints</span><span class="op" id="4297250">.</span><span class="ident" id="4297251">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297261">out</span><span class="op" id="4297264">.</span><span class="ident" id="4297265">MaxPathLen</span>&nbsp;<span class="op" id="4297276">=</span>&nbsp;<span class="ident" id="4297278">constraints</span><span class="op" id="4297289">.</span><span class="ident" id="4297290">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297306">out</span><span class="op" id="4297309">.</span><span class="ident" id="4297310">MaxPathLenZero</span>&nbsp;<span class="op" id="4297325">=</span>&nbsp;<span class="ident" id="4297327">out</span><span class="op" id="4297330">.</span><span class="ident" id="4297331">MaxPathLen</span>&nbsp;<span class="op" id="4297342">==</span>&nbsp;<span class="num" id="4297345">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297352">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297370">case</span>&nbsp;<span class="num" id="4297375">17</span><span class="op" id="4297377">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4297383">out</span><span class="op" id="4297386">.</span><span class="ident" id="4297387">DNSNames</span><span class="op" id="4297395">,</span>&nbsp;<span class="ident" id="4297397">out</span><span class="op" id="4297400">.</span><span class="ident" id="4297401">EmailAddresses</span><span class="op" id="4297415">,</span>&nbsp;<span class="ident" id="4297417">out</span><span class="op" id="4297420">.</span><span class="ident" id="4297421">IPAddresses</span><span class="op" id="4297432">,</span>&nbsp;<span class="ident" id="4297434">err</span>&nbsp;<span class="op" id="4297438">=</span>&nbsp;<span class="ident" id="4297440">parseSANExtension</span><span class="op" id="4297457">(</span><span class="ident" id="4297458">e</span><span class="op" id="4297459">.</span><span class="ident" id="4297460">Value</span><span class="op" id="4297465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297471">if</span>&nbsp;<span class="ident" id="4297474">err</span>&nbsp;<span class="op" id="4297478">!=</span>&nbsp;<span class="ident" id="4297481">nil</span>&nbsp;<span class="op" id="4297485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297492">return</span>&nbsp;<span class="ident" id="4297499">nil</span><span class="op" id="4297502">,</span>&nbsp;<span class="ident" id="4297504">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297519">if</span>&nbsp;<span class="builtinfunc" id="4297522">len</span><span class="op" id="4297525">(</span><span class="ident" id="4297526">out</span><span class="op" id="4297529">.</span><span class="ident" id="4297530">DNSNames</span><span class="op" id="4297538">)</span>&nbsp;<span class="op" id="4297540">&gt;</span>&nbsp;<span class="num" id="4297542">0</span>&nbsp;<span class="op" id="4297544">||</span>&nbsp;<span class="builtinfunc" id="4297547">len</span><span class="op" id="4297550">(</span><span class="ident" id="4297551">out</span><span class="op" id="4297554">.</span><span class="ident" id="4297555">EmailAddresses</span><span class="op" id="4297569">)</span>&nbsp;<span class="op" id="4297571">&gt;</span>&nbsp;<span class="num" id="4297573">0</span>&nbsp;<span class="op" id="4297575">||</span>&nbsp;<span class="builtinfunc" id="4297578">len</span><span class="op" id="4297581">(</span><span class="ident" id="4297582">out</span><span class="op" id="4297585">.</span><span class="ident" id="4297586">IPAddresses</span><span class="op" id="4297597">)</span>&nbsp;<span class="op" id="4297599">&gt;</span>&nbsp;<span class="num" id="4297601">0</span>&nbsp;<span class="op" id="4297603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297610">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4297623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297629">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297680">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4297729">case</span>&nbsp;<span class="num" id="4297734">30</span><span class="op" id="4297736">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297742">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297769">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297877">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297948">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4297955">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298023">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298030">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298067">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298116">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298236">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298243">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298285">var</span>&nbsp;<span class="ident" id="4298289">constraints</span>&nbsp;<span class="ident" id="4298301">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4298321">_</span><span class="op" id="4298322">,</span>&nbsp;<span class="ident" id="4298324">err</span>&nbsp;<span class="op" id="4298328">:=</span>&nbsp;<span class="ident" id="4298331">asn1</span><span class="op" id="4298335">.</span><span class="ident" id="4298336">Unmarshal</span><span class="op" id="4298345">(</span><span class="ident" id="4298346">e</span><span class="op" id="4298347">.</span><span class="ident" id="4298348">Value</span><span class="op" id="4298353">,</span>&nbsp;<span class="op" id="4298355">&amp;</span><span class="ident" id="4298356">constraints</span><span class="op" id="4298367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298373">if</span>&nbsp;<span class="ident" id="4298376">err</span>&nbsp;<span class="op" id="4298380">!=</span>&nbsp;<span class="ident" id="4298383">nil</span>&nbsp;<span class="op" id="4298387">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298394">return</span>&nbsp;<span class="ident" id="4298401">nil</span><span class="op" id="4298404">,</span>&nbsp;<span class="ident" id="4298406">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4298414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298421">if</span>&nbsp;<span class="builtinfunc" id="4298424">len</span><span class="op" id="4298427">(</span><span class="ident" id="4298428">constraints</span><span class="op" id="4298439">.</span><span class="ident" id="4298440">Excluded</span><span class="op" id="4298448">)</span>&nbsp;<span class="op" id="4298450">&gt;</span>&nbsp;<span class="num" id="4298452">0</span>&nbsp;<span class="op" id="4298454">&amp;&amp;</span>&nbsp;<span class="ident" id="4298457">e</span><span class="op" id="4298458">.</span><span class="ident" id="4298459">Critical</span>&nbsp;<span class="op" id="4298468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298475">return</span>&nbsp;<span class="ident" id="4298482">out</span><span class="op" id="4298485">,</span>&nbsp;<span class="ident" id="4298487">UnhandledCriticalExtension</span><span class="op" id="4298513">{</span><span class="op" id="4298514">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4298520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298527">for</span>&nbsp;<span class="ident" id="4298531">_</span><span class="op" id="4298532">,</span>&nbsp;<span class="ident" id="4298534">subtree</span>&nbsp;<span class="op" id="4298542">:=</span>&nbsp;<span class="keyword" id="4298545">range</span>&nbsp;<span class="ident" id="4298551">constraints</span><span class="op" id="4298562">.</span><span class="ident" id="4298563">Permitted</span>&nbsp;<span class="op" id="4298573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298580">if</span>&nbsp;<span class="builtinfunc" id="4298583">len</span><span class="op" id="4298586">(</span><span class="ident" id="4298587">subtree</span><span class="op" id="4298594">.</span><span class="ident" id="4298595">Name</span><span class="op" id="4298599">)</span>&nbsp;<span class="op" id="4298601">==</span>&nbsp;<span class="num" id="4298604">0</span>&nbsp;<span class="op" id="4298606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298614">if</span>&nbsp;<span class="ident" id="4298617">e</span><span class="op" id="4298618">.</span><span class="ident" id="4298619">Critical</span>&nbsp;<span class="op" id="4298628">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298637">return</span>&nbsp;<span class="ident" id="4298644">out</span><span class="op" id="4298647">,</span>&nbsp;<span class="ident" id="4298649">UnhandledCriticalExtension</span><span class="op" id="4298675">{</span><span class="op" id="4298676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4298684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298692">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4298706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4298713">out</span><span class="op" id="4298716">.</span><span class="ident" id="4298717">PermittedDNSDomains</span>&nbsp;<span class="op" id="4298737">=</span>&nbsp;<span class="builtinfunc" id="4298739">append</span><span class="op" id="4298745">(</span><span class="ident" id="4298746">out</span><span class="op" id="4298749">.</span><span class="ident" id="4298750">PermittedDNSDomains</span><span class="op" id="4298769">,</span>&nbsp;<span class="ident" id="4298771">subtree</span><span class="op" id="4298778">.</span><span class="ident" id="4298779">Name</span><span class="op" id="4298783">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4298789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298795">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4298808">case</span>&nbsp;<span class="num" id="4298813">31</span><span class="op" id="4298815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298821">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298848">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298925">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298932">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4298972">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299179">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299186">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299285">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299357">var</span>&nbsp;<span class="ident" id="4299361">cdp</span>&nbsp;<span class="op" id="4299365">[</span><span class="op" id="4299366">]</span><span class="ident" id="4299367">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4299389">_</span><span class="op" id="4299390">,</span>&nbsp;<span class="ident" id="4299392">err</span>&nbsp;<span class="op" id="4299396">:=</span>&nbsp;<span class="ident" id="4299399">asn1</span><span class="op" id="4299403">.</span><span class="ident" id="4299404">Unmarshal</span><span class="op" id="4299413">(</span><span class="ident" id="4299414">e</span><span class="op" id="4299415">.</span><span class="ident" id="4299416">Value</span><span class="op" id="4299421">,</span>&nbsp;<span class="op" id="4299423">&amp;</span><span class="ident" id="4299424">cdp</span><span class="op" id="4299427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299433">if</span>&nbsp;<span class="ident" id="4299436">err</span>&nbsp;<span class="op" id="4299440">!=</span>&nbsp;<span class="ident" id="4299443">nil</span>&nbsp;<span class="op" id="4299447">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299454">return</span>&nbsp;<span class="ident" id="4299461">nil</span><span class="op" id="4299464">,</span>&nbsp;<span class="ident" id="4299466">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4299474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299481">for</span>&nbsp;<span class="ident" id="4299485">_</span><span class="op" id="4299486">,</span>&nbsp;<span class="ident" id="4299488">dp</span>&nbsp;<span class="op" id="4299491">:=</span>&nbsp;<span class="keyword" id="4299494">range</span>&nbsp;<span class="ident" id="4299500">cdp</span>&nbsp;<span class="op" id="4299504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299511">var</span>&nbsp;<span class="ident" id="4299515">n</span>&nbsp;<span class="ident" id="4299517">asn1</span><span class="op" id="4299521">.</span><span class="ident" id="4299522">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4299536">_</span><span class="op" id="4299537">,</span>&nbsp;<span class="ident" id="4299539">err</span>&nbsp;<span class="op" id="4299543">=</span>&nbsp;<span class="ident" id="4299545">asn1</span><span class="op" id="4299549">.</span><span class="ident" id="4299550">Unmarshal</span><span class="op" id="4299559">(</span><span class="ident" id="4299560">dp</span><span class="op" id="4299562">.</span><span class="ident" id="4299563">DistributionPoint</span><span class="op" id="4299580">.</span><span class="ident" id="4299581">FullName</span><span class="op" id="4299589">.</span><span class="ident" id="4299590">Bytes</span><span class="op" id="4299595">,</span>&nbsp;<span class="op" id="4299597">&amp;</span><span class="ident" id="4299598">n</span><span class="op" id="4299599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299606">if</span>&nbsp;<span class="ident" id="4299609">err</span>&nbsp;<span class="op" id="4299613">!=</span>&nbsp;<span class="ident" id="4299616">nil</span>&nbsp;<span class="op" id="4299620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299628">return</span>&nbsp;<span class="ident" id="4299635">nil</span><span class="op" id="4299638">,</span>&nbsp;<span class="ident" id="4299640">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4299649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299657">if</span>&nbsp;<span class="ident" id="4299660">n</span><span class="op" id="4299661">.</span><span class="ident" id="4299662">Tag</span>&nbsp;<span class="op" id="4299666">==</span>&nbsp;<span class="num" id="4299669">6</span>&nbsp;<span class="op" id="4299671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4299679">out</span><span class="op" id="4299682">.</span><span class="ident" id="4299683">CRLDistributionPoints</span>&nbsp;<span class="op" id="4299705">=</span>&nbsp;<span class="builtinfunc" id="4299707">append</span><span class="op" id="4299713">(</span><span class="ident" id="4299714">out</span><span class="op" id="4299717">.</span><span class="ident" id="4299718">CRLDistributionPoints</span><span class="op" id="4299739">,</span>&nbsp;<span class="builtintype" id="4299741">string</span><span class="op" id="4299747">(</span><span class="ident" id="4299748">n</span><span class="op" id="4299749">.</span><span class="ident" id="4299750">Bytes</span><span class="op" id="4299755">)</span><span class="op" id="4299756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4299763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4299769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299775">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299788">case</span>&nbsp;<span class="num" id="4299793">35</span><span class="op" id="4299795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299801">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299826">var</span>&nbsp;<span class="ident" id="4299830">a</span>&nbsp;<span class="ident" id="4299832">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4299846">_</span><span class="op" id="4299847">,</span>&nbsp;<span class="ident" id="4299849">err</span>&nbsp;<span class="op" id="4299853">=</span>&nbsp;<span class="ident" id="4299855">asn1</span><span class="op" id="4299859">.</span><span class="ident" id="4299860">Unmarshal</span><span class="op" id="4299869">(</span><span class="ident" id="4299870">e</span><span class="op" id="4299871">.</span><span class="ident" id="4299872">Value</span><span class="op" id="4299877">,</span>&nbsp;<span class="op" id="4299879">&amp;</span><span class="ident" id="4299880">a</span><span class="op" id="4299881">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299887">if</span>&nbsp;<span class="ident" id="4299890">err</span>&nbsp;<span class="op" id="4299894">!=</span>&nbsp;<span class="ident" id="4299897">nil</span>&nbsp;<span class="op" id="4299901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299908">return</span>&nbsp;<span class="ident" id="4299915">nil</span><span class="op" id="4299918">,</span>&nbsp;<span class="ident" id="4299920">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4299928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4299934">out</span><span class="op" id="4299937">.</span><span class="ident" id="4299938">AuthorityKeyId</span>&nbsp;<span class="op" id="4299953">=</span>&nbsp;<span class="ident" id="4299955">a</span><span class="op" id="4299956">.</span><span class="ident" id="4299957">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299964">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4299977">case</span>&nbsp;<span class="num" id="4299982">37</span><span class="op" id="4299984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4299990">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300038">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300098">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300105">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300173">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300180">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300223">var</span>&nbsp;<span class="ident" id="4300227">keyUsage</span>&nbsp;<span class="op" id="4300236">[</span><span class="op" id="4300237">]</span><span class="ident" id="4300238">asn1</span><span class="op" id="4300242">.</span><span class="ident" id="4300243">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300264">_</span><span class="op" id="4300265">,</span>&nbsp;<span class="ident" id="4300267">err</span>&nbsp;<span class="op" id="4300271">=</span>&nbsp;<span class="ident" id="4300273">asn1</span><span class="op" id="4300277">.</span><span class="ident" id="4300278">Unmarshal</span><span class="op" id="4300287">(</span><span class="ident" id="4300288">e</span><span class="op" id="4300289">.</span><span class="ident" id="4300290">Value</span><span class="op" id="4300295">,</span>&nbsp;<span class="op" id="4300297">&amp;</span><span class="ident" id="4300298">keyUsage</span><span class="op" id="4300306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300312">if</span>&nbsp;<span class="ident" id="4300315">err</span>&nbsp;<span class="op" id="4300319">!=</span>&nbsp;<span class="ident" id="4300322">nil</span>&nbsp;<span class="op" id="4300326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300333">return</span>&nbsp;<span class="ident" id="4300340">nil</span><span class="op" id="4300343">,</span>&nbsp;<span class="ident" id="4300345">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4300353">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300360">for</span>&nbsp;<span class="ident" id="4300364">_</span><span class="op" id="4300365">,</span>&nbsp;<span class="ident" id="4300367">u</span>&nbsp;<span class="op" id="4300369">:=</span>&nbsp;<span class="keyword" id="4300372">range</span>&nbsp;<span class="ident" id="4300378">keyUsage</span>&nbsp;<span class="op" id="4300387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300394">if</span>&nbsp;<span class="ident" id="4300397">extKeyUsage</span><span class="op" id="4300408">,</span>&nbsp;<span class="ident" id="4300410">ok</span>&nbsp;<span class="op" id="4300413">:=</span>&nbsp;<span class="ident" id="4300416">extKeyUsageFromOID</span><span class="op" id="4300434">(</span><span class="ident" id="4300435">u</span><span class="op" id="4300436">)</span><span class="op" id="4300437">;</span>&nbsp;<span class="ident" id="4300439">ok</span>&nbsp;<span class="op" id="4300442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300450">out</span><span class="op" id="4300453">.</span><span class="ident" id="4300454">ExtKeyUsage</span>&nbsp;<span class="op" id="4300466">=</span>&nbsp;<span class="builtinfunc" id="4300468">append</span><span class="op" id="4300474">(</span><span class="ident" id="4300475">out</span><span class="op" id="4300478">.</span><span class="ident" id="4300479">ExtKeyUsage</span><span class="op" id="4300490">,</span>&nbsp;<span class="ident" id="4300492">extKeyUsage</span><span class="op" id="4300503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4300510">}</span>&nbsp;<span class="keyword" id="4300512">else</span>&nbsp;<span class="op" id="4300517">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300525">out</span><span class="op" id="4300528">.</span><span class="ident" id="4300529">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4300548">=</span>&nbsp;<span class="builtinfunc" id="4300550">append</span><span class="op" id="4300556">(</span><span class="ident" id="4300557">out</span><span class="op" id="4300560">.</span><span class="ident" id="4300561">UnknownExtKeyUsage</span><span class="op" id="4300579">,</span>&nbsp;<span class="ident" id="4300581">u</span><span class="op" id="4300582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4300589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4300595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300602">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300615">case</span>&nbsp;<span class="num" id="4300620">14</span><span class="op" id="4300622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300628">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300653">var</span>&nbsp;<span class="ident" id="4300657">keyid</span>&nbsp;<span class="op" id="4300663">[</span><span class="op" id="4300664">]</span><span class="builtintype" id="4300665">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300674">_</span><span class="op" id="4300675">,</span>&nbsp;<span class="ident" id="4300677">err</span>&nbsp;<span class="op" id="4300681">=</span>&nbsp;<span class="ident" id="4300683">asn1</span><span class="op" id="4300687">.</span><span class="ident" id="4300688">Unmarshal</span><span class="op" id="4300697">(</span><span class="ident" id="4300698">e</span><span class="op" id="4300699">.</span><span class="ident" id="4300700">Value</span><span class="op" id="4300705">,</span>&nbsp;<span class="op" id="4300707">&amp;</span><span class="ident" id="4300708">keyid</span><span class="op" id="4300713">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300719">if</span>&nbsp;<span class="ident" id="4300722">err</span>&nbsp;<span class="op" id="4300726">!=</span>&nbsp;<span class="ident" id="4300729">nil</span>&nbsp;<span class="op" id="4300733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300740">return</span>&nbsp;<span class="ident" id="4300747">nil</span><span class="op" id="4300750">,</span>&nbsp;<span class="ident" id="4300752">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4300760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300766">out</span><span class="op" id="4300769">.</span><span class="ident" id="4300770">SubjectKeyId</span>&nbsp;<span class="op" id="4300783">=</span>&nbsp;<span class="ident" id="4300785">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300795">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300808">case</span>&nbsp;<span class="num" id="4300813">32</span><span class="op" id="4300815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4300821">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300867">var</span>&nbsp;<span class="ident" id="4300871">policies</span>&nbsp;<span class="op" id="4300880">[</span><span class="op" id="4300881">]</span><span class="ident" id="4300882">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300904">if</span>&nbsp;<span class="ident" id="4300907">_</span><span class="op" id="4300908">,</span>&nbsp;<span class="ident" id="4300910">err</span>&nbsp;<span class="op" id="4300914">=</span>&nbsp;<span class="ident" id="4300916">asn1</span><span class="op" id="4300920">.</span><span class="ident" id="4300921">Unmarshal</span><span class="op" id="4300930">(</span><span class="ident" id="4300931">e</span><span class="op" id="4300932">.</span><span class="ident" id="4300933">Value</span><span class="op" id="4300938">,</span>&nbsp;<span class="op" id="4300940">&amp;</span><span class="ident" id="4300941">policies</span><span class="op" id="4300949">)</span><span class="op" id="4300950">;</span>&nbsp;<span class="ident" id="4300952">err</span>&nbsp;<span class="op" id="4300956">!=</span>&nbsp;<span class="ident" id="4300959">nil</span>&nbsp;<span class="op" id="4300963">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4300970">return</span>&nbsp;<span class="ident" id="4300977">nil</span><span class="op" id="4300980">,</span>&nbsp;<span class="ident" id="4300982">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4300990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4300996">out</span><span class="op" id="4300999">.</span><span class="ident" id="4301000">PolicyIdentifiers</span>&nbsp;<span class="op" id="4301018">=</span>&nbsp;<span class="builtinfunc" id="4301020">make</span><span class="op" id="4301024">(</span><span class="op" id="4301025">[</span><span class="op" id="4301026">]</span><span class="ident" id="4301027">asn1</span><span class="op" id="4301031">.</span><span class="ident" id="4301032">ObjectIdentifier</span><span class="op" id="4301048">,</span>&nbsp;<span class="builtinfunc" id="4301050">len</span><span class="op" id="4301053">(</span><span class="ident" id="4301054">policies</span><span class="op" id="4301062">)</span><span class="op" id="4301063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301069">for</span>&nbsp;<span class="ident" id="4301073">i</span><span class="op" id="4301074">,</span>&nbsp;<span class="ident" id="4301076">policy</span>&nbsp;<span class="op" id="4301083">:=</span>&nbsp;<span class="keyword" id="4301086">range</span>&nbsp;<span class="ident" id="4301092">policies</span>&nbsp;<span class="op" id="4301101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301108">out</span><span class="op" id="4301111">.</span><span class="ident" id="4301112">PolicyIdentifiers</span><span class="op" id="4301129">[</span><span class="ident" id="4301130">i</span><span class="op" id="4301131">]</span>&nbsp;<span class="op" id="4301133">=</span>&nbsp;<span class="ident" id="4301135">policy</span><span class="op" id="4301141">.</span><span class="ident" id="4301142">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301162">}</span>&nbsp;<span class="keyword" id="4301164">else</span>&nbsp;<span class="keyword" id="4301169">if</span>&nbsp;<span class="ident" id="4301172">e</span><span class="op" id="4301173">.</span><span class="ident" id="4301174">Id</span><span class="op" id="4301176">.</span><span class="ident" id="4301177">Equal</span><span class="op" id="4301182">(</span><span class="ident" id="4301183">oidExtensionAuthorityInfoAccess</span><span class="op" id="4301214">)</span>&nbsp;<span class="op" id="4301216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4301221">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301274">var</span>&nbsp;<span class="ident" id="4301278">aia</span>&nbsp;<span class="op" id="4301282">[</span><span class="op" id="4301283">]</span><span class="ident" id="4301284">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301307">if</span>&nbsp;<span class="ident" id="4301310">_</span><span class="op" id="4301311">,</span>&nbsp;<span class="ident" id="4301313">err</span>&nbsp;<span class="op" id="4301317">=</span>&nbsp;<span class="ident" id="4301319">asn1</span><span class="op" id="4301323">.</span><span class="ident" id="4301324">Unmarshal</span><span class="op" id="4301333">(</span><span class="ident" id="4301334">e</span><span class="op" id="4301335">.</span><span class="ident" id="4301336">Value</span><span class="op" id="4301341">,</span>&nbsp;<span class="op" id="4301343">&amp;</span><span class="ident" id="4301344">aia</span><span class="op" id="4301347">)</span><span class="op" id="4301348">;</span>&nbsp;<span class="ident" id="4301350">err</span>&nbsp;<span class="op" id="4301354">!=</span>&nbsp;<span class="ident" id="4301357">nil</span>&nbsp;<span class="op" id="4301361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301367">return</span>&nbsp;<span class="ident" id="4301374">nil</span><span class="op" id="4301377">,</span>&nbsp;<span class="ident" id="4301379">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301392">for</span>&nbsp;<span class="ident" id="4301396">_</span><span class="op" id="4301397">,</span>&nbsp;<span class="ident" id="4301399">v</span>&nbsp;<span class="op" id="4301401">:=</span>&nbsp;<span class="keyword" id="4301404">range</span>&nbsp;<span class="ident" id="4301410">aia</span>&nbsp;<span class="op" id="4301414">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4301420">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301480">if</span>&nbsp;<span class="ident" id="4301483">v</span><span class="op" id="4301484">.</span><span class="ident" id="4301485">Location</span><span class="op" id="4301493">.</span><span class="ident" id="4301494">Tag</span>&nbsp;<span class="op" id="4301498">!=</span>&nbsp;<span class="num" id="4301501">6</span>&nbsp;<span class="op" id="4301503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301510">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301529">if</span>&nbsp;<span class="ident" id="4301532">v</span><span class="op" id="4301533">.</span><span class="ident" id="4301534">Method</span><span class="op" id="4301540">.</span><span class="ident" id="4301541">Equal</span><span class="op" id="4301546">(</span><span class="ident" id="4301547">oidAuthorityInfoAccessOcsp</span><span class="op" id="4301573">)</span>&nbsp;<span class="op" id="4301575">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301582">out</span><span class="op" id="4301585">.</span><span class="ident" id="4301586">OCSPServer</span>&nbsp;<span class="op" id="4301597">=</span>&nbsp;<span class="builtinfunc" id="4301599">append</span><span class="op" id="4301605">(</span><span class="ident" id="4301606">out</span><span class="op" id="4301609">.</span><span class="ident" id="4301610">OCSPServer</span><span class="op" id="4301620">,</span>&nbsp;<span class="builtintype" id="4301622">string</span><span class="op" id="4301628">(</span><span class="ident" id="4301629">v</span><span class="op" id="4301630">.</span><span class="ident" id="4301631">Location</span><span class="op" id="4301639">.</span><span class="ident" id="4301640">Bytes</span><span class="op" id="4301645">)</span><span class="op" id="4301646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301652">}</span>&nbsp;<span class="keyword" id="4301654">else</span>&nbsp;<span class="keyword" id="4301659">if</span>&nbsp;<span class="ident" id="4301662">v</span><span class="op" id="4301663">.</span><span class="ident" id="4301664">Method</span><span class="op" id="4301670">.</span><span class="ident" id="4301671">Equal</span><span class="op" id="4301676">(</span><span class="ident" id="4301677">oidAuthorityInfoAccessIssuers</span><span class="op" id="4301706">)</span>&nbsp;<span class="op" id="4301708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4301715">out</span><span class="op" id="4301718">.</span><span class="ident" id="4301719">IssuingCertificateURL</span>&nbsp;<span class="op" id="4301741">=</span>&nbsp;<span class="builtinfunc" id="4301743">append</span><span class="op" id="4301749">(</span><span class="ident" id="4301750">out</span><span class="op" id="4301753">.</span><span class="ident" id="4301754">IssuingCertificateURL</span><span class="op" id="4301775">,</span>&nbsp;<span class="builtintype" id="4301777">string</span><span class="op" id="4301783">(</span><span class="ident" id="4301784">v</span><span class="op" id="4301785">.</span><span class="ident" id="4301786">Location</span><span class="op" id="4301794">.</span><span class="ident" id="4301795">Bytes</span><span class="op" id="4301800">)</span><span class="op" id="4301801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301812">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301821">if</span>&nbsp;<span class="ident" id="4301824">e</span><span class="op" id="4301825">.</span><span class="ident" id="4301826">Critical</span>&nbsp;<span class="op" id="4301835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301840">return</span>&nbsp;<span class="ident" id="4301847">out</span><span class="op" id="4301850">,</span>&nbsp;<span class="ident" id="4301852">UnhandledCriticalExtension</span><span class="op" id="4301878">{</span><span class="op" id="4301879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301883">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4301886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4301890">return</span>&nbsp;<span class="ident" id="4301897">out</span><span class="op" id="4301900">,</span>&nbsp;<span class="ident" id="4301902">nil</span><br>
<span class="lineno"></span><span class="op" id="4301906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4301909">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4301988">func</span>&nbsp;<span class="ident" id="4301993">ParseCertificate</span><span class="op" id="4302009">(</span><span class="ident" id="4302010">asn1Data</span>&nbsp;<span class="op" id="4302019">[</span><span class="op" id="4302020">]</span><span class="builtintype" id="4302021">byte</span><span class="op" id="4302025">)</span>&nbsp;<span class="op" id="4302027">(</span><span class="op" id="4302028">*</span><span class="ident" id="4302029">Certificate</span><span class="op" id="4302040">,</span>&nbsp;<span class="builtintype" id="4302042">error</span><span class="op" id="4302047">)</span>&nbsp;<span class="op" id="4302049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302052">var</span>&nbsp;<span class="ident" id="4302056">cert</span>&nbsp;<span class="ident" id="4302061">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302074">rest</span><span class="op" id="4302078">,</span>&nbsp;<span class="ident" id="4302080">err</span>&nbsp;<span class="op" id="4302084">:=</span>&nbsp;<span class="ident" id="4302087">asn1</span><span class="op" id="4302091">.</span><span class="ident" id="4302092">Unmarshal</span><span class="op" id="4302101">(</span><span class="ident" id="4302102">asn1Data</span><span class="op" id="4302110">,</span>&nbsp;<span class="op" id="4302112">&amp;</span><span class="ident" id="4302113">cert</span><span class="op" id="4302117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302120">if</span>&nbsp;<span class="ident" id="4302123">err</span>&nbsp;<span class="op" id="4302127">!=</span>&nbsp;<span class="ident" id="4302130">nil</span>&nbsp;<span class="op" id="4302134">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302138">return</span>&nbsp;<span class="ident" id="4302145">nil</span><span class="op" id="4302148">,</span>&nbsp;<span class="ident" id="4302150">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302158">if</span>&nbsp;<span class="builtinfunc" id="4302161">len</span><span class="op" id="4302164">(</span><span class="ident" id="4302165">rest</span><span class="op" id="4302169">)</span>&nbsp;<span class="op" id="4302171">&gt;</span>&nbsp;<span class="num" id="4302173">0</span>&nbsp;<span class="op" id="4302175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302179">return</span>&nbsp;<span class="ident" id="4302186">nil</span><span class="op" id="4302189">,</span>&nbsp;<span class="ident" id="4302191">asn1</span><span class="op" id="4302195">.</span><span class="ident" id="4302196">SyntaxError</span><span class="op" id="4302207">{</span><span class="ident" id="4302208">Msg</span><span class="op" id="4302211">:</span>&nbsp;<span class="string" id="4302213">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4302228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302231">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302235">return</span>&nbsp;<span class="ident" id="4302242">parseCertificate</span><span class="op" id="4302258">(</span><span class="op" id="4302259">&amp;</span><span class="ident" id="4302260">cert</span><span class="op" id="4302264">)</span><br>
<span class="lineno"></span><span class="op" id="4302266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4302269">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4302347">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4302424">func</span>&nbsp;<span class="ident" id="4302429">ParseCertificates</span><span class="op" id="4302446">(</span><span class="ident" id="4302447">asn1Data</span>&nbsp;<span class="op" id="4302456">[</span><span class="op" id="4302457">]</span><span class="builtintype" id="4302458">byte</span><span class="op" id="4302462">)</span>&nbsp;<span class="op" id="4302464">(</span><span class="op" id="4302465">[</span><span class="op" id="4302466">]</span><span class="op" id="4302467">*</span><span class="ident" id="4302468">Certificate</span><span class="op" id="4302479">,</span>&nbsp;<span class="builtintype" id="4302481">error</span><span class="op" id="4302486">)</span>&nbsp;<span class="op" id="4302488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302491">var</span>&nbsp;<span class="ident" id="4302495">v</span>&nbsp;<span class="op" id="4302497">[</span><span class="op" id="4302498">]</span><span class="op" id="4302499">*</span><span class="ident" id="4302500">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302514">for</span>&nbsp;<span class="builtinfunc" id="4302518">len</span><span class="op" id="4302521">(</span><span class="ident" id="4302522">asn1Data</span><span class="op" id="4302530">)</span>&nbsp;<span class="op" id="4302532">&gt;</span>&nbsp;<span class="num" id="4302534">0</span>&nbsp;<span class="op" id="4302536">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302540">cert</span>&nbsp;<span class="op" id="4302545">:=</span>&nbsp;<span class="builtinfunc" id="4302548">new</span><span class="op" id="4302551">(</span><span class="ident" id="4302552">certificate</span><span class="op" id="4302563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302567">var</span>&nbsp;<span class="ident" id="4302571">err</span>&nbsp;<span class="builtintype" id="4302575">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302583">asn1Data</span><span class="op" id="4302591">,</span>&nbsp;<span class="ident" id="4302593">err</span>&nbsp;<span class="op" id="4302597">=</span>&nbsp;<span class="ident" id="4302599">asn1</span><span class="op" id="4302603">.</span><span class="ident" id="4302604">Unmarshal</span><span class="op" id="4302613">(</span><span class="ident" id="4302614">asn1Data</span><span class="op" id="4302622">,</span>&nbsp;<span class="ident" id="4302624">cert</span><span class="op" id="4302628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302632">if</span>&nbsp;<span class="ident" id="4302635">err</span>&nbsp;<span class="op" id="4302639">!=</span>&nbsp;<span class="ident" id="4302642">nil</span>&nbsp;<span class="op" id="4302646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302651">return</span>&nbsp;<span class="ident" id="4302658">nil</span><span class="op" id="4302661">,</span>&nbsp;<span class="ident" id="4302663">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302673">v</span>&nbsp;<span class="op" id="4302675">=</span>&nbsp;<span class="builtinfunc" id="4302677">append</span><span class="op" id="4302683">(</span><span class="ident" id="4302684">v</span><span class="op" id="4302685">,</span>&nbsp;<span class="ident" id="4302687">cert</span><span class="op" id="4302691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302698">ret</span>&nbsp;<span class="op" id="4302702">:=</span>&nbsp;<span class="builtinfunc" id="4302705">make</span><span class="op" id="4302709">(</span><span class="op" id="4302710">[</span><span class="op" id="4302711">]</span><span class="op" id="4302712">*</span><span class="ident" id="4302713">Certificate</span><span class="op" id="4302724">,</span>&nbsp;<span class="builtinfunc" id="4302726">len</span><span class="op" id="4302729">(</span><span class="ident" id="4302730">v</span><span class="op" id="4302731">)</span><span class="op" id="4302732">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302735">for</span>&nbsp;<span class="ident" id="4302739">i</span><span class="op" id="4302740">,</span>&nbsp;<span class="ident" id="4302742">ci</span>&nbsp;<span class="op" id="4302745">:=</span>&nbsp;<span class="keyword" id="4302748">range</span>&nbsp;<span class="ident" id="4302754">v</span>&nbsp;<span class="op" id="4302756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302760">cert</span><span class="op" id="4302764">,</span>&nbsp;<span class="ident" id="4302766">err</span>&nbsp;<span class="op" id="4302770">:=</span>&nbsp;<span class="ident" id="4302773">parseCertificate</span><span class="op" id="4302789">(</span><span class="ident" id="4302790">ci</span><span class="op" id="4302792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302796">if</span>&nbsp;<span class="ident" id="4302799">err</span>&nbsp;<span class="op" id="4302803">!=</span>&nbsp;<span class="ident" id="4302806">nil</span>&nbsp;<span class="op" id="4302810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302815">return</span>&nbsp;<span class="ident" id="4302822">nil</span><span class="op" id="4302825">,</span>&nbsp;<span class="ident" id="4302827">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302833">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302837">ret</span><span class="op" id="4302840">[</span><span class="ident" id="4302841">i</span><span class="op" id="4302842">]</span>&nbsp;<span class="op" id="4302844">=</span>&nbsp;<span class="ident" id="4302846">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4302852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302856">return</span>&nbsp;<span class="ident" id="4302863">ret</span><span class="op" id="4302866">,</span>&nbsp;<span class="ident" id="4302868">nil</span><br>
<span class="lineno"></span><span class="op" id="4302872">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4302875">func</span>&nbsp;<span class="ident" id="4302880">reverseBitsInAByte</span><span class="op" id="4302898">(</span><span class="ident" id="4302899">in</span>&nbsp;<span class="builtintype" id="4302902">byte</span><span class="op" id="4302906">)</span>&nbsp;<span class="builtintype" id="4302908">byte</span>&nbsp;<span class="op" id="4302913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302916">b1</span>&nbsp;<span class="op" id="4302919">:=</span>&nbsp;<span class="ident" id="4302922">in</span><span class="op" id="4302924">&gt;&gt;</span><span class="num" id="4302926">4</span>&nbsp;<span class="op" id="4302928">|</span>&nbsp;<span class="ident" id="4302930">in</span><span class="op" id="4302932">&lt;&lt;</span><span class="num" id="4302934">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302937">b2</span>&nbsp;<span class="op" id="4302940">:=</span>&nbsp;<span class="ident" id="4302943">b1</span><span class="op" id="4302945">&gt;&gt;</span><span class="num" id="4302947">2</span><span class="op" id="4302948">&amp;</span><span class="num" id="4302949">0x33</span>&nbsp;<span class="op" id="4302954">|</span>&nbsp;<span class="ident" id="4302956">b1</span><span class="op" id="4302958">&lt;&lt;</span><span class="num" id="4302960">2</span><span class="op" id="4302961">&amp;</span><span class="num" id="4302962">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4302968">b3</span>&nbsp;<span class="op" id="4302971">:=</span>&nbsp;<span class="ident" id="4302974">b2</span><span class="op" id="4302976">&gt;&gt;</span><span class="num" id="4302978">1</span><span class="op" id="4302979">&amp;</span><span class="num" id="4302980">0x55</span>&nbsp;<span class="op" id="4302985">|</span>&nbsp;<span class="ident" id="4302987">b2</span><span class="op" id="4302989">&lt;&lt;</span><span class="num" id="4302991">1</span><span class="op" id="4302992">&amp;</span><span class="num" id="4302993">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4302999">return</span>&nbsp;<span class="ident" id="4303006">b3</span><br>
<span class="lineno"></span><span class="op" id="4303009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4303012">var</span>&nbsp;<span class="op" id="4303016">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303019">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303053">=</span>&nbsp;<span class="op" id="4303055">[</span><span class="op" id="4303056">]</span><span class="builtintype" id="4303057">int</span><span class="op" id="4303060">{</span><span class="num" id="4303061">2</span><span class="op" id="4303062">,</span>&nbsp;<span class="num" id="4303064">5</span><span class="op" id="4303065">,</span>&nbsp;<span class="num" id="4303067">29</span><span class="op" id="4303069">,</span>&nbsp;<span class="num" id="4303071">14</span><span class="op" id="4303073">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303076">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303110">=</span>&nbsp;<span class="op" id="4303112">[</span><span class="op" id="4303113">]</span><span class="builtintype" id="4303114">int</span><span class="op" id="4303117">{</span><span class="num" id="4303118">2</span><span class="op" id="4303119">,</span>&nbsp;<span class="num" id="4303121">5</span><span class="op" id="4303122">,</span>&nbsp;<span class="num" id="4303124">29</span><span class="op" id="4303126">,</span>&nbsp;<span class="num" id="4303128">15</span><span class="op" id="4303130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303133">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303167">=</span>&nbsp;<span class="op" id="4303169">[</span><span class="op" id="4303170">]</span><span class="builtintype" id="4303171">int</span><span class="op" id="4303174">{</span><span class="num" id="4303175">2</span><span class="op" id="4303176">,</span>&nbsp;<span class="num" id="4303178">5</span><span class="op" id="4303179">,</span>&nbsp;<span class="num" id="4303181">29</span><span class="op" id="4303183">,</span>&nbsp;<span class="num" id="4303185">37</span><span class="op" id="4303187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303190">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303224">=</span>&nbsp;<span class="op" id="4303226">[</span><span class="op" id="4303227">]</span><span class="builtintype" id="4303228">int</span><span class="op" id="4303231">{</span><span class="num" id="4303232">2</span><span class="op" id="4303233">,</span>&nbsp;<span class="num" id="4303235">5</span><span class="op" id="4303236">,</span>&nbsp;<span class="num" id="4303238">29</span><span class="op" id="4303240">,</span>&nbsp;<span class="num" id="4303242">35</span><span class="op" id="4303244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303247">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303281">=</span>&nbsp;<span class="op" id="4303283">[</span><span class="op" id="4303284">]</span><span class="builtintype" id="4303285">int</span><span class="op" id="4303288">{</span><span class="num" id="4303289">2</span><span class="op" id="4303290">,</span>&nbsp;<span class="num" id="4303292">5</span><span class="op" id="4303293">,</span>&nbsp;<span class="num" id="4303295">29</span><span class="op" id="4303297">,</span>&nbsp;<span class="num" id="4303299">19</span><span class="op" id="4303301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303304">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303338">=</span>&nbsp;<span class="op" id="4303340">[</span><span class="op" id="4303341">]</span><span class="builtintype" id="4303342">int</span><span class="op" id="4303345">{</span><span class="num" id="4303346">2</span><span class="op" id="4303347">,</span>&nbsp;<span class="num" id="4303349">5</span><span class="op" id="4303350">,</span>&nbsp;<span class="num" id="4303352">29</span><span class="op" id="4303354">,</span>&nbsp;<span class="num" id="4303356">17</span><span class="op" id="4303358">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303361">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4303395">=</span>&nbsp;<span class="op" id="4303397">[</span><span class="op" id="4303398">]</span><span class="builtintype" id="4303399">int</span><span class="op" id="4303402">{</span><span class="num" id="4303403">2</span><span class="op" id="4303404">,</span>&nbsp;<span class="num" id="4303406">5</span><span class="op" id="4303407">,</span>&nbsp;<span class="num" id="4303409">29</span><span class="op" id="4303411">,</span>&nbsp;<span class="num" id="4303413">32</span><span class="op" id="4303415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303418">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303452">=</span>&nbsp;<span class="op" id="4303454">[</span><span class="op" id="4303455">]</span><span class="builtintype" id="4303456">int</span><span class="op" id="4303459">{</span><span class="num" id="4303460">2</span><span class="op" id="4303461">,</span>&nbsp;<span class="num" id="4303463">5</span><span class="op" id="4303464">,</span>&nbsp;<span class="num" id="4303466">29</span><span class="op" id="4303468">,</span>&nbsp;<span class="num" id="4303470">30</span><span class="op" id="4303472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303475">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4303509">=</span>&nbsp;<span class="op" id="4303511">[</span><span class="op" id="4303512">]</span><span class="builtintype" id="4303513">int</span><span class="op" id="4303516">{</span><span class="num" id="4303517">2</span><span class="op" id="4303518">,</span>&nbsp;<span class="num" id="4303520">5</span><span class="op" id="4303521">,</span>&nbsp;<span class="num" id="4303523">29</span><span class="op" id="4303525">,</span>&nbsp;<span class="num" id="4303527">31</span><span class="op" id="4303529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303532">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4303566">=</span>&nbsp;<span class="op" id="4303568">[</span><span class="op" id="4303569">]</span><span class="builtintype" id="4303570">int</span><span class="op" id="4303573">{</span><span class="num" id="4303574">1</span><span class="op" id="4303575">,</span>&nbsp;<span class="num" id="4303577">3</span><span class="op" id="4303578">,</span>&nbsp;<span class="num" id="4303580">6</span><span class="op" id="4303581">,</span>&nbsp;<span class="num" id="4303583">1</span><span class="op" id="4303584">,</span>&nbsp;<span class="num" id="4303586">5</span><span class="op" id="4303587">,</span>&nbsp;<span class="num" id="4303589">5</span><span class="op" id="4303590">,</span>&nbsp;<span class="num" id="4303592">7</span><span class="op" id="4303593">,</span>&nbsp;<span class="num" id="4303595">1</span><span class="op" id="4303596">,</span>&nbsp;<span class="num" id="4303598">1</span><span class="op" id="4303599">}</span><br>
<span class="lineno"></span><span class="op" id="4303601">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4303604">var</span>&nbsp;<span class="op" id="4303608">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303611">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303641">=</span>&nbsp;<span class="ident" id="4303643">asn1</span><span class="op" id="4303647">.</span><span class="ident" id="4303648">ObjectIdentifier</span><span class="op" id="4303664">{</span><span class="num" id="4303665">1</span><span class="op" id="4303666">,</span>&nbsp;<span class="num" id="4303668">3</span><span class="op" id="4303669">,</span>&nbsp;<span class="num" id="4303671">6</span><span class="op" id="4303672">,</span>&nbsp;<span class="num" id="4303674">1</span><span class="op" id="4303675">,</span>&nbsp;<span class="num" id="4303677">5</span><span class="op" id="4303678">,</span>&nbsp;<span class="num" id="4303680">5</span><span class="op" id="4303681">,</span>&nbsp;<span class="num" id="4303683">7</span><span class="op" id="4303684">,</span>&nbsp;<span class="num" id="4303686">48</span><span class="op" id="4303688">,</span>&nbsp;<span class="num" id="4303690">1</span><span class="op" id="4303691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303694">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4303724">=</span>&nbsp;<span class="ident" id="4303726">asn1</span><span class="op" id="4303730">.</span><span class="ident" id="4303731">ObjectIdentifier</span><span class="op" id="4303747">{</span><span class="num" id="4303748">1</span><span class="op" id="4303749">,</span>&nbsp;<span class="num" id="4303751">3</span><span class="op" id="4303752">,</span>&nbsp;<span class="num" id="4303754">6</span><span class="op" id="4303755">,</span>&nbsp;<span class="num" id="4303757">1</span><span class="op" id="4303758">,</span>&nbsp;<span class="num" id="4303760">5</span><span class="op" id="4303761">,</span>&nbsp;<span class="num" id="4303763">5</span><span class="op" id="4303764">,</span>&nbsp;<span class="num" id="4303766">7</span><span class="op" id="4303767">,</span>&nbsp;<span class="num" id="4303769">48</span><span class="op" id="4303771">,</span>&nbsp;<span class="num" id="4303773">2</span><span class="op" id="4303774">}</span><br>
<span class="lineno"></span><span class="op" id="4303776">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4303779">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4303859">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4303874">func</span>&nbsp;<span class="ident" id="4303879">oidInExtensions</span><span class="op" id="4303894">(</span><span class="ident" id="4303895">oid</span>&nbsp;<span class="ident" id="4303899">asn1</span><span class="op" id="4303903">.</span><span class="ident" id="4303904">ObjectIdentifier</span><span class="op" id="4303920">,</span>&nbsp;<span class="ident" id="4303922">extensions</span>&nbsp;<span class="op" id="4303933">[</span><span class="op" id="4303934">]</span><span class="ident" id="4303935">pkix</span><span class="op" id="4303939">.</span><span class="ident" id="4303940">Extension</span><span class="op" id="4303949">)</span>&nbsp;<span class="builtintype" id="4303951">bool</span>&nbsp;<span class="op" id="4303956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4303959">for</span>&nbsp;<span class="ident" id="4303963">_</span><span class="op" id="4303964">,</span>&nbsp;<span class="ident" id="4303966">e</span>&nbsp;<span class="op" id="4303968">:=</span>&nbsp;<span class="keyword" id="4303971">range</span>&nbsp;<span class="ident" id="4303977">extensions</span>&nbsp;<span class="op" id="4303988">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4303992">if</span>&nbsp;<span class="ident" id="4303995">e</span><span class="op" id="4303996">.</span><span class="ident" id="4303997">Id</span><span class="op" id="4303999">.</span><span class="ident" id="4304000">Equal</span><span class="op" id="4304005">(</span><span class="ident" id="4304006">oid</span><span class="op" id="4304009">)</span>&nbsp;<span class="op" id="4304011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304016">return</span>&nbsp;<span class="builtintype" id="4304023">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304036">return</span>&nbsp;<span class="builtintype" id="4304043">false</span><br>
<span class="lineno">1165</span><span class="op" id="4304049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4304052">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4304128">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4304165">func</span>&nbsp;<span class="ident" id="4304170">marshalSANs</span><span class="op" id="4304181">(</span><span class="ident" id="4304182">dnsNames</span><span class="op" id="4304190">,</span>&nbsp;<span class="ident" id="4304192">emailAddresses</span>&nbsp;<span class="op" id="4304207">[</span><span class="op" id="4304208">]</span><span class="builtintype" id="4304209">string</span><span class="op" id="4304215">,</span>&nbsp;<span class="ident" id="4304217">ipAddresses</span>&nbsp;<span class="op" id="4304229">[</span><span class="op" id="4304230">]</span><span class="ident" id="4304231">net</span><span class="op" id="4304234">.</span><span class="ident" id="4304235">IP</span><span class="op" id="4304237">)</span>&nbsp;<span class="op" id="4304239">(</span><span class="ident" id="4304240">derBytes</span>&nbsp;<span class="op" id="4304249">[</span><span class="op" id="4304250">]</span><span class="builtintype" id="4304251">byte</span><span class="op" id="4304255">,</span>&nbsp;<span class="ident" id="4304257">err</span>&nbsp;<span class="builtintype" id="4304261">error</span><span class="op" id="4304266">)</span>&nbsp;<span class="op" id="4304268">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304271">var</span>&nbsp;<span class="ident" id="4304275">rawValues</span>&nbsp;<span class="op" id="4304285">[</span><span class="op" id="4304286">]</span><span class="ident" id="4304287">asn1</span><span class="op" id="4304291">.</span><span class="ident" id="4304292">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304302">for</span>&nbsp;<span class="ident" id="4304306">_</span><span class="op" id="4304307">,</span>&nbsp;<span class="ident" id="4304309">name</span>&nbsp;<span class="op" id="4304314">:=</span>&nbsp;<span class="keyword" id="4304317">range</span>&nbsp;<span class="ident" id="4304323">dnsNames</span>&nbsp;<span class="op" id="4304332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304336">rawValues</span>&nbsp;<span class="op" id="4304346">=</span>&nbsp;<span class="builtinfunc" id="4304348">append</span><span class="op" id="4304354">(</span><span class="ident" id="4304355">rawValues</span><span class="op" id="4304364">,</span>&nbsp;<span class="ident" id="4304366">asn1</span><span class="op" id="4304370">.</span><span class="ident" id="4304371">RawValue</span><span class="op" id="4304379">{</span><span class="ident" id="4304380">Tag</span><span class="op" id="4304383">:</span>&nbsp;<span class="num" id="4304385">2</span><span class="op" id="4304386">,</span>&nbsp;<span class="ident" id="4304388">Class</span><span class="op" id="4304393">:</span>&nbsp;<span class="num" id="4304395">2</span><span class="op" id="4304396">,</span>&nbsp;<span class="ident" id="4304398">Bytes</span><span class="op" id="4304403">:</span>&nbsp;<span class="op" id="4304405">[</span><span class="op" id="4304406">]</span><span class="builtintype" id="4304407">byte</span><span class="op" id="4304411">(</span><span class="ident" id="4304412">name</span><span class="op" id="4304416">)</span><span class="op" id="4304417">}</span><span class="op" id="4304418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304424">for</span>&nbsp;<span class="ident" id="4304428">_</span><span class="op" id="4304429">,</span>&nbsp;<span class="ident" id="4304431">email</span>&nbsp;<span class="op" id="4304437">:=</span>&nbsp;<span class="keyword" id="4304440">range</span>&nbsp;<span class="ident" id="4304446">emailAddresses</span>&nbsp;<span class="op" id="4304461">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304465">rawValues</span>&nbsp;<span class="op" id="4304475">=</span>&nbsp;<span class="builtinfunc" id="4304477">append</span><span class="op" id="4304483">(</span><span class="ident" id="4304484">rawValues</span><span class="op" id="4304493">,</span>&nbsp;<span class="ident" id="4304495">asn1</span><span class="op" id="4304499">.</span><span class="ident" id="4304500">RawValue</span><span class="op" id="4304508">{</span><span class="ident" id="4304509">Tag</span><span class="op" id="4304512">:</span>&nbsp;<span class="num" id="4304514">1</span><span class="op" id="4304515">,</span>&nbsp;<span class="ident" id="4304517">Class</span><span class="op" id="4304522">:</span>&nbsp;<span class="num" id="4304524">2</span><span class="op" id="4304525">,</span>&nbsp;<span class="ident" id="4304527">Bytes</span><span class="op" id="4304532">:</span>&nbsp;<span class="op" id="4304534">[</span><span class="op" id="4304535">]</span><span class="builtintype" id="4304536">byte</span><span class="op" id="4304540">(</span><span class="ident" id="4304541">email</span><span class="op" id="4304546">)</span><span class="op" id="4304547">}</span><span class="op" id="4304548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304554">for</span>&nbsp;<span class="ident" id="4304558">_</span><span class="op" id="4304559">,</span>&nbsp;<span class="ident" id="4304561">rawIP</span>&nbsp;<span class="op" id="4304567">:=</span>&nbsp;<span class="keyword" id="4304570">range</span>&nbsp;<span class="ident" id="4304576">ipAddresses</span>&nbsp;<span class="op" id="4304588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4304592">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304662">ip</span>&nbsp;<span class="op" id="4304665">:=</span>&nbsp;<span class="ident" id="4304668">rawIP</span><span class="op" id="4304673">.</span><span class="ident" id="4304674">To4</span><span class="op" id="4304677">(</span><span class="op" id="4304678">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304682">if</span>&nbsp;<span class="ident" id="4304685">ip</span>&nbsp;<span class="op" id="4304688">==</span>&nbsp;<span class="ident" id="4304691">nil</span>&nbsp;<span class="op" id="4304695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304700">ip</span>&nbsp;<span class="op" id="4304703">=</span>&nbsp;<span class="ident" id="4304705">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304717">rawValues</span>&nbsp;<span class="op" id="4304727">=</span>&nbsp;<span class="builtinfunc" id="4304729">append</span><span class="op" id="4304735">(</span><span class="ident" id="4304736">rawValues</span><span class="op" id="4304745">,</span>&nbsp;<span class="ident" id="4304747">asn1</span><span class="op" id="4304751">.</span><span class="ident" id="4304752">RawValue</span><span class="op" id="4304760">{</span><span class="ident" id="4304761">Tag</span><span class="op" id="4304764">:</span>&nbsp;<span class="num" id="4304766">7</span><span class="op" id="4304767">,</span>&nbsp;<span class="ident" id="4304769">Class</span><span class="op" id="4304774">:</span>&nbsp;<span class="num" id="4304776">2</span><span class="op" id="4304777">,</span>&nbsp;<span class="ident" id="4304779">Bytes</span><span class="op" id="4304784">:</span>&nbsp;<span class="ident" id="4304786">ip</span><span class="op" id="4304788">}</span><span class="op" id="4304789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304792">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304795">return</span>&nbsp;<span class="ident" id="4304802">asn1</span><span class="op" id="4304806">.</span><span class="ident" id="4304807">Marshal</span><span class="op" id="4304814">(</span><span class="ident" id="4304815">rawValues</span><span class="op" id="4304824">)</span><br>
<span class="lineno"></span><span class="op" id="4304826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4304829">func</span>&nbsp;<span class="ident" id="4304834">buildExtensions</span><span class="op" id="4304849">(</span><span class="ident" id="4304850">template</span>&nbsp;<span class="op" id="4304859">*</span><span class="ident" id="4304860">Certificate</span><span class="op" id="4304871">)</span>&nbsp;<span class="op" id="4304873">(</span><span class="ident" id="4304874">ret</span>&nbsp;<span class="op" id="4304878">[</span><span class="op" id="4304879">]</span><span class="ident" id="4304880">pkix</span><span class="op" id="4304884">.</span><span class="ident" id="4304885">Extension</span><span class="op" id="4304894">,</span>&nbsp;<span class="ident" id="4304896">err</span>&nbsp;<span class="builtintype" id="4304900">error</span><span class="op" id="4304905">)</span>&nbsp;<span class="op" id="4304907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304910">ret</span>&nbsp;<span class="op" id="4304914">=</span>&nbsp;<span class="builtinfunc" id="4304916">make</span><span class="op" id="4304920">(</span><span class="op" id="4304921">[</span><span class="op" id="4304922">]</span><span class="ident" id="4304923">pkix</span><span class="op" id="4304927">.</span><span class="ident" id="4304928">Extension</span><span class="op" id="4304937">,</span>&nbsp;<span class="num" id="4304939">10</span>&nbsp;<span class="comment" id="4304942">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4304975">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304978">n</span>&nbsp;<span class="op" id="4304980">:=</span>&nbsp;<span class="num" id="4304983">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304987">if</span>&nbsp;<span class="ident" id="4304990">template</span><span class="op" id="4304998">.</span><span class="ident" id="4304999">KeyUsage</span>&nbsp;<span class="op" id="4305008">!=</span>&nbsp;<span class="num" id="4305011">0</span>&nbsp;<span class="op" id="4305013">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305018">!</span><span class="ident" id="4305019">oidInExtensions</span><span class="op" id="4305034">(</span><span class="ident" id="4305035">oidExtensionKeyUsage</span><span class="op" id="4305055">,</span>&nbsp;<span class="ident" id="4305057">template</span><span class="op" id="4305065">.</span><span class="ident" id="4305066">ExtraExtensions</span><span class="op" id="4305081">)</span>&nbsp;<span class="op" id="4305083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305087">ret</span><span class="op" id="4305090">[</span><span class="ident" id="4305091">n</span><span class="op" id="4305092">]</span><span class="op" id="4305093">.</span><span class="ident" id="4305094">Id</span>&nbsp;<span class="op" id="4305097">=</span>&nbsp;<span class="ident" id="4305099">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305122">ret</span><span class="op" id="4305125">[</span><span class="ident" id="4305126">n</span><span class="op" id="4305127">]</span><span class="op" id="4305128">.</span><span class="ident" id="4305129">Critical</span>&nbsp;<span class="op" id="4305138">=</span>&nbsp;<span class="builtintype" id="4305140">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305148">var</span>&nbsp;<span class="ident" id="4305152">a</span>&nbsp;<span class="op" id="4305154">[</span><span class="num" id="4305155">2</span><span class="op" id="4305156">]</span><span class="builtintype" id="4305157">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305164">a</span><span class="op" id="4305165">[</span><span class="num" id="4305166">0</span><span class="op" id="4305167">]</span>&nbsp;<span class="op" id="4305169">=</span>&nbsp;<span class="ident" id="4305171">reverseBitsInAByte</span><span class="op" id="4305189">(</span><span class="builtintype" id="4305190">byte</span><span class="op" id="4305194">(</span><span class="ident" id="4305195">template</span><span class="op" id="4305203">.</span><span class="ident" id="4305204">KeyUsage</span><span class="op" id="4305212">)</span><span class="op" id="4305213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305217">a</span><span class="op" id="4305218">[</span><span class="num" id="4305219">1</span><span class="op" id="4305220">]</span>&nbsp;<span class="op" id="4305222">=</span>&nbsp;<span class="ident" id="4305224">reverseBitsInAByte</span><span class="op" id="4305242">(</span><span class="builtintype" id="4305243">byte</span><span class="op" id="4305247">(</span><span class="ident" id="4305248">template</span><span class="op" id="4305256">.</span><span class="ident" id="4305257">KeyUsage</span>&nbsp;<span class="op" id="4305266">&gt;&gt;</span>&nbsp;<span class="num" id="4305269">8</span><span class="op" id="4305270">)</span><span class="op" id="4305271">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305276">l</span>&nbsp;<span class="op" id="4305278">:=</span>&nbsp;<span class="num" id="4305281">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305285">if</span>&nbsp;<span class="ident" id="4305288">a</span><span class="op" id="4305289">[</span><span class="num" id="4305290">1</span><span class="op" id="4305291">]</span>&nbsp;<span class="op" id="4305293">!=</span>&nbsp;<span class="num" id="4305296">0</span>&nbsp;<span class="op" id="4305298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305303">l</span>&nbsp;<span class="op" id="4305305">=</span>&nbsp;<span class="num" id="4305307">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305311">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305316">ret</span><span class="op" id="4305319">[</span><span class="ident" id="4305320">n</span><span class="op" id="4305321">]</span><span class="op" id="4305322">.</span><span class="ident" id="4305323">Value</span><span class="op" id="4305328">,</span>&nbsp;<span class="ident" id="4305330">err</span>&nbsp;<span class="op" id="4305334">=</span>&nbsp;<span class="ident" id="4305336">asn1</span><span class="op" id="4305340">.</span><span class="ident" id="4305341">Marshal</span><span class="op" id="4305348">(</span><span class="ident" id="4305349">asn1</span><span class="op" id="4305353">.</span><span class="ident" id="4305354">BitString</span><span class="op" id="4305363">{</span><span class="ident" id="4305364">Bytes</span><span class="op" id="4305369">:</span>&nbsp;<span class="ident" id="4305371">a</span><span class="op" id="4305372">[</span><span class="num" id="4305373">0</span><span class="op" id="4305374">:</span><span class="ident" id="4305375">l</span><span class="op" id="4305376">]</span><span class="op" id="4305377">,</span>&nbsp;<span class="ident" id="4305379">BitLength</span><span class="op" id="4305388">:</span>&nbsp;<span class="ident" id="4305390">l</span>&nbsp;<span class="op" id="4305392">*</span>&nbsp;<span class="num" id="4305394">8</span><span class="op" id="4305395">}</span><span class="op" id="4305396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305400">if</span>&nbsp;<span class="ident" id="4305403">err</span>&nbsp;<span class="op" id="4305407">!=</span>&nbsp;<span class="ident" id="4305410">nil</span>&nbsp;<span class="op" id="4305414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305419">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305428">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305432">n</span><span class="op" id="4305433">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305441">if</span>&nbsp;<span class="op" id="4305444">(</span><span class="builtinfunc" id="4305445">len</span><span class="op" id="4305448">(</span><span class="ident" id="4305449">template</span><span class="op" id="4305457">.</span><span class="ident" id="4305458">ExtKeyUsage</span><span class="op" id="4305469">)</span>&nbsp;<span class="op" id="4305471">&gt;</span>&nbsp;<span class="num" id="4305473">0</span>&nbsp;<span class="op" id="4305475">||</span>&nbsp;<span class="builtinfunc" id="4305478">len</span><span class="op" id="4305481">(</span><span class="ident" id="4305482">template</span><span class="op" id="4305490">.</span><span class="ident" id="4305491">UnknownExtKeyUsage</span><span class="op" id="4305509">)</span>&nbsp;<span class="op" id="4305511">&gt;</span>&nbsp;<span class="num" id="4305513">0</span><span class="op" id="4305514">)</span>&nbsp;<span class="op" id="4305516">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305521">!</span><span class="ident" id="4305522">oidInExtensions</span><span class="op" id="4305537">(</span><span class="ident" id="4305538">oidExtensionExtendedKeyUsage</span><span class="op" id="4305566">,</span>&nbsp;<span class="ident" id="4305568">template</span><span class="op" id="4305576">.</span><span class="ident" id="4305577">ExtraExtensions</span><span class="op" id="4305592">)</span>&nbsp;<span class="op" id="4305594">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305598">ret</span><span class="op" id="4305601">[</span><span class="ident" id="4305602">n</span><span class="op" id="4305603">]</span><span class="op" id="4305604">.</span><span class="ident" id="4305605">Id</span>&nbsp;<span class="op" id="4305608">=</span>&nbsp;<span class="ident" id="4305610">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305642">var</span>&nbsp;<span class="ident" id="4305646">oids</span>&nbsp;<span class="op" id="4305651">[</span><span class="op" id="4305652">]</span><span class="ident" id="4305653">asn1</span><span class="op" id="4305657">.</span><span class="ident" id="4305658">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305677">for</span>&nbsp;<span class="ident" id="4305681">_</span><span class="op" id="4305682">,</span>&nbsp;<span class="ident" id="4305684">u</span>&nbsp;<span class="op" id="4305686">:=</span>&nbsp;<span class="keyword" id="4305689">range</span>&nbsp;<span class="ident" id="4305695">template</span><span class="op" id="4305703">.</span><span class="ident" id="4305704">ExtKeyUsage</span>&nbsp;<span class="op" id="4305716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305721">if</span>&nbsp;<span class="ident" id="4305724">oid</span><span class="op" id="4305727">,</span>&nbsp;<span class="ident" id="4305729">ok</span>&nbsp;<span class="op" id="4305732">:=</span>&nbsp;<span class="ident" id="4305735">oidFromExtKeyUsage</span><span class="op" id="4305753">(</span><span class="ident" id="4305754">u</span><span class="op" id="4305755">)</span><span class="op" id="4305756">;</span>&nbsp;<span class="ident" id="4305758">ok</span>&nbsp;<span class="op" id="4305761">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305767">oids</span>&nbsp;<span class="op" id="4305772">=</span>&nbsp;<span class="builtinfunc" id="4305774">append</span><span class="op" id="4305780">(</span><span class="ident" id="4305781">oids</span><span class="op" id="4305785">,</span>&nbsp;<span class="ident" id="4305787">oid</span><span class="op" id="4305790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305795">}</span>&nbsp;<span class="keyword" id="4305797">else</span>&nbsp;<span class="op" id="4305802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4305808">panic</span><span class="op" id="4305813">(</span><span class="string" id="4305814">&#34;internal&nbsp;error&#34;</span><span class="op" id="4305830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305839">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305844">oids</span>&nbsp;<span class="op" id="4305849">=</span>&nbsp;<span class="builtinfunc" id="4305851">append</span><span class="op" id="4305857">(</span><span class="ident" id="4305858">oids</span><span class="op" id="4305862">,</span>&nbsp;<span class="ident" id="4305864">template</span><span class="op" id="4305872">.</span><span class="ident" id="4305873">UnknownExtKeyUsage</span><span class="op" id="4305891">...</span><span class="op" id="4305894">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305899">ret</span><span class="op" id="4305902">[</span><span class="ident" id="4305903">n</span><span class="op" id="4305904">]</span><span class="op" id="4305905">.</span><span class="ident" id="4305906">Value</span><span class="op" id="4305911">,</span>&nbsp;<span class="ident" id="4305913">err</span>&nbsp;<span class="op" id="4305917">=</span>&nbsp;<span class="ident" id="4305919">asn1</span><span class="op" id="4305923">.</span><span class="ident" id="4305924">Marshal</span><span class="op" id="4305931">(</span><span class="ident" id="4305932">oids</span><span class="op" id="4305936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305940">if</span>&nbsp;<span class="ident" id="4305943">err</span>&nbsp;<span class="op" id="4305947">!=</span>&nbsp;<span class="ident" id="4305950">nil</span>&nbsp;<span class="op" id="4305954">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305959">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305972">n</span><span class="op" id="4305973">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305981">if</span>&nbsp;<span class="ident" id="4305984">template</span><span class="op" id="4305992">.</span><span class="ident" id="4305993">BasicConstraintsValid</span>&nbsp;<span class="op" id="4306015">&amp;&amp;</span>&nbsp;<span class="op" id="4306018">!</span><span class="ident" id="4306019">oidInExtensions</span><span class="op" id="4306034">(</span><span class="ident" id="4306035">oidExtensionBasicConstraints</span><span class="op" id="4306063">,</span>&nbsp;<span class="ident" id="4306065">template</span><span class="op" id="4306073">.</span><span class="ident" id="4306074">ExtraExtensions</span><span class="op" id="4306089">)</span>&nbsp;<span class="op" id="4306091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306095">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306158">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306223">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306282">maxPathLen</span>&nbsp;<span class="op" id="4306293">:=</span>&nbsp;<span class="ident" id="4306296">template</span><span class="op" id="4306304">.</span><span class="ident" id="4306305">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306318">if</span>&nbsp;<span class="ident" id="4306321">maxPathLen</span>&nbsp;<span class="op" id="4306332">==</span>&nbsp;<span class="num" id="4306335">0</span>&nbsp;<span class="op" id="4306337">&amp;&amp;</span>&nbsp;<span class="op" id="4306340">!</span><span class="ident" id="4306341">template</span><span class="op" id="4306349">.</span><span class="ident" id="4306350">MaxPathLenZero</span>&nbsp;<span class="op" id="4306365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306370">maxPathLen</span>&nbsp;<span class="op" id="4306381">=</span>&nbsp;<span class="op" id="4306383">-</span><span class="num" id="4306384">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4306388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306392">ret</span><span class="op" id="4306395">[</span><span class="ident" id="4306396">n</span><span class="op" id="4306397">]</span><span class="op" id="4306398">.</span><span class="ident" id="4306399">Id</span>&nbsp;<span class="op" id="4306402">=</span>&nbsp;<span class="ident" id="4306404">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306435">ret</span><span class="op" id="4306438">[</span><span class="ident" id="4306439">n</span><span class="op" id="4306440">]</span><span class="op" id="4306441">.</span><span class="ident" id="4306442">Value</span><span class="op" id="4306447">,</span>&nbsp;<span class="ident" id="4306449">err</span>&nbsp;<span class="op" id="4306453">=</span>&nbsp;<span class="ident" id="4306455">asn1</span><span class="op" id="4306459">.</span><span class="ident" id="4306460">Marshal</span><span class="op" id="4306467">(</span><span class="ident" id="4306468">basicConstraints</span><span class="op" id="4306484">{</span><span class="ident" id="4306485">template</span><span class="op" id="4306493">.</span><span class="ident" id="4306494">IsCA</span><span class="op" id="4306498">,</span>&nbsp;<span class="ident" id="4306500">maxPathLen</span><span class="op" id="4306510">}</span><span class="op" id="4306511">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306515">ret</span><span class="op" id="4306518">[</span><span class="ident" id="4306519">n</span><span class="op" id="4306520">]</span><span class="op" id="4306521">.</span><span class="ident" id="4306522">Critical</span>&nbsp;<span class="op" id="4306531">=</span>&nbsp;<span class="builtintype" id="4306533">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306540">if</span>&nbsp;<span class="ident" id="4306543">err</span>&nbsp;<span class="op" id="4306547">!=</span>&nbsp;<span class="ident" id="4306550">nil</span>&nbsp;<span class="op" id="4306554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306559">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4306568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306572">n</span><span class="op" id="4306573">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4306577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306581">if</span>&nbsp;<span class="builtinfunc" id="4306584">len</span><span class="op" id="4306587">(</span><span class="ident" id="4306588">template</span><span class="op" id="4306596">.</span><span class="ident" id="4306597">SubjectKeyId</span><span class="op" id="4306609">)</span>&nbsp;<span class="op" id="4306611">&gt;</span>&nbsp;<span class="num" id="4306613">0</span>&nbsp;<span class="op" id="4306615">&amp;&amp;</span>&nbsp;<span class="op" id="4306618">!</span><span class="ident" id="4306619">oidInExtensions</span><span class="op" id="4306634">(</span><span class="ident" id="4306635">oidExtensionSubjectKeyId</span><span class="op" id="4306659">,</span>&nbsp;<span class="ident" id="4306661">template</span><span class="op" id="4306669">.</span><span class="ident" id="4306670">ExtraExtensions</span><span class="op" id="4306685">)</span>&nbsp;<span class="op" id="4306687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306691">ret</span><span class="op" id="4306694">[</span><span class="ident" id="4306695">n</span><span class="op" id="4306696">]</span><span class="op" id="4306697">.</span><span class="ident" id="4306698">Id</span>&nbsp;<span class="op" id="4306701">=</span>&nbsp;<span class="ident" id="4306703">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306730">ret</span><span class="op" id="4306733">[</span><span class="ident" id="4306734">n</span><span class="op" id="4306735">]</span><span class="op" id="4306736">.</span><span class="ident" id="4306737">Value</span><span class="op" id="4306742">,</span>&nbsp;<span class="ident" id="4306744">err</span>&nbsp;<span class="op" id="4306748">=</span>&nbsp;<span class="ident" id="4306750">asn1</span><span class="op" id="4306754">.</span><span class="ident" id="4306755">Marshal</span><span class="op" id="4306762">(</span><span class="ident" id="4306763">template</span><span class="op" id="4306771">.</span><span class="ident" id="4306772">SubjectKeyId</span><span class="op" id="4306784">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306788">if</span>&nbsp;<span class="ident" id="4306791">err</span>&nbsp;<span class="op" id="4306795">!=</span>&nbsp;<span class="ident" id="4306798">nil</span>&nbsp;<span class="op" id="4306802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4306816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306820">n</span><span class="op" id="4306821">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4306825">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306829">if</span>&nbsp;<span class="builtinfunc" id="4306832">len</span><span class="op" id="4306835">(</span><span class="ident" id="4306836">template</span><span class="op" id="4306844">.</span><span class="ident" id="4306845">AuthorityKeyId</span><span class="op" id="4306859">)</span>&nbsp;<span class="op" id="4306861">&gt;</span>&nbsp;<span class="num" id="4306863">0</span>&nbsp;<span class="op" id="4306865">&amp;&amp;</span>&nbsp;<span class="op" id="4306868">!</span><span class="ident" id="4306869">oidInExtensions</span><span class="op" id="4306884">(</span><span class="ident" id="4306885">oidExtensionAuthorityKeyId</span><span class="op" id="4306911">,</span>&nbsp;<span class="ident" id="4306913">template</span><span class="op" id="4306921">.</span><span class="ident" id="4306922">ExtraExtensions</span><span class="op" id="4306937">)</span>&nbsp;<span class="op" id="4306939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306943">ret</span><span class="op" id="4306946">[</span><span class="ident" id="4306947">n</span><span class="op" id="4306948">]</span><span class="op" id="4306949">.</span><span class="ident" id="4306950">Id</span>&nbsp;<span class="op" id="4306953">=</span>&nbsp;<span class="ident" id="4306955">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306984">ret</span><span class="op" id="4306987">[</span><span class="ident" id="4306988">n</span><span class="op" id="4306989">]</span><span class="op" id="4306990">.</span><span class="ident" id="4306991">Value</span><span class="op" id="4306996">,</span>&nbsp;<span class="ident" id="4306998">err</span>&nbsp;<span class="op" id="4307002">=</span>&nbsp;<span class="ident" id="4307004">asn1</span><span class="op" id="4307008">.</span><span class="ident" id="4307009">Marshal</span><span class="op" id="4307016">(</span><span class="ident" id="4307017">authKeyId</span><span class="op" id="4307026">{</span><span class="ident" id="4307027">template</span><span class="op" id="4307035">.</span><span class="ident" id="4307036">AuthorityKeyId</span><span class="op" id="4307050">}</span><span class="op" id="4307051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307055">if</span>&nbsp;<span class="ident" id="4307058">err</span>&nbsp;<span class="op" id="4307062">!=</span>&nbsp;<span class="ident" id="4307065">nil</span>&nbsp;<span class="op" id="4307069">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307074">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307087">n</span><span class="op" id="4307088">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307096">if</span>&nbsp;<span class="op" id="4307099">(</span><span class="builtinfunc" id="4307100">len</span><span class="op" id="4307103">(</span><span class="ident" id="4307104">template</span><span class="op" id="4307112">.</span><span class="ident" id="4307113">OCSPServer</span><span class="op" id="4307123">)</span>&nbsp;<span class="op" id="4307125">&gt;</span>&nbsp;<span class="num" id="4307127">0</span>&nbsp;<span class="op" id="4307129">||</span>&nbsp;<span class="builtinfunc" id="4307132">len</span><span class="op" id="4307135">(</span><span class="ident" id="4307136">template</span><span class="op" id="4307144">.</span><span class="ident" id="4307145">IssuingCertificateURL</span><span class="op" id="4307166">)</span>&nbsp;<span class="op" id="4307168">&gt;</span>&nbsp;<span class="num" id="4307170">0</span><span class="op" id="4307171">)</span>&nbsp;<span class="op" id="4307173">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307178">!</span><span class="ident" id="4307179">oidInExtensions</span><span class="op" id="4307194">(</span><span class="ident" id="4307195">oidExtensionAuthorityInfoAccess</span><span class="op" id="4307226">,</span>&nbsp;<span class="ident" id="4307228">template</span><span class="op" id="4307236">.</span><span class="ident" id="4307237">ExtraExtensions</span><span class="op" id="4307252">)</span>&nbsp;<span class="op" id="4307254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307258">ret</span><span class="op" id="4307261">[</span><span class="ident" id="4307262">n</span><span class="op" id="4307263">]</span><span class="op" id="4307264">.</span><span class="ident" id="4307265">Id</span>&nbsp;<span class="op" id="4307268">=</span>&nbsp;<span class="ident" id="4307270">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307304">var</span>&nbsp;<span class="ident" id="4307308">aiaValues</span>&nbsp;<span class="op" id="4307318">[</span><span class="op" id="4307319">]</span><span class="ident" id="4307320">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307342">for</span>&nbsp;<span class="ident" id="4307346">_</span><span class="op" id="4307347">,</span>&nbsp;<span class="ident" id="4307349">name</span>&nbsp;<span class="op" id="4307354">:=</span>&nbsp;<span class="keyword" id="4307357">range</span>&nbsp;<span class="ident" id="4307363">template</span><span class="op" id="4307371">.</span><span class="ident" id="4307372">OCSPServer</span>&nbsp;<span class="op" id="4307383">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307388">aiaValues</span>&nbsp;<span class="op" id="4307398">=</span>&nbsp;<span class="builtinfunc" id="4307400">append</span><span class="op" id="4307406">(</span><span class="ident" id="4307407">aiaValues</span><span class="op" id="4307416">,</span>&nbsp;<span class="ident" id="4307418">authorityInfoAccess</span><span class="op" id="4307437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307443">Method</span><span class="op" id="4307449">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4307453">oidAuthorityInfoAccessOcsp</span><span class="op" id="4307479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307485">Location</span><span class="op" id="4307493">:</span>&nbsp;<span class="ident" id="4307495">asn1</span><span class="op" id="4307499">.</span><span class="ident" id="4307500">RawValue</span><span class="op" id="4307508">{</span><span class="ident" id="4307509">Tag</span><span class="op" id="4307512">:</span>&nbsp;<span class="num" id="4307514">6</span><span class="op" id="4307515">,</span>&nbsp;<span class="ident" id="4307517">Class</span><span class="op" id="4307522">:</span>&nbsp;<span class="num" id="4307524">2</span><span class="op" id="4307525">,</span>&nbsp;<span class="ident" id="4307527">Bytes</span><span class="op" id="4307532">:</span>&nbsp;<span class="op" id="4307534">[</span><span class="op" id="4307535">]</span><span class="builtintype" id="4307536">byte</span><span class="op" id="4307540">(</span><span class="ident" id="4307541">name</span><span class="op" id="4307545">)</span><span class="op" id="4307546">}</span><span class="op" id="4307547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307552">}</span><span class="op" id="4307553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307557">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307561">for</span>&nbsp;<span class="ident" id="4307565">_</span><span class="op" id="4307566">,</span>&nbsp;<span class="ident" id="4307568">name</span>&nbsp;<span class="op" id="4307573">:=</span>&nbsp;<span class="keyword" id="4307576">range</span>&nbsp;<span class="ident" id="4307582">template</span><span class="op" id="4307590">.</span><span class="ident" id="4307591">IssuingCertificateURL</span>&nbsp;<span class="op" id="4307613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307618">aiaValues</span>&nbsp;<span class="op" id="4307628">=</span>&nbsp;<span class="builtinfunc" id="4307630">append</span><span class="op" id="4307636">(</span><span class="ident" id="4307637">aiaValues</span><span class="op" id="4307646">,</span>&nbsp;<span class="ident" id="4307648">authorityInfoAccess</span><span class="op" id="4307667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307673">Method</span><span class="op" id="4307679">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4307683">oidAuthorityInfoAccessIssuers</span><span class="op" id="4307712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307718">Location</span><span class="op" id="4307726">:</span>&nbsp;<span class="ident" id="4307728">asn1</span><span class="op" id="4307732">.</span><span class="ident" id="4307733">RawValue</span><span class="op" id="4307741">{</span><span class="ident" id="4307742">Tag</span><span class="op" id="4307745">:</span>&nbsp;<span class="num" id="4307747">6</span><span class="op" id="4307748">,</span>&nbsp;<span class="ident" id="4307750">Class</span><span class="op" id="4307755">:</span>&nbsp;<span class="num" id="4307757">2</span><span class="op" id="4307758">,</span>&nbsp;<span class="ident" id="4307760">Bytes</span><span class="op" id="4307765">:</span>&nbsp;<span class="op" id="4307767">[</span><span class="op" id="4307768">]</span><span class="builtintype" id="4307769">byte</span><span class="op" id="4307773">(</span><span class="ident" id="4307774">name</span><span class="op" id="4307778">)</span><span class="op" id="4307779">}</span><span class="op" id="4307780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307785">}</span><span class="op" id="4307786">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307794">ret</span><span class="op" id="4307797">[</span><span class="ident" id="4307798">n</span><span class="op" id="4307799">]</span><span class="op" id="4307800">.</span><span class="ident" id="4307801">Value</span><span class="op" id="4307806">,</span>&nbsp;<span class="ident" id="4307808">err</span>&nbsp;<span class="op" id="4307812">=</span>&nbsp;<span class="ident" id="4307814">asn1</span><span class="op" id="4307818">.</span><span class="ident" id="4307819">Marshal</span><span class="op" id="4307826">(</span><span class="ident" id="4307827">aiaValues</span><span class="op" id="4307836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307840">if</span>&nbsp;<span class="ident" id="4307843">err</span>&nbsp;<span class="op" id="4307847">!=</span>&nbsp;<span class="ident" id="4307850">nil</span>&nbsp;<span class="op" id="4307854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307868">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307872">n</span><span class="op" id="4307873">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307881">if</span>&nbsp;<span class="op" id="4307884">(</span><span class="builtinfunc" id="4307885">len</span><span class="op" id="4307888">(</span><span class="ident" id="4307889">template</span><span class="op" id="4307897">.</span><span class="ident" id="4307898">DNSNames</span><span class="op" id="4307906">)</span>&nbsp;<span class="op" id="4307908">&gt;</span>&nbsp;<span class="num" id="4307910">0</span>&nbsp;<span class="op" id="4307912">||</span>&nbsp;<span class="builtinfunc" id="4307915">len</span><span class="op" id="4307918">(</span><span class="ident" id="4307919">template</span><span class="op" id="4307927">.</span><span class="ident" id="4307928">EmailAddresses</span><span class="op" id="4307942">)</span>&nbsp;<span class="op" id="4307944">&gt;</span>&nbsp;<span class="num" id="4307946">0</span>&nbsp;<span class="op" id="4307948">||</span>&nbsp;<span class="builtinfunc" id="4307951">len</span><span class="op" id="4307954">(</span><span class="ident" id="4307955">template</span><span class="op" id="4307963">.</span><span class="ident" id="4307964">IPAddresses</span><span class="op" id="4307975">)</span>&nbsp;<span class="op" id="4307977">&gt;</span>&nbsp;<span class="num" id="4307979">0</span><span class="op" id="4307980">)</span>&nbsp;<span class="op" id="4307982">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307987">!</span><span class="ident" id="4307988">oidInExtensions</span><span class="op" id="4308003">(</span><span class="ident" id="4308004">oidExtensionSubjectAltName</span><span class="op" id="4308030">,</span>&nbsp;<span class="ident" id="4308032">template</span><span class="op" id="4308040">.</span><span class="ident" id="4308041">ExtraExtensions</span><span class="op" id="4308056">)</span>&nbsp;<span class="op" id="4308058">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308062">ret</span><span class="op" id="4308065">[</span><span class="ident" id="4308066">n</span><span class="op" id="4308067">]</span><span class="op" id="4308068">.</span><span class="ident" id="4308069">Id</span>&nbsp;<span class="op" id="4308072">=</span>&nbsp;<span class="ident" id="4308074">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308103">ret</span><span class="op" id="4308106">[</span><span class="ident" id="4308107">n</span><span class="op" id="4308108">]</span><span class="op" id="4308109">.</span><span class="ident" id="4308110">Value</span><span class="op" id="4308115">,</span>&nbsp;<span class="ident" id="4308117">err</span>&nbsp;<span class="op" id="4308121">=</span>&nbsp;<span class="ident" id="4308123">marshalSANs</span><span class="op" id="4308134">(</span><span class="ident" id="4308135">template</span><span class="op" id="4308143">.</span><span class="ident" id="4308144">DNSNames</span><span class="op" id="4308152">,</span>&nbsp;<span class="ident" id="4308154">template</span><span class="op" id="4308162">.</span><span class="ident" id="4308163">EmailAddresses</span><span class="op" id="4308177">,</span>&nbsp;<span class="ident" id="4308179">template</span><span class="op" id="4308187">.</span><span class="ident" id="4308188">IPAddresses</span><span class="op" id="4308199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308203">if</span>&nbsp;<span class="ident" id="4308206">err</span>&nbsp;<span class="op" id="4308210">!=</span>&nbsp;<span class="ident" id="4308213">nil</span>&nbsp;<span class="op" id="4308217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308222">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308231">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308235">n</span><span class="op" id="4308236">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308244">if</span>&nbsp;<span class="builtinfunc" id="4308247">len</span><span class="op" id="4308250">(</span><span class="ident" id="4308251">template</span><span class="op" id="4308259">.</span><span class="ident" id="4308260">PolicyIdentifiers</span><span class="op" id="4308277">)</span>&nbsp;<span class="op" id="4308279">&gt;</span>&nbsp;<span class="num" id="4308281">0</span>&nbsp;<span class="op" id="4308283">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308288">!</span><span class="ident" id="4308289">oidInExtensions</span><span class="op" id="4308304">(</span><span class="ident" id="4308305">oidExtensionCertificatePolicies</span><span class="op" id="4308336">,</span>&nbsp;<span class="ident" id="4308338">template</span><span class="op" id="4308346">.</span><span class="ident" id="4308347">ExtraExtensions</span><span class="op" id="4308362">)</span>&nbsp;<span class="op" id="4308364">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308368">ret</span><span class="op" id="4308371">[</span><span class="ident" id="4308372">n</span><span class="op" id="4308373">]</span><span class="op" id="4308374">.</span><span class="ident" id="4308375">Id</span>&nbsp;<span class="op" id="4308378">=</span>&nbsp;<span class="ident" id="4308380">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308414">policies</span>&nbsp;<span class="op" id="4308423">:=</span>&nbsp;<span class="builtinfunc" id="4308426">make</span><span class="op" id="4308430">(</span><span class="op" id="4308431">[</span><span class="op" id="4308432">]</span><span class="ident" id="4308433">policyInformation</span><span class="op" id="4308450">,</span>&nbsp;<span class="builtinfunc" id="4308452">len</span><span class="op" id="4308455">(</span><span class="ident" id="4308456">template</span><span class="op" id="4308464">.</span><span class="ident" id="4308465">PolicyIdentifiers</span><span class="op" id="4308482">)</span><span class="op" id="4308483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308487">for</span>&nbsp;<span class="ident" id="4308491">i</span><span class="op" id="4308492">,</span>&nbsp;<span class="ident" id="4308494">policy</span>&nbsp;<span class="op" id="4308501">:=</span>&nbsp;<span class="keyword" id="4308504">range</span>&nbsp;<span class="ident" id="4308510">template</span><span class="op" id="4308518">.</span><span class="ident" id="4308519">PolicyIdentifiers</span>&nbsp;<span class="op" id="4308537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308542">policies</span><span class="op" id="4308550">[</span><span class="ident" id="4308551">i</span><span class="op" id="4308552">]</span><span class="op" id="4308553">.</span><span class="ident" id="4308554">Policy</span>&nbsp;<span class="op" id="4308561">=</span>&nbsp;<span class="ident" id="4308563">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308572">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308576">ret</span><span class="op" id="4308579">[</span><span class="ident" id="4308580">n</span><span class="op" id="4308581">]</span><span class="op" id="4308582">.</span><span class="ident" id="4308583">Value</span><span class="op" id="4308588">,</span>&nbsp;<span class="ident" id="4308590">err</span>&nbsp;<span class="op" id="4308594">=</span>&nbsp;<span class="ident" id="4308596">asn1</span><span class="op" id="4308600">.</span><span class="ident" id="4308601">Marshal</span><span class="op" id="4308608">(</span><span class="ident" id="4308609">policies</span><span class="op" id="4308617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308621">if</span>&nbsp;<span class="ident" id="4308624">err</span>&nbsp;<span class="op" id="4308628">!=</span>&nbsp;<span class="ident" id="4308631">nil</span>&nbsp;<span class="op" id="4308635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308640">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308653">n</span><span class="op" id="4308654">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308662">if</span>&nbsp;<span class="builtinfunc" id="4308665">len</span><span class="op" id="4308668">(</span><span class="ident" id="4308669">template</span><span class="op" id="4308677">.</span><span class="ident" id="4308678">PermittedDNSDomains</span><span class="op" id="4308697">)</span>&nbsp;<span class="op" id="4308699">&gt;</span>&nbsp;<span class="num" id="4308701">0</span>&nbsp;<span class="op" id="4308703">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4308708">!</span><span class="ident" id="4308709">oidInExtensions</span><span class="op" id="4308724">(</span><span class="ident" id="4308725">oidExtensionNameConstraints</span><span class="op" id="4308752">,</span>&nbsp;<span class="ident" id="4308754">template</span><span class="op" id="4308762">.</span><span class="ident" id="4308763">ExtraExtensions</span><span class="op" id="4308778">)</span>&nbsp;<span class="op" id="4308780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308784">ret</span><span class="op" id="4308787">[</span><span class="ident" id="4308788">n</span><span class="op" id="4308789">]</span><span class="op" id="4308790">.</span><span class="ident" id="4308791">Id</span>&nbsp;<span class="op" id="4308794">=</span>&nbsp;<span class="ident" id="4308796">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308826">ret</span><span class="op" id="4308829">[</span><span class="ident" id="4308830">n</span><span class="op" id="4308831">]</span><span class="op" id="4308832">.</span><span class="ident" id="4308833">Critical</span>&nbsp;<span class="op" id="4308842">=</span>&nbsp;<span class="ident" id="4308844">template</span><span class="op" id="4308852">.</span><span class="ident" id="4308853">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308884">var</span>&nbsp;<span class="ident" id="4308888">out</span>&nbsp;<span class="ident" id="4308892">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4308910">out</span><span class="op" id="4308913">.</span><span class="ident" id="4308914">Permitted</span>&nbsp;<span class="op" id="4308924">=</span>&nbsp;<span class="builtinfunc" id="4308926">make</span><span class="op" id="4308930">(</span><span class="op" id="4308931">[</span><span class="op" id="4308932">]</span><span class="ident" id="4308933">generalSubtree</span><span class="op" id="4308947">,</span>&nbsp;<span class="builtinfunc" id="4308949">len</span><span class="op" id="4308952">(</span><span class="ident" id="4308953">template</span><span class="op" id="4308961">.</span><span class="ident" id="4308962">PermittedDNSDomains</span><span class="op" id="4308981">)</span><span class="op" id="4308982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308986">for</span>&nbsp;<span class="ident" id="4308990">i</span><span class="op" id="4308991">,</span>&nbsp;<span class="ident" id="4308993">permitted</span>&nbsp;<span class="op" id="4309003">:=</span>&nbsp;<span class="keyword" id="4309006">range</span>&nbsp;<span class="ident" id="4309012">template</span><span class="op" id="4309020">.</span><span class="ident" id="4309021">PermittedDNSDomains</span>&nbsp;<span class="op" id="4309041">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309046">out</span><span class="op" id="4309049">.</span><span class="ident" id="4309050">Permitted</span><span class="op" id="4309059">[</span><span class="ident" id="4309060">i</span><span class="op" id="4309061">]</span>&nbsp;<span class="op" id="4309063">=</span>&nbsp;<span class="ident" id="4309065">generalSubtree</span><span class="op" id="4309079">{</span><span class="ident" id="4309080">Name</span><span class="op" id="4309084">:</span>&nbsp;<span class="ident" id="4309086">permitted</span><span class="op" id="4309095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309103">ret</span><span class="op" id="4309106">[</span><span class="ident" id="4309107">n</span><span class="op" id="4309108">]</span><span class="op" id="4309109">.</span><span class="ident" id="4309110">Value</span><span class="op" id="4309115">,</span>&nbsp;<span class="ident" id="4309117">err</span>&nbsp;<span class="op" id="4309121">=</span>&nbsp;<span class="ident" id="4309123">asn1</span><span class="op" id="4309127">.</span><span class="ident" id="4309128">Marshal</span><span class="op" id="4309135">(</span><span class="ident" id="4309136">out</span><span class="op" id="4309139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309143">if</span>&nbsp;<span class="ident" id="4309146">err</span>&nbsp;<span class="op" id="4309150">!=</span>&nbsp;<span class="ident" id="4309153">nil</span>&nbsp;<span class="op" id="4309157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309162">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309175">n</span><span class="op" id="4309176">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309184">if</span>&nbsp;<span class="builtinfunc" id="4309187">len</span><span class="op" id="4309190">(</span><span class="ident" id="4309191">template</span><span class="op" id="4309199">.</span><span class="ident" id="4309200">CRLDistributionPoints</span><span class="op" id="4309221">)</span>&nbsp;<span class="op" id="4309223">&gt;</span>&nbsp;<span class="num" id="4309225">0</span>&nbsp;<span class="op" id="4309227">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309232">!</span><span class="ident" id="4309233">oidInExtensions</span><span class="op" id="4309248">(</span><span class="ident" id="4309249">oidExtensionCRLDistributionPoints</span><span class="op" id="4309282">,</span>&nbsp;<span class="ident" id="4309284">template</span><span class="op" id="4309292">.</span><span class="ident" id="4309293">ExtraExtensions</span><span class="op" id="4309308">)</span>&nbsp;<span class="op" id="4309310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309314">ret</span><span class="op" id="4309317">[</span><span class="ident" id="4309318">n</span><span class="op" id="4309319">]</span><span class="op" id="4309320">.</span><span class="ident" id="4309321">Id</span>&nbsp;<span class="op" id="4309324">=</span>&nbsp;<span class="ident" id="4309326">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309363">var</span>&nbsp;<span class="ident" id="4309367">crlDp</span>&nbsp;<span class="op" id="4309373">[</span><span class="op" id="4309374">]</span><span class="ident" id="4309375">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309395">for</span>&nbsp;<span class="ident" id="4309399">_</span><span class="op" id="4309400">,</span>&nbsp;<span class="ident" id="4309402">name</span>&nbsp;<span class="op" id="4309407">:=</span>&nbsp;<span class="keyword" id="4309410">range</span>&nbsp;<span class="ident" id="4309416">template</span><span class="op" id="4309424">.</span><span class="ident" id="4309425">CRLDistributionPoints</span>&nbsp;<span class="op" id="4309447">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309452">rawFullName</span><span class="op" id="4309463">,</span>&nbsp;<span class="ident" id="4309465">_</span>&nbsp;<span class="op" id="4309467">:=</span>&nbsp;<span class="ident" id="4309470">asn1</span><span class="op" id="4309474">.</span><span class="ident" id="4309475">Marshal</span><span class="op" id="4309482">(</span><span class="ident" id="4309483">asn1</span><span class="op" id="4309487">.</span><span class="ident" id="4309488">RawValue</span><span class="op" id="4309496">{</span><span class="ident" id="4309497">Tag</span><span class="op" id="4309500">:</span>&nbsp;<span class="num" id="4309502">6</span><span class="op" id="4309503">,</span>&nbsp;<span class="ident" id="4309505">Class</span><span class="op" id="4309510">:</span>&nbsp;<span class="num" id="4309512">2</span><span class="op" id="4309513">,</span>&nbsp;<span class="ident" id="4309515">Bytes</span><span class="op" id="4309520">:</span>&nbsp;<span class="op" id="4309522">[</span><span class="op" id="4309523">]</span><span class="builtintype" id="4309524">byte</span><span class="op" id="4309528">(</span><span class="ident" id="4309529">name</span><span class="op" id="4309533">)</span><span class="op" id="4309534">}</span><span class="op" id="4309535">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309541">dp</span>&nbsp;<span class="op" id="4309544">:=</span>&nbsp;<span class="ident" id="4309547">distributionPoint</span><span class="op" id="4309564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309570">DistributionPoint</span><span class="op" id="4309587">:</span>&nbsp;<span class="ident" id="4309589">distributionPointName</span><span class="op" id="4309610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309617">FullName</span><span class="op" id="4309625">:</span>&nbsp;<span class="ident" id="4309627">asn1</span><span class="op" id="4309631">.</span><span class="ident" id="4309632">RawValue</span><span class="op" id="4309640">{</span><span class="ident" id="4309641">Tag</span><span class="op" id="4309644">:</span>&nbsp;<span class="num" id="4309646">0</span><span class="op" id="4309647">,</span>&nbsp;<span class="ident" id="4309649">Class</span><span class="op" id="4309654">:</span>&nbsp;<span class="num" id="4309656">2</span><span class="op" id="4309657">,</span>&nbsp;<span class="ident" id="4309659">IsCompound</span><span class="op" id="4309669">:</span>&nbsp;<span class="builtintype" id="4309671">true</span><span class="op" id="4309675">,</span>&nbsp;<span class="ident" id="4309677">Bytes</span><span class="op" id="4309682">:</span>&nbsp;<span class="ident" id="4309684">rawFullName</span><span class="op" id="4309695">}</span><span class="op" id="4309696">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309702">}</span><span class="op" id="4309703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309713">crlDp</span>&nbsp;<span class="op" id="4309719">=</span>&nbsp;<span class="builtinfunc" id="4309721">append</span><span class="op" id="4309727">(</span><span class="ident" id="4309728">crlDp</span><span class="op" id="4309733">,</span>&nbsp;<span class="ident" id="4309735">dp</span><span class="op" id="4309737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309746">ret</span><span class="op" id="4309749">[</span><span class="ident" id="4309750">n</span><span class="op" id="4309751">]</span><span class="op" id="4309752">.</span><span class="ident" id="4309753">Value</span><span class="op" id="4309758">,</span>&nbsp;<span class="ident" id="4309760">err</span>&nbsp;<span class="op" id="4309764">=</span>&nbsp;<span class="ident" id="4309766">asn1</span><span class="op" id="4309770">.</span><span class="ident" id="4309771">Marshal</span><span class="op" id="4309778">(</span><span class="ident" id="4309779">crlDp</span><span class="op" id="4309784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309788">if</span>&nbsp;<span class="ident" id="4309791">err</span>&nbsp;<span class="op" id="4309795">!=</span>&nbsp;<span class="ident" id="4309798">nil</span>&nbsp;<span class="op" id="4309802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309807">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309820">n</span><span class="op" id="4309821">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4309829">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4309902">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309961">return</span>&nbsp;<span class="builtinfunc" id="4309968">append</span><span class="op" id="4309974">(</span><span class="ident" id="4309975">ret</span><span class="op" id="4309978">[</span><span class="op" id="4309979">:</span><span class="ident" id="4309980">n</span><span class="op" id="4309981">]</span><span class="op" id="4309982">,</span>&nbsp;<span class="ident" id="4309984">template</span><span class="op" id="4309992">.</span><span class="ident" id="4309993">ExtraExtensions</span><span class="op" id="4310008">...</span><span class="op" id="4310011">)</span><span class="op" id="4310012">,</span>&nbsp;<span class="ident" id="4310014">nil</span><br>
<span class="lineno"></span><span class="op" id="4310018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4310021">func</span>&nbsp;<span class="ident" id="4310026">subjectBytes</span><span class="op" id="4310038">(</span><span class="ident" id="4310039">cert</span>&nbsp;<span class="op" id="4310044">*</span><span class="ident" id="4310045">Certificate</span><span class="op" id="4310056">)</span>&nbsp;<span class="op" id="4310058">(</span><span class="op" id="4310059">[</span><span class="op" id="4310060">]</span><span class="builtintype" id="4310061">byte</span><span class="op" id="4310065">,</span>&nbsp;<span class="builtintype" id="4310067">error</span><span class="op" id="4310072">)</span>&nbsp;<span class="op" id="4310074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310077">if</span>&nbsp;<span class="builtinfunc" id="4310080">len</span><span class="op" id="4310083">(</span><span class="ident" id="4310084">cert</span><span class="op" id="4310088">.</span><span class="ident" id="4310089">RawSubject</span><span class="op" id="4310099">)</span>&nbsp;<span class="op" id="4310101">&gt;</span>&nbsp;<span class="num" id="4310103">0</span>&nbsp;<span class="op" id="4310105">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310109">return</span>&nbsp;<span class="ident" id="4310116">cert</span><span class="op" id="4310120">.</span><span class="ident" id="4310121">RawSubject</span><span class="op" id="4310131">,</span>&nbsp;<span class="ident" id="4310133">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310142">return</span>&nbsp;<span class="ident" id="4310149">asn1</span><span class="op" id="4310153">.</span><span class="ident" id="4310154">Marshal</span><span class="op" id="4310161">(</span><span class="ident" id="4310162">cert</span><span class="op" id="4310166">.</span><span class="ident" id="4310167">Subject</span><span class="op" id="4310174">.</span><span class="ident" id="4310175">ToRDNSequence</span><span class="op" id="4310188">(</span><span class="op" id="4310189">)</span><span class="op" id="4310190">)</span><br>
<span class="lineno"></span><span class="op" id="4310192">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4310195">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4310272">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4310343">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4310367">func</span>&nbsp;<span class="ident" id="4310372">signingParamsForPrivateKey</span><span class="op" id="4310398">(</span><span class="ident" id="4310399">priv</span>&nbsp;<span class="keyword" id="4310404">interface</span><span class="op" id="4310413">{</span><span class="op" id="4310414">}</span><span class="op" id="4310415">,</span>&nbsp;<span class="ident" id="4310417">requestedSigAlgo</span>&nbsp;<span class="ident" id="4310434">SignatureAlgorithm</span><span class="op" id="4310452">)</span>&nbsp;<span class="op" id="4310454">(</span><span class="ident" id="4310455">hashFunc</span>&nbsp;<span class="ident" id="4310464">crypto</span><span class="op" id="4310470">.</span><span class="ident" id="4310471">Hash</span><span class="op" id="4310475">,</span>&nbsp;<span class="ident" id="4310477">sigAlgo</span>&nbsp;<span class="ident" id="4310485">pkix</span><span class="op" id="4310489">.</span><span class="ident" id="4310490">AlgorithmIdentifier</span><span class="op" id="4310509">,</span>&nbsp;<span class="ident" id="4310511">err</span>&nbsp;<span class="builtintype" id="4310515">error</span><span class="op" id="4310520">)</span>&nbsp;<span class="op" id="4310522">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310525">var</span>&nbsp;<span class="ident" id="4310529">pubType</span>&nbsp;<span class="ident" id="4310537">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310558">switch</span>&nbsp;<span class="ident" id="4310565">priv</span>&nbsp;<span class="op" id="4310570">:=</span>&nbsp;<span class="ident" id="4310573">priv</span><span class="op" id="4310577">.</span><span class="op" id="4310578">(</span><span class="keyword" id="4310579">type</span><span class="op" id="4310583">)</span>&nbsp;<span class="op" id="4310585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310588">case</span>&nbsp;<span class="op" id="4310593">*</span><span class="ident" id="4310594">rsa</span><span class="op" id="4310597">.</span><span class="ident" id="4310598">PrivateKey</span><span class="op" id="4310608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310612">pubType</span>&nbsp;<span class="op" id="4310620">=</span>&nbsp;<span class="ident" id="4310622">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310628">sigAlgo</span><span class="op" id="4310635">.</span><span class="ident" id="4310636">Algorithm</span>&nbsp;<span class="op" id="4310646">=</span>&nbsp;<span class="ident" id="4310648">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310676">hashFunc</span>&nbsp;<span class="op" id="4310685">=</span>&nbsp;<span class="ident" id="4310687">crypto</span><span class="op" id="4310693">.</span><span class="ident" id="4310694">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310703">case</span>&nbsp;<span class="op" id="4310708">*</span><span class="ident" id="4310709">ecdsa</span><span class="op" id="4310714">.</span><span class="ident" id="4310715">PrivateKey</span><span class="op" id="4310725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310729">pubType</span>&nbsp;<span class="op" id="4310737">=</span>&nbsp;<span class="ident" id="4310739">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310748">switch</span>&nbsp;<span class="ident" id="4310755">priv</span><span class="op" id="4310759">.</span><span class="ident" id="4310760">Curve</span>&nbsp;<span class="op" id="4310766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310770">case</span>&nbsp;<span class="ident" id="4310775">elliptic</span><span class="op" id="4310783">.</span><span class="ident" id="4310784">P224</span><span class="op" id="4310788">(</span><span class="op" id="4310789">)</span><span class="op" id="4310790">,</span>&nbsp;<span class="ident" id="4310792">elliptic</span><span class="op" id="4310800">.</span><span class="ident" id="4310801">P256</span><span class="op" id="4310805">(</span><span class="op" id="4310806">)</span><span class="op" id="4310807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310812">hashFunc</span>&nbsp;<span class="op" id="4310821">=</span>&nbsp;<span class="ident" id="4310823">crypto</span><span class="op" id="4310829">.</span><span class="ident" id="4310830">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310840">sigAlgo</span><span class="op" id="4310847">.</span><span class="ident" id="4310848">Algorithm</span>&nbsp;<span class="op" id="4310858">=</span>&nbsp;<span class="ident" id="4310860">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310890">case</span>&nbsp;<span class="ident" id="4310895">elliptic</span><span class="op" id="4310903">.</span><span class="ident" id="4310904">P384</span><span class="op" id="4310908">(</span><span class="op" id="4310909">)</span><span class="op" id="4310910">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310915">hashFunc</span>&nbsp;<span class="op" id="4310924">=</span>&nbsp;<span class="ident" id="4310926">crypto</span><span class="op" id="4310932">.</span><span class="ident" id="4310933">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310943">sigAlgo</span><span class="op" id="4310950">.</span><span class="ident" id="4310951">Algorithm</span>&nbsp;<span class="op" id="4310961">=</span>&nbsp;<span class="ident" id="4310963">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310993">case</span>&nbsp;<span class="ident" id="4310998">elliptic</span><span class="op" id="4311006">.</span><span class="ident" id="4311007">P521</span><span class="op" id="4311011">(</span><span class="op" id="4311012">)</span><span class="op" id="4311013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311018">hashFunc</span>&nbsp;<span class="op" id="4311027">=</span>&nbsp;<span class="ident" id="4311029">crypto</span><span class="op" id="4311035">.</span><span class="ident" id="4311036">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311046">sigAlgo</span><span class="op" id="4311053">.</span><span class="ident" id="4311054">Algorithm</span>&nbsp;<span class="op" id="4311064">=</span>&nbsp;<span class="ident" id="4311066">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311096">default</span><span class="op" id="4311103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311108">err</span>&nbsp;<span class="op" id="4311112">=</span>&nbsp;<span class="ident" id="4311114">errors</span><span class="op" id="4311120">.</span><span class="ident" id="4311121">New</span><span class="op" id="4311124">(</span><span class="string" id="4311125">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4311155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311163">default</span><span class="op" id="4311170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311174">err</span>&nbsp;<span class="op" id="4311178">=</span>&nbsp;<span class="ident" id="4311180">errors</span><span class="op" id="4311186">.</span><span class="ident" id="4311187">New</span><span class="op" id="4311190">(</span><span class="string" id="4311191">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4311240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311247">if</span>&nbsp;<span class="ident" id="4311250">err</span>&nbsp;<span class="op" id="4311254">!=</span>&nbsp;<span class="ident" id="4311257">nil</span>&nbsp;<span class="op" id="4311261">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311265">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311277">if</span>&nbsp;<span class="ident" id="4311280">requestedSigAlgo</span>&nbsp;<span class="op" id="4311297">==</span>&nbsp;<span class="num" id="4311300">0</span>&nbsp;<span class="op" id="4311302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311306">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311318">found</span>&nbsp;<span class="op" id="4311324">:=</span>&nbsp;<span class="builtintype" id="4311327">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311334">for</span>&nbsp;<span class="ident" id="4311338">_</span><span class="op" id="4311339">,</span>&nbsp;<span class="ident" id="4311341">details</span>&nbsp;<span class="op" id="4311349">:=</span>&nbsp;<span class="keyword" id="4311352">range</span>&nbsp;<span class="ident" id="4311358">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4311384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311388">if</span>&nbsp;<span class="ident" id="4311391">details</span><span class="op" id="4311398">.</span><span class="ident" id="4311399">algo</span>&nbsp;<span class="op" id="4311404">==</span>&nbsp;<span class="ident" id="4311407">requestedSigAlgo</span>&nbsp;<span class="op" id="4311424">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311429">if</span>&nbsp;<span class="ident" id="4311432">details</span><span class="op" id="4311439">.</span><span class="ident" id="4311440">pubKeyAlgo</span>&nbsp;<span class="op" id="4311451">!=</span>&nbsp;<span class="ident" id="4311454">pubType</span>&nbsp;<span class="op" id="4311462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311468">err</span>&nbsp;<span class="op" id="4311472">=</span>&nbsp;<span class="ident" id="4311474">errors</span><span class="op" id="4311480">.</span><span class="ident" id="4311481">New</span><span class="op" id="4311484">(</span><span class="string" id="4311485">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4311553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311559">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311574">sigAlgo</span><span class="op" id="4311581">.</span><span class="ident" id="4311582">Algorithm</span><span class="op" id="4311591">,</span>&nbsp;<span class="ident" id="4311593">hashFunc</span>&nbsp;<span class="op" id="4311602">=</span>&nbsp;<span class="ident" id="4311604">details</span><span class="op" id="4311611">.</span><span class="ident" id="4311612">oid</span><span class="op" id="4311615">,</span>&nbsp;<span class="ident" id="4311617">details</span><span class="op" id="4311624">.</span><span class="ident" id="4311625">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311633">if</span>&nbsp;<span class="ident" id="4311636">hashFunc</span>&nbsp;<span class="op" id="4311645">==</span>&nbsp;<span class="num" id="4311648">0</span>&nbsp;<span class="op" id="4311650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311656">err</span>&nbsp;<span class="op" id="4311660">=</span>&nbsp;<span class="ident" id="4311662">errors</span><span class="op" id="4311668">.</span><span class="ident" id="4311669">New</span><span class="op" id="4311672">(</span><span class="string" id="4311673">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4311721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311727">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311742">found</span>&nbsp;<span class="op" id="4311748">=</span>&nbsp;<span class="builtintype" id="4311750">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311758">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311773">if</span>&nbsp;<span class="op" id="4311776">!</span><span class="ident" id="4311777">found</span>&nbsp;<span class="op" id="4311783">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311787">err</span>&nbsp;<span class="op" id="4311791">=</span>&nbsp;<span class="ident" id="4311793">errors</span><span class="op" id="4311799">.</span><span class="ident" id="4311800">New</span><span class="op" id="4311803">(</span><span class="string" id="4311804">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4311838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311845">return</span><br>
<span class="lineno"></span><span class="op" id="4311852">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4311855">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4311927">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4312004">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4312083">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4312157">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4312201">//</span><br>
<span class="lineno"></span><span class="comment" id="4312204">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4312284">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4312358">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4312411">//</span><br>
<span class="lineno"></span><span class="comment" id="4312414">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4312472">//</span><br>
<span class="lineno"></span><span class="comment" id="4312475">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4312544">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4312621">func</span>&nbsp;<span class="ident" id="4312626">CreateCertificate</span><span class="op" id="4312643">(</span><span class="ident" id="4312644">rand</span>&nbsp;<span class="ident" id="4312649">io</span><span class="op" id="4312651">.</span><span class="ident" id="4312652">Reader</span><span class="op" id="4312658">,</span>&nbsp;<span class="ident" id="4312660">template</span><span class="op" id="4312668">,</span>&nbsp;<span class="ident" id="4312670">parent</span>&nbsp;<span class="op" id="4312677">*</span><span class="ident" id="4312678">Certificate</span><span class="op" id="4312689">,</span>&nbsp;<span class="ident" id="4312691">pub</span>&nbsp;<span class="keyword" id="4312695">interface</span><span class="op" id="4312704">{</span><span class="op" id="4312705">}</span><span class="op" id="4312706">,</span>&nbsp;<span class="ident" id="4312708">priv</span>&nbsp;<span class="keyword" id="4312713">interface</span><span class="op" id="4312722">{</span><span class="op" id="4312723">}</span><span class="op" id="4312724">)</span>&nbsp;<span class="op" id="4312726">(</span><span class="ident" id="4312727">cert</span>&nbsp;<span class="op" id="4312732">[</span><span class="op" id="4312733">]</span><span class="builtintype" id="4312734">byte</span><span class="op" id="4312738">,</span>&nbsp;<span class="ident" id="4312740">err</span>&nbsp;<span class="builtintype" id="4312744">error</span><span class="op" id="4312749">)</span>&nbsp;<span class="op" id="4312751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312754">hashFunc</span><span class="op" id="4312762">,</span>&nbsp;<span class="ident" id="4312764">signatureAlgorithm</span><span class="op" id="4312782">,</span>&nbsp;<span class="ident" id="4312784">err</span>&nbsp;<span class="op" id="4312788">:=</span>&nbsp;<span class="ident" id="4312791">signingParamsForPrivateKey</span><span class="op" id="4312817">(</span><span class="ident" id="4312818">priv</span><span class="op" id="4312822">,</span>&nbsp;<span class="ident" id="4312824">template</span><span class="op" id="4312832">.</span><span class="ident" id="4312833">SignatureAlgorithm</span><span class="op" id="4312851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312854">if</span>&nbsp;<span class="ident" id="4312857">err</span>&nbsp;<span class="op" id="4312861">!=</span>&nbsp;<span class="ident" id="4312864">nil</span>&nbsp;<span class="op" id="4312868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312872">return</span>&nbsp;<span class="ident" id="4312879">nil</span><span class="op" id="4312882">,</span>&nbsp;<span class="ident" id="4312884">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312889">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312893">publicKeyBytes</span><span class="op" id="4312907">,</span>&nbsp;<span class="ident" id="4312909">publicKeyAlgorithm</span><span class="op" id="4312927">,</span>&nbsp;<span class="ident" id="4312929">err</span>&nbsp;<span class="op" id="4312933">:=</span>&nbsp;<span class="ident" id="4312936">marshalPublicKey</span><span class="op" id="4312952">(</span><span class="ident" id="4312953">pub</span><span class="op" id="4312956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312959">if</span>&nbsp;<span class="ident" id="4312962">err</span>&nbsp;<span class="op" id="4312966">!=</span>&nbsp;<span class="ident" id="4312969">nil</span>&nbsp;<span class="op" id="4312973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312977">return</span>&nbsp;<span class="ident" id="4312984">nil</span><span class="op" id="4312987">,</span>&nbsp;<span class="ident" id="4312989">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312994">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312998">if</span>&nbsp;<span class="ident" id="4313001">err</span>&nbsp;<span class="op" id="4313005">!=</span>&nbsp;<span class="ident" id="4313008">nil</span>&nbsp;<span class="op" id="4313012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313016">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313028">if</span>&nbsp;<span class="builtinfunc" id="4313031">len</span><span class="op" id="4313034">(</span><span class="ident" id="4313035">parent</span><span class="op" id="4313041">.</span><span class="ident" id="4313042">SubjectKeyId</span><span class="op" id="4313054">)</span>&nbsp;<span class="op" id="4313056">&gt;</span>&nbsp;<span class="num" id="4313058">0</span>&nbsp;<span class="op" id="4313060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313064">template</span><span class="op" id="4313072">.</span><span class="ident" id="4313073">AuthorityKeyId</span>&nbsp;<span class="op" id="4313088">=</span>&nbsp;<span class="ident" id="4313090">parent</span><span class="op" id="4313096">.</span><span class="ident" id="4313097">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313115">extensions</span><span class="op" id="4313125">,</span>&nbsp;<span class="ident" id="4313127">err</span>&nbsp;<span class="op" id="4313131">:=</span>&nbsp;<span class="ident" id="4313134">buildExtensions</span><span class="op" id="4313149">(</span><span class="ident" id="4313150">template</span><span class="op" id="4313158">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313161">if</span>&nbsp;<span class="ident" id="4313164">err</span>&nbsp;<span class="op" id="4313168">!=</span>&nbsp;<span class="ident" id="4313171">nil</span>&nbsp;<span class="op" id="4313175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313179">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313191">asn1Issuer</span><span class="op" id="4313201">,</span>&nbsp;<span class="ident" id="4313203">err</span>&nbsp;<span class="op" id="4313207">:=</span>&nbsp;<span class="ident" id="4313210">subjectBytes</span><span class="op" id="4313222">(</span><span class="ident" id="4313223">parent</span><span class="op" id="4313229">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313232">if</span>&nbsp;<span class="ident" id="4313235">err</span>&nbsp;<span class="op" id="4313239">!=</span>&nbsp;<span class="ident" id="4313242">nil</span>&nbsp;<span class="op" id="4313246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313250">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313262">asn1Subject</span><span class="op" id="4313273">,</span>&nbsp;<span class="ident" id="4313275">err</span>&nbsp;<span class="op" id="4313279">:=</span>&nbsp;<span class="ident" id="4313282">subjectBytes</span><span class="op" id="4313294">(</span><span class="ident" id="4313295">template</span><span class="op" id="4313303">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313306">if</span>&nbsp;<span class="ident" id="4313309">err</span>&nbsp;<span class="op" id="4313313">!=</span>&nbsp;<span class="ident" id="4313316">nil</span>&nbsp;<span class="op" id="4313320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313324">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313336">encodedPublicKey</span>&nbsp;<span class="op" id="4313353">:=</span>&nbsp;<span class="ident" id="4313356">asn1</span><span class="op" id="4313360">.</span><span class="ident" id="4313361">BitString</span><span class="op" id="4313370">{</span><span class="ident" id="4313371">BitLength</span><span class="op" id="4313380">:</span>&nbsp;<span class="builtinfunc" id="4313382">len</span><span class="op" id="4313385">(</span><span class="ident" id="4313386">publicKeyBytes</span><span class="op" id="4313400">)</span>&nbsp;<span class="op" id="4313402">*</span>&nbsp;<span class="num" id="4313404">8</span><span class="op" id="4313405">,</span>&nbsp;<span class="ident" id="4313407">Bytes</span><span class="op" id="4313412">:</span>&nbsp;<span class="ident" id="4313414">publicKeyBytes</span><span class="op" id="4313428">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313431">c</span>&nbsp;<span class="op" id="4313433">:=</span>&nbsp;<span class="ident" id="4313436">tbsCertificate</span><span class="op" id="4313450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313454">Version</span><span class="op" id="4313461">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4313474">2</span><span class="op" id="4313475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313479">SerialNumber</span><span class="op" id="4313491">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313499">template</span><span class="op" id="4313507">.</span><span class="ident" id="4313508">SerialNumber</span><span class="op" id="4313520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313524">SignatureAlgorithm</span><span class="op" id="4313542">:</span>&nbsp;<span class="ident" id="4313544">signatureAlgorithm</span><span class="op" id="4313562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313566">Issuer</span><span class="op" id="4313572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313586">asn1</span><span class="op" id="4313590">.</span><span class="ident" id="4313591">RawValue</span><span class="op" id="4313599">{</span><span class="ident" id="4313600">FullBytes</span><span class="op" id="4313609">:</span>&nbsp;<span class="ident" id="4313611">asn1Issuer</span><span class="op" id="4313621">}</span><span class="op" id="4313622">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313626">Validity</span><span class="op" id="4313634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313646">validity</span><span class="op" id="4313654">{</span><span class="ident" id="4313655">template</span><span class="op" id="4313663">.</span><span class="ident" id="4313664">NotBefore</span><span class="op" id="4313673">.</span><span class="ident" id="4313674">UTC</span><span class="op" id="4313677">(</span><span class="op" id="4313678">)</span><span class="op" id="4313679">,</span>&nbsp;<span class="ident" id="4313681">template</span><span class="op" id="4313689">.</span><span class="ident" id="4313690">NotAfter</span><span class="op" id="4313698">.</span><span class="ident" id="4313699">UTC</span><span class="op" id="4313702">(</span><span class="op" id="4313703">)</span><span class="op" id="4313704">}</span><span class="op" id="4313705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313709">Subject</span><span class="op" id="4313716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313729">asn1</span><span class="op" id="4313733">.</span><span class="ident" id="4313734">RawValue</span><span class="op" id="4313742">{</span><span class="ident" id="4313743">FullBytes</span><span class="op" id="4313752">:</span>&nbsp;<span class="ident" id="4313754">asn1Subject</span><span class="op" id="4313765">}</span><span class="op" id="4313766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313770">PublicKey</span><span class="op" id="4313779">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313790">publicKeyInfo</span><span class="op" id="4313803">{</span><span class="ident" id="4313804">nil</span><span class="op" id="4313807">,</span>&nbsp;<span class="ident" id="4313809">publicKeyAlgorithm</span><span class="op" id="4313827">,</span>&nbsp;<span class="ident" id="4313829">encodedPublicKey</span><span class="op" id="4313845">}</span><span class="op" id="4313846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313850">Extensions</span><span class="op" id="4313860">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313870">extensions</span><span class="op" id="4313880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313883">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313887">tbsCertContents</span><span class="op" id="4313902">,</span>&nbsp;<span class="ident" id="4313904">err</span>&nbsp;<span class="op" id="4313908">:=</span>&nbsp;<span class="ident" id="4313911">asn1</span><span class="op" id="4313915">.</span><span class="ident" id="4313916">Marshal</span><span class="op" id="4313923">(</span><span class="ident" id="4313924">c</span><span class="op" id="4313925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313928">if</span>&nbsp;<span class="ident" id="4313931">err</span>&nbsp;<span class="op" id="4313935">!=</span>&nbsp;<span class="ident" id="4313938">nil</span>&nbsp;<span class="op" id="4313942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313946">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313954">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313958">c</span><span class="op" id="4313959">.</span><span class="ident" id="4313960">Raw</span>&nbsp;<span class="op" id="4313964">=</span>&nbsp;<span class="ident" id="4313966">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313984">h</span>&nbsp;<span class="op" id="4313986">:=</span>&nbsp;<span class="ident" id="4313989">hashFunc</span><span class="op" id="4313997">.</span><span class="ident" id="4313998">New</span><span class="op" id="4314001">(</span><span class="op" id="4314002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314005">h</span><span class="op" id="4314006">.</span><span class="ident" id="4314007">Write</span><span class="op" id="4314012">(</span><span class="ident" id="4314013">tbsCertContents</span><span class="op" id="4314028">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314031">digest</span>&nbsp;<span class="op" id="4314038">:=</span>&nbsp;<span class="ident" id="4314041">h</span><span class="op" id="4314042">.</span><span class="ident" id="4314043">Sum</span><span class="op" id="4314046">(</span><span class="ident" id="4314047">nil</span><span class="op" id="4314050">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314054">var</span>&nbsp;<span class="ident" id="4314058">signature</span>&nbsp;<span class="op" id="4314068">[</span><span class="op" id="4314069">]</span><span class="builtintype" id="4314070">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314077">switch</span>&nbsp;<span class="ident" id="4314084">priv</span>&nbsp;<span class="op" id="4314089">:=</span>&nbsp;<span class="ident" id="4314092">priv</span><span class="op" id="4314096">.</span><span class="op" id="4314097">(</span><span class="keyword" id="4314098">type</span><span class="op" id="4314102">)</span>&nbsp;<span class="op" id="4314104">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314107">case</span>&nbsp;<span class="op" id="4314112">*</span><span class="ident" id="4314113">rsa</span><span class="op" id="4314116">.</span><span class="ident" id="4314117">PrivateKey</span><span class="op" id="4314127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314131">signature</span><span class="op" id="4314140">,</span>&nbsp;<span class="ident" id="4314142">err</span>&nbsp;<span class="op" id="4314146">=</span>&nbsp;<span class="ident" id="4314148">rsa</span><span class="op" id="4314151">.</span><span class="ident" id="4314152">SignPKCS1v15</span><span class="op" id="4314164">(</span><span class="ident" id="4314165">rand</span><span class="op" id="4314169">,</span>&nbsp;<span class="ident" id="4314171">priv</span><span class="op" id="4314175">,</span>&nbsp;<span class="ident" id="4314177">hashFunc</span><span class="op" id="4314185">,</span>&nbsp;<span class="ident" id="4314187">digest</span><span class="op" id="4314193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314196">case</span>&nbsp;<span class="op" id="4314201">*</span><span class="ident" id="4314202">ecdsa</span><span class="op" id="4314207">.</span><span class="ident" id="4314208">PrivateKey</span><span class="op" id="4314218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314222">var</span>&nbsp;<span class="ident" id="4314226">r</span><span class="op" id="4314227">,</span>&nbsp;<span class="ident" id="4314229">s</span>&nbsp;<span class="op" id="4314231">*</span><span class="ident" id="4314232">big</span><span class="op" id="4314235">.</span><span class="ident" id="4314236">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314242">if</span>&nbsp;<span class="ident" id="4314245">r</span><span class="op" id="4314246">,</span>&nbsp;<span class="ident" id="4314248">s</span><span class="op" id="4314249">,</span>&nbsp;<span class="ident" id="4314251">err</span>&nbsp;<span class="op" id="4314255">=</span>&nbsp;<span class="ident" id="4314257">ecdsa</span><span class="op" id="4314262">.</span><span class="ident" id="4314263">Sign</span><span class="op" id="4314267">(</span><span class="ident" id="4314268">rand</span><span class="op" id="4314272">,</span>&nbsp;<span class="ident" id="4314274">priv</span><span class="op" id="4314278">,</span>&nbsp;<span class="ident" id="4314280">digest</span><span class="op" id="4314286">)</span><span class="op" id="4314287">;</span>&nbsp;<span class="ident" id="4314289">err</span>&nbsp;<span class="op" id="4314293">==</span>&nbsp;<span class="ident" id="4314296">nil</span>&nbsp;<span class="op" id="4314300">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314305">signature</span><span class="op" id="4314314">,</span>&nbsp;<span class="ident" id="4314316">err</span>&nbsp;<span class="op" id="4314320">=</span>&nbsp;<span class="ident" id="4314322">asn1</span><span class="op" id="4314326">.</span><span class="ident" id="4314327">Marshal</span><span class="op" id="4314334">(</span><span class="ident" id="4314335">ecdsaSignature</span><span class="op" id="4314349">{</span><span class="ident" id="4314350">r</span><span class="op" id="4314351">,</span>&nbsp;<span class="ident" id="4314353">s</span><span class="op" id="4314354">}</span><span class="op" id="4314355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314362">default</span><span class="op" id="4314369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4314373">panic</span><span class="op" id="4314378">(</span><span class="string" id="4314379">&#34;internal&nbsp;error&#34;</span><span class="op" id="4314395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314398">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314402">if</span>&nbsp;<span class="ident" id="4314405">err</span>&nbsp;<span class="op" id="4314409">!=</span>&nbsp;<span class="ident" id="4314412">nil</span>&nbsp;<span class="op" id="4314416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314420">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314432">cert</span><span class="op" id="4314436">,</span>&nbsp;<span class="ident" id="4314438">err</span>&nbsp;<span class="op" id="4314442">=</span>&nbsp;<span class="ident" id="4314444">asn1</span><span class="op" id="4314448">.</span><span class="ident" id="4314449">Marshal</span><span class="op" id="4314456">(</span><span class="ident" id="4314457">certificate</span><span class="op" id="4314468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314472">nil</span><span class="op" id="4314475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314479">c</span><span class="op" id="4314480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314484">signatureAlgorithm</span><span class="op" id="4314502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314506">asn1</span><span class="op" id="4314510">.</span><span class="ident" id="4314511">BitString</span><span class="op" id="4314520">{</span><span class="ident" id="4314521">Bytes</span><span class="op" id="4314526">:</span>&nbsp;<span class="ident" id="4314528">signature</span><span class="op" id="4314537">,</span>&nbsp;<span class="ident" id="4314539">BitLength</span><span class="op" id="4314548">:</span>&nbsp;<span class="builtinfunc" id="4314550">len</span><span class="op" id="4314553">(</span><span class="ident" id="4314554">signature</span><span class="op" id="4314563">)</span>&nbsp;<span class="op" id="4314565">*</span>&nbsp;<span class="num" id="4314567">8</span><span class="op" id="4314568">}</span><span class="op" id="4314569">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314572">}</span><span class="op" id="4314573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314576">return</span><br>
<span class="lineno"></span><span class="op" id="4314583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4314586">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4314664">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4314672">var</span>&nbsp;<span class="ident" id="4314676">pemCRLPrefix</span>&nbsp;<span class="op" id="4314689">=</span>&nbsp;<span class="op" id="4314691">[</span><span class="op" id="4314692">]</span><span class="builtintype" id="4314693">byte</span><span class="op" id="4314697">(</span><span class="string" id="4314698">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4314719">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4314722">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4314767">var</span>&nbsp;<span class="ident" id="4314771">pemType</span>&nbsp;<span class="op" id="4314779">=</span>&nbsp;<span class="string" id="4314781">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4314793">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4314869">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4314948">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4315025">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4315037">func</span>&nbsp;<span class="ident" id="4315042">ParseCRL</span><span class="op" id="4315050">(</span><span class="ident" id="4315051">crlBytes</span>&nbsp;<span class="op" id="4315060">[</span><span class="op" id="4315061">]</span><span class="builtintype" id="4315062">byte</span><span class="op" id="4315066">)</span>&nbsp;<span class="op" id="4315068">(</span><span class="ident" id="4315069">certList</span>&nbsp;<span class="op" id="4315078">*</span><span class="ident" id="4315079">pkix</span><span class="op" id="4315083">.</span><span class="ident" id="4315084">CertificateList</span><span class="op" id="4315099">,</span>&nbsp;<span class="ident" id="4315101">err</span>&nbsp;<span class="builtintype" id="4315105">error</span><span class="op" id="4315110">)</span>&nbsp;<span class="op" id="4315112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315115">if</span>&nbsp;<span class="ident" id="4315118">bytes</span><span class="op" id="4315123">.</span><span class="ident" id="4315124">HasPrefix</span><span class="op" id="4315133">(</span><span class="ident" id="4315134">crlBytes</span><span class="op" id="4315142">,</span>&nbsp;<span class="ident" id="4315144">pemCRLPrefix</span><span class="op" id="4315156">)</span>&nbsp;<span class="op" id="4315158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315162">block</span><span class="op" id="4315167">,</span>&nbsp;<span class="ident" id="4315169">_</span>&nbsp;<span class="op" id="4315171">:=</span>&nbsp;<span class="ident" id="4315174">pem</span><span class="op" id="4315177">.</span><span class="ident" id="4315178">Decode</span><span class="op" id="4315184">(</span><span class="ident" id="4315185">crlBytes</span><span class="op" id="4315193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315197">if</span>&nbsp;<span class="ident" id="4315200">block</span>&nbsp;<span class="op" id="4315206">!=</span>&nbsp;<span class="ident" id="4315209">nil</span>&nbsp;<span class="op" id="4315213">&amp;&amp;</span>&nbsp;<span class="ident" id="4315216">block</span><span class="op" id="4315221">.</span><span class="ident" id="4315222">Type</span>&nbsp;<span class="op" id="4315227">==</span>&nbsp;<span class="ident" id="4315230">pemType</span>&nbsp;<span class="op" id="4315238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315243">crlBytes</span>&nbsp;<span class="op" id="4315252">=</span>&nbsp;<span class="ident" id="4315254">block</span><span class="op" id="4315259">.</span><span class="ident" id="4315260">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315274">return</span>&nbsp;<span class="ident" id="4315281">ParseDERCRL</span><span class="op" id="4315292">(</span><span class="ident" id="4315293">crlBytes</span><span class="op" id="4315301">)</span><br>
<span class="lineno"></span><span class="op" id="4315303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4315306">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4315368">func</span>&nbsp;<span class="ident" id="4315373">ParseDERCRL</span><span class="op" id="4315384">(</span><span class="ident" id="4315385">derBytes</span>&nbsp;<span class="op" id="4315394">[</span><span class="op" id="4315395">]</span><span class="builtintype" id="4315396">byte</span><span class="op" id="4315400">)</span>&nbsp;<span class="op" id="4315402">(</span><span class="ident" id="4315403">certList</span>&nbsp;<span class="op" id="4315412">*</span><span class="ident" id="4315413">pkix</span><span class="op" id="4315417">.</span><span class="ident" id="4315418">CertificateList</span><span class="op" id="4315433">,</span>&nbsp;<span class="ident" id="4315435">err</span>&nbsp;<span class="builtintype" id="4315439">error</span><span class="op" id="4315444">)</span>&nbsp;<span class="op" id="4315446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315449">certList</span>&nbsp;<span class="op" id="4315458">=</span>&nbsp;<span class="builtinfunc" id="4315460">new</span><span class="op" id="4315463">(</span><span class="ident" id="4315464">pkix</span><span class="op" id="4315468">.</span><span class="ident" id="4315469">CertificateList</span><span class="op" id="4315484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315487">_</span><span class="op" id="4315488">,</span>&nbsp;<span class="ident" id="4315490">err</span>&nbsp;<span class="op" id="4315494">=</span>&nbsp;<span class="ident" id="4315496">asn1</span><span class="op" id="4315500">.</span><span class="ident" id="4315501">Unmarshal</span><span class="op" id="4315510">(</span><span class="ident" id="4315511">derBytes</span><span class="op" id="4315519">,</span>&nbsp;<span class="ident" id="4315521">certList</span><span class="op" id="4315529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315532">if</span>&nbsp;<span class="ident" id="4315535">err</span>&nbsp;<span class="op" id="4315539">!=</span>&nbsp;<span class="ident" id="4315542">nil</span>&nbsp;<span class="op" id="4315546">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315550">certList</span>&nbsp;<span class="op" id="4315559">=</span>&nbsp;<span class="ident" id="4315561">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315569">return</span><br>
<span class="lineno"></span><span class="op" id="4315576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4315579">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4315652">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4315704">//</span><br>
<span class="lineno"></span><span class="comment" id="4315707">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4315773">func</span>&nbsp;<span class="op" id="4315778">(</span><span class="ident" id="4315779">c</span>&nbsp;<span class="op" id="4315781">*</span><span class="ident" id="4315782">Certificate</span><span class="op" id="4315793">)</span>&nbsp;<span class="ident" id="4315795">CreateCRL</span><span class="op" id="4315804">(</span><span class="ident" id="4315805">rand</span>&nbsp;<span class="ident" id="4315810">io</span><span class="op" id="4315812">.</span><span class="ident" id="4315813">Reader</span><span class="op" id="4315819">,</span>&nbsp;<span class="ident" id="4315821">priv</span>&nbsp;<span class="keyword" id="4315826">interface</span><span class="op" id="4315835">{</span><span class="op" id="4315836">}</span><span class="op" id="4315837">,</span>&nbsp;<span class="ident" id="4315839">revokedCerts</span>&nbsp;<span class="op" id="4315852">[</span><span class="op" id="4315853">]</span><span class="ident" id="4315854">pkix</span><span class="op" id="4315858">.</span><span class="ident" id="4315859">RevokedCertificate</span><span class="op" id="4315877">,</span>&nbsp;<span class="ident" id="4315879">now</span><span class="op" id="4315882">,</span>&nbsp;<span class="ident" id="4315884">expiry</span>&nbsp;<span class="ident" id="4315891">time</span><span class="op" id="4315895">.</span><span class="ident" id="4315896">Time</span><span class="op" id="4315900">)</span>&nbsp;<span class="op" id="4315902">(</span><span class="ident" id="4315903">crlBytes</span>&nbsp;<span class="op" id="4315912">[</span><span class="op" id="4315913">]</span><span class="builtintype" id="4315914">byte</span><span class="op" id="4315918">,</span>&nbsp;<span class="ident" id="4315920">err</span>&nbsp;<span class="builtintype" id="4315924">error</span><span class="op" id="4315929">)</span>&nbsp;<span class="op" id="4315931">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315934">rsaPriv</span><span class="op" id="4315941">,</span>&nbsp;<span class="ident" id="4315943">ok</span>&nbsp;<span class="op" id="4315946">:=</span>&nbsp;<span class="ident" id="4315949">priv</span><span class="op" id="4315953">.</span><span class="op" id="4315954">(</span><span class="op" id="4315955">*</span><span class="ident" id="4315956">rsa</span><span class="op" id="4315959">.</span><span class="ident" id="4315960">PrivateKey</span><span class="op" id="4315970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315973">if</span>&nbsp;<span class="op" id="4315976">!</span><span class="ident" id="4315977">ok</span>&nbsp;<span class="op" id="4315980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315984">return</span>&nbsp;<span class="ident" id="4315991">nil</span><span class="op" id="4315994">,</span>&nbsp;<span class="ident" id="4315996">errors</span><span class="op" id="4316002">.</span><span class="ident" id="4316003">New</span><span class="op" id="4316006">(</span><span class="string" id="4316007">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4316049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316055">tbsCertList</span>&nbsp;<span class="op" id="4316067">:=</span>&nbsp;<span class="ident" id="4316070">pkix</span><span class="op" id="4316074">.</span><span class="ident" id="4316075">TBSCertificateList</span><span class="op" id="4316093">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316097">Version</span><span class="op" id="4316104">:</span>&nbsp;<span class="num" id="4316106">2</span><span class="op" id="4316107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316111">Signature</span><span class="op" id="4316120">:</span>&nbsp;<span class="ident" id="4316122">pkix</span><span class="op" id="4316126">.</span><span class="ident" id="4316127">AlgorithmIdentifier</span><span class="op" id="4316146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316151">Algorithm</span><span class="op" id="4316160">:</span>&nbsp;<span class="ident" id="4316162">oidSignatureSHA1WithRSA</span><span class="op" id="4316185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316189">}</span><span class="op" id="4316190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316194">Issuer</span><span class="op" id="4316200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316215">c</span><span class="op" id="4316216">.</span><span class="ident" id="4316217">Subject</span><span class="op" id="4316224">.</span><span class="ident" id="4316225">ToRDNSequence</span><span class="op" id="4316238">(</span><span class="op" id="4316239">)</span><span class="op" id="4316240">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316244">ThisUpdate</span><span class="op" id="4316254">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316265">now</span><span class="op" id="4316268">.</span><span class="ident" id="4316269">UTC</span><span class="op" id="4316272">(</span><span class="op" id="4316273">)</span><span class="op" id="4316274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316278">NextUpdate</span><span class="op" id="4316288">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316299">expiry</span><span class="op" id="4316305">.</span><span class="ident" id="4316306">UTC</span><span class="op" id="4316309">(</span><span class="op" id="4316310">)</span><span class="op" id="4316311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316315">RevokedCertificates</span><span class="op" id="4316334">:</span>&nbsp;<span class="ident" id="4316336">revokedCerts</span><span class="op" id="4316348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316355">tbsCertListContents</span><span class="op" id="4316374">,</span>&nbsp;<span class="ident" id="4316376">err</span>&nbsp;<span class="op" id="4316380">:=</span>&nbsp;<span class="ident" id="4316383">asn1</span><span class="op" id="4316387">.</span><span class="ident" id="4316388">Marshal</span><span class="op" id="4316395">(</span><span class="ident" id="4316396">tbsCertList</span><span class="op" id="4316407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316410">if</span>&nbsp;<span class="ident" id="4316413">err</span>&nbsp;<span class="op" id="4316417">!=</span>&nbsp;<span class="ident" id="4316420">nil</span>&nbsp;<span class="op" id="4316424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316428">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316440">h</span>&nbsp;<span class="op" id="4316442">:=</span>&nbsp;<span class="ident" id="4316445">sha1</span><span class="op" id="4316449">.</span><span class="ident" id="4316450">New</span><span class="op" id="4316453">(</span><span class="op" id="4316454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316457">h</span><span class="op" id="4316458">.</span><span class="ident" id="4316459">Write</span><span class="op" id="4316464">(</span><span class="ident" id="4316465">tbsCertListContents</span><span class="op" id="4316484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316487">digest</span>&nbsp;<span class="op" id="4316494">:=</span>&nbsp;<span class="ident" id="4316497">h</span><span class="op" id="4316498">.</span><span class="ident" id="4316499">Sum</span><span class="op" id="4316502">(</span><span class="ident" id="4316503">nil</span><span class="op" id="4316506">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316510">signature</span><span class="op" id="4316519">,</span>&nbsp;<span class="ident" id="4316521">err</span>&nbsp;<span class="op" id="4316525">:=</span>&nbsp;<span class="ident" id="4316528">rsa</span><span class="op" id="4316531">.</span><span class="ident" id="4316532">SignPKCS1v15</span><span class="op" id="4316544">(</span><span class="ident" id="4316545">rand</span><span class="op" id="4316549">,</span>&nbsp;<span class="ident" id="4316551">rsaPriv</span><span class="op" id="4316558">,</span>&nbsp;<span class="ident" id="4316560">crypto</span><span class="op" id="4316566">.</span><span class="ident" id="4316567">SHA1</span><span class="op" id="4316571">,</span>&nbsp;<span class="ident" id="4316573">digest</span><span class="op" id="4316579">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316582">if</span>&nbsp;<span class="ident" id="4316585">err</span>&nbsp;<span class="op" id="4316589">!=</span>&nbsp;<span class="ident" id="4316592">nil</span>&nbsp;<span class="op" id="4316596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316600">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316612">return</span>&nbsp;<span class="ident" id="4316619">asn1</span><span class="op" id="4316623">.</span><span class="ident" id="4316624">Marshal</span><span class="op" id="4316631">(</span><span class="ident" id="4316632">pkix</span><span class="op" id="4316636">.</span><span class="ident" id="4316637">CertificateList</span><span class="op" id="4316652">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316656">TBSCertList</span><span class="op" id="4316667">:</span>&nbsp;<span class="ident" id="4316669">tbsCertList</span><span class="op" id="4316680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316684">SignatureAlgorithm</span><span class="op" id="4316702">:</span>&nbsp;<span class="ident" id="4316704">pkix</span><span class="op" id="4316708">.</span><span class="ident" id="4316709">AlgorithmIdentifier</span><span class="op" id="4316728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316733">Algorithm</span><span class="op" id="4316742">:</span>&nbsp;<span class="ident" id="4316744">oidSignatureSHA1WithRSA</span><span class="op" id="4316767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316771">}</span><span class="op" id="4316772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316776">SignatureValue</span><span class="op" id="4316790">:</span>&nbsp;<span class="ident" id="4316792">asn1</span><span class="op" id="4316796">.</span><span class="ident" id="4316797">BitString</span><span class="op" id="4316806">{</span><span class="ident" id="4316807">Bytes</span><span class="op" id="4316812">:</span>&nbsp;<span class="ident" id="4316814">signature</span><span class="op" id="4316823">,</span>&nbsp;<span class="ident" id="4316825">BitLength</span><span class="op" id="4316834">:</span>&nbsp;<span class="builtinfunc" id="4316836">len</span><span class="op" id="4316839">(</span><span class="ident" id="4316840">signature</span><span class="op" id="4316849">)</span>&nbsp;<span class="op" id="4316851">*</span>&nbsp;<span class="num" id="4316853">8</span><span class="op" id="4316854">}</span><span class="op" id="4316855">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316858">}</span><span class="op" id="4316859">)</span><br>
<span class="lineno"></span><span class="op" id="4316861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4316864">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4316940">type</span>&nbsp;<span class="ident" id="4316945">CertificateRequest</span>&nbsp;<span class="keyword" id="4316964">struct</span>&nbsp;<span class="op" id="4316971">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316974">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316999">[</span><span class="op" id="4317000">]</span><span class="builtintype" id="4317001">byte</span>&nbsp;<span class="comment" id="4317006">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317079">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4317104">[</span><span class="op" id="4317105">]</span><span class="builtintype" id="4317106">byte</span>&nbsp;<span class="comment" id="4317111">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317171">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4317196">[</span><span class="op" id="4317197">]</span><span class="builtintype" id="4317198">byte</span>&nbsp;<span class="comment" id="4317203">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317241">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317266">[</span><span class="op" id="4317267">]</span><span class="builtintype" id="4317268">byte</span>&nbsp;<span class="comment" id="4317273">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317299">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4317318">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317323">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317342">[</span><span class="op" id="4317343">]</span><span class="builtintype" id="4317344">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317350">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4317369">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317390">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4317409">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317429">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317448">interface</span><span class="op" id="4317457">{</span><span class="op" id="4317458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317462">Subject</span>&nbsp;<span class="ident" id="4317470">pkix</span><span class="op" id="4317474">.</span><span class="ident" id="4317475">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317482">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317537">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317602">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317632">Attributes</span>&nbsp;<span class="op" id="4317643">[</span><span class="op" id="4317644">]</span><span class="ident" id="4317645">pkix</span><span class="op" id="4317649">.</span><span class="ident" id="4317650">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317677">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317747">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317813">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4317826">Extensions</span>&nbsp;<span class="op" id="4317837">[</span><span class="op" id="4317838">]</span><span class="ident" id="4317839">pkix</span><span class="op" id="4317843">.</span><span class="ident" id="4317844">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317856">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317924">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4317995">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4318063">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4318103">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4318107">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4318177">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318193">ExtraExtensions</span>&nbsp;<span class="op" id="4318209">[</span><span class="op" id="4318210">]</span><span class="ident" id="4318211">pkix</span><span class="op" id="4318215">.</span><span class="ident" id="4318216">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4318228">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318263">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318278">[</span><span class="op" id="4318279">]</span><span class="builtintype" id="4318280">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318288">EmailAddresses</span>&nbsp;<span class="op" id="4318303">[</span><span class="op" id="4318304">]</span><span class="builtintype" id="4318305">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318313">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318328">[</span><span class="op" id="4318329">]</span><span class="ident" id="4318330">net</span><span class="op" id="4318333">.</span><span class="ident" id="4318334">IP</span><br>
<span class="lineno"></span><span class="op" id="4318337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4318340">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4318409">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4318448">type</span>&nbsp;<span class="ident" id="4318453">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4318475">struct</span>&nbsp;<span class="op" id="4318482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318485">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318496">asn1</span><span class="op" id="4318500">.</span><span class="ident" id="4318501">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318513">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4318524">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318529">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318540">asn1</span><span class="op" id="4318544">.</span><span class="ident" id="4318545">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318555">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4318566">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318581">Attributes</span>&nbsp;<span class="op" id="4318592">[</span><span class="op" id="4318593">]</span><span class="ident" id="4318594">pkix</span><span class="op" id="4318598">.</span><span class="ident" id="4318599">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4318624">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4318639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4318642">type</span>&nbsp;<span class="ident" id="4318647">certificateRequest</span>&nbsp;<span class="keyword" id="4318666">struct</span>&nbsp;<span class="op" id="4318673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318676">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318695">asn1</span><span class="op" id="4318699">.</span><span class="ident" id="4318700">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318712">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318731">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318754">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4318773">pkix</span><span class="op" id="4318777">.</span><span class="ident" id="4318778">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4318799">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318818">asn1</span><span class="op" id="4318822">.</span><span class="ident" id="4318823">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4318833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4318836">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4318914">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4318938">var</span>&nbsp;<span class="ident" id="4318942">oidExtensionRequest</span>&nbsp;<span class="op" id="4318962">=</span>&nbsp;<span class="ident" id="4318964">asn1</span><span class="op" id="4318968">.</span><span class="ident" id="4318969">ObjectIdentifier</span><span class="op" id="4318985">{</span><span class="num" id="4318986">1</span><span class="op" id="4318987">,</span>&nbsp;<span class="num" id="4318989">2</span><span class="op" id="4318990">,</span>&nbsp;<span class="num" id="4318992">840</span><span class="op" id="4318995">,</span>&nbsp;<span class="num" id="4318997">113549</span><span class="op" id="4319003">,</span>&nbsp;<span class="num" id="4319005">1</span><span class="op" id="4319006">,</span>&nbsp;<span class="num" id="4319008">9</span><span class="op" id="4319009">,</span>&nbsp;<span class="num" id="4319011">14</span><span class="op" id="4319013">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4319016">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4319095">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4319159">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4319237">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4319290">//</span><br>
<span class="lineno"></span><span class="comment" id="4319293">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4319359">//</span><br>
<span class="lineno"></span><span class="comment" id="4319362">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4319430">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4319454">func</span>&nbsp;<span class="ident" id="4319459">CreateCertificateRequest</span><span class="op" id="4319483">(</span><span class="ident" id="4319484">rand</span>&nbsp;<span class="ident" id="4319489">io</span><span class="op" id="4319491">.</span><span class="ident" id="4319492">Reader</span><span class="op" id="4319498">,</span>&nbsp;<span class="ident" id="4319500">template</span>&nbsp;<span class="op" id="4319509">*</span><span class="ident" id="4319510">CertificateRequest</span><span class="op" id="4319528">,</span>&nbsp;<span class="ident" id="4319530">priv</span>&nbsp;<span class="keyword" id="4319535">interface</span><span class="op" id="4319544">{</span><span class="op" id="4319545">}</span><span class="op" id="4319546">)</span>&nbsp;<span class="op" id="4319548">(</span><span class="ident" id="4319549">csr</span>&nbsp;<span class="op" id="4319553">[</span><span class="op" id="4319554">]</span><span class="builtintype" id="4319555">byte</span><span class="op" id="4319559">,</span>&nbsp;<span class="ident" id="4319561">err</span>&nbsp;<span class="builtintype" id="4319565">error</span><span class="op" id="4319570">)</span>&nbsp;<span class="op" id="4319572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319575">hashFunc</span><span class="op" id="4319583">,</span>&nbsp;<span class="ident" id="4319585">sigAlgo</span><span class="op" id="4319592">,</span>&nbsp;<span class="ident" id="4319594">err</span>&nbsp;<span class="op" id="4319598">:=</span>&nbsp;<span class="ident" id="4319601">signingParamsForPrivateKey</span><span class="op" id="4319627">(</span><span class="ident" id="4319628">priv</span><span class="op" id="4319632">,</span>&nbsp;<span class="ident" id="4319634">template</span><span class="op" id="4319642">.</span><span class="ident" id="4319643">SignatureAlgorithm</span><span class="op" id="4319661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319664">if</span>&nbsp;<span class="ident" id="4319667">err</span>&nbsp;<span class="op" id="4319671">!=</span>&nbsp;<span class="ident" id="4319674">nil</span>&nbsp;<span class="op" id="4319678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319682">return</span>&nbsp;<span class="ident" id="4319689">nil</span><span class="op" id="4319692">,</span>&nbsp;<span class="ident" id="4319694">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4319699">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319703">var</span>&nbsp;<span class="ident" id="4319707">publicKeyBytes</span>&nbsp;<span class="op" id="4319722">[</span><span class="op" id="4319723">]</span><span class="builtintype" id="4319724">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319730">var</span>&nbsp;<span class="ident" id="4319734">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4319753">pkix</span><span class="op" id="4319757">.</span><span class="ident" id="4319758">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319780">switch</span>&nbsp;<span class="ident" id="4319787">priv</span>&nbsp;<span class="op" id="4319792">:=</span>&nbsp;<span class="ident" id="4319795">priv</span><span class="op" id="4319799">.</span><span class="op" id="4319800">(</span><span class="keyword" id="4319801">type</span><span class="op" id="4319805">)</span>&nbsp;<span class="op" id="4319807">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319810">case</span>&nbsp;<span class="op" id="4319815">*</span><span class="ident" id="4319816">rsa</span><span class="op" id="4319819">.</span><span class="ident" id="4319820">PrivateKey</span><span class="op" id="4319830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319834">publicKeyBytes</span><span class="op" id="4319848">,</span>&nbsp;<span class="ident" id="4319850">publicKeyAlgorithm</span><span class="op" id="4319868">,</span>&nbsp;<span class="ident" id="4319870">err</span>&nbsp;<span class="op" id="4319874">=</span>&nbsp;<span class="ident" id="4319876">marshalPublicKey</span><span class="op" id="4319892">(</span><span class="op" id="4319893">&amp;</span><span class="ident" id="4319894">priv</span><span class="op" id="4319898">.</span><span class="ident" id="4319899">PublicKey</span><span class="op" id="4319908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4319911">case</span>&nbsp;<span class="op" id="4319916">*</span><span class="ident" id="4319917">ecdsa</span><span class="op" id="4319922">.</span><span class="ident" id="4319923">PrivateKey</span><span class="op" id="4319933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4319937">publicKeyBytes</span><span class="op" id="4319951">,</span>&nbsp;<span class="ident" id="4319953">publicKeyAlgorithm</span><span class="op" id="4319971">,</span>&nbsp;<span class="ident" id="4319973">err</span>&nbsp;<span class="op" id="4319977">=</span>&nbsp;<span class="ident" id="4319979">marshalPublicKey</span><span class="op" id="4319995">(</span><span class="op" id="4319996">&amp;</span><span class="ident" id="4319997">priv</span><span class="op" id="4320001">.</span><span class="ident" id="4320002">PublicKey</span><span class="op" id="4320011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320014">default</span><span class="op" id="4320021">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4320025">panic</span><span class="op" id="4320030">(</span><span class="string" id="4320031">&#34;internal&nbsp;error&#34;</span><span class="op" id="4320047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4320050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320054">if</span>&nbsp;<span class="ident" id="4320057">err</span>&nbsp;<span class="op" id="4320061">!=</span>&nbsp;<span class="ident" id="4320064">nil</span>&nbsp;<span class="op" id="4320068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320072">return</span>&nbsp;<span class="ident" id="4320079">nil</span><span class="op" id="4320082">,</span>&nbsp;<span class="ident" id="4320084">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4320089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320093">var</span>&nbsp;<span class="ident" id="4320097">extensions</span>&nbsp;<span class="op" id="4320108">[</span><span class="op" id="4320109">]</span><span class="ident" id="4320110">pkix</span><span class="op" id="4320114">.</span><span class="ident" id="4320115">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320127">if</span>&nbsp;<span class="op" id="4320130">(</span><span class="builtinfunc" id="4320131">len</span><span class="op" id="4320134">(</span><span class="ident" id="4320135">template</span><span class="op" id="4320143">.</span><span class="ident" id="4320144">DNSNames</span><span class="op" id="4320152">)</span>&nbsp;<span class="op" id="4320154">&gt;</span>&nbsp;<span class="num" id="4320156">0</span>&nbsp;<span class="op" id="4320158">||</span>&nbsp;<span class="builtinfunc" id="4320161">len</span><span class="op" id="4320164">(</span><span class="ident" id="4320165">template</span><span class="op" id="4320173">.</span><span class="ident" id="4320174">EmailAddresses</span><span class="op" id="4320188">)</span>&nbsp;<span class="op" id="4320190">&gt;</span>&nbsp;<span class="num" id="4320192">0</span>&nbsp;<span class="op" id="4320194">||</span>&nbsp;<span class="builtinfunc" id="4320197">len</span><span class="op" id="4320200">(</span><span class="ident" id="4320201">template</span><span class="op" id="4320209">.</span><span class="ident" id="4320210">IPAddresses</span><span class="op" id="4320221">)</span>&nbsp;<span class="op" id="4320223">&gt;</span>&nbsp;<span class="num" id="4320225">0</span><span class="op" id="4320226">)</span>&nbsp;<span class="op" id="4320228">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4320233">!</span><span class="ident" id="4320234">oidInExtensions</span><span class="op" id="4320249">(</span><span class="ident" id="4320250">oidExtensionSubjectAltName</span><span class="op" id="4320276">,</span>&nbsp;<span class="ident" id="4320278">template</span><span class="op" id="4320286">.</span><span class="ident" id="4320287">ExtraExtensions</span><span class="op" id="4320302">)</span>&nbsp;<span class="op" id="4320304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320308">sanBytes</span><span class="op" id="4320316">,</span>&nbsp;<span class="ident" id="4320318">err</span>&nbsp;<span class="op" id="4320322">:=</span>&nbsp;<span class="ident" id="4320325">marshalSANs</span><span class="op" id="4320336">(</span><span class="ident" id="4320337">template</span><span class="op" id="4320345">.</span><span class="ident" id="4320346">DNSNames</span><span class="op" id="4320354">,</span>&nbsp;<span class="ident" id="4320356">template</span><span class="op" id="4320364">.</span><span class="ident" id="4320365">EmailAddresses</span><span class="op" id="4320379">,</span>&nbsp;<span class="ident" id="4320381">template</span><span class="op" id="4320389">.</span><span class="ident" id="4320390">IPAddresses</span><span class="op" id="4320401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320405">if</span>&nbsp;<span class="ident" id="4320408">err</span>&nbsp;<span class="op" id="4320412">!=</span>&nbsp;<span class="ident" id="4320415">nil</span>&nbsp;<span class="op" id="4320419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320424">return</span>&nbsp;<span class="ident" id="4320431">nil</span><span class="op" id="4320434">,</span>&nbsp;<span class="ident" id="4320436">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4320442">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320447">extensions</span>&nbsp;<span class="op" id="4320458">=</span>&nbsp;<span class="builtinfunc" id="4320460">append</span><span class="op" id="4320466">(</span><span class="ident" id="4320467">extensions</span><span class="op" id="4320477">,</span>&nbsp;<span class="ident" id="4320479">pkix</span><span class="op" id="4320483">.</span><span class="ident" id="4320484">Extension</span><span class="op" id="4320493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320498">Id</span><span class="op" id="4320500">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320505">oidExtensionSubjectAltName</span><span class="op" id="4320531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320536">Value</span><span class="op" id="4320541">:</span>&nbsp;<span class="ident" id="4320543">sanBytes</span><span class="op" id="4320551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4320555">}</span><span class="op" id="4320556">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4320559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320563">extensions</span>&nbsp;<span class="op" id="4320574">=</span>&nbsp;<span class="builtinfunc" id="4320576">append</span><span class="op" id="4320582">(</span><span class="ident" id="4320583">extensions</span><span class="op" id="4320593">,</span>&nbsp;<span class="ident" id="4320595">template</span><span class="op" id="4320603">.</span><span class="ident" id="4320604">ExtraExtensions</span><span class="op" id="4320619">...</span><span class="op" id="4320622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320626">var</span>&nbsp;<span class="ident" id="4320630">attributes</span>&nbsp;<span class="op" id="4320641">[</span><span class="op" id="4320642">]</span><span class="ident" id="4320643">pkix</span><span class="op" id="4320647">.</span><span class="ident" id="4320648">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320674">attributes</span>&nbsp;<span class="op" id="4320685">=</span>&nbsp;<span class="builtinfunc" id="4320687">append</span><span class="op" id="4320693">(</span><span class="ident" id="4320694">attributes</span><span class="op" id="4320704">,</span>&nbsp;<span class="ident" id="4320706">template</span><span class="op" id="4320714">.</span><span class="ident" id="4320715">Attributes</span><span class="op" id="4320725">...</span><span class="op" id="4320728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320732">if</span>&nbsp;<span class="builtinfunc" id="4320735">len</span><span class="op" id="4320738">(</span><span class="ident" id="4320739">extensions</span><span class="op" id="4320749">)</span>&nbsp;<span class="op" id="4320751">&gt;</span>&nbsp;<span class="num" id="4320753">0</span>&nbsp;<span class="op" id="4320755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4320759">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4320820">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4320866">specifiedExtensions</span>&nbsp;<span class="op" id="4320886">:=</span>&nbsp;<span class="builtinfunc" id="4320889">make</span><span class="op" id="4320893">(</span><span class="keyword" id="4320894">map</span><span class="op" id="4320897">[</span><span class="builtintype" id="4320898">string</span><span class="op" id="4320904">]</span><span class="builtintype" id="4320905">bool</span><span class="op" id="4320909">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320914">for</span>&nbsp;<span class="ident" id="4320918">_</span><span class="op" id="4320919">,</span>&nbsp;<span class="ident" id="4320921">atvSet</span>&nbsp;<span class="op" id="4320928">:=</span>&nbsp;<span class="keyword" id="4320931">range</span>&nbsp;<span class="ident" id="4320937">template</span><span class="op" id="4320945">.</span><span class="ident" id="4320946">Attributes</span>&nbsp;<span class="op" id="4320957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4320962">if</span>&nbsp;<span class="op" id="4320965">!</span><span class="ident" id="4320966">atvSet</span><span class="op" id="4320972">.</span><span class="ident" id="4320973">Type</span><span class="op" id="4320977">.</span><span class="ident" id="4320978">Equal</span><span class="op" id="4320983">(</span><span class="ident" id="4320984">oidExtensionRequest</span><span class="op" id="4321003">)</span>&nbsp;<span class="op" id="4321005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321011">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321029">for</span>&nbsp;<span class="ident" id="4321033">_</span><span class="op" id="4321034">,</span>&nbsp;<span class="ident" id="4321036">atvs</span>&nbsp;<span class="op" id="4321041">:=</span>&nbsp;<span class="keyword" id="4321044">range</span>&nbsp;<span class="ident" id="4321050">atvSet</span><span class="op" id="4321056">.</span><span class="ident" id="4321057">Value</span>&nbsp;<span class="op" id="4321063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321069">for</span>&nbsp;<span class="ident" id="4321073">_</span><span class="op" id="4321074">,</span>&nbsp;<span class="ident" id="4321076">atv</span>&nbsp;<span class="op" id="4321080">:=</span>&nbsp;<span class="keyword" id="4321083">range</span>&nbsp;<span class="ident" id="4321089">atvs</span>&nbsp;<span class="op" id="4321094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321101">specifiedExtensions</span><span class="op" id="4321120">[</span><span class="ident" id="4321121">atv</span><span class="op" id="4321124">.</span><span class="ident" id="4321125">Type</span><span class="op" id="4321129">.</span><span class="ident" id="4321130">String</span><span class="op" id="4321136">(</span><span class="op" id="4321137">)</span><span class="op" id="4321138">]</span>&nbsp;<span class="op" id="4321140">=</span>&nbsp;<span class="builtintype" id="4321142">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321165">atvs</span>&nbsp;<span class="op" id="4321170">:=</span>&nbsp;<span class="builtinfunc" id="4321173">make</span><span class="op" id="4321177">(</span><span class="op" id="4321178">[</span><span class="op" id="4321179">]</span><span class="ident" id="4321180">pkix</span><span class="op" id="4321184">.</span><span class="ident" id="4321185">AttributeTypeAndValue</span><span class="op" id="4321206">,</span>&nbsp;<span class="num" id="4321208">0</span><span class="op" id="4321209">,</span>&nbsp;<span class="builtinfunc" id="4321211">len</span><span class="op" id="4321214">(</span><span class="ident" id="4321215">extensions</span><span class="op" id="4321225">)</span><span class="op" id="4321226">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321230">for</span>&nbsp;<span class="ident" id="4321234">_</span><span class="op" id="4321235">,</span>&nbsp;<span class="ident" id="4321237">e</span>&nbsp;<span class="op" id="4321239">:=</span>&nbsp;<span class="keyword" id="4321242">range</span>&nbsp;<span class="ident" id="4321248">extensions</span>&nbsp;<span class="op" id="4321259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321264">if</span>&nbsp;<span class="ident" id="4321267">specifiedExtensions</span><span class="op" id="4321286">[</span><span class="ident" id="4321287">e</span><span class="op" id="4321288">.</span><span class="ident" id="4321289">Id</span><span class="op" id="4321291">.</span><span class="ident" id="4321292">String</span><span class="op" id="4321298">(</span><span class="op" id="4321299">)</span><span class="op" id="4321300">]</span>&nbsp;<span class="op" id="4321302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4321308">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4321356">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321401">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321419">atvs</span>&nbsp;<span class="op" id="4321424">=</span>&nbsp;<span class="builtinfunc" id="4321426">append</span><span class="op" id="4321432">(</span><span class="ident" id="4321433">atvs</span><span class="op" id="4321437">,</span>&nbsp;<span class="ident" id="4321439">pkix</span><span class="op" id="4321443">.</span><span class="ident" id="4321444">AttributeTypeAndValue</span><span class="op" id="4321465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4321471">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321528">Type</span><span class="op" id="4321532">:</span>&nbsp;&nbsp;<span class="ident" id="4321535">e</span><span class="op" id="4321536">.</span><span class="ident" id="4321537">Id</span><span class="op" id="4321539">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321545">Value</span><span class="op" id="4321550">:</span>&nbsp;<span class="ident" id="4321552">e</span><span class="op" id="4321553">.</span><span class="ident" id="4321554">Value</span><span class="op" id="4321559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321564">}</span><span class="op" id="4321565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4321574">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321639">appended</span>&nbsp;<span class="op" id="4321648">:=</span>&nbsp;<span class="builtintype" id="4321651">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321659">for</span>&nbsp;<span class="ident" id="4321663">_</span><span class="op" id="4321664">,</span>&nbsp;<span class="ident" id="4321666">atvSet</span>&nbsp;<span class="op" id="4321673">:=</span>&nbsp;<span class="keyword" id="4321676">range</span>&nbsp;<span class="ident" id="4321682">attributes</span>&nbsp;<span class="op" id="4321693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321698">if</span>&nbsp;<span class="op" id="4321701">!</span><span class="ident" id="4321702">atvSet</span><span class="op" id="4321708">.</span><span class="ident" id="4321709">Type</span><span class="op" id="4321713">.</span><span class="ident" id="4321714">Equal</span><span class="op" id="4321719">(</span><span class="ident" id="4321720">oidExtensionRequest</span><span class="op" id="4321739">)</span>&nbsp;<span class="op" id="4321741">||</span>&nbsp;<span class="builtinfunc" id="4321744">len</span><span class="op" id="4321747">(</span><span class="ident" id="4321748">atvSet</span><span class="op" id="4321754">.</span><span class="ident" id="4321755">Value</span><span class="op" id="4321760">)</span>&nbsp;<span class="op" id="4321762">==</span>&nbsp;<span class="num" id="4321765">0</span>&nbsp;<span class="op" id="4321767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321773">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321785">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321791">atvSet</span><span class="op" id="4321797">.</span><span class="ident" id="4321798">Value</span><span class="op" id="4321803">[</span><span class="num" id="4321804">0</span><span class="op" id="4321805">]</span>&nbsp;<span class="op" id="4321807">=</span>&nbsp;<span class="builtinfunc" id="4321809">append</span><span class="op" id="4321815">(</span><span class="ident" id="4321816">atvSet</span><span class="op" id="4321822">.</span><span class="ident" id="4321823">Value</span><span class="op" id="4321828">[</span><span class="num" id="4321829">0</span><span class="op" id="4321830">]</span><span class="op" id="4321831">,</span>&nbsp;<span class="ident" id="4321833">atvs</span><span class="op" id="4321837">...</span><span class="op" id="4321840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321845">appended</span>&nbsp;<span class="op" id="4321854">=</span>&nbsp;<span class="builtintype" id="4321856">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321864">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4321872">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4321877">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4321933">if</span>&nbsp;<span class="op" id="4321936">!</span><span class="ident" id="4321937">appended</span>&nbsp;<span class="op" id="4321946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4321951">attributes</span>&nbsp;<span class="op" id="4321962">=</span>&nbsp;<span class="builtinfunc" id="4321964">append</span><span class="op" id="4321970">(</span><span class="ident" id="4321971">attributes</span><span class="op" id="4321981">,</span>&nbsp;<span class="ident" id="4321983">pkix</span><span class="op" id="4321987">.</span><span class="ident" id="4321988">AttributeTypeAndValueSET</span><span class="op" id="4322012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322018">Type</span><span class="op" id="4322022">:</span>&nbsp;<span class="ident" id="4322024">oidExtensionRequest</span><span class="op" id="4322043">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322049">Value</span><span class="op" id="4322054">:</span>&nbsp;<span class="op" id="4322056">[</span><span class="op" id="4322057">]</span><span class="op" id="4322058">[</span><span class="op" id="4322059">]</span><span class="ident" id="4322060">pkix</span><span class="op" id="4322064">.</span><span class="ident" id="4322065">AttributeTypeAndValue</span><span class="op" id="4322086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322093">atvs</span><span class="op" id="4322097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322103">}</span><span class="op" id="4322104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322109">}</span><span class="op" id="4322110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322114">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322121">asn1Subject</span>&nbsp;<span class="op" id="4322133">:=</span>&nbsp;<span class="ident" id="4322136">template</span><span class="op" id="4322144">.</span><span class="ident" id="4322145">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322157">if</span>&nbsp;<span class="builtinfunc" id="4322160">len</span><span class="op" id="4322163">(</span><span class="ident" id="4322164">asn1Subject</span><span class="op" id="4322175">)</span>&nbsp;<span class="op" id="4322177">==</span>&nbsp;<span class="num" id="4322180">0</span>&nbsp;<span class="op" id="4322182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322186">asn1Subject</span><span class="op" id="4322197">,</span>&nbsp;<span class="ident" id="4322199">err</span>&nbsp;<span class="op" id="4322203">=</span>&nbsp;<span class="ident" id="4322205">asn1</span><span class="op" id="4322209">.</span><span class="ident" id="4322210">Marshal</span><span class="op" id="4322217">(</span><span class="ident" id="4322218">template</span><span class="op" id="4322226">.</span><span class="ident" id="4322227">Subject</span><span class="op" id="4322234">.</span><span class="ident" id="4322235">ToRDNSequence</span><span class="op" id="4322248">(</span><span class="op" id="4322249">)</span><span class="op" id="4322250">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322254">if</span>&nbsp;<span class="ident" id="4322257">err</span>&nbsp;<span class="op" id="4322261">!=</span>&nbsp;<span class="ident" id="4322264">nil</span>&nbsp;<span class="op" id="4322268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322273">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322289">tbsCSR</span>&nbsp;<span class="op" id="4322296">:=</span>&nbsp;<span class="ident" id="4322299">tbsCertificateRequest</span><span class="op" id="4322320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322324">Version</span><span class="op" id="4322331">:</span>&nbsp;<span class="num" id="4322333">0</span><span class="op" id="4322334">,</span>&nbsp;<span class="comment" id="4322336">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322360">Subject</span><span class="op" id="4322367">:</span>&nbsp;<span class="ident" id="4322369">asn1</span><span class="op" id="4322373">.</span><span class="ident" id="4322374">RawValue</span><span class="op" id="4322382">{</span><span class="ident" id="4322383">FullBytes</span><span class="op" id="4322392">:</span>&nbsp;<span class="ident" id="4322394">asn1Subject</span><span class="op" id="4322405">}</span><span class="op" id="4322406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322410">PublicKey</span><span class="op" id="4322419">:</span>&nbsp;<span class="ident" id="4322421">publicKeyInfo</span><span class="op" id="4322434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322439">Algorithm</span><span class="op" id="4322448">:</span>&nbsp;<span class="ident" id="4322450">publicKeyAlgorithm</span><span class="op" id="4322468">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322473">PublicKey</span><span class="op" id="4322482">:</span>&nbsp;<span class="ident" id="4322484">asn1</span><span class="op" id="4322488">.</span><span class="ident" id="4322489">BitString</span><span class="op" id="4322498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322504">Bytes</span><span class="op" id="4322509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322515">publicKeyBytes</span><span class="op" id="4322529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322535">BitLength</span><span class="op" id="4322544">:</span>&nbsp;<span class="builtinfunc" id="4322546">len</span><span class="op" id="4322549">(</span><span class="ident" id="4322550">publicKeyBytes</span><span class="op" id="4322564">)</span>&nbsp;<span class="op" id="4322566">*</span>&nbsp;<span class="num" id="4322568">8</span><span class="op" id="4322569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322574">}</span><span class="op" id="4322575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322579">}</span><span class="op" id="4322580">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322584">Attributes</span><span class="op" id="4322594">:</span>&nbsp;<span class="ident" id="4322596">attributes</span><span class="op" id="4322606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322613">tbsCSRContents</span><span class="op" id="4322627">,</span>&nbsp;<span class="ident" id="4322629">err</span>&nbsp;<span class="op" id="4322633">:=</span>&nbsp;<span class="ident" id="4322636">asn1</span><span class="op" id="4322640">.</span><span class="ident" id="4322641">Marshal</span><span class="op" id="4322648">(</span><span class="ident" id="4322649">tbsCSR</span><span class="op" id="4322655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322658">if</span>&nbsp;<span class="ident" id="4322661">err</span>&nbsp;<span class="op" id="4322665">!=</span>&nbsp;<span class="ident" id="4322668">nil</span>&nbsp;<span class="op" id="4322672">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4322684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322687">tbsCSR</span><span class="op" id="4322693">.</span><span class="ident" id="4322694">Raw</span>&nbsp;<span class="op" id="4322698">=</span>&nbsp;<span class="ident" id="4322700">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322717">h</span>&nbsp;<span class="op" id="4322719">:=</span>&nbsp;<span class="ident" id="4322722">hashFunc</span><span class="op" id="4322730">.</span><span class="ident" id="4322731">New</span><span class="op" id="4322734">(</span><span class="op" id="4322735">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322738">h</span><span class="op" id="4322739">.</span><span class="ident" id="4322740">Write</span><span class="op" id="4322745">(</span><span class="ident" id="4322746">tbsCSRContents</span><span class="op" id="4322760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322763">digest</span>&nbsp;<span class="op" id="4322770">:=</span>&nbsp;<span class="ident" id="4322773">h</span><span class="op" id="4322774">.</span><span class="ident" id="4322775">Sum</span><span class="op" id="4322778">(</span><span class="ident" id="4322779">nil</span><span class="op" id="4322782">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322786">var</span>&nbsp;<span class="ident" id="4322790">signature</span>&nbsp;<span class="op" id="4322800">[</span><span class="op" id="4322801">]</span><span class="builtintype" id="4322802">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322808">switch</span>&nbsp;<span class="ident" id="4322815">priv</span>&nbsp;<span class="op" id="4322820">:=</span>&nbsp;<span class="ident" id="4322823">priv</span><span class="op" id="4322827">.</span><span class="op" id="4322828">(</span><span class="keyword" id="4322829">type</span><span class="op" id="4322833">)</span>&nbsp;<span class="op" id="4322835">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322838">case</span>&nbsp;<span class="op" id="4322843">*</span><span class="ident" id="4322844">rsa</span><span class="op" id="4322847">.</span><span class="ident" id="4322848">PrivateKey</span><span class="op" id="4322858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4322862">signature</span><span class="op" id="4322871">,</span>&nbsp;<span class="ident" id="4322873">err</span>&nbsp;<span class="op" id="4322877">=</span>&nbsp;<span class="ident" id="4322879">rsa</span><span class="op" id="4322882">.</span><span class="ident" id="4322883">SignPKCS1v15</span><span class="op" id="4322895">(</span><span class="ident" id="4322896">rand</span><span class="op" id="4322900">,</span>&nbsp;<span class="ident" id="4322902">priv</span><span class="op" id="4322906">,</span>&nbsp;<span class="ident" id="4322908">hashFunc</span><span class="op" id="4322916">,</span>&nbsp;<span class="ident" id="4322918">digest</span><span class="op" id="4322924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322927">case</span>&nbsp;<span class="op" id="4322932">*</span><span class="ident" id="4322933">ecdsa</span><span class="op" id="4322938">.</span><span class="ident" id="4322939">PrivateKey</span><span class="op" id="4322949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322953">var</span>&nbsp;<span class="ident" id="4322957">r</span><span class="op" id="4322958">,</span>&nbsp;<span class="ident" id="4322960">s</span>&nbsp;<span class="op" id="4322962">*</span><span class="ident" id="4322963">big</span><span class="op" id="4322966">.</span><span class="ident" id="4322967">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4322973">if</span>&nbsp;<span class="ident" id="4322976">r</span><span class="op" id="4322977">,</span>&nbsp;<span class="ident" id="4322979">s</span><span class="op" id="4322980">,</span>&nbsp;<span class="ident" id="4322982">err</span>&nbsp;<span class="op" id="4322986">=</span>&nbsp;<span class="ident" id="4322988">ecdsa</span><span class="op" id="4322993">.</span><span class="ident" id="4322994">Sign</span><span class="op" id="4322998">(</span><span class="ident" id="4322999">rand</span><span class="op" id="4323003">,</span>&nbsp;<span class="ident" id="4323005">priv</span><span class="op" id="4323009">,</span>&nbsp;<span class="ident" id="4323011">digest</span><span class="op" id="4323017">)</span><span class="op" id="4323018">;</span>&nbsp;<span class="ident" id="4323020">err</span>&nbsp;<span class="op" id="4323024">==</span>&nbsp;<span class="ident" id="4323027">nil</span>&nbsp;<span class="op" id="4323031">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323036">signature</span><span class="op" id="4323045">,</span>&nbsp;<span class="ident" id="4323047">err</span>&nbsp;<span class="op" id="4323051">=</span>&nbsp;<span class="ident" id="4323053">asn1</span><span class="op" id="4323057">.</span><span class="ident" id="4323058">Marshal</span><span class="op" id="4323065">(</span><span class="ident" id="4323066">ecdsaSignature</span><span class="op" id="4323080">{</span><span class="ident" id="4323081">r</span><span class="op" id="4323082">,</span>&nbsp;<span class="ident" id="4323084">s</span><span class="op" id="4323085">}</span><span class="op" id="4323086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323093">default</span><span class="op" id="4323100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4323104">panic</span><span class="op" id="4323109">(</span><span class="string" id="4323110">&#34;internal&nbsp;error&#34;</span><span class="op" id="4323126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323129">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323133">if</span>&nbsp;<span class="ident" id="4323136">err</span>&nbsp;<span class="op" id="4323140">!=</span>&nbsp;<span class="ident" id="4323143">nil</span>&nbsp;<span class="op" id="4323147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323151">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323163">return</span>&nbsp;<span class="ident" id="4323170">asn1</span><span class="op" id="4323174">.</span><span class="ident" id="4323175">Marshal</span><span class="op" id="4323182">(</span><span class="ident" id="4323183">certificateRequest</span><span class="op" id="4323201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323205">TBSCSR</span><span class="op" id="4323211">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323225">tbsCSR</span><span class="op" id="4323231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323235">SignatureAlgorithm</span><span class="op" id="4323253">:</span>&nbsp;<span class="ident" id="4323255">sigAlgo</span><span class="op" id="4323262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323266">SignatureValue</span><span class="op" id="4323280">:</span>&nbsp;<span class="ident" id="4323282">asn1</span><span class="op" id="4323286">.</span><span class="ident" id="4323287">BitString</span><span class="op" id="4323296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323301">Bytes</span><span class="op" id="4323306">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323312">signature</span><span class="op" id="4323321">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323326">BitLength</span><span class="op" id="4323335">:</span>&nbsp;<span class="builtinfunc" id="4323337">len</span><span class="op" id="4323340">(</span><span class="ident" id="4323341">signature</span><span class="op" id="4323350">)</span>&nbsp;<span class="op" id="4323352">*</span>&nbsp;<span class="num" id="4323354">8</span><span class="op" id="4323355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323359">}</span><span class="op" id="4323360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323363">}</span><span class="op" id="4323364">)</span><br>
<span class="lineno"></span><span class="op" id="4323366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4323369">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4323441">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4323466">func</span>&nbsp;<span class="ident" id="4323471">ParseCertificateRequest</span><span class="op" id="4323494">(</span><span class="ident" id="4323495">asn1Data</span>&nbsp;<span class="op" id="4323504">[</span><span class="op" id="4323505">]</span><span class="builtintype" id="4323506">byte</span><span class="op" id="4323510">)</span>&nbsp;<span class="op" id="4323512">(</span><span class="op" id="4323513">*</span><span class="ident" id="4323514">CertificateRequest</span><span class="op" id="4323532">,</span>&nbsp;<span class="builtintype" id="4323534">error</span><span class="op" id="4323539">)</span>&nbsp;<span class="op" id="4323541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323544">var</span>&nbsp;<span class="ident" id="4323548">csr</span>&nbsp;<span class="ident" id="4323552">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323573">rest</span><span class="op" id="4323577">,</span>&nbsp;<span class="ident" id="4323579">err</span>&nbsp;<span class="op" id="4323583">:=</span>&nbsp;<span class="ident" id="4323586">asn1</span><span class="op" id="4323590">.</span><span class="ident" id="4323591">Unmarshal</span><span class="op" id="4323600">(</span><span class="ident" id="4323601">asn1Data</span><span class="op" id="4323609">,</span>&nbsp;<span class="op" id="4323611">&amp;</span><span class="ident" id="4323612">csr</span><span class="op" id="4323615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323618">if</span>&nbsp;<span class="ident" id="4323621">err</span>&nbsp;<span class="op" id="4323625">!=</span>&nbsp;<span class="ident" id="4323628">nil</span>&nbsp;<span class="op" id="4323632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323636">return</span>&nbsp;<span class="ident" id="4323643">nil</span><span class="op" id="4323646">,</span>&nbsp;<span class="ident" id="4323648">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323653">}</span>&nbsp;<span class="keyword" id="4323655">else</span>&nbsp;<span class="keyword" id="4323660">if</span>&nbsp;<span class="builtinfunc" id="4323663">len</span><span class="op" id="4323666">(</span><span class="ident" id="4323667">rest</span><span class="op" id="4323671">)</span>&nbsp;<span class="op" id="4323673">!=</span>&nbsp;<span class="num" id="4323676">0</span>&nbsp;<span class="op" id="4323678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323682">return</span>&nbsp;<span class="ident" id="4323689">nil</span><span class="op" id="4323692">,</span>&nbsp;<span class="ident" id="4323694">asn1</span><span class="op" id="4323698">.</span><span class="ident" id="4323699">SyntaxError</span><span class="op" id="4323710">{</span><span class="ident" id="4323711">Msg</span><span class="op" id="4323714">:</span>&nbsp;<span class="string" id="4323716">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4323731">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4323734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4323738">return</span>&nbsp;<span class="ident" id="4323745">parseCertificateRequest</span><span class="op" id="4323768">(</span><span class="op" id="4323769">&amp;</span><span class="ident" id="4323770">csr</span><span class="op" id="4323773">)</span><br>
<span class="lineno"></span><span class="op" id="4323775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4323778">func</span>&nbsp;<span class="ident" id="4323783">parseCertificateRequest</span><span class="op" id="4323806">(</span><span class="ident" id="4323807">in</span>&nbsp;<span class="op" id="4323810">*</span><span class="ident" id="4323811">certificateRequest</span><span class="op" id="4323829">)</span>&nbsp;<span class="op" id="4323831">(</span><span class="op" id="4323832">*</span><span class="ident" id="4323833">CertificateRequest</span><span class="op" id="4323851">,</span>&nbsp;<span class="builtintype" id="4323853">error</span><span class="op" id="4323858">)</span>&nbsp;<span class="op" id="4323860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323863">out</span>&nbsp;<span class="op" id="4323867">:=</span>&nbsp;<span class="op" id="4323870">&amp;</span><span class="ident" id="4323871">CertificateRequest</span><span class="op" id="4323889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323893">Raw</span><span class="op" id="4323896">:</span>&nbsp;<span class="ident" id="4323898">in</span><span class="op" id="4323900">.</span><span class="ident" id="4323901">Raw</span><span class="op" id="4323904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323908">RawTBSCertificateRequest</span><span class="op" id="4323932">:</span>&nbsp;<span class="ident" id="4323934">in</span><span class="op" id="4323936">.</span><span class="ident" id="4323937">TBSCSR</span><span class="op" id="4323943">.</span><span class="ident" id="4323944">Raw</span><span class="op" id="4323947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4323951">RawSubjectPublicKeyInfo</span><span class="op" id="4323974">:</span>&nbsp;&nbsp;<span class="ident" id="4323977">in</span><span class="op" id="4323979">.</span><span class="ident" id="4323980">TBSCSR</span><span class="op" id="4323986">.</span><span class="ident" id="4323987">PublicKey</span><span class="op" id="4323996">.</span><span class="ident" id="4323997">Raw</span><span class="op" id="4324000">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324004">RawSubject</span><span class="op" id="4324014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324030">in</span><span class="op" id="4324032">.</span><span class="ident" id="4324033">TBSCSR</span><span class="op" id="4324039">.</span><span class="ident" id="4324040">Subject</span><span class="op" id="4324047">.</span><span class="ident" id="4324048">FullBytes</span><span class="op" id="4324057">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324062">Signature</span><span class="op" id="4324071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324082">in</span><span class="op" id="4324084">.</span><span class="ident" id="4324085">SignatureValue</span><span class="op" id="4324099">.</span><span class="ident" id="4324100">RightAlign</span><span class="op" id="4324110">(</span><span class="op" id="4324111">)</span><span class="op" id="4324112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324116">SignatureAlgorithm</span><span class="op" id="4324134">:</span>&nbsp;<span class="ident" id="4324136">getSignatureAlgorithmFromOID</span><span class="op" id="4324164">(</span><span class="ident" id="4324165">in</span><span class="op" id="4324167">.</span><span class="ident" id="4324168">SignatureAlgorithm</span><span class="op" id="4324186">.</span><span class="ident" id="4324187">Algorithm</span><span class="op" id="4324196">)</span><span class="op" id="4324197">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324202">PublicKeyAlgorithm</span><span class="op" id="4324220">:</span>&nbsp;<span class="ident" id="4324222">getPublicKeyAlgorithmFromOID</span><span class="op" id="4324250">(</span><span class="ident" id="4324251">in</span><span class="op" id="4324253">.</span><span class="ident" id="4324254">TBSCSR</span><span class="op" id="4324260">.</span><span class="ident" id="4324261">PublicKey</span><span class="op" id="4324270">.</span><span class="ident" id="4324271">Algorithm</span><span class="op" id="4324280">.</span><span class="ident" id="4324281">Algorithm</span><span class="op" id="4324290">)</span><span class="op" id="4324291">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324296">Version</span><span class="op" id="4324303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324308">in</span><span class="op" id="4324310">.</span><span class="ident" id="4324311">TBSCSR</span><span class="op" id="4324317">.</span><span class="ident" id="4324318">Version</span><span class="op" id="4324325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324329">Attributes</span><span class="op" id="4324339">:</span>&nbsp;<span class="ident" id="4324341">in</span><span class="op" id="4324343">.</span><span class="ident" id="4324344">TBSCSR</span><span class="op" id="4324350">.</span><span class="ident" id="4324351">Attributes</span><span class="op" id="4324361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324364">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324368">var</span>&nbsp;<span class="ident" id="4324372">err</span>&nbsp;<span class="builtintype" id="4324376">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324383">out</span><span class="op" id="4324386">.</span><span class="ident" id="4324387">PublicKey</span><span class="op" id="4324396">,</span>&nbsp;<span class="ident" id="4324398">err</span>&nbsp;<span class="op" id="4324402">=</span>&nbsp;<span class="ident" id="4324404">parsePublicKey</span><span class="op" id="4324418">(</span><span class="ident" id="4324419">out</span><span class="op" id="4324422">.</span><span class="ident" id="4324423">PublicKeyAlgorithm</span><span class="op" id="4324441">,</span>&nbsp;<span class="op" id="4324443">&amp;</span><span class="ident" id="4324444">in</span><span class="op" id="4324446">.</span><span class="ident" id="4324447">TBSCSR</span><span class="op" id="4324453">.</span><span class="ident" id="4324454">PublicKey</span><span class="op" id="4324463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324466">if</span>&nbsp;<span class="ident" id="4324469">err</span>&nbsp;<span class="op" id="4324473">!=</span>&nbsp;<span class="ident" id="4324476">nil</span>&nbsp;<span class="op" id="4324480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324484">return</span>&nbsp;<span class="ident" id="4324491">nil</span><span class="op" id="4324494">,</span>&nbsp;<span class="ident" id="4324496">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324505">var</span>&nbsp;<span class="ident" id="4324509">subject</span>&nbsp;<span class="ident" id="4324517">pkix</span><span class="op" id="4324521">.</span><span class="ident" id="4324522">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324535">if</span>&nbsp;<span class="ident" id="4324538">_</span><span class="op" id="4324539">,</span>&nbsp;<span class="ident" id="4324541">err</span>&nbsp;<span class="op" id="4324545">:=</span>&nbsp;<span class="ident" id="4324548">asn1</span><span class="op" id="4324552">.</span><span class="ident" id="4324553">Unmarshal</span><span class="op" id="4324562">(</span><span class="ident" id="4324563">in</span><span class="op" id="4324565">.</span><span class="ident" id="4324566">TBSCSR</span><span class="op" id="4324572">.</span><span class="ident" id="4324573">Subject</span><span class="op" id="4324580">.</span><span class="ident" id="4324581">FullBytes</span><span class="op" id="4324590">,</span>&nbsp;<span class="op" id="4324592">&amp;</span><span class="ident" id="4324593">subject</span><span class="op" id="4324600">)</span><span class="op" id="4324601">;</span>&nbsp;<span class="ident" id="4324603">err</span>&nbsp;<span class="op" id="4324607">!=</span>&nbsp;<span class="ident" id="4324610">nil</span>&nbsp;<span class="op" id="4324614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324618">return</span>&nbsp;<span class="ident" id="4324625">nil</span><span class="op" id="4324628">,</span>&nbsp;<span class="ident" id="4324630">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324639">out</span><span class="op" id="4324642">.</span><span class="ident" id="4324643">Subject</span><span class="op" id="4324650">.</span><span class="ident" id="4324651">FillFromRDNSequence</span><span class="op" id="4324670">(</span><span class="op" id="4324671">&amp;</span><span class="ident" id="4324672">subject</span><span class="op" id="4324679">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324683">var</span>&nbsp;<span class="ident" id="4324687">extensions</span>&nbsp;<span class="op" id="4324698">[</span><span class="op" id="4324699">]</span><span class="ident" id="4324700">pkix</span><span class="op" id="4324704">.</span><span class="ident" id="4324705">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324729">for</span>&nbsp;<span class="ident" id="4324733">_</span><span class="op" id="4324734">,</span>&nbsp;<span class="ident" id="4324736">atvSet</span>&nbsp;<span class="op" id="4324743">:=</span>&nbsp;<span class="keyword" id="4324746">range</span>&nbsp;<span class="ident" id="4324752">in</span><span class="op" id="4324754">.</span><span class="ident" id="4324755">TBSCSR</span><span class="op" id="4324761">.</span><span class="ident" id="4324762">Attributes</span>&nbsp;<span class="op" id="4324773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324777">if</span>&nbsp;<span class="op" id="4324780">!</span><span class="ident" id="4324781">atvSet</span><span class="op" id="4324787">.</span><span class="ident" id="4324788">Type</span><span class="op" id="4324792">.</span><span class="ident" id="4324793">Equal</span><span class="op" id="4324798">(</span><span class="ident" id="4324799">oidExtensionRequest</span><span class="op" id="4324818">)</span>&nbsp;<span class="op" id="4324820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324825">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324836">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324841">for</span>&nbsp;<span class="ident" id="4324845">_</span><span class="op" id="4324846">,</span>&nbsp;<span class="ident" id="4324848">atvs</span>&nbsp;<span class="op" id="4324853">:=</span>&nbsp;<span class="keyword" id="4324856">range</span>&nbsp;<span class="ident" id="4324862">atvSet</span><span class="op" id="4324868">.</span><span class="ident" id="4324869">Value</span>&nbsp;<span class="op" id="4324875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324880">extensions</span>&nbsp;<span class="op" id="4324891">=</span>&nbsp;<span class="builtinfunc" id="4324893">append</span><span class="op" id="4324899">(</span><span class="ident" id="4324900">extensions</span><span class="op" id="4324910">,</span>&nbsp;<span class="ident" id="4324912">atvs</span><span class="op" id="4324916">...</span><span class="op" id="4324919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4324926">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4324930">out</span><span class="op" id="4324933">.</span><span class="ident" id="4324934">Extensions</span>&nbsp;<span class="op" id="4324945">=</span>&nbsp;<span class="builtinfunc" id="4324947">make</span><span class="op" id="4324951">(</span><span class="op" id="4324952">[</span><span class="op" id="4324953">]</span><span class="ident" id="4324954">pkix</span><span class="op" id="4324958">.</span><span class="ident" id="4324959">Extension</span><span class="op" id="4324968">,</span>&nbsp;<span class="num" id="4324970">0</span><span class="op" id="4324971">,</span>&nbsp;<span class="builtinfunc" id="4324973">len</span><span class="op" id="4324976">(</span><span class="ident" id="4324977">extensions</span><span class="op" id="4324987">)</span><span class="op" id="4324988">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4324992">for</span>&nbsp;<span class="ident" id="4324996">_</span><span class="op" id="4324997">,</span>&nbsp;<span class="ident" id="4324999">e</span>&nbsp;<span class="op" id="4325001">:=</span>&nbsp;<span class="keyword" id="4325004">range</span>&nbsp;<span class="ident" id="4325010">extensions</span>&nbsp;<span class="op" id="4325021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325025">value</span><span class="op" id="4325030">,</span>&nbsp;<span class="ident" id="4325032">ok</span>&nbsp;<span class="op" id="4325035">:=</span>&nbsp;<span class="ident" id="4325038">e</span><span class="op" id="4325039">.</span><span class="ident" id="4325040">Value</span><span class="op" id="4325045">.</span><span class="op" id="4325046">(</span><span class="op" id="4325047">[</span><span class="op" id="4325048">]</span><span class="builtintype" id="4325049">byte</span><span class="op" id="4325053">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325057">if</span>&nbsp;<span class="op" id="4325060">!</span><span class="ident" id="4325061">ok</span>&nbsp;<span class="op" id="4325064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325069">return</span>&nbsp;<span class="ident" id="4325076">nil</span><span class="op" id="4325079">,</span>&nbsp;<span class="ident" id="4325081">errors</span><span class="op" id="4325087">.</span><span class="ident" id="4325088">New</span><span class="op" id="4325091">(</span><span class="string" id="4325092">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4325151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325160">out</span><span class="op" id="4325163">.</span><span class="ident" id="4325164">Extensions</span>&nbsp;<span class="op" id="4325175">=</span>&nbsp;<span class="builtinfunc" id="4325177">append</span><span class="op" id="4325183">(</span><span class="ident" id="4325184">out</span><span class="op" id="4325187">.</span><span class="ident" id="4325188">Extensions</span><span class="op" id="4325198">,</span>&nbsp;<span class="ident" id="4325200">pkix</span><span class="op" id="4325204">.</span><span class="ident" id="4325205">Extension</span><span class="op" id="4325214">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325219">Id</span><span class="op" id="4325221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325226">e</span><span class="op" id="4325227">.</span><span class="ident" id="4325228">Type</span><span class="op" id="4325232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325237">Value</span><span class="op" id="4325242">:</span>&nbsp;<span class="ident" id="4325244">value</span><span class="op" id="4325249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325253">}</span><span class="op" id="4325254">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325259">if</span>&nbsp;<span class="builtinfunc" id="4325262">len</span><span class="op" id="4325265">(</span><span class="ident" id="4325266">e</span><span class="op" id="4325267">.</span><span class="ident" id="4325268">Type</span><span class="op" id="4325272">)</span>&nbsp;<span class="op" id="4325274">==</span>&nbsp;<span class="num" id="4325277">4</span>&nbsp;<span class="op" id="4325279">&amp;&amp;</span>&nbsp;<span class="ident" id="4325282">e</span><span class="op" id="4325283">.</span><span class="ident" id="4325284">Type</span><span class="op" id="4325288">[</span><span class="num" id="4325289">0</span><span class="op" id="4325290">]</span>&nbsp;<span class="op" id="4325292">==</span>&nbsp;<span class="num" id="4325295">2</span>&nbsp;<span class="op" id="4325297">&amp;&amp;</span>&nbsp;<span class="ident" id="4325300">e</span><span class="op" id="4325301">.</span><span class="ident" id="4325302">Type</span><span class="op" id="4325306">[</span><span class="num" id="4325307">1</span><span class="op" id="4325308">]</span>&nbsp;<span class="op" id="4325310">==</span>&nbsp;<span class="num" id="4325313">5</span>&nbsp;<span class="op" id="4325315">&amp;&amp;</span>&nbsp;<span class="ident" id="4325318">e</span><span class="op" id="4325319">.</span><span class="ident" id="4325320">Type</span><span class="op" id="4325324">[</span><span class="num" id="4325325">2</span><span class="op" id="4325326">]</span>&nbsp;<span class="op" id="4325328">==</span>&nbsp;<span class="num" id="4325331">29</span>&nbsp;<span class="op" id="4325334">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325339">switch</span>&nbsp;<span class="ident" id="4325346">e</span><span class="op" id="4325347">.</span><span class="ident" id="4325348">Type</span><span class="op" id="4325352">[</span><span class="num" id="4325353">3</span><span class="op" id="4325354">]</span>&nbsp;<span class="op" id="4325356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325361">case</span>&nbsp;<span class="num" id="4325366">17</span><span class="op" id="4325368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4325374">out</span><span class="op" id="4325377">.</span><span class="ident" id="4325378">DNSNames</span><span class="op" id="4325386">,</span>&nbsp;<span class="ident" id="4325388">out</span><span class="op" id="4325391">.</span><span class="ident" id="4325392">EmailAddresses</span><span class="op" id="4325406">,</span>&nbsp;<span class="ident" id="4325408">out</span><span class="op" id="4325411">.</span><span class="ident" id="4325412">IPAddresses</span><span class="op" id="4325423">,</span>&nbsp;<span class="ident" id="4325425">err</span>&nbsp;<span class="op" id="4325429">=</span>&nbsp;<span class="ident" id="4325431">parseSANExtension</span><span class="op" id="4325448">(</span><span class="ident" id="4325449">value</span><span class="op" id="4325454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325460">if</span>&nbsp;<span class="ident" id="4325463">err</span>&nbsp;<span class="op" id="4325467">!=</span>&nbsp;<span class="ident" id="4325470">nil</span>&nbsp;<span class="op" id="4325474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325481">return</span>&nbsp;<span class="ident" id="4325488">nil</span><span class="op" id="4325491">,</span>&nbsp;<span class="ident" id="4325493">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4325513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4325517">return</span>&nbsp;<span class="ident" id="4325524">out</span><span class="op" id="4325527">,</span>&nbsp;<span class="ident" id="4325529">nil</span><br>
<span class="lineno"></span><span class="op" id="4325533">}</span>
</div>
</body>
</html>
