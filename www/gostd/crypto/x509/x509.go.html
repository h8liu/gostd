<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4333333">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4333388">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4333442">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4333493">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4333553">package</span>&nbsp;<span class="ident" id="4333561">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4333567">import</span>&nbsp;<span class="op" id="4333574">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333577">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333586">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333596">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333610">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333626">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333645">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333659">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333674">_</span>&nbsp;<span class="string" id="4333676">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333693">_</span>&nbsp;<span class="string" id="4333695">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333712">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333732">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333749">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333765">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333775">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333781">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333793">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333800">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4333811">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4333818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4333821">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4333901">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4333917">type</span>&nbsp;<span class="ident" id="4333922">pkixPublicKey</span>&nbsp;<span class="keyword" id="4333936">struct</span>&nbsp;<span class="op" id="4333943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333946">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4333956">pkix</span><span class="op" id="4333960">.</span><span class="ident" id="4333961">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4333982">BitString</span>&nbsp;<span class="ident" id="4333992">asn1</span><span class="op" id="4333996">.</span><span class="ident" id="4333997">BitString</span><br>
<span class="lineno"></span><span class="op" id="4334007">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4334010">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4334082">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4334140">func</span>&nbsp;<span class="ident" id="4334145">ParsePKIXPublicKey</span><span class="op" id="4334163">(</span><span class="ident" id="4334164">derBytes</span>&nbsp;<span class="op" id="4334173">[</span><span class="op" id="4334174">]</span><span class="builtintype" id="4334175">byte</span><span class="op" id="4334179">)</span>&nbsp;<span class="op" id="4334181">(</span><span class="ident" id="4334182">pub</span>&nbsp;<span class="keyword" id="4334186">interface</span><span class="op" id="4334195">{</span><span class="op" id="4334196">}</span><span class="op" id="4334197">,</span>&nbsp;<span class="ident" id="4334199">err</span>&nbsp;<span class="builtintype" id="4334203">error</span><span class="op" id="4334208">)</span>&nbsp;<span class="op" id="4334210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334213">var</span>&nbsp;<span class="ident" id="4334217">pki</span>&nbsp;<span class="ident" id="4334221">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334236">if</span>&nbsp;<span class="ident" id="4334239">_</span><span class="op" id="4334240">,</span>&nbsp;<span class="ident" id="4334242">err</span>&nbsp;<span class="op" id="4334246">=</span>&nbsp;<span class="ident" id="4334248">asn1</span><span class="op" id="4334252">.</span><span class="ident" id="4334253">Unmarshal</span><span class="op" id="4334262">(</span><span class="ident" id="4334263">derBytes</span><span class="op" id="4334271">,</span>&nbsp;<span class="op" id="4334273">&amp;</span><span class="ident" id="4334274">pki</span><span class="op" id="4334277">)</span><span class="op" id="4334278">;</span>&nbsp;<span class="ident" id="4334280">err</span>&nbsp;<span class="op" id="4334284">!=</span>&nbsp;<span class="ident" id="4334287">nil</span>&nbsp;<span class="op" id="4334291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334295">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334306">algo</span>&nbsp;<span class="op" id="4334311">:=</span>&nbsp;<span class="ident" id="4334314">getPublicKeyAlgorithmFromOID</span><span class="op" id="4334342">(</span><span class="ident" id="4334343">pki</span><span class="op" id="4334346">.</span><span class="ident" id="4334347">Algorithm</span><span class="op" id="4334356">.</span><span class="ident" id="4334357">Algorithm</span><span class="op" id="4334366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334369">if</span>&nbsp;<span class="ident" id="4334372">algo</span>&nbsp;<span class="op" id="4334377">==</span>&nbsp;<span class="ident" id="4334380">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4334406">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334410">return</span>&nbsp;<span class="ident" id="4334417">nil</span><span class="op" id="4334420">,</span>&nbsp;<span class="ident" id="4334422">errors</span><span class="op" id="4334428">.</span><span class="ident" id="4334429">New</span><span class="op" id="4334432">(</span><span class="string" id="4334433">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4334469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334475">return</span>&nbsp;<span class="ident" id="4334482">parsePublicKey</span><span class="op" id="4334496">(</span><span class="ident" id="4334497">algo</span><span class="op" id="4334501">,</span>&nbsp;<span class="op" id="4334503">&amp;</span><span class="ident" id="4334504">pki</span><span class="op" id="4334507">)</span><br>
<span class="lineno"></span><span class="op" id="4334509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4334512">func</span>&nbsp;<span class="ident" id="4334517">marshalPublicKey</span><span class="op" id="4334533">(</span><span class="ident" id="4334534">pub</span>&nbsp;<span class="keyword" id="4334538">interface</span><span class="op" id="4334547">{</span><span class="op" id="4334548">}</span><span class="op" id="4334549">)</span>&nbsp;<span class="op" id="4334551">(</span><span class="ident" id="4334552">publicKeyBytes</span>&nbsp;<span class="op" id="4334567">[</span><span class="op" id="4334568">]</span><span class="builtintype" id="4334569">byte</span><span class="op" id="4334573">,</span>&nbsp;<span class="ident" id="4334575">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4334594">pkix</span><span class="op" id="4334598">.</span><span class="ident" id="4334599">AlgorithmIdentifier</span><span class="op" id="4334618">,</span>&nbsp;<span class="ident" id="4334620">err</span>&nbsp;<span class="builtintype" id="4334624">error</span><span class="op" id="4334629">)</span>&nbsp;<span class="op" id="4334631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334634">switch</span>&nbsp;<span class="ident" id="4334641">pub</span>&nbsp;<span class="op" id="4334645">:=</span>&nbsp;<span class="ident" id="4334648">pub</span><span class="op" id="4334651">.</span><span class="op" id="4334652">(</span><span class="keyword" id="4334653">type</span><span class="op" id="4334657">)</span>&nbsp;<span class="op" id="4334659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4334662">case</span>&nbsp;<span class="op" id="4334667">*</span><span class="ident" id="4334668">rsa</span><span class="op" id="4334671">.</span><span class="ident" id="4334672">PublicKey</span><span class="op" id="4334681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334685">publicKeyBytes</span><span class="op" id="4334699">,</span>&nbsp;<span class="ident" id="4334701">err</span>&nbsp;<span class="op" id="4334705">=</span>&nbsp;<span class="ident" id="4334707">asn1</span><span class="op" id="4334711">.</span><span class="ident" id="4334712">Marshal</span><span class="op" id="4334719">(</span><span class="ident" id="4334720">rsaPublicKey</span><span class="op" id="4334732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334737">N</span><span class="op" id="4334738">:</span>&nbsp;<span class="ident" id="4334740">pub</span><span class="op" id="4334743">.</span><span class="ident" id="4334744">N</span><span class="op" id="4334745">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334750">E</span><span class="op" id="4334751">:</span>&nbsp;<span class="ident" id="4334753">pub</span><span class="op" id="4334756">.</span><span class="ident" id="4334757">E</span><span class="op" id="4334758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4334762">}</span><span class="op" id="4334763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334767">publicKeyAlgorithm</span><span class="op" id="4334785">.</span><span class="ident" id="4334786">Algorithm</span>&nbsp;<span class="op" id="4334796">=</span>&nbsp;<span class="ident" id="4334798">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4334816">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4334874">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4334932">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4334983">publicKeyAlgorithm</span><span class="op" id="4335001">.</span><span class="ident" id="4335002">Parameters</span>&nbsp;<span class="op" id="4335013">=</span>&nbsp;<span class="ident" id="4335015">asn1</span><span class="op" id="4335019">.</span><span class="ident" id="4335020">RawValue</span><span class="op" id="4335028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335033">Tag</span><span class="op" id="4335036">:</span>&nbsp;<span class="num" id="4335038">5</span><span class="op" id="4335039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4335043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335046">case</span>&nbsp;<span class="op" id="4335051">*</span><span class="ident" id="4335052">ecdsa</span><span class="op" id="4335057">.</span><span class="ident" id="4335058">PublicKey</span><span class="op" id="4335067">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335071">publicKeyBytes</span>&nbsp;<span class="op" id="4335086">=</span>&nbsp;<span class="ident" id="4335088">elliptic</span><span class="op" id="4335096">.</span><span class="ident" id="4335097">Marshal</span><span class="op" id="4335104">(</span><span class="ident" id="4335105">pub</span><span class="op" id="4335108">.</span><span class="ident" id="4335109">Curve</span><span class="op" id="4335114">,</span>&nbsp;<span class="ident" id="4335116">pub</span><span class="op" id="4335119">.</span><span class="ident" id="4335120">X</span><span class="op" id="4335121">,</span>&nbsp;<span class="ident" id="4335123">pub</span><span class="op" id="4335126">.</span><span class="ident" id="4335127">Y</span><span class="op" id="4335128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335132">oid</span><span class="op" id="4335135">,</span>&nbsp;<span class="ident" id="4335137">ok</span>&nbsp;<span class="op" id="4335140">:=</span>&nbsp;<span class="ident" id="4335143">oidFromNamedCurve</span><span class="op" id="4335160">(</span><span class="ident" id="4335161">pub</span><span class="op" id="4335164">.</span><span class="ident" id="4335165">Curve</span><span class="op" id="4335170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335174">if</span>&nbsp;<span class="op" id="4335177">!</span><span class="ident" id="4335178">ok</span>&nbsp;<span class="op" id="4335181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335186">return</span>&nbsp;<span class="ident" id="4335193">nil</span><span class="op" id="4335196">,</span>&nbsp;<span class="ident" id="4335198">pkix</span><span class="op" id="4335202">.</span><span class="ident" id="4335203">AlgorithmIdentifier</span><span class="op" id="4335222">{</span><span class="op" id="4335223">}</span><span class="op" id="4335224">,</span>&nbsp;<span class="ident" id="4335226">errors</span><span class="op" id="4335232">.</span><span class="ident" id="4335233">New</span><span class="op" id="4335236">(</span><span class="string" id="4335237">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4335271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4335275">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335279">publicKeyAlgorithm</span><span class="op" id="4335297">.</span><span class="ident" id="4335298">Algorithm</span>&nbsp;<span class="op" id="4335308">=</span>&nbsp;<span class="ident" id="4335310">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335330">var</span>&nbsp;<span class="ident" id="4335334">paramBytes</span>&nbsp;<span class="op" id="4335345">[</span><span class="op" id="4335346">]</span><span class="builtintype" id="4335347">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335354">paramBytes</span><span class="op" id="4335364">,</span>&nbsp;<span class="ident" id="4335366">err</span>&nbsp;<span class="op" id="4335370">=</span>&nbsp;<span class="ident" id="4335372">asn1</span><span class="op" id="4335376">.</span><span class="ident" id="4335377">Marshal</span><span class="op" id="4335384">(</span><span class="ident" id="4335385">oid</span><span class="op" id="4335388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335392">if</span>&nbsp;<span class="ident" id="4335395">err</span>&nbsp;<span class="op" id="4335399">!=</span>&nbsp;<span class="ident" id="4335402">nil</span>&nbsp;<span class="op" id="4335406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335411">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4335420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335424">publicKeyAlgorithm</span><span class="op" id="4335442">.</span><span class="ident" id="4335443">Parameters</span><span class="op" id="4335453">.</span><span class="ident" id="4335454">FullBytes</span>&nbsp;<span class="op" id="4335464">=</span>&nbsp;<span class="ident" id="4335466">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335478">default</span><span class="op" id="4335485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335489">return</span>&nbsp;<span class="ident" id="4335496">nil</span><span class="op" id="4335499">,</span>&nbsp;<span class="ident" id="4335501">pkix</span><span class="op" id="4335505">.</span><span class="ident" id="4335506">AlgorithmIdentifier</span><span class="op" id="4335525">{</span><span class="op" id="4335526">}</span><span class="op" id="4335527">,</span>&nbsp;<span class="ident" id="4335529">errors</span><span class="op" id="4335535">.</span><span class="ident" id="4335536">New</span><span class="op" id="4335539">(</span><span class="string" id="4335540">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4335588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4335591">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335595">return</span>&nbsp;<span class="ident" id="4335602">publicKeyBytes</span><span class="op" id="4335616">,</span>&nbsp;<span class="ident" id="4335618">publicKeyAlgorithm</span><span class="op" id="4335636">,</span>&nbsp;<span class="ident" id="4335638">nil</span><br>
<span class="lineno"></span><span class="op" id="4335642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4335645">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4335721">func</span>&nbsp;<span class="ident" id="4335726">MarshalPKIXPublicKey</span><span class="op" id="4335746">(</span><span class="ident" id="4335747">pub</span>&nbsp;<span class="keyword" id="4335751">interface</span><span class="op" id="4335760">{</span><span class="op" id="4335761">}</span><span class="op" id="4335762">)</span>&nbsp;<span class="op" id="4335764">(</span><span class="op" id="4335765">[</span><span class="op" id="4335766">]</span><span class="builtintype" id="4335767">byte</span><span class="op" id="4335771">,</span>&nbsp;<span class="builtintype" id="4335773">error</span><span class="op" id="4335778">)</span>&nbsp;<span class="op" id="4335780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335783">var</span>&nbsp;<span class="ident" id="4335787">publicKeyBytes</span>&nbsp;<span class="op" id="4335802">[</span><span class="op" id="4335803">]</span><span class="builtintype" id="4335804">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335810">var</span>&nbsp;<span class="ident" id="4335814">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4335833">pkix</span><span class="op" id="4335837">.</span><span class="ident" id="4335838">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335859">var</span>&nbsp;<span class="ident" id="4335863">err</span>&nbsp;<span class="builtintype" id="4335867">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335875">if</span>&nbsp;<span class="ident" id="4335878">publicKeyBytes</span><span class="op" id="4335892">,</span>&nbsp;<span class="ident" id="4335894">publicKeyAlgorithm</span><span class="op" id="4335912">,</span>&nbsp;<span class="ident" id="4335914">err</span>&nbsp;<span class="op" id="4335918">=</span>&nbsp;<span class="ident" id="4335920">marshalPublicKey</span><span class="op" id="4335936">(</span><span class="ident" id="4335937">pub</span><span class="op" id="4335940">)</span><span class="op" id="4335941">;</span>&nbsp;<span class="ident" id="4335943">err</span>&nbsp;<span class="op" id="4335947">!=</span>&nbsp;<span class="ident" id="4335950">nil</span>&nbsp;<span class="op" id="4335954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4335958">return</span>&nbsp;<span class="ident" id="4335965">nil</span><span class="op" id="4335968">,</span>&nbsp;<span class="ident" id="4335970">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4335975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4335979">pkix</span>&nbsp;<span class="op" id="4335984">:=</span>&nbsp;<span class="ident" id="4335987">pkixPublicKey</span><span class="op" id="4336000">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336004">Algo</span><span class="op" id="4336008">:</span>&nbsp;<span class="ident" id="4336010">publicKeyAlgorithm</span><span class="op" id="4336028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336032">BitString</span><span class="op" id="4336041">:</span>&nbsp;<span class="ident" id="4336043">asn1</span><span class="op" id="4336047">.</span><span class="ident" id="4336048">BitString</span><span class="op" id="4336057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336062">Bytes</span><span class="op" id="4336067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336073">publicKeyBytes</span><span class="op" id="4336087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336092">BitLength</span><span class="op" id="4336101">:</span>&nbsp;<span class="num" id="4336103">8</span>&nbsp;<span class="op" id="4336105">*</span>&nbsp;<span class="builtinfunc" id="4336107">len</span><span class="op" id="4336110">(</span><span class="ident" id="4336111">publicKeyBytes</span><span class="op" id="4336125">)</span><span class="op" id="4336126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4336130">}</span><span class="op" id="4336131">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4336134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336138">ret</span><span class="op" id="4336141">,</span>&nbsp;<span class="ident" id="4336143">_</span>&nbsp;<span class="op" id="4336145">:=</span>&nbsp;<span class="ident" id="4336148">asn1</span><span class="op" id="4336152">.</span><span class="ident" id="4336153">Marshal</span><span class="op" id="4336160">(</span><span class="ident" id="4336161">pkix</span><span class="op" id="4336165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4336168">return</span>&nbsp;<span class="ident" id="4336175">ret</span><span class="op" id="4336178">,</span>&nbsp;<span class="ident" id="4336180">nil</span><br>
<span class="lineno"></span><span class="op" id="4336184">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4336187">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4336260">type</span>&nbsp;<span class="ident" id="4336265">certificate</span>&nbsp;<span class="keyword" id="4336277">struct</span>&nbsp;<span class="op" id="4336284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336287">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336306">asn1</span><span class="op" id="4336310">.</span><span class="ident" id="4336311">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336323">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336342">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336358">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4336377">pkix</span><span class="op" id="4336381">.</span><span class="ident" id="4336382">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336403">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336422">asn1</span><span class="op" id="4336426">.</span><span class="ident" id="4336427">BitString</span><br>
<span class="lineno"></span><span class="op" id="4336437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4336440">type</span>&nbsp;<span class="ident" id="4336445">tbsCertificate</span>&nbsp;<span class="keyword" id="4336460">struct</span>&nbsp;<span class="op" id="4336467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336470">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336489">asn1</span><span class="op" id="4336493">.</span><span class="ident" id="4336494">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336506">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4336525">int</span>&nbsp;<span class="string" id="4336529">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336573">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336592">*</span><span class="ident" id="4336593">big</span><span class="op" id="4336596">.</span><span class="ident" id="4336597">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336602">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4336621">pkix</span><span class="op" id="4336625">.</span><span class="ident" id="4336626">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336647">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336666">asn1</span><span class="op" id="4336670">.</span><span class="ident" id="4336671">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336681">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336700">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336710">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336729">asn1</span><span class="op" id="4336733">.</span><span class="ident" id="4336734">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336744">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336763">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336778">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336797">asn1</span><span class="op" id="4336801">.</span><span class="ident" id="4336802">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4336814">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336839">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4336858">asn1</span><span class="op" id="4336862">.</span><span class="ident" id="4336863">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4336875">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4336900">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4336919">[</span><span class="op" id="4336920">]</span><span class="ident" id="4336921">pkix</span><span class="op" id="4336925">.</span><span class="ident" id="4336926">Extension</span>&nbsp;<span class="string" id="4336936">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4336969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4336972">type</span>&nbsp;<span class="ident" id="4336977">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4337000">struct</span>&nbsp;<span class="op" id="4337007">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337010">P</span><span class="op" id="4337011">,</span>&nbsp;<span class="ident" id="4337013">Q</span><span class="op" id="4337014">,</span>&nbsp;<span class="ident" id="4337016">G</span>&nbsp;<span class="op" id="4337018">*</span><span class="ident" id="4337019">big</span><span class="op" id="4337022">.</span><span class="ident" id="4337023">Int</span><br>
<span class="lineno"></span><span class="op" id="4337027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337030">type</span>&nbsp;<span class="ident" id="4337035">dsaSignature</span>&nbsp;<span class="keyword" id="4337048">struct</span>&nbsp;<span class="op" id="4337055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337058">R</span><span class="op" id="4337059">,</span>&nbsp;<span class="ident" id="4337061">S</span>&nbsp;<span class="op" id="4337063">*</span><span class="ident" id="4337064">big</span><span class="op" id="4337067">.</span><span class="ident" id="4337068">Int</span><br>
<span class="lineno">135</span><span class="op" id="4337072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337075">type</span>&nbsp;<span class="ident" id="4337080">ecdsaSignature</span>&nbsp;<span class="ident" id="4337095">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337109">type</span>&nbsp;<span class="ident" id="4337114">validity</span>&nbsp;<span class="keyword" id="4337123">struct</span>&nbsp;<span class="op" id="4337130">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337133">NotBefore</span><span class="op" id="4337142">,</span>&nbsp;<span class="ident" id="4337144">NotAfter</span>&nbsp;<span class="ident" id="4337153">time</span><span class="op" id="4337157">.</span><span class="ident" id="4337158">Time</span><br>
<span class="lineno"></span><span class="op" id="4337163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337166">type</span>&nbsp;<span class="ident" id="4337171">publicKeyInfo</span>&nbsp;<span class="keyword" id="4337185">struct</span>&nbsp;<span class="op" id="4337192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337195">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4337205">asn1</span><span class="op" id="4337209">.</span><span class="ident" id="4337210">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337222">Algorithm</span>&nbsp;<span class="ident" id="4337232">pkix</span><span class="op" id="4337236">.</span><span class="ident" id="4337237">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337258">PublicKey</span>&nbsp;<span class="ident" id="4337268">asn1</span><span class="op" id="4337272">.</span><span class="ident" id="4337273">BitString</span><br>
<span class="lineno"></span><span class="op" id="4337283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4337286">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4337308">type</span>&nbsp;<span class="ident" id="4337313">authKeyId</span>&nbsp;<span class="keyword" id="4337323">struct</span>&nbsp;<span class="op" id="4337330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337333">Id</span>&nbsp;<span class="op" id="4337336">[</span><span class="op" id="4337337">]</span><span class="builtintype" id="4337338">byte</span>&nbsp;<span class="string" id="4337343">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4337367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337370">type</span>&nbsp;<span class="ident" id="4337375">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4337394">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4337399">const</span>&nbsp;<span class="op" id="4337405">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337408">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4337434">SignatureAlgorithm</span>&nbsp;<span class="op" id="4337453">=</span>&nbsp;<span class="ident" id="4337455">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337461">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337473">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337485">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337498">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337513">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337528">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337543">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337556">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337571">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337586">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337603">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337620">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4337636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337639">type</span>&nbsp;<span class="ident" id="4337644">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4337663">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4337668">const</span>&nbsp;<span class="op" id="4337674">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337677">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4337703">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4337722">=</span>&nbsp;<span class="ident" id="4337724">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337730">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337735">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4337740">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4337746">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4337749">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4337782">//</span><br>
<span class="lineno"></span><span class="comment" id="4337785">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4337819">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4337882">//</span><br>
<span class="lineno"></span><span class="comment" id="4337885">//</span><br>
<span class="lineno"></span><span class="comment" id="4337888">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4337931">//</span><br>
<span class="lineno"></span><span class="comment" id="4337934">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4337993">//</span><br>
<span class="lineno"></span><span class="comment" id="4337996">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4338055">//</span><br>
<span class="lineno"></span><span class="comment" id="4338058">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4338119">//</span><br>
<span class="lineno">195</span><span class="comment" id="4338122">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4338161">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4338222">//</span><br>
<span class="lineno"></span><span class="comment" id="4338225">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4338269">//</span><br>
<span class="lineno">200</span><span class="comment" id="4338272">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4338315">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4338368">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4338408">//</span><br>
<span class="lineno"></span><span class="comment" id="4338411">//</span><br>
<span class="lineno">205</span><span class="comment" id="4338414">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4338448">//</span><br>
<span class="lineno"></span><span class="comment" id="4338451">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4338514">//</span><br>
<span class="lineno"></span><span class="comment" id="4338517">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4338580">//</span><br>
<span class="lineno"></span><span class="comment" id="4338583">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4338646">//</span><br>
<span class="lineno"></span><span class="comment" id="4338649">//</span><br>
<span class="lineno"></span><span class="comment" id="4338652">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4338693">//</span><br>
<span class="lineno"></span><span class="comment" id="4338696">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4338737">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4338807">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4338858">//</span><br>
<span class="lineno">220</span><span class="comment" id="4338861">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4338903">//</span><br>
<span class="lineno"></span><span class="comment" id="4338906">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4338973">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4339042">//</span><br>
<span class="lineno">225</span><span class="comment" id="4339045">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4339112">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4339181">//</span><br>
<span class="lineno"></span><span class="comment" id="4339184">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4339251">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4339321">var</span>&nbsp;<span class="op" id="4339325">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339328">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339356">=</span>&nbsp;<span class="ident" id="4339358">asn1</span><span class="op" id="4339362">.</span><span class="ident" id="4339363">ObjectIdentifier</span><span class="op" id="4339379">{</span><span class="num" id="4339380">1</span><span class="op" id="4339381">,</span>&nbsp;<span class="num" id="4339383">2</span><span class="op" id="4339384">,</span>&nbsp;<span class="num" id="4339386">840</span><span class="op" id="4339389">,</span>&nbsp;<span class="num" id="4339391">113549</span><span class="op" id="4339397">,</span>&nbsp;<span class="num" id="4339399">1</span><span class="op" id="4339400">,</span>&nbsp;<span class="num" id="4339402">1</span><span class="op" id="4339403">,</span>&nbsp;<span class="num" id="4339405">2</span><span class="op" id="4339406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339409">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339437">=</span>&nbsp;<span class="ident" id="4339439">asn1</span><span class="op" id="4339443">.</span><span class="ident" id="4339444">ObjectIdentifier</span><span class="op" id="4339460">{</span><span class="num" id="4339461">1</span><span class="op" id="4339462">,</span>&nbsp;<span class="num" id="4339464">2</span><span class="op" id="4339465">,</span>&nbsp;<span class="num" id="4339467">840</span><span class="op" id="4339470">,</span>&nbsp;<span class="num" id="4339472">113549</span><span class="op" id="4339478">,</span>&nbsp;<span class="num" id="4339480">1</span><span class="op" id="4339481">,</span>&nbsp;<span class="num" id="4339483">1</span><span class="op" id="4339484">,</span>&nbsp;<span class="num" id="4339486">4</span><span class="op" id="4339487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339490">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339518">=</span>&nbsp;<span class="ident" id="4339520">asn1</span><span class="op" id="4339524">.</span><span class="ident" id="4339525">ObjectIdentifier</span><span class="op" id="4339541">{</span><span class="num" id="4339542">1</span><span class="op" id="4339543">,</span>&nbsp;<span class="num" id="4339545">2</span><span class="op" id="4339546">,</span>&nbsp;<span class="num" id="4339548">840</span><span class="op" id="4339551">,</span>&nbsp;<span class="num" id="4339553">113549</span><span class="op" id="4339559">,</span>&nbsp;<span class="num" id="4339561">1</span><span class="op" id="4339562">,</span>&nbsp;<span class="num" id="4339564">1</span><span class="op" id="4339565">,</span>&nbsp;<span class="num" id="4339567">5</span><span class="op" id="4339568">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339571">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4339599">=</span>&nbsp;<span class="ident" id="4339601">asn1</span><span class="op" id="4339605">.</span><span class="ident" id="4339606">ObjectIdentifier</span><span class="op" id="4339622">{</span><span class="num" id="4339623">1</span><span class="op" id="4339624">,</span>&nbsp;<span class="num" id="4339626">2</span><span class="op" id="4339627">,</span>&nbsp;<span class="num" id="4339629">840</span><span class="op" id="4339632">,</span>&nbsp;<span class="num" id="4339634">113549</span><span class="op" id="4339640">,</span>&nbsp;<span class="num" id="4339642">1</span><span class="op" id="4339643">,</span>&nbsp;<span class="num" id="4339645">1</span><span class="op" id="4339646">,</span>&nbsp;<span class="num" id="4339648">11</span><span class="op" id="4339650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339653">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4339681">=</span>&nbsp;<span class="ident" id="4339683">asn1</span><span class="op" id="4339687">.</span><span class="ident" id="4339688">ObjectIdentifier</span><span class="op" id="4339704">{</span><span class="num" id="4339705">1</span><span class="op" id="4339706">,</span>&nbsp;<span class="num" id="4339708">2</span><span class="op" id="4339709">,</span>&nbsp;<span class="num" id="4339711">840</span><span class="op" id="4339714">,</span>&nbsp;<span class="num" id="4339716">113549</span><span class="op" id="4339722">,</span>&nbsp;<span class="num" id="4339724">1</span><span class="op" id="4339725">,</span>&nbsp;<span class="num" id="4339727">1</span><span class="op" id="4339728">,</span>&nbsp;<span class="num" id="4339730">12</span><span class="op" id="4339732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339735">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4339763">=</span>&nbsp;<span class="ident" id="4339765">asn1</span><span class="op" id="4339769">.</span><span class="ident" id="4339770">ObjectIdentifier</span><span class="op" id="4339786">{</span><span class="num" id="4339787">1</span><span class="op" id="4339788">,</span>&nbsp;<span class="num" id="4339790">2</span><span class="op" id="4339791">,</span>&nbsp;<span class="num" id="4339793">840</span><span class="op" id="4339796">,</span>&nbsp;<span class="num" id="4339798">113549</span><span class="op" id="4339804">,</span>&nbsp;<span class="num" id="4339806">1</span><span class="op" id="4339807">,</span>&nbsp;<span class="num" id="4339809">1</span><span class="op" id="4339810">,</span>&nbsp;<span class="num" id="4339812">13</span><span class="op" id="4339814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339817">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339845">=</span>&nbsp;<span class="ident" id="4339847">asn1</span><span class="op" id="4339851">.</span><span class="ident" id="4339852">ObjectIdentifier</span><span class="op" id="4339868">{</span><span class="num" id="4339869">1</span><span class="op" id="4339870">,</span>&nbsp;<span class="num" id="4339872">2</span><span class="op" id="4339873">,</span>&nbsp;<span class="num" id="4339875">840</span><span class="op" id="4339878">,</span>&nbsp;<span class="num" id="4339880">10040</span><span class="op" id="4339885">,</span>&nbsp;<span class="num" id="4339887">4</span><span class="op" id="4339888">,</span>&nbsp;<span class="num" id="4339890">3</span><span class="op" id="4339891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339894">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4339922">=</span>&nbsp;<span class="ident" id="4339924">asn1</span><span class="op" id="4339928">.</span><span class="ident" id="4339929">ObjectIdentifier</span><span class="op" id="4339945">{</span><span class="num" id="4339946">2</span><span class="op" id="4339947">,</span>&nbsp;<span class="num" id="4339949">16</span><span class="op" id="4339951">,</span>&nbsp;<span class="num" id="4339953">840</span><span class="op" id="4339956">,</span>&nbsp;<span class="num" id="4339958">1</span><span class="op" id="4339959">,</span>&nbsp;<span class="num" id="4339961">101</span><span class="op" id="4339964">,</span>&nbsp;<span class="num" id="4339966">4</span><span class="op" id="4339967">,</span>&nbsp;<span class="num" id="4339969">3</span><span class="op" id="4339970">,</span>&nbsp;<span class="num" id="4339972">2</span><span class="op" id="4339973">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4339976">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4340004">=</span>&nbsp;<span class="ident" id="4340006">asn1</span><span class="op" id="4340010">.</span><span class="ident" id="4340011">ObjectIdentifier</span><span class="op" id="4340027">{</span><span class="num" id="4340028">1</span><span class="op" id="4340029">,</span>&nbsp;<span class="num" id="4340031">2</span><span class="op" id="4340032">,</span>&nbsp;<span class="num" id="4340034">840</span><span class="op" id="4340037">,</span>&nbsp;<span class="num" id="4340039">10045</span><span class="op" id="4340044">,</span>&nbsp;<span class="num" id="4340046">4</span><span class="op" id="4340047">,</span>&nbsp;<span class="num" id="4340049">1</span><span class="op" id="4340050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340053">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4340081">=</span>&nbsp;<span class="ident" id="4340083">asn1</span><span class="op" id="4340087">.</span><span class="ident" id="4340088">ObjectIdentifier</span><span class="op" id="4340104">{</span><span class="num" id="4340105">1</span><span class="op" id="4340106">,</span>&nbsp;<span class="num" id="4340108">2</span><span class="op" id="4340109">,</span>&nbsp;<span class="num" id="4340111">840</span><span class="op" id="4340114">,</span>&nbsp;<span class="num" id="4340116">10045</span><span class="op" id="4340121">,</span>&nbsp;<span class="num" id="4340123">4</span><span class="op" id="4340124">,</span>&nbsp;<span class="num" id="4340126">3</span><span class="op" id="4340127">,</span>&nbsp;<span class="num" id="4340129">2</span><span class="op" id="4340130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340133">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4340161">=</span>&nbsp;<span class="ident" id="4340163">asn1</span><span class="op" id="4340167">.</span><span class="ident" id="4340168">ObjectIdentifier</span><span class="op" id="4340184">{</span><span class="num" id="4340185">1</span><span class="op" id="4340186">,</span>&nbsp;<span class="num" id="4340188">2</span><span class="op" id="4340189">,</span>&nbsp;<span class="num" id="4340191">840</span><span class="op" id="4340194">,</span>&nbsp;<span class="num" id="4340196">10045</span><span class="op" id="4340201">,</span>&nbsp;<span class="num" id="4340203">4</span><span class="op" id="4340204">,</span>&nbsp;<span class="num" id="4340206">3</span><span class="op" id="4340207">,</span>&nbsp;<span class="num" id="4340209">3</span><span class="op" id="4340210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340213">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4340241">=</span>&nbsp;<span class="ident" id="4340243">asn1</span><span class="op" id="4340247">.</span><span class="ident" id="4340248">ObjectIdentifier</span><span class="op" id="4340264">{</span><span class="num" id="4340265">1</span><span class="op" id="4340266">,</span>&nbsp;<span class="num" id="4340268">2</span><span class="op" id="4340269">,</span>&nbsp;<span class="num" id="4340271">840</span><span class="op" id="4340274">,</span>&nbsp;<span class="num" id="4340276">10045</span><span class="op" id="4340281">,</span>&nbsp;<span class="num" id="4340283">4</span><span class="op" id="4340284">,</span>&nbsp;<span class="num" id="4340286">3</span><span class="op" id="4340287">,</span>&nbsp;<span class="num" id="4340289">4</span><span class="op" id="4340290">}</span><br>
<span class="lineno"></span><span class="op" id="4340292">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4340295">var</span>&nbsp;<span class="ident" id="4340299">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4340325">=</span>&nbsp;<span class="op" id="4340327">[</span><span class="op" id="4340328">]</span><span class="keyword" id="4340329">struct</span>&nbsp;<span class="op" id="4340336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340339">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340350">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340370">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340381">asn1</span><span class="op" id="4340385">.</span><span class="ident" id="4340386">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340404">pubKeyAlgo</span>&nbsp;<span class="ident" id="4340415">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4340435">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340446">crypto</span><span class="op" id="4340452">.</span><span class="ident" id="4340453">Hash</span><br>
<span class="lineno"></span><span class="op" id="4340458">}</span><span class="op" id="4340459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340462">{</span><span class="ident" id="4340463">MD2WithRSA</span><span class="op" id="4340473">,</span>&nbsp;<span class="ident" id="4340475">oidSignatureMD2WithRSA</span><span class="op" id="4340497">,</span>&nbsp;<span class="ident" id="4340499">RSA</span><span class="op" id="4340502">,</span>&nbsp;<span class="ident" id="4340504">crypto</span><span class="op" id="4340510">.</span><span class="ident" id="4340511">Hash</span><span class="op" id="4340515">(</span><span class="num" id="4340516">0</span><span class="op" id="4340517">)</span>&nbsp;<span class="comment" id="4340519">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4340541">}</span><span class="op" id="4340542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340545">{</span><span class="ident" id="4340546">MD5WithRSA</span><span class="op" id="4340556">,</span>&nbsp;<span class="ident" id="4340558">oidSignatureMD5WithRSA</span><span class="op" id="4340580">,</span>&nbsp;<span class="ident" id="4340582">RSA</span><span class="op" id="4340585">,</span>&nbsp;<span class="ident" id="4340587">crypto</span><span class="op" id="4340593">.</span><span class="ident" id="4340594">MD5</span><span class="op" id="4340597">}</span><span class="op" id="4340598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340601">{</span><span class="ident" id="4340602">SHA1WithRSA</span><span class="op" id="4340613">,</span>&nbsp;<span class="ident" id="4340615">oidSignatureSHA1WithRSA</span><span class="op" id="4340638">,</span>&nbsp;<span class="ident" id="4340640">RSA</span><span class="op" id="4340643">,</span>&nbsp;<span class="ident" id="4340645">crypto</span><span class="op" id="4340651">.</span><span class="ident" id="4340652">SHA1</span><span class="op" id="4340656">}</span><span class="op" id="4340657">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340660">{</span><span class="ident" id="4340661">SHA256WithRSA</span><span class="op" id="4340674">,</span>&nbsp;<span class="ident" id="4340676">oidSignatureSHA256WithRSA</span><span class="op" id="4340701">,</span>&nbsp;<span class="ident" id="4340703">RSA</span><span class="op" id="4340706">,</span>&nbsp;<span class="ident" id="4340708">crypto</span><span class="op" id="4340714">.</span><span class="ident" id="4340715">SHA256</span><span class="op" id="4340721">}</span><span class="op" id="4340722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340725">{</span><span class="ident" id="4340726">SHA384WithRSA</span><span class="op" id="4340739">,</span>&nbsp;<span class="ident" id="4340741">oidSignatureSHA384WithRSA</span><span class="op" id="4340766">,</span>&nbsp;<span class="ident" id="4340768">RSA</span><span class="op" id="4340771">,</span>&nbsp;<span class="ident" id="4340773">crypto</span><span class="op" id="4340779">.</span><span class="ident" id="4340780">SHA384</span><span class="op" id="4340786">}</span><span class="op" id="4340787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340790">{</span><span class="ident" id="4340791">SHA512WithRSA</span><span class="op" id="4340804">,</span>&nbsp;<span class="ident" id="4340806">oidSignatureSHA512WithRSA</span><span class="op" id="4340831">,</span>&nbsp;<span class="ident" id="4340833">RSA</span><span class="op" id="4340836">,</span>&nbsp;<span class="ident" id="4340838">crypto</span><span class="op" id="4340844">.</span><span class="ident" id="4340845">SHA512</span><span class="op" id="4340851">}</span><span class="op" id="4340852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340855">{</span><span class="ident" id="4340856">DSAWithSHA1</span><span class="op" id="4340867">,</span>&nbsp;<span class="ident" id="4340869">oidSignatureDSAWithSHA1</span><span class="op" id="4340892">,</span>&nbsp;<span class="ident" id="4340894">DSA</span><span class="op" id="4340897">,</span>&nbsp;<span class="ident" id="4340899">crypto</span><span class="op" id="4340905">.</span><span class="ident" id="4340906">SHA1</span><span class="op" id="4340910">}</span><span class="op" id="4340911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340914">{</span><span class="ident" id="4340915">DSAWithSHA256</span><span class="op" id="4340928">,</span>&nbsp;<span class="ident" id="4340930">oidSignatureDSAWithSHA256</span><span class="op" id="4340955">,</span>&nbsp;<span class="ident" id="4340957">DSA</span><span class="op" id="4340960">,</span>&nbsp;<span class="ident" id="4340962">crypto</span><span class="op" id="4340968">.</span><span class="ident" id="4340969">SHA256</span><span class="op" id="4340975">}</span><span class="op" id="4340976">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4340979">{</span><span class="ident" id="4340980">ECDSAWithSHA1</span><span class="op" id="4340993">,</span>&nbsp;<span class="ident" id="4340995">oidSignatureECDSAWithSHA1</span><span class="op" id="4341020">,</span>&nbsp;<span class="ident" id="4341022">ECDSA</span><span class="op" id="4341027">,</span>&nbsp;<span class="ident" id="4341029">crypto</span><span class="op" id="4341035">.</span><span class="ident" id="4341036">SHA1</span><span class="op" id="4341040">}</span><span class="op" id="4341041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341044">{</span><span class="ident" id="4341045">ECDSAWithSHA256</span><span class="op" id="4341060">,</span>&nbsp;<span class="ident" id="4341062">oidSignatureECDSAWithSHA256</span><span class="op" id="4341089">,</span>&nbsp;<span class="ident" id="4341091">ECDSA</span><span class="op" id="4341096">,</span>&nbsp;<span class="ident" id="4341098">crypto</span><span class="op" id="4341104">.</span><span class="ident" id="4341105">SHA256</span><span class="op" id="4341111">}</span><span class="op" id="4341112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341115">{</span><span class="ident" id="4341116">ECDSAWithSHA384</span><span class="op" id="4341131">,</span>&nbsp;<span class="ident" id="4341133">oidSignatureECDSAWithSHA384</span><span class="op" id="4341160">,</span>&nbsp;<span class="ident" id="4341162">ECDSA</span><span class="op" id="4341167">,</span>&nbsp;<span class="ident" id="4341169">crypto</span><span class="op" id="4341175">.</span><span class="ident" id="4341176">SHA384</span><span class="op" id="4341182">}</span><span class="op" id="4341183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341186">{</span><span class="ident" id="4341187">ECDSAWithSHA512</span><span class="op" id="4341202">,</span>&nbsp;<span class="ident" id="4341204">oidSignatureECDSAWithSHA512</span><span class="op" id="4341231">,</span>&nbsp;<span class="ident" id="4341233">ECDSA</span><span class="op" id="4341238">,</span>&nbsp;<span class="ident" id="4341240">crypto</span><span class="op" id="4341246">.</span><span class="ident" id="4341247">SHA512</span><span class="op" id="4341253">}</span><span class="op" id="4341254">,</span><br>
<span class="lineno"></span><span class="op" id="4341256">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4341259">func</span>&nbsp;<span class="ident" id="4341264">getSignatureAlgorithmFromOID</span><span class="op" id="4341292">(</span><span class="ident" id="4341293">oid</span>&nbsp;<span class="ident" id="4341297">asn1</span><span class="op" id="4341301">.</span><span class="ident" id="4341302">ObjectIdentifier</span><span class="op" id="4341318">)</span>&nbsp;<span class="ident" id="4341320">SignatureAlgorithm</span>&nbsp;<span class="op" id="4341339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341342">for</span>&nbsp;<span class="ident" id="4341346">_</span><span class="op" id="4341347">,</span>&nbsp;<span class="ident" id="4341349">details</span>&nbsp;<span class="op" id="4341357">:=</span>&nbsp;<span class="keyword" id="4341360">range</span>&nbsp;<span class="ident" id="4341366">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4341392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341396">if</span>&nbsp;<span class="ident" id="4341399">oid</span><span class="op" id="4341402">.</span><span class="ident" id="4341403">Equal</span><span class="op" id="4341408">(</span><span class="ident" id="4341409">details</span><span class="op" id="4341416">.</span><span class="ident" id="4341417">oid</span><span class="op" id="4341420">)</span>&nbsp;<span class="op" id="4341422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341427">return</span>&nbsp;<span class="ident" id="4341434">details</span><span class="op" id="4341441">.</span><span class="ident" id="4341442">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4341452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4341455">return</span>&nbsp;<span class="ident" id="4341462">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4341488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4341491">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4341530">//</span><br>
<span class="lineno"></span><span class="comment" id="4341533">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4341598">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4341631">//</span><br>
<span class="lineno">280</span><span class="comment" id="4341634">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4341688">//</span><br>
<span class="lineno"></span><span class="comment" id="4341691">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4341756">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4341787">//</span><br>
<span class="lineno">285</span><span class="comment" id="4341790">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4341858">//</span><br>
<span class="lineno"></span><span class="comment" id="4341861">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4341903">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4341975">var</span>&nbsp;<span class="op" id="4341979">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4341982">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4342000">=</span>&nbsp;<span class="ident" id="4342002">asn1</span><span class="op" id="4342006">.</span><span class="ident" id="4342007">ObjectIdentifier</span><span class="op" id="4342023">{</span><span class="num" id="4342024">1</span><span class="op" id="4342025">,</span>&nbsp;<span class="num" id="4342027">2</span><span class="op" id="4342028">,</span>&nbsp;<span class="num" id="4342030">840</span><span class="op" id="4342033">,</span>&nbsp;<span class="num" id="4342035">113549</span><span class="op" id="4342041">,</span>&nbsp;<span class="num" id="4342043">1</span><span class="op" id="4342044">,</span>&nbsp;<span class="num" id="4342046">1</span><span class="op" id="4342047">,</span>&nbsp;<span class="num" id="4342049">1</span><span class="op" id="4342050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4342053">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4342071">=</span>&nbsp;<span class="ident" id="4342073">asn1</span><span class="op" id="4342077">.</span><span class="ident" id="4342078">ObjectIdentifier</span><span class="op" id="4342094">{</span><span class="num" id="4342095">1</span><span class="op" id="4342096">,</span>&nbsp;<span class="num" id="4342098">2</span><span class="op" id="4342099">,</span>&nbsp;<span class="num" id="4342101">840</span><span class="op" id="4342104">,</span>&nbsp;<span class="num" id="4342106">10040</span><span class="op" id="4342111">,</span>&nbsp;<span class="num" id="4342113">4</span><span class="op" id="4342114">,</span>&nbsp;<span class="num" id="4342116">1</span><span class="op" id="4342117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4342120">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4342138">=</span>&nbsp;<span class="ident" id="4342140">asn1</span><span class="op" id="4342144">.</span><span class="ident" id="4342145">ObjectIdentifier</span><span class="op" id="4342161">{</span><span class="num" id="4342162">1</span><span class="op" id="4342163">,</span>&nbsp;<span class="num" id="4342165">2</span><span class="op" id="4342166">,</span>&nbsp;<span class="num" id="4342168">840</span><span class="op" id="4342171">,</span>&nbsp;<span class="num" id="4342173">10045</span><span class="op" id="4342178">,</span>&nbsp;<span class="num" id="4342180">2</span><span class="op" id="4342181">,</span>&nbsp;<span class="num" id="4342183">1</span><span class="op" id="4342184">}</span><br>
<span class="lineno"></span><span class="op" id="4342186">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4342189">func</span>&nbsp;<span class="ident" id="4342194">getPublicKeyAlgorithmFromOID</span><span class="op" id="4342222">(</span><span class="ident" id="4342223">oid</span>&nbsp;<span class="ident" id="4342227">asn1</span><span class="op" id="4342231">.</span><span class="ident" id="4342232">ObjectIdentifier</span><span class="op" id="4342248">)</span>&nbsp;<span class="ident" id="4342250">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4342269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342272">switch</span>&nbsp;<span class="op" id="4342279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342282">case</span>&nbsp;<span class="ident" id="4342287">oid</span><span class="op" id="4342290">.</span><span class="ident" id="4342291">Equal</span><span class="op" id="4342296">(</span><span class="ident" id="4342297">oidPublicKeyRSA</span><span class="op" id="4342312">)</span><span class="op" id="4342313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342317">return</span>&nbsp;<span class="ident" id="4342324">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342329">case</span>&nbsp;<span class="ident" id="4342334">oid</span><span class="op" id="4342337">.</span><span class="ident" id="4342338">Equal</span><span class="op" id="4342343">(</span><span class="ident" id="4342344">oidPublicKeyDSA</span><span class="op" id="4342359">)</span><span class="op" id="4342360">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342364">return</span>&nbsp;<span class="ident" id="4342371">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342376">case</span>&nbsp;<span class="ident" id="4342381">oid</span><span class="op" id="4342384">.</span><span class="ident" id="4342385">Equal</span><span class="op" id="4342390">(</span><span class="ident" id="4342391">oidPublicKeyECDSA</span><span class="op" id="4342408">)</span><span class="op" id="4342409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342413">return</span>&nbsp;<span class="ident" id="4342420">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4342427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4342430">return</span>&nbsp;<span class="ident" id="4342437">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4342463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4342466">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4342500">//</span><br>
<span class="lineno"></span><span class="comment" id="4342503">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4342540">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4342607">//</span><br>
<span class="lineno"></span><span class="comment" id="4342610">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4342647">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4342710">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4342728">//</span><br>
<span class="lineno"></span><span class="comment" id="4342731">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4342768">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4342835">//</span><br>
<span class="lineno"></span><span class="comment" id="4342838">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4342875">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4342942">//</span><br>
<span class="lineno"></span><span class="comment" id="4342945">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4342990">var</span>&nbsp;<span class="op" id="4342994">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4342997">oidNamedCurveP224</span>&nbsp;<span class="op" id="4343015">=</span>&nbsp;<span class="ident" id="4343017">asn1</span><span class="op" id="4343021">.</span><span class="ident" id="4343022">ObjectIdentifier</span><span class="op" id="4343038">{</span><span class="num" id="4343039">1</span><span class="op" id="4343040">,</span>&nbsp;<span class="num" id="4343042">3</span><span class="op" id="4343043">,</span>&nbsp;<span class="num" id="4343045">132</span><span class="op" id="4343048">,</span>&nbsp;<span class="num" id="4343050">0</span><span class="op" id="4343051">,</span>&nbsp;<span class="num" id="4343053">33</span><span class="op" id="4343055">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343058">oidNamedCurveP256</span>&nbsp;<span class="op" id="4343076">=</span>&nbsp;<span class="ident" id="4343078">asn1</span><span class="op" id="4343082">.</span><span class="ident" id="4343083">ObjectIdentifier</span><span class="op" id="4343099">{</span><span class="num" id="4343100">1</span><span class="op" id="4343101">,</span>&nbsp;<span class="num" id="4343103">2</span><span class="op" id="4343104">,</span>&nbsp;<span class="num" id="4343106">840</span><span class="op" id="4343109">,</span>&nbsp;<span class="num" id="4343111">10045</span><span class="op" id="4343116">,</span>&nbsp;<span class="num" id="4343118">3</span><span class="op" id="4343119">,</span>&nbsp;<span class="num" id="4343121">1</span><span class="op" id="4343122">,</span>&nbsp;<span class="num" id="4343124">7</span><span class="op" id="4343125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343128">oidNamedCurveP384</span>&nbsp;<span class="op" id="4343146">=</span>&nbsp;<span class="ident" id="4343148">asn1</span><span class="op" id="4343152">.</span><span class="ident" id="4343153">ObjectIdentifier</span><span class="op" id="4343169">{</span><span class="num" id="4343170">1</span><span class="op" id="4343171">,</span>&nbsp;<span class="num" id="4343173">3</span><span class="op" id="4343174">,</span>&nbsp;<span class="num" id="4343176">132</span><span class="op" id="4343179">,</span>&nbsp;<span class="num" id="4343181">0</span><span class="op" id="4343182">,</span>&nbsp;<span class="num" id="4343184">34</span><span class="op" id="4343186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4343189">oidNamedCurveP521</span>&nbsp;<span class="op" id="4343207">=</span>&nbsp;<span class="ident" id="4343209">asn1</span><span class="op" id="4343213">.</span><span class="ident" id="4343214">ObjectIdentifier</span><span class="op" id="4343230">{</span><span class="num" id="4343231">1</span><span class="op" id="4343232">,</span>&nbsp;<span class="num" id="4343234">3</span><span class="op" id="4343235">,</span>&nbsp;<span class="num" id="4343237">132</span><span class="op" id="4343240">,</span>&nbsp;<span class="num" id="4343242">0</span><span class="op" id="4343243">,</span>&nbsp;<span class="num" id="4343245">35</span><span class="op" id="4343247">}</span><br>
<span class="lineno"></span><span class="op" id="4343249">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4343252">func</span>&nbsp;<span class="ident" id="4343257">namedCurveFromOID</span><span class="op" id="4343274">(</span><span class="ident" id="4343275">oid</span>&nbsp;<span class="ident" id="4343279">asn1</span><span class="op" id="4343283">.</span><span class="ident" id="4343284">ObjectIdentifier</span><span class="op" id="4343300">)</span>&nbsp;<span class="ident" id="4343302">elliptic</span><span class="op" id="4343310">.</span><span class="ident" id="4343311">Curve</span>&nbsp;<span class="op" id="4343317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343320">switch</span>&nbsp;<span class="op" id="4343327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343330">case</span>&nbsp;<span class="ident" id="4343335">oid</span><span class="op" id="4343338">.</span><span class="ident" id="4343339">Equal</span><span class="op" id="4343344">(</span><span class="ident" id="4343345">oidNamedCurveP224</span><span class="op" id="4343362">)</span><span class="op" id="4343363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343367">return</span>&nbsp;<span class="ident" id="4343374">elliptic</span><span class="op" id="4343382">.</span><span class="ident" id="4343383">P224</span><span class="op" id="4343387">(</span><span class="op" id="4343388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343391">case</span>&nbsp;<span class="ident" id="4343396">oid</span><span class="op" id="4343399">.</span><span class="ident" id="4343400">Equal</span><span class="op" id="4343405">(</span><span class="ident" id="4343406">oidNamedCurveP256</span><span class="op" id="4343423">)</span><span class="op" id="4343424">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343428">return</span>&nbsp;<span class="ident" id="4343435">elliptic</span><span class="op" id="4343443">.</span><span class="ident" id="4343444">P256</span><span class="op" id="4343448">(</span><span class="op" id="4343449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343452">case</span>&nbsp;<span class="ident" id="4343457">oid</span><span class="op" id="4343460">.</span><span class="ident" id="4343461">Equal</span><span class="op" id="4343466">(</span><span class="ident" id="4343467">oidNamedCurveP384</span><span class="op" id="4343484">)</span><span class="op" id="4343485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343489">return</span>&nbsp;<span class="ident" id="4343496">elliptic</span><span class="op" id="4343504">.</span><span class="ident" id="4343505">P384</span><span class="op" id="4343509">(</span><span class="op" id="4343510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343513">case</span>&nbsp;<span class="ident" id="4343518">oid</span><span class="op" id="4343521">.</span><span class="ident" id="4343522">Equal</span><span class="op" id="4343527">(</span><span class="ident" id="4343528">oidNamedCurveP521</span><span class="op" id="4343545">)</span><span class="op" id="4343546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343550">return</span>&nbsp;<span class="ident" id="4343557">elliptic</span><span class="op" id="4343565">.</span><span class="ident" id="4343566">P521</span><span class="op" id="4343570">(</span><span class="op" id="4343571">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343577">return</span>&nbsp;<span class="ident" id="4343584">nil</span><br>
<span class="lineno"></span><span class="op" id="4343588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4343591">func</span>&nbsp;<span class="ident" id="4343596">oidFromNamedCurve</span><span class="op" id="4343613">(</span><span class="ident" id="4343614">curve</span>&nbsp;<span class="ident" id="4343620">elliptic</span><span class="op" id="4343628">.</span><span class="ident" id="4343629">Curve</span><span class="op" id="4343634">)</span>&nbsp;<span class="op" id="4343636">(</span><span class="ident" id="4343637">asn1</span><span class="op" id="4343641">.</span><span class="ident" id="4343642">ObjectIdentifier</span><span class="op" id="4343658">,</span>&nbsp;<span class="builtintype" id="4343660">bool</span><span class="op" id="4343664">)</span>&nbsp;<span class="op" id="4343666">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343669">switch</span>&nbsp;<span class="ident" id="4343676">curve</span>&nbsp;<span class="op" id="4343682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343685">case</span>&nbsp;<span class="ident" id="4343690">elliptic</span><span class="op" id="4343698">.</span><span class="ident" id="4343699">P224</span><span class="op" id="4343703">(</span><span class="op" id="4343704">)</span><span class="op" id="4343705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343709">return</span>&nbsp;<span class="ident" id="4343716">oidNamedCurveP224</span><span class="op" id="4343733">,</span>&nbsp;<span class="builtintype" id="4343735">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343741">case</span>&nbsp;<span class="ident" id="4343746">elliptic</span><span class="op" id="4343754">.</span><span class="ident" id="4343755">P256</span><span class="op" id="4343759">(</span><span class="op" id="4343760">)</span><span class="op" id="4343761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343765">return</span>&nbsp;<span class="ident" id="4343772">oidNamedCurveP256</span><span class="op" id="4343789">,</span>&nbsp;<span class="builtintype" id="4343791">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343797">case</span>&nbsp;<span class="ident" id="4343802">elliptic</span><span class="op" id="4343810">.</span><span class="ident" id="4343811">P384</span><span class="op" id="4343815">(</span><span class="op" id="4343816">)</span><span class="op" id="4343817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343821">return</span>&nbsp;<span class="ident" id="4343828">oidNamedCurveP384</span><span class="op" id="4343845">,</span>&nbsp;<span class="builtintype" id="4343847">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343853">case</span>&nbsp;<span class="ident" id="4343858">elliptic</span><span class="op" id="4343866">.</span><span class="ident" id="4343867">P521</span><span class="op" id="4343871">(</span><span class="op" id="4343872">)</span><span class="op" id="4343873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343877">return</span>&nbsp;<span class="ident" id="4343884">oidNamedCurveP521</span><span class="op" id="4343901">,</span>&nbsp;<span class="builtintype" id="4343903">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4343909">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4343913">return</span>&nbsp;<span class="ident" id="4343920">nil</span><span class="op" id="4343923">,</span>&nbsp;<span class="builtintype" id="4343925">false</span><br>
<span class="lineno"></span><span class="op" id="4343931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4343934">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4344013">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4344053">type</span>&nbsp;<span class="ident" id="4344058">KeyUsage</span>&nbsp;<span class="builtintype" id="4344067">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4344072">const</span>&nbsp;<span class="op" id="4344078">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344081">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4344106">KeyUsage</span>&nbsp;<span class="op" id="4344115">=</span>&nbsp;<span class="num" id="4344117">1</span>&nbsp;<span class="op" id="4344119">&lt;&lt;</span>&nbsp;<span class="ident" id="4344122">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344128">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344155">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344180">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344206">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344228">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344246">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344263">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344285">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4344306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4344309">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4344351">//</span><br>
<span class="lineno"></span><span class="comment" id="4344354">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4344423">//</span><br>
<span class="lineno"></span><span class="comment" id="4344426">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4344471">//</span><br>
<span class="lineno"></span><span class="comment" id="4344474">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4344540">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4344606">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4344672">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4344738">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4344804">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4344870">var</span>&nbsp;<span class="op" id="4344874">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344877">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4344918">=</span>&nbsp;<span class="ident" id="4344920">asn1</span><span class="op" id="4344924">.</span><span class="ident" id="4344925">ObjectIdentifier</span><span class="op" id="4344941">{</span><span class="num" id="4344942">2</span><span class="op" id="4344943">,</span>&nbsp;<span class="num" id="4344945">5</span><span class="op" id="4344946">,</span>&nbsp;<span class="num" id="4344948">29</span><span class="op" id="4344950">,</span>&nbsp;<span class="num" id="4344952">37</span><span class="op" id="4344954">,</span>&nbsp;<span class="num" id="4344956">0</span><span class="op" id="4344957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4344960">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345001">=</span>&nbsp;<span class="ident" id="4345003">asn1</span><span class="op" id="4345007">.</span><span class="ident" id="4345008">ObjectIdentifier</span><span class="op" id="4345024">{</span><span class="num" id="4345025">1</span><span class="op" id="4345026">,</span>&nbsp;<span class="num" id="4345028">3</span><span class="op" id="4345029">,</span>&nbsp;<span class="num" id="4345031">6</span><span class="op" id="4345032">,</span>&nbsp;<span class="num" id="4345034">1</span><span class="op" id="4345035">,</span>&nbsp;<span class="num" id="4345037">5</span><span class="op" id="4345038">,</span>&nbsp;<span class="num" id="4345040">5</span><span class="op" id="4345041">,</span>&nbsp;<span class="num" id="4345043">7</span><span class="op" id="4345044">,</span>&nbsp;<span class="num" id="4345046">3</span><span class="op" id="4345047">,</span>&nbsp;<span class="num" id="4345049">1</span><span class="op" id="4345050">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345053">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345094">=</span>&nbsp;<span class="ident" id="4345096">asn1</span><span class="op" id="4345100">.</span><span class="ident" id="4345101">ObjectIdentifier</span><span class="op" id="4345117">{</span><span class="num" id="4345118">1</span><span class="op" id="4345119">,</span>&nbsp;<span class="num" id="4345121">3</span><span class="op" id="4345122">,</span>&nbsp;<span class="num" id="4345124">6</span><span class="op" id="4345125">,</span>&nbsp;<span class="num" id="4345127">1</span><span class="op" id="4345128">,</span>&nbsp;<span class="num" id="4345130">5</span><span class="op" id="4345131">,</span>&nbsp;<span class="num" id="4345133">5</span><span class="op" id="4345134">,</span>&nbsp;<span class="num" id="4345136">7</span><span class="op" id="4345137">,</span>&nbsp;<span class="num" id="4345139">3</span><span class="op" id="4345140">,</span>&nbsp;<span class="num" id="4345142">2</span><span class="op" id="4345143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345146">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345187">=</span>&nbsp;<span class="ident" id="4345189">asn1</span><span class="op" id="4345193">.</span><span class="ident" id="4345194">ObjectIdentifier</span><span class="op" id="4345210">{</span><span class="num" id="4345211">1</span><span class="op" id="4345212">,</span>&nbsp;<span class="num" id="4345214">3</span><span class="op" id="4345215">,</span>&nbsp;<span class="num" id="4345217">6</span><span class="op" id="4345218">,</span>&nbsp;<span class="num" id="4345220">1</span><span class="op" id="4345221">,</span>&nbsp;<span class="num" id="4345223">5</span><span class="op" id="4345224">,</span>&nbsp;<span class="num" id="4345226">5</span><span class="op" id="4345227">,</span>&nbsp;<span class="num" id="4345229">7</span><span class="op" id="4345230">,</span>&nbsp;<span class="num" id="4345232">3</span><span class="op" id="4345233">,</span>&nbsp;<span class="num" id="4345235">3</span><span class="op" id="4345236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345239">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345280">=</span>&nbsp;<span class="ident" id="4345282">asn1</span><span class="op" id="4345286">.</span><span class="ident" id="4345287">ObjectIdentifier</span><span class="op" id="4345303">{</span><span class="num" id="4345304">1</span><span class="op" id="4345305">,</span>&nbsp;<span class="num" id="4345307">3</span><span class="op" id="4345308">,</span>&nbsp;<span class="num" id="4345310">6</span><span class="op" id="4345311">,</span>&nbsp;<span class="num" id="4345313">1</span><span class="op" id="4345314">,</span>&nbsp;<span class="num" id="4345316">5</span><span class="op" id="4345317">,</span>&nbsp;<span class="num" id="4345319">5</span><span class="op" id="4345320">,</span>&nbsp;<span class="num" id="4345322">7</span><span class="op" id="4345323">,</span>&nbsp;<span class="num" id="4345325">3</span><span class="op" id="4345326">,</span>&nbsp;<span class="num" id="4345328">4</span><span class="op" id="4345329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345332">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345373">=</span>&nbsp;<span class="ident" id="4345375">asn1</span><span class="op" id="4345379">.</span><span class="ident" id="4345380">ObjectIdentifier</span><span class="op" id="4345396">{</span><span class="num" id="4345397">1</span><span class="op" id="4345398">,</span>&nbsp;<span class="num" id="4345400">3</span><span class="op" id="4345401">,</span>&nbsp;<span class="num" id="4345403">6</span><span class="op" id="4345404">,</span>&nbsp;<span class="num" id="4345406">1</span><span class="op" id="4345407">,</span>&nbsp;<span class="num" id="4345409">5</span><span class="op" id="4345410">,</span>&nbsp;<span class="num" id="4345412">5</span><span class="op" id="4345413">,</span>&nbsp;<span class="num" id="4345415">7</span><span class="op" id="4345416">,</span>&nbsp;<span class="num" id="4345418">3</span><span class="op" id="4345419">,</span>&nbsp;<span class="num" id="4345421">5</span><span class="op" id="4345422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345425">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345466">=</span>&nbsp;<span class="ident" id="4345468">asn1</span><span class="op" id="4345472">.</span><span class="ident" id="4345473">ObjectIdentifier</span><span class="op" id="4345489">{</span><span class="num" id="4345490">1</span><span class="op" id="4345491">,</span>&nbsp;<span class="num" id="4345493">3</span><span class="op" id="4345494">,</span>&nbsp;<span class="num" id="4345496">6</span><span class="op" id="4345497">,</span>&nbsp;<span class="num" id="4345499">1</span><span class="op" id="4345500">,</span>&nbsp;<span class="num" id="4345502">5</span><span class="op" id="4345503">,</span>&nbsp;<span class="num" id="4345505">5</span><span class="op" id="4345506">,</span>&nbsp;<span class="num" id="4345508">7</span><span class="op" id="4345509">,</span>&nbsp;<span class="num" id="4345511">3</span><span class="op" id="4345512">,</span>&nbsp;<span class="num" id="4345514">6</span><span class="op" id="4345515">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345518">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345559">=</span>&nbsp;<span class="ident" id="4345561">asn1</span><span class="op" id="4345565">.</span><span class="ident" id="4345566">ObjectIdentifier</span><span class="op" id="4345582">{</span><span class="num" id="4345583">1</span><span class="op" id="4345584">,</span>&nbsp;<span class="num" id="4345586">3</span><span class="op" id="4345587">,</span>&nbsp;<span class="num" id="4345589">6</span><span class="op" id="4345590">,</span>&nbsp;<span class="num" id="4345592">1</span><span class="op" id="4345593">,</span>&nbsp;<span class="num" id="4345595">5</span><span class="op" id="4345596">,</span>&nbsp;<span class="num" id="4345598">5</span><span class="op" id="4345599">,</span>&nbsp;<span class="num" id="4345601">7</span><span class="op" id="4345602">,</span>&nbsp;<span class="num" id="4345604">3</span><span class="op" id="4345605">,</span>&nbsp;<span class="num" id="4345607">7</span><span class="op" id="4345608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345611">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345652">=</span>&nbsp;<span class="ident" id="4345654">asn1</span><span class="op" id="4345658">.</span><span class="ident" id="4345659">ObjectIdentifier</span><span class="op" id="4345675">{</span><span class="num" id="4345676">1</span><span class="op" id="4345677">,</span>&nbsp;<span class="num" id="4345679">3</span><span class="op" id="4345680">,</span>&nbsp;<span class="num" id="4345682">6</span><span class="op" id="4345683">,</span>&nbsp;<span class="num" id="4345685">1</span><span class="op" id="4345686">,</span>&nbsp;<span class="num" id="4345688">5</span><span class="op" id="4345689">,</span>&nbsp;<span class="num" id="4345691">5</span><span class="op" id="4345692">,</span>&nbsp;<span class="num" id="4345694">7</span><span class="op" id="4345695">,</span>&nbsp;<span class="num" id="4345697">3</span><span class="op" id="4345698">,</span>&nbsp;<span class="num" id="4345700">8</span><span class="op" id="4345701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345704">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4345745">=</span>&nbsp;<span class="ident" id="4345747">asn1</span><span class="op" id="4345751">.</span><span class="ident" id="4345752">ObjectIdentifier</span><span class="op" id="4345768">{</span><span class="num" id="4345769">1</span><span class="op" id="4345770">,</span>&nbsp;<span class="num" id="4345772">3</span><span class="op" id="4345773">,</span>&nbsp;<span class="num" id="4345775">6</span><span class="op" id="4345776">,</span>&nbsp;<span class="num" id="4345778">1</span><span class="op" id="4345779">,</span>&nbsp;<span class="num" id="4345781">5</span><span class="op" id="4345782">,</span>&nbsp;<span class="num" id="4345784">5</span><span class="op" id="4345785">,</span>&nbsp;<span class="num" id="4345787">7</span><span class="op" id="4345788">,</span>&nbsp;<span class="num" id="4345790">3</span><span class="op" id="4345791">,</span>&nbsp;<span class="num" id="4345793">9</span><span class="op" id="4345794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345797">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4345838">=</span>&nbsp;<span class="ident" id="4345840">asn1</span><span class="op" id="4345844">.</span><span class="ident" id="4345845">ObjectIdentifier</span><span class="op" id="4345861">{</span><span class="num" id="4345862">1</span><span class="op" id="4345863">,</span>&nbsp;<span class="num" id="4345865">3</span><span class="op" id="4345866">,</span>&nbsp;<span class="num" id="4345868">6</span><span class="op" id="4345869">,</span>&nbsp;<span class="num" id="4345871">1</span><span class="op" id="4345872">,</span>&nbsp;<span class="num" id="4345874">4</span><span class="op" id="4345875">,</span>&nbsp;<span class="num" id="4345877">1</span><span class="op" id="4345878">,</span>&nbsp;<span class="num" id="4345880">311</span><span class="op" id="4345883">,</span>&nbsp;<span class="num" id="4345885">10</span><span class="op" id="4345887">,</span>&nbsp;<span class="num" id="4345889">3</span><span class="op" id="4345890">,</span>&nbsp;<span class="num" id="4345892">3</span><span class="op" id="4345893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4345896">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4345937">=</span>&nbsp;<span class="ident" id="4345939">asn1</span><span class="op" id="4345943">.</span><span class="ident" id="4345944">ObjectIdentifier</span><span class="op" id="4345960">{</span><span class="num" id="4345961">2</span><span class="op" id="4345962">,</span>&nbsp;<span class="num" id="4345964">16</span><span class="op" id="4345966">,</span>&nbsp;<span class="num" id="4345968">840</span><span class="op" id="4345971">,</span>&nbsp;<span class="num" id="4345973">1</span><span class="op" id="4345974">,</span>&nbsp;<span class="num" id="4345976">113730</span><span class="op" id="4345982">,</span>&nbsp;<span class="num" id="4345984">4</span><span class="op" id="4345985">,</span>&nbsp;<span class="num" id="4345987">1</span><span class="op" id="4345988">}</span><br>
<span class="lineno">400</span><span class="op" id="4345990">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4345993">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4346078">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4346140">type</span>&nbsp;<span class="ident" id="4346145">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4346157">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4346162">const</span>&nbsp;<span class="op" id="4346168">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346171">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4346186">ExtKeyUsage</span>&nbsp;<span class="op" id="4346198">=</span>&nbsp;<span class="ident" id="4346200">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346206">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346229">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346252">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346276">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346304">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346331">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346355">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346377">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346402">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346426">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346465">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4346502">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4346505">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4346581">var</span>&nbsp;<span class="ident" id="4346585">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4346601">=</span>&nbsp;<span class="op" id="4346603">[</span><span class="op" id="4346604">]</span><span class="keyword" id="4346605">struct</span>&nbsp;<span class="op" id="4346612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346615">extKeyUsage</span>&nbsp;<span class="ident" id="4346627">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4346640">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4346652">asn1</span><span class="op" id="4346656">.</span><span class="ident" id="4346657">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4346674">}</span><span class="op" id="4346675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346678">{</span><span class="ident" id="4346679">ExtKeyUsageAny</span><span class="op" id="4346693">,</span>&nbsp;<span class="ident" id="4346695">oidExtKeyUsageAny</span><span class="op" id="4346712">}</span><span class="op" id="4346713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346716">{</span><span class="ident" id="4346717">ExtKeyUsageServerAuth</span><span class="op" id="4346738">,</span>&nbsp;<span class="ident" id="4346740">oidExtKeyUsageServerAuth</span><span class="op" id="4346764">}</span><span class="op" id="4346765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346768">{</span><span class="ident" id="4346769">ExtKeyUsageClientAuth</span><span class="op" id="4346790">,</span>&nbsp;<span class="ident" id="4346792">oidExtKeyUsageClientAuth</span><span class="op" id="4346816">}</span><span class="op" id="4346817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346820">{</span><span class="ident" id="4346821">ExtKeyUsageCodeSigning</span><span class="op" id="4346843">,</span>&nbsp;<span class="ident" id="4346845">oidExtKeyUsageCodeSigning</span><span class="op" id="4346870">}</span><span class="op" id="4346871">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346874">{</span><span class="ident" id="4346875">ExtKeyUsageEmailProtection</span><span class="op" id="4346901">,</span>&nbsp;<span class="ident" id="4346903">oidExtKeyUsageEmailProtection</span><span class="op" id="4346932">}</span><span class="op" id="4346933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346936">{</span><span class="ident" id="4346937">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4346962">,</span>&nbsp;<span class="ident" id="4346964">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4346992">}</span><span class="op" id="4346993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4346996">{</span><span class="ident" id="4346997">ExtKeyUsageIPSECTunnel</span><span class="op" id="4347019">,</span>&nbsp;<span class="ident" id="4347021">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4347046">}</span><span class="op" id="4347047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347050">{</span><span class="ident" id="4347051">ExtKeyUsageIPSECUser</span><span class="op" id="4347071">,</span>&nbsp;<span class="ident" id="4347073">oidExtKeyUsageIPSECUser</span><span class="op" id="4347096">}</span><span class="op" id="4347097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347100">{</span><span class="ident" id="4347101">ExtKeyUsageTimeStamping</span><span class="op" id="4347124">,</span>&nbsp;<span class="ident" id="4347126">oidExtKeyUsageTimeStamping</span><span class="op" id="4347152">}</span><span class="op" id="4347153">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347156">{</span><span class="ident" id="4347157">ExtKeyUsageOCSPSigning</span><span class="op" id="4347179">,</span>&nbsp;<span class="ident" id="4347181">oidExtKeyUsageOCSPSigning</span><span class="op" id="4347206">}</span><span class="op" id="4347207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347210">{</span><span class="ident" id="4347211">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4347248">,</span>&nbsp;<span class="ident" id="4347250">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4347290">}</span><span class="op" id="4347291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347294">{</span><span class="ident" id="4347295">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4347331">,</span>&nbsp;<span class="ident" id="4347333">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4347372">}</span><span class="op" id="4347373">,</span><br>
<span class="lineno"></span><span class="op" id="4347375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4347378">func</span>&nbsp;<span class="ident" id="4347383">extKeyUsageFromOID</span><span class="op" id="4347401">(</span><span class="ident" id="4347402">oid</span>&nbsp;<span class="ident" id="4347406">asn1</span><span class="op" id="4347410">.</span><span class="ident" id="4347411">ObjectIdentifier</span><span class="op" id="4347427">)</span>&nbsp;<span class="op" id="4347429">(</span><span class="ident" id="4347430">eku</span>&nbsp;<span class="ident" id="4347434">ExtKeyUsage</span><span class="op" id="4347445">,</span>&nbsp;<span class="ident" id="4347447">ok</span>&nbsp;<span class="builtintype" id="4347450">bool</span><span class="op" id="4347454">)</span>&nbsp;<span class="op" id="4347456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347459">for</span>&nbsp;<span class="ident" id="4347463">_</span><span class="op" id="4347464">,</span>&nbsp;<span class="ident" id="4347466">pair</span>&nbsp;<span class="op" id="4347471">:=</span>&nbsp;<span class="keyword" id="4347474">range</span>&nbsp;<span class="ident" id="4347480">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4347496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347500">if</span>&nbsp;<span class="ident" id="4347503">oid</span><span class="op" id="4347506">.</span><span class="ident" id="4347507">Equal</span><span class="op" id="4347512">(</span><span class="ident" id="4347513">pair</span><span class="op" id="4347517">.</span><span class="ident" id="4347518">oid</span><span class="op" id="4347521">)</span>&nbsp;<span class="op" id="4347523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347528">return</span>&nbsp;<span class="ident" id="4347535">pair</span><span class="op" id="4347539">.</span><span class="ident" id="4347540">extKeyUsage</span><span class="op" id="4347551">,</span>&nbsp;<span class="builtintype" id="4347553">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347560">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347566">return</span><br>
<span class="lineno"></span><span class="op" id="4347573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4347576">func</span>&nbsp;<span class="ident" id="4347581">oidFromExtKeyUsage</span><span class="op" id="4347599">(</span><span class="ident" id="4347600">eku</span>&nbsp;<span class="ident" id="4347604">ExtKeyUsage</span><span class="op" id="4347615">)</span>&nbsp;<span class="op" id="4347617">(</span><span class="ident" id="4347618">oid</span>&nbsp;<span class="ident" id="4347622">asn1</span><span class="op" id="4347626">.</span><span class="ident" id="4347627">ObjectIdentifier</span><span class="op" id="4347643">,</span>&nbsp;<span class="ident" id="4347645">ok</span>&nbsp;<span class="builtintype" id="4347648">bool</span><span class="op" id="4347652">)</span>&nbsp;<span class="op" id="4347654">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347657">for</span>&nbsp;<span class="ident" id="4347661">_</span><span class="op" id="4347662">,</span>&nbsp;<span class="ident" id="4347664">pair</span>&nbsp;<span class="op" id="4347669">:=</span>&nbsp;<span class="keyword" id="4347672">range</span>&nbsp;<span class="ident" id="4347678">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4347694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347698">if</span>&nbsp;<span class="ident" id="4347701">eku</span>&nbsp;<span class="op" id="4347705">==</span>&nbsp;<span class="ident" id="4347708">pair</span><span class="op" id="4347712">.</span><span class="ident" id="4347713">extKeyUsage</span>&nbsp;<span class="op" id="4347725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347730">return</span>&nbsp;<span class="ident" id="4347737">pair</span><span class="op" id="4347741">.</span><span class="ident" id="4347742">oid</span><span class="op" id="4347745">,</span>&nbsp;<span class="builtintype" id="4347747">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4347757">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4347760">return</span><br>
<span class="lineno"></span><span class="op" id="4347767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4347770">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4347820">type</span>&nbsp;<span class="ident" id="4347825">Certificate</span>&nbsp;<span class="keyword" id="4347837">struct</span>&nbsp;<span class="op" id="4347844">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347847">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347871">[</span><span class="op" id="4347872">]</span><span class="builtintype" id="4347873">byte</span>&nbsp;<span class="comment" id="4347878">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4347959">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347983">[</span><span class="op" id="4347984">]</span><span class="builtintype" id="4347985">byte</span>&nbsp;<span class="comment" id="4347990">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348037">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4348061">[</span><span class="op" id="4348062">]</span><span class="builtintype" id="4348063">byte</span>&nbsp;<span class="comment" id="4348068">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348106">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348130">[</span><span class="op" id="4348131">]</span><span class="builtintype" id="4348132">byte</span>&nbsp;<span class="comment" id="4348137">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348161">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348185">[</span><span class="op" id="4348186">]</span><span class="builtintype" id="4348187">byte</span>&nbsp;<span class="comment" id="4348192">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348216">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348235">[</span><span class="op" id="4348236">]</span><span class="builtintype" id="4348237">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348243">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4348262">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348283">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4348302">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348322">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348341">interface</span><span class="op" id="4348350">{</span><span class="op" id="4348351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348355">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4348375">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348380">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348400">*</span><span class="ident" id="4348401">big</span><span class="op" id="4348404">.</span><span class="ident" id="4348405">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348410">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348430">pkix</span><span class="op" id="4348434">.</span><span class="ident" id="4348435">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348441">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348461">pkix</span><span class="op" id="4348465">.</span><span class="ident" id="4348466">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348472">NotBefore</span><span class="op" id="4348481">,</span>&nbsp;<span class="ident" id="4348483">NotAfter</span>&nbsp;<span class="ident" id="4348492">time</span><span class="op" id="4348496">.</span><span class="ident" id="4348497">Time</span>&nbsp;<span class="comment" id="4348502">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348523">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348543">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348554">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348627">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348696">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348769">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4348812">Extensions</span>&nbsp;<span class="op" id="4348823">[</span><span class="op" id="4348824">]</span><span class="ident" id="4348825">pkix</span><span class="op" id="4348829">.</span><span class="ident" id="4348830">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348842">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348910">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4348980">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349053">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349123">ExtraExtensions</span>&nbsp;<span class="op" id="4349139">[</span><span class="op" id="4349140">]</span><span class="ident" id="4349141">pkix</span><span class="op" id="4349145">.</span><span class="ident" id="4349146">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349158">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349177">[</span><span class="op" id="4349178">]</span><span class="ident" id="4349179">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4349201">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349238">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4349257">[</span><span class="op" id="4349258">]</span><span class="ident" id="4349259">asn1</span><span class="op" id="4349263">.</span><span class="ident" id="4349264">ObjectIdentifier</span>&nbsp;<span class="comment" id="4349281">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349343">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4349365">bool</span>&nbsp;<span class="comment" id="4349370">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349418">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4349440">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349446">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4349468">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349473">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349539">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349612">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349682">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349701">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4349716">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349723">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4349738">[</span><span class="op" id="4349739">]</span><span class="builtintype" id="4349740">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349746">AuthorityKeyId</span>&nbsp;<span class="op" id="4349761">[</span><span class="op" id="4349762">]</span><span class="builtintype" id="4349763">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349770">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349823">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349845">[</span><span class="op" id="4349846">]</span><span class="builtintype" id="4349847">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349855">IssuingCertificateURL</span>&nbsp;<span class="op" id="4349877">[</span><span class="op" id="4349878">]</span><span class="builtintype" id="4349879">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349888">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349922">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349937">[</span><span class="op" id="4349938">]</span><span class="builtintype" id="4349939">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349947">EmailAddresses</span>&nbsp;<span class="op" id="4349962">[</span><span class="op" id="4349963">]</span><span class="builtintype" id="4349964">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4349972">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349987">[</span><span class="op" id="4349988">]</span><span class="ident" id="4349989">net</span><span class="op" id="4349992">.</span><span class="ident" id="4349993">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4349998">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350019">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4350047">bool</span>&nbsp;<span class="comment" id="4350052">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350111">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4350139">[</span><span class="op" id="4350140">]</span><span class="builtintype" id="4350141">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4350150">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350178">CRLDistributionPoints</span>&nbsp;<span class="op" id="4350200">[</span><span class="op" id="4350201">]</span><span class="builtintype" id="4350202">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4350211">PolicyIdentifiers</span>&nbsp;<span class="op" id="4350229">[</span><span class="op" id="4350230">]</span><span class="ident" id="4350231">asn1</span><span class="op" id="4350235">.</span><span class="ident" id="4350236">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4350253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4350256">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4350336">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4350395">var</span>&nbsp;<span class="ident" id="4350399">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4350423">=</span>&nbsp;<span class="ident" id="4350425">errors</span><span class="op" id="4350431">.</span><span class="ident" id="4350432">New</span><span class="op" id="4350435">(</span><span class="string" id="4350436">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4350492">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4350495">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4350574">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4350654">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4350682">type</span>&nbsp;<span class="ident" id="4350687">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4350712">struct</span><span class="op" id="4350718">{</span><span class="op" id="4350719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4350722">func</span>&nbsp;<span class="op" id="4350727">(</span><span class="ident" id="4350728">ConstraintViolationError</span><span class="op" id="4350752">)</span>&nbsp;<span class="ident" id="4350754">Error</span><span class="op" id="4350759">(</span><span class="op" id="4350760">)</span>&nbsp;<span class="builtintype" id="4350762">string</span>&nbsp;<span class="op" id="4350769">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350772">return</span>&nbsp;<span class="string" id="4350779">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4350862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4350865">func</span>&nbsp;<span class="op" id="4350870">(</span><span class="ident" id="4350871">c</span>&nbsp;<span class="op" id="4350873">*</span><span class="ident" id="4350874">Certificate</span><span class="op" id="4350885">)</span>&nbsp;<span class="ident" id="4350887">Equal</span><span class="op" id="4350892">(</span><span class="ident" id="4350893">other</span>&nbsp;<span class="op" id="4350899">*</span><span class="ident" id="4350900">Certificate</span><span class="op" id="4350911">)</span>&nbsp;<span class="builtintype" id="4350913">bool</span>&nbsp;<span class="op" id="4350918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4350921">return</span>&nbsp;<span class="ident" id="4350928">bytes</span><span class="op" id="4350933">.</span><span class="ident" id="4350934">Equal</span><span class="op" id="4350939">(</span><span class="ident" id="4350940">c</span><span class="op" id="4350941">.</span><span class="ident" id="4350942">Raw</span><span class="op" id="4350945">,</span>&nbsp;<span class="ident" id="4350947">other</span><span class="op" id="4350952">.</span><span class="ident" id="4350953">Raw</span><span class="op" id="4350956">)</span><br>
<span class="lineno">540</span><span class="op" id="4350958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4350961">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4351033">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4351113">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4351135">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4351210">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4351253">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4351319">//</span><br>
<span class="lineno"></span><span class="comment" id="4351322">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4351394">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4351409">var</span>&nbsp;<span class="ident" id="4351413">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4351431">=</span>&nbsp;<span class="op" id="4351433">[</span><span class="op" id="4351434">]</span><span class="builtintype" id="4351435">byte</span><span class="op" id="4351439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351442">0x30</span><span class="op" id="4351446">,</span>&nbsp;<span class="num" id="4351448">0x82</span><span class="op" id="4351452">,</span>&nbsp;<span class="num" id="4351454">0x01</span><span class="op" id="4351458">,</span>&nbsp;<span class="num" id="4351460">0x22</span><span class="op" id="4351464">,</span>&nbsp;<span class="num" id="4351466">0x30</span><span class="op" id="4351470">,</span>&nbsp;<span class="num" id="4351472">0x0d</span><span class="op" id="4351476">,</span>&nbsp;<span class="num" id="4351478">0x06</span><span class="op" id="4351482">,</span>&nbsp;<span class="num" id="4351484">0x09</span><span class="op" id="4351488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351491">0x2a</span><span class="op" id="4351495">,</span>&nbsp;<span class="num" id="4351497">0x86</span><span class="op" id="4351501">,</span>&nbsp;<span class="num" id="4351503">0x48</span><span class="op" id="4351507">,</span>&nbsp;<span class="num" id="4351509">0x86</span><span class="op" id="4351513">,</span>&nbsp;<span class="num" id="4351515">0xf7</span><span class="op" id="4351519">,</span>&nbsp;<span class="num" id="4351521">0x0d</span><span class="op" id="4351525">,</span>&nbsp;<span class="num" id="4351527">0x01</span><span class="op" id="4351531">,</span>&nbsp;<span class="num" id="4351533">0x01</span><span class="op" id="4351537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351540">0x01</span><span class="op" id="4351544">,</span>&nbsp;<span class="num" id="4351546">0x05</span><span class="op" id="4351550">,</span>&nbsp;<span class="num" id="4351552">0x00</span><span class="op" id="4351556">,</span>&nbsp;<span class="num" id="4351558">0x03</span><span class="op" id="4351562">,</span>&nbsp;<span class="num" id="4351564">0x82</span><span class="op" id="4351568">,</span>&nbsp;<span class="num" id="4351570">0x01</span><span class="op" id="4351574">,</span>&nbsp;<span class="num" id="4351576">0x0f</span><span class="op" id="4351580">,</span>&nbsp;<span class="num" id="4351582">0x00</span><span class="op" id="4351586">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351589">0x30</span><span class="op" id="4351593">,</span>&nbsp;<span class="num" id="4351595">0x82</span><span class="op" id="4351599">,</span>&nbsp;<span class="num" id="4351601">0x01</span><span class="op" id="4351605">,</span>&nbsp;<span class="num" id="4351607">0x0a</span><span class="op" id="4351611">,</span>&nbsp;<span class="num" id="4351613">0x02</span><span class="op" id="4351617">,</span>&nbsp;<span class="num" id="4351619">0x82</span><span class="op" id="4351623">,</span>&nbsp;<span class="num" id="4351625">0x01</span><span class="op" id="4351629">,</span>&nbsp;<span class="num" id="4351631">0x01</span><span class="op" id="4351635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351638">0x00</span><span class="op" id="4351642">,</span>&nbsp;<span class="num" id="4351644">0x97</span><span class="op" id="4351648">,</span>&nbsp;<span class="num" id="4351650">0xa3</span><span class="op" id="4351654">,</span>&nbsp;<span class="num" id="4351656">0x2d</span><span class="op" id="4351660">,</span>&nbsp;<span class="num" id="4351662">0x3c</span><span class="op" id="4351666">,</span>&nbsp;<span class="num" id="4351668">0x9e</span><span class="op" id="4351672">,</span>&nbsp;<span class="num" id="4351674">0xde</span><span class="op" id="4351678">,</span>&nbsp;<span class="num" id="4351680">0x05</span><span class="op" id="4351684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351687">0xda</span><span class="op" id="4351691">,</span>&nbsp;<span class="num" id="4351693">0x13</span><span class="op" id="4351697">,</span>&nbsp;<span class="num" id="4351699">0xc2</span><span class="op" id="4351703">,</span>&nbsp;<span class="num" id="4351705">0x11</span><span class="op" id="4351709">,</span>&nbsp;<span class="num" id="4351711">0x8d</span><span class="op" id="4351715">,</span>&nbsp;<span class="num" id="4351717">0x9d</span><span class="op" id="4351721">,</span>&nbsp;<span class="num" id="4351723">0x8e</span><span class="op" id="4351727">,</span>&nbsp;<span class="num" id="4351729">0xe3</span><span class="op" id="4351733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351736">0x7f</span><span class="op" id="4351740">,</span>&nbsp;<span class="num" id="4351742">0xc7</span><span class="op" id="4351746">,</span>&nbsp;<span class="num" id="4351748">0x4b</span><span class="op" id="4351752">,</span>&nbsp;<span class="num" id="4351754">0x7e</span><span class="op" id="4351758">,</span>&nbsp;<span class="num" id="4351760">0x5a</span><span class="op" id="4351764">,</span>&nbsp;<span class="num" id="4351766">0x9f</span><span class="op" id="4351770">,</span>&nbsp;<span class="num" id="4351772">0xb3</span><span class="op" id="4351776">,</span>&nbsp;<span class="num" id="4351778">0xff</span><span class="op" id="4351782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351785">0x62</span><span class="op" id="4351789">,</span>&nbsp;<span class="num" id="4351791">0xab</span><span class="op" id="4351795">,</span>&nbsp;<span class="num" id="4351797">0x73</span><span class="op" id="4351801">,</span>&nbsp;<span class="num" id="4351803">0xc8</span><span class="op" id="4351807">,</span>&nbsp;<span class="num" id="4351809">0x28</span><span class="op" id="4351813">,</span>&nbsp;<span class="num" id="4351815">0x6b</span><span class="op" id="4351819">,</span>&nbsp;<span class="num" id="4351821">0xba</span><span class="op" id="4351825">,</span>&nbsp;<span class="num" id="4351827">0x10</span><span class="op" id="4351831">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351834">0x64</span><span class="op" id="4351838">,</span>&nbsp;<span class="num" id="4351840">0x82</span><span class="op" id="4351844">,</span>&nbsp;<span class="num" id="4351846">0x87</span><span class="op" id="4351850">,</span>&nbsp;<span class="num" id="4351852">0x13</span><span class="op" id="4351856">,</span>&nbsp;<span class="num" id="4351858">0xcd</span><span class="op" id="4351862">,</span>&nbsp;<span class="num" id="4351864">0x57</span><span class="op" id="4351868">,</span>&nbsp;<span class="num" id="4351870">0x18</span><span class="op" id="4351874">,</span>&nbsp;<span class="num" id="4351876">0xff</span><span class="op" id="4351880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351883">0x28</span><span class="op" id="4351887">,</span>&nbsp;<span class="num" id="4351889">0xce</span><span class="op" id="4351893">,</span>&nbsp;<span class="num" id="4351895">0xc0</span><span class="op" id="4351899">,</span>&nbsp;<span class="num" id="4351901">0xe6</span><span class="op" id="4351905">,</span>&nbsp;<span class="num" id="4351907">0x0e</span><span class="op" id="4351911">,</span>&nbsp;<span class="num" id="4351913">0x06</span><span class="op" id="4351917">,</span>&nbsp;<span class="num" id="4351919">0x91</span><span class="op" id="4351923">,</span>&nbsp;<span class="num" id="4351925">0x50</span><span class="op" id="4351929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351932">0x29</span><span class="op" id="4351936">,</span>&nbsp;<span class="num" id="4351938">0x83</span><span class="op" id="4351942">,</span>&nbsp;<span class="num" id="4351944">0xd1</span><span class="op" id="4351948">,</span>&nbsp;<span class="num" id="4351950">0xf2</span><span class="op" id="4351954">,</span>&nbsp;<span class="num" id="4351956">0xc3</span><span class="op" id="4351960">,</span>&nbsp;<span class="num" id="4351962">0x2a</span><span class="op" id="4351966">,</span>&nbsp;<span class="num" id="4351968">0xdb</span><span class="op" id="4351972">,</span>&nbsp;<span class="num" id="4351974">0xd8</span><span class="op" id="4351978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4351981">0xdb</span><span class="op" id="4351985">,</span>&nbsp;<span class="num" id="4351987">0x4e</span><span class="op" id="4351991">,</span>&nbsp;<span class="num" id="4351993">0x04</span><span class="op" id="4351997">,</span>&nbsp;<span class="num" id="4351999">0xcc</span><span class="op" id="4352003">,</span>&nbsp;<span class="num" id="4352005">0x00</span><span class="op" id="4352009">,</span>&nbsp;<span class="num" id="4352011">0xeb</span><span class="op" id="4352015">,</span>&nbsp;<span class="num" id="4352017">0x8b</span><span class="op" id="4352021">,</span>&nbsp;<span class="num" id="4352023">0xb6</span><span class="op" id="4352027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352030">0x96</span><span class="op" id="4352034">,</span>&nbsp;<span class="num" id="4352036">0xdc</span><span class="op" id="4352040">,</span>&nbsp;<span class="num" id="4352042">0xbc</span><span class="op" id="4352046">,</span>&nbsp;<span class="num" id="4352048">0xaa</span><span class="op" id="4352052">,</span>&nbsp;<span class="num" id="4352054">0xfa</span><span class="op" id="4352058">,</span>&nbsp;<span class="num" id="4352060">0x52</span><span class="op" id="4352064">,</span>&nbsp;<span class="num" id="4352066">0x77</span><span class="op" id="4352070">,</span>&nbsp;<span class="num" id="4352072">0x04</span><span class="op" id="4352076">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352079">0xc1</span><span class="op" id="4352083">,</span>&nbsp;<span class="num" id="4352085">0xdb</span><span class="op" id="4352089">,</span>&nbsp;<span class="num" id="4352091">0x19</span><span class="op" id="4352095">,</span>&nbsp;<span class="num" id="4352097">0xe4</span><span class="op" id="4352101">,</span>&nbsp;<span class="num" id="4352103">0xae</span><span class="op" id="4352107">,</span>&nbsp;<span class="num" id="4352109">0x9c</span><span class="op" id="4352113">,</span>&nbsp;<span class="num" id="4352115">0xfd</span><span class="op" id="4352119">,</span>&nbsp;<span class="num" id="4352121">0x3c</span><span class="op" id="4352125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352128">0x8b</span><span class="op" id="4352132">,</span>&nbsp;<span class="num" id="4352134">0x03</span><span class="op" id="4352138">,</span>&nbsp;<span class="num" id="4352140">0xef</span><span class="op" id="4352144">,</span>&nbsp;<span class="num" id="4352146">0x4d</span><span class="op" id="4352150">,</span>&nbsp;<span class="num" id="4352152">0xbc</span><span class="op" id="4352156">,</span>&nbsp;<span class="num" id="4352158">0x1a</span><span class="op" id="4352162">,</span>&nbsp;<span class="num" id="4352164">0x03</span><span class="op" id="4352168">,</span>&nbsp;<span class="num" id="4352170">0x65</span><span class="op" id="4352174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352177">0xf9</span><span class="op" id="4352181">,</span>&nbsp;<span class="num" id="4352183">0xc1</span><span class="op" id="4352187">,</span>&nbsp;<span class="num" id="4352189">0xb1</span><span class="op" id="4352193">,</span>&nbsp;<span class="num" id="4352195">0x3f</span><span class="op" id="4352199">,</span>&nbsp;<span class="num" id="4352201">0x72</span><span class="op" id="4352205">,</span>&nbsp;<span class="num" id="4352207">0x86</span><span class="op" id="4352211">,</span>&nbsp;<span class="num" id="4352213">0xf2</span><span class="op" id="4352217">,</span>&nbsp;<span class="num" id="4352219">0x38</span><span class="op" id="4352223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352226">0xaa</span><span class="op" id="4352230">,</span>&nbsp;<span class="num" id="4352232">0x19</span><span class="op" id="4352236">,</span>&nbsp;<span class="num" id="4352238">0xae</span><span class="op" id="4352242">,</span>&nbsp;<span class="num" id="4352244">0x10</span><span class="op" id="4352248">,</span>&nbsp;<span class="num" id="4352250">0x88</span><span class="op" id="4352254">,</span>&nbsp;<span class="num" id="4352256">0x78</span><span class="op" id="4352260">,</span>&nbsp;<span class="num" id="4352262">0x28</span><span class="op" id="4352266">,</span>&nbsp;<span class="num" id="4352268">0xda</span><span class="op" id="4352272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352275">0x75</span><span class="op" id="4352279">,</span>&nbsp;<span class="num" id="4352281">0xc3</span><span class="op" id="4352285">,</span>&nbsp;<span class="num" id="4352287">0x3d</span><span class="op" id="4352291">,</span>&nbsp;<span class="num" id="4352293">0x02</span><span class="op" id="4352297">,</span>&nbsp;<span class="num" id="4352299">0x82</span><span class="op" id="4352303">,</span>&nbsp;<span class="num" id="4352305">0x02</span><span class="op" id="4352309">,</span>&nbsp;<span class="num" id="4352311">0x9c</span><span class="op" id="4352315">,</span>&nbsp;<span class="num" id="4352317">0xb9</span><span class="op" id="4352321">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352324">0xc1</span><span class="op" id="4352328">,</span>&nbsp;<span class="num" id="4352330">0x65</span><span class="op" id="4352334">,</span>&nbsp;<span class="num" id="4352336">0x77</span><span class="op" id="4352340">,</span>&nbsp;<span class="num" id="4352342">0x76</span><span class="op" id="4352346">,</span>&nbsp;<span class="num" id="4352348">0x24</span><span class="op" id="4352352">,</span>&nbsp;<span class="num" id="4352354">0x4c</span><span class="op" id="4352358">,</span>&nbsp;<span class="num" id="4352360">0x98</span><span class="op" id="4352364">,</span>&nbsp;<span class="num" id="4352366">0xf7</span><span class="op" id="4352370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352373">0x6d</span><span class="op" id="4352377">,</span>&nbsp;<span class="num" id="4352379">0x31</span><span class="op" id="4352383">,</span>&nbsp;<span class="num" id="4352385">0x38</span><span class="op" id="4352389">,</span>&nbsp;<span class="num" id="4352391">0xfb</span><span class="op" id="4352395">,</span>&nbsp;<span class="num" id="4352397">0xdb</span><span class="op" id="4352401">,</span>&nbsp;<span class="num" id="4352403">0xfe</span><span class="op" id="4352407">,</span>&nbsp;<span class="num" id="4352409">0xdb</span><span class="op" id="4352413">,</span>&nbsp;<span class="num" id="4352415">0x37</span><span class="op" id="4352419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352422">0x02</span><span class="op" id="4352426">,</span>&nbsp;<span class="num" id="4352428">0x76</span><span class="op" id="4352432">,</span>&nbsp;<span class="num" id="4352434">0xa1</span><span class="op" id="4352438">,</span>&nbsp;<span class="num" id="4352440">0x18</span><span class="op" id="4352444">,</span>&nbsp;<span class="num" id="4352446">0x97</span><span class="op" id="4352450">,</span>&nbsp;<span class="num" id="4352452">0xa6</span><span class="op" id="4352456">,</span>&nbsp;<span class="num" id="4352458">0xcc</span><span class="op" id="4352462">,</span>&nbsp;<span class="num" id="4352464">0xde</span><span class="op" id="4352468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352471">0x20</span><span class="op" id="4352475">,</span>&nbsp;<span class="num" id="4352477">0x09</span><span class="op" id="4352481">,</span>&nbsp;<span class="num" id="4352483">0x49</span><span class="op" id="4352487">,</span>&nbsp;<span class="num" id="4352489">0x36</span><span class="op" id="4352493">,</span>&nbsp;<span class="num" id="4352495">0x24</span><span class="op" id="4352499">,</span>&nbsp;<span class="num" id="4352501">0x69</span><span class="op" id="4352505">,</span>&nbsp;<span class="num" id="4352507">0x42</span><span class="op" id="4352511">,</span>&nbsp;<span class="num" id="4352513">0xf6</span><span class="op" id="4352517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352520">0xe4</span><span class="op" id="4352524">,</span>&nbsp;<span class="num" id="4352526">0x37</span><span class="op" id="4352530">,</span>&nbsp;<span class="num" id="4352532">0x62</span><span class="op" id="4352536">,</span>&nbsp;<span class="num" id="4352538">0xf1</span><span class="op" id="4352542">,</span>&nbsp;<span class="num" id="4352544">0x59</span><span class="op" id="4352548">,</span>&nbsp;<span class="num" id="4352550">0x6d</span><span class="op" id="4352554">,</span>&nbsp;<span class="num" id="4352556">0xa9</span><span class="op" id="4352560">,</span>&nbsp;<span class="num" id="4352562">0x3c</span><span class="op" id="4352566">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352569">0xed</span><span class="op" id="4352573">,</span>&nbsp;<span class="num" id="4352575">0x34</span><span class="op" id="4352579">,</span>&nbsp;<span class="num" id="4352581">0x9c</span><span class="op" id="4352585">,</span>&nbsp;<span class="num" id="4352587">0xa3</span><span class="op" id="4352591">,</span>&nbsp;<span class="num" id="4352593">0x8e</span><span class="op" id="4352597">,</span>&nbsp;<span class="num" id="4352599">0xdb</span><span class="op" id="4352603">,</span>&nbsp;<span class="num" id="4352605">0xdc</span><span class="op" id="4352609">,</span>&nbsp;<span class="num" id="4352611">0x3a</span><span class="op" id="4352615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352618">0xd7</span><span class="op" id="4352622">,</span>&nbsp;<span class="num" id="4352624">0xf7</span><span class="op" id="4352628">,</span>&nbsp;<span class="num" id="4352630">0x0a</span><span class="op" id="4352634">,</span>&nbsp;<span class="num" id="4352636">0x6f</span><span class="op" id="4352640">,</span>&nbsp;<span class="num" id="4352642">0xef</span><span class="op" id="4352646">,</span>&nbsp;<span class="num" id="4352648">0x2e</span><span class="op" id="4352652">,</span>&nbsp;<span class="num" id="4352654">0xd8</span><span class="op" id="4352658">,</span>&nbsp;<span class="num" id="4352660">0xd5</span><span class="op" id="4352664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352667">0x93</span><span class="op" id="4352671">,</span>&nbsp;<span class="num" id="4352673">0x5a</span><span class="op" id="4352677">,</span>&nbsp;<span class="num" id="4352679">0x7a</span><span class="op" id="4352683">,</span>&nbsp;<span class="num" id="4352685">0xed</span><span class="op" id="4352689">,</span>&nbsp;<span class="num" id="4352691">0x08</span><span class="op" id="4352695">,</span>&nbsp;<span class="num" id="4352697">0x49</span><span class="op" id="4352701">,</span>&nbsp;<span class="num" id="4352703">0x68</span><span class="op" id="4352707">,</span>&nbsp;<span class="num" id="4352709">0xe2</span><span class="op" id="4352713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352716">0x41</span><span class="op" id="4352720">,</span>&nbsp;<span class="num" id="4352722">0xe3</span><span class="op" id="4352726">,</span>&nbsp;<span class="num" id="4352728">0x5a</span><span class="op" id="4352732">,</span>&nbsp;<span class="num" id="4352734">0x90</span><span class="op" id="4352738">,</span>&nbsp;<span class="num" id="4352740">0xc1</span><span class="op" id="4352744">,</span>&nbsp;<span class="num" id="4352746">0x86</span><span class="op" id="4352750">,</span>&nbsp;<span class="num" id="4352752">0x55</span><span class="op" id="4352756">,</span>&nbsp;<span class="num" id="4352758">0xfc</span><span class="op" id="4352762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352765">0x51</span><span class="op" id="4352769">,</span>&nbsp;<span class="num" id="4352771">0x43</span><span class="op" id="4352775">,</span>&nbsp;<span class="num" id="4352777">0x9d</span><span class="op" id="4352781">,</span>&nbsp;<span class="num" id="4352783">0xe0</span><span class="op" id="4352787">,</span>&nbsp;<span class="num" id="4352789">0xb2</span><span class="op" id="4352793">,</span>&nbsp;<span class="num" id="4352795">0xc4</span><span class="op" id="4352799">,</span>&nbsp;<span class="num" id="4352801">0x67</span><span class="op" id="4352805">,</span>&nbsp;<span class="num" id="4352807">0xb4</span><span class="op" id="4352811">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352814">0xcb</span><span class="op" id="4352818">,</span>&nbsp;<span class="num" id="4352820">0x32</span><span class="op" id="4352824">,</span>&nbsp;<span class="num" id="4352826">0x31</span><span class="op" id="4352830">,</span>&nbsp;<span class="num" id="4352832">0x25</span><span class="op" id="4352836">,</span>&nbsp;<span class="num" id="4352838">0xf0</span><span class="op" id="4352842">,</span>&nbsp;<span class="num" id="4352844">0x54</span><span class="op" id="4352848">,</span>&nbsp;<span class="num" id="4352850">0x9f</span><span class="op" id="4352854">,</span>&nbsp;<span class="num" id="4352856">0x4b</span><span class="op" id="4352860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352863">0xd1</span><span class="op" id="4352867">,</span>&nbsp;<span class="num" id="4352869">0x6f</span><span class="op" id="4352873">,</span>&nbsp;<span class="num" id="4352875">0xdb</span><span class="op" id="4352879">,</span>&nbsp;<span class="num" id="4352881">0xd4</span><span class="op" id="4352885">,</span>&nbsp;<span class="num" id="4352887">0xdd</span><span class="op" id="4352891">,</span>&nbsp;<span class="num" id="4352893">0xfc</span><span class="op" id="4352897">,</span>&nbsp;<span class="num" id="4352899">0xaf</span><span class="op" id="4352903">,</span>&nbsp;<span class="num" id="4352905">0x5e</span><span class="op" id="4352909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352912">0x6c</span><span class="op" id="4352916">,</span>&nbsp;<span class="num" id="4352918">0x78</span><span class="op" id="4352922">,</span>&nbsp;<span class="num" id="4352924">0x90</span><span class="op" id="4352928">,</span>&nbsp;<span class="num" id="4352930">0x95</span><span class="op" id="4352934">,</span>&nbsp;<span class="num" id="4352936">0xde</span><span class="op" id="4352940">,</span>&nbsp;<span class="num" id="4352942">0xca</span><span class="op" id="4352946">,</span>&nbsp;<span class="num" id="4352948">0x3a</span><span class="op" id="4352952">,</span>&nbsp;<span class="num" id="4352954">0x48</span><span class="op" id="4352958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4352961">0xb9</span><span class="op" id="4352965">,</span>&nbsp;<span class="num" id="4352967">0x79</span><span class="op" id="4352971">,</span>&nbsp;<span class="num" id="4352973">0x3c</span><span class="op" id="4352977">,</span>&nbsp;<span class="num" id="4352979">0x9b</span><span class="op" id="4352983">,</span>&nbsp;<span class="num" id="4352985">0x19</span><span class="op" id="4352989">,</span>&nbsp;<span class="num" id="4352991">0xd6</span><span class="op" id="4352995">,</span>&nbsp;<span class="num" id="4352997">0x75</span><span class="op" id="4353001">,</span>&nbsp;<span class="num" id="4353003">0x05</span><span class="op" id="4353007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4353010">0xa0</span><span class="op" id="4353014">,</span>&nbsp;<span class="num" id="4353016">0xf9</span><span class="op" id="4353020">,</span>&nbsp;<span class="num" id="4353022">0x88</span><span class="op" id="4353026">,</span>&nbsp;<span class="num" id="4353028">0xd7</span><span class="op" id="4353032">,</span>&nbsp;<span class="num" id="4353034">0xc1</span><span class="op" id="4353038">,</span>&nbsp;<span class="num" id="4353040">0xe8</span><span class="op" id="4353044">,</span>&nbsp;<span class="num" id="4353046">0xa5</span><span class="op" id="4353050">,</span>&nbsp;<span class="num" id="4353052">0x09</span><span class="op" id="4353056">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4353059">0xe4</span><span class="op" id="4353063">,</span>&nbsp;<span class="num" id="4353065">0x1a</span><span class="op" id="4353069">,</span>&nbsp;<span class="num" id="4353071">0x15</span><span class="op" id="4353075">,</span>&nbsp;<span class="num" id="4353077">0xdc</span><span class="op" id="4353081">,</span>&nbsp;<span class="num" id="4353083">0x87</span><span class="op" id="4353087">,</span>&nbsp;<span class="num" id="4353089">0x23</span><span class="op" id="4353093">,</span>&nbsp;<span class="num" id="4353095">0xaa</span><span class="op" id="4353099">,</span>&nbsp;<span class="num" id="4353101">0xb2</span><span class="op" id="4353105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4353108">0x75</span><span class="op" id="4353112">,</span>&nbsp;<span class="num" id="4353114">0x8c</span><span class="op" id="4353118">,</span>&nbsp;<span class="num" id="4353120">0x63</span><span class="op" id="4353124">,</span>&nbsp;<span class="num" id="4353126">0x25</span><span class="op" id="4353130">,</span>&nbsp;<span class="num" id="4353132">0x87</span><span class="op" id="4353136">,</span>&nbsp;<span class="num" id="4353138">0xd8</span><span class="op" id="4353142">,</span>&nbsp;<span class="num" id="4353144">0xf8</span><span class="op" id="4353148">,</span>&nbsp;<span class="num" id="4353150">0x3d</span><span class="op" id="4353154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4353157">0xa6</span><span class="op" id="4353161">,</span>&nbsp;<span class="num" id="4353163">0xc2</span><span class="op" id="4353167">,</span>&nbsp;<span class="num" id="4353169">0xcc</span><span class="op" id="4353173">,</span>&nbsp;<span class="num" id="4353175">0x66</span><span class="op" id="4353179">,</span>&nbsp;<span class="num" id="4353181">0xff</span><span class="op" id="4353185">,</span>&nbsp;<span class="num" id="4353187">0xa5</span><span class="op" id="4353191">,</span>&nbsp;<span class="num" id="4353193">0x66</span><span class="op" id="4353197">,</span>&nbsp;<span class="num" id="4353199">0x68</span><span class="op" id="4353203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4353206">0x55</span><span class="op" id="4353210">,</span>&nbsp;<span class="num" id="4353212">0x02</span><span class="op" id="4353216">,</span>&nbsp;<span class="num" id="4353218">0x03</span><span class="op" id="4353222">,</span>&nbsp;<span class="num" id="4353224">0x01</span><span class="op" id="4353228">,</span>&nbsp;<span class="num" id="4353230">0x00</span><span class="op" id="4353234">,</span>&nbsp;<span class="num" id="4353236">0x01</span><span class="op" id="4353240">,</span><br>
<span class="lineno"></span><span class="op" id="4353242">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4353245">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4353321">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4353337">func</span>&nbsp;<span class="op" id="4353342">(</span><span class="ident" id="4353343">c</span>&nbsp;<span class="op" id="4353345">*</span><span class="ident" id="4353346">Certificate</span><span class="op" id="4353357">)</span>&nbsp;<span class="ident" id="4353359">CheckSignatureFrom</span><span class="op" id="4353377">(</span><span class="ident" id="4353378">parent</span>&nbsp;<span class="op" id="4353385">*</span><span class="ident" id="4353386">Certificate</span><span class="op" id="4353397">)</span>&nbsp;<span class="op" id="4353399">(</span><span class="ident" id="4353400">err</span>&nbsp;<span class="builtintype" id="4353404">error</span><span class="op" id="4353409">)</span>&nbsp;<span class="op" id="4353411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353414">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353437">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353507">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353578">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353649">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4353678">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353740">if</span>&nbsp;<span class="op" id="4353743">(</span><span class="ident" id="4353744">parent</span><span class="op" id="4353750">.</span><span class="ident" id="4353751">Version</span>&nbsp;<span class="op" id="4353759">==</span>&nbsp;<span class="num" id="4353762">3</span>&nbsp;<span class="op" id="4353764">&amp;&amp;</span>&nbsp;<span class="op" id="4353767">!</span><span class="ident" id="4353768">parent</span><span class="op" id="4353774">.</span><span class="ident" id="4353775">BasicConstraintsValid</span>&nbsp;<span class="op" id="4353797">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4353802">parent</span><span class="op" id="4353808">.</span><span class="ident" id="4353809">BasicConstraintsValid</span>&nbsp;<span class="op" id="4353831">&amp;&amp;</span>&nbsp;<span class="op" id="4353834">!</span><span class="ident" id="4353835">parent</span><span class="op" id="4353841">.</span><span class="ident" id="4353842">IsCA</span><span class="op" id="4353846">)</span>&nbsp;<span class="op" id="4353848">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353853">!</span><span class="ident" id="4353854">bytes</span><span class="op" id="4353859">.</span><span class="ident" id="4353860">Equal</span><span class="op" id="4353865">(</span><span class="ident" id="4353866">c</span><span class="op" id="4353867">.</span><span class="ident" id="4353868">RawSubjectPublicKeyInfo</span><span class="op" id="4353891">,</span>&nbsp;<span class="ident" id="4353893">entrustBrokenSPKI</span><span class="op" id="4353910">)</span>&nbsp;<span class="op" id="4353912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353916">return</span>&nbsp;<span class="ident" id="4353923">ConstraintViolationError</span><span class="op" id="4353947">{</span><span class="op" id="4353948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4353951">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4353955">if</span>&nbsp;<span class="ident" id="4353958">parent</span><span class="op" id="4353964">.</span><span class="ident" id="4353965">KeyUsage</span>&nbsp;<span class="op" id="4353974">!=</span>&nbsp;<span class="num" id="4353977">0</span>&nbsp;<span class="op" id="4353979">&amp;&amp;</span>&nbsp;<span class="ident" id="4353982">parent</span><span class="op" id="4353988">.</span><span class="ident" id="4353989">KeyUsage</span><span class="op" id="4353997">&amp;</span><span class="ident" id="4353998">KeyUsageCertSign</span>&nbsp;<span class="op" id="4354015">==</span>&nbsp;<span class="num" id="4354018">0</span>&nbsp;<span class="op" id="4354020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354024">return</span>&nbsp;<span class="ident" id="4354031">ConstraintViolationError</span><span class="op" id="4354055">{</span><span class="op" id="4354056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354063">if</span>&nbsp;<span class="ident" id="4354066">parent</span><span class="op" id="4354072">.</span><span class="ident" id="4354073">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4354092">==</span>&nbsp;<span class="ident" id="4354095">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4354121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354125">return</span>&nbsp;<span class="ident" id="4354132">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4354161">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354218">return</span>&nbsp;<span class="ident" id="4354225">parent</span><span class="op" id="4354231">.</span><span class="ident" id="4354232">CheckSignature</span><span class="op" id="4354246">(</span><span class="ident" id="4354247">c</span><span class="op" id="4354248">.</span><span class="ident" id="4354249">SignatureAlgorithm</span><span class="op" id="4354267">,</span>&nbsp;<span class="ident" id="4354269">c</span><span class="op" id="4354270">.</span><span class="ident" id="4354271">RawTBSCertificate</span><span class="op" id="4354288">,</span>&nbsp;<span class="ident" id="4354290">c</span><span class="op" id="4354291">.</span><span class="ident" id="4354292">Signature</span><span class="op" id="4354301">)</span><br>
<span class="lineno"></span><span class="op" id="4354303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4354306">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4354386">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4354405">func</span>&nbsp;<span class="op" id="4354410">(</span><span class="ident" id="4354411">c</span>&nbsp;<span class="op" id="4354413">*</span><span class="ident" id="4354414">Certificate</span><span class="op" id="4354425">)</span>&nbsp;<span class="ident" id="4354427">CheckSignature</span><span class="op" id="4354441">(</span><span class="ident" id="4354442">algo</span>&nbsp;<span class="ident" id="4354447">SignatureAlgorithm</span><span class="op" id="4354465">,</span>&nbsp;<span class="ident" id="4354467">signed</span><span class="op" id="4354473">,</span>&nbsp;<span class="ident" id="4354475">signature</span>&nbsp;<span class="op" id="4354485">[</span><span class="op" id="4354486">]</span><span class="builtintype" id="4354487">byte</span><span class="op" id="4354491">)</span>&nbsp;<span class="op" id="4354493">(</span><span class="ident" id="4354494">err</span>&nbsp;<span class="builtintype" id="4354498">error</span><span class="op" id="4354503">)</span>&nbsp;<span class="op" id="4354505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354508">var</span>&nbsp;<span class="ident" id="4354512">hashType</span>&nbsp;<span class="ident" id="4354521">crypto</span><span class="op" id="4354527">.</span><span class="ident" id="4354528">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354535">switch</span>&nbsp;<span class="ident" id="4354542">algo</span>&nbsp;<span class="op" id="4354547">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354550">case</span>&nbsp;<span class="ident" id="4354555">SHA1WithRSA</span><span class="op" id="4354566">,</span>&nbsp;<span class="ident" id="4354568">DSAWithSHA1</span><span class="op" id="4354579">,</span>&nbsp;<span class="ident" id="4354581">ECDSAWithSHA1</span><span class="op" id="4354594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354598">hashType</span>&nbsp;<span class="op" id="4354607">=</span>&nbsp;<span class="ident" id="4354609">crypto</span><span class="op" id="4354615">.</span><span class="ident" id="4354616">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354622">case</span>&nbsp;<span class="ident" id="4354627">SHA256WithRSA</span><span class="op" id="4354640">,</span>&nbsp;<span class="ident" id="4354642">DSAWithSHA256</span><span class="op" id="4354655">,</span>&nbsp;<span class="ident" id="4354657">ECDSAWithSHA256</span><span class="op" id="4354672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354676">hashType</span>&nbsp;<span class="op" id="4354685">=</span>&nbsp;<span class="ident" id="4354687">crypto</span><span class="op" id="4354693">.</span><span class="ident" id="4354694">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354702">case</span>&nbsp;<span class="ident" id="4354707">SHA384WithRSA</span><span class="op" id="4354720">,</span>&nbsp;<span class="ident" id="4354722">ECDSAWithSHA384</span><span class="op" id="4354737">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354741">hashType</span>&nbsp;<span class="op" id="4354750">=</span>&nbsp;<span class="ident" id="4354752">crypto</span><span class="op" id="4354758">.</span><span class="ident" id="4354759">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354767">case</span>&nbsp;<span class="ident" id="4354772">SHA512WithRSA</span><span class="op" id="4354785">,</span>&nbsp;<span class="ident" id="4354787">ECDSAWithSHA512</span><span class="op" id="4354802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354806">hashType</span>&nbsp;<span class="op" id="4354815">=</span>&nbsp;<span class="ident" id="4354817">crypto</span><span class="op" id="4354823">.</span><span class="ident" id="4354824">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354832">default</span><span class="op" id="4354839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354843">return</span>&nbsp;<span class="ident" id="4354850">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354879">if</span>&nbsp;<span class="op" id="4354882">!</span><span class="ident" id="4354883">hashType</span><span class="op" id="4354891">.</span><span class="ident" id="4354892">Available</span><span class="op" id="4354901">(</span><span class="op" id="4354902">)</span>&nbsp;<span class="op" id="4354904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4354908">return</span>&nbsp;<span class="ident" id="4354915">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4354940">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354943">h</span>&nbsp;<span class="op" id="4354945">:=</span>&nbsp;<span class="ident" id="4354948">hashType</span><span class="op" id="4354956">.</span><span class="ident" id="4354957">New</span><span class="op" id="4354960">(</span><span class="op" id="4354961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354965">h</span><span class="op" id="4354966">.</span><span class="ident" id="4354967">Write</span><span class="op" id="4354972">(</span><span class="ident" id="4354973">signed</span><span class="op" id="4354979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4354982">digest</span>&nbsp;<span class="op" id="4354989">:=</span>&nbsp;<span class="ident" id="4354992">h</span><span class="op" id="4354993">.</span><span class="ident" id="4354994">Sum</span><span class="op" id="4354997">(</span><span class="ident" id="4354998">nil</span><span class="op" id="4355001">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355005">switch</span>&nbsp;<span class="ident" id="4355012">pub</span>&nbsp;<span class="op" id="4355016">:=</span>&nbsp;<span class="ident" id="4355019">c</span><span class="op" id="4355020">.</span><span class="ident" id="4355021">PublicKey</span><span class="op" id="4355030">.</span><span class="op" id="4355031">(</span><span class="keyword" id="4355032">type</span><span class="op" id="4355036">)</span>&nbsp;<span class="op" id="4355038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355041">case</span>&nbsp;<span class="op" id="4355046">*</span><span class="ident" id="4355047">rsa</span><span class="op" id="4355050">.</span><span class="ident" id="4355051">PublicKey</span><span class="op" id="4355060">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355064">return</span>&nbsp;<span class="ident" id="4355071">rsa</span><span class="op" id="4355074">.</span><span class="ident" id="4355075">VerifyPKCS1v15</span><span class="op" id="4355089">(</span><span class="ident" id="4355090">pub</span><span class="op" id="4355093">,</span>&nbsp;<span class="ident" id="4355095">hashType</span><span class="op" id="4355103">,</span>&nbsp;<span class="ident" id="4355105">digest</span><span class="op" id="4355111">,</span>&nbsp;<span class="ident" id="4355113">signature</span><span class="op" id="4355122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355125">case</span>&nbsp;<span class="op" id="4355130">*</span><span class="ident" id="4355131">dsa</span><span class="op" id="4355134">.</span><span class="ident" id="4355135">PublicKey</span><span class="op" id="4355144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355148">dsaSig</span>&nbsp;<span class="op" id="4355155">:=</span>&nbsp;<span class="builtinfunc" id="4355158">new</span><span class="op" id="4355161">(</span><span class="ident" id="4355162">dsaSignature</span><span class="op" id="4355174">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355178">if</span>&nbsp;<span class="ident" id="4355181">_</span><span class="op" id="4355182">,</span>&nbsp;<span class="ident" id="4355184">err</span>&nbsp;<span class="op" id="4355188">:=</span>&nbsp;<span class="ident" id="4355191">asn1</span><span class="op" id="4355195">.</span><span class="ident" id="4355196">Unmarshal</span><span class="op" id="4355205">(</span><span class="ident" id="4355206">signature</span><span class="op" id="4355215">,</span>&nbsp;<span class="ident" id="4355217">dsaSig</span><span class="op" id="4355223">)</span><span class="op" id="4355224">;</span>&nbsp;<span class="ident" id="4355226">err</span>&nbsp;<span class="op" id="4355230">!=</span>&nbsp;<span class="ident" id="4355233">nil</span>&nbsp;<span class="op" id="4355237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355242">return</span>&nbsp;<span class="ident" id="4355249">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355259">if</span>&nbsp;<span class="ident" id="4355262">dsaSig</span><span class="op" id="4355268">.</span><span class="ident" id="4355269">R</span><span class="op" id="4355270">.</span><span class="ident" id="4355271">Sign</span><span class="op" id="4355275">(</span><span class="op" id="4355276">)</span>&nbsp;<span class="op" id="4355278">&lt;=</span>&nbsp;<span class="num" id="4355281">0</span>&nbsp;<span class="op" id="4355283">||</span>&nbsp;<span class="ident" id="4355286">dsaSig</span><span class="op" id="4355292">.</span><span class="ident" id="4355293">S</span><span class="op" id="4355294">.</span><span class="ident" id="4355295">Sign</span><span class="op" id="4355299">(</span><span class="op" id="4355300">)</span>&nbsp;<span class="op" id="4355302">&lt;=</span>&nbsp;<span class="num" id="4355305">0</span>&nbsp;<span class="op" id="4355307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355312">return</span>&nbsp;<span class="ident" id="4355319">errors</span><span class="op" id="4355325">.</span><span class="ident" id="4355326">New</span><span class="op" id="4355329">(</span><span class="string" id="4355330">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4355385">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355393">if</span>&nbsp;<span class="op" id="4355396">!</span><span class="ident" id="4355397">dsa</span><span class="op" id="4355400">.</span><span class="ident" id="4355401">Verify</span><span class="op" id="4355407">(</span><span class="ident" id="4355408">pub</span><span class="op" id="4355411">,</span>&nbsp;<span class="ident" id="4355413">digest</span><span class="op" id="4355419">,</span>&nbsp;<span class="ident" id="4355421">dsaSig</span><span class="op" id="4355427">.</span><span class="ident" id="4355428">R</span><span class="op" id="4355429">,</span>&nbsp;<span class="ident" id="4355431">dsaSig</span><span class="op" id="4355437">.</span><span class="ident" id="4355438">S</span><span class="op" id="4355439">)</span>&nbsp;<span class="op" id="4355441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355446">return</span>&nbsp;<span class="ident" id="4355453">errors</span><span class="op" id="4355459">.</span><span class="ident" id="4355460">New</span><span class="op" id="4355463">(</span><span class="string" id="4355464">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4355496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355504">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355512">case</span>&nbsp;<span class="op" id="4355517">*</span><span class="ident" id="4355518">ecdsa</span><span class="op" id="4355523">.</span><span class="ident" id="4355524">PublicKey</span><span class="op" id="4355533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4355537">ecdsaSig</span>&nbsp;<span class="op" id="4355546">:=</span>&nbsp;<span class="builtinfunc" id="4355549">new</span><span class="op" id="4355552">(</span><span class="ident" id="4355553">ecdsaSignature</span><span class="op" id="4355567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355571">if</span>&nbsp;<span class="ident" id="4355574">_</span><span class="op" id="4355575">,</span>&nbsp;<span class="ident" id="4355577">err</span>&nbsp;<span class="op" id="4355581">:=</span>&nbsp;<span class="ident" id="4355584">asn1</span><span class="op" id="4355588">.</span><span class="ident" id="4355589">Unmarshal</span><span class="op" id="4355598">(</span><span class="ident" id="4355599">signature</span><span class="op" id="4355608">,</span>&nbsp;<span class="ident" id="4355610">ecdsaSig</span><span class="op" id="4355618">)</span><span class="op" id="4355619">;</span>&nbsp;<span class="ident" id="4355621">err</span>&nbsp;<span class="op" id="4355625">!=</span>&nbsp;<span class="ident" id="4355628">nil</span>&nbsp;<span class="op" id="4355632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355637">return</span>&nbsp;<span class="ident" id="4355644">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355650">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355654">if</span>&nbsp;<span class="ident" id="4355657">ecdsaSig</span><span class="op" id="4355665">.</span><span class="ident" id="4355666">R</span><span class="op" id="4355667">.</span><span class="ident" id="4355668">Sign</span><span class="op" id="4355672">(</span><span class="op" id="4355673">)</span>&nbsp;<span class="op" id="4355675">&lt;=</span>&nbsp;<span class="num" id="4355678">0</span>&nbsp;<span class="op" id="4355680">||</span>&nbsp;<span class="ident" id="4355683">ecdsaSig</span><span class="op" id="4355691">.</span><span class="ident" id="4355692">S</span><span class="op" id="4355693">.</span><span class="ident" id="4355694">Sign</span><span class="op" id="4355698">(</span><span class="op" id="4355699">)</span>&nbsp;<span class="op" id="4355701">&lt;=</span>&nbsp;<span class="num" id="4355704">0</span>&nbsp;<span class="op" id="4355706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355711">return</span>&nbsp;<span class="ident" id="4355718">errors</span><span class="op" id="4355724">.</span><span class="ident" id="4355725">New</span><span class="op" id="4355728">(</span><span class="string" id="4355729">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4355786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355794">if</span>&nbsp;<span class="op" id="4355797">!</span><span class="ident" id="4355798">ecdsa</span><span class="op" id="4355803">.</span><span class="ident" id="4355804">Verify</span><span class="op" id="4355810">(</span><span class="ident" id="4355811">pub</span><span class="op" id="4355814">,</span>&nbsp;<span class="ident" id="4355816">digest</span><span class="op" id="4355822">,</span>&nbsp;<span class="ident" id="4355824">ecdsaSig</span><span class="op" id="4355832">.</span><span class="ident" id="4355833">R</span><span class="op" id="4355834">,</span>&nbsp;<span class="ident" id="4355836">ecdsaSig</span><span class="op" id="4355844">.</span><span class="ident" id="4355845">S</span><span class="op" id="4355846">)</span>&nbsp;<span class="op" id="4355848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355853">return</span>&nbsp;<span class="ident" id="4355860">errors</span><span class="op" id="4355866">.</span><span class="ident" id="4355867">New</span><span class="op" id="4355870">(</span><span class="string" id="4355871">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4355905">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355913">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4355921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4355924">return</span>&nbsp;<span class="ident" id="4355931">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4355955">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4355958">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4356023">func</span>&nbsp;<span class="op" id="4356028">(</span><span class="ident" id="4356029">c</span>&nbsp;<span class="op" id="4356031">*</span><span class="ident" id="4356032">Certificate</span><span class="op" id="4356043">)</span>&nbsp;<span class="ident" id="4356045">CheckCRLSignature</span><span class="op" id="4356062">(</span><span class="ident" id="4356063">crl</span>&nbsp;<span class="op" id="4356067">*</span><span class="ident" id="4356068">pkix</span><span class="op" id="4356072">.</span><span class="ident" id="4356073">CertificateList</span><span class="op" id="4356088">)</span>&nbsp;<span class="op" id="4356090">(</span><span class="ident" id="4356091">err</span>&nbsp;<span class="builtintype" id="4356095">error</span><span class="op" id="4356100">)</span>&nbsp;<span class="op" id="4356102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356105">algo</span>&nbsp;<span class="op" id="4356110">:=</span>&nbsp;<span class="ident" id="4356113">getSignatureAlgorithmFromOID</span><span class="op" id="4356141">(</span><span class="ident" id="4356142">crl</span><span class="op" id="4356145">.</span><span class="ident" id="4356146">SignatureAlgorithm</span><span class="op" id="4356164">.</span><span class="ident" id="4356165">Algorithm</span><span class="op" id="4356174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356177">return</span>&nbsp;<span class="ident" id="4356184">c</span><span class="op" id="4356185">.</span><span class="ident" id="4356186">CheckSignature</span><span class="op" id="4356200">(</span><span class="ident" id="4356201">algo</span><span class="op" id="4356205">,</span>&nbsp;<span class="ident" id="4356207">crl</span><span class="op" id="4356210">.</span><span class="ident" id="4356211">TBSCertList</span><span class="op" id="4356222">.</span><span class="ident" id="4356223">Raw</span><span class="op" id="4356226">,</span>&nbsp;<span class="ident" id="4356228">crl</span><span class="op" id="4356231">.</span><span class="ident" id="4356232">SignatureValue</span><span class="op" id="4356246">.</span><span class="ident" id="4356247">RightAlign</span><span class="op" id="4356257">(</span><span class="op" id="4356258">)</span><span class="op" id="4356259">)</span><br>
<span class="lineno">680</span><span class="op" id="4356261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4356264">type</span>&nbsp;<span class="ident" id="4356269">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4356296">struct</span><span class="op" id="4356302">{</span><span class="op" id="4356303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4356306">func</span>&nbsp;<span class="op" id="4356311">(</span><span class="ident" id="4356312">h</span>&nbsp;<span class="ident" id="4356314">UnhandledCriticalExtension</span><span class="op" id="4356340">)</span>&nbsp;<span class="ident" id="4356342">Error</span><span class="op" id="4356347">(</span><span class="op" id="4356348">)</span>&nbsp;<span class="builtintype" id="4356350">string</span>&nbsp;<span class="op" id="4356357">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4356360">return</span>&nbsp;<span class="string" id="4356367">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4356404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4356407">type</span>&nbsp;<span class="ident" id="4356412">basicConstraints</span>&nbsp;<span class="keyword" id="4356429">struct</span>&nbsp;<span class="op" id="4356436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356439">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4356450">bool</span>&nbsp;<span class="string" id="4356455">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356474">MaxPathLen</span>&nbsp;<span class="builtintype" id="4356485">int</span>&nbsp;&nbsp;<span class="string" id="4356490">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4356519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4356522">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4356542">type</span>&nbsp;<span class="ident" id="4356547">policyInformation</span>&nbsp;<span class="keyword" id="4356565">struct</span>&nbsp;<span class="op" id="4356572">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356575">Policy</span>&nbsp;<span class="ident" id="4356582">asn1</span><span class="op" id="4356586">.</span><span class="ident" id="4356587">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4356605">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4356633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4356636">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4356658">type</span>&nbsp;<span class="ident" id="4356663">nameConstraints</span>&nbsp;<span class="keyword" id="4356679">struct</span>&nbsp;<span class="op" id="4356686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356689">Permitted</span>&nbsp;<span class="op" id="4356699">[</span><span class="op" id="4356700">]</span><span class="ident" id="4356701">generalSubtree</span>&nbsp;<span class="string" id="4356716">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356741">Excluded</span>&nbsp;&nbsp;<span class="op" id="4356751">[</span><span class="op" id="4356752">]</span><span class="ident" id="4356753">generalSubtree</span>&nbsp;<span class="string" id="4356768">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4356792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4356795">type</span>&nbsp;<span class="ident" id="4356800">generalSubtree</span>&nbsp;<span class="keyword" id="4356815">struct</span>&nbsp;<span class="op" id="4356822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356825">Name</span>&nbsp;<span class="builtintype" id="4356830">string</span>&nbsp;<span class="string" id="4356837">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4356865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4356868">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4356889">type</span>&nbsp;<span class="ident" id="4356894">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4356914">struct</span>&nbsp;<span class="op" id="4356921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356924">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4356933">asn1</span><span class="op" id="4356937">.</span><span class="ident" id="4356938">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4356956">Location</span>&nbsp;<span class="ident" id="4356965">asn1</span><span class="op" id="4356969">.</span><span class="ident" id="4356970">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4356979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4356982">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4357004">type</span>&nbsp;<span class="ident" id="4357009">distributionPoint</span>&nbsp;<span class="keyword" id="4357027">struct</span>&nbsp;<span class="op" id="4357034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357037">DistributionPoint</span>&nbsp;<span class="ident" id="4357055">distributionPointName</span>&nbsp;<span class="string" id="4357077">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357102">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357120">asn1</span><span class="op" id="4357124">.</span><span class="ident" id="4357125">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357142">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357167">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357185">asn1</span><span class="op" id="4357189">.</span><span class="ident" id="4357190">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357207">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4357231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4357234">type</span>&nbsp;<span class="ident" id="4357239">distributionPointName</span>&nbsp;<span class="keyword" id="4357261">struct</span>&nbsp;<span class="op" id="4357268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357271">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357284">asn1</span><span class="op" id="4357288">.</span><span class="ident" id="4357289">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357301">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357326">RelativeName</span>&nbsp;<span class="ident" id="4357339">pkix</span><span class="op" id="4357343">.</span><span class="ident" id="4357344">RDNSequence</span>&nbsp;<span class="string" id="4357356">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4357380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4357383">func</span>&nbsp;<span class="ident" id="4357388">parsePublicKey</span><span class="op" id="4357402">(</span><span class="ident" id="4357403">algo</span>&nbsp;<span class="ident" id="4357408">PublicKeyAlgorithm</span><span class="op" id="4357426">,</span>&nbsp;<span class="ident" id="4357428">keyData</span>&nbsp;<span class="op" id="4357436">*</span><span class="ident" id="4357437">publicKeyInfo</span><span class="op" id="4357450">)</span>&nbsp;<span class="op" id="4357452">(</span><span class="keyword" id="4357453">interface</span><span class="op" id="4357462">{</span><span class="op" id="4357463">}</span><span class="op" id="4357464">,</span>&nbsp;<span class="builtintype" id="4357466">error</span><span class="op" id="4357471">)</span>&nbsp;<span class="op" id="4357473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357476">asn1Data</span>&nbsp;<span class="op" id="4357485">:=</span>&nbsp;<span class="ident" id="4357488">keyData</span><span class="op" id="4357495">.</span><span class="ident" id="4357496">PublicKey</span><span class="op" id="4357505">.</span><span class="ident" id="4357506">RightAlign</span><span class="op" id="4357516">(</span><span class="op" id="4357517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357520">switch</span>&nbsp;<span class="ident" id="4357527">algo</span>&nbsp;<span class="op" id="4357532">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357535">case</span>&nbsp;<span class="ident" id="4357540">RSA</span><span class="op" id="4357543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357547">p</span>&nbsp;<span class="op" id="4357549">:=</span>&nbsp;<span class="builtinfunc" id="4357552">new</span><span class="op" id="4357555">(</span><span class="ident" id="4357556">rsaPublicKey</span><span class="op" id="4357568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357572">_</span><span class="op" id="4357573">,</span>&nbsp;<span class="ident" id="4357575">err</span>&nbsp;<span class="op" id="4357579">:=</span>&nbsp;<span class="ident" id="4357582">asn1</span><span class="op" id="4357586">.</span><span class="ident" id="4357587">Unmarshal</span><span class="op" id="4357596">(</span><span class="ident" id="4357597">asn1Data</span><span class="op" id="4357605">,</span>&nbsp;<span class="ident" id="4357607">p</span><span class="op" id="4357608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357612">if</span>&nbsp;<span class="ident" id="4357615">err</span>&nbsp;<span class="op" id="4357619">!=</span>&nbsp;<span class="ident" id="4357622">nil</span>&nbsp;<span class="op" id="4357626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357631">return</span>&nbsp;<span class="ident" id="4357638">nil</span><span class="op" id="4357641">,</span>&nbsp;<span class="ident" id="4357643">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357654">if</span>&nbsp;<span class="ident" id="4357657">p</span><span class="op" id="4357658">.</span><span class="ident" id="4357659">N</span><span class="op" id="4357660">.</span><span class="ident" id="4357661">Sign</span><span class="op" id="4357665">(</span><span class="op" id="4357666">)</span>&nbsp;<span class="op" id="4357668">&lt;=</span>&nbsp;<span class="num" id="4357671">0</span>&nbsp;<span class="op" id="4357673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357678">return</span>&nbsp;<span class="ident" id="4357685">nil</span><span class="op" id="4357688">,</span>&nbsp;<span class="ident" id="4357690">errors</span><span class="op" id="4357696">.</span><span class="ident" id="4357697">New</span><span class="op" id="4357700">(</span><span class="string" id="4357701">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4357745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357749">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357753">if</span>&nbsp;<span class="ident" id="4357756">p</span><span class="op" id="4357757">.</span><span class="ident" id="4357758">E</span>&nbsp;<span class="op" id="4357760">&lt;=</span>&nbsp;<span class="num" id="4357763">0</span>&nbsp;<span class="op" id="4357765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357770">return</span>&nbsp;<span class="ident" id="4357777">nil</span><span class="op" id="4357780">,</span>&nbsp;<span class="ident" id="4357782">errors</span><span class="op" id="4357788">.</span><span class="ident" id="4357789">New</span><span class="op" id="4357792">(</span><span class="string" id="4357793">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4357845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357854">pub</span>&nbsp;<span class="op" id="4357858">:=</span>&nbsp;<span class="op" id="4357861">&amp;</span><span class="ident" id="4357862">rsa</span><span class="op" id="4357865">.</span><span class="ident" id="4357866">PublicKey</span><span class="op" id="4357875">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357880">E</span><span class="op" id="4357881">:</span>&nbsp;<span class="ident" id="4357883">p</span><span class="op" id="4357884">.</span><span class="ident" id="4357885">E</span><span class="op" id="4357886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357891">N</span><span class="op" id="4357892">:</span>&nbsp;<span class="ident" id="4357894">p</span><span class="op" id="4357895">.</span><span class="ident" id="4357896">N</span><span class="op" id="4357897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4357901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357905">return</span>&nbsp;<span class="ident" id="4357912">pub</span><span class="op" id="4357915">,</span>&nbsp;<span class="ident" id="4357917">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357922">case</span>&nbsp;<span class="ident" id="4357927">DSA</span><span class="op" id="4357930">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357934">var</span>&nbsp;<span class="ident" id="4357938">p</span>&nbsp;<span class="op" id="4357940">*</span><span class="ident" id="4357941">big</span><span class="op" id="4357944">.</span><span class="ident" id="4357945">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4357951">_</span><span class="op" id="4357952">,</span>&nbsp;<span class="ident" id="4357954">err</span>&nbsp;<span class="op" id="4357958">:=</span>&nbsp;<span class="ident" id="4357961">asn1</span><span class="op" id="4357965">.</span><span class="ident" id="4357966">Unmarshal</span><span class="op" id="4357975">(</span><span class="ident" id="4357976">asn1Data</span><span class="op" id="4357984">,</span>&nbsp;<span class="op" id="4357986">&amp;</span><span class="ident" id="4357987">p</span><span class="op" id="4357988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4357992">if</span>&nbsp;<span class="ident" id="4357995">err</span>&nbsp;<span class="op" id="4357999">!=</span>&nbsp;<span class="ident" id="4358002">nil</span>&nbsp;<span class="op" id="4358006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358011">return</span>&nbsp;<span class="ident" id="4358018">nil</span><span class="op" id="4358021">,</span>&nbsp;<span class="ident" id="4358023">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358029">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358033">paramsData</span>&nbsp;<span class="op" id="4358044">:=</span>&nbsp;<span class="ident" id="4358047">keyData</span><span class="op" id="4358054">.</span><span class="ident" id="4358055">Algorithm</span><span class="op" id="4358064">.</span><span class="ident" id="4358065">Parameters</span><span class="op" id="4358075">.</span><span class="ident" id="4358076">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358088">params</span>&nbsp;<span class="op" id="4358095">:=</span>&nbsp;<span class="builtinfunc" id="4358098">new</span><span class="op" id="4358101">(</span><span class="ident" id="4358102">dsaAlgorithmParameters</span><span class="op" id="4358124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358128">_</span><span class="op" id="4358129">,</span>&nbsp;<span class="ident" id="4358131">err</span>&nbsp;<span class="op" id="4358135">=</span>&nbsp;<span class="ident" id="4358137">asn1</span><span class="op" id="4358141">.</span><span class="ident" id="4358142">Unmarshal</span><span class="op" id="4358151">(</span><span class="ident" id="4358152">paramsData</span><span class="op" id="4358162">,</span>&nbsp;<span class="ident" id="4358164">params</span><span class="op" id="4358170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358174">if</span>&nbsp;<span class="ident" id="4358177">err</span>&nbsp;<span class="op" id="4358181">!=</span>&nbsp;<span class="ident" id="4358184">nil</span>&nbsp;<span class="op" id="4358188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358193">return</span>&nbsp;<span class="ident" id="4358200">nil</span><span class="op" id="4358203">,</span>&nbsp;<span class="ident" id="4358205">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358215">if</span>&nbsp;<span class="ident" id="4358218">p</span><span class="op" id="4358219">.</span><span class="ident" id="4358220">Sign</span><span class="op" id="4358224">(</span><span class="op" id="4358225">)</span>&nbsp;<span class="op" id="4358227">&lt;=</span>&nbsp;<span class="num" id="4358230">0</span>&nbsp;<span class="op" id="4358232">||</span>&nbsp;<span class="ident" id="4358235">params</span><span class="op" id="4358241">.</span><span class="ident" id="4358242">P</span><span class="op" id="4358243">.</span><span class="ident" id="4358244">Sign</span><span class="op" id="4358248">(</span><span class="op" id="4358249">)</span>&nbsp;<span class="op" id="4358251">&lt;=</span>&nbsp;<span class="num" id="4358254">0</span>&nbsp;<span class="op" id="4358256">||</span>&nbsp;<span class="ident" id="4358259">params</span><span class="op" id="4358265">.</span><span class="ident" id="4358266">Q</span><span class="op" id="4358267">.</span><span class="ident" id="4358268">Sign</span><span class="op" id="4358272">(</span><span class="op" id="4358273">)</span>&nbsp;<span class="op" id="4358275">&lt;=</span>&nbsp;<span class="num" id="4358278">0</span>&nbsp;<span class="op" id="4358280">||</span>&nbsp;<span class="ident" id="4358283">params</span><span class="op" id="4358289">.</span><span class="ident" id="4358290">G</span><span class="op" id="4358291">.</span><span class="ident" id="4358292">Sign</span><span class="op" id="4358296">(</span><span class="op" id="4358297">)</span>&nbsp;<span class="op" id="4358299">&lt;=</span>&nbsp;<span class="num" id="4358302">0</span>&nbsp;<span class="op" id="4358304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358309">return</span>&nbsp;<span class="ident" id="4358316">nil</span><span class="op" id="4358319">,</span>&nbsp;<span class="ident" id="4358321">errors</span><span class="op" id="4358327">.</span><span class="ident" id="4358328">New</span><span class="op" id="4358331">(</span><span class="string" id="4358332">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4358370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358378">pub</span>&nbsp;<span class="op" id="4358382">:=</span>&nbsp;<span class="op" id="4358385">&amp;</span><span class="ident" id="4358386">dsa</span><span class="op" id="4358389">.</span><span class="ident" id="4358390">PublicKey</span><span class="op" id="4358399">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358404">Parameters</span><span class="op" id="4358414">:</span>&nbsp;<span class="ident" id="4358416">dsa</span><span class="op" id="4358419">.</span><span class="ident" id="4358420">Parameters</span><span class="op" id="4358430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358436">P</span><span class="op" id="4358437">:</span>&nbsp;<span class="ident" id="4358439">params</span><span class="op" id="4358445">.</span><span class="ident" id="4358446">P</span><span class="op" id="4358447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358453">Q</span><span class="op" id="4358454">:</span>&nbsp;<span class="ident" id="4358456">params</span><span class="op" id="4358462">.</span><span class="ident" id="4358463">Q</span><span class="op" id="4358464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358470">G</span><span class="op" id="4358471">:</span>&nbsp;<span class="ident" id="4358473">params</span><span class="op" id="4358479">.</span><span class="ident" id="4358480">G</span><span class="op" id="4358481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358486">}</span><span class="op" id="4358487">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358492">Y</span><span class="op" id="4358493">:</span>&nbsp;<span class="ident" id="4358495">p</span><span class="op" id="4358496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358504">return</span>&nbsp;<span class="ident" id="4358511">pub</span><span class="op" id="4358514">,</span>&nbsp;<span class="ident" id="4358516">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358521">case</span>&nbsp;<span class="ident" id="4358526">ECDSA</span><span class="op" id="4358531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358535">paramsData</span>&nbsp;<span class="op" id="4358546">:=</span>&nbsp;<span class="ident" id="4358549">keyData</span><span class="op" id="4358556">.</span><span class="ident" id="4358557">Algorithm</span><span class="op" id="4358566">.</span><span class="ident" id="4358567">Parameters</span><span class="op" id="4358577">.</span><span class="ident" id="4358578">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358590">namedCurveOID</span>&nbsp;<span class="op" id="4358604">:=</span>&nbsp;<span class="builtinfunc" id="4358607">new</span><span class="op" id="4358610">(</span><span class="ident" id="4358611">asn1</span><span class="op" id="4358615">.</span><span class="ident" id="4358616">ObjectIdentifier</span><span class="op" id="4358632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358636">_</span><span class="op" id="4358637">,</span>&nbsp;<span class="ident" id="4358639">err</span>&nbsp;<span class="op" id="4358643">:=</span>&nbsp;<span class="ident" id="4358646">asn1</span><span class="op" id="4358650">.</span><span class="ident" id="4358651">Unmarshal</span><span class="op" id="4358660">(</span><span class="ident" id="4358661">paramsData</span><span class="op" id="4358671">,</span>&nbsp;<span class="ident" id="4358673">namedCurveOID</span><span class="op" id="4358686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358690">if</span>&nbsp;<span class="ident" id="4358693">err</span>&nbsp;<span class="op" id="4358697">!=</span>&nbsp;<span class="ident" id="4358700">nil</span>&nbsp;<span class="op" id="4358704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358709">return</span>&nbsp;<span class="ident" id="4358716">nil</span><span class="op" id="4358719">,</span>&nbsp;<span class="ident" id="4358721">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358727">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358731">namedCurve</span>&nbsp;<span class="op" id="4358742">:=</span>&nbsp;<span class="ident" id="4358745">namedCurveFromOID</span><span class="op" id="4358762">(</span><span class="op" id="4358763">*</span><span class="ident" id="4358764">namedCurveOID</span><span class="op" id="4358777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358781">if</span>&nbsp;<span class="ident" id="4358784">namedCurve</span>&nbsp;<span class="op" id="4358795">==</span>&nbsp;<span class="ident" id="4358798">nil</span>&nbsp;<span class="op" id="4358802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358807">return</span>&nbsp;<span class="ident" id="4358814">nil</span><span class="op" id="4358817">,</span>&nbsp;<span class="ident" id="4358819">errors</span><span class="op" id="4358825">.</span><span class="ident" id="4358826">New</span><span class="op" id="4358829">(</span><span class="string" id="4358830">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4358864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4358868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4358872">x</span><span class="op" id="4358873">,</span>&nbsp;<span class="ident" id="4358875">y</span>&nbsp;<span class="op" id="4358877">:=</span>&nbsp;<span class="ident" id="4358880">elliptic</span><span class="op" id="4358888">.</span><span class="ident" id="4358889">Unmarshal</span><span class="op" id="4358898">(</span><span class="ident" id="4358899">namedCurve</span><span class="op" id="4358909">,</span>&nbsp;<span class="ident" id="4358911">asn1Data</span><span class="op" id="4358919">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358923">if</span>&nbsp;<span class="ident" id="4358926">x</span>&nbsp;<span class="op" id="4358928">==</span>&nbsp;<span class="ident" id="4358931">nil</span>&nbsp;<span class="op" id="4358935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4358940">return</span>&nbsp;<span class="ident" id="4358947">nil</span><span class="op" id="4358950">,</span>&nbsp;<span class="ident" id="4358952">errors</span><span class="op" id="4358958">.</span><span class="ident" id="4358959">New</span><span class="op" id="4358962">(</span><span class="string" id="4358963">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4359011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359019">pub</span>&nbsp;<span class="op" id="4359023">:=</span>&nbsp;<span class="op" id="4359026">&amp;</span><span class="ident" id="4359027">ecdsa</span><span class="op" id="4359032">.</span><span class="ident" id="4359033">PublicKey</span><span class="op" id="4359042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359047">Curve</span><span class="op" id="4359052">:</span>&nbsp;<span class="ident" id="4359054">namedCurve</span><span class="op" id="4359064">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359069">X</span><span class="op" id="4359070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359076">x</span><span class="op" id="4359077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4359082">Y</span><span class="op" id="4359083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359089">y</span><span class="op" id="4359090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359098">return</span>&nbsp;<span class="ident" id="4359105">pub</span><span class="op" id="4359108">,</span>&nbsp;<span class="ident" id="4359110">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359115">default</span><span class="op" id="4359122">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359126">return</span>&nbsp;<span class="ident" id="4359133">nil</span><span class="op" id="4359136">,</span>&nbsp;<span class="ident" id="4359138">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4359143">}</span><br>
<span class="lineno"></span><span class="op" id="4359145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4359148">func</span>&nbsp;<span class="ident" id="4359153">parseSANExtension</span><span class="op" id="4359170">(</span><span class="ident" id="4359171">value</span>&nbsp;<span class="op" id="4359177">[</span><span class="op" id="4359178">]</span><span class="builtintype" id="4359179">byte</span><span class="op" id="4359183">)</span>&nbsp;<span class="op" id="4359185">(</span><span class="ident" id="4359186">dnsNames</span><span class="op" id="4359194">,</span>&nbsp;<span class="ident" id="4359196">emailAddresses</span>&nbsp;<span class="op" id="4359211">[</span><span class="op" id="4359212">]</span><span class="builtintype" id="4359213">string</span><span class="op" id="4359219">,</span>&nbsp;<span class="ident" id="4359221">ipAddresses</span>&nbsp;<span class="op" id="4359233">[</span><span class="op" id="4359234">]</span><span class="ident" id="4359235">net</span><span class="op" id="4359238">.</span><span class="ident" id="4359239">IP</span><span class="op" id="4359241">,</span>&nbsp;<span class="ident" id="4359243">err</span>&nbsp;<span class="builtintype" id="4359247">error</span><span class="op" id="4359252">)</span>&nbsp;<span class="op" id="4359254">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359257">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359280">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359316">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359320">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359379">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359383">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359412">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359472">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359532">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359592">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359652">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359707">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359770">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359830">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4359893">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359962">var</span>&nbsp;<span class="ident" id="4359966">seq</span>&nbsp;<span class="ident" id="4359970">asn1</span><span class="op" id="4359974">.</span><span class="ident" id="4359975">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4359985">if</span>&nbsp;<span class="ident" id="4359988">_</span><span class="op" id="4359989">,</span>&nbsp;<span class="ident" id="4359991">err</span>&nbsp;<span class="op" id="4359995">=</span>&nbsp;<span class="ident" id="4359997">asn1</span><span class="op" id="4360001">.</span><span class="ident" id="4360002">Unmarshal</span><span class="op" id="4360011">(</span><span class="ident" id="4360012">value</span><span class="op" id="4360017">,</span>&nbsp;<span class="op" id="4360019">&amp;</span><span class="ident" id="4360020">seq</span><span class="op" id="4360023">)</span><span class="op" id="4360024">;</span>&nbsp;<span class="ident" id="4360026">err</span>&nbsp;<span class="op" id="4360030">!=</span>&nbsp;<span class="ident" id="4360033">nil</span>&nbsp;<span class="op" id="4360037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360041">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360049">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360052">if</span>&nbsp;<span class="op" id="4360055">!</span><span class="ident" id="4360056">seq</span><span class="op" id="4360059">.</span><span class="ident" id="4360060">IsCompound</span>&nbsp;<span class="op" id="4360071">||</span>&nbsp;<span class="ident" id="4360074">seq</span><span class="op" id="4360077">.</span><span class="ident" id="4360078">Tag</span>&nbsp;<span class="op" id="4360082">!=</span>&nbsp;<span class="num" id="4360085">16</span>&nbsp;<span class="op" id="4360088">||</span>&nbsp;<span class="ident" id="4360091">seq</span><span class="op" id="4360094">.</span><span class="ident" id="4360095">Class</span>&nbsp;<span class="op" id="4360101">!=</span>&nbsp;<span class="num" id="4360104">0</span>&nbsp;<span class="op" id="4360106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360110">err</span>&nbsp;<span class="op" id="4360114">=</span>&nbsp;<span class="ident" id="4360116">asn1</span><span class="op" id="4360120">.</span><span class="ident" id="4360121">StructuralError</span><span class="op" id="4360136">{</span><span class="ident" id="4360137">Msg</span><span class="op" id="4360140">:</span>&nbsp;<span class="string" id="4360142">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4360160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360164">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360176">rest</span>&nbsp;<span class="op" id="4360181">:=</span>&nbsp;<span class="ident" id="4360184">seq</span><span class="op" id="4360187">.</span><span class="ident" id="4360188">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360195">for</span>&nbsp;<span class="builtinfunc" id="4360199">len</span><span class="op" id="4360202">(</span><span class="ident" id="4360203">rest</span><span class="op" id="4360207">)</span>&nbsp;<span class="op" id="4360209">&gt;</span>&nbsp;<span class="num" id="4360211">0</span>&nbsp;<span class="op" id="4360213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360217">var</span>&nbsp;<span class="ident" id="4360221">v</span>&nbsp;<span class="ident" id="4360223">asn1</span><span class="op" id="4360227">.</span><span class="ident" id="4360228">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360239">rest</span><span class="op" id="4360243">,</span>&nbsp;<span class="ident" id="4360245">err</span>&nbsp;<span class="op" id="4360249">=</span>&nbsp;<span class="ident" id="4360251">asn1</span><span class="op" id="4360255">.</span><span class="ident" id="4360256">Unmarshal</span><span class="op" id="4360265">(</span><span class="ident" id="4360266">rest</span><span class="op" id="4360270">,</span>&nbsp;<span class="op" id="4360272">&amp;</span><span class="ident" id="4360273">v</span><span class="op" id="4360274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360278">if</span>&nbsp;<span class="ident" id="4360281">err</span>&nbsp;<span class="op" id="4360285">!=</span>&nbsp;<span class="ident" id="4360288">nil</span>&nbsp;<span class="op" id="4360292">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360297">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360310">switch</span>&nbsp;<span class="ident" id="4360317">v</span><span class="op" id="4360318">.</span><span class="ident" id="4360319">Tag</span>&nbsp;<span class="op" id="4360323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360327">case</span>&nbsp;<span class="num" id="4360332">1</span><span class="op" id="4360333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360338">emailAddresses</span>&nbsp;<span class="op" id="4360353">=</span>&nbsp;<span class="builtinfunc" id="4360355">append</span><span class="op" id="4360361">(</span><span class="ident" id="4360362">emailAddresses</span><span class="op" id="4360376">,</span>&nbsp;<span class="builtintype" id="4360378">string</span><span class="op" id="4360384">(</span><span class="ident" id="4360385">v</span><span class="op" id="4360386">.</span><span class="ident" id="4360387">Bytes</span><span class="op" id="4360392">)</span><span class="op" id="4360393">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360397">case</span>&nbsp;<span class="num" id="4360402">2</span><span class="op" id="4360403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360408">dnsNames</span>&nbsp;<span class="op" id="4360417">=</span>&nbsp;<span class="builtinfunc" id="4360419">append</span><span class="op" id="4360425">(</span><span class="ident" id="4360426">dnsNames</span><span class="op" id="4360434">,</span>&nbsp;<span class="builtintype" id="4360436">string</span><span class="op" id="4360442">(</span><span class="ident" id="4360443">v</span><span class="op" id="4360444">.</span><span class="ident" id="4360445">Bytes</span><span class="op" id="4360450">)</span><span class="op" id="4360451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360455">case</span>&nbsp;<span class="num" id="4360460">7</span><span class="op" id="4360461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360466">switch</span>&nbsp;<span class="builtinfunc" id="4360473">len</span><span class="op" id="4360476">(</span><span class="ident" id="4360477">v</span><span class="op" id="4360478">.</span><span class="ident" id="4360479">Bytes</span><span class="op" id="4360484">)</span>&nbsp;<span class="op" id="4360486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360491">case</span>&nbsp;<span class="ident" id="4360496">net</span><span class="op" id="4360499">.</span><span class="ident" id="4360500">IPv4len</span><span class="op" id="4360507">,</span>&nbsp;<span class="ident" id="4360509">net</span><span class="op" id="4360512">.</span><span class="ident" id="4360513">IPv6len</span><span class="op" id="4360520">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360526">ipAddresses</span>&nbsp;<span class="op" id="4360538">=</span>&nbsp;<span class="builtinfunc" id="4360540">append</span><span class="op" id="4360546">(</span><span class="ident" id="4360547">ipAddresses</span><span class="op" id="4360558">,</span>&nbsp;<span class="ident" id="4360560">v</span><span class="op" id="4360561">.</span><span class="ident" id="4360562">Bytes</span><span class="op" id="4360567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360572">default</span><span class="op" id="4360579">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360585">err</span>&nbsp;<span class="op" id="4360589">=</span>&nbsp;<span class="ident" id="4360591">errors</span><span class="op" id="4360597">.</span><span class="ident" id="4360598">New</span><span class="op" id="4360601">(</span><span class="string" id="4360602">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4360654">+</span>&nbsp;<span class="ident" id="4360656">strconv</span><span class="op" id="4360663">.</span><span class="ident" id="4360664">Itoa</span><span class="op" id="4360668">(</span><span class="builtinfunc" id="4360669">len</span><span class="op" id="4360672">(</span><span class="ident" id="4360673">v</span><span class="op" id="4360674">.</span><span class="ident" id="4360675">Bytes</span><span class="op" id="4360680">)</span><span class="op" id="4360681">)</span><span class="op" id="4360682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360688">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360698">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4360705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4360709">return</span><br>
<span class="lineno"></span><span class="op" id="4360716">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4360719">func</span>&nbsp;<span class="ident" id="4360724">parseCertificate</span><span class="op" id="4360740">(</span><span class="ident" id="4360741">in</span>&nbsp;<span class="op" id="4360744">*</span><span class="ident" id="4360745">certificate</span><span class="op" id="4360756">)</span>&nbsp;<span class="op" id="4360758">(</span><span class="op" id="4360759">*</span><span class="ident" id="4360760">Certificate</span><span class="op" id="4360771">,</span>&nbsp;<span class="builtintype" id="4360773">error</span><span class="op" id="4360778">)</span>&nbsp;<span class="op" id="4360780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360783">out</span>&nbsp;<span class="op" id="4360787">:=</span>&nbsp;<span class="builtinfunc" id="4360790">new</span><span class="op" id="4360793">(</span><span class="ident" id="4360794">Certificate</span><span class="op" id="4360805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360808">out</span><span class="op" id="4360811">.</span><span class="ident" id="4360812">Raw</span>&nbsp;<span class="op" id="4360816">=</span>&nbsp;<span class="ident" id="4360818">in</span><span class="op" id="4360820">.</span><span class="ident" id="4360821">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360826">out</span><span class="op" id="4360829">.</span><span class="ident" id="4360830">RawTBSCertificate</span>&nbsp;<span class="op" id="4360848">=</span>&nbsp;<span class="ident" id="4360850">in</span><span class="op" id="4360852">.</span><span class="ident" id="4360853">TBSCertificate</span><span class="op" id="4360867">.</span><span class="ident" id="4360868">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360873">out</span><span class="op" id="4360876">.</span><span class="ident" id="4360877">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4360901">=</span>&nbsp;<span class="ident" id="4360903">in</span><span class="op" id="4360905">.</span><span class="ident" id="4360906">TBSCertificate</span><span class="op" id="4360920">.</span><span class="ident" id="4360921">PublicKey</span><span class="op" id="4360930">.</span><span class="ident" id="4360931">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360936">out</span><span class="op" id="4360939">.</span><span class="ident" id="4360940">RawSubject</span>&nbsp;<span class="op" id="4360951">=</span>&nbsp;<span class="ident" id="4360953">in</span><span class="op" id="4360955">.</span><span class="ident" id="4360956">TBSCertificate</span><span class="op" id="4360970">.</span><span class="ident" id="4360971">Subject</span><span class="op" id="4360978">.</span><span class="ident" id="4360979">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4360990">out</span><span class="op" id="4360993">.</span><span class="ident" id="4360994">RawIssuer</span>&nbsp;<span class="op" id="4361004">=</span>&nbsp;<span class="ident" id="4361006">in</span><span class="op" id="4361008">.</span><span class="ident" id="4361009">TBSCertificate</span><span class="op" id="4361023">.</span><span class="ident" id="4361024">Issuer</span><span class="op" id="4361030">.</span><span class="ident" id="4361031">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361043">out</span><span class="op" id="4361046">.</span><span class="ident" id="4361047">Signature</span>&nbsp;<span class="op" id="4361057">=</span>&nbsp;<span class="ident" id="4361059">in</span><span class="op" id="4361061">.</span><span class="ident" id="4361062">SignatureValue</span><span class="op" id="4361076">.</span><span class="ident" id="4361077">RightAlign</span><span class="op" id="4361087">(</span><span class="op" id="4361088">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361091">out</span><span class="op" id="4361094">.</span><span class="ident" id="4361095">SignatureAlgorithm</span>&nbsp;<span class="op" id="4361114">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361118">getSignatureAlgorithmFromOID</span><span class="op" id="4361146">(</span><span class="ident" id="4361147">in</span><span class="op" id="4361149">.</span><span class="ident" id="4361150">TBSCertificate</span><span class="op" id="4361164">.</span><span class="ident" id="4361165">SignatureAlgorithm</span><span class="op" id="4361183">.</span><span class="ident" id="4361184">Algorithm</span><span class="op" id="4361193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361197">out</span><span class="op" id="4361200">.</span><span class="ident" id="4361201">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4361220">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361224">getPublicKeyAlgorithmFromOID</span><span class="op" id="4361252">(</span><span class="ident" id="4361253">in</span><span class="op" id="4361255">.</span><span class="ident" id="4361256">TBSCertificate</span><span class="op" id="4361270">.</span><span class="ident" id="4361271">PublicKey</span><span class="op" id="4361280">.</span><span class="ident" id="4361281">Algorithm</span><span class="op" id="4361290">.</span><span class="ident" id="4361291">Algorithm</span><span class="op" id="4361300">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361303">var</span>&nbsp;<span class="ident" id="4361307">err</span>&nbsp;<span class="builtintype" id="4361311">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361318">out</span><span class="op" id="4361321">.</span><span class="ident" id="4361322">PublicKey</span><span class="op" id="4361331">,</span>&nbsp;<span class="ident" id="4361333">err</span>&nbsp;<span class="op" id="4361337">=</span>&nbsp;<span class="ident" id="4361339">parsePublicKey</span><span class="op" id="4361353">(</span><span class="ident" id="4361354">out</span><span class="op" id="4361357">.</span><span class="ident" id="4361358">PublicKeyAlgorithm</span><span class="op" id="4361376">,</span>&nbsp;<span class="op" id="4361378">&amp;</span><span class="ident" id="4361379">in</span><span class="op" id="4361381">.</span><span class="ident" id="4361382">TBSCertificate</span><span class="op" id="4361396">.</span><span class="ident" id="4361397">PublicKey</span><span class="op" id="4361406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361409">if</span>&nbsp;<span class="ident" id="4361412">err</span>&nbsp;<span class="op" id="4361416">!=</span>&nbsp;<span class="ident" id="4361419">nil</span>&nbsp;<span class="op" id="4361423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361427">return</span>&nbsp;<span class="ident" id="4361434">nil</span><span class="op" id="4361437">,</span>&nbsp;<span class="ident" id="4361439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361444">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361448">if</span>&nbsp;<span class="ident" id="4361451">in</span><span class="op" id="4361453">.</span><span class="ident" id="4361454">TBSCertificate</span><span class="op" id="4361468">.</span><span class="ident" id="4361469">SerialNumber</span><span class="op" id="4361481">.</span><span class="ident" id="4361482">Sign</span><span class="op" id="4361486">(</span><span class="op" id="4361487">)</span>&nbsp;<span class="op" id="4361489">&lt;</span>&nbsp;<span class="num" id="4361491">0</span>&nbsp;<span class="op" id="4361493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361497">return</span>&nbsp;<span class="ident" id="4361504">nil</span><span class="op" id="4361507">,</span>&nbsp;<span class="ident" id="4361509">errors</span><span class="op" id="4361515">.</span><span class="ident" id="4361516">New</span><span class="op" id="4361519">(</span><span class="string" id="4361520">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4361550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361557">out</span><span class="op" id="4361560">.</span><span class="ident" id="4361561">Version</span>&nbsp;<span class="op" id="4361569">=</span>&nbsp;<span class="ident" id="4361571">in</span><span class="op" id="4361573">.</span><span class="ident" id="4361574">TBSCertificate</span><span class="op" id="4361588">.</span><span class="ident" id="4361589">Version</span>&nbsp;<span class="op" id="4361597">+</span>&nbsp;<span class="num" id="4361599">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361602">out</span><span class="op" id="4361605">.</span><span class="ident" id="4361606">SerialNumber</span>&nbsp;<span class="op" id="4361619">=</span>&nbsp;<span class="ident" id="4361621">in</span><span class="op" id="4361623">.</span><span class="ident" id="4361624">TBSCertificate</span><span class="op" id="4361638">.</span><span class="ident" id="4361639">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361654">var</span>&nbsp;<span class="ident" id="4361658">issuer</span><span class="op" id="4361664">,</span>&nbsp;<span class="ident" id="4361666">subject</span>&nbsp;<span class="ident" id="4361674">pkix</span><span class="op" id="4361678">.</span><span class="ident" id="4361679">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361692">if</span>&nbsp;<span class="ident" id="4361695">_</span><span class="op" id="4361696">,</span>&nbsp;<span class="ident" id="4361698">err</span>&nbsp;<span class="op" id="4361702">:=</span>&nbsp;<span class="ident" id="4361705">asn1</span><span class="op" id="4361709">.</span><span class="ident" id="4361710">Unmarshal</span><span class="op" id="4361719">(</span><span class="ident" id="4361720">in</span><span class="op" id="4361722">.</span><span class="ident" id="4361723">TBSCertificate</span><span class="op" id="4361737">.</span><span class="ident" id="4361738">Subject</span><span class="op" id="4361745">.</span><span class="ident" id="4361746">FullBytes</span><span class="op" id="4361755">,</span>&nbsp;<span class="op" id="4361757">&amp;</span><span class="ident" id="4361758">subject</span><span class="op" id="4361765">)</span><span class="op" id="4361766">;</span>&nbsp;<span class="ident" id="4361768">err</span>&nbsp;<span class="op" id="4361772">!=</span>&nbsp;<span class="ident" id="4361775">nil</span>&nbsp;<span class="op" id="4361779">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361783">return</span>&nbsp;<span class="ident" id="4361790">nil</span><span class="op" id="4361793">,</span>&nbsp;<span class="ident" id="4361795">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361803">if</span>&nbsp;<span class="ident" id="4361806">_</span><span class="op" id="4361807">,</span>&nbsp;<span class="ident" id="4361809">err</span>&nbsp;<span class="op" id="4361813">:=</span>&nbsp;<span class="ident" id="4361816">asn1</span><span class="op" id="4361820">.</span><span class="ident" id="4361821">Unmarshal</span><span class="op" id="4361830">(</span><span class="ident" id="4361831">in</span><span class="op" id="4361833">.</span><span class="ident" id="4361834">TBSCertificate</span><span class="op" id="4361848">.</span><span class="ident" id="4361849">Issuer</span><span class="op" id="4361855">.</span><span class="ident" id="4361856">FullBytes</span><span class="op" id="4361865">,</span>&nbsp;<span class="op" id="4361867">&amp;</span><span class="ident" id="4361868">issuer</span><span class="op" id="4361874">)</span><span class="op" id="4361875">;</span>&nbsp;<span class="ident" id="4361877">err</span>&nbsp;<span class="op" id="4361881">!=</span>&nbsp;<span class="ident" id="4361884">nil</span>&nbsp;<span class="op" id="4361888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4361892">return</span>&nbsp;<span class="ident" id="4361899">nil</span><span class="op" id="4361902">,</span>&nbsp;<span class="ident" id="4361904">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4361909">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361913">out</span><span class="op" id="4361916">.</span><span class="ident" id="4361917">Issuer</span><span class="op" id="4361923">.</span><span class="ident" id="4361924">FillFromRDNSequence</span><span class="op" id="4361943">(</span><span class="op" id="4361944">&amp;</span><span class="ident" id="4361945">issuer</span><span class="op" id="4361951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361954">out</span><span class="op" id="4361957">.</span><span class="ident" id="4361958">Subject</span><span class="op" id="4361965">.</span><span class="ident" id="4361966">FillFromRDNSequence</span><span class="op" id="4361985">(</span><span class="op" id="4361986">&amp;</span><span class="ident" id="4361987">subject</span><span class="op" id="4361994">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4361998">out</span><span class="op" id="4362001">.</span><span class="ident" id="4362002">NotBefore</span>&nbsp;<span class="op" id="4362012">=</span>&nbsp;<span class="ident" id="4362014">in</span><span class="op" id="4362016">.</span><span class="ident" id="4362017">TBSCertificate</span><span class="op" id="4362031">.</span><span class="ident" id="4362032">Validity</span><span class="op" id="4362040">.</span><span class="ident" id="4362041">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362052">out</span><span class="op" id="4362055">.</span><span class="ident" id="4362056">NotAfter</span>&nbsp;<span class="op" id="4362065">=</span>&nbsp;<span class="ident" id="4362067">in</span><span class="op" id="4362069">.</span><span class="ident" id="4362070">TBSCertificate</span><span class="op" id="4362084">.</span><span class="ident" id="4362085">Validity</span><span class="op" id="4362093">.</span><span class="ident" id="4362094">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362105">for</span>&nbsp;<span class="ident" id="4362109">_</span><span class="op" id="4362110">,</span>&nbsp;<span class="ident" id="4362112">e</span>&nbsp;<span class="op" id="4362114">:=</span>&nbsp;<span class="keyword" id="4362117">range</span>&nbsp;<span class="ident" id="4362123">in</span><span class="op" id="4362125">.</span><span class="ident" id="4362126">TBSCertificate</span><span class="op" id="4362140">.</span><span class="ident" id="4362141">Extensions</span>&nbsp;<span class="op" id="4362152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362156">out</span><span class="op" id="4362159">.</span><span class="ident" id="4362160">Extensions</span>&nbsp;<span class="op" id="4362171">=</span>&nbsp;<span class="builtinfunc" id="4362173">append</span><span class="op" id="4362179">(</span><span class="ident" id="4362180">out</span><span class="op" id="4362183">.</span><span class="ident" id="4362184">Extensions</span><span class="op" id="4362194">,</span>&nbsp;<span class="ident" id="4362196">e</span><span class="op" id="4362197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362202">if</span>&nbsp;<span class="builtinfunc" id="4362205">len</span><span class="op" id="4362208">(</span><span class="ident" id="4362209">e</span><span class="op" id="4362210">.</span><span class="ident" id="4362211">Id</span><span class="op" id="4362213">)</span>&nbsp;<span class="op" id="4362215">==</span>&nbsp;<span class="num" id="4362218">4</span>&nbsp;<span class="op" id="4362220">&amp;&amp;</span>&nbsp;<span class="ident" id="4362223">e</span><span class="op" id="4362224">.</span><span class="ident" id="4362225">Id</span><span class="op" id="4362227">[</span><span class="num" id="4362228">0</span><span class="op" id="4362229">]</span>&nbsp;<span class="op" id="4362231">==</span>&nbsp;<span class="num" id="4362234">2</span>&nbsp;<span class="op" id="4362236">&amp;&amp;</span>&nbsp;<span class="ident" id="4362239">e</span><span class="op" id="4362240">.</span><span class="ident" id="4362241">Id</span><span class="op" id="4362243">[</span><span class="num" id="4362244">1</span><span class="op" id="4362245">]</span>&nbsp;<span class="op" id="4362247">==</span>&nbsp;<span class="num" id="4362250">5</span>&nbsp;<span class="op" id="4362252">&amp;&amp;</span>&nbsp;<span class="ident" id="4362255">e</span><span class="op" id="4362256">.</span><span class="ident" id="4362257">Id</span><span class="op" id="4362259">[</span><span class="num" id="4362260">2</span><span class="op" id="4362261">]</span>&nbsp;<span class="op" id="4362263">==</span>&nbsp;<span class="num" id="4362266">29</span>&nbsp;<span class="op" id="4362269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362274">switch</span>&nbsp;<span class="ident" id="4362281">e</span><span class="op" id="4362282">.</span><span class="ident" id="4362283">Id</span><span class="op" id="4362285">[</span><span class="num" id="4362286">3</span><span class="op" id="4362287">]</span>&nbsp;<span class="op" id="4362289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362294">case</span>&nbsp;<span class="num" id="4362299">15</span><span class="op" id="4362301">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4362307">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362332">var</span>&nbsp;<span class="ident" id="4362336">usageBits</span>&nbsp;<span class="ident" id="4362346">asn1</span><span class="op" id="4362350">.</span><span class="ident" id="4362351">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362365">_</span><span class="op" id="4362366">,</span>&nbsp;<span class="ident" id="4362368">err</span>&nbsp;<span class="op" id="4362372">:=</span>&nbsp;<span class="ident" id="4362375">asn1</span><span class="op" id="4362379">.</span><span class="ident" id="4362380">Unmarshal</span><span class="op" id="4362389">(</span><span class="ident" id="4362390">e</span><span class="op" id="4362391">.</span><span class="ident" id="4362392">Value</span><span class="op" id="4362397">,</span>&nbsp;<span class="op" id="4362399">&amp;</span><span class="ident" id="4362400">usageBits</span><span class="op" id="4362409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362416">if</span>&nbsp;<span class="ident" id="4362419">err</span>&nbsp;<span class="op" id="4362423">==</span>&nbsp;<span class="ident" id="4362426">nil</span>&nbsp;<span class="op" id="4362430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362437">var</span>&nbsp;<span class="ident" id="4362441">usage</span>&nbsp;<span class="builtintype" id="4362447">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362456">for</span>&nbsp;<span class="ident" id="4362460">i</span>&nbsp;<span class="op" id="4362462">:=</span>&nbsp;<span class="num" id="4362465">0</span><span class="op" id="4362466">;</span>&nbsp;<span class="ident" id="4362468">i</span>&nbsp;<span class="op" id="4362470">&lt;</span>&nbsp;<span class="num" id="4362472">9</span><span class="op" id="4362473">;</span>&nbsp;<span class="ident" id="4362475">i</span><span class="op" id="4362476">++</span>&nbsp;<span class="op" id="4362479">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362487">if</span>&nbsp;<span class="ident" id="4362490">usageBits</span><span class="op" id="4362499">.</span><span class="ident" id="4362500">At</span><span class="op" id="4362502">(</span><span class="ident" id="4362503">i</span><span class="op" id="4362504">)</span>&nbsp;<span class="op" id="4362506">!=</span>&nbsp;<span class="num" id="4362509">0</span>&nbsp;<span class="op" id="4362511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362520">usage</span>&nbsp;<span class="op" id="4362526">|=</span>&nbsp;<span class="num" id="4362529">1</span>&nbsp;<span class="op" id="4362531">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4362534">uint</span><span class="op" id="4362538">(</span><span class="ident" id="4362539">i</span><span class="op" id="4362540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362562">out</span><span class="op" id="4362565">.</span><span class="ident" id="4362566">KeyUsage</span>&nbsp;<span class="op" id="4362575">=</span>&nbsp;<span class="ident" id="4362577">KeyUsage</span><span class="op" id="4362585">(</span><span class="ident" id="4362586">usage</span><span class="op" id="4362591">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362598">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362616">case</span>&nbsp;<span class="num" id="4362621">19</span><span class="op" id="4362623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4362629">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362654">var</span>&nbsp;<span class="ident" id="4362658">constraints</span>&nbsp;<span class="ident" id="4362670">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362691">_</span><span class="op" id="4362692">,</span>&nbsp;<span class="ident" id="4362694">err</span>&nbsp;<span class="op" id="4362698">:=</span>&nbsp;<span class="ident" id="4362701">asn1</span><span class="op" id="4362705">.</span><span class="ident" id="4362706">Unmarshal</span><span class="op" id="4362715">(</span><span class="ident" id="4362716">e</span><span class="op" id="4362717">.</span><span class="ident" id="4362718">Value</span><span class="op" id="4362723">,</span>&nbsp;<span class="op" id="4362725">&amp;</span><span class="ident" id="4362726">constraints</span><span class="op" id="4362737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362744">if</span>&nbsp;<span class="ident" id="4362747">err</span>&nbsp;<span class="op" id="4362751">==</span>&nbsp;<span class="ident" id="4362754">nil</span>&nbsp;<span class="op" id="4362758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362765">out</span><span class="op" id="4362768">.</span><span class="ident" id="4362769">BasicConstraintsValid</span>&nbsp;<span class="op" id="4362791">=</span>&nbsp;<span class="builtintype" id="4362793">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362803">out</span><span class="op" id="4362806">.</span><span class="ident" id="4362807">IsCA</span>&nbsp;<span class="op" id="4362812">=</span>&nbsp;<span class="ident" id="4362814">constraints</span><span class="op" id="4362825">.</span><span class="ident" id="4362826">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362836">out</span><span class="op" id="4362839">.</span><span class="ident" id="4362840">MaxPathLen</span>&nbsp;<span class="op" id="4362851">=</span>&nbsp;<span class="ident" id="4362853">constraints</span><span class="op" id="4362864">.</span><span class="ident" id="4362865">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362881">out</span><span class="op" id="4362884">.</span><span class="ident" id="4362885">MaxPathLenZero</span>&nbsp;<span class="op" id="4362900">=</span>&nbsp;<span class="ident" id="4362902">out</span><span class="op" id="4362905">.</span><span class="ident" id="4362906">MaxPathLen</span>&nbsp;<span class="op" id="4362917">==</span>&nbsp;<span class="num" id="4362920">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362927">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4362940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4362945">case</span>&nbsp;<span class="num" id="4362950">17</span><span class="op" id="4362952">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4362958">out</span><span class="op" id="4362961">.</span><span class="ident" id="4362962">DNSNames</span><span class="op" id="4362970">,</span>&nbsp;<span class="ident" id="4362972">out</span><span class="op" id="4362975">.</span><span class="ident" id="4362976">EmailAddresses</span><span class="op" id="4362990">,</span>&nbsp;<span class="ident" id="4362992">out</span><span class="op" id="4362995">.</span><span class="ident" id="4362996">IPAddresses</span><span class="op" id="4363007">,</span>&nbsp;<span class="ident" id="4363009">err</span>&nbsp;<span class="op" id="4363013">=</span>&nbsp;<span class="ident" id="4363015">parseSANExtension</span><span class="op" id="4363032">(</span><span class="ident" id="4363033">e</span><span class="op" id="4363034">.</span><span class="ident" id="4363035">Value</span><span class="op" id="4363040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363046">if</span>&nbsp;<span class="ident" id="4363049">err</span>&nbsp;<span class="op" id="4363053">!=</span>&nbsp;<span class="ident" id="4363056">nil</span>&nbsp;<span class="op" id="4363060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363067">return</span>&nbsp;<span class="ident" id="4363074">nil</span><span class="op" id="4363077">,</span>&nbsp;<span class="ident" id="4363079">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363094">if</span>&nbsp;<span class="builtinfunc" id="4363097">len</span><span class="op" id="4363100">(</span><span class="ident" id="4363101">out</span><span class="op" id="4363104">.</span><span class="ident" id="4363105">DNSNames</span><span class="op" id="4363113">)</span>&nbsp;<span class="op" id="4363115">&gt;</span>&nbsp;<span class="num" id="4363117">0</span>&nbsp;<span class="op" id="4363119">||</span>&nbsp;<span class="builtinfunc" id="4363122">len</span><span class="op" id="4363125">(</span><span class="ident" id="4363126">out</span><span class="op" id="4363129">.</span><span class="ident" id="4363130">EmailAddresses</span><span class="op" id="4363144">)</span>&nbsp;<span class="op" id="4363146">&gt;</span>&nbsp;<span class="num" id="4363148">0</span>&nbsp;<span class="op" id="4363150">||</span>&nbsp;<span class="builtinfunc" id="4363153">len</span><span class="op" id="4363156">(</span><span class="ident" id="4363157">out</span><span class="op" id="4363160">.</span><span class="ident" id="4363161">IPAddresses</span><span class="op" id="4363172">)</span>&nbsp;<span class="op" id="4363174">&gt;</span>&nbsp;<span class="num" id="4363176">0</span>&nbsp;<span class="op" id="4363178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363185">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363204">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363255">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363304">case</span>&nbsp;<span class="num" id="4363309">30</span><span class="op" id="4363311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363317">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363344">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363382">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363452">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363523">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363530">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363598">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363605">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363642">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363691">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363751">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363811">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4363818">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363860">var</span>&nbsp;<span class="ident" id="4363864">constraints</span>&nbsp;<span class="ident" id="4363876">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4363896">_</span><span class="op" id="4363897">,</span>&nbsp;<span class="ident" id="4363899">err</span>&nbsp;<span class="op" id="4363903">:=</span>&nbsp;<span class="ident" id="4363906">asn1</span><span class="op" id="4363910">.</span><span class="ident" id="4363911">Unmarshal</span><span class="op" id="4363920">(</span><span class="ident" id="4363921">e</span><span class="op" id="4363922">.</span><span class="ident" id="4363923">Value</span><span class="op" id="4363928">,</span>&nbsp;<span class="op" id="4363930">&amp;</span><span class="ident" id="4363931">constraints</span><span class="op" id="4363942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363948">if</span>&nbsp;<span class="ident" id="4363951">err</span>&nbsp;<span class="op" id="4363955">!=</span>&nbsp;<span class="ident" id="4363958">nil</span>&nbsp;<span class="op" id="4363962">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363969">return</span>&nbsp;<span class="ident" id="4363976">nil</span><span class="op" id="4363979">,</span>&nbsp;<span class="ident" id="4363981">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4363989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4363996">if</span>&nbsp;<span class="builtinfunc" id="4363999">len</span><span class="op" id="4364002">(</span><span class="ident" id="4364003">constraints</span><span class="op" id="4364014">.</span><span class="ident" id="4364015">Excluded</span><span class="op" id="4364023">)</span>&nbsp;<span class="op" id="4364025">&gt;</span>&nbsp;<span class="num" id="4364027">0</span>&nbsp;<span class="op" id="4364029">&amp;&amp;</span>&nbsp;<span class="ident" id="4364032">e</span><span class="op" id="4364033">.</span><span class="ident" id="4364034">Critical</span>&nbsp;<span class="op" id="4364043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364050">return</span>&nbsp;<span class="ident" id="4364057">out</span><span class="op" id="4364060">,</span>&nbsp;<span class="ident" id="4364062">UnhandledCriticalExtension</span><span class="op" id="4364088">{</span><span class="op" id="4364089">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364102">for</span>&nbsp;<span class="ident" id="4364106">_</span><span class="op" id="4364107">,</span>&nbsp;<span class="ident" id="4364109">subtree</span>&nbsp;<span class="op" id="4364117">:=</span>&nbsp;<span class="keyword" id="4364120">range</span>&nbsp;<span class="ident" id="4364126">constraints</span><span class="op" id="4364137">.</span><span class="ident" id="4364138">Permitted</span>&nbsp;<span class="op" id="4364148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364155">if</span>&nbsp;<span class="builtinfunc" id="4364158">len</span><span class="op" id="4364161">(</span><span class="ident" id="4364162">subtree</span><span class="op" id="4364169">.</span><span class="ident" id="4364170">Name</span><span class="op" id="4364174">)</span>&nbsp;<span class="op" id="4364176">==</span>&nbsp;<span class="num" id="4364179">0</span>&nbsp;<span class="op" id="4364181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364189">if</span>&nbsp;<span class="ident" id="4364192">e</span><span class="op" id="4364193">.</span><span class="ident" id="4364194">Critical</span>&nbsp;<span class="op" id="4364203">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364212">return</span>&nbsp;<span class="ident" id="4364219">out</span><span class="op" id="4364222">,</span>&nbsp;<span class="ident" id="4364224">UnhandledCriticalExtension</span><span class="op" id="4364250">{</span><span class="op" id="4364251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364267">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364288">out</span><span class="op" id="4364291">.</span><span class="ident" id="4364292">PermittedDNSDomains</span>&nbsp;<span class="op" id="4364312">=</span>&nbsp;<span class="builtinfunc" id="4364314">append</span><span class="op" id="4364320">(</span><span class="ident" id="4364321">out</span><span class="op" id="4364324">.</span><span class="ident" id="4364325">PermittedDNSDomains</span><span class="op" id="4364344">,</span>&nbsp;<span class="ident" id="4364346">subtree</span><span class="op" id="4364353">.</span><span class="ident" id="4364354">Name</span><span class="op" id="4364358">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4364364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364370">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364383">case</span>&nbsp;<span class="num" id="4364388">31</span><span class="op" id="4364390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364396">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364423">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364500">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364507">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364547">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364622">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364687">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364754">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364761">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4364860">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4364932">var</span>&nbsp;<span class="ident" id="4364936">cdp</span>&nbsp;<span class="op" id="4364940">[</span><span class="op" id="4364941">]</span><span class="ident" id="4364942">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4364964">_</span><span class="op" id="4364965">,</span>&nbsp;<span class="ident" id="4364967">err</span>&nbsp;<span class="op" id="4364971">:=</span>&nbsp;<span class="ident" id="4364974">asn1</span><span class="op" id="4364978">.</span><span class="ident" id="4364979">Unmarshal</span><span class="op" id="4364988">(</span><span class="ident" id="4364989">e</span><span class="op" id="4364990">.</span><span class="ident" id="4364991">Value</span><span class="op" id="4364996">,</span>&nbsp;<span class="op" id="4364998">&amp;</span><span class="ident" id="4364999">cdp</span><span class="op" id="4365002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365008">if</span>&nbsp;<span class="ident" id="4365011">err</span>&nbsp;<span class="op" id="4365015">!=</span>&nbsp;<span class="ident" id="4365018">nil</span>&nbsp;<span class="op" id="4365022">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365029">return</span>&nbsp;<span class="ident" id="4365036">nil</span><span class="op" id="4365039">,</span>&nbsp;<span class="ident" id="4365041">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365056">for</span>&nbsp;<span class="ident" id="4365060">_</span><span class="op" id="4365061">,</span>&nbsp;<span class="ident" id="4365063">dp</span>&nbsp;<span class="op" id="4365066">:=</span>&nbsp;<span class="keyword" id="4365069">range</span>&nbsp;<span class="ident" id="4365075">cdp</span>&nbsp;<span class="op" id="4365079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365086">var</span>&nbsp;<span class="ident" id="4365090">n</span>&nbsp;<span class="ident" id="4365092">asn1</span><span class="op" id="4365096">.</span><span class="ident" id="4365097">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365111">_</span><span class="op" id="4365112">,</span>&nbsp;<span class="ident" id="4365114">err</span>&nbsp;<span class="op" id="4365118">=</span>&nbsp;<span class="ident" id="4365120">asn1</span><span class="op" id="4365124">.</span><span class="ident" id="4365125">Unmarshal</span><span class="op" id="4365134">(</span><span class="ident" id="4365135">dp</span><span class="op" id="4365137">.</span><span class="ident" id="4365138">DistributionPoint</span><span class="op" id="4365155">.</span><span class="ident" id="4365156">FullName</span><span class="op" id="4365164">.</span><span class="ident" id="4365165">Bytes</span><span class="op" id="4365170">,</span>&nbsp;<span class="op" id="4365172">&amp;</span><span class="ident" id="4365173">n</span><span class="op" id="4365174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365181">if</span>&nbsp;<span class="ident" id="4365184">err</span>&nbsp;<span class="op" id="4365188">!=</span>&nbsp;<span class="ident" id="4365191">nil</span>&nbsp;<span class="op" id="4365195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365203">return</span>&nbsp;<span class="ident" id="4365210">nil</span><span class="op" id="4365213">,</span>&nbsp;<span class="ident" id="4365215">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365232">if</span>&nbsp;<span class="ident" id="4365235">n</span><span class="op" id="4365236">.</span><span class="ident" id="4365237">Tag</span>&nbsp;<span class="op" id="4365241">==</span>&nbsp;<span class="num" id="4365244">6</span>&nbsp;<span class="op" id="4365246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365254">out</span><span class="op" id="4365257">.</span><span class="ident" id="4365258">CRLDistributionPoints</span>&nbsp;<span class="op" id="4365280">=</span>&nbsp;<span class="builtinfunc" id="4365282">append</span><span class="op" id="4365288">(</span><span class="ident" id="4365289">out</span><span class="op" id="4365292">.</span><span class="ident" id="4365293">CRLDistributionPoints</span><span class="op" id="4365314">,</span>&nbsp;<span class="builtintype" id="4365316">string</span><span class="op" id="4365322">(</span><span class="ident" id="4365323">n</span><span class="op" id="4365324">.</span><span class="ident" id="4365325">Bytes</span><span class="op" id="4365330">)</span><span class="op" id="4365331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365350">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365363">case</span>&nbsp;<span class="num" id="4365368">35</span><span class="op" id="4365370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365376">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365401">var</span>&nbsp;<span class="ident" id="4365405">a</span>&nbsp;<span class="ident" id="4365407">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365421">_</span><span class="op" id="4365422">,</span>&nbsp;<span class="ident" id="4365424">err</span>&nbsp;<span class="op" id="4365428">=</span>&nbsp;<span class="ident" id="4365430">asn1</span><span class="op" id="4365434">.</span><span class="ident" id="4365435">Unmarshal</span><span class="op" id="4365444">(</span><span class="ident" id="4365445">e</span><span class="op" id="4365446">.</span><span class="ident" id="4365447">Value</span><span class="op" id="4365452">,</span>&nbsp;<span class="op" id="4365454">&amp;</span><span class="ident" id="4365455">a</span><span class="op" id="4365456">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365462">if</span>&nbsp;<span class="ident" id="4365465">err</span>&nbsp;<span class="op" id="4365469">!=</span>&nbsp;<span class="ident" id="4365472">nil</span>&nbsp;<span class="op" id="4365476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365483">return</span>&nbsp;<span class="ident" id="4365490">nil</span><span class="op" id="4365493">,</span>&nbsp;<span class="ident" id="4365495">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365509">out</span><span class="op" id="4365512">.</span><span class="ident" id="4365513">AuthorityKeyId</span>&nbsp;<span class="op" id="4365528">=</span>&nbsp;<span class="ident" id="4365530">a</span><span class="op" id="4365531">.</span><span class="ident" id="4365532">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365539">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365552">case</span>&nbsp;<span class="num" id="4365557">37</span><span class="op" id="4365559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365565">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365613">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365673">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365680">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365748">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4365755">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365798">var</span>&nbsp;<span class="ident" id="4365802">keyUsage</span>&nbsp;<span class="op" id="4365811">[</span><span class="op" id="4365812">]</span><span class="ident" id="4365813">asn1</span><span class="op" id="4365817">.</span><span class="ident" id="4365818">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4365839">_</span><span class="op" id="4365840">,</span>&nbsp;<span class="ident" id="4365842">err</span>&nbsp;<span class="op" id="4365846">=</span>&nbsp;<span class="ident" id="4365848">asn1</span><span class="op" id="4365852">.</span><span class="ident" id="4365853">Unmarshal</span><span class="op" id="4365862">(</span><span class="ident" id="4365863">e</span><span class="op" id="4365864">.</span><span class="ident" id="4365865">Value</span><span class="op" id="4365870">,</span>&nbsp;<span class="op" id="4365872">&amp;</span><span class="ident" id="4365873">keyUsage</span><span class="op" id="4365881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365887">if</span>&nbsp;<span class="ident" id="4365890">err</span>&nbsp;<span class="op" id="4365894">!=</span>&nbsp;<span class="ident" id="4365897">nil</span>&nbsp;<span class="op" id="4365901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365908">return</span>&nbsp;<span class="ident" id="4365915">nil</span><span class="op" id="4365918">,</span>&nbsp;<span class="ident" id="4365920">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4365928">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365935">for</span>&nbsp;<span class="ident" id="4365939">_</span><span class="op" id="4365940">,</span>&nbsp;<span class="ident" id="4365942">u</span>&nbsp;<span class="op" id="4365944">:=</span>&nbsp;<span class="keyword" id="4365947">range</span>&nbsp;<span class="ident" id="4365953">keyUsage</span>&nbsp;<span class="op" id="4365962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4365969">if</span>&nbsp;<span class="ident" id="4365972">extKeyUsage</span><span class="op" id="4365983">,</span>&nbsp;<span class="ident" id="4365985">ok</span>&nbsp;<span class="op" id="4365988">:=</span>&nbsp;<span class="ident" id="4365991">extKeyUsageFromOID</span><span class="op" id="4366009">(</span><span class="ident" id="4366010">u</span><span class="op" id="4366011">)</span><span class="op" id="4366012">;</span>&nbsp;<span class="ident" id="4366014">ok</span>&nbsp;<span class="op" id="4366017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366025">out</span><span class="op" id="4366028">.</span><span class="ident" id="4366029">ExtKeyUsage</span>&nbsp;<span class="op" id="4366041">=</span>&nbsp;<span class="builtinfunc" id="4366043">append</span><span class="op" id="4366049">(</span><span class="ident" id="4366050">out</span><span class="op" id="4366053">.</span><span class="ident" id="4366054">ExtKeyUsage</span><span class="op" id="4366065">,</span>&nbsp;<span class="ident" id="4366067">extKeyUsage</span><span class="op" id="4366078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366085">}</span>&nbsp;<span class="keyword" id="4366087">else</span>&nbsp;<span class="op" id="4366092">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366100">out</span><span class="op" id="4366103">.</span><span class="ident" id="4366104">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4366123">=</span>&nbsp;<span class="builtinfunc" id="4366125">append</span><span class="op" id="4366131">(</span><span class="ident" id="4366132">out</span><span class="op" id="4366135">.</span><span class="ident" id="4366136">UnknownExtKeyUsage</span><span class="op" id="4366154">,</span>&nbsp;<span class="ident" id="4366156">u</span><span class="op" id="4366157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366177">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366190">case</span>&nbsp;<span class="num" id="4366195">14</span><span class="op" id="4366197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366203">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366228">var</span>&nbsp;<span class="ident" id="4366232">keyid</span>&nbsp;<span class="op" id="4366238">[</span><span class="op" id="4366239">]</span><span class="builtintype" id="4366240">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366249">_</span><span class="op" id="4366250">,</span>&nbsp;<span class="ident" id="4366252">err</span>&nbsp;<span class="op" id="4366256">=</span>&nbsp;<span class="ident" id="4366258">asn1</span><span class="op" id="4366262">.</span><span class="ident" id="4366263">Unmarshal</span><span class="op" id="4366272">(</span><span class="ident" id="4366273">e</span><span class="op" id="4366274">.</span><span class="ident" id="4366275">Value</span><span class="op" id="4366280">,</span>&nbsp;<span class="op" id="4366282">&amp;</span><span class="ident" id="4366283">keyid</span><span class="op" id="4366288">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366294">if</span>&nbsp;<span class="ident" id="4366297">err</span>&nbsp;<span class="op" id="4366301">!=</span>&nbsp;<span class="ident" id="4366304">nil</span>&nbsp;<span class="op" id="4366308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366315">return</span>&nbsp;<span class="ident" id="4366322">nil</span><span class="op" id="4366325">,</span>&nbsp;<span class="ident" id="4366327">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366341">out</span><span class="op" id="4366344">.</span><span class="ident" id="4366345">SubjectKeyId</span>&nbsp;<span class="op" id="4366358">=</span>&nbsp;<span class="ident" id="4366360">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366370">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366383">case</span>&nbsp;<span class="num" id="4366388">32</span><span class="op" id="4366390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366396">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366442">var</span>&nbsp;<span class="ident" id="4366446">policies</span>&nbsp;<span class="op" id="4366455">[</span><span class="op" id="4366456">]</span><span class="ident" id="4366457">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366479">if</span>&nbsp;<span class="ident" id="4366482">_</span><span class="op" id="4366483">,</span>&nbsp;<span class="ident" id="4366485">err</span>&nbsp;<span class="op" id="4366489">=</span>&nbsp;<span class="ident" id="4366491">asn1</span><span class="op" id="4366495">.</span><span class="ident" id="4366496">Unmarshal</span><span class="op" id="4366505">(</span><span class="ident" id="4366506">e</span><span class="op" id="4366507">.</span><span class="ident" id="4366508">Value</span><span class="op" id="4366513">,</span>&nbsp;<span class="op" id="4366515">&amp;</span><span class="ident" id="4366516">policies</span><span class="op" id="4366524">)</span><span class="op" id="4366525">;</span>&nbsp;<span class="ident" id="4366527">err</span>&nbsp;<span class="op" id="4366531">!=</span>&nbsp;<span class="ident" id="4366534">nil</span>&nbsp;<span class="op" id="4366538">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366545">return</span>&nbsp;<span class="ident" id="4366552">nil</span><span class="op" id="4366555">,</span>&nbsp;<span class="ident" id="4366557">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366571">out</span><span class="op" id="4366574">.</span><span class="ident" id="4366575">PolicyIdentifiers</span>&nbsp;<span class="op" id="4366593">=</span>&nbsp;<span class="builtinfunc" id="4366595">make</span><span class="op" id="4366599">(</span><span class="op" id="4366600">[</span><span class="op" id="4366601">]</span><span class="ident" id="4366602">asn1</span><span class="op" id="4366606">.</span><span class="ident" id="4366607">ObjectIdentifier</span><span class="op" id="4366623">,</span>&nbsp;<span class="builtinfunc" id="4366625">len</span><span class="op" id="4366628">(</span><span class="ident" id="4366629">policies</span><span class="op" id="4366637">)</span><span class="op" id="4366638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366644">for</span>&nbsp;<span class="ident" id="4366648">i</span><span class="op" id="4366649">,</span>&nbsp;<span class="ident" id="4366651">policy</span>&nbsp;<span class="op" id="4366658">:=</span>&nbsp;<span class="keyword" id="4366661">range</span>&nbsp;<span class="ident" id="4366667">policies</span>&nbsp;<span class="op" id="4366676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4366683">out</span><span class="op" id="4366686">.</span><span class="ident" id="4366687">PolicyIdentifiers</span><span class="op" id="4366704">[</span><span class="ident" id="4366705">i</span><span class="op" id="4366706">]</span>&nbsp;<span class="op" id="4366708">=</span>&nbsp;<span class="ident" id="4366710">policy</span><span class="op" id="4366716">.</span><span class="ident" id="4366717">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366737">}</span>&nbsp;<span class="keyword" id="4366739">else</span>&nbsp;<span class="keyword" id="4366744">if</span>&nbsp;<span class="ident" id="4366747">e</span><span class="op" id="4366748">.</span><span class="ident" id="4366749">Id</span><span class="op" id="4366751">.</span><span class="ident" id="4366752">Equal</span><span class="op" id="4366757">(</span><span class="ident" id="4366758">oidExtensionAuthorityInfoAccess</span><span class="op" id="4366789">)</span>&nbsp;<span class="op" id="4366791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366796">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366849">var</span>&nbsp;<span class="ident" id="4366853">aia</span>&nbsp;<span class="op" id="4366857">[</span><span class="op" id="4366858">]</span><span class="ident" id="4366859">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366882">if</span>&nbsp;<span class="ident" id="4366885">_</span><span class="op" id="4366886">,</span>&nbsp;<span class="ident" id="4366888">err</span>&nbsp;<span class="op" id="4366892">=</span>&nbsp;<span class="ident" id="4366894">asn1</span><span class="op" id="4366898">.</span><span class="ident" id="4366899">Unmarshal</span><span class="op" id="4366908">(</span><span class="ident" id="4366909">e</span><span class="op" id="4366910">.</span><span class="ident" id="4366911">Value</span><span class="op" id="4366916">,</span>&nbsp;<span class="op" id="4366918">&amp;</span><span class="ident" id="4366919">aia</span><span class="op" id="4366922">)</span><span class="op" id="4366923">;</span>&nbsp;<span class="ident" id="4366925">err</span>&nbsp;<span class="op" id="4366929">!=</span>&nbsp;<span class="ident" id="4366932">nil</span>&nbsp;<span class="op" id="4366936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366942">return</span>&nbsp;<span class="ident" id="4366949">nil</span><span class="op" id="4366952">,</span>&nbsp;<span class="ident" id="4366954">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4366961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4366967">for</span>&nbsp;<span class="ident" id="4366971">_</span><span class="op" id="4366972">,</span>&nbsp;<span class="ident" id="4366974">v</span>&nbsp;<span class="op" id="4366976">:=</span>&nbsp;<span class="keyword" id="4366979">range</span>&nbsp;<span class="ident" id="4366985">aia</span>&nbsp;<span class="op" id="4366989">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4366995">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367055">if</span>&nbsp;<span class="ident" id="4367058">v</span><span class="op" id="4367059">.</span><span class="ident" id="4367060">Location</span><span class="op" id="4367068">.</span><span class="ident" id="4367069">Tag</span>&nbsp;<span class="op" id="4367073">!=</span>&nbsp;<span class="num" id="4367076">6</span>&nbsp;<span class="op" id="4367078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367085">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367104">if</span>&nbsp;<span class="ident" id="4367107">v</span><span class="op" id="4367108">.</span><span class="ident" id="4367109">Method</span><span class="op" id="4367115">.</span><span class="ident" id="4367116">Equal</span><span class="op" id="4367121">(</span><span class="ident" id="4367122">oidAuthorityInfoAccessOcsp</span><span class="op" id="4367148">)</span>&nbsp;<span class="op" id="4367150">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367157">out</span><span class="op" id="4367160">.</span><span class="ident" id="4367161">OCSPServer</span>&nbsp;<span class="op" id="4367172">=</span>&nbsp;<span class="builtinfunc" id="4367174">append</span><span class="op" id="4367180">(</span><span class="ident" id="4367181">out</span><span class="op" id="4367184">.</span><span class="ident" id="4367185">OCSPServer</span><span class="op" id="4367195">,</span>&nbsp;<span class="builtintype" id="4367197">string</span><span class="op" id="4367203">(</span><span class="ident" id="4367204">v</span><span class="op" id="4367205">.</span><span class="ident" id="4367206">Location</span><span class="op" id="4367214">.</span><span class="ident" id="4367215">Bytes</span><span class="op" id="4367220">)</span><span class="op" id="4367221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367227">}</span>&nbsp;<span class="keyword" id="4367229">else</span>&nbsp;<span class="keyword" id="4367234">if</span>&nbsp;<span class="ident" id="4367237">v</span><span class="op" id="4367238">.</span><span class="ident" id="4367239">Method</span><span class="op" id="4367245">.</span><span class="ident" id="4367246">Equal</span><span class="op" id="4367251">(</span><span class="ident" id="4367252">oidAuthorityInfoAccessIssuers</span><span class="op" id="4367281">)</span>&nbsp;<span class="op" id="4367283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367290">out</span><span class="op" id="4367293">.</span><span class="ident" id="4367294">IssuingCertificateURL</span>&nbsp;<span class="op" id="4367316">=</span>&nbsp;<span class="builtinfunc" id="4367318">append</span><span class="op" id="4367324">(</span><span class="ident" id="4367325">out</span><span class="op" id="4367328">.</span><span class="ident" id="4367329">IssuingCertificateURL</span><span class="op" id="4367350">,</span>&nbsp;<span class="builtintype" id="4367352">string</span><span class="op" id="4367358">(</span><span class="ident" id="4367359">v</span><span class="op" id="4367360">.</span><span class="ident" id="4367361">Location</span><span class="op" id="4367369">.</span><span class="ident" id="4367370">Bytes</span><span class="op" id="4367375">)</span><span class="op" id="4367376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367387">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367396">if</span>&nbsp;<span class="ident" id="4367399">e</span><span class="op" id="4367400">.</span><span class="ident" id="4367401">Critical</span>&nbsp;<span class="op" id="4367410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367415">return</span>&nbsp;<span class="ident" id="4367422">out</span><span class="op" id="4367425">,</span>&nbsp;<span class="ident" id="4367427">UnhandledCriticalExtension</span><span class="op" id="4367453">{</span><span class="op" id="4367454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367458">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367465">return</span>&nbsp;<span class="ident" id="4367472">out</span><span class="op" id="4367475">,</span>&nbsp;<span class="ident" id="4367477">nil</span><br>
<span class="lineno"></span><span class="op" id="4367481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4367484">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4367563">func</span>&nbsp;<span class="ident" id="4367568">ParseCertificate</span><span class="op" id="4367584">(</span><span class="ident" id="4367585">asn1Data</span>&nbsp;<span class="op" id="4367594">[</span><span class="op" id="4367595">]</span><span class="builtintype" id="4367596">byte</span><span class="op" id="4367600">)</span>&nbsp;<span class="op" id="4367602">(</span><span class="op" id="4367603">*</span><span class="ident" id="4367604">Certificate</span><span class="op" id="4367615">,</span>&nbsp;<span class="builtintype" id="4367617">error</span><span class="op" id="4367622">)</span>&nbsp;<span class="op" id="4367624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367627">var</span>&nbsp;<span class="ident" id="4367631">cert</span>&nbsp;<span class="ident" id="4367636">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4367649">rest</span><span class="op" id="4367653">,</span>&nbsp;<span class="ident" id="4367655">err</span>&nbsp;<span class="op" id="4367659">:=</span>&nbsp;<span class="ident" id="4367662">asn1</span><span class="op" id="4367666">.</span><span class="ident" id="4367667">Unmarshal</span><span class="op" id="4367676">(</span><span class="ident" id="4367677">asn1Data</span><span class="op" id="4367685">,</span>&nbsp;<span class="op" id="4367687">&amp;</span><span class="ident" id="4367688">cert</span><span class="op" id="4367692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367695">if</span>&nbsp;<span class="ident" id="4367698">err</span>&nbsp;<span class="op" id="4367702">!=</span>&nbsp;<span class="ident" id="4367705">nil</span>&nbsp;<span class="op" id="4367709">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367713">return</span>&nbsp;<span class="ident" id="4367720">nil</span><span class="op" id="4367723">,</span>&nbsp;<span class="ident" id="4367725">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367733">if</span>&nbsp;<span class="builtinfunc" id="4367736">len</span><span class="op" id="4367739">(</span><span class="ident" id="4367740">rest</span><span class="op" id="4367744">)</span>&nbsp;<span class="op" id="4367746">&gt;</span>&nbsp;<span class="num" id="4367748">0</span>&nbsp;<span class="op" id="4367750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367754">return</span>&nbsp;<span class="ident" id="4367761">nil</span><span class="op" id="4367764">,</span>&nbsp;<span class="ident" id="4367766">asn1</span><span class="op" id="4367770">.</span><span class="ident" id="4367771">SyntaxError</span><span class="op" id="4367782">{</span><span class="ident" id="4367783">Msg</span><span class="op" id="4367786">:</span>&nbsp;<span class="string" id="4367788">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4367803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4367806">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4367810">return</span>&nbsp;<span class="ident" id="4367817">parseCertificate</span><span class="op" id="4367833">(</span><span class="op" id="4367834">&amp;</span><span class="ident" id="4367835">cert</span><span class="op" id="4367839">)</span><br>
<span class="lineno"></span><span class="op" id="4367841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4367844">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4367922">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4367999">func</span>&nbsp;<span class="ident" id="4368004">ParseCertificates</span><span class="op" id="4368021">(</span><span class="ident" id="4368022">asn1Data</span>&nbsp;<span class="op" id="4368031">[</span><span class="op" id="4368032">]</span><span class="builtintype" id="4368033">byte</span><span class="op" id="4368037">)</span>&nbsp;<span class="op" id="4368039">(</span><span class="op" id="4368040">[</span><span class="op" id="4368041">]</span><span class="op" id="4368042">*</span><span class="ident" id="4368043">Certificate</span><span class="op" id="4368054">,</span>&nbsp;<span class="builtintype" id="4368056">error</span><span class="op" id="4368061">)</span>&nbsp;<span class="op" id="4368063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368066">var</span>&nbsp;<span class="ident" id="4368070">v</span>&nbsp;<span class="op" id="4368072">[</span><span class="op" id="4368073">]</span><span class="op" id="4368074">*</span><span class="ident" id="4368075">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368089">for</span>&nbsp;<span class="builtinfunc" id="4368093">len</span><span class="op" id="4368096">(</span><span class="ident" id="4368097">asn1Data</span><span class="op" id="4368105">)</span>&nbsp;<span class="op" id="4368107">&gt;</span>&nbsp;<span class="num" id="4368109">0</span>&nbsp;<span class="op" id="4368111">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368115">cert</span>&nbsp;<span class="op" id="4368120">:=</span>&nbsp;<span class="builtinfunc" id="4368123">new</span><span class="op" id="4368126">(</span><span class="ident" id="4368127">certificate</span><span class="op" id="4368138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368142">var</span>&nbsp;<span class="ident" id="4368146">err</span>&nbsp;<span class="builtintype" id="4368150">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368158">asn1Data</span><span class="op" id="4368166">,</span>&nbsp;<span class="ident" id="4368168">err</span>&nbsp;<span class="op" id="4368172">=</span>&nbsp;<span class="ident" id="4368174">asn1</span><span class="op" id="4368178">.</span><span class="ident" id="4368179">Unmarshal</span><span class="op" id="4368188">(</span><span class="ident" id="4368189">asn1Data</span><span class="op" id="4368197">,</span>&nbsp;<span class="ident" id="4368199">cert</span><span class="op" id="4368203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368207">if</span>&nbsp;<span class="ident" id="4368210">err</span>&nbsp;<span class="op" id="4368214">!=</span>&nbsp;<span class="ident" id="4368217">nil</span>&nbsp;<span class="op" id="4368221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368226">return</span>&nbsp;<span class="ident" id="4368233">nil</span><span class="op" id="4368236">,</span>&nbsp;<span class="ident" id="4368238">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368248">v</span>&nbsp;<span class="op" id="4368250">=</span>&nbsp;<span class="builtinfunc" id="4368252">append</span><span class="op" id="4368258">(</span><span class="ident" id="4368259">v</span><span class="op" id="4368260">,</span>&nbsp;<span class="ident" id="4368262">cert</span><span class="op" id="4368266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368273">ret</span>&nbsp;<span class="op" id="4368277">:=</span>&nbsp;<span class="builtinfunc" id="4368280">make</span><span class="op" id="4368284">(</span><span class="op" id="4368285">[</span><span class="op" id="4368286">]</span><span class="op" id="4368287">*</span><span class="ident" id="4368288">Certificate</span><span class="op" id="4368299">,</span>&nbsp;<span class="builtinfunc" id="4368301">len</span><span class="op" id="4368304">(</span><span class="ident" id="4368305">v</span><span class="op" id="4368306">)</span><span class="op" id="4368307">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368310">for</span>&nbsp;<span class="ident" id="4368314">i</span><span class="op" id="4368315">,</span>&nbsp;<span class="ident" id="4368317">ci</span>&nbsp;<span class="op" id="4368320">:=</span>&nbsp;<span class="keyword" id="4368323">range</span>&nbsp;<span class="ident" id="4368329">v</span>&nbsp;<span class="op" id="4368331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368335">cert</span><span class="op" id="4368339">,</span>&nbsp;<span class="ident" id="4368341">err</span>&nbsp;<span class="op" id="4368345">:=</span>&nbsp;<span class="ident" id="4368348">parseCertificate</span><span class="op" id="4368364">(</span><span class="ident" id="4368365">ci</span><span class="op" id="4368367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368371">if</span>&nbsp;<span class="ident" id="4368374">err</span>&nbsp;<span class="op" id="4368378">!=</span>&nbsp;<span class="ident" id="4368381">nil</span>&nbsp;<span class="op" id="4368385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368390">return</span>&nbsp;<span class="ident" id="4368397">nil</span><span class="op" id="4368400">,</span>&nbsp;<span class="ident" id="4368402">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368408">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368412">ret</span><span class="op" id="4368415">[</span><span class="ident" id="4368416">i</span><span class="op" id="4368417">]</span>&nbsp;<span class="op" id="4368419">=</span>&nbsp;<span class="ident" id="4368421">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4368427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368431">return</span>&nbsp;<span class="ident" id="4368438">ret</span><span class="op" id="4368441">,</span>&nbsp;<span class="ident" id="4368443">nil</span><br>
<span class="lineno"></span><span class="op" id="4368447">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4368450">func</span>&nbsp;<span class="ident" id="4368455">reverseBitsInAByte</span><span class="op" id="4368473">(</span><span class="ident" id="4368474">in</span>&nbsp;<span class="builtintype" id="4368477">byte</span><span class="op" id="4368481">)</span>&nbsp;<span class="builtintype" id="4368483">byte</span>&nbsp;<span class="op" id="4368488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368491">b1</span>&nbsp;<span class="op" id="4368494">:=</span>&nbsp;<span class="ident" id="4368497">in</span><span class="op" id="4368499">&gt;&gt;</span><span class="num" id="4368501">4</span>&nbsp;<span class="op" id="4368503">|</span>&nbsp;<span class="ident" id="4368505">in</span><span class="op" id="4368507">&lt;&lt;</span><span class="num" id="4368509">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368512">b2</span>&nbsp;<span class="op" id="4368515">:=</span>&nbsp;<span class="ident" id="4368518">b1</span><span class="op" id="4368520">&gt;&gt;</span><span class="num" id="4368522">2</span><span class="op" id="4368523">&amp;</span><span class="num" id="4368524">0x33</span>&nbsp;<span class="op" id="4368529">|</span>&nbsp;<span class="ident" id="4368531">b1</span><span class="op" id="4368533">&lt;&lt;</span><span class="num" id="4368535">2</span><span class="op" id="4368536">&amp;</span><span class="num" id="4368537">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368543">b3</span>&nbsp;<span class="op" id="4368546">:=</span>&nbsp;<span class="ident" id="4368549">b2</span><span class="op" id="4368551">&gt;&gt;</span><span class="num" id="4368553">1</span><span class="op" id="4368554">&amp;</span><span class="num" id="4368555">0x55</span>&nbsp;<span class="op" id="4368560">|</span>&nbsp;<span class="ident" id="4368562">b2</span><span class="op" id="4368564">&lt;&lt;</span><span class="num" id="4368566">1</span><span class="op" id="4368567">&amp;</span><span class="num" id="4368568">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4368574">return</span>&nbsp;<span class="ident" id="4368581">b3</span><br>
<span class="lineno"></span><span class="op" id="4368584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4368587">var</span>&nbsp;<span class="op" id="4368591">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368594">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368628">=</span>&nbsp;<span class="op" id="4368630">[</span><span class="op" id="4368631">]</span><span class="builtintype" id="4368632">int</span><span class="op" id="4368635">{</span><span class="num" id="4368636">2</span><span class="op" id="4368637">,</span>&nbsp;<span class="num" id="4368639">5</span><span class="op" id="4368640">,</span>&nbsp;<span class="num" id="4368642">29</span><span class="op" id="4368644">,</span>&nbsp;<span class="num" id="4368646">14</span><span class="op" id="4368648">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368651">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368685">=</span>&nbsp;<span class="op" id="4368687">[</span><span class="op" id="4368688">]</span><span class="builtintype" id="4368689">int</span><span class="op" id="4368692">{</span><span class="num" id="4368693">2</span><span class="op" id="4368694">,</span>&nbsp;<span class="num" id="4368696">5</span><span class="op" id="4368697">,</span>&nbsp;<span class="num" id="4368699">29</span><span class="op" id="4368701">,</span>&nbsp;<span class="num" id="4368703">15</span><span class="op" id="4368705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368708">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368742">=</span>&nbsp;<span class="op" id="4368744">[</span><span class="op" id="4368745">]</span><span class="builtintype" id="4368746">int</span><span class="op" id="4368749">{</span><span class="num" id="4368750">2</span><span class="op" id="4368751">,</span>&nbsp;<span class="num" id="4368753">5</span><span class="op" id="4368754">,</span>&nbsp;<span class="num" id="4368756">29</span><span class="op" id="4368758">,</span>&nbsp;<span class="num" id="4368760">37</span><span class="op" id="4368762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368765">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368799">=</span>&nbsp;<span class="op" id="4368801">[</span><span class="op" id="4368802">]</span><span class="builtintype" id="4368803">int</span><span class="op" id="4368806">{</span><span class="num" id="4368807">2</span><span class="op" id="4368808">,</span>&nbsp;<span class="num" id="4368810">5</span><span class="op" id="4368811">,</span>&nbsp;<span class="num" id="4368813">29</span><span class="op" id="4368815">,</span>&nbsp;<span class="num" id="4368817">35</span><span class="op" id="4368819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368822">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368856">=</span>&nbsp;<span class="op" id="4368858">[</span><span class="op" id="4368859">]</span><span class="builtintype" id="4368860">int</span><span class="op" id="4368863">{</span><span class="num" id="4368864">2</span><span class="op" id="4368865">,</span>&nbsp;<span class="num" id="4368867">5</span><span class="op" id="4368868">,</span>&nbsp;<span class="num" id="4368870">29</span><span class="op" id="4368872">,</span>&nbsp;<span class="num" id="4368874">19</span><span class="op" id="4368876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368879">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4368913">=</span>&nbsp;<span class="op" id="4368915">[</span><span class="op" id="4368916">]</span><span class="builtintype" id="4368917">int</span><span class="op" id="4368920">{</span><span class="num" id="4368921">2</span><span class="op" id="4368922">,</span>&nbsp;<span class="num" id="4368924">5</span><span class="op" id="4368925">,</span>&nbsp;<span class="num" id="4368927">29</span><span class="op" id="4368929">,</span>&nbsp;<span class="num" id="4368931">17</span><span class="op" id="4368933">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368936">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4368970">=</span>&nbsp;<span class="op" id="4368972">[</span><span class="op" id="4368973">]</span><span class="builtintype" id="4368974">int</span><span class="op" id="4368977">{</span><span class="num" id="4368978">2</span><span class="op" id="4368979">,</span>&nbsp;<span class="num" id="4368981">5</span><span class="op" id="4368982">,</span>&nbsp;<span class="num" id="4368984">29</span><span class="op" id="4368986">,</span>&nbsp;<span class="num" id="4368988">32</span><span class="op" id="4368990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4368993">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369027">=</span>&nbsp;<span class="op" id="4369029">[</span><span class="op" id="4369030">]</span><span class="builtintype" id="4369031">int</span><span class="op" id="4369034">{</span><span class="num" id="4369035">2</span><span class="op" id="4369036">,</span>&nbsp;<span class="num" id="4369038">5</span><span class="op" id="4369039">,</span>&nbsp;<span class="num" id="4369041">29</span><span class="op" id="4369043">,</span>&nbsp;<span class="num" id="4369045">30</span><span class="op" id="4369047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369050">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4369084">=</span>&nbsp;<span class="op" id="4369086">[</span><span class="op" id="4369087">]</span><span class="builtintype" id="4369088">int</span><span class="op" id="4369091">{</span><span class="num" id="4369092">2</span><span class="op" id="4369093">,</span>&nbsp;<span class="num" id="4369095">5</span><span class="op" id="4369096">,</span>&nbsp;<span class="num" id="4369098">29</span><span class="op" id="4369100">,</span>&nbsp;<span class="num" id="4369102">31</span><span class="op" id="4369104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369107">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4369141">=</span>&nbsp;<span class="op" id="4369143">[</span><span class="op" id="4369144">]</span><span class="builtintype" id="4369145">int</span><span class="op" id="4369148">{</span><span class="num" id="4369149">1</span><span class="op" id="4369150">,</span>&nbsp;<span class="num" id="4369152">3</span><span class="op" id="4369153">,</span>&nbsp;<span class="num" id="4369155">6</span><span class="op" id="4369156">,</span>&nbsp;<span class="num" id="4369158">1</span><span class="op" id="4369159">,</span>&nbsp;<span class="num" id="4369161">5</span><span class="op" id="4369162">,</span>&nbsp;<span class="num" id="4369164">5</span><span class="op" id="4369165">,</span>&nbsp;<span class="num" id="4369167">7</span><span class="op" id="4369168">,</span>&nbsp;<span class="num" id="4369170">1</span><span class="op" id="4369171">,</span>&nbsp;<span class="num" id="4369173">1</span><span class="op" id="4369174">}</span><br>
<span class="lineno"></span><span class="op" id="4369176">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4369179">var</span>&nbsp;<span class="op" id="4369183">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369186">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4369216">=</span>&nbsp;<span class="ident" id="4369218">asn1</span><span class="op" id="4369222">.</span><span class="ident" id="4369223">ObjectIdentifier</span><span class="op" id="4369239">{</span><span class="num" id="4369240">1</span><span class="op" id="4369241">,</span>&nbsp;<span class="num" id="4369243">3</span><span class="op" id="4369244">,</span>&nbsp;<span class="num" id="4369246">6</span><span class="op" id="4369247">,</span>&nbsp;<span class="num" id="4369249">1</span><span class="op" id="4369250">,</span>&nbsp;<span class="num" id="4369252">5</span><span class="op" id="4369253">,</span>&nbsp;<span class="num" id="4369255">5</span><span class="op" id="4369256">,</span>&nbsp;<span class="num" id="4369258">7</span><span class="op" id="4369259">,</span>&nbsp;<span class="num" id="4369261">48</span><span class="op" id="4369263">,</span>&nbsp;<span class="num" id="4369265">1</span><span class="op" id="4369266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369269">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4369299">=</span>&nbsp;<span class="ident" id="4369301">asn1</span><span class="op" id="4369305">.</span><span class="ident" id="4369306">ObjectIdentifier</span><span class="op" id="4369322">{</span><span class="num" id="4369323">1</span><span class="op" id="4369324">,</span>&nbsp;<span class="num" id="4369326">3</span><span class="op" id="4369327">,</span>&nbsp;<span class="num" id="4369329">6</span><span class="op" id="4369330">,</span>&nbsp;<span class="num" id="4369332">1</span><span class="op" id="4369333">,</span>&nbsp;<span class="num" id="4369335">5</span><span class="op" id="4369336">,</span>&nbsp;<span class="num" id="4369338">5</span><span class="op" id="4369339">,</span>&nbsp;<span class="num" id="4369341">7</span><span class="op" id="4369342">,</span>&nbsp;<span class="num" id="4369344">48</span><span class="op" id="4369346">,</span>&nbsp;<span class="num" id="4369348">2</span><span class="op" id="4369349">}</span><br>
<span class="lineno"></span><span class="op" id="4369351">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4369354">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4369434">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4369449">func</span>&nbsp;<span class="ident" id="4369454">oidInExtensions</span><span class="op" id="4369469">(</span><span class="ident" id="4369470">oid</span>&nbsp;<span class="ident" id="4369474">asn1</span><span class="op" id="4369478">.</span><span class="ident" id="4369479">ObjectIdentifier</span><span class="op" id="4369495">,</span>&nbsp;<span class="ident" id="4369497">extensions</span>&nbsp;<span class="op" id="4369508">[</span><span class="op" id="4369509">]</span><span class="ident" id="4369510">pkix</span><span class="op" id="4369514">.</span><span class="ident" id="4369515">Extension</span><span class="op" id="4369524">)</span>&nbsp;<span class="builtintype" id="4369526">bool</span>&nbsp;<span class="op" id="4369531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369534">for</span>&nbsp;<span class="ident" id="4369538">_</span><span class="op" id="4369539">,</span>&nbsp;<span class="ident" id="4369541">e</span>&nbsp;<span class="op" id="4369543">:=</span>&nbsp;<span class="keyword" id="4369546">range</span>&nbsp;<span class="ident" id="4369552">extensions</span>&nbsp;<span class="op" id="4369563">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369567">if</span>&nbsp;<span class="ident" id="4369570">e</span><span class="op" id="4369571">.</span><span class="ident" id="4369572">Id</span><span class="op" id="4369574">.</span><span class="ident" id="4369575">Equal</span><span class="op" id="4369580">(</span><span class="ident" id="4369581">oid</span><span class="op" id="4369584">)</span>&nbsp;<span class="op" id="4369586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369591">return</span>&nbsp;<span class="builtintype" id="4369598">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369611">return</span>&nbsp;<span class="builtintype" id="4369618">false</span><br>
<span class="lineno">1165</span><span class="op" id="4369624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4369627">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4369703">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4369740">func</span>&nbsp;<span class="ident" id="4369745">marshalSANs</span><span class="op" id="4369756">(</span><span class="ident" id="4369757">dnsNames</span><span class="op" id="4369765">,</span>&nbsp;<span class="ident" id="4369767">emailAddresses</span>&nbsp;<span class="op" id="4369782">[</span><span class="op" id="4369783">]</span><span class="builtintype" id="4369784">string</span><span class="op" id="4369790">,</span>&nbsp;<span class="ident" id="4369792">ipAddresses</span>&nbsp;<span class="op" id="4369804">[</span><span class="op" id="4369805">]</span><span class="ident" id="4369806">net</span><span class="op" id="4369809">.</span><span class="ident" id="4369810">IP</span><span class="op" id="4369812">)</span>&nbsp;<span class="op" id="4369814">(</span><span class="ident" id="4369815">derBytes</span>&nbsp;<span class="op" id="4369824">[</span><span class="op" id="4369825">]</span><span class="builtintype" id="4369826">byte</span><span class="op" id="4369830">,</span>&nbsp;<span class="ident" id="4369832">err</span>&nbsp;<span class="builtintype" id="4369836">error</span><span class="op" id="4369841">)</span>&nbsp;<span class="op" id="4369843">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369846">var</span>&nbsp;<span class="ident" id="4369850">rawValues</span>&nbsp;<span class="op" id="4369860">[</span><span class="op" id="4369861">]</span><span class="ident" id="4369862">asn1</span><span class="op" id="4369866">.</span><span class="ident" id="4369867">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369877">for</span>&nbsp;<span class="ident" id="4369881">_</span><span class="op" id="4369882">,</span>&nbsp;<span class="ident" id="4369884">name</span>&nbsp;<span class="op" id="4369889">:=</span>&nbsp;<span class="keyword" id="4369892">range</span>&nbsp;<span class="ident" id="4369898">dnsNames</span>&nbsp;<span class="op" id="4369907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369911">rawValues</span>&nbsp;<span class="op" id="4369921">=</span>&nbsp;<span class="builtinfunc" id="4369923">append</span><span class="op" id="4369929">(</span><span class="ident" id="4369930">rawValues</span><span class="op" id="4369939">,</span>&nbsp;<span class="ident" id="4369941">asn1</span><span class="op" id="4369945">.</span><span class="ident" id="4369946">RawValue</span><span class="op" id="4369954">{</span><span class="ident" id="4369955">Tag</span><span class="op" id="4369958">:</span>&nbsp;<span class="num" id="4369960">2</span><span class="op" id="4369961">,</span>&nbsp;<span class="ident" id="4369963">Class</span><span class="op" id="4369968">:</span>&nbsp;<span class="num" id="4369970">2</span><span class="op" id="4369971">,</span>&nbsp;<span class="ident" id="4369973">Bytes</span><span class="op" id="4369978">:</span>&nbsp;<span class="op" id="4369980">[</span><span class="op" id="4369981">]</span><span class="builtintype" id="4369982">byte</span><span class="op" id="4369986">(</span><span class="ident" id="4369987">name</span><span class="op" id="4369991">)</span><span class="op" id="4369992">}</span><span class="op" id="4369993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369999">for</span>&nbsp;<span class="ident" id="4370003">_</span><span class="op" id="4370004">,</span>&nbsp;<span class="ident" id="4370006">email</span>&nbsp;<span class="op" id="4370012">:=</span>&nbsp;<span class="keyword" id="4370015">range</span>&nbsp;<span class="ident" id="4370021">emailAddresses</span>&nbsp;<span class="op" id="4370036">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370040">rawValues</span>&nbsp;<span class="op" id="4370050">=</span>&nbsp;<span class="builtinfunc" id="4370052">append</span><span class="op" id="4370058">(</span><span class="ident" id="4370059">rawValues</span><span class="op" id="4370068">,</span>&nbsp;<span class="ident" id="4370070">asn1</span><span class="op" id="4370074">.</span><span class="ident" id="4370075">RawValue</span><span class="op" id="4370083">{</span><span class="ident" id="4370084">Tag</span><span class="op" id="4370087">:</span>&nbsp;<span class="num" id="4370089">1</span><span class="op" id="4370090">,</span>&nbsp;<span class="ident" id="4370092">Class</span><span class="op" id="4370097">:</span>&nbsp;<span class="num" id="4370099">2</span><span class="op" id="4370100">,</span>&nbsp;<span class="ident" id="4370102">Bytes</span><span class="op" id="4370107">:</span>&nbsp;<span class="op" id="4370109">[</span><span class="op" id="4370110">]</span><span class="builtintype" id="4370111">byte</span><span class="op" id="4370115">(</span><span class="ident" id="4370116">email</span><span class="op" id="4370121">)</span><span class="op" id="4370122">}</span><span class="op" id="4370123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370129">for</span>&nbsp;<span class="ident" id="4370133">_</span><span class="op" id="4370134">,</span>&nbsp;<span class="ident" id="4370136">rawIP</span>&nbsp;<span class="op" id="4370142">:=</span>&nbsp;<span class="keyword" id="4370145">range</span>&nbsp;<span class="ident" id="4370151">ipAddresses</span>&nbsp;<span class="op" id="4370163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4370167">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370237">ip</span>&nbsp;<span class="op" id="4370240">:=</span>&nbsp;<span class="ident" id="4370243">rawIP</span><span class="op" id="4370248">.</span><span class="ident" id="4370249">To4</span><span class="op" id="4370252">(</span><span class="op" id="4370253">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370257">if</span>&nbsp;<span class="ident" id="4370260">ip</span>&nbsp;<span class="op" id="4370263">==</span>&nbsp;<span class="ident" id="4370266">nil</span>&nbsp;<span class="op" id="4370270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370275">ip</span>&nbsp;<span class="op" id="4370278">=</span>&nbsp;<span class="ident" id="4370280">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370292">rawValues</span>&nbsp;<span class="op" id="4370302">=</span>&nbsp;<span class="builtinfunc" id="4370304">append</span><span class="op" id="4370310">(</span><span class="ident" id="4370311">rawValues</span><span class="op" id="4370320">,</span>&nbsp;<span class="ident" id="4370322">asn1</span><span class="op" id="4370326">.</span><span class="ident" id="4370327">RawValue</span><span class="op" id="4370335">{</span><span class="ident" id="4370336">Tag</span><span class="op" id="4370339">:</span>&nbsp;<span class="num" id="4370341">7</span><span class="op" id="4370342">,</span>&nbsp;<span class="ident" id="4370344">Class</span><span class="op" id="4370349">:</span>&nbsp;<span class="num" id="4370351">2</span><span class="op" id="4370352">,</span>&nbsp;<span class="ident" id="4370354">Bytes</span><span class="op" id="4370359">:</span>&nbsp;<span class="ident" id="4370361">ip</span><span class="op" id="4370363">}</span><span class="op" id="4370364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370367">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370370">return</span>&nbsp;<span class="ident" id="4370377">asn1</span><span class="op" id="4370381">.</span><span class="ident" id="4370382">Marshal</span><span class="op" id="4370389">(</span><span class="ident" id="4370390">rawValues</span><span class="op" id="4370399">)</span><br>
<span class="lineno"></span><span class="op" id="4370401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4370404">func</span>&nbsp;<span class="ident" id="4370409">buildExtensions</span><span class="op" id="4370424">(</span><span class="ident" id="4370425">template</span>&nbsp;<span class="op" id="4370434">*</span><span class="ident" id="4370435">Certificate</span><span class="op" id="4370446">)</span>&nbsp;<span class="op" id="4370448">(</span><span class="ident" id="4370449">ret</span>&nbsp;<span class="op" id="4370453">[</span><span class="op" id="4370454">]</span><span class="ident" id="4370455">pkix</span><span class="op" id="4370459">.</span><span class="ident" id="4370460">Extension</span><span class="op" id="4370469">,</span>&nbsp;<span class="ident" id="4370471">err</span>&nbsp;<span class="builtintype" id="4370475">error</span><span class="op" id="4370480">)</span>&nbsp;<span class="op" id="4370482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370485">ret</span>&nbsp;<span class="op" id="4370489">=</span>&nbsp;<span class="builtinfunc" id="4370491">make</span><span class="op" id="4370495">(</span><span class="op" id="4370496">[</span><span class="op" id="4370497">]</span><span class="ident" id="4370498">pkix</span><span class="op" id="4370502">.</span><span class="ident" id="4370503">Extension</span><span class="op" id="4370512">,</span>&nbsp;<span class="num" id="4370514">10</span>&nbsp;<span class="comment" id="4370517">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4370550">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370553">n</span>&nbsp;<span class="op" id="4370555">:=</span>&nbsp;<span class="num" id="4370558">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370562">if</span>&nbsp;<span class="ident" id="4370565">template</span><span class="op" id="4370573">.</span><span class="ident" id="4370574">KeyUsage</span>&nbsp;<span class="op" id="4370583">!=</span>&nbsp;<span class="num" id="4370586">0</span>&nbsp;<span class="op" id="4370588">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370593">!</span><span class="ident" id="4370594">oidInExtensions</span><span class="op" id="4370609">(</span><span class="ident" id="4370610">oidExtensionKeyUsage</span><span class="op" id="4370630">,</span>&nbsp;<span class="ident" id="4370632">template</span><span class="op" id="4370640">.</span><span class="ident" id="4370641">ExtraExtensions</span><span class="op" id="4370656">)</span>&nbsp;<span class="op" id="4370658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370662">ret</span><span class="op" id="4370665">[</span><span class="ident" id="4370666">n</span><span class="op" id="4370667">]</span><span class="op" id="4370668">.</span><span class="ident" id="4370669">Id</span>&nbsp;<span class="op" id="4370672">=</span>&nbsp;<span class="ident" id="4370674">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370697">ret</span><span class="op" id="4370700">[</span><span class="ident" id="4370701">n</span><span class="op" id="4370702">]</span><span class="op" id="4370703">.</span><span class="ident" id="4370704">Critical</span>&nbsp;<span class="op" id="4370713">=</span>&nbsp;<span class="builtintype" id="4370715">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370723">var</span>&nbsp;<span class="ident" id="4370727">a</span>&nbsp;<span class="op" id="4370729">[</span><span class="num" id="4370730">2</span><span class="op" id="4370731">]</span><span class="builtintype" id="4370732">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370739">a</span><span class="op" id="4370740">[</span><span class="num" id="4370741">0</span><span class="op" id="4370742">]</span>&nbsp;<span class="op" id="4370744">=</span>&nbsp;<span class="ident" id="4370746">reverseBitsInAByte</span><span class="op" id="4370764">(</span><span class="builtintype" id="4370765">byte</span><span class="op" id="4370769">(</span><span class="ident" id="4370770">template</span><span class="op" id="4370778">.</span><span class="ident" id="4370779">KeyUsage</span><span class="op" id="4370787">)</span><span class="op" id="4370788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370792">a</span><span class="op" id="4370793">[</span><span class="num" id="4370794">1</span><span class="op" id="4370795">]</span>&nbsp;<span class="op" id="4370797">=</span>&nbsp;<span class="ident" id="4370799">reverseBitsInAByte</span><span class="op" id="4370817">(</span><span class="builtintype" id="4370818">byte</span><span class="op" id="4370822">(</span><span class="ident" id="4370823">template</span><span class="op" id="4370831">.</span><span class="ident" id="4370832">KeyUsage</span>&nbsp;<span class="op" id="4370841">&gt;&gt;</span>&nbsp;<span class="num" id="4370844">8</span><span class="op" id="4370845">)</span><span class="op" id="4370846">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370851">l</span>&nbsp;<span class="op" id="4370853">:=</span>&nbsp;<span class="num" id="4370856">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370860">if</span>&nbsp;<span class="ident" id="4370863">a</span><span class="op" id="4370864">[</span><span class="num" id="4370865">1</span><span class="op" id="4370866">]</span>&nbsp;<span class="op" id="4370868">!=</span>&nbsp;<span class="num" id="4370871">0</span>&nbsp;<span class="op" id="4370873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370878">l</span>&nbsp;<span class="op" id="4370880">=</span>&nbsp;<span class="num" id="4370882">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370886">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370891">ret</span><span class="op" id="4370894">[</span><span class="ident" id="4370895">n</span><span class="op" id="4370896">]</span><span class="op" id="4370897">.</span><span class="ident" id="4370898">Value</span><span class="op" id="4370903">,</span>&nbsp;<span class="ident" id="4370905">err</span>&nbsp;<span class="op" id="4370909">=</span>&nbsp;<span class="ident" id="4370911">asn1</span><span class="op" id="4370915">.</span><span class="ident" id="4370916">Marshal</span><span class="op" id="4370923">(</span><span class="ident" id="4370924">asn1</span><span class="op" id="4370928">.</span><span class="ident" id="4370929">BitString</span><span class="op" id="4370938">{</span><span class="ident" id="4370939">Bytes</span><span class="op" id="4370944">:</span>&nbsp;<span class="ident" id="4370946">a</span><span class="op" id="4370947">[</span><span class="num" id="4370948">0</span><span class="op" id="4370949">:</span><span class="ident" id="4370950">l</span><span class="op" id="4370951">]</span><span class="op" id="4370952">,</span>&nbsp;<span class="ident" id="4370954">BitLength</span><span class="op" id="4370963">:</span>&nbsp;<span class="ident" id="4370965">l</span>&nbsp;<span class="op" id="4370967">*</span>&nbsp;<span class="num" id="4370969">8</span><span class="op" id="4370970">}</span><span class="op" id="4370971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370975">if</span>&nbsp;<span class="ident" id="4370978">err</span>&nbsp;<span class="op" id="4370982">!=</span>&nbsp;<span class="ident" id="4370985">nil</span>&nbsp;<span class="op" id="4370989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371003">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371007">n</span><span class="op" id="4371008">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371016">if</span>&nbsp;<span class="op" id="4371019">(</span><span class="builtinfunc" id="4371020">len</span><span class="op" id="4371023">(</span><span class="ident" id="4371024">template</span><span class="op" id="4371032">.</span><span class="ident" id="4371033">ExtKeyUsage</span><span class="op" id="4371044">)</span>&nbsp;<span class="op" id="4371046">&gt;</span>&nbsp;<span class="num" id="4371048">0</span>&nbsp;<span class="op" id="4371050">||</span>&nbsp;<span class="builtinfunc" id="4371053">len</span><span class="op" id="4371056">(</span><span class="ident" id="4371057">template</span><span class="op" id="4371065">.</span><span class="ident" id="4371066">UnknownExtKeyUsage</span><span class="op" id="4371084">)</span>&nbsp;<span class="op" id="4371086">&gt;</span>&nbsp;<span class="num" id="4371088">0</span><span class="op" id="4371089">)</span>&nbsp;<span class="op" id="4371091">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371096">!</span><span class="ident" id="4371097">oidInExtensions</span><span class="op" id="4371112">(</span><span class="ident" id="4371113">oidExtensionExtendedKeyUsage</span><span class="op" id="4371141">,</span>&nbsp;<span class="ident" id="4371143">template</span><span class="op" id="4371151">.</span><span class="ident" id="4371152">ExtraExtensions</span><span class="op" id="4371167">)</span>&nbsp;<span class="op" id="4371169">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371173">ret</span><span class="op" id="4371176">[</span><span class="ident" id="4371177">n</span><span class="op" id="4371178">]</span><span class="op" id="4371179">.</span><span class="ident" id="4371180">Id</span>&nbsp;<span class="op" id="4371183">=</span>&nbsp;<span class="ident" id="4371185">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371217">var</span>&nbsp;<span class="ident" id="4371221">oids</span>&nbsp;<span class="op" id="4371226">[</span><span class="op" id="4371227">]</span><span class="ident" id="4371228">asn1</span><span class="op" id="4371232">.</span><span class="ident" id="4371233">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371252">for</span>&nbsp;<span class="ident" id="4371256">_</span><span class="op" id="4371257">,</span>&nbsp;<span class="ident" id="4371259">u</span>&nbsp;<span class="op" id="4371261">:=</span>&nbsp;<span class="keyword" id="4371264">range</span>&nbsp;<span class="ident" id="4371270">template</span><span class="op" id="4371278">.</span><span class="ident" id="4371279">ExtKeyUsage</span>&nbsp;<span class="op" id="4371291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371296">if</span>&nbsp;<span class="ident" id="4371299">oid</span><span class="op" id="4371302">,</span>&nbsp;<span class="ident" id="4371304">ok</span>&nbsp;<span class="op" id="4371307">:=</span>&nbsp;<span class="ident" id="4371310">oidFromExtKeyUsage</span><span class="op" id="4371328">(</span><span class="ident" id="4371329">u</span><span class="op" id="4371330">)</span><span class="op" id="4371331">;</span>&nbsp;<span class="ident" id="4371333">ok</span>&nbsp;<span class="op" id="4371336">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371342">oids</span>&nbsp;<span class="op" id="4371347">=</span>&nbsp;<span class="builtinfunc" id="4371349">append</span><span class="op" id="4371355">(</span><span class="ident" id="4371356">oids</span><span class="op" id="4371360">,</span>&nbsp;<span class="ident" id="4371362">oid</span><span class="op" id="4371365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371370">}</span>&nbsp;<span class="keyword" id="4371372">else</span>&nbsp;<span class="op" id="4371377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4371383">panic</span><span class="op" id="4371388">(</span><span class="string" id="4371389">&#34;internal&nbsp;error&#34;</span><span class="op" id="4371405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371414">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371419">oids</span>&nbsp;<span class="op" id="4371424">=</span>&nbsp;<span class="builtinfunc" id="4371426">append</span><span class="op" id="4371432">(</span><span class="ident" id="4371433">oids</span><span class="op" id="4371437">,</span>&nbsp;<span class="ident" id="4371439">template</span><span class="op" id="4371447">.</span><span class="ident" id="4371448">UnknownExtKeyUsage</span><span class="op" id="4371466">...</span><span class="op" id="4371469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371474">ret</span><span class="op" id="4371477">[</span><span class="ident" id="4371478">n</span><span class="op" id="4371479">]</span><span class="op" id="4371480">.</span><span class="ident" id="4371481">Value</span><span class="op" id="4371486">,</span>&nbsp;<span class="ident" id="4371488">err</span>&nbsp;<span class="op" id="4371492">=</span>&nbsp;<span class="ident" id="4371494">asn1</span><span class="op" id="4371498">.</span><span class="ident" id="4371499">Marshal</span><span class="op" id="4371506">(</span><span class="ident" id="4371507">oids</span><span class="op" id="4371511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371515">if</span>&nbsp;<span class="ident" id="4371518">err</span>&nbsp;<span class="op" id="4371522">!=</span>&nbsp;<span class="ident" id="4371525">nil</span>&nbsp;<span class="op" id="4371529">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371534">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371547">n</span><span class="op" id="4371548">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371556">if</span>&nbsp;<span class="ident" id="4371559">template</span><span class="op" id="4371567">.</span><span class="ident" id="4371568">BasicConstraintsValid</span>&nbsp;<span class="op" id="4371590">&amp;&amp;</span>&nbsp;<span class="op" id="4371593">!</span><span class="ident" id="4371594">oidInExtensions</span><span class="op" id="4371609">(</span><span class="ident" id="4371610">oidExtensionBasicConstraints</span><span class="op" id="4371638">,</span>&nbsp;<span class="ident" id="4371640">template</span><span class="op" id="4371648">.</span><span class="ident" id="4371649">ExtraExtensions</span><span class="op" id="4371664">)</span>&nbsp;<span class="op" id="4371666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4371670">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4371733">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4371798">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371857">maxPathLen</span>&nbsp;<span class="op" id="4371868">:=</span>&nbsp;<span class="ident" id="4371871">template</span><span class="op" id="4371879">.</span><span class="ident" id="4371880">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371893">if</span>&nbsp;<span class="ident" id="4371896">maxPathLen</span>&nbsp;<span class="op" id="4371907">==</span>&nbsp;<span class="num" id="4371910">0</span>&nbsp;<span class="op" id="4371912">&amp;&amp;</span>&nbsp;<span class="op" id="4371915">!</span><span class="ident" id="4371916">template</span><span class="op" id="4371924">.</span><span class="ident" id="4371925">MaxPathLenZero</span>&nbsp;<span class="op" id="4371940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371945">maxPathLen</span>&nbsp;<span class="op" id="4371956">=</span>&nbsp;<span class="op" id="4371958">-</span><span class="num" id="4371959">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371967">ret</span><span class="op" id="4371970">[</span><span class="ident" id="4371971">n</span><span class="op" id="4371972">]</span><span class="op" id="4371973">.</span><span class="ident" id="4371974">Id</span>&nbsp;<span class="op" id="4371977">=</span>&nbsp;<span class="ident" id="4371979">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372010">ret</span><span class="op" id="4372013">[</span><span class="ident" id="4372014">n</span><span class="op" id="4372015">]</span><span class="op" id="4372016">.</span><span class="ident" id="4372017">Value</span><span class="op" id="4372022">,</span>&nbsp;<span class="ident" id="4372024">err</span>&nbsp;<span class="op" id="4372028">=</span>&nbsp;<span class="ident" id="4372030">asn1</span><span class="op" id="4372034">.</span><span class="ident" id="4372035">Marshal</span><span class="op" id="4372042">(</span><span class="ident" id="4372043">basicConstraints</span><span class="op" id="4372059">{</span><span class="ident" id="4372060">template</span><span class="op" id="4372068">.</span><span class="ident" id="4372069">IsCA</span><span class="op" id="4372073">,</span>&nbsp;<span class="ident" id="4372075">maxPathLen</span><span class="op" id="4372085">}</span><span class="op" id="4372086">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372090">ret</span><span class="op" id="4372093">[</span><span class="ident" id="4372094">n</span><span class="op" id="4372095">]</span><span class="op" id="4372096">.</span><span class="ident" id="4372097">Critical</span>&nbsp;<span class="op" id="4372106">=</span>&nbsp;<span class="builtintype" id="4372108">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372115">if</span>&nbsp;<span class="ident" id="4372118">err</span>&nbsp;<span class="op" id="4372122">!=</span>&nbsp;<span class="ident" id="4372125">nil</span>&nbsp;<span class="op" id="4372129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372147">n</span><span class="op" id="4372148">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372156">if</span>&nbsp;<span class="builtinfunc" id="4372159">len</span><span class="op" id="4372162">(</span><span class="ident" id="4372163">template</span><span class="op" id="4372171">.</span><span class="ident" id="4372172">SubjectKeyId</span><span class="op" id="4372184">)</span>&nbsp;<span class="op" id="4372186">&gt;</span>&nbsp;<span class="num" id="4372188">0</span>&nbsp;<span class="op" id="4372190">&amp;&amp;</span>&nbsp;<span class="op" id="4372193">!</span><span class="ident" id="4372194">oidInExtensions</span><span class="op" id="4372209">(</span><span class="ident" id="4372210">oidExtensionSubjectKeyId</span><span class="op" id="4372234">,</span>&nbsp;<span class="ident" id="4372236">template</span><span class="op" id="4372244">.</span><span class="ident" id="4372245">ExtraExtensions</span><span class="op" id="4372260">)</span>&nbsp;<span class="op" id="4372262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372266">ret</span><span class="op" id="4372269">[</span><span class="ident" id="4372270">n</span><span class="op" id="4372271">]</span><span class="op" id="4372272">.</span><span class="ident" id="4372273">Id</span>&nbsp;<span class="op" id="4372276">=</span>&nbsp;<span class="ident" id="4372278">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372305">ret</span><span class="op" id="4372308">[</span><span class="ident" id="4372309">n</span><span class="op" id="4372310">]</span><span class="op" id="4372311">.</span><span class="ident" id="4372312">Value</span><span class="op" id="4372317">,</span>&nbsp;<span class="ident" id="4372319">err</span>&nbsp;<span class="op" id="4372323">=</span>&nbsp;<span class="ident" id="4372325">asn1</span><span class="op" id="4372329">.</span><span class="ident" id="4372330">Marshal</span><span class="op" id="4372337">(</span><span class="ident" id="4372338">template</span><span class="op" id="4372346">.</span><span class="ident" id="4372347">SubjectKeyId</span><span class="op" id="4372359">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372363">if</span>&nbsp;<span class="ident" id="4372366">err</span>&nbsp;<span class="op" id="4372370">!=</span>&nbsp;<span class="ident" id="4372373">nil</span>&nbsp;<span class="op" id="4372377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372395">n</span><span class="op" id="4372396">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372400">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372404">if</span>&nbsp;<span class="builtinfunc" id="4372407">len</span><span class="op" id="4372410">(</span><span class="ident" id="4372411">template</span><span class="op" id="4372419">.</span><span class="ident" id="4372420">AuthorityKeyId</span><span class="op" id="4372434">)</span>&nbsp;<span class="op" id="4372436">&gt;</span>&nbsp;<span class="num" id="4372438">0</span>&nbsp;<span class="op" id="4372440">&amp;&amp;</span>&nbsp;<span class="op" id="4372443">!</span><span class="ident" id="4372444">oidInExtensions</span><span class="op" id="4372459">(</span><span class="ident" id="4372460">oidExtensionAuthorityKeyId</span><span class="op" id="4372486">,</span>&nbsp;<span class="ident" id="4372488">template</span><span class="op" id="4372496">.</span><span class="ident" id="4372497">ExtraExtensions</span><span class="op" id="4372512">)</span>&nbsp;<span class="op" id="4372514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372518">ret</span><span class="op" id="4372521">[</span><span class="ident" id="4372522">n</span><span class="op" id="4372523">]</span><span class="op" id="4372524">.</span><span class="ident" id="4372525">Id</span>&nbsp;<span class="op" id="4372528">=</span>&nbsp;<span class="ident" id="4372530">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372559">ret</span><span class="op" id="4372562">[</span><span class="ident" id="4372563">n</span><span class="op" id="4372564">]</span><span class="op" id="4372565">.</span><span class="ident" id="4372566">Value</span><span class="op" id="4372571">,</span>&nbsp;<span class="ident" id="4372573">err</span>&nbsp;<span class="op" id="4372577">=</span>&nbsp;<span class="ident" id="4372579">asn1</span><span class="op" id="4372583">.</span><span class="ident" id="4372584">Marshal</span><span class="op" id="4372591">(</span><span class="ident" id="4372592">authKeyId</span><span class="op" id="4372601">{</span><span class="ident" id="4372602">template</span><span class="op" id="4372610">.</span><span class="ident" id="4372611">AuthorityKeyId</span><span class="op" id="4372625">}</span><span class="op" id="4372626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372630">if</span>&nbsp;<span class="ident" id="4372633">err</span>&nbsp;<span class="op" id="4372637">!=</span>&nbsp;<span class="ident" id="4372640">nil</span>&nbsp;<span class="op" id="4372644">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372649">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372662">n</span><span class="op" id="4372663">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372671">if</span>&nbsp;<span class="op" id="4372674">(</span><span class="builtinfunc" id="4372675">len</span><span class="op" id="4372678">(</span><span class="ident" id="4372679">template</span><span class="op" id="4372687">.</span><span class="ident" id="4372688">OCSPServer</span><span class="op" id="4372698">)</span>&nbsp;<span class="op" id="4372700">&gt;</span>&nbsp;<span class="num" id="4372702">0</span>&nbsp;<span class="op" id="4372704">||</span>&nbsp;<span class="builtinfunc" id="4372707">len</span><span class="op" id="4372710">(</span><span class="ident" id="4372711">template</span><span class="op" id="4372719">.</span><span class="ident" id="4372720">IssuingCertificateURL</span><span class="op" id="4372741">)</span>&nbsp;<span class="op" id="4372743">&gt;</span>&nbsp;<span class="num" id="4372745">0</span><span class="op" id="4372746">)</span>&nbsp;<span class="op" id="4372748">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4372753">!</span><span class="ident" id="4372754">oidInExtensions</span><span class="op" id="4372769">(</span><span class="ident" id="4372770">oidExtensionAuthorityInfoAccess</span><span class="op" id="4372801">,</span>&nbsp;<span class="ident" id="4372803">template</span><span class="op" id="4372811">.</span><span class="ident" id="4372812">ExtraExtensions</span><span class="op" id="4372827">)</span>&nbsp;<span class="op" id="4372829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372833">ret</span><span class="op" id="4372836">[</span><span class="ident" id="4372837">n</span><span class="op" id="4372838">]</span><span class="op" id="4372839">.</span><span class="ident" id="4372840">Id</span>&nbsp;<span class="op" id="4372843">=</span>&nbsp;<span class="ident" id="4372845">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372879">var</span>&nbsp;<span class="ident" id="4372883">aiaValues</span>&nbsp;<span class="op" id="4372893">[</span><span class="op" id="4372894">]</span><span class="ident" id="4372895">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372917">for</span>&nbsp;<span class="ident" id="4372921">_</span><span class="op" id="4372922">,</span>&nbsp;<span class="ident" id="4372924">name</span>&nbsp;<span class="op" id="4372929">:=</span>&nbsp;<span class="keyword" id="4372932">range</span>&nbsp;<span class="ident" id="4372938">template</span><span class="op" id="4372946">.</span><span class="ident" id="4372947">OCSPServer</span>&nbsp;<span class="op" id="4372958">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372963">aiaValues</span>&nbsp;<span class="op" id="4372973">=</span>&nbsp;<span class="builtinfunc" id="4372975">append</span><span class="op" id="4372981">(</span><span class="ident" id="4372982">aiaValues</span><span class="op" id="4372991">,</span>&nbsp;<span class="ident" id="4372993">authorityInfoAccess</span><span class="op" id="4373012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373018">Method</span><span class="op" id="4373024">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4373028">oidAuthorityInfoAccessOcsp</span><span class="op" id="4373054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373060">Location</span><span class="op" id="4373068">:</span>&nbsp;<span class="ident" id="4373070">asn1</span><span class="op" id="4373074">.</span><span class="ident" id="4373075">RawValue</span><span class="op" id="4373083">{</span><span class="ident" id="4373084">Tag</span><span class="op" id="4373087">:</span>&nbsp;<span class="num" id="4373089">6</span><span class="op" id="4373090">,</span>&nbsp;<span class="ident" id="4373092">Class</span><span class="op" id="4373097">:</span>&nbsp;<span class="num" id="4373099">2</span><span class="op" id="4373100">,</span>&nbsp;<span class="ident" id="4373102">Bytes</span><span class="op" id="4373107">:</span>&nbsp;<span class="op" id="4373109">[</span><span class="op" id="4373110">]</span><span class="builtintype" id="4373111">byte</span><span class="op" id="4373115">(</span><span class="ident" id="4373116">name</span><span class="op" id="4373120">)</span><span class="op" id="4373121">}</span><span class="op" id="4373122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373127">}</span><span class="op" id="4373128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373132">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373136">for</span>&nbsp;<span class="ident" id="4373140">_</span><span class="op" id="4373141">,</span>&nbsp;<span class="ident" id="4373143">name</span>&nbsp;<span class="op" id="4373148">:=</span>&nbsp;<span class="keyword" id="4373151">range</span>&nbsp;<span class="ident" id="4373157">template</span><span class="op" id="4373165">.</span><span class="ident" id="4373166">IssuingCertificateURL</span>&nbsp;<span class="op" id="4373188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373193">aiaValues</span>&nbsp;<span class="op" id="4373203">=</span>&nbsp;<span class="builtinfunc" id="4373205">append</span><span class="op" id="4373211">(</span><span class="ident" id="4373212">aiaValues</span><span class="op" id="4373221">,</span>&nbsp;<span class="ident" id="4373223">authorityInfoAccess</span><span class="op" id="4373242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373248">Method</span><span class="op" id="4373254">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4373258">oidAuthorityInfoAccessIssuers</span><span class="op" id="4373287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373293">Location</span><span class="op" id="4373301">:</span>&nbsp;<span class="ident" id="4373303">asn1</span><span class="op" id="4373307">.</span><span class="ident" id="4373308">RawValue</span><span class="op" id="4373316">{</span><span class="ident" id="4373317">Tag</span><span class="op" id="4373320">:</span>&nbsp;<span class="num" id="4373322">6</span><span class="op" id="4373323">,</span>&nbsp;<span class="ident" id="4373325">Class</span><span class="op" id="4373330">:</span>&nbsp;<span class="num" id="4373332">2</span><span class="op" id="4373333">,</span>&nbsp;<span class="ident" id="4373335">Bytes</span><span class="op" id="4373340">:</span>&nbsp;<span class="op" id="4373342">[</span><span class="op" id="4373343">]</span><span class="builtintype" id="4373344">byte</span><span class="op" id="4373348">(</span><span class="ident" id="4373349">name</span><span class="op" id="4373353">)</span><span class="op" id="4373354">}</span><span class="op" id="4373355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373360">}</span><span class="op" id="4373361">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373369">ret</span><span class="op" id="4373372">[</span><span class="ident" id="4373373">n</span><span class="op" id="4373374">]</span><span class="op" id="4373375">.</span><span class="ident" id="4373376">Value</span><span class="op" id="4373381">,</span>&nbsp;<span class="ident" id="4373383">err</span>&nbsp;<span class="op" id="4373387">=</span>&nbsp;<span class="ident" id="4373389">asn1</span><span class="op" id="4373393">.</span><span class="ident" id="4373394">Marshal</span><span class="op" id="4373401">(</span><span class="ident" id="4373402">aiaValues</span><span class="op" id="4373411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373415">if</span>&nbsp;<span class="ident" id="4373418">err</span>&nbsp;<span class="op" id="4373422">!=</span>&nbsp;<span class="ident" id="4373425">nil</span>&nbsp;<span class="op" id="4373429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373434">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373443">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373447">n</span><span class="op" id="4373448">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373456">if</span>&nbsp;<span class="op" id="4373459">(</span><span class="builtinfunc" id="4373460">len</span><span class="op" id="4373463">(</span><span class="ident" id="4373464">template</span><span class="op" id="4373472">.</span><span class="ident" id="4373473">DNSNames</span><span class="op" id="4373481">)</span>&nbsp;<span class="op" id="4373483">&gt;</span>&nbsp;<span class="num" id="4373485">0</span>&nbsp;<span class="op" id="4373487">||</span>&nbsp;<span class="builtinfunc" id="4373490">len</span><span class="op" id="4373493">(</span><span class="ident" id="4373494">template</span><span class="op" id="4373502">.</span><span class="ident" id="4373503">EmailAddresses</span><span class="op" id="4373517">)</span>&nbsp;<span class="op" id="4373519">&gt;</span>&nbsp;<span class="num" id="4373521">0</span>&nbsp;<span class="op" id="4373523">||</span>&nbsp;<span class="builtinfunc" id="4373526">len</span><span class="op" id="4373529">(</span><span class="ident" id="4373530">template</span><span class="op" id="4373538">.</span><span class="ident" id="4373539">IPAddresses</span><span class="op" id="4373550">)</span>&nbsp;<span class="op" id="4373552">&gt;</span>&nbsp;<span class="num" id="4373554">0</span><span class="op" id="4373555">)</span>&nbsp;<span class="op" id="4373557">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373562">!</span><span class="ident" id="4373563">oidInExtensions</span><span class="op" id="4373578">(</span><span class="ident" id="4373579">oidExtensionSubjectAltName</span><span class="op" id="4373605">,</span>&nbsp;<span class="ident" id="4373607">template</span><span class="op" id="4373615">.</span><span class="ident" id="4373616">ExtraExtensions</span><span class="op" id="4373631">)</span>&nbsp;<span class="op" id="4373633">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373637">ret</span><span class="op" id="4373640">[</span><span class="ident" id="4373641">n</span><span class="op" id="4373642">]</span><span class="op" id="4373643">.</span><span class="ident" id="4373644">Id</span>&nbsp;<span class="op" id="4373647">=</span>&nbsp;<span class="ident" id="4373649">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373678">ret</span><span class="op" id="4373681">[</span><span class="ident" id="4373682">n</span><span class="op" id="4373683">]</span><span class="op" id="4373684">.</span><span class="ident" id="4373685">Value</span><span class="op" id="4373690">,</span>&nbsp;<span class="ident" id="4373692">err</span>&nbsp;<span class="op" id="4373696">=</span>&nbsp;<span class="ident" id="4373698">marshalSANs</span><span class="op" id="4373709">(</span><span class="ident" id="4373710">template</span><span class="op" id="4373718">.</span><span class="ident" id="4373719">DNSNames</span><span class="op" id="4373727">,</span>&nbsp;<span class="ident" id="4373729">template</span><span class="op" id="4373737">.</span><span class="ident" id="4373738">EmailAddresses</span><span class="op" id="4373752">,</span>&nbsp;<span class="ident" id="4373754">template</span><span class="op" id="4373762">.</span><span class="ident" id="4373763">IPAddresses</span><span class="op" id="4373774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373778">if</span>&nbsp;<span class="ident" id="4373781">err</span>&nbsp;<span class="op" id="4373785">!=</span>&nbsp;<span class="ident" id="4373788">nil</span>&nbsp;<span class="op" id="4373792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373806">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373810">n</span><span class="op" id="4373811">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373819">if</span>&nbsp;<span class="builtinfunc" id="4373822">len</span><span class="op" id="4373825">(</span><span class="ident" id="4373826">template</span><span class="op" id="4373834">.</span><span class="ident" id="4373835">PolicyIdentifiers</span><span class="op" id="4373852">)</span>&nbsp;<span class="op" id="4373854">&gt;</span>&nbsp;<span class="num" id="4373856">0</span>&nbsp;<span class="op" id="4373858">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373863">!</span><span class="ident" id="4373864">oidInExtensions</span><span class="op" id="4373879">(</span><span class="ident" id="4373880">oidExtensionCertificatePolicies</span><span class="op" id="4373911">,</span>&nbsp;<span class="ident" id="4373913">template</span><span class="op" id="4373921">.</span><span class="ident" id="4373922">ExtraExtensions</span><span class="op" id="4373937">)</span>&nbsp;<span class="op" id="4373939">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373943">ret</span><span class="op" id="4373946">[</span><span class="ident" id="4373947">n</span><span class="op" id="4373948">]</span><span class="op" id="4373949">.</span><span class="ident" id="4373950">Id</span>&nbsp;<span class="op" id="4373953">=</span>&nbsp;<span class="ident" id="4373955">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373989">policies</span>&nbsp;<span class="op" id="4373998">:=</span>&nbsp;<span class="builtinfunc" id="4374001">make</span><span class="op" id="4374005">(</span><span class="op" id="4374006">[</span><span class="op" id="4374007">]</span><span class="ident" id="4374008">policyInformation</span><span class="op" id="4374025">,</span>&nbsp;<span class="builtinfunc" id="4374027">len</span><span class="op" id="4374030">(</span><span class="ident" id="4374031">template</span><span class="op" id="4374039">.</span><span class="ident" id="4374040">PolicyIdentifiers</span><span class="op" id="4374057">)</span><span class="op" id="4374058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374062">for</span>&nbsp;<span class="ident" id="4374066">i</span><span class="op" id="4374067">,</span>&nbsp;<span class="ident" id="4374069">policy</span>&nbsp;<span class="op" id="4374076">:=</span>&nbsp;<span class="keyword" id="4374079">range</span>&nbsp;<span class="ident" id="4374085">template</span><span class="op" id="4374093">.</span><span class="ident" id="4374094">PolicyIdentifiers</span>&nbsp;<span class="op" id="4374112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374117">policies</span><span class="op" id="4374125">[</span><span class="ident" id="4374126">i</span><span class="op" id="4374127">]</span><span class="op" id="4374128">.</span><span class="ident" id="4374129">Policy</span>&nbsp;<span class="op" id="4374136">=</span>&nbsp;<span class="ident" id="4374138">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374147">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374151">ret</span><span class="op" id="4374154">[</span><span class="ident" id="4374155">n</span><span class="op" id="4374156">]</span><span class="op" id="4374157">.</span><span class="ident" id="4374158">Value</span><span class="op" id="4374163">,</span>&nbsp;<span class="ident" id="4374165">err</span>&nbsp;<span class="op" id="4374169">=</span>&nbsp;<span class="ident" id="4374171">asn1</span><span class="op" id="4374175">.</span><span class="ident" id="4374176">Marshal</span><span class="op" id="4374183">(</span><span class="ident" id="4374184">policies</span><span class="op" id="4374192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374196">if</span>&nbsp;<span class="ident" id="4374199">err</span>&nbsp;<span class="op" id="4374203">!=</span>&nbsp;<span class="ident" id="4374206">nil</span>&nbsp;<span class="op" id="4374210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374215">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374228">n</span><span class="op" id="4374229">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374237">if</span>&nbsp;<span class="builtinfunc" id="4374240">len</span><span class="op" id="4374243">(</span><span class="ident" id="4374244">template</span><span class="op" id="4374252">.</span><span class="ident" id="4374253">PermittedDNSDomains</span><span class="op" id="4374272">)</span>&nbsp;<span class="op" id="4374274">&gt;</span>&nbsp;<span class="num" id="4374276">0</span>&nbsp;<span class="op" id="4374278">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374283">!</span><span class="ident" id="4374284">oidInExtensions</span><span class="op" id="4374299">(</span><span class="ident" id="4374300">oidExtensionNameConstraints</span><span class="op" id="4374327">,</span>&nbsp;<span class="ident" id="4374329">template</span><span class="op" id="4374337">.</span><span class="ident" id="4374338">ExtraExtensions</span><span class="op" id="4374353">)</span>&nbsp;<span class="op" id="4374355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374359">ret</span><span class="op" id="4374362">[</span><span class="ident" id="4374363">n</span><span class="op" id="4374364">]</span><span class="op" id="4374365">.</span><span class="ident" id="4374366">Id</span>&nbsp;<span class="op" id="4374369">=</span>&nbsp;<span class="ident" id="4374371">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374401">ret</span><span class="op" id="4374404">[</span><span class="ident" id="4374405">n</span><span class="op" id="4374406">]</span><span class="op" id="4374407">.</span><span class="ident" id="4374408">Critical</span>&nbsp;<span class="op" id="4374417">=</span>&nbsp;<span class="ident" id="4374419">template</span><span class="op" id="4374427">.</span><span class="ident" id="4374428">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374459">var</span>&nbsp;<span class="ident" id="4374463">out</span>&nbsp;<span class="ident" id="4374467">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374485">out</span><span class="op" id="4374488">.</span><span class="ident" id="4374489">Permitted</span>&nbsp;<span class="op" id="4374499">=</span>&nbsp;<span class="builtinfunc" id="4374501">make</span><span class="op" id="4374505">(</span><span class="op" id="4374506">[</span><span class="op" id="4374507">]</span><span class="ident" id="4374508">generalSubtree</span><span class="op" id="4374522">,</span>&nbsp;<span class="builtinfunc" id="4374524">len</span><span class="op" id="4374527">(</span><span class="ident" id="4374528">template</span><span class="op" id="4374536">.</span><span class="ident" id="4374537">PermittedDNSDomains</span><span class="op" id="4374556">)</span><span class="op" id="4374557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374561">for</span>&nbsp;<span class="ident" id="4374565">i</span><span class="op" id="4374566">,</span>&nbsp;<span class="ident" id="4374568">permitted</span>&nbsp;<span class="op" id="4374578">:=</span>&nbsp;<span class="keyword" id="4374581">range</span>&nbsp;<span class="ident" id="4374587">template</span><span class="op" id="4374595">.</span><span class="ident" id="4374596">PermittedDNSDomains</span>&nbsp;<span class="op" id="4374616">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374621">out</span><span class="op" id="4374624">.</span><span class="ident" id="4374625">Permitted</span><span class="op" id="4374634">[</span><span class="ident" id="4374635">i</span><span class="op" id="4374636">]</span>&nbsp;<span class="op" id="4374638">=</span>&nbsp;<span class="ident" id="4374640">generalSubtree</span><span class="op" id="4374654">{</span><span class="ident" id="4374655">Name</span><span class="op" id="4374659">:</span>&nbsp;<span class="ident" id="4374661">permitted</span><span class="op" id="4374670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374678">ret</span><span class="op" id="4374681">[</span><span class="ident" id="4374682">n</span><span class="op" id="4374683">]</span><span class="op" id="4374684">.</span><span class="ident" id="4374685">Value</span><span class="op" id="4374690">,</span>&nbsp;<span class="ident" id="4374692">err</span>&nbsp;<span class="op" id="4374696">=</span>&nbsp;<span class="ident" id="4374698">asn1</span><span class="op" id="4374702">.</span><span class="ident" id="4374703">Marshal</span><span class="op" id="4374710">(</span><span class="ident" id="4374711">out</span><span class="op" id="4374714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374718">if</span>&nbsp;<span class="ident" id="4374721">err</span>&nbsp;<span class="op" id="4374725">!=</span>&nbsp;<span class="ident" id="4374728">nil</span>&nbsp;<span class="op" id="4374732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374737">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374750">n</span><span class="op" id="4374751">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374759">if</span>&nbsp;<span class="builtinfunc" id="4374762">len</span><span class="op" id="4374765">(</span><span class="ident" id="4374766">template</span><span class="op" id="4374774">.</span><span class="ident" id="4374775">CRLDistributionPoints</span><span class="op" id="4374796">)</span>&nbsp;<span class="op" id="4374798">&gt;</span>&nbsp;<span class="num" id="4374800">0</span>&nbsp;<span class="op" id="4374802">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374807">!</span><span class="ident" id="4374808">oidInExtensions</span><span class="op" id="4374823">(</span><span class="ident" id="4374824">oidExtensionCRLDistributionPoints</span><span class="op" id="4374857">,</span>&nbsp;<span class="ident" id="4374859">template</span><span class="op" id="4374867">.</span><span class="ident" id="4374868">ExtraExtensions</span><span class="op" id="4374883">)</span>&nbsp;<span class="op" id="4374885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374889">ret</span><span class="op" id="4374892">[</span><span class="ident" id="4374893">n</span><span class="op" id="4374894">]</span><span class="op" id="4374895">.</span><span class="ident" id="4374896">Id</span>&nbsp;<span class="op" id="4374899">=</span>&nbsp;<span class="ident" id="4374901">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374938">var</span>&nbsp;<span class="ident" id="4374942">crlDp</span>&nbsp;<span class="op" id="4374948">[</span><span class="op" id="4374949">]</span><span class="ident" id="4374950">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374970">for</span>&nbsp;<span class="ident" id="4374974">_</span><span class="op" id="4374975">,</span>&nbsp;<span class="ident" id="4374977">name</span>&nbsp;<span class="op" id="4374982">:=</span>&nbsp;<span class="keyword" id="4374985">range</span>&nbsp;<span class="ident" id="4374991">template</span><span class="op" id="4374999">.</span><span class="ident" id="4375000">CRLDistributionPoints</span>&nbsp;<span class="op" id="4375022">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375027">rawFullName</span><span class="op" id="4375038">,</span>&nbsp;<span class="ident" id="4375040">_</span>&nbsp;<span class="op" id="4375042">:=</span>&nbsp;<span class="ident" id="4375045">asn1</span><span class="op" id="4375049">.</span><span class="ident" id="4375050">Marshal</span><span class="op" id="4375057">(</span><span class="ident" id="4375058">asn1</span><span class="op" id="4375062">.</span><span class="ident" id="4375063">RawValue</span><span class="op" id="4375071">{</span><span class="ident" id="4375072">Tag</span><span class="op" id="4375075">:</span>&nbsp;<span class="num" id="4375077">6</span><span class="op" id="4375078">,</span>&nbsp;<span class="ident" id="4375080">Class</span><span class="op" id="4375085">:</span>&nbsp;<span class="num" id="4375087">2</span><span class="op" id="4375088">,</span>&nbsp;<span class="ident" id="4375090">Bytes</span><span class="op" id="4375095">:</span>&nbsp;<span class="op" id="4375097">[</span><span class="op" id="4375098">]</span><span class="builtintype" id="4375099">byte</span><span class="op" id="4375103">(</span><span class="ident" id="4375104">name</span><span class="op" id="4375108">)</span><span class="op" id="4375109">}</span><span class="op" id="4375110">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375116">dp</span>&nbsp;<span class="op" id="4375119">:=</span>&nbsp;<span class="ident" id="4375122">distributionPoint</span><span class="op" id="4375139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375145">DistributionPoint</span><span class="op" id="4375162">:</span>&nbsp;<span class="ident" id="4375164">distributionPointName</span><span class="op" id="4375185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375192">FullName</span><span class="op" id="4375200">:</span>&nbsp;<span class="ident" id="4375202">asn1</span><span class="op" id="4375206">.</span><span class="ident" id="4375207">RawValue</span><span class="op" id="4375215">{</span><span class="ident" id="4375216">Tag</span><span class="op" id="4375219">:</span>&nbsp;<span class="num" id="4375221">0</span><span class="op" id="4375222">,</span>&nbsp;<span class="ident" id="4375224">Class</span><span class="op" id="4375229">:</span>&nbsp;<span class="num" id="4375231">2</span><span class="op" id="4375232">,</span>&nbsp;<span class="ident" id="4375234">IsCompound</span><span class="op" id="4375244">:</span>&nbsp;<span class="builtintype" id="4375246">true</span><span class="op" id="4375250">,</span>&nbsp;<span class="ident" id="4375252">Bytes</span><span class="op" id="4375257">:</span>&nbsp;<span class="ident" id="4375259">rawFullName</span><span class="op" id="4375270">}</span><span class="op" id="4375271">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375277">}</span><span class="op" id="4375278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375288">crlDp</span>&nbsp;<span class="op" id="4375294">=</span>&nbsp;<span class="builtinfunc" id="4375296">append</span><span class="op" id="4375302">(</span><span class="ident" id="4375303">crlDp</span><span class="op" id="4375308">,</span>&nbsp;<span class="ident" id="4375310">dp</span><span class="op" id="4375312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375321">ret</span><span class="op" id="4375324">[</span><span class="ident" id="4375325">n</span><span class="op" id="4375326">]</span><span class="op" id="4375327">.</span><span class="ident" id="4375328">Value</span><span class="op" id="4375333">,</span>&nbsp;<span class="ident" id="4375335">err</span>&nbsp;<span class="op" id="4375339">=</span>&nbsp;<span class="ident" id="4375341">asn1</span><span class="op" id="4375345">.</span><span class="ident" id="4375346">Marshal</span><span class="op" id="4375353">(</span><span class="ident" id="4375354">crlDp</span><span class="op" id="4375359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375363">if</span>&nbsp;<span class="ident" id="4375366">err</span>&nbsp;<span class="op" id="4375370">!=</span>&nbsp;<span class="ident" id="4375373">nil</span>&nbsp;<span class="op" id="4375377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375395">n</span><span class="op" id="4375396">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375404">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375477">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375536">return</span>&nbsp;<span class="builtinfunc" id="4375543">append</span><span class="op" id="4375549">(</span><span class="ident" id="4375550">ret</span><span class="op" id="4375553">[</span><span class="op" id="4375554">:</span><span class="ident" id="4375555">n</span><span class="op" id="4375556">]</span><span class="op" id="4375557">,</span>&nbsp;<span class="ident" id="4375559">template</span><span class="op" id="4375567">.</span><span class="ident" id="4375568">ExtraExtensions</span><span class="op" id="4375583">...</span><span class="op" id="4375586">)</span><span class="op" id="4375587">,</span>&nbsp;<span class="ident" id="4375589">nil</span><br>
<span class="lineno"></span><span class="op" id="4375593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4375596">func</span>&nbsp;<span class="ident" id="4375601">subjectBytes</span><span class="op" id="4375613">(</span><span class="ident" id="4375614">cert</span>&nbsp;<span class="op" id="4375619">*</span><span class="ident" id="4375620">Certificate</span><span class="op" id="4375631">)</span>&nbsp;<span class="op" id="4375633">(</span><span class="op" id="4375634">[</span><span class="op" id="4375635">]</span><span class="builtintype" id="4375636">byte</span><span class="op" id="4375640">,</span>&nbsp;<span class="builtintype" id="4375642">error</span><span class="op" id="4375647">)</span>&nbsp;<span class="op" id="4375649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375652">if</span>&nbsp;<span class="builtinfunc" id="4375655">len</span><span class="op" id="4375658">(</span><span class="ident" id="4375659">cert</span><span class="op" id="4375663">.</span><span class="ident" id="4375664">RawSubject</span><span class="op" id="4375674">)</span>&nbsp;<span class="op" id="4375676">&gt;</span>&nbsp;<span class="num" id="4375678">0</span>&nbsp;<span class="op" id="4375680">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375684">return</span>&nbsp;<span class="ident" id="4375691">cert</span><span class="op" id="4375695">.</span><span class="ident" id="4375696">RawSubject</span><span class="op" id="4375706">,</span>&nbsp;<span class="ident" id="4375708">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375717">return</span>&nbsp;<span class="ident" id="4375724">asn1</span><span class="op" id="4375728">.</span><span class="ident" id="4375729">Marshal</span><span class="op" id="4375736">(</span><span class="ident" id="4375737">cert</span><span class="op" id="4375741">.</span><span class="ident" id="4375742">Subject</span><span class="op" id="4375749">.</span><span class="ident" id="4375750">ToRDNSequence</span><span class="op" id="4375763">(</span><span class="op" id="4375764">)</span><span class="op" id="4375765">)</span><br>
<span class="lineno"></span><span class="op" id="4375767">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4375770">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4375847">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4375918">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4375942">func</span>&nbsp;<span class="ident" id="4375947">signingParamsForPrivateKey</span><span class="op" id="4375973">(</span><span class="ident" id="4375974">priv</span>&nbsp;<span class="keyword" id="4375979">interface</span><span class="op" id="4375988">{</span><span class="op" id="4375989">}</span><span class="op" id="4375990">,</span>&nbsp;<span class="ident" id="4375992">requestedSigAlgo</span>&nbsp;<span class="ident" id="4376009">SignatureAlgorithm</span><span class="op" id="4376027">)</span>&nbsp;<span class="op" id="4376029">(</span><span class="ident" id="4376030">hashFunc</span>&nbsp;<span class="ident" id="4376039">crypto</span><span class="op" id="4376045">.</span><span class="ident" id="4376046">Hash</span><span class="op" id="4376050">,</span>&nbsp;<span class="ident" id="4376052">sigAlgo</span>&nbsp;<span class="ident" id="4376060">pkix</span><span class="op" id="4376064">.</span><span class="ident" id="4376065">AlgorithmIdentifier</span><span class="op" id="4376084">,</span>&nbsp;<span class="ident" id="4376086">err</span>&nbsp;<span class="builtintype" id="4376090">error</span><span class="op" id="4376095">)</span>&nbsp;<span class="op" id="4376097">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376100">var</span>&nbsp;<span class="ident" id="4376104">pubType</span>&nbsp;<span class="ident" id="4376112">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376133">switch</span>&nbsp;<span class="ident" id="4376140">priv</span>&nbsp;<span class="op" id="4376145">:=</span>&nbsp;<span class="ident" id="4376148">priv</span><span class="op" id="4376152">.</span><span class="op" id="4376153">(</span><span class="keyword" id="4376154">type</span><span class="op" id="4376158">)</span>&nbsp;<span class="op" id="4376160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376163">case</span>&nbsp;<span class="op" id="4376168">*</span><span class="ident" id="4376169">rsa</span><span class="op" id="4376172">.</span><span class="ident" id="4376173">PrivateKey</span><span class="op" id="4376183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376187">pubType</span>&nbsp;<span class="op" id="4376195">=</span>&nbsp;<span class="ident" id="4376197">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376203">sigAlgo</span><span class="op" id="4376210">.</span><span class="ident" id="4376211">Algorithm</span>&nbsp;<span class="op" id="4376221">=</span>&nbsp;<span class="ident" id="4376223">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376251">hashFunc</span>&nbsp;<span class="op" id="4376260">=</span>&nbsp;<span class="ident" id="4376262">crypto</span><span class="op" id="4376268">.</span><span class="ident" id="4376269">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376278">case</span>&nbsp;<span class="op" id="4376283">*</span><span class="ident" id="4376284">ecdsa</span><span class="op" id="4376289">.</span><span class="ident" id="4376290">PrivateKey</span><span class="op" id="4376300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376304">pubType</span>&nbsp;<span class="op" id="4376312">=</span>&nbsp;<span class="ident" id="4376314">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376323">switch</span>&nbsp;<span class="ident" id="4376330">priv</span><span class="op" id="4376334">.</span><span class="ident" id="4376335">Curve</span>&nbsp;<span class="op" id="4376341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376345">case</span>&nbsp;<span class="ident" id="4376350">elliptic</span><span class="op" id="4376358">.</span><span class="ident" id="4376359">P224</span><span class="op" id="4376363">(</span><span class="op" id="4376364">)</span><span class="op" id="4376365">,</span>&nbsp;<span class="ident" id="4376367">elliptic</span><span class="op" id="4376375">.</span><span class="ident" id="4376376">P256</span><span class="op" id="4376380">(</span><span class="op" id="4376381">)</span><span class="op" id="4376382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376387">hashFunc</span>&nbsp;<span class="op" id="4376396">=</span>&nbsp;<span class="ident" id="4376398">crypto</span><span class="op" id="4376404">.</span><span class="ident" id="4376405">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376415">sigAlgo</span><span class="op" id="4376422">.</span><span class="ident" id="4376423">Algorithm</span>&nbsp;<span class="op" id="4376433">=</span>&nbsp;<span class="ident" id="4376435">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376465">case</span>&nbsp;<span class="ident" id="4376470">elliptic</span><span class="op" id="4376478">.</span><span class="ident" id="4376479">P384</span><span class="op" id="4376483">(</span><span class="op" id="4376484">)</span><span class="op" id="4376485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376490">hashFunc</span>&nbsp;<span class="op" id="4376499">=</span>&nbsp;<span class="ident" id="4376501">crypto</span><span class="op" id="4376507">.</span><span class="ident" id="4376508">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376518">sigAlgo</span><span class="op" id="4376525">.</span><span class="ident" id="4376526">Algorithm</span>&nbsp;<span class="op" id="4376536">=</span>&nbsp;<span class="ident" id="4376538">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376568">case</span>&nbsp;<span class="ident" id="4376573">elliptic</span><span class="op" id="4376581">.</span><span class="ident" id="4376582">P521</span><span class="op" id="4376586">(</span><span class="op" id="4376587">)</span><span class="op" id="4376588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376593">hashFunc</span>&nbsp;<span class="op" id="4376602">=</span>&nbsp;<span class="ident" id="4376604">crypto</span><span class="op" id="4376610">.</span><span class="ident" id="4376611">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376621">sigAlgo</span><span class="op" id="4376628">.</span><span class="ident" id="4376629">Algorithm</span>&nbsp;<span class="op" id="4376639">=</span>&nbsp;<span class="ident" id="4376641">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376671">default</span><span class="op" id="4376678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376683">err</span>&nbsp;<span class="op" id="4376687">=</span>&nbsp;<span class="ident" id="4376689">errors</span><span class="op" id="4376695">.</span><span class="ident" id="4376696">New</span><span class="op" id="4376699">(</span><span class="string" id="4376700">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4376730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376738">default</span><span class="op" id="4376745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376749">err</span>&nbsp;<span class="op" id="4376753">=</span>&nbsp;<span class="ident" id="4376755">errors</span><span class="op" id="4376761">.</span><span class="ident" id="4376762">New</span><span class="op" id="4376765">(</span><span class="string" id="4376766">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4376815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376822">if</span>&nbsp;<span class="ident" id="4376825">err</span>&nbsp;<span class="op" id="4376829">!=</span>&nbsp;<span class="ident" id="4376832">nil</span>&nbsp;<span class="op" id="4376836">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376840">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376852">if</span>&nbsp;<span class="ident" id="4376855">requestedSigAlgo</span>&nbsp;<span class="op" id="4376872">==</span>&nbsp;<span class="num" id="4376875">0</span>&nbsp;<span class="op" id="4376877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376881">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376893">found</span>&nbsp;<span class="op" id="4376899">:=</span>&nbsp;<span class="builtintype" id="4376902">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376909">for</span>&nbsp;<span class="ident" id="4376913">_</span><span class="op" id="4376914">,</span>&nbsp;<span class="ident" id="4376916">details</span>&nbsp;<span class="op" id="4376924">:=</span>&nbsp;<span class="keyword" id="4376927">range</span>&nbsp;<span class="ident" id="4376933">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4376959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376963">if</span>&nbsp;<span class="ident" id="4376966">details</span><span class="op" id="4376973">.</span><span class="ident" id="4376974">algo</span>&nbsp;<span class="op" id="4376979">==</span>&nbsp;<span class="ident" id="4376982">requestedSigAlgo</span>&nbsp;<span class="op" id="4376999">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377004">if</span>&nbsp;<span class="ident" id="4377007">details</span><span class="op" id="4377014">.</span><span class="ident" id="4377015">pubKeyAlgo</span>&nbsp;<span class="op" id="4377026">!=</span>&nbsp;<span class="ident" id="4377029">pubType</span>&nbsp;<span class="op" id="4377037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377043">err</span>&nbsp;<span class="op" id="4377047">=</span>&nbsp;<span class="ident" id="4377049">errors</span><span class="op" id="4377055">.</span><span class="ident" id="4377056">New</span><span class="op" id="4377059">(</span><span class="string" id="4377060">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4377128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377149">sigAlgo</span><span class="op" id="4377156">.</span><span class="ident" id="4377157">Algorithm</span><span class="op" id="4377166">,</span>&nbsp;<span class="ident" id="4377168">hashFunc</span>&nbsp;<span class="op" id="4377177">=</span>&nbsp;<span class="ident" id="4377179">details</span><span class="op" id="4377186">.</span><span class="ident" id="4377187">oid</span><span class="op" id="4377190">,</span>&nbsp;<span class="ident" id="4377192">details</span><span class="op" id="4377199">.</span><span class="ident" id="4377200">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377208">if</span>&nbsp;<span class="ident" id="4377211">hashFunc</span>&nbsp;<span class="op" id="4377220">==</span>&nbsp;<span class="num" id="4377223">0</span>&nbsp;<span class="op" id="4377225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377231">err</span>&nbsp;<span class="op" id="4377235">=</span>&nbsp;<span class="ident" id="4377237">errors</span><span class="op" id="4377243">.</span><span class="ident" id="4377244">New</span><span class="op" id="4377247">(</span><span class="string" id="4377248">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4377296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377302">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377317">found</span>&nbsp;<span class="op" id="4377323">=</span>&nbsp;<span class="builtintype" id="4377325">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377333">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377348">if</span>&nbsp;<span class="op" id="4377351">!</span><span class="ident" id="4377352">found</span>&nbsp;<span class="op" id="4377358">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377362">err</span>&nbsp;<span class="op" id="4377366">=</span>&nbsp;<span class="ident" id="4377368">errors</span><span class="op" id="4377374">.</span><span class="ident" id="4377375">New</span><span class="op" id="4377378">(</span><span class="string" id="4377379">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4377413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377420">return</span><br>
<span class="lineno"></span><span class="op" id="4377427">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4377430">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4377502">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4377579">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4377658">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4377732">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4377776">//</span><br>
<span class="lineno"></span><span class="comment" id="4377779">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4377859">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4377933">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4377986">//</span><br>
<span class="lineno"></span><span class="comment" id="4377989">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4378047">//</span><br>
<span class="lineno"></span><span class="comment" id="4378050">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4378119">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4378196">func</span>&nbsp;<span class="ident" id="4378201">CreateCertificate</span><span class="op" id="4378218">(</span><span class="ident" id="4378219">rand</span>&nbsp;<span class="ident" id="4378224">io</span><span class="op" id="4378226">.</span><span class="ident" id="4378227">Reader</span><span class="op" id="4378233">,</span>&nbsp;<span class="ident" id="4378235">template</span><span class="op" id="4378243">,</span>&nbsp;<span class="ident" id="4378245">parent</span>&nbsp;<span class="op" id="4378252">*</span><span class="ident" id="4378253">Certificate</span><span class="op" id="4378264">,</span>&nbsp;<span class="ident" id="4378266">pub</span>&nbsp;<span class="keyword" id="4378270">interface</span><span class="op" id="4378279">{</span><span class="op" id="4378280">}</span><span class="op" id="4378281">,</span>&nbsp;<span class="ident" id="4378283">priv</span>&nbsp;<span class="keyword" id="4378288">interface</span><span class="op" id="4378297">{</span><span class="op" id="4378298">}</span><span class="op" id="4378299">)</span>&nbsp;<span class="op" id="4378301">(</span><span class="ident" id="4378302">cert</span>&nbsp;<span class="op" id="4378307">[</span><span class="op" id="4378308">]</span><span class="builtintype" id="4378309">byte</span><span class="op" id="4378313">,</span>&nbsp;<span class="ident" id="4378315">err</span>&nbsp;<span class="builtintype" id="4378319">error</span><span class="op" id="4378324">)</span>&nbsp;<span class="op" id="4378326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378329">hashFunc</span><span class="op" id="4378337">,</span>&nbsp;<span class="ident" id="4378339">signatureAlgorithm</span><span class="op" id="4378357">,</span>&nbsp;<span class="ident" id="4378359">err</span>&nbsp;<span class="op" id="4378363">:=</span>&nbsp;<span class="ident" id="4378366">signingParamsForPrivateKey</span><span class="op" id="4378392">(</span><span class="ident" id="4378393">priv</span><span class="op" id="4378397">,</span>&nbsp;<span class="ident" id="4378399">template</span><span class="op" id="4378407">.</span><span class="ident" id="4378408">SignatureAlgorithm</span><span class="op" id="4378426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378429">if</span>&nbsp;<span class="ident" id="4378432">err</span>&nbsp;<span class="op" id="4378436">!=</span>&nbsp;<span class="ident" id="4378439">nil</span>&nbsp;<span class="op" id="4378443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378447">return</span>&nbsp;<span class="ident" id="4378454">nil</span><span class="op" id="4378457">,</span>&nbsp;<span class="ident" id="4378459">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378464">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378468">publicKeyBytes</span><span class="op" id="4378482">,</span>&nbsp;<span class="ident" id="4378484">publicKeyAlgorithm</span><span class="op" id="4378502">,</span>&nbsp;<span class="ident" id="4378504">err</span>&nbsp;<span class="op" id="4378508">:=</span>&nbsp;<span class="ident" id="4378511">marshalPublicKey</span><span class="op" id="4378527">(</span><span class="ident" id="4378528">pub</span><span class="op" id="4378531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378534">if</span>&nbsp;<span class="ident" id="4378537">err</span>&nbsp;<span class="op" id="4378541">!=</span>&nbsp;<span class="ident" id="4378544">nil</span>&nbsp;<span class="op" id="4378548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378552">return</span>&nbsp;<span class="ident" id="4378559">nil</span><span class="op" id="4378562">,</span>&nbsp;<span class="ident" id="4378564">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378569">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378573">if</span>&nbsp;<span class="ident" id="4378576">err</span>&nbsp;<span class="op" id="4378580">!=</span>&nbsp;<span class="ident" id="4378583">nil</span>&nbsp;<span class="op" id="4378587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378591">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378603">if</span>&nbsp;<span class="builtinfunc" id="4378606">len</span><span class="op" id="4378609">(</span><span class="ident" id="4378610">parent</span><span class="op" id="4378616">.</span><span class="ident" id="4378617">SubjectKeyId</span><span class="op" id="4378629">)</span>&nbsp;<span class="op" id="4378631">&gt;</span>&nbsp;<span class="num" id="4378633">0</span>&nbsp;<span class="op" id="4378635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378639">template</span><span class="op" id="4378647">.</span><span class="ident" id="4378648">AuthorityKeyId</span>&nbsp;<span class="op" id="4378663">=</span>&nbsp;<span class="ident" id="4378665">parent</span><span class="op" id="4378671">.</span><span class="ident" id="4378672">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378690">extensions</span><span class="op" id="4378700">,</span>&nbsp;<span class="ident" id="4378702">err</span>&nbsp;<span class="op" id="4378706">:=</span>&nbsp;<span class="ident" id="4378709">buildExtensions</span><span class="op" id="4378724">(</span><span class="ident" id="4378725">template</span><span class="op" id="4378733">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378736">if</span>&nbsp;<span class="ident" id="4378739">err</span>&nbsp;<span class="op" id="4378743">!=</span>&nbsp;<span class="ident" id="4378746">nil</span>&nbsp;<span class="op" id="4378750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378754">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378766">asn1Issuer</span><span class="op" id="4378776">,</span>&nbsp;<span class="ident" id="4378778">err</span>&nbsp;<span class="op" id="4378782">:=</span>&nbsp;<span class="ident" id="4378785">subjectBytes</span><span class="op" id="4378797">(</span><span class="ident" id="4378798">parent</span><span class="op" id="4378804">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378807">if</span>&nbsp;<span class="ident" id="4378810">err</span>&nbsp;<span class="op" id="4378814">!=</span>&nbsp;<span class="ident" id="4378817">nil</span>&nbsp;<span class="op" id="4378821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378825">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378837">asn1Subject</span><span class="op" id="4378848">,</span>&nbsp;<span class="ident" id="4378850">err</span>&nbsp;<span class="op" id="4378854">:=</span>&nbsp;<span class="ident" id="4378857">subjectBytes</span><span class="op" id="4378869">(</span><span class="ident" id="4378870">template</span><span class="op" id="4378878">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378881">if</span>&nbsp;<span class="ident" id="4378884">err</span>&nbsp;<span class="op" id="4378888">!=</span>&nbsp;<span class="ident" id="4378891">nil</span>&nbsp;<span class="op" id="4378895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378899">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378911">encodedPublicKey</span>&nbsp;<span class="op" id="4378928">:=</span>&nbsp;<span class="ident" id="4378931">asn1</span><span class="op" id="4378935">.</span><span class="ident" id="4378936">BitString</span><span class="op" id="4378945">{</span><span class="ident" id="4378946">BitLength</span><span class="op" id="4378955">:</span>&nbsp;<span class="builtinfunc" id="4378957">len</span><span class="op" id="4378960">(</span><span class="ident" id="4378961">publicKeyBytes</span><span class="op" id="4378975">)</span>&nbsp;<span class="op" id="4378977">*</span>&nbsp;<span class="num" id="4378979">8</span><span class="op" id="4378980">,</span>&nbsp;<span class="ident" id="4378982">Bytes</span><span class="op" id="4378987">:</span>&nbsp;<span class="ident" id="4378989">publicKeyBytes</span><span class="op" id="4379003">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379006">c</span>&nbsp;<span class="op" id="4379008">:=</span>&nbsp;<span class="ident" id="4379011">tbsCertificate</span><span class="op" id="4379025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379029">Version</span><span class="op" id="4379036">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4379049">2</span><span class="op" id="4379050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379054">SerialNumber</span><span class="op" id="4379066">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379074">template</span><span class="op" id="4379082">.</span><span class="ident" id="4379083">SerialNumber</span><span class="op" id="4379095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379099">SignatureAlgorithm</span><span class="op" id="4379117">:</span>&nbsp;<span class="ident" id="4379119">signatureAlgorithm</span><span class="op" id="4379137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379141">Issuer</span><span class="op" id="4379147">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379161">asn1</span><span class="op" id="4379165">.</span><span class="ident" id="4379166">RawValue</span><span class="op" id="4379174">{</span><span class="ident" id="4379175">FullBytes</span><span class="op" id="4379184">:</span>&nbsp;<span class="ident" id="4379186">asn1Issuer</span><span class="op" id="4379196">}</span><span class="op" id="4379197">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379201">Validity</span><span class="op" id="4379209">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379221">validity</span><span class="op" id="4379229">{</span><span class="ident" id="4379230">template</span><span class="op" id="4379238">.</span><span class="ident" id="4379239">NotBefore</span><span class="op" id="4379248">.</span><span class="ident" id="4379249">UTC</span><span class="op" id="4379252">(</span><span class="op" id="4379253">)</span><span class="op" id="4379254">,</span>&nbsp;<span class="ident" id="4379256">template</span><span class="op" id="4379264">.</span><span class="ident" id="4379265">NotAfter</span><span class="op" id="4379273">.</span><span class="ident" id="4379274">UTC</span><span class="op" id="4379277">(</span><span class="op" id="4379278">)</span><span class="op" id="4379279">}</span><span class="op" id="4379280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379284">Subject</span><span class="op" id="4379291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379304">asn1</span><span class="op" id="4379308">.</span><span class="ident" id="4379309">RawValue</span><span class="op" id="4379317">{</span><span class="ident" id="4379318">FullBytes</span><span class="op" id="4379327">:</span>&nbsp;<span class="ident" id="4379329">asn1Subject</span><span class="op" id="4379340">}</span><span class="op" id="4379341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379345">PublicKey</span><span class="op" id="4379354">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379365">publicKeyInfo</span><span class="op" id="4379378">{</span><span class="ident" id="4379379">nil</span><span class="op" id="4379382">,</span>&nbsp;<span class="ident" id="4379384">publicKeyAlgorithm</span><span class="op" id="4379402">,</span>&nbsp;<span class="ident" id="4379404">encodedPublicKey</span><span class="op" id="4379420">}</span><span class="op" id="4379421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379425">Extensions</span><span class="op" id="4379435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379445">extensions</span><span class="op" id="4379455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379458">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379462">tbsCertContents</span><span class="op" id="4379477">,</span>&nbsp;<span class="ident" id="4379479">err</span>&nbsp;<span class="op" id="4379483">:=</span>&nbsp;<span class="ident" id="4379486">asn1</span><span class="op" id="4379490">.</span><span class="ident" id="4379491">Marshal</span><span class="op" id="4379498">(</span><span class="ident" id="4379499">c</span><span class="op" id="4379500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379503">if</span>&nbsp;<span class="ident" id="4379506">err</span>&nbsp;<span class="op" id="4379510">!=</span>&nbsp;<span class="ident" id="4379513">nil</span>&nbsp;<span class="op" id="4379517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379521">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379529">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379533">c</span><span class="op" id="4379534">.</span><span class="ident" id="4379535">Raw</span>&nbsp;<span class="op" id="4379539">=</span>&nbsp;<span class="ident" id="4379541">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379559">h</span>&nbsp;<span class="op" id="4379561">:=</span>&nbsp;<span class="ident" id="4379564">hashFunc</span><span class="op" id="4379572">.</span><span class="ident" id="4379573">New</span><span class="op" id="4379576">(</span><span class="op" id="4379577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379580">h</span><span class="op" id="4379581">.</span><span class="ident" id="4379582">Write</span><span class="op" id="4379587">(</span><span class="ident" id="4379588">tbsCertContents</span><span class="op" id="4379603">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379606">digest</span>&nbsp;<span class="op" id="4379613">:=</span>&nbsp;<span class="ident" id="4379616">h</span><span class="op" id="4379617">.</span><span class="ident" id="4379618">Sum</span><span class="op" id="4379621">(</span><span class="ident" id="4379622">nil</span><span class="op" id="4379625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379629">var</span>&nbsp;<span class="ident" id="4379633">signature</span>&nbsp;<span class="op" id="4379643">[</span><span class="op" id="4379644">]</span><span class="builtintype" id="4379645">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379652">switch</span>&nbsp;<span class="ident" id="4379659">priv</span>&nbsp;<span class="op" id="4379664">:=</span>&nbsp;<span class="ident" id="4379667">priv</span><span class="op" id="4379671">.</span><span class="op" id="4379672">(</span><span class="keyword" id="4379673">type</span><span class="op" id="4379677">)</span>&nbsp;<span class="op" id="4379679">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379682">case</span>&nbsp;<span class="op" id="4379687">*</span><span class="ident" id="4379688">rsa</span><span class="op" id="4379691">.</span><span class="ident" id="4379692">PrivateKey</span><span class="op" id="4379702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379706">signature</span><span class="op" id="4379715">,</span>&nbsp;<span class="ident" id="4379717">err</span>&nbsp;<span class="op" id="4379721">=</span>&nbsp;<span class="ident" id="4379723">rsa</span><span class="op" id="4379726">.</span><span class="ident" id="4379727">SignPKCS1v15</span><span class="op" id="4379739">(</span><span class="ident" id="4379740">rand</span><span class="op" id="4379744">,</span>&nbsp;<span class="ident" id="4379746">priv</span><span class="op" id="4379750">,</span>&nbsp;<span class="ident" id="4379752">hashFunc</span><span class="op" id="4379760">,</span>&nbsp;<span class="ident" id="4379762">digest</span><span class="op" id="4379768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379771">case</span>&nbsp;<span class="op" id="4379776">*</span><span class="ident" id="4379777">ecdsa</span><span class="op" id="4379782">.</span><span class="ident" id="4379783">PrivateKey</span><span class="op" id="4379793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379797">var</span>&nbsp;<span class="ident" id="4379801">r</span><span class="op" id="4379802">,</span>&nbsp;<span class="ident" id="4379804">s</span>&nbsp;<span class="op" id="4379806">*</span><span class="ident" id="4379807">big</span><span class="op" id="4379810">.</span><span class="ident" id="4379811">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379817">if</span>&nbsp;<span class="ident" id="4379820">r</span><span class="op" id="4379821">,</span>&nbsp;<span class="ident" id="4379823">s</span><span class="op" id="4379824">,</span>&nbsp;<span class="ident" id="4379826">err</span>&nbsp;<span class="op" id="4379830">=</span>&nbsp;<span class="ident" id="4379832">ecdsa</span><span class="op" id="4379837">.</span><span class="ident" id="4379838">Sign</span><span class="op" id="4379842">(</span><span class="ident" id="4379843">rand</span><span class="op" id="4379847">,</span>&nbsp;<span class="ident" id="4379849">priv</span><span class="op" id="4379853">,</span>&nbsp;<span class="ident" id="4379855">digest</span><span class="op" id="4379861">)</span><span class="op" id="4379862">;</span>&nbsp;<span class="ident" id="4379864">err</span>&nbsp;<span class="op" id="4379868">==</span>&nbsp;<span class="ident" id="4379871">nil</span>&nbsp;<span class="op" id="4379875">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379880">signature</span><span class="op" id="4379889">,</span>&nbsp;<span class="ident" id="4379891">err</span>&nbsp;<span class="op" id="4379895">=</span>&nbsp;<span class="ident" id="4379897">asn1</span><span class="op" id="4379901">.</span><span class="ident" id="4379902">Marshal</span><span class="op" id="4379909">(</span><span class="ident" id="4379910">ecdsaSignature</span><span class="op" id="4379924">{</span><span class="ident" id="4379925">r</span><span class="op" id="4379926">,</span>&nbsp;<span class="ident" id="4379928">s</span><span class="op" id="4379929">}</span><span class="op" id="4379930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379937">default</span><span class="op" id="4379944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4379948">panic</span><span class="op" id="4379953">(</span><span class="string" id="4379954">&#34;internal&nbsp;error&#34;</span><span class="op" id="4379970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379973">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379977">if</span>&nbsp;<span class="ident" id="4379980">err</span>&nbsp;<span class="op" id="4379984">!=</span>&nbsp;<span class="ident" id="4379987">nil</span>&nbsp;<span class="op" id="4379991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379995">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380007">cert</span><span class="op" id="4380011">,</span>&nbsp;<span class="ident" id="4380013">err</span>&nbsp;<span class="op" id="4380017">=</span>&nbsp;<span class="ident" id="4380019">asn1</span><span class="op" id="4380023">.</span><span class="ident" id="4380024">Marshal</span><span class="op" id="4380031">(</span><span class="ident" id="4380032">certificate</span><span class="op" id="4380043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380047">nil</span><span class="op" id="4380050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380054">c</span><span class="op" id="4380055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380059">signatureAlgorithm</span><span class="op" id="4380077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380081">asn1</span><span class="op" id="4380085">.</span><span class="ident" id="4380086">BitString</span><span class="op" id="4380095">{</span><span class="ident" id="4380096">Bytes</span><span class="op" id="4380101">:</span>&nbsp;<span class="ident" id="4380103">signature</span><span class="op" id="4380112">,</span>&nbsp;<span class="ident" id="4380114">BitLength</span><span class="op" id="4380123">:</span>&nbsp;<span class="builtinfunc" id="4380125">len</span><span class="op" id="4380128">(</span><span class="ident" id="4380129">signature</span><span class="op" id="4380138">)</span>&nbsp;<span class="op" id="4380140">*</span>&nbsp;<span class="num" id="4380142">8</span><span class="op" id="4380143">}</span><span class="op" id="4380144">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380147">}</span><span class="op" id="4380148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380151">return</span><br>
<span class="lineno"></span><span class="op" id="4380158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380161">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4380239">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4380247">var</span>&nbsp;<span class="ident" id="4380251">pemCRLPrefix</span>&nbsp;<span class="op" id="4380264">=</span>&nbsp;<span class="op" id="4380266">[</span><span class="op" id="4380267">]</span><span class="builtintype" id="4380268">byte</span><span class="op" id="4380272">(</span><span class="string" id="4380273">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4380294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380297">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4380342">var</span>&nbsp;<span class="ident" id="4380346">pemType</span>&nbsp;<span class="op" id="4380354">=</span>&nbsp;<span class="string" id="4380356">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4380368">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4380444">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4380523">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4380600">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4380612">func</span>&nbsp;<span class="ident" id="4380617">ParseCRL</span><span class="op" id="4380625">(</span><span class="ident" id="4380626">crlBytes</span>&nbsp;<span class="op" id="4380635">[</span><span class="op" id="4380636">]</span><span class="builtintype" id="4380637">byte</span><span class="op" id="4380641">)</span>&nbsp;<span class="op" id="4380643">(</span><span class="ident" id="4380644">certList</span>&nbsp;<span class="op" id="4380653">*</span><span class="ident" id="4380654">pkix</span><span class="op" id="4380658">.</span><span class="ident" id="4380659">CertificateList</span><span class="op" id="4380674">,</span>&nbsp;<span class="ident" id="4380676">err</span>&nbsp;<span class="builtintype" id="4380680">error</span><span class="op" id="4380685">)</span>&nbsp;<span class="op" id="4380687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380690">if</span>&nbsp;<span class="ident" id="4380693">bytes</span><span class="op" id="4380698">.</span><span class="ident" id="4380699">HasPrefix</span><span class="op" id="4380708">(</span><span class="ident" id="4380709">crlBytes</span><span class="op" id="4380717">,</span>&nbsp;<span class="ident" id="4380719">pemCRLPrefix</span><span class="op" id="4380731">)</span>&nbsp;<span class="op" id="4380733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380737">block</span><span class="op" id="4380742">,</span>&nbsp;<span class="ident" id="4380744">_</span>&nbsp;<span class="op" id="4380746">:=</span>&nbsp;<span class="ident" id="4380749">pem</span><span class="op" id="4380752">.</span><span class="ident" id="4380753">Decode</span><span class="op" id="4380759">(</span><span class="ident" id="4380760">crlBytes</span><span class="op" id="4380768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380772">if</span>&nbsp;<span class="ident" id="4380775">block</span>&nbsp;<span class="op" id="4380781">!=</span>&nbsp;<span class="ident" id="4380784">nil</span>&nbsp;<span class="op" id="4380788">&amp;&amp;</span>&nbsp;<span class="ident" id="4380791">block</span><span class="op" id="4380796">.</span><span class="ident" id="4380797">Type</span>&nbsp;<span class="op" id="4380802">==</span>&nbsp;<span class="ident" id="4380805">pemType</span>&nbsp;<span class="op" id="4380813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380818">crlBytes</span>&nbsp;<span class="op" id="4380827">=</span>&nbsp;<span class="ident" id="4380829">block</span><span class="op" id="4380834">.</span><span class="ident" id="4380835">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380849">return</span>&nbsp;<span class="ident" id="4380856">ParseDERCRL</span><span class="op" id="4380867">(</span><span class="ident" id="4380868">crlBytes</span><span class="op" id="4380876">)</span><br>
<span class="lineno"></span><span class="op" id="4380878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4380881">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4380943">func</span>&nbsp;<span class="ident" id="4380948">ParseDERCRL</span><span class="op" id="4380959">(</span><span class="ident" id="4380960">derBytes</span>&nbsp;<span class="op" id="4380969">[</span><span class="op" id="4380970">]</span><span class="builtintype" id="4380971">byte</span><span class="op" id="4380975">)</span>&nbsp;<span class="op" id="4380977">(</span><span class="ident" id="4380978">certList</span>&nbsp;<span class="op" id="4380987">*</span><span class="ident" id="4380988">pkix</span><span class="op" id="4380992">.</span><span class="ident" id="4380993">CertificateList</span><span class="op" id="4381008">,</span>&nbsp;<span class="ident" id="4381010">err</span>&nbsp;<span class="builtintype" id="4381014">error</span><span class="op" id="4381019">)</span>&nbsp;<span class="op" id="4381021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381024">certList</span>&nbsp;<span class="op" id="4381033">=</span>&nbsp;<span class="builtinfunc" id="4381035">new</span><span class="op" id="4381038">(</span><span class="ident" id="4381039">pkix</span><span class="op" id="4381043">.</span><span class="ident" id="4381044">CertificateList</span><span class="op" id="4381059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381062">_</span><span class="op" id="4381063">,</span>&nbsp;<span class="ident" id="4381065">err</span>&nbsp;<span class="op" id="4381069">=</span>&nbsp;<span class="ident" id="4381071">asn1</span><span class="op" id="4381075">.</span><span class="ident" id="4381076">Unmarshal</span><span class="op" id="4381085">(</span><span class="ident" id="4381086">derBytes</span><span class="op" id="4381094">,</span>&nbsp;<span class="ident" id="4381096">certList</span><span class="op" id="4381104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381107">if</span>&nbsp;<span class="ident" id="4381110">err</span>&nbsp;<span class="op" id="4381114">!=</span>&nbsp;<span class="ident" id="4381117">nil</span>&nbsp;<span class="op" id="4381121">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381125">certList</span>&nbsp;<span class="op" id="4381134">=</span>&nbsp;<span class="ident" id="4381136">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381144">return</span><br>
<span class="lineno"></span><span class="op" id="4381151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4381154">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4381227">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4381279">//</span><br>
<span class="lineno"></span><span class="comment" id="4381282">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4381348">func</span>&nbsp;<span class="op" id="4381353">(</span><span class="ident" id="4381354">c</span>&nbsp;<span class="op" id="4381356">*</span><span class="ident" id="4381357">Certificate</span><span class="op" id="4381368">)</span>&nbsp;<span class="ident" id="4381370">CreateCRL</span><span class="op" id="4381379">(</span><span class="ident" id="4381380">rand</span>&nbsp;<span class="ident" id="4381385">io</span><span class="op" id="4381387">.</span><span class="ident" id="4381388">Reader</span><span class="op" id="4381394">,</span>&nbsp;<span class="ident" id="4381396">priv</span>&nbsp;<span class="keyword" id="4381401">interface</span><span class="op" id="4381410">{</span><span class="op" id="4381411">}</span><span class="op" id="4381412">,</span>&nbsp;<span class="ident" id="4381414">revokedCerts</span>&nbsp;<span class="op" id="4381427">[</span><span class="op" id="4381428">]</span><span class="ident" id="4381429">pkix</span><span class="op" id="4381433">.</span><span class="ident" id="4381434">RevokedCertificate</span><span class="op" id="4381452">,</span>&nbsp;<span class="ident" id="4381454">now</span><span class="op" id="4381457">,</span>&nbsp;<span class="ident" id="4381459">expiry</span>&nbsp;<span class="ident" id="4381466">time</span><span class="op" id="4381470">.</span><span class="ident" id="4381471">Time</span><span class="op" id="4381475">)</span>&nbsp;<span class="op" id="4381477">(</span><span class="ident" id="4381478">crlBytes</span>&nbsp;<span class="op" id="4381487">[</span><span class="op" id="4381488">]</span><span class="builtintype" id="4381489">byte</span><span class="op" id="4381493">,</span>&nbsp;<span class="ident" id="4381495">err</span>&nbsp;<span class="builtintype" id="4381499">error</span><span class="op" id="4381504">)</span>&nbsp;<span class="op" id="4381506">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381509">rsaPriv</span><span class="op" id="4381516">,</span>&nbsp;<span class="ident" id="4381518">ok</span>&nbsp;<span class="op" id="4381521">:=</span>&nbsp;<span class="ident" id="4381524">priv</span><span class="op" id="4381528">.</span><span class="op" id="4381529">(</span><span class="op" id="4381530">*</span><span class="ident" id="4381531">rsa</span><span class="op" id="4381534">.</span><span class="ident" id="4381535">PrivateKey</span><span class="op" id="4381545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381548">if</span>&nbsp;<span class="op" id="4381551">!</span><span class="ident" id="4381552">ok</span>&nbsp;<span class="op" id="4381555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381559">return</span>&nbsp;<span class="ident" id="4381566">nil</span><span class="op" id="4381569">,</span>&nbsp;<span class="ident" id="4381571">errors</span><span class="op" id="4381577">.</span><span class="ident" id="4381578">New</span><span class="op" id="4381581">(</span><span class="string" id="4381582">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4381624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381630">tbsCertList</span>&nbsp;<span class="op" id="4381642">:=</span>&nbsp;<span class="ident" id="4381645">pkix</span><span class="op" id="4381649">.</span><span class="ident" id="4381650">TBSCertificateList</span><span class="op" id="4381668">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381672">Version</span><span class="op" id="4381679">:</span>&nbsp;<span class="num" id="4381681">2</span><span class="op" id="4381682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381686">Signature</span><span class="op" id="4381695">:</span>&nbsp;<span class="ident" id="4381697">pkix</span><span class="op" id="4381701">.</span><span class="ident" id="4381702">AlgorithmIdentifier</span><span class="op" id="4381721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381726">Algorithm</span><span class="op" id="4381735">:</span>&nbsp;<span class="ident" id="4381737">oidSignatureSHA1WithRSA</span><span class="op" id="4381760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381764">}</span><span class="op" id="4381765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381769">Issuer</span><span class="op" id="4381775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381790">c</span><span class="op" id="4381791">.</span><span class="ident" id="4381792">Subject</span><span class="op" id="4381799">.</span><span class="ident" id="4381800">ToRDNSequence</span><span class="op" id="4381813">(</span><span class="op" id="4381814">)</span><span class="op" id="4381815">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381819">ThisUpdate</span><span class="op" id="4381829">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381840">now</span><span class="op" id="4381843">.</span><span class="ident" id="4381844">UTC</span><span class="op" id="4381847">(</span><span class="op" id="4381848">)</span><span class="op" id="4381849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381853">NextUpdate</span><span class="op" id="4381863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381874">expiry</span><span class="op" id="4381880">.</span><span class="ident" id="4381881">UTC</span><span class="op" id="4381884">(</span><span class="op" id="4381885">)</span><span class="op" id="4381886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381890">RevokedCertificates</span><span class="op" id="4381909">:</span>&nbsp;<span class="ident" id="4381911">revokedCerts</span><span class="op" id="4381923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381930">tbsCertListContents</span><span class="op" id="4381949">,</span>&nbsp;<span class="ident" id="4381951">err</span>&nbsp;<span class="op" id="4381955">:=</span>&nbsp;<span class="ident" id="4381958">asn1</span><span class="op" id="4381962">.</span><span class="ident" id="4381963">Marshal</span><span class="op" id="4381970">(</span><span class="ident" id="4381971">tbsCertList</span><span class="op" id="4381982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381985">if</span>&nbsp;<span class="ident" id="4381988">err</span>&nbsp;<span class="op" id="4381992">!=</span>&nbsp;<span class="ident" id="4381995">nil</span>&nbsp;<span class="op" id="4381999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382003">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382015">h</span>&nbsp;<span class="op" id="4382017">:=</span>&nbsp;<span class="ident" id="4382020">sha1</span><span class="op" id="4382024">.</span><span class="ident" id="4382025">New</span><span class="op" id="4382028">(</span><span class="op" id="4382029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382032">h</span><span class="op" id="4382033">.</span><span class="ident" id="4382034">Write</span><span class="op" id="4382039">(</span><span class="ident" id="4382040">tbsCertListContents</span><span class="op" id="4382059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382062">digest</span>&nbsp;<span class="op" id="4382069">:=</span>&nbsp;<span class="ident" id="4382072">h</span><span class="op" id="4382073">.</span><span class="ident" id="4382074">Sum</span><span class="op" id="4382077">(</span><span class="ident" id="4382078">nil</span><span class="op" id="4382081">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382085">signature</span><span class="op" id="4382094">,</span>&nbsp;<span class="ident" id="4382096">err</span>&nbsp;<span class="op" id="4382100">:=</span>&nbsp;<span class="ident" id="4382103">rsa</span><span class="op" id="4382106">.</span><span class="ident" id="4382107">SignPKCS1v15</span><span class="op" id="4382119">(</span><span class="ident" id="4382120">rand</span><span class="op" id="4382124">,</span>&nbsp;<span class="ident" id="4382126">rsaPriv</span><span class="op" id="4382133">,</span>&nbsp;<span class="ident" id="4382135">crypto</span><span class="op" id="4382141">.</span><span class="ident" id="4382142">SHA1</span><span class="op" id="4382146">,</span>&nbsp;<span class="ident" id="4382148">digest</span><span class="op" id="4382154">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382157">if</span>&nbsp;<span class="ident" id="4382160">err</span>&nbsp;<span class="op" id="4382164">!=</span>&nbsp;<span class="ident" id="4382167">nil</span>&nbsp;<span class="op" id="4382171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382175">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382187">return</span>&nbsp;<span class="ident" id="4382194">asn1</span><span class="op" id="4382198">.</span><span class="ident" id="4382199">Marshal</span><span class="op" id="4382206">(</span><span class="ident" id="4382207">pkix</span><span class="op" id="4382211">.</span><span class="ident" id="4382212">CertificateList</span><span class="op" id="4382227">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382231">TBSCertList</span><span class="op" id="4382242">:</span>&nbsp;<span class="ident" id="4382244">tbsCertList</span><span class="op" id="4382255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382259">SignatureAlgorithm</span><span class="op" id="4382277">:</span>&nbsp;<span class="ident" id="4382279">pkix</span><span class="op" id="4382283">.</span><span class="ident" id="4382284">AlgorithmIdentifier</span><span class="op" id="4382303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382308">Algorithm</span><span class="op" id="4382317">:</span>&nbsp;<span class="ident" id="4382319">oidSignatureSHA1WithRSA</span><span class="op" id="4382342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382346">}</span><span class="op" id="4382347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382351">SignatureValue</span><span class="op" id="4382365">:</span>&nbsp;<span class="ident" id="4382367">asn1</span><span class="op" id="4382371">.</span><span class="ident" id="4382372">BitString</span><span class="op" id="4382381">{</span><span class="ident" id="4382382">Bytes</span><span class="op" id="4382387">:</span>&nbsp;<span class="ident" id="4382389">signature</span><span class="op" id="4382398">,</span>&nbsp;<span class="ident" id="4382400">BitLength</span><span class="op" id="4382409">:</span>&nbsp;<span class="builtinfunc" id="4382411">len</span><span class="op" id="4382414">(</span><span class="ident" id="4382415">signature</span><span class="op" id="4382424">)</span>&nbsp;<span class="op" id="4382426">*</span>&nbsp;<span class="num" id="4382428">8</span><span class="op" id="4382429">}</span><span class="op" id="4382430">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382433">}</span><span class="op" id="4382434">)</span><br>
<span class="lineno"></span><span class="op" id="4382436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4382439">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4382515">type</span>&nbsp;<span class="ident" id="4382520">CertificateRequest</span>&nbsp;<span class="keyword" id="4382539">struct</span>&nbsp;<span class="op" id="4382546">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382549">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382574">[</span><span class="op" id="4382575">]</span><span class="builtintype" id="4382576">byte</span>&nbsp;<span class="comment" id="4382581">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382654">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4382679">[</span><span class="op" id="4382680">]</span><span class="builtintype" id="4382681">byte</span>&nbsp;<span class="comment" id="4382686">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382746">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4382771">[</span><span class="op" id="4382772">]</span><span class="builtintype" id="4382773">byte</span>&nbsp;<span class="comment" id="4382778">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382816">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382841">[</span><span class="op" id="4382842">]</span><span class="builtintype" id="4382843">byte</span>&nbsp;<span class="comment" id="4382848">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382874">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4382893">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382898">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382917">[</span><span class="op" id="4382918">]</span><span class="builtintype" id="4382919">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382925">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4382944">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382965">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4382984">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383004">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4383023">interface</span><span class="op" id="4383032">{</span><span class="op" id="4383033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383037">Subject</span>&nbsp;<span class="ident" id="4383045">pkix</span><span class="op" id="4383049">.</span><span class="ident" id="4383050">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383057">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383112">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383177">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383207">Attributes</span>&nbsp;<span class="op" id="4383218">[</span><span class="op" id="4383219">]</span><span class="ident" id="4383220">pkix</span><span class="op" id="4383224">.</span><span class="ident" id="4383225">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383252">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383322">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383388">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383401">Extensions</span>&nbsp;<span class="op" id="4383412">[</span><span class="op" id="4383413">]</span><span class="ident" id="4383414">pkix</span><span class="op" id="4383418">.</span><span class="ident" id="4383419">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383431">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383499">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383570">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383638">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383678">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383682">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383752">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383768">ExtraExtensions</span>&nbsp;<span class="op" id="4383784">[</span><span class="op" id="4383785">]</span><span class="ident" id="4383786">pkix</span><span class="op" id="4383790">.</span><span class="ident" id="4383791">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383803">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383838">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4383853">[</span><span class="op" id="4383854">]</span><span class="builtintype" id="4383855">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383863">EmailAddresses</span>&nbsp;<span class="op" id="4383878">[</span><span class="op" id="4383879">]</span><span class="builtintype" id="4383880">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383888">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4383903">[</span><span class="op" id="4383904">]</span><span class="ident" id="4383905">net</span><span class="op" id="4383908">.</span><span class="ident" id="4383909">IP</span><br>
<span class="lineno"></span><span class="op" id="4383912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4383915">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4383984">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4384023">type</span>&nbsp;<span class="ident" id="4384028">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4384050">struct</span>&nbsp;<span class="op" id="4384057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384060">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4384071">asn1</span><span class="op" id="4384075">.</span><span class="ident" id="4384076">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384088">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4384099">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384104">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4384115">asn1</span><span class="op" id="4384119">.</span><span class="ident" id="4384120">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384130">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4384141">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384156">Attributes</span>&nbsp;<span class="op" id="4384167">[</span><span class="op" id="4384168">]</span><span class="ident" id="4384169">pkix</span><span class="op" id="4384173">.</span><span class="ident" id="4384174">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4384199">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4384214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4384217">type</span>&nbsp;<span class="ident" id="4384222">certificateRequest</span>&nbsp;<span class="keyword" id="4384241">struct</span>&nbsp;<span class="op" id="4384248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384251">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4384270">asn1</span><span class="op" id="4384274">.</span><span class="ident" id="4384275">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384287">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4384306">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384329">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4384348">pkix</span><span class="op" id="4384352">.</span><span class="ident" id="4384353">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384374">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4384393">asn1</span><span class="op" id="4384397">.</span><span class="ident" id="4384398">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4384408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4384411">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4384489">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4384513">var</span>&nbsp;<span class="ident" id="4384517">oidExtensionRequest</span>&nbsp;<span class="op" id="4384537">=</span>&nbsp;<span class="ident" id="4384539">asn1</span><span class="op" id="4384543">.</span><span class="ident" id="4384544">ObjectIdentifier</span><span class="op" id="4384560">{</span><span class="num" id="4384561">1</span><span class="op" id="4384562">,</span>&nbsp;<span class="num" id="4384564">2</span><span class="op" id="4384565">,</span>&nbsp;<span class="num" id="4384567">840</span><span class="op" id="4384570">,</span>&nbsp;<span class="num" id="4384572">113549</span><span class="op" id="4384578">,</span>&nbsp;<span class="num" id="4384580">1</span><span class="op" id="4384581">,</span>&nbsp;<span class="num" id="4384583">9</span><span class="op" id="4384584">,</span>&nbsp;<span class="num" id="4384586">14</span><span class="op" id="4384588">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4384591">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4384670">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4384734">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4384812">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4384865">//</span><br>
<span class="lineno"></span><span class="comment" id="4384868">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4384934">//</span><br>
<span class="lineno"></span><span class="comment" id="4384937">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4385005">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4385029">func</span>&nbsp;<span class="ident" id="4385034">CreateCertificateRequest</span><span class="op" id="4385058">(</span><span class="ident" id="4385059">rand</span>&nbsp;<span class="ident" id="4385064">io</span><span class="op" id="4385066">.</span><span class="ident" id="4385067">Reader</span><span class="op" id="4385073">,</span>&nbsp;<span class="ident" id="4385075">template</span>&nbsp;<span class="op" id="4385084">*</span><span class="ident" id="4385085">CertificateRequest</span><span class="op" id="4385103">,</span>&nbsp;<span class="ident" id="4385105">priv</span>&nbsp;<span class="keyword" id="4385110">interface</span><span class="op" id="4385119">{</span><span class="op" id="4385120">}</span><span class="op" id="4385121">)</span>&nbsp;<span class="op" id="4385123">(</span><span class="ident" id="4385124">csr</span>&nbsp;<span class="op" id="4385128">[</span><span class="op" id="4385129">]</span><span class="builtintype" id="4385130">byte</span><span class="op" id="4385134">,</span>&nbsp;<span class="ident" id="4385136">err</span>&nbsp;<span class="builtintype" id="4385140">error</span><span class="op" id="4385145">)</span>&nbsp;<span class="op" id="4385147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385150">hashFunc</span><span class="op" id="4385158">,</span>&nbsp;<span class="ident" id="4385160">sigAlgo</span><span class="op" id="4385167">,</span>&nbsp;<span class="ident" id="4385169">err</span>&nbsp;<span class="op" id="4385173">:=</span>&nbsp;<span class="ident" id="4385176">signingParamsForPrivateKey</span><span class="op" id="4385202">(</span><span class="ident" id="4385203">priv</span><span class="op" id="4385207">,</span>&nbsp;<span class="ident" id="4385209">template</span><span class="op" id="4385217">.</span><span class="ident" id="4385218">SignatureAlgorithm</span><span class="op" id="4385236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385239">if</span>&nbsp;<span class="ident" id="4385242">err</span>&nbsp;<span class="op" id="4385246">!=</span>&nbsp;<span class="ident" id="4385249">nil</span>&nbsp;<span class="op" id="4385253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385257">return</span>&nbsp;<span class="ident" id="4385264">nil</span><span class="op" id="4385267">,</span>&nbsp;<span class="ident" id="4385269">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385274">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385278">var</span>&nbsp;<span class="ident" id="4385282">publicKeyBytes</span>&nbsp;<span class="op" id="4385297">[</span><span class="op" id="4385298">]</span><span class="builtintype" id="4385299">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385305">var</span>&nbsp;<span class="ident" id="4385309">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4385328">pkix</span><span class="op" id="4385332">.</span><span class="ident" id="4385333">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385355">switch</span>&nbsp;<span class="ident" id="4385362">priv</span>&nbsp;<span class="op" id="4385367">:=</span>&nbsp;<span class="ident" id="4385370">priv</span><span class="op" id="4385374">.</span><span class="op" id="4385375">(</span><span class="keyword" id="4385376">type</span><span class="op" id="4385380">)</span>&nbsp;<span class="op" id="4385382">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385385">case</span>&nbsp;<span class="op" id="4385390">*</span><span class="ident" id="4385391">rsa</span><span class="op" id="4385394">.</span><span class="ident" id="4385395">PrivateKey</span><span class="op" id="4385405">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385409">publicKeyBytes</span><span class="op" id="4385423">,</span>&nbsp;<span class="ident" id="4385425">publicKeyAlgorithm</span><span class="op" id="4385443">,</span>&nbsp;<span class="ident" id="4385445">err</span>&nbsp;<span class="op" id="4385449">=</span>&nbsp;<span class="ident" id="4385451">marshalPublicKey</span><span class="op" id="4385467">(</span><span class="op" id="4385468">&amp;</span><span class="ident" id="4385469">priv</span><span class="op" id="4385473">.</span><span class="ident" id="4385474">PublicKey</span><span class="op" id="4385483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385486">case</span>&nbsp;<span class="op" id="4385491">*</span><span class="ident" id="4385492">ecdsa</span><span class="op" id="4385497">.</span><span class="ident" id="4385498">PrivateKey</span><span class="op" id="4385508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385512">publicKeyBytes</span><span class="op" id="4385526">,</span>&nbsp;<span class="ident" id="4385528">publicKeyAlgorithm</span><span class="op" id="4385546">,</span>&nbsp;<span class="ident" id="4385548">err</span>&nbsp;<span class="op" id="4385552">=</span>&nbsp;<span class="ident" id="4385554">marshalPublicKey</span><span class="op" id="4385570">(</span><span class="op" id="4385571">&amp;</span><span class="ident" id="4385572">priv</span><span class="op" id="4385576">.</span><span class="ident" id="4385577">PublicKey</span><span class="op" id="4385586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385589">default</span><span class="op" id="4385596">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4385600">panic</span><span class="op" id="4385605">(</span><span class="string" id="4385606">&#34;internal&nbsp;error&#34;</span><span class="op" id="4385622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385629">if</span>&nbsp;<span class="ident" id="4385632">err</span>&nbsp;<span class="op" id="4385636">!=</span>&nbsp;<span class="ident" id="4385639">nil</span>&nbsp;<span class="op" id="4385643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385647">return</span>&nbsp;<span class="ident" id="4385654">nil</span><span class="op" id="4385657">,</span>&nbsp;<span class="ident" id="4385659">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385668">var</span>&nbsp;<span class="ident" id="4385672">extensions</span>&nbsp;<span class="op" id="4385683">[</span><span class="op" id="4385684">]</span><span class="ident" id="4385685">pkix</span><span class="op" id="4385689">.</span><span class="ident" id="4385690">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385702">if</span>&nbsp;<span class="op" id="4385705">(</span><span class="builtinfunc" id="4385706">len</span><span class="op" id="4385709">(</span><span class="ident" id="4385710">template</span><span class="op" id="4385718">.</span><span class="ident" id="4385719">DNSNames</span><span class="op" id="4385727">)</span>&nbsp;<span class="op" id="4385729">&gt;</span>&nbsp;<span class="num" id="4385731">0</span>&nbsp;<span class="op" id="4385733">||</span>&nbsp;<span class="builtinfunc" id="4385736">len</span><span class="op" id="4385739">(</span><span class="ident" id="4385740">template</span><span class="op" id="4385748">.</span><span class="ident" id="4385749">EmailAddresses</span><span class="op" id="4385763">)</span>&nbsp;<span class="op" id="4385765">&gt;</span>&nbsp;<span class="num" id="4385767">0</span>&nbsp;<span class="op" id="4385769">||</span>&nbsp;<span class="builtinfunc" id="4385772">len</span><span class="op" id="4385775">(</span><span class="ident" id="4385776">template</span><span class="op" id="4385784">.</span><span class="ident" id="4385785">IPAddresses</span><span class="op" id="4385796">)</span>&nbsp;<span class="op" id="4385798">&gt;</span>&nbsp;<span class="num" id="4385800">0</span><span class="op" id="4385801">)</span>&nbsp;<span class="op" id="4385803">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385808">!</span><span class="ident" id="4385809">oidInExtensions</span><span class="op" id="4385824">(</span><span class="ident" id="4385825">oidExtensionSubjectAltName</span><span class="op" id="4385851">,</span>&nbsp;<span class="ident" id="4385853">template</span><span class="op" id="4385861">.</span><span class="ident" id="4385862">ExtraExtensions</span><span class="op" id="4385877">)</span>&nbsp;<span class="op" id="4385879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385883">sanBytes</span><span class="op" id="4385891">,</span>&nbsp;<span class="ident" id="4385893">err</span>&nbsp;<span class="op" id="4385897">:=</span>&nbsp;<span class="ident" id="4385900">marshalSANs</span><span class="op" id="4385911">(</span><span class="ident" id="4385912">template</span><span class="op" id="4385920">.</span><span class="ident" id="4385921">DNSNames</span><span class="op" id="4385929">,</span>&nbsp;<span class="ident" id="4385931">template</span><span class="op" id="4385939">.</span><span class="ident" id="4385940">EmailAddresses</span><span class="op" id="4385954">,</span>&nbsp;<span class="ident" id="4385956">template</span><span class="op" id="4385964">.</span><span class="ident" id="4385965">IPAddresses</span><span class="op" id="4385976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385980">if</span>&nbsp;<span class="ident" id="4385983">err</span>&nbsp;<span class="op" id="4385987">!=</span>&nbsp;<span class="ident" id="4385990">nil</span>&nbsp;<span class="op" id="4385994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385999">return</span>&nbsp;<span class="ident" id="4386006">nil</span><span class="op" id="4386009">,</span>&nbsp;<span class="ident" id="4386011">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386017">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386022">extensions</span>&nbsp;<span class="op" id="4386033">=</span>&nbsp;<span class="builtinfunc" id="4386035">append</span><span class="op" id="4386041">(</span><span class="ident" id="4386042">extensions</span><span class="op" id="4386052">,</span>&nbsp;<span class="ident" id="4386054">pkix</span><span class="op" id="4386058">.</span><span class="ident" id="4386059">Extension</span><span class="op" id="4386068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386073">Id</span><span class="op" id="4386075">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386080">oidExtensionSubjectAltName</span><span class="op" id="4386106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386111">Value</span><span class="op" id="4386116">:</span>&nbsp;<span class="ident" id="4386118">sanBytes</span><span class="op" id="4386126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386130">}</span><span class="op" id="4386131">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386138">extensions</span>&nbsp;<span class="op" id="4386149">=</span>&nbsp;<span class="builtinfunc" id="4386151">append</span><span class="op" id="4386157">(</span><span class="ident" id="4386158">extensions</span><span class="op" id="4386168">,</span>&nbsp;<span class="ident" id="4386170">template</span><span class="op" id="4386178">.</span><span class="ident" id="4386179">ExtraExtensions</span><span class="op" id="4386194">...</span><span class="op" id="4386197">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386201">var</span>&nbsp;<span class="ident" id="4386205">attributes</span>&nbsp;<span class="op" id="4386216">[</span><span class="op" id="4386217">]</span><span class="ident" id="4386218">pkix</span><span class="op" id="4386222">.</span><span class="ident" id="4386223">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386249">attributes</span>&nbsp;<span class="op" id="4386260">=</span>&nbsp;<span class="builtinfunc" id="4386262">append</span><span class="op" id="4386268">(</span><span class="ident" id="4386269">attributes</span><span class="op" id="4386279">,</span>&nbsp;<span class="ident" id="4386281">template</span><span class="op" id="4386289">.</span><span class="ident" id="4386290">Attributes</span><span class="op" id="4386300">...</span><span class="op" id="4386303">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386307">if</span>&nbsp;<span class="builtinfunc" id="4386310">len</span><span class="op" id="4386313">(</span><span class="ident" id="4386314">extensions</span><span class="op" id="4386324">)</span>&nbsp;<span class="op" id="4386326">&gt;</span>&nbsp;<span class="num" id="4386328">0</span>&nbsp;<span class="op" id="4386330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386334">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386395">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386441">specifiedExtensions</span>&nbsp;<span class="op" id="4386461">:=</span>&nbsp;<span class="builtinfunc" id="4386464">make</span><span class="op" id="4386468">(</span><span class="keyword" id="4386469">map</span><span class="op" id="4386472">[</span><span class="builtintype" id="4386473">string</span><span class="op" id="4386479">]</span><span class="builtintype" id="4386480">bool</span><span class="op" id="4386484">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386489">for</span>&nbsp;<span class="ident" id="4386493">_</span><span class="op" id="4386494">,</span>&nbsp;<span class="ident" id="4386496">atvSet</span>&nbsp;<span class="op" id="4386503">:=</span>&nbsp;<span class="keyword" id="4386506">range</span>&nbsp;<span class="ident" id="4386512">template</span><span class="op" id="4386520">.</span><span class="ident" id="4386521">Attributes</span>&nbsp;<span class="op" id="4386532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386537">if</span>&nbsp;<span class="op" id="4386540">!</span><span class="ident" id="4386541">atvSet</span><span class="op" id="4386547">.</span><span class="ident" id="4386548">Type</span><span class="op" id="4386552">.</span><span class="ident" id="4386553">Equal</span><span class="op" id="4386558">(</span><span class="ident" id="4386559">oidExtensionRequest</span><span class="op" id="4386578">)</span>&nbsp;<span class="op" id="4386580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386586">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386604">for</span>&nbsp;<span class="ident" id="4386608">_</span><span class="op" id="4386609">,</span>&nbsp;<span class="ident" id="4386611">atvs</span>&nbsp;<span class="op" id="4386616">:=</span>&nbsp;<span class="keyword" id="4386619">range</span>&nbsp;<span class="ident" id="4386625">atvSet</span><span class="op" id="4386631">.</span><span class="ident" id="4386632">Value</span>&nbsp;<span class="op" id="4386638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386644">for</span>&nbsp;<span class="ident" id="4386648">_</span><span class="op" id="4386649">,</span>&nbsp;<span class="ident" id="4386651">atv</span>&nbsp;<span class="op" id="4386655">:=</span>&nbsp;<span class="keyword" id="4386658">range</span>&nbsp;<span class="ident" id="4386664">atvs</span>&nbsp;<span class="op" id="4386669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386676">specifiedExtensions</span><span class="op" id="4386695">[</span><span class="ident" id="4386696">atv</span><span class="op" id="4386699">.</span><span class="ident" id="4386700">Type</span><span class="op" id="4386704">.</span><span class="ident" id="4386705">String</span><span class="op" id="4386711">(</span><span class="op" id="4386712">)</span><span class="op" id="4386713">]</span>&nbsp;<span class="op" id="4386715">=</span>&nbsp;<span class="builtintype" id="4386717">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386740">atvs</span>&nbsp;<span class="op" id="4386745">:=</span>&nbsp;<span class="builtinfunc" id="4386748">make</span><span class="op" id="4386752">(</span><span class="op" id="4386753">[</span><span class="op" id="4386754">]</span><span class="ident" id="4386755">pkix</span><span class="op" id="4386759">.</span><span class="ident" id="4386760">AttributeTypeAndValue</span><span class="op" id="4386781">,</span>&nbsp;<span class="num" id="4386783">0</span><span class="op" id="4386784">,</span>&nbsp;<span class="builtinfunc" id="4386786">len</span><span class="op" id="4386789">(</span><span class="ident" id="4386790">extensions</span><span class="op" id="4386800">)</span><span class="op" id="4386801">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386805">for</span>&nbsp;<span class="ident" id="4386809">_</span><span class="op" id="4386810">,</span>&nbsp;<span class="ident" id="4386812">e</span>&nbsp;<span class="op" id="4386814">:=</span>&nbsp;<span class="keyword" id="4386817">range</span>&nbsp;<span class="ident" id="4386823">extensions</span>&nbsp;<span class="op" id="4386834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386839">if</span>&nbsp;<span class="ident" id="4386842">specifiedExtensions</span><span class="op" id="4386861">[</span><span class="ident" id="4386862">e</span><span class="op" id="4386863">.</span><span class="ident" id="4386864">Id</span><span class="op" id="4386866">.</span><span class="ident" id="4386867">String</span><span class="op" id="4386873">(</span><span class="op" id="4386874">)</span><span class="op" id="4386875">]</span>&nbsp;<span class="op" id="4386877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386883">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386931">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386976">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386994">atvs</span>&nbsp;<span class="op" id="4386999">=</span>&nbsp;<span class="builtinfunc" id="4387001">append</span><span class="op" id="4387007">(</span><span class="ident" id="4387008">atvs</span><span class="op" id="4387012">,</span>&nbsp;<span class="ident" id="4387014">pkix</span><span class="op" id="4387018">.</span><span class="ident" id="4387019">AttributeTypeAndValue</span><span class="op" id="4387040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387046">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387103">Type</span><span class="op" id="4387107">:</span>&nbsp;&nbsp;<span class="ident" id="4387110">e</span><span class="op" id="4387111">.</span><span class="ident" id="4387112">Id</span><span class="op" id="4387114">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387120">Value</span><span class="op" id="4387125">:</span>&nbsp;<span class="ident" id="4387127">e</span><span class="op" id="4387128">.</span><span class="ident" id="4387129">Value</span><span class="op" id="4387134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387139">}</span><span class="op" id="4387140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387149">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387214">appended</span>&nbsp;<span class="op" id="4387223">:=</span>&nbsp;<span class="builtintype" id="4387226">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387234">for</span>&nbsp;<span class="ident" id="4387238">_</span><span class="op" id="4387239">,</span>&nbsp;<span class="ident" id="4387241">atvSet</span>&nbsp;<span class="op" id="4387248">:=</span>&nbsp;<span class="keyword" id="4387251">range</span>&nbsp;<span class="ident" id="4387257">attributes</span>&nbsp;<span class="op" id="4387268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387273">if</span>&nbsp;<span class="op" id="4387276">!</span><span class="ident" id="4387277">atvSet</span><span class="op" id="4387283">.</span><span class="ident" id="4387284">Type</span><span class="op" id="4387288">.</span><span class="ident" id="4387289">Equal</span><span class="op" id="4387294">(</span><span class="ident" id="4387295">oidExtensionRequest</span><span class="op" id="4387314">)</span>&nbsp;<span class="op" id="4387316">||</span>&nbsp;<span class="builtinfunc" id="4387319">len</span><span class="op" id="4387322">(</span><span class="ident" id="4387323">atvSet</span><span class="op" id="4387329">.</span><span class="ident" id="4387330">Value</span><span class="op" id="4387335">)</span>&nbsp;<span class="op" id="4387337">==</span>&nbsp;<span class="num" id="4387340">0</span>&nbsp;<span class="op" id="4387342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387348">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387360">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387366">atvSet</span><span class="op" id="4387372">.</span><span class="ident" id="4387373">Value</span><span class="op" id="4387378">[</span><span class="num" id="4387379">0</span><span class="op" id="4387380">]</span>&nbsp;<span class="op" id="4387382">=</span>&nbsp;<span class="builtinfunc" id="4387384">append</span><span class="op" id="4387390">(</span><span class="ident" id="4387391">atvSet</span><span class="op" id="4387397">.</span><span class="ident" id="4387398">Value</span><span class="op" id="4387403">[</span><span class="num" id="4387404">0</span><span class="op" id="4387405">]</span><span class="op" id="4387406">,</span>&nbsp;<span class="ident" id="4387408">atvs</span><span class="op" id="4387412">...</span><span class="op" id="4387415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387420">appended</span>&nbsp;<span class="op" id="4387429">=</span>&nbsp;<span class="builtintype" id="4387431">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387439">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387447">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387452">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387508">if</span>&nbsp;<span class="op" id="4387511">!</span><span class="ident" id="4387512">appended</span>&nbsp;<span class="op" id="4387521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387526">attributes</span>&nbsp;<span class="op" id="4387537">=</span>&nbsp;<span class="builtinfunc" id="4387539">append</span><span class="op" id="4387545">(</span><span class="ident" id="4387546">attributes</span><span class="op" id="4387556">,</span>&nbsp;<span class="ident" id="4387558">pkix</span><span class="op" id="4387562">.</span><span class="ident" id="4387563">AttributeTypeAndValueSET</span><span class="op" id="4387587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387593">Type</span><span class="op" id="4387597">:</span>&nbsp;<span class="ident" id="4387599">oidExtensionRequest</span><span class="op" id="4387618">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387624">Value</span><span class="op" id="4387629">:</span>&nbsp;<span class="op" id="4387631">[</span><span class="op" id="4387632">]</span><span class="op" id="4387633">[</span><span class="op" id="4387634">]</span><span class="ident" id="4387635">pkix</span><span class="op" id="4387639">.</span><span class="ident" id="4387640">AttributeTypeAndValue</span><span class="op" id="4387661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387668">atvs</span><span class="op" id="4387672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387678">}</span><span class="op" id="4387679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387684">}</span><span class="op" id="4387685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387689">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387696">asn1Subject</span>&nbsp;<span class="op" id="4387708">:=</span>&nbsp;<span class="ident" id="4387711">template</span><span class="op" id="4387719">.</span><span class="ident" id="4387720">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387732">if</span>&nbsp;<span class="builtinfunc" id="4387735">len</span><span class="op" id="4387738">(</span><span class="ident" id="4387739">asn1Subject</span><span class="op" id="4387750">)</span>&nbsp;<span class="op" id="4387752">==</span>&nbsp;<span class="num" id="4387755">0</span>&nbsp;<span class="op" id="4387757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387761">asn1Subject</span><span class="op" id="4387772">,</span>&nbsp;<span class="ident" id="4387774">err</span>&nbsp;<span class="op" id="4387778">=</span>&nbsp;<span class="ident" id="4387780">asn1</span><span class="op" id="4387784">.</span><span class="ident" id="4387785">Marshal</span><span class="op" id="4387792">(</span><span class="ident" id="4387793">template</span><span class="op" id="4387801">.</span><span class="ident" id="4387802">Subject</span><span class="op" id="4387809">.</span><span class="ident" id="4387810">ToRDNSequence</span><span class="op" id="4387823">(</span><span class="op" id="4387824">)</span><span class="op" id="4387825">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387829">if</span>&nbsp;<span class="ident" id="4387832">err</span>&nbsp;<span class="op" id="4387836">!=</span>&nbsp;<span class="ident" id="4387839">nil</span>&nbsp;<span class="op" id="4387843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387848">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387864">tbsCSR</span>&nbsp;<span class="op" id="4387871">:=</span>&nbsp;<span class="ident" id="4387874">tbsCertificateRequest</span><span class="op" id="4387895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387899">Version</span><span class="op" id="4387906">:</span>&nbsp;<span class="num" id="4387908">0</span><span class="op" id="4387909">,</span>&nbsp;<span class="comment" id="4387911">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387935">Subject</span><span class="op" id="4387942">:</span>&nbsp;<span class="ident" id="4387944">asn1</span><span class="op" id="4387948">.</span><span class="ident" id="4387949">RawValue</span><span class="op" id="4387957">{</span><span class="ident" id="4387958">FullBytes</span><span class="op" id="4387967">:</span>&nbsp;<span class="ident" id="4387969">asn1Subject</span><span class="op" id="4387980">}</span><span class="op" id="4387981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387985">PublicKey</span><span class="op" id="4387994">:</span>&nbsp;<span class="ident" id="4387996">publicKeyInfo</span><span class="op" id="4388009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388014">Algorithm</span><span class="op" id="4388023">:</span>&nbsp;<span class="ident" id="4388025">publicKeyAlgorithm</span><span class="op" id="4388043">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388048">PublicKey</span><span class="op" id="4388057">:</span>&nbsp;<span class="ident" id="4388059">asn1</span><span class="op" id="4388063">.</span><span class="ident" id="4388064">BitString</span><span class="op" id="4388073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388079">Bytes</span><span class="op" id="4388084">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4388090">publicKeyBytes</span><span class="op" id="4388104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388110">BitLength</span><span class="op" id="4388119">:</span>&nbsp;<span class="builtinfunc" id="4388121">len</span><span class="op" id="4388124">(</span><span class="ident" id="4388125">publicKeyBytes</span><span class="op" id="4388139">)</span>&nbsp;<span class="op" id="4388141">*</span>&nbsp;<span class="num" id="4388143">8</span><span class="op" id="4388144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388149">}</span><span class="op" id="4388150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388154">}</span><span class="op" id="4388155">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388159">Attributes</span><span class="op" id="4388169">:</span>&nbsp;<span class="ident" id="4388171">attributes</span><span class="op" id="4388181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388188">tbsCSRContents</span><span class="op" id="4388202">,</span>&nbsp;<span class="ident" id="4388204">err</span>&nbsp;<span class="op" id="4388208">:=</span>&nbsp;<span class="ident" id="4388211">asn1</span><span class="op" id="4388215">.</span><span class="ident" id="4388216">Marshal</span><span class="op" id="4388223">(</span><span class="ident" id="4388224">tbsCSR</span><span class="op" id="4388230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388233">if</span>&nbsp;<span class="ident" id="4388236">err</span>&nbsp;<span class="op" id="4388240">!=</span>&nbsp;<span class="ident" id="4388243">nil</span>&nbsp;<span class="op" id="4388247">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388251">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388262">tbsCSR</span><span class="op" id="4388268">.</span><span class="ident" id="4388269">Raw</span>&nbsp;<span class="op" id="4388273">=</span>&nbsp;<span class="ident" id="4388275">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388292">h</span>&nbsp;<span class="op" id="4388294">:=</span>&nbsp;<span class="ident" id="4388297">hashFunc</span><span class="op" id="4388305">.</span><span class="ident" id="4388306">New</span><span class="op" id="4388309">(</span><span class="op" id="4388310">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388313">h</span><span class="op" id="4388314">.</span><span class="ident" id="4388315">Write</span><span class="op" id="4388320">(</span><span class="ident" id="4388321">tbsCSRContents</span><span class="op" id="4388335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388338">digest</span>&nbsp;<span class="op" id="4388345">:=</span>&nbsp;<span class="ident" id="4388348">h</span><span class="op" id="4388349">.</span><span class="ident" id="4388350">Sum</span><span class="op" id="4388353">(</span><span class="ident" id="4388354">nil</span><span class="op" id="4388357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388361">var</span>&nbsp;<span class="ident" id="4388365">signature</span>&nbsp;<span class="op" id="4388375">[</span><span class="op" id="4388376">]</span><span class="builtintype" id="4388377">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388383">switch</span>&nbsp;<span class="ident" id="4388390">priv</span>&nbsp;<span class="op" id="4388395">:=</span>&nbsp;<span class="ident" id="4388398">priv</span><span class="op" id="4388402">.</span><span class="op" id="4388403">(</span><span class="keyword" id="4388404">type</span><span class="op" id="4388408">)</span>&nbsp;<span class="op" id="4388410">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388413">case</span>&nbsp;<span class="op" id="4388418">*</span><span class="ident" id="4388419">rsa</span><span class="op" id="4388422">.</span><span class="ident" id="4388423">PrivateKey</span><span class="op" id="4388433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388437">signature</span><span class="op" id="4388446">,</span>&nbsp;<span class="ident" id="4388448">err</span>&nbsp;<span class="op" id="4388452">=</span>&nbsp;<span class="ident" id="4388454">rsa</span><span class="op" id="4388457">.</span><span class="ident" id="4388458">SignPKCS1v15</span><span class="op" id="4388470">(</span><span class="ident" id="4388471">rand</span><span class="op" id="4388475">,</span>&nbsp;<span class="ident" id="4388477">priv</span><span class="op" id="4388481">,</span>&nbsp;<span class="ident" id="4388483">hashFunc</span><span class="op" id="4388491">,</span>&nbsp;<span class="ident" id="4388493">digest</span><span class="op" id="4388499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388502">case</span>&nbsp;<span class="op" id="4388507">*</span><span class="ident" id="4388508">ecdsa</span><span class="op" id="4388513">.</span><span class="ident" id="4388514">PrivateKey</span><span class="op" id="4388524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388528">var</span>&nbsp;<span class="ident" id="4388532">r</span><span class="op" id="4388533">,</span>&nbsp;<span class="ident" id="4388535">s</span>&nbsp;<span class="op" id="4388537">*</span><span class="ident" id="4388538">big</span><span class="op" id="4388541">.</span><span class="ident" id="4388542">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388548">if</span>&nbsp;<span class="ident" id="4388551">r</span><span class="op" id="4388552">,</span>&nbsp;<span class="ident" id="4388554">s</span><span class="op" id="4388555">,</span>&nbsp;<span class="ident" id="4388557">err</span>&nbsp;<span class="op" id="4388561">=</span>&nbsp;<span class="ident" id="4388563">ecdsa</span><span class="op" id="4388568">.</span><span class="ident" id="4388569">Sign</span><span class="op" id="4388573">(</span><span class="ident" id="4388574">rand</span><span class="op" id="4388578">,</span>&nbsp;<span class="ident" id="4388580">priv</span><span class="op" id="4388584">,</span>&nbsp;<span class="ident" id="4388586">digest</span><span class="op" id="4388592">)</span><span class="op" id="4388593">;</span>&nbsp;<span class="ident" id="4388595">err</span>&nbsp;<span class="op" id="4388599">==</span>&nbsp;<span class="ident" id="4388602">nil</span>&nbsp;<span class="op" id="4388606">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388611">signature</span><span class="op" id="4388620">,</span>&nbsp;<span class="ident" id="4388622">err</span>&nbsp;<span class="op" id="4388626">=</span>&nbsp;<span class="ident" id="4388628">asn1</span><span class="op" id="4388632">.</span><span class="ident" id="4388633">Marshal</span><span class="op" id="4388640">(</span><span class="ident" id="4388641">ecdsaSignature</span><span class="op" id="4388655">{</span><span class="ident" id="4388656">r</span><span class="op" id="4388657">,</span>&nbsp;<span class="ident" id="4388659">s</span><span class="op" id="4388660">}</span><span class="op" id="4388661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388668">default</span><span class="op" id="4388675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4388679">panic</span><span class="op" id="4388684">(</span><span class="string" id="4388685">&#34;internal&nbsp;error&#34;</span><span class="op" id="4388701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388704">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388708">if</span>&nbsp;<span class="ident" id="4388711">err</span>&nbsp;<span class="op" id="4388715">!=</span>&nbsp;<span class="ident" id="4388718">nil</span>&nbsp;<span class="op" id="4388722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388726">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388738">return</span>&nbsp;<span class="ident" id="4388745">asn1</span><span class="op" id="4388749">.</span><span class="ident" id="4388750">Marshal</span><span class="op" id="4388757">(</span><span class="ident" id="4388758">certificateRequest</span><span class="op" id="4388776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388780">TBSCSR</span><span class="op" id="4388786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4388800">tbsCSR</span><span class="op" id="4388806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388810">SignatureAlgorithm</span><span class="op" id="4388828">:</span>&nbsp;<span class="ident" id="4388830">sigAlgo</span><span class="op" id="4388837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388841">SignatureValue</span><span class="op" id="4388855">:</span>&nbsp;<span class="ident" id="4388857">asn1</span><span class="op" id="4388861">.</span><span class="ident" id="4388862">BitString</span><span class="op" id="4388871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388876">Bytes</span><span class="op" id="4388881">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4388887">signature</span><span class="op" id="4388896">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388901">BitLength</span><span class="op" id="4388910">:</span>&nbsp;<span class="builtinfunc" id="4388912">len</span><span class="op" id="4388915">(</span><span class="ident" id="4388916">signature</span><span class="op" id="4388925">)</span>&nbsp;<span class="op" id="4388927">*</span>&nbsp;<span class="num" id="4388929">8</span><span class="op" id="4388930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388934">}</span><span class="op" id="4388935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388938">}</span><span class="op" id="4388939">)</span><br>
<span class="lineno"></span><span class="op" id="4388941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4388944">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4389016">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4389041">func</span>&nbsp;<span class="ident" id="4389046">ParseCertificateRequest</span><span class="op" id="4389069">(</span><span class="ident" id="4389070">asn1Data</span>&nbsp;<span class="op" id="4389079">[</span><span class="op" id="4389080">]</span><span class="builtintype" id="4389081">byte</span><span class="op" id="4389085">)</span>&nbsp;<span class="op" id="4389087">(</span><span class="op" id="4389088">*</span><span class="ident" id="4389089">CertificateRequest</span><span class="op" id="4389107">,</span>&nbsp;<span class="builtintype" id="4389109">error</span><span class="op" id="4389114">)</span>&nbsp;<span class="op" id="4389116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389119">var</span>&nbsp;<span class="ident" id="4389123">csr</span>&nbsp;<span class="ident" id="4389127">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389148">rest</span><span class="op" id="4389152">,</span>&nbsp;<span class="ident" id="4389154">err</span>&nbsp;<span class="op" id="4389158">:=</span>&nbsp;<span class="ident" id="4389161">asn1</span><span class="op" id="4389165">.</span><span class="ident" id="4389166">Unmarshal</span><span class="op" id="4389175">(</span><span class="ident" id="4389176">asn1Data</span><span class="op" id="4389184">,</span>&nbsp;<span class="op" id="4389186">&amp;</span><span class="ident" id="4389187">csr</span><span class="op" id="4389190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389193">if</span>&nbsp;<span class="ident" id="4389196">err</span>&nbsp;<span class="op" id="4389200">!=</span>&nbsp;<span class="ident" id="4389203">nil</span>&nbsp;<span class="op" id="4389207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389211">return</span>&nbsp;<span class="ident" id="4389218">nil</span><span class="op" id="4389221">,</span>&nbsp;<span class="ident" id="4389223">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389228">}</span>&nbsp;<span class="keyword" id="4389230">else</span>&nbsp;<span class="keyword" id="4389235">if</span>&nbsp;<span class="builtinfunc" id="4389238">len</span><span class="op" id="4389241">(</span><span class="ident" id="4389242">rest</span><span class="op" id="4389246">)</span>&nbsp;<span class="op" id="4389248">!=</span>&nbsp;<span class="num" id="4389251">0</span>&nbsp;<span class="op" id="4389253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389257">return</span>&nbsp;<span class="ident" id="4389264">nil</span><span class="op" id="4389267">,</span>&nbsp;<span class="ident" id="4389269">asn1</span><span class="op" id="4389273">.</span><span class="ident" id="4389274">SyntaxError</span><span class="op" id="4389285">{</span><span class="ident" id="4389286">Msg</span><span class="op" id="4389289">:</span>&nbsp;<span class="string" id="4389291">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4389306">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389313">return</span>&nbsp;<span class="ident" id="4389320">parseCertificateRequest</span><span class="op" id="4389343">(</span><span class="op" id="4389344">&amp;</span><span class="ident" id="4389345">csr</span><span class="op" id="4389348">)</span><br>
<span class="lineno"></span><span class="op" id="4389350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4389353">func</span>&nbsp;<span class="ident" id="4389358">parseCertificateRequest</span><span class="op" id="4389381">(</span><span class="ident" id="4389382">in</span>&nbsp;<span class="op" id="4389385">*</span><span class="ident" id="4389386">certificateRequest</span><span class="op" id="4389404">)</span>&nbsp;<span class="op" id="4389406">(</span><span class="op" id="4389407">*</span><span class="ident" id="4389408">CertificateRequest</span><span class="op" id="4389426">,</span>&nbsp;<span class="builtintype" id="4389428">error</span><span class="op" id="4389433">)</span>&nbsp;<span class="op" id="4389435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389438">out</span>&nbsp;<span class="op" id="4389442">:=</span>&nbsp;<span class="op" id="4389445">&amp;</span><span class="ident" id="4389446">CertificateRequest</span><span class="op" id="4389464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389468">Raw</span><span class="op" id="4389471">:</span>&nbsp;<span class="ident" id="4389473">in</span><span class="op" id="4389475">.</span><span class="ident" id="4389476">Raw</span><span class="op" id="4389479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389483">RawTBSCertificateRequest</span><span class="op" id="4389507">:</span>&nbsp;<span class="ident" id="4389509">in</span><span class="op" id="4389511">.</span><span class="ident" id="4389512">TBSCSR</span><span class="op" id="4389518">.</span><span class="ident" id="4389519">Raw</span><span class="op" id="4389522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389526">RawSubjectPublicKeyInfo</span><span class="op" id="4389549">:</span>&nbsp;&nbsp;<span class="ident" id="4389552">in</span><span class="op" id="4389554">.</span><span class="ident" id="4389555">TBSCSR</span><span class="op" id="4389561">.</span><span class="ident" id="4389562">PublicKey</span><span class="op" id="4389571">.</span><span class="ident" id="4389572">Raw</span><span class="op" id="4389575">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389579">RawSubject</span><span class="op" id="4389589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389605">in</span><span class="op" id="4389607">.</span><span class="ident" id="4389608">TBSCSR</span><span class="op" id="4389614">.</span><span class="ident" id="4389615">Subject</span><span class="op" id="4389622">.</span><span class="ident" id="4389623">FullBytes</span><span class="op" id="4389632">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389637">Signature</span><span class="op" id="4389646">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389657">in</span><span class="op" id="4389659">.</span><span class="ident" id="4389660">SignatureValue</span><span class="op" id="4389674">.</span><span class="ident" id="4389675">RightAlign</span><span class="op" id="4389685">(</span><span class="op" id="4389686">)</span><span class="op" id="4389687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389691">SignatureAlgorithm</span><span class="op" id="4389709">:</span>&nbsp;<span class="ident" id="4389711">getSignatureAlgorithmFromOID</span><span class="op" id="4389739">(</span><span class="ident" id="4389740">in</span><span class="op" id="4389742">.</span><span class="ident" id="4389743">SignatureAlgorithm</span><span class="op" id="4389761">.</span><span class="ident" id="4389762">Algorithm</span><span class="op" id="4389771">)</span><span class="op" id="4389772">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389777">PublicKeyAlgorithm</span><span class="op" id="4389795">:</span>&nbsp;<span class="ident" id="4389797">getPublicKeyAlgorithmFromOID</span><span class="op" id="4389825">(</span><span class="ident" id="4389826">in</span><span class="op" id="4389828">.</span><span class="ident" id="4389829">TBSCSR</span><span class="op" id="4389835">.</span><span class="ident" id="4389836">PublicKey</span><span class="op" id="4389845">.</span><span class="ident" id="4389846">Algorithm</span><span class="op" id="4389855">.</span><span class="ident" id="4389856">Algorithm</span><span class="op" id="4389865">)</span><span class="op" id="4389866">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389871">Version</span><span class="op" id="4389878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389883">in</span><span class="op" id="4389885">.</span><span class="ident" id="4389886">TBSCSR</span><span class="op" id="4389892">.</span><span class="ident" id="4389893">Version</span><span class="op" id="4389900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389904">Attributes</span><span class="op" id="4389914">:</span>&nbsp;<span class="ident" id="4389916">in</span><span class="op" id="4389918">.</span><span class="ident" id="4389919">TBSCSR</span><span class="op" id="4389925">.</span><span class="ident" id="4389926">Attributes</span><span class="op" id="4389936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389939">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389943">var</span>&nbsp;<span class="ident" id="4389947">err</span>&nbsp;<span class="builtintype" id="4389951">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389958">out</span><span class="op" id="4389961">.</span><span class="ident" id="4389962">PublicKey</span><span class="op" id="4389971">,</span>&nbsp;<span class="ident" id="4389973">err</span>&nbsp;<span class="op" id="4389977">=</span>&nbsp;<span class="ident" id="4389979">parsePublicKey</span><span class="op" id="4389993">(</span><span class="ident" id="4389994">out</span><span class="op" id="4389997">.</span><span class="ident" id="4389998">PublicKeyAlgorithm</span><span class="op" id="4390016">,</span>&nbsp;<span class="op" id="4390018">&amp;</span><span class="ident" id="4390019">in</span><span class="op" id="4390021">.</span><span class="ident" id="4390022">TBSCSR</span><span class="op" id="4390028">.</span><span class="ident" id="4390029">PublicKey</span><span class="op" id="4390038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390041">if</span>&nbsp;<span class="ident" id="4390044">err</span>&nbsp;<span class="op" id="4390048">!=</span>&nbsp;<span class="ident" id="4390051">nil</span>&nbsp;<span class="op" id="4390055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390059">return</span>&nbsp;<span class="ident" id="4390066">nil</span><span class="op" id="4390069">,</span>&nbsp;<span class="ident" id="4390071">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390080">var</span>&nbsp;<span class="ident" id="4390084">subject</span>&nbsp;<span class="ident" id="4390092">pkix</span><span class="op" id="4390096">.</span><span class="ident" id="4390097">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390110">if</span>&nbsp;<span class="ident" id="4390113">_</span><span class="op" id="4390114">,</span>&nbsp;<span class="ident" id="4390116">err</span>&nbsp;<span class="op" id="4390120">:=</span>&nbsp;<span class="ident" id="4390123">asn1</span><span class="op" id="4390127">.</span><span class="ident" id="4390128">Unmarshal</span><span class="op" id="4390137">(</span><span class="ident" id="4390138">in</span><span class="op" id="4390140">.</span><span class="ident" id="4390141">TBSCSR</span><span class="op" id="4390147">.</span><span class="ident" id="4390148">Subject</span><span class="op" id="4390155">.</span><span class="ident" id="4390156">FullBytes</span><span class="op" id="4390165">,</span>&nbsp;<span class="op" id="4390167">&amp;</span><span class="ident" id="4390168">subject</span><span class="op" id="4390175">)</span><span class="op" id="4390176">;</span>&nbsp;<span class="ident" id="4390178">err</span>&nbsp;<span class="op" id="4390182">!=</span>&nbsp;<span class="ident" id="4390185">nil</span>&nbsp;<span class="op" id="4390189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390193">return</span>&nbsp;<span class="ident" id="4390200">nil</span><span class="op" id="4390203">,</span>&nbsp;<span class="ident" id="4390205">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390214">out</span><span class="op" id="4390217">.</span><span class="ident" id="4390218">Subject</span><span class="op" id="4390225">.</span><span class="ident" id="4390226">FillFromRDNSequence</span><span class="op" id="4390245">(</span><span class="op" id="4390246">&amp;</span><span class="ident" id="4390247">subject</span><span class="op" id="4390254">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390258">var</span>&nbsp;<span class="ident" id="4390262">extensions</span>&nbsp;<span class="op" id="4390273">[</span><span class="op" id="4390274">]</span><span class="ident" id="4390275">pkix</span><span class="op" id="4390279">.</span><span class="ident" id="4390280">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390304">for</span>&nbsp;<span class="ident" id="4390308">_</span><span class="op" id="4390309">,</span>&nbsp;<span class="ident" id="4390311">atvSet</span>&nbsp;<span class="op" id="4390318">:=</span>&nbsp;<span class="keyword" id="4390321">range</span>&nbsp;<span class="ident" id="4390327">in</span><span class="op" id="4390329">.</span><span class="ident" id="4390330">TBSCSR</span><span class="op" id="4390336">.</span><span class="ident" id="4390337">Attributes</span>&nbsp;<span class="op" id="4390348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390352">if</span>&nbsp;<span class="op" id="4390355">!</span><span class="ident" id="4390356">atvSet</span><span class="op" id="4390362">.</span><span class="ident" id="4390363">Type</span><span class="op" id="4390367">.</span><span class="ident" id="4390368">Equal</span><span class="op" id="4390373">(</span><span class="ident" id="4390374">oidExtensionRequest</span><span class="op" id="4390393">)</span>&nbsp;<span class="op" id="4390395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390400">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390411">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390416">for</span>&nbsp;<span class="ident" id="4390420">_</span><span class="op" id="4390421">,</span>&nbsp;<span class="ident" id="4390423">atvs</span>&nbsp;<span class="op" id="4390428">:=</span>&nbsp;<span class="keyword" id="4390431">range</span>&nbsp;<span class="ident" id="4390437">atvSet</span><span class="op" id="4390443">.</span><span class="ident" id="4390444">Value</span>&nbsp;<span class="op" id="4390450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390455">extensions</span>&nbsp;<span class="op" id="4390466">=</span>&nbsp;<span class="builtinfunc" id="4390468">append</span><span class="op" id="4390474">(</span><span class="ident" id="4390475">extensions</span><span class="op" id="4390485">,</span>&nbsp;<span class="ident" id="4390487">atvs</span><span class="op" id="4390491">...</span><span class="op" id="4390494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390501">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390505">out</span><span class="op" id="4390508">.</span><span class="ident" id="4390509">Extensions</span>&nbsp;<span class="op" id="4390520">=</span>&nbsp;<span class="builtinfunc" id="4390522">make</span><span class="op" id="4390526">(</span><span class="op" id="4390527">[</span><span class="op" id="4390528">]</span><span class="ident" id="4390529">pkix</span><span class="op" id="4390533">.</span><span class="ident" id="4390534">Extension</span><span class="op" id="4390543">,</span>&nbsp;<span class="num" id="4390545">0</span><span class="op" id="4390546">,</span>&nbsp;<span class="builtinfunc" id="4390548">len</span><span class="op" id="4390551">(</span><span class="ident" id="4390552">extensions</span><span class="op" id="4390562">)</span><span class="op" id="4390563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390567">for</span>&nbsp;<span class="ident" id="4390571">_</span><span class="op" id="4390572">,</span>&nbsp;<span class="ident" id="4390574">e</span>&nbsp;<span class="op" id="4390576">:=</span>&nbsp;<span class="keyword" id="4390579">range</span>&nbsp;<span class="ident" id="4390585">extensions</span>&nbsp;<span class="op" id="4390596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390600">value</span><span class="op" id="4390605">,</span>&nbsp;<span class="ident" id="4390607">ok</span>&nbsp;<span class="op" id="4390610">:=</span>&nbsp;<span class="ident" id="4390613">e</span><span class="op" id="4390614">.</span><span class="ident" id="4390615">Value</span><span class="op" id="4390620">.</span><span class="op" id="4390621">(</span><span class="op" id="4390622">[</span><span class="op" id="4390623">]</span><span class="builtintype" id="4390624">byte</span><span class="op" id="4390628">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390632">if</span>&nbsp;<span class="op" id="4390635">!</span><span class="ident" id="4390636">ok</span>&nbsp;<span class="op" id="4390639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390644">return</span>&nbsp;<span class="ident" id="4390651">nil</span><span class="op" id="4390654">,</span>&nbsp;<span class="ident" id="4390656">errors</span><span class="op" id="4390662">.</span><span class="ident" id="4390663">New</span><span class="op" id="4390666">(</span><span class="string" id="4390667">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4390726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390735">out</span><span class="op" id="4390738">.</span><span class="ident" id="4390739">Extensions</span>&nbsp;<span class="op" id="4390750">=</span>&nbsp;<span class="builtinfunc" id="4390752">append</span><span class="op" id="4390758">(</span><span class="ident" id="4390759">out</span><span class="op" id="4390762">.</span><span class="ident" id="4390763">Extensions</span><span class="op" id="4390773">,</span>&nbsp;<span class="ident" id="4390775">pkix</span><span class="op" id="4390779">.</span><span class="ident" id="4390780">Extension</span><span class="op" id="4390789">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390794">Id</span><span class="op" id="4390796">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390801">e</span><span class="op" id="4390802">.</span><span class="ident" id="4390803">Type</span><span class="op" id="4390807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390812">Value</span><span class="op" id="4390817">:</span>&nbsp;<span class="ident" id="4390819">value</span><span class="op" id="4390824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390828">}</span><span class="op" id="4390829">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390834">if</span>&nbsp;<span class="builtinfunc" id="4390837">len</span><span class="op" id="4390840">(</span><span class="ident" id="4390841">e</span><span class="op" id="4390842">.</span><span class="ident" id="4390843">Type</span><span class="op" id="4390847">)</span>&nbsp;<span class="op" id="4390849">==</span>&nbsp;<span class="num" id="4390852">4</span>&nbsp;<span class="op" id="4390854">&amp;&amp;</span>&nbsp;<span class="ident" id="4390857">e</span><span class="op" id="4390858">.</span><span class="ident" id="4390859">Type</span><span class="op" id="4390863">[</span><span class="num" id="4390864">0</span><span class="op" id="4390865">]</span>&nbsp;<span class="op" id="4390867">==</span>&nbsp;<span class="num" id="4390870">2</span>&nbsp;<span class="op" id="4390872">&amp;&amp;</span>&nbsp;<span class="ident" id="4390875">e</span><span class="op" id="4390876">.</span><span class="ident" id="4390877">Type</span><span class="op" id="4390881">[</span><span class="num" id="4390882">1</span><span class="op" id="4390883">]</span>&nbsp;<span class="op" id="4390885">==</span>&nbsp;<span class="num" id="4390888">5</span>&nbsp;<span class="op" id="4390890">&amp;&amp;</span>&nbsp;<span class="ident" id="4390893">e</span><span class="op" id="4390894">.</span><span class="ident" id="4390895">Type</span><span class="op" id="4390899">[</span><span class="num" id="4390900">2</span><span class="op" id="4390901">]</span>&nbsp;<span class="op" id="4390903">==</span>&nbsp;<span class="num" id="4390906">29</span>&nbsp;<span class="op" id="4390909">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390914">switch</span>&nbsp;<span class="ident" id="4390921">e</span><span class="op" id="4390922">.</span><span class="ident" id="4390923">Type</span><span class="op" id="4390927">[</span><span class="num" id="4390928">3</span><span class="op" id="4390929">]</span>&nbsp;<span class="op" id="4390931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390936">case</span>&nbsp;<span class="num" id="4390941">17</span><span class="op" id="4390943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390949">out</span><span class="op" id="4390952">.</span><span class="ident" id="4390953">DNSNames</span><span class="op" id="4390961">,</span>&nbsp;<span class="ident" id="4390963">out</span><span class="op" id="4390966">.</span><span class="ident" id="4390967">EmailAddresses</span><span class="op" id="4390981">,</span>&nbsp;<span class="ident" id="4390983">out</span><span class="op" id="4390986">.</span><span class="ident" id="4390987">IPAddresses</span><span class="op" id="4390998">,</span>&nbsp;<span class="ident" id="4391000">err</span>&nbsp;<span class="op" id="4391004">=</span>&nbsp;<span class="ident" id="4391006">parseSANExtension</span><span class="op" id="4391023">(</span><span class="ident" id="4391024">value</span><span class="op" id="4391029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391035">if</span>&nbsp;<span class="ident" id="4391038">err</span>&nbsp;<span class="op" id="4391042">!=</span>&nbsp;<span class="ident" id="4391045">nil</span>&nbsp;<span class="op" id="4391049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391056">return</span>&nbsp;<span class="ident" id="4391063">nil</span><span class="op" id="4391066">,</span>&nbsp;<span class="ident" id="4391068">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4391088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4391092">return</span>&nbsp;<span class="ident" id="4391099">out</span><span class="op" id="4391102">,</span>&nbsp;<span class="ident" id="4391104">nil</span><br>
<span class="lineno"></span><span class="op" id="4391108">}</span>
</div>
</body>
</html>
