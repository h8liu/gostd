<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6720474">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6720529">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6720583">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6720634">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;a&nbsp;parser&nbsp;test&nbsp;harness.&nbsp;The&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata</span><br>
<span class="lineno"></span><span class="comment" id="6720707">//&nbsp;directory&nbsp;are&nbsp;parsed&nbsp;and&nbsp;the&nbsp;errors&nbsp;reported&nbsp;are&nbsp;compared&nbsp;against&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6720780">//&nbsp;error&nbsp;messages&nbsp;expected&nbsp;in&nbsp;the&nbsp;test&nbsp;files.&nbsp;The&nbsp;test&nbsp;files&nbsp;must&nbsp;end&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6720853">//&nbsp;.src&nbsp;rather&nbsp;than&nbsp;.go&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;disturbed&nbsp;by&nbsp;gofmt&nbsp;runs.</span><br>
<span class="lineno"></span><span class="comment" id="6720923">//</span><br>
<span class="lineno">10</span><span class="comment" id="6720926">//&nbsp;Expected&nbsp;errors&nbsp;are&nbsp;indicated&nbsp;in&nbsp;the&nbsp;test&nbsp;files&nbsp;by&nbsp;putting&nbsp;a&nbsp;comment</span><br>
<span class="lineno"></span><span class="comment" id="6720998">//&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;immediately&nbsp;following&nbsp;an&nbsp;offending&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6721072">//&nbsp;The&nbsp;harness&nbsp;will&nbsp;verify&nbsp;that&nbsp;an&nbsp;error&nbsp;matching&nbsp;the&nbsp;regular&nbsp;expression</span><br>
<span class="lineno"></span><span class="comment" id="6721145">//&nbsp;rx&nbsp;is&nbsp;reported&nbsp;at&nbsp;that&nbsp;source&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="6721188">//</span><br>
<span class="lineno">15</span><span class="comment" id="6721191">//&nbsp;For&nbsp;instance,&nbsp;the&nbsp;following&nbsp;test&nbsp;file&nbsp;indicates&nbsp;that&nbsp;a&nbsp;&#34;not&nbsp;declared&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6721264">//&nbsp;error&nbsp;should&nbsp;be&nbsp;reported&nbsp;for&nbsp;the&nbsp;undeclared&nbsp;variable&nbsp;x:</span><br>
<span class="lineno"></span><span class="comment" id="6721323">//</span><br>
<span class="lineno"></span><span class="comment" id="6721326">//&nbsp;&nbsp;&nbsp;&nbsppackage&nbsp;p</span><br>
<span class="lineno"></span><span class="comment" id="6721339">//&nbsp;&nbsp;&nbsp;&nbspfunc&nbsp;f()&nbsp;{</span><br>
<span class="lineno">20</span><span class="comment" id="6721353">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp_&nbsp;=&nbsp;x&nbsp;/*&nbsp;ERROR&nbsp;&#34;not&nbsp;declared&#34;&nbsp;*/&nbsp;+&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="6721394">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6721400">package</span>&nbsp;<span class="ident" id="6721408">parser</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6721416">import</span>&nbsp;<span class="op" id="6721423">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721426">&#34;go/scanner&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721440">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721452">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721465">&#34;path/filepath&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721482">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721492">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721503">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6721513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6721516">const</span>&nbsp;<span class="ident" id="6721522">testdata</span>&nbsp;<span class="op" id="6721531">=</span>&nbsp;<span class="string" id="6721533">&#34;testdata&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6721545">var</span>&nbsp;<span class="ident" id="6721549">fsetErrs</span>&nbsp;<span class="op" id="6721558">=</span>&nbsp;<span class="ident" id="6721560"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6721565">.</span><span class="ident" id="6721566">NewFileSet</span><span class="op" id="6721576">(</span><span class="op" id="6721577">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6721580">//&nbsp;getFile&nbsp;assumes&nbsp;that&nbsp;each&nbsp;filename&nbsp;occurs&nbsp;at&nbsp;most&nbsp;once</span><br>
<span class="lineno">40</span><span class="keyword" id="6721638">func</span>&nbsp;<span class="ident" id="6721643">getFile</span><span class="op" id="6721650">(</span><span class="ident" id="6721651">filename</span>&nbsp;<span class="builtintype" id="6721660">string</span><span class="op" id="6721666">)</span>&nbsp;<span class="op" id="6721668">(</span><span class="ident" id="6721669">file</span>&nbsp;<span class="op" id="6721674">*</span><span class="ident" id="6721675"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6721680">.</span><span class="ident" id="6721681">File</span><span class="op" id="6721685">)</span>&nbsp;<span class="op" id="6721687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721690"><a href="/go/parser/error_test.go.html#6721549">fsetErrs</a></span><span class="op" id="6721698">.</span><span class="ident" id="6721699">Iterate</span><span class="op" id="6721706">(</span><span class="keyword" id="6721707">func</span><span class="op" id="6721711">(</span><span class="ident" id="6721712">f</span>&nbsp;<span class="op" id="6721714">*</span><span class="ident" id="6721715"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6721720">.</span><span class="ident" id="6721721">File</span><span class="op" id="6721725">)</span>&nbsp;<span class="builtintype" id="6721727">bool</span>&nbsp;<span class="op" id="6721732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721736">if</span>&nbsp;<span class="ident" id="6721739"><a href="/go/parser/error_test.go.html#6721712">f</a></span><span class="op" id="6721740">.</span><span class="ident" id="6721741">Name</span><span class="op" id="6721745">(</span><span class="op" id="6721746">)</span>&nbsp;<span class="op" id="6721748">==</span>&nbsp;<span class="ident" id="6721751"><a href="/go/parser/error_test.go.html#6721651">filename</a></span>&nbsp;<span class="op" id="6721760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721765">if</span>&nbsp;<span class="ident" id="6721768"><a href="/go/parser/error_test.go.html#6721669">file</a></span>&nbsp;<span class="op" id="6721773">!=</span>&nbsp;<span class="ident" id="6721776">nil</span>&nbsp;<span class="op" id="6721780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6721786">panic</span><span class="op" id="6721791">(</span><span class="ident" id="6721792"><a href="/go/parser/error_test.go.html#6721651">filename</a></span>&nbsp;<span class="op" id="6721801">+</span>&nbsp;<span class="string" id="6721803">&#34;&nbsp;used&nbsp;multiple&nbsp;times&#34;</span><span class="op" id="6721825">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721835"><a href="/go/parser/error_test.go.html#6721669">file</a></span>&nbsp;<span class="op" id="6721840">=</span>&nbsp;<span class="ident" id="6721842"><a href="/go/parser/error_test.go.html#6721712">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721850">return</span>&nbsp;<span class="ident" id="6721857">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721863">}</span><span class="op" id="6721864">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721867">return</span>&nbsp;<span class="ident" id="6721874"><a href="/go/parser/error_test.go.html#6721669">file</a></span><br>
<span class="lineno"></span><span class="op" id="6721879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6721882">func</span>&nbsp;<span class="ident" id="6721887">getPos</span><span class="op" id="6721893">(</span><span class="ident" id="6721894">filename</span>&nbsp;<span class="builtintype" id="6721903">string</span><span class="op" id="6721909">,</span>&nbsp;<span class="ident" id="6721911">offset</span>&nbsp;<span class="builtintype" id="6721918">int</span><span class="op" id="6721921">)</span>&nbsp;<span class="ident" id="6721923"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6721928">.</span><span class="ident" id="6721929">Pos</span>&nbsp;<span class="op" id="6721933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721936">if</span>&nbsp;<span class="ident" id="6721939">f</span>&nbsp;<span class="op" id="6721941">:=</span>&nbsp;<span class="ident" id="6721944"><a href="/go/parser/error_test.go.html#6721643">getFile</a></span><span class="op" id="6721951">(</span><span class="ident" id="6721952"><a href="/go/parser/error_test.go.html#6721894">filename</a></span><span class="op" id="6721960">)</span><span class="op" id="6721961">;</span>&nbsp;<span class="ident" id="6721963"><a href="/go/parser/error_test.go.html#6721939">f</a></span>&nbsp;<span class="op" id="6721965">!=</span>&nbsp;<span class="ident" id="6721968">nil</span>&nbsp;<span class="op" id="6721972">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721976">return</span>&nbsp;<span class="ident" id="6721983"><a href="/go/parser/error_test.go.html#6721939">f</a></span><span class="op" id="6721984">.</span><span class="ident" id="6721985">Pos</span><span class="op" id="6721988">(</span><span class="ident" id="6721989"><a href="/go/parser/error_test.go.html#6721911">offset</a></span><span class="op" id="6721995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6722001">return</span>&nbsp;<span class="ident" id="6722008"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6722013">.</span><span class="ident" id="6722014">NoPos</span><br>
<span class="lineno"></span><span class="op" id="6722020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6722023">//&nbsp;ERROR&nbsp;comments&nbsp;must&nbsp;be&nbsp;of&nbsp;the&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;and&nbsp;rx&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6722088">//&nbsp;a&nbsp;regular&nbsp;expression&nbsp;that&nbsp;matches&nbsp;the&nbsp;expected&nbsp;error&nbsp;message.</span><br>
<span class="lineno"></span><span class="comment" id="6722153">//&nbsp;The&nbsp;special&nbsp;form&nbsp;/*&nbsp;ERROR&nbsp;HERE&nbsp;&#34;rx&#34;&nbsp;*/&nbsp;must&nbsp;be&nbsp;used&nbsp;for&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6722218">//&nbsp;messages&nbsp;that&nbsp;appear&nbsp;immediately&nbsp;after&nbsp;a&nbsp;token,&nbsp;rather&nbsp;than&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="6722284">//&nbsp;a&nbsp;token&#39;s&nbsp;position.</span><br>
<span class="lineno">65</span><span class="comment" id="6722307">//</span><br>
<span class="lineno"></span><span class="keyword" id="6722310">var</span>&nbsp;<span class="ident" id="6722314">errRx</span>&nbsp;<span class="op" id="6722320">=</span>&nbsp;<span class="ident" id="6722322"><a href="/go/parser/error_test.go.html#6721482">regexp</a></span><span class="op" id="6722328">.</span><span class="ident" id="6722329">MustCompile</span><span class="op" id="6722340">(</span><span class="string" id="6722341">`^/\*&nbsp;*ERROR&nbsp;*(HERE)?&nbsp;*&#34;([^&#34;]*)&#34;&nbsp;*\*/$`</span><span class="op" id="6722380">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6722383">//&nbsp;expectedErrors&nbsp;collects&nbsp;the&nbsp;regular&nbsp;expressions&nbsp;of&nbsp;ERROR&nbsp;comments&nbsp;found</span><br>
<span class="lineno"></span><span class="comment" id="6722458">//&nbsp;in&nbsp;files&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a&nbsp;map&nbsp;of&nbsp;error&nbsp;positions&nbsp;to&nbsp;error&nbsp;messages.</span><br>
<span class="lineno">70</span><span class="comment" id="6722534">//</span><br>
<span class="lineno"></span><span class="keyword" id="6722537">func</span>&nbsp;<span class="ident" id="6722542">expectedErrors</span><span class="op" id="6722556">(</span><span class="ident" id="6722557">t</span>&nbsp;<span class="op" id="6722559">*</span><span class="ident" id="6722560"><a href="/go/parser/error_test.go.html#6721503">testing</a></span><span class="op" id="6722567">.</span><span class="ident" id="6722568">T</span><span class="op" id="6722569">,</span>&nbsp;<span class="ident" id="6722571">filename</span>&nbsp;<span class="builtintype" id="6722580">string</span><span class="op" id="6722586">,</span>&nbsp;<span class="ident" id="6722588">src</span>&nbsp;<span class="op" id="6722592">[</span><span class="op" id="6722593">]</span><span class="builtintype" id="6722594">byte</span><span class="op" id="6722598">)</span>&nbsp;<span class="keyword" id="6722600">map</span><span class="op" id="6722603">[</span><span class="ident" id="6722604"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6722609">.</span><span class="ident" id="6722610">Pos</span><span class="op" id="6722613">]</span><span class="builtintype" id="6722614">string</span>&nbsp;<span class="op" id="6722621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6722624">errors</span>&nbsp;<span class="op" id="6722631">:=</span>&nbsp;<span class="builtinfunc" id="6722634">make</span><span class="op" id="6722638">(</span><span class="keyword" id="6722639">map</span><span class="op" id="6722642">[</span><span class="ident" id="6722643"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6722648">.</span><span class="ident" id="6722649">Pos</span><span class="op" id="6722652">]</span><span class="builtintype" id="6722653">string</span><span class="op" id="6722659">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6722663">var</span>&nbsp;<span class="ident" id="6722667">s</span>&nbsp;<span class="ident" id="6722669"><a href="/go/parser/error_test.go.html#6721426">scanner</a></span><span class="op" id="6722676">.</span><span class="ident" id="6722677">Scanner</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6722686">//&nbsp;file&nbsp;was&nbsp;parsed&nbsp;already&nbsp;-&nbsp;do&nbsp;not&nbsp;add&nbsp;it&nbsp;again&nbsp;to&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6722748">//&nbsp;set&nbsp;otherwise&nbsp;the&nbsp;position&nbsp;information&nbsp;returned&nbsp;here&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6722810">//&nbsp;not&nbsp;match&nbsp;the&nbsp;position&nbsp;information&nbsp;collected&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6722873"><a href="/go/parser/error_test.go.html#6722667">s</a></span><span class="op" id="6722874">.</span><span class="ident" id="6722875">Init</span><span class="op" id="6722879">(</span><span class="ident" id="6722880"><a href="/go/parser/error_test.go.html#6721643">getFile</a></span><span class="op" id="6722887">(</span><span class="ident" id="6722888"><a href="/go/parser/error_test.go.html#6722571">filename</a></span><span class="op" id="6722896">)</span><span class="op" id="6722897">,</span>&nbsp;<span class="ident" id="6722899"><a href="/go/parser/error_test.go.html#6722588">src</a></span><span class="op" id="6722902">,</span>&nbsp;<span class="ident" id="6722904">nil</span><span class="op" id="6722907">,</span>&nbsp;<span class="ident" id="6722909"><a href="/go/parser/error_test.go.html#6721426">scanner</a></span><span class="op" id="6722916">.</span><span class="ident" id="6722917">ScanComments</span><span class="op" id="6722929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6722932">var</span>&nbsp;<span class="ident" id="6722936">prev</span>&nbsp;<span class="ident" id="6722941"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6722946">.</span><span class="ident" id="6722947">Pos</span>&nbsp;<span class="comment" id="6722951">//&nbsp;position&nbsp;of&nbsp;last&nbsp;non-comment,&nbsp;non-semicolon&nbsp;token</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723005">var</span>&nbsp;<span class="ident" id="6723009">here</span>&nbsp;<span class="ident" id="6723014"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6723019">.</span><span class="ident" id="6723020">Pos</span>&nbsp;<span class="comment" id="6723024">//&nbsp;position&nbsp;immediately&nbsp;after&nbsp;the&nbsp;token&nbsp;at&nbsp;position&nbsp;prev</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723083">for</span>&nbsp;<span class="op" id="6723087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723091">pos</span><span class="op" id="6723094">,</span>&nbsp;<span class="ident" id="6723096">tok</span><span class="op" id="6723099">,</span>&nbsp;<span class="ident" id="6723101">lit</span>&nbsp;<span class="op" id="6723105">:=</span>&nbsp;<span class="ident" id="6723108"><a href="/go/parser/error_test.go.html#6722667">s</a></span><span class="op" id="6723109">.</span><span class="ident" id="6723110">Scan</span><span class="op" id="6723114">(</span><span class="op" id="6723115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723119">switch</span>&nbsp;<span class="ident" id="6723126"><a href="/go/parser/error_test.go.html#6723096">tok</a></span>&nbsp;<span class="op" id="6723130">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723134">case</span>&nbsp;<span class="ident" id="6723139"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6723144">.</span><span class="ident" id="6723145">EOF</span><span class="op" id="6723148">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723153">return</span>&nbsp;<span class="ident" id="6723160"><a href="/go/parser/error_test.go.html#6722624">errors</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723169">case</span>&nbsp;<span class="ident" id="6723174"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6723179">.</span><span class="ident" id="6723180">COMMENT</span><span class="op" id="6723187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723192">s</span>&nbsp;<span class="op" id="6723194">:=</span>&nbsp;<span class="ident" id="6723197"><a href="/go/parser/error_test.go.html#6722314">errRx</a></span><span class="op" id="6723202">.</span><span class="ident" id="6723203">FindStringSubmatch</span><span class="op" id="6723221">(</span><span class="ident" id="6723222"><a href="/go/parser/error_test.go.html#6723101">lit</a></span><span class="op" id="6723225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723230">if</span>&nbsp;<span class="builtinfunc" id="6723233">len</span><span class="op" id="6723236">(</span><span class="ident" id="6723237"><a href="/go/parser/error_test.go.html#6723192">s</a></span><span class="op" id="6723238">)</span>&nbsp;<span class="op" id="6723240">==</span>&nbsp;<span class="num" id="6723243">3</span>&nbsp;<span class="op" id="6723245">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723251">pos</span>&nbsp;<span class="op" id="6723255">:=</span>&nbsp;<span class="ident" id="6723258"><a href="/go/parser/error_test.go.html#6722936">prev</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723267">if</span>&nbsp;<span class="ident" id="6723270"><a href="/go/parser/error_test.go.html#6723192">s</a></span><span class="op" id="6723271">[</span><span class="num" id="6723272">1</span><span class="op" id="6723273">]</span>&nbsp;<span class="op" id="6723275">==</span>&nbsp;<span class="string" id="6723278">&#34;HERE&#34;</span>&nbsp;<span class="op" id="6723285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723292"><a href="/go/parser/error_test.go.html#6723251">pos</a></span>&nbsp;<span class="op" id="6723296">=</span>&nbsp;<span class="ident" id="6723298"><a href="/go/parser/error_test.go.html#6723009">here</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723313"><a href="/go/parser/error_test.go.html#6722624">errors</a></span><span class="op" id="6723319">[</span><span class="ident" id="6723320"><a href="/go/parser/error_test.go.html#6723251">pos</a></span><span class="op" id="6723323">]</span>&nbsp;<span class="op" id="6723325">=</span>&nbsp;<span class="builtintype" id="6723327">string</span><span class="op" id="6723333">(</span><span class="ident" id="6723334"><a href="/go/parser/error_test.go.html#6723192">s</a></span><span class="op" id="6723335">[</span><span class="num" id="6723336">2</span><span class="op" id="6723337">]</span><span class="op" id="6723338">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723347">default</span><span class="op" id="6723354">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723359"><a href="/go/parser/error_test.go.html#6722936">prev</a></span>&nbsp;<span class="op" id="6723364">=</span>&nbsp;<span class="ident" id="6723366"><a href="/go/parser/error_test.go.html#6723091">pos</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723373">var</span>&nbsp;<span class="ident" id="6723377">l</span>&nbsp;<span class="builtintype" id="6723379">int</span>&nbsp;<span class="comment" id="6723383">//&nbsp;token&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723402">if</span>&nbsp;<span class="ident" id="6723405"><a href="/go/parser/error_test.go.html#6723096">tok</a></span><span class="op" id="6723408">.</span><span class="ident" id="6723409">IsLiteral</span><span class="op" id="6723418">(</span><span class="op" id="6723419">)</span>&nbsp;<span class="op" id="6723421">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723427"><a href="/go/parser/error_test.go.html#6723377">l</a></span>&nbsp;<span class="op" id="6723429">=</span>&nbsp;<span class="builtinfunc" id="6723431">len</span><span class="op" id="6723434">(</span><span class="ident" id="6723435"><a href="/go/parser/error_test.go.html#6723101">lit</a></span><span class="op" id="6723438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723443">}</span>&nbsp;<span class="keyword" id="6723445">else</span>&nbsp;<span class="op" id="6723450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723456"><a href="/go/parser/error_test.go.html#6723377">l</a></span>&nbsp;<span class="op" id="6723458">=</span>&nbsp;<span class="builtinfunc" id="6723460">len</span><span class="op" id="6723463">(</span><span class="ident" id="6723464"><a href="/go/parser/error_test.go.html#6723096">tok</a></span><span class="op" id="6723467">.</span><span class="ident" id="6723468">String</span><span class="op" id="6723474">(</span><span class="op" id="6723475">)</span><span class="op" id="6723476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723486"><a href="/go/parser/error_test.go.html#6723009">here</a></span>&nbsp;<span class="op" id="6723491">=</span>&nbsp;<span class="ident" id="6723493"><a href="/go/parser/error_test.go.html#6722936">prev</a></span>&nbsp;<span class="op" id="6723498">+</span>&nbsp;<span class="ident" id="6723500"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6723505">.</span><span class="ident" id="6723506">Pos</span><span class="op" id="6723509">(</span><span class="ident" id="6723510"><a href="/go/parser/error_test.go.html#6723377">l</a></span><span class="op" id="6723511">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723518">}</span><br>
<span class="lineno"></span><span class="op" id="6723520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6723523">//&nbsp;compareErrors&nbsp;compares&nbsp;the&nbsp;map&nbsp;of&nbsp;expected&nbsp;error&nbsp;messages&nbsp;with&nbsp;the&nbsp;list</span><br>
<span class="lineno">110</span><span class="comment" id="6723598">//&nbsp;of&nbsp;found&nbsp;errors&nbsp;and&nbsp;reports&nbsp;discrepancies.</span><br>
<span class="lineno"></span><span class="comment" id="6723644">//</span><br>
<span class="lineno"></span><span class="keyword" id="6723647">func</span>&nbsp;<span class="ident" id="6723652">compareErrors</span><span class="op" id="6723665">(</span><span class="ident" id="6723666">t</span>&nbsp;<span class="op" id="6723668">*</span><span class="ident" id="6723669"><a href="/go/parser/error_test.go.html#6721503">testing</a></span><span class="op" id="6723676">.</span><span class="ident" id="6723677">T</span><span class="op" id="6723678">,</span>&nbsp;<span class="ident" id="6723680">expected</span>&nbsp;<span class="keyword" id="6723689">map</span><span class="op" id="6723692">[</span><span class="ident" id="6723693"><a href="/go/parser/error_test.go.html#6721440">token</a></span><span class="op" id="6723698">.</span><span class="ident" id="6723699">Pos</span><span class="op" id="6723702">]</span><span class="builtintype" id="6723703">string</span><span class="op" id="6723709">,</span>&nbsp;<span class="ident" id="6723711">found</span>&nbsp;<span class="ident" id="6723717"><a href="/go/parser/error_test.go.html#6721426">scanner</a></span><span class="op" id="6723724">.</span><span class="ident" id="6723725">ErrorList</span><span class="op" id="6723734">)</span>&nbsp;<span class="op" id="6723736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723739">for</span>&nbsp;<span class="ident" id="6723743">_</span><span class="op" id="6723744">,</span>&nbsp;<span class="builtintype" id="6723746">error</span>&nbsp;<span class="op" id="6723752">:=</span>&nbsp;<span class="keyword" id="6723755">range</span>&nbsp;<span class="ident" id="6723761"><a href="/go/parser/error_test.go.html#6723711">found</a></span>&nbsp;<span class="op" id="6723767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6723771">//&nbsp;error.Pos&nbsp;is&nbsp;a&nbsp;token.Position,&nbsp;but&nbsp;we&nbsp;want</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6723819">//&nbsp;a&nbsp;token.Pos&nbsp;so&nbsp;we&nbsp;can&nbsp;do&nbsp;a&nbsp;map&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723862">pos</span>&nbsp;<span class="op" id="6723866">:=</span>&nbsp;<span class="ident" id="6723869"><a href="/go/parser/error_test.go.html#6721887">getPos</a></span><span class="op" id="6723875">(</span><span class="builtintype" id="6723876"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6723881">.</span><span class="ident" id="6723882">Pos</span><span class="op" id="6723885">.</span><span class="ident" id="6723886">Filename</span><span class="op" id="6723894">,</span>&nbsp;<span class="builtintype" id="6723896"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6723901">.</span><span class="ident" id="6723902">Pos</span><span class="op" id="6723905">.</span><span class="ident" id="6723906">Offset</span><span class="op" id="6723912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6723916">if</span>&nbsp;<span class="ident" id="6723919">msg</span><span class="op" id="6723922">,</span>&nbsp;<span class="ident" id="6723924">found</span>&nbsp;<span class="op" id="6723930">:=</span>&nbsp;<span class="ident" id="6723933"><a href="/go/parser/error_test.go.html#6723680">expected</a></span><span class="op" id="6723941">[</span><span class="ident" id="6723942"><a href="/go/parser/error_test.go.html#6723862">pos</a></span><span class="op" id="6723945">]</span><span class="op" id="6723946">;</span>&nbsp;<span class="ident" id="6723948"><a href="/go/parser/error_test.go.html#6723924">found</a></span>&nbsp;<span class="op" id="6723954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6723959">//&nbsp;we&nbsp;expect&nbsp;a&nbsp;message&nbsp;at&nbsp;pos;&nbsp;check&nbsp;if&nbsp;it&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724013">rx</span><span class="op" id="6724015">,</span>&nbsp;<span class="ident" id="6724017">err</span>&nbsp;<span class="op" id="6724021">:=</span>&nbsp;<span class="ident" id="6724024"><a href="/go/parser/error_test.go.html#6721482">regexp</a></span><span class="op" id="6724030">.</span><span class="ident" id="6724031">Compile</span><span class="op" id="6724038">(</span><span class="ident" id="6724039"><a href="/go/parser/error_test.go.html#6723919">msg</a></span><span class="op" id="6724042">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724047">if</span>&nbsp;<span class="ident" id="6724050"><a href="/go/parser/error_test.go.html#6724017">err</a></span>&nbsp;<span class="op" id="6724054">!=</span>&nbsp;<span class="ident" id="6724057">nil</span>&nbsp;<span class="op" id="6724061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724067"><a href="/go/parser/error_test.go.html#6723666">t</a></span><span class="op" id="6724068">.</span><span class="ident" id="6724069">Errorf</span><span class="op" id="6724075">(</span><span class="string" id="6724076">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="6724084">,</span>&nbsp;<span class="builtintype" id="6724086"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6724091">.</span><span class="ident" id="6724092">Pos</span><span class="op" id="6724095">,</span>&nbsp;<span class="ident" id="6724097"><a href="/go/parser/error_test.go.html#6724017">err</a></span><span class="op" id="6724100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724106">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724123">if</span>&nbsp;<span class="ident" id="6724126">match</span>&nbsp;<span class="op" id="6724132">:=</span>&nbsp;<span class="ident" id="6724135"><a href="/go/parser/error_test.go.html#6724013">rx</a></span><span class="op" id="6724137">.</span><span class="ident" id="6724138">MatchString</span><span class="op" id="6724149">(</span><span class="builtintype" id="6724150"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6724155">.</span><span class="ident" id="6724156">Msg</span><span class="op" id="6724159">)</span><span class="op" id="6724160">;</span>&nbsp;<span class="op" id="6724162">!</span><span class="ident" id="6724163"><a href="/go/parser/error_test.go.html#6724126">match</a></span>&nbsp;<span class="op" id="6724169">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724175"><a href="/go/parser/error_test.go.html#6723666">t</a></span><span class="op" id="6724176">.</span><span class="ident" id="6724177">Errorf</span><span class="op" id="6724183">(</span><span class="string" id="6724184">&#34;%s:&nbsp;%q&nbsp;does&nbsp;not&nbsp;match&nbsp;%q&#34;</span><span class="op" id="6724210">,</span>&nbsp;<span class="builtintype" id="6724212"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6724217">.</span><span class="ident" id="6724218">Pos</span><span class="op" id="6724221">,</span>&nbsp;<span class="builtintype" id="6724223"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6724228">.</span><span class="ident" id="6724229">Msg</span><span class="op" id="6724232">,</span>&nbsp;<span class="ident" id="6724234"><a href="/go/parser/error_test.go.html#6723919">msg</a></span><span class="op" id="6724237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724243">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6724260">//&nbsp;we&nbsp;have&nbsp;a&nbsp;match&nbsp;-&nbsp;eliminate&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6724305">delete</span><span class="op" id="6724311">(</span><span class="ident" id="6724312"><a href="/go/parser/error_test.go.html#6723680">expected</a></span><span class="op" id="6724320">,</span>&nbsp;<span class="ident" id="6724322"><a href="/go/parser/error_test.go.html#6723862">pos</a></span><span class="op" id="6724325">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724329">}</span>&nbsp;<span class="keyword" id="6724331">else</span>&nbsp;<span class="op" id="6724336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6724341">//&nbsp;To&nbsp;keep&nbsp;in&nbsp;mind&nbsp;when&nbsp;analyzing&nbsp;failed&nbsp;test&nbsp;output:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6724398">//&nbsp;If&nbsp;the&nbsp;same&nbsp;error&nbsp;position&nbsp;occurs&nbsp;multiple&nbsp;times&nbsp;in&nbsp;errors,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6724464">//&nbsp;this&nbsp;message&nbsp;will&nbsp;be&nbsp;triggered&nbsp;(because&nbsp;the&nbsp;first&nbsp;error&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6724529">//&nbsp;the&nbsp;position&nbsp;removes&nbsp;this&nbsp;position&nbsp;from&nbsp;the&nbsp;expected&nbsp;errors).</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724597"><a href="/go/parser/error_test.go.html#6723666">t</a></span><span class="op" id="6724598">.</span><span class="ident" id="6724599">Errorf</span><span class="op" id="6724605">(</span><span class="string" id="6724606">&#34;%s:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6724632">,</span>&nbsp;<span class="builtintype" id="6724634"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6724639">.</span><span class="ident" id="6724640">Pos</span><span class="op" id="6724643">,</span>&nbsp;<span class="builtintype" id="6724645"><a href="/go/parser/error_test.go.html#6723746">error</a></span><span class="op" id="6724650">.</span><span class="ident" id="6724651">Msg</span><span class="op" id="6724654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6724665">//&nbsp;there&nbsp;should&nbsp;be&nbsp;no&nbsp;expected&nbsp;errors&nbsp;left</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724709">if</span>&nbsp;<span class="builtinfunc" id="6724712">len</span><span class="op" id="6724715">(</span><span class="ident" id="6724716"><a href="/go/parser/error_test.go.html#6723680">expected</a></span><span class="op" id="6724724">)</span>&nbsp;<span class="op" id="6724726">&gt;</span>&nbsp;<span class="num" id="6724728">0</span>&nbsp;<span class="op" id="6724730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724734"><a href="/go/parser/error_test.go.html#6723666">t</a></span><span class="op" id="6724735">.</span><span class="ident" id="6724736">Errorf</span><span class="op" id="6724742">(</span><span class="string" id="6724743">&#34;%d&nbsp;errors&nbsp;not&nbsp;reported:&#34;</span><span class="op" id="6724768">,</span>&nbsp;<span class="builtinfunc" id="6724770">len</span><span class="op" id="6724773">(</span><span class="ident" id="6724774"><a href="/go/parser/error_test.go.html#6723680">expected</a></span><span class="op" id="6724782">)</span><span class="op" id="6724783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724787">for</span>&nbsp;<span class="ident" id="6724791">pos</span><span class="op" id="6724794">,</span>&nbsp;<span class="ident" id="6724796">msg</span>&nbsp;<span class="op" id="6724800">:=</span>&nbsp;<span class="keyword" id="6724803">range</span>&nbsp;<span class="ident" id="6724809"><a href="/go/parser/error_test.go.html#6723680">expected</a></span>&nbsp;<span class="op" id="6724818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724823"><a href="/go/parser/error_test.go.html#6723666">t</a></span><span class="op" id="6724824">.</span><span class="ident" id="6724825">Errorf</span><span class="op" id="6724831">(</span><span class="string" id="6724832">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6724842">,</span>&nbsp;<span class="ident" id="6724844"><a href="/go/parser/error_test.go.html#6721549">fsetErrs</a></span><span class="op" id="6724852">.</span><span class="ident" id="6724853">Position</span><span class="op" id="6724861">(</span><span class="ident" id="6724862"><a href="/go/parser/error_test.go.html#6724791">pos</a></span><span class="op" id="6724865">)</span><span class="op" id="6724866">,</span>&nbsp;<span class="ident" id="6724868"><a href="/go/parser/error_test.go.html#6724796">msg</a></span><span class="op" id="6724871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724875">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724878">}</span><br>
<span class="lineno"></span><span class="op" id="6724880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6724883">func</span>&nbsp;<span class="ident" id="6724888">checkErrors</span><span class="op" id="6724899">(</span><span class="ident" id="6724900">t</span>&nbsp;<span class="op" id="6724902">*</span><span class="ident" id="6724903"><a href="/go/parser/error_test.go.html#6721503">testing</a></span><span class="op" id="6724910">.</span><span class="ident" id="6724911">T</span><span class="op" id="6724912">,</span>&nbsp;<span class="ident" id="6724914">filename</span>&nbsp;<span class="builtintype" id="6724923">string</span><span class="op" id="6724929">,</span>&nbsp;<span class="ident" id="6724931">input</span>&nbsp;<span class="keyword" id="6724937">interface</span><span class="op" id="6724946">{</span><span class="op" id="6724947">}</span><span class="op" id="6724948">)</span>&nbsp;<span class="op" id="6724950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6724953">src</span><span class="op" id="6724956">,</span>&nbsp;<span class="ident" id="6724958">err</span>&nbsp;<span class="op" id="6724962">:=</span>&nbsp;<span class="ident" id="6724965"><a href="/go/parser/interface.go.html#6032136">readSource</a></span><span class="op" id="6724975">(</span><span class="ident" id="6724976"><a href="/go/parser/error_test.go.html#6724914">filename</a></span><span class="op" id="6724984">,</span>&nbsp;<span class="ident" id="6724986"><a href="/go/parser/error_test.go.html#6724931">input</a></span><span class="op" id="6724991">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6724994">if</span>&nbsp;<span class="ident" id="6724997"><a href="/go/parser/error_test.go.html#6724958">err</a></span>&nbsp;<span class="op" id="6725001">!=</span>&nbsp;<span class="ident" id="6725004">nil</span>&nbsp;<span class="op" id="6725008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725012"><a href="/go/parser/error_test.go.html#6724900">t</a></span><span class="op" id="6725013">.</span><span class="ident" id="6725014">Error</span><span class="op" id="6725019">(</span><span class="ident" id="6725020"><a href="/go/parser/error_test.go.html#6724958">err</a></span><span class="op" id="6725023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6725027">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6725035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725039">_</span><span class="op" id="6725040">,</span>&nbsp;<span class="ident" id="6725042"><a href="/go/parser/error_test.go.html#6724958">err</a></span>&nbsp;<span class="op" id="6725046">=</span>&nbsp;<span class="ident" id="6725048"><a href="/go/parser/interface.go.html#6034508">ParseFile</a></span><span class="op" id="6725057">(</span><span class="ident" id="6725058"><a href="/go/parser/error_test.go.html#6721549">fsetErrs</a></span><span class="op" id="6725066">,</span>&nbsp;<span class="ident" id="6725068"><a href="/go/parser/error_test.go.html#6724914">filename</a></span><span class="op" id="6725076">,</span>&nbsp;<span class="ident" id="6725078"><a href="/go/parser/error_test.go.html#6724953">src</a></span><span class="op" id="6725081">,</span>&nbsp;<span class="ident" id="6725083"><a href="/go/parser/interface.go.html#6033188">DeclarationErrors</a></span><span class="op" id="6725100">|</span><span class="ident" id="6725101"><a href="/go/parser/interface.go.html#6033362">AllErrors</a></span><span class="op" id="6725110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725113">found</span><span class="op" id="6725118">,</span>&nbsp;<span class="ident" id="6725120">ok</span>&nbsp;<span class="op" id="6725123">:=</span>&nbsp;<span class="ident" id="6725126"><a href="/go/parser/error_test.go.html#6724958">err</a></span><span class="op" id="6725129">.</span><span class="op" id="6725130">(</span><span class="ident" id="6725131"><a href="/go/parser/error_test.go.html#6721426">scanner</a></span><span class="op" id="6725138">.</span><span class="ident" id="6725139">ErrorList</span><span class="op" id="6725148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6725151">if</span>&nbsp;<span class="ident" id="6725154"><a href="/go/parser/error_test.go.html#6724958">err</a></span>&nbsp;<span class="op" id="6725158">!=</span>&nbsp;<span class="ident" id="6725161">nil</span>&nbsp;<span class="op" id="6725165">&amp;&amp;</span>&nbsp;<span class="op" id="6725168">!</span><span class="ident" id="6725169"><a href="/go/parser/error_test.go.html#6725120">ok</a></span>&nbsp;<span class="op" id="6725172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725176"><a href="/go/parser/error_test.go.html#6724900">t</a></span><span class="op" id="6725177">.</span><span class="ident" id="6725178">Error</span><span class="op" id="6725183">(</span><span class="ident" id="6725184"><a href="/go/parser/error_test.go.html#6724958">err</a></span><span class="op" id="6725187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6725191">return</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6725199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725202"><a href="/go/parser/error_test.go.html#6725113">found</a></span><span class="op" id="6725207">.</span><span class="ident" id="6725208">RemoveMultiples</span><span class="op" id="6725223">(</span><span class="op" id="6725224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6725228">//&nbsp;we&nbsp;are&nbsp;expecting&nbsp;the&nbsp;following&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6725270">//&nbsp;(collect&nbsp;these&nbsp;after&nbsp;parsing&nbsp;a&nbsp;file&nbsp;so&nbsp;that&nbsp;it&nbsp;is&nbsp;found&nbsp;in&nbsp;the&nbsp;file&nbsp;set)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725347">expected</span>&nbsp;<span class="op" id="6725356">:=</span>&nbsp;<span class="ident" id="6725359"><a href="/go/parser/error_test.go.html#6722542">expectedErrors</a></span><span class="op" id="6725373">(</span><span class="ident" id="6725374"><a href="/go/parser/error_test.go.html#6724900">t</a></span><span class="op" id="6725375">,</span>&nbsp;<span class="ident" id="6725377"><a href="/go/parser/error_test.go.html#6724914">filename</a></span><span class="op" id="6725385">,</span>&nbsp;<span class="ident" id="6725387"><a href="/go/parser/error_test.go.html#6724953">src</a></span><span class="op" id="6725390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6725394">//&nbsp;verify&nbsp;errors&nbsp;returned&nbsp;by&nbsp;the&nbsp;parser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725435"><a href="/go/parser/error_test.go.html#6723652">compareErrors</a></span><span class="op" id="6725448">(</span><span class="ident" id="6725449"><a href="/go/parser/error_test.go.html#6724900">t</a></span><span class="op" id="6725450">,</span>&nbsp;<span class="ident" id="6725452"><a href="/go/parser/error_test.go.html#6725347">expected</a></span><span class="op" id="6725460">,</span>&nbsp;<span class="ident" id="6725462"><a href="/go/parser/error_test.go.html#6725113">found</a></span><span class="op" id="6725467">)</span><br>
<span class="lineno"></span><span class="op" id="6725469">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6725472">func</span>&nbsp;<span class="ident" id="6725477">TestErrors</span><span class="op" id="6725487">(</span><span class="ident" id="6725488">t</span>&nbsp;<span class="op" id="6725490">*</span><span class="ident" id="6725491"><a href="/go/parser/error_test.go.html#6721503">testing</a></span><span class="op" id="6725498">.</span><span class="ident" id="6725499">T</span><span class="op" id="6725500">)</span>&nbsp;<span class="op" id="6725502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725505">list</span><span class="op" id="6725509">,</span>&nbsp;<span class="ident" id="6725511">err</span>&nbsp;<span class="op" id="6725515">:=</span>&nbsp;<span class="ident" id="6725518"><a href="/go/parser/error_test.go.html#6721452">ioutil</a></span><span class="op" id="6725524">.</span><span class="ident" id="6725525">ReadDir</span><span class="op" id="6725532">(</span><span class="ident" id="6725533"><a href="/go/parser/error_test.go.html#6721522">testdata</a></span><span class="op" id="6725541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6725544">if</span>&nbsp;<span class="ident" id="6725547"><a href="/go/parser/error_test.go.html#6725511">err</a></span>&nbsp;<span class="op" id="6725551">!=</span>&nbsp;<span class="ident" id="6725554">nil</span>&nbsp;<span class="op" id="6725558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725562"><a href="/go/parser/error_test.go.html#6725488">t</a></span><span class="op" id="6725563">.</span><span class="ident" id="6725564">Fatal</span><span class="op" id="6725569">(</span><span class="ident" id="6725570"><a href="/go/parser/error_test.go.html#6725511">err</a></span><span class="op" id="6725573">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6725576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6725579">for</span>&nbsp;<span class="ident" id="6725583">_</span><span class="op" id="6725584">,</span>&nbsp;<span class="ident" id="6725586">fi</span>&nbsp;<span class="op" id="6725589">:=</span>&nbsp;<span class="keyword" id="6725592">range</span>&nbsp;<span class="ident" id="6725598"><a href="/go/parser/error_test.go.html#6725505">list</a></span>&nbsp;<span class="op" id="6725603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725607">name</span>&nbsp;<span class="op" id="6725612">:=</span>&nbsp;<span class="ident" id="6725615"><a href="/go/parser/error_test.go.html#6725586">fi</a></span><span class="op" id="6725617">.</span><span class="ident" id="6725618">Name</span><span class="op" id="6725622">(</span><span class="op" id="6725623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6725627">if</span>&nbsp;<span class="op" id="6725630">!</span><span class="ident" id="6725631"><a href="/go/parser/error_test.go.html#6725586">fi</a></span><span class="op" id="6725633">.</span><span class="ident" id="6725634">IsDir</span><span class="op" id="6725639">(</span><span class="op" id="6725640">)</span>&nbsp;<span class="op" id="6725642">&amp;&amp;</span>&nbsp;<span class="op" id="6725645">!</span><span class="ident" id="6725646"><a href="/go/parser/error_test.go.html#6721492">strings</a></span><span class="op" id="6725653">.</span><span class="ident" id="6725654">HasPrefix</span><span class="op" id="6725663">(</span><span class="ident" id="6725664"><a href="/go/parser/error_test.go.html#6725607">name</a></span><span class="op" id="6725668">,</span>&nbsp;<span class="string" id="6725670">&#34;.&#34;</span><span class="op" id="6725673">)</span>&nbsp;<span class="op" id="6725675">&amp;&amp;</span>&nbsp;<span class="ident" id="6725678"><a href="/go/parser/error_test.go.html#6721492">strings</a></span><span class="op" id="6725685">.</span><span class="ident" id="6725686">HasSuffix</span><span class="op" id="6725695">(</span><span class="ident" id="6725696"><a href="/go/parser/error_test.go.html#6725607">name</a></span><span class="op" id="6725700">,</span>&nbsp;<span class="string" id="6725702">&#34;.src&#34;</span><span class="op" id="6725708">)</span>&nbsp;<span class="op" id="6725710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6725715"><a href="/go/parser/error_test.go.html#6724888">checkErrors</a></span><span class="op" id="6725726">(</span><span class="ident" id="6725727"><a href="/go/parser/error_test.go.html#6725488">t</a></span><span class="op" id="6725728">,</span>&nbsp;<span class="ident" id="6725730"><a href="/go/parser/error_test.go.html#6721465">filepath</a></span><span class="op" id="6725738">.</span><span class="ident" id="6725739">Join</span><span class="op" id="6725743">(</span><span class="ident" id="6725744"><a href="/go/parser/error_test.go.html#6721522">testdata</a></span><span class="op" id="6725752">,</span>&nbsp;<span class="ident" id="6725754"><a href="/go/parser/error_test.go.html#6725607">name</a></span><span class="op" id="6725758">)</span><span class="op" id="6725759">,</span>&nbsp;<span class="ident" id="6725761">nil</span><span class="op" id="6725764">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6725768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6725771">}</span><br>
<span class="lineno"></span><span class="op" id="6725773">}</span>
</div>
</body>
</html>
