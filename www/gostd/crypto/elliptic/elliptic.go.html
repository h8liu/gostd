<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4894660">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4894715">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4894769">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4894820">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4894895">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4894906">package</span>&nbsp;<span class="ident" id="4894914">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4894924">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4894999">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4895074">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4895154">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4895229">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4895303">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4895368">import</span>&nbsp;<span class="op" id="4895375">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4895378">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4895384">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4895396">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4895403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4895406">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4895470">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4895531">type</span>&nbsp;<span class="ident" id="4895536">Curve</span>&nbsp;<span class="keyword" id="4895542">interface</span>&nbsp;<span class="op" id="4895552">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4895555">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895604">Params</span><span class="op" id="4895610">(</span><span class="op" id="4895611">)</span>&nbsp;<span class="op" id="4895613">*</span><span class="ident" id="4895614">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4895627">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895692">IsOnCurve</span><span class="op" id="4895701">(</span><span class="ident" id="4895702">x</span><span class="op" id="4895703">,</span>&nbsp;<span class="ident" id="4895705">y</span>&nbsp;<span class="op" id="4895707">*</span><span class="ident" id="4895708">big</span><span class="op" id="4895711">.</span><span class="ident" id="4895712">Int</span><span class="op" id="4895715">)</span>&nbsp;<span class="builtintype" id="4895717">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4895723">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895770">Add</span><span class="op" id="4895773">(</span><span class="ident" id="4895774">x1</span><span class="op" id="4895776">,</span>&nbsp;<span class="ident" id="4895778">y1</span><span class="op" id="4895780">,</span>&nbsp;<span class="ident" id="4895782">x2</span><span class="op" id="4895784">,</span>&nbsp;<span class="ident" id="4895786">y2</span>&nbsp;<span class="op" id="4895789">*</span><span class="ident" id="4895790">big</span><span class="op" id="4895793">.</span><span class="ident" id="4895794">Int</span><span class="op" id="4895797">)</span>&nbsp;<span class="op" id="4895799">(</span><span class="ident" id="4895800">x</span><span class="op" id="4895801">,</span>&nbsp;<span class="ident" id="4895803">y</span>&nbsp;<span class="op" id="4895805">*</span><span class="ident" id="4895806">big</span><span class="op" id="4895809">.</span><span class="ident" id="4895810">Int</span><span class="op" id="4895813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4895816">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895843">Double</span><span class="op" id="4895849">(</span><span class="ident" id="4895850">x1</span><span class="op" id="4895852">,</span>&nbsp;<span class="ident" id="4895854">y1</span>&nbsp;<span class="op" id="4895857">*</span><span class="ident" id="4895858">big</span><span class="op" id="4895861">.</span><span class="ident" id="4895862">Int</span><span class="op" id="4895865">)</span>&nbsp;<span class="op" id="4895867">(</span><span class="ident" id="4895868">x</span><span class="op" id="4895869">,</span>&nbsp;<span class="ident" id="4895871">y</span>&nbsp;<span class="op" id="4895873">*</span><span class="ident" id="4895874">big</span><span class="op" id="4895877">.</span><span class="ident" id="4895878">Int</span><span class="op" id="4895881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4895884">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4895957">ScalarMult</span><span class="op" id="4895967">(</span><span class="ident" id="4895968">x1</span><span class="op" id="4895970">,</span>&nbsp;<span class="ident" id="4895972">y1</span>&nbsp;<span class="op" id="4895975">*</span><span class="ident" id="4895976">big</span><span class="op" id="4895979">.</span><span class="ident" id="4895980">Int</span><span class="op" id="4895983">,</span>&nbsp;<span class="ident" id="4895985">k</span>&nbsp;<span class="op" id="4895987">[</span><span class="op" id="4895988">]</span><span class="builtintype" id="4895989">byte</span><span class="op" id="4895993">)</span>&nbsp;<span class="op" id="4895995">(</span><span class="ident" id="4895996">x</span><span class="op" id="4895997">,</span>&nbsp;<span class="ident" id="4895999">y</span>&nbsp;<span class="op" id="4896001">*</span><span class="ident" id="4896002">big</span><span class="op" id="4896005">.</span><span class="ident" id="4896006">Int</span><span class="op" id="4896009">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896012">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896083">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896127">ScalarBaseMult</span><span class="op" id="4896141">(</span><span class="ident" id="4896142">k</span>&nbsp;<span class="op" id="4896144">[</span><span class="op" id="4896145">]</span><span class="builtintype" id="4896146">byte</span><span class="op" id="4896150">)</span>&nbsp;<span class="op" id="4896152">(</span><span class="ident" id="4896153">x</span><span class="op" id="4896154">,</span>&nbsp;<span class="ident" id="4896156">y</span>&nbsp;<span class="op" id="4896158">*</span><span class="ident" id="4896159">big</span><span class="op" id="4896162">.</span><span class="ident" id="4896163">Int</span><span class="op" id="4896166">)</span><br>
<span class="lineno"></span><span class="op" id="4896168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4896171">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4896249">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4896306">type</span>&nbsp;<span class="ident" id="4896311">CurveParams</span>&nbsp;<span class="keyword" id="4896323">struct</span>&nbsp;<span class="op" id="4896330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896333">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4896341">*</span><span class="ident" id="4896342">big</span><span class="op" id="4896345">.</span><span class="ident" id="4896346">Int</span>&nbsp;<span class="comment" id="4896350">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896388">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4896396">*</span><span class="ident" id="4896397">big</span><span class="op" id="4896400">.</span><span class="ident" id="4896401">Int</span>&nbsp;<span class="comment" id="4896405">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896437">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4896445">*</span><span class="ident" id="4896446">big</span><span class="op" id="4896449">.</span><span class="ident" id="4896450">Int</span>&nbsp;<span class="comment" id="4896454">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896493">Gx</span><span class="op" id="4896495">,</span>&nbsp;<span class="ident" id="4896497">Gy</span>&nbsp;&nbsp;<span class="op" id="4896501">*</span><span class="ident" id="4896502">big</span><span class="op" id="4896505">.</span><span class="ident" id="4896506">Int</span>&nbsp;<span class="comment" id="4896510">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896538">BitSize</span>&nbsp;<span class="builtintype" id="4896546">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4896555">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4896591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4896594">func</span>&nbsp;<span class="op" id="4896599">(</span><span class="ident" id="4896600">curve</span>&nbsp;<span class="op" id="4896606">*</span><span class="ident" id="4896607">CurveParams</span><span class="op" id="4896618">)</span>&nbsp;<span class="ident" id="4896620">Params</span><span class="op" id="4896626">(</span><span class="op" id="4896627">)</span>&nbsp;<span class="op" id="4896629">*</span><span class="ident" id="4896630">CurveParams</span>&nbsp;<span class="op" id="4896642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896645">return</span>&nbsp;<span class="ident" id="4896652">curve</span><br>
<span class="lineno"></span><span class="op" id="4896658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4896661">func</span>&nbsp;<span class="op" id="4896666">(</span><span class="ident" id="4896667">curve</span>&nbsp;<span class="op" id="4896673">*</span><span class="ident" id="4896674">CurveParams</span><span class="op" id="4896685">)</span>&nbsp;<span class="ident" id="4896687">IsOnCurve</span><span class="op" id="4896696">(</span><span class="ident" id="4896697">x</span><span class="op" id="4896698">,</span>&nbsp;<span class="ident" id="4896700">y</span>&nbsp;<span class="op" id="4896702">*</span><span class="ident" id="4896703">big</span><span class="op" id="4896706">.</span><span class="ident" id="4896707">Int</span><span class="op" id="4896710">)</span>&nbsp;<span class="builtintype" id="4896712">bool</span>&nbsp;<span class="op" id="4896717">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4896720">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896743">y2</span>&nbsp;<span class="op" id="4896746">:=</span>&nbsp;<span class="builtinfunc" id="4896749">new</span><span class="op" id="4896752">(</span><span class="ident" id="4896753">big</span><span class="op" id="4896756">.</span><span class="ident" id="4896757">Int</span><span class="op" id="4896760">)</span><span class="op" id="4896761">.</span><span class="ident" id="4896762">Mul</span><span class="op" id="4896765">(</span><span class="ident" id="4896766">y</span><span class="op" id="4896767">,</span>&nbsp;<span class="ident" id="4896769">y</span><span class="op" id="4896770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896773">y2</span><span class="op" id="4896775">.</span><span class="ident" id="4896776">Mod</span><span class="op" id="4896779">(</span><span class="ident" id="4896780">y2</span><span class="op" id="4896782">,</span>&nbsp;<span class="ident" id="4896784">curve</span><span class="op" id="4896789">.</span><span class="ident" id="4896790">P</span><span class="op" id="4896791">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896795">x3</span>&nbsp;<span class="op" id="4896798">:=</span>&nbsp;<span class="builtinfunc" id="4896801">new</span><span class="op" id="4896804">(</span><span class="ident" id="4896805">big</span><span class="op" id="4896808">.</span><span class="ident" id="4896809">Int</span><span class="op" id="4896812">)</span><span class="op" id="4896813">.</span><span class="ident" id="4896814">Mul</span><span class="op" id="4896817">(</span><span class="ident" id="4896818">x</span><span class="op" id="4896819">,</span>&nbsp;<span class="ident" id="4896821">x</span><span class="op" id="4896822">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896825">x3</span><span class="op" id="4896827">.</span><span class="ident" id="4896828">Mul</span><span class="op" id="4896831">(</span><span class="ident" id="4896832">x3</span><span class="op" id="4896834">,</span>&nbsp;<span class="ident" id="4896836">x</span><span class="op" id="4896837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896841">threeX</span>&nbsp;<span class="op" id="4896848">:=</span>&nbsp;<span class="builtinfunc" id="4896851">new</span><span class="op" id="4896854">(</span><span class="ident" id="4896855">big</span><span class="op" id="4896858">.</span><span class="ident" id="4896859">Int</span><span class="op" id="4896862">)</span><span class="op" id="4896863">.</span><span class="ident" id="4896864">Lsh</span><span class="op" id="4896867">(</span><span class="ident" id="4896868">x</span><span class="op" id="4896869">,</span>&nbsp;<span class="num" id="4896871">1</span><span class="op" id="4896872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896875">threeX</span><span class="op" id="4896881">.</span><span class="ident" id="4896882">Add</span><span class="op" id="4896885">(</span><span class="ident" id="4896886">threeX</span><span class="op" id="4896892">,</span>&nbsp;<span class="ident" id="4896894">x</span><span class="op" id="4896895">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896899">x3</span><span class="op" id="4896901">.</span><span class="ident" id="4896902">Sub</span><span class="op" id="4896905">(</span><span class="ident" id="4896906">x3</span><span class="op" id="4896908">,</span>&nbsp;<span class="ident" id="4896910">threeX</span><span class="op" id="4896916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896919">x3</span><span class="op" id="4896921">.</span><span class="ident" id="4896922">Add</span><span class="op" id="4896925">(</span><span class="ident" id="4896926">x3</span><span class="op" id="4896928">,</span>&nbsp;<span class="ident" id="4896930">curve</span><span class="op" id="4896935">.</span><span class="ident" id="4896936">B</span><span class="op" id="4896937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4896940">x3</span><span class="op" id="4896942">.</span><span class="ident" id="4896943">Mod</span><span class="op" id="4896946">(</span><span class="ident" id="4896947">x3</span><span class="op" id="4896949">,</span>&nbsp;<span class="ident" id="4896951">curve</span><span class="op" id="4896956">.</span><span class="ident" id="4896957">P</span><span class="op" id="4896958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4896962">return</span>&nbsp;<span class="ident" id="4896969">x3</span><span class="op" id="4896971">.</span><span class="ident" id="4896972">Cmp</span><span class="op" id="4896975">(</span><span class="ident" id="4896976">y2</span><span class="op" id="4896978">)</span>&nbsp;<span class="op" id="4896980">==</span>&nbsp;<span class="num" id="4896983">0</span><br>
<span class="lineno">70</span><span class="op" id="4896985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4896988">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4897067">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4897147">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4897199">func</span>&nbsp;<span class="ident" id="4897204">zForAffine</span><span class="op" id="4897214">(</span><span class="ident" id="4897215">x</span><span class="op" id="4897216">,</span>&nbsp;<span class="ident" id="4897218">y</span>&nbsp;<span class="op" id="4897220">*</span><span class="ident" id="4897221">big</span><span class="op" id="4897224">.</span><span class="ident" id="4897225">Int</span><span class="op" id="4897228">)</span>&nbsp;<span class="op" id="4897230">*</span><span class="ident" id="4897231">big</span><span class="op" id="4897234">.</span><span class="ident" id="4897235">Int</span>&nbsp;<span class="op" id="4897239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897242">z</span>&nbsp;<span class="op" id="4897244">:=</span>&nbsp;<span class="builtinfunc" id="4897247">new</span><span class="op" id="4897250">(</span><span class="ident" id="4897251">big</span><span class="op" id="4897254">.</span><span class="ident" id="4897255">Int</span><span class="op" id="4897258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897261">if</span>&nbsp;<span class="ident" id="4897264">x</span><span class="op" id="4897265">.</span><span class="ident" id="4897266">Sign</span><span class="op" id="4897270">(</span><span class="op" id="4897271">)</span>&nbsp;<span class="op" id="4897273">!=</span>&nbsp;<span class="num" id="4897276">0</span>&nbsp;<span class="op" id="4897278">||</span>&nbsp;<span class="ident" id="4897281">y</span><span class="op" id="4897282">.</span><span class="ident" id="4897283">Sign</span><span class="op" id="4897287">(</span><span class="op" id="4897288">)</span>&nbsp;<span class="op" id="4897290">!=</span>&nbsp;<span class="num" id="4897293">0</span>&nbsp;<span class="op" id="4897295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897299">z</span><span class="op" id="4897300">.</span><span class="ident" id="4897301">SetInt64</span><span class="op" id="4897309">(</span><span class="num" id="4897310">1</span><span class="op" id="4897311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4897314">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897317">return</span>&nbsp;<span class="ident" id="4897324">z</span><br>
<span class="lineno"></span><span class="op" id="4897326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4897329">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4897407">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4897464">func</span>&nbsp;<span class="op" id="4897469">(</span><span class="ident" id="4897470">curve</span>&nbsp;<span class="op" id="4897476">*</span><span class="ident" id="4897477">CurveParams</span><span class="op" id="4897488">)</span>&nbsp;<span class="ident" id="4897490">affineFromJacobian</span><span class="op" id="4897508">(</span><span class="ident" id="4897509">x</span><span class="op" id="4897510">,</span>&nbsp;<span class="ident" id="4897512">y</span><span class="op" id="4897513">,</span>&nbsp;<span class="ident" id="4897515">z</span>&nbsp;<span class="op" id="4897517">*</span><span class="ident" id="4897518">big</span><span class="op" id="4897521">.</span><span class="ident" id="4897522">Int</span><span class="op" id="4897525">)</span>&nbsp;<span class="op" id="4897527">(</span><span class="ident" id="4897528">xOut</span><span class="op" id="4897532">,</span>&nbsp;<span class="ident" id="4897534">yOut</span>&nbsp;<span class="op" id="4897539">*</span><span class="ident" id="4897540">big</span><span class="op" id="4897543">.</span><span class="ident" id="4897544">Int</span><span class="op" id="4897547">)</span>&nbsp;<span class="op" id="4897549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897552">if</span>&nbsp;<span class="ident" id="4897555">z</span><span class="op" id="4897556">.</span><span class="ident" id="4897557">Sign</span><span class="op" id="4897561">(</span><span class="op" id="4897562">)</span>&nbsp;<span class="op" id="4897564">==</span>&nbsp;<span class="num" id="4897567">0</span>&nbsp;<span class="op" id="4897569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897573">return</span>&nbsp;<span class="builtinfunc" id="4897580">new</span><span class="op" id="4897583">(</span><span class="ident" id="4897584">big</span><span class="op" id="4897587">.</span><span class="ident" id="4897588">Int</span><span class="op" id="4897591">)</span><span class="op" id="4897592">,</span>&nbsp;<span class="builtinfunc" id="4897594">new</span><span class="op" id="4897597">(</span><span class="ident" id="4897598">big</span><span class="op" id="4897601">.</span><span class="ident" id="4897602">Int</span><span class="op" id="4897605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4897608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897612">zinv</span>&nbsp;<span class="op" id="4897617">:=</span>&nbsp;<span class="builtinfunc" id="4897620">new</span><span class="op" id="4897623">(</span><span class="ident" id="4897624">big</span><span class="op" id="4897627">.</span><span class="ident" id="4897628">Int</span><span class="op" id="4897631">)</span><span class="op" id="4897632">.</span><span class="ident" id="4897633">ModInverse</span><span class="op" id="4897643">(</span><span class="ident" id="4897644">z</span><span class="op" id="4897645">,</span>&nbsp;<span class="ident" id="4897647">curve</span><span class="op" id="4897652">.</span><span class="ident" id="4897653">P</span><span class="op" id="4897654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897657">zinvsq</span>&nbsp;<span class="op" id="4897664">:=</span>&nbsp;<span class="builtinfunc" id="4897667">new</span><span class="op" id="4897670">(</span><span class="ident" id="4897671">big</span><span class="op" id="4897674">.</span><span class="ident" id="4897675">Int</span><span class="op" id="4897678">)</span><span class="op" id="4897679">.</span><span class="ident" id="4897680">Mul</span><span class="op" id="4897683">(</span><span class="ident" id="4897684">zinv</span><span class="op" id="4897688">,</span>&nbsp;<span class="ident" id="4897690">zinv</span><span class="op" id="4897694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897698">xOut</span>&nbsp;<span class="op" id="4897703">=</span>&nbsp;<span class="builtinfunc" id="4897705">new</span><span class="op" id="4897708">(</span><span class="ident" id="4897709">big</span><span class="op" id="4897712">.</span><span class="ident" id="4897713">Int</span><span class="op" id="4897716">)</span><span class="op" id="4897717">.</span><span class="ident" id="4897718">Mul</span><span class="op" id="4897721">(</span><span class="ident" id="4897722">x</span><span class="op" id="4897723">,</span>&nbsp;<span class="ident" id="4897725">zinvsq</span><span class="op" id="4897731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897734">xOut</span><span class="op" id="4897738">.</span><span class="ident" id="4897739">Mod</span><span class="op" id="4897742">(</span><span class="ident" id="4897743">xOut</span><span class="op" id="4897747">,</span>&nbsp;<span class="ident" id="4897749">curve</span><span class="op" id="4897754">.</span><span class="ident" id="4897755">P</span><span class="op" id="4897756">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897759">zinvsq</span><span class="op" id="4897765">.</span><span class="ident" id="4897766">Mul</span><span class="op" id="4897769">(</span><span class="ident" id="4897770">zinvsq</span><span class="op" id="4897776">,</span>&nbsp;<span class="ident" id="4897778">zinv</span><span class="op" id="4897782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897785">yOut</span>&nbsp;<span class="op" id="4897790">=</span>&nbsp;<span class="builtinfunc" id="4897792">new</span><span class="op" id="4897795">(</span><span class="ident" id="4897796">big</span><span class="op" id="4897799">.</span><span class="ident" id="4897800">Int</span><span class="op" id="4897803">)</span><span class="op" id="4897804">.</span><span class="ident" id="4897805">Mul</span><span class="op" id="4897808">(</span><span class="ident" id="4897809">y</span><span class="op" id="4897810">,</span>&nbsp;<span class="ident" id="4897812">zinvsq</span><span class="op" id="4897818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897821">yOut</span><span class="op" id="4897825">.</span><span class="ident" id="4897826">Mod</span><span class="op" id="4897829">(</span><span class="ident" id="4897830">yOut</span><span class="op" id="4897834">,</span>&nbsp;<span class="ident" id="4897836">curve</span><span class="op" id="4897841">.</span><span class="ident" id="4897842">P</span><span class="op" id="4897843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897846">return</span><br>
<span class="lineno"></span><span class="op" id="4897853">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4897856">func</span>&nbsp;<span class="op" id="4897861">(</span><span class="ident" id="4897862">curve</span>&nbsp;<span class="op" id="4897868">*</span><span class="ident" id="4897869">CurveParams</span><span class="op" id="4897880">)</span>&nbsp;<span class="ident" id="4897882">Add</span><span class="op" id="4897885">(</span><span class="ident" id="4897886">x1</span><span class="op" id="4897888">,</span>&nbsp;<span class="ident" id="4897890">y1</span><span class="op" id="4897892">,</span>&nbsp;<span class="ident" id="4897894">x2</span><span class="op" id="4897896">,</span>&nbsp;<span class="ident" id="4897898">y2</span>&nbsp;<span class="op" id="4897901">*</span><span class="ident" id="4897902">big</span><span class="op" id="4897905">.</span><span class="ident" id="4897906">Int</span><span class="op" id="4897909">)</span>&nbsp;<span class="op" id="4897911">(</span><span class="op" id="4897912">*</span><span class="ident" id="4897913">big</span><span class="op" id="4897916">.</span><span class="ident" id="4897917">Int</span><span class="op" id="4897920">,</span>&nbsp;<span class="op" id="4897922">*</span><span class="ident" id="4897923">big</span><span class="op" id="4897926">.</span><span class="ident" id="4897927">Int</span><span class="op" id="4897930">)</span>&nbsp;<span class="op" id="4897932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897935">z1</span>&nbsp;<span class="op" id="4897938">:=</span>&nbsp;<span class="ident" id="4897941">zForAffine</span><span class="op" id="4897951">(</span><span class="ident" id="4897952">x1</span><span class="op" id="4897954">,</span>&nbsp;<span class="ident" id="4897956">y1</span><span class="op" id="4897958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4897961">z2</span>&nbsp;<span class="op" id="4897964">:=</span>&nbsp;<span class="ident" id="4897967">zForAffine</span><span class="op" id="4897977">(</span><span class="ident" id="4897978">x2</span><span class="op" id="4897980">,</span>&nbsp;<span class="ident" id="4897982">y2</span><span class="op" id="4897984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4897987">return</span>&nbsp;<span class="ident" id="4897994">curve</span><span class="op" id="4897999">.</span><span class="ident" id="4898000">affineFromJacobian</span><span class="op" id="4898018">(</span><span class="ident" id="4898019">curve</span><span class="op" id="4898024">.</span><span class="ident" id="4898025">addJacobian</span><span class="op" id="4898036">(</span><span class="ident" id="4898037">x1</span><span class="op" id="4898039">,</span>&nbsp;<span class="ident" id="4898041">y1</span><span class="op" id="4898043">,</span>&nbsp;<span class="ident" id="4898045">z1</span><span class="op" id="4898047">,</span>&nbsp;<span class="ident" id="4898049">x2</span><span class="op" id="4898051">,</span>&nbsp;<span class="ident" id="4898053">y2</span><span class="op" id="4898055">,</span>&nbsp;<span class="ident" id="4898057">z2</span><span class="op" id="4898059">)</span><span class="op" id="4898060">)</span><br>
<span class="lineno">105</span><span class="op" id="4898062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4898065">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4898139">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4898201">func</span>&nbsp;<span class="op" id="4898206">(</span><span class="ident" id="4898207">curve</span>&nbsp;<span class="op" id="4898213">*</span><span class="ident" id="4898214">CurveParams</span><span class="op" id="4898225">)</span>&nbsp;<span class="ident" id="4898227">addJacobian</span><span class="op" id="4898238">(</span><span class="ident" id="4898239">x1</span><span class="op" id="4898241">,</span>&nbsp;<span class="ident" id="4898243">y1</span><span class="op" id="4898245">,</span>&nbsp;<span class="ident" id="4898247">z1</span><span class="op" id="4898249">,</span>&nbsp;<span class="ident" id="4898251">x2</span><span class="op" id="4898253">,</span>&nbsp;<span class="ident" id="4898255">y2</span><span class="op" id="4898257">,</span>&nbsp;<span class="ident" id="4898259">z2</span>&nbsp;<span class="op" id="4898262">*</span><span class="ident" id="4898263">big</span><span class="op" id="4898266">.</span><span class="ident" id="4898267">Int</span><span class="op" id="4898270">)</span>&nbsp;<span class="op" id="4898272">(</span><span class="op" id="4898273">*</span><span class="ident" id="4898274">big</span><span class="op" id="4898277">.</span><span class="ident" id="4898278">Int</span><span class="op" id="4898281">,</span>&nbsp;<span class="op" id="4898283">*</span><span class="ident" id="4898284">big</span><span class="op" id="4898287">.</span><span class="ident" id="4898288">Int</span><span class="op" id="4898291">,</span>&nbsp;<span class="op" id="4898293">*</span><span class="ident" id="4898294">big</span><span class="op" id="4898297">.</span><span class="ident" id="4898298">Int</span><span class="op" id="4898301">)</span>&nbsp;<span class="op" id="4898303">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4898306">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898396">x3</span><span class="op" id="4898398">,</span>&nbsp;<span class="ident" id="4898400">y3</span><span class="op" id="4898402">,</span>&nbsp;<span class="ident" id="4898404">z3</span>&nbsp;<span class="op" id="4898407">:=</span>&nbsp;<span class="builtinfunc" id="4898410">new</span><span class="op" id="4898413">(</span><span class="ident" id="4898414">big</span><span class="op" id="4898417">.</span><span class="ident" id="4898418">Int</span><span class="op" id="4898421">)</span><span class="op" id="4898422">,</span>&nbsp;<span class="builtinfunc" id="4898424">new</span><span class="op" id="4898427">(</span><span class="ident" id="4898428">big</span><span class="op" id="4898431">.</span><span class="ident" id="4898432">Int</span><span class="op" id="4898435">)</span><span class="op" id="4898436">,</span>&nbsp;<span class="builtinfunc" id="4898438">new</span><span class="op" id="4898441">(</span><span class="ident" id="4898442">big</span><span class="op" id="4898445">.</span><span class="ident" id="4898446">Int</span><span class="op" id="4898449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898452">if</span>&nbsp;<span class="ident" id="4898455">z1</span><span class="op" id="4898457">.</span><span class="ident" id="4898458">Sign</span><span class="op" id="4898462">(</span><span class="op" id="4898463">)</span>&nbsp;<span class="op" id="4898465">==</span>&nbsp;<span class="num" id="4898468">0</span>&nbsp;<span class="op" id="4898470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898474">x3</span><span class="op" id="4898476">.</span><span class="ident" id="4898477">Set</span><span class="op" id="4898480">(</span><span class="ident" id="4898481">x2</span><span class="op" id="4898483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898487">y3</span><span class="op" id="4898489">.</span><span class="ident" id="4898490">Set</span><span class="op" id="4898493">(</span><span class="ident" id="4898494">y2</span><span class="op" id="4898496">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898500">z3</span><span class="op" id="4898502">.</span><span class="ident" id="4898503">Set</span><span class="op" id="4898506">(</span><span class="ident" id="4898507">z2</span><span class="op" id="4898509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898513">return</span>&nbsp;<span class="ident" id="4898520">x3</span><span class="op" id="4898522">,</span>&nbsp;<span class="ident" id="4898524">y3</span><span class="op" id="4898526">,</span>&nbsp;<span class="ident" id="4898528">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4898532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898535">if</span>&nbsp;<span class="ident" id="4898538">z2</span><span class="op" id="4898540">.</span><span class="ident" id="4898541">Sign</span><span class="op" id="4898545">(</span><span class="op" id="4898546">)</span>&nbsp;<span class="op" id="4898548">==</span>&nbsp;<span class="num" id="4898551">0</span>&nbsp;<span class="op" id="4898553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898557">x3</span><span class="op" id="4898559">.</span><span class="ident" id="4898560">Set</span><span class="op" id="4898563">(</span><span class="ident" id="4898564">x1</span><span class="op" id="4898566">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898570">y3</span><span class="op" id="4898572">.</span><span class="ident" id="4898573">Set</span><span class="op" id="4898576">(</span><span class="ident" id="4898577">y1</span><span class="op" id="4898579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898583">z3</span><span class="op" id="4898585">.</span><span class="ident" id="4898586">Set</span><span class="op" id="4898589">(</span><span class="ident" id="4898590">z1</span><span class="op" id="4898592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898596">return</span>&nbsp;<span class="ident" id="4898603">x3</span><span class="op" id="4898605">,</span>&nbsp;<span class="ident" id="4898607">y3</span><span class="op" id="4898609">,</span>&nbsp;<span class="ident" id="4898611">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4898615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898619">z1z1</span>&nbsp;<span class="op" id="4898624">:=</span>&nbsp;<span class="builtinfunc" id="4898627">new</span><span class="op" id="4898630">(</span><span class="ident" id="4898631">big</span><span class="op" id="4898634">.</span><span class="ident" id="4898635">Int</span><span class="op" id="4898638">)</span><span class="op" id="4898639">.</span><span class="ident" id="4898640">Mul</span><span class="op" id="4898643">(</span><span class="ident" id="4898644">z1</span><span class="op" id="4898646">,</span>&nbsp;<span class="ident" id="4898648">z1</span><span class="op" id="4898650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898653">z1z1</span><span class="op" id="4898657">.</span><span class="ident" id="4898658">Mod</span><span class="op" id="4898661">(</span><span class="ident" id="4898662">z1z1</span><span class="op" id="4898666">,</span>&nbsp;<span class="ident" id="4898668">curve</span><span class="op" id="4898673">.</span><span class="ident" id="4898674">P</span><span class="op" id="4898675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898678">z2z2</span>&nbsp;<span class="op" id="4898683">:=</span>&nbsp;<span class="builtinfunc" id="4898686">new</span><span class="op" id="4898689">(</span><span class="ident" id="4898690">big</span><span class="op" id="4898693">.</span><span class="ident" id="4898694">Int</span><span class="op" id="4898697">)</span><span class="op" id="4898698">.</span><span class="ident" id="4898699">Mul</span><span class="op" id="4898702">(</span><span class="ident" id="4898703">z2</span><span class="op" id="4898705">,</span>&nbsp;<span class="ident" id="4898707">z2</span><span class="op" id="4898709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898712">z2z2</span><span class="op" id="4898716">.</span><span class="ident" id="4898717">Mod</span><span class="op" id="4898720">(</span><span class="ident" id="4898721">z2z2</span><span class="op" id="4898725">,</span>&nbsp;<span class="ident" id="4898727">curve</span><span class="op" id="4898732">.</span><span class="ident" id="4898733">P</span><span class="op" id="4898734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898738">u1</span>&nbsp;<span class="op" id="4898741">:=</span>&nbsp;<span class="builtinfunc" id="4898744">new</span><span class="op" id="4898747">(</span><span class="ident" id="4898748">big</span><span class="op" id="4898751">.</span><span class="ident" id="4898752">Int</span><span class="op" id="4898755">)</span><span class="op" id="4898756">.</span><span class="ident" id="4898757">Mul</span><span class="op" id="4898760">(</span><span class="ident" id="4898761">x1</span><span class="op" id="4898763">,</span>&nbsp;<span class="ident" id="4898765">z2z2</span><span class="op" id="4898769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898772">u1</span><span class="op" id="4898774">.</span><span class="ident" id="4898775">Mod</span><span class="op" id="4898778">(</span><span class="ident" id="4898779">u1</span><span class="op" id="4898781">,</span>&nbsp;<span class="ident" id="4898783">curve</span><span class="op" id="4898788">.</span><span class="ident" id="4898789">P</span><span class="op" id="4898790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898793">u2</span>&nbsp;<span class="op" id="4898796">:=</span>&nbsp;<span class="builtinfunc" id="4898799">new</span><span class="op" id="4898802">(</span><span class="ident" id="4898803">big</span><span class="op" id="4898806">.</span><span class="ident" id="4898807">Int</span><span class="op" id="4898810">)</span><span class="op" id="4898811">.</span><span class="ident" id="4898812">Mul</span><span class="op" id="4898815">(</span><span class="ident" id="4898816">x2</span><span class="op" id="4898818">,</span>&nbsp;<span class="ident" id="4898820">z1z1</span><span class="op" id="4898824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898827">u2</span><span class="op" id="4898829">.</span><span class="ident" id="4898830">Mod</span><span class="op" id="4898833">(</span><span class="ident" id="4898834">u2</span><span class="op" id="4898836">,</span>&nbsp;<span class="ident" id="4898838">curve</span><span class="op" id="4898843">.</span><span class="ident" id="4898844">P</span><span class="op" id="4898845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898848">h</span>&nbsp;<span class="op" id="4898850">:=</span>&nbsp;<span class="builtinfunc" id="4898853">new</span><span class="op" id="4898856">(</span><span class="ident" id="4898857">big</span><span class="op" id="4898860">.</span><span class="ident" id="4898861">Int</span><span class="op" id="4898864">)</span><span class="op" id="4898865">.</span><span class="ident" id="4898866">Sub</span><span class="op" id="4898869">(</span><span class="ident" id="4898870">u2</span><span class="op" id="4898872">,</span>&nbsp;<span class="ident" id="4898874">u1</span><span class="op" id="4898876">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898879">xEqual</span>&nbsp;<span class="op" id="4898886">:=</span>&nbsp;<span class="ident" id="4898889">h</span><span class="op" id="4898890">.</span><span class="ident" id="4898891">Sign</span><span class="op" id="4898895">(</span><span class="op" id="4898896">)</span>&nbsp;<span class="op" id="4898898">==</span>&nbsp;<span class="num" id="4898901">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4898904">if</span>&nbsp;<span class="ident" id="4898907">h</span><span class="op" id="4898908">.</span><span class="ident" id="4898909">Sign</span><span class="op" id="4898913">(</span><span class="op" id="4898914">)</span>&nbsp;<span class="op" id="4898916">==</span>&nbsp;<span class="op" id="4898919">-</span><span class="num" id="4898920">1</span>&nbsp;<span class="op" id="4898922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898926">h</span><span class="op" id="4898927">.</span><span class="ident" id="4898928">Add</span><span class="op" id="4898931">(</span><span class="ident" id="4898932">h</span><span class="op" id="4898933">,</span>&nbsp;<span class="ident" id="4898935">curve</span><span class="op" id="4898940">.</span><span class="ident" id="4898941">P</span><span class="op" id="4898942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4898945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898948">i</span>&nbsp;<span class="op" id="4898950">:=</span>&nbsp;<span class="builtinfunc" id="4898953">new</span><span class="op" id="4898956">(</span><span class="ident" id="4898957">big</span><span class="op" id="4898960">.</span><span class="ident" id="4898961">Int</span><span class="op" id="4898964">)</span><span class="op" id="4898965">.</span><span class="ident" id="4898966">Lsh</span><span class="op" id="4898969">(</span><span class="ident" id="4898970">h</span><span class="op" id="4898971">,</span>&nbsp;<span class="num" id="4898973">1</span><span class="op" id="4898974">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898977">i</span><span class="op" id="4898978">.</span><span class="ident" id="4898979">Mul</span><span class="op" id="4898982">(</span><span class="ident" id="4898983">i</span><span class="op" id="4898984">,</span>&nbsp;<span class="ident" id="4898986">i</span><span class="op" id="4898987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4898990">j</span>&nbsp;<span class="op" id="4898992">:=</span>&nbsp;<span class="builtinfunc" id="4898995">new</span><span class="op" id="4898998">(</span><span class="ident" id="4898999">big</span><span class="op" id="4899002">.</span><span class="ident" id="4899003">Int</span><span class="op" id="4899006">)</span><span class="op" id="4899007">.</span><span class="ident" id="4899008">Mul</span><span class="op" id="4899011">(</span><span class="ident" id="4899012">h</span><span class="op" id="4899013">,</span>&nbsp;<span class="ident" id="4899015">i</span><span class="op" id="4899016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899020">s1</span>&nbsp;<span class="op" id="4899023">:=</span>&nbsp;<span class="builtinfunc" id="4899026">new</span><span class="op" id="4899029">(</span><span class="ident" id="4899030">big</span><span class="op" id="4899033">.</span><span class="ident" id="4899034">Int</span><span class="op" id="4899037">)</span><span class="op" id="4899038">.</span><span class="ident" id="4899039">Mul</span><span class="op" id="4899042">(</span><span class="ident" id="4899043">y1</span><span class="op" id="4899045">,</span>&nbsp;<span class="ident" id="4899047">z2</span><span class="op" id="4899049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899052">s1</span><span class="op" id="4899054">.</span><span class="ident" id="4899055">Mul</span><span class="op" id="4899058">(</span><span class="ident" id="4899059">s1</span><span class="op" id="4899061">,</span>&nbsp;<span class="ident" id="4899063">z2z2</span><span class="op" id="4899067">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899070">s1</span><span class="op" id="4899072">.</span><span class="ident" id="4899073">Mod</span><span class="op" id="4899076">(</span><span class="ident" id="4899077">s1</span><span class="op" id="4899079">,</span>&nbsp;<span class="ident" id="4899081">curve</span><span class="op" id="4899086">.</span><span class="ident" id="4899087">P</span><span class="op" id="4899088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899091">s2</span>&nbsp;<span class="op" id="4899094">:=</span>&nbsp;<span class="builtinfunc" id="4899097">new</span><span class="op" id="4899100">(</span><span class="ident" id="4899101">big</span><span class="op" id="4899104">.</span><span class="ident" id="4899105">Int</span><span class="op" id="4899108">)</span><span class="op" id="4899109">.</span><span class="ident" id="4899110">Mul</span><span class="op" id="4899113">(</span><span class="ident" id="4899114">y2</span><span class="op" id="4899116">,</span>&nbsp;<span class="ident" id="4899118">z1</span><span class="op" id="4899120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899123">s2</span><span class="op" id="4899125">.</span><span class="ident" id="4899126">Mul</span><span class="op" id="4899129">(</span><span class="ident" id="4899130">s2</span><span class="op" id="4899132">,</span>&nbsp;<span class="ident" id="4899134">z1z1</span><span class="op" id="4899138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899141">s2</span><span class="op" id="4899143">.</span><span class="ident" id="4899144">Mod</span><span class="op" id="4899147">(</span><span class="ident" id="4899148">s2</span><span class="op" id="4899150">,</span>&nbsp;<span class="ident" id="4899152">curve</span><span class="op" id="4899157">.</span><span class="ident" id="4899158">P</span><span class="op" id="4899159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899162">r</span>&nbsp;<span class="op" id="4899164">:=</span>&nbsp;<span class="builtinfunc" id="4899167">new</span><span class="op" id="4899170">(</span><span class="ident" id="4899171">big</span><span class="op" id="4899174">.</span><span class="ident" id="4899175">Int</span><span class="op" id="4899178">)</span><span class="op" id="4899179">.</span><span class="ident" id="4899180">Sub</span><span class="op" id="4899183">(</span><span class="ident" id="4899184">s2</span><span class="op" id="4899186">,</span>&nbsp;<span class="ident" id="4899188">s1</span><span class="op" id="4899190">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899193">if</span>&nbsp;<span class="ident" id="4899196">r</span><span class="op" id="4899197">.</span><span class="ident" id="4899198">Sign</span><span class="op" id="4899202">(</span><span class="op" id="4899203">)</span>&nbsp;<span class="op" id="4899205">==</span>&nbsp;<span class="op" id="4899208">-</span><span class="num" id="4899209">1</span>&nbsp;<span class="op" id="4899211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899215">r</span><span class="op" id="4899216">.</span><span class="ident" id="4899217">Add</span><span class="op" id="4899220">(</span><span class="ident" id="4899221">r</span><span class="op" id="4899222">,</span>&nbsp;<span class="ident" id="4899224">curve</span><span class="op" id="4899229">.</span><span class="ident" id="4899230">P</span><span class="op" id="4899231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899237">yEqual</span>&nbsp;<span class="op" id="4899244">:=</span>&nbsp;<span class="ident" id="4899247">r</span><span class="op" id="4899248">.</span><span class="ident" id="4899249">Sign</span><span class="op" id="4899253">(</span><span class="op" id="4899254">)</span>&nbsp;<span class="op" id="4899256">==</span>&nbsp;<span class="num" id="4899259">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899262">if</span>&nbsp;<span class="ident" id="4899265">xEqual</span>&nbsp;<span class="op" id="4899272">&amp;&amp;</span>&nbsp;<span class="ident" id="4899275">yEqual</span>&nbsp;<span class="op" id="4899282">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899286">return</span>&nbsp;<span class="ident" id="4899293">curve</span><span class="op" id="4899298">.</span><span class="ident" id="4899299">doubleJacobian</span><span class="op" id="4899313">(</span><span class="ident" id="4899314">x1</span><span class="op" id="4899316">,</span>&nbsp;<span class="ident" id="4899318">y1</span><span class="op" id="4899320">,</span>&nbsp;<span class="ident" id="4899322">z1</span><span class="op" id="4899324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4899327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899330">r</span><span class="op" id="4899331">.</span><span class="ident" id="4899332">Lsh</span><span class="op" id="4899335">(</span><span class="ident" id="4899336">r</span><span class="op" id="4899337">,</span>&nbsp;<span class="num" id="4899339">1</span><span class="op" id="4899340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899343">v</span>&nbsp;<span class="op" id="4899345">:=</span>&nbsp;<span class="builtinfunc" id="4899348">new</span><span class="op" id="4899351">(</span><span class="ident" id="4899352">big</span><span class="op" id="4899355">.</span><span class="ident" id="4899356">Int</span><span class="op" id="4899359">)</span><span class="op" id="4899360">.</span><span class="ident" id="4899361">Mul</span><span class="op" id="4899364">(</span><span class="ident" id="4899365">u1</span><span class="op" id="4899367">,</span>&nbsp;<span class="ident" id="4899369">i</span><span class="op" id="4899370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899374">x3</span><span class="op" id="4899376">.</span><span class="ident" id="4899377">Set</span><span class="op" id="4899380">(</span><span class="ident" id="4899381">r</span><span class="op" id="4899382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899385">x3</span><span class="op" id="4899387">.</span><span class="ident" id="4899388">Mul</span><span class="op" id="4899391">(</span><span class="ident" id="4899392">x3</span><span class="op" id="4899394">,</span>&nbsp;<span class="ident" id="4899396">x3</span><span class="op" id="4899398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899401">x3</span><span class="op" id="4899403">.</span><span class="ident" id="4899404">Sub</span><span class="op" id="4899407">(</span><span class="ident" id="4899408">x3</span><span class="op" id="4899410">,</span>&nbsp;<span class="ident" id="4899412">j</span><span class="op" id="4899413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899416">x3</span><span class="op" id="4899418">.</span><span class="ident" id="4899419">Sub</span><span class="op" id="4899422">(</span><span class="ident" id="4899423">x3</span><span class="op" id="4899425">,</span>&nbsp;<span class="ident" id="4899427">v</span><span class="op" id="4899428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899431">x3</span><span class="op" id="4899433">.</span><span class="ident" id="4899434">Sub</span><span class="op" id="4899437">(</span><span class="ident" id="4899438">x3</span><span class="op" id="4899440">,</span>&nbsp;<span class="ident" id="4899442">v</span><span class="op" id="4899443">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899446">x3</span><span class="op" id="4899448">.</span><span class="ident" id="4899449">Mod</span><span class="op" id="4899452">(</span><span class="ident" id="4899453">x3</span><span class="op" id="4899455">,</span>&nbsp;<span class="ident" id="4899457">curve</span><span class="op" id="4899462">.</span><span class="ident" id="4899463">P</span><span class="op" id="4899464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899468">y3</span><span class="op" id="4899470">.</span><span class="ident" id="4899471">Set</span><span class="op" id="4899474">(</span><span class="ident" id="4899475">r</span><span class="op" id="4899476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899479">v</span><span class="op" id="4899480">.</span><span class="ident" id="4899481">Sub</span><span class="op" id="4899484">(</span><span class="ident" id="4899485">v</span><span class="op" id="4899486">,</span>&nbsp;<span class="ident" id="4899488">x3</span><span class="op" id="4899490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899493">y3</span><span class="op" id="4899495">.</span><span class="ident" id="4899496">Mul</span><span class="op" id="4899499">(</span><span class="ident" id="4899500">y3</span><span class="op" id="4899502">,</span>&nbsp;<span class="ident" id="4899504">v</span><span class="op" id="4899505">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899508">s1</span><span class="op" id="4899510">.</span><span class="ident" id="4899511">Mul</span><span class="op" id="4899514">(</span><span class="ident" id="4899515">s1</span><span class="op" id="4899517">,</span>&nbsp;<span class="ident" id="4899519">j</span><span class="op" id="4899520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899523">s1</span><span class="op" id="4899525">.</span><span class="ident" id="4899526">Lsh</span><span class="op" id="4899529">(</span><span class="ident" id="4899530">s1</span><span class="op" id="4899532">,</span>&nbsp;<span class="num" id="4899534">1</span><span class="op" id="4899535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899538">y3</span><span class="op" id="4899540">.</span><span class="ident" id="4899541">Sub</span><span class="op" id="4899544">(</span><span class="ident" id="4899545">y3</span><span class="op" id="4899547">,</span>&nbsp;<span class="ident" id="4899549">s1</span><span class="op" id="4899551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899554">y3</span><span class="op" id="4899556">.</span><span class="ident" id="4899557">Mod</span><span class="op" id="4899560">(</span><span class="ident" id="4899561">y3</span><span class="op" id="4899563">,</span>&nbsp;<span class="ident" id="4899565">curve</span><span class="op" id="4899570">.</span><span class="ident" id="4899571">P</span><span class="op" id="4899572">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899576">z3</span><span class="op" id="4899578">.</span><span class="ident" id="4899579">Add</span><span class="op" id="4899582">(</span><span class="ident" id="4899583">z1</span><span class="op" id="4899585">,</span>&nbsp;<span class="ident" id="4899587">z2</span><span class="op" id="4899589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899592">z3</span><span class="op" id="4899594">.</span><span class="ident" id="4899595">Mul</span><span class="op" id="4899598">(</span><span class="ident" id="4899599">z3</span><span class="op" id="4899601">,</span>&nbsp;<span class="ident" id="4899603">z3</span><span class="op" id="4899605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899608">z3</span><span class="op" id="4899610">.</span><span class="ident" id="4899611">Sub</span><span class="op" id="4899614">(</span><span class="ident" id="4899615">z3</span><span class="op" id="4899617">,</span>&nbsp;<span class="ident" id="4899619">z1z1</span><span class="op" id="4899623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899626">z3</span><span class="op" id="4899628">.</span><span class="ident" id="4899629">Sub</span><span class="op" id="4899632">(</span><span class="ident" id="4899633">z3</span><span class="op" id="4899635">,</span>&nbsp;<span class="ident" id="4899637">z2z2</span><span class="op" id="4899641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899644">z3</span><span class="op" id="4899646">.</span><span class="ident" id="4899647">Mul</span><span class="op" id="4899650">(</span><span class="ident" id="4899651">z3</span><span class="op" id="4899653">,</span>&nbsp;<span class="ident" id="4899655">h</span><span class="op" id="4899656">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899659">z3</span><span class="op" id="4899661">.</span><span class="ident" id="4899662">Mod</span><span class="op" id="4899665">(</span><span class="ident" id="4899666">z3</span><span class="op" id="4899668">,</span>&nbsp;<span class="ident" id="4899670">curve</span><span class="op" id="4899675">.</span><span class="ident" id="4899676">P</span><span class="op" id="4899677">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899681">return</span>&nbsp;<span class="ident" id="4899688">x3</span><span class="op" id="4899690">,</span>&nbsp;<span class="ident" id="4899692">y3</span><span class="op" id="4899694">,</span>&nbsp;<span class="ident" id="4899696">z3</span><br>
<span class="lineno"></span><span class="op" id="4899699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4899702">func</span>&nbsp;<span class="op" id="4899707">(</span><span class="ident" id="4899708">curve</span>&nbsp;<span class="op" id="4899714">*</span><span class="ident" id="4899715">CurveParams</span><span class="op" id="4899726">)</span>&nbsp;<span class="ident" id="4899728">Double</span><span class="op" id="4899734">(</span><span class="ident" id="4899735">x1</span><span class="op" id="4899737">,</span>&nbsp;<span class="ident" id="4899739">y1</span>&nbsp;<span class="op" id="4899742">*</span><span class="ident" id="4899743">big</span><span class="op" id="4899746">.</span><span class="ident" id="4899747">Int</span><span class="op" id="4899750">)</span>&nbsp;<span class="op" id="4899752">(</span><span class="op" id="4899753">*</span><span class="ident" id="4899754">big</span><span class="op" id="4899757">.</span><span class="ident" id="4899758">Int</span><span class="op" id="4899761">,</span>&nbsp;<span class="op" id="4899763">*</span><span class="ident" id="4899764">big</span><span class="op" id="4899767">.</span><span class="ident" id="4899768">Int</span><span class="op" id="4899771">)</span>&nbsp;<span class="op" id="4899773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4899776">z1</span>&nbsp;<span class="op" id="4899779">:=</span>&nbsp;<span class="ident" id="4899782">zForAffine</span><span class="op" id="4899792">(</span><span class="ident" id="4899793">x1</span><span class="op" id="4899795">,</span>&nbsp;<span class="ident" id="4899797">y1</span><span class="op" id="4899799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4899802">return</span>&nbsp;<span class="ident" id="4899809">curve</span><span class="op" id="4899814">.</span><span class="ident" id="4899815">affineFromJacobian</span><span class="op" id="4899833">(</span><span class="ident" id="4899834">curve</span><span class="op" id="4899839">.</span><span class="ident" id="4899840">doubleJacobian</span><span class="op" id="4899854">(</span><span class="ident" id="4899855">x1</span><span class="op" id="4899857">,</span>&nbsp;<span class="ident" id="4899859">y1</span><span class="op" id="4899861">,</span>&nbsp;<span class="ident" id="4899863">z1</span><span class="op" id="4899865">)</span><span class="op" id="4899866">)</span><br>
<span class="lineno"></span><span class="op" id="4899868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4899871">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4899943">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4899989">func</span>&nbsp;<span class="op" id="4899994">(</span><span class="ident" id="4899995">curve</span>&nbsp;<span class="op" id="4900001">*</span><span class="ident" id="4900002">CurveParams</span><span class="op" id="4900013">)</span>&nbsp;<span class="ident" id="4900015">doubleJacobian</span><span class="op" id="4900029">(</span><span class="ident" id="4900030">x</span><span class="op" id="4900031">,</span>&nbsp;<span class="ident" id="4900033">y</span><span class="op" id="4900034">,</span>&nbsp;<span class="ident" id="4900036">z</span>&nbsp;<span class="op" id="4900038">*</span><span class="ident" id="4900039">big</span><span class="op" id="4900042">.</span><span class="ident" id="4900043">Int</span><span class="op" id="4900046">)</span>&nbsp;<span class="op" id="4900048">(</span><span class="op" id="4900049">*</span><span class="ident" id="4900050">big</span><span class="op" id="4900053">.</span><span class="ident" id="4900054">Int</span><span class="op" id="4900057">,</span>&nbsp;<span class="op" id="4900059">*</span><span class="ident" id="4900060">big</span><span class="op" id="4900063">.</span><span class="ident" id="4900064">Int</span><span class="op" id="4900067">,</span>&nbsp;<span class="op" id="4900069">*</span><span class="ident" id="4900070">big</span><span class="op" id="4900073">.</span><span class="ident" id="4900074">Int</span><span class="op" id="4900077">)</span>&nbsp;<span class="op" id="4900079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4900082">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900171">delta</span>&nbsp;<span class="op" id="4900177">:=</span>&nbsp;<span class="builtinfunc" id="4900180">new</span><span class="op" id="4900183">(</span><span class="ident" id="4900184">big</span><span class="op" id="4900187">.</span><span class="ident" id="4900188">Int</span><span class="op" id="4900191">)</span><span class="op" id="4900192">.</span><span class="ident" id="4900193">Mul</span><span class="op" id="4900196">(</span><span class="ident" id="4900197">z</span><span class="op" id="4900198">,</span>&nbsp;<span class="ident" id="4900200">z</span><span class="op" id="4900201">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900204">delta</span><span class="op" id="4900209">.</span><span class="ident" id="4900210">Mod</span><span class="op" id="4900213">(</span><span class="ident" id="4900214">delta</span><span class="op" id="4900219">,</span>&nbsp;<span class="ident" id="4900221">curve</span><span class="op" id="4900226">.</span><span class="ident" id="4900227">P</span><span class="op" id="4900228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900231">gamma</span>&nbsp;<span class="op" id="4900237">:=</span>&nbsp;<span class="builtinfunc" id="4900240">new</span><span class="op" id="4900243">(</span><span class="ident" id="4900244">big</span><span class="op" id="4900247">.</span><span class="ident" id="4900248">Int</span><span class="op" id="4900251">)</span><span class="op" id="4900252">.</span><span class="ident" id="4900253">Mul</span><span class="op" id="4900256">(</span><span class="ident" id="4900257">y</span><span class="op" id="4900258">,</span>&nbsp;<span class="ident" id="4900260">y</span><span class="op" id="4900261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900264">gamma</span><span class="op" id="4900269">.</span><span class="ident" id="4900270">Mod</span><span class="op" id="4900273">(</span><span class="ident" id="4900274">gamma</span><span class="op" id="4900279">,</span>&nbsp;<span class="ident" id="4900281">curve</span><span class="op" id="4900286">.</span><span class="ident" id="4900287">P</span><span class="op" id="4900288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900291">alpha</span>&nbsp;<span class="op" id="4900297">:=</span>&nbsp;<span class="builtinfunc" id="4900300">new</span><span class="op" id="4900303">(</span><span class="ident" id="4900304">big</span><span class="op" id="4900307">.</span><span class="ident" id="4900308">Int</span><span class="op" id="4900311">)</span><span class="op" id="4900312">.</span><span class="ident" id="4900313">Sub</span><span class="op" id="4900316">(</span><span class="ident" id="4900317">x</span><span class="op" id="4900318">,</span>&nbsp;<span class="ident" id="4900320">delta</span><span class="op" id="4900325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900328">if</span>&nbsp;<span class="ident" id="4900331">alpha</span><span class="op" id="4900336">.</span><span class="ident" id="4900337">Sign</span><span class="op" id="4900341">(</span><span class="op" id="4900342">)</span>&nbsp;<span class="op" id="4900344">==</span>&nbsp;<span class="op" id="4900347">-</span><span class="num" id="4900348">1</span>&nbsp;<span class="op" id="4900350">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900354">alpha</span><span class="op" id="4900359">.</span><span class="ident" id="4900360">Add</span><span class="op" id="4900363">(</span><span class="ident" id="4900364">alpha</span><span class="op" id="4900369">,</span>&nbsp;<span class="ident" id="4900371">curve</span><span class="op" id="4900376">.</span><span class="ident" id="4900377">P</span><span class="op" id="4900378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900384">alpha2</span>&nbsp;<span class="op" id="4900391">:=</span>&nbsp;<span class="builtinfunc" id="4900394">new</span><span class="op" id="4900397">(</span><span class="ident" id="4900398">big</span><span class="op" id="4900401">.</span><span class="ident" id="4900402">Int</span><span class="op" id="4900405">)</span><span class="op" id="4900406">.</span><span class="ident" id="4900407">Add</span><span class="op" id="4900410">(</span><span class="ident" id="4900411">x</span><span class="op" id="4900412">,</span>&nbsp;<span class="ident" id="4900414">delta</span><span class="op" id="4900419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900422">alpha</span><span class="op" id="4900427">.</span><span class="ident" id="4900428">Mul</span><span class="op" id="4900431">(</span><span class="ident" id="4900432">alpha</span><span class="op" id="4900437">,</span>&nbsp;<span class="ident" id="4900439">alpha2</span><span class="op" id="4900445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900448">alpha2</span><span class="op" id="4900454">.</span><span class="ident" id="4900455">Set</span><span class="op" id="4900458">(</span><span class="ident" id="4900459">alpha</span><span class="op" id="4900464">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900467">alpha</span><span class="op" id="4900472">.</span><span class="ident" id="4900473">Lsh</span><span class="op" id="4900476">(</span><span class="ident" id="4900477">alpha</span><span class="op" id="4900482">,</span>&nbsp;<span class="num" id="4900484">1</span><span class="op" id="4900485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900488">alpha</span><span class="op" id="4900493">.</span><span class="ident" id="4900494">Add</span><span class="op" id="4900497">(</span><span class="ident" id="4900498">alpha</span><span class="op" id="4900503">,</span>&nbsp;<span class="ident" id="4900505">alpha2</span><span class="op" id="4900511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900515">beta</span>&nbsp;<span class="op" id="4900520">:=</span>&nbsp;<span class="ident" id="4900523">alpha2</span><span class="op" id="4900529">.</span><span class="ident" id="4900530">Mul</span><span class="op" id="4900533">(</span><span class="ident" id="4900534">x</span><span class="op" id="4900535">,</span>&nbsp;<span class="ident" id="4900537">gamma</span><span class="op" id="4900542">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900546">x3</span>&nbsp;<span class="op" id="4900549">:=</span>&nbsp;<span class="builtinfunc" id="4900552">new</span><span class="op" id="4900555">(</span><span class="ident" id="4900556">big</span><span class="op" id="4900559">.</span><span class="ident" id="4900560">Int</span><span class="op" id="4900563">)</span><span class="op" id="4900564">.</span><span class="ident" id="4900565">Mul</span><span class="op" id="4900568">(</span><span class="ident" id="4900569">alpha</span><span class="op" id="4900574">,</span>&nbsp;<span class="ident" id="4900576">alpha</span><span class="op" id="4900581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900584">beta8</span>&nbsp;<span class="op" id="4900590">:=</span>&nbsp;<span class="builtinfunc" id="4900593">new</span><span class="op" id="4900596">(</span><span class="ident" id="4900597">big</span><span class="op" id="4900600">.</span><span class="ident" id="4900601">Int</span><span class="op" id="4900604">)</span><span class="op" id="4900605">.</span><span class="ident" id="4900606">Lsh</span><span class="op" id="4900609">(</span><span class="ident" id="4900610">beta</span><span class="op" id="4900614">,</span>&nbsp;<span class="num" id="4900616">3</span><span class="op" id="4900617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900620">x3</span><span class="op" id="4900622">.</span><span class="ident" id="4900623">Sub</span><span class="op" id="4900626">(</span><span class="ident" id="4900627">x3</span><span class="op" id="4900629">,</span>&nbsp;<span class="ident" id="4900631">beta8</span><span class="op" id="4900636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900639">for</span>&nbsp;<span class="ident" id="4900643">x3</span><span class="op" id="4900645">.</span><span class="ident" id="4900646">Sign</span><span class="op" id="4900650">(</span><span class="op" id="4900651">)</span>&nbsp;<span class="op" id="4900653">==</span>&nbsp;<span class="op" id="4900656">-</span><span class="num" id="4900657">1</span>&nbsp;<span class="op" id="4900659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900663">x3</span><span class="op" id="4900665">.</span><span class="ident" id="4900666">Add</span><span class="op" id="4900669">(</span><span class="ident" id="4900670">x3</span><span class="op" id="4900672">,</span>&nbsp;<span class="ident" id="4900674">curve</span><span class="op" id="4900679">.</span><span class="ident" id="4900680">P</span><span class="op" id="4900681">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900687">x3</span><span class="op" id="4900689">.</span><span class="ident" id="4900690">Mod</span><span class="op" id="4900693">(</span><span class="ident" id="4900694">x3</span><span class="op" id="4900696">,</span>&nbsp;<span class="ident" id="4900698">curve</span><span class="op" id="4900703">.</span><span class="ident" id="4900704">P</span><span class="op" id="4900705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900709">z3</span>&nbsp;<span class="op" id="4900712">:=</span>&nbsp;<span class="builtinfunc" id="4900715">new</span><span class="op" id="4900718">(</span><span class="ident" id="4900719">big</span><span class="op" id="4900722">.</span><span class="ident" id="4900723">Int</span><span class="op" id="4900726">)</span><span class="op" id="4900727">.</span><span class="ident" id="4900728">Add</span><span class="op" id="4900731">(</span><span class="ident" id="4900732">y</span><span class="op" id="4900733">,</span>&nbsp;<span class="ident" id="4900735">z</span><span class="op" id="4900736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900739">z3</span><span class="op" id="4900741">.</span><span class="ident" id="4900742">Mul</span><span class="op" id="4900745">(</span><span class="ident" id="4900746">z3</span><span class="op" id="4900748">,</span>&nbsp;<span class="ident" id="4900750">z3</span><span class="op" id="4900752">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900755">z3</span><span class="op" id="4900757">.</span><span class="ident" id="4900758">Sub</span><span class="op" id="4900761">(</span><span class="ident" id="4900762">z3</span><span class="op" id="4900764">,</span>&nbsp;<span class="ident" id="4900766">gamma</span><span class="op" id="4900771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900774">if</span>&nbsp;<span class="ident" id="4900777">z3</span><span class="op" id="4900779">.</span><span class="ident" id="4900780">Sign</span><span class="op" id="4900784">(</span><span class="op" id="4900785">)</span>&nbsp;<span class="op" id="4900787">==</span>&nbsp;<span class="op" id="4900790">-</span><span class="num" id="4900791">1</span>&nbsp;<span class="op" id="4900793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900797">z3</span><span class="op" id="4900799">.</span><span class="ident" id="4900800">Add</span><span class="op" id="4900803">(</span><span class="ident" id="4900804">z3</span><span class="op" id="4900806">,</span>&nbsp;<span class="ident" id="4900808">curve</span><span class="op" id="4900813">.</span><span class="ident" id="4900814">P</span><span class="op" id="4900815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900821">z3</span><span class="op" id="4900823">.</span><span class="ident" id="4900824">Sub</span><span class="op" id="4900827">(</span><span class="ident" id="4900828">z3</span><span class="op" id="4900830">,</span>&nbsp;<span class="ident" id="4900832">delta</span><span class="op" id="4900837">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900840">if</span>&nbsp;<span class="ident" id="4900843">z3</span><span class="op" id="4900845">.</span><span class="ident" id="4900846">Sign</span><span class="op" id="4900850">(</span><span class="op" id="4900851">)</span>&nbsp;<span class="op" id="4900853">==</span>&nbsp;<span class="op" id="4900856">-</span><span class="num" id="4900857">1</span>&nbsp;<span class="op" id="4900859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900863">z3</span><span class="op" id="4900865">.</span><span class="ident" id="4900866">Add</span><span class="op" id="4900869">(</span><span class="ident" id="4900870">z3</span><span class="op" id="4900872">,</span>&nbsp;<span class="ident" id="4900874">curve</span><span class="op" id="4900879">.</span><span class="ident" id="4900880">P</span><span class="op" id="4900881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900887">z3</span><span class="op" id="4900889">.</span><span class="ident" id="4900890">Mod</span><span class="op" id="4900893">(</span><span class="ident" id="4900894">z3</span><span class="op" id="4900896">,</span>&nbsp;<span class="ident" id="4900898">curve</span><span class="op" id="4900903">.</span><span class="ident" id="4900904">P</span><span class="op" id="4900905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900909">beta</span><span class="op" id="4900913">.</span><span class="ident" id="4900914">Lsh</span><span class="op" id="4900917">(</span><span class="ident" id="4900918">beta</span><span class="op" id="4900922">,</span>&nbsp;<span class="num" id="4900924">2</span><span class="op" id="4900925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900928">beta</span><span class="op" id="4900932">.</span><span class="ident" id="4900933">Sub</span><span class="op" id="4900936">(</span><span class="ident" id="4900937">beta</span><span class="op" id="4900941">,</span>&nbsp;<span class="ident" id="4900943">x3</span><span class="op" id="4900945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4900948">if</span>&nbsp;<span class="ident" id="4900951">beta</span><span class="op" id="4900955">.</span><span class="ident" id="4900956">Sign</span><span class="op" id="4900960">(</span><span class="op" id="4900961">)</span>&nbsp;<span class="op" id="4900963">==</span>&nbsp;<span class="op" id="4900966">-</span><span class="num" id="4900967">1</span>&nbsp;<span class="op" id="4900969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4900973">beta</span><span class="op" id="4900977">.</span><span class="ident" id="4900978">Add</span><span class="op" id="4900981">(</span><span class="ident" id="4900982">beta</span><span class="op" id="4900986">,</span>&nbsp;<span class="ident" id="4900988">curve</span><span class="op" id="4900993">.</span><span class="ident" id="4900994">P</span><span class="op" id="4900995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4900998">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901001">y3</span>&nbsp;<span class="op" id="4901004">:=</span>&nbsp;<span class="ident" id="4901007">alpha</span><span class="op" id="4901012">.</span><span class="ident" id="4901013">Mul</span><span class="op" id="4901016">(</span><span class="ident" id="4901017">alpha</span><span class="op" id="4901022">,</span>&nbsp;<span class="ident" id="4901024">beta</span><span class="op" id="4901028">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901032">gamma</span><span class="op" id="4901037">.</span><span class="ident" id="4901038">Mul</span><span class="op" id="4901041">(</span><span class="ident" id="4901042">gamma</span><span class="op" id="4901047">,</span>&nbsp;<span class="ident" id="4901049">gamma</span><span class="op" id="4901054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901057">gamma</span><span class="op" id="4901062">.</span><span class="ident" id="4901063">Lsh</span><span class="op" id="4901066">(</span><span class="ident" id="4901067">gamma</span><span class="op" id="4901072">,</span>&nbsp;<span class="num" id="4901074">3</span><span class="op" id="4901075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901078">gamma</span><span class="op" id="4901083">.</span><span class="ident" id="4901084">Mod</span><span class="op" id="4901087">(</span><span class="ident" id="4901088">gamma</span><span class="op" id="4901093">,</span>&nbsp;<span class="ident" id="4901095">curve</span><span class="op" id="4901100">.</span><span class="ident" id="4901101">P</span><span class="op" id="4901102">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901106">y3</span><span class="op" id="4901108">.</span><span class="ident" id="4901109">Sub</span><span class="op" id="4901112">(</span><span class="ident" id="4901113">y3</span><span class="op" id="4901115">,</span>&nbsp;<span class="ident" id="4901117">gamma</span><span class="op" id="4901122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901125">if</span>&nbsp;<span class="ident" id="4901128">y3</span><span class="op" id="4901130">.</span><span class="ident" id="4901131">Sign</span><span class="op" id="4901135">(</span><span class="op" id="4901136">)</span>&nbsp;<span class="op" id="4901138">==</span>&nbsp;<span class="op" id="4901141">-</span><span class="num" id="4901142">1</span>&nbsp;<span class="op" id="4901144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901148">y3</span><span class="op" id="4901150">.</span><span class="ident" id="4901151">Add</span><span class="op" id="4901154">(</span><span class="ident" id="4901155">y3</span><span class="op" id="4901157">,</span>&nbsp;<span class="ident" id="4901159">curve</span><span class="op" id="4901164">.</span><span class="ident" id="4901165">P</span><span class="op" id="4901166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4901169">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901172">y3</span><span class="op" id="4901174">.</span><span class="ident" id="4901175">Mod</span><span class="op" id="4901178">(</span><span class="ident" id="4901179">y3</span><span class="op" id="4901181">,</span>&nbsp;<span class="ident" id="4901183">curve</span><span class="op" id="4901188">.</span><span class="ident" id="4901189">P</span><span class="op" id="4901190">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901194">return</span>&nbsp;<span class="ident" id="4901201">x3</span><span class="op" id="4901203">,</span>&nbsp;<span class="ident" id="4901205">y3</span><span class="op" id="4901207">,</span>&nbsp;<span class="ident" id="4901209">z3</span><br>
<span class="lineno"></span><span class="op" id="4901212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4901215">func</span>&nbsp;<span class="op" id="4901220">(</span><span class="ident" id="4901221">curve</span>&nbsp;<span class="op" id="4901227">*</span><span class="ident" id="4901228">CurveParams</span><span class="op" id="4901239">)</span>&nbsp;<span class="ident" id="4901241">ScalarMult</span><span class="op" id="4901251">(</span><span class="ident" id="4901252">Bx</span><span class="op" id="4901254">,</span>&nbsp;<span class="ident" id="4901256">By</span>&nbsp;<span class="op" id="4901259">*</span><span class="ident" id="4901260">big</span><span class="op" id="4901263">.</span><span class="ident" id="4901264">Int</span><span class="op" id="4901267">,</span>&nbsp;<span class="ident" id="4901269">k</span>&nbsp;<span class="op" id="4901271">[</span><span class="op" id="4901272">]</span><span class="builtintype" id="4901273">byte</span><span class="op" id="4901277">)</span>&nbsp;<span class="op" id="4901279">(</span><span class="op" id="4901280">*</span><span class="ident" id="4901281">big</span><span class="op" id="4901284">.</span><span class="ident" id="4901285">Int</span><span class="op" id="4901288">,</span>&nbsp;<span class="op" id="4901290">*</span><span class="ident" id="4901291">big</span><span class="op" id="4901294">.</span><span class="ident" id="4901295">Int</span><span class="op" id="4901298">)</span>&nbsp;<span class="op" id="4901300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901303">Bz</span>&nbsp;<span class="op" id="4901306">:=</span>&nbsp;<span class="builtinfunc" id="4901309">new</span><span class="op" id="4901312">(</span><span class="ident" id="4901313">big</span><span class="op" id="4901316">.</span><span class="ident" id="4901317">Int</span><span class="op" id="4901320">)</span><span class="op" id="4901321">.</span><span class="ident" id="4901322">SetInt64</span><span class="op" id="4901330">(</span><span class="num" id="4901331">1</span><span class="op" id="4901332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901335">x</span><span class="op" id="4901336">,</span>&nbsp;<span class="ident" id="4901338">y</span><span class="op" id="4901339">,</span>&nbsp;<span class="ident" id="4901341">z</span>&nbsp;<span class="op" id="4901343">:=</span>&nbsp;<span class="builtinfunc" id="4901346">new</span><span class="op" id="4901349">(</span><span class="ident" id="4901350">big</span><span class="op" id="4901353">.</span><span class="ident" id="4901354">Int</span><span class="op" id="4901357">)</span><span class="op" id="4901358">,</span>&nbsp;<span class="builtinfunc" id="4901360">new</span><span class="op" id="4901363">(</span><span class="ident" id="4901364">big</span><span class="op" id="4901367">.</span><span class="ident" id="4901368">Int</span><span class="op" id="4901371">)</span><span class="op" id="4901372">,</span>&nbsp;<span class="builtinfunc" id="4901374">new</span><span class="op" id="4901377">(</span><span class="ident" id="4901378">big</span><span class="op" id="4901381">.</span><span class="ident" id="4901382">Int</span><span class="op" id="4901385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901389">for</span>&nbsp;<span class="ident" id="4901393">_</span><span class="op" id="4901394">,</span>&nbsp;<span class="builtintype" id="4901396">byte</span>&nbsp;<span class="op" id="4901401">:=</span>&nbsp;<span class="keyword" id="4901404">range</span>&nbsp;<span class="ident" id="4901410">k</span>&nbsp;<span class="op" id="4901412">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901416">for</span>&nbsp;<span class="ident" id="4901420">bitNum</span>&nbsp;<span class="op" id="4901427">:=</span>&nbsp;<span class="num" id="4901430">0</span><span class="op" id="4901431">;</span>&nbsp;<span class="ident" id="4901433">bitNum</span>&nbsp;<span class="op" id="4901440">&lt;</span>&nbsp;<span class="num" id="4901442">8</span><span class="op" id="4901443">;</span>&nbsp;<span class="ident" id="4901445">bitNum</span><span class="op" id="4901451">++</span>&nbsp;<span class="op" id="4901454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901459">x</span><span class="op" id="4901460">,</span>&nbsp;<span class="ident" id="4901462">y</span><span class="op" id="4901463">,</span>&nbsp;<span class="ident" id="4901465">z</span>&nbsp;<span class="op" id="4901467">=</span>&nbsp;<span class="ident" id="4901469">curve</span><span class="op" id="4901474">.</span><span class="ident" id="4901475">doubleJacobian</span><span class="op" id="4901489">(</span><span class="ident" id="4901490">x</span><span class="op" id="4901491">,</span>&nbsp;<span class="ident" id="4901493">y</span><span class="op" id="4901494">,</span>&nbsp;<span class="ident" id="4901496">z</span><span class="op" id="4901497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901502">if</span>&nbsp;<span class="builtintype" id="4901505">byte</span><span class="op" id="4901509">&amp;</span><span class="num" id="4901510">0x80</span>&nbsp;<span class="op" id="4901515">==</span>&nbsp;<span class="num" id="4901518">0x80</span>&nbsp;<span class="op" id="4901523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4901529">x</span><span class="op" id="4901530">,</span>&nbsp;<span class="ident" id="4901532">y</span><span class="op" id="4901533">,</span>&nbsp;<span class="ident" id="4901535">z</span>&nbsp;<span class="op" id="4901537">=</span>&nbsp;<span class="ident" id="4901539">curve</span><span class="op" id="4901544">.</span><span class="ident" id="4901545">addJacobian</span><span class="op" id="4901556">(</span><span class="ident" id="4901557">Bx</span><span class="op" id="4901559">,</span>&nbsp;<span class="ident" id="4901561">By</span><span class="op" id="4901563">,</span>&nbsp;<span class="ident" id="4901565">Bz</span><span class="op" id="4901567">,</span>&nbsp;<span class="ident" id="4901569">x</span><span class="op" id="4901570">,</span>&nbsp;<span class="ident" id="4901572">y</span><span class="op" id="4901573">,</span>&nbsp;<span class="ident" id="4901575">z</span><span class="op" id="4901576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4901581">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4901586">byte</span>&nbsp;<span class="op" id="4901591">&lt;&lt;=</span>&nbsp;<span class="num" id="4901595">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4901599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4901602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901606">return</span>&nbsp;<span class="ident" id="4901613">curve</span><span class="op" id="4901618">.</span><span class="ident" id="4901619">affineFromJacobian</span><span class="op" id="4901637">(</span><span class="ident" id="4901638">x</span><span class="op" id="4901639">,</span>&nbsp;<span class="ident" id="4901641">y</span><span class="op" id="4901642">,</span>&nbsp;<span class="ident" id="4901644">z</span><span class="op" id="4901645">)</span><br>
<span class="lineno">265</span><span class="op" id="4901647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4901650">func</span>&nbsp;<span class="op" id="4901655">(</span><span class="ident" id="4901656">curve</span>&nbsp;<span class="op" id="4901662">*</span><span class="ident" id="4901663">CurveParams</span><span class="op" id="4901674">)</span>&nbsp;<span class="ident" id="4901676">ScalarBaseMult</span><span class="op" id="4901690">(</span><span class="ident" id="4901691">k</span>&nbsp;<span class="op" id="4901693">[</span><span class="op" id="4901694">]</span><span class="builtintype" id="4901695">byte</span><span class="op" id="4901699">)</span>&nbsp;<span class="op" id="4901701">(</span><span class="op" id="4901702">*</span><span class="ident" id="4901703">big</span><span class="op" id="4901706">.</span><span class="ident" id="4901707">Int</span><span class="op" id="4901710">,</span>&nbsp;<span class="op" id="4901712">*</span><span class="ident" id="4901713">big</span><span class="op" id="4901716">.</span><span class="ident" id="4901717">Int</span><span class="op" id="4901720">)</span>&nbsp;<span class="op" id="4901722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4901725">return</span>&nbsp;<span class="ident" id="4901732">curve</span><span class="op" id="4901737">.</span><span class="ident" id="4901738">ScalarMult</span><span class="op" id="4901748">(</span><span class="ident" id="4901749">curve</span><span class="op" id="4901754">.</span><span class="ident" id="4901755">Gx</span><span class="op" id="4901757">,</span>&nbsp;<span class="ident" id="4901759">curve</span><span class="op" id="4901764">.</span><span class="ident" id="4901765">Gy</span><span class="op" id="4901767">,</span>&nbsp;<span class="ident" id="4901769">k</span><span class="op" id="4901770">)</span><br>
<span class="lineno"></span><span class="op" id="4901772">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4901775">var</span>&nbsp;<span class="ident" id="4901779">mask</span>&nbsp;<span class="op" id="4901784">=</span>&nbsp;<span class="op" id="4901786">[</span><span class="op" id="4901787">]</span><span class="builtintype" id="4901788">byte</span><span class="op" id="4901792">{</span><span class="num" id="4901793">0xff</span><span class="op" id="4901797">,</span>&nbsp;<span class="num" id="4901799">0x1</span><span class="op" id="4901802">,</span>&nbsp;<span class="num" id="4901804">0x3</span><span class="op" id="4901807">,</span>&nbsp;<span class="num" id="4901809">0x7</span><span class="op" id="4901812">,</span>&nbsp;<span class="num" id="4901814">0xf</span><span class="op" id="4901817">,</span>&nbsp;<span class="num" id="4901819">0x1f</span><span class="op" id="4901823">,</span>&nbsp;<span class="num" id="4901825">0x3f</span><span class="op" id="4901829">,</span>&nbsp;<span class="num" id="4901831">0x7f</span><span class="op" id="4901835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4901838">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4901907">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4901975">func</span>&nbsp;<span class="ident" id="4901980">GenerateKey</span><span class="op" id="4901991">(</span><span class="ident" id="4901992">curve</span>&nbsp;<span class="ident" id="4901998">Curve</span><span class="op" id="4902003">,</span>&nbsp;<span class="ident" id="4902005">rand</span>&nbsp;<span class="ident" id="4902010">io</span><span class="op" id="4902012">.</span><span class="ident" id="4902013">Reader</span><span class="op" id="4902019">)</span>&nbsp;<span class="op" id="4902021">(</span><span class="ident" id="4902022">priv</span>&nbsp;<span class="op" id="4902027">[</span><span class="op" id="4902028">]</span><span class="builtintype" id="4902029">byte</span><span class="op" id="4902033">,</span>&nbsp;<span class="ident" id="4902035">x</span><span class="op" id="4902036">,</span>&nbsp;<span class="ident" id="4902038">y</span>&nbsp;<span class="op" id="4902040">*</span><span class="ident" id="4902041">big</span><span class="op" id="4902044">.</span><span class="ident" id="4902045">Int</span><span class="op" id="4902048">,</span>&nbsp;<span class="ident" id="4902050">err</span>&nbsp;<span class="builtintype" id="4902054">error</span><span class="op" id="4902059">)</span>&nbsp;<span class="op" id="4902061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902064">bitSize</span>&nbsp;<span class="op" id="4902072">:=</span>&nbsp;<span class="ident" id="4902075">curve</span><span class="op" id="4902080">.</span><span class="ident" id="4902081">Params</span><span class="op" id="4902087">(</span><span class="op" id="4902088">)</span><span class="op" id="4902089">.</span><span class="ident" id="4902090">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902099">byteLen</span>&nbsp;<span class="op" id="4902107">:=</span>&nbsp;<span class="op" id="4902110">(</span><span class="ident" id="4902111">bitSize</span>&nbsp;<span class="op" id="4902119">+</span>&nbsp;<span class="num" id="4902121">7</span><span class="op" id="4902122">)</span>&nbsp;<span class="op" id="4902124">&gt;&gt;</span>&nbsp;<span class="num" id="4902127">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902130">priv</span>&nbsp;<span class="op" id="4902135">=</span>&nbsp;<span class="builtinfunc" id="4902137">make</span><span class="op" id="4902141">(</span><span class="op" id="4902142">[</span><span class="op" id="4902143">]</span><span class="builtintype" id="4902144">byte</span><span class="op" id="4902148">,</span>&nbsp;<span class="ident" id="4902150">byteLen</span><span class="op" id="4902157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4902161">for</span>&nbsp;<span class="ident" id="4902165">x</span>&nbsp;<span class="op" id="4902167">==</span>&nbsp;<span class="ident" id="4902170">nil</span>&nbsp;<span class="op" id="4902174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902178">_</span><span class="op" id="4902179">,</span>&nbsp;<span class="ident" id="4902181">err</span>&nbsp;<span class="op" id="4902185">=</span>&nbsp;<span class="ident" id="4902187">io</span><span class="op" id="4902189">.</span><span class="ident" id="4902190">ReadFull</span><span class="op" id="4902198">(</span><span class="ident" id="4902199">rand</span><span class="op" id="4902203">,</span>&nbsp;<span class="ident" id="4902205">priv</span><span class="op" id="4902209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4902213">if</span>&nbsp;<span class="ident" id="4902216">err</span>&nbsp;<span class="op" id="4902220">!=</span>&nbsp;<span class="ident" id="4902223">nil</span>&nbsp;<span class="op" id="4902227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4902232">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4902241">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902245">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902319">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902373">priv</span><span class="op" id="4902377">[</span><span class="num" id="4902378">0</span><span class="op" id="4902379">]</span>&nbsp;<span class="op" id="4902381">&amp;=</span>&nbsp;<span class="ident" id="4902384">mask</span><span class="op" id="4902388">[</span><span class="ident" id="4902389">bitSize</span><span class="op" id="4902396">%</span><span class="num" id="4902397">8</span><span class="op" id="4902398">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902402">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4902474">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902531">priv</span><span class="op" id="4902535">[</span><span class="num" id="4902536">1</span><span class="op" id="4902537">]</span>&nbsp;<span class="op" id="4902539">^=</span>&nbsp;<span class="num" id="4902542">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902549">x</span><span class="op" id="4902550">,</span>&nbsp;<span class="ident" id="4902552">y</span>&nbsp;<span class="op" id="4902554">=</span>&nbsp;<span class="ident" id="4902556">curve</span><span class="op" id="4902561">.</span><span class="ident" id="4902562">ScalarBaseMult</span><span class="op" id="4902576">(</span><span class="ident" id="4902577">priv</span><span class="op" id="4902581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4902584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4902587">return</span><br>
<span class="lineno"></span><span class="op" id="4902594">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4902597">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4902681">func</span>&nbsp;<span class="ident" id="4902686">Marshal</span><span class="op" id="4902693">(</span><span class="ident" id="4902694">curve</span>&nbsp;<span class="ident" id="4902700">Curve</span><span class="op" id="4902705">,</span>&nbsp;<span class="ident" id="4902707">x</span><span class="op" id="4902708">,</span>&nbsp;<span class="ident" id="4902710">y</span>&nbsp;<span class="op" id="4902712">*</span><span class="ident" id="4902713">big</span><span class="op" id="4902716">.</span><span class="ident" id="4902717">Int</span><span class="op" id="4902720">)</span>&nbsp;<span class="op" id="4902722">[</span><span class="op" id="4902723">]</span><span class="builtintype" id="4902724">byte</span>&nbsp;<span class="op" id="4902729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902732">byteLen</span>&nbsp;<span class="op" id="4902740">:=</span>&nbsp;<span class="op" id="4902743">(</span><span class="ident" id="4902744">curve</span><span class="op" id="4902749">.</span><span class="ident" id="4902750">Params</span><span class="op" id="4902756">(</span><span class="op" id="4902757">)</span><span class="op" id="4902758">.</span><span class="ident" id="4902759">BitSize</span>&nbsp;<span class="op" id="4902767">+</span>&nbsp;<span class="num" id="4902769">7</span><span class="op" id="4902770">)</span>&nbsp;<span class="op" id="4902772">&gt;&gt;</span>&nbsp;<span class="num" id="4902775">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902779">ret</span>&nbsp;<span class="op" id="4902783">:=</span>&nbsp;<span class="builtinfunc" id="4902786">make</span><span class="op" id="4902790">(</span><span class="op" id="4902791">[</span><span class="op" id="4902792">]</span><span class="builtintype" id="4902793">byte</span><span class="op" id="4902797">,</span>&nbsp;<span class="num" id="4902799">1</span><span class="op" id="4902800">+</span><span class="num" id="4902801">2</span><span class="op" id="4902802">*</span><span class="ident" id="4902803">byteLen</span><span class="op" id="4902810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902813">ret</span><span class="op" id="4902816">[</span><span class="num" id="4902817">0</span><span class="op" id="4902818">]</span>&nbsp;<span class="op" id="4902820">=</span>&nbsp;<span class="num" id="4902822">4</span>&nbsp;<span class="comment" id="4902824">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902848">xBytes</span>&nbsp;<span class="op" id="4902855">:=</span>&nbsp;<span class="ident" id="4902858">x</span><span class="op" id="4902859">.</span><span class="ident" id="4902860">Bytes</span><span class="op" id="4902865">(</span><span class="op" id="4902866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4902869">copy</span><span class="op" id="4902873">(</span><span class="ident" id="4902874">ret</span><span class="op" id="4902877">[</span><span class="num" id="4902878">1</span><span class="op" id="4902879">+</span><span class="ident" id="4902880">byteLen</span><span class="op" id="4902887">-</span><span class="builtinfunc" id="4902888">len</span><span class="op" id="4902891">(</span><span class="ident" id="4902892">xBytes</span><span class="op" id="4902898">)</span><span class="op" id="4902899">:</span><span class="op" id="4902900">]</span><span class="op" id="4902901">,</span>&nbsp;<span class="ident" id="4902903">xBytes</span><span class="op" id="4902909">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4902912">yBytes</span>&nbsp;<span class="op" id="4902919">:=</span>&nbsp;<span class="ident" id="4902922">y</span><span class="op" id="4902923">.</span><span class="ident" id="4902924">Bytes</span><span class="op" id="4902929">(</span><span class="op" id="4902930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4902933">copy</span><span class="op" id="4902937">(</span><span class="ident" id="4902938">ret</span><span class="op" id="4902941">[</span><span class="num" id="4902942">1</span><span class="op" id="4902943">+</span><span class="num" id="4902944">2</span><span class="op" id="4902945">*</span><span class="ident" id="4902946">byteLen</span><span class="op" id="4902953">-</span><span class="builtinfunc" id="4902954">len</span><span class="op" id="4902957">(</span><span class="ident" id="4902958">yBytes</span><span class="op" id="4902964">)</span><span class="op" id="4902965">:</span><span class="op" id="4902966">]</span><span class="op" id="4902967">,</span>&nbsp;<span class="ident" id="4902969">yBytes</span><span class="op" id="4902975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4902978">return</span>&nbsp;<span class="ident" id="4902985">ret</span><br>
<span class="lineno"></span><span class="op" id="4902989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4902992">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4903084">func</span>&nbsp;<span class="ident" id="4903089">Unmarshal</span><span class="op" id="4903098">(</span><span class="ident" id="4903099">curve</span>&nbsp;<span class="ident" id="4903105">Curve</span><span class="op" id="4903110">,</span>&nbsp;<span class="ident" id="4903112">data</span>&nbsp;<span class="op" id="4903117">[</span><span class="op" id="4903118">]</span><span class="builtintype" id="4903119">byte</span><span class="op" id="4903123">)</span>&nbsp;<span class="op" id="4903125">(</span><span class="ident" id="4903126">x</span><span class="op" id="4903127">,</span>&nbsp;<span class="ident" id="4903129">y</span>&nbsp;<span class="op" id="4903131">*</span><span class="ident" id="4903132">big</span><span class="op" id="4903135">.</span><span class="ident" id="4903136">Int</span><span class="op" id="4903139">)</span>&nbsp;<span class="op" id="4903141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903144">byteLen</span>&nbsp;<span class="op" id="4903152">:=</span>&nbsp;<span class="op" id="4903155">(</span><span class="ident" id="4903156">curve</span><span class="op" id="4903161">.</span><span class="ident" id="4903162">Params</span><span class="op" id="4903168">(</span><span class="op" id="4903169">)</span><span class="op" id="4903170">.</span><span class="ident" id="4903171">BitSize</span>&nbsp;<span class="op" id="4903179">+</span>&nbsp;<span class="num" id="4903181">7</span><span class="op" id="4903182">)</span>&nbsp;<span class="op" id="4903184">&gt;&gt;</span>&nbsp;<span class="num" id="4903187">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903190">if</span>&nbsp;<span class="builtinfunc" id="4903193">len</span><span class="op" id="4903196">(</span><span class="ident" id="4903197">data</span><span class="op" id="4903201">)</span>&nbsp;<span class="op" id="4903203">!=</span>&nbsp;<span class="num" id="4903206">1</span><span class="op" id="4903207">+</span><span class="num" id="4903208">2</span><span class="op" id="4903209">*</span><span class="ident" id="4903210">byteLen</span>&nbsp;<span class="op" id="4903218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903222">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4903230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903233">if</span>&nbsp;<span class="ident" id="4903236">data</span><span class="op" id="4903240">[</span><span class="num" id="4903241">0</span><span class="op" id="4903242">]</span>&nbsp;<span class="op" id="4903244">!=</span>&nbsp;<span class="num" id="4903247">4</span>&nbsp;<span class="op" id="4903249">{</span>&nbsp;<span class="comment" id="4903251">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903274">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4903282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903285">x</span>&nbsp;<span class="op" id="4903287">=</span>&nbsp;<span class="builtinfunc" id="4903289">new</span><span class="op" id="4903292">(</span><span class="ident" id="4903293">big</span><span class="op" id="4903296">.</span><span class="ident" id="4903297">Int</span><span class="op" id="4903300">)</span><span class="op" id="4903301">.</span><span class="ident" id="4903302">SetBytes</span><span class="op" id="4903310">(</span><span class="ident" id="4903311">data</span><span class="op" id="4903315">[</span><span class="num" id="4903316">1</span>&nbsp;<span class="op" id="4903318">:</span>&nbsp;<span class="num" id="4903320">1</span><span class="op" id="4903321">+</span><span class="ident" id="4903322">byteLen</span><span class="op" id="4903329">]</span><span class="op" id="4903330">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903333">y</span>&nbsp;<span class="op" id="4903335">=</span>&nbsp;<span class="builtinfunc" id="4903337">new</span><span class="op" id="4903340">(</span><span class="ident" id="4903341">big</span><span class="op" id="4903344">.</span><span class="ident" id="4903345">Int</span><span class="op" id="4903348">)</span><span class="op" id="4903349">.</span><span class="ident" id="4903350">SetBytes</span><span class="op" id="4903358">(</span><span class="ident" id="4903359">data</span><span class="op" id="4903363">[</span><span class="num" id="4903364">1</span><span class="op" id="4903365">+</span><span class="ident" id="4903366">byteLen</span><span class="op" id="4903373">:</span><span class="op" id="4903374">]</span><span class="op" id="4903375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4903378">return</span><br>
<span class="lineno"></span><span class="op" id="4903385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4903388">var</span>&nbsp;<span class="ident" id="4903392">initonce</span>&nbsp;<span class="ident" id="4903401">sync</span><span class="op" id="4903405">.</span><span class="ident" id="4903406">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4903411">var</span>&nbsp;<span class="ident" id="4903415">p384</span>&nbsp;<span class="op" id="4903420">*</span><span class="ident" id="4903421">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4903433">var</span>&nbsp;<span class="ident" id="4903437">p521</span>&nbsp;<span class="op" id="4903442">*</span><span class="ident" id="4903443">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4903456">func</span>&nbsp;<span class="ident" id="4903461">initAll</span><span class="op" id="4903468">(</span><span class="op" id="4903469">)</span>&nbsp;<span class="op" id="4903471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903474">initP224</span><span class="op" id="4903482">(</span><span class="op" id="4903483">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903486">initP256</span><span class="op" id="4903494">(</span><span class="op" id="4903495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903498">initP384</span><span class="op" id="4903506">(</span><span class="op" id="4903507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903510">initP521</span><span class="op" id="4903518">(</span><span class="op" id="4903519">)</span><br>
<span class="lineno"></span><span class="op" id="4903521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4903524">func</span>&nbsp;<span class="ident" id="4903529">initP384</span><span class="op" id="4903537">(</span><span class="op" id="4903538">)</span>&nbsp;<span class="op" id="4903540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4903543">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903577">p384</span>&nbsp;<span class="op" id="4903582">=</span>&nbsp;<span class="builtinfunc" id="4903584">new</span><span class="op" id="4903587">(</span><span class="ident" id="4903588">CurveParams</span><span class="op" id="4903599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903602">p384</span><span class="op" id="4903606">.</span><span class="ident" id="4903607">P</span><span class="op" id="4903608">,</span>&nbsp;<span class="ident" id="4903610">_</span>&nbsp;<span class="op" id="4903612">=</span>&nbsp;<span class="builtinfunc" id="4903614">new</span><span class="op" id="4903617">(</span><span class="ident" id="4903618">big</span><span class="op" id="4903621">.</span><span class="ident" id="4903622">Int</span><span class="op" id="4903625">)</span><span class="op" id="4903626">.</span><span class="ident" id="4903627">SetString</span><span class="op" id="4903636">(</span><span class="string" id="4903637">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4903755">,</span>&nbsp;<span class="num" id="4903757">10</span><span class="op" id="4903759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903762">p384</span><span class="op" id="4903766">.</span><span class="ident" id="4903767">N</span><span class="op" id="4903768">,</span>&nbsp;<span class="ident" id="4903770">_</span>&nbsp;<span class="op" id="4903772">=</span>&nbsp;<span class="builtinfunc" id="4903774">new</span><span class="op" id="4903777">(</span><span class="ident" id="4903778">big</span><span class="op" id="4903781">.</span><span class="ident" id="4903782">Int</span><span class="op" id="4903785">)</span><span class="op" id="4903786">.</span><span class="ident" id="4903787">SetString</span><span class="op" id="4903796">(</span><span class="string" id="4903797">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4903915">,</span>&nbsp;<span class="num" id="4903917">10</span><span class="op" id="4903919">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4903922">p384</span><span class="op" id="4903926">.</span><span class="ident" id="4903927">B</span><span class="op" id="4903928">,</span>&nbsp;<span class="ident" id="4903930">_</span>&nbsp;<span class="op" id="4903932">=</span>&nbsp;<span class="builtinfunc" id="4903934">new</span><span class="op" id="4903937">(</span><span class="ident" id="4903938">big</span><span class="op" id="4903941">.</span><span class="ident" id="4903942">Int</span><span class="op" id="4903945">)</span><span class="op" id="4903946">.</span><span class="ident" id="4903947">SetString</span><span class="op" id="4903956">(</span><span class="string" id="4903957">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4904055">,</span>&nbsp;<span class="num" id="4904057">16</span><span class="op" id="4904059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904062">p384</span><span class="op" id="4904066">.</span><span class="ident" id="4904067">Gx</span><span class="op" id="4904069">,</span>&nbsp;<span class="ident" id="4904071">_</span>&nbsp;<span class="op" id="4904073">=</span>&nbsp;<span class="builtinfunc" id="4904075">new</span><span class="op" id="4904078">(</span><span class="ident" id="4904079">big</span><span class="op" id="4904082">.</span><span class="ident" id="4904083">Int</span><span class="op" id="4904086">)</span><span class="op" id="4904087">.</span><span class="ident" id="4904088">SetString</span><span class="op" id="4904097">(</span><span class="string" id="4904098">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4904196">,</span>&nbsp;<span class="num" id="4904198">16</span><span class="op" id="4904200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904203">p384</span><span class="op" id="4904207">.</span><span class="ident" id="4904208">Gy</span><span class="op" id="4904210">,</span>&nbsp;<span class="ident" id="4904212">_</span>&nbsp;<span class="op" id="4904214">=</span>&nbsp;<span class="builtinfunc" id="4904216">new</span><span class="op" id="4904219">(</span><span class="ident" id="4904220">big</span><span class="op" id="4904223">.</span><span class="ident" id="4904224">Int</span><span class="op" id="4904227">)</span><span class="op" id="4904228">.</span><span class="ident" id="4904229">SetString</span><span class="op" id="4904238">(</span><span class="string" id="4904239">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4904337">,</span>&nbsp;<span class="num" id="4904339">16</span><span class="op" id="4904341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904344">p384</span><span class="op" id="4904348">.</span><span class="ident" id="4904349">BitSize</span>&nbsp;<span class="op" id="4904357">=</span>&nbsp;<span class="num" id="4904359">384</span><br>
<span class="lineno"></span><span class="op" id="4904363">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4904366">func</span>&nbsp;<span class="ident" id="4904371">initP521</span><span class="op" id="4904379">(</span><span class="op" id="4904380">)</span>&nbsp;<span class="op" id="4904382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4904385">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904419">p521</span>&nbsp;<span class="op" id="4904424">=</span>&nbsp;<span class="builtinfunc" id="4904426">new</span><span class="op" id="4904429">(</span><span class="ident" id="4904430">CurveParams</span><span class="op" id="4904441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904444">p521</span><span class="op" id="4904448">.</span><span class="ident" id="4904449">P</span><span class="op" id="4904450">,</span>&nbsp;<span class="ident" id="4904452">_</span>&nbsp;<span class="op" id="4904454">=</span>&nbsp;<span class="builtinfunc" id="4904456">new</span><span class="op" id="4904459">(</span><span class="ident" id="4904460">big</span><span class="op" id="4904463">.</span><span class="ident" id="4904464">Int</span><span class="op" id="4904467">)</span><span class="op" id="4904468">.</span><span class="ident" id="4904469">SetString</span><span class="op" id="4904478">(</span><span class="string" id="4904479">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4904638">,</span>&nbsp;<span class="num" id="4904640">10</span><span class="op" id="4904642">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904645">p521</span><span class="op" id="4904649">.</span><span class="ident" id="4904650">N</span><span class="op" id="4904651">,</span>&nbsp;<span class="ident" id="4904653">_</span>&nbsp;<span class="op" id="4904655">=</span>&nbsp;<span class="builtinfunc" id="4904657">new</span><span class="op" id="4904660">(</span><span class="ident" id="4904661">big</span><span class="op" id="4904664">.</span><span class="ident" id="4904665">Int</span><span class="op" id="4904668">)</span><span class="op" id="4904669">.</span><span class="ident" id="4904670">SetString</span><span class="op" id="4904679">(</span><span class="string" id="4904680">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4904839">,</span>&nbsp;<span class="num" id="4904841">10</span><span class="op" id="4904843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4904846">p521</span><span class="op" id="4904850">.</span><span class="ident" id="4904851">B</span><span class="op" id="4904852">,</span>&nbsp;<span class="ident" id="4904854">_</span>&nbsp;<span class="op" id="4904856">=</span>&nbsp;<span class="builtinfunc" id="4904858">new</span><span class="op" id="4904861">(</span><span class="ident" id="4904862">big</span><span class="op" id="4904865">.</span><span class="ident" id="4904866">Int</span><span class="op" id="4904869">)</span><span class="op" id="4904870">.</span><span class="ident" id="4904871">SetString</span><span class="op" id="4904880">(</span><span class="string" id="4904881">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4905014">,</span>&nbsp;<span class="num" id="4905016">16</span><span class="op" id="4905018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905021">p521</span><span class="op" id="4905025">.</span><span class="ident" id="4905026">Gx</span><span class="op" id="4905028">,</span>&nbsp;<span class="ident" id="4905030">_</span>&nbsp;<span class="op" id="4905032">=</span>&nbsp;<span class="builtinfunc" id="4905034">new</span><span class="op" id="4905037">(</span><span class="ident" id="4905038">big</span><span class="op" id="4905041">.</span><span class="ident" id="4905042">Int</span><span class="op" id="4905045">)</span><span class="op" id="4905046">.</span><span class="ident" id="4905047">SetString</span><span class="op" id="4905056">(</span><span class="string" id="4905057">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4905189">,</span>&nbsp;<span class="num" id="4905191">16</span><span class="op" id="4905193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905196">p521</span><span class="op" id="4905200">.</span><span class="ident" id="4905201">Gy</span><span class="op" id="4905203">,</span>&nbsp;<span class="ident" id="4905205">_</span>&nbsp;<span class="op" id="4905207">=</span>&nbsp;<span class="builtinfunc" id="4905209">new</span><span class="op" id="4905212">(</span><span class="ident" id="4905213">big</span><span class="op" id="4905216">.</span><span class="ident" id="4905217">Int</span><span class="op" id="4905220">)</span><span class="op" id="4905221">.</span><span class="ident" id="4905222">SetString</span><span class="op" id="4905231">(</span><span class="string" id="4905232">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4905365">,</span>&nbsp;<span class="num" id="4905367">16</span><span class="op" id="4905369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905372">p521</span><span class="op" id="4905376">.</span><span class="ident" id="4905377">BitSize</span>&nbsp;<span class="op" id="4905385">=</span>&nbsp;<span class="num" id="4905387">521</span><br>
<span class="lineno">355</span><span class="op" id="4905391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4905394">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4905473">func</span>&nbsp;<span class="ident" id="4905478">P256</span><span class="op" id="4905482">(</span><span class="op" id="4905483">)</span>&nbsp;<span class="ident" id="4905485">Curve</span>&nbsp;<span class="op" id="4905491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905494">initonce</span><span class="op" id="4905502">.</span><span class="ident" id="4905503">Do</span><span class="op" id="4905505">(</span><span class="ident" id="4905506">initAll</span><span class="op" id="4905513">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905516">return</span>&nbsp;<span class="ident" id="4905523">p256</span><br>
<span class="lineno"></span><span class="op" id="4905528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4905531">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4905610">func</span>&nbsp;<span class="ident" id="4905615">P384</span><span class="op" id="4905619">(</span><span class="op" id="4905620">)</span>&nbsp;<span class="ident" id="4905622">Curve</span>&nbsp;<span class="op" id="4905628">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905631">initonce</span><span class="op" id="4905639">.</span><span class="ident" id="4905640">Do</span><span class="op" id="4905642">(</span><span class="ident" id="4905643">initAll</span><span class="op" id="4905650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905653">return</span>&nbsp;<span class="ident" id="4905660">p384</span><br>
<span class="lineno"></span><span class="op" id="4905665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4905668">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4905747">func</span>&nbsp;<span class="ident" id="4905752">P521</span><span class="op" id="4905756">(</span><span class="op" id="4905757">)</span>&nbsp;<span class="ident" id="4905759">Curve</span>&nbsp;<span class="op" id="4905765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4905768">initonce</span><span class="op" id="4905776">.</span><span class="ident" id="4905777">Do</span><span class="op" id="4905779">(</span><span class="ident" id="4905780">initAll</span><span class="op" id="4905787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4905790">return</span>&nbsp;<span class="ident" id="4905797">p521</span><br>
<span class="lineno"></span><span class="op" id="4905802">}</span>
</div>
</body>
</html>
