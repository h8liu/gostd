<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html" class="current">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2163918">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2163973">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2164027">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2164078">package</span>&nbsp;<span class="ident" id="2164086">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2164092">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2164164">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2164218">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2164270">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2164325">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2164355">//</span><br>
<span class="lineno"></span><span class="comment" id="2164358">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2164414">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2164483">//</span><br>
<span class="lineno"></span><span class="comment" id="2164486">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2164545">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2164601">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2164658">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2164675">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2164731">//</span><br>
<span class="lineno">25</span><span class="comment" id="2164734">//</span><br>
<span class="lineno"></span><span class="comment" id="2164737">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2164761">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2164786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2164817">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2164849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2164892">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2164923">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2164954">//</span><br>
<span class="lineno"></span><span class="comment" id="2164957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2164984">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2164998">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2165032">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2165071">//</span><br>
<span class="lineno"></span><span class="comment" id="2165074">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2165085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2165120">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2165156">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2165222">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2165288">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2165352">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2165394">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2165450">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2165500">//</span><br>
<span class="lineno"></span><span class="comment" id="2165503">//</span><br>
<span class="lineno">50</span><span class="comment" id="2165506">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2165558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2165632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2165652">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2165719">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2165786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2165854">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2165924">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2165985">//</span><br>
<span class="lineno"></span><span class="comment" id="2165988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2166047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2166104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2166159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2166215">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2166271">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2166323">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2166390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2166436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2166485">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2166550">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2166613">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2166673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2166690">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2166733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2166776">//</span><br>
<span class="lineno">75</span><span class="comment" id="2166779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2166825">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2166880">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2166918">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2166935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2166990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2167033">//</span><br>
<span class="lineno"></span><span class="comment" id="2167036">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2167068">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2167132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2167203">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2167264">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2167329">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2167376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2167393">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2167448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2167491">//</span><br>
<span class="lineno"></span><span class="comment" id="2167494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2167509">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2167571">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2167616">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2167658">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2167697">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2167760">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2167775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2167833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2167869">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2167929">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2167966">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2168022">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2168085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2168140">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2168186">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2168232">//</span><br>
<span class="lineno"></span><span class="comment" id="2168235">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2168264">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2168327">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2168390">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2168432">//</span><br>
<span class="lineno"></span><span class="comment" id="2168435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2168460">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2168520">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2168580">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2168618">const</span>&nbsp;<span class="op" id="2168624">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2168627">erx</span>&nbsp;<span class="op" id="2168631">=</span>&nbsp;<span class="num" id="2168633">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2168660">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2168683">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2168742">efx</span>&nbsp;&nbsp;<span class="op" id="2168747">=</span>&nbsp;<span class="num" id="2168749">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2168777">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2168800">efx8</span>&nbsp;<span class="op" id="2168805">=</span>&nbsp;<span class="num" id="2168807">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2168835">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2168858">pp0</span>&nbsp;&nbsp;<span class="op" id="2168863">=</span>&nbsp;<span class="num" id="2168865">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2168893">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2168916">pp1</span>&nbsp;&nbsp;<span class="op" id="2168921">=</span>&nbsp;<span class="op" id="2168923">-</span><span class="num" id="2168924">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2168951">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2168974">pp2</span>&nbsp;&nbsp;<span class="op" id="2168979">=</span>&nbsp;<span class="op" id="2168981">-</span><span class="num" id="2168982">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2169009">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169032">pp3</span>&nbsp;&nbsp;<span class="op" id="2169037">=</span>&nbsp;<span class="op" id="2169039">-</span><span class="num" id="2169040">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2169067">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169090">pp4</span>&nbsp;&nbsp;<span class="op" id="2169095">=</span>&nbsp;<span class="op" id="2169097">-</span><span class="num" id="2169098">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2169125">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169148">qq1</span>&nbsp;&nbsp;<span class="op" id="2169153">=</span>&nbsp;<span class="num" id="2169155">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2169183">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169206">qq2</span>&nbsp;&nbsp;<span class="op" id="2169211">=</span>&nbsp;<span class="num" id="2169213">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2169241">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169264">qq3</span>&nbsp;&nbsp;<span class="op" id="2169269">=</span>&nbsp;<span class="num" id="2169271">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2169299">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169322">qq4</span>&nbsp;&nbsp;<span class="op" id="2169327">=</span>&nbsp;<span class="num" id="2169329">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2169357">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169380">qq5</span>&nbsp;&nbsp;<span class="op" id="2169385">=</span>&nbsp;<span class="op" id="2169387">-</span><span class="num" id="2169388">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2169415">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2169438">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169501">pa0</span>&nbsp;<span class="op" id="2169505">=</span>&nbsp;<span class="op" id="2169507">-</span><span class="num" id="2169508">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2169535">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169558">pa1</span>&nbsp;<span class="op" id="2169562">=</span>&nbsp;<span class="num" id="2169564">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2169592">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169615">pa2</span>&nbsp;<span class="op" id="2169619">=</span>&nbsp;<span class="op" id="2169621">-</span><span class="num" id="2169622">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2169649">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169672">pa3</span>&nbsp;<span class="op" id="2169676">=</span>&nbsp;<span class="num" id="2169678">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2169706">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169729">pa4</span>&nbsp;<span class="op" id="2169733">=</span>&nbsp;<span class="op" id="2169735">-</span><span class="num" id="2169736">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2169763">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169786">pa5</span>&nbsp;<span class="op" id="2169790">=</span>&nbsp;<span class="num" id="2169792">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2169820">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169843">pa6</span>&nbsp;<span class="op" id="2169847">=</span>&nbsp;<span class="op" id="2169849">-</span><span class="num" id="2169850">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2169877">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169900">qa1</span>&nbsp;<span class="op" id="2169904">=</span>&nbsp;<span class="num" id="2169906">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2169934">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2169957">qa2</span>&nbsp;<span class="op" id="2169961">=</span>&nbsp;<span class="num" id="2169963">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2169991">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170014">qa3</span>&nbsp;<span class="op" id="2170018">=</span>&nbsp;<span class="num" id="2170020">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2170048">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170071">qa4</span>&nbsp;<span class="op" id="2170075">=</span>&nbsp;<span class="num" id="2170077">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2170105">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170128">qa5</span>&nbsp;<span class="op" id="2170132">=</span>&nbsp;<span class="num" id="2170134">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2170162">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170185">qa6</span>&nbsp;<span class="op" id="2170189">=</span>&nbsp;<span class="num" id="2170191">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2170219">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2170242">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170304">ra0</span>&nbsp;<span class="op" id="2170308">=</span>&nbsp;<span class="op" id="2170310">-</span><span class="num" id="2170311">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2170338">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170361">ra1</span>&nbsp;<span class="op" id="2170365">=</span>&nbsp;<span class="op" id="2170367">-</span><span class="num" id="2170368">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2170395">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170418">ra2</span>&nbsp;<span class="op" id="2170422">=</span>&nbsp;<span class="op" id="2170424">-</span><span class="num" id="2170425">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2170452">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170475">ra3</span>&nbsp;<span class="op" id="2170479">=</span>&nbsp;<span class="op" id="2170481">-</span><span class="num" id="2170482">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2170509">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170532">ra4</span>&nbsp;<span class="op" id="2170536">=</span>&nbsp;<span class="op" id="2170538">-</span><span class="num" id="2170539">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2170566">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170589">ra5</span>&nbsp;<span class="op" id="2170593">=</span>&nbsp;<span class="op" id="2170595">-</span><span class="num" id="2170596">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2170623">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170646">ra6</span>&nbsp;<span class="op" id="2170650">=</span>&nbsp;<span class="op" id="2170652">-</span><span class="num" id="2170653">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2170680">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170703">ra7</span>&nbsp;<span class="op" id="2170707">=</span>&nbsp;<span class="op" id="2170709">-</span><span class="num" id="2170710">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2170737">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170760">sa1</span>&nbsp;<span class="op" id="2170764">=</span>&nbsp;<span class="num" id="2170766">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2170794">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170817">sa2</span>&nbsp;<span class="op" id="2170821">=</span>&nbsp;<span class="num" id="2170823">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2170851">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170874">sa3</span>&nbsp;<span class="op" id="2170878">=</span>&nbsp;<span class="num" id="2170880">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2170908">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170931">sa4</span>&nbsp;<span class="op" id="2170935">=</span>&nbsp;<span class="num" id="2170937">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2170965">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2170988">sa5</span>&nbsp;<span class="op" id="2170992">=</span>&nbsp;<span class="num" id="2170994">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2171022">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171045">sa6</span>&nbsp;<span class="op" id="2171049">=</span>&nbsp;<span class="num" id="2171051">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2171079">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171102">sa7</span>&nbsp;<span class="op" id="2171106">=</span>&nbsp;<span class="num" id="2171108">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2171136">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171159">sa8</span>&nbsp;<span class="op" id="2171163">=</span>&nbsp;<span class="op" id="2171165">-</span><span class="num" id="2171166">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2171193">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2171216">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171275">rb0</span>&nbsp;<span class="op" id="2171279">=</span>&nbsp;<span class="op" id="2171281">-</span><span class="num" id="2171282">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2171309">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171332">rb1</span>&nbsp;<span class="op" id="2171336">=</span>&nbsp;<span class="op" id="2171338">-</span><span class="num" id="2171339">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2171366">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171389">rb2</span>&nbsp;<span class="op" id="2171393">=</span>&nbsp;<span class="op" id="2171395">-</span><span class="num" id="2171396">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2171423">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171446">rb3</span>&nbsp;<span class="op" id="2171450">=</span>&nbsp;<span class="op" id="2171452">-</span><span class="num" id="2171453">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2171480">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171503">rb4</span>&nbsp;<span class="op" id="2171507">=</span>&nbsp;<span class="op" id="2171509">-</span><span class="num" id="2171510">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2171537">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171560">rb5</span>&nbsp;<span class="op" id="2171564">=</span>&nbsp;<span class="op" id="2171566">-</span><span class="num" id="2171567">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2171594">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171617">rb6</span>&nbsp;<span class="op" id="2171621">=</span>&nbsp;<span class="op" id="2171623">-</span><span class="num" id="2171624">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2171651">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171674">sb1</span>&nbsp;<span class="op" id="2171678">=</span>&nbsp;<span class="num" id="2171680">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2171708">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171731">sb2</span>&nbsp;<span class="op" id="2171735">=</span>&nbsp;<span class="num" id="2171737">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2171765">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171788">sb3</span>&nbsp;<span class="op" id="2171792">=</span>&nbsp;<span class="num" id="2171794">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2171822">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171845">sb4</span>&nbsp;<span class="op" id="2171849">=</span>&nbsp;<span class="num" id="2171851">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2171879">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171902">sb5</span>&nbsp;<span class="op" id="2171906">=</span>&nbsp;<span class="num" id="2171908">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2171936">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2171959">sb6</span>&nbsp;<span class="op" id="2171963">=</span>&nbsp;<span class="num" id="2171965">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2171993">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172016">sb7</span>&nbsp;<span class="op" id="2172020">=</span>&nbsp;<span class="op" id="2172022">-</span><span class="num" id="2172023">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2172050">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2172072">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2172075">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2172115">//</span><br>
<span class="lineno"></span><span class="comment" id="2172118">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2172140">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2172157">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2172175">//&nbsp;&nbsp;&nbsp;&nbsp;Erf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2172193">func</span>&nbsp;<span class="ident" id="2172198">Erf</span><span class="op" id="2172201">(</span><span class="ident" id="2172202">x</span>&nbsp;<span class="builtintype" id="2172204">float64</span><span class="op" id="2172211">)</span>&nbsp;<span class="builtintype" id="2172213">float64</span>&nbsp;<span class="op" id="2172221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172224">const</span>&nbsp;<span class="op" id="2172230">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172234">VeryTiny</span>&nbsp;<span class="op" id="2172243">=</span>&nbsp;<span class="num" id="2172245">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2172268">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172292">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172301">=</span>&nbsp;<span class="num" id="2172303">1.0</span>&nbsp;<span class="op" id="2172307">/</span>&nbsp;<span class="op" id="2172309">(</span><span class="num" id="2172310">1</span>&nbsp;<span class="op" id="2172312">&lt;&lt;</span>&nbsp;<span class="num" id="2172315">28</span><span class="op" id="2172317">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2172326">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2172340">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172358">switch</span>&nbsp;<span class="op" id="2172365">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172368">case</span>&nbsp;<span class="ident" id="2172373">IsNaN</span><span class="op" id="2172378">(</span><span class="ident" id="2172379">x</span><span class="op" id="2172380">)</span><span class="op" id="2172381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172385">return</span>&nbsp;<span class="ident" id="2172392">NaN</span><span class="op" id="2172395">(</span><span class="op" id="2172396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172399">case</span>&nbsp;<span class="ident" id="2172404">IsInf</span><span class="op" id="2172409">(</span><span class="ident" id="2172410">x</span><span class="op" id="2172411">,</span>&nbsp;<span class="num" id="2172413">1</span><span class="op" id="2172414">)</span><span class="op" id="2172415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172419">return</span>&nbsp;<span class="num" id="2172426">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172429">case</span>&nbsp;<span class="ident" id="2172434">IsInf</span><span class="op" id="2172439">(</span><span class="ident" id="2172440">x</span><span class="op" id="2172441">,</span>&nbsp;<span class="op" id="2172443">-</span><span class="num" id="2172444">1</span><span class="op" id="2172445">)</span><span class="op" id="2172446">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172450">return</span>&nbsp;<span class="op" id="2172457">-</span><span class="num" id="2172458">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172464">sign</span>&nbsp;<span class="op" id="2172469">:=</span>&nbsp;<span class="builtintype" id="2172472">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172479">if</span>&nbsp;<span class="ident" id="2172482">x</span>&nbsp;<span class="op" id="2172484">&lt;</span>&nbsp;<span class="num" id="2172486">0</span>&nbsp;<span class="op" id="2172488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172492">x</span>&nbsp;<span class="op" id="2172494">=</span>&nbsp;<span class="op" id="2172496">-</span><span class="ident" id="2172497">x</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172501">sign</span>&nbsp;<span class="op" id="2172506">=</span>&nbsp;<span class="builtintype" id="2172508">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172517">if</span>&nbsp;<span class="ident" id="2172520">x</span>&nbsp;<span class="op" id="2172522">&lt;</span>&nbsp;<span class="num" id="2172524">0.84375</span>&nbsp;<span class="op" id="2172532">{</span>&nbsp;<span class="comment" id="2172534">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172553">var</span>&nbsp;<span class="ident" id="2172557">temp</span>&nbsp;<span class="builtintype" id="2172562">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172572">if</span>&nbsp;<span class="ident" id="2172575">x</span>&nbsp;<span class="op" id="2172577">&lt;</span>&nbsp;<span class="ident" id="2172579">Small</span>&nbsp;<span class="op" id="2172585">{</span>&nbsp;<span class="comment" id="2172587">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172606">if</span>&nbsp;<span class="ident" id="2172609">x</span>&nbsp;<span class="op" id="2172611">&lt;</span>&nbsp;<span class="ident" id="2172613">VeryTiny</span>&nbsp;<span class="op" id="2172622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172628">temp</span>&nbsp;<span class="op" id="2172633">=</span>&nbsp;<span class="num" id="2172635">0.125</span>&nbsp;<span class="op" id="2172641">*</span>&nbsp;<span class="op" id="2172643">(</span><span class="num" id="2172644">8.0</span><span class="op" id="2172647">*</span><span class="ident" id="2172648">x</span>&nbsp;<span class="op" id="2172650">+</span>&nbsp;<span class="ident" id="2172652">efx8</span><span class="op" id="2172656">*</span><span class="ident" id="2172657">x</span><span class="op" id="2172658">)</span>&nbsp;<span class="comment" id="2172660">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172682">}</span>&nbsp;<span class="keyword" id="2172684">else</span>&nbsp;<span class="op" id="2172689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172695">temp</span>&nbsp;<span class="op" id="2172700">=</span>&nbsp;<span class="ident" id="2172702">x</span>&nbsp;<span class="op" id="2172704">+</span>&nbsp;<span class="ident" id="2172706">efx</span><span class="op" id="2172709">*</span><span class="ident" id="2172710">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172715">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172719">}</span>&nbsp;<span class="keyword" id="2172721">else</span>&nbsp;<span class="op" id="2172726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172731">z</span>&nbsp;<span class="op" id="2172733">:=</span>&nbsp;<span class="ident" id="2172736">x</span>&nbsp;<span class="op" id="2172738">*</span>&nbsp;<span class="ident" id="2172740">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172745">r</span>&nbsp;<span class="op" id="2172747">:=</span>&nbsp;<span class="ident" id="2172750">pp0</span>&nbsp;<span class="op" id="2172754">+</span>&nbsp;<span class="ident" id="2172756">z</span><span class="op" id="2172757">*</span><span class="op" id="2172758">(</span><span class="ident" id="2172759">pp1</span><span class="op" id="2172762">+</span><span class="ident" id="2172763">z</span><span class="op" id="2172764">*</span><span class="op" id="2172765">(</span><span class="ident" id="2172766">pp2</span><span class="op" id="2172769">+</span><span class="ident" id="2172770">z</span><span class="op" id="2172771">*</span><span class="op" id="2172772">(</span><span class="ident" id="2172773">pp3</span><span class="op" id="2172776">+</span><span class="ident" id="2172777">z</span><span class="op" id="2172778">*</span><span class="ident" id="2172779">pp4</span><span class="op" id="2172782">)</span><span class="op" id="2172783">)</span><span class="op" id="2172784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172789">s</span>&nbsp;<span class="op" id="2172791">:=</span>&nbsp;<span class="num" id="2172794">1</span>&nbsp;<span class="op" id="2172796">+</span>&nbsp;<span class="ident" id="2172798">z</span><span class="op" id="2172799">*</span><span class="op" id="2172800">(</span><span class="ident" id="2172801">qq1</span><span class="op" id="2172804">+</span><span class="ident" id="2172805">z</span><span class="op" id="2172806">*</span><span class="op" id="2172807">(</span><span class="ident" id="2172808">qq2</span><span class="op" id="2172811">+</span><span class="ident" id="2172812">z</span><span class="op" id="2172813">*</span><span class="op" id="2172814">(</span><span class="ident" id="2172815">qq3</span><span class="op" id="2172818">+</span><span class="ident" id="2172819">z</span><span class="op" id="2172820">*</span><span class="op" id="2172821">(</span><span class="ident" id="2172822">qq4</span><span class="op" id="2172825">+</span><span class="ident" id="2172826">z</span><span class="op" id="2172827">*</span><span class="ident" id="2172828">qq5</span><span class="op" id="2172831">)</span><span class="op" id="2172832">)</span><span class="op" id="2172833">)</span><span class="op" id="2172834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172839">y</span>&nbsp;<span class="op" id="2172841">:=</span>&nbsp;<span class="ident" id="2172844">r</span>&nbsp;<span class="op" id="2172846">/</span>&nbsp;<span class="ident" id="2172848">s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172853">temp</span>&nbsp;<span class="op" id="2172858">=</span>&nbsp;<span class="ident" id="2172860">x</span>&nbsp;<span class="op" id="2172862">+</span>&nbsp;<span class="ident" id="2172864">x</span><span class="op" id="2172865">*</span><span class="ident" id="2172866">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172874">if</span>&nbsp;<span class="ident" id="2172877">sign</span>&nbsp;<span class="op" id="2172882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172887">return</span>&nbsp;<span class="op" id="2172894">-</span><span class="ident" id="2172895">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172902">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172906">return</span>&nbsp;<span class="ident" id="2172913">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2172919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2172922">if</span>&nbsp;<span class="ident" id="2172925">x</span>&nbsp;<span class="op" id="2172927">&lt;</span>&nbsp;<span class="num" id="2172929">1.25</span>&nbsp;<span class="op" id="2172934">{</span>&nbsp;<span class="comment" id="2172936">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172963">s</span>&nbsp;<span class="op" id="2172965">:=</span>&nbsp;<span class="ident" id="2172968">x</span>&nbsp;<span class="op" id="2172970">-</span>&nbsp;<span class="num" id="2172972">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2172976">P</span>&nbsp;<span class="op" id="2172978">:=</span>&nbsp;<span class="ident" id="2172981">pa0</span>&nbsp;<span class="op" id="2172985">+</span>&nbsp;<span class="ident" id="2172987">s</span><span class="op" id="2172988">*</span><span class="op" id="2172989">(</span><span class="ident" id="2172990">pa1</span><span class="op" id="2172993">+</span><span class="ident" id="2172994">s</span><span class="op" id="2172995">*</span><span class="op" id="2172996">(</span><span class="ident" id="2172997">pa2</span><span class="op" id="2173000">+</span><span class="ident" id="2173001">s</span><span class="op" id="2173002">*</span><span class="op" id="2173003">(</span><span class="ident" id="2173004">pa3</span><span class="op" id="2173007">+</span><span class="ident" id="2173008">s</span><span class="op" id="2173009">*</span><span class="op" id="2173010">(</span><span class="ident" id="2173011">pa4</span><span class="op" id="2173014">+</span><span class="ident" id="2173015">s</span><span class="op" id="2173016">*</span><span class="op" id="2173017">(</span><span class="ident" id="2173018">pa5</span><span class="op" id="2173021">+</span><span class="ident" id="2173022">s</span><span class="op" id="2173023">*</span><span class="ident" id="2173024">pa6</span><span class="op" id="2173027">)</span><span class="op" id="2173028">)</span><span class="op" id="2173029">)</span><span class="op" id="2173030">)</span><span class="op" id="2173031">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173035">Q</span>&nbsp;<span class="op" id="2173037">:=</span>&nbsp;<span class="num" id="2173040">1</span>&nbsp;<span class="op" id="2173042">+</span>&nbsp;<span class="ident" id="2173044">s</span><span class="op" id="2173045">*</span><span class="op" id="2173046">(</span><span class="ident" id="2173047">qa1</span><span class="op" id="2173050">+</span><span class="ident" id="2173051">s</span><span class="op" id="2173052">*</span><span class="op" id="2173053">(</span><span class="ident" id="2173054">qa2</span><span class="op" id="2173057">+</span><span class="ident" id="2173058">s</span><span class="op" id="2173059">*</span><span class="op" id="2173060">(</span><span class="ident" id="2173061">qa3</span><span class="op" id="2173064">+</span><span class="ident" id="2173065">s</span><span class="op" id="2173066">*</span><span class="op" id="2173067">(</span><span class="ident" id="2173068">qa4</span><span class="op" id="2173071">+</span><span class="ident" id="2173072">s</span><span class="op" id="2173073">*</span><span class="op" id="2173074">(</span><span class="ident" id="2173075">qa5</span><span class="op" id="2173078">+</span><span class="ident" id="2173079">s</span><span class="op" id="2173080">*</span><span class="ident" id="2173081">qa6</span><span class="op" id="2173084">)</span><span class="op" id="2173085">)</span><span class="op" id="2173086">)</span><span class="op" id="2173087">)</span><span class="op" id="2173088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173092">if</span>&nbsp;<span class="ident" id="2173095">sign</span>&nbsp;<span class="op" id="2173100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173105">return</span>&nbsp;<span class="op" id="2173112">-</span><span class="ident" id="2173113">erx</span>&nbsp;<span class="op" id="2173117">-</span>&nbsp;<span class="ident" id="2173119">P</span><span class="op" id="2173120">/</span><span class="ident" id="2173121">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173129">return</span>&nbsp;<span class="ident" id="2173136">erx</span>&nbsp;<span class="op" id="2173140">+</span>&nbsp;<span class="ident" id="2173142">P</span><span class="op" id="2173143">/</span><span class="ident" id="2173144">Q</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173150">if</span>&nbsp;<span class="ident" id="2173153">x</span>&nbsp;<span class="op" id="2173155">&gt;=</span>&nbsp;<span class="num" id="2173158">6</span>&nbsp;<span class="op" id="2173160">{</span>&nbsp;<span class="comment" id="2173162">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173182">if</span>&nbsp;<span class="ident" id="2173185">sign</span>&nbsp;<span class="op" id="2173190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173195">return</span>&nbsp;<span class="op" id="2173202">-</span><span class="num" id="2173203">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173207">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173211">return</span>&nbsp;<span class="num" id="2173218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173224">s</span>&nbsp;<span class="op" id="2173226">:=</span>&nbsp;<span class="num" id="2173229">1</span>&nbsp;<span class="op" id="2173231">/</span>&nbsp;<span class="op" id="2173233">(</span><span class="ident" id="2173234">x</span>&nbsp;<span class="op" id="2173236">*</span>&nbsp;<span class="ident" id="2173238">x</span><span class="op" id="2173239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173242">var</span>&nbsp;<span class="ident" id="2173246">R</span><span class="op" id="2173247">,</span>&nbsp;<span class="ident" id="2173249">S</span>&nbsp;<span class="builtintype" id="2173251">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173260">if</span>&nbsp;<span class="ident" id="2173263">x</span>&nbsp;<span class="op" id="2173265">&lt;</span>&nbsp;<span class="num" id="2173267">1</span><span class="op" id="2173268">/</span><span class="num" id="2173269">0.35</span>&nbsp;<span class="op" id="2173274">{</span>&nbsp;<span class="comment" id="2173276">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173308">R</span>&nbsp;<span class="op" id="2173310">=</span>&nbsp;<span class="ident" id="2173312">ra0</span>&nbsp;<span class="op" id="2173316">+</span>&nbsp;<span class="ident" id="2173318">s</span><span class="op" id="2173319">*</span><span class="op" id="2173320">(</span><span class="ident" id="2173321">ra1</span><span class="op" id="2173324">+</span><span class="ident" id="2173325">s</span><span class="op" id="2173326">*</span><span class="op" id="2173327">(</span><span class="ident" id="2173328">ra2</span><span class="op" id="2173331">+</span><span class="ident" id="2173332">s</span><span class="op" id="2173333">*</span><span class="op" id="2173334">(</span><span class="ident" id="2173335">ra3</span><span class="op" id="2173338">+</span><span class="ident" id="2173339">s</span><span class="op" id="2173340">*</span><span class="op" id="2173341">(</span><span class="ident" id="2173342">ra4</span><span class="op" id="2173345">+</span><span class="ident" id="2173346">s</span><span class="op" id="2173347">*</span><span class="op" id="2173348">(</span><span class="ident" id="2173349">ra5</span><span class="op" id="2173352">+</span><span class="ident" id="2173353">s</span><span class="op" id="2173354">*</span><span class="op" id="2173355">(</span><span class="ident" id="2173356">ra6</span><span class="op" id="2173359">+</span><span class="ident" id="2173360">s</span><span class="op" id="2173361">*</span><span class="ident" id="2173362">ra7</span><span class="op" id="2173365">)</span><span class="op" id="2173366">)</span><span class="op" id="2173367">)</span><span class="op" id="2173368">)</span><span class="op" id="2173369">)</span><span class="op" id="2173370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173374">S</span>&nbsp;<span class="op" id="2173376">=</span>&nbsp;<span class="num" id="2173378">1</span>&nbsp;<span class="op" id="2173380">+</span>&nbsp;<span class="ident" id="2173382">s</span><span class="op" id="2173383">*</span><span class="op" id="2173384">(</span><span class="ident" id="2173385">sa1</span><span class="op" id="2173388">+</span><span class="ident" id="2173389">s</span><span class="op" id="2173390">*</span><span class="op" id="2173391">(</span><span class="ident" id="2173392">sa2</span><span class="op" id="2173395">+</span><span class="ident" id="2173396">s</span><span class="op" id="2173397">*</span><span class="op" id="2173398">(</span><span class="ident" id="2173399">sa3</span><span class="op" id="2173402">+</span><span class="ident" id="2173403">s</span><span class="op" id="2173404">*</span><span class="op" id="2173405">(</span><span class="ident" id="2173406">sa4</span><span class="op" id="2173409">+</span><span class="ident" id="2173410">s</span><span class="op" id="2173411">*</span><span class="op" id="2173412">(</span><span class="ident" id="2173413">sa5</span><span class="op" id="2173416">+</span><span class="ident" id="2173417">s</span><span class="op" id="2173418">*</span><span class="op" id="2173419">(</span><span class="ident" id="2173420">sa6</span><span class="op" id="2173423">+</span><span class="ident" id="2173424">s</span><span class="op" id="2173425">*</span><span class="op" id="2173426">(</span><span class="ident" id="2173427">sa7</span><span class="op" id="2173430">+</span><span class="ident" id="2173431">s</span><span class="op" id="2173432">*</span><span class="ident" id="2173433">sa8</span><span class="op" id="2173436">)</span><span class="op" id="2173437">)</span><span class="op" id="2173438">)</span><span class="op" id="2173439">)</span><span class="op" id="2173440">)</span><span class="op" id="2173441">)</span><span class="op" id="2173442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173445">}</span>&nbsp;<span class="keyword" id="2173447">else</span>&nbsp;<span class="op" id="2173452">{</span>&nbsp;<span class="comment" id="2173454">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173487">R</span>&nbsp;<span class="op" id="2173489">=</span>&nbsp;<span class="ident" id="2173491">rb0</span>&nbsp;<span class="op" id="2173495">+</span>&nbsp;<span class="ident" id="2173497">s</span><span class="op" id="2173498">*</span><span class="op" id="2173499">(</span><span class="ident" id="2173500">rb1</span><span class="op" id="2173503">+</span><span class="ident" id="2173504">s</span><span class="op" id="2173505">*</span><span class="op" id="2173506">(</span><span class="ident" id="2173507">rb2</span><span class="op" id="2173510">+</span><span class="ident" id="2173511">s</span><span class="op" id="2173512">*</span><span class="op" id="2173513">(</span><span class="ident" id="2173514">rb3</span><span class="op" id="2173517">+</span><span class="ident" id="2173518">s</span><span class="op" id="2173519">*</span><span class="op" id="2173520">(</span><span class="ident" id="2173521">rb4</span><span class="op" id="2173524">+</span><span class="ident" id="2173525">s</span><span class="op" id="2173526">*</span><span class="op" id="2173527">(</span><span class="ident" id="2173528">rb5</span><span class="op" id="2173531">+</span><span class="ident" id="2173532">s</span><span class="op" id="2173533">*</span><span class="ident" id="2173534">rb6</span><span class="op" id="2173537">)</span><span class="op" id="2173538">)</span><span class="op" id="2173539">)</span><span class="op" id="2173540">)</span><span class="op" id="2173541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173545">S</span>&nbsp;<span class="op" id="2173547">=</span>&nbsp;<span class="num" id="2173549">1</span>&nbsp;<span class="op" id="2173551">+</span>&nbsp;<span class="ident" id="2173553">s</span><span class="op" id="2173554">*</span><span class="op" id="2173555">(</span><span class="ident" id="2173556">sb1</span><span class="op" id="2173559">+</span><span class="ident" id="2173560">s</span><span class="op" id="2173561">*</span><span class="op" id="2173562">(</span><span class="ident" id="2173563">sb2</span><span class="op" id="2173566">+</span><span class="ident" id="2173567">s</span><span class="op" id="2173568">*</span><span class="op" id="2173569">(</span><span class="ident" id="2173570">sb3</span><span class="op" id="2173573">+</span><span class="ident" id="2173574">s</span><span class="op" id="2173575">*</span><span class="op" id="2173576">(</span><span class="ident" id="2173577">sb4</span><span class="op" id="2173580">+</span><span class="ident" id="2173581">s</span><span class="op" id="2173582">*</span><span class="op" id="2173583">(</span><span class="ident" id="2173584">sb5</span><span class="op" id="2173587">+</span><span class="ident" id="2173588">s</span><span class="op" id="2173589">*</span><span class="op" id="2173590">(</span><span class="ident" id="2173591">sb6</span><span class="op" id="2173594">+</span><span class="ident" id="2173595">s</span><span class="op" id="2173596">*</span><span class="ident" id="2173597">sb7</span><span class="op" id="2173600">)</span><span class="op" id="2173601">)</span><span class="op" id="2173602">)</span><span class="op" id="2173603">)</span><span class="op" id="2173604">)</span><span class="op" id="2173605">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173611">z</span>&nbsp;<span class="op" id="2173613">:=</span>&nbsp;<span class="ident" id="2173616">Float64frombits</span><span class="op" id="2173631">(</span><span class="ident" id="2173632">Float64bits</span><span class="op" id="2173643">(</span><span class="ident" id="2173644">x</span><span class="op" id="2173645">)</span>&nbsp;<span class="op" id="2173647">&amp;</span>&nbsp;<span class="num" id="2173649">0xffffffff00000000</span><span class="op" id="2173667">)</span>&nbsp;<span class="comment" id="2173669">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173708">r</span>&nbsp;<span class="op" id="2173710">:=</span>&nbsp;<span class="ident" id="2173713">Exp</span><span class="op" id="2173716">(</span><span class="op" id="2173717">-</span><span class="ident" id="2173718">z</span><span class="op" id="2173719">*</span><span class="ident" id="2173720">z</span><span class="op" id="2173721">-</span><span class="num" id="2173722">0.5625</span><span class="op" id="2173728">)</span>&nbsp;<span class="op" id="2173730">*</span>&nbsp;<span class="ident" id="2173732">Exp</span><span class="op" id="2173735">(</span><span class="op" id="2173736">(</span><span class="ident" id="2173737">z</span><span class="op" id="2173738">-</span><span class="ident" id="2173739">x</span><span class="op" id="2173740">)</span><span class="op" id="2173741">*</span><span class="op" id="2173742">(</span><span class="ident" id="2173743">z</span><span class="op" id="2173744">+</span><span class="ident" id="2173745">x</span><span class="op" id="2173746">)</span><span class="op" id="2173747">+</span><span class="ident" id="2173748">R</span><span class="op" id="2173749">/</span><span class="ident" id="2173750">S</span><span class="op" id="2173751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173754">if</span>&nbsp;<span class="ident" id="2173757">sign</span>&nbsp;<span class="op" id="2173762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173766">return</span>&nbsp;<span class="ident" id="2173773">r</span><span class="op" id="2173774">/</span><span class="ident" id="2173775">x</span>&nbsp;<span class="op" id="2173777">-</span>&nbsp;<span class="num" id="2173779">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173785">return</span>&nbsp;<span class="num" id="2173792">1</span>&nbsp;<span class="op" id="2173794">-</span>&nbsp;<span class="ident" id="2173796">r</span><span class="op" id="2173797">/</span><span class="ident" id="2173798">x</span><br>
<span class="lineno"></span><span class="op" id="2173800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2173803">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2173858">//</span><br>
<span class="lineno"></span><span class="comment" id="2173861">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2173883">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2173901">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2173919">//&nbsp;&nbsp;&nbsp;&nbsp;Erfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2173938">func</span>&nbsp;<span class="ident" id="2173943">Erfc</span><span class="op" id="2173947">(</span><span class="ident" id="2173948">x</span>&nbsp;<span class="builtintype" id="2173950">float64</span><span class="op" id="2173957">)</span>&nbsp;<span class="builtintype" id="2173959">float64</span>&nbsp;<span class="op" id="2173967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173970">const</span>&nbsp;<span class="ident" id="2173976">Tiny</span>&nbsp;<span class="op" id="2173981">=</span>&nbsp;<span class="num" id="2173983">1.0</span>&nbsp;<span class="op" id="2173987">/</span>&nbsp;<span class="op" id="2173989">(</span><span class="num" id="2173990">1</span>&nbsp;<span class="op" id="2173992">&lt;&lt;</span>&nbsp;<span class="num" id="2173995">56</span><span class="op" id="2173997">)</span>&nbsp;<span class="comment" id="2173999">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174010">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174028">switch</span>&nbsp;<span class="op" id="2174035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174038">case</span>&nbsp;<span class="ident" id="2174043">IsNaN</span><span class="op" id="2174048">(</span><span class="ident" id="2174049">x</span><span class="op" id="2174050">)</span><span class="op" id="2174051">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174055">return</span>&nbsp;<span class="ident" id="2174062">NaN</span><span class="op" id="2174065">(</span><span class="op" id="2174066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174069">case</span>&nbsp;<span class="ident" id="2174074">IsInf</span><span class="op" id="2174079">(</span><span class="ident" id="2174080">x</span><span class="op" id="2174081">,</span>&nbsp;<span class="num" id="2174083">1</span><span class="op" id="2174084">)</span><span class="op" id="2174085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174089">return</span>&nbsp;<span class="num" id="2174096">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174099">case</span>&nbsp;<span class="ident" id="2174104">IsInf</span><span class="op" id="2174109">(</span><span class="ident" id="2174110">x</span><span class="op" id="2174111">,</span>&nbsp;<span class="op" id="2174113">-</span><span class="num" id="2174114">1</span><span class="op" id="2174115">)</span><span class="op" id="2174116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174120">return</span>&nbsp;<span class="num" id="2174127">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174133">sign</span>&nbsp;<span class="op" id="2174138">:=</span>&nbsp;<span class="builtintype" id="2174141">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174148">if</span>&nbsp;<span class="ident" id="2174151">x</span>&nbsp;<span class="op" id="2174153">&lt;</span>&nbsp;<span class="num" id="2174155">0</span>&nbsp;<span class="op" id="2174157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174161">x</span>&nbsp;<span class="op" id="2174163">=</span>&nbsp;<span class="op" id="2174165">-</span><span class="ident" id="2174166">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174170">sign</span>&nbsp;<span class="op" id="2174175">=</span>&nbsp;<span class="builtintype" id="2174177">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174186">if</span>&nbsp;<span class="ident" id="2174189">x</span>&nbsp;<span class="op" id="2174191">&lt;</span>&nbsp;<span class="num" id="2174193">0.84375</span>&nbsp;<span class="op" id="2174201">{</span>&nbsp;<span class="comment" id="2174203">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174222">var</span>&nbsp;<span class="ident" id="2174226">temp</span>&nbsp;<span class="builtintype" id="2174231">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174241">if</span>&nbsp;<span class="ident" id="2174244">x</span>&nbsp;<span class="op" id="2174246">&lt;</span>&nbsp;<span class="ident" id="2174248">Tiny</span>&nbsp;<span class="op" id="2174253">{</span>&nbsp;<span class="comment" id="2174255">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174274">temp</span>&nbsp;<span class="op" id="2174279">=</span>&nbsp;<span class="ident" id="2174281">x</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174285">}</span>&nbsp;<span class="keyword" id="2174287">else</span>&nbsp;<span class="op" id="2174292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174297">z</span>&nbsp;<span class="op" id="2174299">:=</span>&nbsp;<span class="ident" id="2174302">x</span>&nbsp;<span class="op" id="2174304">*</span>&nbsp;<span class="ident" id="2174306">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174311">r</span>&nbsp;<span class="op" id="2174313">:=</span>&nbsp;<span class="ident" id="2174316">pp0</span>&nbsp;<span class="op" id="2174320">+</span>&nbsp;<span class="ident" id="2174322">z</span><span class="op" id="2174323">*</span><span class="op" id="2174324">(</span><span class="ident" id="2174325">pp1</span><span class="op" id="2174328">+</span><span class="ident" id="2174329">z</span><span class="op" id="2174330">*</span><span class="op" id="2174331">(</span><span class="ident" id="2174332">pp2</span><span class="op" id="2174335">+</span><span class="ident" id="2174336">z</span><span class="op" id="2174337">*</span><span class="op" id="2174338">(</span><span class="ident" id="2174339">pp3</span><span class="op" id="2174342">+</span><span class="ident" id="2174343">z</span><span class="op" id="2174344">*</span><span class="ident" id="2174345">pp4</span><span class="op" id="2174348">)</span><span class="op" id="2174349">)</span><span class="op" id="2174350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174355">s</span>&nbsp;<span class="op" id="2174357">:=</span>&nbsp;<span class="num" id="2174360">1</span>&nbsp;<span class="op" id="2174362">+</span>&nbsp;<span class="ident" id="2174364">z</span><span class="op" id="2174365">*</span><span class="op" id="2174366">(</span><span class="ident" id="2174367">qq1</span><span class="op" id="2174370">+</span><span class="ident" id="2174371">z</span><span class="op" id="2174372">*</span><span class="op" id="2174373">(</span><span class="ident" id="2174374">qq2</span><span class="op" id="2174377">+</span><span class="ident" id="2174378">z</span><span class="op" id="2174379">*</span><span class="op" id="2174380">(</span><span class="ident" id="2174381">qq3</span><span class="op" id="2174384">+</span><span class="ident" id="2174385">z</span><span class="op" id="2174386">*</span><span class="op" id="2174387">(</span><span class="ident" id="2174388">qq4</span><span class="op" id="2174391">+</span><span class="ident" id="2174392">z</span><span class="op" id="2174393">*</span><span class="ident" id="2174394">qq5</span><span class="op" id="2174397">)</span><span class="op" id="2174398">)</span><span class="op" id="2174399">)</span><span class="op" id="2174400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174405">y</span>&nbsp;<span class="op" id="2174407">:=</span>&nbsp;<span class="ident" id="2174410">r</span>&nbsp;<span class="op" id="2174412">/</span>&nbsp;<span class="ident" id="2174414">s</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174419">if</span>&nbsp;<span class="ident" id="2174422">x</span>&nbsp;<span class="op" id="2174424">&lt;</span>&nbsp;<span class="num" id="2174426">0.25</span>&nbsp;<span class="op" id="2174431">{</span>&nbsp;<span class="comment" id="2174433">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174450">temp</span>&nbsp;<span class="op" id="2174455">=</span>&nbsp;<span class="ident" id="2174457">x</span>&nbsp;<span class="op" id="2174459">+</span>&nbsp;<span class="ident" id="2174461">x</span><span class="op" id="2174462">*</span><span class="ident" id="2174463">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174468">}</span>&nbsp;<span class="keyword" id="2174470">else</span>&nbsp;<span class="op" id="2174475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174481">temp</span>&nbsp;<span class="op" id="2174486">=</span>&nbsp;<span class="num" id="2174488">0.5</span>&nbsp;<span class="op" id="2174492">+</span>&nbsp;<span class="op" id="2174494">(</span><span class="ident" id="2174495">x</span><span class="op" id="2174496">*</span><span class="ident" id="2174497">y</span>&nbsp;<span class="op" id="2174499">+</span>&nbsp;<span class="op" id="2174501">(</span><span class="ident" id="2174502">x</span>&nbsp;<span class="op" id="2174504">-</span>&nbsp;<span class="num" id="2174506">0.5</span><span class="op" id="2174509">)</span><span class="op" id="2174510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174515">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174523">if</span>&nbsp;<span class="ident" id="2174526">sign</span>&nbsp;<span class="op" id="2174531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174536">return</span>&nbsp;<span class="num" id="2174543">1</span>&nbsp;<span class="op" id="2174545">+</span>&nbsp;<span class="ident" id="2174547">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174558">return</span>&nbsp;<span class="num" id="2174565">1</span>&nbsp;<span class="op" id="2174567">-</span>&nbsp;<span class="ident" id="2174569">temp</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174578">if</span>&nbsp;<span class="ident" id="2174581">x</span>&nbsp;<span class="op" id="2174583">&lt;</span>&nbsp;<span class="num" id="2174585">1.25</span>&nbsp;<span class="op" id="2174590">{</span>&nbsp;<span class="comment" id="2174592">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174619">s</span>&nbsp;<span class="op" id="2174621">:=</span>&nbsp;<span class="ident" id="2174624">x</span>&nbsp;<span class="op" id="2174626">-</span>&nbsp;<span class="num" id="2174628">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174632">P</span>&nbsp;<span class="op" id="2174634">:=</span>&nbsp;<span class="ident" id="2174637">pa0</span>&nbsp;<span class="op" id="2174641">+</span>&nbsp;<span class="ident" id="2174643">s</span><span class="op" id="2174644">*</span><span class="op" id="2174645">(</span><span class="ident" id="2174646">pa1</span><span class="op" id="2174649">+</span><span class="ident" id="2174650">s</span><span class="op" id="2174651">*</span><span class="op" id="2174652">(</span><span class="ident" id="2174653">pa2</span><span class="op" id="2174656">+</span><span class="ident" id="2174657">s</span><span class="op" id="2174658">*</span><span class="op" id="2174659">(</span><span class="ident" id="2174660">pa3</span><span class="op" id="2174663">+</span><span class="ident" id="2174664">s</span><span class="op" id="2174665">*</span><span class="op" id="2174666">(</span><span class="ident" id="2174667">pa4</span><span class="op" id="2174670">+</span><span class="ident" id="2174671">s</span><span class="op" id="2174672">*</span><span class="op" id="2174673">(</span><span class="ident" id="2174674">pa5</span><span class="op" id="2174677">+</span><span class="ident" id="2174678">s</span><span class="op" id="2174679">*</span><span class="ident" id="2174680">pa6</span><span class="op" id="2174683">)</span><span class="op" id="2174684">)</span><span class="op" id="2174685">)</span><span class="op" id="2174686">)</span><span class="op" id="2174687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174691">Q</span>&nbsp;<span class="op" id="2174693">:=</span>&nbsp;<span class="num" id="2174696">1</span>&nbsp;<span class="op" id="2174698">+</span>&nbsp;<span class="ident" id="2174700">s</span><span class="op" id="2174701">*</span><span class="op" id="2174702">(</span><span class="ident" id="2174703">qa1</span><span class="op" id="2174706">+</span><span class="ident" id="2174707">s</span><span class="op" id="2174708">*</span><span class="op" id="2174709">(</span><span class="ident" id="2174710">qa2</span><span class="op" id="2174713">+</span><span class="ident" id="2174714">s</span><span class="op" id="2174715">*</span><span class="op" id="2174716">(</span><span class="ident" id="2174717">qa3</span><span class="op" id="2174720">+</span><span class="ident" id="2174721">s</span><span class="op" id="2174722">*</span><span class="op" id="2174723">(</span><span class="ident" id="2174724">qa4</span><span class="op" id="2174727">+</span><span class="ident" id="2174728">s</span><span class="op" id="2174729">*</span><span class="op" id="2174730">(</span><span class="ident" id="2174731">qa5</span><span class="op" id="2174734">+</span><span class="ident" id="2174735">s</span><span class="op" id="2174736">*</span><span class="ident" id="2174737">qa6</span><span class="op" id="2174740">)</span><span class="op" id="2174741">)</span><span class="op" id="2174742">)</span><span class="op" id="2174743">)</span><span class="op" id="2174744">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174748">if</span>&nbsp;<span class="ident" id="2174751">sign</span>&nbsp;<span class="op" id="2174756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174761">return</span>&nbsp;<span class="num" id="2174768">1</span>&nbsp;<span class="op" id="2174770">+</span>&nbsp;<span class="ident" id="2174772">erx</span>&nbsp;<span class="op" id="2174776">+</span>&nbsp;<span class="ident" id="2174778">P</span><span class="op" id="2174779">/</span><span class="ident" id="2174780">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174788">return</span>&nbsp;<span class="num" id="2174795">1</span>&nbsp;<span class="op" id="2174797">-</span>&nbsp;<span class="ident" id="2174799">erx</span>&nbsp;<span class="op" id="2174803">-</span>&nbsp;<span class="ident" id="2174805">P</span><span class="op" id="2174806">/</span><span class="ident" id="2174807">Q</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174814">if</span>&nbsp;<span class="ident" id="2174817">x</span>&nbsp;<span class="op" id="2174819">&lt;</span>&nbsp;<span class="num" id="2174821">28</span>&nbsp;<span class="op" id="2174824">{</span>&nbsp;<span class="comment" id="2174826">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174840">s</span>&nbsp;<span class="op" id="2174842">:=</span>&nbsp;<span class="num" id="2174845">1</span>&nbsp;<span class="op" id="2174847">/</span>&nbsp;<span class="op" id="2174849">(</span><span class="ident" id="2174850">x</span>&nbsp;<span class="op" id="2174852">*</span>&nbsp;<span class="ident" id="2174854">x</span><span class="op" id="2174855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174859">var</span>&nbsp;<span class="ident" id="2174863">R</span><span class="op" id="2174864">,</span>&nbsp;<span class="ident" id="2174866">S</span>&nbsp;<span class="builtintype" id="2174868">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174878">if</span>&nbsp;<span class="ident" id="2174881">x</span>&nbsp;<span class="op" id="2174883">&lt;</span>&nbsp;<span class="num" id="2174885">1</span><span class="op" id="2174886">/</span><span class="num" id="2174887">0.35</span>&nbsp;<span class="op" id="2174892">{</span>&nbsp;<span class="comment" id="2174894">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174926">R</span>&nbsp;<span class="op" id="2174928">=</span>&nbsp;<span class="ident" id="2174930">ra0</span>&nbsp;<span class="op" id="2174934">+</span>&nbsp;<span class="ident" id="2174936">s</span><span class="op" id="2174937">*</span><span class="op" id="2174938">(</span><span class="ident" id="2174939">ra1</span><span class="op" id="2174942">+</span><span class="ident" id="2174943">s</span><span class="op" id="2174944">*</span><span class="op" id="2174945">(</span><span class="ident" id="2174946">ra2</span><span class="op" id="2174949">+</span><span class="ident" id="2174950">s</span><span class="op" id="2174951">*</span><span class="op" id="2174952">(</span><span class="ident" id="2174953">ra3</span><span class="op" id="2174956">+</span><span class="ident" id="2174957">s</span><span class="op" id="2174958">*</span><span class="op" id="2174959">(</span><span class="ident" id="2174960">ra4</span><span class="op" id="2174963">+</span><span class="ident" id="2174964">s</span><span class="op" id="2174965">*</span><span class="op" id="2174966">(</span><span class="ident" id="2174967">ra5</span><span class="op" id="2174970">+</span><span class="ident" id="2174971">s</span><span class="op" id="2174972">*</span><span class="op" id="2174973">(</span><span class="ident" id="2174974">ra6</span><span class="op" id="2174977">+</span><span class="ident" id="2174978">s</span><span class="op" id="2174979">*</span><span class="ident" id="2174980">ra7</span><span class="op" id="2174983">)</span><span class="op" id="2174984">)</span><span class="op" id="2174985">)</span><span class="op" id="2174986">)</span><span class="op" id="2174987">)</span><span class="op" id="2174988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174993">S</span>&nbsp;<span class="op" id="2174995">=</span>&nbsp;<span class="num" id="2174997">1</span>&nbsp;<span class="op" id="2174999">+</span>&nbsp;<span class="ident" id="2175001">s</span><span class="op" id="2175002">*</span><span class="op" id="2175003">(</span><span class="ident" id="2175004">sa1</span><span class="op" id="2175007">+</span><span class="ident" id="2175008">s</span><span class="op" id="2175009">*</span><span class="op" id="2175010">(</span><span class="ident" id="2175011">sa2</span><span class="op" id="2175014">+</span><span class="ident" id="2175015">s</span><span class="op" id="2175016">*</span><span class="op" id="2175017">(</span><span class="ident" id="2175018">sa3</span><span class="op" id="2175021">+</span><span class="ident" id="2175022">s</span><span class="op" id="2175023">*</span><span class="op" id="2175024">(</span><span class="ident" id="2175025">sa4</span><span class="op" id="2175028">+</span><span class="ident" id="2175029">s</span><span class="op" id="2175030">*</span><span class="op" id="2175031">(</span><span class="ident" id="2175032">sa5</span><span class="op" id="2175035">+</span><span class="ident" id="2175036">s</span><span class="op" id="2175037">*</span><span class="op" id="2175038">(</span><span class="ident" id="2175039">sa6</span><span class="op" id="2175042">+</span><span class="ident" id="2175043">s</span><span class="op" id="2175044">*</span><span class="op" id="2175045">(</span><span class="ident" id="2175046">sa7</span><span class="op" id="2175049">+</span><span class="ident" id="2175050">s</span><span class="op" id="2175051">*</span><span class="ident" id="2175052">sa8</span><span class="op" id="2175055">)</span><span class="op" id="2175056">)</span><span class="op" id="2175057">)</span><span class="op" id="2175058">)</span><span class="op" id="2175059">)</span><span class="op" id="2175060">)</span><span class="op" id="2175061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175065">}</span>&nbsp;<span class="keyword" id="2175067">else</span>&nbsp;<span class="op" id="2175072">{</span>&nbsp;<span class="comment" id="2175074">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175107">if</span>&nbsp;<span class="ident" id="2175110">sign</span>&nbsp;<span class="op" id="2175115">&amp;&amp;</span>&nbsp;<span class="ident" id="2175118">x</span>&nbsp;<span class="op" id="2175120">&gt;</span>&nbsp;<span class="num" id="2175122">6</span>&nbsp;<span class="op" id="2175124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175130">return</span>&nbsp;<span class="num" id="2175137">2</span>&nbsp;<span class="comment" id="2175139">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175157">R</span>&nbsp;<span class="op" id="2175159">=</span>&nbsp;<span class="ident" id="2175161">rb0</span>&nbsp;<span class="op" id="2175165">+</span>&nbsp;<span class="ident" id="2175167">s</span><span class="op" id="2175168">*</span><span class="op" id="2175169">(</span><span class="ident" id="2175170">rb1</span><span class="op" id="2175173">+</span><span class="ident" id="2175174">s</span><span class="op" id="2175175">*</span><span class="op" id="2175176">(</span><span class="ident" id="2175177">rb2</span><span class="op" id="2175180">+</span><span class="ident" id="2175181">s</span><span class="op" id="2175182">*</span><span class="op" id="2175183">(</span><span class="ident" id="2175184">rb3</span><span class="op" id="2175187">+</span><span class="ident" id="2175188">s</span><span class="op" id="2175189">*</span><span class="op" id="2175190">(</span><span class="ident" id="2175191">rb4</span><span class="op" id="2175194">+</span><span class="ident" id="2175195">s</span><span class="op" id="2175196">*</span><span class="op" id="2175197">(</span><span class="ident" id="2175198">rb5</span><span class="op" id="2175201">+</span><span class="ident" id="2175202">s</span><span class="op" id="2175203">*</span><span class="ident" id="2175204">rb6</span><span class="op" id="2175207">)</span><span class="op" id="2175208">)</span><span class="op" id="2175209">)</span><span class="op" id="2175210">)</span><span class="op" id="2175211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175216">S</span>&nbsp;<span class="op" id="2175218">=</span>&nbsp;<span class="num" id="2175220">1</span>&nbsp;<span class="op" id="2175222">+</span>&nbsp;<span class="ident" id="2175224">s</span><span class="op" id="2175225">*</span><span class="op" id="2175226">(</span><span class="ident" id="2175227">sb1</span><span class="op" id="2175230">+</span><span class="ident" id="2175231">s</span><span class="op" id="2175232">*</span><span class="op" id="2175233">(</span><span class="ident" id="2175234">sb2</span><span class="op" id="2175237">+</span><span class="ident" id="2175238">s</span><span class="op" id="2175239">*</span><span class="op" id="2175240">(</span><span class="ident" id="2175241">sb3</span><span class="op" id="2175244">+</span><span class="ident" id="2175245">s</span><span class="op" id="2175246">*</span><span class="op" id="2175247">(</span><span class="ident" id="2175248">sb4</span><span class="op" id="2175251">+</span><span class="ident" id="2175252">s</span><span class="op" id="2175253">*</span><span class="op" id="2175254">(</span><span class="ident" id="2175255">sb5</span><span class="op" id="2175258">+</span><span class="ident" id="2175259">s</span><span class="op" id="2175260">*</span><span class="op" id="2175261">(</span><span class="ident" id="2175262">sb6</span><span class="op" id="2175265">+</span><span class="ident" id="2175266">s</span><span class="op" id="2175267">*</span><span class="ident" id="2175268">sb7</span><span class="op" id="2175271">)</span><span class="op" id="2175272">)</span><span class="op" id="2175273">)</span><span class="op" id="2175274">)</span><span class="op" id="2175275">)</span><span class="op" id="2175276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175284">z</span>&nbsp;<span class="op" id="2175286">:=</span>&nbsp;<span class="ident" id="2175289">Float64frombits</span><span class="op" id="2175304">(</span><span class="ident" id="2175305">Float64bits</span><span class="op" id="2175316">(</span><span class="ident" id="2175317">x</span><span class="op" id="2175318">)</span>&nbsp;<span class="op" id="2175320">&amp;</span>&nbsp;<span class="num" id="2175322">0xffffffff00000000</span><span class="op" id="2175340">)</span>&nbsp;<span class="comment" id="2175342">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175382">r</span>&nbsp;<span class="op" id="2175384">:=</span>&nbsp;<span class="ident" id="2175387">Exp</span><span class="op" id="2175390">(</span><span class="op" id="2175391">-</span><span class="ident" id="2175392">z</span><span class="op" id="2175393">*</span><span class="ident" id="2175394">z</span><span class="op" id="2175395">-</span><span class="num" id="2175396">0.5625</span><span class="op" id="2175402">)</span>&nbsp;<span class="op" id="2175404">*</span>&nbsp;<span class="ident" id="2175406">Exp</span><span class="op" id="2175409">(</span><span class="op" id="2175410">(</span><span class="ident" id="2175411">z</span><span class="op" id="2175412">-</span><span class="ident" id="2175413">x</span><span class="op" id="2175414">)</span><span class="op" id="2175415">*</span><span class="op" id="2175416">(</span><span class="ident" id="2175417">z</span><span class="op" id="2175418">+</span><span class="ident" id="2175419">x</span><span class="op" id="2175420">)</span><span class="op" id="2175421">+</span><span class="ident" id="2175422">R</span><span class="op" id="2175423">/</span><span class="ident" id="2175424">S</span><span class="op" id="2175425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175429">if</span>&nbsp;<span class="ident" id="2175432">sign</span>&nbsp;<span class="op" id="2175437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175442">return</span>&nbsp;<span class="num" id="2175449">2</span>&nbsp;<span class="op" id="2175451">-</span>&nbsp;<span class="ident" id="2175453">r</span><span class="op" id="2175454">/</span><span class="ident" id="2175455">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175463">return</span>&nbsp;<span class="ident" id="2175470">r</span>&nbsp;<span class="op" id="2175472">/</span>&nbsp;<span class="ident" id="2175474">x</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175480">if</span>&nbsp;<span class="ident" id="2175483">sign</span>&nbsp;<span class="op" id="2175488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175492">return</span>&nbsp;<span class="num" id="2175499">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175505">return</span>&nbsp;<span class="num" id="2175512">0</span><br>
<span class="lineno">335</span><span class="op" id="2175514">}</span>
</div>
</body>
</html>
