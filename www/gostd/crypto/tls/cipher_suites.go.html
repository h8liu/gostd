<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3324040">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3324095">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3324149">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3324200">package</span>&nbsp;<span class="ident" id="3324208">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3324213">import</span>&nbsp;<span class="op" id="3324220">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324223">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324237">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324254">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324268">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324283">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324297">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324312">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3324327">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3324334">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3324337">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="3324416">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="3324480">type</span>&nbsp;<span class="ident" id="3324485">keyAgreement</span>&nbsp;<span class="keyword" id="3324498">interface</span>&nbsp;<span class="op" id="3324508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324511">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324579">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324641">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324714">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324723">generateServerKeyExchange</span><span class="op" id="3324748">(</span><span class="op" id="3324749">*</span><span class="ident" id="3324750">Config</span><span class="op" id="3324756">,</span>&nbsp;<span class="op" id="3324758">*</span><span class="ident" id="3324759">Certificate</span><span class="op" id="3324770">,</span>&nbsp;<span class="op" id="3324772">*</span><span class="ident" id="3324773">clientHelloMsg</span><span class="op" id="3324787">,</span>&nbsp;<span class="op" id="3324789">*</span><span class="ident" id="3324790">serverHelloMsg</span><span class="op" id="3324804">)</span>&nbsp;<span class="op" id="3324806">(</span><span class="op" id="3324807">*</span><span class="ident" id="3324808">serverKeyExchangeMsg</span><span class="op" id="3324828">,</span>&nbsp;<span class="builtintype" id="3324830">error</span><span class="op" id="3324835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3324838">processClientKeyExchange</span><span class="op" id="3324862">(</span><span class="op" id="3324863">*</span><span class="ident" id="3324864">Config</span><span class="op" id="3324870">,</span>&nbsp;<span class="op" id="3324872">*</span><span class="ident" id="3324873">Certificate</span><span class="op" id="3324884">,</span>&nbsp;<span class="op" id="3324886">*</span><span class="ident" id="3324887">clientKeyExchangeMsg</span><span class="op" id="3324907">,</span>&nbsp;<span class="builtintype" id="3324909">uint16</span><span class="op" id="3324915">)</span>&nbsp;<span class="op" id="3324917">(</span><span class="op" id="3324918">[</span><span class="op" id="3324919">]</span><span class="builtintype" id="3324920">byte</span><span class="op" id="3324924">,</span>&nbsp;<span class="builtintype" id="3324926">error</span><span class="op" id="3324931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3324935">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325002">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325065">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325096">processServerKeyExchange</span><span class="op" id="3325120">(</span><span class="op" id="3325121">*</span><span class="ident" id="3325122">Config</span><span class="op" id="3325128">,</span>&nbsp;<span class="op" id="3325130">*</span><span class="ident" id="3325131">clientHelloMsg</span><span class="op" id="3325145">,</span>&nbsp;<span class="op" id="3325147">*</span><span class="ident" id="3325148">serverHelloMsg</span><span class="op" id="3325162">,</span>&nbsp;<span class="op" id="3325164">*</span><span class="ident" id="3325165">x509</span><span class="op" id="3325169">.</span><span class="ident" id="3325170">Certificate</span><span class="op" id="3325181">,</span>&nbsp;<span class="op" id="3325183">*</span><span class="ident" id="3325184">serverKeyExchangeMsg</span><span class="op" id="3325204">)</span>&nbsp;<span class="builtintype" id="3325206">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325213">generateClientKeyExchange</span><span class="op" id="3325238">(</span><span class="op" id="3325239">*</span><span class="ident" id="3325240">Config</span><span class="op" id="3325246">,</span>&nbsp;<span class="op" id="3325248">*</span><span class="ident" id="3325249">clientHelloMsg</span><span class="op" id="3325263">,</span>&nbsp;<span class="op" id="3325265">*</span><span class="ident" id="3325266">x509</span><span class="op" id="3325270">.</span><span class="ident" id="3325271">Certificate</span><span class="op" id="3325282">)</span>&nbsp;<span class="op" id="3325284">(</span><span class="op" id="3325285">[</span><span class="op" id="3325286">]</span><span class="builtintype" id="3325287">byte</span><span class="op" id="3325291">,</span>&nbsp;<span class="op" id="3325293">*</span><span class="ident" id="3325294">clientKeyExchangeMsg</span><span class="op" id="3325314">,</span>&nbsp;<span class="builtintype" id="3325316">error</span><span class="op" id="3325321">)</span><br>
<span class="lineno">35</span><span class="op" id="3325323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3325326">const</span>&nbsp;<span class="op" id="3325332">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325335">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325405">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325477">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325549">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325576">suiteECDHE</span>&nbsp;<span class="op" id="3325587">=</span>&nbsp;<span class="num" id="3325589">1</span>&nbsp;<span class="op" id="3325591">&lt;&lt;</span>&nbsp;<span class="ident" id="3325594">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325600">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325665">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325732">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325802">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325817">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325829">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3325902">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3325939">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="3325950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3325953">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="3326029">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="3326096">type</span>&nbsp;<span class="ident" id="3326101">cipherSuite</span>&nbsp;<span class="keyword" id="3326113">struct</span>&nbsp;<span class="op" id="3326120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326123">id</span>&nbsp;<span class="builtintype" id="3326126">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326134">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326208">keyLen</span>&nbsp;<span class="builtintype" id="3326215">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326220">macLen</span>&nbsp;<span class="builtintype" id="3326227">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326232">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="3326239">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326244">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326251">func</span><span class="op" id="3326255">(</span><span class="ident" id="3326256">version</span>&nbsp;<span class="builtintype" id="3326264">uint16</span><span class="op" id="3326270">)</span>&nbsp;<span class="ident" id="3326272">keyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326286">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326338">flags</span>&nbsp;&nbsp;<span class="builtintype" id="3326345">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326350">cipher</span>&nbsp;<span class="keyword" id="3326357">func</span><span class="op" id="3326361">(</span><span class="ident" id="3326362">key</span><span class="op" id="3326365">,</span>&nbsp;<span class="ident" id="3326367">iv</span>&nbsp;<span class="op" id="3326370">[</span><span class="op" id="3326371">]</span><span class="builtintype" id="3326372">byte</span><span class="op" id="3326376">,</span>&nbsp;<span class="ident" id="3326378">isRead</span>&nbsp;<span class="builtintype" id="3326385">bool</span><span class="op" id="3326389">)</span>&nbsp;<span class="keyword" id="3326391">interface</span><span class="op" id="3326400">{</span><span class="op" id="3326401">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326404">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326411">func</span><span class="op" id="3326415">(</span><span class="ident" id="3326416">version</span>&nbsp;<span class="builtintype" id="3326424">uint16</span><span class="op" id="3326430">,</span>&nbsp;<span class="ident" id="3326432">macKey</span>&nbsp;<span class="op" id="3326439">[</span><span class="op" id="3326440">]</span><span class="builtintype" id="3326441">byte</span><span class="op" id="3326445">)</span>&nbsp;<span class="ident" id="3326447">macFunction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3326460">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3326467">func</span><span class="op" id="3326471">(</span><span class="ident" id="3326472">key</span><span class="op" id="3326475">,</span>&nbsp;<span class="ident" id="3326477">fixedNonce</span>&nbsp;<span class="op" id="3326488">[</span><span class="op" id="3326489">]</span><span class="builtintype" id="3326490">byte</span><span class="op" id="3326494">)</span>&nbsp;<span class="ident" id="3326496">cipher</span><span class="op" id="3326502">.</span><span class="ident" id="3326503">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3326508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3326511">var</span>&nbsp;<span class="ident" id="3326515">cipherSuites</span>&nbsp;<span class="op" id="3326528">=</span>&nbsp;<span class="op" id="3326530">[</span><span class="op" id="3326531">]</span><span class="op" id="3326532">*</span><span class="ident" id="3326533">cipherSuite</span><span class="op" id="3326544">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326547">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3326616">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326678">{</span><span class="ident" id="3326679">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3326716">,</span>&nbsp;<span class="num" id="3326718">16</span><span class="op" id="3326720">,</span>&nbsp;<span class="num" id="3326722">0</span><span class="op" id="3326723">,</span>&nbsp;<span class="num" id="3326725">4</span><span class="op" id="3326726">,</span>&nbsp;<span class="ident" id="3326728">ecdheRSAKA</span><span class="op" id="3326738">,</span>&nbsp;<span class="ident" id="3326740">suiteECDHE</span>&nbsp;<span class="op" id="3326751">|</span>&nbsp;<span class="ident" id="3326753">suiteTLS12</span><span class="op" id="3326763">,</span>&nbsp;<span class="ident" id="3326765">nil</span><span class="op" id="3326768">,</span>&nbsp;<span class="ident" id="3326770">nil</span><span class="op" id="3326773">,</span>&nbsp;<span class="ident" id="3326775">aeadAESGCM</span><span class="op" id="3326785">}</span><span class="op" id="3326786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326789">{</span><span class="ident" id="3326790">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="op" id="3326829">,</span>&nbsp;<span class="num" id="3326831">16</span><span class="op" id="3326833">,</span>&nbsp;<span class="num" id="3326835">0</span><span class="op" id="3326836">,</span>&nbsp;<span class="num" id="3326838">4</span><span class="op" id="3326839">,</span>&nbsp;<span class="ident" id="3326841">ecdheECDSAKA</span><span class="op" id="3326853">,</span>&nbsp;<span class="ident" id="3326855">suiteECDHE</span>&nbsp;<span class="op" id="3326866">|</span>&nbsp;<span class="ident" id="3326868">suiteECDSA</span>&nbsp;<span class="op" id="3326879">|</span>&nbsp;<span class="ident" id="3326881">suiteTLS12</span><span class="op" id="3326891">,</span>&nbsp;<span class="ident" id="3326893">nil</span><span class="op" id="3326896">,</span>&nbsp;<span class="ident" id="3326898">nil</span><span class="op" id="3326901">,</span>&nbsp;<span class="ident" id="3326903">aeadAESGCM</span><span class="op" id="3326913">}</span><span class="op" id="3326914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3326917">{</span><span class="ident" id="3326918">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="op" id="3326948">,</span>&nbsp;<span class="num" id="3326950">16</span><span class="op" id="3326952">,</span>&nbsp;<span class="num" id="3326954">20</span><span class="op" id="3326956">,</span>&nbsp;<span class="num" id="3326958">0</span><span class="op" id="3326959">,</span>&nbsp;<span class="ident" id="3326961">ecdheRSAKA</span><span class="op" id="3326971">,</span>&nbsp;<span class="ident" id="3326973">suiteECDHE</span><span class="op" id="3326983">,</span>&nbsp;<span class="ident" id="3326985">cipherRC4</span><span class="op" id="3326994">,</span>&nbsp;<span class="ident" id="3326996">macSHA1</span><span class="op" id="3327003">,</span>&nbsp;<span class="ident" id="3327005">nil</span><span class="op" id="3327008">}</span><span class="op" id="3327009">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327012">{</span><span class="ident" id="3327013">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span><span class="op" id="3327045">,</span>&nbsp;<span class="num" id="3327047">16</span><span class="op" id="3327049">,</span>&nbsp;<span class="num" id="3327051">20</span><span class="op" id="3327053">,</span>&nbsp;<span class="num" id="3327055">0</span><span class="op" id="3327056">,</span>&nbsp;<span class="ident" id="3327058">ecdheECDSAKA</span><span class="op" id="3327070">,</span>&nbsp;<span class="ident" id="3327072">suiteECDHE</span>&nbsp;<span class="op" id="3327083">|</span>&nbsp;<span class="ident" id="3327085">suiteECDSA</span><span class="op" id="3327095">,</span>&nbsp;<span class="ident" id="3327097">cipherRC4</span><span class="op" id="3327106">,</span>&nbsp;<span class="ident" id="3327108">macSHA1</span><span class="op" id="3327115">,</span>&nbsp;<span class="ident" id="3327117">nil</span><span class="op" id="3327120">}</span><span class="op" id="3327121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327124">{</span><span class="ident" id="3327125">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3327159">,</span>&nbsp;<span class="num" id="3327161">16</span><span class="op" id="3327163">,</span>&nbsp;<span class="num" id="3327165">20</span><span class="op" id="3327167">,</span>&nbsp;<span class="num" id="3327169">16</span><span class="op" id="3327171">,</span>&nbsp;<span class="ident" id="3327173">ecdheRSAKA</span><span class="op" id="3327183">,</span>&nbsp;<span class="ident" id="3327185">suiteECDHE</span><span class="op" id="3327195">,</span>&nbsp;<span class="ident" id="3327197">cipherAES</span><span class="op" id="3327206">,</span>&nbsp;<span class="ident" id="3327208">macSHA1</span><span class="op" id="3327215">,</span>&nbsp;<span class="ident" id="3327217">nil</span><span class="op" id="3327220">}</span><span class="op" id="3327221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327224">{</span><span class="ident" id="3327225">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3327261">,</span>&nbsp;<span class="num" id="3327263">16</span><span class="op" id="3327265">,</span>&nbsp;<span class="num" id="3327267">20</span><span class="op" id="3327269">,</span>&nbsp;<span class="num" id="3327271">16</span><span class="op" id="3327273">,</span>&nbsp;<span class="ident" id="3327275">ecdheECDSAKA</span><span class="op" id="3327287">,</span>&nbsp;<span class="ident" id="3327289">suiteECDHE</span>&nbsp;<span class="op" id="3327300">|</span>&nbsp;<span class="ident" id="3327302">suiteECDSA</span><span class="op" id="3327312">,</span>&nbsp;<span class="ident" id="3327314">cipherAES</span><span class="op" id="3327323">,</span>&nbsp;<span class="ident" id="3327325">macSHA1</span><span class="op" id="3327332">,</span>&nbsp;<span class="ident" id="3327334">nil</span><span class="op" id="3327337">}</span><span class="op" id="3327338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327341">{</span><span class="ident" id="3327342">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3327376">,</span>&nbsp;<span class="num" id="3327378">32</span><span class="op" id="3327380">,</span>&nbsp;<span class="num" id="3327382">20</span><span class="op" id="3327384">,</span>&nbsp;<span class="num" id="3327386">16</span><span class="op" id="3327388">,</span>&nbsp;<span class="ident" id="3327390">ecdheRSAKA</span><span class="op" id="3327400">,</span>&nbsp;<span class="ident" id="3327402">suiteECDHE</span><span class="op" id="3327412">,</span>&nbsp;<span class="ident" id="3327414">cipherAES</span><span class="op" id="3327423">,</span>&nbsp;<span class="ident" id="3327425">macSHA1</span><span class="op" id="3327432">,</span>&nbsp;<span class="ident" id="3327434">nil</span><span class="op" id="3327437">}</span><span class="op" id="3327438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327441">{</span><span class="ident" id="3327442">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3327478">,</span>&nbsp;<span class="num" id="3327480">32</span><span class="op" id="3327482">,</span>&nbsp;<span class="num" id="3327484">20</span><span class="op" id="3327486">,</span>&nbsp;<span class="num" id="3327488">16</span><span class="op" id="3327490">,</span>&nbsp;<span class="ident" id="3327492">ecdheECDSAKA</span><span class="op" id="3327504">,</span>&nbsp;<span class="ident" id="3327506">suiteECDHE</span>&nbsp;<span class="op" id="3327517">|</span>&nbsp;<span class="ident" id="3327519">suiteECDSA</span><span class="op" id="3327529">,</span>&nbsp;<span class="ident" id="3327531">cipherAES</span><span class="op" id="3327540">,</span>&nbsp;<span class="ident" id="3327542">macSHA1</span><span class="op" id="3327549">,</span>&nbsp;<span class="ident" id="3327551">nil</span><span class="op" id="3327554">}</span><span class="op" id="3327555">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327558">{</span><span class="ident" id="3327559">TLS_RSA_WITH_RC4_128_SHA</span><span class="op" id="3327583">,</span>&nbsp;<span class="num" id="3327585">16</span><span class="op" id="3327587">,</span>&nbsp;<span class="num" id="3327589">20</span><span class="op" id="3327591">,</span>&nbsp;<span class="num" id="3327593">0</span><span class="op" id="3327594">,</span>&nbsp;<span class="ident" id="3327596">rsaKA</span><span class="op" id="3327601">,</span>&nbsp;<span class="num" id="3327603">0</span><span class="op" id="3327604">,</span>&nbsp;<span class="ident" id="3327606">cipherRC4</span><span class="op" id="3327615">,</span>&nbsp;<span class="ident" id="3327617">macSHA1</span><span class="op" id="3327624">,</span>&nbsp;<span class="ident" id="3327626">nil</span><span class="op" id="3327629">}</span><span class="op" id="3327630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327633">{</span><span class="ident" id="3327634">TLS_RSA_WITH_AES_128_CBC_SHA</span><span class="op" id="3327662">,</span>&nbsp;<span class="num" id="3327664">16</span><span class="op" id="3327666">,</span>&nbsp;<span class="num" id="3327668">20</span><span class="op" id="3327670">,</span>&nbsp;<span class="num" id="3327672">16</span><span class="op" id="3327674">,</span>&nbsp;<span class="ident" id="3327676">rsaKA</span><span class="op" id="3327681">,</span>&nbsp;<span class="num" id="3327683">0</span><span class="op" id="3327684">,</span>&nbsp;<span class="ident" id="3327686">cipherAES</span><span class="op" id="3327695">,</span>&nbsp;<span class="ident" id="3327697">macSHA1</span><span class="op" id="3327704">,</span>&nbsp;<span class="ident" id="3327706">nil</span><span class="op" id="3327709">}</span><span class="op" id="3327710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327713">{</span><span class="ident" id="3327714">TLS_RSA_WITH_AES_256_CBC_SHA</span><span class="op" id="3327742">,</span>&nbsp;<span class="num" id="3327744">32</span><span class="op" id="3327746">,</span>&nbsp;<span class="num" id="3327748">20</span><span class="op" id="3327750">,</span>&nbsp;<span class="num" id="3327752">16</span><span class="op" id="3327754">,</span>&nbsp;<span class="ident" id="3327756">rsaKA</span><span class="op" id="3327761">,</span>&nbsp;<span class="num" id="3327763">0</span><span class="op" id="3327764">,</span>&nbsp;<span class="ident" id="3327766">cipherAES</span><span class="op" id="3327775">,</span>&nbsp;<span class="ident" id="3327777">macSHA1</span><span class="op" id="3327784">,</span>&nbsp;<span class="ident" id="3327786">nil</span><span class="op" id="3327789">}</span><span class="op" id="3327790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327793">{</span><span class="ident" id="3327794">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3327829">,</span>&nbsp;<span class="num" id="3327831">24</span><span class="op" id="3327833">,</span>&nbsp;<span class="num" id="3327835">20</span><span class="op" id="3327837">,</span>&nbsp;<span class="num" id="3327839">8</span><span class="op" id="3327840">,</span>&nbsp;<span class="ident" id="3327842">ecdheRSAKA</span><span class="op" id="3327852">,</span>&nbsp;<span class="ident" id="3327854">suiteECDHE</span><span class="op" id="3327864">,</span>&nbsp;<span class="ident" id="3327866">cipher3DES</span><span class="op" id="3327876">,</span>&nbsp;<span class="ident" id="3327878">macSHA1</span><span class="op" id="3327885">,</span>&nbsp;<span class="ident" id="3327887">nil</span><span class="op" id="3327890">}</span><span class="op" id="3327891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3327894">{</span><span class="ident" id="3327895">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span><span class="op" id="3327924">,</span>&nbsp;<span class="num" id="3327926">24</span><span class="op" id="3327928">,</span>&nbsp;<span class="num" id="3327930">20</span><span class="op" id="3327932">,</span>&nbsp;<span class="num" id="3327934">8</span><span class="op" id="3327935">,</span>&nbsp;<span class="ident" id="3327937">rsaKA</span><span class="op" id="3327942">,</span>&nbsp;<span class="num" id="3327944">0</span><span class="op" id="3327945">,</span>&nbsp;<span class="ident" id="3327947">cipher3DES</span><span class="op" id="3327957">,</span>&nbsp;<span class="ident" id="3327959">macSHA1</span><span class="op" id="3327966">,</span>&nbsp;<span class="ident" id="3327968">nil</span><span class="op" id="3327971">}</span><span class="op" id="3327972">,</span><br>
<span class="lineno">85</span><span class="op" id="3327974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3327977">func</span>&nbsp;<span class="ident" id="3327982">cipherRC4</span><span class="op" id="3327991">(</span><span class="ident" id="3327992">key</span><span class="op" id="3327995">,</span>&nbsp;<span class="ident" id="3327997">iv</span>&nbsp;<span class="op" id="3328000">[</span><span class="op" id="3328001">]</span><span class="builtintype" id="3328002">byte</span><span class="op" id="3328006">,</span>&nbsp;<span class="ident" id="3328008">isRead</span>&nbsp;<span class="builtintype" id="3328015">bool</span><span class="op" id="3328019">)</span>&nbsp;<span class="keyword" id="3328021">interface</span><span class="op" id="3328030">{</span><span class="op" id="3328031">}</span>&nbsp;<span class="op" id="3328033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328036">cipher</span><span class="op" id="3328042">,</span>&nbsp;<span class="ident" id="3328044">_</span>&nbsp;<span class="op" id="3328046">:=</span>&nbsp;<span class="ident" id="3328049">rc4</span><span class="op" id="3328052">.</span><span class="ident" id="3328053">NewCipher</span><span class="op" id="3328062">(</span><span class="ident" id="3328063">key</span><span class="op" id="3328066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328069">return</span>&nbsp;<span class="ident" id="3328076">cipher</span><br>
<span class="lineno">90</span><span class="op" id="3328083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3328086">func</span>&nbsp;<span class="ident" id="3328091">cipher3DES</span><span class="op" id="3328101">(</span><span class="ident" id="3328102">key</span><span class="op" id="3328105">,</span>&nbsp;<span class="ident" id="3328107">iv</span>&nbsp;<span class="op" id="3328110">[</span><span class="op" id="3328111">]</span><span class="builtintype" id="3328112">byte</span><span class="op" id="3328116">,</span>&nbsp;<span class="ident" id="3328118">isRead</span>&nbsp;<span class="builtintype" id="3328125">bool</span><span class="op" id="3328129">)</span>&nbsp;<span class="keyword" id="3328131">interface</span><span class="op" id="3328140">{</span><span class="op" id="3328141">}</span>&nbsp;<span class="op" id="3328143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328146">block</span><span class="op" id="3328151">,</span>&nbsp;<span class="ident" id="3328153">_</span>&nbsp;<span class="op" id="3328155">:=</span>&nbsp;<span class="ident" id="3328158">des</span><span class="op" id="3328161">.</span><span class="ident" id="3328162">NewTripleDESCipher</span><span class="op" id="3328180">(</span><span class="ident" id="3328181">key</span><span class="op" id="3328184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328187">if</span>&nbsp;<span class="ident" id="3328190">isRead</span>&nbsp;<span class="op" id="3328197">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328201">return</span>&nbsp;<span class="ident" id="3328208">cipher</span><span class="op" id="3328214">.</span><span class="ident" id="3328215">NewCBCDecrypter</span><span class="op" id="3328230">(</span><span class="ident" id="3328231">block</span><span class="op" id="3328236">,</span>&nbsp;<span class="ident" id="3328238">iv</span><span class="op" id="3328240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328246">return</span>&nbsp;<span class="ident" id="3328253">cipher</span><span class="op" id="3328259">.</span><span class="ident" id="3328260">NewCBCEncrypter</span><span class="op" id="3328275">(</span><span class="ident" id="3328276">block</span><span class="op" id="3328281">,</span>&nbsp;<span class="ident" id="3328283">iv</span><span class="op" id="3328285">)</span><br>
<span class="lineno"></span><span class="op" id="3328287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3328290">func</span>&nbsp;<span class="ident" id="3328295">cipherAES</span><span class="op" id="3328304">(</span><span class="ident" id="3328305">key</span><span class="op" id="3328308">,</span>&nbsp;<span class="ident" id="3328310">iv</span>&nbsp;<span class="op" id="3328313">[</span><span class="op" id="3328314">]</span><span class="builtintype" id="3328315">byte</span><span class="op" id="3328319">,</span>&nbsp;<span class="ident" id="3328321">isRead</span>&nbsp;<span class="builtintype" id="3328328">bool</span><span class="op" id="3328332">)</span>&nbsp;<span class="keyword" id="3328334">interface</span><span class="op" id="3328343">{</span><span class="op" id="3328344">}</span>&nbsp;<span class="op" id="3328346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328349">block</span><span class="op" id="3328354">,</span>&nbsp;<span class="ident" id="3328356">_</span>&nbsp;<span class="op" id="3328358">:=</span>&nbsp;<span class="ident" id="3328361">aes</span><span class="op" id="3328364">.</span><span class="ident" id="3328365">NewCipher</span><span class="op" id="3328374">(</span><span class="ident" id="3328375">key</span><span class="op" id="3328378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328381">if</span>&nbsp;<span class="ident" id="3328384">isRead</span>&nbsp;<span class="op" id="3328391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328395">return</span>&nbsp;<span class="ident" id="3328402">cipher</span><span class="op" id="3328408">.</span><span class="ident" id="3328409">NewCBCDecrypter</span><span class="op" id="3328424">(</span><span class="ident" id="3328425">block</span><span class="op" id="3328430">,</span>&nbsp;<span class="ident" id="3328432">iv</span><span class="op" id="3328434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328437">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328440">return</span>&nbsp;<span class="ident" id="3328447">cipher</span><span class="op" id="3328453">.</span><span class="ident" id="3328454">NewCBCEncrypter</span><span class="op" id="3328469">(</span><span class="ident" id="3328470">block</span><span class="op" id="3328475">,</span>&nbsp;<span class="ident" id="3328477">iv</span><span class="op" id="3328479">)</span><br>
<span class="lineno"></span><span class="op" id="3328481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3328484">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="3328549">func</span>&nbsp;<span class="ident" id="3328554">macSHA1</span><span class="op" id="3328561">(</span><span class="ident" id="3328562">version</span>&nbsp;<span class="builtintype" id="3328570">uint16</span><span class="op" id="3328576">,</span>&nbsp;<span class="ident" id="3328578">key</span>&nbsp;<span class="op" id="3328582">[</span><span class="op" id="3328583">]</span><span class="builtintype" id="3328584">byte</span><span class="op" id="3328588">)</span>&nbsp;<span class="ident" id="3328590">macFunction</span>&nbsp;<span class="op" id="3328602">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328605">if</span>&nbsp;<span class="ident" id="3328608">version</span>&nbsp;<span class="op" id="3328616">==</span>&nbsp;<span class="ident" id="3328619">VersionSSL30</span>&nbsp;<span class="op" id="3328632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328636">mac</span>&nbsp;<span class="op" id="3328640">:=</span>&nbsp;<span class="ident" id="3328643">ssl30MAC</span><span class="op" id="3328651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328656">h</span><span class="op" id="3328657">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3328661">sha1</span><span class="op" id="3328665">.</span><span class="ident" id="3328666">New</span><span class="op" id="3328669">(</span><span class="op" id="3328670">)</span><span class="op" id="3328671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328676">key</span><span class="op" id="3328679">:</span>&nbsp;<span class="builtinfunc" id="3328681">make</span><span class="op" id="3328685">(</span><span class="op" id="3328686">[</span><span class="op" id="3328687">]</span><span class="builtintype" id="3328688">byte</span><span class="op" id="3328692">,</span>&nbsp;<span class="builtinfunc" id="3328694">len</span><span class="op" id="3328697">(</span><span class="ident" id="3328698">key</span><span class="op" id="3328701">)</span><span class="op" id="3328702">)</span><span class="op" id="3328703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328707">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3328711">copy</span><span class="op" id="3328715">(</span><span class="ident" id="3328716">mac</span><span class="op" id="3328719">.</span><span class="ident" id="3328720">key</span><span class="op" id="3328723">,</span>&nbsp;<span class="ident" id="3328725">key</span><span class="op" id="3328728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328732">return</span>&nbsp;<span class="ident" id="3328739">mac</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3328744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3328747">return</span>&nbsp;<span class="ident" id="3328754">tls10MAC</span><span class="op" id="3328762">{</span><span class="ident" id="3328763">hmac</span><span class="op" id="3328767">.</span><span class="ident" id="3328768">New</span><span class="op" id="3328771">(</span><span class="ident" id="3328772">sha1</span><span class="op" id="3328776">.</span><span class="ident" id="3328777">New</span><span class="op" id="3328780">,</span>&nbsp;<span class="ident" id="3328782">key</span><span class="op" id="3328785">)</span><span class="op" id="3328786">}</span><br>
<span class="lineno"></span><span class="op" id="3328788">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="3328791">type</span>&nbsp;<span class="ident" id="3328796">macFunction</span>&nbsp;<span class="keyword" id="3328808">interface</span>&nbsp;<span class="op" id="3328818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328821">Size</span><span class="op" id="3328825">(</span><span class="op" id="3328826">)</span>&nbsp;<span class="builtintype" id="3328828">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3328833">MAC</span><span class="op" id="3328836">(</span><span class="ident" id="3328837">digestBuf</span><span class="op" id="3328846">,</span>&nbsp;<span class="ident" id="3328848">seq</span><span class="op" id="3328851">,</span>&nbsp;<span class="ident" id="3328853">header</span><span class="op" id="3328859">,</span>&nbsp;<span class="ident" id="3328861">data</span>&nbsp;<span class="op" id="3328866">[</span><span class="op" id="3328867">]</span><span class="builtintype" id="3328868">byte</span><span class="op" id="3328872">)</span>&nbsp;<span class="op" id="3328874">[</span><span class="op" id="3328875">]</span><span class="builtintype" id="3328876">byte</span><br>
<span class="lineno"></span><span class="op" id="3328881">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="3328884">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3328961">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="3328975">type</span>&nbsp;<span class="ident" id="3328980">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="3328995">struct</span>&nbsp;<span class="op" id="3329002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329005">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329076">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3329140">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329195">sealNonce</span><span class="op" id="3329204">,</span>&nbsp;<span class="ident" id="3329206">openNonce</span>&nbsp;<span class="op" id="3329216">[</span><span class="op" id="3329217">]</span><span class="builtintype" id="3329218">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329224">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3329245">cipher</span><span class="op" id="3329251">.</span><span class="ident" id="3329252">AEAD</span><br>
<span class="lineno"></span><span class="op" id="3329257">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="3329260">func</span>&nbsp;<span class="op" id="3329265">(</span><span class="ident" id="3329266">f</span>&nbsp;<span class="op" id="3329268">*</span><span class="ident" id="3329269">fixedNonceAEAD</span><span class="op" id="3329283">)</span>&nbsp;<span class="ident" id="3329285">NonceSize</span><span class="op" id="3329294">(</span><span class="op" id="3329295">)</span>&nbsp;<span class="builtintype" id="3329297">int</span>&nbsp;<span class="op" id="3329301">{</span>&nbsp;<span class="keyword" id="3329303">return</span>&nbsp;<span class="num" id="3329310">8</span>&nbsp;<span class="op" id="3329312">}</span><br>
<span class="lineno"></span><span class="keyword" id="3329314">func</span>&nbsp;<span class="op" id="3329319">(</span><span class="ident" id="3329320">f</span>&nbsp;<span class="op" id="3329322">*</span><span class="ident" id="3329323">fixedNonceAEAD</span><span class="op" id="3329337">)</span>&nbsp;<span class="ident" id="3329339">Overhead</span><span class="op" id="3329347">(</span><span class="op" id="3329348">)</span>&nbsp;<span class="builtintype" id="3329350">int</span>&nbsp;&nbsp;<span class="op" id="3329355">{</span>&nbsp;<span class="keyword" id="3329357">return</span>&nbsp;<span class="ident" id="3329364">f</span><span class="op" id="3329365">.</span><span class="ident" id="3329366">aead</span><span class="op" id="3329370">.</span><span class="ident" id="3329371">Overhead</span><span class="op" id="3329379">(</span><span class="op" id="3329380">)</span>&nbsp;<span class="op" id="3329382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3329385">func</span>&nbsp;<span class="op" id="3329390">(</span><span class="ident" id="3329391">f</span>&nbsp;<span class="op" id="3329393">*</span><span class="ident" id="3329394">fixedNonceAEAD</span><span class="op" id="3329408">)</span>&nbsp;<span class="ident" id="3329410">Seal</span><span class="op" id="3329414">(</span><span class="ident" id="3329415">out</span><span class="op" id="3329418">,</span>&nbsp;<span class="ident" id="3329420">nonce</span><span class="op" id="3329425">,</span>&nbsp;<span class="ident" id="3329427">plaintext</span><span class="op" id="3329436">,</span>&nbsp;<span class="ident" id="3329438">additionalData</span>&nbsp;<span class="op" id="3329453">[</span><span class="op" id="3329454">]</span><span class="builtintype" id="3329455">byte</span><span class="op" id="3329459">)</span>&nbsp;<span class="op" id="3329461">[</span><span class="op" id="3329462">]</span><span class="builtintype" id="3329463">byte</span>&nbsp;<span class="op" id="3329468">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3329471">copy</span><span class="op" id="3329475">(</span><span class="ident" id="3329476">f</span><span class="op" id="3329477">.</span><span class="ident" id="3329478">sealNonce</span><span class="op" id="3329487">[</span><span class="builtinfunc" id="3329488">len</span><span class="op" id="3329491">(</span><span class="ident" id="3329492">f</span><span class="op" id="3329493">.</span><span class="ident" id="3329494">sealNonce</span><span class="op" id="3329503">)</span><span class="op" id="3329504">-</span><span class="num" id="3329505">8</span><span class="op" id="3329506">:</span><span class="op" id="3329507">]</span><span class="op" id="3329508">,</span>&nbsp;<span class="ident" id="3329510">nonce</span><span class="op" id="3329515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329518">return</span>&nbsp;<span class="ident" id="3329525">f</span><span class="op" id="3329526">.</span><span class="ident" id="3329527">aead</span><span class="op" id="3329531">.</span><span class="ident" id="3329532">Seal</span><span class="op" id="3329536">(</span><span class="ident" id="3329537">out</span><span class="op" id="3329540">,</span>&nbsp;<span class="ident" id="3329542">f</span><span class="op" id="3329543">.</span><span class="ident" id="3329544">sealNonce</span><span class="op" id="3329553">,</span>&nbsp;<span class="ident" id="3329555">plaintext</span><span class="op" id="3329564">,</span>&nbsp;<span class="ident" id="3329566">additionalData</span><span class="op" id="3329580">)</span><br>
<span class="lineno"></span><span class="op" id="3329582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3329585">func</span>&nbsp;<span class="op" id="3329590">(</span><span class="ident" id="3329591">f</span>&nbsp;<span class="op" id="3329593">*</span><span class="ident" id="3329594">fixedNonceAEAD</span><span class="op" id="3329608">)</span>&nbsp;<span class="ident" id="3329610">Open</span><span class="op" id="3329614">(</span><span class="ident" id="3329615">out</span><span class="op" id="3329618">,</span>&nbsp;<span class="ident" id="3329620">nonce</span><span class="op" id="3329625">,</span>&nbsp;<span class="ident" id="3329627">plaintext</span><span class="op" id="3329636">,</span>&nbsp;<span class="ident" id="3329638">additionalData</span>&nbsp;<span class="op" id="3329653">[</span><span class="op" id="3329654">]</span><span class="builtintype" id="3329655">byte</span><span class="op" id="3329659">)</span>&nbsp;<span class="op" id="3329661">(</span><span class="op" id="3329662">[</span><span class="op" id="3329663">]</span><span class="builtintype" id="3329664">byte</span><span class="op" id="3329668">,</span>&nbsp;<span class="builtintype" id="3329670">error</span><span class="op" id="3329675">)</span>&nbsp;<span class="op" id="3329677">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3329680">copy</span><span class="op" id="3329684">(</span><span class="ident" id="3329685">f</span><span class="op" id="3329686">.</span><span class="ident" id="3329687">openNonce</span><span class="op" id="3329696">[</span><span class="builtinfunc" id="3329697">len</span><span class="op" id="3329700">(</span><span class="ident" id="3329701">f</span><span class="op" id="3329702">.</span><span class="ident" id="3329703">openNonce</span><span class="op" id="3329712">)</span><span class="op" id="3329713">-</span><span class="num" id="3329714">8</span><span class="op" id="3329715">:</span><span class="op" id="3329716">]</span><span class="op" id="3329717">,</span>&nbsp;<span class="ident" id="3329719">nonce</span><span class="op" id="3329724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329727">return</span>&nbsp;<span class="ident" id="3329734">f</span><span class="op" id="3329735">.</span><span class="ident" id="3329736">aead</span><span class="op" id="3329740">.</span><span class="ident" id="3329741">Open</span><span class="op" id="3329745">(</span><span class="ident" id="3329746">out</span><span class="op" id="3329749">,</span>&nbsp;<span class="ident" id="3329751">f</span><span class="op" id="3329752">.</span><span class="ident" id="3329753">openNonce</span><span class="op" id="3329762">,</span>&nbsp;<span class="ident" id="3329764">plaintext</span><span class="op" id="3329773">,</span>&nbsp;<span class="ident" id="3329775">additionalData</span><span class="op" id="3329789">)</span><br>
<span class="lineno"></span><span class="op" id="3329791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3329794">func</span>&nbsp;<span class="ident" id="3329799">aeadAESGCM</span><span class="op" id="3329809">(</span><span class="ident" id="3329810">key</span><span class="op" id="3329813">,</span>&nbsp;<span class="ident" id="3329815">fixedNonce</span>&nbsp;<span class="op" id="3329826">[</span><span class="op" id="3329827">]</span><span class="builtintype" id="3329828">byte</span><span class="op" id="3329832">)</span>&nbsp;<span class="ident" id="3329834">cipher</span><span class="op" id="3329840">.</span><span class="ident" id="3329841">AEAD</span>&nbsp;<span class="op" id="3329846">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329849">aes</span><span class="op" id="3329852">,</span>&nbsp;<span class="ident" id="3329854">err</span>&nbsp;<span class="op" id="3329858">:=</span>&nbsp;<span class="ident" id="3329861">aes</span><span class="op" id="3329864">.</span><span class="ident" id="3329865">NewCipher</span><span class="op" id="3329874">(</span><span class="ident" id="3329875">key</span><span class="op" id="3329878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329881">if</span>&nbsp;<span class="ident" id="3329884">err</span>&nbsp;<span class="op" id="3329888">!=</span>&nbsp;<span class="ident" id="3329891">nil</span>&nbsp;<span class="op" id="3329895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3329899">panic</span><span class="op" id="3329904">(</span><span class="ident" id="3329905">err</span><span class="op" id="3329908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329914">aead</span><span class="op" id="3329918">,</span>&nbsp;<span class="ident" id="3329920">err</span>&nbsp;<span class="op" id="3329924">:=</span>&nbsp;<span class="ident" id="3329927">cipher</span><span class="op" id="3329933">.</span><span class="ident" id="3329934">NewGCM</span><span class="op" id="3329940">(</span><span class="ident" id="3329941">aes</span><span class="op" id="3329944">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3329947">if</span>&nbsp;<span class="ident" id="3329950">err</span>&nbsp;<span class="op" id="3329954">!=</span>&nbsp;<span class="ident" id="3329957">nil</span>&nbsp;<span class="op" id="3329961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3329965">panic</span><span class="op" id="3329970">(</span><span class="ident" id="3329971">err</span><span class="op" id="3329974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3329977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3329981">nonce1</span><span class="op" id="3329987">,</span>&nbsp;<span class="ident" id="3329989">nonce2</span>&nbsp;<span class="op" id="3329996">:=</span>&nbsp;<span class="builtinfunc" id="3329999">make</span><span class="op" id="3330003">(</span><span class="op" id="3330004">[</span><span class="op" id="3330005">]</span><span class="builtintype" id="3330006">byte</span><span class="op" id="3330010">,</span>&nbsp;<span class="num" id="3330012">12</span><span class="op" id="3330014">)</span><span class="op" id="3330015">,</span>&nbsp;<span class="builtinfunc" id="3330017">make</span><span class="op" id="3330021">(</span><span class="op" id="3330022">[</span><span class="op" id="3330023">]</span><span class="builtintype" id="3330024">byte</span><span class="op" id="3330028">,</span>&nbsp;<span class="num" id="3330030">12</span><span class="op" id="3330032">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3330035">copy</span><span class="op" id="3330039">(</span><span class="ident" id="3330040">nonce1</span><span class="op" id="3330046">,</span>&nbsp;<span class="ident" id="3330048">fixedNonce</span><span class="op" id="3330058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3330061">copy</span><span class="op" id="3330065">(</span><span class="ident" id="3330066">nonce2</span><span class="op" id="3330072">,</span>&nbsp;<span class="ident" id="3330074">fixedNonce</span><span class="op" id="3330084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330088">return</span>&nbsp;<span class="op" id="3330095">&amp;</span><span class="ident" id="3330096">fixedNonceAEAD</span><span class="op" id="3330110">{</span><span class="ident" id="3330111">nonce1</span><span class="op" id="3330117">,</span>&nbsp;<span class="ident" id="3330119">nonce2</span><span class="op" id="3330125">,</span>&nbsp;<span class="ident" id="3330127">aead</span><span class="op" id="3330131">}</span><br>
<span class="lineno"></span><span class="op" id="3330133">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3330136">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3330197">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="3330275">type</span>&nbsp;<span class="ident" id="3330280">ssl30MAC</span>&nbsp;<span class="keyword" id="3330289">struct</span>&nbsp;<span class="op" id="3330296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330299">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3330303">hash</span><span class="op" id="3330307">.</span><span class="ident" id="3330308">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3330314">key</span>&nbsp;<span class="op" id="3330318">[</span><span class="op" id="3330319">]</span><span class="builtintype" id="3330320">byte</span><br>
<span class="lineno"></span><span class="op" id="3330325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330328">func</span>&nbsp;<span class="op" id="3330333">(</span><span class="ident" id="3330334">s</span>&nbsp;<span class="ident" id="3330336">ssl30MAC</span><span class="op" id="3330344">)</span>&nbsp;<span class="ident" id="3330346">Size</span><span class="op" id="3330350">(</span><span class="op" id="3330351">)</span>&nbsp;<span class="builtintype" id="3330353">int</span>&nbsp;<span class="op" id="3330357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3330360">return</span>&nbsp;<span class="ident" id="3330367">s</span><span class="op" id="3330368">.</span><span class="ident" id="3330369">h</span><span class="op" id="3330370">.</span><span class="ident" id="3330371">Size</span><span class="op" id="3330375">(</span><span class="op" id="3330376">)</span><br>
<span class="lineno">175</span><span class="op" id="3330378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330381">var</span>&nbsp;<span class="ident" id="3330385">ssl30Pad1</span>&nbsp;<span class="op" id="3330395">=</span>&nbsp;<span class="op" id="3330397">[</span><span class="num" id="3330398">48</span><span class="op" id="3330400">]</span><span class="builtintype" id="3330401">byte</span><span class="op" id="3330405">{</span><span class="num" id="3330406">0x36</span><span class="op" id="3330410">,</span>&nbsp;<span class="num" id="3330412">0x36</span><span class="op" id="3330416">,</span>&nbsp;<span class="num" id="3330418">0x36</span><span class="op" id="3330422">,</span>&nbsp;<span class="num" id="3330424">0x36</span><span class="op" id="3330428">,</span>&nbsp;<span class="num" id="3330430">0x36</span><span class="op" id="3330434">,</span>&nbsp;<span class="num" id="3330436">0x36</span><span class="op" id="3330440">,</span>&nbsp;<span class="num" id="3330442">0x36</span><span class="op" id="3330446">,</span>&nbsp;<span class="num" id="3330448">0x36</span><span class="op" id="3330452">,</span>&nbsp;<span class="num" id="3330454">0x36</span><span class="op" id="3330458">,</span>&nbsp;<span class="num" id="3330460">0x36</span><span class="op" id="3330464">,</span>&nbsp;<span class="num" id="3330466">0x36</span><span class="op" id="3330470">,</span>&nbsp;<span class="num" id="3330472">0x36</span><span class="op" id="3330476">,</span>&nbsp;<span class="num" id="3330478">0x36</span><span class="op" id="3330482">,</span>&nbsp;<span class="num" id="3330484">0x36</span><span class="op" id="3330488">,</span>&nbsp;<span class="num" id="3330490">0x36</span><span class="op" id="3330494">,</span>&nbsp;<span class="num" id="3330496">0x36</span><span class="op" id="3330500">,</span>&nbsp;<span class="num" id="3330502">0x36</span><span class="op" id="3330506">,</span>&nbsp;<span class="num" id="3330508">0x36</span><span class="op" id="3330512">,</span>&nbsp;<span class="num" id="3330514">0x36</span><span class="op" id="3330518">,</span>&nbsp;<span class="num" id="3330520">0x36</span><span class="op" id="3330524">,</span>&nbsp;<span class="num" id="3330526">0x36</span><span class="op" id="3330530">,</span>&nbsp;<span class="num" id="3330532">0x36</span><span class="op" id="3330536">,</span>&nbsp;<span class="num" id="3330538">0x36</span><span class="op" id="3330542">,</span>&nbsp;<span class="num" id="3330544">0x36</span><span class="op" id="3330548">,</span>&nbsp;<span class="num" id="3330550">0x36</span><span class="op" id="3330554">,</span>&nbsp;<span class="num" id="3330556">0x36</span><span class="op" id="3330560">,</span>&nbsp;<span class="num" id="3330562">0x36</span><span class="op" id="3330566">,</span>&nbsp;<span class="num" id="3330568">0x36</span><span class="op" id="3330572">,</span>&nbsp;<span class="num" id="3330574">0x36</span><span class="op" id="3330578">,</span>&nbsp;<span class="num" id="3330580">0x36</span><span class="op" id="3330584">,</span>&nbsp;<span class="num" id="3330586">0x36</span><span class="op" id="3330590">,</span>&nbsp;<span class="num" id="3330592">0x36</span><span class="op" id="3330596">,</span>&nbsp;<span class="num" id="3330598">0x36</span><span class="op" id="3330602">,</span>&nbsp;<span class="num" id="3330604">0x36</span><span class="op" id="3330608">,</span>&nbsp;<span class="num" id="3330610">0x36</span><span class="op" id="3330614">,</span>&nbsp;<span class="num" id="3330616">0x36</span><span class="op" id="3330620">,</span>&nbsp;<span class="num" id="3330622">0x36</span><span class="op" id="3330626">,</span>&nbsp;<span class="num" id="3330628">0x36</span><span class="op" id="3330632">,</span>&nbsp;<span class="num" id="3330634">0x36</span><span class="op" id="3330638">,</span>&nbsp;<span class="num" id="3330640">0x36</span><span class="op" id="3330644">,</span>&nbsp;<span class="num" id="3330646">0x36</span><span class="op" id="3330650">,</span>&nbsp;<span class="num" id="3330652">0x36</span><span class="op" id="3330656">,</span>&nbsp;<span class="num" id="3330658">0x36</span><span class="op" id="3330662">,</span>&nbsp;<span class="num" id="3330664">0x36</span><span class="op" id="3330668">,</span>&nbsp;<span class="num" id="3330670">0x36</span><span class="op" id="3330674">,</span>&nbsp;<span class="num" id="3330676">0x36</span><span class="op" id="3330680">,</span>&nbsp;<span class="num" id="3330682">0x36</span><span class="op" id="3330686">,</span>&nbsp;<span class="num" id="3330688">0x36</span><span class="op" id="3330692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3330695">var</span>&nbsp;<span class="ident" id="3330699">ssl30Pad2</span>&nbsp;<span class="op" id="3330709">=</span>&nbsp;<span class="op" id="3330711">[</span><span class="num" id="3330712">48</span><span class="op" id="3330714">]</span><span class="builtintype" id="3330715">byte</span><span class="op" id="3330719">{</span><span class="num" id="3330720">0x5c</span><span class="op" id="3330724">,</span>&nbsp;<span class="num" id="3330726">0x5c</span><span class="op" id="3330730">,</span>&nbsp;<span class="num" id="3330732">0x5c</span><span class="op" id="3330736">,</span>&nbsp;<span class="num" id="3330738">0x5c</span><span class="op" id="3330742">,</span>&nbsp;<span class="num" id="3330744">0x5c</span><span class="op" id="3330748">,</span>&nbsp;<span class="num" id="3330750">0x5c</span><span class="op" id="3330754">,</span>&nbsp;<span class="num" id="3330756">0x5c</span><span class="op" id="3330760">,</span>&nbsp;<span class="num" id="3330762">0x5c</span><span class="op" id="3330766">,</span>&nbsp;<span class="num" id="3330768">0x5c</span><span class="op" id="3330772">,</span>&nbsp;<span class="num" id="3330774">0x5c</span><span class="op" id="3330778">,</span>&nbsp;<span class="num" id="3330780">0x5c</span><span class="op" id="3330784">,</span>&nbsp;<span class="num" id="3330786">0x5c</span><span class="op" id="3330790">,</span>&nbsp;<span class="num" id="3330792">0x5c</span><span class="op" id="3330796">,</span>&nbsp;<span class="num" id="3330798">0x5c</span><span class="op" id="3330802">,</span>&nbsp;<span class="num" id="3330804">0x5c</span><span class="op" id="3330808">,</span>&nbsp;<span class="num" id="3330810">0x5c</span><span class="op" id="3330814">,</span>&nbsp;<span class="num" id="3330816">0x5c</span><span class="op" id="3330820">,</span>&nbsp;<span class="num" id="3330822">0x5c</span><span class="op" id="3330826">,</span>&nbsp;<span class="num" id="3330828">0x5c</span><span class="op" id="3330832">,</span>&nbsp;<span class="num" id="3330834">0x5c</span><span class="op" id="3330838">,</span>&nbsp;<span class="num" id="3330840">0x5c</span><span class="op" id="3330844">,</span>&nbsp;<span class="num" id="3330846">0x5c</span><span class="op" id="3330850">,</span>&nbsp;<span class="num" id="3330852">0x5c</span><span class="op" id="3330856">,</span>&nbsp;<span class="num" id="3330858">0x5c</span><span class="op" id="3330862">,</span>&nbsp;<span class="num" id="3330864">0x5c</span><span class="op" id="3330868">,</span>&nbsp;<span class="num" id="3330870">0x5c</span><span class="op" id="3330874">,</span>&nbsp;<span class="num" id="3330876">0x5c</span><span class="op" id="3330880">,</span>&nbsp;<span class="num" id="3330882">0x5c</span><span class="op" id="3330886">,</span>&nbsp;<span class="num" id="3330888">0x5c</span><span class="op" id="3330892">,</span>&nbsp;<span class="num" id="3330894">0x5c</span><span class="op" id="3330898">,</span>&nbsp;<span class="num" id="3330900">0x5c</span><span class="op" id="3330904">,</span>&nbsp;<span class="num" id="3330906">0x5c</span><span class="op" id="3330910">,</span>&nbsp;<span class="num" id="3330912">0x5c</span><span class="op" id="3330916">,</span>&nbsp;<span class="num" id="3330918">0x5c</span><span class="op" id="3330922">,</span>&nbsp;<span class="num" id="3330924">0x5c</span><span class="op" id="3330928">,</span>&nbsp;<span class="num" id="3330930">0x5c</span><span class="op" id="3330934">,</span>&nbsp;<span class="num" id="3330936">0x5c</span><span class="op" id="3330940">,</span>&nbsp;<span class="num" id="3330942">0x5c</span><span class="op" id="3330946">,</span>&nbsp;<span class="num" id="3330948">0x5c</span><span class="op" id="3330952">,</span>&nbsp;<span class="num" id="3330954">0x5c</span><span class="op" id="3330958">,</span>&nbsp;<span class="num" id="3330960">0x5c</span><span class="op" id="3330964">,</span>&nbsp;<span class="num" id="3330966">0x5c</span><span class="op" id="3330970">,</span>&nbsp;<span class="num" id="3330972">0x5c</span><span class="op" id="3330976">,</span>&nbsp;<span class="num" id="3330978">0x5c</span><span class="op" id="3330982">,</span>&nbsp;<span class="num" id="3330984">0x5c</span><span class="op" id="3330988">,</span>&nbsp;<span class="num" id="3330990">0x5c</span><span class="op" id="3330994">,</span>&nbsp;<span class="num" id="3330996">0x5c</span><span class="op" id="3331000">,</span>&nbsp;<span class="num" id="3331002">0x5c</span><span class="op" id="3331006">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3331009">func</span>&nbsp;<span class="op" id="3331014">(</span><span class="ident" id="3331015">s</span>&nbsp;<span class="ident" id="3331017">ssl30MAC</span><span class="op" id="3331025">)</span>&nbsp;<span class="ident" id="3331027">MAC</span><span class="op" id="3331030">(</span><span class="ident" id="3331031">digestBuf</span><span class="op" id="3331040">,</span>&nbsp;<span class="ident" id="3331042">seq</span><span class="op" id="3331045">,</span>&nbsp;<span class="ident" id="3331047">header</span><span class="op" id="3331053">,</span>&nbsp;<span class="ident" id="3331055">data</span>&nbsp;<span class="op" id="3331060">[</span><span class="op" id="3331061">]</span><span class="builtintype" id="3331062">byte</span><span class="op" id="3331066">)</span>&nbsp;<span class="op" id="3331068">[</span><span class="op" id="3331069">]</span><span class="builtintype" id="3331070">byte</span>&nbsp;<span class="op" id="3331075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331078">padLength</span>&nbsp;<span class="op" id="3331088">:=</span>&nbsp;<span class="num" id="3331091">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331095">if</span>&nbsp;<span class="ident" id="3331098">s</span><span class="op" id="3331099">.</span><span class="ident" id="3331100">h</span><span class="op" id="3331101">.</span><span class="ident" id="3331102">Size</span><span class="op" id="3331106">(</span><span class="op" id="3331107">)</span>&nbsp;<span class="op" id="3331109">==</span>&nbsp;<span class="num" id="3331112">20</span>&nbsp;<span class="op" id="3331115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331119">padLength</span>&nbsp;<span class="op" id="3331129">=</span>&nbsp;<span class="num" id="3331131">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331139">s</span><span class="op" id="3331140">.</span><span class="ident" id="3331141">h</span><span class="op" id="3331142">.</span><span class="ident" id="3331143">Reset</span><span class="op" id="3331148">(</span><span class="op" id="3331149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331152">s</span><span class="op" id="3331153">.</span><span class="ident" id="3331154">h</span><span class="op" id="3331155">.</span><span class="ident" id="3331156">Write</span><span class="op" id="3331161">(</span><span class="ident" id="3331162">s</span><span class="op" id="3331163">.</span><span class="ident" id="3331164">key</span><span class="op" id="3331167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331170">s</span><span class="op" id="3331171">.</span><span class="ident" id="3331172">h</span><span class="op" id="3331173">.</span><span class="ident" id="3331174">Write</span><span class="op" id="3331179">(</span><span class="ident" id="3331180">ssl30Pad1</span><span class="op" id="3331189">[</span><span class="op" id="3331190">:</span><span class="ident" id="3331191">padLength</span><span class="op" id="3331200">]</span><span class="op" id="3331201">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331204">s</span><span class="op" id="3331205">.</span><span class="ident" id="3331206">h</span><span class="op" id="3331207">.</span><span class="ident" id="3331208">Write</span><span class="op" id="3331213">(</span><span class="ident" id="3331214">seq</span><span class="op" id="3331217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331220">s</span><span class="op" id="3331221">.</span><span class="ident" id="3331222">h</span><span class="op" id="3331223">.</span><span class="ident" id="3331224">Write</span><span class="op" id="3331229">(</span><span class="ident" id="3331230">header</span><span class="op" id="3331236">[</span><span class="op" id="3331237">:</span><span class="num" id="3331238">1</span><span class="op" id="3331239">]</span><span class="op" id="3331240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331243">s</span><span class="op" id="3331244">.</span><span class="ident" id="3331245">h</span><span class="op" id="3331246">.</span><span class="ident" id="3331247">Write</span><span class="op" id="3331252">(</span><span class="ident" id="3331253">header</span><span class="op" id="3331259">[</span><span class="num" id="3331260">3</span><span class="op" id="3331261">:</span><span class="num" id="3331262">5</span><span class="op" id="3331263">]</span><span class="op" id="3331264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331267">s</span><span class="op" id="3331268">.</span><span class="ident" id="3331269">h</span><span class="op" id="3331270">.</span><span class="ident" id="3331271">Write</span><span class="op" id="3331276">(</span><span class="ident" id="3331277">data</span><span class="op" id="3331281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331284">digestBuf</span>&nbsp;<span class="op" id="3331294">=</span>&nbsp;<span class="ident" id="3331296">s</span><span class="op" id="3331297">.</span><span class="ident" id="3331298">h</span><span class="op" id="3331299">.</span><span class="ident" id="3331300">Sum</span><span class="op" id="3331303">(</span><span class="ident" id="3331304">digestBuf</span><span class="op" id="3331313">[</span><span class="op" id="3331314">:</span><span class="num" id="3331315">0</span><span class="op" id="3331316">]</span><span class="op" id="3331317">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331321">s</span><span class="op" id="3331322">.</span><span class="ident" id="3331323">h</span><span class="op" id="3331324">.</span><span class="ident" id="3331325">Reset</span><span class="op" id="3331330">(</span><span class="op" id="3331331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331334">s</span><span class="op" id="3331335">.</span><span class="ident" id="3331336">h</span><span class="op" id="3331337">.</span><span class="ident" id="3331338">Write</span><span class="op" id="3331343">(</span><span class="ident" id="3331344">s</span><span class="op" id="3331345">.</span><span class="ident" id="3331346">key</span><span class="op" id="3331349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331352">s</span><span class="op" id="3331353">.</span><span class="ident" id="3331354">h</span><span class="op" id="3331355">.</span><span class="ident" id="3331356">Write</span><span class="op" id="3331361">(</span><span class="ident" id="3331362">ssl30Pad2</span><span class="op" id="3331371">[</span><span class="op" id="3331372">:</span><span class="ident" id="3331373">padLength</span><span class="op" id="3331382">]</span><span class="op" id="3331383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331386">s</span><span class="op" id="3331387">.</span><span class="ident" id="3331388">h</span><span class="op" id="3331389">.</span><span class="ident" id="3331390">Write</span><span class="op" id="3331395">(</span><span class="ident" id="3331396">digestBuf</span><span class="op" id="3331405">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331408">return</span>&nbsp;<span class="ident" id="3331415">s</span><span class="op" id="3331416">.</span><span class="ident" id="3331417">h</span><span class="op" id="3331418">.</span><span class="ident" id="3331419">Sum</span><span class="op" id="3331422">(</span><span class="ident" id="3331423">digestBuf</span><span class="op" id="3331432">[</span><span class="op" id="3331433">:</span><span class="num" id="3331434">0</span><span class="op" id="3331435">]</span><span class="op" id="3331436">)</span><br>
<span class="lineno"></span><span class="op" id="3331438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3331441">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3331515">type</span>&nbsp;<span class="ident" id="3331520">tls10MAC</span>&nbsp;<span class="keyword" id="3331529">struct</span>&nbsp;<span class="op" id="3331536">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331539">h</span>&nbsp;<span class="ident" id="3331541">hash</span><span class="op" id="3331545">.</span><span class="ident" id="3331546">Hash</span><br>
<span class="lineno"></span><span class="op" id="3331551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331554">func</span>&nbsp;<span class="op" id="3331559">(</span><span class="ident" id="3331560">s</span>&nbsp;<span class="ident" id="3331562">tls10MAC</span><span class="op" id="3331570">)</span>&nbsp;<span class="ident" id="3331572">Size</span><span class="op" id="3331576">(</span><span class="op" id="3331577">)</span>&nbsp;<span class="builtintype" id="3331579">int</span>&nbsp;<span class="op" id="3331583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331586">return</span>&nbsp;<span class="ident" id="3331593">s</span><span class="op" id="3331594">.</span><span class="ident" id="3331595">h</span><span class="op" id="3331596">.</span><span class="ident" id="3331597">Size</span><span class="op" id="3331601">(</span><span class="op" id="3331602">)</span><br>
<span class="lineno">210</span><span class="op" id="3331604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331607">func</span>&nbsp;<span class="op" id="3331612">(</span><span class="ident" id="3331613">s</span>&nbsp;<span class="ident" id="3331615">tls10MAC</span><span class="op" id="3331623">)</span>&nbsp;<span class="ident" id="3331625">MAC</span><span class="op" id="3331628">(</span><span class="ident" id="3331629">digestBuf</span><span class="op" id="3331638">,</span>&nbsp;<span class="ident" id="3331640">seq</span><span class="op" id="3331643">,</span>&nbsp;<span class="ident" id="3331645">header</span><span class="op" id="3331651">,</span>&nbsp;<span class="ident" id="3331653">data</span>&nbsp;<span class="op" id="3331658">[</span><span class="op" id="3331659">]</span><span class="builtintype" id="3331660">byte</span><span class="op" id="3331664">)</span>&nbsp;<span class="op" id="3331666">[</span><span class="op" id="3331667">]</span><span class="builtintype" id="3331668">byte</span>&nbsp;<span class="op" id="3331673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331676">s</span><span class="op" id="3331677">.</span><span class="ident" id="3331678">h</span><span class="op" id="3331679">.</span><span class="ident" id="3331680">Reset</span><span class="op" id="3331685">(</span><span class="op" id="3331686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331689">s</span><span class="op" id="3331690">.</span><span class="ident" id="3331691">h</span><span class="op" id="3331692">.</span><span class="ident" id="3331693">Write</span><span class="op" id="3331698">(</span><span class="ident" id="3331699">seq</span><span class="op" id="3331702">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331705">s</span><span class="op" id="3331706">.</span><span class="ident" id="3331707">h</span><span class="op" id="3331708">.</span><span class="ident" id="3331709">Write</span><span class="op" id="3331714">(</span><span class="ident" id="3331715">header</span><span class="op" id="3331721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331724">s</span><span class="op" id="3331725">.</span><span class="ident" id="3331726">h</span><span class="op" id="3331727">.</span><span class="ident" id="3331728">Write</span><span class="op" id="3331733">(</span><span class="ident" id="3331734">data</span><span class="op" id="3331738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331741">return</span>&nbsp;<span class="ident" id="3331748">s</span><span class="op" id="3331749">.</span><span class="ident" id="3331750">h</span><span class="op" id="3331751">.</span><span class="ident" id="3331752">Sum</span><span class="op" id="3331755">(</span><span class="ident" id="3331756">digestBuf</span><span class="op" id="3331765">[</span><span class="op" id="3331766">:</span><span class="num" id="3331767">0</span><span class="op" id="3331768">]</span><span class="op" id="3331769">)</span><br>
<span class="lineno"></span><span class="op" id="3331771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3331774">func</span>&nbsp;<span class="ident" id="3331779">rsaKA</span><span class="op" id="3331784">(</span><span class="ident" id="3331785">version</span>&nbsp;<span class="builtintype" id="3331793">uint16</span><span class="op" id="3331799">)</span>&nbsp;<span class="ident" id="3331801">keyAgreement</span>&nbsp;<span class="op" id="3331814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331817">return</span>&nbsp;<span class="ident" id="3331824">rsaKeyAgreement</span><span class="op" id="3331839">{</span><span class="op" id="3331840">}</span><br>
<span class="lineno"></span><span class="op" id="3331842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3331845">func</span>&nbsp;<span class="ident" id="3331850">ecdheECDSAKA</span><span class="op" id="3331862">(</span><span class="ident" id="3331863">version</span>&nbsp;<span class="builtintype" id="3331871">uint16</span><span class="op" id="3331877">)</span>&nbsp;<span class="ident" id="3331879">keyAgreement</span>&nbsp;<span class="op" id="3331892">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3331895">return</span>&nbsp;<span class="op" id="3331902">&amp;</span><span class="ident" id="3331903">ecdheKeyAgreement</span><span class="op" id="3331920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331924">sigType</span><span class="op" id="3331931">:</span>&nbsp;<span class="ident" id="3331933">signatureECDSA</span><span class="op" id="3331947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3331951">version</span><span class="op" id="3331958">:</span>&nbsp;<span class="ident" id="3331960">version</span><span class="op" id="3331967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3331970">}</span><br>
<span class="lineno"></span><span class="op" id="3331972">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3331975">func</span>&nbsp;<span class="ident" id="3331980">ecdheRSAKA</span><span class="op" id="3331990">(</span><span class="ident" id="3331991">version</span>&nbsp;<span class="builtintype" id="3331999">uint16</span><span class="op" id="3332005">)</span>&nbsp;<span class="ident" id="3332007">keyAgreement</span>&nbsp;<span class="op" id="3332020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332023">return</span>&nbsp;<span class="op" id="3332030">&amp;</span><span class="ident" id="3332031">ecdheKeyAgreement</span><span class="op" id="3332048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332052">sigType</span><span class="op" id="3332059">:</span>&nbsp;<span class="ident" id="3332061">signatureRSA</span><span class="op" id="3332073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332077">version</span><span class="op" id="3332084">:</span>&nbsp;<span class="ident" id="3332086">version</span><span class="op" id="3332093">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332096">}</span><br>
<span class="lineno"></span><span class="op" id="3332098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3332101">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="3332170">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="3332220">func</span>&nbsp;<span class="ident" id="3332225">mutualCipherSuite</span><span class="op" id="3332242">(</span><span class="ident" id="3332243">have</span>&nbsp;<span class="op" id="3332248">[</span><span class="op" id="3332249">]</span><span class="builtintype" id="3332250">uint16</span><span class="op" id="3332256">,</span>&nbsp;<span class="ident" id="3332258">want</span>&nbsp;<span class="builtintype" id="3332263">uint16</span><span class="op" id="3332269">)</span>&nbsp;<span class="op" id="3332271">*</span><span class="ident" id="3332272">cipherSuite</span>&nbsp;<span class="op" id="3332284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332287">for</span>&nbsp;<span class="ident" id="3332291">_</span><span class="op" id="3332292">,</span>&nbsp;<span class="ident" id="3332294">id</span>&nbsp;<span class="op" id="3332297">:=</span>&nbsp;<span class="keyword" id="3332300">range</span>&nbsp;<span class="ident" id="3332306">have</span>&nbsp;<span class="op" id="3332311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332315">if</span>&nbsp;<span class="ident" id="3332318">id</span>&nbsp;<span class="op" id="3332321">==</span>&nbsp;<span class="ident" id="3332324">want</span>&nbsp;<span class="op" id="3332329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332334">for</span>&nbsp;<span class="ident" id="3332338">_</span><span class="op" id="3332339">,</span>&nbsp;<span class="ident" id="3332341">suite</span>&nbsp;<span class="op" id="3332347">:=</span>&nbsp;<span class="keyword" id="3332350">range</span>&nbsp;<span class="ident" id="3332356">cipherSuites</span>&nbsp;<span class="op" id="3332369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332375">if</span>&nbsp;<span class="ident" id="3332378">suite</span><span class="op" id="3332383">.</span><span class="ident" id="3332384">id</span>&nbsp;<span class="op" id="3332387">==</span>&nbsp;<span class="ident" id="3332390">want</span>&nbsp;<span class="op" id="3332395">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332402">return</span>&nbsp;<span class="ident" id="3332409">suite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332429">return</span>&nbsp;<span class="ident" id="3332436">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332442">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3332445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3332448">return</span>&nbsp;<span class="ident" id="3332455">nil</span><br>
<span class="lineno"></span><span class="op" id="3332459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3332462">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="3332517">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="3332586">const</span>&nbsp;<span class="op" id="3332592">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332595">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332635">uint16</span>&nbsp;<span class="op" id="3332642">=</span>&nbsp;<span class="num" id="3332644">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332652">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332692">uint16</span>&nbsp;<span class="op" id="3332699">=</span>&nbsp;<span class="num" id="3332701">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332709">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332749">uint16</span>&nbsp;<span class="op" id="3332756">=</span>&nbsp;<span class="num" id="3332758">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332766">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332806">uint16</span>&nbsp;<span class="op" id="3332813">=</span>&nbsp;<span class="num" id="3332815">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332823">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332863">uint16</span>&nbsp;<span class="op" id="3332870">=</span>&nbsp;<span class="num" id="3332872">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332880">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332920">uint16</span>&nbsp;<span class="op" id="3332927">=</span>&nbsp;<span class="num" id="3332929">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332937">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3332977">uint16</span>&nbsp;<span class="op" id="3332984">=</span>&nbsp;<span class="num" id="3332986">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3332994">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3333034">uint16</span>&nbsp;<span class="op" id="3333041">=</span>&nbsp;<span class="num" id="3333043">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333051">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3333091">uint16</span>&nbsp;<span class="op" id="3333098">=</span>&nbsp;<span class="num" id="3333100">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333108">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3333148">uint16</span>&nbsp;<span class="op" id="3333155">=</span>&nbsp;<span class="num" id="3333157">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333165">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3333205">uint16</span>&nbsp;<span class="op" id="3333212">=</span>&nbsp;<span class="num" id="3333214">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333222">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3333262">uint16</span>&nbsp;<span class="op" id="3333269">=</span>&nbsp;<span class="num" id="3333271">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333279">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="3333319">uint16</span>&nbsp;<span class="op" id="3333326">=</span>&nbsp;<span class="num" id="3333328">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3333337">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3333406">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3333457">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333523">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="3333541">uint16</span>&nbsp;<span class="op" id="3333548">=</span>&nbsp;<span class="num" id="3333550">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="3333557">)</span>
</div>
</body>
</html>
