<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4020870">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4020925">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4020979">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4021030">//&nbsp;This&nbsp;Go&nbsp;implementation&nbsp;is&nbsp;derived&nbsp;in&nbsp;part&nbsp;from&nbsp;the&nbsp;reference</span><br>
<span class="lineno"></span><span class="comment" id="4021094">//&nbsp;ANSI&nbsp;C&nbsp;implementation,&nbsp;which&nbsp;carries&nbsp;the&nbsp;following&nbsp;notice:</span><br>
<span class="lineno"></span><span class="comment" id="4021156">//</span><br>
<span class="lineno"></span><span class="comment" id="4021159">//&nbsp;&nbsp;&nbsp;&nbsprijndael-alg-fst.c</span><br>
<span class="lineno"></span><span class="comment" id="4021181">//</span><br>
<span class="lineno">10</span><span class="comment" id="4021184">//&nbsp;&nbsp;&nbsp;&nbsp@version&nbsp;3.0&nbsp;(December&nbsp;2000)</span><br>
<span class="lineno"></span><span class="comment" id="4021216">//</span><br>
<span class="lineno"></span><span class="comment" id="4021219">//&nbsp;&nbsp;&nbsp;&nbspOptimised&nbsp;ANSI&nbsp;C&nbsp;code&nbsp;for&nbsp;the&nbsp;Rijndael&nbsp;cipher&nbsp;(now&nbsp;AES)</span><br>
<span class="lineno"></span><span class="comment" id="4021278">//</span><br>
<span class="lineno"></span><span class="comment" id="4021281">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Vincent&nbsp;Rijmen&nbsp;&lt;vincent.rijmen@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno">15</span><span class="comment" id="4021344">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Antoon&nbsp;Bosselaers&nbsp;&lt;antoon.bosselaers@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4021413">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Paulo&nbsp;Barreto&nbsp;&lt;paulo.barreto@terra.com.br&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4021467">//</span><br>
<span class="lineno"></span><span class="comment" id="4021470">//&nbsp;&nbsp;&nbsp;&nbspThis&nbsp;code&nbsp;is&nbsp;hereby&nbsp;placed&nbsp;in&nbsp;the&nbsp;public&nbsp;domain.</span><br>
<span class="lineno"></span><span class="comment" id="4021522">//</span><br>
<span class="lineno">20</span><span class="comment" id="4021525">//&nbsp;&nbsp;&nbsp;&nbspTHIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHORS&nbsp;&#39;&#39;AS&nbsp;IS&#39;&#39;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS</span><br>
<span class="lineno"></span><span class="comment" id="4021595">//&nbsp;&nbsp;&nbsp;&nbspOR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED</span><br>
<span class="lineno"></span><span class="comment" id="4021664">//&nbsp;&nbsp;&nbsp;&nbspWARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE</span><br>
<span class="lineno"></span><span class="comment" id="4021734">//&nbsp;&nbsp;&nbsp;&nbspARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHORS&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE</span><br>
<span class="lineno"></span><span class="comment" id="4021803">//&nbsp;&nbsp;&nbsp;&nbspLIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR</span><br>
<span class="lineno">25</span><span class="comment" id="4021874">//&nbsp;&nbsp;&nbsp;&nbspCONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF</span><br>
<span class="lineno"></span><span class="comment" id="4021946">//&nbsp;&nbsp;&nbsp;&nbspSUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR</span><br>
<span class="lineno"></span><span class="comment" id="4022013">//&nbsp;&nbsp;&nbsp;&nbspBUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,</span><br>
<span class="lineno"></span><span class="comment" id="4022086">//&nbsp;&nbsp;&nbsp;&nbspWHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE</span><br>
<span class="lineno"></span><span class="comment" id="4022158">//&nbsp;&nbsp;&nbsp;&nbspOR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,</span><br>
<span class="lineno">30</span><span class="comment" id="4022227">//&nbsp;&nbsp;&nbsp;&nbspEVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.</span><br>
<span class="lineno"></span><span class="comment" id="4022281">//</span><br>
<span class="lineno"></span><span class="comment" id="4022284">//&nbsp;See&nbsp;FIPS&nbsp;197&nbsp;for&nbsp;specification,&nbsp;and&nbsp;see&nbsp;Daemen&nbsp;and&nbsp;Rijmen&#39;s&nbsp;Rijndael&nbsp;submission</span><br>
<span class="lineno"></span><span class="comment" id="4022367">//&nbsp;for&nbsp;implementation&nbsp;details.</span><br>
<span class="lineno"></span><span class="comment" id="4022398">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno">35</span><span class="comment" id="4022465">//&nbsp;&nbsp;&nbsp;&nbsphttp://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022533">package</span>&nbsp;<span class="ident" id="4022541">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022546">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">40</span><span class="keyword" id="4022613">func</span>&nbsp;<span class="ident" id="4022618">encryptBlockGo</span><span class="op" id="4022632">(</span><span class="ident" id="4022633">xk</span>&nbsp;<span class="op" id="4022636">[</span><span class="op" id="4022637">]</span><span class="builtintype" id="4022638">uint32</span><span class="op" id="4022644">,</span>&nbsp;<span class="ident" id="4022646">dst</span><span class="op" id="4022649">,</span>&nbsp;<span class="ident" id="4022651">src</span>&nbsp;<span class="op" id="4022655">[</span><span class="op" id="4022656">]</span><span class="builtintype" id="4022657">byte</span><span class="op" id="4022661">)</span>&nbsp;<span class="op" id="4022663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022666">var</span>&nbsp;<span class="ident" id="4022670">s0</span><span class="op" id="4022672">,</span>&nbsp;<span class="ident" id="4022674">s1</span><span class="op" id="4022676">,</span>&nbsp;<span class="ident" id="4022678">s2</span><span class="op" id="4022680">,</span>&nbsp;<span class="ident" id="4022682">s3</span><span class="op" id="4022684">,</span>&nbsp;<span class="ident" id="4022686">t0</span><span class="op" id="4022688">,</span>&nbsp;<span class="ident" id="4022690">t1</span><span class="op" id="4022692">,</span>&nbsp;<span class="ident" id="4022694">t2</span><span class="op" id="4022696">,</span>&nbsp;<span class="ident" id="4022698">t3</span>&nbsp;<span class="builtintype" id="4022701">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022710"><a href="/crypto/aes/block.go.html#4022670">s0</a></span>&nbsp;<span class="op" id="4022713">=</span>&nbsp;<span class="builtintype" id="4022715">uint32</span><span class="op" id="4022721">(</span><span class="ident" id="4022722"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022725">[</span><span class="num" id="4022726">0</span><span class="op" id="4022727">]</span><span class="op" id="4022728">)</span><span class="op" id="4022729">&lt;&lt;</span><span class="num" id="4022731">24</span>&nbsp;<span class="op" id="4022734">|</span>&nbsp;<span class="builtintype" id="4022736">uint32</span><span class="op" id="4022742">(</span><span class="ident" id="4022743"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022746">[</span><span class="num" id="4022747">1</span><span class="op" id="4022748">]</span><span class="op" id="4022749">)</span><span class="op" id="4022750">&lt;&lt;</span><span class="num" id="4022752">16</span>&nbsp;<span class="op" id="4022755">|</span>&nbsp;<span class="builtintype" id="4022757">uint32</span><span class="op" id="4022763">(</span><span class="ident" id="4022764"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022767">[</span><span class="num" id="4022768">2</span><span class="op" id="4022769">]</span><span class="op" id="4022770">)</span><span class="op" id="4022771">&lt;&lt;</span><span class="num" id="4022773">8</span>&nbsp;<span class="op" id="4022775">|</span>&nbsp;<span class="builtintype" id="4022777">uint32</span><span class="op" id="4022783">(</span><span class="ident" id="4022784"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022787">[</span><span class="num" id="4022788">3</span><span class="op" id="4022789">]</span><span class="op" id="4022790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022793"><a href="/crypto/aes/block.go.html#4022674">s1</a></span>&nbsp;<span class="op" id="4022796">=</span>&nbsp;<span class="builtintype" id="4022798">uint32</span><span class="op" id="4022804">(</span><span class="ident" id="4022805"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022808">[</span><span class="num" id="4022809">4</span><span class="op" id="4022810">]</span><span class="op" id="4022811">)</span><span class="op" id="4022812">&lt;&lt;</span><span class="num" id="4022814">24</span>&nbsp;<span class="op" id="4022817">|</span>&nbsp;<span class="builtintype" id="4022819">uint32</span><span class="op" id="4022825">(</span><span class="ident" id="4022826"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022829">[</span><span class="num" id="4022830">5</span><span class="op" id="4022831">]</span><span class="op" id="4022832">)</span><span class="op" id="4022833">&lt;&lt;</span><span class="num" id="4022835">16</span>&nbsp;<span class="op" id="4022838">|</span>&nbsp;<span class="builtintype" id="4022840">uint32</span><span class="op" id="4022846">(</span><span class="ident" id="4022847"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022850">[</span><span class="num" id="4022851">6</span><span class="op" id="4022852">]</span><span class="op" id="4022853">)</span><span class="op" id="4022854">&lt;&lt;</span><span class="num" id="4022856">8</span>&nbsp;<span class="op" id="4022858">|</span>&nbsp;<span class="builtintype" id="4022860">uint32</span><span class="op" id="4022866">(</span><span class="ident" id="4022867"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022870">[</span><span class="num" id="4022871">7</span><span class="op" id="4022872">]</span><span class="op" id="4022873">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022876"><a href="/crypto/aes/block.go.html#4022678">s2</a></span>&nbsp;<span class="op" id="4022879">=</span>&nbsp;<span class="builtintype" id="4022881">uint32</span><span class="op" id="4022887">(</span><span class="ident" id="4022888"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022891">[</span><span class="num" id="4022892">8</span><span class="op" id="4022893">]</span><span class="op" id="4022894">)</span><span class="op" id="4022895">&lt;&lt;</span><span class="num" id="4022897">24</span>&nbsp;<span class="op" id="4022900">|</span>&nbsp;<span class="builtintype" id="4022902">uint32</span><span class="op" id="4022908">(</span><span class="ident" id="4022909"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022912">[</span><span class="num" id="4022913">9</span><span class="op" id="4022914">]</span><span class="op" id="4022915">)</span><span class="op" id="4022916">&lt;&lt;</span><span class="num" id="4022918">16</span>&nbsp;<span class="op" id="4022921">|</span>&nbsp;<span class="builtintype" id="4022923">uint32</span><span class="op" id="4022929">(</span><span class="ident" id="4022930"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022933">[</span><span class="num" id="4022934">10</span><span class="op" id="4022936">]</span><span class="op" id="4022937">)</span><span class="op" id="4022938">&lt;&lt;</span><span class="num" id="4022940">8</span>&nbsp;<span class="op" id="4022942">|</span>&nbsp;<span class="builtintype" id="4022944">uint32</span><span class="op" id="4022950">(</span><span class="ident" id="4022951"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022954">[</span><span class="num" id="4022955">11</span><span class="op" id="4022957">]</span><span class="op" id="4022958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022961"><a href="/crypto/aes/block.go.html#4022682">s3</a></span>&nbsp;<span class="op" id="4022964">=</span>&nbsp;<span class="builtintype" id="4022966">uint32</span><span class="op" id="4022972">(</span><span class="ident" id="4022973"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022976">[</span><span class="num" id="4022977">12</span><span class="op" id="4022979">]</span><span class="op" id="4022980">)</span><span class="op" id="4022981">&lt;&lt;</span><span class="num" id="4022983">24</span>&nbsp;<span class="op" id="4022986">|</span>&nbsp;<span class="builtintype" id="4022988">uint32</span><span class="op" id="4022994">(</span><span class="ident" id="4022995"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4022998">[</span><span class="num" id="4022999">13</span><span class="op" id="4023001">]</span><span class="op" id="4023002">)</span><span class="op" id="4023003">&lt;&lt;</span><span class="num" id="4023005">16</span>&nbsp;<span class="op" id="4023008">|</span>&nbsp;<span class="builtintype" id="4023010">uint32</span><span class="op" id="4023016">(</span><span class="ident" id="4023017"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4023020">[</span><span class="num" id="4023021">14</span><span class="op" id="4023023">]</span><span class="op" id="4023024">)</span><span class="op" id="4023025">&lt;&lt;</span><span class="num" id="4023027">8</span>&nbsp;<span class="op" id="4023029">|</span>&nbsp;<span class="builtintype" id="4023031">uint32</span><span class="op" id="4023037">(</span><span class="ident" id="4023038"><a href="/crypto/aes/block.go.html#4022651">src</a></span><span class="op" id="4023041">[</span><span class="num" id="4023042">15</span><span class="op" id="4023044">]</span><span class="op" id="4023045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023049">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023091"><a href="/crypto/aes/block.go.html#4022670">s0</a></span>&nbsp;<span class="op" id="4023094">^=</span>&nbsp;<span class="ident" id="4023097"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023099">[</span><span class="num" id="4023100">0</span><span class="op" id="4023101">]</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023104"><a href="/crypto/aes/block.go.html#4022674">s1</a></span>&nbsp;<span class="op" id="4023107">^=</span>&nbsp;<span class="ident" id="4023110"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023112">[</span><span class="num" id="4023113">1</span><span class="op" id="4023114">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023117"><a href="/crypto/aes/block.go.html#4022678">s2</a></span>&nbsp;<span class="op" id="4023120">^=</span>&nbsp;<span class="ident" id="4023123"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023125">[</span><span class="num" id="4023126">2</span><span class="op" id="4023127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023130"><a href="/crypto/aes/block.go.html#4022682">s3</a></span>&nbsp;<span class="op" id="4023133">^=</span>&nbsp;<span class="ident" id="4023136"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023138">[</span><span class="num" id="4023139">3</span><span class="op" id="4023140">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023144">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023184">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023239">nr</span>&nbsp;<span class="op" id="4023242">:=</span>&nbsp;<span class="builtinfunc" id="4023245">len</span><span class="op" id="4023248">(</span><span class="ident" id="4023249"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023251">)</span><span class="op" id="4023252">/</span><span class="num" id="4023253">4</span>&nbsp;<span class="op" id="4023255">-</span>&nbsp;<span class="num" id="4023257">2</span>&nbsp;<span class="comment" id="4023259">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023294">k</span>&nbsp;<span class="op" id="4023296">:=</span>&nbsp;<span class="num" id="4023299">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023302">for</span>&nbsp;<span class="ident" id="4023306">r</span>&nbsp;<span class="op" id="4023308">:=</span>&nbsp;<span class="num" id="4023311">0</span><span class="op" id="4023312">;</span>&nbsp;<span class="ident" id="4023314"><a href="/crypto/aes/block.go.html#4023306">r</a></span>&nbsp;<span class="op" id="4023316">&lt;</span>&nbsp;<span class="ident" id="4023318"><a href="/crypto/aes/block.go.html#4023239">nr</a></span><span class="op" id="4023320">;</span>&nbsp;<span class="ident" id="4023322"><a href="/crypto/aes/block.go.html#4023306">r</a></span><span class="op" id="4023323">++</span>&nbsp;<span class="op" id="4023326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023330"><a href="/crypto/aes/block.go.html#4022686">t0</a></span>&nbsp;<span class="op" id="4023333">=</span>&nbsp;<span class="ident" id="4023335"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023337">[</span><span class="ident" id="4023338"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4023339">+</span><span class="num" id="4023340">0</span><span class="op" id="4023341">]</span>&nbsp;<span class="op" id="4023343">^</span>&nbsp;<span class="ident" id="4023345"><a href="/crypto/aes/const.go.html#4035071">te0</a></span><span class="op" id="4023348">[</span><span class="builtintype" id="4023349">uint8</span><span class="op" id="4023354">(</span><span class="ident" id="4023355"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4023357">&gt;&gt;</span><span class="num" id="4023359">24</span><span class="op" id="4023361">)</span><span class="op" id="4023362">]</span>&nbsp;<span class="op" id="4023364">^</span>&nbsp;<span class="ident" id="4023366"><a href="/crypto/aes/const.go.html#4038200">te1</a></span><span class="op" id="4023369">[</span><span class="builtintype" id="4023370">uint8</span><span class="op" id="4023375">(</span><span class="ident" id="4023376"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4023378">&gt;&gt;</span><span class="num" id="4023380">16</span><span class="op" id="4023382">)</span><span class="op" id="4023383">]</span>&nbsp;<span class="op" id="4023385">^</span>&nbsp;<span class="ident" id="4023387"><a href="/crypto/aes/const.go.html#4041329">te2</a></span><span class="op" id="4023390">[</span><span class="builtintype" id="4023391">uint8</span><span class="op" id="4023396">(</span><span class="ident" id="4023397"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4023399">&gt;&gt;</span><span class="num" id="4023401">8</span><span class="op" id="4023402">)</span><span class="op" id="4023403">]</span>&nbsp;<span class="op" id="4023405">^</span>&nbsp;<span class="ident" id="4023407"><a href="/crypto/aes/const.go.html#4044458">te3</a></span><span class="op" id="4023410">[</span><span class="builtintype" id="4023411">uint8</span><span class="op" id="4023416">(</span><span class="ident" id="4023417"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4023419">)</span><span class="op" id="4023420">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023424"><a href="/crypto/aes/block.go.html#4022690">t1</a></span>&nbsp;<span class="op" id="4023427">=</span>&nbsp;<span class="ident" id="4023429"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023431">[</span><span class="ident" id="4023432"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4023433">+</span><span class="num" id="4023434">1</span><span class="op" id="4023435">]</span>&nbsp;<span class="op" id="4023437">^</span>&nbsp;<span class="ident" id="4023439"><a href="/crypto/aes/const.go.html#4035071">te0</a></span><span class="op" id="4023442">[</span><span class="builtintype" id="4023443">uint8</span><span class="op" id="4023448">(</span><span class="ident" id="4023449"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4023451">&gt;&gt;</span><span class="num" id="4023453">24</span><span class="op" id="4023455">)</span><span class="op" id="4023456">]</span>&nbsp;<span class="op" id="4023458">^</span>&nbsp;<span class="ident" id="4023460"><a href="/crypto/aes/const.go.html#4038200">te1</a></span><span class="op" id="4023463">[</span><span class="builtintype" id="4023464">uint8</span><span class="op" id="4023469">(</span><span class="ident" id="4023470"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4023472">&gt;&gt;</span><span class="num" id="4023474">16</span><span class="op" id="4023476">)</span><span class="op" id="4023477">]</span>&nbsp;<span class="op" id="4023479">^</span>&nbsp;<span class="ident" id="4023481"><a href="/crypto/aes/const.go.html#4041329">te2</a></span><span class="op" id="4023484">[</span><span class="builtintype" id="4023485">uint8</span><span class="op" id="4023490">(</span><span class="ident" id="4023491"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4023493">&gt;&gt;</span><span class="num" id="4023495">8</span><span class="op" id="4023496">)</span><span class="op" id="4023497">]</span>&nbsp;<span class="op" id="4023499">^</span>&nbsp;<span class="ident" id="4023501"><a href="/crypto/aes/const.go.html#4044458">te3</a></span><span class="op" id="4023504">[</span><span class="builtintype" id="4023505">uint8</span><span class="op" id="4023510">(</span><span class="ident" id="4023511"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4023513">)</span><span class="op" id="4023514">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023518"><a href="/crypto/aes/block.go.html#4022694">t2</a></span>&nbsp;<span class="op" id="4023521">=</span>&nbsp;<span class="ident" id="4023523"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023525">[</span><span class="ident" id="4023526"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4023527">+</span><span class="num" id="4023528">2</span><span class="op" id="4023529">]</span>&nbsp;<span class="op" id="4023531">^</span>&nbsp;<span class="ident" id="4023533"><a href="/crypto/aes/const.go.html#4035071">te0</a></span><span class="op" id="4023536">[</span><span class="builtintype" id="4023537">uint8</span><span class="op" id="4023542">(</span><span class="ident" id="4023543"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4023545">&gt;&gt;</span><span class="num" id="4023547">24</span><span class="op" id="4023549">)</span><span class="op" id="4023550">]</span>&nbsp;<span class="op" id="4023552">^</span>&nbsp;<span class="ident" id="4023554"><a href="/crypto/aes/const.go.html#4038200">te1</a></span><span class="op" id="4023557">[</span><span class="builtintype" id="4023558">uint8</span><span class="op" id="4023563">(</span><span class="ident" id="4023564"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4023566">&gt;&gt;</span><span class="num" id="4023568">16</span><span class="op" id="4023570">)</span><span class="op" id="4023571">]</span>&nbsp;<span class="op" id="4023573">^</span>&nbsp;<span class="ident" id="4023575"><a href="/crypto/aes/const.go.html#4041329">te2</a></span><span class="op" id="4023578">[</span><span class="builtintype" id="4023579">uint8</span><span class="op" id="4023584">(</span><span class="ident" id="4023585"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4023587">&gt;&gt;</span><span class="num" id="4023589">8</span><span class="op" id="4023590">)</span><span class="op" id="4023591">]</span>&nbsp;<span class="op" id="4023593">^</span>&nbsp;<span class="ident" id="4023595"><a href="/crypto/aes/const.go.html#4044458">te3</a></span><span class="op" id="4023598">[</span><span class="builtintype" id="4023599">uint8</span><span class="op" id="4023604">(</span><span class="ident" id="4023605"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4023607">)</span><span class="op" id="4023608">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023612"><a href="/crypto/aes/block.go.html#4022698">t3</a></span>&nbsp;<span class="op" id="4023615">=</span>&nbsp;<span class="ident" id="4023617"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4023619">[</span><span class="ident" id="4023620"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4023621">+</span><span class="num" id="4023622">3</span><span class="op" id="4023623">]</span>&nbsp;<span class="op" id="4023625">^</span>&nbsp;<span class="ident" id="4023627"><a href="/crypto/aes/const.go.html#4035071">te0</a></span><span class="op" id="4023630">[</span><span class="builtintype" id="4023631">uint8</span><span class="op" id="4023636">(</span><span class="ident" id="4023637"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4023639">&gt;&gt;</span><span class="num" id="4023641">24</span><span class="op" id="4023643">)</span><span class="op" id="4023644">]</span>&nbsp;<span class="op" id="4023646">^</span>&nbsp;<span class="ident" id="4023648"><a href="/crypto/aes/const.go.html#4038200">te1</a></span><span class="op" id="4023651">[</span><span class="builtintype" id="4023652">uint8</span><span class="op" id="4023657">(</span><span class="ident" id="4023658"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4023660">&gt;&gt;</span><span class="num" id="4023662">16</span><span class="op" id="4023664">)</span><span class="op" id="4023665">]</span>&nbsp;<span class="op" id="4023667">^</span>&nbsp;<span class="ident" id="4023669"><a href="/crypto/aes/const.go.html#4041329">te2</a></span><span class="op" id="4023672">[</span><span class="builtintype" id="4023673">uint8</span><span class="op" id="4023678">(</span><span class="ident" id="4023679"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4023681">&gt;&gt;</span><span class="num" id="4023683">8</span><span class="op" id="4023684">)</span><span class="op" id="4023685">]</span>&nbsp;<span class="op" id="4023687">^</span>&nbsp;<span class="ident" id="4023689"><a href="/crypto/aes/const.go.html#4044458">te3</a></span><span class="op" id="4023692">[</span><span class="builtintype" id="4023693">uint8</span><span class="op" id="4023698">(</span><span class="ident" id="4023699"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4023701">)</span><span class="op" id="4023702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023706"><a href="/crypto/aes/block.go.html#4023294">k</a></span>&nbsp;<span class="op" id="4023708">+=</span>&nbsp;<span class="num" id="4023711">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023715"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4023717">,</span>&nbsp;<span class="ident" id="4023719"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4023721">,</span>&nbsp;<span class="ident" id="4023723"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4023725">,</span>&nbsp;<span class="ident" id="4023727"><a href="/crypto/aes/block.go.html#4022682">s3</a></span>&nbsp;<span class="op" id="4023730">=</span>&nbsp;<span class="ident" id="4023732"><a href="/crypto/aes/block.go.html#4022686">t0</a></span><span class="op" id="4023734">,</span>&nbsp;<span class="ident" id="4023736"><a href="/crypto/aes/block.go.html#4022690">t1</a></span><span class="op" id="4023738">,</span>&nbsp;<span class="ident" id="4023740"><a href="/crypto/aes/block.go.html#4022694">t2</a></span><span class="op" id="4023742">,</span>&nbsp;<span class="ident" id="4023744"><a href="/crypto/aes/block.go.html#4022698">t3</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4023752">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023815"><a href="/crypto/aes/block.go.html#4022670">s0</a></span>&nbsp;<span class="op" id="4023818">=</span>&nbsp;<span class="builtintype" id="4023820">uint32</span><span class="op" id="4023826">(</span><span class="ident" id="4023827"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4023832">[</span><span class="ident" id="4023833"><a href="/crypto/aes/block.go.html#4022686">t0</a></span><span class="op" id="4023835">&gt;&gt;</span><span class="num" id="4023837">24</span><span class="op" id="4023839">]</span><span class="op" id="4023840">)</span><span class="op" id="4023841">&lt;&lt;</span><span class="num" id="4023843">24</span>&nbsp;<span class="op" id="4023846">|</span>&nbsp;<span class="builtintype" id="4023848">uint32</span><span class="op" id="4023854">(</span><span class="ident" id="4023855"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4023860">[</span><span class="ident" id="4023861"><a href="/crypto/aes/block.go.html#4022690">t1</a></span><span class="op" id="4023863">&gt;&gt;</span><span class="num" id="4023865">16</span><span class="op" id="4023867">&amp;</span><span class="num" id="4023868">0xff</span><span class="op" id="4023872">]</span><span class="op" id="4023873">)</span><span class="op" id="4023874">&lt;&lt;</span><span class="num" id="4023876">16</span>&nbsp;<span class="op" id="4023879">|</span>&nbsp;<span class="builtintype" id="4023881">uint32</span><span class="op" id="4023887">(</span><span class="ident" id="4023888"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4023893">[</span><span class="ident" id="4023894"><a href="/crypto/aes/block.go.html#4022694">t2</a></span><span class="op" id="4023896">&gt;&gt;</span><span class="num" id="4023898">8</span><span class="op" id="4023899">&amp;</span><span class="num" id="4023900">0xff</span><span class="op" id="4023904">]</span><span class="op" id="4023905">)</span><span class="op" id="4023906">&lt;&lt;</span><span class="num" id="4023908">8</span>&nbsp;<span class="op" id="4023910">|</span>&nbsp;<span class="builtintype" id="4023912">uint32</span><span class="op" id="4023918">(</span><span class="ident" id="4023919"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4023924">[</span><span class="ident" id="4023925"><a href="/crypto/aes/block.go.html#4022698">t3</a></span><span class="op" id="4023927">&amp;</span><span class="num" id="4023928">0xff</span><span class="op" id="4023932">]</span><span class="op" id="4023933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023936"><a href="/crypto/aes/block.go.html#4022674">s1</a></span>&nbsp;<span class="op" id="4023939">=</span>&nbsp;<span class="builtintype" id="4023941">uint32</span><span class="op" id="4023947">(</span><span class="ident" id="4023948"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4023953">[</span><span class="ident" id="4023954"><a href="/crypto/aes/block.go.html#4022690">t1</a></span><span class="op" id="4023956">&gt;&gt;</span><span class="num" id="4023958">24</span><span class="op" id="4023960">]</span><span class="op" id="4023961">)</span><span class="op" id="4023962">&lt;&lt;</span><span class="num" id="4023964">24</span>&nbsp;<span class="op" id="4023967">|</span>&nbsp;<span class="builtintype" id="4023969">uint32</span><span class="op" id="4023975">(</span><span class="ident" id="4023976"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4023981">[</span><span class="ident" id="4023982"><a href="/crypto/aes/block.go.html#4022694">t2</a></span><span class="op" id="4023984">&gt;&gt;</span><span class="num" id="4023986">16</span><span class="op" id="4023988">&amp;</span><span class="num" id="4023989">0xff</span><span class="op" id="4023993">]</span><span class="op" id="4023994">)</span><span class="op" id="4023995">&lt;&lt;</span><span class="num" id="4023997">16</span>&nbsp;<span class="op" id="4024000">|</span>&nbsp;<span class="builtintype" id="4024002">uint32</span><span class="op" id="4024008">(</span><span class="ident" id="4024009"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024014">[</span><span class="ident" id="4024015"><a href="/crypto/aes/block.go.html#4022698">t3</a></span><span class="op" id="4024017">&gt;&gt;</span><span class="num" id="4024019">8</span><span class="op" id="4024020">&amp;</span><span class="num" id="4024021">0xff</span><span class="op" id="4024025">]</span><span class="op" id="4024026">)</span><span class="op" id="4024027">&lt;&lt;</span><span class="num" id="4024029">8</span>&nbsp;<span class="op" id="4024031">|</span>&nbsp;<span class="builtintype" id="4024033">uint32</span><span class="op" id="4024039">(</span><span class="ident" id="4024040"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024045">[</span><span class="ident" id="4024046"><a href="/crypto/aes/block.go.html#4022686">t0</a></span><span class="op" id="4024048">&amp;</span><span class="num" id="4024049">0xff</span><span class="op" id="4024053">]</span><span class="op" id="4024054">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024057"><a href="/crypto/aes/block.go.html#4022678">s2</a></span>&nbsp;<span class="op" id="4024060">=</span>&nbsp;<span class="builtintype" id="4024062">uint32</span><span class="op" id="4024068">(</span><span class="ident" id="4024069"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024074">[</span><span class="ident" id="4024075"><a href="/crypto/aes/block.go.html#4022694">t2</a></span><span class="op" id="4024077">&gt;&gt;</span><span class="num" id="4024079">24</span><span class="op" id="4024081">]</span><span class="op" id="4024082">)</span><span class="op" id="4024083">&lt;&lt;</span><span class="num" id="4024085">24</span>&nbsp;<span class="op" id="4024088">|</span>&nbsp;<span class="builtintype" id="4024090">uint32</span><span class="op" id="4024096">(</span><span class="ident" id="4024097"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024102">[</span><span class="ident" id="4024103"><a href="/crypto/aes/block.go.html#4022698">t3</a></span><span class="op" id="4024105">&gt;&gt;</span><span class="num" id="4024107">16</span><span class="op" id="4024109">&amp;</span><span class="num" id="4024110">0xff</span><span class="op" id="4024114">]</span><span class="op" id="4024115">)</span><span class="op" id="4024116">&lt;&lt;</span><span class="num" id="4024118">16</span>&nbsp;<span class="op" id="4024121">|</span>&nbsp;<span class="builtintype" id="4024123">uint32</span><span class="op" id="4024129">(</span><span class="ident" id="4024130"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024135">[</span><span class="ident" id="4024136"><a href="/crypto/aes/block.go.html#4022686">t0</a></span><span class="op" id="4024138">&gt;&gt;</span><span class="num" id="4024140">8</span><span class="op" id="4024141">&amp;</span><span class="num" id="4024142">0xff</span><span class="op" id="4024146">]</span><span class="op" id="4024147">)</span><span class="op" id="4024148">&lt;&lt;</span><span class="num" id="4024150">8</span>&nbsp;<span class="op" id="4024152">|</span>&nbsp;<span class="builtintype" id="4024154">uint32</span><span class="op" id="4024160">(</span><span class="ident" id="4024161"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024166">[</span><span class="ident" id="4024167"><a href="/crypto/aes/block.go.html#4022690">t1</a></span><span class="op" id="4024169">&amp;</span><span class="num" id="4024170">0xff</span><span class="op" id="4024174">]</span><span class="op" id="4024175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024178"><a href="/crypto/aes/block.go.html#4022682">s3</a></span>&nbsp;<span class="op" id="4024181">=</span>&nbsp;<span class="builtintype" id="4024183">uint32</span><span class="op" id="4024189">(</span><span class="ident" id="4024190"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024195">[</span><span class="ident" id="4024196"><a href="/crypto/aes/block.go.html#4022698">t3</a></span><span class="op" id="4024198">&gt;&gt;</span><span class="num" id="4024200">24</span><span class="op" id="4024202">]</span><span class="op" id="4024203">)</span><span class="op" id="4024204">&lt;&lt;</span><span class="num" id="4024206">24</span>&nbsp;<span class="op" id="4024209">|</span>&nbsp;<span class="builtintype" id="4024211">uint32</span><span class="op" id="4024217">(</span><span class="ident" id="4024218"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024223">[</span><span class="ident" id="4024224"><a href="/crypto/aes/block.go.html#4022686">t0</a></span><span class="op" id="4024226">&gt;&gt;</span><span class="num" id="4024228">16</span><span class="op" id="4024230">&amp;</span><span class="num" id="4024231">0xff</span><span class="op" id="4024235">]</span><span class="op" id="4024236">)</span><span class="op" id="4024237">&lt;&lt;</span><span class="num" id="4024239">16</span>&nbsp;<span class="op" id="4024242">|</span>&nbsp;<span class="builtintype" id="4024244">uint32</span><span class="op" id="4024250">(</span><span class="ident" id="4024251"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024256">[</span><span class="ident" id="4024257"><a href="/crypto/aes/block.go.html#4022690">t1</a></span><span class="op" id="4024259">&gt;&gt;</span><span class="num" id="4024261">8</span><span class="op" id="4024262">&amp;</span><span class="num" id="4024263">0xff</span><span class="op" id="4024267">]</span><span class="op" id="4024268">)</span><span class="op" id="4024269">&lt;&lt;</span><span class="num" id="4024271">8</span>&nbsp;<span class="op" id="4024273">|</span>&nbsp;<span class="builtintype" id="4024275">uint32</span><span class="op" id="4024281">(</span><span class="ident" id="4024282"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4024287">[</span><span class="ident" id="4024288"><a href="/crypto/aes/block.go.html#4022694">t2</a></span><span class="op" id="4024290">&amp;</span><span class="num" id="4024291">0xff</span><span class="op" id="4024295">]</span><span class="op" id="4024296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024300"><a href="/crypto/aes/block.go.html#4022670">s0</a></span>&nbsp;<span class="op" id="4024303">^=</span>&nbsp;<span class="ident" id="4024306"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4024308">[</span><span class="ident" id="4024309"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4024310">+</span><span class="num" id="4024311">0</span><span class="op" id="4024312">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024315"><a href="/crypto/aes/block.go.html#4022674">s1</a></span>&nbsp;<span class="op" id="4024318">^=</span>&nbsp;<span class="ident" id="4024321"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4024323">[</span><span class="ident" id="4024324"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4024325">+</span><span class="num" id="4024326">1</span><span class="op" id="4024327">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024330"><a href="/crypto/aes/block.go.html#4022678">s2</a></span>&nbsp;<span class="op" id="4024333">^=</span>&nbsp;<span class="ident" id="4024336"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4024338">[</span><span class="ident" id="4024339"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4024340">+</span><span class="num" id="4024341">2</span><span class="op" id="4024342">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024345"><a href="/crypto/aes/block.go.html#4022682">s3</a></span>&nbsp;<span class="op" id="4024348">^=</span>&nbsp;<span class="ident" id="4024351"><a href="/crypto/aes/block.go.html#4022633">xk</a></span><span class="op" id="4024353">[</span><span class="ident" id="4024354"><a href="/crypto/aes/block.go.html#4023294">k</a></span><span class="op" id="4024355">+</span><span class="num" id="4024356">3</span><span class="op" id="4024357">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024361"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024364">[</span><span class="num" id="4024365">0</span><span class="op" id="4024366">]</span><span class="op" id="4024367">,</span>&nbsp;<span class="ident" id="4024369"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024372">[</span><span class="num" id="4024373">1</span><span class="op" id="4024374">]</span><span class="op" id="4024375">,</span>&nbsp;<span class="ident" id="4024377"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024380">[</span><span class="num" id="4024381">2</span><span class="op" id="4024382">]</span><span class="op" id="4024383">,</span>&nbsp;<span class="ident" id="4024385"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024388">[</span><span class="num" id="4024389">3</span><span class="op" id="4024390">]</span>&nbsp;<span class="op" id="4024392">=</span>&nbsp;<span class="builtintype" id="4024394">byte</span><span class="op" id="4024398">(</span><span class="ident" id="4024399"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4024401">&gt;&gt;</span><span class="num" id="4024403">24</span><span class="op" id="4024405">)</span><span class="op" id="4024406">,</span>&nbsp;<span class="builtintype" id="4024408">byte</span><span class="op" id="4024412">(</span><span class="ident" id="4024413"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4024415">&gt;&gt;</span><span class="num" id="4024417">16</span><span class="op" id="4024419">)</span><span class="op" id="4024420">,</span>&nbsp;<span class="builtintype" id="4024422">byte</span><span class="op" id="4024426">(</span><span class="ident" id="4024427"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4024429">&gt;&gt;</span><span class="num" id="4024431">8</span><span class="op" id="4024432">)</span><span class="op" id="4024433">,</span>&nbsp;<span class="builtintype" id="4024435">byte</span><span class="op" id="4024439">(</span><span class="ident" id="4024440"><a href="/crypto/aes/block.go.html#4022670">s0</a></span><span class="op" id="4024442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024445"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024448">[</span><span class="num" id="4024449">4</span><span class="op" id="4024450">]</span><span class="op" id="4024451">,</span>&nbsp;<span class="ident" id="4024453"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024456">[</span><span class="num" id="4024457">5</span><span class="op" id="4024458">]</span><span class="op" id="4024459">,</span>&nbsp;<span class="ident" id="4024461"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024464">[</span><span class="num" id="4024465">6</span><span class="op" id="4024466">]</span><span class="op" id="4024467">,</span>&nbsp;<span class="ident" id="4024469"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024472">[</span><span class="num" id="4024473">7</span><span class="op" id="4024474">]</span>&nbsp;<span class="op" id="4024476">=</span>&nbsp;<span class="builtintype" id="4024478">byte</span><span class="op" id="4024482">(</span><span class="ident" id="4024483"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4024485">&gt;&gt;</span><span class="num" id="4024487">24</span><span class="op" id="4024489">)</span><span class="op" id="4024490">,</span>&nbsp;<span class="builtintype" id="4024492">byte</span><span class="op" id="4024496">(</span><span class="ident" id="4024497"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4024499">&gt;&gt;</span><span class="num" id="4024501">16</span><span class="op" id="4024503">)</span><span class="op" id="4024504">,</span>&nbsp;<span class="builtintype" id="4024506">byte</span><span class="op" id="4024510">(</span><span class="ident" id="4024511"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4024513">&gt;&gt;</span><span class="num" id="4024515">8</span><span class="op" id="4024516">)</span><span class="op" id="4024517">,</span>&nbsp;<span class="builtintype" id="4024519">byte</span><span class="op" id="4024523">(</span><span class="ident" id="4024524"><a href="/crypto/aes/block.go.html#4022674">s1</a></span><span class="op" id="4024526">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024529"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024532">[</span><span class="num" id="4024533">8</span><span class="op" id="4024534">]</span><span class="op" id="4024535">,</span>&nbsp;<span class="ident" id="4024537"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024540">[</span><span class="num" id="4024541">9</span><span class="op" id="4024542">]</span><span class="op" id="4024543">,</span>&nbsp;<span class="ident" id="4024545"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024548">[</span><span class="num" id="4024549">10</span><span class="op" id="4024551">]</span><span class="op" id="4024552">,</span>&nbsp;<span class="ident" id="4024554"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024557">[</span><span class="num" id="4024558">11</span><span class="op" id="4024560">]</span>&nbsp;<span class="op" id="4024562">=</span>&nbsp;<span class="builtintype" id="4024564">byte</span><span class="op" id="4024568">(</span><span class="ident" id="4024569"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4024571">&gt;&gt;</span><span class="num" id="4024573">24</span><span class="op" id="4024575">)</span><span class="op" id="4024576">,</span>&nbsp;<span class="builtintype" id="4024578">byte</span><span class="op" id="4024582">(</span><span class="ident" id="4024583"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4024585">&gt;&gt;</span><span class="num" id="4024587">16</span><span class="op" id="4024589">)</span><span class="op" id="4024590">,</span>&nbsp;<span class="builtintype" id="4024592">byte</span><span class="op" id="4024596">(</span><span class="ident" id="4024597"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4024599">&gt;&gt;</span><span class="num" id="4024601">8</span><span class="op" id="4024602">)</span><span class="op" id="4024603">,</span>&nbsp;<span class="builtintype" id="4024605">byte</span><span class="op" id="4024609">(</span><span class="ident" id="4024610"><a href="/crypto/aes/block.go.html#4022678">s2</a></span><span class="op" id="4024612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024615"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024618">[</span><span class="num" id="4024619">12</span><span class="op" id="4024621">]</span><span class="op" id="4024622">,</span>&nbsp;<span class="ident" id="4024624"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024627">[</span><span class="num" id="4024628">13</span><span class="op" id="4024630">]</span><span class="op" id="4024631">,</span>&nbsp;<span class="ident" id="4024633"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024636">[</span><span class="num" id="4024637">14</span><span class="op" id="4024639">]</span><span class="op" id="4024640">,</span>&nbsp;<span class="ident" id="4024642"><a href="/crypto/aes/block.go.html#4022646">dst</a></span><span class="op" id="4024645">[</span><span class="num" id="4024646">15</span><span class="op" id="4024648">]</span>&nbsp;<span class="op" id="4024650">=</span>&nbsp;<span class="builtintype" id="4024652">byte</span><span class="op" id="4024656">(</span><span class="ident" id="4024657"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4024659">&gt;&gt;</span><span class="num" id="4024661">24</span><span class="op" id="4024663">)</span><span class="op" id="4024664">,</span>&nbsp;<span class="builtintype" id="4024666">byte</span><span class="op" id="4024670">(</span><span class="ident" id="4024671"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4024673">&gt;&gt;</span><span class="num" id="4024675">16</span><span class="op" id="4024677">)</span><span class="op" id="4024678">,</span>&nbsp;<span class="builtintype" id="4024680">byte</span><span class="op" id="4024684">(</span><span class="ident" id="4024685"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4024687">&gt;&gt;</span><span class="num" id="4024689">8</span><span class="op" id="4024690">)</span><span class="op" id="4024691">,</span>&nbsp;<span class="builtintype" id="4024693">byte</span><span class="op" id="4024697">(</span><span class="ident" id="4024698"><a href="/crypto/aes/block.go.html#4022682">s3</a></span><span class="op" id="4024700">)</span><br>
<span class="lineno"></span><span class="op" id="4024702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4024705">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">85</span><span class="keyword" id="4024772">func</span>&nbsp;<span class="ident" id="4024777">decryptBlockGo</span><span class="op" id="4024791">(</span><span class="ident" id="4024792">xk</span>&nbsp;<span class="op" id="4024795">[</span><span class="op" id="4024796">]</span><span class="builtintype" id="4024797">uint32</span><span class="op" id="4024803">,</span>&nbsp;<span class="ident" id="4024805">dst</span><span class="op" id="4024808">,</span>&nbsp;<span class="ident" id="4024810">src</span>&nbsp;<span class="op" id="4024814">[</span><span class="op" id="4024815">]</span><span class="builtintype" id="4024816">byte</span><span class="op" id="4024820">)</span>&nbsp;<span class="op" id="4024822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024825">var</span>&nbsp;<span class="ident" id="4024829">s0</span><span class="op" id="4024831">,</span>&nbsp;<span class="ident" id="4024833">s1</span><span class="op" id="4024835">,</span>&nbsp;<span class="ident" id="4024837">s2</span><span class="op" id="4024839">,</span>&nbsp;<span class="ident" id="4024841">s3</span><span class="op" id="4024843">,</span>&nbsp;<span class="ident" id="4024845">t0</span><span class="op" id="4024847">,</span>&nbsp;<span class="ident" id="4024849">t1</span><span class="op" id="4024851">,</span>&nbsp;<span class="ident" id="4024853">t2</span><span class="op" id="4024855">,</span>&nbsp;<span class="ident" id="4024857">t3</span>&nbsp;<span class="builtintype" id="4024860">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024869"><a href="/crypto/aes/block.go.html#4024829">s0</a></span>&nbsp;<span class="op" id="4024872">=</span>&nbsp;<span class="builtintype" id="4024874">uint32</span><span class="op" id="4024880">(</span><span class="ident" id="4024881"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4024884">[</span><span class="num" id="4024885">0</span><span class="op" id="4024886">]</span><span class="op" id="4024887">)</span><span class="op" id="4024888">&lt;&lt;</span><span class="num" id="4024890">24</span>&nbsp;<span class="op" id="4024893">|</span>&nbsp;<span class="builtintype" id="4024895">uint32</span><span class="op" id="4024901">(</span><span class="ident" id="4024902"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4024905">[</span><span class="num" id="4024906">1</span><span class="op" id="4024907">]</span><span class="op" id="4024908">)</span><span class="op" id="4024909">&lt;&lt;</span><span class="num" id="4024911">16</span>&nbsp;<span class="op" id="4024914">|</span>&nbsp;<span class="builtintype" id="4024916">uint32</span><span class="op" id="4024922">(</span><span class="ident" id="4024923"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4024926">[</span><span class="num" id="4024927">2</span><span class="op" id="4024928">]</span><span class="op" id="4024929">)</span><span class="op" id="4024930">&lt;&lt;</span><span class="num" id="4024932">8</span>&nbsp;<span class="op" id="4024934">|</span>&nbsp;<span class="builtintype" id="4024936">uint32</span><span class="op" id="4024942">(</span><span class="ident" id="4024943"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4024946">[</span><span class="num" id="4024947">3</span><span class="op" id="4024948">]</span><span class="op" id="4024949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024952"><a href="/crypto/aes/block.go.html#4024833">s1</a></span>&nbsp;<span class="op" id="4024955">=</span>&nbsp;<span class="builtintype" id="4024957">uint32</span><span class="op" id="4024963">(</span><span class="ident" id="4024964"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4024967">[</span><span class="num" id="4024968">4</span><span class="op" id="4024969">]</span><span class="op" id="4024970">)</span><span class="op" id="4024971">&lt;&lt;</span><span class="num" id="4024973">24</span>&nbsp;<span class="op" id="4024976">|</span>&nbsp;<span class="builtintype" id="4024978">uint32</span><span class="op" id="4024984">(</span><span class="ident" id="4024985"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4024988">[</span><span class="num" id="4024989">5</span><span class="op" id="4024990">]</span><span class="op" id="4024991">)</span><span class="op" id="4024992">&lt;&lt;</span><span class="num" id="4024994">16</span>&nbsp;<span class="op" id="4024997">|</span>&nbsp;<span class="builtintype" id="4024999">uint32</span><span class="op" id="4025005">(</span><span class="ident" id="4025006"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025009">[</span><span class="num" id="4025010">6</span><span class="op" id="4025011">]</span><span class="op" id="4025012">)</span><span class="op" id="4025013">&lt;&lt;</span><span class="num" id="4025015">8</span>&nbsp;<span class="op" id="4025017">|</span>&nbsp;<span class="builtintype" id="4025019">uint32</span><span class="op" id="4025025">(</span><span class="ident" id="4025026"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025029">[</span><span class="num" id="4025030">7</span><span class="op" id="4025031">]</span><span class="op" id="4025032">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025035"><a href="/crypto/aes/block.go.html#4024837">s2</a></span>&nbsp;<span class="op" id="4025038">=</span>&nbsp;<span class="builtintype" id="4025040">uint32</span><span class="op" id="4025046">(</span><span class="ident" id="4025047"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025050">[</span><span class="num" id="4025051">8</span><span class="op" id="4025052">]</span><span class="op" id="4025053">)</span><span class="op" id="4025054">&lt;&lt;</span><span class="num" id="4025056">24</span>&nbsp;<span class="op" id="4025059">|</span>&nbsp;<span class="builtintype" id="4025061">uint32</span><span class="op" id="4025067">(</span><span class="ident" id="4025068"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025071">[</span><span class="num" id="4025072">9</span><span class="op" id="4025073">]</span><span class="op" id="4025074">)</span><span class="op" id="4025075">&lt;&lt;</span><span class="num" id="4025077">16</span>&nbsp;<span class="op" id="4025080">|</span>&nbsp;<span class="builtintype" id="4025082">uint32</span><span class="op" id="4025088">(</span><span class="ident" id="4025089"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025092">[</span><span class="num" id="4025093">10</span><span class="op" id="4025095">]</span><span class="op" id="4025096">)</span><span class="op" id="4025097">&lt;&lt;</span><span class="num" id="4025099">8</span>&nbsp;<span class="op" id="4025101">|</span>&nbsp;<span class="builtintype" id="4025103">uint32</span><span class="op" id="4025109">(</span><span class="ident" id="4025110"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025113">[</span><span class="num" id="4025114">11</span><span class="op" id="4025116">]</span><span class="op" id="4025117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025120"><a href="/crypto/aes/block.go.html#4024841">s3</a></span>&nbsp;<span class="op" id="4025123">=</span>&nbsp;<span class="builtintype" id="4025125">uint32</span><span class="op" id="4025131">(</span><span class="ident" id="4025132"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025135">[</span><span class="num" id="4025136">12</span><span class="op" id="4025138">]</span><span class="op" id="4025139">)</span><span class="op" id="4025140">&lt;&lt;</span><span class="num" id="4025142">24</span>&nbsp;<span class="op" id="4025145">|</span>&nbsp;<span class="builtintype" id="4025147">uint32</span><span class="op" id="4025153">(</span><span class="ident" id="4025154"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025157">[</span><span class="num" id="4025158">13</span><span class="op" id="4025160">]</span><span class="op" id="4025161">)</span><span class="op" id="4025162">&lt;&lt;</span><span class="num" id="4025164">16</span>&nbsp;<span class="op" id="4025167">|</span>&nbsp;<span class="builtintype" id="4025169">uint32</span><span class="op" id="4025175">(</span><span class="ident" id="4025176"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025179">[</span><span class="num" id="4025180">14</span><span class="op" id="4025182">]</span><span class="op" id="4025183">)</span><span class="op" id="4025184">&lt;&lt;</span><span class="num" id="4025186">8</span>&nbsp;<span class="op" id="4025188">|</span>&nbsp;<span class="builtintype" id="4025190">uint32</span><span class="op" id="4025196">(</span><span class="ident" id="4025197"><a href="/crypto/aes/block.go.html#4024810">src</a></span><span class="op" id="4025200">[</span><span class="num" id="4025201">15</span><span class="op" id="4025203">]</span><span class="op" id="4025204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025208">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025250"><a href="/crypto/aes/block.go.html#4024829">s0</a></span>&nbsp;<span class="op" id="4025253">^=</span>&nbsp;<span class="ident" id="4025256"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025258">[</span><span class="num" id="4025259">0</span><span class="op" id="4025260">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025263"><a href="/crypto/aes/block.go.html#4024833">s1</a></span>&nbsp;<span class="op" id="4025266">^=</span>&nbsp;<span class="ident" id="4025269"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025271">[</span><span class="num" id="4025272">1</span><span class="op" id="4025273">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025276"><a href="/crypto/aes/block.go.html#4024837">s2</a></span>&nbsp;<span class="op" id="4025279">^=</span>&nbsp;<span class="ident" id="4025282"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025284">[</span><span class="num" id="4025285">2</span><span class="op" id="4025286">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025289"><a href="/crypto/aes/block.go.html#4024841">s3</a></span>&nbsp;<span class="op" id="4025292">^=</span>&nbsp;<span class="ident" id="4025295"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025297">[</span><span class="num" id="4025298">3</span><span class="op" id="4025299">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025303">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025343">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025398">nr</span>&nbsp;<span class="op" id="4025401">:=</span>&nbsp;<span class="builtinfunc" id="4025404">len</span><span class="op" id="4025407">(</span><span class="ident" id="4025408"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025410">)</span><span class="op" id="4025411">/</span><span class="num" id="4025412">4</span>&nbsp;<span class="op" id="4025414">-</span>&nbsp;<span class="num" id="4025416">2</span>&nbsp;<span class="comment" id="4025418">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025453">k</span>&nbsp;<span class="op" id="4025455">:=</span>&nbsp;<span class="num" id="4025458">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025461">for</span>&nbsp;<span class="ident" id="4025465">r</span>&nbsp;<span class="op" id="4025467">:=</span>&nbsp;<span class="num" id="4025470">0</span><span class="op" id="4025471">;</span>&nbsp;<span class="ident" id="4025473"><a href="/crypto/aes/block.go.html#4025465">r</a></span>&nbsp;<span class="op" id="4025475">&lt;</span>&nbsp;<span class="ident" id="4025477"><a href="/crypto/aes/block.go.html#4025398">nr</a></span><span class="op" id="4025479">;</span>&nbsp;<span class="ident" id="4025481"><a href="/crypto/aes/block.go.html#4025465">r</a></span><span class="op" id="4025482">++</span>&nbsp;<span class="op" id="4025485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025489"><a href="/crypto/aes/block.go.html#4024845">t0</a></span>&nbsp;<span class="op" id="4025492">=</span>&nbsp;<span class="ident" id="4025494"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025496">[</span><span class="ident" id="4025497"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4025498">+</span><span class="num" id="4025499">0</span><span class="op" id="4025500">]</span>&nbsp;<span class="op" id="4025502">^</span>&nbsp;<span class="ident" id="4025504"><a href="/crypto/aes/const.go.html#4047687">td0</a></span><span class="op" id="4025507">[</span><span class="builtintype" id="4025508">uint8</span><span class="op" id="4025513">(</span><span class="ident" id="4025514"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4025516">&gt;&gt;</span><span class="num" id="4025518">24</span><span class="op" id="4025520">)</span><span class="op" id="4025521">]</span>&nbsp;<span class="op" id="4025523">^</span>&nbsp;<span class="ident" id="4025525"><a href="/crypto/aes/const.go.html#4050816">td1</a></span><span class="op" id="4025528">[</span><span class="builtintype" id="4025529">uint8</span><span class="op" id="4025534">(</span><span class="ident" id="4025535"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4025537">&gt;&gt;</span><span class="num" id="4025539">16</span><span class="op" id="4025541">)</span><span class="op" id="4025542">]</span>&nbsp;<span class="op" id="4025544">^</span>&nbsp;<span class="ident" id="4025546"><a href="/crypto/aes/const.go.html#4053945">td2</a></span><span class="op" id="4025549">[</span><span class="builtintype" id="4025550">uint8</span><span class="op" id="4025555">(</span><span class="ident" id="4025556"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4025558">&gt;&gt;</span><span class="num" id="4025560">8</span><span class="op" id="4025561">)</span><span class="op" id="4025562">]</span>&nbsp;<span class="op" id="4025564">^</span>&nbsp;<span class="ident" id="4025566"><a href="/crypto/aes/const.go.html#4057074">td3</a></span><span class="op" id="4025569">[</span><span class="builtintype" id="4025570">uint8</span><span class="op" id="4025575">(</span><span class="ident" id="4025576"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4025578">)</span><span class="op" id="4025579">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025583"><a href="/crypto/aes/block.go.html#4024849">t1</a></span>&nbsp;<span class="op" id="4025586">=</span>&nbsp;<span class="ident" id="4025588"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025590">[</span><span class="ident" id="4025591"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4025592">+</span><span class="num" id="4025593">1</span><span class="op" id="4025594">]</span>&nbsp;<span class="op" id="4025596">^</span>&nbsp;<span class="ident" id="4025598"><a href="/crypto/aes/const.go.html#4047687">td0</a></span><span class="op" id="4025601">[</span><span class="builtintype" id="4025602">uint8</span><span class="op" id="4025607">(</span><span class="ident" id="4025608"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4025610">&gt;&gt;</span><span class="num" id="4025612">24</span><span class="op" id="4025614">)</span><span class="op" id="4025615">]</span>&nbsp;<span class="op" id="4025617">^</span>&nbsp;<span class="ident" id="4025619"><a href="/crypto/aes/const.go.html#4050816">td1</a></span><span class="op" id="4025622">[</span><span class="builtintype" id="4025623">uint8</span><span class="op" id="4025628">(</span><span class="ident" id="4025629"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4025631">&gt;&gt;</span><span class="num" id="4025633">16</span><span class="op" id="4025635">)</span><span class="op" id="4025636">]</span>&nbsp;<span class="op" id="4025638">^</span>&nbsp;<span class="ident" id="4025640"><a href="/crypto/aes/const.go.html#4053945">td2</a></span><span class="op" id="4025643">[</span><span class="builtintype" id="4025644">uint8</span><span class="op" id="4025649">(</span><span class="ident" id="4025650"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4025652">&gt;&gt;</span><span class="num" id="4025654">8</span><span class="op" id="4025655">)</span><span class="op" id="4025656">]</span>&nbsp;<span class="op" id="4025658">^</span>&nbsp;<span class="ident" id="4025660"><a href="/crypto/aes/const.go.html#4057074">td3</a></span><span class="op" id="4025663">[</span><span class="builtintype" id="4025664">uint8</span><span class="op" id="4025669">(</span><span class="ident" id="4025670"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4025672">)</span><span class="op" id="4025673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025677"><a href="/crypto/aes/block.go.html#4024853">t2</a></span>&nbsp;<span class="op" id="4025680">=</span>&nbsp;<span class="ident" id="4025682"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025684">[</span><span class="ident" id="4025685"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4025686">+</span><span class="num" id="4025687">2</span><span class="op" id="4025688">]</span>&nbsp;<span class="op" id="4025690">^</span>&nbsp;<span class="ident" id="4025692"><a href="/crypto/aes/const.go.html#4047687">td0</a></span><span class="op" id="4025695">[</span><span class="builtintype" id="4025696">uint8</span><span class="op" id="4025701">(</span><span class="ident" id="4025702"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4025704">&gt;&gt;</span><span class="num" id="4025706">24</span><span class="op" id="4025708">)</span><span class="op" id="4025709">]</span>&nbsp;<span class="op" id="4025711">^</span>&nbsp;<span class="ident" id="4025713"><a href="/crypto/aes/const.go.html#4050816">td1</a></span><span class="op" id="4025716">[</span><span class="builtintype" id="4025717">uint8</span><span class="op" id="4025722">(</span><span class="ident" id="4025723"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4025725">&gt;&gt;</span><span class="num" id="4025727">16</span><span class="op" id="4025729">)</span><span class="op" id="4025730">]</span>&nbsp;<span class="op" id="4025732">^</span>&nbsp;<span class="ident" id="4025734"><a href="/crypto/aes/const.go.html#4053945">td2</a></span><span class="op" id="4025737">[</span><span class="builtintype" id="4025738">uint8</span><span class="op" id="4025743">(</span><span class="ident" id="4025744"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4025746">&gt;&gt;</span><span class="num" id="4025748">8</span><span class="op" id="4025749">)</span><span class="op" id="4025750">]</span>&nbsp;<span class="op" id="4025752">^</span>&nbsp;<span class="ident" id="4025754"><a href="/crypto/aes/const.go.html#4057074">td3</a></span><span class="op" id="4025757">[</span><span class="builtintype" id="4025758">uint8</span><span class="op" id="4025763">(</span><span class="ident" id="4025764"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4025766">)</span><span class="op" id="4025767">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025771"><a href="/crypto/aes/block.go.html#4024857">t3</a></span>&nbsp;<span class="op" id="4025774">=</span>&nbsp;<span class="ident" id="4025776"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4025778">[</span><span class="ident" id="4025779"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4025780">+</span><span class="num" id="4025781">3</span><span class="op" id="4025782">]</span>&nbsp;<span class="op" id="4025784">^</span>&nbsp;<span class="ident" id="4025786"><a href="/crypto/aes/const.go.html#4047687">td0</a></span><span class="op" id="4025789">[</span><span class="builtintype" id="4025790">uint8</span><span class="op" id="4025795">(</span><span class="ident" id="4025796"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4025798">&gt;&gt;</span><span class="num" id="4025800">24</span><span class="op" id="4025802">)</span><span class="op" id="4025803">]</span>&nbsp;<span class="op" id="4025805">^</span>&nbsp;<span class="ident" id="4025807"><a href="/crypto/aes/const.go.html#4050816">td1</a></span><span class="op" id="4025810">[</span><span class="builtintype" id="4025811">uint8</span><span class="op" id="4025816">(</span><span class="ident" id="4025817"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4025819">&gt;&gt;</span><span class="num" id="4025821">16</span><span class="op" id="4025823">)</span><span class="op" id="4025824">]</span>&nbsp;<span class="op" id="4025826">^</span>&nbsp;<span class="ident" id="4025828"><a href="/crypto/aes/const.go.html#4053945">td2</a></span><span class="op" id="4025831">[</span><span class="builtintype" id="4025832">uint8</span><span class="op" id="4025837">(</span><span class="ident" id="4025838"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4025840">&gt;&gt;</span><span class="num" id="4025842">8</span><span class="op" id="4025843">)</span><span class="op" id="4025844">]</span>&nbsp;<span class="op" id="4025846">^</span>&nbsp;<span class="ident" id="4025848"><a href="/crypto/aes/const.go.html#4057074">td3</a></span><span class="op" id="4025851">[</span><span class="builtintype" id="4025852">uint8</span><span class="op" id="4025857">(</span><span class="ident" id="4025858"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4025860">)</span><span class="op" id="4025861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025865"><a href="/crypto/aes/block.go.html#4025453">k</a></span>&nbsp;<span class="op" id="4025867">+=</span>&nbsp;<span class="num" id="4025870">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025874"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4025876">,</span>&nbsp;<span class="ident" id="4025878"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4025880">,</span>&nbsp;<span class="ident" id="4025882"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4025884">,</span>&nbsp;<span class="ident" id="4025886"><a href="/crypto/aes/block.go.html#4024841">s3</a></span>&nbsp;<span class="op" id="4025889">=</span>&nbsp;<span class="ident" id="4025891"><a href="/crypto/aes/block.go.html#4024845">t0</a></span><span class="op" id="4025893">,</span>&nbsp;<span class="ident" id="4025895"><a href="/crypto/aes/block.go.html#4024849">t1</a></span><span class="op" id="4025897">,</span>&nbsp;<span class="ident" id="4025899"><a href="/crypto/aes/block.go.html#4024853">t2</a></span><span class="op" id="4025901">,</span>&nbsp;<span class="ident" id="4025903"><a href="/crypto/aes/block.go.html#4024857">t3</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4025907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4025911">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025974"><a href="/crypto/aes/block.go.html#4024829">s0</a></span>&nbsp;<span class="op" id="4025977">=</span>&nbsp;<span class="builtintype" id="4025979">uint32</span><span class="op" id="4025985">(</span><span class="ident" id="4025986"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4025991">[</span><span class="ident" id="4025992"><a href="/crypto/aes/block.go.html#4024845">t0</a></span><span class="op" id="4025994">&gt;&gt;</span><span class="num" id="4025996">24</span><span class="op" id="4025998">]</span><span class="op" id="4025999">)</span><span class="op" id="4026000">&lt;&lt;</span><span class="num" id="4026002">24</span>&nbsp;<span class="op" id="4026005">|</span>&nbsp;<span class="builtintype" id="4026007">uint32</span><span class="op" id="4026013">(</span><span class="ident" id="4026014"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026019">[</span><span class="ident" id="4026020"><a href="/crypto/aes/block.go.html#4024857">t3</a></span><span class="op" id="4026022">&gt;&gt;</span><span class="num" id="4026024">16</span><span class="op" id="4026026">&amp;</span><span class="num" id="4026027">0xff</span><span class="op" id="4026031">]</span><span class="op" id="4026032">)</span><span class="op" id="4026033">&lt;&lt;</span><span class="num" id="4026035">16</span>&nbsp;<span class="op" id="4026038">|</span>&nbsp;<span class="builtintype" id="4026040">uint32</span><span class="op" id="4026046">(</span><span class="ident" id="4026047"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026052">[</span><span class="ident" id="4026053"><a href="/crypto/aes/block.go.html#4024853">t2</a></span><span class="op" id="4026055">&gt;&gt;</span><span class="num" id="4026057">8</span><span class="op" id="4026058">&amp;</span><span class="num" id="4026059">0xff</span><span class="op" id="4026063">]</span><span class="op" id="4026064">)</span><span class="op" id="4026065">&lt;&lt;</span><span class="num" id="4026067">8</span>&nbsp;<span class="op" id="4026069">|</span>&nbsp;<span class="builtintype" id="4026071">uint32</span><span class="op" id="4026077">(</span><span class="ident" id="4026078"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026083">[</span><span class="ident" id="4026084"><a href="/crypto/aes/block.go.html#4024849">t1</a></span><span class="op" id="4026086">&amp;</span><span class="num" id="4026087">0xff</span><span class="op" id="4026091">]</span><span class="op" id="4026092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026095"><a href="/crypto/aes/block.go.html#4024833">s1</a></span>&nbsp;<span class="op" id="4026098">=</span>&nbsp;<span class="builtintype" id="4026100">uint32</span><span class="op" id="4026106">(</span><span class="ident" id="4026107"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026112">[</span><span class="ident" id="4026113"><a href="/crypto/aes/block.go.html#4024849">t1</a></span><span class="op" id="4026115">&gt;&gt;</span><span class="num" id="4026117">24</span><span class="op" id="4026119">]</span><span class="op" id="4026120">)</span><span class="op" id="4026121">&lt;&lt;</span><span class="num" id="4026123">24</span>&nbsp;<span class="op" id="4026126">|</span>&nbsp;<span class="builtintype" id="4026128">uint32</span><span class="op" id="4026134">(</span><span class="ident" id="4026135"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026140">[</span><span class="ident" id="4026141"><a href="/crypto/aes/block.go.html#4024845">t0</a></span><span class="op" id="4026143">&gt;&gt;</span><span class="num" id="4026145">16</span><span class="op" id="4026147">&amp;</span><span class="num" id="4026148">0xff</span><span class="op" id="4026152">]</span><span class="op" id="4026153">)</span><span class="op" id="4026154">&lt;&lt;</span><span class="num" id="4026156">16</span>&nbsp;<span class="op" id="4026159">|</span>&nbsp;<span class="builtintype" id="4026161">uint32</span><span class="op" id="4026167">(</span><span class="ident" id="4026168"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026173">[</span><span class="ident" id="4026174"><a href="/crypto/aes/block.go.html#4024857">t3</a></span><span class="op" id="4026176">&gt;&gt;</span><span class="num" id="4026178">8</span><span class="op" id="4026179">&amp;</span><span class="num" id="4026180">0xff</span><span class="op" id="4026184">]</span><span class="op" id="4026185">)</span><span class="op" id="4026186">&lt;&lt;</span><span class="num" id="4026188">8</span>&nbsp;<span class="op" id="4026190">|</span>&nbsp;<span class="builtintype" id="4026192">uint32</span><span class="op" id="4026198">(</span><span class="ident" id="4026199"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026204">[</span><span class="ident" id="4026205"><a href="/crypto/aes/block.go.html#4024853">t2</a></span><span class="op" id="4026207">&amp;</span><span class="num" id="4026208">0xff</span><span class="op" id="4026212">]</span><span class="op" id="4026213">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026216"><a href="/crypto/aes/block.go.html#4024837">s2</a></span>&nbsp;<span class="op" id="4026219">=</span>&nbsp;<span class="builtintype" id="4026221">uint32</span><span class="op" id="4026227">(</span><span class="ident" id="4026228"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026233">[</span><span class="ident" id="4026234"><a href="/crypto/aes/block.go.html#4024853">t2</a></span><span class="op" id="4026236">&gt;&gt;</span><span class="num" id="4026238">24</span><span class="op" id="4026240">]</span><span class="op" id="4026241">)</span><span class="op" id="4026242">&lt;&lt;</span><span class="num" id="4026244">24</span>&nbsp;<span class="op" id="4026247">|</span>&nbsp;<span class="builtintype" id="4026249">uint32</span><span class="op" id="4026255">(</span><span class="ident" id="4026256"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026261">[</span><span class="ident" id="4026262"><a href="/crypto/aes/block.go.html#4024849">t1</a></span><span class="op" id="4026264">&gt;&gt;</span><span class="num" id="4026266">16</span><span class="op" id="4026268">&amp;</span><span class="num" id="4026269">0xff</span><span class="op" id="4026273">]</span><span class="op" id="4026274">)</span><span class="op" id="4026275">&lt;&lt;</span><span class="num" id="4026277">16</span>&nbsp;<span class="op" id="4026280">|</span>&nbsp;<span class="builtintype" id="4026282">uint32</span><span class="op" id="4026288">(</span><span class="ident" id="4026289"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026294">[</span><span class="ident" id="4026295"><a href="/crypto/aes/block.go.html#4024845">t0</a></span><span class="op" id="4026297">&gt;&gt;</span><span class="num" id="4026299">8</span><span class="op" id="4026300">&amp;</span><span class="num" id="4026301">0xff</span><span class="op" id="4026305">]</span><span class="op" id="4026306">)</span><span class="op" id="4026307">&lt;&lt;</span><span class="num" id="4026309">8</span>&nbsp;<span class="op" id="4026311">|</span>&nbsp;<span class="builtintype" id="4026313">uint32</span><span class="op" id="4026319">(</span><span class="ident" id="4026320"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026325">[</span><span class="ident" id="4026326"><a href="/crypto/aes/block.go.html#4024857">t3</a></span><span class="op" id="4026328">&amp;</span><span class="num" id="4026329">0xff</span><span class="op" id="4026333">]</span><span class="op" id="4026334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026337"><a href="/crypto/aes/block.go.html#4024841">s3</a></span>&nbsp;<span class="op" id="4026340">=</span>&nbsp;<span class="builtintype" id="4026342">uint32</span><span class="op" id="4026348">(</span><span class="ident" id="4026349"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026354">[</span><span class="ident" id="4026355"><a href="/crypto/aes/block.go.html#4024857">t3</a></span><span class="op" id="4026357">&gt;&gt;</span><span class="num" id="4026359">24</span><span class="op" id="4026361">]</span><span class="op" id="4026362">)</span><span class="op" id="4026363">&lt;&lt;</span><span class="num" id="4026365">24</span>&nbsp;<span class="op" id="4026368">|</span>&nbsp;<span class="builtintype" id="4026370">uint32</span><span class="op" id="4026376">(</span><span class="ident" id="4026377"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026382">[</span><span class="ident" id="4026383"><a href="/crypto/aes/block.go.html#4024853">t2</a></span><span class="op" id="4026385">&gt;&gt;</span><span class="num" id="4026387">16</span><span class="op" id="4026389">&amp;</span><span class="num" id="4026390">0xff</span><span class="op" id="4026394">]</span><span class="op" id="4026395">)</span><span class="op" id="4026396">&lt;&lt;</span><span class="num" id="4026398">16</span>&nbsp;<span class="op" id="4026401">|</span>&nbsp;<span class="builtintype" id="4026403">uint32</span><span class="op" id="4026409">(</span><span class="ident" id="4026410"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026415">[</span><span class="ident" id="4026416"><a href="/crypto/aes/block.go.html#4024849">t1</a></span><span class="op" id="4026418">&gt;&gt;</span><span class="num" id="4026420">8</span><span class="op" id="4026421">&amp;</span><span class="num" id="4026422">0xff</span><span class="op" id="4026426">]</span><span class="op" id="4026427">)</span><span class="op" id="4026428">&lt;&lt;</span><span class="num" id="4026430">8</span>&nbsp;<span class="op" id="4026432">|</span>&nbsp;<span class="builtintype" id="4026434">uint32</span><span class="op" id="4026440">(</span><span class="ident" id="4026441"><a href="/crypto/aes/const.go.html#4033394">sbox1</a></span><span class="op" id="4026446">[</span><span class="ident" id="4026447"><a href="/crypto/aes/block.go.html#4024845">t0</a></span><span class="op" id="4026449">&amp;</span><span class="num" id="4026450">0xff</span><span class="op" id="4026454">]</span><span class="op" id="4026455">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026459"><a href="/crypto/aes/block.go.html#4024829">s0</a></span>&nbsp;<span class="op" id="4026462">^=</span>&nbsp;<span class="ident" id="4026465"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4026467">[</span><span class="ident" id="4026468"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4026469">+</span><span class="num" id="4026470">0</span><span class="op" id="4026471">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026474"><a href="/crypto/aes/block.go.html#4024833">s1</a></span>&nbsp;<span class="op" id="4026477">^=</span>&nbsp;<span class="ident" id="4026480"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4026482">[</span><span class="ident" id="4026483"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4026484">+</span><span class="num" id="4026485">1</span><span class="op" id="4026486">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026489"><a href="/crypto/aes/block.go.html#4024837">s2</a></span>&nbsp;<span class="op" id="4026492">^=</span>&nbsp;<span class="ident" id="4026495"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4026497">[</span><span class="ident" id="4026498"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4026499">+</span><span class="num" id="4026500">2</span><span class="op" id="4026501">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026504"><a href="/crypto/aes/block.go.html#4024841">s3</a></span>&nbsp;<span class="op" id="4026507">^=</span>&nbsp;<span class="ident" id="4026510"><a href="/crypto/aes/block.go.html#4024792">xk</a></span><span class="op" id="4026512">[</span><span class="ident" id="4026513"><a href="/crypto/aes/block.go.html#4025453">k</a></span><span class="op" id="4026514">+</span><span class="num" id="4026515">3</span><span class="op" id="4026516">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026520"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026523">[</span><span class="num" id="4026524">0</span><span class="op" id="4026525">]</span><span class="op" id="4026526">,</span>&nbsp;<span class="ident" id="4026528"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026531">[</span><span class="num" id="4026532">1</span><span class="op" id="4026533">]</span><span class="op" id="4026534">,</span>&nbsp;<span class="ident" id="4026536"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026539">[</span><span class="num" id="4026540">2</span><span class="op" id="4026541">]</span><span class="op" id="4026542">,</span>&nbsp;<span class="ident" id="4026544"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026547">[</span><span class="num" id="4026548">3</span><span class="op" id="4026549">]</span>&nbsp;<span class="op" id="4026551">=</span>&nbsp;<span class="builtintype" id="4026553">byte</span><span class="op" id="4026557">(</span><span class="ident" id="4026558"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4026560">&gt;&gt;</span><span class="num" id="4026562">24</span><span class="op" id="4026564">)</span><span class="op" id="4026565">,</span>&nbsp;<span class="builtintype" id="4026567">byte</span><span class="op" id="4026571">(</span><span class="ident" id="4026572"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4026574">&gt;&gt;</span><span class="num" id="4026576">16</span><span class="op" id="4026578">)</span><span class="op" id="4026579">,</span>&nbsp;<span class="builtintype" id="4026581">byte</span><span class="op" id="4026585">(</span><span class="ident" id="4026586"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4026588">&gt;&gt;</span><span class="num" id="4026590">8</span><span class="op" id="4026591">)</span><span class="op" id="4026592">,</span>&nbsp;<span class="builtintype" id="4026594">byte</span><span class="op" id="4026598">(</span><span class="ident" id="4026599"><a href="/crypto/aes/block.go.html#4024829">s0</a></span><span class="op" id="4026601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026604"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026607">[</span><span class="num" id="4026608">4</span><span class="op" id="4026609">]</span><span class="op" id="4026610">,</span>&nbsp;<span class="ident" id="4026612"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026615">[</span><span class="num" id="4026616">5</span><span class="op" id="4026617">]</span><span class="op" id="4026618">,</span>&nbsp;<span class="ident" id="4026620"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026623">[</span><span class="num" id="4026624">6</span><span class="op" id="4026625">]</span><span class="op" id="4026626">,</span>&nbsp;<span class="ident" id="4026628"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026631">[</span><span class="num" id="4026632">7</span><span class="op" id="4026633">]</span>&nbsp;<span class="op" id="4026635">=</span>&nbsp;<span class="builtintype" id="4026637">byte</span><span class="op" id="4026641">(</span><span class="ident" id="4026642"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4026644">&gt;&gt;</span><span class="num" id="4026646">24</span><span class="op" id="4026648">)</span><span class="op" id="4026649">,</span>&nbsp;<span class="builtintype" id="4026651">byte</span><span class="op" id="4026655">(</span><span class="ident" id="4026656"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4026658">&gt;&gt;</span><span class="num" id="4026660">16</span><span class="op" id="4026662">)</span><span class="op" id="4026663">,</span>&nbsp;<span class="builtintype" id="4026665">byte</span><span class="op" id="4026669">(</span><span class="ident" id="4026670"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4026672">&gt;&gt;</span><span class="num" id="4026674">8</span><span class="op" id="4026675">)</span><span class="op" id="4026676">,</span>&nbsp;<span class="builtintype" id="4026678">byte</span><span class="op" id="4026682">(</span><span class="ident" id="4026683"><a href="/crypto/aes/block.go.html#4024833">s1</a></span><span class="op" id="4026685">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026688"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026691">[</span><span class="num" id="4026692">8</span><span class="op" id="4026693">]</span><span class="op" id="4026694">,</span>&nbsp;<span class="ident" id="4026696"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026699">[</span><span class="num" id="4026700">9</span><span class="op" id="4026701">]</span><span class="op" id="4026702">,</span>&nbsp;<span class="ident" id="4026704"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026707">[</span><span class="num" id="4026708">10</span><span class="op" id="4026710">]</span><span class="op" id="4026711">,</span>&nbsp;<span class="ident" id="4026713"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026716">[</span><span class="num" id="4026717">11</span><span class="op" id="4026719">]</span>&nbsp;<span class="op" id="4026721">=</span>&nbsp;<span class="builtintype" id="4026723">byte</span><span class="op" id="4026727">(</span><span class="ident" id="4026728"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4026730">&gt;&gt;</span><span class="num" id="4026732">24</span><span class="op" id="4026734">)</span><span class="op" id="4026735">,</span>&nbsp;<span class="builtintype" id="4026737">byte</span><span class="op" id="4026741">(</span><span class="ident" id="4026742"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4026744">&gt;&gt;</span><span class="num" id="4026746">16</span><span class="op" id="4026748">)</span><span class="op" id="4026749">,</span>&nbsp;<span class="builtintype" id="4026751">byte</span><span class="op" id="4026755">(</span><span class="ident" id="4026756"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4026758">&gt;&gt;</span><span class="num" id="4026760">8</span><span class="op" id="4026761">)</span><span class="op" id="4026762">,</span>&nbsp;<span class="builtintype" id="4026764">byte</span><span class="op" id="4026768">(</span><span class="ident" id="4026769"><a href="/crypto/aes/block.go.html#4024837">s2</a></span><span class="op" id="4026771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026774"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026777">[</span><span class="num" id="4026778">12</span><span class="op" id="4026780">]</span><span class="op" id="4026781">,</span>&nbsp;<span class="ident" id="4026783"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026786">[</span><span class="num" id="4026787">13</span><span class="op" id="4026789">]</span><span class="op" id="4026790">,</span>&nbsp;<span class="ident" id="4026792"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026795">[</span><span class="num" id="4026796">14</span><span class="op" id="4026798">]</span><span class="op" id="4026799">,</span>&nbsp;<span class="ident" id="4026801"><a href="/crypto/aes/block.go.html#4024805">dst</a></span><span class="op" id="4026804">[</span><span class="num" id="4026805">15</span><span class="op" id="4026807">]</span>&nbsp;<span class="op" id="4026809">=</span>&nbsp;<span class="builtintype" id="4026811">byte</span><span class="op" id="4026815">(</span><span class="ident" id="4026816"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4026818">&gt;&gt;</span><span class="num" id="4026820">24</span><span class="op" id="4026822">)</span><span class="op" id="4026823">,</span>&nbsp;<span class="builtintype" id="4026825">byte</span><span class="op" id="4026829">(</span><span class="ident" id="4026830"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4026832">&gt;&gt;</span><span class="num" id="4026834">16</span><span class="op" id="4026836">)</span><span class="op" id="4026837">,</span>&nbsp;<span class="builtintype" id="4026839">byte</span><span class="op" id="4026843">(</span><span class="ident" id="4026844"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4026846">&gt;&gt;</span><span class="num" id="4026848">8</span><span class="op" id="4026849">)</span><span class="op" id="4026850">,</span>&nbsp;<span class="builtintype" id="4026852">byte</span><span class="op" id="4026856">(</span><span class="ident" id="4026857"><a href="/crypto/aes/block.go.html#4024841">s3</a></span><span class="op" id="4026859">)</span><br>
<span class="lineno"></span><span class="op" id="4026861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4026864">//&nbsp;Apply&nbsp;sbox0&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;w.</span><br>
<span class="lineno">130</span><span class="keyword" id="4026898">func</span>&nbsp;<span class="ident" id="4026903">subw</span><span class="op" id="4026907">(</span><span class="ident" id="4026908">w</span>&nbsp;<span class="builtintype" id="4026910">uint32</span><span class="op" id="4026916">)</span>&nbsp;<span class="builtintype" id="4026918">uint32</span>&nbsp;<span class="op" id="4026925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026928">return</span>&nbsp;<span class="builtintype" id="4026935">uint32</span><span class="op" id="4026941">(</span><span class="ident" id="4026942"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4026947">[</span><span class="ident" id="4026948"><a href="/crypto/aes/block.go.html#4026908">w</a></span><span class="op" id="4026949">&gt;&gt;</span><span class="num" id="4026951">24</span><span class="op" id="4026953">]</span><span class="op" id="4026954">)</span><span class="op" id="4026955">&lt;&lt;</span><span class="num" id="4026957">24</span>&nbsp;<span class="op" id="4026960">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4026964">uint32</span><span class="op" id="4026970">(</span><span class="ident" id="4026971"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4026976">[</span><span class="ident" id="4026977"><a href="/crypto/aes/block.go.html#4026908">w</a></span><span class="op" id="4026978">&gt;&gt;</span><span class="num" id="4026980">16</span><span class="op" id="4026982">&amp;</span><span class="num" id="4026983">0xff</span><span class="op" id="4026987">]</span><span class="op" id="4026988">)</span><span class="op" id="4026989">&lt;&lt;</span><span class="num" id="4026991">16</span>&nbsp;<span class="op" id="4026994">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4026998">uint32</span><span class="op" id="4027004">(</span><span class="ident" id="4027005"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4027010">[</span><span class="ident" id="4027011"><a href="/crypto/aes/block.go.html#4026908">w</a></span><span class="op" id="4027012">&gt;&gt;</span><span class="num" id="4027014">8</span><span class="op" id="4027015">&amp;</span><span class="num" id="4027016">0xff</span><span class="op" id="4027020">]</span><span class="op" id="4027021">)</span><span class="op" id="4027022">&lt;&lt;</span><span class="num" id="4027024">8</span>&nbsp;<span class="op" id="4027026">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4027030">uint32</span><span class="op" id="4027036">(</span><span class="ident" id="4027037"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4027042">[</span><span class="ident" id="4027043"><a href="/crypto/aes/block.go.html#4026908">w</a></span><span class="op" id="4027044">&amp;</span><span class="num" id="4027045">0xff</span><span class="op" id="4027049">]</span><span class="op" id="4027050">)</span><br>
<span class="lineno">135</span><span class="op" id="4027052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4027055">//&nbsp;Rotate</span><br>
<span class="lineno"></span><span class="keyword" id="4027065">func</span>&nbsp;<span class="ident" id="4027070">rotw</span><span class="op" id="4027074">(</span><span class="ident" id="4027075">w</span>&nbsp;<span class="builtintype" id="4027077">uint32</span><span class="op" id="4027083">)</span>&nbsp;<span class="builtintype" id="4027085">uint32</span>&nbsp;<span class="op" id="4027092">{</span>&nbsp;<span class="keyword" id="4027094">return</span>&nbsp;<span class="ident" id="4027101"><a href="/crypto/aes/block.go.html#4027075">w</a></span><span class="op" id="4027102">&lt;&lt;</span><span class="num" id="4027104">8</span>&nbsp;<span class="op" id="4027106">|</span>&nbsp;<span class="ident" id="4027108"><a href="/crypto/aes/block.go.html#4027075">w</a></span><span class="op" id="4027109">&gt;&gt;</span><span class="num" id="4027111">24</span>&nbsp;<span class="op" id="4027114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="4027117">//&nbsp;Key&nbsp;expansion&nbsp;algorithm.&nbsp;&nbsp;See&nbsp;FIPS-197,&nbsp;Figure&nbsp;11.</span><br>
<span class="lineno"></span><span class="comment" id="4027171">//&nbsp;Their&nbsp;rcon[i]&nbsp;is&nbsp;our&nbsp;powx[i-1]&nbsp;&lt;&lt;&nbsp;24.</span><br>
<span class="lineno"></span><span class="keyword" id="4027212">func</span>&nbsp;<span class="ident" id="4027217">expandKeyGo</span><span class="op" id="4027228">(</span><span class="ident" id="4027229">key</span>&nbsp;<span class="op" id="4027233">[</span><span class="op" id="4027234">]</span><span class="builtintype" id="4027235">byte</span><span class="op" id="4027239">,</span>&nbsp;<span class="ident" id="4027241">enc</span><span class="op" id="4027244">,</span>&nbsp;<span class="ident" id="4027246">dec</span>&nbsp;<span class="op" id="4027250">[</span><span class="op" id="4027251">]</span><span class="builtintype" id="4027252">uint32</span><span class="op" id="4027258">)</span>&nbsp;<span class="op" id="4027260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027263">//&nbsp;Encryption&nbsp;key&nbsp;setup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027289">var</span>&nbsp;<span class="ident" id="4027293">i</span>&nbsp;<span class="builtintype" id="4027295">int</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027300">nk</span>&nbsp;<span class="op" id="4027303">:=</span>&nbsp;<span class="builtinfunc" id="4027306">len</span><span class="op" id="4027309">(</span><span class="ident" id="4027310"><a href="/crypto/aes/block.go.html#4027229">key</a></span><span class="op" id="4027313">)</span>&nbsp;<span class="op" id="4027315">/</span>&nbsp;<span class="num" id="4027317">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027320">for</span>&nbsp;<span class="ident" id="4027324"><a href="/crypto/aes/block.go.html#4027293">i</a></span>&nbsp;<span class="op" id="4027326">=</span>&nbsp;<span class="num" id="4027328">0</span><span class="op" id="4027329">;</span>&nbsp;<span class="ident" id="4027331"><a href="/crypto/aes/block.go.html#4027293">i</a></span>&nbsp;<span class="op" id="4027333">&lt;</span>&nbsp;<span class="ident" id="4027335"><a href="/crypto/aes/block.go.html#4027300">nk</a></span><span class="op" id="4027337">;</span>&nbsp;<span class="ident" id="4027339"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027340">++</span>&nbsp;<span class="op" id="4027343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027347"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027350">[</span><span class="ident" id="4027351"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027352">]</span>&nbsp;<span class="op" id="4027354">=</span>&nbsp;<span class="builtintype" id="4027356">uint32</span><span class="op" id="4027362">(</span><span class="ident" id="4027363"><a href="/crypto/aes/block.go.html#4027229">key</a></span><span class="op" id="4027366">[</span><span class="num" id="4027367">4</span><span class="op" id="4027368">*</span><span class="ident" id="4027369"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027370">]</span><span class="op" id="4027371">)</span><span class="op" id="4027372">&lt;&lt;</span><span class="num" id="4027374">24</span>&nbsp;<span class="op" id="4027377">|</span>&nbsp;<span class="builtintype" id="4027379">uint32</span><span class="op" id="4027385">(</span><span class="ident" id="4027386"><a href="/crypto/aes/block.go.html#4027229">key</a></span><span class="op" id="4027389">[</span><span class="num" id="4027390">4</span><span class="op" id="4027391">*</span><span class="ident" id="4027392"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027393">+</span><span class="num" id="4027394">1</span><span class="op" id="4027395">]</span><span class="op" id="4027396">)</span><span class="op" id="4027397">&lt;&lt;</span><span class="num" id="4027399">16</span>&nbsp;<span class="op" id="4027402">|</span>&nbsp;<span class="builtintype" id="4027404">uint32</span><span class="op" id="4027410">(</span><span class="ident" id="4027411"><a href="/crypto/aes/block.go.html#4027229">key</a></span><span class="op" id="4027414">[</span><span class="num" id="4027415">4</span><span class="op" id="4027416">*</span><span class="ident" id="4027417"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027418">+</span><span class="num" id="4027419">2</span><span class="op" id="4027420">]</span><span class="op" id="4027421">)</span><span class="op" id="4027422">&lt;&lt;</span><span class="num" id="4027424">8</span>&nbsp;<span class="op" id="4027426">|</span>&nbsp;<span class="builtintype" id="4027428">uint32</span><span class="op" id="4027434">(</span><span class="ident" id="4027435"><a href="/crypto/aes/block.go.html#4027229">key</a></span><span class="op" id="4027438">[</span><span class="num" id="4027439">4</span><span class="op" id="4027440">*</span><span class="ident" id="4027441"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027442">+</span><span class="num" id="4027443">3</span><span class="op" id="4027444">]</span><span class="op" id="4027445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027451">for</span>&nbsp;<span class="op" id="4027455">;</span>&nbsp;<span class="ident" id="4027457"><a href="/crypto/aes/block.go.html#4027293">i</a></span>&nbsp;<span class="op" id="4027459">&lt;</span>&nbsp;<span class="builtinfunc" id="4027461">len</span><span class="op" id="4027464">(</span><span class="ident" id="4027465"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027468">)</span><span class="op" id="4027469">;</span>&nbsp;<span class="ident" id="4027471"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027472">++</span>&nbsp;<span class="op" id="4027475">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027479">t</span>&nbsp;<span class="op" id="4027481">:=</span>&nbsp;<span class="ident" id="4027484"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027487">[</span><span class="ident" id="4027488"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027489">-</span><span class="num" id="4027490">1</span><span class="op" id="4027491">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027495">if</span>&nbsp;<span class="ident" id="4027498"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027499">%</span><span class="ident" id="4027500"><a href="/crypto/aes/block.go.html#4027300">nk</a></span>&nbsp;<span class="op" id="4027503">==</span>&nbsp;<span class="num" id="4027506">0</span>&nbsp;<span class="op" id="4027508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027513"><a href="/crypto/aes/block.go.html#4027479">t</a></span>&nbsp;<span class="op" id="4027515">=</span>&nbsp;<span class="ident" id="4027517"><a href="/crypto/aes/block.go.html#4026903">subw</a></span><span class="op" id="4027521">(</span><span class="ident" id="4027522"><a href="/crypto/aes/block.go.html#4027070">rotw</a></span><span class="op" id="4027526">(</span><span class="ident" id="4027527"><a href="/crypto/aes/block.go.html#4027479">t</a></span><span class="op" id="4027528">)</span><span class="op" id="4027529">)</span>&nbsp;<span class="op" id="4027531">^</span>&nbsp;<span class="op" id="4027533">(</span><span class="builtintype" id="4027534">uint32</span><span class="op" id="4027540">(</span><span class="ident" id="4027541"><a href="/crypto/aes/const.go.html#4031528">powx</a></span><span class="op" id="4027545">[</span><span class="ident" id="4027546"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027547">/</span><span class="ident" id="4027548"><a href="/crypto/aes/block.go.html#4027300">nk</a></span><span class="op" id="4027550">-</span><span class="num" id="4027551">1</span><span class="op" id="4027552">]</span><span class="op" id="4027553">)</span>&nbsp;<span class="op" id="4027555">&lt;&lt;</span>&nbsp;<span class="num" id="4027558">24</span><span class="op" id="4027560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027564">}</span>&nbsp;<span class="keyword" id="4027566">else</span>&nbsp;<span class="keyword" id="4027571">if</span>&nbsp;<span class="ident" id="4027574"><a href="/crypto/aes/block.go.html#4027300">nk</a></span>&nbsp;<span class="op" id="4027577">&gt;</span>&nbsp;<span class="num" id="4027579">6</span>&nbsp;<span class="op" id="4027581">&amp;&amp;</span>&nbsp;<span class="ident" id="4027584"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027585">%</span><span class="ident" id="4027586"><a href="/crypto/aes/block.go.html#4027300">nk</a></span>&nbsp;<span class="op" id="4027589">==</span>&nbsp;<span class="num" id="4027592">4</span>&nbsp;<span class="op" id="4027594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027599"><a href="/crypto/aes/block.go.html#4027479">t</a></span>&nbsp;<span class="op" id="4027601">=</span>&nbsp;<span class="ident" id="4027603"><a href="/crypto/aes/block.go.html#4026903">subw</a></span><span class="op" id="4027607">(</span><span class="ident" id="4027608"><a href="/crypto/aes/block.go.html#4027479">t</a></span><span class="op" id="4027609">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027617"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027620">[</span><span class="ident" id="4027621"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027622">]</span>&nbsp;<span class="op" id="4027624">=</span>&nbsp;<span class="ident" id="4027626"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027629">[</span><span class="ident" id="4027630"><a href="/crypto/aes/block.go.html#4027293">i</a></span><span class="op" id="4027631">-</span><span class="ident" id="4027632"><a href="/crypto/aes/block.go.html#4027300">nk</a></span><span class="op" id="4027634">]</span>&nbsp;<span class="op" id="4027636">^</span>&nbsp;<span class="ident" id="4027638"><a href="/crypto/aes/block.go.html#4027479">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027645">//&nbsp;Derive&nbsp;decryption&nbsp;key&nbsp;from&nbsp;encryption&nbsp;key.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027692">//&nbsp;Reverse&nbsp;the&nbsp;4-word&nbsp;round&nbsp;key&nbsp;sets&nbsp;from&nbsp;enc&nbsp;to&nbsp;produce&nbsp;dec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4027755">//&nbsp;All&nbsp;sets&nbsp;but&nbsp;the&nbsp;first&nbsp;and&nbsp;last&nbsp;get&nbsp;the&nbsp;MixColumn&nbsp;transform&nbsp;applied.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027828">if</span>&nbsp;<span class="ident" id="4027831"><a href="/crypto/aes/block.go.html#4027246">dec</a></span>&nbsp;<span class="op" id="4027835">==</span>&nbsp;<span class="ident" id="4027838">nil</span>&nbsp;<span class="op" id="4027842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027846">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4027854">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027857">n</span>&nbsp;<span class="op" id="4027859">:=</span>&nbsp;<span class="builtinfunc" id="4027862">len</span><span class="op" id="4027865">(</span><span class="ident" id="4027866"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027872">for</span>&nbsp;<span class="ident" id="4027876">i</span>&nbsp;<span class="op" id="4027878">:=</span>&nbsp;<span class="num" id="4027881">0</span><span class="op" id="4027882">;</span>&nbsp;<span class="ident" id="4027884"><a href="/crypto/aes/block.go.html#4027876">i</a></span>&nbsp;<span class="op" id="4027886">&lt;</span>&nbsp;<span class="ident" id="4027888"><a href="/crypto/aes/block.go.html#4027857">n</a></span><span class="op" id="4027889">;</span>&nbsp;<span class="ident" id="4027891"><a href="/crypto/aes/block.go.html#4027876">i</a></span>&nbsp;<span class="op" id="4027893">+=</span>&nbsp;<span class="num" id="4027896">4</span>&nbsp;<span class="op" id="4027898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027902">ei</span>&nbsp;<span class="op" id="4027905">:=</span>&nbsp;<span class="ident" id="4027908"><a href="/crypto/aes/block.go.html#4027857">n</a></span>&nbsp;<span class="op" id="4027910">-</span>&nbsp;<span class="ident" id="4027912"><a href="/crypto/aes/block.go.html#4027876">i</a></span>&nbsp;<span class="op" id="4027914">-</span>&nbsp;<span class="num" id="4027916">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027920">for</span>&nbsp;<span class="ident" id="4027924">j</span>&nbsp;<span class="op" id="4027926">:=</span>&nbsp;<span class="num" id="4027929">0</span><span class="op" id="4027930">;</span>&nbsp;<span class="ident" id="4027932"><a href="/crypto/aes/block.go.html#4027924">j</a></span>&nbsp;<span class="op" id="4027934">&lt;</span>&nbsp;<span class="num" id="4027936">4</span><span class="op" id="4027937">;</span>&nbsp;<span class="ident" id="4027939"><a href="/crypto/aes/block.go.html#4027924">j</a></span><span class="op" id="4027940">++</span>&nbsp;<span class="op" id="4027943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027948">x</span>&nbsp;<span class="op" id="4027950">:=</span>&nbsp;<span class="ident" id="4027953"><a href="/crypto/aes/block.go.html#4027241">enc</a></span><span class="op" id="4027956">[</span><span class="ident" id="4027957"><a href="/crypto/aes/block.go.html#4027902">ei</a></span><span class="op" id="4027959">+</span><span class="ident" id="4027960"><a href="/crypto/aes/block.go.html#4027924">j</a></span><span class="op" id="4027961">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027966">if</span>&nbsp;<span class="ident" id="4027969"><a href="/crypto/aes/block.go.html#4027876">i</a></span>&nbsp;<span class="op" id="4027971">&gt;</span>&nbsp;<span class="num" id="4027973">0</span>&nbsp;<span class="op" id="4027975">&amp;&amp;</span>&nbsp;<span class="ident" id="4027978"><a href="/crypto/aes/block.go.html#4027876">i</a></span><span class="op" id="4027979">+</span><span class="num" id="4027980">4</span>&nbsp;<span class="op" id="4027982">&lt;</span>&nbsp;<span class="ident" id="4027984"><a href="/crypto/aes/block.go.html#4027857">n</a></span>&nbsp;<span class="op" id="4027986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027992"><a href="/crypto/aes/block.go.html#4027948">x</a></span>&nbsp;<span class="op" id="4027994">=</span>&nbsp;<span class="ident" id="4027996"><a href="/crypto/aes/const.go.html#4047687">td0</a></span><span class="op" id="4027999">[</span><span class="ident" id="4028000"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4028005">[</span><span class="ident" id="4028006"><a href="/crypto/aes/block.go.html#4027948">x</a></span><span class="op" id="4028007">&gt;&gt;</span><span class="num" id="4028009">24</span><span class="op" id="4028011">]</span><span class="op" id="4028012">]</span>&nbsp;<span class="op" id="4028014">^</span>&nbsp;<span class="ident" id="4028016"><a href="/crypto/aes/const.go.html#4050816">td1</a></span><span class="op" id="4028019">[</span><span class="ident" id="4028020"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4028025">[</span><span class="ident" id="4028026"><a href="/crypto/aes/block.go.html#4027948">x</a></span><span class="op" id="4028027">&gt;&gt;</span><span class="num" id="4028029">16</span><span class="op" id="4028031">&amp;</span><span class="num" id="4028032">0xff</span><span class="op" id="4028036">]</span><span class="op" id="4028037">]</span>&nbsp;<span class="op" id="4028039">^</span>&nbsp;<span class="ident" id="4028041"><a href="/crypto/aes/const.go.html#4053945">td2</a></span><span class="op" id="4028044">[</span><span class="ident" id="4028045"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4028050">[</span><span class="ident" id="4028051"><a href="/crypto/aes/block.go.html#4027948">x</a></span><span class="op" id="4028052">&gt;&gt;</span><span class="num" id="4028054">8</span><span class="op" id="4028055">&amp;</span><span class="num" id="4028056">0xff</span><span class="op" id="4028060">]</span><span class="op" id="4028061">]</span>&nbsp;<span class="op" id="4028063">^</span>&nbsp;<span class="ident" id="4028065"><a href="/crypto/aes/const.go.html#4057074">td3</a></span><span class="op" id="4028068">[</span><span class="ident" id="4028069"><a href="/crypto/aes/const.go.html#4031735">sbox0</a></span><span class="op" id="4028074">[</span><span class="ident" id="4028075"><a href="/crypto/aes/block.go.html#4027948">x</a></span><span class="op" id="4028076">&amp;</span><span class="num" id="4028077">0xff</span><span class="op" id="4028081">]</span><span class="op" id="4028082">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028092"><a href="/crypto/aes/block.go.html#4027246">dec</a></span><span class="op" id="4028095">[</span><span class="ident" id="4028096"><a href="/crypto/aes/block.go.html#4027876">i</a></span><span class="op" id="4028097">+</span><span class="ident" id="4028098"><a href="/crypto/aes/block.go.html#4027924">j</a></span><span class="op" id="4028099">]</span>&nbsp;<span class="op" id="4028101">=</span>&nbsp;<span class="ident" id="4028103"><a href="/crypto/aes/block.go.html#4027948">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028107">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028110">}</span><br>
<span class="lineno"></span><span class="op" id="4028112">}</span>
</div>
</body>
</html>
