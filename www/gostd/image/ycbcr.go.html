<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image</h2>
<ul>
<li><a href="/gostd/image/decode_example_test.go.html">decode_example_test.go</a></li>
<li><a href="/gostd/image/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/image/format.go.html">format.go</a></li>
<li><a href="/gostd/image/geom.go.html">geom.go</a></li>
<li><a href="/gostd/image/image.go.html">image.go</a></li>
<li><a href="/gostd/image/image_test.go.html">image_test.go</a></li>
<li><a href="/gostd/image/names.go.html">names.go</a></li>
<li><a href="/gostd/image/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5422103">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5422158">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5422212">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5422263">package</span>&nbsp;<span class="ident" id="5422271">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5422278">import</span>&nbsp;<span class="op" id="5422285">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5422288">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="5422302">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5422305">//&nbsp;YCbCrSubsampleRatio&nbsp;is&nbsp;the&nbsp;chroma&nbsp;subsample&nbsp;ratio&nbsp;used&nbsp;in&nbsp;a&nbsp;YCbCr&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5422381">type</span>&nbsp;<span class="ident" id="5422386">YCbCrSubsampleRatio</span>&nbsp;<span class="builtintype" id="5422406">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5422411">const</span>&nbsp;<span class="op" id="5422417">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422420">YCbCrSubsampleRatio444</span>&nbsp;<span class="ident" id="5422443">YCbCrSubsampleRatio</span>&nbsp;<span class="op" id="5422463">=</span>&nbsp;<span class="ident" id="5422465">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422471">YCbCrSubsampleRatio422</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422495">YCbCrSubsampleRatio420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422519">YCbCrSubsampleRatio440</span><br>
<span class="lineno"></span><span class="op" id="5422542">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5422545">func</span>&nbsp;<span class="op" id="5422550">(</span><span class="ident" id="5422551">s</span>&nbsp;<span class="ident" id="5422553">YCbCrSubsampleRatio</span><span class="op" id="5422572">)</span>&nbsp;<span class="ident" id="5422574">String</span><span class="op" id="5422580">(</span><span class="op" id="5422581">)</span>&nbsp;<span class="builtintype" id="5422583">string</span>&nbsp;<span class="op" id="5422590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422593">switch</span>&nbsp;<span class="ident" id="5422600">s</span>&nbsp;<span class="op" id="5422602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422605">case</span>&nbsp;<span class="ident" id="5422610">YCbCrSubsampleRatio444</span><span class="op" id="5422632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422636">return</span>&nbsp;<span class="string" id="5422643">&#34;YCbCrSubsampleRatio444&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422669">case</span>&nbsp;<span class="ident" id="5422674">YCbCrSubsampleRatio422</span><span class="op" id="5422696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422700">return</span>&nbsp;<span class="string" id="5422707">&#34;YCbCrSubsampleRatio422&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422733">case</span>&nbsp;<span class="ident" id="5422738">YCbCrSubsampleRatio420</span><span class="op" id="5422760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422764">return</span>&nbsp;<span class="string" id="5422771">&#34;YCbCrSubsampleRatio420&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422797">case</span>&nbsp;<span class="ident" id="5422802">YCbCrSubsampleRatio440</span><span class="op" id="5422824">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422828">return</span>&nbsp;<span class="string" id="5422835">&#34;YCbCrSubsampleRatio440&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422864">return</span>&nbsp;<span class="string" id="5422871">&#34;YCbCrSubsampleRatioUnknown&#34;</span><br>
<span class="lineno"></span><span class="op" id="5422900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5422903">//&nbsp;YCbCr&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;image&nbsp;of&nbsp;Y&#39;CbCr&nbsp;colors.&nbsp;There&nbsp;is&nbsp;one&nbsp;Y&nbsp;sample&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="5422978">//&nbsp;pixel,&nbsp;but&nbsp;each&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;sample&nbsp;can&nbsp;span&nbsp;one&nbsp;or&nbsp;more&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="5423043">//&nbsp;YStride&nbsp;is&nbsp;the&nbsp;Y&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="5423117">//&nbsp;CStride&nbsp;is&nbsp;the&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels</span><br>
<span class="lineno"></span><span class="comment" id="5423198">//&nbsp;that&nbsp;map&nbsp;to&nbsp;separate&nbsp;chroma&nbsp;samples.</span><br>
<span class="lineno">40</span><span class="comment" id="5423238">//&nbsp;It&nbsp;is&nbsp;not&nbsp;an&nbsp;absolute&nbsp;requirement,&nbsp;but&nbsp;YStride&nbsp;and&nbsp;len(Y)&nbsp;are&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="5423313">//&nbsp;multiples&nbsp;of&nbsp;8,&nbsp;and:</span><br>
<span class="lineno"></span><span class="comment" id="5423337">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:4,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/1.</span><br>
<span class="lineno"></span><span class="comment" id="5423407">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:2,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="comment" id="5423477">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:0,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/4.</span><br>
<span class="lineno">45</span><span class="comment" id="5423547">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:0,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="5423617">type</span>&nbsp;<span class="ident" id="5423622">YCbCr</span>&nbsp;<span class="keyword" id="5423628">struct</span>&nbsp;<span class="op" id="5423635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423638">Y</span><span class="op" id="5423639">,</span>&nbsp;<span class="ident" id="5423641">Cb</span><span class="op" id="5423643">,</span>&nbsp;<span class="ident" id="5423645">Cr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5423653">[</span><span class="op" id="5423654">]</span><span class="builtintype" id="5423655">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423662">YStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5423677">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423682">CStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5423697">int</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423702">SubsampleRatio</span>&nbsp;<span class="ident" id="5423717">YCbCrSubsampleRatio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423738">Rect</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423753">Rectangle</span><br>
<span class="lineno"></span><span class="op" id="5423763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5423766">func</span>&nbsp;<span class="op" id="5423771">(</span><span class="ident" id="5423772">p</span>&nbsp;<span class="op" id="5423774">*</span><span class="ident" id="5423775">YCbCr</span><span class="op" id="5423780">)</span>&nbsp;<span class="ident" id="5423782">ColorModel</span><span class="op" id="5423792">(</span><span class="op" id="5423793">)</span>&nbsp;<span class="ident" id="5423795">color</span><span class="op" id="5423800">.</span><span class="ident" id="5423801">Model</span>&nbsp;<span class="op" id="5423807">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423810">return</span>&nbsp;<span class="ident" id="5423817">color</span><span class="op" id="5423822">.</span><span class="ident" id="5423823">YCbCrModel</span><br>
<span class="lineno"></span><span class="op" id="5423834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5423837">func</span>&nbsp;<span class="op" id="5423842">(</span><span class="ident" id="5423843">p</span>&nbsp;<span class="op" id="5423845">*</span><span class="ident" id="5423846">YCbCr</span><span class="op" id="5423851">)</span>&nbsp;<span class="ident" id="5423853">Bounds</span><span class="op" id="5423859">(</span><span class="op" id="5423860">)</span>&nbsp;<span class="ident" id="5423862">Rectangle</span>&nbsp;<span class="op" id="5423872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423875">return</span>&nbsp;<span class="ident" id="5423882">p</span><span class="op" id="5423883">.</span><span class="ident" id="5423884">Rect</span><br>
<span class="lineno">60</span><span class="op" id="5423889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5423892">func</span>&nbsp;<span class="op" id="5423897">(</span><span class="ident" id="5423898">p</span>&nbsp;<span class="op" id="5423900">*</span><span class="ident" id="5423901">YCbCr</span><span class="op" id="5423906">)</span>&nbsp;<span class="ident" id="5423908">At</span><span class="op" id="5423910">(</span><span class="ident" id="5423911">x</span><span class="op" id="5423912">,</span>&nbsp;<span class="ident" id="5423914">y</span>&nbsp;<span class="builtintype" id="5423916">int</span><span class="op" id="5423919">)</span>&nbsp;<span class="ident" id="5423921">color</span><span class="op" id="5423926">.</span><span class="ident" id="5423927">Color</span>&nbsp;<span class="op" id="5423933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423936">return</span>&nbsp;<span class="ident" id="5423943">p</span><span class="op" id="5423944">.</span><span class="ident" id="5423945">YCbCrAt</span><span class="op" id="5423952">(</span><span class="ident" id="5423953">x</span><span class="op" id="5423954">,</span>&nbsp;<span class="ident" id="5423956">y</span><span class="op" id="5423957">)</span><br>
<span class="lineno"></span><span class="op" id="5423959">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="5423962">func</span>&nbsp;<span class="op" id="5423967">(</span><span class="ident" id="5423968">p</span>&nbsp;<span class="op" id="5423970">*</span><span class="ident" id="5423971">YCbCr</span><span class="op" id="5423976">)</span>&nbsp;<span class="ident" id="5423978">YCbCrAt</span><span class="op" id="5423985">(</span><span class="ident" id="5423986">x</span><span class="op" id="5423987">,</span>&nbsp;<span class="ident" id="5423989">y</span>&nbsp;<span class="builtintype" id="5423991">int</span><span class="op" id="5423994">)</span>&nbsp;<span class="ident" id="5423996">color</span><span class="op" id="5424001">.</span><span class="ident" id="5424002">YCbCr</span>&nbsp;<span class="op" id="5424008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424011">if</span>&nbsp;<span class="op" id="5424014">!</span><span class="op" id="5424015">(</span><span class="ident" id="5424016">Point</span><span class="op" id="5424021">{</span><span class="ident" id="5424022">x</span><span class="op" id="5424023">,</span>&nbsp;<span class="ident" id="5424025">y</span><span class="op" id="5424026">}</span><span class="op" id="5424027">.</span><span class="ident" id="5424028">In</span><span class="op" id="5424030">(</span><span class="ident" id="5424031">p</span><span class="op" id="5424032">.</span><span class="ident" id="5424033">Rect</span><span class="op" id="5424037">)</span><span class="op" id="5424038">)</span>&nbsp;<span class="op" id="5424040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424044">return</span>&nbsp;<span class="ident" id="5424051">color</span><span class="op" id="5424056">.</span><span class="ident" id="5424057">YCbCr</span><span class="op" id="5424062">{</span><span class="op" id="5424063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424066">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424069">yi</span>&nbsp;<span class="op" id="5424072">:=</span>&nbsp;<span class="ident" id="5424075">p</span><span class="op" id="5424076">.</span><span class="ident" id="5424077">YOffset</span><span class="op" id="5424084">(</span><span class="ident" id="5424085">x</span><span class="op" id="5424086">,</span>&nbsp;<span class="ident" id="5424088">y</span><span class="op" id="5424089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424092">ci</span>&nbsp;<span class="op" id="5424095">:=</span>&nbsp;<span class="ident" id="5424098">p</span><span class="op" id="5424099">.</span><span class="ident" id="5424100">COffset</span><span class="op" id="5424107">(</span><span class="ident" id="5424108">x</span><span class="op" id="5424109">,</span>&nbsp;<span class="ident" id="5424111">y</span><span class="op" id="5424112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424115">return</span>&nbsp;<span class="ident" id="5424122">color</span><span class="op" id="5424127">.</span><span class="ident" id="5424128">YCbCr</span><span class="op" id="5424133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424137">p</span><span class="op" id="5424138">.</span><span class="ident" id="5424139">Y</span><span class="op" id="5424140">[</span><span class="ident" id="5424141">yi</span><span class="op" id="5424143">]</span><span class="op" id="5424144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424148">p</span><span class="op" id="5424149">.</span><span class="ident" id="5424150">Cb</span><span class="op" id="5424152">[</span><span class="ident" id="5424153">ci</span><span class="op" id="5424155">]</span><span class="op" id="5424156">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424160">p</span><span class="op" id="5424161">.</span><span class="ident" id="5424162">Cr</span><span class="op" id="5424164">[</span><span class="ident" id="5424165">ci</span><span class="op" id="5424167">]</span><span class="op" id="5424168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424171">}</span><br>
<span class="lineno"></span><span class="op" id="5424173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5424176">//&nbsp;YOffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Y&nbsp;that&nbsp;corresponds&nbsp;to</span><br>
<span class="lineno">80</span><span class="comment" id="5424251">//&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="5424275">func</span>&nbsp;<span class="op" id="5424280">(</span><span class="ident" id="5424281">p</span>&nbsp;<span class="op" id="5424283">*</span><span class="ident" id="5424284">YCbCr</span><span class="op" id="5424289">)</span>&nbsp;<span class="ident" id="5424291">YOffset</span><span class="op" id="5424298">(</span><span class="ident" id="5424299">x</span><span class="op" id="5424300">,</span>&nbsp;<span class="ident" id="5424302">y</span>&nbsp;<span class="builtintype" id="5424304">int</span><span class="op" id="5424307">)</span>&nbsp;<span class="builtintype" id="5424309">int</span>&nbsp;<span class="op" id="5424313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424316">return</span>&nbsp;<span class="op" id="5424323">(</span><span class="ident" id="5424324">y</span><span class="op" id="5424325">-</span><span class="ident" id="5424326">p</span><span class="op" id="5424327">.</span><span class="ident" id="5424328">Rect</span><span class="op" id="5424332">.</span><span class="ident" id="5424333">Min</span><span class="op" id="5424336">.</span><span class="ident" id="5424337">Y</span><span class="op" id="5424338">)</span><span class="op" id="5424339">*</span><span class="ident" id="5424340">p</span><span class="op" id="5424341">.</span><span class="ident" id="5424342">YStride</span>&nbsp;<span class="op" id="5424350">+</span>&nbsp;<span class="op" id="5424352">(</span><span class="ident" id="5424353">x</span>&nbsp;<span class="op" id="5424355">-</span>&nbsp;<span class="ident" id="5424357">p</span><span class="op" id="5424358">.</span><span class="ident" id="5424359">Rect</span><span class="op" id="5424363">.</span><span class="ident" id="5424364">Min</span><span class="op" id="5424367">.</span><span class="ident" id="5424368">X</span><span class="op" id="5424369">)</span><br>
<span class="lineno"></span><span class="op" id="5424371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5424374">//&nbsp;COffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Cb&nbsp;or&nbsp;Cr&nbsp;that&nbsp;corresponds</span><br>
<span class="lineno"></span><span class="comment" id="5424453">//&nbsp;to&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="5424480">func</span>&nbsp;<span class="op" id="5424485">(</span><span class="ident" id="5424486">p</span>&nbsp;<span class="op" id="5424488">*</span><span class="ident" id="5424489">YCbCr</span><span class="op" id="5424494">)</span>&nbsp;<span class="ident" id="5424496">COffset</span><span class="op" id="5424503">(</span><span class="ident" id="5424504">x</span><span class="op" id="5424505">,</span>&nbsp;<span class="ident" id="5424507">y</span>&nbsp;<span class="builtintype" id="5424509">int</span><span class="op" id="5424512">)</span>&nbsp;<span class="builtintype" id="5424514">int</span>&nbsp;<span class="op" id="5424518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424521">switch</span>&nbsp;<span class="ident" id="5424528">p</span><span class="op" id="5424529">.</span><span class="ident" id="5424530">SubsampleRatio</span>&nbsp;<span class="op" id="5424545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424548">case</span>&nbsp;<span class="ident" id="5424553">YCbCrSubsampleRatio422</span><span class="op" id="5424575">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424579">return</span>&nbsp;<span class="op" id="5424586">(</span><span class="ident" id="5424587">y</span><span class="op" id="5424588">-</span><span class="ident" id="5424589">p</span><span class="op" id="5424590">.</span><span class="ident" id="5424591">Rect</span><span class="op" id="5424595">.</span><span class="ident" id="5424596">Min</span><span class="op" id="5424599">.</span><span class="ident" id="5424600">Y</span><span class="op" id="5424601">)</span><span class="op" id="5424602">*</span><span class="ident" id="5424603">p</span><span class="op" id="5424604">.</span><span class="ident" id="5424605">CStride</span>&nbsp;<span class="op" id="5424613">+</span>&nbsp;<span class="op" id="5424615">(</span><span class="ident" id="5424616">x</span><span class="op" id="5424617">/</span><span class="num" id="5424618">2</span>&nbsp;<span class="op" id="5424620">-</span>&nbsp;<span class="ident" id="5424622">p</span><span class="op" id="5424623">.</span><span class="ident" id="5424624">Rect</span><span class="op" id="5424628">.</span><span class="ident" id="5424629">Min</span><span class="op" id="5424632">.</span><span class="ident" id="5424633">X</span><span class="op" id="5424634">/</span><span class="num" id="5424635">2</span><span class="op" id="5424636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424639">case</span>&nbsp;<span class="ident" id="5424644">YCbCrSubsampleRatio420</span><span class="op" id="5424666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424670">return</span>&nbsp;<span class="op" id="5424677">(</span><span class="ident" id="5424678">y</span><span class="op" id="5424679">/</span><span class="num" id="5424680">2</span><span class="op" id="5424681">-</span><span class="ident" id="5424682">p</span><span class="op" id="5424683">.</span><span class="ident" id="5424684">Rect</span><span class="op" id="5424688">.</span><span class="ident" id="5424689">Min</span><span class="op" id="5424692">.</span><span class="ident" id="5424693">Y</span><span class="op" id="5424694">/</span><span class="num" id="5424695">2</span><span class="op" id="5424696">)</span><span class="op" id="5424697">*</span><span class="ident" id="5424698">p</span><span class="op" id="5424699">.</span><span class="ident" id="5424700">CStride</span>&nbsp;<span class="op" id="5424708">+</span>&nbsp;<span class="op" id="5424710">(</span><span class="ident" id="5424711">x</span><span class="op" id="5424712">/</span><span class="num" id="5424713">2</span>&nbsp;<span class="op" id="5424715">-</span>&nbsp;<span class="ident" id="5424717">p</span><span class="op" id="5424718">.</span><span class="ident" id="5424719">Rect</span><span class="op" id="5424723">.</span><span class="ident" id="5424724">Min</span><span class="op" id="5424727">.</span><span class="ident" id="5424728">X</span><span class="op" id="5424729">/</span><span class="num" id="5424730">2</span><span class="op" id="5424731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424734">case</span>&nbsp;<span class="ident" id="5424739">YCbCrSubsampleRatio440</span><span class="op" id="5424761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424765">return</span>&nbsp;<span class="op" id="5424772">(</span><span class="ident" id="5424773">y</span><span class="op" id="5424774">/</span><span class="num" id="5424775">2</span><span class="op" id="5424776">-</span><span class="ident" id="5424777">p</span><span class="op" id="5424778">.</span><span class="ident" id="5424779">Rect</span><span class="op" id="5424783">.</span><span class="ident" id="5424784">Min</span><span class="op" id="5424787">.</span><span class="ident" id="5424788">Y</span><span class="op" id="5424789">/</span><span class="num" id="5424790">2</span><span class="op" id="5424791">)</span><span class="op" id="5424792">*</span><span class="ident" id="5424793">p</span><span class="op" id="5424794">.</span><span class="ident" id="5424795">CStride</span>&nbsp;<span class="op" id="5424803">+</span>&nbsp;<span class="op" id="5424805">(</span><span class="ident" id="5424806">x</span>&nbsp;<span class="op" id="5424808">-</span>&nbsp;<span class="ident" id="5424810">p</span><span class="op" id="5424811">.</span><span class="ident" id="5424812">Rect</span><span class="op" id="5424816">.</span><span class="ident" id="5424817">Min</span><span class="op" id="5424820">.</span><span class="ident" id="5424821">X</span><span class="op" id="5424822">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5424828">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424862">return</span>&nbsp;<span class="op" id="5424869">(</span><span class="ident" id="5424870">y</span><span class="op" id="5424871">-</span><span class="ident" id="5424872">p</span><span class="op" id="5424873">.</span><span class="ident" id="5424874">Rect</span><span class="op" id="5424878">.</span><span class="ident" id="5424879">Min</span><span class="op" id="5424882">.</span><span class="ident" id="5424883">Y</span><span class="op" id="5424884">)</span><span class="op" id="5424885">*</span><span class="ident" id="5424886">p</span><span class="op" id="5424887">.</span><span class="ident" id="5424888">CStride</span>&nbsp;<span class="op" id="5424896">+</span>&nbsp;<span class="op" id="5424898">(</span><span class="ident" id="5424899">x</span>&nbsp;<span class="op" id="5424901">-</span>&nbsp;<span class="ident" id="5424903">p</span><span class="op" id="5424904">.</span><span class="ident" id="5424905">Rect</span><span class="op" id="5424909">.</span><span class="ident" id="5424910">Min</span><span class="op" id="5424913">.</span><span class="ident" id="5424914">X</span><span class="op" id="5424915">)</span><br>
<span class="lineno"></span><span class="op" id="5424917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5424920">//&nbsp;SubImage&nbsp;returns&nbsp;an&nbsp;image&nbsp;representing&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;image&nbsp;p&nbsp;visible</span><br>
<span class="lineno"></span><span class="comment" id="5424997">//&nbsp;through&nbsp;r.&nbsp;The&nbsp;returned&nbsp;value&nbsp;shares&nbsp;pixels&nbsp;with&nbsp;the&nbsp;original&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5425069">func</span>&nbsp;<span class="op" id="5425074">(</span><span class="ident" id="5425075">p</span>&nbsp;<span class="op" id="5425077">*</span><span class="ident" id="5425078">YCbCr</span><span class="op" id="5425083">)</span>&nbsp;<span class="ident" id="5425085">SubImage</span><span class="op" id="5425093">(</span><span class="ident" id="5425094">r</span>&nbsp;<span class="ident" id="5425096">Rectangle</span><span class="op" id="5425105">)</span>&nbsp;<span class="ident" id="5425107">Image</span>&nbsp;<span class="op" id="5425113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425116">r</span>&nbsp;<span class="op" id="5425118">=</span>&nbsp;<span class="ident" id="5425120">r</span><span class="op" id="5425121">.</span><span class="ident" id="5425122">Intersect</span><span class="op" id="5425131">(</span><span class="ident" id="5425132">p</span><span class="op" id="5425133">.</span><span class="ident" id="5425134">Rect</span><span class="op" id="5425138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425141">//&nbsp;If&nbsp;r1&nbsp;and&nbsp;r2&nbsp;are&nbsp;Rectangles,&nbsp;r1.Intersect(r2)&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;inside</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425222">//&nbsp;either&nbsp;r1&nbsp;or&nbsp;r2&nbsp;if&nbsp;the&nbsp;intersection&nbsp;is&nbsp;empty.&nbsp;Without&nbsp;explicitly&nbsp;checking&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5425304">//&nbsp;this,&nbsp;the&nbsp;Pix[i:]&nbsp;expression&nbsp;below&nbsp;can&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425354">if</span>&nbsp;<span class="ident" id="5425357">r</span><span class="op" id="5425358">.</span><span class="ident" id="5425359">Empty</span><span class="op" id="5425364">(</span><span class="op" id="5425365">)</span>&nbsp;<span class="op" id="5425367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425371">return</span>&nbsp;<span class="op" id="5425378">&amp;</span><span class="ident" id="5425379">YCbCr</span><span class="op" id="5425384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425389">SubsampleRatio</span><span class="op" id="5425403">:</span>&nbsp;<span class="ident" id="5425405">p</span><span class="op" id="5425406">.</span><span class="ident" id="5425407">SubsampleRatio</span><span class="op" id="5425421">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425431">yi</span>&nbsp;<span class="op" id="5425434">:=</span>&nbsp;<span class="ident" id="5425437">p</span><span class="op" id="5425438">.</span><span class="ident" id="5425439">YOffset</span><span class="op" id="5425446">(</span><span class="ident" id="5425447">r</span><span class="op" id="5425448">.</span><span class="ident" id="5425449">Min</span><span class="op" id="5425452">.</span><span class="ident" id="5425453">X</span><span class="op" id="5425454">,</span>&nbsp;<span class="ident" id="5425456">r</span><span class="op" id="5425457">.</span><span class="ident" id="5425458">Min</span><span class="op" id="5425461">.</span><span class="ident" id="5425462">Y</span><span class="op" id="5425463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425466">ci</span>&nbsp;<span class="op" id="5425469">:=</span>&nbsp;<span class="ident" id="5425472">p</span><span class="op" id="5425473">.</span><span class="ident" id="5425474">COffset</span><span class="op" id="5425481">(</span><span class="ident" id="5425482">r</span><span class="op" id="5425483">.</span><span class="ident" id="5425484">Min</span><span class="op" id="5425487">.</span><span class="ident" id="5425488">X</span><span class="op" id="5425489">,</span>&nbsp;<span class="ident" id="5425491">r</span><span class="op" id="5425492">.</span><span class="ident" id="5425493">Min</span><span class="op" id="5425496">.</span><span class="ident" id="5425497">Y</span><span class="op" id="5425498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425501">return</span>&nbsp;<span class="op" id="5425508">&amp;</span><span class="ident" id="5425509">YCbCr</span><span class="op" id="5425514">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425518">Y</span><span class="op" id="5425519">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425534">p</span><span class="op" id="5425535">.</span><span class="ident" id="5425536">Y</span><span class="op" id="5425537">[</span><span class="ident" id="5425538">yi</span><span class="op" id="5425540">:</span><span class="op" id="5425541">]</span><span class="op" id="5425542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425546">Cb</span><span class="op" id="5425548">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425562">p</span><span class="op" id="5425563">.</span><span class="ident" id="5425564">Cb</span><span class="op" id="5425566">[</span><span class="ident" id="5425567">ci</span><span class="op" id="5425569">:</span><span class="op" id="5425570">]</span><span class="op" id="5425571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425575">Cr</span><span class="op" id="5425577">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425591">p</span><span class="op" id="5425592">.</span><span class="ident" id="5425593">Cr</span><span class="op" id="5425595">[</span><span class="ident" id="5425596">ci</span><span class="op" id="5425598">:</span><span class="op" id="5425599">]</span><span class="op" id="5425600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425604">SubsampleRatio</span><span class="op" id="5425618">:</span>&nbsp;<span class="ident" id="5425620">p</span><span class="op" id="5425621">.</span><span class="ident" id="5425622">SubsampleRatio</span><span class="op" id="5425636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425640">YStride</span><span class="op" id="5425647">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425656">p</span><span class="op" id="5425657">.</span><span class="ident" id="5425658">YStride</span><span class="op" id="5425665">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425669">CStride</span><span class="op" id="5425676">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425685">p</span><span class="op" id="5425686">.</span><span class="ident" id="5425687">CStride</span><span class="op" id="5425694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425698">Rect</span><span class="op" id="5425702">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5425714">r</span><span class="op" id="5425715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5425718">}</span><br>
<span class="lineno"></span><span class="op" id="5425720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="5425723">func</span>&nbsp;<span class="op" id="5425728">(</span><span class="ident" id="5425729">p</span>&nbsp;<span class="op" id="5425731">*</span><span class="ident" id="5425732">YCbCr</span><span class="op" id="5425737">)</span>&nbsp;<span class="ident" id="5425739">Opaque</span><span class="op" id="5425745">(</span><span class="op" id="5425746">)</span>&nbsp;<span class="builtintype" id="5425748">bool</span>&nbsp;<span class="op" id="5425753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425756">return</span>&nbsp;<span class="builtintype" id="5425763">true</span><br>
<span class="lineno"></span><span class="op" id="5425768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5425771">//&nbsp;NewYCbCr&nbsp;returns&nbsp;a&nbsp;new&nbsp;YCbCr&nbsp;with&nbsp;the&nbsp;given&nbsp;bounds&nbsp;and&nbsp;subsample&nbsp;ratio.</span><br>
<span class="lineno">130</span><span class="keyword" id="5425846">func</span>&nbsp;<span class="ident" id="5425851">NewYCbCr</span><span class="op" id="5425859">(</span><span class="ident" id="5425860">r</span>&nbsp;<span class="ident" id="5425862">Rectangle</span><span class="op" id="5425871">,</span>&nbsp;<span class="ident" id="5425873">subsampleRatio</span>&nbsp;<span class="ident" id="5425888">YCbCrSubsampleRatio</span><span class="op" id="5425907">)</span>&nbsp;<span class="op" id="5425909">*</span><span class="ident" id="5425910">YCbCr</span>&nbsp;<span class="op" id="5425916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5425919">w</span><span class="op" id="5425920">,</span>&nbsp;<span class="ident" id="5425922">h</span><span class="op" id="5425923">,</span>&nbsp;<span class="ident" id="5425925">cw</span><span class="op" id="5425927">,</span>&nbsp;<span class="ident" id="5425929">ch</span>&nbsp;<span class="op" id="5425932">:=</span>&nbsp;<span class="ident" id="5425935">r</span><span class="op" id="5425936">.</span><span class="ident" id="5425937">Dx</span><span class="op" id="5425939">(</span><span class="op" id="5425940">)</span><span class="op" id="5425941">,</span>&nbsp;<span class="ident" id="5425943">r</span><span class="op" id="5425944">.</span><span class="ident" id="5425945">Dy</span><span class="op" id="5425947">(</span><span class="op" id="5425948">)</span><span class="op" id="5425949">,</span>&nbsp;<span class="num" id="5425951">0</span><span class="op" id="5425952">,</span>&nbsp;<span class="num" id="5425954">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425957">switch</span>&nbsp;<span class="ident" id="5425964">subsampleRatio</span>&nbsp;<span class="op" id="5425979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5425982">case</span>&nbsp;<span class="ident" id="5425987">YCbCrSubsampleRatio422</span><span class="op" id="5426009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426013">cw</span>&nbsp;<span class="op" id="5426016">=</span>&nbsp;<span class="op" id="5426018">(</span><span class="ident" id="5426019">r</span><span class="op" id="5426020">.</span><span class="ident" id="5426021">Max</span><span class="op" id="5426024">.</span><span class="ident" id="5426025">X</span><span class="op" id="5426026">+</span><span class="num" id="5426027">1</span><span class="op" id="5426028">)</span><span class="op" id="5426029">/</span><span class="num" id="5426030">2</span>&nbsp;<span class="op" id="5426032">-</span>&nbsp;<span class="ident" id="5426034">r</span><span class="op" id="5426035">.</span><span class="ident" id="5426036">Min</span><span class="op" id="5426039">.</span><span class="ident" id="5426040">X</span><span class="op" id="5426041">/</span><span class="num" id="5426042">2</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426046">ch</span>&nbsp;<span class="op" id="5426049">=</span>&nbsp;<span class="ident" id="5426051">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426054">case</span>&nbsp;<span class="ident" id="5426059">YCbCrSubsampleRatio420</span><span class="op" id="5426081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426085">cw</span>&nbsp;<span class="op" id="5426088">=</span>&nbsp;<span class="op" id="5426090">(</span><span class="ident" id="5426091">r</span><span class="op" id="5426092">.</span><span class="ident" id="5426093">Max</span><span class="op" id="5426096">.</span><span class="ident" id="5426097">X</span><span class="op" id="5426098">+</span><span class="num" id="5426099">1</span><span class="op" id="5426100">)</span><span class="op" id="5426101">/</span><span class="num" id="5426102">2</span>&nbsp;<span class="op" id="5426104">-</span>&nbsp;<span class="ident" id="5426106">r</span><span class="op" id="5426107">.</span><span class="ident" id="5426108">Min</span><span class="op" id="5426111">.</span><span class="ident" id="5426112">X</span><span class="op" id="5426113">/</span><span class="num" id="5426114">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426118">ch</span>&nbsp;<span class="op" id="5426121">=</span>&nbsp;<span class="op" id="5426123">(</span><span class="ident" id="5426124">r</span><span class="op" id="5426125">.</span><span class="ident" id="5426126">Max</span><span class="op" id="5426129">.</span><span class="ident" id="5426130">Y</span><span class="op" id="5426131">+</span><span class="num" id="5426132">1</span><span class="op" id="5426133">)</span><span class="op" id="5426134">/</span><span class="num" id="5426135">2</span>&nbsp;<span class="op" id="5426137">-</span>&nbsp;<span class="ident" id="5426139">r</span><span class="op" id="5426140">.</span><span class="ident" id="5426141">Min</span><span class="op" id="5426144">.</span><span class="ident" id="5426145">Y</span><span class="op" id="5426146">/</span><span class="num" id="5426147">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426150">case</span>&nbsp;<span class="ident" id="5426155">YCbCrSubsampleRatio440</span><span class="op" id="5426177">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426181">cw</span>&nbsp;<span class="op" id="5426184">=</span>&nbsp;<span class="ident" id="5426186">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426190">ch</span>&nbsp;<span class="op" id="5426193">=</span>&nbsp;<span class="op" id="5426195">(</span><span class="ident" id="5426196">r</span><span class="op" id="5426197">.</span><span class="ident" id="5426198">Max</span><span class="op" id="5426201">.</span><span class="ident" id="5426202">Y</span><span class="op" id="5426203">+</span><span class="num" id="5426204">1</span><span class="op" id="5426205">)</span><span class="op" id="5426206">/</span><span class="num" id="5426207">2</span>&nbsp;<span class="op" id="5426209">-</span>&nbsp;<span class="ident" id="5426211">r</span><span class="op" id="5426212">.</span><span class="ident" id="5426213">Min</span><span class="op" id="5426216">.</span><span class="ident" id="5426217">Y</span><span class="op" id="5426218">/</span><span class="num" id="5426219">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426222">default</span><span class="op" id="5426229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5426233">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426268">cw</span>&nbsp;<span class="op" id="5426271">=</span>&nbsp;<span class="ident" id="5426273">w</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426277">ch</span>&nbsp;<span class="op" id="5426280">=</span>&nbsp;<span class="ident" id="5426282">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426288">b</span>&nbsp;<span class="op" id="5426290">:=</span>&nbsp;<span class="builtinfunc" id="5426293">make</span><span class="op" id="5426297">(</span><span class="op" id="5426298">[</span><span class="op" id="5426299">]</span><span class="builtintype" id="5426300">byte</span><span class="op" id="5426304">,</span>&nbsp;<span class="ident" id="5426306">w</span><span class="op" id="5426307">*</span><span class="ident" id="5426308">h</span><span class="op" id="5426309">+</span><span class="num" id="5426310">2</span><span class="op" id="5426311">*</span><span class="ident" id="5426312">cw</span><span class="op" id="5426314">*</span><span class="ident" id="5426315">ch</span><span class="op" id="5426317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5426320">return</span>&nbsp;<span class="op" id="5426327">&amp;</span><span class="ident" id="5426328">YCbCr</span><span class="op" id="5426333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426337">Y</span><span class="op" id="5426338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426353">b</span><span class="op" id="5426354">[</span><span class="op" id="5426355">:</span><span class="ident" id="5426356">w</span><span class="op" id="5426357">*</span><span class="ident" id="5426358">h</span><span class="op" id="5426359">]</span><span class="op" id="5426360">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426364">Cb</span><span class="op" id="5426366">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426380">b</span><span class="op" id="5426381">[</span><span class="ident" id="5426382">w</span><span class="op" id="5426383">*</span><span class="ident" id="5426384">h</span><span class="op" id="5426385">+</span><span class="num" id="5426386">0</span><span class="op" id="5426387">*</span><span class="ident" id="5426388">cw</span><span class="op" id="5426390">*</span><span class="ident" id="5426391">ch</span>&nbsp;<span class="op" id="5426394">:</span>&nbsp;<span class="ident" id="5426396">w</span><span class="op" id="5426397">*</span><span class="ident" id="5426398">h</span><span class="op" id="5426399">+</span><span class="num" id="5426400">1</span><span class="op" id="5426401">*</span><span class="ident" id="5426402">cw</span><span class="op" id="5426404">*</span><span class="ident" id="5426405">ch</span><span class="op" id="5426407">]</span><span class="op" id="5426408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426412">Cr</span><span class="op" id="5426414">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426428">b</span><span class="op" id="5426429">[</span><span class="ident" id="5426430">w</span><span class="op" id="5426431">*</span><span class="ident" id="5426432">h</span><span class="op" id="5426433">+</span><span class="num" id="5426434">1</span><span class="op" id="5426435">*</span><span class="ident" id="5426436">cw</span><span class="op" id="5426438">*</span><span class="ident" id="5426439">ch</span>&nbsp;<span class="op" id="5426442">:</span>&nbsp;<span class="ident" id="5426444">w</span><span class="op" id="5426445">*</span><span class="ident" id="5426446">h</span><span class="op" id="5426447">+</span><span class="num" id="5426448">2</span><span class="op" id="5426449">*</span><span class="ident" id="5426450">cw</span><span class="op" id="5426452">*</span><span class="ident" id="5426453">ch</span><span class="op" id="5426455">]</span><span class="op" id="5426456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426460">SubsampleRatio</span><span class="op" id="5426474">:</span>&nbsp;<span class="ident" id="5426476">subsampleRatio</span><span class="op" id="5426490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426494">YStride</span><span class="op" id="5426501">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426510">w</span><span class="op" id="5426511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426515">CStride</span><span class="op" id="5426522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426531">cw</span><span class="op" id="5426533">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5426537">Rect</span><span class="op" id="5426541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5426553">r</span><span class="op" id="5426554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5426557">}</span><br>
<span class="lineno"></span><span class="op" id="5426559">}</span>
</div>
</body>
</html>
