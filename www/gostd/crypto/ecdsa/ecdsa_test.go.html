<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7217300">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7217355">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7217409">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7217460">package</span>&nbsp;<span class="ident" id="7217468">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7217475">import</span>&nbsp;<span class="op" id="7217482">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217485">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217494">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217512">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217531">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217546">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217561">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217578">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217595">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217611">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217619">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217625">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217637">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217643">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7217654">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7217664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7217667">func</span>&nbsp;<span class="ident" id="7217672">testKeyGeneration</span><span class="op" id="7217689">(</span><span class="ident" id="7217690">t</span>&nbsp;<span class="op" id="7217692">*</span><span class="ident" id="7217693">testing</span><span class="op" id="7217700">.</span><span class="ident" id="7217701">T</span><span class="op" id="7217702">,</span>&nbsp;<span class="ident" id="7217704">c</span>&nbsp;<span class="ident" id="7217706">elliptic</span><span class="op" id="7217714">.</span><span class="ident" id="7217715">Curve</span><span class="op" id="7217720">,</span>&nbsp;<span class="ident" id="7217722">tag</span>&nbsp;<span class="builtintype" id="7217726">string</span><span class="op" id="7217732">)</span>&nbsp;<span class="op" id="7217734">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217737">priv</span><span class="op" id="7217741">,</span>&nbsp;<span class="ident" id="7217743">err</span>&nbsp;<span class="op" id="7217747">:=</span>&nbsp;<span class="ident" id="7217750">GenerateKey</span><span class="op" id="7217761">(</span><span class="ident" id="7217762">c</span><span class="op" id="7217763">,</span>&nbsp;<span class="ident" id="7217765">rand</span><span class="op" id="7217769">.</span><span class="ident" id="7217770">Reader</span><span class="op" id="7217776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7217779">if</span>&nbsp;<span class="ident" id="7217782">err</span>&nbsp;<span class="op" id="7217786">!=</span>&nbsp;<span class="ident" id="7217789">nil</span>&nbsp;<span class="op" id="7217793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217797">t</span><span class="op" id="7217798">.</span><span class="ident" id="7217799">Errorf</span><span class="op" id="7217805">(</span><span class="string" id="7217806">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7217821">,</span>&nbsp;<span class="ident" id="7217823">tag</span><span class="op" id="7217826">,</span>&nbsp;<span class="ident" id="7217828">err</span><span class="op" id="7217831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7217835">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217843">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7217846">if</span>&nbsp;<span class="op" id="7217849">!</span><span class="ident" id="7217850">c</span><span class="op" id="7217851">.</span><span class="ident" id="7217852">IsOnCurve</span><span class="op" id="7217861">(</span><span class="ident" id="7217862">priv</span><span class="op" id="7217866">.</span><span class="ident" id="7217867">PublicKey</span><span class="op" id="7217876">.</span><span class="ident" id="7217877">X</span><span class="op" id="7217878">,</span>&nbsp;<span class="ident" id="7217880">priv</span><span class="op" id="7217884">.</span><span class="ident" id="7217885">PublicKey</span><span class="op" id="7217894">.</span><span class="ident" id="7217895">Y</span><span class="op" id="7217896">)</span>&nbsp;<span class="op" id="7217898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217902">t</span><span class="op" id="7217903">.</span><span class="ident" id="7217904">Errorf</span><span class="op" id="7217910">(</span><span class="string" id="7217911">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="7217939">,</span>&nbsp;<span class="ident" id="7217941">tag</span><span class="op" id="7217944">,</span>&nbsp;<span class="ident" id="7217946">err</span><span class="op" id="7217949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7217952">}</span><br>
<span class="lineno"></span><span class="op" id="7217954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7217957">func</span>&nbsp;<span class="ident" id="7217962">TestKeyGeneration</span><span class="op" id="7217979">(</span><span class="ident" id="7217980">t</span>&nbsp;<span class="op" id="7217982">*</span><span class="ident" id="7217983">testing</span><span class="op" id="7217990">.</span><span class="ident" id="7217991">T</span><span class="op" id="7217992">)</span>&nbsp;<span class="op" id="7217994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7217997">testKeyGeneration</span><span class="op" id="7218014">(</span><span class="ident" id="7218015">t</span><span class="op" id="7218016">,</span>&nbsp;<span class="ident" id="7218018">elliptic</span><span class="op" id="7218026">.</span><span class="ident" id="7218027">P224</span><span class="op" id="7218031">(</span><span class="op" id="7218032">)</span><span class="op" id="7218033">,</span>&nbsp;<span class="string" id="7218035">&#34;p224&#34;</span><span class="op" id="7218041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218044">if</span>&nbsp;<span class="ident" id="7218047">testing</span><span class="op" id="7218054">.</span><span class="ident" id="7218055">Short</span><span class="op" id="7218060">(</span><span class="op" id="7218061">)</span>&nbsp;<span class="op" id="7218063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218067">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218075">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218078">testKeyGeneration</span><span class="op" id="7218095">(</span><span class="ident" id="7218096">t</span><span class="op" id="7218097">,</span>&nbsp;<span class="ident" id="7218099">elliptic</span><span class="op" id="7218107">.</span><span class="ident" id="7218108">P256</span><span class="op" id="7218112">(</span><span class="op" id="7218113">)</span><span class="op" id="7218114">,</span>&nbsp;<span class="string" id="7218116">&#34;p256&#34;</span><span class="op" id="7218122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218125">testKeyGeneration</span><span class="op" id="7218142">(</span><span class="ident" id="7218143">t</span><span class="op" id="7218144">,</span>&nbsp;<span class="ident" id="7218146">elliptic</span><span class="op" id="7218154">.</span><span class="ident" id="7218155">P384</span><span class="op" id="7218159">(</span><span class="op" id="7218160">)</span><span class="op" id="7218161">,</span>&nbsp;<span class="string" id="7218163">&#34;p384&#34;</span><span class="op" id="7218169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218172">testKeyGeneration</span><span class="op" id="7218189">(</span><span class="ident" id="7218190">t</span><span class="op" id="7218191">,</span>&nbsp;<span class="ident" id="7218193">elliptic</span><span class="op" id="7218201">.</span><span class="ident" id="7218202">P521</span><span class="op" id="7218206">(</span><span class="op" id="7218207">)</span><span class="op" id="7218208">,</span>&nbsp;<span class="string" id="7218210">&#34;p521&#34;</span><span class="op" id="7218216">)</span><br>
<span class="lineno"></span><span class="op" id="7218218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7218221">func</span>&nbsp;<span class="ident" id="7218226">testSignAndVerify</span><span class="op" id="7218243">(</span><span class="ident" id="7218244">t</span>&nbsp;<span class="op" id="7218246">*</span><span class="ident" id="7218247">testing</span><span class="op" id="7218254">.</span><span class="ident" id="7218255">T</span><span class="op" id="7218256">,</span>&nbsp;<span class="ident" id="7218258">c</span>&nbsp;<span class="ident" id="7218260">elliptic</span><span class="op" id="7218268">.</span><span class="ident" id="7218269">Curve</span><span class="op" id="7218274">,</span>&nbsp;<span class="ident" id="7218276">tag</span>&nbsp;<span class="builtintype" id="7218280">string</span><span class="op" id="7218286">)</span>&nbsp;<span class="op" id="7218288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218291">priv</span><span class="op" id="7218295">,</span>&nbsp;<span class="ident" id="7218297">_</span>&nbsp;<span class="op" id="7218299">:=</span>&nbsp;<span class="ident" id="7218302">GenerateKey</span><span class="op" id="7218313">(</span><span class="ident" id="7218314">c</span><span class="op" id="7218315">,</span>&nbsp;<span class="ident" id="7218317">rand</span><span class="op" id="7218321">.</span><span class="ident" id="7218322">Reader</span><span class="op" id="7218328">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218332">hashed</span>&nbsp;<span class="op" id="7218339">:=</span>&nbsp;<span class="op" id="7218342">[</span><span class="op" id="7218343">]</span><span class="builtintype" id="7218344">byte</span><span class="op" id="7218348">(</span><span class="string" id="7218349">&#34;testing&#34;</span><span class="op" id="7218358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218361">r</span><span class="op" id="7218362">,</span>&nbsp;<span class="ident" id="7218364">s</span><span class="op" id="7218365">,</span>&nbsp;<span class="ident" id="7218367">err</span>&nbsp;<span class="op" id="7218371">:=</span>&nbsp;<span class="ident" id="7218374">Sign</span><span class="op" id="7218378">(</span><span class="ident" id="7218379">rand</span><span class="op" id="7218383">.</span><span class="ident" id="7218384">Reader</span><span class="op" id="7218390">,</span>&nbsp;<span class="ident" id="7218392">priv</span><span class="op" id="7218396">,</span>&nbsp;<span class="ident" id="7218398">hashed</span><span class="op" id="7218404">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218407">if</span>&nbsp;<span class="ident" id="7218410">err</span>&nbsp;<span class="op" id="7218414">!=</span>&nbsp;<span class="ident" id="7218417">nil</span>&nbsp;<span class="op" id="7218421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218425">t</span><span class="op" id="7218426">.</span><span class="ident" id="7218427">Errorf</span><span class="op" id="7218433">(</span><span class="string" id="7218434">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7218457">,</span>&nbsp;<span class="ident" id="7218459">tag</span><span class="op" id="7218462">,</span>&nbsp;<span class="ident" id="7218464">err</span><span class="op" id="7218467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218471">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218483">if</span>&nbsp;<span class="op" id="7218486">!</span><span class="ident" id="7218487">Verify</span><span class="op" id="7218493">(</span><span class="op" id="7218494">&amp;</span><span class="ident" id="7218495">priv</span><span class="op" id="7218499">.</span><span class="ident" id="7218500">PublicKey</span><span class="op" id="7218509">,</span>&nbsp;<span class="ident" id="7218511">hashed</span><span class="op" id="7218517">,</span>&nbsp;<span class="ident" id="7218519">r</span><span class="op" id="7218520">,</span>&nbsp;<span class="ident" id="7218522">s</span><span class="op" id="7218523">)</span>&nbsp;<span class="op" id="7218525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218529">t</span><span class="op" id="7218530">.</span><span class="ident" id="7218531">Errorf</span><span class="op" id="7218537">(</span><span class="string" id="7218538">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7218557">,</span>&nbsp;<span class="ident" id="7218559">tag</span><span class="op" id="7218562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218569">hashed</span><span class="op" id="7218575">[</span><span class="num" id="7218576">0</span><span class="op" id="7218577">]</span>&nbsp;<span class="op" id="7218579">^=</span>&nbsp;<span class="num" id="7218582">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218588">if</span>&nbsp;<span class="ident" id="7218591">Verify</span><span class="op" id="7218597">(</span><span class="op" id="7218598">&amp;</span><span class="ident" id="7218599">priv</span><span class="op" id="7218603">.</span><span class="ident" id="7218604">PublicKey</span><span class="op" id="7218613">,</span>&nbsp;<span class="ident" id="7218615">hashed</span><span class="op" id="7218621">,</span>&nbsp;<span class="ident" id="7218623">r</span><span class="op" id="7218624">,</span>&nbsp;<span class="ident" id="7218626">s</span><span class="op" id="7218627">)</span>&nbsp;<span class="op" id="7218629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218633">t</span><span class="op" id="7218634">.</span><span class="ident" id="7218635">Errorf</span><span class="op" id="7218641">(</span><span class="string" id="7218642">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="7218668">,</span>&nbsp;<span class="ident" id="7218670">tag</span><span class="op" id="7218673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218676">}</span><br>
<span class="lineno"></span><span class="op" id="7218678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7218681">func</span>&nbsp;<span class="ident" id="7218686">TestSignAndVerify</span><span class="op" id="7218703">(</span><span class="ident" id="7218704">t</span>&nbsp;<span class="op" id="7218706">*</span><span class="ident" id="7218707">testing</span><span class="op" id="7218714">.</span><span class="ident" id="7218715">T</span><span class="op" id="7218716">)</span>&nbsp;<span class="op" id="7218718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218721">testSignAndVerify</span><span class="op" id="7218738">(</span><span class="ident" id="7218739">t</span><span class="op" id="7218740">,</span>&nbsp;<span class="ident" id="7218742">elliptic</span><span class="op" id="7218750">.</span><span class="ident" id="7218751">P224</span><span class="op" id="7218755">(</span><span class="op" id="7218756">)</span><span class="op" id="7218757">,</span>&nbsp;<span class="string" id="7218759">&#34;p224&#34;</span><span class="op" id="7218765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218768">if</span>&nbsp;<span class="ident" id="7218771">testing</span><span class="op" id="7218778">.</span><span class="ident" id="7218779">Short</span><span class="op" id="7218784">(</span><span class="op" id="7218785">)</span>&nbsp;<span class="op" id="7218787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7218791">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7218799">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218802">testSignAndVerify</span><span class="op" id="7218819">(</span><span class="ident" id="7218820">t</span><span class="op" id="7218821">,</span>&nbsp;<span class="ident" id="7218823">elliptic</span><span class="op" id="7218831">.</span><span class="ident" id="7218832">P256</span><span class="op" id="7218836">(</span><span class="op" id="7218837">)</span><span class="op" id="7218838">,</span>&nbsp;<span class="string" id="7218840">&#34;p256&#34;</span><span class="op" id="7218846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218849">testSignAndVerify</span><span class="op" id="7218866">(</span><span class="ident" id="7218867">t</span><span class="op" id="7218868">,</span>&nbsp;<span class="ident" id="7218870">elliptic</span><span class="op" id="7218878">.</span><span class="ident" id="7218879">P384</span><span class="op" id="7218883">(</span><span class="op" id="7218884">)</span><span class="op" id="7218885">,</span>&nbsp;<span class="string" id="7218887">&#34;p384&#34;</span><span class="op" id="7218893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218896">testSignAndVerify</span><span class="op" id="7218913">(</span><span class="ident" id="7218914">t</span><span class="op" id="7218915">,</span>&nbsp;<span class="ident" id="7218917">elliptic</span><span class="op" id="7218925">.</span><span class="ident" id="7218926">P521</span><span class="op" id="7218930">(</span><span class="op" id="7218931">)</span><span class="op" id="7218932">,</span>&nbsp;<span class="string" id="7218934">&#34;p521&#34;</span><span class="op" id="7218940">)</span><br>
<span class="lineno"></span><span class="op" id="7218942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7218945">func</span>&nbsp;<span class="ident" id="7218950">fromHex</span><span class="op" id="7218957">(</span><span class="ident" id="7218958">s</span>&nbsp;<span class="builtintype" id="7218960">string</span><span class="op" id="7218966">)</span>&nbsp;<span class="op" id="7218968">*</span><span class="ident" id="7218969">big</span><span class="op" id="7218972">.</span><span class="ident" id="7218973">Int</span>&nbsp;<span class="op" id="7218977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7218980">r</span><span class="op" id="7218981">,</span>&nbsp;<span class="ident" id="7218983">ok</span>&nbsp;<span class="op" id="7218986">:=</span>&nbsp;<span class="builtinfunc" id="7218989">new</span><span class="op" id="7218992">(</span><span class="ident" id="7218993">big</span><span class="op" id="7218996">.</span><span class="ident" id="7218997">Int</span><span class="op" id="7219000">)</span><span class="op" id="7219001">.</span><span class="ident" id="7219002">SetString</span><span class="op" id="7219011">(</span><span class="ident" id="7219012">s</span><span class="op" id="7219013">,</span>&nbsp;<span class="num" id="7219015">16</span><span class="op" id="7219017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219020">if</span>&nbsp;<span class="op" id="7219023">!</span><span class="ident" id="7219024">ok</span>&nbsp;<span class="op" id="7219027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7219031">panic</span><span class="op" id="7219036">(</span><span class="string" id="7219037">&#34;bad&nbsp;hex&#34;</span><span class="op" id="7219046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219049">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219052">return</span>&nbsp;<span class="ident" id="7219059">r</span><br>
<span class="lineno"></span><span class="op" id="7219061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7219064">func</span>&nbsp;<span class="ident" id="7219069">TestVectors</span><span class="op" id="7219080">(</span><span class="ident" id="7219081">t</span>&nbsp;<span class="op" id="7219083">*</span><span class="ident" id="7219084">testing</span><span class="op" id="7219091">.</span><span class="ident" id="7219092">T</span><span class="op" id="7219093">)</span>&nbsp;<span class="op" id="7219095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219098">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219156">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219237">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219241">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219308">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219361">if</span>&nbsp;<span class="ident" id="7219364">testing</span><span class="op" id="7219371">.</span><span class="ident" id="7219372">Short</span><span class="op" id="7219377">(</span><span class="op" id="7219378">)</span>&nbsp;<span class="op" id="7219380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219384">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219396">f</span><span class="op" id="7219397">,</span>&nbsp;<span class="ident" id="7219399">err</span>&nbsp;<span class="op" id="7219403">:=</span>&nbsp;<span class="ident" id="7219406">os</span><span class="op" id="7219408">.</span><span class="ident" id="7219409">Open</span><span class="op" id="7219413">(</span><span class="string" id="7219414">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="7219439">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219442">if</span>&nbsp;<span class="ident" id="7219445">err</span>&nbsp;<span class="op" id="7219449">!=</span>&nbsp;<span class="ident" id="7219452">nil</span>&nbsp;<span class="op" id="7219456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219460">t</span><span class="op" id="7219461">.</span><span class="ident" id="7219462">Fatal</span><span class="op" id="7219467">(</span><span class="ident" id="7219468">err</span><span class="op" id="7219471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219478">buf</span>&nbsp;<span class="op" id="7219482">:=</span>&nbsp;<span class="ident" id="7219485">bufio</span><span class="op" id="7219490">.</span><span class="ident" id="7219491">NewReader</span><span class="op" id="7219500">(</span><span class="ident" id="7219501">bzip2</span><span class="op" id="7219506">.</span><span class="ident" id="7219507">NewReader</span><span class="op" id="7219516">(</span><span class="ident" id="7219517">f</span><span class="op" id="7219518">)</span><span class="op" id="7219519">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219523">lineNo</span>&nbsp;<span class="op" id="7219530">:=</span>&nbsp;<span class="num" id="7219533">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219536">var</span>&nbsp;<span class="ident" id="7219540">h</span>&nbsp;<span class="ident" id="7219542">hash</span><span class="op" id="7219546">.</span><span class="ident" id="7219547">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219553">var</span>&nbsp;<span class="ident" id="7219557">msg</span>&nbsp;<span class="op" id="7219561">[</span><span class="op" id="7219562">]</span><span class="builtintype" id="7219563">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219569">var</span>&nbsp;<span class="ident" id="7219573">hashed</span>&nbsp;<span class="op" id="7219580">[</span><span class="op" id="7219581">]</span><span class="builtintype" id="7219582">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219588">var</span>&nbsp;<span class="ident" id="7219592">r</span><span class="op" id="7219593">,</span>&nbsp;<span class="ident" id="7219595">s</span>&nbsp;<span class="op" id="7219597">*</span><span class="ident" id="7219598">big</span><span class="op" id="7219601">.</span><span class="ident" id="7219602">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219607">pub</span>&nbsp;<span class="op" id="7219611">:=</span>&nbsp;<span class="builtinfunc" id="7219614">new</span><span class="op" id="7219617">(</span><span class="ident" id="7219618">PublicKey</span><span class="op" id="7219627">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219631">for</span>&nbsp;<span class="op" id="7219635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219639">line</span><span class="op" id="7219643">,</span>&nbsp;<span class="ident" id="7219645">err</span>&nbsp;<span class="op" id="7219649">:=</span>&nbsp;<span class="ident" id="7219652">buf</span><span class="op" id="7219655">.</span><span class="ident" id="7219656">ReadString</span><span class="op" id="7219666">(</span><span class="string" id="7219667">&#39;\n&#39;</span><span class="op" id="7219671">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219675">if</span>&nbsp;<span class="builtinfunc" id="7219678">len</span><span class="op" id="7219681">(</span><span class="ident" id="7219682">line</span><span class="op" id="7219686">)</span>&nbsp;<span class="op" id="7219688">==</span>&nbsp;<span class="num" id="7219691">0</span>&nbsp;<span class="op" id="7219693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219698">if</span>&nbsp;<span class="ident" id="7219701">err</span>&nbsp;<span class="op" id="7219705">==</span>&nbsp;<span class="ident" id="7219708">io</span><span class="op" id="7219710">.</span><span class="ident" id="7219711">EOF</span>&nbsp;<span class="op" id="7219715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219721">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219735">t</span><span class="op" id="7219736">.</span><span class="ident" id="7219737">Fatalf</span><span class="op" id="7219743">(</span><span class="string" id="7219744">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="7219774">,</span>&nbsp;<span class="ident" id="7219776">err</span><span class="op" id="7219779">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219787">lineNo</span><span class="op" id="7219793">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7219798">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219849">if</span>&nbsp;<span class="op" id="7219852">!</span><span class="ident" id="7219853">strings</span><span class="op" id="7219860">.</span><span class="ident" id="7219861">HasSuffix</span><span class="op" id="7219870">(</span><span class="ident" id="7219871">line</span><span class="op" id="7219875">,</span>&nbsp;<span class="string" id="7219877">&#34;\r\n&#34;</span><span class="op" id="7219883">)</span>&nbsp;<span class="op" id="7219885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219890">t</span><span class="op" id="7219891">.</span><span class="ident" id="7219892">Fatalf</span><span class="op" id="7219898">(</span><span class="string" id="7219899">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7219945">,</span>&nbsp;<span class="ident" id="7219947">lineNo</span><span class="op" id="7219953">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7219957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7219961">line</span>&nbsp;<span class="op" id="7219966">=</span>&nbsp;<span class="ident" id="7219968">line</span><span class="op" id="7219972">[</span><span class="op" id="7219973">:</span><span class="builtinfunc" id="7219974">len</span><span class="op" id="7219977">(</span><span class="ident" id="7219978">line</span><span class="op" id="7219982">)</span><span class="op" id="7219983">-</span><span class="num" id="7219984">2</span><span class="op" id="7219985">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7219990">if</span>&nbsp;<span class="builtinfunc" id="7219993">len</span><span class="op" id="7219996">(</span><span class="ident" id="7219997">line</span><span class="op" id="7220001">)</span>&nbsp;<span class="op" id="7220003">==</span>&nbsp;<span class="num" id="7220006">0</span>&nbsp;<span class="op" id="7220008">||</span>&nbsp;<span class="ident" id="7220011">line</span><span class="op" id="7220015">[</span><span class="num" id="7220016">0</span><span class="op" id="7220017">]</span>&nbsp;<span class="op" id="7220019">==</span>&nbsp;<span class="string" id="7220022">&#39;#&#39;</span>&nbsp;<span class="op" id="7220026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220031">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220047">if</span>&nbsp;<span class="ident" id="7220050">line</span><span class="op" id="7220054">[</span><span class="num" id="7220055">0</span><span class="op" id="7220056">]</span>&nbsp;<span class="op" id="7220058">==</span>&nbsp;<span class="string" id="7220061">&#39;[&#39;</span>&nbsp;<span class="op" id="7220065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220070">line</span>&nbsp;<span class="op" id="7220075">=</span>&nbsp;<span class="ident" id="7220077">line</span><span class="op" id="7220081">[</span><span class="num" id="7220082">1</span>&nbsp;<span class="op" id="7220084">:</span>&nbsp;<span class="builtinfunc" id="7220086">len</span><span class="op" id="7220089">(</span><span class="ident" id="7220090">line</span><span class="op" id="7220094">)</span><span class="op" id="7220095">-</span><span class="num" id="7220096">1</span><span class="op" id="7220097">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220102">parts</span>&nbsp;<span class="op" id="7220108">:=</span>&nbsp;<span class="ident" id="7220111">strings</span><span class="op" id="7220118">.</span><span class="ident" id="7220119">SplitN</span><span class="op" id="7220125">(</span><span class="ident" id="7220126">line</span><span class="op" id="7220130">,</span>&nbsp;<span class="string" id="7220132">&#34;,&#34;</span><span class="op" id="7220135">,</span>&nbsp;<span class="num" id="7220137">2</span><span class="op" id="7220138">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220144">switch</span>&nbsp;<span class="ident" id="7220151">parts</span><span class="op" id="7220156">[</span><span class="num" id="7220157">0</span><span class="op" id="7220158">]</span>&nbsp;<span class="op" id="7220160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220165">case</span>&nbsp;<span class="string" id="7220170">&#34;P-224&#34;</span><span class="op" id="7220177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220183">pub</span><span class="op" id="7220186">.</span><span class="ident" id="7220187">Curve</span>&nbsp;<span class="op" id="7220193">=</span>&nbsp;<span class="ident" id="7220195">elliptic</span><span class="op" id="7220203">.</span><span class="ident" id="7220204">P224</span><span class="op" id="7220208">(</span><span class="op" id="7220209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220214">case</span>&nbsp;<span class="string" id="7220219">&#34;P-256&#34;</span><span class="op" id="7220226">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220232">pub</span><span class="op" id="7220235">.</span><span class="ident" id="7220236">Curve</span>&nbsp;<span class="op" id="7220242">=</span>&nbsp;<span class="ident" id="7220244">elliptic</span><span class="op" id="7220252">.</span><span class="ident" id="7220253">P256</span><span class="op" id="7220257">(</span><span class="op" id="7220258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220263">case</span>&nbsp;<span class="string" id="7220268">&#34;P-384&#34;</span><span class="op" id="7220275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220281">pub</span><span class="op" id="7220284">.</span><span class="ident" id="7220285">Curve</span>&nbsp;<span class="op" id="7220291">=</span>&nbsp;<span class="ident" id="7220293">elliptic</span><span class="op" id="7220301">.</span><span class="ident" id="7220302">P384</span><span class="op" id="7220306">(</span><span class="op" id="7220307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220312">case</span>&nbsp;<span class="string" id="7220317">&#34;P-521&#34;</span><span class="op" id="7220324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220330">pub</span><span class="op" id="7220333">.</span><span class="ident" id="7220334">Curve</span>&nbsp;<span class="op" id="7220340">=</span>&nbsp;<span class="ident" id="7220342">elliptic</span><span class="op" id="7220350">.</span><span class="ident" id="7220351">P521</span><span class="op" id="7220355">(</span><span class="op" id="7220356">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220361">default</span><span class="op" id="7220368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220374">pub</span><span class="op" id="7220377">.</span><span class="ident" id="7220378">Curve</span>&nbsp;<span class="op" id="7220384">=</span>&nbsp;<span class="ident" id="7220386">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220399">switch</span>&nbsp;<span class="ident" id="7220406">parts</span><span class="op" id="7220411">[</span><span class="num" id="7220412">1</span><span class="op" id="7220413">]</span>&nbsp;<span class="op" id="7220415">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220420">case</span>&nbsp;<span class="string" id="7220425">&#34;SHA-1&#34;</span><span class="op" id="7220432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220438">h</span>&nbsp;<span class="op" id="7220440">=</span>&nbsp;<span class="ident" id="7220442">sha1</span><span class="op" id="7220446">.</span><span class="ident" id="7220447">New</span><span class="op" id="7220450">(</span><span class="op" id="7220451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220456">case</span>&nbsp;<span class="string" id="7220461">&#34;SHA-224&#34;</span><span class="op" id="7220470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220476">h</span>&nbsp;<span class="op" id="7220478">=</span>&nbsp;<span class="ident" id="7220480">sha256</span><span class="op" id="7220486">.</span><span class="ident" id="7220487">New224</span><span class="op" id="7220493">(</span><span class="op" id="7220494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220499">case</span>&nbsp;<span class="string" id="7220504">&#34;SHA-256&#34;</span><span class="op" id="7220513">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220519">h</span>&nbsp;<span class="op" id="7220521">=</span>&nbsp;<span class="ident" id="7220523">sha256</span><span class="op" id="7220529">.</span><span class="ident" id="7220530">New</span><span class="op" id="7220533">(</span><span class="op" id="7220534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220539">case</span>&nbsp;<span class="string" id="7220544">&#34;SHA-384&#34;</span><span class="op" id="7220553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220559">h</span>&nbsp;<span class="op" id="7220561">=</span>&nbsp;<span class="ident" id="7220563">sha512</span><span class="op" id="7220569">.</span><span class="ident" id="7220570">New384</span><span class="op" id="7220576">(</span><span class="op" id="7220577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220582">case</span>&nbsp;<span class="string" id="7220587">&#34;SHA-512&#34;</span><span class="op" id="7220596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220602">h</span>&nbsp;<span class="op" id="7220604">=</span>&nbsp;<span class="ident" id="7220606">sha512</span><span class="op" id="7220612">.</span><span class="ident" id="7220613">New</span><span class="op" id="7220616">(</span><span class="op" id="7220617">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220622">default</span><span class="op" id="7220629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220635">h</span>&nbsp;<span class="op" id="7220637">=</span>&nbsp;<span class="ident" id="7220639">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220652">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220668">if</span>&nbsp;<span class="ident" id="7220671">h</span>&nbsp;<span class="op" id="7220673">==</span>&nbsp;<span class="ident" id="7220676">nil</span>&nbsp;<span class="op" id="7220680">||</span>&nbsp;<span class="ident" id="7220683">pub</span><span class="op" id="7220686">.</span><span class="ident" id="7220687">Curve</span>&nbsp;<span class="op" id="7220693">==</span>&nbsp;<span class="ident" id="7220696">nil</span>&nbsp;<span class="op" id="7220700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220705">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220716">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220721">switch</span>&nbsp;<span class="op" id="7220728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220732">case</span>&nbsp;<span class="ident" id="7220737">strings</span><span class="op" id="7220744">.</span><span class="ident" id="7220745">HasPrefix</span><span class="op" id="7220754">(</span><span class="ident" id="7220755">line</span><span class="op" id="7220759">,</span>&nbsp;<span class="string" id="7220761">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="7220769">)</span><span class="op" id="7220770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220775">if</span>&nbsp;<span class="ident" id="7220778">msg</span><span class="op" id="7220781">,</span>&nbsp;<span class="ident" id="7220783">err</span>&nbsp;<span class="op" id="7220787">=</span>&nbsp;<span class="ident" id="7220789">hex</span><span class="op" id="7220792">.</span><span class="ident" id="7220793">DecodeString</span><span class="op" id="7220805">(</span><span class="ident" id="7220806">line</span><span class="op" id="7220810">[</span><span class="num" id="7220811">6</span><span class="op" id="7220812">:</span><span class="op" id="7220813">]</span><span class="op" id="7220814">)</span><span class="op" id="7220815">;</span>&nbsp;<span class="ident" id="7220817">err</span>&nbsp;<span class="op" id="7220821">!=</span>&nbsp;<span class="ident" id="7220824">nil</span>&nbsp;<span class="op" id="7220828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220834">t</span><span class="op" id="7220835">.</span><span class="ident" id="7220836">Fatalf</span><span class="op" id="7220842">(</span><span class="string" id="7220843">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7220884">,</span>&nbsp;<span class="ident" id="7220886">lineNo</span><span class="op" id="7220892">,</span>&nbsp;<span class="ident" id="7220894">err</span><span class="op" id="7220897">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7220902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220906">case</span>&nbsp;<span class="ident" id="7220911">strings</span><span class="op" id="7220918">.</span><span class="ident" id="7220919">HasPrefix</span><span class="op" id="7220928">(</span><span class="ident" id="7220929">line</span><span class="op" id="7220933">,</span>&nbsp;<span class="string" id="7220935">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="7220942">)</span><span class="op" id="7220943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7220948">pub</span><span class="op" id="7220951">.</span><span class="ident" id="7220952">X</span>&nbsp;<span class="op" id="7220954">=</span>&nbsp;<span class="ident" id="7220956">fromHex</span><span class="op" id="7220963">(</span><span class="ident" id="7220964">line</span><span class="op" id="7220968">[</span><span class="num" id="7220969">5</span><span class="op" id="7220970">:</span><span class="op" id="7220971">]</span><span class="op" id="7220972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7220976">case</span>&nbsp;<span class="ident" id="7220981">strings</span><span class="op" id="7220988">.</span><span class="ident" id="7220989">HasPrefix</span><span class="op" id="7220998">(</span><span class="ident" id="7220999">line</span><span class="op" id="7221003">,</span>&nbsp;<span class="string" id="7221005">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="7221012">)</span><span class="op" id="7221013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221018">pub</span><span class="op" id="7221021">.</span><span class="ident" id="7221022">Y</span>&nbsp;<span class="op" id="7221024">=</span>&nbsp;<span class="ident" id="7221026">fromHex</span><span class="op" id="7221033">(</span><span class="ident" id="7221034">line</span><span class="op" id="7221038">[</span><span class="num" id="7221039">5</span><span class="op" id="7221040">:</span><span class="op" id="7221041">]</span><span class="op" id="7221042">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221046">case</span>&nbsp;<span class="ident" id="7221051">strings</span><span class="op" id="7221058">.</span><span class="ident" id="7221059">HasPrefix</span><span class="op" id="7221068">(</span><span class="ident" id="7221069">line</span><span class="op" id="7221073">,</span>&nbsp;<span class="string" id="7221075">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="7221081">)</span><span class="op" id="7221082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221087">r</span>&nbsp;<span class="op" id="7221089">=</span>&nbsp;<span class="ident" id="7221091">fromHex</span><span class="op" id="7221098">(</span><span class="ident" id="7221099">line</span><span class="op" id="7221103">[</span><span class="num" id="7221104">4</span><span class="op" id="7221105">:</span><span class="op" id="7221106">]</span><span class="op" id="7221107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221111">case</span>&nbsp;<span class="ident" id="7221116">strings</span><span class="op" id="7221123">.</span><span class="ident" id="7221124">HasPrefix</span><span class="op" id="7221133">(</span><span class="ident" id="7221134">line</span><span class="op" id="7221138">,</span>&nbsp;<span class="string" id="7221140">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="7221146">)</span><span class="op" id="7221147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221152">s</span>&nbsp;<span class="op" id="7221154">=</span>&nbsp;<span class="ident" id="7221156">fromHex</span><span class="op" id="7221163">(</span><span class="ident" id="7221164">line</span><span class="op" id="7221168">[</span><span class="num" id="7221169">4</span><span class="op" id="7221170">:</span><span class="op" id="7221171">]</span><span class="op" id="7221172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221176">case</span>&nbsp;<span class="ident" id="7221181">strings</span><span class="op" id="7221188">.</span><span class="ident" id="7221189">HasPrefix</span><span class="op" id="7221198">(</span><span class="ident" id="7221199">line</span><span class="op" id="7221203">,</span>&nbsp;<span class="string" id="7221205">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="7221216">)</span><span class="op" id="7221217">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221222">expected</span>&nbsp;<span class="op" id="7221231">:=</span>&nbsp;<span class="ident" id="7221234">line</span><span class="op" id="7221238">[</span><span class="num" id="7221239">9</span><span class="op" id="7221240">]</span>&nbsp;<span class="op" id="7221242">==</span>&nbsp;<span class="string" id="7221245">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221252">h</span><span class="op" id="7221253">.</span><span class="ident" id="7221254">Reset</span><span class="op" id="7221259">(</span><span class="op" id="7221260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221265">h</span><span class="op" id="7221266">.</span><span class="ident" id="7221267">Write</span><span class="op" id="7221272">(</span><span class="ident" id="7221273">msg</span><span class="op" id="7221276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221281">hashed</span>&nbsp;<span class="op" id="7221288">:=</span>&nbsp;<span class="ident" id="7221291">h</span><span class="op" id="7221292">.</span><span class="ident" id="7221293">Sum</span><span class="op" id="7221296">(</span><span class="ident" id="7221297">hashed</span><span class="op" id="7221303">[</span><span class="op" id="7221304">:</span><span class="num" id="7221305">0</span><span class="op" id="7221306">]</span><span class="op" id="7221307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221312">if</span>&nbsp;<span class="ident" id="7221315">Verify</span><span class="op" id="7221321">(</span><span class="ident" id="7221322">pub</span><span class="op" id="7221325">,</span>&nbsp;<span class="ident" id="7221327">hashed</span><span class="op" id="7221333">,</span>&nbsp;<span class="ident" id="7221335">r</span><span class="op" id="7221336">,</span>&nbsp;<span class="ident" id="7221338">s</span><span class="op" id="7221339">)</span>&nbsp;<span class="op" id="7221341">!=</span>&nbsp;<span class="ident" id="7221344">expected</span>&nbsp;<span class="op" id="7221353">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221359">t</span><span class="op" id="7221360">.</span><span class="ident" id="7221361">Fatalf</span><span class="op" id="7221367">(</span><span class="string" id="7221368">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="7221397">,</span>&nbsp;<span class="ident" id="7221399">lineNo</span><span class="op" id="7221405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7221414">default</span><span class="op" id="7221421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7221426">t</span><span class="op" id="7221427">.</span><span class="ident" id="7221428">Fatalf</span><span class="op" id="7221434">(</span><span class="string" id="7221435">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="7221468">,</span>&nbsp;<span class="ident" id="7221470">lineNo</span><span class="op" id="7221476">,</span>&nbsp;<span class="ident" id="7221478">line</span><span class="op" id="7221482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221486">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7221489">}</span><br>
<span class="lineno"></span><span class="op" id="7221491">}</span>
</div>
</body>
</html>
