<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html" class="current">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4760059">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4760114">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4760168">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4760219">package</span>&nbsp;<span class="ident" id="4760227">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4760232">import</span>&nbsp;<span class="op" id="4760239">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760242">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760251">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760260">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760272">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760279">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760285">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760296">&#34;strconv&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4760307">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4760317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4760320">const</span>&nbsp;<span class="op" id="4760326">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760329">//&nbsp;A&nbsp;generic&nbsp;XML&nbsp;header&nbsp;suitable&nbsp;for&nbsp;use&nbsp;with&nbsp;the&nbsp;output&nbsp;of&nbsp;Marshal.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760399">//&nbsp;This&nbsp;is&nbsp;not&nbsp;automatically&nbsp;added&nbsp;to&nbsp;any&nbsp;output&nbsp;of&nbsp;this&nbsp;package,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4760466">//&nbsp;it&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;convenience.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760503">Header</span>&nbsp;<span class="op" id="4760510">=</span>&nbsp;<span class="string" id="4760512">`&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;`</span>&nbsp;<span class="op" id="4760553">+</span>&nbsp;<span class="string" id="4760555">&#34;\n&#34;</span><br>
<span class="lineno"></span><span class="op" id="4760560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4760563">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="4760605">//</span><br>
<span class="lineno"></span><span class="comment" id="4760608">//&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;array&nbsp;or&nbsp;slice&nbsp;by&nbsp;marshalling&nbsp;each&nbsp;of&nbsp;the&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="4760682">//&nbsp;Marshal&nbsp;handles&nbsp;a&nbsp;pointer&nbsp;by&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;points&nbsp;at&nbsp;or,&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4760760">//&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;by&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;interface&nbsp;value&nbsp;by</span><br>
<span class="lineno">30</span><span class="comment" id="4760838">//&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;contains&nbsp;or,&nbsp;if&nbsp;the&nbsp;interface&nbsp;value&nbsp;is&nbsp;nil,&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4760913">//&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;all&nbsp;other&nbsp;data&nbsp;by&nbsp;writing&nbsp;one&nbsp;or&nbsp;more&nbsp;XML</span><br>
<span class="lineno"></span><span class="comment" id="4760992">//&nbsp;elements&nbsp;containing&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="4761025">//</span><br>
<span class="lineno"></span><span class="comment" id="4761028">//&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;XML&nbsp;elements&nbsp;is&nbsp;taken&nbsp;from,&nbsp;in&nbsp;order&nbsp;of&nbsp;preference:</span><br>
<span class="lineno">35</span><span class="comment" id="4761100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;on&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;if&nbsp;the&nbsp;data&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4761163">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;XMLName&nbsp;field&nbsp;of&nbsp;type&nbsp;xml.Name</span><br>
<span class="lineno"></span><span class="comment" id="4761220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4761281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4761343">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;marshalled&nbsp;type</span><br>
<span class="lineno">40</span><span class="comment" id="4761384">//</span><br>
<span class="lineno"></span><span class="comment" id="4761387">//&nbsp;The&nbsp;XML&nbsp;element&nbsp;for&nbsp;a&nbsp;struct&nbsp;contains&nbsp;marshalled&nbsp;elements&nbsp;for&nbsp;each&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4761464">//&nbsp;exported&nbsp;fields&nbsp;of&nbsp;the&nbsp;struct,&nbsp;with&nbsp;these&nbsp;exceptions:</span><br>
<span class="lineno"></span><span class="comment" id="4761521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;described&nbsp;above,&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="comment" id="4761578">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;-&#34;&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno">45</span><span class="comment" id="4761620">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;name,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4761684">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="4761728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4761792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="4761832">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,chardata&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;character&nbsp;data,</span><br>
<span class="lineno">50</span><span class="comment" id="4761900">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;as&nbsp;an&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="4761932">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,innerxml&#34;&nbsp;is&nbsp;written&nbsp;verbatim,&nbsp;not&nbsp;subject</span><br>
<span class="lineno"></span><span class="comment" id="4762003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.</span><br>
<span class="lineno"></span><span class="comment" id="4762048">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,comment&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;an&nbsp;XML&nbsp;comment,&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4762119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.&nbsp;It&nbsp;must&nbsp;not&nbsp;contain</span><br>
<span class="lineno">55</span><span class="comment" id="4762192">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;&#34;--&#34;&nbsp;string&nbsp;within&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4762228">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;including&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option&nbsp;is&nbsp;omitted</span><br>
<span class="lineno"></span><span class="comment" id="4762300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;field&nbsp;value&nbsp;is&nbsp;empty.&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="4762373">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4762444">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;of&nbsp;length&nbsp;zero.</span><br>
<span class="lineno">60</span><span class="comment" id="4762476">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;is&nbsp;handled&nbsp;as&nbsp;if&nbsp;the&nbsp;fields&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="4762546">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;were&nbsp;part&nbsp;of&nbsp;the&nbsp;outer&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment" id="4762592">//</span><br>
<span class="lineno"></span><span class="comment" id="4762595">//&nbsp;If&nbsp;a&nbsp;field&nbsp;uses&nbsp;a&nbsp;tag&nbsp;&#34;a&gt;b&gt;c&#34;,&nbsp;then&nbsp;the&nbsp;element&nbsp;c&nbsp;will&nbsp;be&nbsp;nested&nbsp;inside</span><br>
<span class="lineno"></span><span class="comment" id="4762670">//&nbsp;parent&nbsp;elements&nbsp;a&nbsp;and&nbsp;b.&nbsp;&nbsp;Fields&nbsp;that&nbsp;appear&nbsp;next&nbsp;to&nbsp;each&nbsp;other&nbsp;that&nbsp;name</span><br>
<span class="lineno">65</span><span class="comment" id="4762747">//&nbsp;the&nbsp;same&nbsp;parent&nbsp;will&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;one&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="4762803">//</span><br>
<span class="lineno"></span><span class="comment" id="4762806">//&nbsp;See&nbsp;MarshalIndent&nbsp;for&nbsp;an&nbsp;example.</span><br>
<span class="lineno"></span><span class="comment" id="4762843">//</span><br>
<span class="lineno"></span><span class="comment" id="4762846">//&nbsp;Marshal&nbsp;will&nbsp;return&nbsp;an&nbsp;error&nbsp;if&nbsp;asked&nbsp;to&nbsp;marshal&nbsp;a&nbsp;channel,&nbsp;function,&nbsp;or&nbsp;map.</span><br>
<span class="lineno">70</span><span class="keyword" id="4762927">func</span>&nbsp;<span class="ident" id="4762932">Marshal</span><span class="op" id="4762939">(</span><span class="ident" id="4762940">v</span>&nbsp;<span class="keyword" id="4762942">interface</span><span class="op" id="4762951">{</span><span class="op" id="4762952">}</span><span class="op" id="4762953">)</span>&nbsp;<span class="op" id="4762955">(</span><span class="op" id="4762956">[</span><span class="op" id="4762957">]</span><span class="builtintype" id="4762958">byte</span><span class="op" id="4762962">,</span>&nbsp;<span class="builtintype" id="4762964">error</span><span class="op" id="4762969">)</span>&nbsp;<span class="op" id="4762971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762974">var</span>&nbsp;<span class="ident" id="4762978">b</span>&nbsp;<span class="ident" id="4762980">bytes</span><span class="op" id="4762985">.</span><span class="ident" id="4762986">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762994">if</span>&nbsp;<span class="ident" id="4762997">err</span>&nbsp;<span class="op" id="4763001">:=</span>&nbsp;<span class="ident" id="4763004">NewEncoder</span><span class="op" id="4763014">(</span><span class="op" id="4763015">&amp;</span><span class="ident" id="4763016">b</span><span class="op" id="4763017">)</span><span class="op" id="4763018">.</span><span class="ident" id="4763019">Encode</span><span class="op" id="4763025">(</span><span class="ident" id="4763026">v</span><span class="op" id="4763027">)</span><span class="op" id="4763028">;</span>&nbsp;<span class="ident" id="4763030">err</span>&nbsp;<span class="op" id="4763034">!=</span>&nbsp;<span class="builtintype" id="4763037">nil</span>&nbsp;<span class="op" id="4763041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763045">return</span>&nbsp;<span class="builtintype" id="4763052">nil</span><span class="op" id="4763055">,</span>&nbsp;<span class="ident" id="4763057">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763062">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763065">return</span>&nbsp;<span class="ident" id="4763072">b</span><span class="op" id="4763073">.</span><span class="ident" id="4763074">Bytes</span><span class="op" id="4763079">(</span><span class="op" id="4763080">)</span><span class="op" id="4763081">,</span>&nbsp;<span class="builtintype" id="4763083">nil</span><br>
<span class="lineno"></span><span class="op" id="4763087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4763090">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="4763160">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno">80</span><span class="comment" id="4763199">//</span><br>
<span class="lineno"></span><span class="comment" id="4763202">//&nbsp;MarshalXML&nbsp;encodes&nbsp;the&nbsp;receiver&nbsp;as&nbsp;zero&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="4763267">//&nbsp;By&nbsp;convention,&nbsp;arrays&nbsp;or&nbsp;slices&nbsp;are&nbsp;typically&nbsp;encoded&nbsp;as&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="4763338">//&nbsp;of&nbsp;elements,&nbsp;one&nbsp;per&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="4763369">//&nbsp;Using&nbsp;start&nbsp;as&nbsp;the&nbsp;element&nbsp;tag&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno">85</span><span class="comment" id="4763433">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;XML&nbsp;elements&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="4763499">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="4763516">//&nbsp;One&nbsp;common&nbsp;implementation&nbsp;strategy&nbsp;is&nbsp;to&nbsp;construct&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span><span class="comment" id="4763581">//&nbsp;value&nbsp;with&nbsp;a&nbsp;layout&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;desired&nbsp;XML&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="4763646">//&nbsp;to&nbsp;encode&nbsp;it&nbsp;using&nbsp;e.EncodeElement.</span><br>
<span class="lineno">90</span><span class="comment" id="4763685">//&nbsp;Another&nbsp;common&nbsp;strategy&nbsp;is&nbsp;to&nbsp;use&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;e.EncodeToken</span><br>
<span class="lineno"></span><span class="comment" id="4763754">//&nbsp;to&nbsp;generate&nbsp;the&nbsp;XML&nbsp;output&nbsp;one&nbsp;token&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="4763805">//&nbsp;The&nbsp;sequence&nbsp;of&nbsp;encoded&nbsp;tokens&nbsp;must&nbsp;make&nbsp;up&nbsp;zero&nbsp;or&nbsp;more&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="4763871">//&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="4763888">type</span>&nbsp;<span class="ident" id="4763893">Marshaler</span>&nbsp;<span class="keyword" id="4763903">interface</span>&nbsp;<span class="op" id="4763913">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763916">MarshalXML</span><span class="op" id="4763926">(</span><span class="ident" id="4763927">e</span>&nbsp;<span class="op" id="4763929">*</span><span class="ident" id="4763930">Encoder</span><span class="op" id="4763937">,</span>&nbsp;<span class="ident" id="4763939">start</span>&nbsp;<span class="ident" id="4763945">StartElement</span><span class="op" id="4763957">)</span>&nbsp;<span class="builtintype" id="4763959">error</span><br>
<span class="lineno"></span><span class="op" id="4763965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4763968">//&nbsp;MarshalerAttr&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="4764042">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;attributes.</span><br>
<span class="lineno">100</span><span class="comment" id="4764083">//</span><br>
<span class="lineno"></span><span class="comment" id="4764086">//&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;an&nbsp;XML&nbsp;attribute&nbsp;with&nbsp;the&nbsp;encoded&nbsp;value&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="4764169">//&nbsp;Using&nbsp;name&nbsp;as&nbsp;the&nbsp;attribute&nbsp;name&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="4764235">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;attribute&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="4764298">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno">105</span><span class="comment" id="4764315">//&nbsp;If&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;the&nbsp;zero&nbsp;attribute&nbsp;Attr{},&nbsp;no&nbsp;attribute</span><br>
<span class="lineno"></span><span class="comment" id="4764384">//&nbsp;will&nbsp;be&nbsp;generated&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="4764420">//&nbsp;MarshalXMLAttr&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;struct&nbsp;fields&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4764478">//&nbsp;&#34;attr&#34;&nbsp;option&nbsp;in&nbsp;the&nbsp;field&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4764513">type</span>&nbsp;<span class="ident" id="4764518">MarshalerAttr</span>&nbsp;<span class="keyword" id="4764532">interface</span>&nbsp;<span class="op" id="4764542">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764545">MarshalXMLAttr</span><span class="op" id="4764559">(</span><span class="ident" id="4764560">name</span>&nbsp;<span class="ident" id="4764565">Name</span><span class="op" id="4764569">)</span>&nbsp;<span class="op" id="4764571">(</span><span class="ident" id="4764572">Attr</span><span class="op" id="4764576">,</span>&nbsp;<span class="builtintype" id="4764578">error</span><span class="op" id="4764583">)</span><br>
<span class="lineno"></span><span class="op" id="4764585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4764588">//&nbsp;MarshalIndent&nbsp;works&nbsp;like&nbsp;Marshal,&nbsp;but&nbsp;each&nbsp;XML&nbsp;element&nbsp;begins&nbsp;on&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="4764662">//&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno">115</span><span class="comment" id="4764734">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="4764786">func</span>&nbsp;<span class="ident" id="4764791">MarshalIndent</span><span class="op" id="4764804">(</span><span class="ident" id="4764805">v</span>&nbsp;<span class="keyword" id="4764807">interface</span><span class="op" id="4764816">{</span><span class="op" id="4764817">}</span><span class="op" id="4764818">,</span>&nbsp;<span class="ident" id="4764820">prefix</span><span class="op" id="4764826">,</span>&nbsp;<span class="ident" id="4764828">indent</span>&nbsp;<span class="builtintype" id="4764835">string</span><span class="op" id="4764841">)</span>&nbsp;<span class="op" id="4764843">(</span><span class="op" id="4764844">[</span><span class="op" id="4764845">]</span><span class="builtintype" id="4764846">byte</span><span class="op" id="4764850">,</span>&nbsp;<span class="builtintype" id="4764852">error</span><span class="op" id="4764857">)</span>&nbsp;<span class="op" id="4764859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764862">var</span>&nbsp;<span class="ident" id="4764866">b</span>&nbsp;<span class="ident" id="4764868">bytes</span><span class="op" id="4764873">.</span><span class="ident" id="4764874">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764882">enc</span>&nbsp;<span class="op" id="4764886">:=</span>&nbsp;<span class="ident" id="4764889">NewEncoder</span><span class="op" id="4764899">(</span><span class="op" id="4764900">&amp;</span><span class="ident" id="4764901">b</span><span class="op" id="4764902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764905">enc</span><span class="op" id="4764908">.</span><span class="ident" id="4764909">Indent</span><span class="op" id="4764915">(</span><span class="ident" id="4764916">prefix</span><span class="op" id="4764922">,</span>&nbsp;<span class="ident" id="4764924">indent</span><span class="op" id="4764930">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764933">if</span>&nbsp;<span class="ident" id="4764936">err</span>&nbsp;<span class="op" id="4764940">:=</span>&nbsp;<span class="ident" id="4764943">enc</span><span class="op" id="4764946">.</span><span class="ident" id="4764947">Encode</span><span class="op" id="4764953">(</span><span class="ident" id="4764954">v</span><span class="op" id="4764955">)</span><span class="op" id="4764956">;</span>&nbsp;<span class="ident" id="4764958">err</span>&nbsp;<span class="op" id="4764962">!=</span>&nbsp;<span class="builtintype" id="4764965">nil</span>&nbsp;<span class="op" id="4764969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764973">return</span>&nbsp;<span class="builtintype" id="4764980">nil</span><span class="op" id="4764983">,</span>&nbsp;<span class="ident" id="4764985">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4764990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764993">return</span>&nbsp;<span class="ident" id="4765000">b</span><span class="op" id="4765001">.</span><span class="ident" id="4765002">Bytes</span><span class="op" id="4765007">(</span><span class="op" id="4765008">)</span><span class="op" id="4765009">,</span>&nbsp;<span class="builtintype" id="4765011">nil</span><br>
<span class="lineno"></span><span class="op" id="4765015">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4765018">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;XML&nbsp;data&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="4765069">type</span>&nbsp;<span class="ident" id="4765074">Encoder</span>&nbsp;<span class="keyword" id="4765082">struct</span>&nbsp;<span class="op" id="4765089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765092">p</span>&nbsp;<span class="ident" id="4765094">printer</span><br>
<span class="lineno"></span><span class="op" id="4765102">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4765105">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="4765159">func</span>&nbsp;<span class="ident" id="4765164">NewEncoder</span><span class="op" id="4765174">(</span><span class="ident" id="4765175">w</span>&nbsp;<span class="ident" id="4765177">io</span><span class="op" id="4765179">.</span><span class="ident" id="4765180">Writer</span><span class="op" id="4765186">)</span>&nbsp;<span class="op" id="4765188">*</span><span class="ident" id="4765189">Encoder</span>&nbsp;<span class="op" id="4765197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765200">e</span>&nbsp;<span class="op" id="4765202">:=</span>&nbsp;<span class="op" id="4765205">&amp;</span><span class="ident" id="4765206">Encoder</span><span class="op" id="4765213">{</span><span class="ident" id="4765214">printer</span><span class="op" id="4765221">{</span><span class="ident" id="4765222">Writer</span><span class="op" id="4765228">:</span>&nbsp;<span class="ident" id="4765230">bufio</span><span class="op" id="4765235">.</span><span class="ident" id="4765236">NewWriter</span><span class="op" id="4765245">(</span><span class="ident" id="4765246">w</span><span class="op" id="4765247">)</span><span class="op" id="4765248">}</span><span class="op" id="4765249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765252">e</span><span class="op" id="4765253">.</span><span class="ident" id="4765254">p</span><span class="op" id="4765255">.</span><span class="ident" id="4765256">encoder</span>&nbsp;<span class="op" id="4765264">=</span>&nbsp;<span class="ident" id="4765266">e</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765269">return</span>&nbsp;<span class="ident" id="4765276">e</span><br>
<span class="lineno"></span><span class="op" id="4765278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4765281">//&nbsp;Indent&nbsp;sets&nbsp;the&nbsp;encoder&nbsp;to&nbsp;generate&nbsp;XML&nbsp;in&nbsp;which&nbsp;each&nbsp;element</span><br>
<span class="lineno"></span><span class="comment" id="4765346">//&nbsp;begins&nbsp;on&nbsp;a&nbsp;new&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by</span><br>
<span class="lineno">140</span><span class="comment" id="4765422">//&nbsp;one&nbsp;or&nbsp;more&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="4765486">func</span>&nbsp;<span class="op" id="4765491">(</span><span class="ident" id="4765492">enc</span>&nbsp;<span class="op" id="4765496">*</span><span class="ident" id="4765497">Encoder</span><span class="op" id="4765504">)</span>&nbsp;<span class="ident" id="4765506">Indent</span><span class="op" id="4765512">(</span><span class="ident" id="4765513">prefix</span><span class="op" id="4765519">,</span>&nbsp;<span class="ident" id="4765521">indent</span>&nbsp;<span class="builtintype" id="4765528">string</span><span class="op" id="4765534">)</span>&nbsp;<span class="op" id="4765536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765539">enc</span><span class="op" id="4765542">.</span><span class="ident" id="4765543">p</span><span class="op" id="4765544">.</span><span class="ident" id="4765545">prefix</span>&nbsp;<span class="op" id="4765552">=</span>&nbsp;<span class="ident" id="4765554">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765562">enc</span><span class="op" id="4765565">.</span><span class="ident" id="4765566">p</span><span class="op" id="4765567">.</span><span class="ident" id="4765568">indent</span>&nbsp;<span class="op" id="4765575">=</span>&nbsp;<span class="ident" id="4765577">indent</span><br>
<span class="lineno"></span><span class="op" id="4765584">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4765587">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="4765641">//</span><br>
<span class="lineno"></span><span class="comment" id="4765644">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="4765714">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">150</span><span class="comment" id="4765738">//</span><br>
<span class="lineno"></span><span class="comment" id="4765741">//&nbsp;Encode&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="4765781">func</span>&nbsp;<span class="op" id="4765786">(</span><span class="ident" id="4765787">enc</span>&nbsp;<span class="op" id="4765791">*</span><span class="ident" id="4765792">Encoder</span><span class="op" id="4765799">)</span>&nbsp;<span class="ident" id="4765801">Encode</span><span class="op" id="4765807">(</span><span class="ident" id="4765808">v</span>&nbsp;<span class="keyword" id="4765810">interface</span><span class="op" id="4765819">{</span><span class="op" id="4765820">}</span><span class="op" id="4765821">)</span>&nbsp;<span class="builtintype" id="4765823">error</span>&nbsp;<span class="op" id="4765829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765832">err</span>&nbsp;<span class="op" id="4765836">:=</span>&nbsp;<span class="ident" id="4765839">enc</span><span class="op" id="4765842">.</span><span class="ident" id="4765843">p</span><span class="op" id="4765844">.</span><span class="ident" id="4765845">marshalValue</span><span class="op" id="4765857">(</span><span class="ident" id="4765858">reflect</span><span class="op" id="4765865">.</span><span class="ident" id="4765866">ValueOf</span><span class="op" id="4765873">(</span><span class="ident" id="4765874">v</span><span class="op" id="4765875">)</span><span class="op" id="4765876">,</span>&nbsp;<span class="builtintype" id="4765878">nil</span><span class="op" id="4765881">,</span>&nbsp;<span class="builtintype" id="4765883">nil</span><span class="op" id="4765886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765889">if</span>&nbsp;<span class="ident" id="4765892">err</span>&nbsp;<span class="op" id="4765896">!=</span>&nbsp;<span class="builtintype" id="4765899">nil</span>&nbsp;<span class="op" id="4765903">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765907">return</span>&nbsp;<span class="ident" id="4765914">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765922">return</span>&nbsp;<span class="ident" id="4765929">enc</span><span class="op" id="4765932">.</span><span class="ident" id="4765933">p</span><span class="op" id="4765934">.</span><span class="ident" id="4765935">Flush</span><span class="op" id="4765940">(</span><span class="op" id="4765941">)</span><br>
<span class="lineno"></span><span class="op" id="4765943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="4765946">//&nbsp;EncodeElement&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="4766007">//&nbsp;using&nbsp;start&nbsp;as&nbsp;the&nbsp;outermost&nbsp;tag&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4766060">//</span><br>
<span class="lineno"></span><span class="comment" id="4766063">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="4766133">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">165</span><span class="comment" id="4766157">//</span><br>
<span class="lineno"></span><span class="comment" id="4766160">//&nbsp;EncodeElement&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="4766207">func</span>&nbsp;<span class="op" id="4766212">(</span><span class="ident" id="4766213">enc</span>&nbsp;<span class="op" id="4766217">*</span><span class="ident" id="4766218">Encoder</span><span class="op" id="4766225">)</span>&nbsp;<span class="ident" id="4766227">EncodeElement</span><span class="op" id="4766240">(</span><span class="ident" id="4766241">v</span>&nbsp;<span class="keyword" id="4766243">interface</span><span class="op" id="4766252">{</span><span class="op" id="4766253">}</span><span class="op" id="4766254">,</span>&nbsp;<span class="ident" id="4766256">start</span>&nbsp;<span class="ident" id="4766262">StartElement</span><span class="op" id="4766274">)</span>&nbsp;<span class="builtintype" id="4766276">error</span>&nbsp;<span class="op" id="4766282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766285">err</span>&nbsp;<span class="op" id="4766289">:=</span>&nbsp;<span class="ident" id="4766292">enc</span><span class="op" id="4766295">.</span><span class="ident" id="4766296">p</span><span class="op" id="4766297">.</span><span class="ident" id="4766298">marshalValue</span><span class="op" id="4766310">(</span><span class="ident" id="4766311">reflect</span><span class="op" id="4766318">.</span><span class="ident" id="4766319">ValueOf</span><span class="op" id="4766326">(</span><span class="ident" id="4766327">v</span><span class="op" id="4766328">)</span><span class="op" id="4766329">,</span>&nbsp;<span class="builtintype" id="4766331">nil</span><span class="op" id="4766334">,</span>&nbsp;<span class="op" id="4766336">&amp;</span><span class="ident" id="4766337">start</span><span class="op" id="4766342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766345">if</span>&nbsp;<span class="ident" id="4766348">err</span>&nbsp;<span class="op" id="4766352">!=</span>&nbsp;<span class="builtintype" id="4766355">nil</span>&nbsp;<span class="op" id="4766359">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766363">return</span>&nbsp;<span class="ident" id="4766370">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766378">return</span>&nbsp;<span class="ident" id="4766385">enc</span><span class="op" id="4766388">.</span><span class="ident" id="4766389">p</span><span class="op" id="4766390">.</span><span class="ident" id="4766391">Flush</span><span class="op" id="4766396">(</span><span class="op" id="4766397">)</span><br>
<span class="lineno"></span><span class="op" id="4766399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="4766402">var</span>&nbsp;<span class="op" id="4766406">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766409">endComment</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4766422">=</span>&nbsp;<span class="op" id="4766424">[</span><span class="op" id="4766425">]</span><span class="builtintype" id="4766426">byte</span><span class="op" id="4766430">(</span><span class="string" id="4766431">&#34;--&gt;&#34;</span><span class="op" id="4766436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766439">endProcInst</span>&nbsp;&nbsp;<span class="op" id="4766452">=</span>&nbsp;<span class="op" id="4766454">[</span><span class="op" id="4766455">]</span><span class="builtintype" id="4766456">byte</span><span class="op" id="4766460">(</span><span class="string" id="4766461">&#34;?&gt;&#34;</span><span class="op" id="4766465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766468">endDirective</span>&nbsp;<span class="op" id="4766481">=</span>&nbsp;<span class="op" id="4766483">[</span><span class="op" id="4766484">]</span><span class="builtintype" id="4766485">byte</span><span class="op" id="4766489">(</span><span class="string" id="4766490">&#34;&gt;&#34;</span><span class="op" id="4766493">)</span><br>
<span class="lineno"></span><span class="op" id="4766495">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4766498">//&nbsp;EncodeToken&nbsp;writes&nbsp;the&nbsp;given&nbsp;XML&nbsp;token&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="4766555">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;StartElement&nbsp;and&nbsp;EndElement&nbsp;tokens&nbsp;are&nbsp;not&nbsp;properly&nbsp;matched.</span><br>
<span class="lineno"></span><span class="comment" id="4766642">//</span><br>
<span class="lineno"></span><span class="comment" id="4766645">//&nbsp;EncodeToken&nbsp;does&nbsp;not&nbsp;call&nbsp;Flush,&nbsp;because&nbsp;usually&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;operation</span><br>
<span class="lineno">185</span><span class="comment" id="4766730">//&nbsp;such&nbsp;as&nbsp;Encode&nbsp;or&nbsp;EncodeElement&nbsp;(or&nbsp;a&nbsp;custom&nbsp;Marshaler&#39;s&nbsp;MarshalXML&nbsp;invoked</span><br>
<span class="lineno"></span><span class="comment" id="4766809">//&nbsp;during&nbsp;those),&nbsp;and&nbsp;those&nbsp;will&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="4766868">//&nbsp;Callers&nbsp;that&nbsp;create&nbsp;an&nbsp;Encoder&nbsp;and&nbsp;then&nbsp;invoke&nbsp;EncodeToken&nbsp;directly,&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="4766948">//&nbsp;using&nbsp;Encode&nbsp;or&nbsp;EncodeElement,&nbsp;need&nbsp;to&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="4767025">//&nbsp;that&nbsp;the&nbsp;XML&nbsp;is&nbsp;written&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">190</span><span class="comment" id="4767078">//</span><br>
<span class="lineno"></span><span class="comment" id="4767081">//&nbsp;EncodeToken&nbsp;allows&nbsp;writing&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;Target&nbsp;set&nbsp;to&nbsp;&#34;xml&#34;&nbsp;only&nbsp;as&nbsp;the&nbsp;first&nbsp;token</span><br>
<span class="lineno"></span><span class="comment" id="4767171">//&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="4767189">func</span>&nbsp;<span class="op" id="4767194">(</span><span class="ident" id="4767195">enc</span>&nbsp;<span class="op" id="4767199">*</span><span class="ident" id="4767200">Encoder</span><span class="op" id="4767207">)</span>&nbsp;<span class="ident" id="4767209">EncodeToken</span><span class="op" id="4767220">(</span><span class="ident" id="4767221">t</span>&nbsp;<span class="ident" id="4767223">Token</span><span class="op" id="4767228">)</span>&nbsp;<span class="builtintype" id="4767230">error</span>&nbsp;<span class="op" id="4767236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767239">p</span>&nbsp;<span class="op" id="4767241">:=</span>&nbsp;<span class="op" id="4767244">&amp;</span><span class="ident" id="4767245">enc</span><span class="op" id="4767248">.</span><span class="ident" id="4767249">p</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767252">switch</span>&nbsp;<span class="ident" id="4767259">t</span>&nbsp;<span class="op" id="4767261">:=</span>&nbsp;<span class="ident" id="4767264">t</span><span class="op" id="4767265">.</span><span class="op" id="4767266">(</span><span class="keyword" id="4767267">type</span><span class="op" id="4767271">)</span>&nbsp;<span class="op" id="4767273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767276">case</span>&nbsp;<span class="ident" id="4767281">StartElement</span><span class="op" id="4767293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767297">if</span>&nbsp;<span class="ident" id="4767300">err</span>&nbsp;<span class="op" id="4767304">:=</span>&nbsp;<span class="ident" id="4767307">p</span><span class="op" id="4767308">.</span><span class="ident" id="4767309">writeStart</span><span class="op" id="4767319">(</span><span class="op" id="4767320">&amp;</span><span class="ident" id="4767321">t</span><span class="op" id="4767322">)</span><span class="op" id="4767323">;</span>&nbsp;<span class="ident" id="4767325">err</span>&nbsp;<span class="op" id="4767329">!=</span>&nbsp;<span class="builtintype" id="4767332">nil</span>&nbsp;<span class="op" id="4767336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767341">return</span>&nbsp;<span class="ident" id="4767348">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767354">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767357">case</span>&nbsp;<span class="ident" id="4767362">EndElement</span><span class="op" id="4767372">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767376">if</span>&nbsp;<span class="ident" id="4767379">err</span>&nbsp;<span class="op" id="4767383">:=</span>&nbsp;<span class="ident" id="4767386">p</span><span class="op" id="4767387">.</span><span class="ident" id="4767388">writeEnd</span><span class="op" id="4767396">(</span><span class="ident" id="4767397">t</span><span class="op" id="4767398">.</span><span class="ident" id="4767399">Name</span><span class="op" id="4767403">)</span><span class="op" id="4767404">;</span>&nbsp;<span class="ident" id="4767406">err</span>&nbsp;<span class="op" id="4767410">!=</span>&nbsp;<span class="builtintype" id="4767413">nil</span>&nbsp;<span class="op" id="4767417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767422">return</span>&nbsp;<span class="ident" id="4767429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767438">case</span>&nbsp;<span class="ident" id="4767443">CharData</span><span class="op" id="4767451">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767455">EscapeText</span><span class="op" id="4767465">(</span><span class="ident" id="4767466">p</span><span class="op" id="4767467">,</span>&nbsp;<span class="ident" id="4767469">t</span><span class="op" id="4767470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767473">case</span>&nbsp;<span class="ident" id="4767478">Comment</span><span class="op" id="4767485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767489">if</span>&nbsp;<span class="ident" id="4767492">bytes</span><span class="op" id="4767497">.</span><span class="ident" id="4767498">Contains</span><span class="op" id="4767506">(</span><span class="ident" id="4767507">t</span><span class="op" id="4767508">,</span>&nbsp;<span class="ident" id="4767510">endComment</span><span class="op" id="4767520">)</span>&nbsp;<span class="op" id="4767522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767527">return</span>&nbsp;<span class="ident" id="4767534">fmt</span><span class="op" id="4767537">.</span><span class="ident" id="4767538">Errorf</span><span class="op" id="4767544">(</span><span class="string" id="4767545">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Comment&nbsp;containing&nbsp;--&gt;&nbsp;marker&#34;</span><span class="op" id="4767596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767600">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767604">p</span><span class="op" id="4767605">.</span><span class="ident" id="4767606">WriteString</span><span class="op" id="4767617">(</span><span class="string" id="4767618">&#34;&lt;!--&#34;</span><span class="op" id="4767624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767628">p</span><span class="op" id="4767629">.</span><span class="ident" id="4767630">Write</span><span class="op" id="4767635">(</span><span class="ident" id="4767636">t</span><span class="op" id="4767637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767641">p</span><span class="op" id="4767642">.</span><span class="ident" id="4767643">WriteString</span><span class="op" id="4767654">(</span><span class="string" id="4767655">&#34;--&gt;&#34;</span><span class="op" id="4767660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767664">return</span>&nbsp;<span class="ident" id="4767671">p</span><span class="op" id="4767672">.</span><span class="ident" id="4767673">cachedWriteError</span><span class="op" id="4767689">(</span><span class="op" id="4767690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767693">case</span>&nbsp;<span class="ident" id="4767698">ProcInst</span><span class="op" id="4767706">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4767710">//&nbsp;First&nbsp;token&nbsp;to&nbsp;be&nbsp;encoded&nbsp;which&nbsp;is&nbsp;also&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;target&nbsp;of&nbsp;xml</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4767785">//&nbsp;is&nbsp;the&nbsp;xml&nbsp;declaration.&nbsp;&nbsp;The&nbsp;only&nbsp;ProcInst&nbsp;where&nbsp;target&nbsp;of&nbsp;xml&nbsp;is&nbsp;allowed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767865">if</span>&nbsp;<span class="ident" id="4767868">t</span><span class="op" id="4767869">.</span><span class="ident" id="4767870">Target</span>&nbsp;<span class="op" id="4767877">==</span>&nbsp;<span class="string" id="4767880">&#34;xml&#34;</span>&nbsp;<span class="op" id="4767886">&amp;&amp;</span>&nbsp;<span class="ident" id="4767889">p</span><span class="op" id="4767890">.</span><span class="ident" id="4767891">Buffered</span><span class="op" id="4767899">(</span><span class="op" id="4767900">)</span>&nbsp;<span class="op" id="4767902">!=</span>&nbsp;<span class="num" id="4767905">0</span>&nbsp;<span class="op" id="4767907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767912">return</span>&nbsp;<span class="ident" id="4767919">fmt</span><span class="op" id="4767922">.</span><span class="ident" id="4767923">Errorf</span><span class="op" id="4767929">(</span><span class="string" id="4767930">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;xml&nbsp;target&nbsp;only&nbsp;valid&nbsp;for&nbsp;xml&nbsp;declaration,&nbsp;first&nbsp;token&nbsp;encoded&#34;</span><span class="op" id="4768023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768027">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768031">if</span>&nbsp;<span class="op" id="4768034">!</span><span class="ident" id="4768035">isNameString</span><span class="op" id="4768047">(</span><span class="ident" id="4768048">t</span><span class="op" id="4768049">.</span><span class="ident" id="4768050">Target</span><span class="op" id="4768056">)</span>&nbsp;<span class="op" id="4768058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768063">return</span>&nbsp;<span class="ident" id="4768070">fmt</span><span class="op" id="4768073">.</span><span class="ident" id="4768074">Errorf</span><span class="op" id="4768080">(</span><span class="string" id="4768081">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;with&nbsp;invalid&nbsp;Target&#34;</span><span class="op" id="4768131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768139">if</span>&nbsp;<span class="ident" id="4768142">bytes</span><span class="op" id="4768147">.</span><span class="ident" id="4768148">Contains</span><span class="op" id="4768156">(</span><span class="ident" id="4768157">t</span><span class="op" id="4768158">.</span><span class="ident" id="4768159">Inst</span><span class="op" id="4768163">,</span>&nbsp;<span class="ident" id="4768165">endProcInst</span><span class="op" id="4768176">)</span>&nbsp;<span class="op" id="4768178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768183">return</span>&nbsp;<span class="ident" id="4768190">fmt</span><span class="op" id="4768193">.</span><span class="ident" id="4768194">Errorf</span><span class="op" id="4768200">(</span><span class="string" id="4768201">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;containing&nbsp;?&gt;&nbsp;marker&#34;</span><span class="op" id="4768252">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768260">p</span><span class="op" id="4768261">.</span><span class="ident" id="4768262">WriteString</span><span class="op" id="4768273">(</span><span class="string" id="4768274">&#34;&lt;?&#34;</span><span class="op" id="4768278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768282">p</span><span class="op" id="4768283">.</span><span class="ident" id="4768284">WriteString</span><span class="op" id="4768295">(</span><span class="ident" id="4768296">t</span><span class="op" id="4768297">.</span><span class="ident" id="4768298">Target</span><span class="op" id="4768304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768308">if</span>&nbsp;<span class="builtinfunc" id="4768311">len</span><span class="op" id="4768314">(</span><span class="ident" id="4768315">t</span><span class="op" id="4768316">.</span><span class="ident" id="4768317">Inst</span><span class="op" id="4768321">)</span>&nbsp;<span class="op" id="4768323">&gt;</span>&nbsp;<span class="num" id="4768325">0</span>&nbsp;<span class="op" id="4768327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768332">p</span><span class="op" id="4768333">.</span><span class="ident" id="4768334">WriteByte</span><span class="op" id="4768343">(</span><span class="string" id="4768344">&#39;&nbsp;&#39;</span><span class="op" id="4768347">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768352">p</span><span class="op" id="4768353">.</span><span class="ident" id="4768354">Write</span><span class="op" id="4768359">(</span><span class="ident" id="4768360">t</span><span class="op" id="4768361">.</span><span class="ident" id="4768362">Inst</span><span class="op" id="4768366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768374">p</span><span class="op" id="4768375">.</span><span class="ident" id="4768376">WriteString</span><span class="op" id="4768387">(</span><span class="string" id="4768388">&#34;?&gt;&#34;</span><span class="op" id="4768392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768395">case</span>&nbsp;<span class="ident" id="4768400">Directive</span><span class="op" id="4768409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768413">if</span>&nbsp;<span class="ident" id="4768416">bytes</span><span class="op" id="4768421">.</span><span class="ident" id="4768422">Contains</span><span class="op" id="4768430">(</span><span class="ident" id="4768431">t</span><span class="op" id="4768432">,</span>&nbsp;<span class="ident" id="4768434">endDirective</span><span class="op" id="4768446">)</span>&nbsp;<span class="op" id="4768448">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768453">return</span>&nbsp;<span class="ident" id="4768460">fmt</span><span class="op" id="4768463">.</span><span class="ident" id="4768464">Errorf</span><span class="op" id="4768470">(</span><span class="string" id="4768471">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Directive&nbsp;containing&nbsp;&gt;&nbsp;marker&#34;</span><span class="op" id="4768522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768530">p</span><span class="op" id="4768531">.</span><span class="ident" id="4768532">WriteString</span><span class="op" id="4768543">(</span><span class="string" id="4768544">&#34;&lt;!&#34;</span><span class="op" id="4768548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768552">p</span><span class="op" id="4768553">.</span><span class="ident" id="4768554">Write</span><span class="op" id="4768559">(</span><span class="ident" id="4768560">t</span><span class="op" id="4768561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768565">p</span><span class="op" id="4768566">.</span><span class="ident" id="4768567">WriteString</span><span class="op" id="4768578">(</span><span class="string" id="4768579">&#34;&gt;&#34;</span><span class="op" id="4768582">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768588">return</span>&nbsp;<span class="ident" id="4768595">p</span><span class="op" id="4768596">.</span><span class="ident" id="4768597">cachedWriteError</span><span class="op" id="4768613">(</span><span class="op" id="4768614">)</span><br>
<span class="lineno"></span><span class="op" id="4768616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4768619">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;XML&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">245</span><span class="comment" id="4768679">//&nbsp;See&nbsp;the&nbsp;EncodeToken&nbsp;documentation&nbsp;for&nbsp;details&nbsp;about&nbsp;when&nbsp;it&nbsp;is&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="4768756">func</span>&nbsp;<span class="op" id="4768761">(</span><span class="ident" id="4768762">enc</span>&nbsp;<span class="op" id="4768766">*</span><span class="ident" id="4768767">Encoder</span><span class="op" id="4768774">)</span>&nbsp;<span class="ident" id="4768776">Flush</span><span class="op" id="4768781">(</span><span class="op" id="4768782">)</span>&nbsp;<span class="builtintype" id="4768784">error</span>&nbsp;<span class="op" id="4768790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768793">return</span>&nbsp;<span class="ident" id="4768800">enc</span><span class="op" id="4768803">.</span><span class="ident" id="4768804">p</span><span class="op" id="4768805">.</span><span class="ident" id="4768806">Flush</span><span class="op" id="4768811">(</span><span class="op" id="4768812">)</span><br>
<span class="lineno"></span><span class="op" id="4768814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4768817">type</span>&nbsp;<span class="ident" id="4768822">printer</span>&nbsp;<span class="keyword" id="4768830">struct</span>&nbsp;<span class="op" id="4768837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768840">*</span><span class="ident" id="4768841">bufio</span><span class="op" id="4768846">.</span><span class="ident" id="4768847">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768855">encoder</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768866">*</span><span class="ident" id="4768867">Encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768876">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4768887">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768892">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4768903">string</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768911">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4768922">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768930">depth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4768941">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768946">indentedIn</span>&nbsp;<span class="builtintype" id="4768957">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768963">putNewline</span>&nbsp;<span class="builtintype" id="4768974">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768980">attrNS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768991">map</span><span class="op" id="4768994">[</span><span class="builtintype" id="4768995">string</span><span class="op" id="4769001">]</span><span class="builtintype" id="4769002">string</span>&nbsp;<span class="comment" id="4769009">//&nbsp;map&nbsp;prefix&nbsp;-&gt;&nbsp;name&nbsp;space</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769038">attrPrefix</span>&nbsp;<span class="keyword" id="4769049">map</span><span class="op" id="4769052">[</span><span class="builtintype" id="4769053">string</span><span class="op" id="4769059">]</span><span class="builtintype" id="4769060">string</span>&nbsp;<span class="comment" id="4769067">//&nbsp;map&nbsp;name&nbsp;space&nbsp;-&gt;&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769096">prefixes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4769107">[</span><span class="op" id="4769108">]</span><span class="builtintype" id="4769109">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769117">tags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769128">[</span><span class="op" id="4769129">]</span><span class="ident" id="4769130">Name</span><br>
<span class="lineno"></span><span class="op" id="4769135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4769138">//&nbsp;createAttrPrefix&nbsp;finds&nbsp;the&nbsp;name&nbsp;space&nbsp;prefix&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;given&nbsp;name&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="4769229">//&nbsp;defining&nbsp;a&nbsp;new&nbsp;prefix&nbsp;if&nbsp;necessary.&nbsp;It&nbsp;returns&nbsp;the&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="4769291">func</span>&nbsp;<span class="op" id="4769296">(</span><span class="ident" id="4769297">p</span>&nbsp;<span class="op" id="4769299">*</span><span class="ident" id="4769300">printer</span><span class="op" id="4769307">)</span>&nbsp;<span class="ident" id="4769309">createAttrPrefix</span><span class="op" id="4769325">(</span><span class="ident" id="4769326">url</span>&nbsp;<span class="builtintype" id="4769330">string</span><span class="op" id="4769336">)</span>&nbsp;<span class="builtintype" id="4769338">string</span>&nbsp;<span class="op" id="4769345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769348">if</span>&nbsp;<span class="ident" id="4769351">prefix</span>&nbsp;<span class="op" id="4769358">:=</span>&nbsp;<span class="ident" id="4769361">p</span><span class="op" id="4769362">.</span><span class="ident" id="4769363">attrPrefix</span><span class="op" id="4769373">[</span><span class="ident" id="4769374">url</span><span class="op" id="4769377">]</span><span class="op" id="4769378">;</span>&nbsp;<span class="ident" id="4769380">prefix</span>&nbsp;<span class="op" id="4769387">!=</span>&nbsp;<span class="string" id="4769390">&#34;&#34;</span>&nbsp;<span class="op" id="4769393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769397">return</span>&nbsp;<span class="ident" id="4769404">prefix</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769416">//&nbsp;The&nbsp;&#34;http://www.w3.org/XML/1998/namespace&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;predefined&nbsp;as&nbsp;&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769497">//&nbsp;and&nbsp;must&nbsp;be&nbsp;referred&nbsp;to&nbsp;that&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769535">//&nbsp;(The&nbsp;&#34;http://www.w3.org/2000/xmlns/&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;also&nbsp;predefined&nbsp;as&nbsp;&#34;xmlns&#34;,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769618">//&nbsp;but&nbsp;users&nbsp;should&nbsp;not&nbsp;be&nbsp;trying&nbsp;to&nbsp;use&nbsp;that&nbsp;one&nbsp;directly&nbsp;-&nbsp;that&#39;s&nbsp;our&nbsp;job.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769697">if</span>&nbsp;<span class="ident" id="4769700">url</span>&nbsp;<span class="op" id="4769704">==</span>&nbsp;<span class="ident" id="4769707">xmlURL</span>&nbsp;<span class="op" id="4769714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769718">return</span>&nbsp;<span class="string" id="4769725">&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769736">//&nbsp;Need&nbsp;to&nbsp;define&nbsp;a&nbsp;new&nbsp;name&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769773">if</span>&nbsp;<span class="ident" id="4769776">p</span><span class="op" id="4769777">.</span><span class="ident" id="4769778">attrPrefix</span>&nbsp;<span class="op" id="4769789">==</span>&nbsp;<span class="builtintype" id="4769792">nil</span>&nbsp;<span class="op" id="4769796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769800">p</span><span class="op" id="4769801">.</span><span class="ident" id="4769802">attrPrefix</span>&nbsp;<span class="op" id="4769813">=</span>&nbsp;<span class="builtinfunc" id="4769815">make</span><span class="op" id="4769819">(</span><span class="keyword" id="4769820">map</span><span class="op" id="4769823">[</span><span class="builtintype" id="4769824">string</span><span class="op" id="4769830">]</span><span class="builtintype" id="4769831">string</span><span class="op" id="4769837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769841">p</span><span class="op" id="4769842">.</span><span class="ident" id="4769843">attrNS</span>&nbsp;<span class="op" id="4769850">=</span>&nbsp;<span class="builtinfunc" id="4769852">make</span><span class="op" id="4769856">(</span><span class="keyword" id="4769857">map</span><span class="op" id="4769860">[</span><span class="builtintype" id="4769861">string</span><span class="op" id="4769867">]</span><span class="builtintype" id="4769868">string</span><span class="op" id="4769874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769877">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769881">//&nbsp;Pick&nbsp;a&nbsp;name.&nbsp;We&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;the&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769942">//&nbsp;but&nbsp;fall&nbsp;back&nbsp;to&nbsp;_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769966">prefix</span>&nbsp;<span class="op" id="4769973">:=</span>&nbsp;<span class="ident" id="4769976">strings</span><span class="op" id="4769983">.</span><span class="ident" id="4769984">TrimRight</span><span class="op" id="4769993">(</span><span class="ident" id="4769994">url</span><span class="op" id="4769997">,</span>&nbsp;<span class="string" id="4769999">&#34;/&#34;</span><span class="op" id="4770002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770005">if</span>&nbsp;<span class="ident" id="4770008">i</span>&nbsp;<span class="op" id="4770010">:=</span>&nbsp;<span class="ident" id="4770013">strings</span><span class="op" id="4770020">.</span><span class="ident" id="4770021">LastIndex</span><span class="op" id="4770030">(</span><span class="ident" id="4770031">prefix</span><span class="op" id="4770037">,</span>&nbsp;<span class="string" id="4770039">&#34;/&#34;</span><span class="op" id="4770042">)</span><span class="op" id="4770043">;</span>&nbsp;<span class="ident" id="4770045">i</span>&nbsp;<span class="op" id="4770047">&gt;=</span>&nbsp;<span class="num" id="4770050">0</span>&nbsp;<span class="op" id="4770052">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770056">prefix</span>&nbsp;<span class="op" id="4770063">=</span>&nbsp;<span class="ident" id="4770065">prefix</span><span class="op" id="4770071">[</span><span class="ident" id="4770072">i</span><span class="op" id="4770073">+</span><span class="num" id="4770074">1</span><span class="op" id="4770075">:</span><span class="op" id="4770076">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770082">if</span>&nbsp;<span class="ident" id="4770085">prefix</span>&nbsp;<span class="op" id="4770092">==</span>&nbsp;<span class="string" id="4770095">&#34;&#34;</span>&nbsp;<span class="op" id="4770098">||</span>&nbsp;<span class="op" id="4770101">!</span><span class="ident" id="4770102">isName</span><span class="op" id="4770108">(</span><span class="op" id="4770109">[</span><span class="op" id="4770110">]</span><span class="builtintype" id="4770111">byte</span><span class="op" id="4770115">(</span><span class="ident" id="4770116">prefix</span><span class="op" id="4770122">)</span><span class="op" id="4770123">)</span>&nbsp;<span class="op" id="4770125">||</span>&nbsp;<span class="ident" id="4770128">strings</span><span class="op" id="4770135">.</span><span class="ident" id="4770136">Contains</span><span class="op" id="4770144">(</span><span class="ident" id="4770145">prefix</span><span class="op" id="4770151">,</span>&nbsp;<span class="string" id="4770153">&#34;:&#34;</span><span class="op" id="4770156">)</span>&nbsp;<span class="op" id="4770158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770162">prefix</span>&nbsp;<span class="op" id="4770169">=</span>&nbsp;<span class="string" id="4770171">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770176">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770179">if</span>&nbsp;<span class="ident" id="4770182">strings</span><span class="op" id="4770189">.</span><span class="ident" id="4770190">HasPrefix</span><span class="op" id="4770199">(</span><span class="ident" id="4770200">prefix</span><span class="op" id="4770206">,</span>&nbsp;<span class="string" id="4770208">&#34;xml&#34;</span><span class="op" id="4770213">)</span>&nbsp;<span class="op" id="4770215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4770219">//&nbsp;xmlanything&nbsp;is&nbsp;reserved.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770249">prefix</span>&nbsp;<span class="op" id="4770256">=</span>&nbsp;<span class="string" id="4770258">&#34;_&#34;</span>&nbsp;<span class="op" id="4770262">+</span>&nbsp;<span class="ident" id="4770264">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770275">if</span>&nbsp;<span class="ident" id="4770278">p</span><span class="op" id="4770279">.</span><span class="ident" id="4770280">attrNS</span><span class="op" id="4770286">[</span><span class="ident" id="4770287">prefix</span><span class="op" id="4770293">]</span>&nbsp;<span class="op" id="4770295">!=</span>&nbsp;<span class="string" id="4770298">&#34;&#34;</span>&nbsp;<span class="op" id="4770301">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4770305">//&nbsp;Name&nbsp;is&nbsp;taken.&nbsp;Find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770344">for</span>&nbsp;<span class="ident" id="4770348">p</span><span class="op" id="4770349">.</span><span class="ident" id="4770350">seq</span><span class="op" id="4770353">++</span><span class="op" id="4770355">;</span>&nbsp;<span class="op" id="4770357">;</span>&nbsp;<span class="ident" id="4770359">p</span><span class="op" id="4770360">.</span><span class="ident" id="4770361">seq</span><span class="op" id="4770364">++</span>&nbsp;<span class="op" id="4770367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770372">if</span>&nbsp;<span class="ident" id="4770375">id</span>&nbsp;<span class="op" id="4770378">:=</span>&nbsp;<span class="ident" id="4770381">prefix</span>&nbsp;<span class="op" id="4770388">+</span>&nbsp;<span class="string" id="4770390">&#34;_&#34;</span>&nbsp;<span class="op" id="4770394">+</span>&nbsp;<span class="ident" id="4770396">strconv</span><span class="op" id="4770403">.</span><span class="ident" id="4770404">Itoa</span><span class="op" id="4770408">(</span><span class="ident" id="4770409">p</span><span class="op" id="4770410">.</span><span class="ident" id="4770411">seq</span><span class="op" id="4770414">)</span><span class="op" id="4770415">;</span>&nbsp;<span class="ident" id="4770417">p</span><span class="op" id="4770418">.</span><span class="ident" id="4770419">attrNS</span><span class="op" id="4770425">[</span><span class="ident" id="4770426">id</span><span class="op" id="4770428">]</span>&nbsp;<span class="op" id="4770430">==</span>&nbsp;<span class="string" id="4770433">&#34;&#34;</span>&nbsp;<span class="op" id="4770436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770442">prefix</span>&nbsp;<span class="op" id="4770449">=</span>&nbsp;<span class="ident" id="4770451">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770458">break</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770478">p</span><span class="op" id="4770479">.</span><span class="ident" id="4770480">attrPrefix</span><span class="op" id="4770490">[</span><span class="ident" id="4770491">url</span><span class="op" id="4770494">]</span>&nbsp;<span class="op" id="4770496">=</span>&nbsp;<span class="ident" id="4770498">prefix</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770506">p</span><span class="op" id="4770507">.</span><span class="ident" id="4770508">attrNS</span><span class="op" id="4770514">[</span><span class="ident" id="4770515">prefix</span><span class="op" id="4770521">]</span>&nbsp;<span class="op" id="4770523">=</span>&nbsp;<span class="ident" id="4770525">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770531">p</span><span class="op" id="4770532">.</span><span class="ident" id="4770533">WriteString</span><span class="op" id="4770544">(</span><span class="string" id="4770545">`xmlns:`</span><span class="op" id="4770553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770556">p</span><span class="op" id="4770557">.</span><span class="ident" id="4770558">WriteString</span><span class="op" id="4770569">(</span><span class="ident" id="4770570">prefix</span><span class="op" id="4770576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770579">p</span><span class="op" id="4770580">.</span><span class="ident" id="4770581">WriteString</span><span class="op" id="4770592">(</span><span class="string" id="4770593">`=&#34;`</span><span class="op" id="4770597">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770600">EscapeText</span><span class="op" id="4770610">(</span><span class="ident" id="4770611">p</span><span class="op" id="4770612">,</span>&nbsp;<span class="op" id="4770614">[</span><span class="op" id="4770615">]</span><span class="builtintype" id="4770616">byte</span><span class="op" id="4770620">(</span><span class="ident" id="4770621">url</span><span class="op" id="4770624">)</span><span class="op" id="4770625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770628">p</span><span class="op" id="4770629">.</span><span class="ident" id="4770630">WriteString</span><span class="op" id="4770641">(</span><span class="string" id="4770642">`&#34;&nbsp;`</span><span class="op" id="4770646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770650">p</span><span class="op" id="4770651">.</span><span class="ident" id="4770652">prefixes</span>&nbsp;<span class="op" id="4770661">=</span>&nbsp;<span class="builtinfunc" id="4770663">append</span><span class="op" id="4770669">(</span><span class="ident" id="4770670">p</span><span class="op" id="4770671">.</span><span class="ident" id="4770672">prefixes</span><span class="op" id="4770680">,</span>&nbsp;<span class="ident" id="4770682">prefix</span><span class="op" id="4770688">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770692">return</span>&nbsp;<span class="ident" id="4770699">prefix</span><br>
<span class="lineno"></span><span class="op" id="4770706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4770709">//&nbsp;deleteAttrPrefix&nbsp;removes&nbsp;an&nbsp;attribute&nbsp;name&nbsp;space&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="4770769">func</span>&nbsp;<span class="op" id="4770774">(</span><span class="ident" id="4770775">p</span>&nbsp;<span class="op" id="4770777">*</span><span class="ident" id="4770778">printer</span><span class="op" id="4770785">)</span>&nbsp;<span class="ident" id="4770787">deleteAttrPrefix</span><span class="op" id="4770803">(</span><span class="ident" id="4770804">prefix</span>&nbsp;<span class="builtintype" id="4770811">string</span><span class="op" id="4770817">)</span>&nbsp;<span class="op" id="4770819">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4770822">delete</span><span class="op" id="4770828">(</span><span class="ident" id="4770829">p</span><span class="op" id="4770830">.</span><span class="ident" id="4770831">attrPrefix</span><span class="op" id="4770841">,</span>&nbsp;<span class="ident" id="4770843">p</span><span class="op" id="4770844">.</span><span class="ident" id="4770845">attrNS</span><span class="op" id="4770851">[</span><span class="ident" id="4770852">prefix</span><span class="op" id="4770858">]</span><span class="op" id="4770859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4770862">delete</span><span class="op" id="4770868">(</span><span class="ident" id="4770869">p</span><span class="op" id="4770870">.</span><span class="ident" id="4770871">attrNS</span><span class="op" id="4770877">,</span>&nbsp;<span class="ident" id="4770879">prefix</span><span class="op" id="4770885">)</span><br>
<span class="lineno"></span><span class="op" id="4770887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4770890">func</span>&nbsp;<span class="op" id="4770895">(</span><span class="ident" id="4770896">p</span>&nbsp;<span class="op" id="4770898">*</span><span class="ident" id="4770899">printer</span><span class="op" id="4770906">)</span>&nbsp;<span class="ident" id="4770908">markPrefix</span><span class="op" id="4770918">(</span><span class="op" id="4770919">)</span>&nbsp;<span class="op" id="4770921">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770924">p</span><span class="op" id="4770925">.</span><span class="ident" id="4770926">prefixes</span>&nbsp;<span class="op" id="4770935">=</span>&nbsp;<span class="builtinfunc" id="4770937">append</span><span class="op" id="4770943">(</span><span class="ident" id="4770944">p</span><span class="op" id="4770945">.</span><span class="ident" id="4770946">prefixes</span><span class="op" id="4770954">,</span>&nbsp;<span class="string" id="4770956">&#34;&#34;</span><span class="op" id="4770958">)</span><br>
<span class="lineno"></span><span class="op" id="4770960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4770963">func</span>&nbsp;<span class="op" id="4770968">(</span><span class="ident" id="4770969">p</span>&nbsp;<span class="op" id="4770971">*</span><span class="ident" id="4770972">printer</span><span class="op" id="4770979">)</span>&nbsp;<span class="ident" id="4770981">popPrefix</span><span class="op" id="4770990">(</span><span class="op" id="4770991">)</span>&nbsp;<span class="op" id="4770993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770996">for</span>&nbsp;<span class="builtinfunc" id="4771000">len</span><span class="op" id="4771003">(</span><span class="ident" id="4771004">p</span><span class="op" id="4771005">.</span><span class="ident" id="4771006">prefixes</span><span class="op" id="4771014">)</span>&nbsp;<span class="op" id="4771016">&gt;</span>&nbsp;<span class="num" id="4771018">0</span>&nbsp;<span class="op" id="4771020">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771024">prefix</span>&nbsp;<span class="op" id="4771031">:=</span>&nbsp;<span class="ident" id="4771034">p</span><span class="op" id="4771035">.</span><span class="ident" id="4771036">prefixes</span><span class="op" id="4771044">[</span><span class="builtinfunc" id="4771045">len</span><span class="op" id="4771048">(</span><span class="ident" id="4771049">p</span><span class="op" id="4771050">.</span><span class="ident" id="4771051">prefixes</span><span class="op" id="4771059">)</span><span class="op" id="4771060">-</span><span class="num" id="4771061">1</span><span class="op" id="4771062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771066">p</span><span class="op" id="4771067">.</span><span class="ident" id="4771068">prefixes</span>&nbsp;<span class="op" id="4771077">=</span>&nbsp;<span class="ident" id="4771079">p</span><span class="op" id="4771080">.</span><span class="ident" id="4771081">prefixes</span><span class="op" id="4771089">[</span><span class="op" id="4771090">:</span><span class="builtinfunc" id="4771091">len</span><span class="op" id="4771094">(</span><span class="ident" id="4771095">p</span><span class="op" id="4771096">.</span><span class="ident" id="4771097">prefixes</span><span class="op" id="4771105">)</span><span class="op" id="4771106">-</span><span class="num" id="4771107">1</span><span class="op" id="4771108">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771112">if</span>&nbsp;<span class="ident" id="4771115">prefix</span>&nbsp;<span class="op" id="4771122">==</span>&nbsp;<span class="string" id="4771125">&#34;&#34;</span>&nbsp;<span class="op" id="4771128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771133">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771141">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771145">p</span><span class="op" id="4771146">.</span><span class="ident" id="4771147">deleteAttrPrefix</span><span class="op" id="4771163">(</span><span class="ident" id="4771164">prefix</span><span class="op" id="4771170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771173">}</span><br>
<span class="lineno"></span><span class="op" id="4771175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4771178">var</span>&nbsp;<span class="op" id="4771182">(</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771185">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771203">=</span>&nbsp;<span class="ident" id="4771205">reflect</span><span class="op" id="4771212">.</span><span class="ident" id="4771213">TypeOf</span><span class="op" id="4771219">(</span><span class="op" id="4771220">(</span><span class="op" id="4771221">*</span><span class="ident" id="4771222">Marshaler</span><span class="op" id="4771231">)</span><span class="op" id="4771232">(</span><span class="builtintype" id="4771233">nil</span><span class="op" id="4771236">)</span><span class="op" id="4771237">)</span><span class="op" id="4771238">.</span><span class="ident" id="4771239">Elem</span><span class="op" id="4771243">(</span><span class="op" id="4771244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771247">marshalerAttrType</span>&nbsp;<span class="op" id="4771265">=</span>&nbsp;<span class="ident" id="4771267">reflect</span><span class="op" id="4771274">.</span><span class="ident" id="4771275">TypeOf</span><span class="op" id="4771281">(</span><span class="op" id="4771282">(</span><span class="op" id="4771283">*</span><span class="ident" id="4771284">MarshalerAttr</span><span class="op" id="4771297">)</span><span class="op" id="4771298">(</span><span class="builtintype" id="4771299">nil</span><span class="op" id="4771302">)</span><span class="op" id="4771303">)</span><span class="op" id="4771304">.</span><span class="ident" id="4771305">Elem</span><span class="op" id="4771309">(</span><span class="op" id="4771310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4771313">textMarshalerType</span>&nbsp;<span class="op" id="4771331">=</span>&nbsp;<span class="ident" id="4771333">reflect</span><span class="op" id="4771340">.</span><span class="ident" id="4771341">TypeOf</span><span class="op" id="4771347">(</span><span class="op" id="4771348">(</span><span class="op" id="4771349">*</span><span class="ident" id="4771350">encoding</span><span class="op" id="4771358">.</span><span class="ident" id="4771359">TextMarshaler</span><span class="op" id="4771372">)</span><span class="op" id="4771373">(</span><span class="builtintype" id="4771374">nil</span><span class="op" id="4771377">)</span><span class="op" id="4771378">)</span><span class="op" id="4771379">.</span><span class="ident" id="4771380">Elem</span><span class="op" id="4771384">(</span><span class="op" id="4771385">)</span><br>
<span class="lineno"></span><span class="op" id="4771387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="4771390">//&nbsp;marshalValue&nbsp;writes&nbsp;one&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements&nbsp;representing&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4771456">//&nbsp;If&nbsp;val&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;struct&nbsp;field,&nbsp;finfo&nbsp;must&nbsp;have&nbsp;its&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="4771529">func</span>&nbsp;<span class="op" id="4771534">(</span><span class="ident" id="4771535">p</span>&nbsp;<span class="op" id="4771537">*</span><span class="ident" id="4771538">printer</span><span class="op" id="4771545">)</span>&nbsp;<span class="ident" id="4771547">marshalValue</span><span class="op" id="4771559">(</span><span class="ident" id="4771560">val</span>&nbsp;<span class="ident" id="4771564">reflect</span><span class="op" id="4771571">.</span><span class="ident" id="4771572">Value</span><span class="op" id="4771577">,</span>&nbsp;<span class="ident" id="4771579">finfo</span>&nbsp;<span class="op" id="4771585">*</span><span class="ident" id="4771586">fieldInfo</span><span class="op" id="4771595">,</span>&nbsp;<span class="ident" id="4771597">startTemplate</span>&nbsp;<span class="op" id="4771611">*</span><span class="ident" id="4771612">StartElement</span><span class="op" id="4771624">)</span>&nbsp;<span class="builtintype" id="4771626">error</span>&nbsp;<span class="op" id="4771632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771635">if</span>&nbsp;<span class="ident" id="4771638">startTemplate</span>&nbsp;<span class="op" id="4771652">!=</span>&nbsp;<span class="builtintype" id="4771655">nil</span>&nbsp;<span class="op" id="4771659">&amp;&amp;</span>&nbsp;<span class="ident" id="4771662">startTemplate</span><span class="op" id="4771675">.</span><span class="ident" id="4771676">Name</span><span class="op" id="4771680">.</span><span class="ident" id="4771681">Local</span>&nbsp;<span class="op" id="4771687">==</span>&nbsp;<span class="string" id="4771690">&#34;&#34;</span>&nbsp;<span class="op" id="4771693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771697">return</span>&nbsp;<span class="ident" id="4771704">fmt</span><span class="op" id="4771707">.</span><span class="ident" id="4771708">Errorf</span><span class="op" id="4771714">(</span><span class="string" id="4771715">&#34;xml:&nbsp;EncodeElement&nbsp;of&nbsp;StartElement&nbsp;with&nbsp;missing&nbsp;name&#34;</span><span class="op" id="4771769">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771776">if</span>&nbsp;<span class="op" id="4771779">!</span><span class="ident" id="4771780">val</span><span class="op" id="4771783">.</span><span class="ident" id="4771784">IsValid</span><span class="op" id="4771791">(</span><span class="op" id="4771792">)</span>&nbsp;<span class="op" id="4771794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771798">return</span>&nbsp;<span class="builtintype" id="4771805">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771810">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771813">if</span>&nbsp;<span class="ident" id="4771816">finfo</span>&nbsp;<span class="op" id="4771822">!=</span>&nbsp;<span class="builtintype" id="4771825">nil</span>&nbsp;<span class="op" id="4771829">&amp;&amp;</span>&nbsp;<span class="ident" id="4771832">finfo</span><span class="op" id="4771837">.</span><span class="ident" id="4771838">flags</span><span class="op" id="4771843">&amp;</span><span class="ident" id="4771844">fOmitEmpty</span>&nbsp;<span class="op" id="4771855">!=</span>&nbsp;<span class="num" id="4771858">0</span>&nbsp;<span class="op" id="4771860">&amp;&amp;</span>&nbsp;<span class="ident" id="4771863">isEmptyValue</span><span class="op" id="4771875">(</span><span class="ident" id="4771876">val</span><span class="op" id="4771879">)</span>&nbsp;<span class="op" id="4771881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771885">return</span>&nbsp;<span class="builtintype" id="4771892">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4771901">//&nbsp;Drill&nbsp;into&nbsp;interfaces&nbsp;and&nbsp;pointers.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4771941">//&nbsp;This&nbsp;can&nbsp;turn&nbsp;into&nbsp;an&nbsp;infinite&nbsp;loop&nbsp;given&nbsp;a&nbsp;cyclic&nbsp;chain,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772003">//&nbsp;but&nbsp;it&nbsp;matches&nbsp;the&nbsp;Go&nbsp;1&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772041">for</span>&nbsp;<span class="ident" id="4772045">val</span><span class="op" id="4772048">.</span><span class="ident" id="4772049">Kind</span><span class="op" id="4772053">(</span><span class="op" id="4772054">)</span>&nbsp;<span class="op" id="4772056">==</span>&nbsp;<span class="ident" id="4772059">reflect</span><span class="op" id="4772066">.</span><span class="ident" id="4772067">Interface</span>&nbsp;<span class="op" id="4772077">||</span>&nbsp;<span class="ident" id="4772080">val</span><span class="op" id="4772083">.</span><span class="ident" id="4772084">Kind</span><span class="op" id="4772088">(</span><span class="op" id="4772089">)</span>&nbsp;<span class="op" id="4772091">==</span>&nbsp;<span class="ident" id="4772094">reflect</span><span class="op" id="4772101">.</span><span class="ident" id="4772102">Ptr</span>&nbsp;<span class="op" id="4772106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772110">if</span>&nbsp;<span class="ident" id="4772113">val</span><span class="op" id="4772116">.</span><span class="ident" id="4772117">IsNil</span><span class="op" id="4772122">(</span><span class="op" id="4772123">)</span>&nbsp;<span class="op" id="4772125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772130">return</span>&nbsp;<span class="builtintype" id="4772137">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772147">val</span>&nbsp;<span class="op" id="4772151">=</span>&nbsp;<span class="ident" id="4772153">val</span><span class="op" id="4772156">.</span><span class="ident" id="4772157">Elem</span><span class="op" id="4772161">(</span><span class="op" id="4772162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772169">kind</span>&nbsp;<span class="op" id="4772174">:=</span>&nbsp;<span class="ident" id="4772177">val</span><span class="op" id="4772180">.</span><span class="ident" id="4772181">Kind</span><span class="op" id="4772185">(</span><span class="op" id="4772186">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772189">typ</span>&nbsp;<span class="op" id="4772193">:=</span>&nbsp;<span class="ident" id="4772196">val</span><span class="op" id="4772199">.</span><span class="ident" id="4772200">Type</span><span class="op" id="4772204">(</span><span class="op" id="4772205">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772209">//&nbsp;Check&nbsp;for&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772234">if</span>&nbsp;<span class="ident" id="4772237">val</span><span class="op" id="4772240">.</span><span class="ident" id="4772241">CanInterface</span><span class="op" id="4772253">(</span><span class="op" id="4772254">)</span>&nbsp;<span class="op" id="4772256">&amp;&amp;</span>&nbsp;<span class="ident" id="4772259">typ</span><span class="op" id="4772262">.</span><span class="ident" id="4772263">Implements</span><span class="op" id="4772273">(</span><span class="ident" id="4772274">marshalerType</span><span class="op" id="4772287">)</span>&nbsp;<span class="op" id="4772289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772293">return</span>&nbsp;<span class="ident" id="4772300">p</span><span class="op" id="4772301">.</span><span class="ident" id="4772302">marshalInterface</span><span class="op" id="4772318">(</span><span class="ident" id="4772319">val</span><span class="op" id="4772322">.</span><span class="ident" id="4772323">Interface</span><span class="op" id="4772332">(</span><span class="op" id="4772333">)</span><span class="op" id="4772334">.</span><span class="op" id="4772335">(</span><span class="ident" id="4772336">Marshaler</span><span class="op" id="4772345">)</span><span class="op" id="4772346">,</span>&nbsp;<span class="ident" id="4772348">defaultStart</span><span class="op" id="4772360">(</span><span class="ident" id="4772361">typ</span><span class="op" id="4772364">,</span>&nbsp;<span class="ident" id="4772366">finfo</span><span class="op" id="4772371">,</span>&nbsp;<span class="ident" id="4772373">startTemplate</span><span class="op" id="4772386">)</span><span class="op" id="4772387">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772393">if</span>&nbsp;<span class="ident" id="4772396">val</span><span class="op" id="4772399">.</span><span class="ident" id="4772400">CanAddr</span><span class="op" id="4772407">(</span><span class="op" id="4772408">)</span>&nbsp;<span class="op" id="4772410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772414">pv</span>&nbsp;<span class="op" id="4772417">:=</span>&nbsp;<span class="ident" id="4772420">val</span><span class="op" id="4772423">.</span><span class="ident" id="4772424">Addr</span><span class="op" id="4772428">(</span><span class="op" id="4772429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772433">if</span>&nbsp;<span class="ident" id="4772436">pv</span><span class="op" id="4772438">.</span><span class="ident" id="4772439">CanInterface</span><span class="op" id="4772451">(</span><span class="op" id="4772452">)</span>&nbsp;<span class="op" id="4772454">&amp;&amp;</span>&nbsp;<span class="ident" id="4772457">pv</span><span class="op" id="4772459">.</span><span class="ident" id="4772460">Type</span><span class="op" id="4772464">(</span><span class="op" id="4772465">)</span><span class="op" id="4772466">.</span><span class="ident" id="4772467">Implements</span><span class="op" id="4772477">(</span><span class="ident" id="4772478">marshalerType</span><span class="op" id="4772491">)</span>&nbsp;<span class="op" id="4772493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772498">return</span>&nbsp;<span class="ident" id="4772505">p</span><span class="op" id="4772506">.</span><span class="ident" id="4772507">marshalInterface</span><span class="op" id="4772523">(</span><span class="ident" id="4772524">pv</span><span class="op" id="4772526">.</span><span class="ident" id="4772527">Interface</span><span class="op" id="4772536">(</span><span class="op" id="4772537">)</span><span class="op" id="4772538">.</span><span class="op" id="4772539">(</span><span class="ident" id="4772540">Marshaler</span><span class="op" id="4772549">)</span><span class="op" id="4772550">,</span>&nbsp;<span class="ident" id="4772552">defaultStart</span><span class="op" id="4772564">(</span><span class="ident" id="4772565">pv</span><span class="op" id="4772567">.</span><span class="ident" id="4772568">Type</span><span class="op" id="4772572">(</span><span class="op" id="4772573">)</span><span class="op" id="4772574">,</span>&nbsp;<span class="ident" id="4772576">finfo</span><span class="op" id="4772581">,</span>&nbsp;<span class="ident" id="4772583">startTemplate</span><span class="op" id="4772596">)</span><span class="op" id="4772597">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4772608">//&nbsp;Check&nbsp;for&nbsp;text&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772638">if</span>&nbsp;<span class="ident" id="4772641">val</span><span class="op" id="4772644">.</span><span class="ident" id="4772645">CanInterface</span><span class="op" id="4772657">(</span><span class="op" id="4772658">)</span>&nbsp;<span class="op" id="4772660">&amp;&amp;</span>&nbsp;<span class="ident" id="4772663">typ</span><span class="op" id="4772666">.</span><span class="ident" id="4772667">Implements</span><span class="op" id="4772677">(</span><span class="ident" id="4772678">textMarshalerType</span><span class="op" id="4772695">)</span>&nbsp;<span class="op" id="4772697">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772701">return</span>&nbsp;<span class="ident" id="4772708">p</span><span class="op" id="4772709">.</span><span class="ident" id="4772710">marshalTextInterface</span><span class="op" id="4772730">(</span><span class="ident" id="4772731">val</span><span class="op" id="4772734">.</span><span class="ident" id="4772735">Interface</span><span class="op" id="4772744">(</span><span class="op" id="4772745">)</span><span class="op" id="4772746">.</span><span class="op" id="4772747">(</span><span class="ident" id="4772748">encoding</span><span class="op" id="4772756">.</span><span class="ident" id="4772757">TextMarshaler</span><span class="op" id="4772770">)</span><span class="op" id="4772771">,</span>&nbsp;<span class="ident" id="4772773">defaultStart</span><span class="op" id="4772785">(</span><span class="ident" id="4772786">typ</span><span class="op" id="4772789">,</span>&nbsp;<span class="ident" id="4772791">finfo</span><span class="op" id="4772796">,</span>&nbsp;<span class="ident" id="4772798">startTemplate</span><span class="op" id="4772811">)</span><span class="op" id="4772812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4772815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772818">if</span>&nbsp;<span class="ident" id="4772821">val</span><span class="op" id="4772824">.</span><span class="ident" id="4772825">CanAddr</span><span class="op" id="4772832">(</span><span class="op" id="4772833">)</span>&nbsp;<span class="op" id="4772835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4772839">pv</span>&nbsp;<span class="op" id="4772842">:=</span>&nbsp;<span class="ident" id="4772845">val</span><span class="op" id="4772848">.</span><span class="ident" id="4772849">Addr</span><span class="op" id="4772853">(</span><span class="op" id="4772854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772858">if</span>&nbsp;<span class="ident" id="4772861">pv</span><span class="op" id="4772863">.</span><span class="ident" id="4772864">CanInterface</span><span class="op" id="4772876">(</span><span class="op" id="4772877">)</span>&nbsp;<span class="op" id="4772879">&amp;&amp;</span>&nbsp;<span class="ident" id="4772882">pv</span><span class="op" id="4772884">.</span><span class="ident" id="4772885">Type</span><span class="op" id="4772889">(</span><span class="op" id="4772890">)</span><span class="op" id="4772891">.</span><span class="ident" id="4772892">Implements</span><span class="op" id="4772902">(</span><span class="ident" id="4772903">textMarshalerType</span><span class="op" id="4772920">)</span>&nbsp;<span class="op" id="4772922">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4772927">return</span>&nbsp;<span class="ident" id="4772934">p</span><span class="op" id="4772935">.</span><span class="ident" id="4772936">marshalTextInterface</span><span class="op" id="4772956">(</span><span class="ident" id="4772957">pv</span><span class="op" id="4772959">.</span><span class="ident" id="4772960">Interface</span><span class="op" id="4772969">(</span><span class="op" id="4772970">)</span><span class="op" id="4772971">.</span><span class="op" id="4772972">(</span><span class="ident" id="4772973">encoding</span><span class="op" id="4772981">.</span><span class="ident" id="4772982">TextMarshaler</span><span class="op" id="4772995">)</span><span class="op" id="4772996">,</span>&nbsp;<span class="ident" id="4772998">defaultStart</span><span class="op" id="4773010">(</span><span class="ident" id="4773011">pv</span><span class="op" id="4773013">.</span><span class="ident" id="4773014">Type</span><span class="op" id="4773018">(</span><span class="op" id="4773019">)</span><span class="op" id="4773020">,</span>&nbsp;<span class="ident" id="4773022">finfo</span><span class="op" id="4773027">,</span>&nbsp;<span class="ident" id="4773029">startTemplate</span><span class="op" id="4773042">)</span><span class="op" id="4773043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773054">//&nbsp;Slices&nbsp;and&nbsp;arrays&nbsp;iterate&nbsp;over&nbsp;the&nbsp;elements.&nbsp;They&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;enclosing&nbsp;tag.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773138">if</span>&nbsp;<span class="op" id="4773141">(</span><span class="ident" id="4773142">kind</span>&nbsp;<span class="op" id="4773147">==</span>&nbsp;<span class="ident" id="4773150">reflect</span><span class="op" id="4773157">.</span><span class="ident" id="4773158">Slice</span>&nbsp;<span class="op" id="4773164">||</span>&nbsp;<span class="ident" id="4773167">kind</span>&nbsp;<span class="op" id="4773172">==</span>&nbsp;<span class="ident" id="4773175">reflect</span><span class="op" id="4773182">.</span><span class="ident" id="4773183">Array</span><span class="op" id="4773188">)</span>&nbsp;<span class="op" id="4773190">&amp;&amp;</span>&nbsp;<span class="ident" id="4773193">typ</span><span class="op" id="4773196">.</span><span class="ident" id="4773197">Elem</span><span class="op" id="4773201">(</span><span class="op" id="4773202">)</span><span class="op" id="4773203">.</span><span class="ident" id="4773204">Kind</span><span class="op" id="4773208">(</span><span class="op" id="4773209">)</span>&nbsp;<span class="op" id="4773211">!=</span>&nbsp;<span class="ident" id="4773214">reflect</span><span class="op" id="4773221">.</span><span class="ident" id="4773222">Uint8</span>&nbsp;<span class="op" id="4773228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773232">for</span>&nbsp;<span class="ident" id="4773236">i</span><span class="op" id="4773237">,</span>&nbsp;<span class="ident" id="4773239">n</span>&nbsp;<span class="op" id="4773241">:=</span>&nbsp;<span class="num" id="4773244">0</span><span class="op" id="4773245">,</span>&nbsp;<span class="ident" id="4773247">val</span><span class="op" id="4773250">.</span><span class="ident" id="4773251">Len</span><span class="op" id="4773254">(</span><span class="op" id="4773255">)</span><span class="op" id="4773256">;</span>&nbsp;<span class="ident" id="4773258">i</span>&nbsp;<span class="op" id="4773260">&lt;</span>&nbsp;<span class="ident" id="4773262">n</span><span class="op" id="4773263">;</span>&nbsp;<span class="ident" id="4773265">i</span><span class="op" id="4773266">++</span>&nbsp;<span class="op" id="4773269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773274">if</span>&nbsp;<span class="ident" id="4773277">err</span>&nbsp;<span class="op" id="4773281">:=</span>&nbsp;<span class="ident" id="4773284">p</span><span class="op" id="4773285">.</span><span class="ident" id="4773286">marshalValue</span><span class="op" id="4773298">(</span><span class="ident" id="4773299">val</span><span class="op" id="4773302">.</span><span class="ident" id="4773303">Index</span><span class="op" id="4773308">(</span><span class="ident" id="4773309">i</span><span class="op" id="4773310">)</span><span class="op" id="4773311">,</span>&nbsp;<span class="ident" id="4773313">finfo</span><span class="op" id="4773318">,</span>&nbsp;<span class="ident" id="4773320">startTemplate</span><span class="op" id="4773333">)</span><span class="op" id="4773334">;</span>&nbsp;<span class="ident" id="4773336">err</span>&nbsp;<span class="op" id="4773340">!=</span>&nbsp;<span class="builtintype" id="4773343">nil</span>&nbsp;<span class="op" id="4773347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773353">return</span>&nbsp;<span class="ident" id="4773360">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773367">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773375">return</span>&nbsp;<span class="builtintype" id="4773382">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773391">tinfo</span><span class="op" id="4773396">,</span>&nbsp;<span class="ident" id="4773398">err</span>&nbsp;<span class="op" id="4773402">:=</span>&nbsp;<span class="ident" id="4773405">getTypeInfo</span><span class="op" id="4773416">(</span><span class="ident" id="4773417">typ</span><span class="op" id="4773420">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773423">if</span>&nbsp;<span class="ident" id="4773426">err</span>&nbsp;<span class="op" id="4773430">!=</span>&nbsp;<span class="builtintype" id="4773433">nil</span>&nbsp;<span class="op" id="4773437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773441">return</span>&nbsp;<span class="ident" id="4773448">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773457">//&nbsp;Create&nbsp;start&nbsp;element.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773483">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773527">//&nbsp;0.&nbsp;startTemplate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773548">//&nbsp;1.&nbsp;XMLName&nbsp;field&nbsp;in&nbsp;underlying&nbsp;struct;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773591">//&nbsp;2.&nbsp;field&nbsp;name/tag&nbsp;in&nbsp;the&nbsp;struct&nbsp;field;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4773638">//&nbsp;3.&nbsp;type&nbsp;name</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773655">var</span>&nbsp;<span class="ident" id="4773659">start</span>&nbsp;<span class="ident" id="4773665">StartElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773680">if</span>&nbsp;<span class="ident" id="4773683">startTemplate</span>&nbsp;<span class="op" id="4773697">!=</span>&nbsp;<span class="builtintype" id="4773700">nil</span>&nbsp;<span class="op" id="4773704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773708">start</span><span class="op" id="4773713">.</span><span class="ident" id="4773714">Name</span>&nbsp;<span class="op" id="4773719">=</span>&nbsp;<span class="ident" id="4773721">startTemplate</span><span class="op" id="4773734">.</span><span class="ident" id="4773735">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773742">start</span><span class="op" id="4773747">.</span><span class="ident" id="4773748">Attr</span>&nbsp;<span class="op" id="4773753">=</span>&nbsp;<span class="builtinfunc" id="4773755">append</span><span class="op" id="4773761">(</span><span class="ident" id="4773762">start</span><span class="op" id="4773767">.</span><span class="ident" id="4773768">Attr</span><span class="op" id="4773772">,</span>&nbsp;<span class="ident" id="4773774">startTemplate</span><span class="op" id="4773787">.</span><span class="ident" id="4773788">Attr</span><span class="op" id="4773792">...</span><span class="op" id="4773795">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773798">}</span>&nbsp;<span class="keyword" id="4773800">else</span>&nbsp;<span class="keyword" id="4773805">if</span>&nbsp;<span class="ident" id="4773808">tinfo</span><span class="op" id="4773813">.</span><span class="ident" id="4773814">xmlname</span>&nbsp;<span class="op" id="4773822">!=</span>&nbsp;<span class="builtintype" id="4773825">nil</span>&nbsp;<span class="op" id="4773829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773833">xmlname</span>&nbsp;<span class="op" id="4773841">:=</span>&nbsp;<span class="ident" id="4773844">tinfo</span><span class="op" id="4773849">.</span><span class="ident" id="4773850">xmlname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4773860">if</span>&nbsp;<span class="ident" id="4773863">xmlname</span><span class="op" id="4773870">.</span><span class="ident" id="4773871">name</span>&nbsp;<span class="op" id="4773876">!=</span>&nbsp;<span class="string" id="4773879">&#34;&#34;</span>&nbsp;<span class="op" id="4773882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4773887">start</span><span class="op" id="4773892">.</span><span class="ident" id="4773893">Name</span><span class="op" id="4773897">.</span><span class="ident" id="4773898">Space</span><span class="op" id="4773903">,</span>&nbsp;<span class="ident" id="4773905">start</span><span class="op" id="4773910">.</span><span class="ident" id="4773911">Name</span><span class="op" id="4773915">.</span><span class="ident" id="4773916">Local</span>&nbsp;<span class="op" id="4773922">=</span>&nbsp;<span class="ident" id="4773924">xmlname</span><span class="op" id="4773931">.</span><span class="ident" id="4773932">xmlns</span><span class="op" id="4773937">,</span>&nbsp;<span class="ident" id="4773939">xmlname</span><span class="op" id="4773946">.</span><span class="ident" id="4773947">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4773954">}</span>&nbsp;<span class="keyword" id="4773956">else</span>&nbsp;<span class="keyword" id="4773961">if</span>&nbsp;<span class="ident" id="4773964">v</span><span class="op" id="4773965">,</span>&nbsp;<span class="ident" id="4773967">ok</span>&nbsp;<span class="op" id="4773970">:=</span>&nbsp;<span class="ident" id="4773973">xmlname</span><span class="op" id="4773980">.</span><span class="ident" id="4773981">value</span><span class="op" id="4773986">(</span><span class="ident" id="4773987">val</span><span class="op" id="4773990">)</span><span class="op" id="4773991">.</span><span class="ident" id="4773992">Interface</span><span class="op" id="4774001">(</span><span class="op" id="4774002">)</span><span class="op" id="4774003">.</span><span class="op" id="4774004">(</span><span class="ident" id="4774005">Name</span><span class="op" id="4774009">)</span><span class="op" id="4774010">;</span>&nbsp;<span class="ident" id="4774012">ok</span>&nbsp;<span class="op" id="4774015">&amp;&amp;</span>&nbsp;<span class="ident" id="4774018">v</span><span class="op" id="4774019">.</span><span class="ident" id="4774020">Local</span>&nbsp;<span class="op" id="4774026">!=</span>&nbsp;<span class="string" id="4774029">&#34;&#34;</span>&nbsp;<span class="op" id="4774032">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774037">start</span><span class="op" id="4774042">.</span><span class="ident" id="4774043">Name</span>&nbsp;<span class="op" id="4774048">=</span>&nbsp;<span class="ident" id="4774050">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774060">if</span>&nbsp;<span class="ident" id="4774063">start</span><span class="op" id="4774068">.</span><span class="ident" id="4774069">Name</span><span class="op" id="4774073">.</span><span class="ident" id="4774074">Local</span>&nbsp;<span class="op" id="4774080">==</span>&nbsp;<span class="string" id="4774083">&#34;&#34;</span>&nbsp;<span class="op" id="4774086">&amp;&amp;</span>&nbsp;<span class="ident" id="4774089">finfo</span>&nbsp;<span class="op" id="4774095">!=</span>&nbsp;<span class="builtintype" id="4774098">nil</span>&nbsp;<span class="op" id="4774102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774106">start</span><span class="op" id="4774111">.</span><span class="ident" id="4774112">Name</span><span class="op" id="4774116">.</span><span class="ident" id="4774117">Space</span><span class="op" id="4774122">,</span>&nbsp;<span class="ident" id="4774124">start</span><span class="op" id="4774129">.</span><span class="ident" id="4774130">Name</span><span class="op" id="4774134">.</span><span class="ident" id="4774135">Local</span>&nbsp;<span class="op" id="4774141">=</span>&nbsp;<span class="ident" id="4774143">finfo</span><span class="op" id="4774148">.</span><span class="ident" id="4774149">xmlns</span><span class="op" id="4774154">,</span>&nbsp;<span class="ident" id="4774156">finfo</span><span class="op" id="4774161">.</span><span class="ident" id="4774162">name</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774171">if</span>&nbsp;<span class="ident" id="4774174">start</span><span class="op" id="4774179">.</span><span class="ident" id="4774180">Name</span><span class="op" id="4774184">.</span><span class="ident" id="4774185">Local</span>&nbsp;<span class="op" id="4774191">==</span>&nbsp;<span class="string" id="4774194">&#34;&#34;</span>&nbsp;<span class="op" id="4774197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774201">name</span>&nbsp;<span class="op" id="4774206">:=</span>&nbsp;<span class="ident" id="4774209">typ</span><span class="op" id="4774212">.</span><span class="ident" id="4774213">Name</span><span class="op" id="4774217">(</span><span class="op" id="4774218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774222">if</span>&nbsp;<span class="ident" id="4774225">name</span>&nbsp;<span class="op" id="4774230">==</span>&nbsp;<span class="string" id="4774233">&#34;&#34;</span>&nbsp;<span class="op" id="4774236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774241">return</span>&nbsp;<span class="op" id="4774248">&amp;</span><span class="ident" id="4774249">UnsupportedTypeError</span><span class="op" id="4774269">{</span><span class="ident" id="4774270">typ</span><span class="op" id="4774273">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774281">start</span><span class="op" id="4774286">.</span><span class="ident" id="4774287">Name</span><span class="op" id="4774291">.</span><span class="ident" id="4774292">Local</span>&nbsp;<span class="op" id="4774298">=</span>&nbsp;<span class="ident" id="4774300">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4774310">//&nbsp;Attributes</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774325">for</span>&nbsp;<span class="ident" id="4774329">i</span>&nbsp;<span class="op" id="4774331">:=</span>&nbsp;<span class="keyword" id="4774334">range</span>&nbsp;<span class="ident" id="4774340">tinfo</span><span class="op" id="4774345">.</span><span class="ident" id="4774346">fields</span>&nbsp;<span class="op" id="4774353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774357">finfo</span>&nbsp;<span class="op" id="4774363">:=</span>&nbsp;<span class="op" id="4774366">&amp;</span><span class="ident" id="4774367">tinfo</span><span class="op" id="4774372">.</span><span class="ident" id="4774373">fields</span><span class="op" id="4774379">[</span><span class="ident" id="4774380">i</span><span class="op" id="4774381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774385">if</span>&nbsp;<span class="ident" id="4774388">finfo</span><span class="op" id="4774393">.</span><span class="ident" id="4774394">flags</span><span class="op" id="4774399">&amp;</span><span class="ident" id="4774400">fAttr</span>&nbsp;<span class="op" id="4774406">==</span>&nbsp;<span class="num" id="4774409">0</span>&nbsp;<span class="op" id="4774411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774416">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774427">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774431">fv</span>&nbsp;<span class="op" id="4774434">:=</span>&nbsp;<span class="ident" id="4774437">finfo</span><span class="op" id="4774442">.</span><span class="ident" id="4774443">value</span><span class="op" id="4774448">(</span><span class="ident" id="4774449">val</span><span class="op" id="4774452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774456">name</span>&nbsp;<span class="op" id="4774461">:=</span>&nbsp;<span class="ident" id="4774464">Name</span><span class="op" id="4774468">{</span><span class="ident" id="4774469">Space</span><span class="op" id="4774474">:</span>&nbsp;<span class="ident" id="4774476">finfo</span><span class="op" id="4774481">.</span><span class="ident" id="4774482">xmlns</span><span class="op" id="4774487">,</span>&nbsp;<span class="ident" id="4774489">Local</span><span class="op" id="4774494">:</span>&nbsp;<span class="ident" id="4774496">finfo</span><span class="op" id="4774501">.</span><span class="ident" id="4774502">name</span><span class="op" id="4774506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774511">if</span>&nbsp;<span class="ident" id="4774514">finfo</span><span class="op" id="4774519">.</span><span class="ident" id="4774520">flags</span><span class="op" id="4774525">&amp;</span><span class="ident" id="4774526">fOmitEmpty</span>&nbsp;<span class="op" id="4774537">!=</span>&nbsp;<span class="num" id="4774540">0</span>&nbsp;<span class="op" id="4774542">&amp;&amp;</span>&nbsp;<span class="ident" id="4774545">isEmptyValue</span><span class="op" id="4774557">(</span><span class="ident" id="4774558">fv</span><span class="op" id="4774560">)</span>&nbsp;<span class="op" id="4774562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774567">continue</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774583">if</span>&nbsp;<span class="ident" id="4774586">fv</span><span class="op" id="4774588">.</span><span class="ident" id="4774589">Kind</span><span class="op" id="4774593">(</span><span class="op" id="4774594">)</span>&nbsp;<span class="op" id="4774596">==</span>&nbsp;<span class="ident" id="4774599">reflect</span><span class="op" id="4774606">.</span><span class="ident" id="4774607">Interface</span>&nbsp;<span class="op" id="4774617">&amp;&amp;</span>&nbsp;<span class="ident" id="4774620">fv</span><span class="op" id="4774622">.</span><span class="ident" id="4774623">IsNil</span><span class="op" id="4774628">(</span><span class="op" id="4774629">)</span>&nbsp;<span class="op" id="4774631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774636">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774647">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774652">if</span>&nbsp;<span class="ident" id="4774655">fv</span><span class="op" id="4774657">.</span><span class="ident" id="4774658">CanInterface</span><span class="op" id="4774670">(</span><span class="op" id="4774671">)</span>&nbsp;<span class="op" id="4774673">&amp;&amp;</span>&nbsp;<span class="ident" id="4774676">fv</span><span class="op" id="4774678">.</span><span class="ident" id="4774679">Type</span><span class="op" id="4774683">(</span><span class="op" id="4774684">)</span><span class="op" id="4774685">.</span><span class="ident" id="4774686">Implements</span><span class="op" id="4774696">(</span><span class="ident" id="4774697">marshalerAttrType</span><span class="op" id="4774714">)</span>&nbsp;<span class="op" id="4774716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774721">attr</span><span class="op" id="4774725">,</span>&nbsp;<span class="ident" id="4774727">err</span>&nbsp;<span class="op" id="4774731">:=</span>&nbsp;<span class="ident" id="4774734">fv</span><span class="op" id="4774736">.</span><span class="ident" id="4774737">Interface</span><span class="op" id="4774746">(</span><span class="op" id="4774747">)</span><span class="op" id="4774748">.</span><span class="op" id="4774749">(</span><span class="ident" id="4774750">MarshalerAttr</span><span class="op" id="4774763">)</span><span class="op" id="4774764">.</span><span class="ident" id="4774765">MarshalXMLAttr</span><span class="op" id="4774779">(</span><span class="ident" id="4774780">name</span><span class="op" id="4774784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774789">if</span>&nbsp;<span class="ident" id="4774792">err</span>&nbsp;<span class="op" id="4774796">!=</span>&nbsp;<span class="builtintype" id="4774799">nil</span>&nbsp;<span class="op" id="4774803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774809">return</span>&nbsp;<span class="ident" id="4774816">err</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774828">if</span>&nbsp;<span class="ident" id="4774831">attr</span><span class="op" id="4774835">.</span><span class="ident" id="4774836">Name</span><span class="op" id="4774840">.</span><span class="ident" id="4774841">Local</span>&nbsp;<span class="op" id="4774847">!=</span>&nbsp;<span class="string" id="4774850">&#34;&#34;</span>&nbsp;<span class="op" id="4774853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774859">start</span><span class="op" id="4774864">.</span><span class="ident" id="4774865">Attr</span>&nbsp;<span class="op" id="4774870">=</span>&nbsp;<span class="builtinfunc" id="4774872">append</span><span class="op" id="4774878">(</span><span class="ident" id="4774879">start</span><span class="op" id="4774884">.</span><span class="ident" id="4774885">Attr</span><span class="op" id="4774889">,</span>&nbsp;<span class="ident" id="4774891">attr</span><span class="op" id="4774895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774905">continue</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4774916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774921">if</span>&nbsp;<span class="ident" id="4774924">fv</span><span class="op" id="4774926">.</span><span class="ident" id="4774927">CanAddr</span><span class="op" id="4774934">(</span><span class="op" id="4774935">)</span>&nbsp;<span class="op" id="4774937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4774942">pv</span>&nbsp;<span class="op" id="4774945">:=</span>&nbsp;<span class="ident" id="4774948">fv</span><span class="op" id="4774950">.</span><span class="ident" id="4774951">Addr</span><span class="op" id="4774955">(</span><span class="op" id="4774956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4774961">if</span>&nbsp;<span class="ident" id="4774964">pv</span><span class="op" id="4774966">.</span><span class="ident" id="4774967">CanInterface</span><span class="op" id="4774979">(</span><span class="op" id="4774980">)</span>&nbsp;<span class="op" id="4774982">&amp;&amp;</span>&nbsp;<span class="ident" id="4774985">pv</span><span class="op" id="4774987">.</span><span class="ident" id="4774988">Type</span><span class="op" id="4774992">(</span><span class="op" id="4774993">)</span><span class="op" id="4774994">.</span><span class="ident" id="4774995">Implements</span><span class="op" id="4775005">(</span><span class="ident" id="4775006">marshalerAttrType</span><span class="op" id="4775023">)</span>&nbsp;<span class="op" id="4775025">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775031">attr</span><span class="op" id="4775035">,</span>&nbsp;<span class="ident" id="4775037">err</span>&nbsp;<span class="op" id="4775041">:=</span>&nbsp;<span class="ident" id="4775044">pv</span><span class="op" id="4775046">.</span><span class="ident" id="4775047">Interface</span><span class="op" id="4775056">(</span><span class="op" id="4775057">)</span><span class="op" id="4775058">.</span><span class="op" id="4775059">(</span><span class="ident" id="4775060">MarshalerAttr</span><span class="op" id="4775073">)</span><span class="op" id="4775074">.</span><span class="ident" id="4775075">MarshalXMLAttr</span><span class="op" id="4775089">(</span><span class="ident" id="4775090">name</span><span class="op" id="4775094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775100">if</span>&nbsp;<span class="ident" id="4775103">err</span>&nbsp;<span class="op" id="4775107">!=</span>&nbsp;<span class="builtintype" id="4775110">nil</span>&nbsp;<span class="op" id="4775114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775121">return</span>&nbsp;<span class="ident" id="4775128">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775142">if</span>&nbsp;<span class="ident" id="4775145">attr</span><span class="op" id="4775149">.</span><span class="ident" id="4775150">Name</span><span class="op" id="4775154">.</span><span class="ident" id="4775155">Local</span>&nbsp;<span class="op" id="4775161">!=</span>&nbsp;<span class="string" id="4775164">&#34;&#34;</span>&nbsp;<span class="op" id="4775167">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775174">start</span><span class="op" id="4775179">.</span><span class="ident" id="4775180">Attr</span>&nbsp;<span class="op" id="4775185">=</span>&nbsp;<span class="builtinfunc" id="4775187">append</span><span class="op" id="4775193">(</span><span class="ident" id="4775194">start</span><span class="op" id="4775199">.</span><span class="ident" id="4775200">Attr</span><span class="op" id="4775204">,</span>&nbsp;<span class="ident" id="4775206">attr</span><span class="op" id="4775210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775222">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775238">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775243">if</span>&nbsp;<span class="ident" id="4775246">fv</span><span class="op" id="4775248">.</span><span class="ident" id="4775249">CanInterface</span><span class="op" id="4775261">(</span><span class="op" id="4775262">)</span>&nbsp;<span class="op" id="4775264">&amp;&amp;</span>&nbsp;<span class="ident" id="4775267">fv</span><span class="op" id="4775269">.</span><span class="ident" id="4775270">Type</span><span class="op" id="4775274">(</span><span class="op" id="4775275">)</span><span class="op" id="4775276">.</span><span class="ident" id="4775277">Implements</span><span class="op" id="4775287">(</span><span class="ident" id="4775288">textMarshalerType</span><span class="op" id="4775305">)</span>&nbsp;<span class="op" id="4775307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775312">text</span><span class="op" id="4775316">,</span>&nbsp;<span class="ident" id="4775318">err</span>&nbsp;<span class="op" id="4775322">:=</span>&nbsp;<span class="ident" id="4775325">fv</span><span class="op" id="4775327">.</span><span class="ident" id="4775328">Interface</span><span class="op" id="4775337">(</span><span class="op" id="4775338">)</span><span class="op" id="4775339">.</span><span class="op" id="4775340">(</span><span class="ident" id="4775341">encoding</span><span class="op" id="4775349">.</span><span class="ident" id="4775350">TextMarshaler</span><span class="op" id="4775363">)</span><span class="op" id="4775364">.</span><span class="ident" id="4775365">MarshalText</span><span class="op" id="4775376">(</span><span class="op" id="4775377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775382">if</span>&nbsp;<span class="ident" id="4775385">err</span>&nbsp;<span class="op" id="4775389">!=</span>&nbsp;<span class="builtintype" id="4775392">nil</span>&nbsp;<span class="op" id="4775396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775402">return</span>&nbsp;<span class="ident" id="4775409">err</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775421">start</span><span class="op" id="4775426">.</span><span class="ident" id="4775427">Attr</span>&nbsp;<span class="op" id="4775432">=</span>&nbsp;<span class="builtinfunc" id="4775434">append</span><span class="op" id="4775440">(</span><span class="ident" id="4775441">start</span><span class="op" id="4775446">.</span><span class="ident" id="4775447">Attr</span><span class="op" id="4775451">,</span>&nbsp;<span class="ident" id="4775453">Attr</span><span class="op" id="4775457">{</span><span class="ident" id="4775458">name</span><span class="op" id="4775462">,</span>&nbsp;<span class="builtintype" id="4775464">string</span><span class="op" id="4775470">(</span><span class="ident" id="4775471">text</span><span class="op" id="4775475">)</span><span class="op" id="4775476">}</span><span class="op" id="4775477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775482">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775498">if</span>&nbsp;<span class="ident" id="4775501">fv</span><span class="op" id="4775503">.</span><span class="ident" id="4775504">CanAddr</span><span class="op" id="4775511">(</span><span class="op" id="4775512">)</span>&nbsp;<span class="op" id="4775514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775519">pv</span>&nbsp;<span class="op" id="4775522">:=</span>&nbsp;<span class="ident" id="4775525">fv</span><span class="op" id="4775527">.</span><span class="ident" id="4775528">Addr</span><span class="op" id="4775532">(</span><span class="op" id="4775533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775538">if</span>&nbsp;<span class="ident" id="4775541">pv</span><span class="op" id="4775543">.</span><span class="ident" id="4775544">CanInterface</span><span class="op" id="4775556">(</span><span class="op" id="4775557">)</span>&nbsp;<span class="op" id="4775559">&amp;&amp;</span>&nbsp;<span class="ident" id="4775562">pv</span><span class="op" id="4775564">.</span><span class="ident" id="4775565">Type</span><span class="op" id="4775569">(</span><span class="op" id="4775570">)</span><span class="op" id="4775571">.</span><span class="ident" id="4775572">Implements</span><span class="op" id="4775582">(</span><span class="ident" id="4775583">textMarshalerType</span><span class="op" id="4775600">)</span>&nbsp;<span class="op" id="4775602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775608">text</span><span class="op" id="4775612">,</span>&nbsp;<span class="ident" id="4775614">err</span>&nbsp;<span class="op" id="4775618">:=</span>&nbsp;<span class="ident" id="4775621">pv</span><span class="op" id="4775623">.</span><span class="ident" id="4775624">Interface</span><span class="op" id="4775633">(</span><span class="op" id="4775634">)</span><span class="op" id="4775635">.</span><span class="op" id="4775636">(</span><span class="ident" id="4775637">encoding</span><span class="op" id="4775645">.</span><span class="ident" id="4775646">TextMarshaler</span><span class="op" id="4775659">)</span><span class="op" id="4775660">.</span><span class="ident" id="4775661">MarshalText</span><span class="op" id="4775672">(</span><span class="op" id="4775673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775679">if</span>&nbsp;<span class="ident" id="4775682">err</span>&nbsp;<span class="op" id="4775686">!=</span>&nbsp;<span class="builtintype" id="4775689">nil</span>&nbsp;<span class="op" id="4775693">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775700">return</span>&nbsp;<span class="ident" id="4775707">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775721">start</span><span class="op" id="4775726">.</span><span class="ident" id="4775727">Attr</span>&nbsp;<span class="op" id="4775732">=</span>&nbsp;<span class="builtinfunc" id="4775734">append</span><span class="op" id="4775740">(</span><span class="ident" id="4775741">start</span><span class="op" id="4775746">.</span><span class="ident" id="4775747">Attr</span><span class="op" id="4775751">,</span>&nbsp;<span class="ident" id="4775753">Attr</span><span class="op" id="4775757">{</span><span class="ident" id="4775758">name</span><span class="op" id="4775762">,</span>&nbsp;<span class="builtintype" id="4775764">string</span><span class="op" id="4775770">(</span><span class="ident" id="4775771">text</span><span class="op" id="4775775">)</span><span class="op" id="4775776">}</span><span class="op" id="4775777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775783">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775795">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4775804">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775860">switch</span>&nbsp;<span class="ident" id="4775867">fv</span><span class="op" id="4775869">.</span><span class="ident" id="4775870">Kind</span><span class="op" id="4775874">(</span><span class="op" id="4775875">)</span>&nbsp;<span class="op" id="4775877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775881">case</span>&nbsp;<span class="ident" id="4775886">reflect</span><span class="op" id="4775893">.</span><span class="ident" id="4775894">Ptr</span><span class="op" id="4775897">,</span>&nbsp;<span class="ident" id="4775899">reflect</span><span class="op" id="4775906">.</span><span class="ident" id="4775907">Interface</span><span class="op" id="4775916">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775921">if</span>&nbsp;<span class="ident" id="4775924">fv</span><span class="op" id="4775926">.</span><span class="ident" id="4775927">IsNil</span><span class="op" id="4775932">(</span><span class="op" id="4775933">)</span>&nbsp;<span class="op" id="4775935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4775941">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775958">fv</span>&nbsp;<span class="op" id="4775961">=</span>&nbsp;<span class="ident" id="4775963">fv</span><span class="op" id="4775965">.</span><span class="ident" id="4775966">Elem</span><span class="op" id="4775970">(</span><span class="op" id="4775971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4775975">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4775980">s</span><span class="op" id="4775981">,</span>&nbsp;<span class="ident" id="4775983">b</span><span class="op" id="4775984">,</span>&nbsp;<span class="ident" id="4775986">err</span>&nbsp;<span class="op" id="4775990">:=</span>&nbsp;<span class="ident" id="4775993">p</span><span class="op" id="4775994">.</span><span class="ident" id="4775995">marshalSimple</span><span class="op" id="4776008">(</span><span class="ident" id="4776009">fv</span><span class="op" id="4776011">.</span><span class="ident" id="4776012">Type</span><span class="op" id="4776016">(</span><span class="op" id="4776017">)</span><span class="op" id="4776018">,</span>&nbsp;<span class="ident" id="4776020">fv</span><span class="op" id="4776022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776026">if</span>&nbsp;<span class="ident" id="4776029">err</span>&nbsp;<span class="op" id="4776033">!=</span>&nbsp;<span class="builtintype" id="4776036">nil</span>&nbsp;<span class="op" id="4776040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776045">return</span>&nbsp;<span class="ident" id="4776052">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776058">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776062">if</span>&nbsp;<span class="ident" id="4776065">b</span>&nbsp;<span class="op" id="4776067">!=</span>&nbsp;<span class="builtintype" id="4776070">nil</span>&nbsp;<span class="op" id="4776074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776079">s</span>&nbsp;<span class="op" id="4776081">=</span>&nbsp;<span class="builtintype" id="4776083">string</span><span class="op" id="4776089">(</span><span class="ident" id="4776090">b</span><span class="op" id="4776091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776099">start</span><span class="op" id="4776104">.</span><span class="ident" id="4776105">Attr</span>&nbsp;<span class="op" id="4776110">=</span>&nbsp;<span class="builtinfunc" id="4776112">append</span><span class="op" id="4776118">(</span><span class="ident" id="4776119">start</span><span class="op" id="4776124">.</span><span class="ident" id="4776125">Attr</span><span class="op" id="4776129">,</span>&nbsp;<span class="ident" id="4776131">Attr</span><span class="op" id="4776135">{</span><span class="ident" id="4776136">name</span><span class="op" id="4776140">,</span>&nbsp;<span class="ident" id="4776142">s</span><span class="op" id="4776143">}</span><span class="op" id="4776144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776147">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776151">if</span>&nbsp;<span class="ident" id="4776154">err</span>&nbsp;<span class="op" id="4776158">:=</span>&nbsp;<span class="ident" id="4776161">p</span><span class="op" id="4776162">.</span><span class="ident" id="4776163">writeStart</span><span class="op" id="4776173">(</span><span class="op" id="4776174">&amp;</span><span class="ident" id="4776175">start</span><span class="op" id="4776180">)</span><span class="op" id="4776181">;</span>&nbsp;<span class="ident" id="4776183">err</span>&nbsp;<span class="op" id="4776187">!=</span>&nbsp;<span class="builtintype" id="4776190">nil</span>&nbsp;<span class="op" id="4776194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776198">return</span>&nbsp;<span class="ident" id="4776205">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776214">if</span>&nbsp;<span class="ident" id="4776217">val</span><span class="op" id="4776220">.</span><span class="ident" id="4776221">Kind</span><span class="op" id="4776225">(</span><span class="op" id="4776226">)</span>&nbsp;<span class="op" id="4776228">==</span>&nbsp;<span class="ident" id="4776231">reflect</span><span class="op" id="4776238">.</span><span class="ident" id="4776239">Struct</span>&nbsp;<span class="op" id="4776246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776250">err</span>&nbsp;<span class="op" id="4776254">=</span>&nbsp;<span class="ident" id="4776256">p</span><span class="op" id="4776257">.</span><span class="ident" id="4776258">marshalStruct</span><span class="op" id="4776271">(</span><span class="ident" id="4776272">tinfo</span><span class="op" id="4776277">,</span>&nbsp;<span class="ident" id="4776279">val</span><span class="op" id="4776282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776285">}</span>&nbsp;<span class="keyword" id="4776287">else</span>&nbsp;<span class="op" id="4776292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776296">s</span><span class="op" id="4776297">,</span>&nbsp;<span class="ident" id="4776299">b</span><span class="op" id="4776300">,</span>&nbsp;<span class="ident" id="4776302">err1</span>&nbsp;<span class="op" id="4776307">:=</span>&nbsp;<span class="ident" id="4776310">p</span><span class="op" id="4776311">.</span><span class="ident" id="4776312">marshalSimple</span><span class="op" id="4776325">(</span><span class="ident" id="4776326">typ</span><span class="op" id="4776329">,</span>&nbsp;<span class="ident" id="4776331">val</span><span class="op" id="4776334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776338">if</span>&nbsp;<span class="ident" id="4776341">err1</span>&nbsp;<span class="op" id="4776346">!=</span>&nbsp;<span class="builtintype" id="4776349">nil</span>&nbsp;<span class="op" id="4776353">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776358">err</span>&nbsp;<span class="op" id="4776362">=</span>&nbsp;<span class="ident" id="4776364">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776371">}</span>&nbsp;<span class="keyword" id="4776373">else</span>&nbsp;<span class="keyword" id="4776378">if</span>&nbsp;<span class="ident" id="4776381">b</span>&nbsp;<span class="op" id="4776383">!=</span>&nbsp;<span class="builtintype" id="4776386">nil</span>&nbsp;<span class="op" id="4776390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776395">EscapeText</span><span class="op" id="4776405">(</span><span class="ident" id="4776406">p</span><span class="op" id="4776407">,</span>&nbsp;<span class="ident" id="4776409">b</span><span class="op" id="4776410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776414">}</span>&nbsp;<span class="keyword" id="4776416">else</span>&nbsp;<span class="op" id="4776421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776426">p</span><span class="op" id="4776427">.</span><span class="ident" id="4776428">EscapeString</span><span class="op" id="4776440">(</span><span class="ident" id="4776441">s</span><span class="op" id="4776442">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776452">if</span>&nbsp;<span class="ident" id="4776455">err</span>&nbsp;<span class="op" id="4776459">!=</span>&nbsp;<span class="builtintype" id="4776462">nil</span>&nbsp;<span class="op" id="4776466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776470">return</span>&nbsp;<span class="ident" id="4776477">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776482">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776486">if</span>&nbsp;<span class="ident" id="4776489">err</span>&nbsp;<span class="op" id="4776493">:=</span>&nbsp;<span class="ident" id="4776496">p</span><span class="op" id="4776497">.</span><span class="ident" id="4776498">writeEnd</span><span class="op" id="4776506">(</span><span class="ident" id="4776507">start</span><span class="op" id="4776512">.</span><span class="ident" id="4776513">Name</span><span class="op" id="4776517">)</span><span class="op" id="4776518">;</span>&nbsp;<span class="ident" id="4776520">err</span>&nbsp;<span class="op" id="4776524">!=</span>&nbsp;<span class="builtintype" id="4776527">nil</span>&nbsp;<span class="op" id="4776531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776535">return</span>&nbsp;<span class="ident" id="4776542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4776547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776551">return</span>&nbsp;<span class="ident" id="4776558">p</span><span class="op" id="4776559">.</span><span class="ident" id="4776560">cachedWriteError</span><span class="op" id="4776576">(</span><span class="op" id="4776577">)</span><br>
<span class="lineno"></span><span class="op" id="4776579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4776582">//&nbsp;defaultStart&nbsp;returns&nbsp;the&nbsp;default&nbsp;start&nbsp;element&nbsp;to&nbsp;use,</span><br>
<span class="lineno"></span><span class="comment" id="4776640">//&nbsp;given&nbsp;the&nbsp;reflect&nbsp;type,&nbsp;field&nbsp;info,&nbsp;and&nbsp;start&nbsp;template.</span><br>
<span class="lineno">555</span><span class="keyword" id="4776699">func</span>&nbsp;<span class="ident" id="4776704">defaultStart</span><span class="op" id="4776716">(</span><span class="ident" id="4776717">typ</span>&nbsp;<span class="ident" id="4776721">reflect</span><span class="op" id="4776728">.</span><span class="ident" id="4776729">Type</span><span class="op" id="4776733">,</span>&nbsp;<span class="ident" id="4776735">finfo</span>&nbsp;<span class="op" id="4776741">*</span><span class="ident" id="4776742">fieldInfo</span><span class="op" id="4776751">,</span>&nbsp;<span class="ident" id="4776753">startTemplate</span>&nbsp;<span class="op" id="4776767">*</span><span class="ident" id="4776768">StartElement</span><span class="op" id="4776780">)</span>&nbsp;<span class="ident" id="4776782">StartElement</span>&nbsp;<span class="op" id="4776795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776798">var</span>&nbsp;<span class="ident" id="4776802">start</span>&nbsp;<span class="ident" id="4776808">StartElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4776822">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is&nbsp;as&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4776875">//&nbsp;except&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;look&nbsp;inside&nbsp;structs&nbsp;for&nbsp;the&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4776942">if</span>&nbsp;<span class="ident" id="4776945">startTemplate</span>&nbsp;<span class="op" id="4776959">!=</span>&nbsp;<span class="builtintype" id="4776962">nil</span>&nbsp;<span class="op" id="4776966">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4776970">start</span><span class="op" id="4776975">.</span><span class="ident" id="4776976">Name</span>&nbsp;<span class="op" id="4776981">=</span>&nbsp;<span class="ident" id="4776983">startTemplate</span><span class="op" id="4776996">.</span><span class="ident" id="4776997">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777004">start</span><span class="op" id="4777009">.</span><span class="ident" id="4777010">Attr</span>&nbsp;<span class="op" id="4777015">=</span>&nbsp;<span class="builtinfunc" id="4777017">append</span><span class="op" id="4777023">(</span><span class="ident" id="4777024">start</span><span class="op" id="4777029">.</span><span class="ident" id="4777030">Attr</span><span class="op" id="4777034">,</span>&nbsp;<span class="ident" id="4777036">startTemplate</span><span class="op" id="4777049">.</span><span class="ident" id="4777050">Attr</span><span class="op" id="4777054">...</span><span class="op" id="4777057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777060">}</span>&nbsp;<span class="keyword" id="4777062">else</span>&nbsp;<span class="keyword" id="4777067">if</span>&nbsp;<span class="ident" id="4777070">finfo</span>&nbsp;<span class="op" id="4777076">!=</span>&nbsp;<span class="builtintype" id="4777079">nil</span>&nbsp;<span class="op" id="4777083">&amp;&amp;</span>&nbsp;<span class="ident" id="4777086">finfo</span><span class="op" id="4777091">.</span><span class="ident" id="4777092">name</span>&nbsp;<span class="op" id="4777097">!=</span>&nbsp;<span class="string" id="4777100">&#34;&#34;</span>&nbsp;<span class="op" id="4777103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777107">start</span><span class="op" id="4777112">.</span><span class="ident" id="4777113">Name</span><span class="op" id="4777117">.</span><span class="ident" id="4777118">Local</span>&nbsp;<span class="op" id="4777124">=</span>&nbsp;<span class="ident" id="4777126">finfo</span><span class="op" id="4777131">.</span><span class="ident" id="4777132">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777139">start</span><span class="op" id="4777144">.</span><span class="ident" id="4777145">Name</span><span class="op" id="4777149">.</span><span class="ident" id="4777150">Space</span>&nbsp;<span class="op" id="4777156">=</span>&nbsp;<span class="ident" id="4777158">finfo</span><span class="op" id="4777163">.</span><span class="ident" id="4777164">xmlns</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777171">}</span>&nbsp;<span class="keyword" id="4777173">else</span>&nbsp;<span class="keyword" id="4777178">if</span>&nbsp;<span class="ident" id="4777181">typ</span><span class="op" id="4777184">.</span><span class="ident" id="4777185">Name</span><span class="op" id="4777189">(</span><span class="op" id="4777190">)</span>&nbsp;<span class="op" id="4777192">!=</span>&nbsp;<span class="string" id="4777195">&#34;&#34;</span>&nbsp;<span class="op" id="4777198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777202">start</span><span class="op" id="4777207">.</span><span class="ident" id="4777208">Name</span><span class="op" id="4777212">.</span><span class="ident" id="4777213">Local</span>&nbsp;<span class="op" id="4777219">=</span>&nbsp;<span class="ident" id="4777221">typ</span><span class="op" id="4777224">.</span><span class="ident" id="4777225">Name</span><span class="op" id="4777229">(</span><span class="op" id="4777230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777233">}</span>&nbsp;<span class="keyword" id="4777235">else</span>&nbsp;<span class="op" id="4777240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4777244">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;named&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4777284">//&nbsp;since&nbsp;it&nbsp;has&nbsp;the&nbsp;Marshaler&nbsp;methods.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777325">start</span><span class="op" id="4777330">.</span><span class="ident" id="4777331">Name</span><span class="op" id="4777335">.</span><span class="ident" id="4777336">Local</span>&nbsp;<span class="op" id="4777342">=</span>&nbsp;<span class="ident" id="4777344">typ</span><span class="op" id="4777347">.</span><span class="ident" id="4777348">Elem</span><span class="op" id="4777352">(</span><span class="op" id="4777353">)</span><span class="op" id="4777354">.</span><span class="ident" id="4777355">Name</span><span class="op" id="4777359">(</span><span class="op" id="4777360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777366">return</span>&nbsp;<span class="ident" id="4777373">start</span><br>
<span class="lineno"></span><span class="op" id="4777379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="4777382">//&nbsp;marshalInterface&nbsp;marshals&nbsp;a&nbsp;Marshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4777440">func</span>&nbsp;<span class="op" id="4777445">(</span><span class="ident" id="4777446">p</span>&nbsp;<span class="op" id="4777448">*</span><span class="ident" id="4777449">printer</span><span class="op" id="4777456">)</span>&nbsp;<span class="ident" id="4777458">marshalInterface</span><span class="op" id="4777474">(</span><span class="ident" id="4777475">val</span>&nbsp;<span class="ident" id="4777479">Marshaler</span><span class="op" id="4777488">,</span>&nbsp;<span class="ident" id="4777490">start</span>&nbsp;<span class="ident" id="4777496">StartElement</span><span class="op" id="4777508">)</span>&nbsp;<span class="builtintype" id="4777510">error</span>&nbsp;<span class="op" id="4777516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4777519">//&nbsp;Push&nbsp;a&nbsp;marker&nbsp;onto&nbsp;the&nbsp;tag&nbsp;stack&nbsp;so&nbsp;that&nbsp;MarshalXML</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4777575">//&nbsp;cannot&nbsp;close&nbsp;the&nbsp;XML&nbsp;tags&nbsp;that&nbsp;it&nbsp;did&nbsp;not&nbsp;open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777627">p</span><span class="op" id="4777628">.</span><span class="ident" id="4777629">tags</span>&nbsp;<span class="op" id="4777634">=</span>&nbsp;<span class="builtinfunc" id="4777636">append</span><span class="op" id="4777642">(</span><span class="ident" id="4777643">p</span><span class="op" id="4777644">.</span><span class="ident" id="4777645">tags</span><span class="op" id="4777649">,</span>&nbsp;<span class="ident" id="4777651">Name</span><span class="op" id="4777655">{</span><span class="op" id="4777656">}</span><span class="op" id="4777657">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777660">n</span>&nbsp;<span class="op" id="4777662">:=</span>&nbsp;<span class="builtinfunc" id="4777665">len</span><span class="op" id="4777668">(</span><span class="ident" id="4777669">p</span><span class="op" id="4777670">.</span><span class="ident" id="4777671">tags</span><span class="op" id="4777675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777679">err</span>&nbsp;<span class="op" id="4777683">:=</span>&nbsp;<span class="ident" id="4777686">val</span><span class="op" id="4777689">.</span><span class="ident" id="4777690">MarshalXML</span><span class="op" id="4777700">(</span><span class="ident" id="4777701">p</span><span class="op" id="4777702">.</span><span class="ident" id="4777703">encoder</span><span class="op" id="4777710">,</span>&nbsp;<span class="ident" id="4777712">start</span><span class="op" id="4777717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777720">if</span>&nbsp;<span class="ident" id="4777723">err</span>&nbsp;<span class="op" id="4777727">!=</span>&nbsp;<span class="builtintype" id="4777730">nil</span>&nbsp;<span class="op" id="4777734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777738">return</span>&nbsp;<span class="ident" id="4777745">err</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4777754">//&nbsp;Make&nbsp;sure&nbsp;MarshalXML&nbsp;closed&nbsp;all&nbsp;its&nbsp;tags.&nbsp;p.tags[n-1]&nbsp;is&nbsp;the&nbsp;mark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777825">if</span>&nbsp;<span class="builtinfunc" id="4777828">len</span><span class="op" id="4777831">(</span><span class="ident" id="4777832">p</span><span class="op" id="4777833">.</span><span class="ident" id="4777834">tags</span><span class="op" id="4777838">)</span>&nbsp;<span class="op" id="4777840">&gt;</span>&nbsp;<span class="ident" id="4777842">n</span>&nbsp;<span class="op" id="4777844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777848">return</span>&nbsp;<span class="ident" id="4777855">fmt</span><span class="op" id="4777858">.</span><span class="ident" id="4777859">Errorf</span><span class="op" id="4777865">(</span><span class="string" id="4777866">&#34;xml:&nbsp;%s.MarshalXML&nbsp;wrote&nbsp;invalid&nbsp;XML:&nbsp;&lt;%s&gt;&nbsp;not&nbsp;closed&#34;</span><span class="op" id="4777921">,</span>&nbsp;<span class="ident" id="4777923">receiverType</span><span class="op" id="4777935">(</span><span class="ident" id="4777936">val</span><span class="op" id="4777939">)</span><span class="op" id="4777940">,</span>&nbsp;<span class="ident" id="4777942">p</span><span class="op" id="4777943">.</span><span class="ident" id="4777944">tags</span><span class="op" id="4777948">[</span><span class="builtinfunc" id="4777949">len</span><span class="op" id="4777952">(</span><span class="ident" id="4777953">p</span><span class="op" id="4777954">.</span><span class="ident" id="4777955">tags</span><span class="op" id="4777959">)</span><span class="op" id="4777960">-</span><span class="num" id="4777961">1</span><span class="op" id="4777962">]</span><span class="op" id="4777963">.</span><span class="ident" id="4777964">Local</span><span class="op" id="4777969">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4777972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4777975">p</span><span class="op" id="4777976">.</span><span class="ident" id="4777977">tags</span>&nbsp;<span class="op" id="4777982">=</span>&nbsp;<span class="ident" id="4777984">p</span><span class="op" id="4777985">.</span><span class="ident" id="4777986">tags</span><span class="op" id="4777990">[</span><span class="op" id="4777991">:</span><span class="ident" id="4777992">n</span><span class="op" id="4777993">-</span><span class="num" id="4777994">1</span><span class="op" id="4777995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4777998">return</span>&nbsp;<span class="builtintype" id="4778005">nil</span><br>
<span class="lineno"></span><span class="op" id="4778009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="4778012">//&nbsp;marshalTextInterface&nbsp;marshals&nbsp;a&nbsp;TextMarshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4778078">func</span>&nbsp;<span class="op" id="4778083">(</span><span class="ident" id="4778084">p</span>&nbsp;<span class="op" id="4778086">*</span><span class="ident" id="4778087">printer</span><span class="op" id="4778094">)</span>&nbsp;<span class="ident" id="4778096">marshalTextInterface</span><span class="op" id="4778116">(</span><span class="ident" id="4778117">val</span>&nbsp;<span class="ident" id="4778121">encoding</span><span class="op" id="4778129">.</span><span class="ident" id="4778130">TextMarshaler</span><span class="op" id="4778143">,</span>&nbsp;<span class="ident" id="4778145">start</span>&nbsp;<span class="ident" id="4778151">StartElement</span><span class="op" id="4778163">)</span>&nbsp;<span class="builtintype" id="4778165">error</span>&nbsp;<span class="op" id="4778171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778174">if</span>&nbsp;<span class="ident" id="4778177">err</span>&nbsp;<span class="op" id="4778181">:=</span>&nbsp;<span class="ident" id="4778184">p</span><span class="op" id="4778185">.</span><span class="ident" id="4778186">writeStart</span><span class="op" id="4778196">(</span><span class="op" id="4778197">&amp;</span><span class="ident" id="4778198">start</span><span class="op" id="4778203">)</span><span class="op" id="4778204">;</span>&nbsp;<span class="ident" id="4778206">err</span>&nbsp;<span class="op" id="4778210">!=</span>&nbsp;<span class="builtintype" id="4778213">nil</span>&nbsp;<span class="op" id="4778217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778221">return</span>&nbsp;<span class="ident" id="4778228">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4778233">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778236">text</span><span class="op" id="4778240">,</span>&nbsp;<span class="ident" id="4778242">err</span>&nbsp;<span class="op" id="4778246">:=</span>&nbsp;<span class="ident" id="4778249">val</span><span class="op" id="4778252">.</span><span class="ident" id="4778253">MarshalText</span><span class="op" id="4778264">(</span><span class="op" id="4778265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778268">if</span>&nbsp;<span class="ident" id="4778271">err</span>&nbsp;<span class="op" id="4778275">!=</span>&nbsp;<span class="builtintype" id="4778278">nil</span>&nbsp;<span class="op" id="4778282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778286">return</span>&nbsp;<span class="ident" id="4778293">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4778298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778301">EscapeText</span><span class="op" id="4778311">(</span><span class="ident" id="4778312">p</span><span class="op" id="4778313">,</span>&nbsp;<span class="ident" id="4778315">text</span><span class="op" id="4778319">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778322">return</span>&nbsp;<span class="ident" id="4778329">p</span><span class="op" id="4778330">.</span><span class="ident" id="4778331">writeEnd</span><span class="op" id="4778339">(</span><span class="ident" id="4778340">start</span><span class="op" id="4778345">.</span><span class="ident" id="4778346">Name</span><span class="op" id="4778350">)</span><br>
<span class="lineno"></span><span class="op" id="4778352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4778355">//&nbsp;writeStart&nbsp;writes&nbsp;the&nbsp;given&nbsp;start&nbsp;element.</span><br>
<span class="lineno"></span><span class="keyword" id="4778401">func</span>&nbsp;<span class="op" id="4778406">(</span><span class="ident" id="4778407">p</span>&nbsp;<span class="op" id="4778409">*</span><span class="ident" id="4778410">printer</span><span class="op" id="4778417">)</span>&nbsp;<span class="ident" id="4778419">writeStart</span><span class="op" id="4778429">(</span><span class="ident" id="4778430">start</span>&nbsp;<span class="op" id="4778436">*</span><span class="ident" id="4778437">StartElement</span><span class="op" id="4778449">)</span>&nbsp;<span class="builtintype" id="4778451">error</span>&nbsp;<span class="op" id="4778457">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778460">if</span>&nbsp;<span class="ident" id="4778463">start</span><span class="op" id="4778468">.</span><span class="ident" id="4778469">Name</span><span class="op" id="4778473">.</span><span class="ident" id="4778474">Local</span>&nbsp;<span class="op" id="4778480">==</span>&nbsp;<span class="string" id="4778483">&#34;&#34;</span>&nbsp;<span class="op" id="4778486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778490">return</span>&nbsp;<span class="ident" id="4778497">fmt</span><span class="op" id="4778500">.</span><span class="ident" id="4778501">Errorf</span><span class="op" id="4778507">(</span><span class="string" id="4778508">&#34;xml:&nbsp;start&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="4778537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4778540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778544">p</span><span class="op" id="4778545">.</span><span class="ident" id="4778546">tags</span>&nbsp;<span class="op" id="4778551">=</span>&nbsp;<span class="builtinfunc" id="4778553">append</span><span class="op" id="4778559">(</span><span class="ident" id="4778560">p</span><span class="op" id="4778561">.</span><span class="ident" id="4778562">tags</span><span class="op" id="4778566">,</span>&nbsp;<span class="ident" id="4778568">start</span><span class="op" id="4778573">.</span><span class="ident" id="4778574">Name</span><span class="op" id="4778578">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778581">p</span><span class="op" id="4778582">.</span><span class="ident" id="4778583">markPrefix</span><span class="op" id="4778593">(</span><span class="op" id="4778594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778598">p</span><span class="op" id="4778599">.</span><span class="ident" id="4778600">writeIndent</span><span class="op" id="4778611">(</span><span class="num" id="4778612">1</span><span class="op" id="4778613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778616">p</span><span class="op" id="4778617">.</span><span class="ident" id="4778618">WriteByte</span><span class="op" id="4778627">(</span><span class="string" id="4778628">&#39;&lt;&#39;</span><span class="op" id="4778631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778634">p</span><span class="op" id="4778635">.</span><span class="ident" id="4778636">WriteString</span><span class="op" id="4778647">(</span><span class="ident" id="4778648">start</span><span class="op" id="4778653">.</span><span class="ident" id="4778654">Name</span><span class="op" id="4778658">.</span><span class="ident" id="4778659">Local</span><span class="op" id="4778664">)</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778668">if</span>&nbsp;<span class="ident" id="4778671">start</span><span class="op" id="4778676">.</span><span class="ident" id="4778677">Name</span><span class="op" id="4778681">.</span><span class="ident" id="4778682">Space</span>&nbsp;<span class="op" id="4778688">!=</span>&nbsp;<span class="string" id="4778691">&#34;&#34;</span>&nbsp;<span class="op" id="4778694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778698">p</span><span class="op" id="4778699">.</span><span class="ident" id="4778700">WriteString</span><span class="op" id="4778711">(</span><span class="string" id="4778712">`&nbsp;xmlns=&#34;`</span><span class="op" id="4778722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778726">p</span><span class="op" id="4778727">.</span><span class="ident" id="4778728">EscapeString</span><span class="op" id="4778740">(</span><span class="ident" id="4778741">start</span><span class="op" id="4778746">.</span><span class="ident" id="4778747">Name</span><span class="op" id="4778751">.</span><span class="ident" id="4778752">Space</span><span class="op" id="4778757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778761">p</span><span class="op" id="4778762">.</span><span class="ident" id="4778763">WriteByte</span><span class="op" id="4778772">(</span><span class="string" id="4778773">&#39;&#34;&#39;</span><span class="op" id="4778776">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4778779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4778783">//&nbsp;Attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778798">for</span>&nbsp;<span class="ident" id="4778802">_</span><span class="op" id="4778803">,</span>&nbsp;<span class="ident" id="4778805">attr</span>&nbsp;<span class="op" id="4778810">:=</span>&nbsp;<span class="keyword" id="4778813">range</span>&nbsp;<span class="ident" id="4778819">start</span><span class="op" id="4778824">.</span><span class="ident" id="4778825">Attr</span>&nbsp;<span class="op" id="4778830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778834">name</span>&nbsp;<span class="op" id="4778839">:=</span>&nbsp;<span class="ident" id="4778842">attr</span><span class="op" id="4778846">.</span><span class="ident" id="4778847">Name</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778854">if</span>&nbsp;<span class="ident" id="4778857">name</span><span class="op" id="4778861">.</span><span class="ident" id="4778862">Local</span>&nbsp;<span class="op" id="4778868">==</span>&nbsp;<span class="string" id="4778871">&#34;&#34;</span>&nbsp;<span class="op" id="4778874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778879">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4778890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778894">p</span><span class="op" id="4778895">.</span><span class="ident" id="4778896">WriteByte</span><span class="op" id="4778905">(</span><span class="string" id="4778906">&#39;&nbsp;&#39;</span><span class="op" id="4778909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4778913">if</span>&nbsp;<span class="ident" id="4778916">name</span><span class="op" id="4778920">.</span><span class="ident" id="4778921">Space</span>&nbsp;<span class="op" id="4778927">!=</span>&nbsp;<span class="string" id="4778930">&#34;&#34;</span>&nbsp;<span class="op" id="4778933">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778938">p</span><span class="op" id="4778939">.</span><span class="ident" id="4778940">WriteString</span><span class="op" id="4778951">(</span><span class="ident" id="4778952">p</span><span class="op" id="4778953">.</span><span class="ident" id="4778954">createAttrPrefix</span><span class="op" id="4778970">(</span><span class="ident" id="4778971">name</span><span class="op" id="4778975">.</span><span class="ident" id="4778976">Space</span><span class="op" id="4778981">)</span><span class="op" id="4778982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4778987">p</span><span class="op" id="4778988">.</span><span class="ident" id="4778989">WriteByte</span><span class="op" id="4778998">(</span><span class="string" id="4778999">&#39;:&#39;</span><span class="op" id="4779002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4779006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779010">p</span><span class="op" id="4779011">.</span><span class="ident" id="4779012">WriteString</span><span class="op" id="4779023">(</span><span class="ident" id="4779024">name</span><span class="op" id="4779028">.</span><span class="ident" id="4779029">Local</span><span class="op" id="4779034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779038">p</span><span class="op" id="4779039">.</span><span class="ident" id="4779040">WriteString</span><span class="op" id="4779051">(</span><span class="string" id="4779052">`=&#34;`</span><span class="op" id="4779056">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779060">p</span><span class="op" id="4779061">.</span><span class="ident" id="4779062">EscapeString</span><span class="op" id="4779074">(</span><span class="ident" id="4779075">attr</span><span class="op" id="4779079">.</span><span class="ident" id="4779080">Value</span><span class="op" id="4779085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779089">p</span><span class="op" id="4779090">.</span><span class="ident" id="4779091">WriteByte</span><span class="op" id="4779100">(</span><span class="string" id="4779101">&#39;&#34;&#39;</span><span class="op" id="4779104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4779107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779110">p</span><span class="op" id="4779111">.</span><span class="ident" id="4779112">WriteByte</span><span class="op" id="4779121">(</span><span class="string" id="4779122">&#39;&gt;&#39;</span><span class="op" id="4779125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779128">return</span>&nbsp;<span class="builtintype" id="4779135">nil</span><br>
<span class="lineno">645</span><span class="op" id="4779139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4779142">func</span>&nbsp;<span class="op" id="4779147">(</span><span class="ident" id="4779148">p</span>&nbsp;<span class="op" id="4779150">*</span><span class="ident" id="4779151">printer</span><span class="op" id="4779158">)</span>&nbsp;<span class="ident" id="4779160">writeEnd</span><span class="op" id="4779168">(</span><span class="ident" id="4779169">name</span>&nbsp;<span class="ident" id="4779174">Name</span><span class="op" id="4779178">)</span>&nbsp;<span class="builtintype" id="4779180">error</span>&nbsp;<span class="op" id="4779186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779189">if</span>&nbsp;<span class="ident" id="4779192">name</span><span class="op" id="4779196">.</span><span class="ident" id="4779197">Local</span>&nbsp;<span class="op" id="4779203">==</span>&nbsp;<span class="string" id="4779206">&#34;&#34;</span>&nbsp;<span class="op" id="4779209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779213">return</span>&nbsp;<span class="ident" id="4779220">fmt</span><span class="op" id="4779223">.</span><span class="ident" id="4779224">Errorf</span><span class="op" id="4779230">(</span><span class="string" id="4779231">&#34;xml:&nbsp;end&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="4779258">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4779261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779264">if</span>&nbsp;<span class="builtinfunc" id="4779267">len</span><span class="op" id="4779270">(</span><span class="ident" id="4779271">p</span><span class="op" id="4779272">.</span><span class="ident" id="4779273">tags</span><span class="op" id="4779277">)</span>&nbsp;<span class="op" id="4779279">==</span>&nbsp;<span class="num" id="4779282">0</span>&nbsp;<span class="op" id="4779284">||</span>&nbsp;<span class="ident" id="4779287">p</span><span class="op" id="4779288">.</span><span class="ident" id="4779289">tags</span><span class="op" id="4779293">[</span><span class="builtinfunc" id="4779294">len</span><span class="op" id="4779297">(</span><span class="ident" id="4779298">p</span><span class="op" id="4779299">.</span><span class="ident" id="4779300">tags</span><span class="op" id="4779304">)</span><span class="op" id="4779305">-</span><span class="num" id="4779306">1</span><span class="op" id="4779307">]</span><span class="op" id="4779308">.</span><span class="ident" id="4779309">Local</span>&nbsp;<span class="op" id="4779315">==</span>&nbsp;<span class="string" id="4779318">&#34;&#34;</span>&nbsp;<span class="op" id="4779321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779325">return</span>&nbsp;<span class="ident" id="4779332">fmt</span><span class="op" id="4779335">.</span><span class="ident" id="4779336">Errorf</span><span class="op" id="4779342">(</span><span class="string" id="4779343">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;without&nbsp;start&nbsp;tag&#34;</span><span class="op" id="4779381">,</span>&nbsp;<span class="ident" id="4779383">name</span><span class="op" id="4779387">.</span><span class="ident" id="4779388">Local</span><span class="op" id="4779393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4779396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779399">if</span>&nbsp;<span class="ident" id="4779402">top</span>&nbsp;<span class="op" id="4779406">:=</span>&nbsp;<span class="ident" id="4779409">p</span><span class="op" id="4779410">.</span><span class="ident" id="4779411">tags</span><span class="op" id="4779415">[</span><span class="builtinfunc" id="4779416">len</span><span class="op" id="4779419">(</span><span class="ident" id="4779420">p</span><span class="op" id="4779421">.</span><span class="ident" id="4779422">tags</span><span class="op" id="4779426">)</span><span class="op" id="4779427">-</span><span class="num" id="4779428">1</span><span class="op" id="4779429">]</span><span class="op" id="4779430">;</span>&nbsp;<span class="ident" id="4779432">top</span>&nbsp;<span class="op" id="4779436">!=</span>&nbsp;<span class="ident" id="4779439">name</span>&nbsp;<span class="op" id="4779444">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779448">if</span>&nbsp;<span class="ident" id="4779451">top</span><span class="op" id="4779454">.</span><span class="ident" id="4779455">Local</span>&nbsp;<span class="op" id="4779461">!=</span>&nbsp;<span class="ident" id="4779464">name</span><span class="op" id="4779468">.</span><span class="ident" id="4779469">Local</span>&nbsp;<span class="op" id="4779475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779480">return</span>&nbsp;<span class="ident" id="4779487">fmt</span><span class="op" id="4779490">.</span><span class="ident" id="4779491">Errorf</span><span class="op" id="4779497">(</span><span class="string" id="4779498">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="4779548">,</span>&nbsp;<span class="ident" id="4779550">name</span><span class="op" id="4779554">.</span><span class="ident" id="4779555">Local</span><span class="op" id="4779560">,</span>&nbsp;<span class="ident" id="4779562">top</span><span class="op" id="4779565">.</span><span class="ident" id="4779566">Local</span><span class="op" id="4779571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4779575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779579">return</span>&nbsp;<span class="ident" id="4779586">fmt</span><span class="op" id="4779589">.</span><span class="ident" id="4779590">Errorf</span><span class="op" id="4779596">(</span><span class="string" id="4779597">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&#34;</span><span class="op" id="4779679">,</span>&nbsp;<span class="ident" id="4779681">name</span><span class="op" id="4779685">.</span><span class="ident" id="4779686">Local</span><span class="op" id="4779691">,</span>&nbsp;<span class="ident" id="4779693">name</span><span class="op" id="4779697">.</span><span class="ident" id="4779698">Space</span><span class="op" id="4779703">,</span>&nbsp;<span class="ident" id="4779705">top</span><span class="op" id="4779708">.</span><span class="ident" id="4779709">Local</span><span class="op" id="4779714">,</span>&nbsp;<span class="ident" id="4779716">top</span><span class="op" id="4779719">.</span><span class="ident" id="4779720">Space</span><span class="op" id="4779725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4779728">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779731">p</span><span class="op" id="4779732">.</span><span class="ident" id="4779733">tags</span>&nbsp;<span class="op" id="4779738">=</span>&nbsp;<span class="ident" id="4779740">p</span><span class="op" id="4779741">.</span><span class="ident" id="4779742">tags</span><span class="op" id="4779746">[</span><span class="op" id="4779747">:</span><span class="builtinfunc" id="4779748">len</span><span class="op" id="4779751">(</span><span class="ident" id="4779752">p</span><span class="op" id="4779753">.</span><span class="ident" id="4779754">tags</span><span class="op" id="4779758">)</span><span class="op" id="4779759">-</span><span class="num" id="4779760">1</span><span class="op" id="4779761">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779765">p</span><span class="op" id="4779766">.</span><span class="ident" id="4779767">writeIndent</span><span class="op" id="4779778">(</span><span class="op" id="4779779">-</span><span class="num" id="4779780">1</span><span class="op" id="4779781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779784">p</span><span class="op" id="4779785">.</span><span class="ident" id="4779786">WriteByte</span><span class="op" id="4779795">(</span><span class="string" id="4779796">&#39;&lt;&#39;</span><span class="op" id="4779799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779802">p</span><span class="op" id="4779803">.</span><span class="ident" id="4779804">WriteByte</span><span class="op" id="4779813">(</span><span class="string" id="4779814">&#39;/&#39;</span><span class="op" id="4779817">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779820">p</span><span class="op" id="4779821">.</span><span class="ident" id="4779822">WriteString</span><span class="op" id="4779833">(</span><span class="ident" id="4779834">name</span><span class="op" id="4779838">.</span><span class="ident" id="4779839">Local</span><span class="op" id="4779844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779847">p</span><span class="op" id="4779848">.</span><span class="ident" id="4779849">WriteByte</span><span class="op" id="4779858">(</span><span class="string" id="4779859">&#39;&gt;&#39;</span><span class="op" id="4779862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4779865">p</span><span class="op" id="4779866">.</span><span class="ident" id="4779867">popPrefix</span><span class="op" id="4779876">(</span><span class="op" id="4779877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779880">return</span>&nbsp;<span class="builtintype" id="4779887">nil</span><br>
<span class="lineno"></span><span class="op" id="4779891">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="4779894">func</span>&nbsp;<span class="op" id="4779899">(</span><span class="ident" id="4779900">p</span>&nbsp;<span class="op" id="4779902">*</span><span class="ident" id="4779903">printer</span><span class="op" id="4779910">)</span>&nbsp;<span class="ident" id="4779912">marshalSimple</span><span class="op" id="4779925">(</span><span class="ident" id="4779926">typ</span>&nbsp;<span class="ident" id="4779930">reflect</span><span class="op" id="4779937">.</span><span class="ident" id="4779938">Type</span><span class="op" id="4779942">,</span>&nbsp;<span class="ident" id="4779944">val</span>&nbsp;<span class="ident" id="4779948">reflect</span><span class="op" id="4779955">.</span><span class="ident" id="4779956">Value</span><span class="op" id="4779961">)</span>&nbsp;<span class="op" id="4779963">(</span><span class="builtintype" id="4779964">string</span><span class="op" id="4779970">,</span>&nbsp;<span class="op" id="4779972">[</span><span class="op" id="4779973">]</span><span class="builtintype" id="4779974">byte</span><span class="op" id="4779978">,</span>&nbsp;<span class="builtintype" id="4779980">error</span><span class="op" id="4779985">)</span>&nbsp;<span class="op" id="4779987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4779990">switch</span>&nbsp;<span class="ident" id="4779997">val</span><span class="op" id="4780000">.</span><span class="ident" id="4780001">Kind</span><span class="op" id="4780005">(</span><span class="op" id="4780006">)</span>&nbsp;<span class="op" id="4780008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780011">case</span>&nbsp;<span class="ident" id="4780016">reflect</span><span class="op" id="4780023">.</span><span class="ident" id="4780024">Int</span><span class="op" id="4780027">,</span>&nbsp;<span class="ident" id="4780029">reflect</span><span class="op" id="4780036">.</span><span class="ident" id="4780037">Int8</span><span class="op" id="4780041">,</span>&nbsp;<span class="ident" id="4780043">reflect</span><span class="op" id="4780050">.</span><span class="ident" id="4780051">Int16</span><span class="op" id="4780056">,</span>&nbsp;<span class="ident" id="4780058">reflect</span><span class="op" id="4780065">.</span><span class="ident" id="4780066">Int32</span><span class="op" id="4780071">,</span>&nbsp;<span class="ident" id="4780073">reflect</span><span class="op" id="4780080">.</span><span class="ident" id="4780081">Int64</span><span class="op" id="4780086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780090">return</span>&nbsp;<span class="ident" id="4780097">strconv</span><span class="op" id="4780104">.</span><span class="ident" id="4780105">FormatInt</span><span class="op" id="4780114">(</span><span class="ident" id="4780115">val</span><span class="op" id="4780118">.</span><span class="ident" id="4780119">Int</span><span class="op" id="4780122">(</span><span class="op" id="4780123">)</span><span class="op" id="4780124">,</span>&nbsp;<span class="num" id="4780126">10</span><span class="op" id="4780128">)</span><span class="op" id="4780129">,</span>&nbsp;<span class="builtintype" id="4780131">nil</span><span class="op" id="4780134">,</span>&nbsp;<span class="builtintype" id="4780136">nil</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780141">case</span>&nbsp;<span class="ident" id="4780146">reflect</span><span class="op" id="4780153">.</span><span class="ident" id="4780154">Uint</span><span class="op" id="4780158">,</span>&nbsp;<span class="ident" id="4780160">reflect</span><span class="op" id="4780167">.</span><span class="ident" id="4780168">Uint8</span><span class="op" id="4780173">,</span>&nbsp;<span class="ident" id="4780175">reflect</span><span class="op" id="4780182">.</span><span class="ident" id="4780183">Uint16</span><span class="op" id="4780189">,</span>&nbsp;<span class="ident" id="4780191">reflect</span><span class="op" id="4780198">.</span><span class="ident" id="4780199">Uint32</span><span class="op" id="4780205">,</span>&nbsp;<span class="ident" id="4780207">reflect</span><span class="op" id="4780214">.</span><span class="ident" id="4780215">Uint64</span><span class="op" id="4780221">,</span>&nbsp;<span class="ident" id="4780223">reflect</span><span class="op" id="4780230">.</span><span class="ident" id="4780231">Uintptr</span><span class="op" id="4780238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780242">return</span>&nbsp;<span class="ident" id="4780249">strconv</span><span class="op" id="4780256">.</span><span class="ident" id="4780257">FormatUint</span><span class="op" id="4780267">(</span><span class="ident" id="4780268">val</span><span class="op" id="4780271">.</span><span class="ident" id="4780272">Uint</span><span class="op" id="4780276">(</span><span class="op" id="4780277">)</span><span class="op" id="4780278">,</span>&nbsp;<span class="num" id="4780280">10</span><span class="op" id="4780282">)</span><span class="op" id="4780283">,</span>&nbsp;<span class="builtintype" id="4780285">nil</span><span class="op" id="4780288">,</span>&nbsp;<span class="builtintype" id="4780290">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780295">case</span>&nbsp;<span class="ident" id="4780300">reflect</span><span class="op" id="4780307">.</span><span class="ident" id="4780308">Float32</span><span class="op" id="4780315">,</span>&nbsp;<span class="ident" id="4780317">reflect</span><span class="op" id="4780324">.</span><span class="ident" id="4780325">Float64</span><span class="op" id="4780332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780336">return</span>&nbsp;<span class="ident" id="4780343">strconv</span><span class="op" id="4780350">.</span><span class="ident" id="4780351">FormatFloat</span><span class="op" id="4780362">(</span><span class="ident" id="4780363">val</span><span class="op" id="4780366">.</span><span class="ident" id="4780367">Float</span><span class="op" id="4780372">(</span><span class="op" id="4780373">)</span><span class="op" id="4780374">,</span>&nbsp;<span class="string" id="4780376">&#39;g&#39;</span><span class="op" id="4780379">,</span>&nbsp;<span class="op" id="4780381">-</span><span class="num" id="4780382">1</span><span class="op" id="4780383">,</span>&nbsp;<span class="ident" id="4780385">val</span><span class="op" id="4780388">.</span><span class="ident" id="4780389">Type</span><span class="op" id="4780393">(</span><span class="op" id="4780394">)</span><span class="op" id="4780395">.</span><span class="ident" id="4780396">Bits</span><span class="op" id="4780400">(</span><span class="op" id="4780401">)</span><span class="op" id="4780402">)</span><span class="op" id="4780403">,</span>&nbsp;<span class="builtintype" id="4780405">nil</span><span class="op" id="4780408">,</span>&nbsp;<span class="builtintype" id="4780410">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780415">case</span>&nbsp;<span class="ident" id="4780420">reflect</span><span class="op" id="4780427">.</span><span class="ident" id="4780428">String</span><span class="op" id="4780434">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780438">return</span>&nbsp;<span class="ident" id="4780445">val</span><span class="op" id="4780448">.</span><span class="ident" id="4780449">String</span><span class="op" id="4780455">(</span><span class="op" id="4780456">)</span><span class="op" id="4780457">,</span>&nbsp;<span class="builtintype" id="4780459">nil</span><span class="op" id="4780462">,</span>&nbsp;<span class="builtintype" id="4780464">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780469">case</span>&nbsp;<span class="ident" id="4780474">reflect</span><span class="op" id="4780481">.</span><span class="ident" id="4780482">Bool</span><span class="op" id="4780486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780490">return</span>&nbsp;<span class="ident" id="4780497">strconv</span><span class="op" id="4780504">.</span><span class="ident" id="4780505">FormatBool</span><span class="op" id="4780515">(</span><span class="ident" id="4780516">val</span><span class="op" id="4780519">.</span><span class="ident" id="4780520">Bool</span><span class="op" id="4780524">(</span><span class="op" id="4780525">)</span><span class="op" id="4780526">)</span><span class="op" id="4780527">,</span>&nbsp;<span class="builtintype" id="4780529">nil</span><span class="op" id="4780532">,</span>&nbsp;<span class="builtintype" id="4780534">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780539">case</span>&nbsp;<span class="ident" id="4780544">reflect</span><span class="op" id="4780551">.</span><span class="ident" id="4780552">Array</span><span class="op" id="4780557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780561">if</span>&nbsp;<span class="ident" id="4780564">typ</span><span class="op" id="4780567">.</span><span class="ident" id="4780568">Elem</span><span class="op" id="4780572">(</span><span class="op" id="4780573">)</span><span class="op" id="4780574">.</span><span class="ident" id="4780575">Kind</span><span class="op" id="4780579">(</span><span class="op" id="4780580">)</span>&nbsp;<span class="op" id="4780582">!=</span>&nbsp;<span class="ident" id="4780585">reflect</span><span class="op" id="4780592">.</span><span class="ident" id="4780593">Uint8</span>&nbsp;<span class="op" id="4780599">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780604">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4780612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4780616">//&nbsp;[...]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780631">var</span>&nbsp;<span class="ident" id="4780635">bytes</span>&nbsp;<span class="op" id="4780641">[</span><span class="op" id="4780642">]</span><span class="builtintype" id="4780643">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780650">if</span>&nbsp;<span class="ident" id="4780653">val</span><span class="op" id="4780656">.</span><span class="ident" id="4780657">CanAddr</span><span class="op" id="4780664">(</span><span class="op" id="4780665">)</span>&nbsp;<span class="op" id="4780667">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4780672">bytes</span>&nbsp;<span class="op" id="4780678">=</span>&nbsp;<span class="ident" id="4780680">val</span><span class="op" id="4780683">.</span><span class="ident" id="4780684">Slice</span><span class="op" id="4780689">(</span><span class="num" id="4780690">0</span><span class="op" id="4780691">,</span>&nbsp;<span class="ident" id="4780693">val</span><span class="op" id="4780696">.</span><span class="ident" id="4780697">Len</span><span class="op" id="4780700">(</span><span class="op" id="4780701">)</span><span class="op" id="4780702">)</span><span class="op" id="4780703">.</span><span class="ident" id="4780704">Bytes</span><span class="op" id="4780709">(</span><span class="op" id="4780710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4780714">}</span>&nbsp;<span class="keyword" id="4780716">else</span>&nbsp;<span class="op" id="4780721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4780726">bytes</span>&nbsp;<span class="op" id="4780732">=</span>&nbsp;<span class="builtinfunc" id="4780734">make</span><span class="op" id="4780738">(</span><span class="op" id="4780739">[</span><span class="op" id="4780740">]</span><span class="builtintype" id="4780741">byte</span><span class="op" id="4780745">,</span>&nbsp;<span class="ident" id="4780747">val</span><span class="op" id="4780750">.</span><span class="ident" id="4780751">Len</span><span class="op" id="4780754">(</span><span class="op" id="4780755">)</span><span class="op" id="4780756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4780761">reflect</span><span class="op" id="4780768">.</span><span class="ident" id="4780769">Copy</span><span class="op" id="4780773">(</span><span class="ident" id="4780774">reflect</span><span class="op" id="4780781">.</span><span class="ident" id="4780782">ValueOf</span><span class="op" id="4780789">(</span><span class="ident" id="4780790">bytes</span><span class="op" id="4780795">)</span><span class="op" id="4780796">,</span>&nbsp;<span class="ident" id="4780798">val</span><span class="op" id="4780801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4780805">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780809">return</span>&nbsp;<span class="string" id="4780816">&#34;&#34;</span><span class="op" id="4780818">,</span>&nbsp;<span class="ident" id="4780820">bytes</span><span class="op" id="4780825">,</span>&nbsp;<span class="builtintype" id="4780827">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780832">case</span>&nbsp;<span class="ident" id="4780837">reflect</span><span class="op" id="4780844">.</span><span class="ident" id="4780845">Slice</span><span class="op" id="4780850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780854">if</span>&nbsp;<span class="ident" id="4780857">typ</span><span class="op" id="4780860">.</span><span class="ident" id="4780861">Elem</span><span class="op" id="4780865">(</span><span class="op" id="4780866">)</span><span class="op" id="4780867">.</span><span class="ident" id="4780868">Kind</span><span class="op" id="4780872">(</span><span class="op" id="4780873">)</span>&nbsp;<span class="op" id="4780875">!=</span>&nbsp;<span class="ident" id="4780878">reflect</span><span class="op" id="4780885">.</span><span class="ident" id="4780886">Uint8</span>&nbsp;<span class="op" id="4780892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780897">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4780905">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4780909">//&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780921">return</span>&nbsp;<span class="string" id="4780928">&#34;&#34;</span><span class="op" id="4780930">,</span>&nbsp;<span class="ident" id="4780932">val</span><span class="op" id="4780935">.</span><span class="ident" id="4780936">Bytes</span><span class="op" id="4780941">(</span><span class="op" id="4780942">)</span><span class="op" id="4780943">,</span>&nbsp;<span class="builtintype" id="4780945">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4780950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4780953">return</span>&nbsp;<span class="string" id="4780960">&#34;&#34;</span><span class="op" id="4780962">,</span>&nbsp;<span class="builtintype" id="4780964">nil</span><span class="op" id="4780967">,</span>&nbsp;<span class="op" id="4780969">&amp;</span><span class="ident" id="4780970">UnsupportedTypeError</span><span class="op" id="4780990">{</span><span class="ident" id="4780991">typ</span><span class="op" id="4780994">}</span><br>
<span class="lineno"></span><span class="op" id="4780996">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="4780999">var</span>&nbsp;<span class="ident" id="4781003">ddBytes</span>&nbsp;<span class="op" id="4781011">=</span>&nbsp;<span class="op" id="4781013">[</span><span class="op" id="4781014">]</span><span class="builtintype" id="4781015">byte</span><span class="op" id="4781019">(</span><span class="string" id="4781020">&#34;--&#34;</span><span class="op" id="4781024">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4781027">func</span>&nbsp;<span class="op" id="4781032">(</span><span class="ident" id="4781033">p</span>&nbsp;<span class="op" id="4781035">*</span><span class="ident" id="4781036">printer</span><span class="op" id="4781043">)</span>&nbsp;<span class="ident" id="4781045">marshalStruct</span><span class="op" id="4781058">(</span><span class="ident" id="4781059">tinfo</span>&nbsp;<span class="op" id="4781065">*</span><span class="ident" id="4781066">typeInfo</span><span class="op" id="4781074">,</span>&nbsp;<span class="ident" id="4781076">val</span>&nbsp;<span class="ident" id="4781080">reflect</span><span class="op" id="4781087">.</span><span class="ident" id="4781088">Value</span><span class="op" id="4781093">)</span>&nbsp;<span class="builtintype" id="4781095">error</span>&nbsp;<span class="op" id="4781101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781104">s</span>&nbsp;<span class="op" id="4781106">:=</span>&nbsp;<span class="ident" id="4781109">parentStack</span><span class="op" id="4781120">{</span><span class="ident" id="4781121">p</span><span class="op" id="4781122">:</span>&nbsp;<span class="ident" id="4781124">p</span><span class="op" id="4781125">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781128">for</span>&nbsp;<span class="ident" id="4781132">i</span>&nbsp;<span class="op" id="4781134">:=</span>&nbsp;<span class="keyword" id="4781137">range</span>&nbsp;<span class="ident" id="4781143">tinfo</span><span class="op" id="4781148">.</span><span class="ident" id="4781149">fields</span>&nbsp;<span class="op" id="4781156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781160">finfo</span>&nbsp;<span class="op" id="4781166">:=</span>&nbsp;<span class="op" id="4781169">&amp;</span><span class="ident" id="4781170">tinfo</span><span class="op" id="4781175">.</span><span class="ident" id="4781176">fields</span><span class="op" id="4781182">[</span><span class="ident" id="4781183">i</span><span class="op" id="4781184">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781188">if</span>&nbsp;<span class="ident" id="4781191">finfo</span><span class="op" id="4781196">.</span><span class="ident" id="4781197">flags</span><span class="op" id="4781202">&amp;</span><span class="ident" id="4781203">fAttr</span>&nbsp;<span class="op" id="4781209">!=</span>&nbsp;<span class="num" id="4781212">0</span>&nbsp;<span class="op" id="4781214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781219">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781230">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781234">vf</span>&nbsp;<span class="op" id="4781237">:=</span>&nbsp;<span class="ident" id="4781240">finfo</span><span class="op" id="4781245">.</span><span class="ident" id="4781246">value</span><span class="op" id="4781251">(</span><span class="ident" id="4781252">val</span><span class="op" id="4781255">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4781260">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781316">switch</span>&nbsp;<span class="ident" id="4781323">vf</span><span class="op" id="4781325">.</span><span class="ident" id="4781326">Kind</span><span class="op" id="4781330">(</span><span class="op" id="4781331">)</span>&nbsp;<span class="op" id="4781333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781337">case</span>&nbsp;<span class="ident" id="4781342">reflect</span><span class="op" id="4781349">.</span><span class="ident" id="4781350">Ptr</span><span class="op" id="4781353">,</span>&nbsp;<span class="ident" id="4781355">reflect</span><span class="op" id="4781362">.</span><span class="ident" id="4781363">Interface</span><span class="op" id="4781372">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781377">if</span>&nbsp;<span class="op" id="4781380">!</span><span class="ident" id="4781381">vf</span><span class="op" id="4781383">.</span><span class="ident" id="4781384">IsNil</span><span class="op" id="4781389">(</span><span class="op" id="4781390">)</span>&nbsp;<span class="op" id="4781392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781398">vf</span>&nbsp;<span class="op" id="4781401">=</span>&nbsp;<span class="ident" id="4781403">vf</span><span class="op" id="4781405">.</span><span class="ident" id="4781406">Elem</span><span class="op" id="4781410">(</span><span class="op" id="4781411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781425">switch</span>&nbsp;<span class="ident" id="4781432">finfo</span><span class="op" id="4781437">.</span><span class="ident" id="4781438">flags</span>&nbsp;<span class="op" id="4781444">&amp;</span>&nbsp;<span class="ident" id="4781446">fMode</span>&nbsp;<span class="op" id="4781452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781456">case</span>&nbsp;<span class="ident" id="4781461">fCharData</span><span class="op" id="4781470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781475">if</span>&nbsp;<span class="ident" id="4781478">vf</span><span class="op" id="4781480">.</span><span class="ident" id="4781481">CanInterface</span><span class="op" id="4781493">(</span><span class="op" id="4781494">)</span>&nbsp;<span class="op" id="4781496">&amp;&amp;</span>&nbsp;<span class="ident" id="4781499">vf</span><span class="op" id="4781501">.</span><span class="ident" id="4781502">Type</span><span class="op" id="4781506">(</span><span class="op" id="4781507">)</span><span class="op" id="4781508">.</span><span class="ident" id="4781509">Implements</span><span class="op" id="4781519">(</span><span class="ident" id="4781520">textMarshalerType</span><span class="op" id="4781537">)</span>&nbsp;<span class="op" id="4781539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781545">data</span><span class="op" id="4781549">,</span>&nbsp;<span class="ident" id="4781551">err</span>&nbsp;<span class="op" id="4781555">:=</span>&nbsp;<span class="ident" id="4781558">vf</span><span class="op" id="4781560">.</span><span class="ident" id="4781561">Interface</span><span class="op" id="4781570">(</span><span class="op" id="4781571">)</span><span class="op" id="4781572">.</span><span class="op" id="4781573">(</span><span class="ident" id="4781574">encoding</span><span class="op" id="4781582">.</span><span class="ident" id="4781583">TextMarshaler</span><span class="op" id="4781596">)</span><span class="op" id="4781597">.</span><span class="ident" id="4781598">MarshalText</span><span class="op" id="4781609">(</span><span class="op" id="4781610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781616">if</span>&nbsp;<span class="ident" id="4781619">err</span>&nbsp;<span class="op" id="4781623">!=</span>&nbsp;<span class="builtintype" id="4781626">nil</span>&nbsp;<span class="op" id="4781630">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781637">return</span>&nbsp;<span class="ident" id="4781644">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781658">Escape</span><span class="op" id="4781664">(</span><span class="ident" id="4781665">p</span><span class="op" id="4781666">,</span>&nbsp;<span class="ident" id="4781668">data</span><span class="op" id="4781672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781678">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781690">}</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781695">if</span>&nbsp;<span class="ident" id="4781698">vf</span><span class="op" id="4781700">.</span><span class="ident" id="4781701">CanAddr</span><span class="op" id="4781708">(</span><span class="op" id="4781709">)</span>&nbsp;<span class="op" id="4781711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781717">pv</span>&nbsp;<span class="op" id="4781720">:=</span>&nbsp;<span class="ident" id="4781723">vf</span><span class="op" id="4781725">.</span><span class="ident" id="4781726">Addr</span><span class="op" id="4781730">(</span><span class="op" id="4781731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781737">if</span>&nbsp;<span class="ident" id="4781740">pv</span><span class="op" id="4781742">.</span><span class="ident" id="4781743">CanInterface</span><span class="op" id="4781755">(</span><span class="op" id="4781756">)</span>&nbsp;<span class="op" id="4781758">&amp;&amp;</span>&nbsp;<span class="ident" id="4781761">pv</span><span class="op" id="4781763">.</span><span class="ident" id="4781764">Type</span><span class="op" id="4781768">(</span><span class="op" id="4781769">)</span><span class="op" id="4781770">.</span><span class="ident" id="4781771">Implements</span><span class="op" id="4781781">(</span><span class="ident" id="4781782">textMarshalerType</span><span class="op" id="4781799">)</span>&nbsp;<span class="op" id="4781801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781808">data</span><span class="op" id="4781812">,</span>&nbsp;<span class="ident" id="4781814">err</span>&nbsp;<span class="op" id="4781818">:=</span>&nbsp;<span class="ident" id="4781821">pv</span><span class="op" id="4781823">.</span><span class="ident" id="4781824">Interface</span><span class="op" id="4781833">(</span><span class="op" id="4781834">)</span><span class="op" id="4781835">.</span><span class="op" id="4781836">(</span><span class="ident" id="4781837">encoding</span><span class="op" id="4781845">.</span><span class="ident" id="4781846">TextMarshaler</span><span class="op" id="4781859">)</span><span class="op" id="4781860">.</span><span class="ident" id="4781861">MarshalText</span><span class="op" id="4781872">(</span><span class="op" id="4781873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781880">if</span>&nbsp;<span class="ident" id="4781883">err</span>&nbsp;<span class="op" id="4781887">!=</span>&nbsp;<span class="builtintype" id="4781890">nil</span>&nbsp;<span class="op" id="4781894">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781902">return</span>&nbsp;<span class="ident" id="4781909">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4781925">Escape</span><span class="op" id="4781931">(</span><span class="ident" id="4781932">p</span><span class="op" id="4781933">,</span>&nbsp;<span class="ident" id="4781935">data</span><span class="op" id="4781939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781946">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781959">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4781964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781969">var</span>&nbsp;<span class="ident" id="4781973">scratch</span>&nbsp;<span class="op" id="4781981">[</span><span class="num" id="4781982">64</span><span class="op" id="4781984">]</span><span class="builtintype" id="4781985">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4781993">switch</span>&nbsp;<span class="ident" id="4782000">vf</span><span class="op" id="4782002">.</span><span class="ident" id="4782003">Kind</span><span class="op" id="4782007">(</span><span class="op" id="4782008">)</span>&nbsp;<span class="op" id="4782010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782015">case</span>&nbsp;<span class="ident" id="4782020">reflect</span><span class="op" id="4782027">.</span><span class="ident" id="4782028">Int</span><span class="op" id="4782031">,</span>&nbsp;<span class="ident" id="4782033">reflect</span><span class="op" id="4782040">.</span><span class="ident" id="4782041">Int8</span><span class="op" id="4782045">,</span>&nbsp;<span class="ident" id="4782047">reflect</span><span class="op" id="4782054">.</span><span class="ident" id="4782055">Int16</span><span class="op" id="4782060">,</span>&nbsp;<span class="ident" id="4782062">reflect</span><span class="op" id="4782069">.</span><span class="ident" id="4782070">Int32</span><span class="op" id="4782075">,</span>&nbsp;<span class="ident" id="4782077">reflect</span><span class="op" id="4782084">.</span><span class="ident" id="4782085">Int64</span><span class="op" id="4782090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4782096">Escape</span><span class="op" id="4782102">(</span><span class="ident" id="4782103">p</span><span class="op" id="4782104">,</span>&nbsp;<span class="ident" id="4782106">strconv</span><span class="op" id="4782113">.</span><span class="ident" id="4782114">AppendInt</span><span class="op" id="4782123">(</span><span class="ident" id="4782124">scratch</span><span class="op" id="4782131">[</span><span class="op" id="4782132">:</span><span class="num" id="4782133">0</span><span class="op" id="4782134">]</span><span class="op" id="4782135">,</span>&nbsp;<span class="ident" id="4782137">vf</span><span class="op" id="4782139">.</span><span class="ident" id="4782140">Int</span><span class="op" id="4782143">(</span><span class="op" id="4782144">)</span><span class="op" id="4782145">,</span>&nbsp;<span class="num" id="4782147">10</span><span class="op" id="4782149">)</span><span class="op" id="4782150">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782155">case</span>&nbsp;<span class="ident" id="4782160">reflect</span><span class="op" id="4782167">.</span><span class="ident" id="4782168">Uint</span><span class="op" id="4782172">,</span>&nbsp;<span class="ident" id="4782174">reflect</span><span class="op" id="4782181">.</span><span class="ident" id="4782182">Uint8</span><span class="op" id="4782187">,</span>&nbsp;<span class="ident" id="4782189">reflect</span><span class="op" id="4782196">.</span><span class="ident" id="4782197">Uint16</span><span class="op" id="4782203">,</span>&nbsp;<span class="ident" id="4782205">reflect</span><span class="op" id="4782212">.</span><span class="ident" id="4782213">Uint32</span><span class="op" id="4782219">,</span>&nbsp;<span class="ident" id="4782221">reflect</span><span class="op" id="4782228">.</span><span class="ident" id="4782229">Uint64</span><span class="op" id="4782235">,</span>&nbsp;<span class="ident" id="4782237">reflect</span><span class="op" id="4782244">.</span><span class="ident" id="4782245">Uintptr</span><span class="op" id="4782252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4782258">Escape</span><span class="op" id="4782264">(</span><span class="ident" id="4782265">p</span><span class="op" id="4782266">,</span>&nbsp;<span class="ident" id="4782268">strconv</span><span class="op" id="4782275">.</span><span class="ident" id="4782276">AppendUint</span><span class="op" id="4782286">(</span><span class="ident" id="4782287">scratch</span><span class="op" id="4782294">[</span><span class="op" id="4782295">:</span><span class="num" id="4782296">0</span><span class="op" id="4782297">]</span><span class="op" id="4782298">,</span>&nbsp;<span class="ident" id="4782300">vf</span><span class="op" id="4782302">.</span><span class="ident" id="4782303">Uint</span><span class="op" id="4782307">(</span><span class="op" id="4782308">)</span><span class="op" id="4782309">,</span>&nbsp;<span class="num" id="4782311">10</span><span class="op" id="4782313">)</span><span class="op" id="4782314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782319">case</span>&nbsp;<span class="ident" id="4782324">reflect</span><span class="op" id="4782331">.</span><span class="ident" id="4782332">Float32</span><span class="op" id="4782339">,</span>&nbsp;<span class="ident" id="4782341">reflect</span><span class="op" id="4782348">.</span><span class="ident" id="4782349">Float64</span><span class="op" id="4782356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4782362">Escape</span><span class="op" id="4782368">(</span><span class="ident" id="4782369">p</span><span class="op" id="4782370">,</span>&nbsp;<span class="ident" id="4782372">strconv</span><span class="op" id="4782379">.</span><span class="ident" id="4782380">AppendFloat</span><span class="op" id="4782391">(</span><span class="ident" id="4782392">scratch</span><span class="op" id="4782399">[</span><span class="op" id="4782400">:</span><span class="num" id="4782401">0</span><span class="op" id="4782402">]</span><span class="op" id="4782403">,</span>&nbsp;<span class="ident" id="4782405">vf</span><span class="op" id="4782407">.</span><span class="ident" id="4782408">Float</span><span class="op" id="4782413">(</span><span class="op" id="4782414">)</span><span class="op" id="4782415">,</span>&nbsp;<span class="string" id="4782417">&#39;g&#39;</span><span class="op" id="4782420">,</span>&nbsp;<span class="op" id="4782422">-</span><span class="num" id="4782423">1</span><span class="op" id="4782424">,</span>&nbsp;<span class="ident" id="4782426">vf</span><span class="op" id="4782428">.</span><span class="ident" id="4782429">Type</span><span class="op" id="4782433">(</span><span class="op" id="4782434">)</span><span class="op" id="4782435">.</span><span class="ident" id="4782436">Bits</span><span class="op" id="4782440">(</span><span class="op" id="4782441">)</span><span class="op" id="4782442">)</span><span class="op" id="4782443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782448">case</span>&nbsp;<span class="ident" id="4782453">reflect</span><span class="op" id="4782460">.</span><span class="ident" id="4782461">Bool</span><span class="op" id="4782465">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4782471">Escape</span><span class="op" id="4782477">(</span><span class="ident" id="4782478">p</span><span class="op" id="4782479">,</span>&nbsp;<span class="ident" id="4782481">strconv</span><span class="op" id="4782488">.</span><span class="ident" id="4782489">AppendBool</span><span class="op" id="4782499">(</span><span class="ident" id="4782500">scratch</span><span class="op" id="4782507">[</span><span class="op" id="4782508">:</span><span class="num" id="4782509">0</span><span class="op" id="4782510">]</span><span class="op" id="4782511">,</span>&nbsp;<span class="ident" id="4782513">vf</span><span class="op" id="4782515">.</span><span class="ident" id="4782516">Bool</span><span class="op" id="4782520">(</span><span class="op" id="4782521">)</span><span class="op" id="4782522">)</span><span class="op" id="4782523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782528">case</span>&nbsp;<span class="ident" id="4782533">reflect</span><span class="op" id="4782540">.</span><span class="ident" id="4782541">String</span><span class="op" id="4782547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782553">if</span>&nbsp;<span class="ident" id="4782556">err</span>&nbsp;<span class="op" id="4782560">:=</span>&nbsp;<span class="ident" id="4782563">EscapeText</span><span class="op" id="4782573">(</span><span class="ident" id="4782574">p</span><span class="op" id="4782575">,</span>&nbsp;<span class="op" id="4782577">[</span><span class="op" id="4782578">]</span><span class="builtintype" id="4782579">byte</span><span class="op" id="4782583">(</span><span class="ident" id="4782584">vf</span><span class="op" id="4782586">.</span><span class="ident" id="4782587">String</span><span class="op" id="4782593">(</span><span class="op" id="4782594">)</span><span class="op" id="4782595">)</span><span class="op" id="4782596">)</span><span class="op" id="4782597">;</span>&nbsp;<span class="ident" id="4782599">err</span>&nbsp;<span class="op" id="4782603">!=</span>&nbsp;<span class="builtintype" id="4782606">nil</span>&nbsp;<span class="op" id="4782610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782617">return</span>&nbsp;<span class="ident" id="4782624">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4782632">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782637">case</span>&nbsp;<span class="ident" id="4782642">reflect</span><span class="op" id="4782649">.</span><span class="ident" id="4782650">Slice</span><span class="op" id="4782655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782661">if</span>&nbsp;<span class="ident" id="4782664">elem</span><span class="op" id="4782668">,</span>&nbsp;<span class="ident" id="4782670">ok</span>&nbsp;<span class="op" id="4782673">:=</span>&nbsp;<span class="ident" id="4782676">vf</span><span class="op" id="4782678">.</span><span class="ident" id="4782679">Interface</span><span class="op" id="4782688">(</span><span class="op" id="4782689">)</span><span class="op" id="4782690">.</span><span class="op" id="4782691">(</span><span class="op" id="4782692">[</span><span class="op" id="4782693">]</span><span class="builtintype" id="4782694">byte</span><span class="op" id="4782698">)</span><span class="op" id="4782699">;</span>&nbsp;<span class="ident" id="4782701">ok</span>&nbsp;<span class="op" id="4782704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782711">if</span>&nbsp;<span class="ident" id="4782714">err</span>&nbsp;<span class="op" id="4782718">:=</span>&nbsp;<span class="ident" id="4782721">EscapeText</span><span class="op" id="4782731">(</span><span class="ident" id="4782732">p</span><span class="op" id="4782733">,</span>&nbsp;<span class="ident" id="4782735">elem</span><span class="op" id="4782739">)</span><span class="op" id="4782740">;</span>&nbsp;<span class="ident" id="4782742">err</span>&nbsp;<span class="op" id="4782746">!=</span>&nbsp;<span class="builtintype" id="4782749">nil</span>&nbsp;<span class="op" id="4782753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782761">return</span>&nbsp;<span class="ident" id="4782768">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4782777">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4782783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4782788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782793">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782805">case</span>&nbsp;<span class="ident" id="4782810">fComment</span><span class="op" id="4782818">:</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4782823">k</span>&nbsp;<span class="op" id="4782825">:=</span>&nbsp;<span class="ident" id="4782828">vf</span><span class="op" id="4782830">.</span><span class="ident" id="4782831">Kind</span><span class="op" id="4782835">(</span><span class="op" id="4782836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782841">if</span>&nbsp;<span class="op" id="4782844">!</span><span class="op" id="4782845">(</span><span class="ident" id="4782846">k</span>&nbsp;<span class="op" id="4782848">==</span>&nbsp;<span class="ident" id="4782851">reflect</span><span class="op" id="4782858">.</span><span class="ident" id="4782859">String</span>&nbsp;<span class="op" id="4782866">||</span>&nbsp;<span class="ident" id="4782869">k</span>&nbsp;<span class="op" id="4782871">==</span>&nbsp;<span class="ident" id="4782874">reflect</span><span class="op" id="4782881">.</span><span class="ident" id="4782882">Slice</span>&nbsp;<span class="op" id="4782888">&amp;&amp;</span>&nbsp;<span class="ident" id="4782891">vf</span><span class="op" id="4782893">.</span><span class="ident" id="4782894">Type</span><span class="op" id="4782898">(</span><span class="op" id="4782899">)</span><span class="op" id="4782900">.</span><span class="ident" id="4782901">Elem</span><span class="op" id="4782905">(</span><span class="op" id="4782906">)</span><span class="op" id="4782907">.</span><span class="ident" id="4782908">Kind</span><span class="op" id="4782912">(</span><span class="op" id="4782913">)</span>&nbsp;<span class="op" id="4782915">==</span>&nbsp;<span class="ident" id="4782918">reflect</span><span class="op" id="4782925">.</span><span class="ident" id="4782926">Uint8</span><span class="op" id="4782931">)</span>&nbsp;<span class="op" id="4782933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4782939">return</span>&nbsp;<span class="ident" id="4782946">fmt</span><span class="op" id="4782949">.</span><span class="ident" id="4782950">Errorf</span><span class="op" id="4782956">(</span><span class="string" id="4782957">&#34;xml:&nbsp;bad&nbsp;type&nbsp;for&nbsp;comment&nbsp;field&nbsp;of&nbsp;%s&#34;</span><span class="op" id="4782996">,</span>&nbsp;<span class="ident" id="4782998">val</span><span class="op" id="4783001">.</span><span class="ident" id="4783002">Type</span><span class="op" id="4783006">(</span><span class="op" id="4783007">)</span><span class="op" id="4783008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783018">if</span>&nbsp;<span class="ident" id="4783021">vf</span><span class="op" id="4783023">.</span><span class="ident" id="4783024">Len</span><span class="op" id="4783027">(</span><span class="op" id="4783028">)</span>&nbsp;<span class="op" id="4783030">==</span>&nbsp;<span class="num" id="4783033">0</span>&nbsp;<span class="op" id="4783035">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783041">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783058">p</span><span class="op" id="4783059">.</span><span class="ident" id="4783060">writeIndent</span><span class="op" id="4783071">(</span><span class="num" id="4783072">0</span><span class="op" id="4783073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783078">p</span><span class="op" id="4783079">.</span><span class="ident" id="4783080">WriteString</span><span class="op" id="4783091">(</span><span class="string" id="4783092">&#34;&lt;!--&#34;</span><span class="op" id="4783098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783103">dashDash</span>&nbsp;<span class="op" id="4783112">:=</span>&nbsp;<span class="builtintype" id="4783115">false</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783124">dashLast</span>&nbsp;<span class="op" id="4783133">:=</span>&nbsp;<span class="builtintype" id="4783136">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783145">switch</span>&nbsp;<span class="ident" id="4783152">k</span>&nbsp;<span class="op" id="4783154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783159">case</span>&nbsp;<span class="ident" id="4783164">reflect</span><span class="op" id="4783171">.</span><span class="ident" id="4783172">String</span><span class="op" id="4783178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783184">s</span>&nbsp;<span class="op" id="4783186">:=</span>&nbsp;<span class="ident" id="4783189">vf</span><span class="op" id="4783191">.</span><span class="ident" id="4783192">String</span><span class="op" id="4783198">(</span><span class="op" id="4783199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783205">dashDash</span>&nbsp;<span class="op" id="4783214">=</span>&nbsp;<span class="ident" id="4783216">strings</span><span class="op" id="4783223">.</span><span class="ident" id="4783224">Index</span><span class="op" id="4783229">(</span><span class="ident" id="4783230">s</span><span class="op" id="4783231">,</span>&nbsp;<span class="string" id="4783233">&#34;--&#34;</span><span class="op" id="4783237">)</span>&nbsp;<span class="op" id="4783239">&gt;=</span>&nbsp;<span class="num" id="4783242">0</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783248">dashLast</span>&nbsp;<span class="op" id="4783257">=</span>&nbsp;<span class="ident" id="4783259">s</span><span class="op" id="4783260">[</span><span class="builtinfunc" id="4783261">len</span><span class="op" id="4783264">(</span><span class="ident" id="4783265">s</span><span class="op" id="4783266">)</span><span class="op" id="4783267">-</span><span class="num" id="4783268">1</span><span class="op" id="4783269">]</span>&nbsp;<span class="op" id="4783271">==</span>&nbsp;<span class="string" id="4783274">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783282">if</span>&nbsp;<span class="op" id="4783285">!</span><span class="ident" id="4783286">dashDash</span>&nbsp;<span class="op" id="4783295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783302">p</span><span class="op" id="4783303">.</span><span class="ident" id="4783304">WriteString</span><span class="op" id="4783315">(</span><span class="ident" id="4783316">s</span><span class="op" id="4783317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783328">case</span>&nbsp;<span class="ident" id="4783333">reflect</span><span class="op" id="4783340">.</span><span class="ident" id="4783341">Slice</span><span class="op" id="4783346">:</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783352">b</span>&nbsp;<span class="op" id="4783354">:=</span>&nbsp;<span class="ident" id="4783357">vf</span><span class="op" id="4783359">.</span><span class="ident" id="4783360">Bytes</span><span class="op" id="4783365">(</span><span class="op" id="4783366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783372">dashDash</span>&nbsp;<span class="op" id="4783381">=</span>&nbsp;<span class="ident" id="4783383">bytes</span><span class="op" id="4783388">.</span><span class="ident" id="4783389">Index</span><span class="op" id="4783394">(</span><span class="ident" id="4783395">b</span><span class="op" id="4783396">,</span>&nbsp;<span class="ident" id="4783398">ddBytes</span><span class="op" id="4783405">)</span>&nbsp;<span class="op" id="4783407">&gt;=</span>&nbsp;<span class="num" id="4783410">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783416">dashLast</span>&nbsp;<span class="op" id="4783425">=</span>&nbsp;<span class="ident" id="4783427">b</span><span class="op" id="4783428">[</span><span class="builtinfunc" id="4783429">len</span><span class="op" id="4783432">(</span><span class="ident" id="4783433">b</span><span class="op" id="4783434">)</span><span class="op" id="4783435">-</span><span class="num" id="4783436">1</span><span class="op" id="4783437">]</span>&nbsp;<span class="op" id="4783439">==</span>&nbsp;<span class="string" id="4783442">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783450">if</span>&nbsp;<span class="op" id="4783453">!</span><span class="ident" id="4783454">dashDash</span>&nbsp;<span class="op" id="4783463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783470">p</span><span class="op" id="4783471">.</span><span class="ident" id="4783472">Write</span><span class="op" id="4783477">(</span><span class="ident" id="4783478">b</span><span class="op" id="4783479">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783490">default</span><span class="op" id="4783497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4783503">panic</span><span class="op" id="4783508">(</span><span class="string" id="4783509">&#34;can&#39;t&nbsp;happen&#34;</span><span class="op" id="4783523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783533">if</span>&nbsp;<span class="ident" id="4783536">dashDash</span>&nbsp;<span class="op" id="4783545">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783551">return</span>&nbsp;<span class="ident" id="4783558">fmt</span><span class="op" id="4783561">.</span><span class="ident" id="4783562">Errorf</span><span class="op" id="4783568">(</span><span class="string" id="4783569">`xml:&nbsp;comments&nbsp;must&nbsp;not&nbsp;contain&nbsp;&#34;--&#34;`</span><span class="op" id="4783606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783616">if</span>&nbsp;<span class="ident" id="4783619">dashLast</span>&nbsp;<span class="op" id="4783628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4783634">//&nbsp;&#34;---&gt;&#34;&nbsp;is&nbsp;invalid&nbsp;grammar.&nbsp;Make&nbsp;it&nbsp;&#34;-&nbsp;--&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783684">p</span><span class="op" id="4783685">.</span><span class="ident" id="4783686">WriteByte</span><span class="op" id="4783695">(</span><span class="string" id="4783696">&#39;&nbsp;&#39;</span><span class="op" id="4783699">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783709">p</span><span class="op" id="4783710">.</span><span class="ident" id="4783711">WriteString</span><span class="op" id="4783722">(</span><span class="string" id="4783723">&#34;--&gt;&#34;</span><span class="op" id="4783728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783733">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783745">case</span>&nbsp;<span class="ident" id="4783750">fInnerXml</span><span class="op" id="4783759">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783764">iface</span>&nbsp;<span class="op" id="4783770">:=</span>&nbsp;<span class="ident" id="4783773">vf</span><span class="op" id="4783775">.</span><span class="ident" id="4783776">Interface</span><span class="op" id="4783785">(</span><span class="op" id="4783786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783791">switch</span>&nbsp;<span class="ident" id="4783798">raw</span>&nbsp;<span class="op" id="4783802">:=</span>&nbsp;<span class="ident" id="4783805">iface</span><span class="op" id="4783810">.</span><span class="op" id="4783811">(</span><span class="keyword" id="4783812">type</span><span class="op" id="4783816">)</span>&nbsp;<span class="op" id="4783818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783823">case</span>&nbsp;<span class="op" id="4783828">[</span><span class="op" id="4783829">]</span><span class="builtintype" id="4783830">byte</span><span class="op" id="4783834">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783840">p</span><span class="op" id="4783841">.</span><span class="ident" id="4783842">Write</span><span class="op" id="4783847">(</span><span class="ident" id="4783848">raw</span><span class="op" id="4783851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783857">continue</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783869">case</span>&nbsp;<span class="builtintype" id="4783874">string</span><span class="op" id="4783880">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4783886">p</span><span class="op" id="4783887">.</span><span class="ident" id="4783888">WriteString</span><span class="op" id="4783899">(</span><span class="ident" id="4783900">raw</span><span class="op" id="4783903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783909">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4783921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783926">case</span>&nbsp;<span class="ident" id="4783931">fElement</span><span class="op" id="4783939">,</span>&nbsp;<span class="ident" id="4783941">fElement</span>&nbsp;<span class="op" id="4783950">|</span>&nbsp;<span class="ident" id="4783952">fAny</span><span class="op" id="4783956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4783961">if</span>&nbsp;<span class="ident" id="4783964">err</span>&nbsp;<span class="op" id="4783968">:=</span>&nbsp;<span class="ident" id="4783971">s</span><span class="op" id="4783972">.</span><span class="ident" id="4783973">trim</span><span class="op" id="4783977">(</span><span class="ident" id="4783978">finfo</span><span class="op" id="4783983">.</span><span class="ident" id="4783984">parents</span><span class="op" id="4783991">)</span><span class="op" id="4783992">;</span>&nbsp;<span class="ident" id="4783994">err</span>&nbsp;<span class="op" id="4783998">!=</span>&nbsp;<span class="builtintype" id="4784001">nil</span>&nbsp;<span class="op" id="4784005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784011">return</span>&nbsp;<span class="ident" id="4784018">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784030">if</span>&nbsp;<span class="builtinfunc" id="4784033">len</span><span class="op" id="4784036">(</span><span class="ident" id="4784037">finfo</span><span class="op" id="4784042">.</span><span class="ident" id="4784043">parents</span><span class="op" id="4784050">)</span>&nbsp;<span class="op" id="4784052">&gt;</span>&nbsp;<span class="builtinfunc" id="4784054">len</span><span class="op" id="4784057">(</span><span class="ident" id="4784058">s</span><span class="op" id="4784059">.</span><span class="ident" id="4784060">stack</span><span class="op" id="4784065">)</span>&nbsp;<span class="op" id="4784067">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784073">if</span>&nbsp;<span class="ident" id="4784076">vf</span><span class="op" id="4784078">.</span><span class="ident" id="4784079">Kind</span><span class="op" id="4784083">(</span><span class="op" id="4784084">)</span>&nbsp;<span class="op" id="4784086">!=</span>&nbsp;<span class="ident" id="4784089">reflect</span><span class="op" id="4784096">.</span><span class="ident" id="4784097">Ptr</span>&nbsp;<span class="op" id="4784101">&amp;&amp;</span>&nbsp;<span class="ident" id="4784104">vf</span><span class="op" id="4784106">.</span><span class="ident" id="4784107">Kind</span><span class="op" id="4784111">(</span><span class="op" id="4784112">)</span>&nbsp;<span class="op" id="4784114">!=</span>&nbsp;<span class="ident" id="4784117">reflect</span><span class="op" id="4784124">.</span><span class="ident" id="4784125">Interface</span>&nbsp;<span class="op" id="4784135">||</span>&nbsp;<span class="op" id="4784138">!</span><span class="ident" id="4784139">vf</span><span class="op" id="4784141">.</span><span class="ident" id="4784142">IsNil</span><span class="op" id="4784147">(</span><span class="op" id="4784148">)</span>&nbsp;<span class="op" id="4784150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784157">if</span>&nbsp;<span class="ident" id="4784160">err</span>&nbsp;<span class="op" id="4784164">:=</span>&nbsp;<span class="ident" id="4784167">s</span><span class="op" id="4784168">.</span><span class="ident" id="4784169">push</span><span class="op" id="4784173">(</span><span class="ident" id="4784174">finfo</span><span class="op" id="4784179">.</span><span class="ident" id="4784180">parents</span><span class="op" id="4784187">[</span><span class="builtinfunc" id="4784188">len</span><span class="op" id="4784191">(</span><span class="ident" id="4784192">s</span><span class="op" id="4784193">.</span><span class="ident" id="4784194">stack</span><span class="op" id="4784199">)</span><span class="op" id="4784200">:</span><span class="op" id="4784201">]</span><span class="op" id="4784202">)</span><span class="op" id="4784203">;</span>&nbsp;<span class="ident" id="4784205">err</span>&nbsp;<span class="op" id="4784209">!=</span>&nbsp;<span class="builtintype" id="4784212">nil</span>&nbsp;<span class="op" id="4784216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784224">return</span>&nbsp;<span class="ident" id="4784231">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784246">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784259">if</span>&nbsp;<span class="ident" id="4784262">err</span>&nbsp;<span class="op" id="4784266">:=</span>&nbsp;<span class="ident" id="4784269">p</span><span class="op" id="4784270">.</span><span class="ident" id="4784271">marshalValue</span><span class="op" id="4784283">(</span><span class="ident" id="4784284">vf</span><span class="op" id="4784286">,</span>&nbsp;<span class="ident" id="4784288">finfo</span><span class="op" id="4784293">,</span>&nbsp;<span class="builtintype" id="4784295">nil</span><span class="op" id="4784298">)</span><span class="op" id="4784299">;</span>&nbsp;<span class="ident" id="4784301">err</span>&nbsp;<span class="op" id="4784305">!=</span>&nbsp;<span class="builtintype" id="4784308">nil</span>&nbsp;<span class="op" id="4784312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784317">return</span>&nbsp;<span class="ident" id="4784324">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784330">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784336">s</span><span class="op" id="4784337">.</span><span class="ident" id="4784338">trim</span><span class="op" id="4784342">(</span><span class="builtintype" id="4784343">nil</span><span class="op" id="4784346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784349">return</span>&nbsp;<span class="ident" id="4784356">p</span><span class="op" id="4784357">.</span><span class="ident" id="4784358">cachedWriteError</span><span class="op" id="4784374">(</span><span class="op" id="4784375">)</span><br>
<span class="lineno"></span><span class="op" id="4784377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4784380">//&nbsp;return&nbsp;the&nbsp;bufio&nbsp;Writer&#39;s&nbsp;cached&nbsp;write&nbsp;error</span><br>
<span class="lineno"></span><span class="keyword" id="4784428">func</span>&nbsp;<span class="op" id="4784433">(</span><span class="ident" id="4784434">p</span>&nbsp;<span class="op" id="4784436">*</span><span class="ident" id="4784437">printer</span><span class="op" id="4784444">)</span>&nbsp;<span class="ident" id="4784446">cachedWriteError</span><span class="op" id="4784462">(</span><span class="op" id="4784463">)</span>&nbsp;<span class="builtintype" id="4784465">error</span>&nbsp;<span class="op" id="4784471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784474">_</span><span class="op" id="4784475">,</span>&nbsp;<span class="ident" id="4784477">err</span>&nbsp;<span class="op" id="4784481">:=</span>&nbsp;<span class="ident" id="4784484">p</span><span class="op" id="4784485">.</span><span class="ident" id="4784486">Write</span><span class="op" id="4784491">(</span><span class="builtintype" id="4784492">nil</span><span class="op" id="4784495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784498">return</span>&nbsp;<span class="ident" id="4784505">err</span><br>
<span class="lineno"></span><span class="op" id="4784509">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span><span class="keyword" id="4784512">func</span>&nbsp;<span class="op" id="4784517">(</span><span class="ident" id="4784518">p</span>&nbsp;<span class="op" id="4784520">*</span><span class="ident" id="4784521">printer</span><span class="op" id="4784528">)</span>&nbsp;<span class="ident" id="4784530">writeIndent</span><span class="op" id="4784541">(</span><span class="ident" id="4784542">depthDelta</span>&nbsp;<span class="builtintype" id="4784553">int</span><span class="op" id="4784556">)</span>&nbsp;<span class="op" id="4784558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784561">if</span>&nbsp;<span class="builtinfunc" id="4784564">len</span><span class="op" id="4784567">(</span><span class="ident" id="4784568">p</span><span class="op" id="4784569">.</span><span class="ident" id="4784570">prefix</span><span class="op" id="4784576">)</span>&nbsp;<span class="op" id="4784578">==</span>&nbsp;<span class="num" id="4784581">0</span>&nbsp;<span class="op" id="4784583">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4784586">len</span><span class="op" id="4784589">(</span><span class="ident" id="4784590">p</span><span class="op" id="4784591">.</span><span class="ident" id="4784592">indent</span><span class="op" id="4784598">)</span>&nbsp;<span class="op" id="4784600">==</span>&nbsp;<span class="num" id="4784603">0</span>&nbsp;<span class="op" id="4784605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784609">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784617">}</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784620">if</span>&nbsp;<span class="ident" id="4784623">depthDelta</span>&nbsp;<span class="op" id="4784634">&lt;</span>&nbsp;<span class="num" id="4784636">0</span>&nbsp;<span class="op" id="4784638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784642">p</span><span class="op" id="4784643">.</span><span class="ident" id="4784644">depth</span><span class="op" id="4784649">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784654">if</span>&nbsp;<span class="ident" id="4784657">p</span><span class="op" id="4784658">.</span><span class="ident" id="4784659">indentedIn</span>&nbsp;<span class="op" id="4784670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784675">p</span><span class="op" id="4784676">.</span><span class="ident" id="4784677">indentedIn</span>&nbsp;<span class="op" id="4784688">=</span>&nbsp;<span class="builtintype" id="4784690">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784699">return</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784712">p</span><span class="op" id="4784713">.</span><span class="ident" id="4784714">indentedIn</span>&nbsp;<span class="op" id="4784725">=</span>&nbsp;<span class="builtintype" id="4784727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784737">if</span>&nbsp;<span class="ident" id="4784740">p</span><span class="op" id="4784741">.</span><span class="ident" id="4784742">putNewline</span>&nbsp;<span class="op" id="4784753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784757">p</span><span class="op" id="4784758">.</span><span class="ident" id="4784759">WriteByte</span><span class="op" id="4784768">(</span><span class="string" id="4784769">&#39;\n&#39;</span><span class="op" id="4784773">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784776">}</span>&nbsp;<span class="keyword" id="4784778">else</span>&nbsp;<span class="op" id="4784783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784787">p</span><span class="op" id="4784788">.</span><span class="ident" id="4784789">putNewline</span>&nbsp;<span class="op" id="4784800">=</span>&nbsp;<span class="builtintype" id="4784802">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784811">if</span>&nbsp;<span class="builtinfunc" id="4784814">len</span><span class="op" id="4784817">(</span><span class="ident" id="4784818">p</span><span class="op" id="4784819">.</span><span class="ident" id="4784820">prefix</span><span class="op" id="4784826">)</span>&nbsp;<span class="op" id="4784828">&gt;</span>&nbsp;<span class="num" id="4784830">0</span>&nbsp;<span class="op" id="4784832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784836">p</span><span class="op" id="4784837">.</span><span class="ident" id="4784838">WriteString</span><span class="op" id="4784849">(</span><span class="ident" id="4784850">p</span><span class="op" id="4784851">.</span><span class="ident" id="4784852">prefix</span><span class="op" id="4784858">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784864">if</span>&nbsp;<span class="builtinfunc" id="4784867">len</span><span class="op" id="4784870">(</span><span class="ident" id="4784871">p</span><span class="op" id="4784872">.</span><span class="ident" id="4784873">indent</span><span class="op" id="4784879">)</span>&nbsp;<span class="op" id="4784881">&gt;</span>&nbsp;<span class="num" id="4784883">0</span>&nbsp;<span class="op" id="4784885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784889">for</span>&nbsp;<span class="ident" id="4784893">i</span>&nbsp;<span class="op" id="4784895">:=</span>&nbsp;<span class="num" id="4784898">0</span><span class="op" id="4784899">;</span>&nbsp;<span class="ident" id="4784901">i</span>&nbsp;<span class="op" id="4784903">&lt;</span>&nbsp;<span class="ident" id="4784905">p</span><span class="op" id="4784906">.</span><span class="ident" id="4784907">depth</span><span class="op" id="4784912">;</span>&nbsp;<span class="ident" id="4784914">i</span><span class="op" id="4784915">++</span>&nbsp;<span class="op" id="4784918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784923">p</span><span class="op" id="4784924">.</span><span class="ident" id="4784925">WriteString</span><span class="op" id="4784936">(</span><span class="ident" id="4784937">p</span><span class="op" id="4784938">.</span><span class="ident" id="4784939">indent</span><span class="op" id="4784945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784949">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4784952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4784955">if</span>&nbsp;<span class="ident" id="4784958">depthDelta</span>&nbsp;<span class="op" id="4784969">&gt;</span>&nbsp;<span class="num" id="4784971">0</span>&nbsp;<span class="op" id="4784973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784977">p</span><span class="op" id="4784978">.</span><span class="ident" id="4784979">depth</span><span class="op" id="4784984">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4784989">p</span><span class="op" id="4784990">.</span><span class="ident" id="4784991">indentedIn</span>&nbsp;<span class="op" id="4785002">=</span>&nbsp;<span class="builtintype" id="4785004">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785010">}</span><br>
<span class="lineno">875</span><span class="op" id="4785012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4785015">type</span>&nbsp;<span class="ident" id="4785020">parentStack</span>&nbsp;<span class="keyword" id="4785032">struct</span>&nbsp;<span class="op" id="4785039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4785042">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785048">*</span><span class="ident" id="4785049">printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4785058">stack</span>&nbsp;<span class="op" id="4785064">[</span><span class="op" id="4785065">]</span><span class="builtintype" id="4785066">string</span><br>
<span class="lineno">880</span><span class="op" id="4785073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4785076">//&nbsp;trim&nbsp;updates&nbsp;the&nbsp;XML&nbsp;context&nbsp;to&nbsp;match&nbsp;the&nbsp;longest&nbsp;common&nbsp;prefix&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="4785156">//&nbsp;and&nbsp;the&nbsp;given&nbsp;parents.&nbsp;&nbsp;A&nbsp;closing&nbsp;tag&nbsp;will&nbsp;be&nbsp;written&nbsp;for&nbsp;every&nbsp;parent</span><br>
<span class="lineno"></span><span class="comment" id="4785230">//&nbsp;popped.&nbsp;&nbsp;Passing&nbsp;a&nbsp;zero&nbsp;slice&nbsp;or&nbsp;nil&nbsp;will&nbsp;close&nbsp;all&nbsp;the&nbsp;elements.</span><br>
<span class="lineno">885</span><span class="keyword" id="4785299">func</span>&nbsp;<span class="op" id="4785304">(</span><span class="ident" id="4785305">s</span>&nbsp;<span class="op" id="4785307">*</span><span class="ident" id="4785308">parentStack</span><span class="op" id="4785319">)</span>&nbsp;<span class="ident" id="4785321">trim</span><span class="op" id="4785325">(</span><span class="ident" id="4785326">parents</span>&nbsp;<span class="op" id="4785334">[</span><span class="op" id="4785335">]</span><span class="builtintype" id="4785336">string</span><span class="op" id="4785342">)</span>&nbsp;<span class="builtintype" id="4785344">error</span>&nbsp;<span class="op" id="4785350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4785353">split</span>&nbsp;<span class="op" id="4785359">:=</span>&nbsp;<span class="num" id="4785362">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785365">for</span>&nbsp;<span class="op" id="4785369">;</span>&nbsp;<span class="ident" id="4785371">split</span>&nbsp;<span class="op" id="4785377">&lt;</span>&nbsp;<span class="builtinfunc" id="4785379">len</span><span class="op" id="4785382">(</span><span class="ident" id="4785383">parents</span><span class="op" id="4785390">)</span>&nbsp;<span class="op" id="4785392">&amp;&amp;</span>&nbsp;<span class="ident" id="4785395">split</span>&nbsp;<span class="op" id="4785401">&lt;</span>&nbsp;<span class="builtinfunc" id="4785403">len</span><span class="op" id="4785406">(</span><span class="ident" id="4785407">s</span><span class="op" id="4785408">.</span><span class="ident" id="4785409">stack</span><span class="op" id="4785414">)</span><span class="op" id="4785415">;</span>&nbsp;<span class="ident" id="4785417">split</span><span class="op" id="4785422">++</span>&nbsp;<span class="op" id="4785425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785429">if</span>&nbsp;<span class="ident" id="4785432">parents</span><span class="op" id="4785439">[</span><span class="ident" id="4785440">split</span><span class="op" id="4785445">]</span>&nbsp;<span class="op" id="4785447">!=</span>&nbsp;<span class="ident" id="4785450">s</span><span class="op" id="4785451">.</span><span class="ident" id="4785452">stack</span><span class="op" id="4785457">[</span><span class="ident" id="4785458">split</span><span class="op" id="4785463">]</span>&nbsp;<span class="op" id="4785465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785470">break</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785484">for</span>&nbsp;<span class="ident" id="4785488">i</span>&nbsp;<span class="op" id="4785490">:=</span>&nbsp;<span class="builtinfunc" id="4785493">len</span><span class="op" id="4785496">(</span><span class="ident" id="4785497">s</span><span class="op" id="4785498">.</span><span class="ident" id="4785499">stack</span><span class="op" id="4785504">)</span>&nbsp;<span class="op" id="4785506">-</span>&nbsp;<span class="num" id="4785508">1</span><span class="op" id="4785509">;</span>&nbsp;<span class="ident" id="4785511">i</span>&nbsp;<span class="op" id="4785513">&gt;=</span>&nbsp;<span class="ident" id="4785516">split</span><span class="op" id="4785521">;</span>&nbsp;<span class="ident" id="4785523">i</span><span class="op" id="4785524">--</span>&nbsp;<span class="op" id="4785527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785531">if</span>&nbsp;<span class="ident" id="4785534">err</span>&nbsp;<span class="op" id="4785538">:=</span>&nbsp;<span class="ident" id="4785541">s</span><span class="op" id="4785542">.</span><span class="ident" id="4785543">p</span><span class="op" id="4785544">.</span><span class="ident" id="4785545">writeEnd</span><span class="op" id="4785553">(</span><span class="ident" id="4785554">Name</span><span class="op" id="4785558">{</span><span class="ident" id="4785559">Local</span><span class="op" id="4785564">:</span>&nbsp;<span class="ident" id="4785566">s</span><span class="op" id="4785567">.</span><span class="ident" id="4785568">stack</span><span class="op" id="4785573">[</span><span class="ident" id="4785574">i</span><span class="op" id="4785575">]</span><span class="op" id="4785576">}</span><span class="op" id="4785577">)</span><span class="op" id="4785578">;</span>&nbsp;<span class="ident" id="4785580">err</span>&nbsp;<span class="op" id="4785584">!=</span>&nbsp;<span class="builtintype" id="4785587">nil</span>&nbsp;<span class="op" id="4785591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785596">return</span>&nbsp;<span class="ident" id="4785603">err</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4785615">s</span><span class="op" id="4785616">.</span><span class="ident" id="4785617">stack</span>&nbsp;<span class="op" id="4785623">=</span>&nbsp;<span class="ident" id="4785625">parents</span><span class="op" id="4785632">[</span><span class="op" id="4785633">:</span><span class="ident" id="4785634">split</span><span class="op" id="4785639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785642">return</span>&nbsp;<span class="builtintype" id="4785649">nil</span><br>
<span class="lineno"></span><span class="op" id="4785653">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span><span class="comment" id="4785656">//&nbsp;push&nbsp;adds&nbsp;parent&nbsp;elements&nbsp;to&nbsp;the&nbsp;stack&nbsp;and&nbsp;writes&nbsp;open&nbsp;tags.</span><br>
<span class="lineno"></span><span class="keyword" id="4785720">func</span>&nbsp;<span class="op" id="4785725">(</span><span class="ident" id="4785726">s</span>&nbsp;<span class="op" id="4785728">*</span><span class="ident" id="4785729">parentStack</span><span class="op" id="4785740">)</span>&nbsp;<span class="ident" id="4785742">push</span><span class="op" id="4785746">(</span><span class="ident" id="4785747">parents</span>&nbsp;<span class="op" id="4785755">[</span><span class="op" id="4785756">]</span><span class="builtintype" id="4785757">string</span><span class="op" id="4785763">)</span>&nbsp;<span class="builtintype" id="4785765">error</span>&nbsp;<span class="op" id="4785771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785774">for</span>&nbsp;<span class="ident" id="4785778">i</span>&nbsp;<span class="op" id="4785780">:=</span>&nbsp;<span class="num" id="4785783">0</span><span class="op" id="4785784">;</span>&nbsp;<span class="ident" id="4785786">i</span>&nbsp;<span class="op" id="4785788">&lt;</span>&nbsp;<span class="builtinfunc" id="4785790">len</span><span class="op" id="4785793">(</span><span class="ident" id="4785794">parents</span><span class="op" id="4785801">)</span><span class="op" id="4785802">;</span>&nbsp;<span class="ident" id="4785804">i</span><span class="op" id="4785805">++</span>&nbsp;<span class="op" id="4785808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785812">if</span>&nbsp;<span class="ident" id="4785815">err</span>&nbsp;<span class="op" id="4785819">:=</span>&nbsp;<span class="ident" id="4785822">s</span><span class="op" id="4785823">.</span><span class="ident" id="4785824">p</span><span class="op" id="4785825">.</span><span class="ident" id="4785826">writeStart</span><span class="op" id="4785836">(</span><span class="op" id="4785837">&amp;</span><span class="ident" id="4785838">StartElement</span><span class="op" id="4785850">{</span><span class="ident" id="4785851">Name</span><span class="op" id="4785855">:</span>&nbsp;<span class="ident" id="4785857">Name</span><span class="op" id="4785861">{</span><span class="ident" id="4785862">Local</span><span class="op" id="4785867">:</span>&nbsp;<span class="ident" id="4785869">parents</span><span class="op" id="4785876">[</span><span class="ident" id="4785877">i</span><span class="op" id="4785878">]</span><span class="op" id="4785879">}</span><span class="op" id="4785880">}</span><span class="op" id="4785881">)</span><span class="op" id="4785882">;</span>&nbsp;<span class="ident" id="4785884">err</span>&nbsp;<span class="op" id="4785888">!=</span>&nbsp;<span class="builtintype" id="4785891">nil</span>&nbsp;<span class="op" id="4785895">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785900">return</span>&nbsp;<span class="ident" id="4785907">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4785916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4785919">s</span><span class="op" id="4785920">.</span><span class="ident" id="4785921">stack</span>&nbsp;<span class="op" id="4785927">=</span>&nbsp;<span class="builtinfunc" id="4785929">append</span><span class="op" id="4785935">(</span><span class="ident" id="4785936">s</span><span class="op" id="4785937">.</span><span class="ident" id="4785938">stack</span><span class="op" id="4785943">,</span>&nbsp;<span class="ident" id="4785945">parents</span><span class="op" id="4785952">...</span><span class="op" id="4785955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4785958">return</span>&nbsp;<span class="builtintype" id="4785965">nil</span><br>
<span class="lineno">910</span><span class="op" id="4785969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4785972">//&nbsp;A&nbsp;MarshalXMLError&nbsp;is&nbsp;returned&nbsp;when&nbsp;Marshal&nbsp;encounters&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4786036">//&nbsp;that&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;into&nbsp;XML.</span><br>
<span class="lineno"></span><span class="keyword" id="4786074">type</span>&nbsp;<span class="ident" id="4786079">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="4786100">struct</span>&nbsp;<span class="op" id="4786107">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4786110">Type</span>&nbsp;<span class="ident" id="4786115">reflect</span><span class="op" id="4786122">.</span><span class="ident" id="4786123">Type</span><br>
<span class="lineno"></span><span class="op" id="4786128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4786131">func</span>&nbsp;<span class="op" id="4786136">(</span><span class="ident" id="4786137">e</span>&nbsp;<span class="op" id="4786139">*</span><span class="ident" id="4786140">UnsupportedTypeError</span><span class="op" id="4786160">)</span>&nbsp;<span class="ident" id="4786162">Error</span><span class="op" id="4786167">(</span><span class="op" id="4786168">)</span>&nbsp;<span class="builtintype" id="4786170">string</span>&nbsp;<span class="op" id="4786177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786180">return</span>&nbsp;<span class="string" id="4786187">&#34;xml:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="4786213">+</span>&nbsp;<span class="ident" id="4786215">e</span><span class="op" id="4786216">.</span><span class="ident" id="4786217">Type</span><span class="op" id="4786221">.</span><span class="ident" id="4786222">String</span><span class="op" id="4786228">(</span><span class="op" id="4786229">)</span><br>
<span class="lineno">920</span><span class="op" id="4786231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4786234">func</span>&nbsp;<span class="ident" id="4786239">isEmptyValue</span><span class="op" id="4786251">(</span><span class="ident" id="4786252">v</span>&nbsp;<span class="ident" id="4786254">reflect</span><span class="op" id="4786261">.</span><span class="ident" id="4786262">Value</span><span class="op" id="4786267">)</span>&nbsp;<span class="builtintype" id="4786269">bool</span>&nbsp;<span class="op" id="4786274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786277">switch</span>&nbsp;<span class="ident" id="4786284">v</span><span class="op" id="4786285">.</span><span class="ident" id="4786286">Kind</span><span class="op" id="4786290">(</span><span class="op" id="4786291">)</span>&nbsp;<span class="op" id="4786293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786296">case</span>&nbsp;<span class="ident" id="4786301">reflect</span><span class="op" id="4786308">.</span><span class="ident" id="4786309">Array</span><span class="op" id="4786314">,</span>&nbsp;<span class="ident" id="4786316">reflect</span><span class="op" id="4786323">.</span><span class="ident" id="4786324">Map</span><span class="op" id="4786327">,</span>&nbsp;<span class="ident" id="4786329">reflect</span><span class="op" id="4786336">.</span><span class="ident" id="4786337">Slice</span><span class="op" id="4786342">,</span>&nbsp;<span class="ident" id="4786344">reflect</span><span class="op" id="4786351">.</span><span class="ident" id="4786352">String</span><span class="op" id="4786358">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786362">return</span>&nbsp;<span class="ident" id="4786369">v</span><span class="op" id="4786370">.</span><span class="ident" id="4786371">Len</span><span class="op" id="4786374">(</span><span class="op" id="4786375">)</span>&nbsp;<span class="op" id="4786377">==</span>&nbsp;<span class="num" id="4786380">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786383">case</span>&nbsp;<span class="ident" id="4786388">reflect</span><span class="op" id="4786395">.</span><span class="ident" id="4786396">Bool</span><span class="op" id="4786400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786404">return</span>&nbsp;<span class="op" id="4786411">!</span><span class="ident" id="4786412">v</span><span class="op" id="4786413">.</span><span class="ident" id="4786414">Bool</span><span class="op" id="4786418">(</span><span class="op" id="4786419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786422">case</span>&nbsp;<span class="ident" id="4786427">reflect</span><span class="op" id="4786434">.</span><span class="ident" id="4786435">Int</span><span class="op" id="4786438">,</span>&nbsp;<span class="ident" id="4786440">reflect</span><span class="op" id="4786447">.</span><span class="ident" id="4786448">Int8</span><span class="op" id="4786452">,</span>&nbsp;<span class="ident" id="4786454">reflect</span><span class="op" id="4786461">.</span><span class="ident" id="4786462">Int16</span><span class="op" id="4786467">,</span>&nbsp;<span class="ident" id="4786469">reflect</span><span class="op" id="4786476">.</span><span class="ident" id="4786477">Int32</span><span class="op" id="4786482">,</span>&nbsp;<span class="ident" id="4786484">reflect</span><span class="op" id="4786491">.</span><span class="ident" id="4786492">Int64</span><span class="op" id="4786497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786501">return</span>&nbsp;<span class="ident" id="4786508">v</span><span class="op" id="4786509">.</span><span class="ident" id="4786510">Int</span><span class="op" id="4786513">(</span><span class="op" id="4786514">)</span>&nbsp;<span class="op" id="4786516">==</span>&nbsp;<span class="num" id="4786519">0</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786522">case</span>&nbsp;<span class="ident" id="4786527">reflect</span><span class="op" id="4786534">.</span><span class="ident" id="4786535">Uint</span><span class="op" id="4786539">,</span>&nbsp;<span class="ident" id="4786541">reflect</span><span class="op" id="4786548">.</span><span class="ident" id="4786549">Uint8</span><span class="op" id="4786554">,</span>&nbsp;<span class="ident" id="4786556">reflect</span><span class="op" id="4786563">.</span><span class="ident" id="4786564">Uint16</span><span class="op" id="4786570">,</span>&nbsp;<span class="ident" id="4786572">reflect</span><span class="op" id="4786579">.</span><span class="ident" id="4786580">Uint32</span><span class="op" id="4786586">,</span>&nbsp;<span class="ident" id="4786588">reflect</span><span class="op" id="4786595">.</span><span class="ident" id="4786596">Uint64</span><span class="op" id="4786602">,</span>&nbsp;<span class="ident" id="4786604">reflect</span><span class="op" id="4786611">.</span><span class="ident" id="4786612">Uintptr</span><span class="op" id="4786619">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786623">return</span>&nbsp;<span class="ident" id="4786630">v</span><span class="op" id="4786631">.</span><span class="ident" id="4786632">Uint</span><span class="op" id="4786636">(</span><span class="op" id="4786637">)</span>&nbsp;<span class="op" id="4786639">==</span>&nbsp;<span class="num" id="4786642">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786645">case</span>&nbsp;<span class="ident" id="4786650">reflect</span><span class="op" id="4786657">.</span><span class="ident" id="4786658">Float32</span><span class="op" id="4786665">,</span>&nbsp;<span class="ident" id="4786667">reflect</span><span class="op" id="4786674">.</span><span class="ident" id="4786675">Float64</span><span class="op" id="4786682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786686">return</span>&nbsp;<span class="ident" id="4786693">v</span><span class="op" id="4786694">.</span><span class="ident" id="4786695">Float</span><span class="op" id="4786700">(</span><span class="op" id="4786701">)</span>&nbsp;<span class="op" id="4786703">==</span>&nbsp;<span class="num" id="4786706">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786709">case</span>&nbsp;<span class="ident" id="4786714">reflect</span><span class="op" id="4786721">.</span><span class="ident" id="4786722">Interface</span><span class="op" id="4786731">,</span>&nbsp;<span class="ident" id="4786733">reflect</span><span class="op" id="4786740">.</span><span class="ident" id="4786741">Ptr</span><span class="op" id="4786744">:</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786748">return</span>&nbsp;<span class="ident" id="4786755">v</span><span class="op" id="4786756">.</span><span class="ident" id="4786757">IsNil</span><span class="op" id="4786762">(</span><span class="op" id="4786763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4786766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4786769">return</span>&nbsp;<span class="builtintype" id="4786776">false</span><br>
<span class="lineno"></span><span class="op" id="4786782">}</span>
</div>
</body>
</html>
