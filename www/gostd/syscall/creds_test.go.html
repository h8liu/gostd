<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html" class="current">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1184332">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1184388">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1184442">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1184493">//&nbsp;+build&nbsp;linux</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1184510">package</span>&nbsp;<span class="ident" id="1184518">syscall_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1184532">import</span>&nbsp;<span class="op" id="1184539">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1184542">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1184551">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1184558">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1184564">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1184575">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="1184585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1184588">//&nbsp;TestSCMCredentials&nbsp;tests&nbsp;the&nbsp;sending&nbsp;and&nbsp;receiving&nbsp;of&nbsp;credentials</span><br>
<span class="lineno"></span><span class="comment" id="1184657">//&nbsp;(PID,&nbsp;UID,&nbsp;GID)&nbsp;in&nbsp;an&nbsp;ancillary&nbsp;message&nbsp;between&nbsp;two&nbsp;UNIX</span><br>
<span class="lineno"></span><span class="comment" id="1184717">//&nbsp;sockets.&nbsp;The&nbsp;SO_PASSCRED&nbsp;socket&nbsp;option&nbsp;is&nbsp;enabled&nbsp;on&nbsp;the&nbsp;sending</span><br>
<span class="lineno">20</span><span class="comment" id="1184785">//&nbsp;socket&nbsp;for&nbsp;this&nbsp;to&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="1184813">func</span>&nbsp;<span class="ident" id="1184818">TestSCMCredentials</span><span class="op" id="1184836">(</span><span class="ident" id="1184837">t</span>&nbsp;<span class="op" id="1184839">*</span><span class="ident" id="1184840"><a href="/gostd/syscall/creds_test.go.html#1184575">testing</a></span><span class="op" id="1184847">.</span><span class="ident" id="1184848"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="1184849">)</span>&nbsp;<span class="op" id="1184851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1184854">fds</span><span class="op" id="1184857">,</span>&nbsp;<span class="ident" id="1184859">err</span>&nbsp;<span class="op" id="1184863">:=</span>&nbsp;<span class="ident" id="1184866"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1184873">.</span><span class="ident" id="1184874"><a href="/gostd/syscall/syscall_unix.go.html#2550084">Socketpair</a></span><span class="op" id="1184884">(</span><span class="ident" id="1184885"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1184892">.</span><span class="ident" id="1184893"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551568">AF_LOCAL</a></span><span class="op" id="1184901">,</span>&nbsp;<span class="ident" id="1184903"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1184910">.</span><span class="ident" id="1184911"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592030">SOCK_STREAM</a></span><span class="op" id="1184922">,</span>&nbsp;<span class="num" id="1184924">0</span><span class="op" id="1184925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1184928">if</span>&nbsp;<span class="ident" id="1184931"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1184935">!=</span>&nbsp;<span class="builtintype" id="1184938">nil</span>&nbsp;<span class="op" id="1184942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1184946"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1184947">.</span><span class="ident" id="1184948"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1184954">(</span><span class="string" id="1184955">&#34;Socketpair:&nbsp;%v&#34;</span><span class="op" id="1184971">,</span>&nbsp;<span class="ident" id="1184973"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1184976">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1184979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1184982">defer</span>&nbsp;<span class="ident" id="1184988"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1184995">.</span><span class="ident" id="1184996"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="1185001">(</span><span class="ident" id="1185002"><a href="/gostd/syscall/creds_test.go.html#1184854">fds</a></span><span class="op" id="1185005">[</span><span class="num" id="1185006">0</span><span class="op" id="1185007">]</span><span class="op" id="1185008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185011">defer</span>&nbsp;<span class="ident" id="1185017"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185024">.</span><span class="ident" id="1185025"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="1185030">(</span><span class="ident" id="1185031"><a href="/gostd/syscall/creds_test.go.html#1184854">fds</a></span><span class="op" id="1185034">[</span><span class="num" id="1185035">1</span><span class="op" id="1185036">]</span><span class="op" id="1185037">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185041"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1185045">=</span>&nbsp;<span class="ident" id="1185047"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185054">.</span><span class="ident" id="1185055"><a href="/gostd/syscall/syscall_unix.go.html#2548721">SetsockoptInt</a></span><span class="op" id="1185068">(</span><span class="ident" id="1185069"><a href="/gostd/syscall/creds_test.go.html#1184854">fds</a></span><span class="op" id="1185072">[</span><span class="num" id="1185073">0</span><span class="op" id="1185074">]</span><span class="op" id="1185075">,</span>&nbsp;<span class="ident" id="1185077"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185084">.</span><span class="ident" id="1185085"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592443">SOL_SOCKET</a></span><span class="op" id="1185095">,</span>&nbsp;<span class="ident" id="1185097"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185104">.</span><span class="ident" id="1185105"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2593212">SO_PASSCRED</a></span><span class="op" id="1185116">,</span>&nbsp;<span class="num" id="1185118">1</span><span class="op" id="1185119">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185122">if</span>&nbsp;<span class="ident" id="1185125"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1185129">!=</span>&nbsp;<span class="builtintype" id="1185132">nil</span>&nbsp;<span class="op" id="1185136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185140"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1185141">.</span><span class="ident" id="1185142"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1185148">(</span><span class="string" id="1185149">&#34;SetsockoptInt:&nbsp;%v&#34;</span><span class="op" id="1185168">,</span>&nbsp;<span class="ident" id="1185170"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1185173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1185176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185180">srvFile</span>&nbsp;<span class="op" id="1185188">:=</span>&nbsp;<span class="ident" id="1185191"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185193">.</span><span class="ident" id="1185194"><a href="/gostd/os/file_unix.go.html#2453016">NewFile</a></span><span class="op" id="1185201">(</span><span class="builtintype" id="1185202">uintptr</span><span class="op" id="1185209">(</span><span class="ident" id="1185210"><a href="/gostd/syscall/creds_test.go.html#1184854">fds</a></span><span class="op" id="1185213">[</span><span class="num" id="1185214">0</span><span class="op" id="1185215">]</span><span class="op" id="1185216">)</span><span class="op" id="1185217">,</span>&nbsp;<span class="string" id="1185219">&#34;server&#34;</span><span class="op" id="1185227">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185230">defer</span>&nbsp;<span class="ident" id="1185236"><a href="/gostd/syscall/creds_test.go.html#1185180">srvFile</a></span><span class="op" id="1185243">.</span><span class="ident" id="1185244"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="1185249">(</span><span class="op" id="1185250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185253">srv</span><span class="op" id="1185256">,</span>&nbsp;<span class="ident" id="1185258"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1185262">:=</span>&nbsp;<span class="ident" id="1185265"><a href="/gostd/syscall/creds_test.go.html#1184551">net</a></span><span class="op" id="1185268">.</span><span class="ident" id="1185269"><a href="/gostd/net/file_unix.go.html#3271424">FileConn</a></span><span class="op" id="1185277">(</span><span class="ident" id="1185278"><a href="/gostd/syscall/creds_test.go.html#1185180">srvFile</a></span><span class="op" id="1185285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185288">if</span>&nbsp;<span class="ident" id="1185291"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1185295">!=</span>&nbsp;<span class="builtintype" id="1185298">nil</span>&nbsp;<span class="op" id="1185302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185306"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1185307">.</span><span class="ident" id="1185308"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="1185314">(</span><span class="string" id="1185315">&#34;FileConn:&nbsp;%v&#34;</span><span class="op" id="1185329">,</span>&nbsp;<span class="ident" id="1185331"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1185334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185338">return</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1185346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185349">defer</span>&nbsp;<span class="ident" id="1185355"><a href="/gostd/syscall/creds_test.go.html#1185253">srv</a></span><span class="op" id="1185358">.</span><span class="ident" id="1185359"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="1185364">(</span><span class="op" id="1185365">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185369">cliFile</span>&nbsp;<span class="op" id="1185377">:=</span>&nbsp;<span class="ident" id="1185380"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185382">.</span><span class="ident" id="1185383"><a href="/gostd/os/file_unix.go.html#2453016">NewFile</a></span><span class="op" id="1185390">(</span><span class="builtintype" id="1185391">uintptr</span><span class="op" id="1185398">(</span><span class="ident" id="1185399"><a href="/gostd/syscall/creds_test.go.html#1184854">fds</a></span><span class="op" id="1185402">[</span><span class="num" id="1185403">1</span><span class="op" id="1185404">]</span><span class="op" id="1185405">)</span><span class="op" id="1185406">,</span>&nbsp;<span class="string" id="1185408">&#34;client&#34;</span><span class="op" id="1185416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185419">defer</span>&nbsp;<span class="ident" id="1185425"><a href="/gostd/syscall/creds_test.go.html#1185369">cliFile</a></span><span class="op" id="1185432">.</span><span class="ident" id="1185433"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="1185438">(</span><span class="op" id="1185439">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185442">cli</span><span class="op" id="1185445">,</span>&nbsp;<span class="ident" id="1185447"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1185451">:=</span>&nbsp;<span class="ident" id="1185454"><a href="/gostd/syscall/creds_test.go.html#1184551">net</a></span><span class="op" id="1185457">.</span><span class="ident" id="1185458"><a href="/gostd/net/file_unix.go.html#3271424">FileConn</a></span><span class="op" id="1185466">(</span><span class="ident" id="1185467"><a href="/gostd/syscall/creds_test.go.html#1185369">cliFile</a></span><span class="op" id="1185474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185477">if</span>&nbsp;<span class="ident" id="1185480"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1185484">!=</span>&nbsp;<span class="builtintype" id="1185487">nil</span>&nbsp;<span class="op" id="1185491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185495"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1185496">.</span><span class="ident" id="1185497"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="1185503">(</span><span class="string" id="1185504">&#34;FileConn:&nbsp;%v&#34;</span><span class="op" id="1185518">,</span>&nbsp;<span class="ident" id="1185520"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1185523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1185535">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185538">defer</span>&nbsp;<span class="ident" id="1185544"><a href="/gostd/syscall/creds_test.go.html#1185442">cli</a></span><span class="op" id="1185547">.</span><span class="ident" id="1185548"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="1185553">(</span><span class="op" id="1185554">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185558">var</span>&nbsp;<span class="ident" id="1185562">ucred</span>&nbsp;<span class="ident" id="1185568"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185575">.</span><span class="ident" id="1185576"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670077">Ucred</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185583">if</span>&nbsp;<span class="ident" id="1185586"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185588">.</span><span class="ident" id="1185589"><a href="/gostd/os/proc.go.html#2468979">Getuid</a></span><span class="op" id="1185595">(</span><span class="op" id="1185596">)</span>&nbsp;<span class="op" id="1185598">!=</span>&nbsp;<span class="num" id="1185601">0</span>&nbsp;<span class="op" id="1185603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185607"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185612">.</span><span class="ident" id="1185613"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670093">Pid</a></span>&nbsp;<span class="op" id="1185617">=</span>&nbsp;<span class="builtintype" id="1185619">int32</span><span class="op" id="1185624">(</span><span class="ident" id="1185625"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185627">.</span><span class="ident" id="1185628"><a href="/gostd/os/exec.go.html#2435259">Getpid</a></span><span class="op" id="1185634">(</span><span class="op" id="1185635">)</span><span class="op" id="1185636">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185640"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185645">.</span><span class="ident" id="1185646"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670104">Uid</a></span>&nbsp;<span class="op" id="1185650">=</span>&nbsp;<span class="num" id="1185652">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185656"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185661">.</span><span class="ident" id="1185662"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670116">Gid</a></span>&nbsp;<span class="op" id="1185666">=</span>&nbsp;<span class="num" id="1185668">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185672">oob</span>&nbsp;<span class="op" id="1185676">:=</span>&nbsp;<span class="ident" id="1185679"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185686">.</span><span class="ident" id="1185687"><a href="/gostd/syscall/sockcmsg_linux.go.html#2504475">UnixCredentials</a></span><span class="op" id="1185702">(</span><span class="op" id="1185703">&amp;</span><span class="ident" id="1185704"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185713">_</span><span class="op" id="1185714">,</span>&nbsp;<span class="ident" id="1185716">_</span><span class="op" id="1185717">,</span>&nbsp;<span class="ident" id="1185719">err</span>&nbsp;<span class="op" id="1185723">:=</span>&nbsp;<span class="ident" id="1185726"><a href="/gostd/syscall/creds_test.go.html#1185442">cli</a></span><span class="op" id="1185729">.</span><span class="op" id="1185730">(</span><span class="op" id="1185731">*</span><span class="ident" id="1185732"><a href="/gostd/syscall/creds_test.go.html#1184551">net</a></span><span class="op" id="1185735">.</span><span class="ident" id="1185736"><a href="/gostd/net/unixsock_posix.go.html#3398471">UnixConn</a></span><span class="op" id="1185744">)</span><span class="op" id="1185745">.</span><span class="ident" id="1185746"><a href="/gostd/net/unixsock_posix.go.html#3401367">WriteMsgUnix</a></span><span class="op" id="1185758">(</span><span class="builtintype" id="1185759">nil</span><span class="op" id="1185762">,</span>&nbsp;<span class="ident" id="1185764"><a href="/gostd/syscall/creds_test.go.html#1185672">oob</a></span><span class="op" id="1185767">,</span>&nbsp;<span class="builtintype" id="1185769">nil</span><span class="op" id="1185772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1185776">if</span>&nbsp;<span class="ident" id="1185779"><a href="/gostd/syscall/creds_test.go.html#1185719">err</a></span><span class="op" id="1185782">.</span><span class="op" id="1185783">(</span><span class="op" id="1185784">*</span><span class="ident" id="1185785"><a href="/gostd/syscall/creds_test.go.html#1184551">net</a></span><span class="op" id="1185788">.</span><span class="ident" id="1185789"><a href="/gostd/net/net.go.html#3341562">OpError</a></span><span class="op" id="1185796">)</span><span class="op" id="1185797">.</span><span class="ident" id="1185798"><a href="/gostd/net/net.go.html#3341902">Err</a></span>&nbsp;<span class="op" id="1185802">!=</span>&nbsp;<span class="ident" id="1185805"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1185812">.</span><span class="ident" id="1185813"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2603309">EPERM</a></span>&nbsp;<span class="op" id="1185819">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185824"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1185825">.</span><span class="ident" id="1185826"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1185832">(</span><span class="string" id="1185833">&#34;WriteMsgUnix&nbsp;failed&nbsp;with&nbsp;%v,&nbsp;want&nbsp;EPERM&#34;</span><span class="op" id="1185874">,</span>&nbsp;<span class="ident" id="1185876"><a href="/gostd/syscall/creds_test.go.html#1185719">err</a></span><span class="op" id="1185879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1185883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1185886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185890"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185895">.</span><span class="ident" id="1185896"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670093">Pid</a></span>&nbsp;<span class="op" id="1185900">=</span>&nbsp;<span class="builtintype" id="1185902">int32</span><span class="op" id="1185907">(</span><span class="ident" id="1185908"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185910">.</span><span class="ident" id="1185911"><a href="/gostd/os/exec.go.html#2435259">Getpid</a></span><span class="op" id="1185917">(</span><span class="op" id="1185918">)</span><span class="op" id="1185919">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185922"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185927">.</span><span class="ident" id="1185928"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670104">Uid</a></span>&nbsp;<span class="op" id="1185932">=</span>&nbsp;<span class="builtintype" id="1185934">uint32</span><span class="op" id="1185940">(</span><span class="ident" id="1185941"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185943">.</span><span class="ident" id="1185944"><a href="/gostd/os/proc.go.html#2468979">Getuid</a></span><span class="op" id="1185950">(</span><span class="op" id="1185951">)</span><span class="op" id="1185952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185955"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1185960">.</span><span class="ident" id="1185961"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2670116">Gid</a></span>&nbsp;<span class="op" id="1185965">=</span>&nbsp;<span class="builtintype" id="1185967">uint32</span><span class="op" id="1185973">(</span><span class="ident" id="1185974"><a href="/gostd/syscall/creds_test.go.html#1184558">os</a></span><span class="op" id="1185976">.</span><span class="ident" id="1185977"><a href="/gostd/os/proc.go.html#2469193">Getgid</a></span><span class="op" id="1185983">(</span><span class="op" id="1185984">)</span><span class="op" id="1185985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1185988">oob</span>&nbsp;<span class="op" id="1185992">:=</span>&nbsp;<span class="ident" id="1185995"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1186002">.</span><span class="ident" id="1186003"><a href="/gostd/syscall/sockcmsg_linux.go.html#2504475">UnixCredentials</a></span><span class="op" id="1186018">(</span><span class="op" id="1186019">&amp;</span><span class="ident" id="1186020"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1186025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1186029">//&nbsp;this&nbsp;is&nbsp;going&nbsp;to&nbsp;send&nbsp;a&nbsp;dummy&nbsp;byte</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186068">n</span><span class="op" id="1186069">,</span>&nbsp;<span class="ident" id="1186071">oobn</span><span class="op" id="1186075">,</span>&nbsp;<span class="ident" id="1186077"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1186081">:=</span>&nbsp;<span class="ident" id="1186084"><a href="/gostd/syscall/creds_test.go.html#1185442">cli</a></span><span class="op" id="1186087">.</span><span class="op" id="1186088">(</span><span class="op" id="1186089">*</span><span class="ident" id="1186090"><a href="/gostd/syscall/creds_test.go.html#1184551">net</a></span><span class="op" id="1186093">.</span><span class="ident" id="1186094"><a href="/gostd/net/unixsock_posix.go.html#3398471">UnixConn</a></span><span class="op" id="1186102">)</span><span class="op" id="1186103">.</span><span class="ident" id="1186104"><a href="/gostd/net/unixsock_posix.go.html#3401367">WriteMsgUnix</a></span><span class="op" id="1186116">(</span><span class="builtintype" id="1186117">nil</span><span class="op" id="1186120">,</span>&nbsp;<span class="ident" id="1186122"><a href="/gostd/syscall/creds_test.go.html#1185988">oob</a></span><span class="op" id="1186125">,</span>&nbsp;<span class="builtintype" id="1186127">nil</span><span class="op" id="1186130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186133">if</span>&nbsp;<span class="ident" id="1186136"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1186140">!=</span>&nbsp;<span class="builtintype" id="1186143">nil</span>&nbsp;<span class="op" id="1186147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186151"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186152">.</span><span class="ident" id="1186153"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186159">(</span><span class="string" id="1186160">&#34;WriteMsgUnix:&nbsp;%v&#34;</span><span class="op" id="1186178">,</span>&nbsp;<span class="ident" id="1186180"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1186183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186189">if</span>&nbsp;<span class="ident" id="1186192"><a href="/gostd/syscall/creds_test.go.html#1186068">n</a></span>&nbsp;<span class="op" id="1186194">!=</span>&nbsp;<span class="num" id="1186197">0</span>&nbsp;<span class="op" id="1186199">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186203"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186204">.</span><span class="ident" id="1186205"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186211">(</span><span class="string" id="1186212">&#34;WriteMsgUnix&nbsp;n&nbsp;=&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="1186241">,</span>&nbsp;<span class="ident" id="1186243"><a href="/gostd/syscall/creds_test.go.html#1186068">n</a></span><span class="op" id="1186244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186250">if</span>&nbsp;<span class="ident" id="1186253"><a href="/gostd/syscall/creds_test.go.html#1186071">oobn</a></span>&nbsp;<span class="op" id="1186258">!=</span>&nbsp;<span class="builtinfunc" id="1186261">len</span><span class="op" id="1186264">(</span><span class="ident" id="1186265"><a href="/gostd/syscall/creds_test.go.html#1185988">oob</a></span><span class="op" id="1186268">)</span>&nbsp;<span class="op" id="1186270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186274"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186275">.</span><span class="ident" id="1186276"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186282">(</span><span class="string" id="1186283">&#34;WriteMsgUnix&nbsp;oobn&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="1186316">,</span>&nbsp;<span class="ident" id="1186318"><a href="/gostd/syscall/creds_test.go.html#1186071">oobn</a></span><span class="op" id="1186322">,</span>&nbsp;<span class="builtinfunc" id="1186324">len</span><span class="op" id="1186327">(</span><span class="ident" id="1186328"><a href="/gostd/syscall/creds_test.go.html#1185988">oob</a></span><span class="op" id="1186331">)</span><span class="op" id="1186332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186335">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186339">oob2</span>&nbsp;<span class="op" id="1186344">:=</span>&nbsp;<span class="builtinfunc" id="1186347">make</span><span class="op" id="1186351">(</span><span class="op" id="1186352">[</span><span class="op" id="1186353">]</span><span class="builtintype" id="1186354">byte</span><span class="op" id="1186358">,</span>&nbsp;<span class="num" id="1186360">10</span><span class="op" id="1186362">*</span><span class="builtinfunc" id="1186363">len</span><span class="op" id="1186366">(</span><span class="ident" id="1186367"><a href="/gostd/syscall/creds_test.go.html#1185988">oob</a></span><span class="op" id="1186370">)</span><span class="op" id="1186371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186374"><a href="/gostd/syscall/creds_test.go.html#1186068">n</a></span><span class="op" id="1186375">,</span>&nbsp;<span class="ident" id="1186377">oobn2</span><span class="op" id="1186382">,</span>&nbsp;<span class="ident" id="1186384">flags</span><span class="op" id="1186389">,</span>&nbsp;<span class="ident" id="1186391">_</span><span class="op" id="1186392">,</span>&nbsp;<span class="ident" id="1186394"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1186398">:=</span>&nbsp;<span class="ident" id="1186401"><a href="/gostd/syscall/creds_test.go.html#1185253">srv</a></span><span class="op" id="1186404">.</span><span class="op" id="1186405">(</span><span class="op" id="1186406">*</span><span class="ident" id="1186407"><a href="/gostd/syscall/creds_test.go.html#1184551">net</a></span><span class="op" id="1186410">.</span><span class="ident" id="1186411"><a href="/gostd/net/unixsock_posix.go.html#3398471">UnixConn</a></span><span class="op" id="1186419">)</span><span class="op" id="1186420">.</span><span class="ident" id="1186421"><a href="/gostd/net/unixsock_posix.go.html#3399731">ReadMsgUnix</a></span><span class="op" id="1186432">(</span><span class="builtintype" id="1186433">nil</span><span class="op" id="1186436">,</span>&nbsp;<span class="ident" id="1186438"><a href="/gostd/syscall/creds_test.go.html#1186339">oob2</a></span><span class="op" id="1186442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186445">if</span>&nbsp;<span class="ident" id="1186448"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1186452">!=</span>&nbsp;<span class="builtintype" id="1186455">nil</span>&nbsp;<span class="op" id="1186459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186463"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186464">.</span><span class="ident" id="1186465"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186471">(</span><span class="string" id="1186472">&#34;ReadMsgUnix:&nbsp;%v&#34;</span><span class="op" id="1186489">,</span>&nbsp;<span class="ident" id="1186491"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1186494">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186500">if</span>&nbsp;<span class="ident" id="1186503"><a href="/gostd/syscall/creds_test.go.html#1186384">flags</a></span>&nbsp;<span class="op" id="1186509">!=</span>&nbsp;<span class="num" id="1186512">0</span>&nbsp;<span class="op" id="1186514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186518"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186519">.</span><span class="ident" id="1186520"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186526">(</span><span class="string" id="1186527">&#34;ReadMsgUnix&nbsp;flags&nbsp;=&nbsp;0x%x,&nbsp;want&nbsp;0&#34;</span><span class="op" id="1186561">,</span>&nbsp;<span class="ident" id="1186563"><a href="/gostd/syscall/creds_test.go.html#1186384">flags</a></span><span class="op" id="1186568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186574">if</span>&nbsp;<span class="ident" id="1186577"><a href="/gostd/syscall/creds_test.go.html#1186068">n</a></span>&nbsp;<span class="op" id="1186579">!=</span>&nbsp;<span class="num" id="1186582">1</span>&nbsp;<span class="op" id="1186584">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186588"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186589">.</span><span class="ident" id="1186590"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186596">(</span><span class="string" id="1186597">&#34;ReadMsgUnix&nbsp;n&nbsp;=&nbsp;%d,&nbsp;want&nbsp;1&nbsp;(dummy&nbsp;byte)&#34;</span><span class="op" id="1186638">,</span>&nbsp;<span class="ident" id="1186640"><a href="/gostd/syscall/creds_test.go.html#1186068">n</a></span><span class="op" id="1186641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186647">if</span>&nbsp;<span class="ident" id="1186650"><a href="/gostd/syscall/creds_test.go.html#1186377">oobn2</a></span>&nbsp;<span class="op" id="1186656">!=</span>&nbsp;<span class="ident" id="1186659"><a href="/gostd/syscall/creds_test.go.html#1186071">oobn</a></span>&nbsp;<span class="op" id="1186664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1186668">//&nbsp;without&nbsp;SO_PASSCRED&nbsp;set&nbsp;on&nbsp;the&nbsp;socket,&nbsp;ReadMsgUnix&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1186729">//&nbsp;return&nbsp;zero&nbsp;oob&nbsp;bytes</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186756"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186757">.</span><span class="ident" id="1186758"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186764">(</span><span class="string" id="1186765">&#34;ReadMsgUnix&nbsp;oobn&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="1186797">,</span>&nbsp;<span class="ident" id="1186799"><a href="/gostd/syscall/creds_test.go.html#1186377">oobn2</a></span><span class="op" id="1186804">,</span>&nbsp;<span class="ident" id="1186806"><a href="/gostd/syscall/creds_test.go.html#1186071">oobn</a></span><span class="op" id="1186810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186816"><a href="/gostd/syscall/creds_test.go.html#1186339">oob2</a></span>&nbsp;<span class="op" id="1186821">=</span>&nbsp;<span class="ident" id="1186823"><a href="/gostd/syscall/creds_test.go.html#1186339">oob2</a></span><span class="op" id="1186827">[</span><span class="op" id="1186828">:</span><span class="ident" id="1186829"><a href="/gostd/syscall/creds_test.go.html#1186377">oobn2</a></span><span class="op" id="1186834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186837">if</span>&nbsp;<span class="op" id="1186840">!</span><span class="ident" id="1186841"><a href="/gostd/syscall/creds_test.go.html#1184542">bytes</a></span><span class="op" id="1186846">.</span><span class="ident" id="1186847"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="1186852">(</span><span class="ident" id="1186853"><a href="/gostd/syscall/creds_test.go.html#1185988">oob</a></span><span class="op" id="1186856">,</span>&nbsp;<span class="ident" id="1186858"><a href="/gostd/syscall/creds_test.go.html#1186339">oob2</a></span><span class="op" id="1186862">)</span>&nbsp;<span class="op" id="1186864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186868"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186869">.</span><span class="ident" id="1186870"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="1186875">(</span><span class="string" id="1186876">&#34;ReadMsgUnix&nbsp;oob&nbsp;bytes&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="1186911">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1186914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186918">scm</span><span class="op" id="1186921">,</span>&nbsp;<span class="ident" id="1186923"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1186927">:=</span>&nbsp;<span class="ident" id="1186930"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1186937">.</span><span class="ident" id="1186938"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506580">ParseSocketControlMessage</a></span><span class="op" id="1186963">(</span><span class="ident" id="1186964"><a href="/gostd/syscall/creds_test.go.html#1186339">oob2</a></span><span class="op" id="1186968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1186971">if</span>&nbsp;<span class="ident" id="1186974"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1186978">!=</span>&nbsp;<span class="builtintype" id="1186981">nil</span>&nbsp;<span class="op" id="1186985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1186989"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1186990">.</span><span class="ident" id="1186991"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1186997">(</span><span class="string" id="1186998">&#34;ParseSocketControlMessage:&nbsp;%v&#34;</span><span class="op" id="1187029">,</span>&nbsp;<span class="ident" id="1187031"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1187034">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1187037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1187040">newUcred</span><span class="op" id="1187048">,</span>&nbsp;<span class="ident" id="1187050"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1187054">:=</span>&nbsp;<span class="ident" id="1187057"><a href="/gostd/syscall/creds_test.go.html#1184564">syscall</a></span><span class="op" id="1187064">.</span><span class="ident" id="1187065"><a href="/gostd/syscall/sockcmsg_linux.go.html#2504922">ParseUnixCredentials</a></span><span class="op" id="1187085">(</span><span class="op" id="1187086">&amp;</span><span class="ident" id="1187087"><a href="/gostd/syscall/creds_test.go.html#1186918">scm</a></span><span class="op" id="1187090">[</span><span class="num" id="1187091">0</span><span class="op" id="1187092">]</span><span class="op" id="1187093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1187096">if</span>&nbsp;<span class="ident" id="1187099"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span>&nbsp;<span class="op" id="1187103">!=</span>&nbsp;<span class="builtintype" id="1187106">nil</span>&nbsp;<span class="op" id="1187110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1187114"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1187115">.</span><span class="ident" id="1187116"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1187122">(</span><span class="string" id="1187123">&#34;ParseUnixCredentials:&nbsp;%v&#34;</span><span class="op" id="1187149">,</span>&nbsp;<span class="ident" id="1187151"><a href="/gostd/syscall/creds_test.go.html#1184859">err</a></span><span class="op" id="1187154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1187157">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1187160">if</span>&nbsp;<span class="op" id="1187163">*</span><span class="ident" id="1187164"><a href="/gostd/syscall/creds_test.go.html#1187040">newUcred</a></span>&nbsp;<span class="op" id="1187173">!=</span>&nbsp;<span class="ident" id="1187176"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span>&nbsp;<span class="op" id="1187182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1187186"><a href="/gostd/syscall/creds_test.go.html#1184837">t</a></span><span class="op" id="1187187">.</span><span class="ident" id="1187188"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="1187194">(</span><span class="string" id="1187195">&#34;ParseUnixCredentials&nbsp;=&nbsp;%+v,&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="1187233">,</span>&nbsp;<span class="ident" id="1187235"><a href="/gostd/syscall/creds_test.go.html#1187040">newUcred</a></span><span class="op" id="1187243">,</span>&nbsp;<span class="ident" id="1187245"><a href="/gostd/syscall/creds_test.go.html#1185562">ucred</a></span><span class="op" id="1187250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1187253">}</span><br>
<span class="lineno"></span><span class="op" id="1187255">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
