<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="6076025">package</span>&nbsp;<span class="ident" id="6076033">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6076040">import</span>&nbsp;<span class="op" id="6076047">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6076050">&#34;fmt&#34;</span><br>
<span class="lineno">5</span><span class="op" id="6076056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6076059">//&nbsp;LinkMain&nbsp;produces&nbsp;a&nbsp;image&nbsp;for&nbsp;a&nbsp;main()&nbsp;in&nbsp;a&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="6076115">func</span>&nbsp;<span class="ident" id="6076120">LinkMain</span><span class="op" id="6076128">(</span><span class="ident" id="6076129">main</span>&nbsp;<span class="op" id="6076134">*</span><span class="ident" id="6076135"><a href="/lonnie.io/e8vm/link8/package.go.html#6078334">Package</a></span><span class="op" id="6076142">)</span>&nbsp;<span class="op" id="6076144">(</span><span class="op" id="6076145">[</span><span class="op" id="6076146">]</span><span class="builtintype" id="6076147">byte</span><span class="op" id="6076151">,</span>&nbsp;<span class="builtintype" id="6076153">error</span><span class="op" id="6076158">)</span>&nbsp;<span class="op" id="6076160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076163">lnk</span>&nbsp;<span class="op" id="6076167">:=</span>&nbsp;<span class="ident" id="6076170"><a href="/lonnie.io/e8vm/link8/linker.go.html#6077068">NewLinker</a></span><span class="op" id="6076179">(</span><span class="op" id="6076180">)</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076183"><a href="/lonnie.io/e8vm/link8/link.go.html#6076163">lnk</a></span><span class="op" id="6076186">.</span><span class="ident" id="6076187">AddPkgs</span><span class="op" id="6076194">(</span><span class="ident" id="6076195"><a href="/lonnie.io/e8vm/link8/link.go.html#6076129">main</a></span><span class="op" id="6076199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076203">funcMain</span><span class="op" id="6076211">,</span>&nbsp;<span class="ident" id="6076213">index</span>&nbsp;<span class="op" id="6076219">:=</span>&nbsp;<span class="ident" id="6076222"><a href="/lonnie.io/e8vm/link8/link.go.html#6076129">main</a></span><span class="op" id="6076226">.</span><span class="ident" id="6076227">Query</span><span class="op" id="6076232">(</span><span class="string" id="6076233">&#34;main&#34;</span><span class="op" id="6076239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076242">if</span>&nbsp;<span class="ident" id="6076245"><a href="/lonnie.io/e8vm/link8/link.go.html#6076203">funcMain</a></span>&nbsp;<span class="op" id="6076254">==</span>&nbsp;<span class="ident" id="6076257">nil</span>&nbsp;<span class="op" id="6076261">||</span>&nbsp;<span class="ident" id="6076264"><a href="/lonnie.io/e8vm/link8/link.go.html#6076203">funcMain</a></span><span class="op" id="6076272">.</span><span class="ident" id="6076273">Type</span>&nbsp;<span class="op" id="6076278">!=</span>&nbsp;<span class="ident" id="6076281"><a href="/lonnie.io/e8vm/link8/symbol.go.html#6081812">SymFunc</a></span>&nbsp;<span class="op" id="6076289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076293">return</span>&nbsp;<span class="ident" id="6076300">nil</span><span class="op" id="6076303">,</span>&nbsp;<span class="ident" id="6076305"><a href="/lonnie.io/e8vm/link8/link.go.html#6076050">fmt</a></span><span class="op" id="6076308">.</span><span class="ident" id="6076309">Errorf</span><span class="op" id="6076315">(</span><span class="string" id="6076316">&#34;main&nbsp;function&nbsp;missing&#34;</span><span class="op" id="6076339">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6076342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076346">used</span>&nbsp;<span class="op" id="6076351">:=</span>&nbsp;<span class="ident" id="6076354"><a href="/lonnie.io/e8vm/link8/trace_used.go.html#6082295">traceUsed</a></span><span class="op" id="6076363">(</span><span class="ident" id="6076364"><a href="/lonnie.io/e8vm/link8/link.go.html#6076163">lnk</a></span><span class="op" id="6076367">,</span>&nbsp;<span class="ident" id="6076369"><a href="/lonnie.io/e8vm/link8/link.go.html#6076129">main</a></span><span class="op" id="6076373">,</span>&nbsp;<span class="ident" id="6076375"><a href="/lonnie.io/e8vm/link8/link.go.html#6076213">index</a></span><span class="op" id="6076380">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076384">funcs</span><span class="op" id="6076389">,</span>&nbsp;<span class="ident" id="6076391">vars</span><span class="op" id="6076395">,</span>&nbsp;<span class="ident" id="6076397">e</span>&nbsp;<span class="op" id="6076399">:=</span>&nbsp;<span class="ident" id="6076402"><a href="/lonnie.io/e8vm/link8/layout.go.html#6075140">layout</a></span><span class="op" id="6076408">(</span><span class="ident" id="6076409"><a href="/lonnie.io/e8vm/link8/link.go.html#6076346">used</a></span><span class="op" id="6076413">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076416">if</span>&nbsp;<span class="ident" id="6076419"><a href="/lonnie.io/e8vm/link8/link.go.html#6076397">e</a></span>&nbsp;<span class="op" id="6076421">!=</span>&nbsp;<span class="ident" id="6076424">nil</span>&nbsp;<span class="op" id="6076428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076432">return</span>&nbsp;<span class="ident" id="6076439">nil</span><span class="op" id="6076442">,</span>&nbsp;<span class="ident" id="6076444"><a href="/lonnie.io/e8vm/link8/link.go.html#6076397">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6076447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076451">w</span>&nbsp;<span class="op" id="6076453">:=</span>&nbsp;<span class="ident" id="6076456"><a href="/lonnie.io/e8vm/link8/writer.go.html#6083867">newWriter</a></span><span class="op" id="6076465">(</span><span class="op" id="6076466">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076469">for</span>&nbsp;<span class="ident" id="6076473">_</span><span class="op" id="6076474">,</span>&nbsp;<span class="ident" id="6076476">f</span>&nbsp;<span class="op" id="6076478">:=</span>&nbsp;<span class="keyword" id="6076481">range</span>&nbsp;<span class="ident" id="6076487"><a href="/lonnie.io/e8vm/link8/link.go.html#6076384">funcs</a></span>&nbsp;<span class="op" id="6076493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076497"><a href="/lonnie.io/e8vm/link8/writer.go.html#6084434">writeFunc</a></span><span class="op" id="6076506">(</span><span class="ident" id="6076507"><a href="/lonnie.io/e8vm/link8/link.go.html#6076451">w</a></span><span class="op" id="6076508">,</span>&nbsp;<span class="ident" id="6076510"><a href="/lonnie.io/e8vm/link8/link.go.html#6076476">f</a></span><span class="op" id="6076511">.</span><span class="ident" id="6076512">pkg</span><span class="op" id="6076515">,</span>&nbsp;<span class="ident" id="6076517"><a href="/lonnie.io/e8vm/link8/link.go.html#6076476">f</a></span><span class="op" id="6076518">.</span><span class="ident" id="6076519">Func</span><span class="op" id="6076523">(</span><span class="op" id="6076524">)</span><span class="op" id="6076525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6076528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076532">for</span>&nbsp;<span class="ident" id="6076536">_</span><span class="op" id="6076537">,</span>&nbsp;<span class="ident" id="6076539">v</span>&nbsp;<span class="op" id="6076541">:=</span>&nbsp;<span class="keyword" id="6076544">range</span>&nbsp;<span class="ident" id="6076550"><a href="/lonnie.io/e8vm/link8/link.go.html#6076391">vars</a></span>&nbsp;<span class="op" id="6076555">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076559"><a href="/lonnie.io/e8vm/link8/writer.go.html#6084331">writeVar</a></span><span class="op" id="6076567">(</span><span class="ident" id="6076568"><a href="/lonnie.io/e8vm/link8/link.go.html#6076451">w</a></span><span class="op" id="6076569">,</span>&nbsp;<span class="ident" id="6076571"><a href="/lonnie.io/e8vm/link8/link.go.html#6076539">v</a></span><span class="op" id="6076572">.</span><span class="ident" id="6076573">Var</span><span class="op" id="6076576">(</span><span class="op" id="6076577">)</span><span class="op" id="6076578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6076581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076585">return</span>&nbsp;<span class="ident" id="6076592"><a href="/lonnie.io/e8vm/link8/link.go.html#6076451">w</a></span><span class="op" id="6076593">.</span><span class="ident" id="6076594">bytes</span><span class="op" id="6076599">(</span><span class="op" id="6076600">)</span><span class="op" id="6076601">,</span>&nbsp;<span class="ident" id="6076603">nil</span><br>
<span class="lineno"></span><span class="op" id="6076607">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="6076610">//&nbsp;LinkBareFunc&nbsp;produces&nbsp;a&nbsp;image&nbsp;of&nbsp;a&nbsp;single&nbsp;function&nbsp;that&nbsp;has&nbsp;no&nbsp;links.</span><br>
<span class="lineno"></span><span class="keyword" id="6076683">func</span>&nbsp;<span class="ident" id="6076688">LinkBareFunc</span><span class="op" id="6076700">(</span><span class="ident" id="6076701">f</span>&nbsp;<span class="op" id="6076703">*</span><span class="ident" id="6076704"><a href="/lonnie.io/e8vm/link8/func.go.html#6073639">Func</a></span><span class="op" id="6076708">)</span>&nbsp;<span class="op" id="6076710">(</span><span class="op" id="6076711">[</span><span class="op" id="6076712">]</span><span class="builtintype" id="6076713">byte</span><span class="op" id="6076717">,</span>&nbsp;<span class="builtintype" id="6076719">error</span><span class="op" id="6076724">)</span>&nbsp;<span class="op" id="6076726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076729">if</span>&nbsp;<span class="ident" id="6076732"><a href="/lonnie.io/e8vm/link8/link.go.html#6076701">f</a></span><span class="op" id="6076733">.</span><span class="ident" id="6076734">TooLarge</span><span class="op" id="6076742">(</span><span class="op" id="6076743">)</span>&nbsp;<span class="op" id="6076745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076749">return</span>&nbsp;<span class="ident" id="6076756">nil</span><span class="op" id="6076759">,</span>&nbsp;<span class="ident" id="6076761"><a href="/lonnie.io/e8vm/link8/link.go.html#6076050">fmt</a></span><span class="op" id="6076764">.</span><span class="ident" id="6076765">Errorf</span><span class="op" id="6076771">(</span><span class="string" id="6076772">&#34;code&nbsp;section&nbsp;too&nbsp;large&#34;</span><span class="op" id="6076796">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6076799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076803">w</span>&nbsp;<span class="op" id="6076805">:=</span>&nbsp;<span class="ident" id="6076808"><a href="/lonnie.io/e8vm/link8/writer.go.html#6083867">newWriter</a></span><span class="op" id="6076817">(</span><span class="op" id="6076818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6076821"><a href="/lonnie.io/e8vm/link8/link.go.html#6076803">w</a></span><span class="op" id="6076822">.</span><span class="ident" id="6076823">writeBareFunc</span><span class="op" id="6076836">(</span><span class="ident" id="6076837"><a href="/lonnie.io/e8vm/link8/link.go.html#6076701">f</a></span><span class="op" id="6076838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6076841">return</span>&nbsp;<span class="ident" id="6076848"><a href="/lonnie.io/e8vm/link8/link.go.html#6076803">w</a></span><span class="op" id="6076849">.</span><span class="ident" id="6076850">bytes</span><span class="op" id="6076855">(</span><span class="op" id="6076856">)</span><span class="op" id="6076857">,</span>&nbsp;<span class="ident" id="6076859">nil</span><br>
<span class="lineno">45</span><span class="op" id="6076863">}</span>
</div>
</body>
</html>
