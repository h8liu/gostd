<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html" class="current">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7870278">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7870334">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7870388">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7870439">package</span>&nbsp;<span class="ident" id="7870447">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7870453">import</span>&nbsp;<span class="op" id="7870460">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870463">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870472">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870482">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870489">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870495">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870508">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870519">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7870530">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7870540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7870543">type</span>&nbsp;<span class="ident" id="7870548">reqWriteTest</span>&nbsp;<span class="keyword" id="7870561">struct</span>&nbsp;<span class="op" id="7870568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870571">Req</span>&nbsp;&nbsp;<span class="ident" id="7870576">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870585">Body</span>&nbsp;<span class="keyword" id="7870590">interface</span><span class="op" id="7870599">{</span><span class="op" id="7870600">}</span>&nbsp;<span class="comment" id="7870602">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7870668">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870723">WantWrite</span>&nbsp;<span class="builtintype" id="7870733">string</span>&nbsp;<span class="comment" id="7870740">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870758">WantProxy</span>&nbsp;<span class="builtintype" id="7870768">string</span>&nbsp;<span class="comment" id="7870775">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870799">WantError</span>&nbsp;<span class="builtintype" id="7870809">error</span>&nbsp;<span class="comment" id="7870815">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="7870850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7870853">var</span>&nbsp;<span class="ident" id="7870857">reqWriteTests</span>&nbsp;<span class="op" id="7870871">=</span>&nbsp;<span class="op" id="7870873">[</span><span class="op" id="7870874">]</span><span class="ident" id="7870875">reqWriteTest</span><span class="op" id="7870887">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7870890">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7870942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870946">Req</span><span class="op" id="7870949">:</span>&nbsp;<span class="ident" id="7870951">Request</span><span class="op" id="7870958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870963">Method</span><span class="op" id="7870969">:</span>&nbsp;<span class="string" id="7870971">&#34;GET&#34;</span><span class="op" id="7870976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7870981">URL</span><span class="op" id="7870984">:</span>&nbsp;<span class="op" id="7870986">&amp;</span><span class="ident" id="7870987">url</span><span class="op" id="7870990">.</span><span class="ident" id="7870991">URL</span><span class="op" id="7870994">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871000">Scheme</span><span class="op" id="7871006">:</span>&nbsp;<span class="string" id="7871008">&#34;http&#34;</span><span class="op" id="7871014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871020">Host</span><span class="op" id="7871024">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7871028">&#34;www.techcrunch.com&#34;</span><span class="op" id="7871048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871054">Path</span><span class="op" id="7871058">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7871062">&#34;/&#34;</span><span class="op" id="7871065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7871070">}</span><span class="op" id="7871071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871076">Proto</span><span class="op" id="7871081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871088">&#34;HTTP/1.1&#34;</span><span class="op" id="7871098">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871103">ProtoMajor</span><span class="op" id="7871113">:</span>&nbsp;<span class="num" id="7871115">1</span><span class="op" id="7871116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871121">ProtoMinor</span><span class="op" id="7871131">:</span>&nbsp;<span class="num" id="7871133">1</span><span class="op" id="7871134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871139">Header</span><span class="op" id="7871145">:</span>&nbsp;<span class="ident" id="7871147">Header</span><span class="op" id="7871153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871159">&#34;Accept&#34;</span><span class="op" id="7871167">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7871179">{</span><span class="string" id="7871180">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="7871245">}</span><span class="op" id="7871246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871252">&#34;Accept-Charset&#34;</span><span class="op" id="7871268">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7871272">{</span><span class="string" id="7871273">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="7871305">}</span><span class="op" id="7871306">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871312">&#34;Accept-Encoding&#34;</span><span class="op" id="7871329">:</span>&nbsp;&nbsp;<span class="op" id="7871332">{</span><span class="string" id="7871333">&#34;gzip,deflate&#34;</span><span class="op" id="7871347">}</span><span class="op" id="7871348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871354">&#34;Accept-Language&#34;</span><span class="op" id="7871371">:</span>&nbsp;&nbsp;<span class="op" id="7871374">{</span><span class="string" id="7871375">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="7871391">}</span><span class="op" id="7871392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871398">&#34;Keep-Alive&#34;</span><span class="op" id="7871410">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7871418">{</span><span class="string" id="7871419">&#34;300&#34;</span><span class="op" id="7871424">}</span><span class="op" id="7871425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871431">&#34;Proxy-Connection&#34;</span><span class="op" id="7871449">:</span>&nbsp;<span class="op" id="7871451">{</span><span class="string" id="7871452">&#34;keep-alive&#34;</span><span class="op" id="7871464">}</span><span class="op" id="7871465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871471">&#34;User-Agent&#34;</span><span class="op" id="7871483">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7871491">{</span><span class="string" id="7871492">&#34;Fake&#34;</span><span class="op" id="7871498">}</span><span class="op" id="7871499">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7871504">}</span><span class="op" id="7871505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871510">Body</span><span class="op" id="7871514">:</span>&nbsp;&nbsp;<span class="builtintype" id="7871517">nil</span><span class="op" id="7871520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871525">Close</span><span class="op" id="7871530">:</span>&nbsp;<span class="builtintype" id="7871532">false</span><span class="op" id="7871537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871542">Host</span><span class="op" id="7871546">:</span>&nbsp;&nbsp;<span class="string" id="7871549">&#34;www.techcrunch.com&#34;</span><span class="op" id="7871569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871574">Form</span><span class="op" id="7871578">:</span>&nbsp;&nbsp;<span class="keyword" id="7871581">map</span><span class="op" id="7871584">[</span><span class="builtintype" id="7871585">string</span><span class="op" id="7871591">]</span><span class="op" id="7871592">[</span><span class="op" id="7871593">]</span><span class="builtintype" id="7871594">string</span><span class="op" id="7871600">{</span><span class="op" id="7871601">}</span><span class="op" id="7871602">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7871606">}</span><span class="op" id="7871607">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7871612">WantWrite</span><span class="op" id="7871621">:</span>&nbsp;<span class="string" id="7871623">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7871644">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871649">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7871680">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871685">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7871708">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871713">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7871791">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871796">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7871849">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871854">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7871890">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871895">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7871933">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871938">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7871960">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7871965">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7872003">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872008">WantProxy</span><span class="op" id="7872017">:</span>&nbsp;<span class="string" id="7872019">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7872065">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872070">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7872101">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872106">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7872129">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872134">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7872212">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872217">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7872270">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872275">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7872311">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872316">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7872354">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872359">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7872381">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872386">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7872424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7872427">}</span><span class="op" id="7872428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7872431">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7872483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872487">Req</span><span class="op" id="7872490">:</span>&nbsp;<span class="ident" id="7872492">Request</span><span class="op" id="7872499">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872504">Method</span><span class="op" id="7872510">:</span>&nbsp;<span class="string" id="7872512">&#34;GET&#34;</span><span class="op" id="7872517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872522">URL</span><span class="op" id="7872525">:</span>&nbsp;<span class="op" id="7872527">&amp;</span><span class="ident" id="7872528">url</span><span class="op" id="7872531">.</span><span class="ident" id="7872532">URL</span><span class="op" id="7872535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872541">Scheme</span><span class="op" id="7872547">:</span>&nbsp;<span class="string" id="7872549">&#34;http&#34;</span><span class="op" id="7872555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872561">Host</span><span class="op" id="7872565">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7872569">&#34;www.google.com&#34;</span><span class="op" id="7872585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872591">Path</span><span class="op" id="7872595">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7872599">&#34;/search&#34;</span><span class="op" id="7872608">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7872613">}</span><span class="op" id="7872614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872619">ProtoMajor</span><span class="op" id="7872629">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7872637">1</span><span class="op" id="7872638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872643">ProtoMinor</span><span class="op" id="7872653">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7872661">1</span><span class="op" id="7872662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872667">Header</span><span class="op" id="7872673">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872685">Header</span><span class="op" id="7872691">{</span><span class="op" id="7872692">}</span><span class="op" id="7872693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872698">TransferEncoding</span><span class="op" id="7872714">:</span>&nbsp;<span class="op" id="7872716">[</span><span class="op" id="7872717">]</span><span class="builtintype" id="7872718">string</span><span class="op" id="7872724">{</span><span class="string" id="7872725">&#34;chunked&#34;</span><span class="op" id="7872734">}</span><span class="op" id="7872735">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7872739">}</span><span class="op" id="7872740">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872745">Body</span><span class="op" id="7872749">:</span>&nbsp;<span class="op" id="7872751">[</span><span class="op" id="7872752">]</span><span class="builtintype" id="7872753">byte</span><span class="op" id="7872757">(</span><span class="string" id="7872758">&#34;abcdef&#34;</span><span class="op" id="7872766">)</span><span class="op" id="7872767">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872772">WantWrite</span><span class="op" id="7872781">:</span>&nbsp;<span class="string" id="7872783">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7872810">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872815">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7872842">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872847">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7872885">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7872890">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7872927">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872932">chunk</span><span class="op" id="7872937">(</span><span class="string" id="7872938">&#34;abcdef&#34;</span><span class="op" id="7872946">)</span>&nbsp;<span class="op" id="7872948">+</span>&nbsp;<span class="ident" id="7872950">chunk</span><span class="op" id="7872955">(</span><span class="string" id="7872956">&#34;&#34;</span><span class="op" id="7872958">)</span><span class="op" id="7872959">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7872964">WantProxy</span><span class="op" id="7872973">:</span>&nbsp;<span class="string" id="7872975">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7873023">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873028">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7873055">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873060">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7873098">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873103">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7873140">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873145">chunk</span><span class="op" id="7873150">(</span><span class="string" id="7873151">&#34;abcdef&#34;</span><span class="op" id="7873159">)</span>&nbsp;<span class="op" id="7873161">+</span>&nbsp;<span class="ident" id="7873163">chunk</span><span class="op" id="7873168">(</span><span class="string" id="7873169">&#34;&#34;</span><span class="op" id="7873171">)</span><span class="op" id="7873172">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7873175">}</span><span class="op" id="7873176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7873179">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7873236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873240">Req</span><span class="op" id="7873243">:</span>&nbsp;<span class="ident" id="7873245">Request</span><span class="op" id="7873252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873257">Method</span><span class="op" id="7873263">:</span>&nbsp;<span class="string" id="7873265">&#34;POST&#34;</span><span class="op" id="7873271">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873276">URL</span><span class="op" id="7873279">:</span>&nbsp;<span class="op" id="7873281">&amp;</span><span class="ident" id="7873282">url</span><span class="op" id="7873285">.</span><span class="ident" id="7873286">URL</span><span class="op" id="7873289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873295">Scheme</span><span class="op" id="7873301">:</span>&nbsp;<span class="string" id="7873303">&#34;http&#34;</span><span class="op" id="7873309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873315">Host</span><span class="op" id="7873319">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7873323">&#34;www.google.com&#34;</span><span class="op" id="7873339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873345">Path</span><span class="op" id="7873349">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7873353">&#34;/search&#34;</span><span class="op" id="7873362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7873367">}</span><span class="op" id="7873368">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873373">ProtoMajor</span><span class="op" id="7873383">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7873391">1</span><span class="op" id="7873392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873397">ProtoMinor</span><span class="op" id="7873407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7873415">1</span><span class="op" id="7873416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873421">Header</span><span class="op" id="7873427">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873439">Header</span><span class="op" id="7873445">{</span><span class="op" id="7873446">}</span><span class="op" id="7873447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873452">Close</span><span class="op" id="7873457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7873470">true</span><span class="op" id="7873474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873479">TransferEncoding</span><span class="op" id="7873495">:</span>&nbsp;<span class="op" id="7873497">[</span><span class="op" id="7873498">]</span><span class="builtintype" id="7873499">string</span><span class="op" id="7873505">{</span><span class="string" id="7873506">&#34;chunked&#34;</span><span class="op" id="7873515">}</span><span class="op" id="7873516">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7873520">}</span><span class="op" id="7873521">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873526">Body</span><span class="op" id="7873530">:</span>&nbsp;<span class="op" id="7873532">[</span><span class="op" id="7873533">]</span><span class="builtintype" id="7873534">byte</span><span class="op" id="7873538">(</span><span class="string" id="7873539">&#34;abcdef&#34;</span><span class="op" id="7873547">)</span><span class="op" id="7873548">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873553">WantWrite</span><span class="op" id="7873562">:</span>&nbsp;<span class="string" id="7873564">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7873592">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873597">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7873624">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873629">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7873667">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873672">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7873696">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873701">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7873738">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873743">chunk</span><span class="op" id="7873748">(</span><span class="string" id="7873749">&#34;abcdef&#34;</span><span class="op" id="7873757">)</span>&nbsp;<span class="op" id="7873759">+</span>&nbsp;<span class="ident" id="7873761">chunk</span><span class="op" id="7873766">(</span><span class="string" id="7873767">&#34;&#34;</span><span class="op" id="7873769">)</span><span class="op" id="7873770">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873775">WantProxy</span><span class="op" id="7873784">:</span>&nbsp;<span class="string" id="7873786">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7873835">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873840">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7873867">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873872">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7873910">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873915">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7873939">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7873944">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7873981">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7873986">chunk</span><span class="op" id="7873991">(</span><span class="string" id="7873992">&#34;abcdef&#34;</span><span class="op" id="7874000">)</span>&nbsp;<span class="op" id="7874002">+</span>&nbsp;<span class="ident" id="7874004">chunk</span><span class="op" id="7874009">(</span><span class="string" id="7874010">&#34;&#34;</span><span class="op" id="7874012">)</span><span class="op" id="7874013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7874016">}</span><span class="op" id="7874017">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7874021">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7874072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874076">Req</span><span class="op" id="7874079">:</span>&nbsp;<span class="ident" id="7874081">Request</span><span class="op" id="7874088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874093">Method</span><span class="op" id="7874099">:</span>&nbsp;<span class="string" id="7874101">&#34;POST&#34;</span><span class="op" id="7874107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874112">URL</span><span class="op" id="7874115">:</span>&nbsp;<span class="op" id="7874117">&amp;</span><span class="ident" id="7874118">url</span><span class="op" id="7874121">.</span><span class="ident" id="7874122">URL</span><span class="op" id="7874125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874131">Scheme</span><span class="op" id="7874137">:</span>&nbsp;<span class="string" id="7874139">&#34;http&#34;</span><span class="op" id="7874145">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874151">Host</span><span class="op" id="7874155">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7874159">&#34;www.google.com&#34;</span><span class="op" id="7874175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874181">Path</span><span class="op" id="7874185">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7874189">&#34;/search&#34;</span><span class="op" id="7874198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7874203">}</span><span class="op" id="7874204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874209">ProtoMajor</span><span class="op" id="7874219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7874224">1</span><span class="op" id="7874225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874230">ProtoMinor</span><span class="op" id="7874240">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7874245">1</span><span class="op" id="7874246">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874251">Header</span><span class="op" id="7874257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874266">Header</span><span class="op" id="7874272">{</span><span class="op" id="7874273">}</span><span class="op" id="7874274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874279">Close</span><span class="op" id="7874284">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7874294">true</span><span class="op" id="7874298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874303">ContentLength</span><span class="op" id="7874316">:</span>&nbsp;<span class="num" id="7874318">6</span><span class="op" id="7874319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7874323">}</span><span class="op" id="7874324">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874329">Body</span><span class="op" id="7874333">:</span>&nbsp;<span class="op" id="7874335">[</span><span class="op" id="7874336">]</span><span class="builtintype" id="7874337">byte</span><span class="op" id="7874341">(</span><span class="string" id="7874342">&#34;abcdef&#34;</span><span class="op" id="7874350">)</span><span class="op" id="7874351">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874356">WantWrite</span><span class="op" id="7874365">:</span>&nbsp;<span class="string" id="7874367">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7874395">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874400">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7874427">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874432">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7874470">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874475">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7874499">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874504">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7874528">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874533">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7874540">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874545">&#34;abcdef&#34;</span><span class="op" id="7874553">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874558">WantProxy</span><span class="op" id="7874567">:</span>&nbsp;<span class="string" id="7874569">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7874618">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874623">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7874650">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874655">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7874693">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874698">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7874722">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874727">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7874751">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874756">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7874763">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874768">&#34;abcdef&#34;</span><span class="op" id="7874776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7874779">}</span><span class="op" id="7874780">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7874784">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7874833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874837">Req</span><span class="op" id="7874840">:</span>&nbsp;<span class="ident" id="7874842">Request</span><span class="op" id="7874849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874854">Method</span><span class="op" id="7874860">:</span>&nbsp;<span class="string" id="7874862">&#34;POST&#34;</span><span class="op" id="7874868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874873">URL</span><span class="op" id="7874876">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874881">mustParseURL</span><span class="op" id="7874893">(</span><span class="string" id="7874894">&#34;http://example.com/&#34;</span><span class="op" id="7874915">)</span><span class="op" id="7874916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874921">Host</span><span class="op" id="7874925">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7874929">&#34;example.com&#34;</span><span class="op" id="7874942">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7874947">Header</span><span class="op" id="7874953">:</span>&nbsp;<span class="ident" id="7874955">Header</span><span class="op" id="7874961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7874967">&#34;Content-Length&#34;</span><span class="op" id="7874983">:</span>&nbsp;<span class="op" id="7874985">[</span><span class="op" id="7874986">]</span><span class="builtintype" id="7874987">string</span><span class="op" id="7874993">{</span><span class="string" id="7874994">&#34;10&#34;</span><span class="op" id="7874998">}</span><span class="op" id="7874999">,</span>&nbsp;<span class="comment" id="7875001">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875015">}</span><span class="op" id="7875016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875021">ContentLength</span><span class="op" id="7875034">:</span>&nbsp;<span class="num" id="7875036">6</span><span class="op" id="7875037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875041">}</span><span class="op" id="7875042">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875047">Body</span><span class="op" id="7875051">:</span>&nbsp;<span class="op" id="7875053">[</span><span class="op" id="7875054">]</span><span class="builtintype" id="7875055">byte</span><span class="op" id="7875059">(</span><span class="string" id="7875060">&#34;abcdef&#34;</span><span class="op" id="7875068">)</span><span class="op" id="7875069">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875074">WantWrite</span><span class="op" id="7875083">:</span>&nbsp;<span class="string" id="7875085">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7875107">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875112">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7875136">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875141">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7875179">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875184">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7875208">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875213">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7875220">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875225">&#34;abcdef&#34;</span><span class="op" id="7875233">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875238">WantProxy</span><span class="op" id="7875247">:</span>&nbsp;<span class="string" id="7875249">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7875289">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875294">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7875318">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875323">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7875361">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875366">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7875390">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875395">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7875402">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875407">&#34;abcdef&#34;</span><span class="op" id="7875415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875418">}</span><span class="op" id="7875419">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7875423">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875447">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875451">Req</span><span class="op" id="7875454">:</span>&nbsp;<span class="ident" id="7875456">Request</span><span class="op" id="7875463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875468">Method</span><span class="op" id="7875474">:</span>&nbsp;<span class="string" id="7875476">&#34;GET&#34;</span><span class="op" id="7875481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875486">URL</span><span class="op" id="7875489">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875494">mustParseURL</span><span class="op" id="7875506">(</span><span class="string" id="7875507">&#34;/search&#34;</span><span class="op" id="7875516">)</span><span class="op" id="7875517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875522">Host</span><span class="op" id="7875526">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7875530">&#34;www.google.com&#34;</span><span class="op" id="7875546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875550">}</span><span class="op" id="7875551">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875556">WantWrite</span><span class="op" id="7875565">:</span>&nbsp;<span class="string" id="7875567">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7875594">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875599">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7875626">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875631">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7875669">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875674">&#34;\r\n&#34;</span><span class="op" id="7875680">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875683">}</span><span class="op" id="7875684">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7875688">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875746">Req</span><span class="op" id="7875749">:</span>&nbsp;<span class="ident" id="7875751">Request</span><span class="op" id="7875758">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875763">Method</span><span class="op" id="7875769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875778">&#34;POST&#34;</span><span class="op" id="7875784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875789">URL</span><span class="op" id="7875792">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875804">mustParseURL</span><span class="op" id="7875816">(</span><span class="string" id="7875817">&#34;/&#34;</span><span class="op" id="7875820">)</span><span class="op" id="7875821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875826">Host</span><span class="op" id="7875830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7875841">&#34;example.com&#34;</span><span class="op" id="7875854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875859">ProtoMajor</span><span class="op" id="7875869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7875874">1</span><span class="op" id="7875875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875880">ProtoMinor</span><span class="op" id="7875890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7875895">1</span><span class="op" id="7875896">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875901">ContentLength</span><span class="op" id="7875914">:</span>&nbsp;<span class="num" id="7875916">0</span><span class="op" id="7875917">,</span>&nbsp;<span class="comment" id="7875919">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7875944">}</span><span class="op" id="7875945">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7875950">Body</span><span class="op" id="7875954">:</span>&nbsp;<span class="keyword" id="7875956">func</span><span class="op" id="7875960">(</span><span class="op" id="7875961">)</span>&nbsp;<span class="ident" id="7875963">io</span><span class="op" id="7875965">.</span><span class="ident" id="7875966">ReadCloser</span>&nbsp;<span class="op" id="7875977">{</span>&nbsp;<span class="keyword" id="7875979">return</span>&nbsp;<span class="ident" id="7875986">ioutil</span><span class="op" id="7875992">.</span><span class="ident" id="7875993">NopCloser</span><span class="op" id="7876002">(</span><span class="ident" id="7876003">io</span><span class="op" id="7876005">.</span><span class="ident" id="7876006">LimitReader</span><span class="op" id="7876017">(</span><span class="ident" id="7876018">strings</span><span class="op" id="7876025">.</span><span class="ident" id="7876026">NewReader</span><span class="op" id="7876035">(</span><span class="string" id="7876036">&#34;xx&#34;</span><span class="op" id="7876040">)</span><span class="op" id="7876041">,</span>&nbsp;<span class="num" id="7876043">0</span><span class="op" id="7876044">)</span><span class="op" id="7876045">)</span>&nbsp;<span class="op" id="7876047">}</span><span class="op" id="7876048">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7876053">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7876121">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7876175">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876221">WantWrite</span><span class="op" id="7876230">:</span>&nbsp;<span class="string" id="7876232">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7876254">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876259">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7876283">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876288">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7876326">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876331">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7876355">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876360">&#34;\r\n&#34;</span><span class="op" id="7876366">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876371">WantProxy</span><span class="op" id="7876380">:</span>&nbsp;<span class="string" id="7876382">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7876404">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876409">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7876433">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876438">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7876476">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876481">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7876505">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876510">&#34;\r\n&#34;</span><span class="op" id="7876516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7876519">}</span><span class="op" id="7876520">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7876524">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7876578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876582">Req</span><span class="op" id="7876585">:</span>&nbsp;<span class="ident" id="7876587">Request</span><span class="op" id="7876594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876599">Method</span><span class="op" id="7876605">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876614">&#34;POST&#34;</span><span class="op" id="7876620">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876625">URL</span><span class="op" id="7876628">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876640">mustParseURL</span><span class="op" id="7876652">(</span><span class="string" id="7876653">&#34;/&#34;</span><span class="op" id="7876656">)</span><span class="op" id="7876657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876662">Host</span><span class="op" id="7876666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876677">&#34;example.com&#34;</span><span class="op" id="7876690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876695">ProtoMajor</span><span class="op" id="7876705">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7876710">1</span><span class="op" id="7876711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876716">ProtoMinor</span><span class="op" id="7876726">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7876731">1</span><span class="op" id="7876732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876737">ContentLength</span><span class="op" id="7876750">:</span>&nbsp;<span class="num" id="7876752">0</span><span class="op" id="7876753">,</span>&nbsp;<span class="comment" id="7876755">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7876780">}</span><span class="op" id="7876781">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876786">Body</span><span class="op" id="7876790">:</span>&nbsp;<span class="keyword" id="7876792">func</span><span class="op" id="7876796">(</span><span class="op" id="7876797">)</span>&nbsp;<span class="ident" id="7876799">io</span><span class="op" id="7876801">.</span><span class="ident" id="7876802">ReadCloser</span>&nbsp;<span class="op" id="7876813">{</span>&nbsp;<span class="keyword" id="7876815">return</span>&nbsp;<span class="ident" id="7876822">ioutil</span><span class="op" id="7876828">.</span><span class="ident" id="7876829">NopCloser</span><span class="op" id="7876838">(</span><span class="ident" id="7876839">io</span><span class="op" id="7876841">.</span><span class="ident" id="7876842">LimitReader</span><span class="op" id="7876853">(</span><span class="ident" id="7876854">strings</span><span class="op" id="7876861">.</span><span class="ident" id="7876862">NewReader</span><span class="op" id="7876871">(</span><span class="string" id="7876872">&#34;xx&#34;</span><span class="op" id="7876876">)</span><span class="op" id="7876877">,</span>&nbsp;<span class="num" id="7876879">1</span><span class="op" id="7876880">)</span><span class="op" id="7876881">)</span>&nbsp;<span class="op" id="7876883">}</span><span class="op" id="7876884">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7876889">WantWrite</span><span class="op" id="7876898">:</span>&nbsp;<span class="string" id="7876900">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7876922">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876927">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7876951">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876956">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7876994">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7876999">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7877036">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877041">chunk</span><span class="op" id="7877046">(</span><span class="string" id="7877047">&#34;x&#34;</span><span class="op" id="7877050">)</span>&nbsp;<span class="op" id="7877052">+</span>&nbsp;<span class="ident" id="7877054">chunk</span><span class="op" id="7877059">(</span><span class="string" id="7877060">&#34;&#34;</span><span class="op" id="7877062">)</span><span class="op" id="7877063">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877068">WantProxy</span><span class="op" id="7877077">:</span>&nbsp;<span class="string" id="7877079">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7877101">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877106">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7877130">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877135">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7877173">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877178">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7877215">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877220">chunk</span><span class="op" id="7877225">(</span><span class="string" id="7877226">&#34;x&#34;</span><span class="op" id="7877229">)</span>&nbsp;<span class="op" id="7877231">+</span>&nbsp;<span class="ident" id="7877233">chunk</span><span class="op" id="7877238">(</span><span class="string" id="7877239">&#34;&#34;</span><span class="op" id="7877241">)</span><span class="op" id="7877242">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877245">}</span><span class="op" id="7877246">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7877250">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877312">Req</span><span class="op" id="7877315">:</span>&nbsp;<span class="ident" id="7877317">Request</span><span class="op" id="7877324">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877329">Method</span><span class="op" id="7877335">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877344">&#34;POST&#34;</span><span class="op" id="7877350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877355">URL</span><span class="op" id="7877358">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877370">mustParseURL</span><span class="op" id="7877382">(</span><span class="string" id="7877383">&#34;/&#34;</span><span class="op" id="7877386">)</span><span class="op" id="7877387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877392">Host</span><span class="op" id="7877396">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877407">&#34;example.com&#34;</span><span class="op" id="7877420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877425">ProtoMajor</span><span class="op" id="7877435">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7877440">1</span><span class="op" id="7877441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877446">ProtoMinor</span><span class="op" id="7877456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7877461">1</span><span class="op" id="7877462">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877467">ContentLength</span><span class="op" id="7877480">:</span>&nbsp;<span class="num" id="7877482">10</span><span class="op" id="7877484">,</span>&nbsp;<span class="comment" id="7877486">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877528">}</span><span class="op" id="7877529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877533">Body</span><span class="op" id="7877537">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877544">[</span><span class="op" id="7877545">]</span><span class="builtintype" id="7877546">byte</span><span class="op" id="7877550">(</span><span class="string" id="7877551">&#34;12345&#34;</span><span class="op" id="7877558">)</span><span class="op" id="7877559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877563">WantError</span><span class="op" id="7877572">:</span>&nbsp;<span class="ident" id="7877574">errors</span><span class="op" id="7877580">.</span><span class="ident" id="7877581">New</span><span class="op" id="7877584">(</span><span class="string" id="7877585">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="7877628">)</span><span class="op" id="7877629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877632">}</span><span class="op" id="7877633">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7877637">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877699">Req</span><span class="op" id="7877702">:</span>&nbsp;<span class="ident" id="7877704">Request</span><span class="op" id="7877711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877716">Method</span><span class="op" id="7877722">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877731">&#34;POST&#34;</span><span class="op" id="7877737">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877742">URL</span><span class="op" id="7877745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877757">mustParseURL</span><span class="op" id="7877769">(</span><span class="string" id="7877770">&#34;/&#34;</span><span class="op" id="7877773">)</span><span class="op" id="7877774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877779">Host</span><span class="op" id="7877783">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7877794">&#34;example.com&#34;</span><span class="op" id="7877807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877812">ProtoMajor</span><span class="op" id="7877822">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7877827">1</span><span class="op" id="7877828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877833">ProtoMinor</span><span class="op" id="7877843">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7877848">1</span><span class="op" id="7877849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877854">ContentLength</span><span class="op" id="7877867">:</span>&nbsp;<span class="num" id="7877869">4</span><span class="op" id="7877870">,</span>&nbsp;<span class="comment" id="7877872">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877916">}</span><span class="op" id="7877917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877921">Body</span><span class="op" id="7877925">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7877932">[</span><span class="op" id="7877933">]</span><span class="builtintype" id="7877934">byte</span><span class="op" id="7877938">(</span><span class="string" id="7877939">&#34;12345678&#34;</span><span class="op" id="7877949">)</span><span class="op" id="7877950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7877954">WantError</span><span class="op" id="7877963">:</span>&nbsp;<span class="ident" id="7877965">errors</span><span class="op" id="7877971">.</span><span class="ident" id="7877972">New</span><span class="op" id="7877975">(</span><span class="string" id="7877976">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="7878018">)</span><span class="op" id="7878019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878022">}</span><span class="op" id="7878023">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7878027">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878080">Req</span><span class="op" id="7878083">:</span>&nbsp;<span class="ident" id="7878085">Request</span><span class="op" id="7878092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878097">Method</span><span class="op" id="7878103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7878112">&#34;POST&#34;</span><span class="op" id="7878118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878123">URL</span><span class="op" id="7878126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878138">mustParseURL</span><span class="op" id="7878150">(</span><span class="string" id="7878151">&#34;/&#34;</span><span class="op" id="7878154">)</span><span class="op" id="7878155">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878160">Host</span><span class="op" id="7878164">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7878175">&#34;example.com&#34;</span><span class="op" id="7878188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878193">ProtoMajor</span><span class="op" id="7878203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7878208">1</span><span class="op" id="7878209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878214">ProtoMinor</span><span class="op" id="7878224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7878229">1</span><span class="op" id="7878230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878235">ContentLength</span><span class="op" id="7878248">:</span>&nbsp;<span class="num" id="7878250">5</span><span class="op" id="7878251">,</span>&nbsp;<span class="comment" id="7878253">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878282">}</span><span class="op" id="7878283">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878287">WantError</span><span class="op" id="7878296">:</span>&nbsp;<span class="ident" id="7878298">errors</span><span class="op" id="7878304">.</span><span class="ident" id="7878305">New</span><span class="op" id="7878308">(</span><span class="string" id="7878309">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="7878354">)</span><span class="op" id="7878355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878358">}</span><span class="op" id="7878359">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7878363">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878443">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878447">Req</span><span class="op" id="7878450">:</span>&nbsp;<span class="ident" id="7878452">Request</span><span class="op" id="7878459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878464">Method</span><span class="op" id="7878470">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7878479">&#34;POST&#34;</span><span class="op" id="7878485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878490">URL</span><span class="op" id="7878493">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878505">mustParseURL</span><span class="op" id="7878517">(</span><span class="string" id="7878518">&#34;/&#34;</span><span class="op" id="7878521">)</span><span class="op" id="7878522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878527">Host</span><span class="op" id="7878531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7878542">&#34;example.com&#34;</span><span class="op" id="7878555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878560">ProtoMajor</span><span class="op" id="7878570">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7878575">1</span><span class="op" id="7878576">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878581">ProtoMinor</span><span class="op" id="7878591">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7878596">1</span><span class="op" id="7878597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878602">ContentLength</span><span class="op" id="7878615">:</span>&nbsp;<span class="num" id="7878617">0</span><span class="op" id="7878618">,</span>&nbsp;<span class="comment" id="7878620">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878645">}</span><span class="op" id="7878646">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878651">Body</span><span class="op" id="7878655">:</span>&nbsp;<span class="keyword" id="7878657">func</span><span class="op" id="7878661">(</span><span class="op" id="7878662">)</span>&nbsp;<span class="ident" id="7878664">io</span><span class="op" id="7878666">.</span><span class="ident" id="7878667">ReadCloser</span>&nbsp;<span class="op" id="7878678">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878683">err</span>&nbsp;<span class="op" id="7878687">:=</span>&nbsp;<span class="ident" id="7878690">errors</span><span class="op" id="7878696">.</span><span class="ident" id="7878697">New</span><span class="op" id="7878700">(</span><span class="string" id="7878701">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7878722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878727">errReader</span>&nbsp;<span class="op" id="7878737">:=</span>&nbsp;<span class="op" id="7878740">&amp;</span><span class="ident" id="7878741">errorReader</span><span class="op" id="7878752">{</span><span class="ident" id="7878753">err</span><span class="op" id="7878756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7878761">return</span>&nbsp;<span class="ident" id="7878768">ioutil</span><span class="op" id="7878774">.</span><span class="ident" id="7878775">NopCloser</span><span class="op" id="7878784">(</span><span class="ident" id="7878785">io</span><span class="op" id="7878787">.</span><span class="ident" id="7878788">MultiReader</span><span class="op" id="7878799">(</span><span class="ident" id="7878800">strings</span><span class="op" id="7878807">.</span><span class="ident" id="7878808">NewReader</span><span class="op" id="7878817">(</span><span class="string" id="7878818">&#34;x&#34;</span><span class="op" id="7878821">)</span><span class="op" id="7878822">,</span>&nbsp;<span class="ident" id="7878824">errReader</span><span class="op" id="7878833">)</span><span class="op" id="7878834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878838">}</span><span class="op" id="7878839">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878844">WantError</span><span class="op" id="7878853">:</span>&nbsp;<span class="ident" id="7878855">errors</span><span class="op" id="7878861">.</span><span class="ident" id="7878862">New</span><span class="op" id="7878865">(</span><span class="string" id="7878866">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7878887">)</span><span class="op" id="7878888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878891">}</span><span class="op" id="7878892">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7878896">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7878972">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878976">Req</span><span class="op" id="7878979">:</span>&nbsp;<span class="ident" id="7878981">Request</span><span class="op" id="7878988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7878993">Method</span><span class="op" id="7878999">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879008">&#34;POST&#34;</span><span class="op" id="7879014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879019">URL</span><span class="op" id="7879022">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879034">mustParseURL</span><span class="op" id="7879046">(</span><span class="string" id="7879047">&#34;/&#34;</span><span class="op" id="7879050">)</span><span class="op" id="7879051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879056">Host</span><span class="op" id="7879060">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879071">&#34;example.com&#34;</span><span class="op" id="7879084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879089">ProtoMajor</span><span class="op" id="7879099">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7879104">1</span><span class="op" id="7879105">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879110">ProtoMinor</span><span class="op" id="7879120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7879125">1</span><span class="op" id="7879126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879131">ContentLength</span><span class="op" id="7879144">:</span>&nbsp;<span class="num" id="7879146">0</span><span class="op" id="7879147">,</span>&nbsp;<span class="comment" id="7879149">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879174">}</span><span class="op" id="7879175">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879180">Body</span><span class="op" id="7879184">:</span>&nbsp;<span class="keyword" id="7879186">func</span><span class="op" id="7879190">(</span><span class="op" id="7879191">)</span>&nbsp;<span class="ident" id="7879193">io</span><span class="op" id="7879195">.</span><span class="ident" id="7879196">ReadCloser</span>&nbsp;<span class="op" id="7879207">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879212">err</span>&nbsp;<span class="op" id="7879216">:=</span>&nbsp;<span class="ident" id="7879219">errors</span><span class="op" id="7879225">.</span><span class="ident" id="7879226">New</span><span class="op" id="7879229">(</span><span class="string" id="7879230">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7879251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879256">errReader</span>&nbsp;<span class="op" id="7879266">:=</span>&nbsp;<span class="op" id="7879269">&amp;</span><span class="ident" id="7879270">errorReader</span><span class="op" id="7879281">{</span><span class="ident" id="7879282">err</span><span class="op" id="7879285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7879290">return</span>&nbsp;<span class="ident" id="7879297">ioutil</span><span class="op" id="7879303">.</span><span class="ident" id="7879304">NopCloser</span><span class="op" id="7879313">(</span><span class="ident" id="7879314">errReader</span><span class="op" id="7879323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879327">}</span><span class="op" id="7879328">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879333">WantError</span><span class="op" id="7879342">:</span>&nbsp;<span class="ident" id="7879344">errors</span><span class="op" id="7879350">.</span><span class="ident" id="7879351">New</span><span class="op" id="7879354">(</span><span class="string" id="7879355">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7879376">)</span><span class="op" id="7879377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879380">}</span><span class="op" id="7879381">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7879385">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7879468">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879506">Req</span><span class="op" id="7879509">:</span>&nbsp;<span class="ident" id="7879511">Request</span><span class="op" id="7879518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879523">Method</span><span class="op" id="7879529">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879535">&#34;GET&#34;</span><span class="op" id="7879540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879545">URL</span><span class="op" id="7879548">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879557">mustParseURL</span><span class="op" id="7879569">(</span><span class="string" id="7879570">&#34;/foo&#34;</span><span class="op" id="7879576">)</span><span class="op" id="7879577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879582">ProtoMajor</span><span class="op" id="7879592">:</span>&nbsp;<span class="num" id="7879594">1</span><span class="op" id="7879595">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879600">ProtoMinor</span><span class="op" id="7879610">:</span>&nbsp;<span class="num" id="7879612">0</span><span class="op" id="7879613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879618">Header</span><span class="op" id="7879624">:</span>&nbsp;<span class="ident" id="7879626">Header</span><span class="op" id="7879632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879638">&#34;X-Foo&#34;</span><span class="op" id="7879645">:</span>&nbsp;<span class="op" id="7879647">[</span><span class="op" id="7879648">]</span><span class="builtintype" id="7879649">string</span><span class="op" id="7879655">{</span><span class="string" id="7879656">&#34;X-Bar&#34;</span><span class="op" id="7879663">}</span><span class="op" id="7879664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879669">}</span><span class="op" id="7879670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879674">}</span><span class="op" id="7879675">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7879680">WantWrite</span><span class="op" id="7879689">:</span>&nbsp;<span class="string" id="7879691">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7879715">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879720">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7879733">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879738">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7879776">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7879781">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7879803">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879806">}</span><span class="op" id="7879807">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7879811">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7879867">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7879907">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7879961">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7879998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880002">Req</span><span class="op" id="7880005">:</span>&nbsp;<span class="ident" id="7880007">Request</span><span class="op" id="7880014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880019">Method</span><span class="op" id="7880025">:</span>&nbsp;<span class="string" id="7880027">&#34;GET&#34;</span><span class="op" id="7880032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880037">Host</span><span class="op" id="7880041">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7880045">&#34;&#34;</span><span class="op" id="7880047">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880052">URL</span><span class="op" id="7880055">:</span>&nbsp;<span class="op" id="7880057">&amp;</span><span class="ident" id="7880058">url</span><span class="op" id="7880061">.</span><span class="ident" id="7880062">URL</span><span class="op" id="7880065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880071">Scheme</span><span class="op" id="7880077">:</span>&nbsp;<span class="string" id="7880079">&#34;http&#34;</span><span class="op" id="7880085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880091">Host</span><span class="op" id="7880095">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7880099">&#34;&#34;</span><span class="op" id="7880101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880107">Path</span><span class="op" id="7880111">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7880115">&#34;/search&#34;</span><span class="op" id="7880124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880129">}</span><span class="op" id="7880130">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880135">ProtoMajor</span><span class="op" id="7880145">:</span>&nbsp;<span class="num" id="7880147">1</span><span class="op" id="7880148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880153">ProtoMinor</span><span class="op" id="7880163">:</span>&nbsp;<span class="num" id="7880165">1</span><span class="op" id="7880166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880171">Header</span><span class="op" id="7880177">:</span>&nbsp;<span class="ident" id="7880179">Header</span><span class="op" id="7880185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7880191">&#34;Host&#34;</span><span class="op" id="7880197">:</span>&nbsp;<span class="op" id="7880199">[</span><span class="op" id="7880200">]</span><span class="builtintype" id="7880201">string</span><span class="op" id="7880207">{</span><span class="string" id="7880208">&#34;bad.example.com&#34;</span><span class="op" id="7880225">}</span><span class="op" id="7880226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880231">}</span><span class="op" id="7880232">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880236">}</span><span class="op" id="7880237">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880242">WantWrite</span><span class="op" id="7880251">:</span>&nbsp;<span class="string" id="7880253">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7880280">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7880285">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7880298">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7880303">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7880344">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880347">}</span><span class="op" id="7880348">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7880352">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880402">Req</span><span class="op" id="7880405">:</span>&nbsp;<span class="ident" id="7880407">Request</span><span class="op" id="7880414">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880419">Method</span><span class="op" id="7880425">:</span>&nbsp;<span class="string" id="7880427">&#34;GET&#34;</span><span class="op" id="7880432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880437">URL</span><span class="op" id="7880440">:</span>&nbsp;<span class="op" id="7880442">&amp;</span><span class="ident" id="7880443">url</span><span class="op" id="7880446">.</span><span class="ident" id="7880447">URL</span><span class="op" id="7880450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880456">Scheme</span><span class="op" id="7880462">:</span>&nbsp;<span class="string" id="7880464">&#34;http&#34;</span><span class="op" id="7880470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880476">Host</span><span class="op" id="7880480">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7880484">&#34;www.google.com&#34;</span><span class="op" id="7880500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880506">Opaque</span><span class="op" id="7880512">:</span>&nbsp;<span class="string" id="7880514">&#34;/%2F/%2F/&#34;</span><span class="op" id="7880525">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880530">}</span><span class="op" id="7880531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880536">ProtoMajor</span><span class="op" id="7880546">:</span>&nbsp;<span class="num" id="7880548">1</span><span class="op" id="7880549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880554">ProtoMinor</span><span class="op" id="7880564">:</span>&nbsp;<span class="num" id="7880566">1</span><span class="op" id="7880567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880572">Header</span><span class="op" id="7880578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880584">Header</span><span class="op" id="7880590">{</span><span class="op" id="7880591">}</span><span class="op" id="7880592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880596">}</span><span class="op" id="7880597">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880602">WantWrite</span><span class="op" id="7880611">:</span>&nbsp;<span class="string" id="7880613">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7880642">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7880647">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7880674">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7880679">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7880720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880723">}</span><span class="op" id="7880724">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7880728">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880778">Req</span><span class="op" id="7880781">:</span>&nbsp;<span class="ident" id="7880783">Request</span><span class="op" id="7880790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880795">Method</span><span class="op" id="7880801">:</span>&nbsp;<span class="string" id="7880803">&#34;GET&#34;</span><span class="op" id="7880808">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880813">URL</span><span class="op" id="7880816">:</span>&nbsp;<span class="op" id="7880818">&amp;</span><span class="ident" id="7880819">url</span><span class="op" id="7880822">.</span><span class="ident" id="7880823">URL</span><span class="op" id="7880826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880832">Scheme</span><span class="op" id="7880838">:</span>&nbsp;<span class="string" id="7880840">&#34;http&#34;</span><span class="op" id="7880846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880852">Host</span><span class="op" id="7880856">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7880860">&#34;x.google.com&#34;</span><span class="op" id="7880874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880880">Opaque</span><span class="op" id="7880886">:</span>&nbsp;<span class="string" id="7880888">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="7880913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880918">}</span><span class="op" id="7880919">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880924">ProtoMajor</span><span class="op" id="7880934">:</span>&nbsp;<span class="num" id="7880936">1</span><span class="op" id="7880937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880942">ProtoMinor</span><span class="op" id="7880952">:</span>&nbsp;<span class="num" id="7880954">1</span><span class="op" id="7880955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880960">Header</span><span class="op" id="7880966">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880972">Header</span><span class="op" id="7880978">{</span><span class="op" id="7880979">}</span><span class="op" id="7880980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7880984">}</span><span class="op" id="7880985">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7880990">WantWrite</span><span class="op" id="7880999">:</span>&nbsp;<span class="string" id="7881001">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7881049">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881054">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7881079">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881084">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7881125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881128">}</span><span class="op" id="7881129">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7881133">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881189">Req</span><span class="op" id="7881192">:</span>&nbsp;<span class="ident" id="7881194">Request</span><span class="op" id="7881201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881206">Method</span><span class="op" id="7881212">:</span>&nbsp;<span class="string" id="7881214">&#34;GET&#34;</span><span class="op" id="7881219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881224">URL</span><span class="op" id="7881227">:</span>&nbsp;<span class="op" id="7881229">&amp;</span><span class="ident" id="7881230">url</span><span class="op" id="7881233">.</span><span class="ident" id="7881234">URL</span><span class="op" id="7881237">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881243">Scheme</span><span class="op" id="7881249">:</span>&nbsp;<span class="string" id="7881251">&#34;http&#34;</span><span class="op" id="7881257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881263">Host</span><span class="op" id="7881267">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7881271">&#34;www.google.com&#34;</span><span class="op" id="7881287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881293">Path</span><span class="op" id="7881297">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7881301">&#34;/&#34;</span><span class="op" id="7881304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881309">}</span><span class="op" id="7881310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881315">Proto</span><span class="op" id="7881320">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881327">&#34;HTTP/1.1&#34;</span><span class="op" id="7881337">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881342">ProtoMajor</span><span class="op" id="7881352">:</span>&nbsp;<span class="num" id="7881354">1</span><span class="op" id="7881355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881360">ProtoMinor</span><span class="op" id="7881370">:</span>&nbsp;<span class="num" id="7881372">1</span><span class="op" id="7881373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881378">Header</span><span class="op" id="7881384">:</span>&nbsp;<span class="ident" id="7881386">Header</span><span class="op" id="7881392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881398">&#34;ALL-CAPS&#34;</span><span class="op" id="7881408">:</span>&nbsp;<span class="op" id="7881410">{</span><span class="string" id="7881411">&#34;x&#34;</span><span class="op" id="7881414">}</span><span class="op" id="7881415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881420">}</span><span class="op" id="7881421">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881425">}</span><span class="op" id="7881426">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881431">WantWrite</span><span class="op" id="7881440">:</span>&nbsp;<span class="string" id="7881442">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7881463">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881468">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7881495">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881500">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7881538">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881543">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="7881561">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7881566">&#34;\r\n&#34;</span><span class="op" id="7881572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881575">}</span><span class="op" id="7881576">,</span><br>
<span class="lineno"></span><span class="op" id="7881578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="7881581">func</span>&nbsp;<span class="ident" id="7881586">TestRequestWrite</span><span class="op" id="7881602">(</span><span class="ident" id="7881603">t</span>&nbsp;<span class="op" id="7881605">*</span><span class="ident" id="7881606">testing</span><span class="op" id="7881613">.</span><span class="ident" id="7881614">T</span><span class="op" id="7881615">)</span>&nbsp;<span class="op" id="7881617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881620">for</span>&nbsp;<span class="ident" id="7881624">i</span>&nbsp;<span class="op" id="7881626">:=</span>&nbsp;<span class="keyword" id="7881629">range</span>&nbsp;<span class="ident" id="7881635">reqWriteTests</span>&nbsp;<span class="op" id="7881649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881653">tt</span>&nbsp;<span class="op" id="7881656">:=</span>&nbsp;<span class="op" id="7881659">&amp;</span><span class="ident" id="7881660">reqWriteTests</span><span class="op" id="7881673">[</span><span class="ident" id="7881674">i</span><span class="op" id="7881675">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881680">setBody</span>&nbsp;<span class="op" id="7881688">:=</span>&nbsp;<span class="keyword" id="7881691">func</span><span class="op" id="7881695">(</span><span class="op" id="7881696">)</span>&nbsp;<span class="op" id="7881698">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881703">if</span>&nbsp;<span class="ident" id="7881706">tt</span><span class="op" id="7881708">.</span><span class="ident" id="7881709">Body</span>&nbsp;<span class="op" id="7881714">==</span>&nbsp;<span class="builtintype" id="7881717">nil</span>&nbsp;<span class="op" id="7881721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881727">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881742">switch</span>&nbsp;<span class="ident" id="7881749">b</span>&nbsp;<span class="op" id="7881751">:=</span>&nbsp;<span class="ident" id="7881754">tt</span><span class="op" id="7881756">.</span><span class="ident" id="7881757">Body</span><span class="op" id="7881761">.</span><span class="op" id="7881762">(</span><span class="keyword" id="7881763">type</span><span class="op" id="7881767">)</span>&nbsp;<span class="op" id="7881769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881774">case</span>&nbsp;<span class="op" id="7881779">[</span><span class="op" id="7881780">]</span><span class="builtintype" id="7881781">byte</span><span class="op" id="7881785">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881791">tt</span><span class="op" id="7881793">.</span><span class="ident" id="7881794">Req</span><span class="op" id="7881797">.</span><span class="ident" id="7881798">Body</span>&nbsp;<span class="op" id="7881803">=</span>&nbsp;<span class="ident" id="7881805">ioutil</span><span class="op" id="7881811">.</span><span class="ident" id="7881812">NopCloser</span><span class="op" id="7881821">(</span><span class="ident" id="7881822">bytes</span><span class="op" id="7881827">.</span><span class="ident" id="7881828">NewReader</span><span class="op" id="7881837">(</span><span class="ident" id="7881838">b</span><span class="op" id="7881839">)</span><span class="op" id="7881840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881845">case</span>&nbsp;<span class="keyword" id="7881850">func</span><span class="op" id="7881854">(</span><span class="op" id="7881855">)</span>&nbsp;<span class="ident" id="7881857">io</span><span class="op" id="7881859">.</span><span class="ident" id="7881860">ReadCloser</span><span class="op" id="7881870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881876">tt</span><span class="op" id="7881878">.</span><span class="ident" id="7881879">Req</span><span class="op" id="7881882">.</span><span class="ident" id="7881883">Body</span>&nbsp;<span class="op" id="7881888">=</span>&nbsp;<span class="ident" id="7881890">b</span><span class="op" id="7881891">(</span><span class="op" id="7881892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881901">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881905">setBody</span><span class="op" id="7881912">(</span><span class="op" id="7881913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881917">if</span>&nbsp;<span class="ident" id="7881920">tt</span><span class="op" id="7881922">.</span><span class="ident" id="7881923">Req</span><span class="op" id="7881926">.</span><span class="ident" id="7881927">Header</span>&nbsp;<span class="op" id="7881934">==</span>&nbsp;<span class="builtintype" id="7881937">nil</span>&nbsp;<span class="op" id="7881941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7881946">tt</span><span class="op" id="7881948">.</span><span class="ident" id="7881949">Req</span><span class="op" id="7881952">.</span><span class="ident" id="7881953">Header</span>&nbsp;<span class="op" id="7881960">=</span>&nbsp;<span class="builtinfunc" id="7881962">make</span><span class="op" id="7881966">(</span><span class="ident" id="7881967">Header</span><span class="op" id="7881973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7881977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7881982">var</span>&nbsp;<span class="ident" id="7881986">braw</span>&nbsp;<span class="ident" id="7881991">bytes</span><span class="op" id="7881996">.</span><span class="ident" id="7881997">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882006">err</span>&nbsp;<span class="op" id="7882010">:=</span>&nbsp;<span class="ident" id="7882013">tt</span><span class="op" id="7882015">.</span><span class="ident" id="7882016">Req</span><span class="op" id="7882019">.</span><span class="ident" id="7882020">Write</span><span class="op" id="7882025">(</span><span class="op" id="7882026">&amp;</span><span class="ident" id="7882027">braw</span><span class="op" id="7882031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882035">if</span>&nbsp;<span class="ident" id="7882038">g</span><span class="op" id="7882039">,</span>&nbsp;<span class="ident" id="7882041">e</span>&nbsp;<span class="op" id="7882043">:=</span>&nbsp;<span class="ident" id="7882046">fmt</span><span class="op" id="7882049">.</span><span class="ident" id="7882050">Sprintf</span><span class="op" id="7882057">(</span><span class="string" id="7882058">&#34;%v&#34;</span><span class="op" id="7882062">,</span>&nbsp;<span class="ident" id="7882064">err</span><span class="op" id="7882067">)</span><span class="op" id="7882068">,</span>&nbsp;<span class="ident" id="7882070">fmt</span><span class="op" id="7882073">.</span><span class="ident" id="7882074">Sprintf</span><span class="op" id="7882081">(</span><span class="string" id="7882082">&#34;%v&#34;</span><span class="op" id="7882086">,</span>&nbsp;<span class="ident" id="7882088">tt</span><span class="op" id="7882090">.</span><span class="ident" id="7882091">WantError</span><span class="op" id="7882100">)</span><span class="op" id="7882101">;</span>&nbsp;<span class="ident" id="7882103">g</span>&nbsp;<span class="op" id="7882105">!=</span>&nbsp;<span class="ident" id="7882108">e</span>&nbsp;<span class="op" id="7882110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882115">t</span><span class="op" id="7882116">.</span><span class="ident" id="7882117">Errorf</span><span class="op" id="7882123">(</span><span class="string" id="7882124">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7882156">,</span>&nbsp;<span class="ident" id="7882158">i</span><span class="op" id="7882159">,</span>&nbsp;<span class="ident" id="7882161">g</span><span class="op" id="7882162">,</span>&nbsp;<span class="ident" id="7882164">e</span><span class="op" id="7882165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882170">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882185">if</span>&nbsp;<span class="ident" id="7882188">err</span>&nbsp;<span class="op" id="7882192">!=</span>&nbsp;<span class="builtintype" id="7882195">nil</span>&nbsp;<span class="op" id="7882199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882204">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882220">if</span>&nbsp;<span class="ident" id="7882223">tt</span><span class="op" id="7882225">.</span><span class="ident" id="7882226">WantWrite</span>&nbsp;<span class="op" id="7882236">!=</span>&nbsp;<span class="string" id="7882239">&#34;&#34;</span>&nbsp;<span class="op" id="7882242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882247">sraw</span>&nbsp;<span class="op" id="7882252">:=</span>&nbsp;<span class="ident" id="7882255">braw</span><span class="op" id="7882259">.</span><span class="ident" id="7882260">String</span><span class="op" id="7882266">(</span><span class="op" id="7882267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882272">if</span>&nbsp;<span class="ident" id="7882275">sraw</span>&nbsp;<span class="op" id="7882280">!=</span>&nbsp;<span class="ident" id="7882283">tt</span><span class="op" id="7882285">.</span><span class="ident" id="7882286">WantWrite</span>&nbsp;<span class="op" id="7882296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882302">t</span><span class="op" id="7882303">.</span><span class="ident" id="7882304">Errorf</span><span class="op" id="7882310">(</span><span class="string" id="7882311">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7882348">,</span>&nbsp;<span class="ident" id="7882350">i</span><span class="op" id="7882351">,</span>&nbsp;<span class="ident" id="7882353">tt</span><span class="op" id="7882355">.</span><span class="ident" id="7882356">WantWrite</span><span class="op" id="7882365">,</span>&nbsp;<span class="ident" id="7882367">sraw</span><span class="op" id="7882371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882377">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882398">if</span>&nbsp;<span class="ident" id="7882401">tt</span><span class="op" id="7882403">.</span><span class="ident" id="7882404">WantProxy</span>&nbsp;<span class="op" id="7882414">!=</span>&nbsp;<span class="string" id="7882417">&#34;&#34;</span>&nbsp;<span class="op" id="7882420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882425">setBody</span><span class="op" id="7882432">(</span><span class="op" id="7882433">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882438">var</span>&nbsp;<span class="ident" id="7882442">praw</span>&nbsp;<span class="ident" id="7882447">bytes</span><span class="op" id="7882452">.</span><span class="ident" id="7882453">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882463">err</span>&nbsp;<span class="op" id="7882467">=</span>&nbsp;<span class="ident" id="7882469">tt</span><span class="op" id="7882471">.</span><span class="ident" id="7882472">Req</span><span class="op" id="7882475">.</span><span class="ident" id="7882476">WriteProxy</span><span class="op" id="7882486">(</span><span class="op" id="7882487">&amp;</span><span class="ident" id="7882488">praw</span><span class="op" id="7882492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882497">if</span>&nbsp;<span class="ident" id="7882500">err</span>&nbsp;<span class="op" id="7882504">!=</span>&nbsp;<span class="builtintype" id="7882507">nil</span>&nbsp;<span class="op" id="7882511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882517">t</span><span class="op" id="7882518">.</span><span class="ident" id="7882519">Errorf</span><span class="op" id="7882525">(</span><span class="string" id="7882526">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7882546">,</span>&nbsp;<span class="ident" id="7882548">i</span><span class="op" id="7882549">,</span>&nbsp;<span class="ident" id="7882551">err</span><span class="op" id="7882554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882560">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882577">sraw</span>&nbsp;<span class="op" id="7882582">:=</span>&nbsp;<span class="ident" id="7882585">praw</span><span class="op" id="7882589">.</span><span class="ident" id="7882590">String</span><span class="op" id="7882596">(</span><span class="op" id="7882597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882602">if</span>&nbsp;<span class="ident" id="7882605">sraw</span>&nbsp;<span class="op" id="7882610">!=</span>&nbsp;<span class="ident" id="7882613">tt</span><span class="op" id="7882615">.</span><span class="ident" id="7882616">WantProxy</span>&nbsp;<span class="op" id="7882626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882632">t</span><span class="op" id="7882633">.</span><span class="ident" id="7882634">Errorf</span><span class="op" id="7882640">(</span><span class="string" id="7882641">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7882684">,</span>&nbsp;<span class="ident" id="7882686">i</span><span class="op" id="7882687">,</span>&nbsp;<span class="ident" id="7882689">tt</span><span class="op" id="7882691">.</span><span class="ident" id="7882692">WantProxy</span><span class="op" id="7882701">,</span>&nbsp;<span class="ident" id="7882703">sraw</span><span class="op" id="7882707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882713">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7882732">}</span><br>
<span class="lineno"></span><span class="op" id="7882734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7882737">type</span>&nbsp;<span class="ident" id="7882742">closeChecker</span>&nbsp;<span class="keyword" id="7882755">struct</span>&nbsp;<span class="op" id="7882762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882765">io</span><span class="op" id="7882767">.</span><span class="ident" id="7882768">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882776">closed</span>&nbsp;<span class="builtintype" id="7882783">bool</span><br>
<span class="lineno"></span><span class="op" id="7882788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="7882791">func</span>&nbsp;<span class="op" id="7882796">(</span><span class="ident" id="7882797">rc</span>&nbsp;<span class="op" id="7882800">*</span><span class="ident" id="7882801">closeChecker</span><span class="op" id="7882813">)</span>&nbsp;<span class="ident" id="7882815">Close</span><span class="op" id="7882820">(</span><span class="op" id="7882821">)</span>&nbsp;<span class="builtintype" id="7882823">error</span>&nbsp;<span class="op" id="7882829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7882832">rc</span><span class="op" id="7882834">.</span><span class="ident" id="7882835">closed</span>&nbsp;<span class="op" id="7882842">=</span>&nbsp;<span class="builtintype" id="7882844">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7882850">return</span>&nbsp;<span class="builtintype" id="7882857">nil</span><br>
<span class="lineno"></span><span class="op" id="7882861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="7882864">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="7882948">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="7883031">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="7883091">func</span>&nbsp;<span class="ident" id="7883096">TestRequestWriteClosesBody</span><span class="op" id="7883122">(</span><span class="ident" id="7883123">t</span>&nbsp;<span class="op" id="7883125">*</span><span class="ident" id="7883126">testing</span><span class="op" id="7883133">.</span><span class="ident" id="7883134">T</span><span class="op" id="7883135">)</span>&nbsp;<span class="op" id="7883137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883140">rc</span>&nbsp;<span class="op" id="7883143">:=</span>&nbsp;<span class="op" id="7883146">&amp;</span><span class="ident" id="7883147">closeChecker</span><span class="op" id="7883159">{</span><span class="ident" id="7883160">Reader</span><span class="op" id="7883166">:</span>&nbsp;<span class="ident" id="7883168">strings</span><span class="op" id="7883175">.</span><span class="ident" id="7883176">NewReader</span><span class="op" id="7883185">(</span><span class="string" id="7883186">&#34;my&nbsp;body&#34;</span><span class="op" id="7883195">)</span><span class="op" id="7883196">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883199">req</span><span class="op" id="7883202">,</span>&nbsp;<span class="ident" id="7883204">_</span>&nbsp;<span class="op" id="7883206">:=</span>&nbsp;<span class="ident" id="7883209">NewRequest</span><span class="op" id="7883219">(</span><span class="string" id="7883220">&#34;POST&#34;</span><span class="op" id="7883226">,</span>&nbsp;<span class="string" id="7883228">&#34;http://foo.com/&#34;</span><span class="op" id="7883245">,</span>&nbsp;<span class="ident" id="7883247">rc</span><span class="op" id="7883249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7883252">if</span>&nbsp;<span class="ident" id="7883255">req</span><span class="op" id="7883258">.</span><span class="ident" id="7883259">ContentLength</span>&nbsp;<span class="op" id="7883273">!=</span>&nbsp;<span class="num" id="7883276">0</span>&nbsp;<span class="op" id="7883278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883282">t</span><span class="op" id="7883283">.</span><span class="ident" id="7883284">Errorf</span><span class="op" id="7883290">(</span><span class="string" id="7883291">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7883325">,</span>&nbsp;<span class="ident" id="7883327">req</span><span class="op" id="7883330">.</span><span class="ident" id="7883331">ContentLength</span><span class="op" id="7883344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7883347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883350">buf</span>&nbsp;<span class="op" id="7883354">:=</span>&nbsp;<span class="builtinfunc" id="7883357">new</span><span class="op" id="7883360">(</span><span class="ident" id="7883361">bytes</span><span class="op" id="7883366">.</span><span class="ident" id="7883367">Buffer</span><span class="op" id="7883373">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883376">req</span><span class="op" id="7883379">.</span><span class="ident" id="7883380">Write</span><span class="op" id="7883385">(</span><span class="ident" id="7883386">buf</span><span class="op" id="7883389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7883392">if</span>&nbsp;<span class="op" id="7883395">!</span><span class="ident" id="7883396">rc</span><span class="op" id="7883398">.</span><span class="ident" id="7883399">closed</span>&nbsp;<span class="op" id="7883406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883410">t</span><span class="op" id="7883411">.</span><span class="ident" id="7883412">Error</span><span class="op" id="7883417">(</span><span class="string" id="7883418">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="7883447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7883450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883453">expected</span>&nbsp;<span class="op" id="7883462">:=</span>&nbsp;<span class="string" id="7883465">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7883487">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7883491">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="7883511">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7883515">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7883553">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7883557">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7883594">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7883598">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7883664">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7883734">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7883805">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883862">chunk</span><span class="op" id="7883867">(</span><span class="string" id="7883868">&#34;m&#34;</span><span class="op" id="7883871">)</span>&nbsp;<span class="op" id="7883873">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883877">chunk</span><span class="op" id="7883882">(</span><span class="string" id="7883883">&#34;y&nbsp;body&#34;</span><span class="op" id="7883891">)</span>&nbsp;<span class="op" id="7883893">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883897">chunk</span><span class="op" id="7883902">(</span><span class="string" id="7883903">&#34;&#34;</span><span class="op" id="7883905">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7883908">if</span>&nbsp;<span class="ident" id="7883911">buf</span><span class="op" id="7883914">.</span><span class="ident" id="7883915">String</span><span class="op" id="7883921">(</span><span class="op" id="7883922">)</span>&nbsp;<span class="op" id="7883924">!=</span>&nbsp;<span class="ident" id="7883927">expected</span>&nbsp;<span class="op" id="7883936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7883940">t</span><span class="op" id="7883941">.</span><span class="ident" id="7883942">Errorf</span><span class="op" id="7883948">(</span><span class="string" id="7883949">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7883977">,</span>&nbsp;<span class="ident" id="7883979">buf</span><span class="op" id="7883982">.</span><span class="ident" id="7883983">String</span><span class="op" id="7883989">(</span><span class="op" id="7883990">)</span><span class="op" id="7883991">,</span>&nbsp;<span class="ident" id="7883993">expected</span><span class="op" id="7884001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7884004">}</span><br>
<span class="lineno"></span><span class="op" id="7884006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="7884009">func</span>&nbsp;<span class="ident" id="7884014">chunk</span><span class="op" id="7884019">(</span><span class="ident" id="7884020">s</span>&nbsp;<span class="builtintype" id="7884022">string</span><span class="op" id="7884028">)</span>&nbsp;<span class="builtintype" id="7884030">string</span>&nbsp;<span class="op" id="7884037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7884040">return</span>&nbsp;<span class="ident" id="7884047">fmt</span><span class="op" id="7884050">.</span><span class="ident" id="7884051">Sprintf</span><span class="op" id="7884058">(</span><span class="string" id="7884059">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7884073">,</span>&nbsp;<span class="builtinfunc" id="7884075">len</span><span class="op" id="7884078">(</span><span class="ident" id="7884079">s</span><span class="op" id="7884080">)</span><span class="op" id="7884081">,</span>&nbsp;<span class="ident" id="7884083">s</span><span class="op" id="7884084">)</span><br>
<span class="lineno"></span><span class="op" id="7884086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884089">func</span>&nbsp;<span class="ident" id="7884094">mustParseURL</span><span class="op" id="7884106">(</span><span class="ident" id="7884107">s</span>&nbsp;<span class="builtintype" id="7884109">string</span><span class="op" id="7884115">)</span>&nbsp;<span class="op" id="7884117">*</span><span class="ident" id="7884118">url</span><span class="op" id="7884121">.</span><span class="ident" id="7884122">URL</span>&nbsp;<span class="op" id="7884126">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884129">u</span><span class="op" id="7884130">,</span>&nbsp;<span class="ident" id="7884132">err</span>&nbsp;<span class="op" id="7884136">:=</span>&nbsp;<span class="ident" id="7884139">url</span><span class="op" id="7884142">.</span><span class="ident" id="7884143">Parse</span><span class="op" id="7884148">(</span><span class="ident" id="7884149">s</span><span class="op" id="7884150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7884153">if</span>&nbsp;<span class="ident" id="7884156">err</span>&nbsp;<span class="op" id="7884160">!=</span>&nbsp;<span class="builtintype" id="7884163">nil</span>&nbsp;<span class="op" id="7884167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7884171">panic</span><span class="op" id="7884176">(</span><span class="ident" id="7884177">fmt</span><span class="op" id="7884180">.</span><span class="ident" id="7884181">Sprintf</span><span class="op" id="7884188">(</span><span class="string" id="7884189">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7884215">,</span>&nbsp;<span class="ident" id="7884217">s</span><span class="op" id="7884218">,</span>&nbsp;<span class="ident" id="7884220">err</span><span class="op" id="7884223">)</span><span class="op" id="7884224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7884227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7884230">return</span>&nbsp;<span class="ident" id="7884237">u</span><br>
<span class="lineno">565</span><span class="op" id="7884239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884242">type</span>&nbsp;<span class="ident" id="7884247">writerFunc</span>&nbsp;<span class="keyword" id="7884258">func</span><span class="op" id="7884262">(</span><span class="op" id="7884263">[</span><span class="op" id="7884264">]</span><span class="builtintype" id="7884265">byte</span><span class="op" id="7884269">)</span>&nbsp;<span class="op" id="7884271">(</span><span class="builtintype" id="7884272">int</span><span class="op" id="7884275">,</span>&nbsp;<span class="builtintype" id="7884277">error</span><span class="op" id="7884282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7884285">func</span>&nbsp;<span class="op" id="7884290">(</span><span class="ident" id="7884291">f</span>&nbsp;<span class="ident" id="7884293">writerFunc</span><span class="op" id="7884303">)</span>&nbsp;<span class="ident" id="7884305">Write</span><span class="op" id="7884310">(</span><span class="ident" id="7884311">p</span>&nbsp;<span class="op" id="7884313">[</span><span class="op" id="7884314">]</span><span class="builtintype" id="7884315">byte</span><span class="op" id="7884319">)</span>&nbsp;<span class="op" id="7884321">(</span><span class="builtintype" id="7884322">int</span><span class="op" id="7884325">,</span>&nbsp;<span class="builtintype" id="7884327">error</span><span class="op" id="7884332">)</span>&nbsp;<span class="op" id="7884334">{</span>&nbsp;<span class="keyword" id="7884336">return</span>&nbsp;<span class="ident" id="7884343">f</span><span class="op" id="7884344">(</span><span class="ident" id="7884345">p</span><span class="op" id="7884346">)</span>&nbsp;<span class="op" id="7884348">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="7884351">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="7884431">func</span>&nbsp;<span class="ident" id="7884436">TestRequestWriteError</span><span class="op" id="7884457">(</span><span class="ident" id="7884458">t</span>&nbsp;<span class="op" id="7884460">*</span><span class="ident" id="7884461">testing</span><span class="op" id="7884468">.</span><span class="ident" id="7884469">T</span><span class="op" id="7884470">)</span>&nbsp;<span class="op" id="7884472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884475">failAfter</span><span class="op" id="7884484">,</span>&nbsp;<span class="ident" id="7884486">writeCount</span>&nbsp;<span class="op" id="7884497">:=</span>&nbsp;<span class="num" id="7884500">0</span><span class="op" id="7884501">,</span>&nbsp;<span class="num" id="7884503">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884506">errFail</span>&nbsp;<span class="op" id="7884514">:=</span>&nbsp;<span class="ident" id="7884517">errors</span><span class="op" id="7884523">.</span><span class="ident" id="7884524">New</span><span class="op" id="7884527">(</span><span class="string" id="7884528">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7884548">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7884552">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7884613">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7884676">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7884729">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884745">w</span>&nbsp;<span class="op" id="7884747">:=</span>&nbsp;<span class="keyword" id="7884750">struct</span>&nbsp;<span class="op" id="7884757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884761">io</span><span class="op" id="7884763">.</span><span class="ident" id="7884764">ByteWriter</span>&nbsp;<span class="comment" id="7884775">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884821">io</span><span class="op" id="7884823">.</span><span class="ident" id="7884824">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7884832">}</span><span class="op" id="7884833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7884837">nil</span><span class="op" id="7884840">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884844">writerFunc</span><span class="op" id="7884854">(</span><span class="keyword" id="7884855">func</span><span class="op" id="7884859">(</span><span class="ident" id="7884860">p</span>&nbsp;<span class="op" id="7884862">[</span><span class="op" id="7884863">]</span><span class="builtintype" id="7884864">byte</span><span class="op" id="7884868">)</span>&nbsp;<span class="op" id="7884870">(</span><span class="ident" id="7884871">n</span>&nbsp;<span class="builtintype" id="7884873">int</span><span class="op" id="7884876">,</span>&nbsp;<span class="ident" id="7884878">err</span>&nbsp;<span class="builtintype" id="7884882">error</span><span class="op" id="7884887">)</span>&nbsp;<span class="op" id="7884889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884894">writeCount</span><span class="op" id="7884904">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7884910">if</span>&nbsp;<span class="ident" id="7884913">failAfter</span>&nbsp;<span class="op" id="7884923">==</span>&nbsp;<span class="num" id="7884926">0</span>&nbsp;<span class="op" id="7884928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884934">err</span>&nbsp;<span class="op" id="7884938">=</span>&nbsp;<span class="ident" id="7884940">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7884951">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7884956">failAfter</span><span class="op" id="7884965">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7884971">return</span>&nbsp;<span class="builtinfunc" id="7884978">len</span><span class="op" id="7884981">(</span><span class="ident" id="7884982">p</span><span class="op" id="7884983">)</span><span class="op" id="7884984">,</span>&nbsp;<span class="ident" id="7884986">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7884992">}</span><span class="op" id="7884993">)</span><span class="op" id="7884994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7884997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885001">req</span><span class="op" id="7885004">,</span>&nbsp;<span class="ident" id="7885006">_</span>&nbsp;<span class="op" id="7885008">:=</span>&nbsp;<span class="ident" id="7885011">NewRequest</span><span class="op" id="7885021">(</span><span class="string" id="7885022">&#34;GET&#34;</span><span class="op" id="7885027">,</span>&nbsp;<span class="string" id="7885029">&#34;http://example.com/&#34;</span><span class="op" id="7885050">,</span>&nbsp;<span class="builtintype" id="7885052">nil</span><span class="op" id="7885055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885058">const</span>&nbsp;<span class="ident" id="7885064">writeCalls</span>&nbsp;<span class="op" id="7885075">=</span>&nbsp;<span class="num" id="7885077">4</span>&nbsp;<span class="comment" id="7885079">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885131">sawGood</span>&nbsp;<span class="op" id="7885139">:=</span>&nbsp;<span class="builtintype" id="7885142">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885149">for</span>&nbsp;<span class="ident" id="7885153">n</span>&nbsp;<span class="op" id="7885155">:=</span>&nbsp;<span class="num" id="7885158">0</span><span class="op" id="7885159">;</span>&nbsp;<span class="ident" id="7885161">n</span>&nbsp;<span class="op" id="7885163">&lt;=</span>&nbsp;<span class="ident" id="7885166">writeCalls</span><span class="op" id="7885176">+</span><span class="num" id="7885177">2</span><span class="op" id="7885178">;</span>&nbsp;<span class="ident" id="7885180">n</span><span class="op" id="7885181">++</span>&nbsp;<span class="op" id="7885184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885188">failAfter</span>&nbsp;<span class="op" id="7885198">=</span>&nbsp;<span class="ident" id="7885200">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885204">writeCount</span>&nbsp;<span class="op" id="7885215">=</span>&nbsp;<span class="num" id="7885217">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885221">err</span>&nbsp;<span class="op" id="7885225">:=</span>&nbsp;<span class="ident" id="7885228">req</span><span class="op" id="7885231">.</span><span class="ident" id="7885232">Write</span><span class="op" id="7885237">(</span><span class="ident" id="7885238">w</span><span class="op" id="7885239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885243">var</span>&nbsp;<span class="ident" id="7885247">wantErr</span>&nbsp;<span class="builtintype" id="7885255">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885263">if</span>&nbsp;<span class="ident" id="7885266">n</span>&nbsp;<span class="op" id="7885268">&lt;</span>&nbsp;<span class="ident" id="7885270">writeCalls</span>&nbsp;<span class="op" id="7885281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885286">wantErr</span>&nbsp;<span class="op" id="7885294">=</span>&nbsp;<span class="ident" id="7885296">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885310">if</span>&nbsp;<span class="ident" id="7885313">err</span>&nbsp;<span class="op" id="7885317">!=</span>&nbsp;<span class="ident" id="7885320">wantErr</span>&nbsp;<span class="op" id="7885328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885333">t</span><span class="op" id="7885334">.</span><span class="ident" id="7885335">Errorf</span><span class="op" id="7885341">(</span><span class="string" id="7885342">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7885387">,</span>&nbsp;<span class="ident" id="7885389">n</span><span class="op" id="7885390">,</span>&nbsp;<span class="ident" id="7885392">err</span><span class="op" id="7885395">,</span>&nbsp;<span class="ident" id="7885397">wantErr</span><span class="op" id="7885404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885409">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885420">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885424">if</span>&nbsp;<span class="ident" id="7885427">err</span>&nbsp;<span class="op" id="7885431">==</span>&nbsp;<span class="builtintype" id="7885434">nil</span>&nbsp;<span class="op" id="7885438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885443">sawGood</span>&nbsp;<span class="op" id="7885451">=</span>&nbsp;<span class="builtintype" id="7885453">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885461">if</span>&nbsp;<span class="ident" id="7885464">writeCount</span>&nbsp;<span class="op" id="7885475">!=</span>&nbsp;<span class="ident" id="7885478">writeCalls</span>&nbsp;<span class="op" id="7885489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885495">t</span><span class="op" id="7885496">.</span><span class="ident" id="7885497">Fatalf</span><span class="op" id="7885503">(</span><span class="string" id="7885504">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7885545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885550">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885558">if</span>&nbsp;<span class="ident" id="7885561">writeCount</span>&nbsp;<span class="op" id="7885572">&gt;</span>&nbsp;<span class="ident" id="7885574">writeCalls</span>&nbsp;<span class="op" id="7885585">||</span>&nbsp;<span class="ident" id="7885588">writeCount</span>&nbsp;<span class="op" id="7885599">&gt;</span>&nbsp;<span class="ident" id="7885601">n</span><span class="op" id="7885602">+</span><span class="num" id="7885603">1</span>&nbsp;<span class="op" id="7885605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885610">t</span><span class="op" id="7885611">.</span><span class="ident" id="7885612">Errorf</span><span class="op" id="7885618">(</span><span class="string" id="7885619">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="7885678">,</span>&nbsp;<span class="ident" id="7885680">n</span><span class="op" id="7885681">,</span>&nbsp;<span class="ident" id="7885683">writeCount</span><span class="op" id="7885693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885700">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7885703">if</span>&nbsp;<span class="op" id="7885706">!</span><span class="ident" id="7885707">sawGood</span>&nbsp;<span class="op" id="7885715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7885719">t</span><span class="op" id="7885720">.</span><span class="ident" id="7885721">Fatalf</span><span class="op" id="7885727">(</span><span class="string" id="7885728">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7885769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7885772">}</span><br>
<span class="lineno"></span><span class="op" id="7885774">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
