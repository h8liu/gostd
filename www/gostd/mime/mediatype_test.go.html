<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7874318">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7874373">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7874427">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7874478">package</span>&nbsp;<span class="ident" id="7874486">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7874492">import</span>&nbsp;<span class="op" id="7874499">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874502">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7874513">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7874523">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7874526">func</span>&nbsp;<span class="ident" id="7874531">TestConsumeToken</span><span class="op" id="7874547">(</span><span class="ident" id="7874548">t</span>&nbsp;<span class="op" id="7874550">*</span><span class="ident" id="7874551">testing</span><span class="op" id="7874558">.</span><span class="ident" id="7874559">T</span><span class="op" id="7874560">)</span>&nbsp;<span class="op" id="7874562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874565">tests</span>&nbsp;<span class="op" id="7874571">:=</span>&nbsp;<span class="op" id="7874574">[</span><span class="op" id="7874575">...</span><span class="op" id="7874578">]</span><span class="op" id="7874579">[</span><span class="num" id="7874580">3</span><span class="op" id="7874581">]</span><span class="builtintype" id="7874582">string</span><span class="op" id="7874588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874592">{</span><span class="string" id="7874593">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7874602">,</span>&nbsp;<span class="string" id="7874604">&#34;foo&#34;</span><span class="op" id="7874609">,</span>&nbsp;<span class="string" id="7874611">&#34;&nbsp;bar&#34;</span><span class="op" id="7874617">}</span><span class="op" id="7874618">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874622">{</span><span class="string" id="7874623">&#34;bar&#34;</span><span class="op" id="7874628">,</span>&nbsp;<span class="string" id="7874630">&#34;bar&#34;</span><span class="op" id="7874635">,</span>&nbsp;<span class="string" id="7874637">&#34;&#34;</span><span class="op" id="7874639">}</span><span class="op" id="7874640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874644">{</span><span class="string" id="7874645">&#34;&#34;</span><span class="op" id="7874647">,</span>&nbsp;<span class="string" id="7874649">&#34;&#34;</span><span class="op" id="7874651">,</span>&nbsp;<span class="string" id="7874653">&#34;&#34;</span><span class="op" id="7874655">}</span><span class="op" id="7874656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874660">{</span><span class="string" id="7874661">&#34;&nbsp;foo&#34;</span><span class="op" id="7874667">,</span>&nbsp;<span class="string" id="7874669">&#34;&#34;</span><span class="op" id="7874671">,</span>&nbsp;<span class="string" id="7874673">&#34;&nbsp;foo&#34;</span><span class="op" id="7874679">}</span><span class="op" id="7874680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7874686">for</span>&nbsp;<span class="ident" id="7874690">_</span><span class="op" id="7874691">,</span>&nbsp;<span class="ident" id="7874693">test</span>&nbsp;<span class="op" id="7874698">:=</span>&nbsp;<span class="keyword" id="7874701">range</span>&nbsp;<span class="ident" id="7874707">tests</span>&nbsp;<span class="op" id="7874713">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874717">token</span><span class="op" id="7874722">,</span>&nbsp;<span class="ident" id="7874724">rest</span>&nbsp;<span class="op" id="7874729">:=</span>&nbsp;<span class="ident" id="7874732">consumeToken</span><span class="op" id="7874744">(</span><span class="ident" id="7874745">test</span><span class="op" id="7874749">[</span><span class="num" id="7874750">0</span><span class="op" id="7874751">]</span><span class="op" id="7874752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874756">expectedToken</span>&nbsp;<span class="op" id="7874770">:=</span>&nbsp;<span class="ident" id="7874773">test</span><span class="op" id="7874777">[</span><span class="num" id="7874778">1</span><span class="op" id="7874779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874783">expectedRest</span>&nbsp;<span class="op" id="7874796">:=</span>&nbsp;<span class="ident" id="7874799">test</span><span class="op" id="7874803">[</span><span class="num" id="7874804">2</span><span class="op" id="7874805">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7874809">if</span>&nbsp;<span class="ident" id="7874812">token</span>&nbsp;<span class="op" id="7874818">!=</span>&nbsp;<span class="ident" id="7874821">expectedToken</span>&nbsp;<span class="op" id="7874835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874840">t</span><span class="op" id="7874841">.</span><span class="ident" id="7874842">Errorf</span><span class="op" id="7874848">(</span><span class="string" id="7874849">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7874901">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874907">expectedToken</span><span class="op" id="7874920">,</span>&nbsp;<span class="ident" id="7874922">token</span><span class="op" id="7874927">,</span>&nbsp;<span class="ident" id="7874929">test</span><span class="op" id="7874933">[</span><span class="num" id="7874934">0</span><span class="op" id="7874935">]</span><span class="op" id="7874936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7874940">}</span>&nbsp;<span class="keyword" id="7874942">else</span>&nbsp;<span class="keyword" id="7874947">if</span>&nbsp;<span class="ident" id="7874950">rest</span>&nbsp;<span class="op" id="7874955">!=</span>&nbsp;<span class="ident" id="7874958">expectedRest</span>&nbsp;<span class="op" id="7874971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7874976">t</span><span class="op" id="7874977">.</span><span class="ident" id="7874978">Errorf</span><span class="op" id="7874984">(</span><span class="string" id="7874985">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7875058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875064">expectedRest</span><span class="op" id="7875076">,</span>&nbsp;<span class="ident" id="7875078">rest</span><span class="op" id="7875082">,</span>&nbsp;<span class="ident" id="7875084">token</span><span class="op" id="7875089">,</span>&nbsp;<span class="ident" id="7875091">test</span><span class="op" id="7875095">[</span><span class="num" id="7875096">0</span><span class="op" id="7875097">]</span><span class="op" id="7875098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875102">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875105">}</span><br>
<span class="lineno"></span><span class="op" id="7875107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7875110">func</span>&nbsp;<span class="ident" id="7875115">TestConsumeValue</span><span class="op" id="7875131">(</span><span class="ident" id="7875132">t</span>&nbsp;<span class="op" id="7875134">*</span><span class="ident" id="7875135">testing</span><span class="op" id="7875142">.</span><span class="ident" id="7875143">T</span><span class="op" id="7875144">)</span>&nbsp;<span class="op" id="7875146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875149">tests</span>&nbsp;<span class="op" id="7875155">:=</span>&nbsp;<span class="op" id="7875158">[</span><span class="op" id="7875159">...</span><span class="op" id="7875162">]</span><span class="op" id="7875163">[</span><span class="num" id="7875164">3</span><span class="op" id="7875165">]</span><span class="builtintype" id="7875166">string</span><span class="op" id="7875172">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875176">{</span><span class="string" id="7875177">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7875186">,</span>&nbsp;<span class="string" id="7875188">&#34;foo&#34;</span><span class="op" id="7875193">,</span>&nbsp;<span class="string" id="7875195">&#34;&nbsp;bar&#34;</span><span class="op" id="7875201">}</span><span class="op" id="7875202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875206">{</span><span class="string" id="7875207">&#34;bar&#34;</span><span class="op" id="7875212">,</span>&nbsp;<span class="string" id="7875214">&#34;bar&#34;</span><span class="op" id="7875219">,</span>&nbsp;<span class="string" id="7875221">&#34;&#34;</span><span class="op" id="7875223">}</span><span class="op" id="7875224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875228">{</span><span class="string" id="7875229">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7875236">,</span>&nbsp;<span class="string" id="7875238">&#34;&#34;</span><span class="op" id="7875240">,</span>&nbsp;<span class="string" id="7875242">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7875249">}</span><span class="op" id="7875250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875254">{</span><span class="string" id="7875255">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="7875270">,</span>&nbsp;<span class="string" id="7875272">&#34;My&nbsp;value&#34;</span><span class="op" id="7875282">,</span>&nbsp;<span class="string" id="7875284">&#34;end&#34;</span><span class="op" id="7875289">}</span><span class="op" id="7875290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875294">{</span><span class="string" id="7875295">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="7875311">,</span>&nbsp;<span class="string" id="7875313">&#34;My&nbsp;value&#34;</span><span class="op" id="7875323">,</span>&nbsp;<span class="string" id="7875325">&#34;&nbsp;end&#34;</span><span class="op" id="7875331">}</span><span class="op" id="7875332">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875336">{</span><span class="string" id="7875337">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="7875348">,</span>&nbsp;<span class="string" id="7875350">&#34;\\&#34;</span><span class="op" id="7875354">,</span>&nbsp;<span class="string" id="7875356">&#34;&nbsp;rest&#34;</span><span class="op" id="7875363">}</span><span class="op" id="7875364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875368">{</span><span class="string" id="7875369">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="7875387">,</span>&nbsp;<span class="string" id="7875389">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="7875402">,</span>&nbsp;<span class="string" id="7875404">&#34;end&#34;</span><span class="op" id="7875409">}</span><span class="op" id="7875410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875414">{</span><span class="string" id="7875415">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7875425">,</span>&nbsp;<span class="string" id="7875427">&#34;&#34;</span><span class="op" id="7875429">,</span>&nbsp;<span class="string" id="7875431">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7875441">}</span><span class="op" id="7875442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875448">for</span>&nbsp;<span class="ident" id="7875452">_</span><span class="op" id="7875453">,</span>&nbsp;<span class="ident" id="7875455">test</span>&nbsp;<span class="op" id="7875460">:=</span>&nbsp;<span class="keyword" id="7875463">range</span>&nbsp;<span class="ident" id="7875469">tests</span>&nbsp;<span class="op" id="7875475">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875479">value</span><span class="op" id="7875484">,</span>&nbsp;<span class="ident" id="7875486">rest</span>&nbsp;<span class="op" id="7875491">:=</span>&nbsp;<span class="ident" id="7875494">consumeValue</span><span class="op" id="7875506">(</span><span class="ident" id="7875507">test</span><span class="op" id="7875511">[</span><span class="num" id="7875512">0</span><span class="op" id="7875513">]</span><span class="op" id="7875514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875518">expectedValue</span>&nbsp;<span class="op" id="7875532">:=</span>&nbsp;<span class="ident" id="7875535">test</span><span class="op" id="7875539">[</span><span class="num" id="7875540">1</span><span class="op" id="7875541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875545">expectedRest</span>&nbsp;<span class="op" id="7875558">:=</span>&nbsp;<span class="ident" id="7875561">test</span><span class="op" id="7875565">[</span><span class="num" id="7875566">2</span><span class="op" id="7875567">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7875571">if</span>&nbsp;<span class="ident" id="7875574">value</span>&nbsp;<span class="op" id="7875580">!=</span>&nbsp;<span class="ident" id="7875583">expectedValue</span>&nbsp;<span class="op" id="7875597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875602">t</span><span class="op" id="7875603">.</span><span class="ident" id="7875604">Errorf</span><span class="op" id="7875610">(</span><span class="string" id="7875611">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7875663">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875669">expectedValue</span><span class="op" id="7875682">,</span>&nbsp;<span class="ident" id="7875684">value</span><span class="op" id="7875689">,</span>&nbsp;<span class="ident" id="7875691">test</span><span class="op" id="7875695">[</span><span class="num" id="7875696">0</span><span class="op" id="7875697">]</span><span class="op" id="7875698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875702">}</span>&nbsp;<span class="keyword" id="7875704">else</span>&nbsp;<span class="keyword" id="7875709">if</span>&nbsp;<span class="ident" id="7875712">rest</span>&nbsp;<span class="op" id="7875717">!=</span>&nbsp;<span class="ident" id="7875720">expectedRest</span>&nbsp;<span class="op" id="7875733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875738">t</span><span class="op" id="7875739">.</span><span class="ident" id="7875740">Errorf</span><span class="op" id="7875746">(</span><span class="string" id="7875747">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7875820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875826">expectedRest</span><span class="op" id="7875838">,</span>&nbsp;<span class="ident" id="7875840">rest</span><span class="op" id="7875844">,</span>&nbsp;<span class="ident" id="7875846">value</span><span class="op" id="7875851">,</span>&nbsp;<span class="ident" id="7875853">test</span><span class="op" id="7875857">[</span><span class="num" id="7875858">0</span><span class="op" id="7875859">]</span><span class="op" id="7875860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875864">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875867">}</span><br>
<span class="lineno"></span><span class="op" id="7875869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7875872">func</span>&nbsp;<span class="ident" id="7875877">TestConsumeMediaParam</span><span class="op" id="7875898">(</span><span class="ident" id="7875899">t</span>&nbsp;<span class="op" id="7875901">*</span><span class="ident" id="7875902">testing</span><span class="op" id="7875909">.</span><span class="ident" id="7875910">T</span><span class="op" id="7875911">)</span>&nbsp;<span class="op" id="7875913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7875916">tests</span>&nbsp;<span class="op" id="7875922">:=</span>&nbsp;<span class="op" id="7875925">[</span><span class="op" id="7875926">...</span><span class="op" id="7875929">]</span><span class="op" id="7875930">[</span><span class="num" id="7875931">4</span><span class="op" id="7875932">]</span><span class="builtintype" id="7875933">string</span><span class="op" id="7875939">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875943">{</span><span class="string" id="7875944">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="7875956">,</span>&nbsp;<span class="string" id="7875958">&#34;foo&#34;</span><span class="op" id="7875963">,</span>&nbsp;<span class="string" id="7875965">&#34;bar&#34;</span><span class="op" id="7875970">,</span>&nbsp;<span class="string" id="7875972">&#34;&#34;</span><span class="op" id="7875974">}</span><span class="op" id="7875975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7875979">{</span><span class="string" id="7875980">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="7875991">,</span>&nbsp;<span class="string" id="7875993">&#34;foo&#34;</span><span class="op" id="7875998">,</span>&nbsp;<span class="string" id="7876000">&#34;bar&#34;</span><span class="op" id="7876005">,</span>&nbsp;<span class="string" id="7876007">&#34;&#34;</span><span class="op" id="7876009">}</span><span class="op" id="7876010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876014">{</span><span class="string" id="7876015">&#34;;foo=bar&#34;</span><span class="op" id="7876025">,</span>&nbsp;<span class="string" id="7876027">&#34;foo&#34;</span><span class="op" id="7876032">,</span>&nbsp;<span class="string" id="7876034">&#34;bar&#34;</span><span class="op" id="7876039">,</span>&nbsp;<span class="string" id="7876041">&#34;&#34;</span><span class="op" id="7876043">}</span><span class="op" id="7876044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876048">{</span><span class="string" id="7876049">&#34;;FOO=bar&#34;</span><span class="op" id="7876059">,</span>&nbsp;<span class="string" id="7876061">&#34;foo&#34;</span><span class="op" id="7876066">,</span>&nbsp;<span class="string" id="7876068">&#34;bar&#34;</span><span class="op" id="7876073">,</span>&nbsp;<span class="string" id="7876075">&#34;&#34;</span><span class="op" id="7876077">}</span><span class="op" id="7876078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876082">{</span><span class="string" id="7876083">`;foo=&#34;bar&#34;`</span><span class="op" id="7876095">,</span>&nbsp;<span class="string" id="7876097">&#34;foo&#34;</span><span class="op" id="7876102">,</span>&nbsp;<span class="string" id="7876104">&#34;bar&#34;</span><span class="op" id="7876109">,</span>&nbsp;<span class="string" id="7876111">&#34;&#34;</span><span class="op" id="7876113">}</span><span class="op" id="7876114">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876118">{</span><span class="string" id="7876119">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="7876133">,</span>&nbsp;<span class="string" id="7876135">&#34;foo&#34;</span><span class="op" id="7876140">,</span>&nbsp;<span class="string" id="7876142">&#34;bar&#34;</span><span class="op" id="7876147">,</span>&nbsp;<span class="string" id="7876149">&#34;;&nbsp;&#34;</span><span class="op" id="7876153">}</span><span class="op" id="7876154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876158">{</span><span class="string" id="7876159">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="7876180">,</span>&nbsp;<span class="string" id="7876182">&#34;foo&#34;</span><span class="op" id="7876187">,</span>&nbsp;<span class="string" id="7876189">&#34;bar&#34;</span><span class="op" id="7876194">,</span>&nbsp;<span class="string" id="7876196">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="7876207">}</span><span class="op" id="7876208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876212">{</span><span class="string" id="7876213">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="7876235">,</span>&nbsp;<span class="string" id="7876237">&#34;boundary&#34;</span><span class="op" id="7876247">,</span>&nbsp;<span class="string" id="7876249">&#34;----CUT&#34;</span><span class="op" id="7876258">,</span>&nbsp;<span class="string" id="7876260">&#34;;&#34;</span><span class="op" id="7876263">}</span><span class="op" id="7876264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876268">{</span><span class="string" id="7876269">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7876310">,</span>&nbsp;<span class="string" id="7876312">&#34;key&#34;</span><span class="op" id="7876317">,</span>&nbsp;<span class="string" id="7876319">&#34;value&#34;</span><span class="op" id="7876326">,</span>&nbsp;<span class="string" id="7876328">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7876357">}</span><span class="op" id="7876358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876362">{</span><span class="string" id="7876363">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7876392">,</span>&nbsp;<span class="string" id="7876394">&#34;blah&#34;</span><span class="op" id="7876400">,</span>&nbsp;<span class="string" id="7876402">&#34;value&#34;</span><span class="op" id="7876409">,</span>&nbsp;<span class="string" id="7876411">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7876425">}</span><span class="op" id="7876426">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876430">{</span><span class="string" id="7876431">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7876445">,</span>&nbsp;<span class="string" id="7876447">&#34;name&#34;</span><span class="op" id="7876453">,</span>&nbsp;<span class="string" id="7876455">&#34;foo&#34;</span><span class="op" id="7876460">,</span>&nbsp;<span class="string" id="7876462">`&nbsp;`</span><span class="op" id="7876465">}</span><span class="op" id="7876466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876472">for</span>&nbsp;<span class="ident" id="7876476">_</span><span class="op" id="7876477">,</span>&nbsp;<span class="ident" id="7876479">test</span>&nbsp;<span class="op" id="7876484">:=</span>&nbsp;<span class="keyword" id="7876487">range</span>&nbsp;<span class="ident" id="7876493">tests</span>&nbsp;<span class="op" id="7876499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876503">param</span><span class="op" id="7876508">,</span>&nbsp;<span class="ident" id="7876510">value</span><span class="op" id="7876515">,</span>&nbsp;<span class="ident" id="7876517">rest</span>&nbsp;<span class="op" id="7876522">:=</span>&nbsp;<span class="ident" id="7876525">consumeMediaParam</span><span class="op" id="7876542">(</span><span class="ident" id="7876543">test</span><span class="op" id="7876547">[</span><span class="num" id="7876548">0</span><span class="op" id="7876549">]</span><span class="op" id="7876550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876554">expectedParam</span>&nbsp;<span class="op" id="7876568">:=</span>&nbsp;<span class="ident" id="7876571">test</span><span class="op" id="7876575">[</span><span class="num" id="7876576">1</span><span class="op" id="7876577">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876581">expectedValue</span>&nbsp;<span class="op" id="7876595">:=</span>&nbsp;<span class="ident" id="7876598">test</span><span class="op" id="7876602">[</span><span class="num" id="7876603">2</span><span class="op" id="7876604">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876608">expectedRest</span>&nbsp;<span class="op" id="7876621">:=</span>&nbsp;<span class="ident" id="7876624">test</span><span class="op" id="7876628">[</span><span class="num" id="7876629">3</span><span class="op" id="7876630">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7876634">if</span>&nbsp;<span class="ident" id="7876637">param</span>&nbsp;<span class="op" id="7876643">!=</span>&nbsp;<span class="ident" id="7876646">expectedParam</span>&nbsp;<span class="op" id="7876660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876665">t</span><span class="op" id="7876666">.</span><span class="ident" id="7876667">Errorf</span><span class="op" id="7876673">(</span><span class="string" id="7876674">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7876726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876732">expectedParam</span><span class="op" id="7876745">,</span>&nbsp;<span class="ident" id="7876747">param</span><span class="op" id="7876752">,</span>&nbsp;<span class="ident" id="7876754">test</span><span class="op" id="7876758">[</span><span class="num" id="7876759">0</span><span class="op" id="7876760">]</span><span class="op" id="7876761">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876765">}</span>&nbsp;<span class="keyword" id="7876767">else</span>&nbsp;<span class="keyword" id="7876772">if</span>&nbsp;<span class="ident" id="7876775">value</span>&nbsp;<span class="op" id="7876781">!=</span>&nbsp;<span class="ident" id="7876784">expectedValue</span>&nbsp;<span class="op" id="7876798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876803">t</span><span class="op" id="7876804">.</span><span class="ident" id="7876805">Errorf</span><span class="op" id="7876811">(</span><span class="string" id="7876812">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7876864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876870">expectedValue</span><span class="op" id="7876883">,</span>&nbsp;<span class="ident" id="7876885">value</span><span class="op" id="7876890">,</span>&nbsp;<span class="ident" id="7876892">test</span><span class="op" id="7876896">[</span><span class="num" id="7876897">0</span><span class="op" id="7876898">]</span><span class="op" id="7876899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7876903">}</span>&nbsp;<span class="keyword" id="7876905">else</span>&nbsp;<span class="keyword" id="7876910">if</span>&nbsp;<span class="ident" id="7876913">rest</span>&nbsp;<span class="op" id="7876918">!=</span>&nbsp;<span class="ident" id="7876921">expectedRest</span>&nbsp;<span class="op" id="7876934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7876939">t</span><span class="op" id="7876940">.</span><span class="ident" id="7876941">Errorf</span><span class="op" id="7876947">(</span><span class="string" id="7876948">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7877018">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877024">expectedRest</span><span class="op" id="7877036">,</span>&nbsp;<span class="ident" id="7877038">rest</span><span class="op" id="7877042">,</span>&nbsp;<span class="ident" id="7877044">param</span><span class="op" id="7877049">,</span>&nbsp;<span class="ident" id="7877051">value</span><span class="op" id="7877056">,</span>&nbsp;<span class="ident" id="7877058">test</span><span class="op" id="7877062">[</span><span class="num" id="7877063">0</span><span class="op" id="7877064">]</span><span class="op" id="7877065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877072">}</span><br>
<span class="lineno"></span><span class="op" id="7877074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7877077">type</span>&nbsp;<span class="ident" id="7877082">mediaTypeTest</span>&nbsp;<span class="keyword" id="7877096">struct</span>&nbsp;<span class="op" id="7877103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877106">in</span>&nbsp;<span class="builtintype" id="7877109">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877117">t</span>&nbsp;&nbsp;<span class="builtintype" id="7877120">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877128">p</span>&nbsp;&nbsp;<span class="keyword" id="7877131">map</span><span class="op" id="7877134">[</span><span class="builtintype" id="7877135">string</span><span class="op" id="7877141">]</span><span class="builtintype" id="7877142">string</span><br>
<span class="lineno"></span><span class="op" id="7877149">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7877152">func</span>&nbsp;<span class="ident" id="7877157">TestParseMediaType</span><span class="op" id="7877175">(</span><span class="ident" id="7877176">t</span>&nbsp;<span class="op" id="7877178">*</span><span class="ident" id="7877179">testing</span><span class="op" id="7877186">.</span><span class="ident" id="7877187">T</span><span class="op" id="7877188">)</span>&nbsp;<span class="op" id="7877190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7877193">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877225">m</span>&nbsp;<span class="op" id="7877227">:=</span>&nbsp;<span class="keyword" id="7877230">func</span><span class="op" id="7877234">(</span><span class="ident" id="7877235">s</span>&nbsp;<span class="op" id="7877237">...</span><span class="builtintype" id="7877240">string</span><span class="op" id="7877246">)</span>&nbsp;<span class="keyword" id="7877248">map</span><span class="op" id="7877251">[</span><span class="builtintype" id="7877252">string</span><span class="op" id="7877258">]</span><span class="builtintype" id="7877259">string</span>&nbsp;<span class="op" id="7877266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877270">sm</span>&nbsp;<span class="op" id="7877273">:=</span>&nbsp;<span class="builtinfunc" id="7877276">make</span><span class="op" id="7877280">(</span><span class="keyword" id="7877281">map</span><span class="op" id="7877284">[</span><span class="builtintype" id="7877285">string</span><span class="op" id="7877291">]</span><span class="builtintype" id="7877292">string</span><span class="op" id="7877298">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7877302">for</span>&nbsp;<span class="ident" id="7877306">i</span>&nbsp;<span class="op" id="7877308">:=</span>&nbsp;<span class="num" id="7877311">0</span><span class="op" id="7877312">;</span>&nbsp;<span class="ident" id="7877314">i</span>&nbsp;<span class="op" id="7877316">&lt;</span>&nbsp;<span class="builtinfunc" id="7877318">len</span><span class="op" id="7877321">(</span><span class="ident" id="7877322">s</span><span class="op" id="7877323">)</span><span class="op" id="7877324">;</span>&nbsp;<span class="ident" id="7877326">i</span>&nbsp;<span class="op" id="7877328">+=</span>&nbsp;<span class="num" id="7877331">2</span>&nbsp;<span class="op" id="7877333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877338">sm</span><span class="op" id="7877340">[</span><span class="ident" id="7877341">s</span><span class="op" id="7877342">[</span><span class="ident" id="7877343">i</span><span class="op" id="7877344">]</span><span class="op" id="7877345">]</span>&nbsp;<span class="op" id="7877347">=</span>&nbsp;<span class="ident" id="7877349">s</span><span class="op" id="7877350">[</span><span class="ident" id="7877351">i</span><span class="op" id="7877352">+</span><span class="num" id="7877353">1</span><span class="op" id="7877354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7877362">return</span>&nbsp;<span class="ident" id="7877369">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877373">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877377">nameFoo</span>&nbsp;<span class="op" id="7877385">:=</span>&nbsp;<span class="keyword" id="7877388">map</span><span class="op" id="7877391">[</span><span class="builtintype" id="7877392">string</span><span class="op" id="7877398">]</span><span class="builtintype" id="7877399">string</span><span class="op" id="7877405">{</span><span class="string" id="7877406">&#34;name&#34;</span><span class="op" id="7877412">:</span>&nbsp;<span class="string" id="7877414">&#34;foo&#34;</span><span class="op" id="7877419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877422">tests</span>&nbsp;<span class="op" id="7877428">:=</span>&nbsp;<span class="op" id="7877431">[</span><span class="op" id="7877432">]</span><span class="ident" id="7877433">mediaTypeTest</span><span class="op" id="7877446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877450">{</span><span class="string" id="7877451">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7877474">,</span>&nbsp;<span class="string" id="7877476">&#34;form-data&#34;</span><span class="op" id="7877487">,</span>&nbsp;<span class="ident" id="7877489">nameFoo</span><span class="op" id="7877496">}</span><span class="op" id="7877497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877501">{</span><span class="string" id="7877502">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="7877525">,</span>&nbsp;<span class="string" id="7877527">&#34;form-data&#34;</span><span class="op" id="7877538">,</span>&nbsp;<span class="ident" id="7877540">nameFoo</span><span class="op" id="7877547">}</span><span class="op" id="7877548">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877552">{</span><span class="string" id="7877553">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="7877575">,</span>&nbsp;<span class="string" id="7877577">&#34;form-data&#34;</span><span class="op" id="7877588">,</span>&nbsp;<span class="ident" id="7877590">nameFoo</span><span class="op" id="7877597">}</span><span class="op" id="7877598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877602">{</span><span class="string" id="7877603">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7877628">,</span>&nbsp;<span class="string" id="7877630">&#34;form-data&#34;</span><span class="op" id="7877641">,</span>&nbsp;<span class="ident" id="7877643">nameFoo</span><span class="op" id="7877650">}</span><span class="op" id="7877651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877655">{</span><span class="string" id="7877656">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7877681">,</span>&nbsp;<span class="string" id="7877683">&#34;form-data&#34;</span><span class="op" id="7877694">,</span>&nbsp;<span class="ident" id="7877696">nameFoo</span><span class="op" id="7877703">}</span><span class="op" id="7877704">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877709">{</span><span class="string" id="7877710">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7877759">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7877764">&#34;form-data&#34;</span><span class="op" id="7877775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7877780">m</span><span class="op" id="7877781">(</span><span class="string" id="7877782">&#34;key&#34;</span><span class="op" id="7877787">,</span>&nbsp;<span class="string" id="7877789">&#34;value&#34;</span><span class="op" id="7877796">,</span>&nbsp;<span class="string" id="7877798">&#34;blah&#34;</span><span class="op" id="7877804">,</span>&nbsp;<span class="string" id="7877806">&#34;value&#34;</span><span class="op" id="7877813">,</span>&nbsp;<span class="string" id="7877815">&#34;name&#34;</span><span class="op" id="7877821">,</span>&nbsp;<span class="string" id="7877823">&#34;foo&#34;</span><span class="op" id="7877828">)</span><span class="op" id="7877829">}</span><span class="op" id="7877830">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877835">{</span><span class="string" id="7877836">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="7877893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7877898">&#34;&#34;</span><span class="op" id="7877900">,</span>&nbsp;<span class="ident" id="7877902">m</span><span class="op" id="7877903">(</span><span class="op" id="7877904">)</span><span class="op" id="7877905">}</span><span class="op" id="7877906">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7877911">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7877931">{</span><span class="string" id="7877932">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="7878010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878015">&#34;application/x-stuff&#34;</span><span class="op" id="7878036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7878041">m</span><span class="op" id="7878042">(</span><span class="string" id="7878043">&#34;title&#34;</span><span class="op" id="7878050">,</span>&nbsp;<span class="string" id="7878052">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="7878071">)</span><span class="op" id="7878072">}</span><span class="op" id="7878073">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7878078">{</span><span class="string" id="7878079">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="7878122">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878127">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="7878145">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878150">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="7878208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878213">&#34;message/external-body&#34;</span><span class="op" id="7878236">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7878241">m</span><span class="op" id="7878242">(</span><span class="string" id="7878243">&#34;access-type&#34;</span><span class="op" id="7878256">,</span>&nbsp;<span class="string" id="7878258">&#34;URL&#34;</span><span class="op" id="7878263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878269">&#34;url&#34;</span><span class="op" id="7878274">,</span>&nbsp;<span class="string" id="7878276">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="7878332">)</span><span class="op" id="7878333">}</span><span class="op" id="7878334">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7878339">{</span><span class="string" id="7878340">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="7878364">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878369">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="7878421">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878426">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="7878464">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878469">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="7878490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878495">&#34;application/x-stuff&#34;</span><span class="op" id="7878516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7878521">m</span><span class="op" id="7878522">(</span><span class="string" id="7878523">&#34;title&#34;</span><span class="op" id="7878530">,</span>&nbsp;<span class="string" id="7878532">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="7878571">)</span><span class="op" id="7878572">}</span><span class="op" id="7878573">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7878578">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7878628">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7878691">{</span><span class="string" id="7878692">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="7878726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878731">&#34;attachment&#34;</span><span class="op" id="7878743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7878748">m</span><span class="op" id="7878749">(</span><span class="string" id="7878750">&#34;filename&#34;</span><span class="op" id="7878760">,</span>&nbsp;<span class="string" id="7878762">&#34;foo.html&#34;</span><span class="op" id="7878772">)</span><span class="op" id="7878773">}</span><span class="op" id="7878774">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7878778">{</span><span class="string" id="7878779">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="7878827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878832">&#34;attachment&#34;</span><span class="op" id="7878844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7878849">m</span><span class="op" id="7878850">(</span><span class="string" id="7878851">&#34;filename&#34;</span><span class="op" id="7878861">,</span>&nbsp;<span class="string" id="7878863">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="7878886">)</span><span class="op" id="7878887">}</span><span class="op" id="7878888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7878892">{</span><span class="string" id="7878893">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="7878942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7878947">&#34;attachment&#34;</span><span class="op" id="7878959">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7878964">m</span><span class="op" id="7878965">(</span><span class="string" id="7878966">&#34;filename&#34;</span><span class="op" id="7878976">,</span>&nbsp;<span class="string" id="7878978">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="7879004">)</span><span class="op" id="7879005">}</span><span class="op" id="7879006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879010">{</span><span class="string" id="7879011">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="7879055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879060">&#34;attachment&#34;</span><span class="op" id="7879072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879077">m</span><span class="op" id="7879078">(</span><span class="string" id="7879079">&#34;foo&#34;</span><span class="op" id="7879084">,</span>&nbsp;<span class="string" id="7879086">&#34;\&#34;\\&#34;</span><span class="op" id="7879092">,</span>&nbsp;<span class="string" id="7879094">&#34;filename&#34;</span><span class="op" id="7879104">,</span>&nbsp;<span class="string" id="7879106">&#34;foo.html&#34;</span><span class="op" id="7879116">)</span><span class="op" id="7879117">}</span><span class="op" id="7879118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879122">{</span><span class="string" id="7879123">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="7879154">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879159">&#34;attachment&#34;</span><span class="op" id="7879171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879176">m</span><span class="op" id="7879177">(</span><span class="string" id="7879178">&#34;filename&#34;</span><span class="op" id="7879188">,</span>&nbsp;<span class="string" id="7879190">&#34;foo.html&#34;</span><span class="op" id="7879200">)</span><span class="op" id="7879201">}</span><span class="op" id="7879202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879206">{</span><span class="string" id="7879207">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="7879240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879245">&#34;attachment&#34;</span><span class="op" id="7879257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879262">m</span><span class="op" id="7879263">(</span><span class="string" id="7879264">&#34;filename&#34;</span><span class="op" id="7879274">,</span>&nbsp;<span class="string" id="7879276">&#34;foo.html&#34;</span><span class="op" id="7879286">)</span><span class="op" id="7879287">}</span><span class="op" id="7879288">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879292">{</span><span class="string" id="7879293">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="7879326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879331">&#34;attachment&#34;</span><span class="op" id="7879343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879348">m</span><span class="op" id="7879349">(</span><span class="string" id="7879350">&#34;filename&#34;</span><span class="op" id="7879360">,</span>&nbsp;<span class="string" id="7879362">&#34;foo.html&#34;</span><span class="op" id="7879372">)</span><span class="op" id="7879373">}</span><span class="op" id="7879374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879378">{</span><span class="string" id="7879379">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="7879416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879421">&#34;attachment&#34;</span><span class="op" id="7879433">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879438">m</span><span class="op" id="7879439">(</span><span class="string" id="7879440">&#34;filename&#34;</span><span class="op" id="7879450">,</span>&nbsp;<span class="string" id="7879452">&#34;foo-%41.html&#34;</span><span class="op" id="7879466">)</span><span class="op" id="7879467">}</span><span class="op" id="7879468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879472">{</span><span class="string" id="7879473">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="7879511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879516">&#34;attachment&#34;</span><span class="op" id="7879528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879533">m</span><span class="op" id="7879534">(</span><span class="string" id="7879535">&#34;filename&#34;</span><span class="op" id="7879545">,</span>&nbsp;<span class="string" id="7879547">&#34;foo-%41.html&#34;</span><span class="op" id="7879561">)</span><span class="op" id="7879562">}</span><span class="op" id="7879563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879567">{</span><span class="string" id="7879568">`filename=foo.html`</span><span class="op" id="7879587">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879592">&#34;&#34;</span><span class="op" id="7879594">,</span>&nbsp;<span class="ident" id="7879596">m</span><span class="op" id="7879597">(</span><span class="op" id="7879598">)</span><span class="op" id="7879599">}</span><span class="op" id="7879600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879604">{</span><span class="string" id="7879605">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="7879629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879634">&#34;&#34;</span><span class="op" id="7879636">,</span>&nbsp;<span class="ident" id="7879638">m</span><span class="op" id="7879639">(</span><span class="op" id="7879640">)</span><span class="op" id="7879641">}</span><span class="op" id="7879642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879646">{</span><span class="string" id="7879647">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="7879686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879691">&#34;&#34;</span><span class="op" id="7879693">,</span>&nbsp;<span class="ident" id="7879695">m</span><span class="op" id="7879696">(</span><span class="op" id="7879697">)</span><span class="op" id="7879698">}</span><span class="op" id="7879699">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879703">{</span><span class="string" id="7879704">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="7879743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879748">&#34;&#34;</span><span class="op" id="7879750">,</span>&nbsp;<span class="ident" id="7879752">m</span><span class="op" id="7879753">(</span><span class="op" id="7879754">)</span><span class="op" id="7879755">}</span><span class="op" id="7879756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879760">{</span><span class="string" id="7879761">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="7879798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879803">&#34;&#34;</span><span class="op" id="7879805">,</span>&nbsp;<span class="ident" id="7879807">m</span><span class="op" id="7879808">(</span><span class="op" id="7879809">)</span><span class="op" id="7879810">}</span><span class="op" id="7879811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879815">{</span><span class="string" id="7879816">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="7879843">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879848">&#34;&#34;</span><span class="op" id="7879850">,</span>&nbsp;<span class="ident" id="7879852">m</span><span class="op" id="7879853">(</span><span class="op" id="7879854">)</span><span class="op" id="7879855">}</span><span class="op" id="7879856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7879860">{</span><span class="string" id="7879861">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="7879922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7879927">&#34;attachment&#34;</span><span class="op" id="7879939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7879944">m</span><span class="op" id="7879945">(</span><span class="string" id="7879946">&#34;creation-date&#34;</span><span class="op" id="7879961">,</span>&nbsp;<span class="string" id="7879963">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="7879996">)</span><span class="op" id="7879997">}</span><span class="op" id="7879998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880002">{</span><span class="string" id="7880003">`foobar`</span><span class="op" id="7880011">,</span>&nbsp;<span class="string" id="7880013">&#34;foobar&#34;</span><span class="op" id="7880021">,</span>&nbsp;<span class="ident" id="7880023">m</span><span class="op" id="7880024">(</span><span class="op" id="7880025">)</span><span class="op" id="7880026">}</span><span class="op" id="7880027">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880031">{</span><span class="string" id="7880032">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7880079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880084">&#34;attachment&#34;</span><span class="op" id="7880096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880101">m</span><span class="op" id="7880102">(</span><span class="string" id="7880103">&#34;filename&#34;</span><span class="op" id="7880113">,</span>&nbsp;<span class="string" id="7880115">&#34;foo-ä.html&#34;</span><span class="op" id="7880128">)</span><span class="op" id="7880129">}</span><span class="op" id="7880130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880134">{</span><span class="string" id="7880135">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="7880178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880183">&#34;attachment&#34;</span><span class="op" id="7880195">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880200">m</span><span class="op" id="7880201">(</span><span class="string" id="7880202">&#34;filename&#34;</span><span class="op" id="7880212">,</span>&nbsp;<span class="string" id="7880214">&#34;A-%41.html&#34;</span><span class="op" id="7880226">)</span><span class="op" id="7880227">}</span><span class="op" id="7880228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880232">{</span><span class="string" id="7880233">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="7880283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880288">&#34;attachment&#34;</span><span class="op" id="7880300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880305">m</span><span class="op" id="7880306">(</span><span class="string" id="7880307">&#34;filename&#34;</span><span class="op" id="7880317">,</span>&nbsp;<span class="string" id="7880319">&#34;foo.html&#34;</span><span class="op" id="7880329">)</span><span class="op" id="7880330">}</span><span class="op" id="7880331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880335">{</span><span class="string" id="7880336">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="7880399">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880404">&#34;attachment&#34;</span><span class="op" id="7880416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880421">m</span><span class="op" id="7880422">(</span><span class="string" id="7880423">&#34;filename&#34;</span><span class="op" id="7880433">,</span>&nbsp;<span class="string" id="7880435">&#34;foo-ä.html&#34;</span><span class="op" id="7880448">)</span><span class="op" id="7880449">}</span><span class="op" id="7880450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880454">{</span><span class="string" id="7880455">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="7880504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880509">&#34;attachment&#34;</span><span class="op" id="7880521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880526">m</span><span class="op" id="7880527">(</span><span class="string" id="7880528">&#34;filename&#34;</span><span class="op" id="7880538">,</span>&nbsp;<span class="string" id="7880540">&#34;foo&#34;</span><span class="op" id="7880545">)</span><span class="op" id="7880546">}</span><span class="op" id="7880547">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880551">{</span><span class="string" id="7880552">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7880600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880605">&#34;attachment&#34;</span><span class="op" id="7880617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880622">m</span><span class="op" id="7880623">(</span><span class="string" id="7880624">&#34;filename&#34;</span><span class="op" id="7880634">,</span>&nbsp;<span class="string" id="7880636">&#34;foo&#34;</span><span class="op" id="7880641">)</span><span class="op" id="7880642">}</span><span class="op" id="7880643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880647">{</span><span class="string" id="7880648">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7880696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880701">&#34;attachment&#34;</span><span class="op" id="7880713">,</span>&nbsp;<span class="ident" id="7880715">m</span><span class="op" id="7880716">(</span><span class="op" id="7880717">)</span><span class="op" id="7880718">}</span><span class="op" id="7880719">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880723">{</span><span class="string" id="7880724">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="7880772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880777">&#34;attachment&#34;</span><span class="op" id="7880789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880794">m</span><span class="op" id="7880795">(</span><span class="string" id="7880796">&#34;filename&#34;</span><span class="op" id="7880806">,</span>&nbsp;<span class="string" id="7880808">&#34;foobar&#34;</span><span class="op" id="7880816">)</span><span class="op" id="7880817">}</span><span class="op" id="7880818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880822">{</span><span class="string" id="7880823">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7880893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7880898">&#34;attachment&#34;</span><span class="op" id="7880910">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7880915">m</span><span class="op" id="7880916">(</span><span class="string" id="7880917">&#34;filename&#34;</span><span class="op" id="7880927">,</span>&nbsp;<span class="string" id="7880929">&#34;foo-ä.html&#34;</span><span class="op" id="7880942">)</span><span class="op" id="7880943">}</span><span class="op" id="7880944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7880948">{</span><span class="string" id="7880949">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="7881019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7881024">&#34;attachment&#34;</span><span class="op" id="7881036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881041">m</span><span class="op" id="7881042">(</span><span class="string" id="7881043">&#34;filename&#34;</span><span class="op" id="7881053">,</span>&nbsp;<span class="string" id="7881055">&#34;foo-ä.html&#34;</span><span class="op" id="7881068">)</span><span class="op" id="7881069">}</span><span class="op" id="7881070">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7881075">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7881137">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881194">{</span><span class="string" id="7881195">`form-data;&nbsp;firstname=&#34;Брэд&#34;;&nbsp;lastname=&#34;Фицпатрик&#34;`</span><span class="op" id="7881259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7881264">&#34;form-data&#34;</span><span class="op" id="7881275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881280">m</span><span class="op" id="7881281">(</span><span class="string" id="7881282">&#34;firstname&#34;</span><span class="op" id="7881293">,</span>&nbsp;<span class="string" id="7881295">&#34;Брэд&#34;</span><span class="op" id="7881305">,</span>&nbsp;<span class="string" id="7881307">&#34;lastname&#34;</span><span class="op" id="7881317">,</span>&nbsp;<span class="string" id="7881319">&#34;Фицпатрик&#34;</span><span class="op" id="7881339">)</span><span class="op" id="7881340">}</span><span class="op" id="7881341">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881347">for</span>&nbsp;<span class="ident" id="7881351">_</span><span class="op" id="7881352">,</span>&nbsp;<span class="ident" id="7881354">test</span>&nbsp;<span class="op" id="7881359">:=</span>&nbsp;<span class="keyword" id="7881362">range</span>&nbsp;<span class="ident" id="7881368">tests</span>&nbsp;<span class="op" id="7881374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881378">mt</span><span class="op" id="7881380">,</span>&nbsp;<span class="ident" id="7881382">params</span><span class="op" id="7881388">,</span>&nbsp;<span class="ident" id="7881390">err</span>&nbsp;<span class="op" id="7881394">:=</span>&nbsp;<span class="ident" id="7881397">ParseMediaType</span><span class="op" id="7881411">(</span><span class="ident" id="7881412">test</span><span class="op" id="7881416">.</span><span class="ident" id="7881417">in</span><span class="op" id="7881419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881423">if</span>&nbsp;<span class="ident" id="7881426">err</span>&nbsp;<span class="op" id="7881430">!=</span>&nbsp;<span class="ident" id="7881433">nil</span>&nbsp;<span class="op" id="7881437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881442">if</span>&nbsp;<span class="ident" id="7881445">test</span><span class="op" id="7881449">.</span><span class="ident" id="7881450">t</span>&nbsp;<span class="op" id="7881452">!=</span>&nbsp;<span class="string" id="7881455">&#34;&#34;</span>&nbsp;<span class="op" id="7881458">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881464">t</span><span class="op" id="7881465">.</span><span class="ident" id="7881466">Errorf</span><span class="op" id="7881472">(</span><span class="string" id="7881473">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7881509">,</span>&nbsp;<span class="ident" id="7881511">test</span><span class="op" id="7881515">.</span><span class="ident" id="7881516">in</span><span class="op" id="7881518">,</span>&nbsp;<span class="ident" id="7881520">err</span><span class="op" id="7881523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881529">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881546">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881557">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881561">if</span>&nbsp;<span class="ident" id="7881564">g</span><span class="op" id="7881565">,</span>&nbsp;<span class="ident" id="7881567">e</span>&nbsp;<span class="op" id="7881569">:=</span>&nbsp;<span class="ident" id="7881572">mt</span><span class="op" id="7881574">,</span>&nbsp;<span class="ident" id="7881576">test</span><span class="op" id="7881580">.</span><span class="ident" id="7881581">t</span><span class="op" id="7881582">;</span>&nbsp;<span class="ident" id="7881584">g</span>&nbsp;<span class="op" id="7881586">!=</span>&nbsp;<span class="ident" id="7881589">e</span>&nbsp;<span class="op" id="7881591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881596">t</span><span class="op" id="7881597">.</span><span class="ident" id="7881598">Errorf</span><span class="op" id="7881604">(</span><span class="string" id="7881605">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7881645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881651">test</span><span class="op" id="7881655">.</span><span class="ident" id="7881656">in</span><span class="op" id="7881658">,</span>&nbsp;<span class="ident" id="7881660">e</span><span class="op" id="7881661">,</span>&nbsp;<span class="ident" id="7881663">g</span><span class="op" id="7881664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881669">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881680">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881684">if</span>&nbsp;<span class="builtinfunc" id="7881687">len</span><span class="op" id="7881690">(</span><span class="ident" id="7881691">params</span><span class="op" id="7881697">)</span>&nbsp;<span class="op" id="7881699">==</span>&nbsp;<span class="num" id="7881702">0</span>&nbsp;<span class="op" id="7881704">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7881707">len</span><span class="op" id="7881710">(</span><span class="ident" id="7881711">test</span><span class="op" id="7881715">.</span><span class="ident" id="7881716">p</span><span class="op" id="7881717">)</span>&nbsp;<span class="op" id="7881719">==</span>&nbsp;<span class="num" id="7881722">0</span>&nbsp;<span class="op" id="7881724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881729">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7881744">if</span>&nbsp;<span class="op" id="7881747">!</span><span class="ident" id="7881748">reflect</span><span class="op" id="7881755">.</span><span class="ident" id="7881756">DeepEqual</span><span class="op" id="7881765">(</span><span class="ident" id="7881766">params</span><span class="op" id="7881772">,</span>&nbsp;<span class="ident" id="7881774">test</span><span class="op" id="7881778">.</span><span class="ident" id="7881779">p</span><span class="op" id="7881780">)</span>&nbsp;<span class="op" id="7881782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881787">t</span><span class="op" id="7881788">.</span><span class="ident" id="7881789">Errorf</span><span class="op" id="7881795">(</span><span class="string" id="7881796">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="7881827">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7881833">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="7881850">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7881856">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="7881871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881877">test</span><span class="op" id="7881881">.</span><span class="ident" id="7881882">in</span><span class="op" id="7881884">,</span>&nbsp;<span class="ident" id="7881886">test</span><span class="op" id="7881890">.</span><span class="ident" id="7881891">p</span><span class="op" id="7881892">,</span>&nbsp;<span class="ident" id="7881894">params</span><span class="op" id="7881900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7881907">}</span><br>
<span class="lineno">245</span><span class="op" id="7881909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7881912">type</span>&nbsp;<span class="ident" id="7881917">badMediaTypeTest</span>&nbsp;<span class="keyword" id="7881934">struct</span>&nbsp;<span class="op" id="7881941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881944">in</span>&nbsp;&nbsp;<span class="builtintype" id="7881948">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7881956">err</span>&nbsp;<span class="builtintype" id="7881960">string</span><br>
<span class="lineno">250</span><span class="op" id="7881967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7881970">var</span>&nbsp;<span class="ident" id="7881974">badMediaTypeTests</span>&nbsp;<span class="op" id="7881992">=</span>&nbsp;<span class="op" id="7881994">[</span><span class="op" id="7881995">]</span><span class="ident" id="7881996">badMediaTypeTest</span><span class="op" id="7882012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882015">{</span><span class="string" id="7882016">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="7882034">,</span>&nbsp;<span class="string" id="7882036">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="7882067">}</span><span class="op" id="7882068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882071">{</span><span class="string" id="7882072">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7882102">,</span>&nbsp;<span class="string" id="7882104">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="7882138">}</span><span class="op" id="7882139">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882142">{</span><span class="string" id="7882143">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7882178">,</span>&nbsp;<span class="string" id="7882180">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="7882226">}</span><span class="op" id="7882227">,</span><br>
<span class="lineno"></span><span class="op" id="7882229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7882232">func</span>&nbsp;<span class="ident" id="7882237">TestParseMediaTypeBogus</span><span class="op" id="7882260">(</span><span class="ident" id="7882261">t</span>&nbsp;<span class="op" id="7882263">*</span><span class="ident" id="7882264">testing</span><span class="op" id="7882271">.</span><span class="ident" id="7882272">T</span><span class="op" id="7882273">)</span>&nbsp;<span class="op" id="7882275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7882278">for</span>&nbsp;<span class="ident" id="7882282">_</span><span class="op" id="7882283">,</span>&nbsp;<span class="ident" id="7882285">tt</span>&nbsp;<span class="op" id="7882288">:=</span>&nbsp;<span class="keyword" id="7882291">range</span>&nbsp;<span class="ident" id="7882297">badMediaTypeTests</span>&nbsp;<span class="op" id="7882315">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882319">mt</span><span class="op" id="7882321">,</span>&nbsp;<span class="ident" id="7882323">params</span><span class="op" id="7882329">,</span>&nbsp;<span class="ident" id="7882331">err</span>&nbsp;<span class="op" id="7882335">:=</span>&nbsp;<span class="ident" id="7882338">ParseMediaType</span><span class="op" id="7882352">(</span><span class="ident" id="7882353">tt</span><span class="op" id="7882355">.</span><span class="ident" id="7882356">in</span><span class="op" id="7882358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7882362">if</span>&nbsp;<span class="ident" id="7882365">err</span>&nbsp;<span class="op" id="7882369">==</span>&nbsp;<span class="ident" id="7882372">nil</span>&nbsp;<span class="op" id="7882376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882381">t</span><span class="op" id="7882382">.</span><span class="ident" id="7882383">Errorf</span><span class="op" id="7882389">(</span><span class="string" id="7882390">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="7882440">,</span>&nbsp;<span class="ident" id="7882442">tt</span><span class="op" id="7882444">.</span><span class="ident" id="7882445">in</span><span class="op" id="7882447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7882452">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882463">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7882467">if</span>&nbsp;<span class="ident" id="7882470">err</span><span class="op" id="7882473">.</span><span class="ident" id="7882474">Error</span><span class="op" id="7882479">(</span><span class="op" id="7882480">)</span>&nbsp;<span class="op" id="7882482">!=</span>&nbsp;<span class="ident" id="7882485">tt</span><span class="op" id="7882487">.</span><span class="ident" id="7882488">err</span>&nbsp;<span class="op" id="7882492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882497">t</span><span class="op" id="7882498">.</span><span class="ident" id="7882499">Errorf</span><span class="op" id="7882505">(</span><span class="string" id="7882506">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7882544">,</span>&nbsp;<span class="ident" id="7882546">tt</span><span class="op" id="7882548">.</span><span class="ident" id="7882549">in</span><span class="op" id="7882551">,</span>&nbsp;<span class="ident" id="7882553">err</span><span class="op" id="7882556">.</span><span class="ident" id="7882557">Error</span><span class="op" id="7882562">(</span><span class="op" id="7882563">)</span><span class="op" id="7882564">,</span>&nbsp;<span class="ident" id="7882566">tt</span><span class="op" id="7882568">.</span><span class="ident" id="7882569">err</span><span class="op" id="7882572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7882580">if</span>&nbsp;<span class="ident" id="7882583">params</span>&nbsp;<span class="op" id="7882590">!=</span>&nbsp;<span class="ident" id="7882593">nil</span>&nbsp;<span class="op" id="7882597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882602">t</span><span class="op" id="7882603">.</span><span class="ident" id="7882604">Errorf</span><span class="op" id="7882610">(</span><span class="string" id="7882611">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="7882660">,</span>&nbsp;<span class="ident" id="7882662">tt</span><span class="op" id="7882664">.</span><span class="ident" id="7882665">in</span><span class="op" id="7882667">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7882675">if</span>&nbsp;<span class="ident" id="7882678">mt</span>&nbsp;<span class="op" id="7882681">!=</span>&nbsp;<span class="string" id="7882684">&#34;&#34;</span>&nbsp;<span class="op" id="7882687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882692">t</span><span class="op" id="7882693">.</span><span class="ident" id="7882694">Errorf</span><span class="op" id="7882700">(</span><span class="string" id="7882701">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="7882763">,</span>&nbsp;<span class="ident" id="7882765">tt</span><span class="op" id="7882767">.</span><span class="ident" id="7882768">in</span><span class="op" id="7882770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882777">}</span><br>
<span class="lineno">275</span><span class="op" id="7882779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7882782">type</span>&nbsp;<span class="ident" id="7882787">formatTest</span>&nbsp;<span class="keyword" id="7882798">struct</span>&nbsp;<span class="op" id="7882805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882808">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7882815">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882823">params</span>&nbsp;<span class="keyword" id="7882830">map</span><span class="op" id="7882833">[</span><span class="builtintype" id="7882834">string</span><span class="op" id="7882840">]</span><span class="builtintype" id="7882841">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7882849">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7882856">string</span><br>
<span class="lineno"></span><span class="op" id="7882863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7882866">var</span>&nbsp;<span class="ident" id="7882870">formatTests</span>&nbsp;<span class="op" id="7882882">=</span>&nbsp;<span class="op" id="7882884">[</span><span class="op" id="7882885">]</span><span class="ident" id="7882886">formatTest</span><span class="op" id="7882896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882899">{</span><span class="string" id="7882900">&#34;noslash&#34;</span><span class="op" id="7882909">,</span>&nbsp;<span class="ident" id="7882911">nil</span><span class="op" id="7882914">,</span>&nbsp;<span class="string" id="7882916">&#34;&#34;</span><span class="op" id="7882918">}</span><span class="op" id="7882919">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882922">{</span><span class="string" id="7882923">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="7882936">,</span>&nbsp;<span class="ident" id="7882938">nil</span><span class="op" id="7882941">,</span>&nbsp;<span class="string" id="7882943">&#34;&#34;</span><span class="op" id="7882945">}</span><span class="op" id="7882946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882949">{</span><span class="string" id="7882950">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="7882963">,</span>&nbsp;<span class="ident" id="7882965">nil</span><span class="op" id="7882968">,</span>&nbsp;<span class="string" id="7882970">&#34;&#34;</span><span class="op" id="7882972">}</span><span class="op" id="7882973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7882976">{</span><span class="string" id="7882977">&#34;foo/BAR&#34;</span><span class="op" id="7882986">,</span>&nbsp;<span class="ident" id="7882988">nil</span><span class="op" id="7882991">,</span>&nbsp;<span class="string" id="7882993">&#34;foo/bar&#34;</span><span class="op" id="7883002">}</span><span class="op" id="7883003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883006">{</span><span class="string" id="7883007">&#34;foo/BAR&#34;</span><span class="op" id="7883016">,</span>&nbsp;<span class="keyword" id="7883018">map</span><span class="op" id="7883021">[</span><span class="builtintype" id="7883022">string</span><span class="op" id="7883028">]</span><span class="builtintype" id="7883029">string</span><span class="op" id="7883035">{</span><span class="string" id="7883036">&#34;X&#34;</span><span class="op" id="7883039">:</span>&nbsp;<span class="string" id="7883041">&#34;Y&#34;</span><span class="op" id="7883044">}</span><span class="op" id="7883045">,</span>&nbsp;<span class="string" id="7883047">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="7883061">}</span><span class="op" id="7883062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883065">{</span><span class="string" id="7883066">&#34;foo/BAR&#34;</span><span class="op" id="7883075">,</span>&nbsp;<span class="keyword" id="7883077">map</span><span class="op" id="7883080">[</span><span class="builtintype" id="7883081">string</span><span class="op" id="7883087">]</span><span class="builtintype" id="7883088">string</span><span class="op" id="7883094">{</span><span class="string" id="7883095">&#34;space&#34;</span><span class="op" id="7883102">:</span>&nbsp;<span class="string" id="7883104">&#34;With&nbsp;space&#34;</span><span class="op" id="7883116">}</span><span class="op" id="7883117">,</span>&nbsp;<span class="string" id="7883119">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="7883148">}</span><span class="op" id="7883149">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883152">{</span><span class="string" id="7883153">&#34;foo/BAR&#34;</span><span class="op" id="7883162">,</span>&nbsp;<span class="keyword" id="7883164">map</span><span class="op" id="7883167">[</span><span class="builtintype" id="7883168">string</span><span class="op" id="7883174">]</span><span class="builtintype" id="7883175">string</span><span class="op" id="7883181">{</span><span class="string" id="7883182">&#34;quote&#34;</span><span class="op" id="7883189">:</span>&nbsp;<span class="string" id="7883191">`With&nbsp;&#34;quote`</span><span class="op" id="7883204">}</span><span class="op" id="7883205">,</span>&nbsp;<span class="string" id="7883207">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="7883238">}</span><span class="op" id="7883239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883242">{</span><span class="string" id="7883243">&#34;foo/BAR&#34;</span><span class="op" id="7883252">,</span>&nbsp;<span class="keyword" id="7883254">map</span><span class="op" id="7883257">[</span><span class="builtintype" id="7883258">string</span><span class="op" id="7883264">]</span><span class="builtintype" id="7883265">string</span><span class="op" id="7883271">{</span><span class="string" id="7883272">&#34;bslash&#34;</span><span class="op" id="7883280">:</span>&nbsp;<span class="string" id="7883282">`With&nbsp;\backslash`</span><span class="op" id="7883299">}</span><span class="op" id="7883300">,</span>&nbsp;<span class="string" id="7883302">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="7883338">}</span><span class="op" id="7883339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883342">{</span><span class="string" id="7883343">&#34;foo/BAR&#34;</span><span class="op" id="7883352">,</span>&nbsp;<span class="keyword" id="7883354">map</span><span class="op" id="7883357">[</span><span class="builtintype" id="7883358">string</span><span class="op" id="7883364">]</span><span class="builtintype" id="7883365">string</span><span class="op" id="7883371">{</span><span class="string" id="7883372">&#34;both&#34;</span><span class="op" id="7883378">:</span>&nbsp;<span class="string" id="7883380">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="7883408">}</span><span class="op" id="7883409">,</span>&nbsp;<span class="string" id="7883411">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="7883457">}</span><span class="op" id="7883458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883461">{</span><span class="string" id="7883462">&#34;foo/BAR&#34;</span><span class="op" id="7883471">,</span>&nbsp;<span class="keyword" id="7883473">map</span><span class="op" id="7883476">[</span><span class="builtintype" id="7883477">string</span><span class="op" id="7883483">]</span><span class="builtintype" id="7883484">string</span><span class="op" id="7883490">{</span><span class="string" id="7883491">&#34;&#34;</span><span class="op" id="7883493">:</span>&nbsp;<span class="string" id="7883495">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="7883512">}</span><span class="op" id="7883513">,</span>&nbsp;<span class="string" id="7883515">&#34;&#34;</span><span class="op" id="7883517">}</span><span class="op" id="7883518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883521">{</span><span class="string" id="7883522">&#34;foo/BAR&#34;</span><span class="op" id="7883531">,</span>&nbsp;<span class="keyword" id="7883533">map</span><span class="op" id="7883536">[</span><span class="builtintype" id="7883537">string</span><span class="op" id="7883543">]</span><span class="builtintype" id="7883544">string</span><span class="op" id="7883550">{</span><span class="string" id="7883551">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="7883566">:</span>&nbsp;<span class="string" id="7883568">&#34;baz&#34;</span><span class="op" id="7883573">}</span><span class="op" id="7883574">,</span>&nbsp;<span class="string" id="7883576">&#34;&#34;</span><span class="op" id="7883578">}</span><span class="op" id="7883579">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883582">{</span><span class="string" id="7883583">&#34;foo/BAR&#34;</span><span class="op" id="7883592">,</span>&nbsp;<span class="keyword" id="7883594">map</span><span class="op" id="7883597">[</span><span class="builtintype" id="7883598">string</span><span class="op" id="7883604">]</span><span class="builtintype" id="7883605">string</span><span class="op" id="7883611">{</span><span class="string" id="7883612">&#34;nonascii&#34;</span><span class="op" id="7883622">:</span>&nbsp;<span class="string" id="7883624">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;ä&#34;</span><span class="op" id="7883652">}</span><span class="op" id="7883653">,</span>&nbsp;<span class="string" id="7883655">&#34;&#34;</span><span class="op" id="7883657">}</span><span class="op" id="7883658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883661">{</span><span class="string" id="7883662">&#34;foo/bar&#34;</span><span class="op" id="7883671">,</span>&nbsp;<span class="keyword" id="7883673">map</span><span class="op" id="7883676">[</span><span class="builtintype" id="7883677">string</span><span class="op" id="7883683">]</span><span class="builtintype" id="7883684">string</span><span class="op" id="7883690">{</span><span class="string" id="7883691">&#34;a&#34;</span><span class="op" id="7883694">:</span>&nbsp;<span class="string" id="7883696">&#34;av&#34;</span><span class="op" id="7883700">,</span>&nbsp;<span class="string" id="7883702">&#34;b&#34;</span><span class="op" id="7883705">:</span>&nbsp;<span class="string" id="7883707">&#34;bv&#34;</span><span class="op" id="7883711">,</span>&nbsp;<span class="string" id="7883713">&#34;c&#34;</span><span class="op" id="7883716">:</span>&nbsp;<span class="string" id="7883718">&#34;cv&#34;</span><span class="op" id="7883722">}</span><span class="op" id="7883723">,</span>&nbsp;<span class="string" id="7883725">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="7883752">}</span><span class="op" id="7883753">,</span><br>
<span class="lineno"></span><span class="op" id="7883755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7883758">func</span>&nbsp;<span class="ident" id="7883763">TestFormatMediaType</span><span class="op" id="7883782">(</span><span class="ident" id="7883783">t</span>&nbsp;<span class="op" id="7883785">*</span><span class="ident" id="7883786">testing</span><span class="op" id="7883793">.</span><span class="ident" id="7883794">T</span><span class="op" id="7883795">)</span>&nbsp;<span class="op" id="7883797">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7883800">for</span>&nbsp;<span class="ident" id="7883804">i</span><span class="op" id="7883805">,</span>&nbsp;<span class="ident" id="7883807">tt</span>&nbsp;<span class="op" id="7883810">:=</span>&nbsp;<span class="keyword" id="7883813">range</span>&nbsp;<span class="ident" id="7883819">formatTests</span>&nbsp;<span class="op" id="7883831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7883835">got</span>&nbsp;<span class="op" id="7883839">:=</span>&nbsp;<span class="ident" id="7883842">FormatMediaType</span><span class="op" id="7883857">(</span><span class="ident" id="7883858">tt</span><span class="op" id="7883860">.</span><span class="ident" id="7883861">typ</span><span class="op" id="7883864">,</span>&nbsp;<span class="ident" id="7883866">tt</span><span class="op" id="7883868">.</span><span class="ident" id="7883869">params</span><span class="op" id="7883875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7883879">if</span>&nbsp;<span class="ident" id="7883882">got</span>&nbsp;<span class="op" id="7883886">!=</span>&nbsp;<span class="ident" id="7883889">tt</span><span class="op" id="7883891">.</span><span class="ident" id="7883892">want</span>&nbsp;<span class="op" id="7883897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7883902">t</span><span class="op" id="7883903">.</span><span class="ident" id="7883904">Errorf</span><span class="op" id="7883910">(</span><span class="string" id="7883911">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7883954">,</span>&nbsp;<span class="ident" id="7883956">i</span><span class="op" id="7883957">,</span>&nbsp;<span class="ident" id="7883959">tt</span><span class="op" id="7883961">.</span><span class="ident" id="7883962">typ</span><span class="op" id="7883965">,</span>&nbsp;<span class="ident" id="7883967">tt</span><span class="op" id="7883969">.</span><span class="ident" id="7883970">params</span><span class="op" id="7883976">,</span>&nbsp;<span class="ident" id="7883978">got</span><span class="op" id="7883981">,</span>&nbsp;<span class="ident" id="7883983">tt</span><span class="op" id="7883985">.</span><span class="ident" id="7883986">want</span><span class="op" id="7883990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883994">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7883997">}</span><br>
<span class="lineno"></span><span class="op" id="7883999">}</span>
</div>
</body>
</html>
