<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html" class="current">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3344323">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3344378">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3344432">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3344483">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3344553">package</span>&nbsp;<span class="ident" id="3344561">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3344567">import</span>&nbsp;<span class="op" id="3344574">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3344577">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3344586">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3344592">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3344602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3344605">var</span>&nbsp;<span class="ident" id="3344609">typeFiles</span>&nbsp;<span class="op" id="3344619">=</span>&nbsp;<span class="op" id="3344621">[</span><span class="op" id="3344622">]</span><span class="builtintype" id="3344623">string</span><span class="op" id="3344629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3344632">&#34;/etc/mime.types&#34;</span><span class="op" id="3344649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3344652">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3344677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3344680">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3344704">,</span><br>
<span class="lineno"></span><span class="op" id="3344706">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3344709">func</span>&nbsp;<span class="ident" id="3344714">loadMimeFile</span><span class="op" id="3344726">(</span><span class="ident" id="3344727">filename</span>&nbsp;<span class="builtintype" id="3344736">string</span><span class="op" id="3344742">)</span>&nbsp;<span class="op" id="3344744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3344747">f</span><span class="op" id="3344748">,</span>&nbsp;<span class="ident" id="3344750">err</span>&nbsp;<span class="op" id="3344754">:=</span>&nbsp;<span class="ident" id="3344757">os</span><span class="op" id="3344759">.</span><span class="ident" id="3344760">Open</span><span class="op" id="3344764">(</span><span class="ident" id="3344765">filename</span><span class="op" id="3344773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3344776">if</span>&nbsp;<span class="ident" id="3344779">err</span>&nbsp;<span class="op" id="3344783">!=</span>&nbsp;<span class="ident" id="3344786">nil</span>&nbsp;<span class="op" id="3344790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3344794">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3344802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3344805">defer</span>&nbsp;<span class="ident" id="3344811">f</span><span class="op" id="3344812">.</span><span class="ident" id="3344813">Close</span><span class="op" id="3344818">(</span><span class="op" id="3344819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3344823">scanner</span>&nbsp;<span class="op" id="3344831">:=</span>&nbsp;<span class="ident" id="3344834">bufio</span><span class="op" id="3344839">.</span><span class="ident" id="3344840">NewScanner</span><span class="op" id="3344850">(</span><span class="ident" id="3344851">f</span><span class="op" id="3344852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3344855">for</span>&nbsp;<span class="ident" id="3344859">scanner</span><span class="op" id="3344866">.</span><span class="ident" id="3344867">Scan</span><span class="op" id="3344871">(</span><span class="op" id="3344872">)</span>&nbsp;<span class="op" id="3344874">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3344878">fields</span>&nbsp;<span class="op" id="3344885">:=</span>&nbsp;<span class="ident" id="3344888">strings</span><span class="op" id="3344895">.</span><span class="ident" id="3344896">Fields</span><span class="op" id="3344902">(</span><span class="ident" id="3344903">scanner</span><span class="op" id="3344910">.</span><span class="ident" id="3344911">Text</span><span class="op" id="3344915">(</span><span class="op" id="3344916">)</span><span class="op" id="3344917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3344921">if</span>&nbsp;<span class="builtinfunc" id="3344924">len</span><span class="op" id="3344927">(</span><span class="ident" id="3344928">fields</span><span class="op" id="3344934">)</span>&nbsp;<span class="op" id="3344936">&lt;=</span>&nbsp;<span class="num" id="3344939">1</span>&nbsp;<span class="op" id="3344941">||</span>&nbsp;<span class="ident" id="3344944">fields</span><span class="op" id="3344950">[</span><span class="num" id="3344951">0</span><span class="op" id="3344952">]</span><span class="op" id="3344953">[</span><span class="num" id="3344954">0</span><span class="op" id="3344955">]</span>&nbsp;<span class="op" id="3344957">==</span>&nbsp;<span class="string" id="3344960">&#39;#&#39;</span>&nbsp;<span class="op" id="3344964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3344969">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3344980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3344984">mimeType</span>&nbsp;<span class="op" id="3344993">:=</span>&nbsp;<span class="ident" id="3344996">fields</span><span class="op" id="3345002">[</span><span class="num" id="3345003">0</span><span class="op" id="3345004">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3345008">for</span>&nbsp;<span class="ident" id="3345012">_</span><span class="op" id="3345013">,</span>&nbsp;<span class="ident" id="3345015">ext</span>&nbsp;<span class="op" id="3345019">:=</span>&nbsp;<span class="keyword" id="3345022">range</span>&nbsp;<span class="ident" id="3345028">fields</span><span class="op" id="3345034">[</span><span class="num" id="3345035">1</span><span class="op" id="3345036">:</span><span class="op" id="3345037">]</span>&nbsp;<span class="op" id="3345039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3345044">if</span>&nbsp;<span class="ident" id="3345047">ext</span><span class="op" id="3345050">[</span><span class="num" id="3345051">0</span><span class="op" id="3345052">]</span>&nbsp;<span class="op" id="3345054">==</span>&nbsp;<span class="string" id="3345057">&#39;#&#39;</span>&nbsp;<span class="op" id="3345061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3345067">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3345076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3345081">setExtensionType</span><span class="op" id="3345097">(</span><span class="string" id="3345098">&#34;.&#34;</span><span class="op" id="3345101">+</span><span class="ident" id="3345102">ext</span><span class="op" id="3345105">,</span>&nbsp;<span class="ident" id="3345107">mimeType</span><span class="op" id="3345115">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3345119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3345122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3345125">if</span>&nbsp;<span class="ident" id="3345128">err</span>&nbsp;<span class="op" id="3345132">:=</span>&nbsp;<span class="ident" id="3345135">scanner</span><span class="op" id="3345142">.</span><span class="ident" id="3345143">Err</span><span class="op" id="3345146">(</span><span class="op" id="3345147">)</span><span class="op" id="3345148">;</span>&nbsp;<span class="ident" id="3345150">err</span>&nbsp;<span class="op" id="3345154">!=</span>&nbsp;<span class="ident" id="3345157">nil</span>&nbsp;<span class="op" id="3345161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3345165">panic</span><span class="op" id="3345170">(</span><span class="ident" id="3345171">err</span><span class="op" id="3345174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3345177">}</span><br>
<span class="lineno">45</span><span class="op" id="3345179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3345182">func</span>&nbsp;<span class="ident" id="3345187">initMime</span><span class="op" id="3345195">(</span><span class="op" id="3345196">)</span>&nbsp;<span class="op" id="3345198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3345201">for</span>&nbsp;<span class="ident" id="3345205">_</span><span class="op" id="3345206">,</span>&nbsp;<span class="ident" id="3345208">filename</span>&nbsp;<span class="op" id="3345217">:=</span>&nbsp;<span class="keyword" id="3345220">range</span>&nbsp;<span class="ident" id="3345226">typeFiles</span>&nbsp;<span class="op" id="3345236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3345240">loadMimeFile</span><span class="op" id="3345252">(</span><span class="ident" id="3345253">filename</span><span class="op" id="3345261">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3345264">}</span><br>
<span class="lineno"></span><span class="op" id="3345266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3345269">func</span>&nbsp;<span class="ident" id="3345274">initMimeForTests</span><span class="op" id="3345290">(</span><span class="op" id="3345291">)</span>&nbsp;<span class="keyword" id="3345293">map</span><span class="op" id="3345296">[</span><span class="builtintype" id="3345297">string</span><span class="op" id="3345303">]</span><span class="builtintype" id="3345304">string</span>&nbsp;<span class="op" id="3345311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3345314">typeFiles</span>&nbsp;<span class="op" id="3345324">=</span>&nbsp;<span class="op" id="3345326">[</span><span class="op" id="3345327">]</span><span class="builtintype" id="3345328">string</span><span class="op" id="3345334">{</span><span class="string" id="3345335">&#34;testdata/test.types&#34;</span><span class="op" id="3345356">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3345359">return</span>&nbsp;<span class="keyword" id="3345366">map</span><span class="op" id="3345369">[</span><span class="builtintype" id="3345370">string</span><span class="op" id="3345376">]</span><span class="builtintype" id="3345377">string</span><span class="op" id="3345383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3345387">&#34;.T1&#34;</span><span class="op" id="3345392">:</span>&nbsp;&nbsp;<span class="string" id="3345395">&#34;application/test&#34;</span><span class="op" id="3345413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3345417">&#34;.t2&#34;</span><span class="op" id="3345422">:</span>&nbsp;&nbsp;<span class="string" id="3345425">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3345451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3345455">&#34;.png&#34;</span><span class="op" id="3345461">:</span>&nbsp;<span class="string" id="3345463">&#34;image/png&#34;</span><span class="op" id="3345474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3345477">}</span><br>
<span class="lineno">60</span><span class="op" id="3345479">}</span>
</div>
</body>
</html>
