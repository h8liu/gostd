<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2777371">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2777426">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2777480">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2777531">//&nbsp;Package&nbsp;time&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;measuring&nbsp;and&nbsp;displaying&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2777605">//</span><br>
<span class="lineno"></span><span class="comment" id="2777608">//&nbsp;The&nbsp;calendrical&nbsp;calculations&nbsp;always&nbsp;assume&nbsp;a&nbsp;Gregorian&nbsp;calendar.</span><br>
<span class="lineno"></span><span class="keyword" id="2777676">package</span>&nbsp;<span class="ident" id="2777684">time</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2777690">import</span>&nbsp;<span class="string" id="2777697">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2777707">//&nbsp;A&nbsp;Time&nbsp;represents&nbsp;an&nbsp;instant&nbsp;in&nbsp;time&nbsp;with&nbsp;nanosecond&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="2777774">//</span><br>
<span class="lineno"></span><span class="comment" id="2777777">//&nbsp;Programs&nbsp;using&nbsp;times&nbsp;should&nbsp;typically&nbsp;store&nbsp;and&nbsp;pass&nbsp;them&nbsp;as&nbsp;values,</span><br>
<span class="lineno">15</span><span class="comment" id="2777849">//&nbsp;not&nbsp;pointers.&nbsp;&nbsp;That&nbsp;is,&nbsp;time&nbsp;variables&nbsp;and&nbsp;struct&nbsp;fields&nbsp;should&nbsp;be&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2777922">//&nbsp;type&nbsp;time.Time,&nbsp;not&nbsp;*time.Time.&nbsp;&nbsp;A&nbsp;Time&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2777986">//&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="2778025">//</span><br>
<span class="lineno"></span><span class="comment" id="2778028">//&nbsp;Time&nbsp;instants&nbsp;can&nbsp;be&nbsp;compared&nbsp;using&nbsp;the&nbsp;Before,&nbsp;After,&nbsp;and&nbsp;Equal&nbsp;methods.</span><br>
<span class="lineno">20</span><span class="comment" id="2778105">//&nbsp;The&nbsp;Sub&nbsp;method&nbsp;subtracts&nbsp;two&nbsp;instants,&nbsp;producing&nbsp;a&nbsp;Duration.</span><br>
<span class="lineno"></span><span class="comment" id="2778169">//&nbsp;The&nbsp;Add&nbsp;method&nbsp;adds&nbsp;a&nbsp;Time&nbsp;and&nbsp;a&nbsp;Duration,&nbsp;producing&nbsp;a&nbsp;Time.</span><br>
<span class="lineno"></span><span class="comment" id="2778233">//</span><br>
<span class="lineno"></span><span class="comment" id="2778236">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;Time&nbsp;is&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2778313">//&nbsp;As&nbsp;this&nbsp;time&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;come&nbsp;up&nbsp;in&nbsp;practice,&nbsp;the&nbsp;IsZero&nbsp;method&nbsp;gives</span><br>
<span class="lineno">25</span><span class="comment" id="2778389">//&nbsp;a&nbsp;simple&nbsp;way&nbsp;of&nbsp;detecting&nbsp;a&nbsp;time&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;initialized&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment" id="2778467">//</span><br>
<span class="lineno"></span><span class="comment" id="2778470">//&nbsp;Each&nbsp;Time&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;Location,&nbsp;consulted&nbsp;when&nbsp;computing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2778547">//&nbsp;presentation&nbsp;form&nbsp;of&nbsp;the&nbsp;time,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;Format,&nbsp;Hour,&nbsp;and&nbsp;Year&nbsp;methods.</span><br>
<span class="lineno"></span><span class="comment" id="2778628">//&nbsp;The&nbsp;methods&nbsp;Local,&nbsp;UTC,&nbsp;and&nbsp;In&nbsp;return&nbsp;a&nbsp;Time&nbsp;with&nbsp;a&nbsp;specific&nbsp;location.</span><br>
<span class="lineno">30</span><span class="comment" id="2778702">//&nbsp;Changing&nbsp;the&nbsp;location&nbsp;in&nbsp;this&nbsp;way&nbsp;changes&nbsp;only&nbsp;the&nbsp;presentation;&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2778782">//&nbsp;change&nbsp;the&nbsp;instant&nbsp;in&nbsp;time&nbsp;being&nbsp;denoted&nbsp;and&nbsp;therefore&nbsp;does&nbsp;not&nbsp;affect&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2778860">//&nbsp;computations&nbsp;described&nbsp;in&nbsp;earlier&nbsp;paragraphs.</span><br>
<span class="lineno"></span><span class="comment" id="2778909">//</span><br>
<span class="lineno"></span><span class="comment" id="2778912">//&nbsp;Note&nbsp;that&nbsp;the&nbsp;Go&nbsp;==&nbsp;operator&nbsp;compares&nbsp;not&nbsp;just&nbsp;the&nbsp;time&nbsp;instant&nbsp;but&nbsp;also&nbsp;the</span><br>
<span class="lineno">35</span><span class="comment" id="2778992">//&nbsp;Location.&nbsp;Therefore,&nbsp;Time&nbsp;values&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;as&nbsp;map&nbsp;or&nbsp;database&nbsp;keys</span><br>
<span class="lineno"></span><span class="comment" id="2779071">//&nbsp;without&nbsp;first&nbsp;guaranteeing&nbsp;that&nbsp;the&nbsp;identical&nbsp;Location&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2779150">//&nbsp;values,&nbsp;which&nbsp;can&nbsp;be&nbsp;achieved&nbsp;through&nbsp;use&nbsp;of&nbsp;the&nbsp;UTC&nbsp;or&nbsp;Local&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2779223">//</span><br>
<span class="lineno"></span><span class="keyword" id="2779226">type</span>&nbsp;<span class="ident" id="2779231">Time</span>&nbsp;<span class="keyword" id="2779236">struct</span>&nbsp;<span class="op" id="2779243">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779246">//&nbsp;sec&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed&nbsp;since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779296">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779332">sec</span>&nbsp;<span class="ident" id="2779336">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779344">//&nbsp;nsec&nbsp;specifies&nbsp;a&nbsp;non-negative&nbsp;nanosecond</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779389">//&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;named&nbsp;by&nbsp;Seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779436">//&nbsp;It&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779480">nsec</span>&nbsp;<span class="builtintype" id="2779485">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779493">//&nbsp;loc&nbsp;specifies&nbsp;the&nbsp;Location&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779547">//&nbsp;determine&nbsp;the&nbsp;minute,&nbsp;hour,&nbsp;month,&nbsp;day,&nbsp;and&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779600">//&nbsp;that&nbsp;correspond&nbsp;to&nbsp;this&nbsp;Time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779634">//&nbsp;Only&nbsp;the&nbsp;zero&nbsp;Time&nbsp;has&nbsp;a&nbsp;nil&nbsp;Location.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2779677">//&nbsp;In&nbsp;that&nbsp;case&nbsp;it&nbsp;is&nbsp;interpreted&nbsp;to&nbsp;mean&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2779725">loc</span>&nbsp;<span class="op" id="2779729">*</span><span class="ident" id="2779730">Location</span><br>
<span class="lineno">55</span><span class="op" id="2779739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2779742">//&nbsp;After&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;after&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2779798">func</span>&nbsp;<span class="op" id="2779803">(</span><span class="ident" id="2779804">t</span>&nbsp;<span class="ident" id="2779806">Time</span><span class="op" id="2779810">)</span>&nbsp;<span class="ident" id="2779812">After</span><span class="op" id="2779817">(</span><span class="ident" id="2779818">u</span>&nbsp;<span class="ident" id="2779820">Time</span><span class="op" id="2779824">)</span>&nbsp;<span class="builtintype" id="2779826">bool</span>&nbsp;<span class="op" id="2779831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2779834">return</span>&nbsp;<span class="ident" id="2779841">t</span><span class="op" id="2779842">.</span><span class="ident" id="2779843">sec</span>&nbsp;<span class="op" id="2779847">&gt;</span>&nbsp;<span class="ident" id="2779849">u</span><span class="op" id="2779850">.</span><span class="ident" id="2779851">sec</span>&nbsp;<span class="op" id="2779855">||</span>&nbsp;<span class="ident" id="2779858">t</span><span class="op" id="2779859">.</span><span class="ident" id="2779860">sec</span>&nbsp;<span class="op" id="2779864">==</span>&nbsp;<span class="ident" id="2779867">u</span><span class="op" id="2779868">.</span><span class="ident" id="2779869">sec</span>&nbsp;<span class="op" id="2779873">&amp;&amp;</span>&nbsp;<span class="ident" id="2779876">t</span><span class="op" id="2779877">.</span><span class="ident" id="2779878">nsec</span>&nbsp;<span class="op" id="2779883">&gt;</span>&nbsp;<span class="ident" id="2779885">u</span><span class="op" id="2779886">.</span><span class="ident" id="2779887">nsec</span><br>
<span class="lineno">60</span><span class="op" id="2779892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2779895">//&nbsp;Before&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;before&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2779953">func</span>&nbsp;<span class="op" id="2779958">(</span><span class="ident" id="2779959">t</span>&nbsp;<span class="ident" id="2779961">Time</span><span class="op" id="2779965">)</span>&nbsp;<span class="ident" id="2779967">Before</span><span class="op" id="2779973">(</span><span class="ident" id="2779974">u</span>&nbsp;<span class="ident" id="2779976">Time</span><span class="op" id="2779980">)</span>&nbsp;<span class="builtintype" id="2779982">bool</span>&nbsp;<span class="op" id="2779987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2779990">return</span>&nbsp;<span class="ident" id="2779997">t</span><span class="op" id="2779998">.</span><span class="ident" id="2779999">sec</span>&nbsp;<span class="op" id="2780003">&lt;</span>&nbsp;<span class="ident" id="2780005">u</span><span class="op" id="2780006">.</span><span class="ident" id="2780007">sec</span>&nbsp;<span class="op" id="2780011">||</span>&nbsp;<span class="ident" id="2780014">t</span><span class="op" id="2780015">.</span><span class="ident" id="2780016">sec</span>&nbsp;<span class="op" id="2780020">==</span>&nbsp;<span class="ident" id="2780023">u</span><span class="op" id="2780024">.</span><span class="ident" id="2780025">sec</span>&nbsp;<span class="op" id="2780029">&amp;&amp;</span>&nbsp;<span class="ident" id="2780032">t</span><span class="op" id="2780033">.</span><span class="ident" id="2780034">nsec</span>&nbsp;<span class="op" id="2780039">&lt;</span>&nbsp;<span class="ident" id="2780041">u</span><span class="op" id="2780042">.</span><span class="ident" id="2780043">nsec</span><br>
<span class="lineno">65</span><span class="op" id="2780048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2780051">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;t&nbsp;and&nbsp;u&nbsp;represent&nbsp;the&nbsp;same&nbsp;time&nbsp;instant.</span><br>
<span class="lineno"></span><span class="comment" id="2780117">//&nbsp;Two&nbsp;times&nbsp;can&nbsp;be&nbsp;equal&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;different&nbsp;locations.</span><br>
<span class="lineno"></span><span class="comment" id="2780184">//&nbsp;For&nbsp;example,&nbsp;6:00&nbsp;+0200&nbsp;CEST&nbsp;and&nbsp;4:00&nbsp;UTC&nbsp;are&nbsp;Equal.</span><br>
<span class="lineno">70</span><span class="comment" id="2780240">//&nbsp;This&nbsp;comparison&nbsp;is&nbsp;different&nbsp;from&nbsp;using&nbsp;t&nbsp;==&nbsp;u,&nbsp;which&nbsp;also&nbsp;compares</span><br>
<span class="lineno"></span><span class="comment" id="2780311">//&nbsp;the&nbsp;locations.</span><br>
<span class="lineno"></span><span class="keyword" id="2780329">func</span>&nbsp;<span class="op" id="2780334">(</span><span class="ident" id="2780335">t</span>&nbsp;<span class="ident" id="2780337">Time</span><span class="op" id="2780341">)</span>&nbsp;<span class="ident" id="2780343">Equal</span><span class="op" id="2780348">(</span><span class="ident" id="2780349">u</span>&nbsp;<span class="ident" id="2780351">Time</span><span class="op" id="2780355">)</span>&nbsp;<span class="builtintype" id="2780357">bool</span>&nbsp;<span class="op" id="2780362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2780365">return</span>&nbsp;<span class="ident" id="2780372">t</span><span class="op" id="2780373">.</span><span class="ident" id="2780374">sec</span>&nbsp;<span class="op" id="2780378">==</span>&nbsp;<span class="ident" id="2780381">u</span><span class="op" id="2780382">.</span><span class="ident" id="2780383">sec</span>&nbsp;<span class="op" id="2780387">&amp;&amp;</span>&nbsp;<span class="ident" id="2780390">t</span><span class="op" id="2780391">.</span><span class="ident" id="2780392">nsec</span>&nbsp;<span class="op" id="2780397">==</span>&nbsp;<span class="ident" id="2780400">u</span><span class="op" id="2780401">.</span><span class="ident" id="2780402">nsec</span><br>
<span class="lineno"></span><span class="op" id="2780407">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2780410">//&nbsp;A&nbsp;Month&nbsp;specifies&nbsp;a&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;(January&nbsp;=&nbsp;1,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2780471">type</span>&nbsp;<span class="ident" id="2780476">Month</span>&nbsp;<span class="builtintype" id="2780482">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2780487">const</span>&nbsp;<span class="op" id="2780493">(</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780496">January</span>&nbsp;<span class="ident" id="2780504">Month</span>&nbsp;<span class="op" id="2780510">=</span>&nbsp;<span class="num" id="2780512">1</span>&nbsp;<span class="op" id="2780514">+</span>&nbsp;<span class="ident" id="2780516">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780522">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780532">March</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780539">April</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780546">May</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780551">June</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780557">July</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780563">August</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780571">September</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780582">October</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780591">November</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780601">December</span><br>
<span class="lineno"></span><span class="op" id="2780610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2780613">var</span>&nbsp;<span class="ident" id="2780617">months</span>&nbsp;<span class="op" id="2780624">=</span>&nbsp;<span class="op" id="2780626">[</span><span class="op" id="2780627">...</span><span class="op" id="2780630">]</span><span class="builtintype" id="2780631">string</span><span class="op" id="2780637">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780640">&#34;January&#34;</span><span class="op" id="2780649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780652">&#34;February&#34;</span><span class="op" id="2780662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780665">&#34;March&#34;</span><span class="op" id="2780672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780675">&#34;April&#34;</span><span class="op" id="2780682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780685">&#34;May&#34;</span><span class="op" id="2780690">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780693">&#34;June&#34;</span><span class="op" id="2780699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780702">&#34;July&#34;</span><span class="op" id="2780708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780711">&#34;August&#34;</span><span class="op" id="2780719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780722">&#34;September&#34;</span><span class="op" id="2780733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780736">&#34;October&#34;</span><span class="op" id="2780745">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780748">&#34;November&#34;</span><span class="op" id="2780758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2780761">&#34;December&#34;</span><span class="op" id="2780771">,</span><br>
<span class="lineno"></span><span class="op" id="2780773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2780776">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;month&nbsp;(&#34;January&#34;,&nbsp;&#34;February&#34;,&nbsp;...).</span><br>
<span class="lineno">110</span><span class="keyword" id="2780854">func</span>&nbsp;<span class="op" id="2780859">(</span><span class="ident" id="2780860">m</span>&nbsp;<span class="ident" id="2780862">Month</span><span class="op" id="2780867">)</span>&nbsp;<span class="ident" id="2780869">String</span><span class="op" id="2780875">(</span><span class="op" id="2780876">)</span>&nbsp;<span class="builtintype" id="2780878">string</span>&nbsp;<span class="op" id="2780885">{</span>&nbsp;<span class="keyword" id="2780887">return</span>&nbsp;<span class="ident" id="2780894">months</span><span class="op" id="2780900">[</span><span class="ident" id="2780901">m</span><span class="op" id="2780902">-</span><span class="num" id="2780903">1</span><span class="op" id="2780904">]</span>&nbsp;<span class="op" id="2780906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2780909">//&nbsp;A&nbsp;Weekday&nbsp;specifies&nbsp;a&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;(Sunday&nbsp;=&nbsp;0,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2780969">type</span>&nbsp;<span class="ident" id="2780974">Weekday</span>&nbsp;<span class="builtintype" id="2780982">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2780987">const</span>&nbsp;<span class="op" id="2780993">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2780996">Sunday</span>&nbsp;<span class="ident" id="2781003">Weekday</span>&nbsp;<span class="op" id="2781011">=</span>&nbsp;<span class="ident" id="2781013">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781019">Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781027">Tuesday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781036">Wednesday</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781047">Thursday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781057">Friday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2781065">Saturday</span><br>
<span class="lineno"></span><span class="op" id="2781074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2781077">var</span>&nbsp;<span class="ident" id="2781081">days</span>&nbsp;<span class="op" id="2781086">=</span>&nbsp;<span class="op" id="2781088">[</span><span class="op" id="2781089">...</span><span class="op" id="2781092">]</span><span class="builtintype" id="2781093">string</span><span class="op" id="2781099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781102">&#34;Sunday&#34;</span><span class="op" id="2781110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781113">&#34;Monday&#34;</span><span class="op" id="2781121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781124">&#34;Tuesday&#34;</span><span class="op" id="2781133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781136">&#34;Wednesday&#34;</span><span class="op" id="2781147">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781150">&#34;Thursday&#34;</span><span class="op" id="2781160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781163">&#34;Friday&#34;</span><span class="op" id="2781171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2781174">&#34;Saturday&#34;</span><span class="op" id="2781184">,</span><br>
<span class="lineno"></span><span class="op" id="2781186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2781189">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;day&nbsp;(&#34;Sunday&#34;,&nbsp;&#34;Monday&#34;,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2781262">func</span>&nbsp;<span class="op" id="2781267">(</span><span class="ident" id="2781268">d</span>&nbsp;<span class="ident" id="2781270">Weekday</span><span class="op" id="2781277">)</span>&nbsp;<span class="ident" id="2781279">String</span><span class="op" id="2781285">(</span><span class="op" id="2781286">)</span>&nbsp;<span class="builtintype" id="2781288">string</span>&nbsp;<span class="op" id="2781295">{</span>&nbsp;<span class="keyword" id="2781297">return</span>&nbsp;<span class="ident" id="2781304">days</span><span class="op" id="2781308">[</span><span class="ident" id="2781309">d</span><span class="op" id="2781310">]</span>&nbsp;<span class="op" id="2781312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2781315">//&nbsp;Computations&nbsp;on&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2781340">//</span><br>
<span class="lineno">140</span><span class="comment" id="2781343">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Time&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2781389">//&nbsp;&nbsp;&nbsp;&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC</span><br>
<span class="lineno"></span><span class="comment" id="2781434">//&nbsp;which&nbsp;(1)&nbsp;looks&nbsp;like&nbsp;a&nbsp;zero,&nbsp;or&nbsp;as&nbsp;close&nbsp;as&nbsp;you&nbsp;can&nbsp;get&nbsp;in&nbsp;a&nbsp;date</span><br>
<span class="lineno"></span><span class="comment" id="2781503">//&nbsp;(1-1-1&nbsp;00:00:00&nbsp;UTC),&nbsp;(2)&nbsp;is&nbsp;unlikely&nbsp;enough&nbsp;to&nbsp;arise&nbsp;in&nbsp;practice&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2781575">//&nbsp;be&nbsp;a&nbsp;suitable&nbsp;&#34;not&nbsp;set&#34;&nbsp;sentinel,&nbsp;unlike&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;and&nbsp;(3)&nbsp;has&nbsp;a</span><br>
<span class="lineno">145</span><span class="comment" id="2781645">//&nbsp;non-negative&nbsp;year&nbsp;even&nbsp;in&nbsp;time&nbsp;zones&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;unlike&nbsp;1-1-0</span><br>
<span class="lineno"></span><span class="comment" id="2781711">//&nbsp;00:00:00&nbsp;UTC,&nbsp;which&nbsp;would&nbsp;be&nbsp;12-31-(-1)&nbsp;19:00:00&nbsp;in&nbsp;New&nbsp;York.</span><br>
<span class="lineno"></span><span class="comment" id="2781776">//</span><br>
<span class="lineno"></span><span class="comment" id="2781779">//&nbsp;The&nbsp;zero&nbsp;Time&nbsp;value&nbsp;does&nbsp;not&nbsp;force&nbsp;a&nbsp;specific&nbsp;epoch&nbsp;for&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2781847">//&nbsp;representation.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;use&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;internally,&nbsp;we</span><br>
<span class="lineno">150</span><span class="comment" id="2781917">//&nbsp;could&nbsp;define&nbsp;that&nbsp;to&nbsp;distinguish&nbsp;a&nbsp;zero&nbsp;value&nbsp;from&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2781988">//&nbsp;time&nbsp;would&nbsp;be&nbsp;represented&nbsp;by&nbsp;sec=-1,&nbsp;nsec=1e9.&nbsp;&nbsp;However,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2782056">//&nbsp;suggest&nbsp;a&nbsp;representation,&nbsp;namely&nbsp;using&nbsp;1-1-1&nbsp;00:00:00&nbsp;UTC&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2782124">//&nbsp;epoch,&nbsp;and&nbsp;that&#39;s&nbsp;what&nbsp;we&nbsp;do.</span><br>
<span class="lineno"></span><span class="comment" id="2782157">//</span><br>
<span class="lineno">155</span><span class="comment" id="2782160">//&nbsp;The&nbsp;Add&nbsp;and&nbsp;Sub&nbsp;computations&nbsp;are&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;choice&nbsp;of&nbsp;epoch.</span><br>
<span class="lineno"></span><span class="comment" id="2782230">//</span><br>
<span class="lineno"></span><span class="comment" id="2782233">//&nbsp;The&nbsp;presentation&nbsp;computations&nbsp;-&nbsp;year,&nbsp;month,&nbsp;minute,&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2782305">//&nbsp;rely&nbsp;heavily&nbsp;on&nbsp;division&nbsp;and&nbsp;modulus&nbsp;by&nbsp;positive&nbsp;constants.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span><span class="comment" id="2782373">//&nbsp;calendrical&nbsp;calculations&nbsp;we&nbsp;want&nbsp;these&nbsp;divisions&nbsp;to&nbsp;round&nbsp;down,&nbsp;even</span><br>
<span class="lineno">160</span><span class="comment" id="2782445">//&nbsp;for&nbsp;negative&nbsp;values,&nbsp;so&nbsp;that&nbsp;the&nbsp;remainder&nbsp;is&nbsp;always&nbsp;positive,&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2782515">//&nbsp;Go&#39;s&nbsp;division&nbsp;(like&nbsp;most&nbsp;hardware&nbsp;division&nbsp;instructions)&nbsp;rounds&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2782585">//&nbsp;zero.&nbsp;&nbsp;We&nbsp;can&nbsp;still&nbsp;do&nbsp;those&nbsp;computations&nbsp;and&nbsp;then&nbsp;adjust&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="2782657">//&nbsp;for&nbsp;a&nbsp;negative&nbsp;numerator,&nbsp;but&nbsp;it&#39;s&nbsp;annoying&nbsp;to&nbsp;write&nbsp;the&nbsp;adjustment</span><br>
<span class="lineno"></span><span class="comment" id="2782728">//&nbsp;over&nbsp;and&nbsp;over.&nbsp;&nbsp;Instead,&nbsp;we&nbsp;can&nbsp;change&nbsp;to&nbsp;a&nbsp;different&nbsp;epoch&nbsp;so&nbsp;long</span><br>
<span class="lineno">165</span><span class="comment" id="2782799">//&nbsp;ago&nbsp;that&nbsp;all&nbsp;the&nbsp;times&nbsp;we&nbsp;care&nbsp;about&nbsp;will&nbsp;be&nbsp;positive,&nbsp;and&nbsp;then&nbsp;round</span><br>
<span class="lineno"></span><span class="comment" id="2782872">//&nbsp;to&nbsp;zero&nbsp;and&nbsp;round&nbsp;down&nbsp;coincide.&nbsp;&nbsp;These&nbsp;presentation&nbsp;routines&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2782945">//&nbsp;have&nbsp;to&nbsp;add&nbsp;the&nbsp;zone&nbsp;offset,&nbsp;so&nbsp;adding&nbsp;the&nbsp;translation&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2783010">//&nbsp;alternate&nbsp;epoch&nbsp;is&nbsp;cheap.&nbsp;&nbsp;For&nbsp;example,&nbsp;having&nbsp;a&nbsp;non-negative&nbsp;time&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2783082">//&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">170</span><span class="comment" id="2783109">//</span><br>
<span class="lineno"></span><span class="comment" id="2783112">//&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2783128">//</span><br>
<span class="lineno"></span><span class="comment" id="2783131">//&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2783145">//</span><br>
<span class="lineno">175</span><span class="comment" id="2783148">//&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2783164">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="2783180">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;+=&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2783194">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="2783199">//</span><br>
<span class="lineno">180</span><span class="comment" id="2783202">//&nbsp;everywhere.</span><br>
<span class="lineno"></span><span class="comment" id="2783217">//</span><br>
<span class="lineno"></span><span class="comment" id="2783220">//&nbsp;The&nbsp;calendar&nbsp;runs&nbsp;on&nbsp;an&nbsp;exact&nbsp;400&nbsp;year&nbsp;cycle:&nbsp;a&nbsp;400-year&nbsp;calendar</span><br>
<span class="lineno"></span><span class="comment" id="2783289">//&nbsp;printed&nbsp;for&nbsp;1970-2469&nbsp;will&nbsp;apply&nbsp;as&nbsp;well&nbsp;to&nbsp;2470-2869.&nbsp;&nbsp;Even&nbsp;the&nbsp;days</span><br>
<span class="lineno"></span><span class="comment" id="2783362">//&nbsp;of&nbsp;the&nbsp;week&nbsp;match&nbsp;up.&nbsp;&nbsp;It&nbsp;simplifies&nbsp;the&nbsp;computations&nbsp;to&nbsp;choose&nbsp;the</span><br>
<span class="lineno">185</span><span class="comment" id="2783433">//&nbsp;cycle&nbsp;boundaries&nbsp;so&nbsp;that&nbsp;the&nbsp;exceptional&nbsp;years&nbsp;are&nbsp;always&nbsp;delayed&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2783505">//&nbsp;long&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&nbsp;means&nbsp;choosing&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2783577">//&nbsp;that&nbsp;the&nbsp;first&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;4th&nbsp;year,&nbsp;the&nbsp;first&nbsp;missed&nbsp;leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2783649">//&nbsp;is&nbsp;the&nbsp;100th&nbsp;year,&nbsp;and&nbsp;the&nbsp;missed&nbsp;missed&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;400th&nbsp;year.</span><br>
<span class="lineno"></span><span class="comment" id="2783722">//&nbsp;So&nbsp;we&#39;d&nbsp;prefer&nbsp;instead&nbsp;to&nbsp;print&nbsp;a&nbsp;calendar&nbsp;for&nbsp;2001-2400&nbsp;and&nbsp;reuse&nbsp;it</span><br>
<span class="lineno">190</span><span class="comment" id="2783795">//&nbsp;for&nbsp;2401-2800.</span><br>
<span class="lineno"></span><span class="comment" id="2783813">//</span><br>
<span class="lineno"></span><span class="comment" id="2783816">//&nbsp;Finally,&nbsp;it&#39;s&nbsp;convenient&nbsp;if&nbsp;the&nbsp;delta&nbsp;between&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2783884">//&nbsp;long-ago&nbsp;epoch&nbsp;is&nbsp;representable&nbsp;by&nbsp;an&nbsp;int64&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2783941">//</span><br>
<span class="lineno">195</span><span class="comment" id="2783944">//&nbsp;These&nbsp;three&nbsp;considerations—choose&nbsp;an&nbsp;epoch&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2784019">//&nbsp;uses&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;that&nbsp;is&nbsp;no&nbsp;more&nbsp;than&nbsp;2⁶³&nbsp;seconds</span><br>
<span class="lineno"></span><span class="comment" id="2784094">//&nbsp;earlier&nbsp;than&nbsp;1970—bring&nbsp;us&nbsp;to&nbsp;the&nbsp;year&nbsp;-292277022399.&nbsp;&nbsp;We&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2784166">//&nbsp;this&nbsp;year&nbsp;as&nbsp;the&nbsp;absolute&nbsp;zero&nbsp;year,&nbsp;and&nbsp;to&nbsp;times&nbsp;measured&nbsp;as&nbsp;a&nbsp;uint64</span><br>
<span class="lineno"></span><span class="comment" id="2784240">//&nbsp;seconds&nbsp;since&nbsp;this&nbsp;year&nbsp;as&nbsp;absolute&nbsp;times.</span><br>
<span class="lineno">200</span><span class="comment" id="2784286">//</span><br>
<span class="lineno"></span><span class="comment" id="2784289">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1—the&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2784365">//&nbsp;used&nbsp;for&nbsp;Time&#39;s&nbsp;sec&nbsp;field—are&nbsp;called&nbsp;internal&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2784423">//</span><br>
<span class="lineno"></span><span class="comment" id="2784426">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1970&nbsp;are&nbsp;called&nbsp;Unix</span><br>
<span class="lineno">205</span><span class="comment" id="2784500">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2784510">//</span><br>
<span class="lineno"></span><span class="comment" id="2784513">//&nbsp;It&nbsp;is&nbsp;tempting&nbsp;to&nbsp;just&nbsp;use&nbsp;the&nbsp;year&nbsp;1&nbsp;as&nbsp;the&nbsp;absolute&nbsp;epoch,&nbsp;defining</span><br>
<span class="lineno"></span><span class="comment" id="2784586">//&nbsp;that&nbsp;the&nbsp;routines&nbsp;are&nbsp;only&nbsp;valid&nbsp;for&nbsp;years&nbsp;&gt;=&nbsp;1.&nbsp;&nbsp;However,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2784652">//&nbsp;routines&nbsp;would&nbsp;then&nbsp;be&nbsp;invalid&nbsp;when&nbsp;displaying&nbsp;the&nbsp;epoch&nbsp;in&nbsp;time&nbsp;zones</span><br>
<span class="lineno">210</span><span class="comment" id="2784726">//&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;since&nbsp;it&nbsp;is&nbsp;year&nbsp;0.&nbsp;&nbsp;It&nbsp;doesn&#39;t&nbsp;seem&nbsp;tenable&nbsp;to&nbsp;say&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2784799">//&nbsp;printing&nbsp;the&nbsp;zero&nbsp;time&nbsp;correctly&nbsp;isn&#39;t&nbsp;supported&nbsp;in&nbsp;half&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2784868">//&nbsp;zones.&nbsp;&nbsp;By&nbsp;comparison,&nbsp;it&#39;s&nbsp;reasonable&nbsp;to&nbsp;mishandle&nbsp;some&nbsp;times&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2784937">//&nbsp;the&nbsp;year&nbsp;-292277022399.</span><br>
<span class="lineno"></span><span class="comment" id="2784964">//</span><br>
<span class="lineno">215</span><span class="comment" id="2784967">//&nbsp;All&nbsp;this&nbsp;is&nbsp;opaque&nbsp;to&nbsp;clients&nbsp;of&nbsp;the&nbsp;API&nbsp;and&nbsp;can&nbsp;be&nbsp;changed&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2785035">//&nbsp;better&nbsp;implementation&nbsp;presents&nbsp;itself.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785078">const</span>&nbsp;<span class="op" id="2785084">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785087">//&nbsp;The&nbsp;unsigned&nbsp;zero&nbsp;year&nbsp;for&nbsp;internal&nbsp;calculations.</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785141">//&nbsp;Must&nbsp;be&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;times&nbsp;before&nbsp;it&nbsp;will&nbsp;not&nbsp;compute&nbsp;correctly,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785212">//&nbsp;but&nbsp;otherwise&nbsp;can&nbsp;be&nbsp;changed&nbsp;at&nbsp;will.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785254">absoluteZeroYear</span>&nbsp;<span class="op" id="2785271">=</span>&nbsp;<span class="op" id="2785273">-</span><span class="num" id="2785274">292277022399</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785289">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Time.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785320">//&nbsp;Assumed&nbsp;by&nbsp;the&nbsp;unixToInternal&nbsp;computation&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785373">internalYear</span>&nbsp;<span class="op" id="2785386">=</span>&nbsp;<span class="num" id="2785388">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785392">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Unix&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785428">unixYear</span>&nbsp;<span class="op" id="2785437">=</span>&nbsp;<span class="num" id="2785439">1970</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2785446">//&nbsp;Offsets&nbsp;to&nbsp;convert&nbsp;between&nbsp;internal&nbsp;and&nbsp;absolute&nbsp;or&nbsp;Unix&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785514">absoluteToInternal</span>&nbsp;<span class="ident" id="2785533">int64</span>&nbsp;<span class="op" id="2785539">=</span>&nbsp;<span class="op" id="2785541">(</span><span class="ident" id="2785542">absoluteZeroYear</span>&nbsp;<span class="op" id="2785559">-</span>&nbsp;<span class="ident" id="2785561">internalYear</span><span class="op" id="2785573">)</span>&nbsp;<span class="op" id="2785575">*</span>&nbsp;<span class="num" id="2785577">365.2425</span>&nbsp;<span class="op" id="2785586">*</span>&nbsp;<span class="ident" id="2785588">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785603">internalToAbsolute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2785628">=</span>&nbsp;<span class="op" id="2785630">-</span><span class="ident" id="2785631">absoluteToInternal</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785652">unixToInternal</span>&nbsp;<span class="ident" id="2785667">int64</span>&nbsp;<span class="op" id="2785673">=</span>&nbsp;<span class="op" id="2785675">(</span><span class="num" id="2785676">1969</span><span class="op" id="2785680">*</span><span class="num" id="2785681">365</span>&nbsp;<span class="op" id="2785685">+</span>&nbsp;<span class="num" id="2785687">1969</span><span class="op" id="2785691">/</span><span class="num" id="2785692">4</span>&nbsp;<span class="op" id="2785694">-</span>&nbsp;<span class="num" id="2785696">1969</span><span class="op" id="2785700">/</span><span class="num" id="2785701">100</span>&nbsp;<span class="op" id="2785705">+</span>&nbsp;<span class="num" id="2785707">1969</span><span class="op" id="2785711">/</span><span class="num" id="2785712">400</span><span class="op" id="2785715">)</span>&nbsp;<span class="op" id="2785717">*</span>&nbsp;<span class="ident" id="2785719">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2785734">internalToUnix</span>&nbsp;<span class="ident" id="2785749">int64</span>&nbsp;<span class="op" id="2785755">=</span>&nbsp;<span class="op" id="2785757">-</span><span class="ident" id="2785758">unixToInternal</span><br>
<span class="lineno"></span><span class="op" id="2785773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2785776">//&nbsp;IsZero&nbsp;reports&nbsp;whether&nbsp;t&nbsp;represents&nbsp;the&nbsp;zero&nbsp;time&nbsp;instant,</span><br>
<span class="lineno">240</span><span class="comment" id="2785838">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2785874">func</span>&nbsp;<span class="op" id="2785879">(</span><span class="ident" id="2785880">t</span>&nbsp;<span class="ident" id="2785882">Time</span><span class="op" id="2785886">)</span>&nbsp;<span class="ident" id="2785888">IsZero</span><span class="op" id="2785894">(</span><span class="op" id="2785895">)</span>&nbsp;<span class="builtintype" id="2785897">bool</span>&nbsp;<span class="op" id="2785902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2785905">return</span>&nbsp;<span class="ident" id="2785912">t</span><span class="op" id="2785913">.</span><span class="ident" id="2785914">sec</span>&nbsp;<span class="op" id="2785918">==</span>&nbsp;<span class="num" id="2785921">0</span>&nbsp;<span class="op" id="2785923">&amp;&amp;</span>&nbsp;<span class="ident" id="2785926">t</span><span class="op" id="2785927">.</span><span class="ident" id="2785928">nsec</span>&nbsp;<span class="op" id="2785933">==</span>&nbsp;<span class="num" id="2785936">0</span><br>
<span class="lineno"></span><span class="op" id="2785938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2785941">//&nbsp;abs&nbsp;returns&nbsp;the&nbsp;time&nbsp;t&nbsp;as&nbsp;an&nbsp;absolute&nbsp;time,&nbsp;adjusted&nbsp;by&nbsp;the&nbsp;zone&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2786017">//&nbsp;It&nbsp;is&nbsp;called&nbsp;when&nbsp;computing&nbsp;a&nbsp;presentation&nbsp;property&nbsp;like&nbsp;Month&nbsp;or&nbsp;Hour.</span><br>
<span class="lineno"></span><span class="keyword" id="2786092">func</span>&nbsp;<span class="op" id="2786097">(</span><span class="ident" id="2786098">t</span>&nbsp;<span class="ident" id="2786100">Time</span><span class="op" id="2786104">)</span>&nbsp;<span class="ident" id="2786106">abs</span><span class="op" id="2786109">(</span><span class="op" id="2786110">)</span>&nbsp;<span class="ident" id="2786112">uint64</span>&nbsp;<span class="op" id="2786119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786122">l</span>&nbsp;<span class="op" id="2786124">:=</span>&nbsp;<span class="ident" id="2786127">t</span><span class="op" id="2786128">.</span><span class="ident" id="2786129">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2786134">//&nbsp;Avoid&nbsp;function&nbsp;calls&nbsp;when&nbsp;possible.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786174">if</span>&nbsp;<span class="ident" id="2786177">l</span>&nbsp;<span class="op" id="2786179">==</span>&nbsp;<span class="ident" id="2786182">nil</span>&nbsp;<span class="op" id="2786186">||</span>&nbsp;<span class="ident" id="2786189">l</span>&nbsp;<span class="op" id="2786191">==</span>&nbsp;<span class="op" id="2786194">&amp;</span><span class="ident" id="2786195">localLoc</span>&nbsp;<span class="op" id="2786204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786208">l</span>&nbsp;<span class="op" id="2786210">=</span>&nbsp;<span class="ident" id="2786212">l</span><span class="op" id="2786213">.</span><span class="ident" id="2786214">get</span><span class="op" id="2786217">(</span><span class="op" id="2786218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786224">sec</span>&nbsp;<span class="op" id="2786228">:=</span>&nbsp;<span class="ident" id="2786231">t</span><span class="op" id="2786232">.</span><span class="ident" id="2786233">sec</span>&nbsp;<span class="op" id="2786237">+</span>&nbsp;<span class="ident" id="2786239">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786255">if</span>&nbsp;<span class="ident" id="2786258">l</span>&nbsp;<span class="op" id="2786260">!=</span>&nbsp;<span class="op" id="2786263">&amp;</span><span class="ident" id="2786264">utcLoc</span>&nbsp;<span class="op" id="2786271">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786275">if</span>&nbsp;<span class="ident" id="2786278">l</span><span class="op" id="2786279">.</span><span class="ident" id="2786280">cacheZone</span>&nbsp;<span class="op" id="2786290">!=</span>&nbsp;<span class="ident" id="2786293">nil</span>&nbsp;<span class="op" id="2786297">&amp;&amp;</span>&nbsp;<span class="ident" id="2786300">l</span><span class="op" id="2786301">.</span><span class="ident" id="2786302">cacheStart</span>&nbsp;<span class="op" id="2786313">&lt;=</span>&nbsp;<span class="ident" id="2786316">sec</span>&nbsp;<span class="op" id="2786320">&amp;&amp;</span>&nbsp;<span class="ident" id="2786323">sec</span>&nbsp;<span class="op" id="2786327">&lt;</span>&nbsp;<span class="ident" id="2786329">l</span><span class="op" id="2786330">.</span><span class="ident" id="2786331">cacheEnd</span>&nbsp;<span class="op" id="2786340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786345">sec</span>&nbsp;<span class="op" id="2786349">+=</span>&nbsp;<span class="ident" id="2786352">int64</span><span class="op" id="2786357">(</span><span class="ident" id="2786358">l</span><span class="op" id="2786359">.</span><span class="ident" id="2786360">cacheZone</span><span class="op" id="2786369">.</span><span class="ident" id="2786370">offset</span><span class="op" id="2786376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786380">}</span>&nbsp;<span class="keyword" id="2786382">else</span>&nbsp;<span class="op" id="2786387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786392">_</span><span class="op" id="2786393">,</span>&nbsp;<span class="ident" id="2786395">offset</span><span class="op" id="2786401">,</span>&nbsp;<span class="ident" id="2786403">_</span><span class="op" id="2786404">,</span>&nbsp;<span class="ident" id="2786406">_</span><span class="op" id="2786407">,</span>&nbsp;<span class="ident" id="2786409">_</span>&nbsp;<span class="op" id="2786411">:=</span>&nbsp;<span class="ident" id="2786414">l</span><span class="op" id="2786415">.</span><span class="ident" id="2786416">lookup</span><span class="op" id="2786422">(</span><span class="ident" id="2786423">sec</span><span class="op" id="2786426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786431">sec</span>&nbsp;<span class="op" id="2786435">+=</span>&nbsp;<span class="ident" id="2786438">int64</span><span class="op" id="2786443">(</span><span class="ident" id="2786444">offset</span><span class="op" id="2786450">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786460">return</span>&nbsp;<span class="ident" id="2786467">uint64</span><span class="op" id="2786473">(</span><span class="ident" id="2786474">sec</span>&nbsp;<span class="op" id="2786478">+</span>&nbsp;<span class="op" id="2786480">(</span><span class="ident" id="2786481">unixToInternal</span>&nbsp;<span class="op" id="2786496">+</span>&nbsp;<span class="ident" id="2786498">internalToAbsolute</span><span class="op" id="2786516">)</span><span class="op" id="2786517">)</span><br>
<span class="lineno"></span><span class="op" id="2786519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2786522">//&nbsp;locabs&nbsp;is&nbsp;a&nbsp;combination&nbsp;of&nbsp;the&nbsp;Zone&nbsp;and&nbsp;abs&nbsp;methods,</span><br>
<span class="lineno"></span><span class="comment" id="2786578">//&nbsp;extracting&nbsp;both&nbsp;return&nbsp;values&nbsp;from&nbsp;a&nbsp;single&nbsp;zone&nbsp;lookup.</span><br>
<span class="lineno"></span><span class="keyword" id="2786638">func</span>&nbsp;<span class="op" id="2786643">(</span><span class="ident" id="2786644">t</span>&nbsp;<span class="ident" id="2786646">Time</span><span class="op" id="2786650">)</span>&nbsp;<span class="ident" id="2786652">locabs</span><span class="op" id="2786658">(</span><span class="op" id="2786659">)</span>&nbsp;<span class="op" id="2786661">(</span><span class="ident" id="2786662">name</span>&nbsp;<span class="builtintype" id="2786667">string</span><span class="op" id="2786673">,</span>&nbsp;<span class="ident" id="2786675">offset</span>&nbsp;<span class="builtintype" id="2786682">int</span><span class="op" id="2786685">,</span>&nbsp;<span class="ident" id="2786687">abs</span>&nbsp;<span class="ident" id="2786691">uint64</span><span class="op" id="2786697">)</span>&nbsp;<span class="op" id="2786699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786702">l</span>&nbsp;<span class="op" id="2786704">:=</span>&nbsp;<span class="ident" id="2786707">t</span><span class="op" id="2786708">.</span><span class="ident" id="2786709">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786714">if</span>&nbsp;<span class="ident" id="2786717">l</span>&nbsp;<span class="op" id="2786719">==</span>&nbsp;<span class="ident" id="2786722">nil</span>&nbsp;<span class="op" id="2786726">||</span>&nbsp;<span class="ident" id="2786729">l</span>&nbsp;<span class="op" id="2786731">==</span>&nbsp;<span class="op" id="2786734">&amp;</span><span class="ident" id="2786735">localLoc</span>&nbsp;<span class="op" id="2786744">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786748">l</span>&nbsp;<span class="op" id="2786750">=</span>&nbsp;<span class="ident" id="2786752">l</span><span class="op" id="2786753">.</span><span class="ident" id="2786754">get</span><span class="op" id="2786757">(</span><span class="op" id="2786758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2786764">//&nbsp;Avoid&nbsp;function&nbsp;call&nbsp;if&nbsp;we&nbsp;hit&nbsp;the&nbsp;local&nbsp;time&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786820">sec</span>&nbsp;<span class="op" id="2786824">:=</span>&nbsp;<span class="ident" id="2786827">t</span><span class="op" id="2786828">.</span><span class="ident" id="2786829">sec</span>&nbsp;<span class="op" id="2786833">+</span>&nbsp;<span class="ident" id="2786835">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786851">if</span>&nbsp;<span class="ident" id="2786854">l</span>&nbsp;<span class="op" id="2786856">!=</span>&nbsp;<span class="op" id="2786859">&amp;</span><span class="ident" id="2786860">utcLoc</span>&nbsp;<span class="op" id="2786867">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2786871">if</span>&nbsp;<span class="ident" id="2786874">l</span><span class="op" id="2786875">.</span><span class="ident" id="2786876">cacheZone</span>&nbsp;<span class="op" id="2786886">!=</span>&nbsp;<span class="ident" id="2786889">nil</span>&nbsp;<span class="op" id="2786893">&amp;&amp;</span>&nbsp;<span class="ident" id="2786896">l</span><span class="op" id="2786897">.</span><span class="ident" id="2786898">cacheStart</span>&nbsp;<span class="op" id="2786909">&lt;=</span>&nbsp;<span class="ident" id="2786912">sec</span>&nbsp;<span class="op" id="2786916">&amp;&amp;</span>&nbsp;<span class="ident" id="2786919">sec</span>&nbsp;<span class="op" id="2786923">&lt;</span>&nbsp;<span class="ident" id="2786925">l</span><span class="op" id="2786926">.</span><span class="ident" id="2786927">cacheEnd</span>&nbsp;<span class="op" id="2786936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786941">name</span>&nbsp;<span class="op" id="2786946">=</span>&nbsp;<span class="ident" id="2786948">l</span><span class="op" id="2786949">.</span><span class="ident" id="2786950">cacheZone</span><span class="op" id="2786959">.</span><span class="ident" id="2786960">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786968">offset</span>&nbsp;<span class="op" id="2786975">=</span>&nbsp;<span class="ident" id="2786977">l</span><span class="op" id="2786978">.</span><span class="ident" id="2786979">cacheZone</span><span class="op" id="2786988">.</span><span class="ident" id="2786989">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2786998">}</span>&nbsp;<span class="keyword" id="2787000">else</span>&nbsp;<span class="op" id="2787005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787010">name</span><span class="op" id="2787014">,</span>&nbsp;<span class="ident" id="2787016">offset</span><span class="op" id="2787022">,</span>&nbsp;<span class="ident" id="2787024">_</span><span class="op" id="2787025">,</span>&nbsp;<span class="ident" id="2787027">_</span><span class="op" id="2787028">,</span>&nbsp;<span class="ident" id="2787030">_</span>&nbsp;<span class="op" id="2787032">=</span>&nbsp;<span class="ident" id="2787034">l</span><span class="op" id="2787035">.</span><span class="ident" id="2787036">lookup</span><span class="op" id="2787042">(</span><span class="ident" id="2787043">sec</span><span class="op" id="2787046">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787054">sec</span>&nbsp;<span class="op" id="2787058">+=</span>&nbsp;<span class="ident" id="2787061">int64</span><span class="op" id="2787066">(</span><span class="ident" id="2787067">offset</span><span class="op" id="2787073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787076">}</span>&nbsp;<span class="keyword" id="2787078">else</span>&nbsp;<span class="op" id="2787083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787087">name</span>&nbsp;<span class="op" id="2787092">=</span>&nbsp;<span class="string" id="2787094">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2787101">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787104">abs</span>&nbsp;<span class="op" id="2787108">=</span>&nbsp;<span class="ident" id="2787110">uint64</span><span class="op" id="2787116">(</span><span class="ident" id="2787117">sec</span>&nbsp;<span class="op" id="2787121">+</span>&nbsp;<span class="op" id="2787123">(</span><span class="ident" id="2787124">unixToInternal</span>&nbsp;<span class="op" id="2787139">+</span>&nbsp;<span class="ident" id="2787141">internalToAbsolute</span><span class="op" id="2787159">)</span><span class="op" id="2787160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787163">return</span><br>
<span class="lineno"></span><span class="op" id="2787170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787173">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno">290</span><span class="keyword" id="2787233">func</span>&nbsp;<span class="op" id="2787238">(</span><span class="ident" id="2787239">t</span>&nbsp;<span class="ident" id="2787241">Time</span><span class="op" id="2787245">)</span>&nbsp;<span class="ident" id="2787247">Date</span><span class="op" id="2787251">(</span><span class="op" id="2787252">)</span>&nbsp;<span class="op" id="2787254">(</span><span class="ident" id="2787255">year</span>&nbsp;<span class="builtintype" id="2787260">int</span><span class="op" id="2787263">,</span>&nbsp;<span class="ident" id="2787265">month</span>&nbsp;<span class="ident" id="2787271">Month</span><span class="op" id="2787276">,</span>&nbsp;<span class="ident" id="2787278">day</span>&nbsp;<span class="builtintype" id="2787282">int</span><span class="op" id="2787285">)</span>&nbsp;<span class="op" id="2787287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787290">year</span><span class="op" id="2787294">,</span>&nbsp;<span class="ident" id="2787296">month</span><span class="op" id="2787301">,</span>&nbsp;<span class="ident" id="2787303">day</span><span class="op" id="2787306">,</span>&nbsp;<span class="ident" id="2787308">_</span>&nbsp;<span class="op" id="2787310">=</span>&nbsp;<span class="ident" id="2787312">t</span><span class="op" id="2787313">.</span><span class="ident" id="2787314">date</span><span class="op" id="2787318">(</span><span class="builtintype" id="2787319">true</span><span class="op" id="2787323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787326">return</span><br>
<span class="lineno"></span><span class="op" id="2787333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="2787336">//&nbsp;Year&nbsp;returns&nbsp;the&nbsp;year&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2787380">func</span>&nbsp;<span class="op" id="2787385">(</span><span class="ident" id="2787386">t</span>&nbsp;<span class="ident" id="2787388">Time</span><span class="op" id="2787392">)</span>&nbsp;<span class="ident" id="2787394">Year</span><span class="op" id="2787398">(</span><span class="op" id="2787399">)</span>&nbsp;<span class="builtintype" id="2787401">int</span>&nbsp;<span class="op" id="2787405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787408">year</span><span class="op" id="2787412">,</span>&nbsp;<span class="ident" id="2787414">_</span><span class="op" id="2787415">,</span>&nbsp;<span class="ident" id="2787417">_</span><span class="op" id="2787418">,</span>&nbsp;<span class="ident" id="2787420">_</span>&nbsp;<span class="op" id="2787422">:=</span>&nbsp;<span class="ident" id="2787425">t</span><span class="op" id="2787426">.</span><span class="ident" id="2787427">date</span><span class="op" id="2787431">(</span><span class="builtintype" id="2787432">false</span><span class="op" id="2787437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787440">return</span>&nbsp;<span class="ident" id="2787447">year</span><br>
<span class="lineno"></span><span class="op" id="2787452">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2787455">//&nbsp;Month&nbsp;returns&nbsp;the&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2787510">func</span>&nbsp;<span class="op" id="2787515">(</span><span class="ident" id="2787516">t</span>&nbsp;<span class="ident" id="2787518">Time</span><span class="op" id="2787522">)</span>&nbsp;<span class="ident" id="2787524">Month</span><span class="op" id="2787529">(</span><span class="op" id="2787530">)</span>&nbsp;<span class="ident" id="2787532">Month</span>&nbsp;<span class="op" id="2787538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787541">_</span><span class="op" id="2787542">,</span>&nbsp;<span class="ident" id="2787544">month</span><span class="op" id="2787549">,</span>&nbsp;<span class="ident" id="2787551">_</span><span class="op" id="2787552">,</span>&nbsp;<span class="ident" id="2787554">_</span>&nbsp;<span class="op" id="2787556">:=</span>&nbsp;<span class="ident" id="2787559">t</span><span class="op" id="2787560">.</span><span class="ident" id="2787561">date</span><span class="op" id="2787565">(</span><span class="builtintype" id="2787566">true</span><span class="op" id="2787570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787573">return</span>&nbsp;<span class="ident" id="2787580">month</span><br>
<span class="lineno">305</span><span class="op" id="2787586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787589">//&nbsp;Day&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2787641">func</span>&nbsp;<span class="op" id="2787646">(</span><span class="ident" id="2787647">t</span>&nbsp;<span class="ident" id="2787649">Time</span><span class="op" id="2787653">)</span>&nbsp;<span class="ident" id="2787655">Day</span><span class="op" id="2787658">(</span><span class="op" id="2787659">)</span>&nbsp;<span class="builtintype" id="2787661">int</span>&nbsp;<span class="op" id="2787665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2787668">_</span><span class="op" id="2787669">,</span>&nbsp;<span class="ident" id="2787671">_</span><span class="op" id="2787672">,</span>&nbsp;<span class="ident" id="2787674">day</span><span class="op" id="2787677">,</span>&nbsp;<span class="ident" id="2787679">_</span>&nbsp;<span class="op" id="2787681">:=</span>&nbsp;<span class="ident" id="2787684">t</span><span class="op" id="2787685">.</span><span class="ident" id="2787686">date</span><span class="op" id="2787690">(</span><span class="builtintype" id="2787691">true</span><span class="op" id="2787695">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787698">return</span>&nbsp;<span class="ident" id="2787705">day</span><br>
<span class="lineno"></span><span class="op" id="2787709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787712">//&nbsp;Weekday&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2787767">func</span>&nbsp;<span class="op" id="2787772">(</span><span class="ident" id="2787773">t</span>&nbsp;<span class="ident" id="2787775">Time</span><span class="op" id="2787779">)</span>&nbsp;<span class="ident" id="2787781">Weekday</span><span class="op" id="2787788">(</span><span class="op" id="2787789">)</span>&nbsp;<span class="ident" id="2787791">Weekday</span>&nbsp;<span class="op" id="2787799">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2787802">return</span>&nbsp;<span class="ident" id="2787809">absWeekday</span><span class="op" id="2787819">(</span><span class="ident" id="2787820">t</span><span class="op" id="2787821">.</span><span class="ident" id="2787822">abs</span><span class="op" id="2787825">(</span><span class="op" id="2787826">)</span><span class="op" id="2787827">)</span><br>
<span class="lineno"></span><span class="op" id="2787829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787832">//&nbsp;absWeekday&nbsp;is&nbsp;like&nbsp;Weekday&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2787896">func</span>&nbsp;<span class="ident" id="2787901">absWeekday</span><span class="op" id="2787911">(</span><span class="ident" id="2787912">abs</span>&nbsp;<span class="ident" id="2787916">uint64</span><span class="op" id="2787922">)</span>&nbsp;<span class="ident" id="2787924">Weekday</span>&nbsp;<span class="op" id="2787932">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2787935">//&nbsp;January&nbsp;1&nbsp;of&nbsp;the&nbsp;absolute&nbsp;year,&nbsp;like&nbsp;January&nbsp;1&nbsp;of&nbsp;2001,&nbsp;was&nbsp;a&nbsp;Monday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788009">sec</span>&nbsp;<span class="op" id="2788013">:=</span>&nbsp;<span class="op" id="2788016">(</span><span class="ident" id="2788017">abs</span>&nbsp;<span class="op" id="2788021">+</span>&nbsp;<span class="ident" id="2788023">uint64</span><span class="op" id="2788029">(</span><span class="ident" id="2788030">Monday</span><span class="op" id="2788036">)</span><span class="op" id="2788037">*</span><span class="ident" id="2788038">secondsPerDay</span><span class="op" id="2788051">)</span>&nbsp;<span class="op" id="2788053">%</span>&nbsp;<span class="ident" id="2788055">secondsPerWeek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788071">return</span>&nbsp;<span class="ident" id="2788078">Weekday</span><span class="op" id="2788085">(</span><span class="builtintype" id="2788086">int</span><span class="op" id="2788089">(</span><span class="ident" id="2788090">sec</span><span class="op" id="2788093">)</span>&nbsp;<span class="op" id="2788095">/</span>&nbsp;<span class="ident" id="2788097">secondsPerDay</span><span class="op" id="2788110">)</span><br>
<span class="lineno"></span><span class="op" id="2788112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="comment" id="2788115">//&nbsp;ISOWeek&nbsp;returns&nbsp;the&nbsp;ISO&nbsp;8601&nbsp;year&nbsp;and&nbsp;week&nbsp;number&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="2788187">//&nbsp;Week&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;53.&nbsp;Jan&nbsp;01&nbsp;to&nbsp;Jan&nbsp;03&nbsp;of&nbsp;year&nbsp;n&nbsp;might&nbsp;belong&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2788259">//&nbsp;week&nbsp;52&nbsp;or&nbsp;53&nbsp;of&nbsp;year&nbsp;n-1,&nbsp;and&nbsp;Dec&nbsp;29&nbsp;to&nbsp;Dec&nbsp;31&nbsp;might&nbsp;belong&nbsp;to&nbsp;week&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2788333">//&nbsp;of&nbsp;year&nbsp;n+1.</span><br>
<span class="lineno"></span><span class="keyword" id="2788349">func</span>&nbsp;<span class="op" id="2788354">(</span><span class="ident" id="2788355">t</span>&nbsp;<span class="ident" id="2788357">Time</span><span class="op" id="2788361">)</span>&nbsp;<span class="ident" id="2788363">ISOWeek</span><span class="op" id="2788370">(</span><span class="op" id="2788371">)</span>&nbsp;<span class="op" id="2788373">(</span><span class="ident" id="2788374">year</span><span class="op" id="2788378">,</span>&nbsp;<span class="ident" id="2788380">week</span>&nbsp;<span class="builtintype" id="2788385">int</span><span class="op" id="2788388">)</span>&nbsp;<span class="op" id="2788390">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788393">year</span><span class="op" id="2788397">,</span>&nbsp;<span class="ident" id="2788399">month</span><span class="op" id="2788404">,</span>&nbsp;<span class="ident" id="2788406">day</span><span class="op" id="2788409">,</span>&nbsp;<span class="ident" id="2788411">yday</span>&nbsp;<span class="op" id="2788416">:=</span>&nbsp;<span class="ident" id="2788419">t</span><span class="op" id="2788420">.</span><span class="ident" id="2788421">date</span><span class="op" id="2788425">(</span><span class="builtintype" id="2788426">true</span><span class="op" id="2788430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788433">wday</span>&nbsp;<span class="op" id="2788438">:=</span>&nbsp;<span class="builtintype" id="2788441">int</span><span class="op" id="2788444">(</span><span class="ident" id="2788445">t</span><span class="op" id="2788446">.</span><span class="ident" id="2788447">Weekday</span><span class="op" id="2788454">(</span><span class="op" id="2788455">)</span><span class="op" id="2788456">+</span><span class="num" id="2788457">6</span><span class="op" id="2788458">)</span>&nbsp;<span class="op" id="2788460">%</span>&nbsp;<span class="num" id="2788462">7</span>&nbsp;<span class="comment" id="2788464">//&nbsp;weekday&nbsp;but&nbsp;Monday&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2788492">const</span>&nbsp;<span class="op" id="2788498">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788502">Mon</span>&nbsp;<span class="builtintype" id="2788506">int</span>&nbsp;<span class="op" id="2788510">=</span>&nbsp;<span class="ident" id="2788512">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788519">Tue</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788525">Wed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788531">Thu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788537">Fri</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788543">Sat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788549">Sun</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788554">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788558">//&nbsp;Calculate&nbsp;week&nbsp;as&nbsp;number&nbsp;of&nbsp;Mondays&nbsp;in&nbsp;year&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788612">//&nbsp;and&nbsp;including&nbsp;today,&nbsp;plus&nbsp;1&nbsp;because&nbsp;the&nbsp;first&nbsp;week&nbsp;is&nbsp;week&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788678">//&nbsp;Putting&nbsp;the&nbsp;+&nbsp;1&nbsp;inside&nbsp;the&nbsp;numerator&nbsp;as&nbsp;a&nbsp;+&nbsp;7&nbsp;keeps&nbsp;the</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788738">//&nbsp;numerator&nbsp;from&nbsp;being&nbsp;negative,&nbsp;which&nbsp;would&nbsp;cause&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788797">//&nbsp;round&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788820">week</span>&nbsp;<span class="op" id="2788825">=</span>&nbsp;<span class="op" id="2788827">(</span><span class="ident" id="2788828">yday</span>&nbsp;<span class="op" id="2788833">-</span>&nbsp;<span class="ident" id="2788835">wday</span>&nbsp;<span class="op" id="2788840">+</span>&nbsp;<span class="num" id="2788842">7</span><span class="op" id="2788843">)</span>&nbsp;<span class="op" id="2788845">/</span>&nbsp;<span class="num" id="2788847">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788851">//&nbsp;The&nbsp;week&nbsp;number&nbsp;is&nbsp;now&nbsp;correct&nbsp;under&nbsp;the&nbsp;assumption</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788907">//&nbsp;that&nbsp;the&nbsp;first&nbsp;Monday&nbsp;of&nbsp;the&nbsp;year&nbsp;is&nbsp;in&nbsp;week&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2788959">//&nbsp;If&nbsp;Jan&nbsp;1&nbsp;is&nbsp;a&nbsp;Tuesday,&nbsp;Wednesday,&nbsp;or&nbsp;Thursday,&nbsp;the&nbsp;first&nbsp;Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789027">//&nbsp;is&nbsp;actually&nbsp;in&nbsp;week&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789054">jan1wday</span>&nbsp;<span class="op" id="2789063">:=</span>&nbsp;<span class="op" id="2789066">(</span><span class="ident" id="2789067">wday</span>&nbsp;<span class="op" id="2789072">-</span>&nbsp;<span class="ident" id="2789074">yday</span>&nbsp;<span class="op" id="2789079">+</span>&nbsp;<span class="num" id="2789081">7</span><span class="op" id="2789082">*</span><span class="num" id="2789083">53</span><span class="op" id="2789085">)</span>&nbsp;<span class="op" id="2789087">%</span>&nbsp;<span class="num" id="2789089">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789092">if</span>&nbsp;<span class="ident" id="2789095">Tue</span>&nbsp;<span class="op" id="2789099">&lt;=</span>&nbsp;<span class="ident" id="2789102">jan1wday</span>&nbsp;<span class="op" id="2789111">&amp;&amp;</span>&nbsp;<span class="ident" id="2789114">jan1wday</span>&nbsp;<span class="op" id="2789123">&lt;=</span>&nbsp;<span class="ident" id="2789126">Thu</span>&nbsp;<span class="op" id="2789130">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789134">week</span><span class="op" id="2789138">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789146">//&nbsp;If&nbsp;the&nbsp;week&nbsp;number&nbsp;is&nbsp;still&nbsp;0,&nbsp;we&#39;re&nbsp;in&nbsp;early&nbsp;January&nbsp;but&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789211">//&nbsp;the&nbsp;last&nbsp;week&nbsp;of&nbsp;last&nbsp;year.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789243">if</span>&nbsp;<span class="ident" id="2789246">week</span>&nbsp;<span class="op" id="2789251">==</span>&nbsp;<span class="num" id="2789254">0</span>&nbsp;<span class="op" id="2789256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789260">year</span><span class="op" id="2789264">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789269">week</span>&nbsp;<span class="op" id="2789274">=</span>&nbsp;<span class="num" id="2789276">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789281">//&nbsp;A&nbsp;year&nbsp;has&nbsp;53&nbsp;weeks&nbsp;when&nbsp;Jan&nbsp;1&nbsp;or&nbsp;Dec&nbsp;31&nbsp;is&nbsp;a&nbsp;Thursday,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789342">//&nbsp;meaning&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Friday</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789390">//&nbsp;or&nbsp;it&nbsp;was&nbsp;a&nbsp;leap&nbsp;year&nbsp;and&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Saturday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789459">if</span>&nbsp;<span class="ident" id="2789462">jan1wday</span>&nbsp;<span class="op" id="2789471">==</span>&nbsp;<span class="ident" id="2789474">Fri</span>&nbsp;<span class="op" id="2789478">||</span>&nbsp;<span class="op" id="2789481">(</span><span class="ident" id="2789482">jan1wday</span>&nbsp;<span class="op" id="2789491">==</span>&nbsp;<span class="ident" id="2789494">Sat</span>&nbsp;<span class="op" id="2789498">&amp;&amp;</span>&nbsp;<span class="ident" id="2789501">isLeap</span><span class="op" id="2789507">(</span><span class="ident" id="2789508">year</span><span class="op" id="2789512">)</span><span class="op" id="2789513">)</span>&nbsp;<span class="op" id="2789515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789520">week</span><span class="op" id="2789524">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789532">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789536">//&nbsp;December&nbsp;29&nbsp;to&nbsp;31&nbsp;are&nbsp;in&nbsp;week&nbsp;1&nbsp;of&nbsp;next&nbsp;year&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789588">//&nbsp;they&nbsp;are&nbsp;after&nbsp;the&nbsp;last&nbsp;Thursday&nbsp;of&nbsp;the&nbsp;year&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2789641">//&nbsp;December&nbsp;31&nbsp;is&nbsp;a&nbsp;Monday,&nbsp;Tuesday,&nbsp;or&nbsp;Wednesday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789693">if</span>&nbsp;<span class="ident" id="2789696">month</span>&nbsp;<span class="op" id="2789702">==</span>&nbsp;<span class="ident" id="2789705">December</span>&nbsp;<span class="op" id="2789714">&amp;&amp;</span>&nbsp;<span class="ident" id="2789717">day</span>&nbsp;<span class="op" id="2789721">&gt;=</span>&nbsp;<span class="num" id="2789724">29</span>&nbsp;<span class="op" id="2789727">&amp;&amp;</span>&nbsp;<span class="ident" id="2789730">wday</span>&nbsp;<span class="op" id="2789735">&lt;</span>&nbsp;<span class="ident" id="2789737">Thu</span>&nbsp;<span class="op" id="2789741">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789745">if</span>&nbsp;<span class="ident" id="2789748">dec31wday</span>&nbsp;<span class="op" id="2789758">:=</span>&nbsp;<span class="op" id="2789761">(</span><span class="ident" id="2789762">wday</span>&nbsp;<span class="op" id="2789767">+</span>&nbsp;<span class="num" id="2789769">31</span>&nbsp;<span class="op" id="2789772">-</span>&nbsp;<span class="ident" id="2789774">day</span><span class="op" id="2789777">)</span>&nbsp;<span class="op" id="2789779">%</span>&nbsp;<span class="num" id="2789781">7</span><span class="op" id="2789782">;</span>&nbsp;<span class="ident" id="2789784">Mon</span>&nbsp;<span class="op" id="2789788">&lt;=</span>&nbsp;<span class="ident" id="2789791">dec31wday</span>&nbsp;<span class="op" id="2789801">&amp;&amp;</span>&nbsp;<span class="ident" id="2789804">dec31wday</span>&nbsp;<span class="op" id="2789814">&lt;=</span>&nbsp;<span class="ident" id="2789817">Wed</span>&nbsp;<span class="op" id="2789821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789826">year</span><span class="op" id="2789830">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2789836">week</span>&nbsp;<span class="op" id="2789841">=</span>&nbsp;<span class="num" id="2789843">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2789850">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789854">return</span><br>
<span class="lineno"></span><span class="op" id="2789861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2789864">//&nbsp;Clock&nbsp;returns&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;second&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno">385</span><span class="keyword" id="2789941">func</span>&nbsp;<span class="op" id="2789946">(</span><span class="ident" id="2789947">t</span>&nbsp;<span class="ident" id="2789949">Time</span><span class="op" id="2789953">)</span>&nbsp;<span class="ident" id="2789955">Clock</span><span class="op" id="2789960">(</span><span class="op" id="2789961">)</span>&nbsp;<span class="op" id="2789963">(</span><span class="ident" id="2789964">hour</span><span class="op" id="2789968">,</span>&nbsp;<span class="ident" id="2789970">min</span><span class="op" id="2789973">,</span>&nbsp;<span class="ident" id="2789975">sec</span>&nbsp;<span class="builtintype" id="2789979">int</span><span class="op" id="2789982">)</span>&nbsp;<span class="op" id="2789984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2789987">return</span>&nbsp;<span class="ident" id="2789994">absClock</span><span class="op" id="2790002">(</span><span class="ident" id="2790003">t</span><span class="op" id="2790004">.</span><span class="ident" id="2790005">abs</span><span class="op" id="2790008">(</span><span class="op" id="2790009">)</span><span class="op" id="2790010">)</span><br>
<span class="lineno"></span><span class="op" id="2790012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790015">//&nbsp;absClock&nbsp;is&nbsp;like&nbsp;clock&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="2790075">func</span>&nbsp;<span class="ident" id="2790080">absClock</span><span class="op" id="2790088">(</span><span class="ident" id="2790089">abs</span>&nbsp;<span class="ident" id="2790093">uint64</span><span class="op" id="2790099">)</span>&nbsp;<span class="op" id="2790101">(</span><span class="ident" id="2790102">hour</span><span class="op" id="2790106">,</span>&nbsp;<span class="ident" id="2790108">min</span><span class="op" id="2790111">,</span>&nbsp;<span class="ident" id="2790113">sec</span>&nbsp;<span class="builtintype" id="2790117">int</span><span class="op" id="2790120">)</span>&nbsp;<span class="op" id="2790122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790125">sec</span>&nbsp;<span class="op" id="2790129">=</span>&nbsp;<span class="builtintype" id="2790131">int</span><span class="op" id="2790134">(</span><span class="ident" id="2790135">abs</span>&nbsp;<span class="op" id="2790139">%</span>&nbsp;<span class="ident" id="2790141">secondsPerDay</span><span class="op" id="2790154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790157">hour</span>&nbsp;<span class="op" id="2790162">=</span>&nbsp;<span class="ident" id="2790164">sec</span>&nbsp;<span class="op" id="2790168">/</span>&nbsp;<span class="ident" id="2790170">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790186">sec</span>&nbsp;<span class="op" id="2790190">-=</span>&nbsp;<span class="ident" id="2790193">hour</span>&nbsp;<span class="op" id="2790198">*</span>&nbsp;<span class="ident" id="2790200">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790216">min</span>&nbsp;<span class="op" id="2790220">=</span>&nbsp;<span class="ident" id="2790222">sec</span>&nbsp;<span class="op" id="2790226">/</span>&nbsp;<span class="ident" id="2790228">secondsPerMinute</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2790246">sec</span>&nbsp;<span class="op" id="2790250">-=</span>&nbsp;<span class="ident" id="2790253">min</span>&nbsp;<span class="op" id="2790257">*</span>&nbsp;<span class="ident" id="2790259">secondsPerMinute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790277">return</span><br>
<span class="lineno"></span><span class="op" id="2790284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790287">//&nbsp;Hour&nbsp;returns&nbsp;the&nbsp;hour&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;23].</span><br>
<span class="lineno">400</span><span class="keyword" id="2790365">func</span>&nbsp;<span class="op" id="2790370">(</span><span class="ident" id="2790371">t</span>&nbsp;<span class="ident" id="2790373">Time</span><span class="op" id="2790377">)</span>&nbsp;<span class="ident" id="2790379">Hour</span><span class="op" id="2790383">(</span><span class="op" id="2790384">)</span>&nbsp;<span class="builtintype" id="2790386">int</span>&nbsp;<span class="op" id="2790390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790393">return</span>&nbsp;<span class="builtintype" id="2790400">int</span><span class="op" id="2790403">(</span><span class="ident" id="2790404">t</span><span class="op" id="2790405">.</span><span class="ident" id="2790406">abs</span><span class="op" id="2790409">(</span><span class="op" id="2790410">)</span><span class="op" id="2790411">%</span><span class="ident" id="2790412">secondsPerDay</span><span class="op" id="2790425">)</span>&nbsp;<span class="op" id="2790427">/</span>&nbsp;<span class="ident" id="2790429">secondsPerHour</span><br>
<span class="lineno"></span><span class="op" id="2790444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790447">//&nbsp;Minute&nbsp;returns&nbsp;the&nbsp;minute&nbsp;offset&nbsp;within&nbsp;the&nbsp;hour&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">405</span><span class="keyword" id="2790537">func</span>&nbsp;<span class="op" id="2790542">(</span><span class="ident" id="2790543">t</span>&nbsp;<span class="ident" id="2790545">Time</span><span class="op" id="2790549">)</span>&nbsp;<span class="ident" id="2790551">Minute</span><span class="op" id="2790557">(</span><span class="op" id="2790558">)</span>&nbsp;<span class="builtintype" id="2790560">int</span>&nbsp;<span class="op" id="2790564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790567">return</span>&nbsp;<span class="builtintype" id="2790574">int</span><span class="op" id="2790577">(</span><span class="ident" id="2790578">t</span><span class="op" id="2790579">.</span><span class="ident" id="2790580">abs</span><span class="op" id="2790583">(</span><span class="op" id="2790584">)</span><span class="op" id="2790585">%</span><span class="ident" id="2790586">secondsPerHour</span><span class="op" id="2790600">)</span>&nbsp;<span class="op" id="2790602">/</span>&nbsp;<span class="ident" id="2790604">secondsPerMinute</span><br>
<span class="lineno"></span><span class="op" id="2790621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790624">//&nbsp;Second&nbsp;returns&nbsp;the&nbsp;second&nbsp;offset&nbsp;within&nbsp;the&nbsp;minute&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">410</span><span class="keyword" id="2790716">func</span>&nbsp;<span class="op" id="2790721">(</span><span class="ident" id="2790722">t</span>&nbsp;<span class="ident" id="2790724">Time</span><span class="op" id="2790728">)</span>&nbsp;<span class="ident" id="2790730">Second</span><span class="op" id="2790736">(</span><span class="op" id="2790737">)</span>&nbsp;<span class="builtintype" id="2790739">int</span>&nbsp;<span class="op" id="2790743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790746">return</span>&nbsp;<span class="builtintype" id="2790753">int</span><span class="op" id="2790756">(</span><span class="ident" id="2790757">t</span><span class="op" id="2790758">.</span><span class="ident" id="2790759">abs</span><span class="op" id="2790762">(</span><span class="op" id="2790763">)</span>&nbsp;<span class="op" id="2790765">%</span>&nbsp;<span class="ident" id="2790767">secondsPerMinute</span><span class="op" id="2790783">)</span><br>
<span class="lineno"></span><span class="op" id="2790785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790788">//&nbsp;Nanosecond&nbsp;returns&nbsp;the&nbsp;nanosecond&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;specified&nbsp;by&nbsp;t,</span><br>
<span class="lineno">415</span><span class="comment" id="2790866">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2790898">func</span>&nbsp;<span class="op" id="2790903">(</span><span class="ident" id="2790904">t</span>&nbsp;<span class="ident" id="2790906">Time</span><span class="op" id="2790910">)</span>&nbsp;<span class="ident" id="2790912">Nanosecond</span><span class="op" id="2790922">(</span><span class="op" id="2790923">)</span>&nbsp;<span class="builtintype" id="2790925">int</span>&nbsp;<span class="op" id="2790929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2790932">return</span>&nbsp;<span class="builtintype" id="2790939">int</span><span class="op" id="2790942">(</span><span class="ident" id="2790943">t</span><span class="op" id="2790944">.</span><span class="ident" id="2790945">nsec</span><span class="op" id="2790949">)</span><br>
<span class="lineno"></span><span class="op" id="2790951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2790954">//&nbsp;YearDay&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[1,365]&nbsp;for&nbsp;non-leap&nbsp;years,</span><br>
<span class="lineno"></span><span class="comment" id="2791050">//&nbsp;and&nbsp;[1,366]&nbsp;in&nbsp;leap&nbsp;years.</span><br>
<span class="lineno"></span><span class="keyword" id="2791080">func</span>&nbsp;<span class="op" id="2791085">(</span><span class="ident" id="2791086">t</span>&nbsp;<span class="ident" id="2791088">Time</span><span class="op" id="2791092">)</span>&nbsp;<span class="ident" id="2791094">YearDay</span><span class="op" id="2791101">(</span><span class="op" id="2791102">)</span>&nbsp;<span class="builtintype" id="2791104">int</span>&nbsp;<span class="op" id="2791108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791111">_</span><span class="op" id="2791112">,</span>&nbsp;<span class="ident" id="2791114">_</span><span class="op" id="2791115">,</span>&nbsp;<span class="ident" id="2791117">_</span><span class="op" id="2791118">,</span>&nbsp;<span class="ident" id="2791120">yday</span>&nbsp;<span class="op" id="2791125">:=</span>&nbsp;<span class="ident" id="2791128">t</span><span class="op" id="2791129">.</span><span class="ident" id="2791130">date</span><span class="op" id="2791134">(</span><span class="builtintype" id="2791135">false</span><span class="op" id="2791140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2791143">return</span>&nbsp;<span class="ident" id="2791150">yday</span>&nbsp;<span class="op" id="2791155">+</span>&nbsp;<span class="num" id="2791157">1</span><br>
<span class="lineno">425</span><span class="op" id="2791159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791162">//&nbsp;A&nbsp;Duration&nbsp;represents&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;two&nbsp;instants</span><br>
<span class="lineno"></span><span class="comment" id="2791225">//&nbsp;as&nbsp;an&nbsp;int64&nbsp;nanosecond&nbsp;count.&nbsp;&nbsp;The&nbsp;representation&nbsp;limits&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2791289">//&nbsp;largest&nbsp;representable&nbsp;duration&nbsp;to&nbsp;approximately&nbsp;290&nbsp;years.</span><br>
<span class="lineno">430</span><span class="keyword" id="2791351">type</span>&nbsp;<span class="ident" id="2791356">Duration</span>&nbsp;<span class="ident" id="2791365">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2791372">const</span>&nbsp;<span class="op" id="2791378">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791381">minDuration</span>&nbsp;<span class="ident" id="2791393">Duration</span>&nbsp;<span class="op" id="2791402">=</span>&nbsp;<span class="op" id="2791404">-</span><span class="num" id="2791405">1</span>&nbsp;<span class="op" id="2791407">&lt;&lt;</span>&nbsp;<span class="num" id="2791410">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791414">maxDuration</span>&nbsp;<span class="ident" id="2791426">Duration</span>&nbsp;<span class="op" id="2791435">=</span>&nbsp;<span class="num" id="2791437">1</span><span class="op" id="2791438">&lt;&lt;</span><span class="num" id="2791440">63</span>&nbsp;<span class="op" id="2791443">-</span>&nbsp;<span class="num" id="2791445">1</span><br>
<span class="lineno">435</span><span class="op" id="2791447">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791450">//&nbsp;Common&nbsp;durations.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;definition&nbsp;for&nbsp;units&nbsp;of&nbsp;Day&nbsp;or&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2791522">//&nbsp;to&nbsp;avoid&nbsp;confusion&nbsp;across&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;zone&nbsp;transitions.</span><br>
<span class="lineno"></span><span class="comment" id="2791591">//</span><br>
<span class="lineno">440</span><span class="comment" id="2791594">//&nbsp;To&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;units&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;divide:</span><br>
<span class="lineno"></span><span class="comment" id="2791649">//&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;time.Second</span><br>
<span class="lineno"></span><span class="comment" id="2791674">//&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(int64(second/time.Millisecond))&nbsp;//&nbsp;prints&nbsp;1000</span><br>
<span class="lineno"></span><span class="comment" id="2791734">//</span><br>
<span class="lineno"></span><span class="comment" id="2791737">//&nbsp;To&nbsp;convert&nbsp;an&nbsp;integer&nbsp;number&nbsp;of&nbsp;units&nbsp;to&nbsp;a&nbsp;Duration,&nbsp;multiply:</span><br>
<span class="lineno">445</span><span class="comment" id="2791803">//&nbsp;&nbsp;&nbsp;&nbsp;seconds&nbsp;:=&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2791820">//&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(time.Duration(seconds)*time.Second)&nbsp;//&nbsp;prints&nbsp;10s</span><br>
<span class="lineno"></span><span class="comment" id="2791883">//</span><br>
<span class="lineno"></span><span class="keyword" id="2791886">const</span>&nbsp;<span class="op" id="2791892">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791895">Nanosecond</span>&nbsp;&nbsp;<span class="ident" id="2791907">Duration</span>&nbsp;<span class="op" id="2791916">=</span>&nbsp;<span class="num" id="2791918">1</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791921">Microsecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791942">=</span>&nbsp;<span class="num" id="2791944">1000</span>&nbsp;<span class="op" id="2791949">*</span>&nbsp;<span class="ident" id="2791951">Nanosecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2791963">Millisecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2791984">=</span>&nbsp;<span class="num" id="2791986">1000</span>&nbsp;<span class="op" id="2791991">*</span>&nbsp;<span class="ident" id="2791993">Microsecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792006">Second</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792027">=</span>&nbsp;<span class="num" id="2792029">1000</span>&nbsp;<span class="op" id="2792034">*</span>&nbsp;<span class="ident" id="2792036">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792049">Minute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792070">=</span>&nbsp;<span class="num" id="2792072">60</span>&nbsp;<span class="op" id="2792075">*</span>&nbsp;<span class="ident" id="2792077">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792085">Hour</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792106">=</span>&nbsp;<span class="num" id="2792108">60</span>&nbsp;<span class="op" id="2792111">*</span>&nbsp;<span class="ident" id="2792113">Minute</span><br>
<span class="lineno">455</span><span class="op" id="2792120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2792123">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;the&nbsp;duration&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;72h3m0.5s&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2792201">//&nbsp;Leading&nbsp;zero&nbsp;units&nbsp;are&nbsp;omitted.&nbsp;&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;durations&nbsp;less&nbsp;than&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2792280">//&nbsp;second&nbsp;format&nbsp;use&nbsp;a&nbsp;smaller&nbsp;unit&nbsp;(milli-,&nbsp;micro-,&nbsp;or&nbsp;nanoseconds)&nbsp;to&nbsp;ensure</span><br>
<span class="lineno">460</span><span class="comment" id="2792359">//&nbsp;that&nbsp;the&nbsp;leading&nbsp;digit&nbsp;is&nbsp;non-zero.&nbsp;&nbsp;The&nbsp;zero&nbsp;duration&nbsp;formats&nbsp;as&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="2792431">//&nbsp;with&nbsp;no&nbsp;unit.</span><br>
<span class="lineno"></span><span class="keyword" id="2792448">func</span>&nbsp;<span class="op" id="2792453">(</span><span class="ident" id="2792454">d</span>&nbsp;<span class="ident" id="2792456">Duration</span><span class="op" id="2792464">)</span>&nbsp;<span class="ident" id="2792466">String</span><span class="op" id="2792472">(</span><span class="op" id="2792473">)</span>&nbsp;<span class="builtintype" id="2792475">string</span>&nbsp;<span class="op" id="2792482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792485">//&nbsp;Largest&nbsp;time&nbsp;is&nbsp;2540400h10m10.000000000s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792530">var</span>&nbsp;<span class="ident" id="2792534">buf</span>&nbsp;<span class="op" id="2792538">[</span><span class="num" id="2792539">32</span><span class="op" id="2792541">]</span><span class="builtintype" id="2792542">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792548">w</span>&nbsp;<span class="op" id="2792550">:=</span>&nbsp;<span class="builtinfunc" id="2792553">len</span><span class="op" id="2792556">(</span><span class="ident" id="2792557">buf</span><span class="op" id="2792560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792564">u</span>&nbsp;<span class="op" id="2792566">:=</span>&nbsp;<span class="ident" id="2792569">uint64</span><span class="op" id="2792575">(</span><span class="ident" id="2792576">d</span><span class="op" id="2792577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792580">neg</span>&nbsp;<span class="op" id="2792584">:=</span>&nbsp;<span class="ident" id="2792587">d</span>&nbsp;<span class="op" id="2792589">&lt;</span>&nbsp;<span class="num" id="2792591">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792594">if</span>&nbsp;<span class="ident" id="2792597">neg</span>&nbsp;<span class="op" id="2792601">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792605">u</span>&nbsp;<span class="op" id="2792607">=</span>&nbsp;<span class="op" id="2792609">-</span><span class="ident" id="2792610">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2792613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792617">if</span>&nbsp;<span class="ident" id="2792620">u</span>&nbsp;<span class="op" id="2792622">&lt;</span>&nbsp;<span class="ident" id="2792624">uint64</span><span class="op" id="2792630">(</span><span class="ident" id="2792631">Second</span><span class="op" id="2792637">)</span>&nbsp;<span class="op" id="2792639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792643">//&nbsp;Special&nbsp;case:&nbsp;if&nbsp;duration&nbsp;is&nbsp;smaller&nbsp;than&nbsp;a&nbsp;second,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792700">//&nbsp;use&nbsp;smaller&nbsp;units,&nbsp;like&nbsp;1.2ms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792735">var</span>&nbsp;<span class="ident" id="2792739">prec</span>&nbsp;<span class="builtintype" id="2792744">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792750">w</span><span class="op" id="2792751">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792756">buf</span><span class="op" id="2792759">[</span><span class="ident" id="2792760">w</span><span class="op" id="2792761">]</span>&nbsp;<span class="op" id="2792763">=</span>&nbsp;<span class="string" id="2792765">&#39;s&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792771">w</span><span class="op" id="2792772">--</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792777">switch</span>&nbsp;<span class="op" id="2792784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792788">case</span>&nbsp;<span class="ident" id="2792793">u</span>&nbsp;<span class="op" id="2792795">==</span>&nbsp;<span class="num" id="2792798">0</span><span class="op" id="2792799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792804">return</span>&nbsp;<span class="string" id="2792811">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792817">case</span>&nbsp;<span class="ident" id="2792822">u</span>&nbsp;<span class="op" id="2792824">&lt;</span>&nbsp;<span class="ident" id="2792826">uint64</span><span class="op" id="2792832">(</span><span class="ident" id="2792833">Microsecond</span><span class="op" id="2792844">)</span><span class="op" id="2792845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792850">//&nbsp;print&nbsp;nanoseconds</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792874">prec</span>&nbsp;<span class="op" id="2792879">=</span>&nbsp;<span class="num" id="2792881">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792886">buf</span><span class="op" id="2792889">[</span><span class="ident" id="2792890">w</span><span class="op" id="2792891">]</span>&nbsp;<span class="op" id="2792893">=</span>&nbsp;<span class="string" id="2792895">&#39;n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2792901">case</span>&nbsp;<span class="ident" id="2792906">u</span>&nbsp;<span class="op" id="2792908">&lt;</span>&nbsp;<span class="ident" id="2792910">uint64</span><span class="op" id="2792916">(</span><span class="ident" id="2792917">Millisecond</span><span class="op" id="2792928">)</span><span class="op" id="2792929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792934">//&nbsp;print&nbsp;microseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2792959">prec</span>&nbsp;<span class="op" id="2792964">=</span>&nbsp;<span class="num" id="2792966">3</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2792971">//&nbsp;U+00B5&nbsp;&#39;µ&#39;&nbsp;micro&nbsp;sign&nbsp;==&nbsp;0xC2&nbsp;0xB5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793013">w</span><span class="op" id="2793014">--</span>&nbsp;<span class="comment" id="2793017">//&nbsp;Need&nbsp;room&nbsp;for&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2793048">copy</span><span class="op" id="2793052">(</span><span class="ident" id="2793053">buf</span><span class="op" id="2793056">[</span><span class="ident" id="2793057">w</span><span class="op" id="2793058">:</span><span class="op" id="2793059">]</span><span class="op" id="2793060">,</span>&nbsp;<span class="string" id="2793062">&#34;µ&#34;</span><span class="op" id="2793066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793070">default</span><span class="op" id="2793077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793082">//&nbsp;print&nbsp;milliseconds</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793107">prec</span>&nbsp;<span class="op" id="2793112">=</span>&nbsp;<span class="num" id="2793114">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793119">buf</span><span class="op" id="2793122">[</span><span class="ident" id="2793123">w</span><span class="op" id="2793124">]</span>&nbsp;<span class="op" id="2793126">=</span>&nbsp;<span class="string" id="2793128">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793138">w</span><span class="op" id="2793139">,</span>&nbsp;<span class="ident" id="2793141">u</span>&nbsp;<span class="op" id="2793143">=</span>&nbsp;<span class="ident" id="2793145">fmtFrac</span><span class="op" id="2793152">(</span><span class="ident" id="2793153">buf</span><span class="op" id="2793156">[</span><span class="op" id="2793157">:</span><span class="ident" id="2793158">w</span><span class="op" id="2793159">]</span><span class="op" id="2793160">,</span>&nbsp;<span class="ident" id="2793162">u</span><span class="op" id="2793163">,</span>&nbsp;<span class="ident" id="2793165">prec</span><span class="op" id="2793169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793173">w</span>&nbsp;<span class="op" id="2793175">=</span>&nbsp;<span class="ident" id="2793177">fmtInt</span><span class="op" id="2793183">(</span><span class="ident" id="2793184">buf</span><span class="op" id="2793187">[</span><span class="op" id="2793188">:</span><span class="ident" id="2793189">w</span><span class="op" id="2793190">]</span><span class="op" id="2793191">,</span>&nbsp;<span class="ident" id="2793193">u</span><span class="op" id="2793194">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793197">}</span>&nbsp;<span class="keyword" id="2793199">else</span>&nbsp;<span class="op" id="2793204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793208">w</span><span class="op" id="2793209">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793214">buf</span><span class="op" id="2793217">[</span><span class="ident" id="2793218">w</span><span class="op" id="2793219">]</span>&nbsp;<span class="op" id="2793221">=</span>&nbsp;<span class="string" id="2793223">&#39;s&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793230">w</span><span class="op" id="2793231">,</span>&nbsp;<span class="ident" id="2793233">u</span>&nbsp;<span class="op" id="2793235">=</span>&nbsp;<span class="ident" id="2793237">fmtFrac</span><span class="op" id="2793244">(</span><span class="ident" id="2793245">buf</span><span class="op" id="2793248">[</span><span class="op" id="2793249">:</span><span class="ident" id="2793250">w</span><span class="op" id="2793251">]</span><span class="op" id="2793252">,</span>&nbsp;<span class="ident" id="2793254">u</span><span class="op" id="2793255">,</span>&nbsp;<span class="num" id="2793257">9</span><span class="op" id="2793258">)</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793263">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793293">w</span>&nbsp;<span class="op" id="2793295">=</span>&nbsp;<span class="ident" id="2793297">fmtInt</span><span class="op" id="2793303">(</span><span class="ident" id="2793304">buf</span><span class="op" id="2793307">[</span><span class="op" id="2793308">:</span><span class="ident" id="2793309">w</span><span class="op" id="2793310">]</span><span class="op" id="2793311">,</span>&nbsp;<span class="ident" id="2793313">u</span><span class="op" id="2793314">%</span><span class="num" id="2793315">60</span><span class="op" id="2793317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793321">u</span>&nbsp;<span class="op" id="2793323">/=</span>&nbsp;<span class="num" id="2793326">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793332">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793362">if</span>&nbsp;<span class="ident" id="2793365">u</span>&nbsp;<span class="op" id="2793367">&gt;</span>&nbsp;<span class="num" id="2793369">0</span>&nbsp;<span class="op" id="2793371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793376">w</span><span class="op" id="2793377">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793383">buf</span><span class="op" id="2793386">[</span><span class="ident" id="2793387">w</span><span class="op" id="2793388">]</span>&nbsp;<span class="op" id="2793390">=</span>&nbsp;<span class="string" id="2793392">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793399">w</span>&nbsp;<span class="op" id="2793401">=</span>&nbsp;<span class="ident" id="2793403">fmtInt</span><span class="op" id="2793409">(</span><span class="ident" id="2793410">buf</span><span class="op" id="2793413">[</span><span class="op" id="2793414">:</span><span class="ident" id="2793415">w</span><span class="op" id="2793416">]</span><span class="op" id="2793417">,</span>&nbsp;<span class="ident" id="2793419">u</span><span class="op" id="2793420">%</span><span class="num" id="2793421">60</span><span class="op" id="2793423">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793428">u</span>&nbsp;<span class="op" id="2793430">/=</span>&nbsp;<span class="num" id="2793433">60</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793440">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;hours</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793469">//&nbsp;Stop&nbsp;at&nbsp;hours&nbsp;because&nbsp;days&nbsp;can&nbsp;be&nbsp;different&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793528">if</span>&nbsp;<span class="ident" id="2793531">u</span>&nbsp;<span class="op" id="2793533">&gt;</span>&nbsp;<span class="num" id="2793535">0</span>&nbsp;<span class="op" id="2793537">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793543">w</span><span class="op" id="2793544">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793551">buf</span><span class="op" id="2793554">[</span><span class="ident" id="2793555">w</span><span class="op" id="2793556">]</span>&nbsp;<span class="op" id="2793558">=</span>&nbsp;<span class="string" id="2793560">&#39;h&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793568">w</span>&nbsp;<span class="op" id="2793570">=</span>&nbsp;<span class="ident" id="2793572">fmtInt</span><span class="op" id="2793578">(</span><span class="ident" id="2793579">buf</span><span class="op" id="2793582">[</span><span class="op" id="2793583">:</span><span class="ident" id="2793584">w</span><span class="op" id="2793585">]</span><span class="op" id="2793586">,</span>&nbsp;<span class="ident" id="2793588">u</span><span class="op" id="2793589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793598">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793605">if</span>&nbsp;<span class="ident" id="2793608">neg</span>&nbsp;<span class="op" id="2793612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793616">w</span><span class="op" id="2793617">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2793622">buf</span><span class="op" id="2793625">[</span><span class="ident" id="2793626">w</span><span class="op" id="2793627">]</span>&nbsp;<span class="op" id="2793629">=</span>&nbsp;<span class="string" id="2793631">&#39;-&#39;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2793636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2793640">return</span>&nbsp;<span class="builtintype" id="2793647">string</span><span class="op" id="2793653">(</span><span class="ident" id="2793654">buf</span><span class="op" id="2793657">[</span><span class="ident" id="2793658">w</span><span class="op" id="2793659">:</span><span class="op" id="2793660">]</span><span class="op" id="2793661">)</span><br>
<span class="lineno"></span><span class="op" id="2793663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="2793666">//&nbsp;fmtFrac&nbsp;formats&nbsp;the&nbsp;fraction&nbsp;of&nbsp;v/10**prec&nbsp;(e.g.,&nbsp;&#34;.12345&#34;)&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2793738">//&nbsp;tail&nbsp;of&nbsp;buf,&nbsp;omitting&nbsp;trailing&nbsp;zeros.&nbsp;&nbsp;it&nbsp;omits&nbsp;the&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2793801">//&nbsp;point&nbsp;too&nbsp;when&nbsp;the&nbsp;fraction&nbsp;is&nbsp;0.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2793870">//&nbsp;output&nbsp;bytes&nbsp;begin&nbsp;and&nbsp;the&nbsp;value&nbsp;v/10**prec.</span><br>
<span class="lineno"></span><span class="keyword" id="2793918">func</span>&nbsp;<span class="ident" id="2793923">fmtFrac</span><span class="op" id="2793930">(</span><span class="ident" id="2793931">buf</span>&nbsp;<span class="op" id="2793935">[</span><span class="op" id="2793936">]</span><span class="builtintype" id="2793937">byte</span><span class="op" id="2793941">,</span>&nbsp;<span class="ident" id="2793943">v</span>&nbsp;<span class="ident" id="2793945">uint64</span><span class="op" id="2793951">,</span>&nbsp;<span class="ident" id="2793953">prec</span>&nbsp;<span class="builtintype" id="2793958">int</span><span class="op" id="2793961">)</span>&nbsp;<span class="op" id="2793963">(</span><span class="ident" id="2793964">nw</span>&nbsp;<span class="builtintype" id="2793967">int</span><span class="op" id="2793970">,</span>&nbsp;<span class="ident" id="2793972">nv</span>&nbsp;<span class="ident" id="2793975">uint64</span><span class="op" id="2793981">)</span>&nbsp;<span class="op" id="2793983">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2793986">//&nbsp;Omit&nbsp;trailing&nbsp;zeros&nbsp;up&nbsp;to&nbsp;and&nbsp;including&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794045">w</span>&nbsp;<span class="op" id="2794047">:=</span>&nbsp;<span class="builtinfunc" id="2794050">len</span><span class="op" id="2794053">(</span><span class="ident" id="2794054">buf</span><span class="op" id="2794057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2794060">print</span>&nbsp;<span class="op" id="2794066">:=</span>&nbsp;<span class="builtintype" id="2794069">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794076">for</span>&nbsp;<span class="ident" id="2794080">i</span>&nbsp;<span class="op" id="2794082">:=</span>&nbsp;<span class="num" id="2794085">0</span><span class="op" id="2794086">;</span>&nbsp;<span class="ident" id="2794088">i</span>&nbsp;<span class="op" id="2794090">&lt;</span>&nbsp;<span class="ident" id="2794092">prec</span><span class="op" id="2794096">;</span>&nbsp;<span class="ident" id="2794098">i</span><span class="op" id="2794099">++</span>&nbsp;<span class="op" id="2794102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794106">digit</span>&nbsp;<span class="op" id="2794112">:=</span>&nbsp;<span class="ident" id="2794115">v</span>&nbsp;<span class="op" id="2794117">%</span>&nbsp;<span class="num" id="2794119">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2794124">print</span>&nbsp;<span class="op" id="2794130">=</span>&nbsp;<span class="builtinfunc" id="2794132">print</span>&nbsp;<span class="op" id="2794138">||</span>&nbsp;<span class="ident" id="2794141">digit</span>&nbsp;<span class="op" id="2794147">!=</span>&nbsp;<span class="num" id="2794150">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794154">if</span>&nbsp;<span class="builtinfunc" id="2794157">print</span>&nbsp;<span class="op" id="2794163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794168">w</span><span class="op" id="2794169">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794175">buf</span><span class="op" id="2794178">[</span><span class="ident" id="2794179">w</span><span class="op" id="2794180">]</span>&nbsp;<span class="op" id="2794182">=</span>&nbsp;<span class="builtintype" id="2794184">byte</span><span class="op" id="2794188">(</span><span class="ident" id="2794189">digit</span><span class="op" id="2794194">)</span>&nbsp;<span class="op" id="2794196">+</span>&nbsp;<span class="string" id="2794198">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794204">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794208">v</span>&nbsp;<span class="op" id="2794210">/=</span>&nbsp;<span class="num" id="2794213">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794220">if</span>&nbsp;<span class="builtinfunc" id="2794223">print</span>&nbsp;<span class="op" id="2794229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794233">w</span><span class="op" id="2794234">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794239">buf</span><span class="op" id="2794242">[</span><span class="ident" id="2794243">w</span><span class="op" id="2794244">]</span>&nbsp;<span class="op" id="2794246">=</span>&nbsp;<span class="string" id="2794248">&#39;.&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794256">return</span>&nbsp;<span class="ident" id="2794263">w</span><span class="op" id="2794264">,</span>&nbsp;<span class="ident" id="2794266">v</span><br>
<span class="lineno"></span><span class="op" id="2794268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794271">//&nbsp;fmtInt&nbsp;formats&nbsp;v&nbsp;into&nbsp;the&nbsp;tail&nbsp;of&nbsp;buf.</span><br>
<span class="lineno">560</span><span class="comment" id="2794313">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the&nbsp;output&nbsp;begins.</span><br>
<span class="lineno"></span><span class="keyword" id="2794362">func</span>&nbsp;<span class="ident" id="2794367">fmtInt</span><span class="op" id="2794373">(</span><span class="ident" id="2794374">buf</span>&nbsp;<span class="op" id="2794378">[</span><span class="op" id="2794379">]</span><span class="builtintype" id="2794380">byte</span><span class="op" id="2794384">,</span>&nbsp;<span class="ident" id="2794386">v</span>&nbsp;<span class="ident" id="2794388">uint64</span><span class="op" id="2794394">)</span>&nbsp;<span class="builtintype" id="2794396">int</span>&nbsp;<span class="op" id="2794400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794403">w</span>&nbsp;<span class="op" id="2794405">:=</span>&nbsp;<span class="builtinfunc" id="2794408">len</span><span class="op" id="2794411">(</span><span class="ident" id="2794412">buf</span><span class="op" id="2794415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794418">if</span>&nbsp;<span class="ident" id="2794421">v</span>&nbsp;<span class="op" id="2794423">==</span>&nbsp;<span class="num" id="2794426">0</span>&nbsp;<span class="op" id="2794428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794432">w</span><span class="op" id="2794433">--</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794438">buf</span><span class="op" id="2794441">[</span><span class="ident" id="2794442">w</span><span class="op" id="2794443">]</span>&nbsp;<span class="op" id="2794445">=</span>&nbsp;<span class="string" id="2794447">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794452">}</span>&nbsp;<span class="keyword" id="2794454">else</span>&nbsp;<span class="op" id="2794459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794463">for</span>&nbsp;<span class="ident" id="2794467">v</span>&nbsp;<span class="op" id="2794469">&gt;</span>&nbsp;<span class="num" id="2794471">0</span>&nbsp;<span class="op" id="2794473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794478">w</span><span class="op" id="2794479">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794485">buf</span><span class="op" id="2794488">[</span><span class="ident" id="2794489">w</span><span class="op" id="2794490">]</span>&nbsp;<span class="op" id="2794492">=</span>&nbsp;<span class="builtintype" id="2794494">byte</span><span class="op" id="2794498">(</span><span class="ident" id="2794499">v</span><span class="op" id="2794500">%</span><span class="num" id="2794501">10</span><span class="op" id="2794503">)</span>&nbsp;<span class="op" id="2794505">+</span>&nbsp;<span class="string" id="2794507">&#39;0&#39;</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2794514">v</span>&nbsp;<span class="op" id="2794516">/=</span>&nbsp;<span class="num" id="2794519">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2794527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2794530">return</span>&nbsp;<span class="ident" id="2794537">w</span><br>
<span class="lineno"></span><span class="op" id="2794539">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="2794542">//&nbsp;Nanoseconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;an&nbsp;integer&nbsp;nanosecond&nbsp;count.</span><br>
<span class="lineno"></span><span class="keyword" id="2794610">func</span>&nbsp;<span class="op" id="2794615">(</span><span class="ident" id="2794616">d</span>&nbsp;<span class="ident" id="2794618">Duration</span><span class="op" id="2794626">)</span>&nbsp;<span class="ident" id="2794628">Nanoseconds</span><span class="op" id="2794639">(</span><span class="op" id="2794640">)</span>&nbsp;<span class="ident" id="2794642">int64</span>&nbsp;<span class="op" id="2794648">{</span>&nbsp;<span class="keyword" id="2794650">return</span>&nbsp;<span class="ident" id="2794657">int64</span><span class="op" id="2794662">(</span><span class="ident" id="2794663">d</span><span class="op" id="2794664">)</span>&nbsp;<span class="op" id="2794666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794669">//&nbsp;These&nbsp;methods&nbsp;return&nbsp;float64&nbsp;because&nbsp;the&nbsp;dominant</span><br>
<span class="lineno">580</span><span class="comment" id="2794722">//&nbsp;use&nbsp;case&nbsp;is&nbsp;for&nbsp;printing&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;like&nbsp;1.5s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2794789">//&nbsp;a&nbsp;truncation&nbsp;to&nbsp;integer&nbsp;would&nbsp;make&nbsp;them&nbsp;not&nbsp;useful&nbsp;in&nbsp;those&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="2794859">//&nbsp;Splitting&nbsp;the&nbsp;integer&nbsp;and&nbsp;fraction&nbsp;ourselves&nbsp;guarantees&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2794923">//&nbsp;converting&nbsp;the&nbsp;returned&nbsp;float64&nbsp;to&nbsp;an&nbsp;integer&nbsp;rounds&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2794988">//&nbsp;way&nbsp;that&nbsp;a&nbsp;pure&nbsp;integer&nbsp;conversion&nbsp;would&nbsp;have,&nbsp;even&nbsp;in&nbsp;cases</span><br>
<span class="lineno">585</span><span class="comment" id="2795052">//&nbsp;where,&nbsp;say,&nbsp;float64(d.Nanoseconds())/1e9&nbsp;would&nbsp;have&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2795115">//&nbsp;differently.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795132">//&nbsp;Seconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;seconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2795203">func</span>&nbsp;<span class="op" id="2795208">(</span><span class="ident" id="2795209">d</span>&nbsp;<span class="ident" id="2795211">Duration</span><span class="op" id="2795219">)</span>&nbsp;<span class="ident" id="2795221">Seconds</span><span class="op" id="2795228">(</span><span class="op" id="2795229">)</span>&nbsp;<span class="builtintype" id="2795231">float64</span>&nbsp;<span class="op" id="2795239">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795242">sec</span>&nbsp;<span class="op" id="2795246">:=</span>&nbsp;<span class="ident" id="2795249">d</span>&nbsp;<span class="op" id="2795251">/</span>&nbsp;<span class="ident" id="2795253">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795261">nsec</span>&nbsp;<span class="op" id="2795266">:=</span>&nbsp;<span class="ident" id="2795269">d</span>&nbsp;<span class="op" id="2795271">%</span>&nbsp;<span class="ident" id="2795273">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795281">return</span>&nbsp;<span class="builtintype" id="2795288">float64</span><span class="op" id="2795295">(</span><span class="ident" id="2795296">sec</span><span class="op" id="2795299">)</span>&nbsp;<span class="op" id="2795301">+</span>&nbsp;<span class="builtintype" id="2795303">float64</span><span class="op" id="2795310">(</span><span class="ident" id="2795311">nsec</span><span class="op" id="2795315">)</span><span class="op" id="2795316">*</span><span class="num" id="2795317">1e-9</span><br>
<span class="lineno"></span><span class="op" id="2795322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2795325">//&nbsp;Minutes&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;minutes.</span><br>
<span class="lineno"></span><span class="keyword" id="2795396">func</span>&nbsp;<span class="op" id="2795401">(</span><span class="ident" id="2795402">d</span>&nbsp;<span class="ident" id="2795404">Duration</span><span class="op" id="2795412">)</span>&nbsp;<span class="ident" id="2795414">Minutes</span><span class="op" id="2795421">(</span><span class="op" id="2795422">)</span>&nbsp;<span class="builtintype" id="2795424">float64</span>&nbsp;<span class="op" id="2795432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795435">min</span>&nbsp;<span class="op" id="2795439">:=</span>&nbsp;<span class="ident" id="2795442">d</span>&nbsp;<span class="op" id="2795444">/</span>&nbsp;<span class="ident" id="2795446">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795454">nsec</span>&nbsp;<span class="op" id="2795459">:=</span>&nbsp;<span class="ident" id="2795462">d</span>&nbsp;<span class="op" id="2795464">%</span>&nbsp;<span class="ident" id="2795466">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795474">return</span>&nbsp;<span class="builtintype" id="2795481">float64</span><span class="op" id="2795488">(</span><span class="ident" id="2795489">min</span><span class="op" id="2795492">)</span>&nbsp;<span class="op" id="2795494">+</span>&nbsp;<span class="builtintype" id="2795496">float64</span><span class="op" id="2795503">(</span><span class="ident" id="2795504">nsec</span><span class="op" id="2795508">)</span><span class="op" id="2795509">*</span><span class="op" id="2795510">(</span><span class="num" id="2795511">1e-9</span><span class="op" id="2795515">/</span><span class="num" id="2795516">60</span><span class="op" id="2795518">)</span><br>
<span class="lineno">600</span><span class="op" id="2795520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795523">//&nbsp;Hours&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;hours.</span><br>
<span class="lineno"></span><span class="keyword" id="2795590">func</span>&nbsp;<span class="op" id="2795595">(</span><span class="ident" id="2795596">d</span>&nbsp;<span class="ident" id="2795598">Duration</span><span class="op" id="2795606">)</span>&nbsp;<span class="ident" id="2795608">Hours</span><span class="op" id="2795613">(</span><span class="op" id="2795614">)</span>&nbsp;<span class="builtintype" id="2795616">float64</span>&nbsp;<span class="op" id="2795624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795627">hour</span>&nbsp;<span class="op" id="2795632">:=</span>&nbsp;<span class="ident" id="2795635">d</span>&nbsp;<span class="op" id="2795637">/</span>&nbsp;<span class="ident" id="2795639">Hour</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795645">nsec</span>&nbsp;<span class="op" id="2795650">:=</span>&nbsp;<span class="ident" id="2795653">d</span>&nbsp;<span class="op" id="2795655">%</span>&nbsp;<span class="ident" id="2795657">Hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795663">return</span>&nbsp;<span class="builtintype" id="2795670">float64</span><span class="op" id="2795677">(</span><span class="ident" id="2795678">hour</span><span class="op" id="2795682">)</span>&nbsp;<span class="op" id="2795684">+</span>&nbsp;<span class="builtintype" id="2795686">float64</span><span class="op" id="2795693">(</span><span class="ident" id="2795694">nsec</span><span class="op" id="2795698">)</span><span class="op" id="2795699">*</span><span class="op" id="2795700">(</span><span class="num" id="2795701">1e-9</span><span class="op" id="2795705">/</span><span class="num" id="2795706">60</span><span class="op" id="2795708">/</span><span class="num" id="2795709">60</span><span class="op" id="2795711">)</span><br>
<span class="lineno"></span><span class="op" id="2795713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795716">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;time&nbsp;t+d.</span><br>
<span class="lineno">610</span><span class="keyword" id="2795745">func</span>&nbsp;<span class="op" id="2795750">(</span><span class="ident" id="2795751">t</span>&nbsp;<span class="ident" id="2795753">Time</span><span class="op" id="2795757">)</span>&nbsp;<span class="ident" id="2795759">Add</span><span class="op" id="2795762">(</span><span class="ident" id="2795763">d</span>&nbsp;<span class="ident" id="2795765">Duration</span><span class="op" id="2795773">)</span>&nbsp;<span class="ident" id="2795775">Time</span>&nbsp;<span class="op" id="2795780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795783">t</span><span class="op" id="2795784">.</span><span class="ident" id="2795785">sec</span>&nbsp;<span class="op" id="2795789">+=</span>&nbsp;<span class="ident" id="2795792">int64</span><span class="op" id="2795797">(</span><span class="ident" id="2795798">d</span>&nbsp;<span class="op" id="2795800">/</span>&nbsp;<span class="num" id="2795802">1e9</span><span class="op" id="2795805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795808">nsec</span>&nbsp;<span class="op" id="2795813">:=</span>&nbsp;<span class="builtintype" id="2795816">int32</span><span class="op" id="2795821">(</span><span class="ident" id="2795822">t</span><span class="op" id="2795823">.</span><span class="ident" id="2795824">nsec</span><span class="op" id="2795828">)</span>&nbsp;<span class="op" id="2795830">+</span>&nbsp;<span class="builtintype" id="2795832">int32</span><span class="op" id="2795837">(</span><span class="ident" id="2795838">d</span><span class="op" id="2795839">%</span><span class="num" id="2795840">1e9</span><span class="op" id="2795843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795846">if</span>&nbsp;<span class="ident" id="2795849">nsec</span>&nbsp;<span class="op" id="2795854">&gt;=</span>&nbsp;<span class="num" id="2795857">1e9</span>&nbsp;<span class="op" id="2795861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795865">t</span><span class="op" id="2795866">.</span><span class="ident" id="2795867">sec</span><span class="op" id="2795870">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795875">nsec</span>&nbsp;<span class="op" id="2795880">-=</span>&nbsp;<span class="num" id="2795883">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795888">}</span>&nbsp;<span class="keyword" id="2795890">else</span>&nbsp;<span class="keyword" id="2795895">if</span>&nbsp;<span class="ident" id="2795898">nsec</span>&nbsp;<span class="op" id="2795903">&lt;</span>&nbsp;<span class="num" id="2795905">0</span>&nbsp;<span class="op" id="2795907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795911">t</span><span class="op" id="2795912">.</span><span class="ident" id="2795913">sec</span><span class="op" id="2795916">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795921">nsec</span>&nbsp;<span class="op" id="2795926">+=</span>&nbsp;<span class="num" id="2795929">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2795934">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2795937">t</span><span class="op" id="2795938">.</span><span class="ident" id="2795939">nsec</span>&nbsp;<span class="op" id="2795944">=</span>&nbsp;<span class="ident" id="2795946">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2795952">return</span>&nbsp;<span class="ident" id="2795959">t</span><br>
<span class="lineno"></span><span class="op" id="2795961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795964">//&nbsp;Sub&nbsp;returns&nbsp;the&nbsp;duration&nbsp;t-u.&nbsp;If&nbsp;the&nbsp;result&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)</span><br>
<span class="lineno">625</span><span class="comment" id="2796044">//&nbsp;value&nbsp;that&nbsp;can&nbsp;be&nbsp;stored&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)&nbsp;duration</span><br>
<span class="lineno"></span><span class="comment" id="2796121">//&nbsp;will&nbsp;be&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="2796142">//&nbsp;To&nbsp;compute&nbsp;t-d&nbsp;for&nbsp;a&nbsp;duration&nbsp;d,&nbsp;use&nbsp;t.Add(-d).</span><br>
<span class="lineno"></span><span class="keyword" id="2796193">func</span>&nbsp;<span class="op" id="2796198">(</span><span class="ident" id="2796199">t</span>&nbsp;<span class="ident" id="2796201">Time</span><span class="op" id="2796205">)</span>&nbsp;<span class="ident" id="2796207">Sub</span><span class="op" id="2796210">(</span><span class="ident" id="2796211">u</span>&nbsp;<span class="ident" id="2796213">Time</span><span class="op" id="2796217">)</span>&nbsp;<span class="ident" id="2796219">Duration</span>&nbsp;<span class="op" id="2796228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2796231">d</span>&nbsp;<span class="op" id="2796233">:=</span>&nbsp;<span class="ident" id="2796236">Duration</span><span class="op" id="2796244">(</span><span class="ident" id="2796245">t</span><span class="op" id="2796246">.</span><span class="ident" id="2796247">sec</span><span class="op" id="2796250">-</span><span class="ident" id="2796251">u</span><span class="op" id="2796252">.</span><span class="ident" id="2796253">sec</span><span class="op" id="2796256">)</span><span class="op" id="2796257">*</span><span class="ident" id="2796258">Second</span>&nbsp;<span class="op" id="2796265">+</span>&nbsp;<span class="ident" id="2796267">Duration</span><span class="op" id="2796275">(</span><span class="builtintype" id="2796276">int32</span><span class="op" id="2796281">(</span><span class="ident" id="2796282">t</span><span class="op" id="2796283">.</span><span class="ident" id="2796284">nsec</span><span class="op" id="2796288">)</span><span class="op" id="2796289">-</span><span class="builtintype" id="2796290">int32</span><span class="op" id="2796295">(</span><span class="ident" id="2796296">u</span><span class="op" id="2796297">.</span><span class="ident" id="2796298">nsec</span><span class="op" id="2796302">)</span><span class="op" id="2796303">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2796306">//&nbsp;Check&nbsp;for&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796343">switch</span>&nbsp;<span class="op" id="2796350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796353">case</span>&nbsp;<span class="ident" id="2796358">u</span><span class="op" id="2796359">.</span><span class="ident" id="2796360">Add</span><span class="op" id="2796363">(</span><span class="ident" id="2796364">d</span><span class="op" id="2796365">)</span><span class="op" id="2796366">.</span><span class="ident" id="2796367">Equal</span><span class="op" id="2796372">(</span><span class="ident" id="2796373">t</span><span class="op" id="2796374">)</span><span class="op" id="2796375">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796379">return</span>&nbsp;<span class="ident" id="2796386">d</span>&nbsp;<span class="comment" id="2796388">//&nbsp;d&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796405">case</span>&nbsp;<span class="ident" id="2796410">t</span><span class="op" id="2796411">.</span><span class="ident" id="2796412">Before</span><span class="op" id="2796418">(</span><span class="ident" id="2796419">u</span><span class="op" id="2796420">)</span><span class="op" id="2796421">:</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796425">return</span>&nbsp;<span class="ident" id="2796432">minDuration</span>&nbsp;<span class="comment" id="2796444">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;negative&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796479">default</span><span class="op" id="2796486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796490">return</span>&nbsp;<span class="ident" id="2796497">maxDuration</span>&nbsp;<span class="comment" id="2796509">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;positive&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2796544">}</span><br>
<span class="lineno"></span><span class="op" id="2796546">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2796549">//&nbsp;Since&nbsp;returns&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;since&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2796592">//&nbsp;It&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;time.Now().Sub(t).</span><br>
<span class="lineno"></span><span class="keyword" id="2796634">func</span>&nbsp;<span class="ident" id="2796639">Since</span><span class="op" id="2796644">(</span><span class="ident" id="2796645">t</span>&nbsp;<span class="ident" id="2796647">Time</span><span class="op" id="2796651">)</span>&nbsp;<span class="ident" id="2796653">Duration</span>&nbsp;<span class="op" id="2796662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2796665">return</span>&nbsp;<span class="ident" id="2796672">Now</span><span class="op" id="2796675">(</span><span class="op" id="2796676">)</span><span class="op" id="2796677">.</span><span class="ident" id="2796678">Sub</span><span class="op" id="2796681">(</span><span class="ident" id="2796682">t</span><span class="op" id="2796683">)</span><br>
<span class="lineno">645</span><span class="op" id="2796685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2796688">//&nbsp;AddDate&nbsp;returns&nbsp;the&nbsp;time&nbsp;corresponding&nbsp;to&nbsp;adding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2796744">//&nbsp;given&nbsp;number&nbsp;of&nbsp;years,&nbsp;months,&nbsp;and&nbsp;days&nbsp;to&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2796793">//&nbsp;For&nbsp;example,&nbsp;AddDate(-1,&nbsp;2,&nbsp;3)&nbsp;applied&nbsp;to&nbsp;January&nbsp;1,&nbsp;2011</span><br>
<span class="lineno">650</span><span class="comment" id="2796854">//&nbsp;returns&nbsp;March&nbsp;4,&nbsp;2010.</span><br>
<span class="lineno"></span><span class="comment" id="2796880">//</span><br>
<span class="lineno"></span><span class="comment" id="2796883">//&nbsp;AddDate&nbsp;normalizes&nbsp;its&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;Date&nbsp;does,</span><br>
<span class="lineno"></span><span class="comment" id="2796948">//&nbsp;so,&nbsp;for&nbsp;example,&nbsp;adding&nbsp;one&nbsp;month&nbsp;to&nbsp;October&nbsp;31&nbsp;yields</span><br>
<span class="lineno"></span><span class="comment" id="2797006">//&nbsp;December&nbsp;1,&nbsp;the&nbsp;normalized&nbsp;form&nbsp;for&nbsp;November&nbsp;31.</span><br>
<span class="lineno">655</span><span class="keyword" id="2797058">func</span>&nbsp;<span class="op" id="2797063">(</span><span class="ident" id="2797064">t</span>&nbsp;<span class="ident" id="2797066">Time</span><span class="op" id="2797070">)</span>&nbsp;<span class="ident" id="2797072">AddDate</span><span class="op" id="2797079">(</span><span class="ident" id="2797080">years</span>&nbsp;<span class="builtintype" id="2797086">int</span><span class="op" id="2797089">,</span>&nbsp;<span class="ident" id="2797091">months</span>&nbsp;<span class="builtintype" id="2797098">int</span><span class="op" id="2797101">,</span>&nbsp;<span class="ident" id="2797103">days</span>&nbsp;<span class="builtintype" id="2797108">int</span><span class="op" id="2797111">)</span>&nbsp;<span class="ident" id="2797113">Time</span>&nbsp;<span class="op" id="2797118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797121">year</span><span class="op" id="2797125">,</span>&nbsp;<span class="ident" id="2797127">month</span><span class="op" id="2797132">,</span>&nbsp;<span class="ident" id="2797134">day</span>&nbsp;<span class="op" id="2797138">:=</span>&nbsp;<span class="ident" id="2797141">t</span><span class="op" id="2797142">.</span><span class="ident" id="2797143">Date</span><span class="op" id="2797147">(</span><span class="op" id="2797148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797151">hour</span><span class="op" id="2797155">,</span>&nbsp;<span class="ident" id="2797157">min</span><span class="op" id="2797160">,</span>&nbsp;<span class="ident" id="2797162">sec</span>&nbsp;<span class="op" id="2797166">:=</span>&nbsp;<span class="ident" id="2797169">t</span><span class="op" id="2797170">.</span><span class="ident" id="2797171">Clock</span><span class="op" id="2797176">(</span><span class="op" id="2797177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797180">return</span>&nbsp;<span class="ident" id="2797187">Date</span><span class="op" id="2797191">(</span><span class="ident" id="2797192">year</span><span class="op" id="2797196">+</span><span class="ident" id="2797197">years</span><span class="op" id="2797202">,</span>&nbsp;<span class="ident" id="2797204">month</span><span class="op" id="2797209">+</span><span class="ident" id="2797210">Month</span><span class="op" id="2797215">(</span><span class="ident" id="2797216">months</span><span class="op" id="2797222">)</span><span class="op" id="2797223">,</span>&nbsp;<span class="ident" id="2797225">day</span><span class="op" id="2797228">+</span><span class="ident" id="2797229">days</span><span class="op" id="2797233">,</span>&nbsp;<span class="ident" id="2797235">hour</span><span class="op" id="2797239">,</span>&nbsp;<span class="ident" id="2797241">min</span><span class="op" id="2797244">,</span>&nbsp;<span class="ident" id="2797246">sec</span><span class="op" id="2797249">,</span>&nbsp;<span class="builtintype" id="2797251">int</span><span class="op" id="2797254">(</span><span class="ident" id="2797255">t</span><span class="op" id="2797256">.</span><span class="ident" id="2797257">nsec</span><span class="op" id="2797261">)</span><span class="op" id="2797262">,</span>&nbsp;<span class="ident" id="2797264">t</span><span class="op" id="2797265">.</span><span class="ident" id="2797266">loc</span><span class="op" id="2797269">)</span><br>
<span class="lineno"></span><span class="op" id="2797271">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="keyword" id="2797274">const</span>&nbsp;<span class="op" id="2797280">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797283">secondsPerMinute</span>&nbsp;<span class="op" id="2797300">=</span>&nbsp;<span class="num" id="2797302">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797306">secondsPerHour</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2797323">=</span>&nbsp;<span class="num" id="2797325">60</span>&nbsp;<span class="op" id="2797328">*</span>&nbsp;<span class="num" id="2797330">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797334">secondsPerDay</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797351">=</span>&nbsp;<span class="num" id="2797353">24</span>&nbsp;<span class="op" id="2797356">*</span>&nbsp;<span class="ident" id="2797358">secondsPerHour</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797374">secondsPerWeek</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2797391">=</span>&nbsp;<span class="num" id="2797393">7</span>&nbsp;<span class="op" id="2797395">*</span>&nbsp;<span class="ident" id="2797397">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797412">daysPer400Years</span>&nbsp;&nbsp;<span class="op" id="2797429">=</span>&nbsp;<span class="num" id="2797431">365</span><span class="op" id="2797434">*</span><span class="num" id="2797435">400</span>&nbsp;<span class="op" id="2797439">+</span>&nbsp;<span class="num" id="2797441">97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797445">daysPer100Years</span>&nbsp;&nbsp;<span class="op" id="2797462">=</span>&nbsp;<span class="num" id="2797464">365</span><span class="op" id="2797467">*</span><span class="num" id="2797468">100</span>&nbsp;<span class="op" id="2797472">+</span>&nbsp;<span class="num" id="2797474">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797478">daysPer4Years</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2797495">=</span>&nbsp;<span class="num" id="2797497">365</span><span class="op" id="2797500">*</span><span class="num" id="2797501">4</span>&nbsp;<span class="op" id="2797503">+</span>&nbsp;<span class="num" id="2797505">1</span><br>
<span class="lineno"></span><span class="op" id="2797507">)</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="2797510">//&nbsp;date&nbsp;computes&nbsp;the&nbsp;year,&nbsp;day&nbsp;of&nbsp;year,&nbsp;and&nbsp;when&nbsp;full=true,</span><br>
<span class="lineno"></span><span class="comment" id="2797570">//&nbsp;the&nbsp;month&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2797610">func</span>&nbsp;<span class="op" id="2797615">(</span><span class="ident" id="2797616">t</span>&nbsp;<span class="ident" id="2797618">Time</span><span class="op" id="2797622">)</span>&nbsp;<span class="ident" id="2797624">date</span><span class="op" id="2797628">(</span><span class="ident" id="2797629">full</span>&nbsp;<span class="builtintype" id="2797634">bool</span><span class="op" id="2797638">)</span>&nbsp;<span class="op" id="2797640">(</span><span class="ident" id="2797641">year</span>&nbsp;<span class="builtintype" id="2797646">int</span><span class="op" id="2797649">,</span>&nbsp;<span class="ident" id="2797651">month</span>&nbsp;<span class="ident" id="2797657">Month</span><span class="op" id="2797662">,</span>&nbsp;<span class="ident" id="2797664">day</span>&nbsp;<span class="builtintype" id="2797668">int</span><span class="op" id="2797671">,</span>&nbsp;<span class="ident" id="2797673">yday</span>&nbsp;<span class="builtintype" id="2797678">int</span><span class="op" id="2797681">)</span>&nbsp;<span class="op" id="2797683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2797686">return</span>&nbsp;<span class="ident" id="2797693">absDate</span><span class="op" id="2797700">(</span><span class="ident" id="2797701">t</span><span class="op" id="2797702">.</span><span class="ident" id="2797703">abs</span><span class="op" id="2797706">(</span><span class="op" id="2797707">)</span><span class="op" id="2797708">,</span>&nbsp;<span class="ident" id="2797710">full</span><span class="op" id="2797714">)</span><br>
<span class="lineno">675</span><span class="op" id="2797716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2797719">//&nbsp;absDate&nbsp;is&nbsp;like&nbsp;date&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2797777">func</span>&nbsp;<span class="ident" id="2797782">absDate</span><span class="op" id="2797789">(</span><span class="ident" id="2797790">abs</span>&nbsp;<span class="ident" id="2797794">uint64</span><span class="op" id="2797800">,</span>&nbsp;<span class="ident" id="2797802">full</span>&nbsp;<span class="builtintype" id="2797807">bool</span><span class="op" id="2797811">)</span>&nbsp;<span class="op" id="2797813">(</span><span class="ident" id="2797814">year</span>&nbsp;<span class="builtintype" id="2797819">int</span><span class="op" id="2797822">,</span>&nbsp;<span class="ident" id="2797824">month</span>&nbsp;<span class="ident" id="2797830">Month</span><span class="op" id="2797835">,</span>&nbsp;<span class="ident" id="2797837">day</span>&nbsp;<span class="builtintype" id="2797841">int</span><span class="op" id="2797844">,</span>&nbsp;<span class="ident" id="2797846">yday</span>&nbsp;<span class="builtintype" id="2797851">int</span><span class="op" id="2797854">)</span>&nbsp;<span class="op" id="2797856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797859">//&nbsp;Split&nbsp;into&nbsp;time&nbsp;and&nbsp;day.</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797888">d</span>&nbsp;<span class="op" id="2797890">:=</span>&nbsp;<span class="ident" id="2797893">abs</span>&nbsp;<span class="op" id="2797897">/</span>&nbsp;<span class="ident" id="2797899">secondsPerDay</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2797915">//&nbsp;Account&nbsp;for&nbsp;400&nbsp;year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797948">n</span>&nbsp;<span class="op" id="2797950">:=</span>&nbsp;<span class="ident" id="2797953">d</span>&nbsp;<span class="op" id="2797955">/</span>&nbsp;<span class="ident" id="2797957">daysPer400Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797974">y</span>&nbsp;<span class="op" id="2797976">:=</span>&nbsp;<span class="num" id="2797979">400</span>&nbsp;<span class="op" id="2797983">*</span>&nbsp;<span class="ident" id="2797985">n</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2797988">d</span>&nbsp;<span class="op" id="2797990">-=</span>&nbsp;<span class="ident" id="2797993">daysPer400Years</span>&nbsp;<span class="op" id="2798009">*</span>&nbsp;<span class="ident" id="2798011">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798015">//&nbsp;Cut&nbsp;off&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798044">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;one&nbsp;extra&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798107">//&nbsp;of&nbsp;that&nbsp;year,&nbsp;day&nbsp;/&nbsp;daysPer100Years&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798171">//&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798218">n</span>&nbsp;<span class="op" id="2798220">=</span>&nbsp;<span class="ident" id="2798222">d</span>&nbsp;<span class="op" id="2798224">/</span>&nbsp;<span class="ident" id="2798226">daysPer100Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798243">n</span>&nbsp;<span class="op" id="2798245">-=</span>&nbsp;<span class="ident" id="2798248">n</span>&nbsp;<span class="op" id="2798250">&gt;&gt;</span>&nbsp;<span class="num" id="2798253">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798256">y</span>&nbsp;<span class="op" id="2798258">+=</span>&nbsp;<span class="num" id="2798261">100</span>&nbsp;<span class="op" id="2798265">*</span>&nbsp;<span class="ident" id="2798267">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798270">d</span>&nbsp;<span class="op" id="2798272">-=</span>&nbsp;<span class="ident" id="2798275">daysPer100Years</span>&nbsp;<span class="op" id="2798291">*</span>&nbsp;<span class="ident" id="2798293">n</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798297">//&nbsp;Cut&nbsp;off&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798324">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;a&nbsp;missing&nbsp;leap&nbsp;year,&nbsp;which&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798383">//&nbsp;affect&nbsp;the&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798411">n</span>&nbsp;<span class="op" id="2798413">=</span>&nbsp;<span class="ident" id="2798415">d</span>&nbsp;<span class="op" id="2798417">/</span>&nbsp;<span class="ident" id="2798419">daysPer4Years</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798434">y</span>&nbsp;<span class="op" id="2798436">+=</span>&nbsp;<span class="num" id="2798439">4</span>&nbsp;<span class="op" id="2798441">*</span>&nbsp;<span class="ident" id="2798443">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798446">d</span>&nbsp;<span class="op" id="2798448">-=</span>&nbsp;<span class="ident" id="2798451">daysPer4Years</span>&nbsp;<span class="op" id="2798465">*</span>&nbsp;<span class="ident" id="2798467">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798471">//&nbsp;Cut&nbsp;off&nbsp;years&nbsp;within&nbsp;a&nbsp;4-year&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798512">//&nbsp;The&nbsp;last&nbsp;year&nbsp;is&nbsp;a&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day&nbsp;of&nbsp;that&nbsp;year,</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798579">//&nbsp;day&nbsp;/&nbsp;365&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.&nbsp;&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798640">//&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798665">n</span>&nbsp;<span class="op" id="2798667">=</span>&nbsp;<span class="ident" id="2798669">d</span>&nbsp;<span class="op" id="2798671">/</span>&nbsp;<span class="num" id="2798673">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798678">n</span>&nbsp;<span class="op" id="2798680">-=</span>&nbsp;<span class="ident" id="2798683">n</span>&nbsp;<span class="op" id="2798685">&gt;&gt;</span>&nbsp;<span class="num" id="2798688">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798691">y</span>&nbsp;<span class="op" id="2798693">+=</span>&nbsp;<span class="ident" id="2798696">n</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798699">d</span>&nbsp;<span class="op" id="2798701">-=</span>&nbsp;<span class="num" id="2798704">365</span>&nbsp;<span class="op" id="2798708">*</span>&nbsp;<span class="ident" id="2798710">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798714">year</span>&nbsp;<span class="op" id="2798719">=</span>&nbsp;<span class="builtintype" id="2798721">int</span><span class="op" id="2798724">(</span><span class="ident" id="2798725">int64</span><span class="op" id="2798730">(</span><span class="ident" id="2798731">y</span><span class="op" id="2798732">)</span>&nbsp;<span class="op" id="2798734">+</span>&nbsp;<span class="ident" id="2798736">absoluteZeroYear</span><span class="op" id="2798752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798755">yday</span>&nbsp;<span class="op" id="2798760">=</span>&nbsp;<span class="builtintype" id="2798762">int</span><span class="op" id="2798765">(</span><span class="ident" id="2798766">d</span><span class="op" id="2798767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798771">if</span>&nbsp;<span class="op" id="2798774">!</span><span class="ident" id="2798775">full</span>&nbsp;<span class="op" id="2798780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798784">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2798792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798796">day</span>&nbsp;<span class="op" id="2798800">=</span>&nbsp;<span class="ident" id="2798802">yday</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798808">if</span>&nbsp;<span class="ident" id="2798811">isLeap</span><span class="op" id="2798817">(</span><span class="ident" id="2798818">year</span><span class="op" id="2798822">)</span>&nbsp;<span class="op" id="2798824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798828">//&nbsp;Leap&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798843">switch</span>&nbsp;<span class="op" id="2798850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798854">case</span>&nbsp;<span class="ident" id="2798859">day</span>&nbsp;<span class="op" id="2798863">&gt;</span>&nbsp;<span class="num" id="2798865">31</span><span class="op" id="2798867">+</span><span class="num" id="2798868">29</span><span class="op" id="2798870">-</span><span class="num" id="2798871">1</span><span class="op" id="2798872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798877">//&nbsp;After&nbsp;leap&nbsp;day;&nbsp;pretend&nbsp;it&nbsp;wasn&#39;t&nbsp;there.</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798924">day</span><span class="op" id="2798927">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2798932">case</span>&nbsp;<span class="ident" id="2798937">day</span>&nbsp;<span class="op" id="2798941">==</span>&nbsp;<span class="num" id="2798944">31</span><span class="op" id="2798946">+</span><span class="num" id="2798947">29</span><span class="op" id="2798949">-</span><span class="num" id="2798950">1</span><span class="op" id="2798951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2798956">//&nbsp;Leap&nbsp;day.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798972">month</span>&nbsp;<span class="op" id="2798978">=</span>&nbsp;<span class="ident" id="2798980">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2798992">day</span>&nbsp;<span class="op" id="2798996">=</span>&nbsp;<span class="num" id="2798998">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799004">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799020">//&nbsp;Estimate&nbsp;month&nbsp;on&nbsp;assumption&nbsp;that&nbsp;every&nbsp;month&nbsp;has&nbsp;31&nbsp;days.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2799083">//&nbsp;The&nbsp;estimate&nbsp;may&nbsp;be&nbsp;too&nbsp;low&nbsp;by&nbsp;at&nbsp;most&nbsp;one&nbsp;month,&nbsp;so&nbsp;adjust.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799148">month</span>&nbsp;<span class="op" id="2799154">=</span>&nbsp;<span class="ident" id="2799156">Month</span><span class="op" id="2799161">(</span><span class="ident" id="2799162">day</span>&nbsp;<span class="op" id="2799166">/</span>&nbsp;<span class="num" id="2799168">31</span><span class="op" id="2799170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799173">end</span>&nbsp;<span class="op" id="2799177">:=</span>&nbsp;<span class="builtintype" id="2799180">int</span><span class="op" id="2799183">(</span><span class="ident" id="2799184">daysBefore</span><span class="op" id="2799194">[</span><span class="ident" id="2799195">month</span><span class="op" id="2799200">+</span><span class="num" id="2799201">1</span><span class="op" id="2799202">]</span><span class="op" id="2799203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799206">var</span>&nbsp;<span class="ident" id="2799210">begin</span>&nbsp;<span class="builtintype" id="2799216">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799221">if</span>&nbsp;<span class="ident" id="2799224">day</span>&nbsp;<span class="op" id="2799228">&gt;=</span>&nbsp;<span class="ident" id="2799231">end</span>&nbsp;<span class="op" id="2799235">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799239">month</span><span class="op" id="2799244">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799249">begin</span>&nbsp;<span class="op" id="2799255">=</span>&nbsp;<span class="ident" id="2799257">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799262">}</span>&nbsp;<span class="keyword" id="2799264">else</span>&nbsp;<span class="op" id="2799269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799273">begin</span>&nbsp;<span class="op" id="2799279">=</span>&nbsp;<span class="builtintype" id="2799281">int</span><span class="op" id="2799284">(</span><span class="ident" id="2799285">daysBefore</span><span class="op" id="2799295">[</span><span class="ident" id="2799296">month</span><span class="op" id="2799301">]</span><span class="op" id="2799302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2799305">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799309">month</span><span class="op" id="2799314">++</span>&nbsp;<span class="comment" id="2799317">//&nbsp;because&nbsp;January&nbsp;is&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2799342">day</span>&nbsp;<span class="op" id="2799346">=</span>&nbsp;<span class="ident" id="2799348">day</span>&nbsp;<span class="op" id="2799352">-</span>&nbsp;<span class="ident" id="2799354">begin</span>&nbsp;<span class="op" id="2799360">+</span>&nbsp;<span class="num" id="2799362">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2799365">return</span><br>
<span class="lineno"></span><span class="op" id="2799372">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="comment" id="2799375">//&nbsp;daysBefore[m]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;a&nbsp;non-leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2799437">//&nbsp;before&nbsp;month&nbsp;m&nbsp;begins.&nbsp;&nbsp;There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;m=12,&nbsp;counting</span><br>
<span class="lineno"></span><span class="comment" id="2799501">//&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;before&nbsp;January&nbsp;of&nbsp;next&nbsp;year&nbsp;(365).</span><br>
<span class="lineno"></span><span class="keyword" id="2799558">var</span>&nbsp;<span class="ident" id="2799562">daysBefore</span>&nbsp;<span class="op" id="2799573">=</span>&nbsp;<span class="op" id="2799575">[</span><span class="op" id="2799576">...</span><span class="op" id="2799579">]</span><span class="builtintype" id="2799580">int32</span><span class="op" id="2799585">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799588">0</span><span class="op" id="2799589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799592">31</span><span class="op" id="2799594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799597">31</span>&nbsp;<span class="op" id="2799600">+</span>&nbsp;<span class="num" id="2799602">28</span><span class="op" id="2799604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799607">31</span>&nbsp;<span class="op" id="2799610">+</span>&nbsp;<span class="num" id="2799612">28</span>&nbsp;<span class="op" id="2799615">+</span>&nbsp;<span class="num" id="2799617">31</span><span class="op" id="2799619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799622">31</span>&nbsp;<span class="op" id="2799625">+</span>&nbsp;<span class="num" id="2799627">28</span>&nbsp;<span class="op" id="2799630">+</span>&nbsp;<span class="num" id="2799632">31</span>&nbsp;<span class="op" id="2799635">+</span>&nbsp;<span class="num" id="2799637">30</span><span class="op" id="2799639">,</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799642">31</span>&nbsp;<span class="op" id="2799645">+</span>&nbsp;<span class="num" id="2799647">28</span>&nbsp;<span class="op" id="2799650">+</span>&nbsp;<span class="num" id="2799652">31</span>&nbsp;<span class="op" id="2799655">+</span>&nbsp;<span class="num" id="2799657">30</span>&nbsp;<span class="op" id="2799660">+</span>&nbsp;<span class="num" id="2799662">31</span><span class="op" id="2799664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799667">31</span>&nbsp;<span class="op" id="2799670">+</span>&nbsp;<span class="num" id="2799672">28</span>&nbsp;<span class="op" id="2799675">+</span>&nbsp;<span class="num" id="2799677">31</span>&nbsp;<span class="op" id="2799680">+</span>&nbsp;<span class="num" id="2799682">30</span>&nbsp;<span class="op" id="2799685">+</span>&nbsp;<span class="num" id="2799687">31</span>&nbsp;<span class="op" id="2799690">+</span>&nbsp;<span class="num" id="2799692">30</span><span class="op" id="2799694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799697">31</span>&nbsp;<span class="op" id="2799700">+</span>&nbsp;<span class="num" id="2799702">28</span>&nbsp;<span class="op" id="2799705">+</span>&nbsp;<span class="num" id="2799707">31</span>&nbsp;<span class="op" id="2799710">+</span>&nbsp;<span class="num" id="2799712">30</span>&nbsp;<span class="op" id="2799715">+</span>&nbsp;<span class="num" id="2799717">31</span>&nbsp;<span class="op" id="2799720">+</span>&nbsp;<span class="num" id="2799722">30</span>&nbsp;<span class="op" id="2799725">+</span>&nbsp;<span class="num" id="2799727">31</span><span class="op" id="2799729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799732">31</span>&nbsp;<span class="op" id="2799735">+</span>&nbsp;<span class="num" id="2799737">28</span>&nbsp;<span class="op" id="2799740">+</span>&nbsp;<span class="num" id="2799742">31</span>&nbsp;<span class="op" id="2799745">+</span>&nbsp;<span class="num" id="2799747">30</span>&nbsp;<span class="op" id="2799750">+</span>&nbsp;<span class="num" id="2799752">31</span>&nbsp;<span class="op" id="2799755">+</span>&nbsp;<span class="num" id="2799757">30</span>&nbsp;<span class="op" id="2799760">+</span>&nbsp;<span class="num" id="2799762">31</span>&nbsp;<span class="op" id="2799765">+</span>&nbsp;<span class="num" id="2799767">31</span><span class="op" id="2799769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799772">31</span>&nbsp;<span class="op" id="2799775">+</span>&nbsp;<span class="num" id="2799777">28</span>&nbsp;<span class="op" id="2799780">+</span>&nbsp;<span class="num" id="2799782">31</span>&nbsp;<span class="op" id="2799785">+</span>&nbsp;<span class="num" id="2799787">30</span>&nbsp;<span class="op" id="2799790">+</span>&nbsp;<span class="num" id="2799792">31</span>&nbsp;<span class="op" id="2799795">+</span>&nbsp;<span class="num" id="2799797">30</span>&nbsp;<span class="op" id="2799800">+</span>&nbsp;<span class="num" id="2799802">31</span>&nbsp;<span class="op" id="2799805">+</span>&nbsp;<span class="num" id="2799807">31</span>&nbsp;<span class="op" id="2799810">+</span>&nbsp;<span class="num" id="2799812">30</span><span class="op" id="2799814">,</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799817">31</span>&nbsp;<span class="op" id="2799820">+</span>&nbsp;<span class="num" id="2799822">28</span>&nbsp;<span class="op" id="2799825">+</span>&nbsp;<span class="num" id="2799827">31</span>&nbsp;<span class="op" id="2799830">+</span>&nbsp;<span class="num" id="2799832">30</span>&nbsp;<span class="op" id="2799835">+</span>&nbsp;<span class="num" id="2799837">31</span>&nbsp;<span class="op" id="2799840">+</span>&nbsp;<span class="num" id="2799842">30</span>&nbsp;<span class="op" id="2799845">+</span>&nbsp;<span class="num" id="2799847">31</span>&nbsp;<span class="op" id="2799850">+</span>&nbsp;<span class="num" id="2799852">31</span>&nbsp;<span class="op" id="2799855">+</span>&nbsp;<span class="num" id="2799857">30</span>&nbsp;<span class="op" id="2799860">+</span>&nbsp;<span class="num" id="2799862">31</span><span class="op" id="2799864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799867">31</span>&nbsp;<span class="op" id="2799870">+</span>&nbsp;<span class="num" id="2799872">28</span>&nbsp;<span class="op" id="2799875">+</span>&nbsp;<span class="num" id="2799877">31</span>&nbsp;<span class="op" id="2799880">+</span>&nbsp;<span class="num" id="2799882">30</span>&nbsp;<span class="op" id="2799885">+</span>&nbsp;<span class="num" id="2799887">31</span>&nbsp;<span class="op" id="2799890">+</span>&nbsp;<span class="num" id="2799892">30</span>&nbsp;<span class="op" id="2799895">+</span>&nbsp;<span class="num" id="2799897">31</span>&nbsp;<span class="op" id="2799900">+</span>&nbsp;<span class="num" id="2799902">31</span>&nbsp;<span class="op" id="2799905">+</span>&nbsp;<span class="num" id="2799907">30</span>&nbsp;<span class="op" id="2799910">+</span>&nbsp;<span class="num" id="2799912">31</span>&nbsp;<span class="op" id="2799915">+</span>&nbsp;<span class="num" id="2799917">30</span><span class="op" id="2799919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2799922">31</span>&nbsp;<span class="op" id="2799925">+</span>&nbsp;<span class="num" id="2799927">28</span>&nbsp;<span class="op" id="2799930">+</span>&nbsp;<span class="num" id="2799932">31</span>&nbsp;<span class="op" id="2799935">+</span>&nbsp;<span class="num" id="2799937">30</span>&nbsp;<span class="op" id="2799940">+</span>&nbsp;<span class="num" id="2799942">31</span>&nbsp;<span class="op" id="2799945">+</span>&nbsp;<span class="num" id="2799947">30</span>&nbsp;<span class="op" id="2799950">+</span>&nbsp;<span class="num" id="2799952">31</span>&nbsp;<span class="op" id="2799955">+</span>&nbsp;<span class="num" id="2799957">31</span>&nbsp;<span class="op" id="2799960">+</span>&nbsp;<span class="num" id="2799962">30</span>&nbsp;<span class="op" id="2799965">+</span>&nbsp;<span class="num" id="2799967">31</span>&nbsp;<span class="op" id="2799970">+</span>&nbsp;<span class="num" id="2799972">30</span>&nbsp;<span class="op" id="2799975">+</span>&nbsp;<span class="num" id="2799977">31</span><span class="op" id="2799979">,</span><br>
<span class="lineno"></span><span class="op" id="2799981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span><span class="keyword" id="2799984">func</span>&nbsp;<span class="ident" id="2799989">daysIn</span><span class="op" id="2799995">(</span><span class="ident" id="2799996">m</span>&nbsp;<span class="ident" id="2799998">Month</span><span class="op" id="2800003">,</span>&nbsp;<span class="ident" id="2800005">year</span>&nbsp;<span class="builtintype" id="2800010">int</span><span class="op" id="2800013">)</span>&nbsp;<span class="builtintype" id="2800015">int</span>&nbsp;<span class="op" id="2800019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800022">if</span>&nbsp;<span class="ident" id="2800025">m</span>&nbsp;<span class="op" id="2800027">==</span>&nbsp;<span class="ident" id="2800030">February</span>&nbsp;<span class="op" id="2800039">&amp;&amp;</span>&nbsp;<span class="ident" id="2800042">isLeap</span><span class="op" id="2800048">(</span><span class="ident" id="2800049">year</span><span class="op" id="2800053">)</span>&nbsp;<span class="op" id="2800055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800059">return</span>&nbsp;<span class="num" id="2800066">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800073">return</span>&nbsp;<span class="builtintype" id="2800080">int</span><span class="op" id="2800083">(</span><span class="ident" id="2800084">daysBefore</span><span class="op" id="2800094">[</span><span class="ident" id="2800095">m</span><span class="op" id="2800096">]</span>&nbsp;<span class="op" id="2800098">-</span>&nbsp;<span class="ident" id="2800100">daysBefore</span><span class="op" id="2800110">[</span><span class="ident" id="2800111">m</span><span class="op" id="2800112">-</span><span class="num" id="2800113">1</span><span class="op" id="2800114">]</span><span class="op" id="2800115">)</span><br>
<span class="lineno">775</span><span class="op" id="2800117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2800120">//&nbsp;Provided&nbsp;by&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="2800152">func</span>&nbsp;<span class="ident" id="2800157">now</span><span class="op" id="2800160">(</span><span class="op" id="2800161">)</span>&nbsp;<span class="op" id="2800163">(</span><span class="ident" id="2800164">sec</span>&nbsp;<span class="ident" id="2800168">int64</span><span class="op" id="2800173">,</span>&nbsp;<span class="ident" id="2800175">nsec</span>&nbsp;<span class="builtintype" id="2800180">int32</span><span class="op" id="2800185">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="comment" id="2800188">//&nbsp;Now&nbsp;returns&nbsp;the&nbsp;current&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2800227">func</span>&nbsp;<span class="ident" id="2800232">Now</span><span class="op" id="2800235">(</span><span class="op" id="2800236">)</span>&nbsp;<span class="ident" id="2800238">Time</span>&nbsp;<span class="op" id="2800243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800246">sec</span><span class="op" id="2800249">,</span>&nbsp;<span class="ident" id="2800251">nsec</span>&nbsp;<span class="op" id="2800256">:=</span>&nbsp;<span class="ident" id="2800259">now</span><span class="op" id="2800262">(</span><span class="op" id="2800263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800266">return</span>&nbsp;<span class="ident" id="2800273">Time</span><span class="op" id="2800277">{</span><span class="ident" id="2800278">sec</span>&nbsp;<span class="op" id="2800282">+</span>&nbsp;<span class="ident" id="2800284">unixToInternal</span><span class="op" id="2800298">,</span>&nbsp;<span class="ident" id="2800300">nsec</span><span class="op" id="2800304">,</span>&nbsp;<span class="ident" id="2800306">Local</span><span class="op" id="2800311">}</span><br>
<span class="lineno"></span><span class="op" id="2800313">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="comment" id="2800316">//&nbsp;UTC&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2800363">func</span>&nbsp;<span class="op" id="2800368">(</span><span class="ident" id="2800369">t</span>&nbsp;<span class="ident" id="2800371">Time</span><span class="op" id="2800375">)</span>&nbsp;<span class="ident" id="2800377">UTC</span><span class="op" id="2800380">(</span><span class="op" id="2800381">)</span>&nbsp;<span class="ident" id="2800383">Time</span>&nbsp;<span class="op" id="2800388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800391">t</span><span class="op" id="2800392">.</span><span class="ident" id="2800393">loc</span>&nbsp;<span class="op" id="2800397">=</span>&nbsp;<span class="ident" id="2800399">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800404">return</span>&nbsp;<span class="ident" id="2800411">t</span><br>
<span class="lineno">790</span><span class="op" id="2800413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2800416">//&nbsp;Local&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2800472">func</span>&nbsp;<span class="op" id="2800477">(</span><span class="ident" id="2800478">t</span>&nbsp;<span class="ident" id="2800480">Time</span><span class="op" id="2800484">)</span>&nbsp;<span class="ident" id="2800486">Local</span><span class="op" id="2800491">(</span><span class="op" id="2800492">)</span>&nbsp;<span class="ident" id="2800494">Time</span>&nbsp;<span class="op" id="2800499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800502">t</span><span class="op" id="2800503">.</span><span class="ident" id="2800504">loc</span>&nbsp;<span class="op" id="2800508">=</span>&nbsp;<span class="ident" id="2800510">Local</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800517">return</span>&nbsp;<span class="ident" id="2800524">t</span><br>
<span class="lineno"></span><span class="op" id="2800526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2800529">//&nbsp;In&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;information&nbsp;set&nbsp;to&nbsp;loc.</span><br>
<span class="lineno"></span><span class="comment" id="2800587">//</span><br>
<span class="lineno">800</span><span class="comment" id="2800590">//&nbsp;In&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2800618">func</span>&nbsp;<span class="op" id="2800623">(</span><span class="ident" id="2800624">t</span>&nbsp;<span class="ident" id="2800626">Time</span><span class="op" id="2800630">)</span>&nbsp;<span class="ident" id="2800632">In</span><span class="op" id="2800634">(</span><span class="ident" id="2800635">loc</span>&nbsp;<span class="op" id="2800639">*</span><span class="ident" id="2800640">Location</span><span class="op" id="2800648">)</span>&nbsp;<span class="ident" id="2800650">Time</span>&nbsp;<span class="op" id="2800655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800658">if</span>&nbsp;<span class="ident" id="2800661">loc</span>&nbsp;<span class="op" id="2800665">==</span>&nbsp;<span class="ident" id="2800668">nil</span>&nbsp;<span class="op" id="2800672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2800676">panic</span><span class="op" id="2800681">(</span><span class="string" id="2800682">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Time.In&#34;</span><span class="op" id="2800725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800728">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800731">t</span><span class="op" id="2800732">.</span><span class="ident" id="2800733">loc</span>&nbsp;<span class="op" id="2800737">=</span>&nbsp;<span class="ident" id="2800739">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800744">return</span>&nbsp;<span class="ident" id="2800751">t</span><br>
<span class="lineno"></span><span class="op" id="2800753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2800756">//&nbsp;Location&nbsp;returns&nbsp;the&nbsp;time&nbsp;zone&nbsp;information&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno">810</span><span class="keyword" id="2800821">func</span>&nbsp;<span class="op" id="2800826">(</span><span class="ident" id="2800827">t</span>&nbsp;<span class="ident" id="2800829">Time</span><span class="op" id="2800833">)</span>&nbsp;<span class="ident" id="2800835">Location</span><span class="op" id="2800843">(</span><span class="op" id="2800844">)</span>&nbsp;<span class="op" id="2800846">*</span><span class="ident" id="2800847">Location</span>&nbsp;<span class="op" id="2800856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800859">l</span>&nbsp;<span class="op" id="2800861">:=</span>&nbsp;<span class="ident" id="2800864">t</span><span class="op" id="2800865">.</span><span class="ident" id="2800866">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800871">if</span>&nbsp;<span class="ident" id="2800874">l</span>&nbsp;<span class="op" id="2800876">==</span>&nbsp;<span class="ident" id="2800879">nil</span>&nbsp;<span class="op" id="2800883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2800887">l</span>&nbsp;<span class="op" id="2800889">=</span>&nbsp;<span class="ident" id="2800891">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2800896">}</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2800899">return</span>&nbsp;<span class="ident" id="2800906">l</span><br>
<span class="lineno"></span><span class="op" id="2800908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2800911">//&nbsp;Zone&nbsp;computes&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;effect&nbsp;at&nbsp;time&nbsp;t,&nbsp;returning&nbsp;the&nbsp;abbreviated</span><br>
<span class="lineno"></span><span class="comment" id="2800989">//&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;)&nbsp;and&nbsp;its&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC.</span><br>
<span class="lineno">820</span><span class="keyword" id="2801064">func</span>&nbsp;<span class="op" id="2801069">(</span><span class="ident" id="2801070">t</span>&nbsp;<span class="ident" id="2801072">Time</span><span class="op" id="2801076">)</span>&nbsp;<span class="ident" id="2801078">Zone</span><span class="op" id="2801082">(</span><span class="op" id="2801083">)</span>&nbsp;<span class="op" id="2801085">(</span><span class="ident" id="2801086">name</span>&nbsp;<span class="builtintype" id="2801091">string</span><span class="op" id="2801097">,</span>&nbsp;<span class="ident" id="2801099">offset</span>&nbsp;<span class="builtintype" id="2801106">int</span><span class="op" id="2801109">)</span>&nbsp;<span class="op" id="2801111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801114">name</span><span class="op" id="2801118">,</span>&nbsp;<span class="ident" id="2801120">offset</span><span class="op" id="2801126">,</span>&nbsp;<span class="ident" id="2801128">_</span><span class="op" id="2801129">,</span>&nbsp;<span class="ident" id="2801131">_</span><span class="op" id="2801132">,</span>&nbsp;<span class="ident" id="2801134">_</span>&nbsp;<span class="op" id="2801136">=</span>&nbsp;<span class="ident" id="2801138">t</span><span class="op" id="2801139">.</span><span class="ident" id="2801140">loc</span><span class="op" id="2801143">.</span><span class="ident" id="2801144">lookup</span><span class="op" id="2801150">(</span><span class="ident" id="2801151">t</span><span class="op" id="2801152">.</span><span class="ident" id="2801153">sec</span>&nbsp;<span class="op" id="2801157">+</span>&nbsp;<span class="ident" id="2801159">internalToUnix</span><span class="op" id="2801173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801176">return</span><br>
<span class="lineno"></span><span class="op" id="2801183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="2801186">//&nbsp;Unix&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2801250">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2801280">func</span>&nbsp;<span class="op" id="2801285">(</span><span class="ident" id="2801286">t</span>&nbsp;<span class="ident" id="2801288">Time</span><span class="op" id="2801292">)</span>&nbsp;<span class="ident" id="2801294">Unix</span><span class="op" id="2801298">(</span><span class="op" id="2801299">)</span>&nbsp;<span class="ident" id="2801301">int64</span>&nbsp;<span class="op" id="2801307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801310">return</span>&nbsp;<span class="ident" id="2801317">t</span><span class="op" id="2801318">.</span><span class="ident" id="2801319">sec</span>&nbsp;<span class="op" id="2801323">+</span>&nbsp;<span class="ident" id="2801325">internalToUnix</span><br>
<span class="lineno"></span><span class="op" id="2801340">}</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span><span class="comment" id="2801343">//&nbsp;UnixNano&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;nanoseconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2801415">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.&nbsp;The&nbsp;result&nbsp;is&nbsp;undefined&nbsp;if&nbsp;the&nbsp;Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2801486">//&nbsp;in&nbsp;nanoseconds&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;an&nbsp;int64.&nbsp;Note&nbsp;that&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2801554">//&nbsp;means&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;UnixNano&nbsp;on&nbsp;the&nbsp;zero&nbsp;Time&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">835</span><span class="keyword" id="2801625">func</span>&nbsp;<span class="op" id="2801630">(</span><span class="ident" id="2801631">t</span>&nbsp;<span class="ident" id="2801633">Time</span><span class="op" id="2801637">)</span>&nbsp;<span class="ident" id="2801639">UnixNano</span><span class="op" id="2801647">(</span><span class="op" id="2801648">)</span>&nbsp;<span class="ident" id="2801650">int64</span>&nbsp;<span class="op" id="2801656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801659">return</span>&nbsp;<span class="op" id="2801666">(</span><span class="ident" id="2801667">t</span><span class="op" id="2801668">.</span><span class="ident" id="2801669">sec</span><span class="op" id="2801672">+</span><span class="ident" id="2801673">internalToUnix</span><span class="op" id="2801687">)</span><span class="op" id="2801688">*</span><span class="num" id="2801689">1e9</span>&nbsp;<span class="op" id="2801693">+</span>&nbsp;<span class="ident" id="2801695">int64</span><span class="op" id="2801700">(</span><span class="ident" id="2801701">t</span><span class="op" id="2801702">.</span><span class="ident" id="2801703">nsec</span><span class="op" id="2801707">)</span><br>
<span class="lineno"></span><span class="op" id="2801709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2801712">const</span>&nbsp;<span class="ident" id="2801718">timeBinaryVersion</span>&nbsp;<span class="builtintype" id="2801736">byte</span>&nbsp;<span class="op" id="2801741">=</span>&nbsp;<span class="num" id="2801743">1</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="comment" id="2801746">//&nbsp;MarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2801814">func</span>&nbsp;<span class="op" id="2801819">(</span><span class="ident" id="2801820">t</span>&nbsp;<span class="ident" id="2801822">Time</span><span class="op" id="2801826">)</span>&nbsp;<span class="ident" id="2801828">MarshalBinary</span><span class="op" id="2801841">(</span><span class="op" id="2801842">)</span>&nbsp;<span class="op" id="2801844">(</span><span class="op" id="2801845">[</span><span class="op" id="2801846">]</span><span class="builtintype" id="2801847">byte</span><span class="op" id="2801851">,</span>&nbsp;<span class="builtintype" id="2801853">error</span><span class="op" id="2801858">)</span>&nbsp;<span class="op" id="2801860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801863">var</span>&nbsp;<span class="ident" id="2801867">offsetMin</span>&nbsp;<span class="builtintype" id="2801877">int16</span>&nbsp;<span class="comment" id="2801883">//&nbsp;minutes&nbsp;east&nbsp;of&nbsp;UTC.&nbsp;-1&nbsp;is&nbsp;UTC.</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2801920">if</span>&nbsp;<span class="ident" id="2801923">t</span><span class="op" id="2801924">.</span><span class="ident" id="2801925">Location</span><span class="op" id="2801933">(</span><span class="op" id="2801934">)</span>&nbsp;<span class="op" id="2801936">==</span>&nbsp;<span class="op" id="2801939">&amp;</span><span class="ident" id="2801940">utcLoc</span>&nbsp;<span class="op" id="2801947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801951">offsetMin</span>&nbsp;<span class="op" id="2801961">=</span>&nbsp;<span class="op" id="2801963">-</span><span class="num" id="2801964">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2801967">}</span>&nbsp;<span class="keyword" id="2801969">else</span>&nbsp;<span class="op" id="2801974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2801978">_</span><span class="op" id="2801979">,</span>&nbsp;<span class="ident" id="2801981">offset</span>&nbsp;<span class="op" id="2801988">:=</span>&nbsp;<span class="ident" id="2801991">t</span><span class="op" id="2801992">.</span><span class="ident" id="2801993">Zone</span><span class="op" id="2801997">(</span><span class="op" id="2801998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802002">if</span>&nbsp;<span class="ident" id="2802005">offset</span><span class="op" id="2802011">%</span><span class="num" id="2802012">60</span>&nbsp;<span class="op" id="2802015">!=</span>&nbsp;<span class="num" id="2802018">0</span>&nbsp;<span class="op" id="2802020">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802025">return</span>&nbsp;<span class="ident" id="2802032">nil</span><span class="op" id="2802035">,</span>&nbsp;<span class="ident" id="2802037">errors</span><span class="op" id="2802043">.</span><span class="ident" id="2802044">New</span><span class="op" id="2802047">(</span><span class="string" id="2802048">&#34;Time.MarshalBinary:&nbsp;zone&nbsp;offset&nbsp;has&nbsp;fractional&nbsp;minute&#34;</span><span class="op" id="2802103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802111">offset</span>&nbsp;<span class="op" id="2802118">/=</span>&nbsp;<span class="num" id="2802121">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802126">if</span>&nbsp;<span class="ident" id="2802129">offset</span>&nbsp;<span class="op" id="2802136">&lt;</span>&nbsp;<span class="op" id="2802138">-</span><span class="num" id="2802139">32768</span>&nbsp;<span class="op" id="2802145">||</span>&nbsp;<span class="ident" id="2802148">offset</span>&nbsp;<span class="op" id="2802155">==</span>&nbsp;<span class="op" id="2802158">-</span><span class="num" id="2802159">1</span>&nbsp;<span class="op" id="2802161">||</span>&nbsp;<span class="ident" id="2802164">offset</span>&nbsp;<span class="op" id="2802171">&gt;</span>&nbsp;<span class="num" id="2802173">32767</span>&nbsp;<span class="op" id="2802179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802184">return</span>&nbsp;<span class="ident" id="2802191">nil</span><span class="op" id="2802194">,</span>&nbsp;<span class="ident" id="2802196">errors</span><span class="op" id="2802202">.</span><span class="ident" id="2802203">New</span><span class="op" id="2802206">(</span><span class="string" id="2802207">&#34;Time.MarshalBinary:&nbsp;unexpected&nbsp;zone&nbsp;offset&#34;</span><span class="op" id="2802251">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802259">offsetMin</span>&nbsp;<span class="op" id="2802269">=</span>&nbsp;<span class="builtintype" id="2802271">int16</span><span class="op" id="2802276">(</span><span class="ident" id="2802277">offset</span><span class="op" id="2802283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802290">enc</span>&nbsp;<span class="op" id="2802294">:=</span>&nbsp;<span class="op" id="2802297">[</span><span class="op" id="2802298">]</span><span class="builtintype" id="2802299">byte</span><span class="op" id="2802303">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802307">timeBinaryVersion</span><span class="op" id="2802324">,</span>&nbsp;<span class="comment" id="2802326">//&nbsp;byte&nbsp;0&nbsp;:&nbsp;version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802348">byte</span><span class="op" id="2802352">(</span><span class="ident" id="2802353">t</span><span class="op" id="2802354">.</span><span class="ident" id="2802355">sec</span>&nbsp;<span class="op" id="2802359">&gt;&gt;</span>&nbsp;<span class="num" id="2802362">56</span><span class="op" id="2802364">)</span><span class="op" id="2802365">,</span>&nbsp;<span class="comment" id="2802367">//&nbsp;bytes&nbsp;1-8:&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802391">byte</span><span class="op" id="2802395">(</span><span class="ident" id="2802396">t</span><span class="op" id="2802397">.</span><span class="ident" id="2802398">sec</span>&nbsp;<span class="op" id="2802402">&gt;&gt;</span>&nbsp;<span class="num" id="2802405">48</span><span class="op" id="2802407">)</span><span class="op" id="2802408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802412">byte</span><span class="op" id="2802416">(</span><span class="ident" id="2802417">t</span><span class="op" id="2802418">.</span><span class="ident" id="2802419">sec</span>&nbsp;<span class="op" id="2802423">&gt;&gt;</span>&nbsp;<span class="num" id="2802426">40</span><span class="op" id="2802428">)</span><span class="op" id="2802429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802433">byte</span><span class="op" id="2802437">(</span><span class="ident" id="2802438">t</span><span class="op" id="2802439">.</span><span class="ident" id="2802440">sec</span>&nbsp;<span class="op" id="2802444">&gt;&gt;</span>&nbsp;<span class="num" id="2802447">32</span><span class="op" id="2802449">)</span><span class="op" id="2802450">,</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802454">byte</span><span class="op" id="2802458">(</span><span class="ident" id="2802459">t</span><span class="op" id="2802460">.</span><span class="ident" id="2802461">sec</span>&nbsp;<span class="op" id="2802465">&gt;&gt;</span>&nbsp;<span class="num" id="2802468">24</span><span class="op" id="2802470">)</span><span class="op" id="2802471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802475">byte</span><span class="op" id="2802479">(</span><span class="ident" id="2802480">t</span><span class="op" id="2802481">.</span><span class="ident" id="2802482">sec</span>&nbsp;<span class="op" id="2802486">&gt;&gt;</span>&nbsp;<span class="num" id="2802489">16</span><span class="op" id="2802491">)</span><span class="op" id="2802492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802496">byte</span><span class="op" id="2802500">(</span><span class="ident" id="2802501">t</span><span class="op" id="2802502">.</span><span class="ident" id="2802503">sec</span>&nbsp;<span class="op" id="2802507">&gt;&gt;</span>&nbsp;<span class="num" id="2802510">8</span><span class="op" id="2802511">)</span><span class="op" id="2802512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802516">byte</span><span class="op" id="2802520">(</span><span class="ident" id="2802521">t</span><span class="op" id="2802522">.</span><span class="ident" id="2802523">sec</span><span class="op" id="2802526">)</span><span class="op" id="2802527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802531">byte</span><span class="op" id="2802535">(</span><span class="ident" id="2802536">t</span><span class="op" id="2802537">.</span><span class="ident" id="2802538">nsec</span>&nbsp;<span class="op" id="2802543">&gt;&gt;</span>&nbsp;<span class="num" id="2802546">24</span><span class="op" id="2802548">)</span><span class="op" id="2802549">,</span>&nbsp;<span class="comment" id="2802551">//&nbsp;bytes&nbsp;9-12:&nbsp;nanoseconds</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802580">byte</span><span class="op" id="2802584">(</span><span class="ident" id="2802585">t</span><span class="op" id="2802586">.</span><span class="ident" id="2802587">nsec</span>&nbsp;<span class="op" id="2802592">&gt;&gt;</span>&nbsp;<span class="num" id="2802595">16</span><span class="op" id="2802597">)</span><span class="op" id="2802598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802602">byte</span><span class="op" id="2802606">(</span><span class="ident" id="2802607">t</span><span class="op" id="2802608">.</span><span class="ident" id="2802609">nsec</span>&nbsp;<span class="op" id="2802614">&gt;&gt;</span>&nbsp;<span class="num" id="2802617">8</span><span class="op" id="2802618">)</span><span class="op" id="2802619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802623">byte</span><span class="op" id="2802627">(</span><span class="ident" id="2802628">t</span><span class="op" id="2802629">.</span><span class="ident" id="2802630">nsec</span><span class="op" id="2802634">)</span><span class="op" id="2802635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802639">byte</span><span class="op" id="2802643">(</span><span class="ident" id="2802644">offsetMin</span>&nbsp;<span class="op" id="2802654">&gt;&gt;</span>&nbsp;<span class="num" id="2802657">8</span><span class="op" id="2802658">)</span><span class="op" id="2802659">,</span>&nbsp;<span class="comment" id="2802661">//&nbsp;bytes&nbsp;13-14:&nbsp;zone&nbsp;offset&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2802702">byte</span><span class="op" id="2802706">(</span><span class="ident" id="2802707">offsetMin</span><span class="op" id="2802716">)</span><span class="op" id="2802717">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802724">return</span>&nbsp;<span class="ident" id="2802731">enc</span><span class="op" id="2802734">,</span>&nbsp;<span class="ident" id="2802736">nil</span><br>
<span class="lineno"></span><span class="op" id="2802740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">880</span><span class="comment" id="2802743">//&nbsp;UnmarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2802815">func</span>&nbsp;<span class="op" id="2802820">(</span><span class="ident" id="2802821">t</span>&nbsp;<span class="op" id="2802823">*</span><span class="ident" id="2802824">Time</span><span class="op" id="2802828">)</span>&nbsp;<span class="ident" id="2802830">UnmarshalBinary</span><span class="op" id="2802845">(</span><span class="ident" id="2802846">data</span>&nbsp;<span class="op" id="2802851">[</span><span class="op" id="2802852">]</span><span class="builtintype" id="2802853">byte</span><span class="op" id="2802857">)</span>&nbsp;<span class="builtintype" id="2802859">error</span>&nbsp;<span class="op" id="2802865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2802868">buf</span>&nbsp;<span class="op" id="2802872">:=</span>&nbsp;<span class="ident" id="2802875">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802881">if</span>&nbsp;<span class="builtinfunc" id="2802884">len</span><span class="op" id="2802887">(</span><span class="ident" id="2802888">buf</span><span class="op" id="2802891">)</span>&nbsp;<span class="op" id="2802893">==</span>&nbsp;<span class="num" id="2802896">0</span>&nbsp;<span class="op" id="2802898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802902">return</span>&nbsp;<span class="ident" id="2802909">errors</span><span class="op" id="2802915">.</span><span class="ident" id="2802916">New</span><span class="op" id="2802919">(</span><span class="string" id="2802920">&#34;Time.UnmarshalBinary:&nbsp;no&nbsp;data&#34;</span><span class="op" id="2802951">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2802954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802958">if</span>&nbsp;<span class="ident" id="2802961">buf</span><span class="op" id="2802964">[</span><span class="num" id="2802965">0</span><span class="op" id="2802966">]</span>&nbsp;<span class="op" id="2802968">!=</span>&nbsp;<span class="ident" id="2802971">timeBinaryVersion</span>&nbsp;<span class="op" id="2802989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2802993">return</span>&nbsp;<span class="ident" id="2803000">errors</span><span class="op" id="2803006">.</span><span class="ident" id="2803007">New</span><span class="op" id="2803010">(</span><span class="string" id="2803011">&#34;Time.UnmarshalBinary:&nbsp;unsupported&nbsp;version&#34;</span><span class="op" id="2803054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803057">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803061">if</span>&nbsp;<span class="builtinfunc" id="2803064">len</span><span class="op" id="2803067">(</span><span class="ident" id="2803068">buf</span><span class="op" id="2803071">)</span>&nbsp;<span class="op" id="2803073">!=</span>&nbsp;<span class="comment" id="2803076">/*version*/</span>&nbsp;<span class="num" id="2803088">1</span><span class="op" id="2803089">+</span>&nbsp;<span class="comment" id="2803091">/*sec*/</span>&nbsp;<span class="num" id="2803099">8</span><span class="op" id="2803100">+</span>&nbsp;<span class="comment" id="2803102">/*nsec*/</span>&nbsp;<span class="num" id="2803111">4</span><span class="op" id="2803112">+</span>&nbsp;<span class="comment" id="2803114">/*zone&nbsp;offset*/</span>&nbsp;<span class="num" id="2803130">2</span>&nbsp;<span class="op" id="2803132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803136">return</span>&nbsp;<span class="ident" id="2803143">errors</span><span class="op" id="2803149">.</span><span class="ident" id="2803150">New</span><span class="op" id="2803153">(</span><span class="string" id="2803154">&#34;Time.UnmarshalBinary:&nbsp;invalid&nbsp;length&#34;</span><span class="op" id="2803192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803199">buf</span>&nbsp;<span class="op" id="2803203">=</span>&nbsp;<span class="ident" id="2803205">buf</span><span class="op" id="2803208">[</span><span class="num" id="2803209">1</span><span class="op" id="2803210">:</span><span class="op" id="2803211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803214">t</span><span class="op" id="2803215">.</span><span class="ident" id="2803216">sec</span>&nbsp;<span class="op" id="2803220">=</span>&nbsp;<span class="ident" id="2803222">int64</span><span class="op" id="2803227">(</span><span class="ident" id="2803228">buf</span><span class="op" id="2803231">[</span><span class="num" id="2803232">7</span><span class="op" id="2803233">]</span><span class="op" id="2803234">)</span>&nbsp;<span class="op" id="2803236">|</span>&nbsp;<span class="ident" id="2803238">int64</span><span class="op" id="2803243">(</span><span class="ident" id="2803244">buf</span><span class="op" id="2803247">[</span><span class="num" id="2803248">6</span><span class="op" id="2803249">]</span><span class="op" id="2803250">)</span><span class="op" id="2803251">&lt;&lt;</span><span class="num" id="2803253">8</span>&nbsp;<span class="op" id="2803255">|</span>&nbsp;<span class="ident" id="2803257">int64</span><span class="op" id="2803262">(</span><span class="ident" id="2803263">buf</span><span class="op" id="2803266">[</span><span class="num" id="2803267">5</span><span class="op" id="2803268">]</span><span class="op" id="2803269">)</span><span class="op" id="2803270">&lt;&lt;</span><span class="num" id="2803272">16</span>&nbsp;<span class="op" id="2803275">|</span>&nbsp;<span class="ident" id="2803277">int64</span><span class="op" id="2803282">(</span><span class="ident" id="2803283">buf</span><span class="op" id="2803286">[</span><span class="num" id="2803287">4</span><span class="op" id="2803288">]</span><span class="op" id="2803289">)</span><span class="op" id="2803290">&lt;&lt;</span><span class="num" id="2803292">24</span>&nbsp;<span class="op" id="2803295">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803299">int64</span><span class="op" id="2803304">(</span><span class="ident" id="2803305">buf</span><span class="op" id="2803308">[</span><span class="num" id="2803309">3</span><span class="op" id="2803310">]</span><span class="op" id="2803311">)</span><span class="op" id="2803312">&lt;&lt;</span><span class="num" id="2803314">32</span>&nbsp;<span class="op" id="2803317">|</span>&nbsp;<span class="ident" id="2803319">int64</span><span class="op" id="2803324">(</span><span class="ident" id="2803325">buf</span><span class="op" id="2803328">[</span><span class="num" id="2803329">2</span><span class="op" id="2803330">]</span><span class="op" id="2803331">)</span><span class="op" id="2803332">&lt;&lt;</span><span class="num" id="2803334">40</span>&nbsp;<span class="op" id="2803337">|</span>&nbsp;<span class="ident" id="2803339">int64</span><span class="op" id="2803344">(</span><span class="ident" id="2803345">buf</span><span class="op" id="2803348">[</span><span class="num" id="2803349">1</span><span class="op" id="2803350">]</span><span class="op" id="2803351">)</span><span class="op" id="2803352">&lt;&lt;</span><span class="num" id="2803354">48</span>&nbsp;<span class="op" id="2803357">|</span>&nbsp;<span class="ident" id="2803359">int64</span><span class="op" id="2803364">(</span><span class="ident" id="2803365">buf</span><span class="op" id="2803368">[</span><span class="num" id="2803369">0</span><span class="op" id="2803370">]</span><span class="op" id="2803371">)</span><span class="op" id="2803372">&lt;&lt;</span><span class="num" id="2803374">56</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803379">buf</span>&nbsp;<span class="op" id="2803383">=</span>&nbsp;<span class="ident" id="2803385">buf</span><span class="op" id="2803388">[</span><span class="num" id="2803389">8</span><span class="op" id="2803390">:</span><span class="op" id="2803391">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803394">t</span><span class="op" id="2803395">.</span><span class="ident" id="2803396">nsec</span>&nbsp;<span class="op" id="2803401">=</span>&nbsp;<span class="builtintype" id="2803403">int32</span><span class="op" id="2803408">(</span><span class="ident" id="2803409">buf</span><span class="op" id="2803412">[</span><span class="num" id="2803413">3</span><span class="op" id="2803414">]</span><span class="op" id="2803415">)</span>&nbsp;<span class="op" id="2803417">|</span>&nbsp;<span class="builtintype" id="2803419">int32</span><span class="op" id="2803424">(</span><span class="ident" id="2803425">buf</span><span class="op" id="2803428">[</span><span class="num" id="2803429">2</span><span class="op" id="2803430">]</span><span class="op" id="2803431">)</span><span class="op" id="2803432">&lt;&lt;</span><span class="num" id="2803434">8</span>&nbsp;<span class="op" id="2803436">|</span>&nbsp;<span class="builtintype" id="2803438">int32</span><span class="op" id="2803443">(</span><span class="ident" id="2803444">buf</span><span class="op" id="2803447">[</span><span class="num" id="2803448">1</span><span class="op" id="2803449">]</span><span class="op" id="2803450">)</span><span class="op" id="2803451">&lt;&lt;</span><span class="num" id="2803453">16</span>&nbsp;<span class="op" id="2803456">|</span>&nbsp;<span class="builtintype" id="2803458">int32</span><span class="op" id="2803463">(</span><span class="ident" id="2803464">buf</span><span class="op" id="2803467">[</span><span class="num" id="2803468">0</span><span class="op" id="2803469">]</span><span class="op" id="2803470">)</span><span class="op" id="2803471">&lt;&lt;</span><span class="num" id="2803473">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803478">buf</span>&nbsp;<span class="op" id="2803482">=</span>&nbsp;<span class="ident" id="2803484">buf</span><span class="op" id="2803487">[</span><span class="num" id="2803488">4</span><span class="op" id="2803489">:</span><span class="op" id="2803490">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803493">offset</span>&nbsp;<span class="op" id="2803500">:=</span>&nbsp;<span class="builtintype" id="2803503">int</span><span class="op" id="2803506">(</span><span class="builtintype" id="2803507">int16</span><span class="op" id="2803512">(</span><span class="ident" id="2803513">buf</span><span class="op" id="2803516">[</span><span class="num" id="2803517">1</span><span class="op" id="2803518">]</span><span class="op" id="2803519">)</span><span class="op" id="2803520">|</span><span class="builtintype" id="2803521">int16</span><span class="op" id="2803526">(</span><span class="ident" id="2803527">buf</span><span class="op" id="2803530">[</span><span class="num" id="2803531">0</span><span class="op" id="2803532">]</span><span class="op" id="2803533">)</span><span class="op" id="2803534">&lt;&lt;</span><span class="num" id="2803536">8</span><span class="op" id="2803537">)</span>&nbsp;<span class="op" id="2803539">*</span>&nbsp;<span class="num" id="2803541">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803546">if</span>&nbsp;<span class="ident" id="2803549">offset</span>&nbsp;<span class="op" id="2803556">==</span>&nbsp;<span class="op" id="2803559">-</span><span class="num" id="2803560">1</span><span class="op" id="2803561">*</span><span class="num" id="2803562">60</span>&nbsp;<span class="op" id="2803565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803569">t</span><span class="op" id="2803570">.</span><span class="ident" id="2803571">loc</span>&nbsp;<span class="op" id="2803575">=</span>&nbsp;<span class="op" id="2803577">&amp;</span><span class="ident" id="2803578">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803586">}</span>&nbsp;<span class="keyword" id="2803588">else</span>&nbsp;<span class="keyword" id="2803593">if</span>&nbsp;<span class="ident" id="2803596">_</span><span class="op" id="2803597">,</span>&nbsp;<span class="ident" id="2803599">localoff</span><span class="op" id="2803607">,</span>&nbsp;<span class="ident" id="2803609">_</span><span class="op" id="2803610">,</span>&nbsp;<span class="ident" id="2803612">_</span><span class="op" id="2803613">,</span>&nbsp;<span class="ident" id="2803615">_</span>&nbsp;<span class="op" id="2803617">:=</span>&nbsp;<span class="ident" id="2803620">Local</span><span class="op" id="2803625">.</span><span class="ident" id="2803626">lookup</span><span class="op" id="2803632">(</span><span class="ident" id="2803633">t</span><span class="op" id="2803634">.</span><span class="ident" id="2803635">sec</span>&nbsp;<span class="op" id="2803639">+</span>&nbsp;<span class="ident" id="2803641">internalToUnix</span><span class="op" id="2803655">)</span><span class="op" id="2803656">;</span>&nbsp;<span class="ident" id="2803658">offset</span>&nbsp;<span class="op" id="2803665">==</span>&nbsp;<span class="ident" id="2803668">localoff</span>&nbsp;<span class="op" id="2803677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803681">t</span><span class="op" id="2803682">.</span><span class="ident" id="2803683">loc</span>&nbsp;<span class="op" id="2803687">=</span>&nbsp;<span class="ident" id="2803689">Local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803696">}</span>&nbsp;<span class="keyword" id="2803698">else</span>&nbsp;<span class="op" id="2803703">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2803707">t</span><span class="op" id="2803708">.</span><span class="ident" id="2803709">loc</span>&nbsp;<span class="op" id="2803713">=</span>&nbsp;<span class="ident" id="2803715">FixedZone</span><span class="op" id="2803724">(</span><span class="string" id="2803725">&#34;&#34;</span><span class="op" id="2803727">,</span>&nbsp;<span class="ident" id="2803729">offset</span><span class="op" id="2803735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2803738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2803742">return</span>&nbsp;<span class="ident" id="2803749">nil</span><br>
<span class="lineno"></span><span class="op" id="2803753">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="2803756">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;GobEncoder,&nbsp;GobDecoder,&nbsp;MarshalJSON,&nbsp;UnmarshalJSON&nbsp;in&nbsp;Go&nbsp;2.</span><br>
<span class="lineno"></span><span class="comment" id="2803837">//&nbsp;The&nbsp;same&nbsp;semantics&nbsp;will&nbsp;be&nbsp;provided&nbsp;by&nbsp;the&nbsp;generic&nbsp;MarshalBinary,&nbsp;MarshalText,</span><br>
<span class="lineno"></span><span class="comment" id="2803919">//&nbsp;UnmarshalBinary,&nbsp;UnmarshalText.</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span><span class="comment" id="2803955">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2804009">func</span>&nbsp;<span class="op" id="2804014">(</span><span class="ident" id="2804015">t</span>&nbsp;<span class="ident" id="2804017">Time</span><span class="op" id="2804021">)</span>&nbsp;<span class="ident" id="2804023">GobEncode</span><span class="op" id="2804032">(</span><span class="op" id="2804033">)</span>&nbsp;<span class="op" id="2804035">(</span><span class="op" id="2804036">[</span><span class="op" id="2804037">]</span><span class="builtintype" id="2804038">byte</span><span class="op" id="2804042">,</span>&nbsp;<span class="builtintype" id="2804044">error</span><span class="op" id="2804049">)</span>&nbsp;<span class="op" id="2804051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804054">return</span>&nbsp;<span class="ident" id="2804061">t</span><span class="op" id="2804062">.</span><span class="ident" id="2804063">MarshalBinary</span><span class="op" id="2804076">(</span><span class="op" id="2804077">)</span><br>
<span class="lineno"></span><span class="op" id="2804079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="comment" id="2804082">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2804136">func</span>&nbsp;<span class="op" id="2804141">(</span><span class="ident" id="2804142">t</span>&nbsp;<span class="op" id="2804144">*</span><span class="ident" id="2804145">Time</span><span class="op" id="2804149">)</span>&nbsp;<span class="ident" id="2804151">GobDecode</span><span class="op" id="2804160">(</span><span class="ident" id="2804161">data</span>&nbsp;<span class="op" id="2804166">[</span><span class="op" id="2804167">]</span><span class="builtintype" id="2804168">byte</span><span class="op" id="2804172">)</span>&nbsp;<span class="builtintype" id="2804174">error</span>&nbsp;<span class="op" id="2804180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804183">return</span>&nbsp;<span class="ident" id="2804190">t</span><span class="op" id="2804191">.</span><span class="ident" id="2804192">UnmarshalBinary</span><span class="op" id="2804207">(</span><span class="ident" id="2804208">data</span><span class="op" id="2804212">)</span><br>
<span class="lineno"></span><span class="op" id="2804214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="2804217">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2804273">//&nbsp;The&nbsp;time&nbsp;is&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2804368">func</span>&nbsp;<span class="op" id="2804373">(</span><span class="ident" id="2804374">t</span>&nbsp;<span class="ident" id="2804376">Time</span><span class="op" id="2804380">)</span>&nbsp;<span class="ident" id="2804382">MarshalJSON</span><span class="op" id="2804393">(</span><span class="op" id="2804394">)</span>&nbsp;<span class="op" id="2804396">(</span><span class="op" id="2804397">[</span><span class="op" id="2804398">]</span><span class="builtintype" id="2804399">byte</span><span class="op" id="2804403">,</span>&nbsp;<span class="builtintype" id="2804405">error</span><span class="op" id="2804410">)</span>&nbsp;<span class="op" id="2804412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804415">if</span>&nbsp;<span class="ident" id="2804418">y</span>&nbsp;<span class="op" id="2804420">:=</span>&nbsp;<span class="ident" id="2804423">t</span><span class="op" id="2804424">.</span><span class="ident" id="2804425">Year</span><span class="op" id="2804429">(</span><span class="op" id="2804430">)</span><span class="op" id="2804431">;</span>&nbsp;<span class="ident" id="2804433">y</span>&nbsp;<span class="op" id="2804435">&lt;</span>&nbsp;<span class="num" id="2804437">0</span>&nbsp;<span class="op" id="2804439">||</span>&nbsp;<span class="ident" id="2804442">y</span>&nbsp;<span class="op" id="2804444">&gt;=</span>&nbsp;<span class="num" id="2804447">10000</span>&nbsp;<span class="op" id="2804453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804457">//&nbsp;RFC&nbsp;3339&nbsp;is&nbsp;clear&nbsp;that&nbsp;years&nbsp;are&nbsp;4&nbsp;digits&nbsp;exactly.</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804513">//&nbsp;See&nbsp;golang.org/issue/4556#c15&nbsp;for&nbsp;more&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804569">return</span>&nbsp;<span class="ident" id="2804576">nil</span><span class="op" id="2804579">,</span>&nbsp;<span class="ident" id="2804581">errors</span><span class="op" id="2804587">.</span><span class="ident" id="2804588">New</span><span class="op" id="2804591">(</span><span class="string" id="2804592">&#34;Time.MarshalJSON:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2804642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804648">return</span>&nbsp;<span class="op" id="2804655">[</span><span class="op" id="2804656">]</span><span class="builtintype" id="2804657">byte</span><span class="op" id="2804661">(</span><span class="ident" id="2804662">t</span><span class="op" id="2804663">.</span><span class="ident" id="2804664">Format</span><span class="op" id="2804670">(</span><span class="string" id="2804671">`&#34;`</span>&nbsp;<span class="op" id="2804675">+</span>&nbsp;<span class="ident" id="2804677">RFC3339Nano</span>&nbsp;<span class="op" id="2804689">+</span>&nbsp;<span class="string" id="2804691">`&#34;`</span><span class="op" id="2804694">)</span><span class="op" id="2804695">)</span><span class="op" id="2804696">,</span>&nbsp;<span class="ident" id="2804698">nil</span><br>
<span class="lineno"></span><span class="op" id="2804702">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="comment" id="2804705">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2804765">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="2804831">func</span>&nbsp;<span class="op" id="2804836">(</span><span class="ident" id="2804837">t</span>&nbsp;<span class="op" id="2804839">*</span><span class="ident" id="2804840">Time</span><span class="op" id="2804844">)</span>&nbsp;<span class="ident" id="2804846">UnmarshalJSON</span><span class="op" id="2804859">(</span><span class="ident" id="2804860">data</span>&nbsp;<span class="op" id="2804865">[</span><span class="op" id="2804866">]</span><span class="builtintype" id="2804867">byte</span><span class="op" id="2804871">)</span>&nbsp;<span class="op" id="2804873">(</span><span class="ident" id="2804874">err</span>&nbsp;<span class="builtintype" id="2804878">error</span><span class="op" id="2804883">)</span>&nbsp;<span class="op" id="2804885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2804888">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2804944">*</span><span class="ident" id="2804945">t</span><span class="op" id="2804946">,</span>&nbsp;<span class="ident" id="2804948">err</span>&nbsp;<span class="op" id="2804952">=</span>&nbsp;<span class="ident" id="2804954">Parse</span><span class="op" id="2804959">(</span><span class="string" id="2804960">`&#34;`</span><span class="op" id="2804963">+</span><span class="ident" id="2804964">RFC3339</span><span class="op" id="2804971">+</span><span class="string" id="2804972">`&#34;`</span><span class="op" id="2804975">,</span>&nbsp;<span class="builtintype" id="2804977">string</span><span class="op" id="2804983">(</span><span class="ident" id="2804984">data</span><span class="op" id="2804988">)</span><span class="op" id="2804989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2804992">return</span><br>
<span class="lineno"></span><span class="op" id="2804999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2805002">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno">950</span><span class="comment" id="2805066">//&nbsp;The&nbsp;time&nbsp;is&nbsp;formatted&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2805155">func</span>&nbsp;<span class="op" id="2805160">(</span><span class="ident" id="2805161">t</span>&nbsp;<span class="ident" id="2805163">Time</span><span class="op" id="2805167">)</span>&nbsp;<span class="ident" id="2805169">MarshalText</span><span class="op" id="2805180">(</span><span class="op" id="2805181">)</span>&nbsp;<span class="op" id="2805183">(</span><span class="op" id="2805184">[</span><span class="op" id="2805185">]</span><span class="builtintype" id="2805186">byte</span><span class="op" id="2805190">,</span>&nbsp;<span class="builtintype" id="2805192">error</span><span class="op" id="2805197">)</span>&nbsp;<span class="op" id="2805199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805202">if</span>&nbsp;<span class="ident" id="2805205">y</span>&nbsp;<span class="op" id="2805207">:=</span>&nbsp;<span class="ident" id="2805210">t</span><span class="op" id="2805211">.</span><span class="ident" id="2805212">Year</span><span class="op" id="2805216">(</span><span class="op" id="2805217">)</span><span class="op" id="2805218">;</span>&nbsp;<span class="ident" id="2805220">y</span>&nbsp;<span class="op" id="2805222">&lt;</span>&nbsp;<span class="num" id="2805224">0</span>&nbsp;<span class="op" id="2805226">||</span>&nbsp;<span class="ident" id="2805229">y</span>&nbsp;<span class="op" id="2805231">&gt;=</span>&nbsp;<span class="num" id="2805234">10000</span>&nbsp;<span class="op" id="2805240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805244">return</span>&nbsp;<span class="ident" id="2805251">nil</span><span class="op" id="2805254">,</span>&nbsp;<span class="ident" id="2805256">errors</span><span class="op" id="2805262">.</span><span class="ident" id="2805263">New</span><span class="op" id="2805266">(</span><span class="string" id="2805267">&#34;Time.MarshalText:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2805317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805320">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805323">return</span>&nbsp;<span class="op" id="2805330">[</span><span class="op" id="2805331">]</span><span class="builtintype" id="2805332">byte</span><span class="op" id="2805336">(</span><span class="ident" id="2805337">t</span><span class="op" id="2805338">.</span><span class="ident" id="2805339">Format</span><span class="op" id="2805345">(</span><span class="ident" id="2805346">RFC3339Nano</span><span class="op" id="2805357">)</span><span class="op" id="2805358">)</span><span class="op" id="2805359">,</span>&nbsp;<span class="ident" id="2805361">nil</span><br>
<span class="lineno"></span><span class="op" id="2805365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2805368">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2805436">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno">960</span><span class="keyword" id="2805486">func</span>&nbsp;<span class="op" id="2805491">(</span><span class="ident" id="2805492">t</span>&nbsp;<span class="op" id="2805494">*</span><span class="ident" id="2805495">Time</span><span class="op" id="2805499">)</span>&nbsp;<span class="ident" id="2805501">UnmarshalText</span><span class="op" id="2805514">(</span><span class="ident" id="2805515">data</span>&nbsp;<span class="op" id="2805520">[</span><span class="op" id="2805521">]</span><span class="builtintype" id="2805522">byte</span><span class="op" id="2805526">)</span>&nbsp;<span class="op" id="2805528">(</span><span class="ident" id="2805529">err</span>&nbsp;<span class="builtintype" id="2805533">error</span><span class="op" id="2805538">)</span>&nbsp;<span class="op" id="2805540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2805543">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2805599">*</span><span class="ident" id="2805600">t</span><span class="op" id="2805601">,</span>&nbsp;<span class="ident" id="2805603">err</span>&nbsp;<span class="op" id="2805607">=</span>&nbsp;<span class="ident" id="2805609">Parse</span><span class="op" id="2805614">(</span><span class="ident" id="2805615">RFC3339</span><span class="op" id="2805622">,</span>&nbsp;<span class="builtintype" id="2805624">string</span><span class="op" id="2805630">(</span><span class="ident" id="2805631">data</span><span class="op" id="2805635">)</span><span class="op" id="2805636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805639">return</span><br>
<span class="lineno"></span><span class="op" id="2805646">}</span><br>
<span class="lineno">965</span><br>
<span class="lineno"></span><span class="comment" id="2805649">//&nbsp;Unix&nbsp;returns&nbsp;the&nbsp;local&nbsp;Time&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;given&nbsp;Unix&nbsp;time,</span><br>
<span class="lineno"></span><span class="comment" id="2805718">//&nbsp;sec&nbsp;seconds&nbsp;and&nbsp;nsec&nbsp;nanoseconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2805781">//&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;pass&nbsp;nsec&nbsp;outside&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2805843">func</span>&nbsp;<span class="ident" id="2805848">Unix</span><span class="op" id="2805852">(</span><span class="ident" id="2805853">sec</span>&nbsp;<span class="ident" id="2805857">int64</span><span class="op" id="2805862">,</span>&nbsp;<span class="ident" id="2805864">nsec</span>&nbsp;<span class="ident" id="2805869">int64</span><span class="op" id="2805874">)</span>&nbsp;<span class="ident" id="2805876">Time</span>&nbsp;<span class="op" id="2805881">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805884">if</span>&nbsp;<span class="ident" id="2805887">nsec</span>&nbsp;<span class="op" id="2805892">&lt;</span>&nbsp;<span class="num" id="2805894">0</span>&nbsp;<span class="op" id="2805896">||</span>&nbsp;<span class="ident" id="2805899">nsec</span>&nbsp;<span class="op" id="2805904">&gt;=</span>&nbsp;<span class="num" id="2805907">1e9</span>&nbsp;<span class="op" id="2805911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805915">n</span>&nbsp;<span class="op" id="2805917">:=</span>&nbsp;<span class="ident" id="2805920">nsec</span>&nbsp;<span class="op" id="2805925">/</span>&nbsp;<span class="num" id="2805927">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805933">sec</span>&nbsp;<span class="op" id="2805937">+=</span>&nbsp;<span class="ident" id="2805940">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805944">nsec</span>&nbsp;<span class="op" id="2805949">-=</span>&nbsp;<span class="ident" id="2805952">n</span>&nbsp;<span class="op" id="2805954">*</span>&nbsp;<span class="num" id="2805956">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2805962">if</span>&nbsp;<span class="ident" id="2805965">nsec</span>&nbsp;<span class="op" id="2805970">&lt;</span>&nbsp;<span class="num" id="2805972">0</span>&nbsp;<span class="op" id="2805974">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805979">nsec</span>&nbsp;<span class="op" id="2805984">+=</span>&nbsp;<span class="num" id="2805987">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2805994">sec</span><span class="op" id="2805997">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806008">return</span>&nbsp;<span class="ident" id="2806015">Time</span><span class="op" id="2806019">{</span><span class="ident" id="2806020">sec</span>&nbsp;<span class="op" id="2806024">+</span>&nbsp;<span class="ident" id="2806026">unixToInternal</span><span class="op" id="2806040">,</span>&nbsp;<span class="builtintype" id="2806042">int32</span><span class="op" id="2806047">(</span><span class="ident" id="2806048">nsec</span><span class="op" id="2806052">)</span><span class="op" id="2806053">,</span>&nbsp;<span class="ident" id="2806055">Local</span><span class="op" id="2806060">}</span><br>
<span class="lineno">980</span><span class="op" id="2806062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2806065">func</span>&nbsp;<span class="ident" id="2806070">isLeap</span><span class="op" id="2806076">(</span><span class="ident" id="2806077">year</span>&nbsp;<span class="builtintype" id="2806082">int</span><span class="op" id="2806085">)</span>&nbsp;<span class="builtintype" id="2806087">bool</span>&nbsp;<span class="op" id="2806092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806095">return</span>&nbsp;<span class="ident" id="2806102">year</span><span class="op" id="2806106">%</span><span class="num" id="2806107">4</span>&nbsp;<span class="op" id="2806109">==</span>&nbsp;<span class="num" id="2806112">0</span>&nbsp;<span class="op" id="2806114">&amp;&amp;</span>&nbsp;<span class="op" id="2806117">(</span><span class="ident" id="2806118">year</span><span class="op" id="2806122">%</span><span class="num" id="2806123">100</span>&nbsp;<span class="op" id="2806127">!=</span>&nbsp;<span class="num" id="2806130">0</span>&nbsp;<span class="op" id="2806132">||</span>&nbsp;<span class="ident" id="2806135">year</span><span class="op" id="2806139">%</span><span class="num" id="2806140">400</span>&nbsp;<span class="op" id="2806144">==</span>&nbsp;<span class="num" id="2806147">0</span><span class="op" id="2806148">)</span><br>
<span class="lineno"></span><span class="op" id="2806150">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="2806153">//&nbsp;norm&nbsp;returns&nbsp;nhi,&nbsp;nlo&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2806188">//&nbsp;&nbsp;&nbsp;&nbsp;hi&nbsp;*&nbsp;base&nbsp;+&nbsp;lo&nbsp;==&nbsp;nhi&nbsp;*&nbsp;base&nbsp;+&nbsp;nlo</span><br>
<span class="lineno"></span><span class="comment" id="2806226">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&lt;=&nbsp;nlo&nbsp;&lt;&nbsp;base</span><br>
<span class="lineno"></span><span class="keyword" id="2806245">func</span>&nbsp;<span class="ident" id="2806250">norm</span><span class="op" id="2806254">(</span><span class="ident" id="2806255">hi</span><span class="op" id="2806257">,</span>&nbsp;<span class="ident" id="2806259">lo</span><span class="op" id="2806261">,</span>&nbsp;<span class="ident" id="2806263">base</span>&nbsp;<span class="builtintype" id="2806268">int</span><span class="op" id="2806271">)</span>&nbsp;<span class="op" id="2806273">(</span><span class="ident" id="2806274">nhi</span><span class="op" id="2806277">,</span>&nbsp;<span class="ident" id="2806279">nlo</span>&nbsp;<span class="builtintype" id="2806283">int</span><span class="op" id="2806286">)</span>&nbsp;<span class="op" id="2806288">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806291">if</span>&nbsp;<span class="ident" id="2806294">lo</span>&nbsp;<span class="op" id="2806297">&lt;</span>&nbsp;<span class="num" id="2806299">0</span>&nbsp;<span class="op" id="2806301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806305">n</span>&nbsp;<span class="op" id="2806307">:=</span>&nbsp;<span class="op" id="2806310">(</span><span class="op" id="2806311">-</span><span class="ident" id="2806312">lo</span><span class="op" id="2806314">-</span><span class="num" id="2806315">1</span><span class="op" id="2806316">)</span><span class="op" id="2806317">/</span><span class="ident" id="2806318">base</span>&nbsp;<span class="op" id="2806323">+</span>&nbsp;<span class="num" id="2806325">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806329">hi</span>&nbsp;<span class="op" id="2806332">-=</span>&nbsp;<span class="ident" id="2806335">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806339">lo</span>&nbsp;<span class="op" id="2806342">+=</span>&nbsp;<span class="ident" id="2806345">n</span>&nbsp;<span class="op" id="2806347">*</span>&nbsp;<span class="ident" id="2806349">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806355">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806358">if</span>&nbsp;<span class="ident" id="2806361">lo</span>&nbsp;<span class="op" id="2806364">&gt;=</span>&nbsp;<span class="ident" id="2806367">base</span>&nbsp;<span class="op" id="2806372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806376">n</span>&nbsp;<span class="op" id="2806378">:=</span>&nbsp;<span class="ident" id="2806381">lo</span>&nbsp;<span class="op" id="2806384">/</span>&nbsp;<span class="ident" id="2806386">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806393">hi</span>&nbsp;<span class="op" id="2806396">+=</span>&nbsp;<span class="ident" id="2806399">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2806403">lo</span>&nbsp;<span class="op" id="2806406">-=</span>&nbsp;<span class="ident" id="2806409">n</span>&nbsp;<span class="op" id="2806411">*</span>&nbsp;<span class="ident" id="2806413">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2806419">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2806422">return</span>&nbsp;<span class="ident" id="2806429">hi</span><span class="op" id="2806431">,</span>&nbsp;<span class="ident" id="2806433">lo</span><br>
<span class="lineno"></span><span class="op" id="2806436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2806439">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;Time&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2806481">//&nbsp;&nbsp;&nbsp;&nbsp;yyyy-mm-dd&nbsp;hh:mm:ss&nbsp;+&nbsp;nsec&nbsp;nanoseconds</span><br>
<span class="lineno">1005</span><span class="comment" id="2806523">//&nbsp;in&nbsp;the&nbsp;appropriate&nbsp;zone&nbsp;for&nbsp;that&nbsp;time&nbsp;in&nbsp;the&nbsp;given&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="2806587">//</span><br>
<span class="lineno"></span><span class="comment" id="2806590">//&nbsp;The&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;min,&nbsp;sec,&nbsp;and&nbsp;nsec&nbsp;values&nbsp;may&nbsp;be&nbsp;outside</span><br>
<span class="lineno"></span><span class="comment" id="2806656">//&nbsp;their&nbsp;usual&nbsp;ranges&nbsp;and&nbsp;will&nbsp;be&nbsp;normalized&nbsp;during&nbsp;the&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2806724">//&nbsp;For&nbsp;example,&nbsp;October&nbsp;32&nbsp;converts&nbsp;to&nbsp;November&nbsp;1.</span><br>
<span class="lineno">1010</span><span class="comment" id="2806775">//</span><br>
<span class="lineno"></span><span class="comment" id="2806778">//&nbsp;A&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;transition&nbsp;skips&nbsp;or&nbsp;repeats&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2806840">//&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;United&nbsp;States,&nbsp;March&nbsp;13,&nbsp;2011&nbsp;2:15am&nbsp;never&nbsp;occurred,</span><br>
<span class="lineno"></span><span class="comment" id="2806916">//&nbsp;while&nbsp;November&nbsp;6,&nbsp;2011&nbsp;1:15am&nbsp;occurred&nbsp;twice.&nbsp;&nbsp;In&nbsp;such&nbsp;cases,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2806985">//&nbsp;choice&nbsp;of&nbsp;time&nbsp;zone,&nbsp;and&nbsp;therefore&nbsp;the&nbsp;time,&nbsp;is&nbsp;not&nbsp;well-defined.</span><br>
<span class="lineno">1015</span><span class="comment" id="2807054">//&nbsp;Date&nbsp;returns&nbsp;a&nbsp;time&nbsp;that&nbsp;is&nbsp;correct&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;zones&nbsp;involved</span><br>
<span class="lineno"></span><span class="comment" id="2807126">//&nbsp;in&nbsp;the&nbsp;transition,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;guarantee&nbsp;which.</span><br>
<span class="lineno"></span><span class="comment" id="2807181">//</span><br>
<span class="lineno"></span><span class="comment" id="2807184">//&nbsp;Date&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2807214">func</span>&nbsp;<span class="ident" id="2807219">Date</span><span class="op" id="2807223">(</span><span class="ident" id="2807224">year</span>&nbsp;<span class="builtintype" id="2807229">int</span><span class="op" id="2807232">,</span>&nbsp;<span class="ident" id="2807234">month</span>&nbsp;<span class="ident" id="2807240">Month</span><span class="op" id="2807245">,</span>&nbsp;<span class="ident" id="2807247">day</span><span class="op" id="2807250">,</span>&nbsp;<span class="ident" id="2807252">hour</span><span class="op" id="2807256">,</span>&nbsp;<span class="ident" id="2807258">min</span><span class="op" id="2807261">,</span>&nbsp;<span class="ident" id="2807263">sec</span><span class="op" id="2807266">,</span>&nbsp;<span class="ident" id="2807268">nsec</span>&nbsp;<span class="builtintype" id="2807273">int</span><span class="op" id="2807276">,</span>&nbsp;<span class="ident" id="2807278">loc</span>&nbsp;<span class="op" id="2807282">*</span><span class="ident" id="2807283">Location</span><span class="op" id="2807291">)</span>&nbsp;<span class="ident" id="2807293">Time</span>&nbsp;<span class="op" id="2807298">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2807301">if</span>&nbsp;<span class="ident" id="2807304">loc</span>&nbsp;<span class="op" id="2807308">==</span>&nbsp;<span class="ident" id="2807311">nil</span>&nbsp;<span class="op" id="2807315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2807319">panic</span><span class="op" id="2807324">(</span><span class="string" id="2807325">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Date&#34;</span><span class="op" id="2807365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2807368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807372">//&nbsp;Normalize&nbsp;month,&nbsp;overflowing&nbsp;into&nbsp;year.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807416">m</span>&nbsp;<span class="op" id="2807418">:=</span>&nbsp;<span class="builtintype" id="2807421">int</span><span class="op" id="2807424">(</span><span class="ident" id="2807425">month</span><span class="op" id="2807430">)</span>&nbsp;<span class="op" id="2807432">-</span>&nbsp;<span class="num" id="2807434">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807437">year</span><span class="op" id="2807441">,</span>&nbsp;<span class="ident" id="2807443">m</span>&nbsp;<span class="op" id="2807445">=</span>&nbsp;<span class="ident" id="2807447">norm</span><span class="op" id="2807451">(</span><span class="ident" id="2807452">year</span><span class="op" id="2807456">,</span>&nbsp;<span class="ident" id="2807458">m</span><span class="op" id="2807459">,</span>&nbsp;<span class="num" id="2807461">12</span><span class="op" id="2807463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807466">month</span>&nbsp;<span class="op" id="2807472">=</span>&nbsp;<span class="ident" id="2807474">Month</span><span class="op" id="2807479">(</span><span class="ident" id="2807480">m</span><span class="op" id="2807481">)</span>&nbsp;<span class="op" id="2807483">+</span>&nbsp;<span class="num" id="2807485">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807489">//&nbsp;Normalize&nbsp;nsec,&nbsp;sec,&nbsp;min,&nbsp;hour,&nbsp;overflowing&nbsp;into&nbsp;day.</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807547">sec</span><span class="op" id="2807550">,</span>&nbsp;<span class="ident" id="2807552">nsec</span>&nbsp;<span class="op" id="2807557">=</span>&nbsp;<span class="ident" id="2807559">norm</span><span class="op" id="2807563">(</span><span class="ident" id="2807564">sec</span><span class="op" id="2807567">,</span>&nbsp;<span class="ident" id="2807569">nsec</span><span class="op" id="2807573">,</span>&nbsp;<span class="num" id="2807575">1e9</span><span class="op" id="2807578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807581">min</span><span class="op" id="2807584">,</span>&nbsp;<span class="ident" id="2807586">sec</span>&nbsp;<span class="op" id="2807590">=</span>&nbsp;<span class="ident" id="2807592">norm</span><span class="op" id="2807596">(</span><span class="ident" id="2807597">min</span><span class="op" id="2807600">,</span>&nbsp;<span class="ident" id="2807602">sec</span><span class="op" id="2807605">,</span>&nbsp;<span class="num" id="2807607">60</span><span class="op" id="2807609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807612">hour</span><span class="op" id="2807616">,</span>&nbsp;<span class="ident" id="2807618">min</span>&nbsp;<span class="op" id="2807622">=</span>&nbsp;<span class="ident" id="2807624">norm</span><span class="op" id="2807628">(</span><span class="ident" id="2807629">hour</span><span class="op" id="2807633">,</span>&nbsp;<span class="ident" id="2807635">min</span><span class="op" id="2807638">,</span>&nbsp;<span class="num" id="2807640">60</span><span class="op" id="2807642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807645">day</span><span class="op" id="2807648">,</span>&nbsp;<span class="ident" id="2807650">hour</span>&nbsp;<span class="op" id="2807655">=</span>&nbsp;<span class="ident" id="2807657">norm</span><span class="op" id="2807661">(</span><span class="ident" id="2807662">day</span><span class="op" id="2807665">,</span>&nbsp;<span class="ident" id="2807667">hour</span><span class="op" id="2807671">,</span>&nbsp;<span class="num" id="2807673">24</span><span class="op" id="2807675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807679">y</span>&nbsp;<span class="op" id="2807681">:=</span>&nbsp;<span class="ident" id="2807684">uint64</span><span class="op" id="2807690">(</span><span class="ident" id="2807691">int64</span><span class="op" id="2807696">(</span><span class="ident" id="2807697">year</span><span class="op" id="2807701">)</span>&nbsp;<span class="op" id="2807703">-</span>&nbsp;<span class="ident" id="2807705">absoluteZeroYear</span><span class="op" id="2807721">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807725">//&nbsp;Compute&nbsp;days&nbsp;since&nbsp;the&nbsp;absolute&nbsp;epoch.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807769">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;from&nbsp;400-year&nbsp;cycles.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807807">n</span>&nbsp;<span class="op" id="2807809">:=</span>&nbsp;<span class="ident" id="2807812">y</span>&nbsp;<span class="op" id="2807814">/</span>&nbsp;<span class="num" id="2807816">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807821">y</span>&nbsp;<span class="op" id="2807823">-=</span>&nbsp;<span class="num" id="2807826">400</span>&nbsp;<span class="op" id="2807830">*</span>&nbsp;<span class="ident" id="2807832">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807835">d</span>&nbsp;<span class="op" id="2807837">:=</span>&nbsp;<span class="ident" id="2807840">daysPer400Years</span>&nbsp;<span class="op" id="2807856">*</span>&nbsp;<span class="ident" id="2807858">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807862">//&nbsp;Add&nbsp;in&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807890">n</span>&nbsp;<span class="op" id="2807892">=</span>&nbsp;<span class="ident" id="2807894">y</span>&nbsp;<span class="op" id="2807896">/</span>&nbsp;<span class="num" id="2807898">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807903">y</span>&nbsp;<span class="op" id="2807905">-=</span>&nbsp;<span class="num" id="2807908">100</span>&nbsp;<span class="op" id="2807912">*</span>&nbsp;<span class="ident" id="2807914">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807917">d</span>&nbsp;<span class="op" id="2807919">+=</span>&nbsp;<span class="ident" id="2807922">daysPer100Years</span>&nbsp;<span class="op" id="2807938">*</span>&nbsp;<span class="ident" id="2807940">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2807944">//&nbsp;Add&nbsp;in&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807970">n</span>&nbsp;<span class="op" id="2807972">=</span>&nbsp;<span class="ident" id="2807974">y</span>&nbsp;<span class="op" id="2807976">/</span>&nbsp;<span class="num" id="2807978">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807981">y</span>&nbsp;<span class="op" id="2807983">-=</span>&nbsp;<span class="num" id="2807986">4</span>&nbsp;<span class="op" id="2807988">*</span>&nbsp;<span class="ident" id="2807990">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2807993">d</span>&nbsp;<span class="op" id="2807995">+=</span>&nbsp;<span class="ident" id="2807998">daysPer4Years</span>&nbsp;<span class="op" id="2808012">*</span>&nbsp;<span class="ident" id="2808014">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808018">//&nbsp;Add&nbsp;in&nbsp;non-leap&nbsp;years.</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808045">n</span>&nbsp;<span class="op" id="2808047">=</span>&nbsp;<span class="ident" id="2808049">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808052">d</span>&nbsp;<span class="op" id="2808054">+=</span>&nbsp;<span class="num" id="2808057">365</span>&nbsp;<span class="op" id="2808061">*</span>&nbsp;<span class="ident" id="2808063">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808067">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;this&nbsp;month.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808102">d</span>&nbsp;<span class="op" id="2808104">+=</span>&nbsp;<span class="ident" id="2808107">uint64</span><span class="op" id="2808113">(</span><span class="ident" id="2808114">daysBefore</span><span class="op" id="2808124">[</span><span class="ident" id="2808125">month</span><span class="op" id="2808130">-</span><span class="num" id="2808131">1</span><span class="op" id="2808132">]</span><span class="op" id="2808133">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808136">if</span>&nbsp;<span class="ident" id="2808139">isLeap</span><span class="op" id="2808145">(</span><span class="ident" id="2808146">year</span><span class="op" id="2808150">)</span>&nbsp;<span class="op" id="2808152">&amp;&amp;</span>&nbsp;<span class="ident" id="2808155">month</span>&nbsp;<span class="op" id="2808161">&gt;=</span>&nbsp;<span class="ident" id="2808164">March</span>&nbsp;<span class="op" id="2808170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808174">d</span><span class="op" id="2808175">++</span>&nbsp;<span class="comment" id="2808178">//&nbsp;February&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808198">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;today.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808228">d</span>&nbsp;<span class="op" id="2808230">+=</span>&nbsp;<span class="ident" id="2808233">uint64</span><span class="op" id="2808239">(</span><span class="ident" id="2808240">day</span>&nbsp;<span class="op" id="2808244">-</span>&nbsp;<span class="num" id="2808246">1</span><span class="op" id="2808247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808251">//&nbsp;Add&nbsp;in&nbsp;time&nbsp;elapsed&nbsp;today.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808282">abs</span>&nbsp;<span class="op" id="2808286">:=</span>&nbsp;<span class="ident" id="2808289">d</span>&nbsp;<span class="op" id="2808291">*</span>&nbsp;<span class="ident" id="2808293">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808308">abs</span>&nbsp;<span class="op" id="2808312">+=</span>&nbsp;<span class="ident" id="2808315">uint64</span><span class="op" id="2808321">(</span><span class="ident" id="2808322">hour</span><span class="op" id="2808326">*</span><span class="ident" id="2808327">secondsPerHour</span>&nbsp;<span class="op" id="2808342">+</span>&nbsp;<span class="ident" id="2808344">min</span><span class="op" id="2808347">*</span><span class="ident" id="2808348">secondsPerMinute</span>&nbsp;<span class="op" id="2808365">+</span>&nbsp;<span class="ident" id="2808367">sec</span><span class="op" id="2808370">)</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808374">unix</span>&nbsp;<span class="op" id="2808379">:=</span>&nbsp;<span class="ident" id="2808382">int64</span><span class="op" id="2808387">(</span><span class="ident" id="2808388">abs</span><span class="op" id="2808391">)</span>&nbsp;<span class="op" id="2808393">+</span>&nbsp;<span class="op" id="2808395">(</span><span class="ident" id="2808396">absoluteToInternal</span>&nbsp;<span class="op" id="2808415">+</span>&nbsp;<span class="ident" id="2808417">internalToUnix</span><span class="op" id="2808431">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808435">//&nbsp;Look&nbsp;for&nbsp;zone&nbsp;offset&nbsp;for&nbsp;t,&nbsp;so&nbsp;we&nbsp;can&nbsp;adjust&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808492">//&nbsp;The&nbsp;lookup&nbsp;function&nbsp;expects&nbsp;UTC,&nbsp;so&nbsp;we&nbsp;pass&nbsp;t&nbsp;in&nbsp;the</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808549">//&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;too&nbsp;close&nbsp;to&nbsp;a&nbsp;zone&nbsp;transition,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2808610">//&nbsp;and&nbsp;then&nbsp;adjust&nbsp;if&nbsp;it&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808640">_</span><span class="op" id="2808641">,</span>&nbsp;<span class="ident" id="2808643">offset</span><span class="op" id="2808649">,</span>&nbsp;<span class="ident" id="2808651">_</span><span class="op" id="2808652">,</span>&nbsp;<span class="ident" id="2808654">start</span><span class="op" id="2808659">,</span>&nbsp;<span class="ident" id="2808661">end</span>&nbsp;<span class="op" id="2808665">:=</span>&nbsp;<span class="ident" id="2808668">loc</span><span class="op" id="2808671">.</span><span class="ident" id="2808672">lookup</span><span class="op" id="2808678">(</span><span class="ident" id="2808679">unix</span><span class="op" id="2808683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808686">if</span>&nbsp;<span class="ident" id="2808689">offset</span>&nbsp;<span class="op" id="2808696">!=</span>&nbsp;<span class="num" id="2808699">0</span>&nbsp;<span class="op" id="2808701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808705">switch</span>&nbsp;<span class="ident" id="2808712">utc</span>&nbsp;<span class="op" id="2808716">:=</span>&nbsp;<span class="ident" id="2808719">unix</span>&nbsp;<span class="op" id="2808724">-</span>&nbsp;<span class="ident" id="2808726">int64</span><span class="op" id="2808731">(</span><span class="ident" id="2808732">offset</span><span class="op" id="2808738">)</span><span class="op" id="2808739">;</span>&nbsp;<span class="op" id="2808741">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808745">case</span>&nbsp;<span class="ident" id="2808750">utc</span>&nbsp;<span class="op" id="2808754">&lt;</span>&nbsp;<span class="ident" id="2808756">start</span><span class="op" id="2808761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808766">_</span><span class="op" id="2808767">,</span>&nbsp;<span class="ident" id="2808769">offset</span><span class="op" id="2808775">,</span>&nbsp;<span class="ident" id="2808777">_</span><span class="op" id="2808778">,</span>&nbsp;<span class="ident" id="2808780">_</span><span class="op" id="2808781">,</span>&nbsp;<span class="ident" id="2808783">_</span>&nbsp;<span class="op" id="2808785">=</span>&nbsp;<span class="ident" id="2808787">loc</span><span class="op" id="2808790">.</span><span class="ident" id="2808791">lookup</span><span class="op" id="2808797">(</span><span class="ident" id="2808798">start</span>&nbsp;<span class="op" id="2808804">-</span>&nbsp;<span class="num" id="2808806">1</span><span class="op" id="2808807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808811">case</span>&nbsp;<span class="ident" id="2808816">utc</span>&nbsp;<span class="op" id="2808820">&gt;=</span>&nbsp;<span class="ident" id="2808823">end</span><span class="op" id="2808826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808831">_</span><span class="op" id="2808832">,</span>&nbsp;<span class="ident" id="2808834">offset</span><span class="op" id="2808840">,</span>&nbsp;<span class="ident" id="2808842">_</span><span class="op" id="2808843">,</span>&nbsp;<span class="ident" id="2808845">_</span><span class="op" id="2808846">,</span>&nbsp;<span class="ident" id="2808848">_</span>&nbsp;<span class="op" id="2808850">=</span>&nbsp;<span class="ident" id="2808852">loc</span><span class="op" id="2808855">.</span><span class="ident" id="2808856">lookup</span><span class="op" id="2808862">(</span><span class="ident" id="2808863">end</span><span class="op" id="2808866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808870">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2808874">unix</span>&nbsp;<span class="op" id="2808879">-=</span>&nbsp;<span class="ident" id="2808882">int64</span><span class="op" id="2808887">(</span><span class="ident" id="2808888">offset</span><span class="op" id="2808894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2808897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2808901">return</span>&nbsp;<span class="ident" id="2808908">Time</span><span class="op" id="2808912">{</span><span class="ident" id="2808913">unix</span>&nbsp;<span class="op" id="2808918">+</span>&nbsp;<span class="ident" id="2808920">unixToInternal</span><span class="op" id="2808934">,</span>&nbsp;<span class="builtintype" id="2808936">int32</span><span class="op" id="2808941">(</span><span class="ident" id="2808942">nsec</span><span class="op" id="2808946">)</span><span class="op" id="2808947">,</span>&nbsp;<span class="ident" id="2808949">loc</span><span class="op" id="2808952">}</span><br>
<span class="lineno"></span><span class="op" id="2808954">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="2808957">//&nbsp;Truncate&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;down&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2809049">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Truncate&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2809093">func</span>&nbsp;<span class="op" id="2809098">(</span><span class="ident" id="2809099">t</span>&nbsp;<span class="ident" id="2809101">Time</span><span class="op" id="2809105">)</span>&nbsp;<span class="ident" id="2809107">Truncate</span><span class="op" id="2809115">(</span><span class="ident" id="2809116">d</span>&nbsp;<span class="ident" id="2809118">Duration</span><span class="op" id="2809126">)</span>&nbsp;<span class="ident" id="2809128">Time</span>&nbsp;<span class="op" id="2809133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809136">if</span>&nbsp;<span class="ident" id="2809139">d</span>&nbsp;<span class="op" id="2809141">&lt;=</span>&nbsp;<span class="num" id="2809144">0</span>&nbsp;<span class="op" id="2809146">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809150">return</span>&nbsp;<span class="ident" id="2809157">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2809160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809163">_</span><span class="op" id="2809164">,</span>&nbsp;<span class="ident" id="2809166">r</span>&nbsp;<span class="op" id="2809168">:=</span>&nbsp;<span class="ident" id="2809171">div</span><span class="op" id="2809174">(</span><span class="ident" id="2809175">t</span><span class="op" id="2809176">,</span>&nbsp;<span class="ident" id="2809178">d</span><span class="op" id="2809179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809182">return</span>&nbsp;<span class="ident" id="2809189">t</span><span class="op" id="2809190">.</span><span class="ident" id="2809191">Add</span><span class="op" id="2809194">(</span><span class="op" id="2809195">-</span><span class="ident" id="2809196">r</span><span class="op" id="2809197">)</span><br>
<span class="lineno"></span><span class="op" id="2809199">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="comment" id="2809202">//&nbsp;Round&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2809296">//&nbsp;The&nbsp;rounding&nbsp;behavior&nbsp;for&nbsp;halfway&nbsp;values&nbsp;is&nbsp;to&nbsp;round&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="2809356">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Round&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2809397">func</span>&nbsp;<span class="op" id="2809402">(</span><span class="ident" id="2809403">t</span>&nbsp;<span class="ident" id="2809405">Time</span><span class="op" id="2809409">)</span>&nbsp;<span class="ident" id="2809411">Round</span><span class="op" id="2809416">(</span><span class="ident" id="2809417">d</span>&nbsp;<span class="ident" id="2809419">Duration</span><span class="op" id="2809427">)</span>&nbsp;<span class="ident" id="2809429">Time</span>&nbsp;<span class="op" id="2809434">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809437">if</span>&nbsp;<span class="ident" id="2809440">d</span>&nbsp;<span class="op" id="2809442">&lt;=</span>&nbsp;<span class="num" id="2809445">0</span>&nbsp;<span class="op" id="2809447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809451">return</span>&nbsp;<span class="ident" id="2809458">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2809461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809464">_</span><span class="op" id="2809465">,</span>&nbsp;<span class="ident" id="2809467">r</span>&nbsp;<span class="op" id="2809469">:=</span>&nbsp;<span class="ident" id="2809472">div</span><span class="op" id="2809475">(</span><span class="ident" id="2809476">t</span><span class="op" id="2809477">,</span>&nbsp;<span class="ident" id="2809479">d</span><span class="op" id="2809480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809483">if</span>&nbsp;<span class="ident" id="2809486">r</span><span class="op" id="2809487">+</span><span class="ident" id="2809488">r</span>&nbsp;<span class="op" id="2809490">&lt;</span>&nbsp;<span class="ident" id="2809492">d</span>&nbsp;<span class="op" id="2809494">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809498">return</span>&nbsp;<span class="ident" id="2809505">t</span><span class="op" id="2809506">.</span><span class="ident" id="2809507">Add</span><span class="op" id="2809510">(</span><span class="op" id="2809511">-</span><span class="ident" id="2809512">r</span><span class="op" id="2809513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2809516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809519">return</span>&nbsp;<span class="ident" id="2809526">t</span><span class="op" id="2809527">.</span><span class="ident" id="2809528">Add</span><span class="op" id="2809531">(</span><span class="ident" id="2809532">d</span>&nbsp;<span class="op" id="2809534">-</span>&nbsp;<span class="ident" id="2809536">r</span><span class="op" id="2809537">)</span><br>
<span class="lineno"></span><span class="op" id="2809539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2809542">//&nbsp;div&nbsp;divides&nbsp;t&nbsp;by&nbsp;d&nbsp;and&nbsp;returns&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;and&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2809611">//&nbsp;We&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;anymore&nbsp;(round&nbsp;half&nbsp;up&nbsp;instead&nbsp;of&nbsp;round&nbsp;to&nbsp;even)</span><br>
<span class="lineno"></span><span class="comment" id="2809696">//&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;here&nbsp;in&nbsp;case&nbsp;we&nbsp;change&nbsp;our&nbsp;minds.</span><br>
<span class="lineno"></span><span class="keyword" id="2809748">func</span>&nbsp;<span class="ident" id="2809753">div</span><span class="op" id="2809756">(</span><span class="ident" id="2809757">t</span>&nbsp;<span class="ident" id="2809759">Time</span><span class="op" id="2809763">,</span>&nbsp;<span class="ident" id="2809765">d</span>&nbsp;<span class="ident" id="2809767">Duration</span><span class="op" id="2809775">)</span>&nbsp;<span class="op" id="2809777">(</span><span class="ident" id="2809778">qmod2</span>&nbsp;<span class="builtintype" id="2809784">int</span><span class="op" id="2809787">,</span>&nbsp;<span class="ident" id="2809789">r</span>&nbsp;<span class="ident" id="2809791">Duration</span><span class="op" id="2809799">)</span>&nbsp;<span class="op" id="2809801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809804">neg</span>&nbsp;<span class="op" id="2809808">:=</span>&nbsp;<span class="builtintype" id="2809811">false</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809818">nsec</span>&nbsp;<span class="op" id="2809823">:=</span>&nbsp;<span class="builtintype" id="2809826">int32</span><span class="op" id="2809831">(</span><span class="ident" id="2809832">t</span><span class="op" id="2809833">.</span><span class="ident" id="2809834">nsec</span><span class="op" id="2809838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809841">if</span>&nbsp;<span class="ident" id="2809844">t</span><span class="op" id="2809845">.</span><span class="ident" id="2809846">sec</span>&nbsp;<span class="op" id="2809850">&lt;</span>&nbsp;<span class="num" id="2809852">0</span>&nbsp;<span class="op" id="2809854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2809858">//&nbsp;Operate&nbsp;on&nbsp;absolute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809890">neg</span>&nbsp;<span class="op" id="2809894">=</span>&nbsp;<span class="builtintype" id="2809896">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809903">t</span><span class="op" id="2809904">.</span><span class="ident" id="2809905">sec</span>&nbsp;<span class="op" id="2809909">=</span>&nbsp;<span class="op" id="2809911">-</span><span class="ident" id="2809912">t</span><span class="op" id="2809913">.</span><span class="ident" id="2809914">sec</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809920">nsec</span>&nbsp;<span class="op" id="2809925">=</span>&nbsp;<span class="op" id="2809927">-</span><span class="ident" id="2809928">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2809935">if</span>&nbsp;<span class="ident" id="2809938">nsec</span>&nbsp;<span class="op" id="2809943">&lt;</span>&nbsp;<span class="num" id="2809945">0</span>&nbsp;<span class="op" id="2809947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809952">nsec</span>&nbsp;<span class="op" id="2809957">+=</span>&nbsp;<span class="num" id="2809960">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2809967">t</span><span class="op" id="2809968">.</span><span class="ident" id="2809969">sec</span><span class="op" id="2809972">--</span>&nbsp;<span class="comment" id="2809975">//&nbsp;t.sec&nbsp;&gt;=&nbsp;1&nbsp;before&nbsp;the&nbsp;--&nbsp;so&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810013">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810020">switch</span>&nbsp;<span class="op" id="2810027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810030">//&nbsp;Special&nbsp;case:&nbsp;2d&nbsp;divides&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810069">case</span>&nbsp;<span class="ident" id="2810074">d</span>&nbsp;<span class="op" id="2810076">&lt;</span>&nbsp;<span class="ident" id="2810078">Second</span>&nbsp;<span class="op" id="2810085">&amp;&amp;</span>&nbsp;<span class="ident" id="2810088">Second</span><span class="op" id="2810094">%</span><span class="op" id="2810095">(</span><span class="ident" id="2810096">d</span><span class="op" id="2810097">+</span><span class="ident" id="2810098">d</span><span class="op" id="2810099">)</span>&nbsp;<span class="op" id="2810101">==</span>&nbsp;<span class="num" id="2810104">0</span><span class="op" id="2810105">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810109">qmod2</span>&nbsp;<span class="op" id="2810115">=</span>&nbsp;<span class="builtintype" id="2810117">int</span><span class="op" id="2810120">(</span><span class="ident" id="2810121">nsec</span><span class="op" id="2810125">/</span><span class="builtintype" id="2810126">int32</span><span class="op" id="2810131">(</span><span class="ident" id="2810132">d</span><span class="op" id="2810133">)</span><span class="op" id="2810134">)</span>&nbsp;<span class="op" id="2810136">&amp;</span>&nbsp;<span class="num" id="2810138">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810142">r</span>&nbsp;<span class="op" id="2810144">=</span>&nbsp;<span class="ident" id="2810146">Duration</span><span class="op" id="2810154">(</span><span class="ident" id="2810155">nsec</span>&nbsp;<span class="op" id="2810160">%</span>&nbsp;<span class="builtintype" id="2810162">int32</span><span class="op" id="2810167">(</span><span class="ident" id="2810168">d</span><span class="op" id="2810169">)</span><span class="op" id="2810170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810174">//&nbsp;Special&nbsp;case:&nbsp;d&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810221">case</span>&nbsp;<span class="ident" id="2810226">d</span><span class="op" id="2810227">%</span><span class="ident" id="2810228">Second</span>&nbsp;<span class="op" id="2810235">==</span>&nbsp;<span class="num" id="2810238">0</span><span class="op" id="2810239">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810243">d1</span>&nbsp;<span class="op" id="2810246">:=</span>&nbsp;<span class="ident" id="2810249">int64</span><span class="op" id="2810254">(</span><span class="ident" id="2810255">d</span>&nbsp;<span class="op" id="2810257">/</span>&nbsp;<span class="ident" id="2810259">Second</span><span class="op" id="2810265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810269">qmod2</span>&nbsp;<span class="op" id="2810275">=</span>&nbsp;<span class="builtintype" id="2810277">int</span><span class="op" id="2810280">(</span><span class="ident" id="2810281">t</span><span class="op" id="2810282">.</span><span class="ident" id="2810283">sec</span><span class="op" id="2810286">/</span><span class="ident" id="2810287">d1</span><span class="op" id="2810289">)</span>&nbsp;<span class="op" id="2810291">&amp;</span>&nbsp;<span class="num" id="2810293">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810297">r</span>&nbsp;<span class="op" id="2810299">=</span>&nbsp;<span class="ident" id="2810301">Duration</span><span class="op" id="2810309">(</span><span class="ident" id="2810310">t</span><span class="op" id="2810311">.</span><span class="ident" id="2810312">sec</span><span class="op" id="2810315">%</span><span class="ident" id="2810316">d1</span><span class="op" id="2810318">)</span><span class="op" id="2810319">*</span><span class="ident" id="2810320">Second</span>&nbsp;<span class="op" id="2810327">+</span>&nbsp;<span class="ident" id="2810329">Duration</span><span class="op" id="2810337">(</span><span class="ident" id="2810338">nsec</span><span class="op" id="2810342">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810346">//&nbsp;General&nbsp;case.</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810364">//&nbsp;This&nbsp;could&nbsp;be&nbsp;faster&nbsp;if&nbsp;more&nbsp;cleverness&nbsp;were&nbsp;applied,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810422">//&nbsp;but&nbsp;it&#39;s&nbsp;really&nbsp;only&nbsp;here&nbsp;to&nbsp;avoid&nbsp;special&nbsp;case&nbsp;restrictions&nbsp;in&nbsp;the&nbsp;API.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810499">//&nbsp;No&nbsp;one&nbsp;will&nbsp;care&nbsp;about&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810539">default</span><span class="op" id="2810546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810550">//&nbsp;Compute&nbsp;nanoseconds&nbsp;as&nbsp;128-bit&nbsp;number.</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810594">sec</span>&nbsp;<span class="op" id="2810598">:=</span>&nbsp;<span class="ident" id="2810601">uint64</span><span class="op" id="2810607">(</span><span class="ident" id="2810608">t</span><span class="op" id="2810609">.</span><span class="ident" id="2810610">sec</span><span class="op" id="2810613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810617">tmp</span>&nbsp;<span class="op" id="2810621">:=</span>&nbsp;<span class="op" id="2810624">(</span><span class="ident" id="2810625">sec</span>&nbsp;<span class="op" id="2810629">&gt;&gt;</span>&nbsp;<span class="num" id="2810632">32</span><span class="op" id="2810634">)</span>&nbsp;<span class="op" id="2810636">*</span>&nbsp;<span class="num" id="2810638">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810644">u1</span>&nbsp;<span class="op" id="2810647">:=</span>&nbsp;<span class="ident" id="2810650">tmp</span>&nbsp;<span class="op" id="2810654">&gt;&gt;</span>&nbsp;<span class="num" id="2810657">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810662">u0</span>&nbsp;<span class="op" id="2810665">:=</span>&nbsp;<span class="ident" id="2810668">tmp</span>&nbsp;<span class="op" id="2810672">&lt;&lt;</span>&nbsp;<span class="num" id="2810675">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810680">tmp</span>&nbsp;<span class="op" id="2810684">=</span>&nbsp;<span class="ident" id="2810686">uint64</span><span class="op" id="2810692">(</span><span class="ident" id="2810693">sec</span><span class="op" id="2810696">&amp;</span><span class="num" id="2810697">0xFFFFFFFF</span><span class="op" id="2810707">)</span>&nbsp;<span class="op" id="2810709">*</span>&nbsp;<span class="num" id="2810711">1e9</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810717">u0x</span><span class="op" id="2810720">,</span>&nbsp;<span class="ident" id="2810722">u0</span>&nbsp;<span class="op" id="2810725">:=</span>&nbsp;<span class="ident" id="2810728">u0</span><span class="op" id="2810730">,</span>&nbsp;<span class="ident" id="2810732">u0</span><span class="op" id="2810734">+</span><span class="ident" id="2810735">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810741">if</span>&nbsp;<span class="ident" id="2810744">u0</span>&nbsp;<span class="op" id="2810747">&lt;</span>&nbsp;<span class="ident" id="2810749">u0x</span>&nbsp;<span class="op" id="2810753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810758">u1</span><span class="op" id="2810760">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810769">u0x</span><span class="op" id="2810772">,</span>&nbsp;<span class="ident" id="2810774">u0</span>&nbsp;<span class="op" id="2810777">=</span>&nbsp;<span class="ident" id="2810779">u0</span><span class="op" id="2810781">,</span>&nbsp;<span class="ident" id="2810783">u0</span><span class="op" id="2810785">+</span><span class="ident" id="2810786">uint64</span><span class="op" id="2810792">(</span><span class="ident" id="2810793">nsec</span><span class="op" id="2810797">)</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810801">if</span>&nbsp;<span class="ident" id="2810804">u0</span>&nbsp;<span class="op" id="2810807">&lt;</span>&nbsp;<span class="ident" id="2810809">u0x</span>&nbsp;<span class="op" id="2810813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810818">u1</span><span class="op" id="2810820">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2810825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810830">//&nbsp;Compute&nbsp;remainder&nbsp;by&nbsp;subtracting&nbsp;r&lt;&lt;k&nbsp;for&nbsp;decreasing&nbsp;k.</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2810891">//&nbsp;Quotient&nbsp;parity&nbsp;is&nbsp;whether&nbsp;we&nbsp;subtract&nbsp;on&nbsp;last&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810950">d1</span>&nbsp;<span class="op" id="2810953">:=</span>&nbsp;<span class="ident" id="2810956">uint64</span><span class="op" id="2810962">(</span><span class="ident" id="2810963">d</span><span class="op" id="2810964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2810968">for</span>&nbsp;<span class="ident" id="2810972">d1</span><span class="op" id="2810974">&gt;&gt;</span><span class="num" id="2810976">63</span>&nbsp;<span class="op" id="2810979">!=</span>&nbsp;<span class="num" id="2810982">1</span>&nbsp;<span class="op" id="2810984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2810989">d1</span>&nbsp;<span class="op" id="2810992">&lt;&lt;=</span>&nbsp;<span class="num" id="2810996">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811000">}</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811004">d0</span>&nbsp;<span class="op" id="2811007">:=</span>&nbsp;<span class="ident" id="2811010">uint64</span><span class="op" id="2811016">(</span><span class="num" id="2811017">0</span><span class="op" id="2811018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811022">for</span>&nbsp;<span class="op" id="2811026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811031">qmod2</span>&nbsp;<span class="op" id="2811037">=</span>&nbsp;<span class="num" id="2811039">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811044">if</span>&nbsp;<span class="ident" id="2811047">u1</span>&nbsp;<span class="op" id="2811050">&gt;</span>&nbsp;<span class="ident" id="2811052">d1</span>&nbsp;<span class="op" id="2811055">||</span>&nbsp;<span class="ident" id="2811058">u1</span>&nbsp;<span class="op" id="2811061">==</span>&nbsp;<span class="ident" id="2811064">d1</span>&nbsp;<span class="op" id="2811067">&amp;&amp;</span>&nbsp;<span class="ident" id="2811070">u0</span>&nbsp;<span class="op" id="2811073">&gt;=</span>&nbsp;<span class="ident" id="2811076">d0</span>&nbsp;<span class="op" id="2811079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811085">//&nbsp;subtract</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811101">qmod2</span>&nbsp;<span class="op" id="2811107">=</span>&nbsp;<span class="num" id="2811109">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811115">u0x</span><span class="op" id="2811118">,</span>&nbsp;<span class="ident" id="2811120">u0</span>&nbsp;<span class="op" id="2811123">=</span>&nbsp;<span class="ident" id="2811125">u0</span><span class="op" id="2811127">,</span>&nbsp;<span class="ident" id="2811129">u0</span><span class="op" id="2811131">-</span><span class="ident" id="2811132">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811139">if</span>&nbsp;<span class="ident" id="2811142">u0</span>&nbsp;<span class="op" id="2811145">&gt;</span>&nbsp;<span class="ident" id="2811147">u0x</span>&nbsp;<span class="op" id="2811151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811158">u1</span><span class="op" id="2811160">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811167">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811173">u1</span>&nbsp;<span class="op" id="2811176">-=</span>&nbsp;<span class="ident" id="2811179">d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811190">if</span>&nbsp;<span class="ident" id="2811193">d1</span>&nbsp;<span class="op" id="2811196">==</span>&nbsp;<span class="num" id="2811199">0</span>&nbsp;<span class="op" id="2811201">&amp;&amp;</span>&nbsp;<span class="ident" id="2811204">d0</span>&nbsp;<span class="op" id="2811207">==</span>&nbsp;<span class="ident" id="2811210">uint64</span><span class="op" id="2811216">(</span><span class="ident" id="2811217">d</span><span class="op" id="2811218">)</span>&nbsp;<span class="op" id="2811220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811226">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811235">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811240">d0</span>&nbsp;<span class="op" id="2811243">&gt;&gt;=</span>&nbsp;<span class="num" id="2811247">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811252">d0</span>&nbsp;<span class="op" id="2811255">|=</span>&nbsp;<span class="op" id="2811258">(</span><span class="ident" id="2811259">d1</span>&nbsp;<span class="op" id="2811262">&amp;</span>&nbsp;<span class="num" id="2811264">1</span><span class="op" id="2811265">)</span>&nbsp;<span class="op" id="2811267">&lt;&lt;</span>&nbsp;<span class="num" id="2811270">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811276">d1</span>&nbsp;<span class="op" id="2811279">&gt;&gt;=</span>&nbsp;<span class="num" id="2811283">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811291">r</span>&nbsp;<span class="op" id="2811293">=</span>&nbsp;<span class="ident" id="2811295">Duration</span><span class="op" id="2811303">(</span><span class="ident" id="2811304">u0</span><span class="op" id="2811306">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811313">if</span>&nbsp;<span class="ident" id="2811316">neg</span>&nbsp;<span class="op" id="2811320">&amp;&amp;</span>&nbsp;<span class="ident" id="2811323">r</span>&nbsp;<span class="op" id="2811325">!=</span>&nbsp;<span class="num" id="2811328">0</span>&nbsp;<span class="op" id="2811330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811334">//&nbsp;If&nbsp;input&nbsp;was&nbsp;negative&nbsp;and&nbsp;not&nbsp;an&nbsp;exact&nbsp;multiple&nbsp;of&nbsp;d,&nbsp;we&nbsp;computed&nbsp;q,&nbsp;r&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811420">//&nbsp;&nbsp;&nbsp;&nbsp;q*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811438">//&nbsp;But&nbsp;the&nbsp;right&nbsp;answers&nbsp;are&nbsp;given&nbsp;by&nbsp;-(q-1),&nbsp;d-r:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811491">//&nbsp;&nbsp;&nbsp;&nbsp;q*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811509">//&nbsp;&nbsp;&nbsp;&nbsp;-q*d&nbsp;-&nbsp;r&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2811527">//&nbsp;&nbsp;&nbsp;&nbsp;-(q-1)*d&nbsp;+&nbsp;(d&nbsp;-&nbsp;r)&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811555">qmod2</span>&nbsp;<span class="op" id="2811561">^=</span>&nbsp;<span class="num" id="2811564">1</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2811568">r</span>&nbsp;<span class="op" id="2811570">=</span>&nbsp;<span class="ident" id="2811572">d</span>&nbsp;<span class="op" id="2811574">-</span>&nbsp;<span class="ident" id="2811576">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2811579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2811582">return</span><br>
<span class="lineno"></span><span class="op" id="2811589">}</span>
</div>
</body>
</html>
