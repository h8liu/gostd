<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html" class="current">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4170872">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4170928">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4170982">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4171033">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4171106">package</span>&nbsp;<span class="ident" id="4171114">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4171119">import</span>&nbsp;<span class="op" id="4171126">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4171129">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4171135">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4171145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4171148">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="4171167">func</span>&nbsp;<span class="ident" id="4171172">boolint</span><span class="op" id="4171179">(</span><span class="ident" id="4171180">b</span>&nbsp;<span class="builtintype" id="4171182">bool</span><span class="op" id="4171186">)</span>&nbsp;<span class="builtintype" id="4171188">int</span>&nbsp;<span class="op" id="4171192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171195">if</span>&nbsp;<span class="ident" id="4171198">b</span>&nbsp;<span class="op" id="4171200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171204">return</span>&nbsp;<span class="num" id="4171211">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171217">return</span>&nbsp;<span class="num" id="4171224">0</span><br>
<span class="lineno">20</span><span class="op" id="4171226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4171229">func</span>&nbsp;<span class="ident" id="4171234">ipv4AddrToInterface</span><span class="op" id="4171253">(</span><span class="ident" id="4171254">ip</span>&nbsp;<span class="ident" id="4171257">IP</span><span class="op" id="4171259">)</span>&nbsp;<span class="op" id="4171261">(</span><span class="op" id="4171262">*</span><span class="ident" id="4171263">Interface</span><span class="op" id="4171272">,</span>&nbsp;<span class="builtintype" id="4171274">error</span><span class="op" id="4171279">)</span>&nbsp;<span class="op" id="4171281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171284">ift</span><span class="op" id="4171287">,</span>&nbsp;<span class="ident" id="4171289">err</span>&nbsp;<span class="op" id="4171293">:=</span>&nbsp;<span class="ident" id="4171296">Interfaces</span><span class="op" id="4171306">(</span><span class="op" id="4171307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171310">if</span>&nbsp;<span class="ident" id="4171313">err</span>&nbsp;<span class="op" id="4171317">!=</span>&nbsp;<span class="ident" id="4171320">nil</span>&nbsp;<span class="op" id="4171324">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171328">return</span>&nbsp;<span class="ident" id="4171335">nil</span><span class="op" id="4171338">,</span>&nbsp;<span class="ident" id="4171340">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171348">for</span>&nbsp;<span class="ident" id="4171352">_</span><span class="op" id="4171353">,</span>&nbsp;<span class="ident" id="4171355">ifi</span>&nbsp;<span class="op" id="4171359">:=</span>&nbsp;<span class="keyword" id="4171362">range</span>&nbsp;<span class="ident" id="4171368">ift</span>&nbsp;<span class="op" id="4171372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171376">ifat</span><span class="op" id="4171380">,</span>&nbsp;<span class="ident" id="4171382">err</span>&nbsp;<span class="op" id="4171386">:=</span>&nbsp;<span class="ident" id="4171389">ifi</span><span class="op" id="4171392">.</span><span class="ident" id="4171393">Addrs</span><span class="op" id="4171398">(</span><span class="op" id="4171399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171403">if</span>&nbsp;<span class="ident" id="4171406">err</span>&nbsp;<span class="op" id="4171410">!=</span>&nbsp;<span class="ident" id="4171413">nil</span>&nbsp;<span class="op" id="4171417">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171422">return</span>&nbsp;<span class="ident" id="4171429">nil</span><span class="op" id="4171432">,</span>&nbsp;<span class="ident" id="4171434">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171444">for</span>&nbsp;<span class="ident" id="4171448">_</span><span class="op" id="4171449">,</span>&nbsp;<span class="ident" id="4171451">ifa</span>&nbsp;<span class="op" id="4171455">:=</span>&nbsp;<span class="keyword" id="4171458">range</span>&nbsp;<span class="ident" id="4171464">ifat</span>&nbsp;<span class="op" id="4171469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171474">switch</span>&nbsp;<span class="ident" id="4171481">v</span>&nbsp;<span class="op" id="4171483">:=</span>&nbsp;<span class="ident" id="4171486">ifa</span><span class="op" id="4171489">.</span><span class="op" id="4171490">(</span><span class="keyword" id="4171491">type</span><span class="op" id="4171495">)</span>&nbsp;<span class="op" id="4171497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171502">case</span>&nbsp;<span class="op" id="4171507">*</span><span class="ident" id="4171508">IPAddr</span><span class="op" id="4171514">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171520">if</span>&nbsp;<span class="ident" id="4171523">ip</span><span class="op" id="4171525">.</span><span class="ident" id="4171526">Equal</span><span class="op" id="4171531">(</span><span class="ident" id="4171532">v</span><span class="op" id="4171533">.</span><span class="ident" id="4171534">IP</span><span class="op" id="4171536">)</span>&nbsp;<span class="op" id="4171538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171545">return</span>&nbsp;<span class="op" id="4171552">&amp;</span><span class="ident" id="4171553">ifi</span><span class="op" id="4171556">,</span>&nbsp;<span class="ident" id="4171558">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171571">case</span>&nbsp;<span class="op" id="4171576">*</span><span class="ident" id="4171577">IPNet</span><span class="op" id="4171582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171588">if</span>&nbsp;<span class="ident" id="4171591">ip</span><span class="op" id="4171593">.</span><span class="ident" id="4171594">Equal</span><span class="op" id="4171599">(</span><span class="ident" id="4171600">v</span><span class="op" id="4171601">.</span><span class="ident" id="4171602">IP</span><span class="op" id="4171604">)</span>&nbsp;<span class="op" id="4171606">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171613">return</span>&nbsp;<span class="op" id="4171620">&amp;</span><span class="ident" id="4171621">ifi</span><span class="op" id="4171624">,</span>&nbsp;<span class="ident" id="4171626">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171646">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171649">if</span>&nbsp;<span class="ident" id="4171652">ip</span><span class="op" id="4171654">.</span><span class="ident" id="4171655">Equal</span><span class="op" id="4171660">(</span><span class="ident" id="4171661">IPv4zero</span><span class="op" id="4171669">)</span>&nbsp;<span class="op" id="4171671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171675">return</span>&nbsp;<span class="ident" id="4171682">nil</span><span class="op" id="4171685">,</span>&nbsp;<span class="ident" id="4171687">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171695">return</span>&nbsp;<span class="ident" id="4171702">nil</span><span class="op" id="4171705">,</span>&nbsp;<span class="ident" id="4171707">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="4171726">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="4171729">func</span>&nbsp;<span class="ident" id="4171734">interfaceToIPv4Addr</span><span class="op" id="4171753">(</span><span class="ident" id="4171754">ifi</span>&nbsp;<span class="op" id="4171758">*</span><span class="ident" id="4171759">Interface</span><span class="op" id="4171768">)</span>&nbsp;<span class="op" id="4171770">(</span><span class="ident" id="4171771">IP</span><span class="op" id="4171773">,</span>&nbsp;<span class="builtintype" id="4171775">error</span><span class="op" id="4171780">)</span>&nbsp;<span class="op" id="4171782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171785">if</span>&nbsp;<span class="ident" id="4171788">ifi</span>&nbsp;<span class="op" id="4171792">==</span>&nbsp;<span class="ident" id="4171795">nil</span>&nbsp;<span class="op" id="4171799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171803">return</span>&nbsp;<span class="ident" id="4171810">IPv4zero</span><span class="op" id="4171818">,</span>&nbsp;<span class="ident" id="4171820">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171825">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171828">ifat</span><span class="op" id="4171832">,</span>&nbsp;<span class="ident" id="4171834">err</span>&nbsp;<span class="op" id="4171838">:=</span>&nbsp;<span class="ident" id="4171841">ifi</span><span class="op" id="4171844">.</span><span class="ident" id="4171845">Addrs</span><span class="op" id="4171850">(</span><span class="op" id="4171851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171854">if</span>&nbsp;<span class="ident" id="4171857">err</span>&nbsp;<span class="op" id="4171861">!=</span>&nbsp;<span class="ident" id="4171864">nil</span>&nbsp;<span class="op" id="4171868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171872">return</span>&nbsp;<span class="ident" id="4171879">nil</span><span class="op" id="4171882">,</span>&nbsp;<span class="ident" id="4171884">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171892">for</span>&nbsp;<span class="ident" id="4171896">_</span><span class="op" id="4171897">,</span>&nbsp;<span class="ident" id="4171899">ifa</span>&nbsp;<span class="op" id="4171903">:=</span>&nbsp;<span class="keyword" id="4171906">range</span>&nbsp;<span class="ident" id="4171912">ifat</span>&nbsp;<span class="op" id="4171917">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171921">switch</span>&nbsp;<span class="ident" id="4171928">v</span>&nbsp;<span class="op" id="4171930">:=</span>&nbsp;<span class="ident" id="4171933">ifa</span><span class="op" id="4171936">.</span><span class="op" id="4171937">(</span><span class="keyword" id="4171938">type</span><span class="op" id="4171942">)</span>&nbsp;<span class="op" id="4171944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171948">case</span>&nbsp;<span class="op" id="4171953">*</span><span class="ident" id="4171954">IPAddr</span><span class="op" id="4171960">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171965">if</span>&nbsp;<span class="ident" id="4171968">v</span><span class="op" id="4171969">.</span><span class="ident" id="4171970">IP</span><span class="op" id="4171972">.</span><span class="ident" id="4171973">To4</span><span class="op" id="4171976">(</span><span class="op" id="4171977">)</span>&nbsp;<span class="op" id="4171979">!=</span>&nbsp;<span class="ident" id="4171982">nil</span>&nbsp;<span class="op" id="4171986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171992">return</span>&nbsp;<span class="ident" id="4171999">v</span><span class="op" id="4172000">.</span><span class="ident" id="4172001">IP</span><span class="op" id="4172003">,</span>&nbsp;<span class="ident" id="4172005">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172012">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172016">case</span>&nbsp;<span class="op" id="4172021">*</span><span class="ident" id="4172022">IPNet</span><span class="op" id="4172027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172032">if</span>&nbsp;<span class="ident" id="4172035">v</span><span class="op" id="4172036">.</span><span class="ident" id="4172037">IP</span><span class="op" id="4172039">.</span><span class="ident" id="4172040">To4</span><span class="op" id="4172043">(</span><span class="op" id="4172044">)</span>&nbsp;<span class="op" id="4172046">!=</span>&nbsp;<span class="ident" id="4172049">nil</span>&nbsp;<span class="op" id="4172053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172059">return</span>&nbsp;<span class="ident" id="4172066">v</span><span class="op" id="4172067">.</span><span class="ident" id="4172068">IP</span><span class="op" id="4172070">,</span>&nbsp;<span class="ident" id="4172072">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172083">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172089">return</span>&nbsp;<span class="ident" id="4172096">nil</span><span class="op" id="4172099">,</span>&nbsp;<span class="ident" id="4172101">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="4172120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4172123">func</span>&nbsp;<span class="ident" id="4172128">setIPv4MreqToInterface</span><span class="op" id="4172150">(</span><span class="ident" id="4172151">mreq</span>&nbsp;<span class="op" id="4172156">*</span><span class="ident" id="4172157">syscall</span><span class="op" id="4172164">.</span><span class="ident" id="4172165">IPMreq</span><span class="op" id="4172171">,</span>&nbsp;<span class="ident" id="4172173">ifi</span>&nbsp;<span class="op" id="4172177">*</span><span class="ident" id="4172178">Interface</span><span class="op" id="4172187">)</span>&nbsp;<span class="builtintype" id="4172189">error</span>&nbsp;<span class="op" id="4172195">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172198">if</span>&nbsp;<span class="ident" id="4172201">ifi</span>&nbsp;<span class="op" id="4172205">==</span>&nbsp;<span class="ident" id="4172208">nil</span>&nbsp;<span class="op" id="4172212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172216">return</span>&nbsp;<span class="ident" id="4172223">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4172231">ifat</span><span class="op" id="4172235">,</span>&nbsp;<span class="ident" id="4172237">err</span>&nbsp;<span class="op" id="4172241">:=</span>&nbsp;<span class="ident" id="4172244">ifi</span><span class="op" id="4172247">.</span><span class="ident" id="4172248">Addrs</span><span class="op" id="4172253">(</span><span class="op" id="4172254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172257">if</span>&nbsp;<span class="ident" id="4172260">err</span>&nbsp;<span class="op" id="4172264">!=</span>&nbsp;<span class="ident" id="4172267">nil</span>&nbsp;<span class="op" id="4172271">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172275">return</span>&nbsp;<span class="ident" id="4172282">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172290">for</span>&nbsp;<span class="ident" id="4172294">_</span><span class="op" id="4172295">,</span>&nbsp;<span class="ident" id="4172297">ifa</span>&nbsp;<span class="op" id="4172301">:=</span>&nbsp;<span class="keyword" id="4172304">range</span>&nbsp;<span class="ident" id="4172310">ifat</span>&nbsp;<span class="op" id="4172315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172319">switch</span>&nbsp;<span class="ident" id="4172326">v</span>&nbsp;<span class="op" id="4172328">:=</span>&nbsp;<span class="ident" id="4172331">ifa</span><span class="op" id="4172334">.</span><span class="op" id="4172335">(</span><span class="keyword" id="4172336">type</span><span class="op" id="4172340">)</span>&nbsp;<span class="op" id="4172342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172346">case</span>&nbsp;<span class="op" id="4172351">*</span><span class="ident" id="4172352">IPAddr</span><span class="op" id="4172358">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172363">if</span>&nbsp;<span class="ident" id="4172366">a</span>&nbsp;<span class="op" id="4172368">:=</span>&nbsp;<span class="ident" id="4172371">v</span><span class="op" id="4172372">.</span><span class="ident" id="4172373">IP</span><span class="op" id="4172375">.</span><span class="ident" id="4172376">To4</span><span class="op" id="4172379">(</span><span class="op" id="4172380">)</span><span class="op" id="4172381">;</span>&nbsp;<span class="ident" id="4172383">a</span>&nbsp;<span class="op" id="4172385">!=</span>&nbsp;<span class="ident" id="4172388">nil</span>&nbsp;<span class="op" id="4172392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4172398">copy</span><span class="op" id="4172402">(</span><span class="ident" id="4172403">mreq</span><span class="op" id="4172407">.</span><span class="ident" id="4172408">Interface</span><span class="op" id="4172417">[</span><span class="op" id="4172418">:</span><span class="op" id="4172419">]</span><span class="op" id="4172420">,</span>&nbsp;<span class="ident" id="4172422">a</span><span class="op" id="4172423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172429">goto</span>&nbsp;<span class="ident" id="4172434">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172446">case</span>&nbsp;<span class="op" id="4172451">*</span><span class="ident" id="4172452">IPNet</span><span class="op" id="4172457">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172462">if</span>&nbsp;<span class="ident" id="4172465">a</span>&nbsp;<span class="op" id="4172467">:=</span>&nbsp;<span class="ident" id="4172470">v</span><span class="op" id="4172471">.</span><span class="ident" id="4172472">IP</span><span class="op" id="4172474">.</span><span class="ident" id="4172475">To4</span><span class="op" id="4172478">(</span><span class="op" id="4172479">)</span><span class="op" id="4172480">;</span>&nbsp;<span class="ident" id="4172482">a</span>&nbsp;<span class="op" id="4172484">!=</span>&nbsp;<span class="ident" id="4172487">nil</span>&nbsp;<span class="op" id="4172491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4172497">copy</span><span class="op" id="4172501">(</span><span class="ident" id="4172502">mreq</span><span class="op" id="4172506">.</span><span class="ident" id="4172507">Interface</span><span class="op" id="4172516">[</span><span class="op" id="4172517">:</span><span class="op" id="4172518">]</span><span class="op" id="4172519">,</span>&nbsp;<span class="ident" id="4172521">a</span><span class="op" id="4172522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172528">goto</span>&nbsp;<span class="ident" id="4172533">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172545">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172548">}</span><br>
<span class="lineno"></span><span class="ident" id="4172550">done</span><span class="op" id="4172554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172557">if</span>&nbsp;<span class="ident" id="4172560">bytesEqual</span><span class="op" id="4172570">(</span><span class="ident" id="4172571">mreq</span><span class="op" id="4172575">.</span><span class="ident" id="4172576">Multiaddr</span><span class="op" id="4172585">[</span><span class="op" id="4172586">:</span><span class="op" id="4172587">]</span><span class="op" id="4172588">,</span>&nbsp;<span class="ident" id="4172590">IPv4zero</span><span class="op" id="4172598">.</span><span class="ident" id="4172599">To4</span><span class="op" id="4172602">(</span><span class="op" id="4172603">)</span><span class="op" id="4172604">)</span>&nbsp;<span class="op" id="4172606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172610">return</span>&nbsp;<span class="ident" id="4172617">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172646">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172649">return</span>&nbsp;<span class="ident" id="4172656">nil</span><br>
<span class="lineno"></span><span class="op" id="4172660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4172663">func</span>&nbsp;<span class="ident" id="4172668">setReadBuffer</span><span class="op" id="4172681">(</span><span class="ident" id="4172682">fd</span>&nbsp;<span class="op" id="4172685">*</span><span class="ident" id="4172686">netFD</span><span class="op" id="4172691">,</span>&nbsp;<span class="ident" id="4172693">bytes</span>&nbsp;<span class="builtintype" id="4172699">int</span><span class="op" id="4172702">)</span>&nbsp;<span class="builtintype" id="4172704">error</span>&nbsp;<span class="op" id="4172710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172713">if</span>&nbsp;<span class="ident" id="4172716">err</span>&nbsp;<span class="op" id="4172720">:=</span>&nbsp;<span class="ident" id="4172723">fd</span><span class="op" id="4172725">.</span><span class="ident" id="4172726">incref</span><span class="op" id="4172732">(</span><span class="op" id="4172733">)</span><span class="op" id="4172734">;</span>&nbsp;<span class="ident" id="4172736">err</span>&nbsp;<span class="op" id="4172740">!=</span>&nbsp;<span class="ident" id="4172743">nil</span>&nbsp;<span class="op" id="4172747">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172751">return</span>&nbsp;<span class="ident" id="4172758">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4172763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172766">defer</span>&nbsp;<span class="ident" id="4172772">fd</span><span class="op" id="4172774">.</span><span class="ident" id="4172775">decref</span><span class="op" id="4172781">(</span><span class="op" id="4172782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172785">return</span>&nbsp;<span class="ident" id="4172792">os</span><span class="op" id="4172794">.</span><span class="ident" id="4172795">NewSyscallError</span><span class="op" id="4172810">(</span><span class="string" id="4172811">&#34;setsockopt&#34;</span><span class="op" id="4172823">,</span>&nbsp;<span class="ident" id="4172825">syscall</span><span class="op" id="4172832">.</span><span class="ident" id="4172833">SetsockoptInt</span><span class="op" id="4172846">(</span><span class="ident" id="4172847">fd</span><span class="op" id="4172849">.</span><span class="ident" id="4172850">sysfd</span><span class="op" id="4172855">,</span>&nbsp;<span class="ident" id="4172857">syscall</span><span class="op" id="4172864">.</span><span class="ident" id="4172865">SOL_SOCKET</span><span class="op" id="4172875">,</span>&nbsp;<span class="ident" id="4172877">syscall</span><span class="op" id="4172884">.</span><span class="ident" id="4172885">SO_RCVBUF</span><span class="op" id="4172894">,</span>&nbsp;<span class="ident" id="4172896">bytes</span><span class="op" id="4172901">)</span><span class="op" id="4172902">)</span><br>
<span class="lineno"></span><span class="op" id="4172904">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="4172907">func</span>&nbsp;<span class="ident" id="4172912">setWriteBuffer</span><span class="op" id="4172926">(</span><span class="ident" id="4172927">fd</span>&nbsp;<span class="op" id="4172930">*</span><span class="ident" id="4172931">netFD</span><span class="op" id="4172936">,</span>&nbsp;<span class="ident" id="4172938">bytes</span>&nbsp;<span class="builtintype" id="4172944">int</span><span class="op" id="4172947">)</span>&nbsp;<span class="builtintype" id="4172949">error</span>&nbsp;<span class="op" id="4172955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172958">if</span>&nbsp;<span class="ident" id="4172961">err</span>&nbsp;<span class="op" id="4172965">:=</span>&nbsp;<span class="ident" id="4172968">fd</span><span class="op" id="4172970">.</span><span class="ident" id="4172971">incref</span><span class="op" id="4172977">(</span><span class="op" id="4172978">)</span><span class="op" id="4172979">;</span>&nbsp;<span class="ident" id="4172981">err</span>&nbsp;<span class="op" id="4172985">!=</span>&nbsp;<span class="ident" id="4172988">nil</span>&nbsp;<span class="op" id="4172992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4172996">return</span>&nbsp;<span class="ident" id="4173003">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4173008">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173011">defer</span>&nbsp;<span class="ident" id="4173017">fd</span><span class="op" id="4173019">.</span><span class="ident" id="4173020">decref</span><span class="op" id="4173026">(</span><span class="op" id="4173027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173030">return</span>&nbsp;<span class="ident" id="4173037">os</span><span class="op" id="4173039">.</span><span class="ident" id="4173040">NewSyscallError</span><span class="op" id="4173055">(</span><span class="string" id="4173056">&#34;setsockopt&#34;</span><span class="op" id="4173068">,</span>&nbsp;<span class="ident" id="4173070">syscall</span><span class="op" id="4173077">.</span><span class="ident" id="4173078">SetsockoptInt</span><span class="op" id="4173091">(</span><span class="ident" id="4173092">fd</span><span class="op" id="4173094">.</span><span class="ident" id="4173095">sysfd</span><span class="op" id="4173100">,</span>&nbsp;<span class="ident" id="4173102">syscall</span><span class="op" id="4173109">.</span><span class="ident" id="4173110">SOL_SOCKET</span><span class="op" id="4173120">,</span>&nbsp;<span class="ident" id="4173122">syscall</span><span class="op" id="4173129">.</span><span class="ident" id="4173130">SO_SNDBUF</span><span class="op" id="4173139">,</span>&nbsp;<span class="ident" id="4173141">bytes</span><span class="op" id="4173146">)</span><span class="op" id="4173147">)</span><br>
<span class="lineno"></span><span class="op" id="4173149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4173152">func</span>&nbsp;<span class="ident" id="4173157">setKeepAlive</span><span class="op" id="4173169">(</span><span class="ident" id="4173170">fd</span>&nbsp;<span class="op" id="4173173">*</span><span class="ident" id="4173174">netFD</span><span class="op" id="4173179">,</span>&nbsp;<span class="ident" id="4173181">keepalive</span>&nbsp;<span class="builtintype" id="4173191">bool</span><span class="op" id="4173195">)</span>&nbsp;<span class="builtintype" id="4173197">error</span>&nbsp;<span class="op" id="4173203">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173206">if</span>&nbsp;<span class="ident" id="4173209">err</span>&nbsp;<span class="op" id="4173213">:=</span>&nbsp;<span class="ident" id="4173216">fd</span><span class="op" id="4173218">.</span><span class="ident" id="4173219">incref</span><span class="op" id="4173225">(</span><span class="op" id="4173226">)</span><span class="op" id="4173227">;</span>&nbsp;<span class="ident" id="4173229">err</span>&nbsp;<span class="op" id="4173233">!=</span>&nbsp;<span class="ident" id="4173236">nil</span>&nbsp;<span class="op" id="4173240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173244">return</span>&nbsp;<span class="ident" id="4173251">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4173256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173259">defer</span>&nbsp;<span class="ident" id="4173265">fd</span><span class="op" id="4173267">.</span><span class="ident" id="4173268">decref</span><span class="op" id="4173274">(</span><span class="op" id="4173275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173278">return</span>&nbsp;<span class="ident" id="4173285">os</span><span class="op" id="4173287">.</span><span class="ident" id="4173288">NewSyscallError</span><span class="op" id="4173303">(</span><span class="string" id="4173304">&#34;setsockopt&#34;</span><span class="op" id="4173316">,</span>&nbsp;<span class="ident" id="4173318">syscall</span><span class="op" id="4173325">.</span><span class="ident" id="4173326">SetsockoptInt</span><span class="op" id="4173339">(</span><span class="ident" id="4173340">fd</span><span class="op" id="4173342">.</span><span class="ident" id="4173343">sysfd</span><span class="op" id="4173348">,</span>&nbsp;<span class="ident" id="4173350">syscall</span><span class="op" id="4173357">.</span><span class="ident" id="4173358">SOL_SOCKET</span><span class="op" id="4173368">,</span>&nbsp;<span class="ident" id="4173370">syscall</span><span class="op" id="4173377">.</span><span class="ident" id="4173378">SO_KEEPALIVE</span><span class="op" id="4173390">,</span>&nbsp;<span class="ident" id="4173392">boolint</span><span class="op" id="4173399">(</span><span class="ident" id="4173400">keepalive</span><span class="op" id="4173409">)</span><span class="op" id="4173410">)</span><span class="op" id="4173411">)</span><br>
<span class="lineno">125</span><span class="op" id="4173413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4173416">func</span>&nbsp;<span class="ident" id="4173421">setLinger</span><span class="op" id="4173430">(</span><span class="ident" id="4173431">fd</span>&nbsp;<span class="op" id="4173434">*</span><span class="ident" id="4173435">netFD</span><span class="op" id="4173440">,</span>&nbsp;<span class="ident" id="4173442">sec</span>&nbsp;<span class="builtintype" id="4173446">int</span><span class="op" id="4173449">)</span>&nbsp;<span class="builtintype" id="4173451">error</span>&nbsp;<span class="op" id="4173457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173460">var</span>&nbsp;<span class="ident" id="4173464">l</span>&nbsp;<span class="ident" id="4173466">syscall</span><span class="op" id="4173473">.</span><span class="ident" id="4173474">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173482">if</span>&nbsp;<span class="ident" id="4173485">sec</span>&nbsp;<span class="op" id="4173489">&gt;=</span>&nbsp;<span class="num" id="4173492">0</span>&nbsp;<span class="op" id="4173494">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4173498">l</span><span class="op" id="4173499">.</span><span class="ident" id="4173500">Onoff</span>&nbsp;<span class="op" id="4173506">=</span>&nbsp;<span class="num" id="4173508">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4173512">l</span><span class="op" id="4173513">.</span><span class="ident" id="4173514">Linger</span>&nbsp;<span class="op" id="4173521">=</span>&nbsp;<span class="builtintype" id="4173523">int32</span><span class="op" id="4173528">(</span><span class="ident" id="4173529">sec</span><span class="op" id="4173532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4173535">}</span>&nbsp;<span class="keyword" id="4173537">else</span>&nbsp;<span class="op" id="4173542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4173546">l</span><span class="op" id="4173547">.</span><span class="ident" id="4173548">Onoff</span>&nbsp;<span class="op" id="4173554">=</span>&nbsp;<span class="num" id="4173556">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4173560">l</span><span class="op" id="4173561">.</span><span class="ident" id="4173562">Linger</span>&nbsp;<span class="op" id="4173569">=</span>&nbsp;<span class="num" id="4173571">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4173574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173577">if</span>&nbsp;<span class="ident" id="4173580">err</span>&nbsp;<span class="op" id="4173584">:=</span>&nbsp;<span class="ident" id="4173587">fd</span><span class="op" id="4173589">.</span><span class="ident" id="4173590">incref</span><span class="op" id="4173596">(</span><span class="op" id="4173597">)</span><span class="op" id="4173598">;</span>&nbsp;<span class="ident" id="4173600">err</span>&nbsp;<span class="op" id="4173604">!=</span>&nbsp;<span class="ident" id="4173607">nil</span>&nbsp;<span class="op" id="4173611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173615">return</span>&nbsp;<span class="ident" id="4173622">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4173627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173630">defer</span>&nbsp;<span class="ident" id="4173636">fd</span><span class="op" id="4173638">.</span><span class="ident" id="4173639">decref</span><span class="op" id="4173645">(</span><span class="op" id="4173646">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4173649">return</span>&nbsp;<span class="ident" id="4173656">os</span><span class="op" id="4173658">.</span><span class="ident" id="4173659">NewSyscallError</span><span class="op" id="4173674">(</span><span class="string" id="4173675">&#34;setsockopt&#34;</span><span class="op" id="4173687">,</span>&nbsp;<span class="ident" id="4173689">syscall</span><span class="op" id="4173696">.</span><span class="ident" id="4173697">SetsockoptLinger</span><span class="op" id="4173713">(</span><span class="ident" id="4173714">fd</span><span class="op" id="4173716">.</span><span class="ident" id="4173717">sysfd</span><span class="op" id="4173722">,</span>&nbsp;<span class="ident" id="4173724">syscall</span><span class="op" id="4173731">.</span><span class="ident" id="4173732">SOL_SOCKET</span><span class="op" id="4173742">,</span>&nbsp;<span class="ident" id="4173744">syscall</span><span class="op" id="4173751">.</span><span class="ident" id="4173752">SO_LINGER</span><span class="op" id="4173761">,</span>&nbsp;<span class="op" id="4173763">&amp;</span><span class="ident" id="4173764">l</span><span class="op" id="4173765">)</span><span class="op" id="4173766">)</span><br>
<span class="lineno"></span><span class="op" id="4173768">}</span>
</div>
</body>
</html>
