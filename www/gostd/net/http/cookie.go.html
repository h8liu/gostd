<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html" class="current">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4095512">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4095567">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4095621">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4095672">package</span>&nbsp;<span class="ident" id="4095680">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4095686">import</span>&nbsp;<span class="op" id="4095693">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095696">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095705">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095712">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095719">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095726">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095737">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4095748">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4095755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095758">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="4095812">//</span><br>
<span class="lineno"></span><span class="comment" id="4095815">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4095857">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4095934">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4095992">type</span>&nbsp;<span class="ident" id="4095997">Cookie</span>&nbsp;<span class="keyword" id="4096004">struct</span>&nbsp;<span class="op" id="4096011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096014">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096025">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096033">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096044">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096052">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096063">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096071">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096082">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096090">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096101"><a href="/gostd/net/http/cookie.go.html#4095748">time</a></span><span class="op" id="4096105">.</span><span class="ident" id="4096106"><a href="/gostd/time/time.go.html#2722087">Time</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096112">RawExpires</span>&nbsp;<span class="builtintype" id="4096123">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096132">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096185">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4096249">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096315">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096324">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096329">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096338">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096344">HttpOnly</span>&nbsp;<span class="builtintype" id="4096353">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096359">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4096368">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096376">Unparsed</span>&nbsp;<span class="op" id="4096385">[</span><span class="op" id="4096386">]</span><span class="builtintype" id="4096387">string</span>&nbsp;<span class="comment" id="4096394">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="4096440">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4096443">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4096497">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="4096558">func</span>&nbsp;<span class="ident" id="4096563">readSetCookies</span><span class="op" id="4096577">(</span><span class="ident" id="4096578">h</span>&nbsp;<span class="ident" id="4096580"><a href="/gostd/net/http/header.go.html#4126117">Header</a></span><span class="op" id="4096586">)</span>&nbsp;<span class="op" id="4096588">[</span><span class="op" id="4096589">]</span><span class="op" id="4096590">*</span><span class="ident" id="4096591"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span>&nbsp;<span class="op" id="4096598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096601">cookies</span>&nbsp;<span class="op" id="4096609">:=</span>&nbsp;<span class="op" id="4096612">[</span><span class="op" id="4096613">]</span><span class="op" id="4096614">*</span><span class="ident" id="4096615"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span><span class="op" id="4096621">{</span><span class="op" id="4096622">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096625">for</span>&nbsp;<span class="ident" id="4096629">_</span><span class="op" id="4096630">,</span>&nbsp;<span class="ident" id="4096632">line</span>&nbsp;<span class="op" id="4096637">:=</span>&nbsp;<span class="keyword" id="4096640">range</span>&nbsp;<span class="ident" id="4096646"><a href="/gostd/net/http/cookie.go.html#4096578">h</a></span><span class="op" id="4096647">[</span><span class="string" id="4096648">&#34;Set-Cookie&#34;</span><span class="op" id="4096660">]</span>&nbsp;<span class="op" id="4096662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096666">parts</span>&nbsp;<span class="op" id="4096672">:=</span>&nbsp;<span class="ident" id="4096675"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4096682">.</span><span class="ident" id="4096683"><a href="/gostd/strings/strings.go.html#2973136">Split</a></span><span class="op" id="4096688">(</span><span class="ident" id="4096689"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4096696">.</span><span class="ident" id="4096697"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="4096706">(</span><span class="ident" id="4096707"><a href="/gostd/net/http/cookie.go.html#4096632">line</a></span><span class="op" id="4096711">)</span><span class="op" id="4096712">,</span>&nbsp;<span class="string" id="4096714">&#34;;&#34;</span><span class="op" id="4096717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096721">if</span>&nbsp;<span class="builtinfunc" id="4096724">len</span><span class="op" id="4096727">(</span><span class="ident" id="4096728"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096733">)</span>&nbsp;<span class="op" id="4096735">==</span>&nbsp;<span class="num" id="4096738">1</span>&nbsp;<span class="op" id="4096740">&amp;&amp;</span>&nbsp;<span class="ident" id="4096743"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096748">[</span><span class="num" id="4096749">0</span><span class="op" id="4096750">]</span>&nbsp;<span class="op" id="4096752">==</span>&nbsp;<span class="string" id="4096755">&#34;&#34;</span>&nbsp;<span class="op" id="4096758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096763">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096774">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096778"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096783">[</span><span class="num" id="4096784">0</span><span class="op" id="4096785">]</span>&nbsp;<span class="op" id="4096787">=</span>&nbsp;<span class="ident" id="4096789"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4096796">.</span><span class="ident" id="4096797"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="4096806">(</span><span class="ident" id="4096807"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096812">[</span><span class="num" id="4096813">0</span><span class="op" id="4096814">]</span><span class="op" id="4096815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096819">j</span>&nbsp;<span class="op" id="4096821">:=</span>&nbsp;<span class="ident" id="4096824"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4096831">.</span><span class="ident" id="4096832"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="4096837">(</span><span class="ident" id="4096838"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096843">[</span><span class="num" id="4096844">0</span><span class="op" id="4096845">]</span><span class="op" id="4096846">,</span>&nbsp;<span class="string" id="4096848">&#34;=&#34;</span><span class="op" id="4096851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096855">if</span>&nbsp;<span class="ident" id="4096858"><a href="/gostd/net/http/cookie.go.html#4096819">j</a></span>&nbsp;<span class="op" id="4096860">&lt;</span>&nbsp;<span class="num" id="4096862">0</span>&nbsp;<span class="op" id="4096864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096869">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096880">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096884">name</span><span class="op" id="4096888">,</span>&nbsp;<span class="ident" id="4096890">value</span>&nbsp;<span class="op" id="4096896">:=</span>&nbsp;<span class="ident" id="4096899"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096904">[</span><span class="num" id="4096905">0</span><span class="op" id="4096906">]</span><span class="op" id="4096907">[</span><span class="op" id="4096908">:</span><span class="ident" id="4096909"><a href="/gostd/net/http/cookie.go.html#4096819">j</a></span><span class="op" id="4096910">]</span><span class="op" id="4096911">,</span>&nbsp;<span class="ident" id="4096913"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4096918">[</span><span class="num" id="4096919">0</span><span class="op" id="4096920">]</span><span class="op" id="4096921">[</span><span class="ident" id="4096922"><a href="/gostd/net/http/cookie.go.html#4096819">j</a></span><span class="op" id="4096923">+</span><span class="num" id="4096924">1</span><span class="op" id="4096925">:</span><span class="op" id="4096926">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096930">if</span>&nbsp;<span class="op" id="4096933">!</span><span class="ident" id="4096934"><a href="/gostd/net/http/cookie.go.html#4104284">isCookieNameValid</a></span><span class="op" id="4096951">(</span><span class="ident" id="4096952"><a href="/gostd/net/http/cookie.go.html#4096884">name</a></span><span class="op" id="4096956">)</span>&nbsp;<span class="op" id="4096958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4096963">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4096974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4096978"><a href="/gostd/net/http/cookie.go.html#4096890">value</a></span><span class="op" id="4096983">,</span>&nbsp;<span class="ident" id="4096985">success</span>&nbsp;<span class="op" id="4096993">:=</span>&nbsp;<span class="ident" id="4096996"><a href="/gostd/net/http/cookie.go.html#4103945">parseCookieValue</a></span><span class="op" id="4097012">(</span><span class="ident" id="4097013"><a href="/gostd/net/http/cookie.go.html#4096890">value</a></span><span class="op" id="4097018">,</span>&nbsp;<span class="builtintype" id="4097020">true</span><span class="op" id="4097024">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097028">if</span>&nbsp;<span class="op" id="4097031">!</span><span class="ident" id="4097032"><a href="/gostd/net/http/cookie.go.html#4096985">success</a></span>&nbsp;<span class="op" id="4097040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097045">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097060">c</span>&nbsp;<span class="op" id="4097062">:=</span>&nbsp;<span class="op" id="4097065">&amp;</span><span class="ident" id="4097066"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span><span class="op" id="4097072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097077"><a href="/gostd/net/http/cookie.go.html#4096014">Name</a></span><span class="op" id="4097081">:</span>&nbsp;&nbsp;<span class="ident" id="4097084"><a href="/gostd/net/http/cookie.go.html#4096884">name</a></span><span class="op" id="4097088">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097093"><a href="/gostd/net/http/cookie.go.html#4096033">Value</a></span><span class="op" id="4097098">:</span>&nbsp;<span class="ident" id="4097100"><a href="/gostd/net/http/cookie.go.html#4096890">value</a></span><span class="op" id="4097105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097110"><a href="/gostd/net/http/cookie.go.html#4096359">Raw</a></span><span class="op" id="4097113">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4097117"><a href="/gostd/net/http/cookie.go.html#4096632">line</a></span><span class="op" id="4097121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097129">for</span>&nbsp;<span class="ident" id="4097133">i</span>&nbsp;<span class="op" id="4097135">:=</span>&nbsp;<span class="num" id="4097138">1</span><span class="op" id="4097139">;</span>&nbsp;<span class="ident" id="4097141"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span>&nbsp;<span class="op" id="4097143">&lt;</span>&nbsp;<span class="builtinfunc" id="4097145">len</span><span class="op" id="4097148">(</span><span class="ident" id="4097149"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4097154">)</span><span class="op" id="4097155">;</span>&nbsp;<span class="ident" id="4097157"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4097158">++</span>&nbsp;<span class="op" id="4097161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097166"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4097171">[</span><span class="ident" id="4097172"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4097173">]</span>&nbsp;<span class="op" id="4097175">=</span>&nbsp;<span class="ident" id="4097177"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4097184">.</span><span class="ident" id="4097185"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="4097194">(</span><span class="ident" id="4097195"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4097200">[</span><span class="ident" id="4097201"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4097202">]</span><span class="op" id="4097203">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097208">if</span>&nbsp;<span class="builtinfunc" id="4097211">len</span><span class="op" id="4097214">(</span><span class="ident" id="4097215"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4097220">[</span><span class="ident" id="4097221"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4097222">]</span><span class="op" id="4097223">)</span>&nbsp;<span class="op" id="4097225">==</span>&nbsp;<span class="num" id="4097228">0</span>&nbsp;<span class="op" id="4097230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097236">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097254">attr</span><span class="op" id="4097258">,</span>&nbsp;<span class="ident" id="4097260">val</span>&nbsp;<span class="op" id="4097264">:=</span>&nbsp;<span class="ident" id="4097267"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4097272">[</span><span class="ident" id="4097273"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4097274">]</span><span class="op" id="4097275">,</span>&nbsp;<span class="string" id="4097277">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097283">if</span>&nbsp;<span class="ident" id="4097286">j</span>&nbsp;<span class="op" id="4097288">:=</span>&nbsp;<span class="ident" id="4097291"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4097298">.</span><span class="ident" id="4097299"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="4097304">(</span><span class="ident" id="4097305"><a href="/gostd/net/http/cookie.go.html#4097254">attr</a></span><span class="op" id="4097309">,</span>&nbsp;<span class="string" id="4097311">&#34;=&#34;</span><span class="op" id="4097314">)</span><span class="op" id="4097315">;</span>&nbsp;<span class="ident" id="4097317"><a href="/gostd/net/http/cookie.go.html#4097286">j</a></span>&nbsp;<span class="op" id="4097319">&gt;=</span>&nbsp;<span class="num" id="4097322">0</span>&nbsp;<span class="op" id="4097324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097330"><a href="/gostd/net/http/cookie.go.html#4097254">attr</a></span><span class="op" id="4097334">,</span>&nbsp;<span class="ident" id="4097336"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span>&nbsp;<span class="op" id="4097340">=</span>&nbsp;<span class="ident" id="4097342"><a href="/gostd/net/http/cookie.go.html#4097254">attr</a></span><span class="op" id="4097346">[</span><span class="op" id="4097347">:</span><span class="ident" id="4097348"><a href="/gostd/net/http/cookie.go.html#4097286">j</a></span><span class="op" id="4097349">]</span><span class="op" id="4097350">,</span>&nbsp;<span class="ident" id="4097352"><a href="/gostd/net/http/cookie.go.html#4097254">attr</a></span><span class="op" id="4097356">[</span><span class="ident" id="4097357"><a href="/gostd/net/http/cookie.go.html#4097286">j</a></span><span class="op" id="4097358">+</span><span class="num" id="4097359">1</span><span class="op" id="4097360">:</span><span class="op" id="4097361">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097371">lowerAttr</span>&nbsp;<span class="op" id="4097381">:=</span>&nbsp;<span class="ident" id="4097384"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4097391">.</span><span class="ident" id="4097392"><a href="/gostd/strings/strings.go.html#2977307">ToLower</a></span><span class="op" id="4097399">(</span><span class="ident" id="4097400"><a href="/gostd/net/http/cookie.go.html#4097254">attr</a></span><span class="op" id="4097404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097409"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><span class="op" id="4097412">,</span>&nbsp;<span class="ident" id="4097414"><a href="/gostd/net/http/cookie.go.html#4096985">success</a></span>&nbsp;<span class="op" id="4097422">=</span>&nbsp;<span class="ident" id="4097424"><a href="/gostd/net/http/cookie.go.html#4103945">parseCookieValue</a></span><span class="op" id="4097440">(</span><span class="ident" id="4097441"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><span class="op" id="4097444">,</span>&nbsp;<span class="builtintype" id="4097446">false</span><span class="op" id="4097451">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097456">if</span>&nbsp;<span class="op" id="4097459">!</span><span class="ident" id="4097460"><a href="/gostd/net/http/cookie.go.html#4096985">success</a></span>&nbsp;<span class="op" id="4097468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097474"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097475">.</span><span class="ident" id="4097476"><a href="/gostd/net/http/cookie.go.html#4096376">Unparsed</a></span>&nbsp;<span class="op" id="4097485">=</span>&nbsp;<span class="builtinfunc" id="4097487">append</span><span class="op" id="4097493">(</span><span class="ident" id="4097494"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097495">.</span><span class="ident" id="4097496"><a href="/gostd/net/http/cookie.go.html#4096376">Unparsed</a></span><span class="op" id="4097504">,</span>&nbsp;<span class="ident" id="4097506"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4097511">[</span><span class="ident" id="4097512"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4097513">]</span><span class="op" id="4097514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097520">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097537">switch</span>&nbsp;<span class="ident" id="4097544"><a href="/gostd/net/http/cookie.go.html#4097371">lowerAttr</a></span>&nbsp;<span class="op" id="4097554">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097559">case</span>&nbsp;<span class="string" id="4097564">&#34;secure&#34;</span><span class="op" id="4097572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097578"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097579">.</span><span class="ident" id="4097580"><a href="/gostd/net/http/cookie.go.html#4096329">Secure</a></span>&nbsp;<span class="op" id="4097587">=</span>&nbsp;<span class="builtintype" id="4097589">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097598">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097610">case</span>&nbsp;<span class="string" id="4097615">&#34;httponly&#34;</span><span class="op" id="4097625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097631"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097632">.</span><span class="ident" id="4097633"><a href="/gostd/net/http/cookie.go.html#4096344">HttpOnly</a></span>&nbsp;<span class="op" id="4097642">=</span>&nbsp;<span class="builtintype" id="4097644">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097653">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097665">case</span>&nbsp;<span class="string" id="4097670">&#34;domain&#34;</span><span class="op" id="4097678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097684"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097685">.</span><span class="ident" id="4097686"><a href="/gostd/net/http/cookie.go.html#4096071">Domain</a></span>&nbsp;<span class="op" id="4097693">=</span>&nbsp;<span class="ident" id="4097695"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097703">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097715">case</span>&nbsp;<span class="string" id="4097720">&#34;max-age&#34;</span><span class="op" id="4097729">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097735">secs</span><span class="op" id="4097739">,</span>&nbsp;<span class="ident" id="4097741">err</span>&nbsp;<span class="op" id="4097745">:=</span>&nbsp;<span class="ident" id="4097748"><a href="/gostd/net/http/cookie.go.html#4095726">strconv</a></span><span class="op" id="4097755">.</span><span class="ident" id="4097756"><a href="/gostd/strconv/atoi.go.html#2357032">Atoi</a></span><span class="op" id="4097760">(</span><span class="ident" id="4097761"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><span class="op" id="4097764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097770">if</span>&nbsp;<span class="ident" id="4097773"><a href="/gostd/net/http/cookie.go.html#4097741">err</a></span>&nbsp;<span class="op" id="4097777">!=</span>&nbsp;<span class="builtintype" id="4097780">nil</span>&nbsp;<span class="op" id="4097784">||</span>&nbsp;<span class="ident" id="4097787"><a href="/gostd/net/http/cookie.go.html#4097735">secs</a></span>&nbsp;<span class="op" id="4097792">!=</span>&nbsp;<span class="num" id="4097795">0</span>&nbsp;<span class="op" id="4097797">&amp;&amp;</span>&nbsp;<span class="ident" id="4097800"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><span class="op" id="4097803">[</span><span class="num" id="4097804">0</span><span class="op" id="4097805">]</span>&nbsp;<span class="op" id="4097807">==</span>&nbsp;<span class="string" id="4097810">&#39;0&#39;</span>&nbsp;<span class="op" id="4097814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097821">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097837">if</span>&nbsp;<span class="ident" id="4097840"><a href="/gostd/net/http/cookie.go.html#4097735">secs</a></span>&nbsp;<span class="op" id="4097845">&lt;=</span>&nbsp;<span class="num" id="4097848">0</span>&nbsp;<span class="op" id="4097850">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097857"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097858">.</span><span class="ident" id="4097859"><a href="/gostd/net/http/cookie.go.html#4096315">MaxAge</a></span>&nbsp;<span class="op" id="4097866">=</span>&nbsp;<span class="op" id="4097868">-</span><span class="num" id="4097869">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097875">}</span>&nbsp;<span class="keyword" id="4097877">else</span>&nbsp;<span class="op" id="4097882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097889"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097890">.</span><span class="ident" id="4097891"><a href="/gostd/net/http/cookie.go.html#4096315">MaxAge</a></span>&nbsp;<span class="op" id="4097898">=</span>&nbsp;<span class="ident" id="4097900"><a href="/gostd/net/http/cookie.go.html#4097735">secs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097915">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4097927">case</span>&nbsp;<span class="string" id="4097932">&#34;expires&#34;</span><span class="op" id="4097941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097947"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4097948">.</span><span class="ident" id="4097949"><a href="/gostd/net/http/cookie.go.html#4096112">RawExpires</a></span>&nbsp;<span class="op" id="4097960">=</span>&nbsp;<span class="ident" id="4097962"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4097970">exptime</span><span class="op" id="4097977">,</span>&nbsp;<span class="ident" id="4097979">err</span>&nbsp;<span class="op" id="4097983">:=</span>&nbsp;<span class="ident" id="4097986"><a href="/gostd/net/http/cookie.go.html#4095748">time</a></span><span class="op" id="4097990">.</span><span class="ident" id="4097991"><a href="/gostd/time/format.go.html#2699353">Parse</a></span><span class="op" id="4097996">(</span><span class="ident" id="4097997"><a href="/gostd/net/http/cookie.go.html#4095748">time</a></span><span class="op" id="4098001">.</span><span class="ident" id="4098002"><a href="/gostd/time/format.go.html#2680409">RFC1123</a></span><span class="op" id="4098009">,</span>&nbsp;<span class="ident" id="4098011"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><span class="op" id="4098014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098020">if</span>&nbsp;<span class="ident" id="4098023"><a href="/gostd/net/http/cookie.go.html#4097979">err</a></span>&nbsp;<span class="op" id="4098027">!=</span>&nbsp;<span class="builtintype" id="4098030">nil</span>&nbsp;<span class="op" id="4098034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098041"><a href="/gostd/net/http/cookie.go.html#4097970">exptime</a></span><span class="op" id="4098048">,</span>&nbsp;<span class="ident" id="4098050"><a href="/gostd/net/http/cookie.go.html#4097979">err</a></span>&nbsp;<span class="op" id="4098054">=</span>&nbsp;<span class="ident" id="4098056"><a href="/gostd/net/http/cookie.go.html#4095748">time</a></span><span class="op" id="4098060">.</span><span class="ident" id="4098061"><a href="/gostd/time/format.go.html#2699353">Parse</a></span><span class="op" id="4098066">(</span><span class="string" id="4098067">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="4098098">,</span>&nbsp;<span class="ident" id="4098100"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><span class="op" id="4098103">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098110">if</span>&nbsp;<span class="ident" id="4098113"><a href="/gostd/net/http/cookie.go.html#4097979">err</a></span>&nbsp;<span class="op" id="4098117">!=</span>&nbsp;<span class="builtintype" id="4098120">nil</span>&nbsp;<span class="op" id="4098124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098132"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4098133">.</span><span class="ident" id="4098134"><a href="/gostd/net/http/cookie.go.html#4096090">Expires</a></span>&nbsp;<span class="op" id="4098142">=</span>&nbsp;<span class="ident" id="4098144"><a href="/gostd/net/http/cookie.go.html#4095748">time</a></span><span class="op" id="4098148">.</span><span class="ident" id="4098149"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="4098153">{</span><span class="op" id="4098154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098162">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098179">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098185"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4098186">.</span><span class="ident" id="4098187"><a href="/gostd/net/http/cookie.go.html#4096090">Expires</a></span>&nbsp;<span class="op" id="4098195">=</span>&nbsp;<span class="ident" id="4098197"><a href="/gostd/net/http/cookie.go.html#4097970">exptime</a></span><span class="op" id="4098204">.</span><span class="ident" id="4098205"><a href="/gostd/time/time.go.html#2743233">UTC</a></span><span class="op" id="4098208">(</span><span class="op" id="4098209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098215">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098227">case</span>&nbsp;<span class="string" id="4098232">&#34;path&#34;</span><span class="op" id="4098238">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098244"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4098245">.</span><span class="ident" id="4098246"><a href="/gostd/net/http/cookie.go.html#4096052">Path</a></span>&nbsp;<span class="op" id="4098251">=</span>&nbsp;<span class="ident" id="4098253"><a href="/gostd/net/http/cookie.go.html#4097260">val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098261">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098278"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4098279">.</span><span class="ident" id="4098280"><a href="/gostd/net/http/cookie.go.html#4096376">Unparsed</a></span>&nbsp;<span class="op" id="4098289">=</span>&nbsp;<span class="builtinfunc" id="4098291">append</span><span class="op" id="4098297">(</span><span class="ident" id="4098298"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4098299">.</span><span class="ident" id="4098300"><a href="/gostd/net/http/cookie.go.html#4096376">Unparsed</a></span><span class="op" id="4098308">,</span>&nbsp;<span class="ident" id="4098310"><a href="/gostd/net/http/cookie.go.html#4096666">parts</a></span><span class="op" id="4098315">[</span><span class="ident" id="4098316"><a href="/gostd/net/http/cookie.go.html#4097133">i</a></span><span class="op" id="4098317">]</span><span class="op" id="4098318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098326"><a href="/gostd/net/http/cookie.go.html#4096601">cookies</a></span>&nbsp;<span class="op" id="4098334">=</span>&nbsp;<span class="builtinfunc" id="4098336">append</span><span class="op" id="4098342">(</span><span class="ident" id="4098343"><a href="/gostd/net/http/cookie.go.html#4096601">cookies</a></span><span class="op" id="4098350">,</span>&nbsp;<span class="ident" id="4098352"><a href="/gostd/net/http/cookie.go.html#4097060">c</a></span><span class="op" id="4098353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098356">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098359">return</span>&nbsp;<span class="ident" id="4098366"><a href="/gostd/net/http/cookie.go.html#4096601">cookies</a></span><br>
<span class="lineno"></span><span class="op" id="4098374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4098377">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="4098457">func</span>&nbsp;<span class="ident" id="4098462">SetCookie</span><span class="op" id="4098471">(</span><span class="ident" id="4098472">w</span>&nbsp;<span class="ident" id="4098474"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="4098488">,</span>&nbsp;<span class="ident" id="4098490">cookie</span>&nbsp;<span class="op" id="4098497">*</span><span class="ident" id="4098498"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span><span class="op" id="4098504">)</span>&nbsp;<span class="op" id="4098506">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098509"><a href="/gostd/net/http/cookie.go.html#4098472">w</a></span><span class="op" id="4098510">.</span><span class="ident" id="4098511"><a href="/gostd/net/http/server.go.html#4170747">Header</a></span><span class="op" id="4098517">(</span><span class="op" id="4098518">)</span><span class="op" id="4098519">.</span><span class="ident" id="4098520"><a href="/gostd/net/http/header.go.html#4126266">Add</a></span><span class="op" id="4098523">(</span><span class="string" id="4098524">&#34;Set-Cookie&#34;</span><span class="op" id="4098536">,</span>&nbsp;<span class="ident" id="4098538"><a href="/gostd/net/http/cookie.go.html#4098490">cookie</a></span><span class="op" id="4098544">.</span><span class="ident" id="4098545"><a href="/gostd/net/http/cookie.go.html#4098750">String</a></span><span class="op" id="4098551">(</span><span class="op" id="4098552">)</span><span class="op" id="4098553">)</span><br>
<span class="lineno"></span><span class="op" id="4098555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4098558">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="4098628">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="4098696">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="4098733">func</span>&nbsp;<span class="op" id="4098738">(</span><span class="ident" id="4098739">c</span>&nbsp;<span class="op" id="4098741">*</span><span class="ident" id="4098742"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span><span class="op" id="4098748">)</span>&nbsp;<span class="ident" id="4098750">String</span><span class="op" id="4098756">(</span><span class="op" id="4098757">)</span>&nbsp;<span class="builtintype" id="4098759">string</span>&nbsp;<span class="op" id="4098766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098769">var</span>&nbsp;<span class="ident" id="4098773">b</span>&nbsp;<span class="ident" id="4098775"><a href="/gostd/net/http/cookie.go.html#4095696">bytes</a></span><span class="op" id="4098780">.</span><span class="ident" id="4098781"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098789"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4098792">.</span><span class="ident" id="4098793"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4098800">(</span><span class="op" id="4098801">&amp;</span><span class="ident" id="4098802"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4098803">,</span>&nbsp;<span class="string" id="4098805">&#34;%s=%s&#34;</span><span class="op" id="4098812">,</span>&nbsp;<span class="ident" id="4098814"><a href="/gostd/net/http/cookie.go.html#4102229">sanitizeCookieName</a></span><span class="op" id="4098832">(</span><span class="ident" id="4098833"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4098834">.</span><span class="ident" id="4098835"><a href="/gostd/net/http/cookie.go.html#4096014">Name</a></span><span class="op" id="4098839">)</span><span class="op" id="4098840">,</span>&nbsp;<span class="ident" id="4098842"><a href="/gostd/net/http/cookie.go.html#4102855">sanitizeCookieValue</a></span><span class="op" id="4098861">(</span><span class="ident" id="4098862"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4098863">.</span><span class="ident" id="4098864"><a href="/gostd/net/http/cookie.go.html#4096033">Value</a></span><span class="op" id="4098869">)</span><span class="op" id="4098870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098873">if</span>&nbsp;<span class="builtinfunc" id="4098876">len</span><span class="op" id="4098879">(</span><span class="ident" id="4098880"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4098881">.</span><span class="ident" id="4098882"><a href="/gostd/net/http/cookie.go.html#4096052">Path</a></span><span class="op" id="4098886">)</span>&nbsp;<span class="op" id="4098888">&gt;</span>&nbsp;<span class="num" id="4098890">0</span>&nbsp;<span class="op" id="4098892">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4098896"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4098899">.</span><span class="ident" id="4098900"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4098907">(</span><span class="op" id="4098908">&amp;</span><span class="ident" id="4098909"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4098910">,</span>&nbsp;<span class="string" id="4098912">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="4098923">,</span>&nbsp;<span class="ident" id="4098925"><a href="/gostd/net/http/cookie.go.html#4103314">sanitizeCookiePath</a></span><span class="op" id="4098943">(</span><span class="ident" id="4098944"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4098945">.</span><span class="ident" id="4098946"><a href="/gostd/net/http/cookie.go.html#4096052">Path</a></span><span class="op" id="4098950">)</span><span class="op" id="4098951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4098954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098957">if</span>&nbsp;<span class="builtinfunc" id="4098960">len</span><span class="op" id="4098963">(</span><span class="ident" id="4098964"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4098965">.</span><span class="ident" id="4098966"><a href="/gostd/net/http/cookie.go.html#4096071">Domain</a></span><span class="op" id="4098972">)</span>&nbsp;<span class="op" id="4098974">&gt;</span>&nbsp;<span class="num" id="4098976">0</span>&nbsp;<span class="op" id="4098978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4098982">if</span>&nbsp;<span class="ident" id="4098985"><a href="/gostd/net/http/cookie.go.html#4100865">validCookieDomain</a></span><span class="op" id="4099002">(</span><span class="ident" id="4099003"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099004">.</span><span class="ident" id="4099005"><a href="/gostd/net/http/cookie.go.html#4096071">Domain</a></span><span class="op" id="4099011">)</span>&nbsp;<span class="op" id="4099013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4099018">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4099072">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4099130">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4099183">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099208">d</span>&nbsp;<span class="op" id="4099210">:=</span>&nbsp;<span class="ident" id="4099213"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099214">.</span><span class="ident" id="4099215"><a href="/gostd/net/http/cookie.go.html#4096071">Domain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099225">if</span>&nbsp;<span class="ident" id="4099228"><a href="/gostd/net/http/cookie.go.html#4099208">d</a></span><span class="op" id="4099229">[</span><span class="num" id="4099230">0</span><span class="op" id="4099231">]</span>&nbsp;<span class="op" id="4099233">==</span>&nbsp;<span class="string" id="4099236">&#39;.&#39;</span>&nbsp;<span class="op" id="4099240">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099246"><a href="/gostd/net/http/cookie.go.html#4099208">d</a></span>&nbsp;<span class="op" id="4099248">=</span>&nbsp;<span class="ident" id="4099250"><a href="/gostd/net/http/cookie.go.html#4099208">d</a></span><span class="op" id="4099251">[</span><span class="num" id="4099252">1</span><span class="op" id="4099253">:</span><span class="op" id="4099254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099264"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4099267">.</span><span class="ident" id="4099268"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4099275">(</span><span class="op" id="4099276">&amp;</span><span class="ident" id="4099277"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099278">,</span>&nbsp;<span class="string" id="4099280">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="4099293">,</span>&nbsp;<span class="ident" id="4099295"><a href="/gostd/net/http/cookie.go.html#4099208">d</a></span><span class="op" id="4099296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099300">}</span>&nbsp;<span class="keyword" id="4099302">else</span>&nbsp;<span class="op" id="4099307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099312"><a href="/gostd/net/http/cookie.go.html#4095712">log</a></span><span class="op" id="4099315">.</span><span class="ident" id="4099316"><a href="/gostd/log/log.go.html#4078664">Printf</a></span><span class="op" id="4099322">(</span><span class="string" id="4099323">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="4099386">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099392"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099393">.</span><span class="ident" id="4099394"><a href="/gostd/net/http/cookie.go.html#4096071">Domain</a></span><span class="op" id="4099400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099410">if</span>&nbsp;<span class="ident" id="4099413"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099414">.</span><span class="ident" id="4099415"><a href="/gostd/net/http/cookie.go.html#4096090">Expires</a></span><span class="op" id="4099422">.</span><span class="ident" id="4099423"><a href="/gostd/time/time.go.html#2744150">Unix</a></span><span class="op" id="4099427">(</span><span class="op" id="4099428">)</span>&nbsp;<span class="op" id="4099430">&gt;</span>&nbsp;<span class="num" id="4099432">0</span>&nbsp;<span class="op" id="4099434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099438"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4099441">.</span><span class="ident" id="4099442"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4099449">(</span><span class="op" id="4099450">&amp;</span><span class="ident" id="4099451"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099452">,</span>&nbsp;<span class="string" id="4099454">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="4099468">,</span>&nbsp;<span class="ident" id="4099470"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099471">.</span><span class="ident" id="4099472"><a href="/gostd/net/http/cookie.go.html#4096090">Expires</a></span><span class="op" id="4099479">.</span><span class="ident" id="4099480"><a href="/gostd/time/time.go.html#2743233">UTC</a></span><span class="op" id="4099483">(</span><span class="op" id="4099484">)</span><span class="op" id="4099485">.</span><span class="ident" id="4099486"><a href="/gostd/time/format.go.html#2690960">Format</a></span><span class="op" id="4099492">(</span><span class="ident" id="4099493"><a href="/gostd/net/http/cookie.go.html#4095748">time</a></span><span class="op" id="4099497">.</span><span class="ident" id="4099498"><a href="/gostd/time/format.go.html#2680409">RFC1123</a></span><span class="op" id="4099505">)</span><span class="op" id="4099506">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099512">if</span>&nbsp;<span class="ident" id="4099515"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099516">.</span><span class="ident" id="4099517"><a href="/gostd/net/http/cookie.go.html#4096315">MaxAge</a></span>&nbsp;<span class="op" id="4099524">&gt;</span>&nbsp;<span class="num" id="4099526">0</span>&nbsp;<span class="op" id="4099528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099532"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4099535">.</span><span class="ident" id="4099536"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4099543">(</span><span class="op" id="4099544">&amp;</span><span class="ident" id="4099545"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099546">,</span>&nbsp;<span class="string" id="4099548">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="4099562">,</span>&nbsp;<span class="ident" id="4099564"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099565">.</span><span class="ident" id="4099566"><a href="/gostd/net/http/cookie.go.html#4096315">MaxAge</a></span><span class="op" id="4099572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099575">}</span>&nbsp;<span class="keyword" id="4099577">else</span>&nbsp;<span class="keyword" id="4099582">if</span>&nbsp;<span class="ident" id="4099585"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099586">.</span><span class="ident" id="4099587"><a href="/gostd/net/http/cookie.go.html#4096315">MaxAge</a></span>&nbsp;<span class="op" id="4099594">&lt;</span>&nbsp;<span class="num" id="4099596">0</span>&nbsp;<span class="op" id="4099598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099602"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4099605">.</span><span class="ident" id="4099606"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4099613">(</span><span class="op" id="4099614">&amp;</span><span class="ident" id="4099615"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099616">,</span>&nbsp;<span class="string" id="4099618">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="4099631">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099637">if</span>&nbsp;<span class="ident" id="4099640"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099641">.</span><span class="ident" id="4099642"><a href="/gostd/net/http/cookie.go.html#4096344">HttpOnly</a></span>&nbsp;<span class="op" id="4099651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099655"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4099658">.</span><span class="ident" id="4099659"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4099666">(</span><span class="op" id="4099667">&amp;</span><span class="ident" id="4099668"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099669">,</span>&nbsp;<span class="string" id="4099671">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="4099683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099689">if</span>&nbsp;<span class="ident" id="4099692"><a href="/gostd/net/http/cookie.go.html#4098739">c</a></span><span class="op" id="4099693">.</span><span class="ident" id="4099694"><a href="/gostd/net/http/cookie.go.html#4096329">Secure</a></span>&nbsp;<span class="op" id="4099701">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099705"><a href="/gostd/net/http/cookie.go.html#4095705">fmt</a></span><span class="op" id="4099708">.</span><span class="ident" id="4099709"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4099716">(</span><span class="op" id="4099717">&amp;</span><span class="ident" id="4099718"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099719">,</span>&nbsp;<span class="string" id="4099721">&#34;;&nbsp;Secure&#34;</span><span class="op" id="4099731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4099734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4099737">return</span>&nbsp;<span class="ident" id="4099744"><a href="/gostd/net/http/cookie.go.html#4098773">b</a></span><span class="op" id="4099745">.</span><span class="ident" id="4099746"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="4099752">(</span><span class="op" id="4099753">)</span><br>
<span class="lineno"></span><span class="op" id="4099755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="4099758">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4099822">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="4099866">//</span><br>
<span class="lineno"></span><span class="comment" id="4099869">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="4099934">func</span>&nbsp;<span class="ident" id="4099939">readCookies</span><span class="op" id="4099950">(</span><span class="ident" id="4099951">h</span>&nbsp;<span class="ident" id="4099953"><a href="/gostd/net/http/header.go.html#4126117">Header</a></span><span class="op" id="4099959">,</span>&nbsp;<span class="ident" id="4099961">filter</span>&nbsp;<span class="builtintype" id="4099968">string</span><span class="op" id="4099974">)</span>&nbsp;<span class="op" id="4099976">[</span><span class="op" id="4099977">]</span><span class="op" id="4099978">*</span><span class="ident" id="4099979"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span>&nbsp;<span class="op" id="4099986">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4099989">cookies</span>&nbsp;<span class="op" id="4099997">:=</span>&nbsp;<span class="op" id="4100000">[</span><span class="op" id="4100001">]</span><span class="op" id="4100002">*</span><span class="ident" id="4100003"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span><span class="op" id="4100009">{</span><span class="op" id="4100010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100013">lines</span><span class="op" id="4100018">,</span>&nbsp;<span class="ident" id="4100020">ok</span>&nbsp;<span class="op" id="4100023">:=</span>&nbsp;<span class="ident" id="4100026"><a href="/gostd/net/http/cookie.go.html#4099951">h</a></span><span class="op" id="4100027">[</span><span class="string" id="4100028">&#34;Cookie&#34;</span><span class="op" id="4100036">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100039">if</span>&nbsp;<span class="op" id="4100042">!</span><span class="ident" id="4100043"><a href="/gostd/net/http/cookie.go.html#4100020">ok</a></span>&nbsp;<span class="op" id="4100046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100050">return</span>&nbsp;<span class="ident" id="4100057"><a href="/gostd/net/http/cookie.go.html#4099989">cookies</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100066">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100070">for</span>&nbsp;<span class="ident" id="4100074">_</span><span class="op" id="4100075">,</span>&nbsp;<span class="ident" id="4100077">line</span>&nbsp;<span class="op" id="4100082">:=</span>&nbsp;<span class="keyword" id="4100085">range</span>&nbsp;<span class="ident" id="4100091"><a href="/gostd/net/http/cookie.go.html#4100013">lines</a></span>&nbsp;<span class="op" id="4100097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100101">parts</span>&nbsp;<span class="op" id="4100107">:=</span>&nbsp;<span class="ident" id="4100110"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4100117">.</span><span class="ident" id="4100118"><a href="/gostd/strings/strings.go.html#2973136">Split</a></span><span class="op" id="4100123">(</span><span class="ident" id="4100124"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4100131">.</span><span class="ident" id="4100132"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="4100141">(</span><span class="ident" id="4100142"><a href="/gostd/net/http/cookie.go.html#4100077">line</a></span><span class="op" id="4100146">)</span><span class="op" id="4100147">,</span>&nbsp;<span class="string" id="4100149">&#34;;&#34;</span><span class="op" id="4100152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100156">if</span>&nbsp;<span class="builtinfunc" id="4100159">len</span><span class="op" id="4100162">(</span><span class="ident" id="4100163"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100168">)</span>&nbsp;<span class="op" id="4100170">==</span>&nbsp;<span class="num" id="4100173">1</span>&nbsp;<span class="op" id="4100175">&amp;&amp;</span>&nbsp;<span class="ident" id="4100178"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100183">[</span><span class="num" id="4100184">0</span><span class="op" id="4100185">]</span>&nbsp;<span class="op" id="4100187">==</span>&nbsp;<span class="string" id="4100190">&#34;&#34;</span>&nbsp;<span class="op" id="4100193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100198">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4100213">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100238">parsedPairs</span>&nbsp;<span class="op" id="4100250">:=</span>&nbsp;<span class="num" id="4100253">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100257">for</span>&nbsp;<span class="ident" id="4100261">i</span>&nbsp;<span class="op" id="4100263">:=</span>&nbsp;<span class="num" id="4100266">0</span><span class="op" id="4100267">;</span>&nbsp;<span class="ident" id="4100269"><a href="/gostd/net/http/cookie.go.html#4100261">i</a></span>&nbsp;<span class="op" id="4100271">&lt;</span>&nbsp;<span class="builtinfunc" id="4100273">len</span><span class="op" id="4100276">(</span><span class="ident" id="4100277"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100282">)</span><span class="op" id="4100283">;</span>&nbsp;<span class="ident" id="4100285"><a href="/gostd/net/http/cookie.go.html#4100261">i</a></span><span class="op" id="4100286">++</span>&nbsp;<span class="op" id="4100289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100294"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100299">[</span><span class="ident" id="4100300"><a href="/gostd/net/http/cookie.go.html#4100261">i</a></span><span class="op" id="4100301">]</span>&nbsp;<span class="op" id="4100303">=</span>&nbsp;<span class="ident" id="4100305"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4100312">.</span><span class="ident" id="4100313"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="4100322">(</span><span class="ident" id="4100323"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100328">[</span><span class="ident" id="4100329"><a href="/gostd/net/http/cookie.go.html#4100261">i</a></span><span class="op" id="4100330">]</span><span class="op" id="4100331">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100336">if</span>&nbsp;<span class="builtinfunc" id="4100339">len</span><span class="op" id="4100342">(</span><span class="ident" id="4100343"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100348">[</span><span class="ident" id="4100349"><a href="/gostd/net/http/cookie.go.html#4100261">i</a></span><span class="op" id="4100350">]</span><span class="op" id="4100351">)</span>&nbsp;<span class="op" id="4100353">==</span>&nbsp;<span class="num" id="4100356">0</span>&nbsp;<span class="op" id="4100358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100364">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100381">name</span><span class="op" id="4100385">,</span>&nbsp;<span class="ident" id="4100387">val</span>&nbsp;<span class="op" id="4100391">:=</span>&nbsp;<span class="ident" id="4100394"><a href="/gostd/net/http/cookie.go.html#4100101">parts</a></span><span class="op" id="4100399">[</span><span class="ident" id="4100400"><a href="/gostd/net/http/cookie.go.html#4100261">i</a></span><span class="op" id="4100401">]</span><span class="op" id="4100402">,</span>&nbsp;<span class="string" id="4100404">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100410">if</span>&nbsp;<span class="ident" id="4100413">j</span>&nbsp;<span class="op" id="4100415">:=</span>&nbsp;<span class="ident" id="4100418"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4100425">.</span><span class="ident" id="4100426"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="4100431">(</span><span class="ident" id="4100432"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span><span class="op" id="4100436">,</span>&nbsp;<span class="string" id="4100438">&#34;=&#34;</span><span class="op" id="4100441">)</span><span class="op" id="4100442">;</span>&nbsp;<span class="ident" id="4100444"><a href="/gostd/net/http/cookie.go.html#4100413">j</a></span>&nbsp;<span class="op" id="4100446">&gt;=</span>&nbsp;<span class="num" id="4100449">0</span>&nbsp;<span class="op" id="4100451">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100457"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span><span class="op" id="4100461">,</span>&nbsp;<span class="ident" id="4100463"><a href="/gostd/net/http/cookie.go.html#4100387">val</a></span>&nbsp;<span class="op" id="4100467">=</span>&nbsp;<span class="ident" id="4100469"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span><span class="op" id="4100473">[</span><span class="op" id="4100474">:</span><span class="ident" id="4100475"><a href="/gostd/net/http/cookie.go.html#4100413">j</a></span><span class="op" id="4100476">]</span><span class="op" id="4100477">,</span>&nbsp;<span class="ident" id="4100479"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span><span class="op" id="4100483">[</span><span class="ident" id="4100484"><a href="/gostd/net/http/cookie.go.html#4100413">j</a></span><span class="op" id="4100485">+</span><span class="num" id="4100486">1</span><span class="op" id="4100487">:</span><span class="op" id="4100488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100498">if</span>&nbsp;<span class="op" id="4100501">!</span><span class="ident" id="4100502"><a href="/gostd/net/http/cookie.go.html#4104284">isCookieNameValid</a></span><span class="op" id="4100519">(</span><span class="ident" id="4100520"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span><span class="op" id="4100524">)</span>&nbsp;<span class="op" id="4100526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100532">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100544">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100549">if</span>&nbsp;<span class="ident" id="4100552"><a href="/gostd/net/http/cookie.go.html#4099961">filter</a></span>&nbsp;<span class="op" id="4100559">!=</span>&nbsp;<span class="string" id="4100562">&#34;&#34;</span>&nbsp;<span class="op" id="4100565">&amp;&amp;</span>&nbsp;<span class="ident" id="4100568"><a href="/gostd/net/http/cookie.go.html#4099961">filter</a></span>&nbsp;<span class="op" id="4100575">!=</span>&nbsp;<span class="ident" id="4100578"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span>&nbsp;<span class="op" id="4100583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100589">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100606"><a href="/gostd/net/http/cookie.go.html#4100387">val</a></span><span class="op" id="4100609">,</span>&nbsp;<span class="ident" id="4100611">success</span>&nbsp;<span class="op" id="4100619">:=</span>&nbsp;<span class="ident" id="4100622"><a href="/gostd/net/http/cookie.go.html#4103945">parseCookieValue</a></span><span class="op" id="4100638">(</span><span class="ident" id="4100639"><a href="/gostd/net/http/cookie.go.html#4100387">val</a></span><span class="op" id="4100642">,</span>&nbsp;<span class="builtintype" id="4100644">true</span><span class="op" id="4100648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100653">if</span>&nbsp;<span class="op" id="4100656">!</span><span class="ident" id="4100657"><a href="/gostd/net/http/cookie.go.html#4100611">success</a></span>&nbsp;<span class="op" id="4100665">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100671">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100688"><a href="/gostd/net/http/cookie.go.html#4099989">cookies</a></span>&nbsp;<span class="op" id="4100696">=</span>&nbsp;<span class="builtinfunc" id="4100698">append</span><span class="op" id="4100704">(</span><span class="ident" id="4100705"><a href="/gostd/net/http/cookie.go.html#4099989">cookies</a></span><span class="op" id="4100712">,</span>&nbsp;<span class="op" id="4100714">&amp;</span><span class="ident" id="4100715"><a href="/gostd/net/http/cookie.go.html#4095997">Cookie</a></span><span class="op" id="4100721">{</span><span class="ident" id="4100722"><a href="/gostd/net/http/cookie.go.html#4096014">Name</a></span><span class="op" id="4100726">:</span>&nbsp;<span class="ident" id="4100728"><a href="/gostd/net/http/cookie.go.html#4100381">name</a></span><span class="op" id="4100732">,</span>&nbsp;<span class="ident" id="4100734"><a href="/gostd/net/http/cookie.go.html#4096033">Value</a></span><span class="op" id="4100739">:</span>&nbsp;<span class="ident" id="4100741"><a href="/gostd/net/http/cookie.go.html#4100387">val</a></span><span class="op" id="4100744">}</span><span class="op" id="4100745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4100750"><a href="/gostd/net/http/cookie.go.html#4100238">parsedPairs</a></span><span class="op" id="4100761">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100766">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100772">return</span>&nbsp;<span class="ident" id="4100779"><a href="/gostd/net/http/cookie.go.html#4099989">cookies</a></span><br>
<span class="lineno"></span><span class="op" id="4100787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4100790">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="4100860">func</span>&nbsp;<span class="ident" id="4100865">validCookieDomain</span><span class="op" id="4100882">(</span><span class="ident" id="4100883">v</span>&nbsp;<span class="builtintype" id="4100885">string</span><span class="op" id="4100891">)</span>&nbsp;<span class="builtintype" id="4100893">bool</span>&nbsp;<span class="op" id="4100898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100901">if</span>&nbsp;<span class="ident" id="4100904"><a href="/gostd/net/http/cookie.go.html#4101216">isCookieDomainName</a></span><span class="op" id="4100922">(</span><span class="ident" id="4100923"><a href="/gostd/net/http/cookie.go.html#4100883">v</a></span><span class="op" id="4100924">)</span>&nbsp;<span class="op" id="4100926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100930">return</span>&nbsp;<span class="builtintype" id="4100937">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4100943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100946">if</span>&nbsp;<span class="ident" id="4100949"><a href="/gostd/net/http/cookie.go.html#4095719">net</a></span><span class="op" id="4100952">.</span><span class="ident" id="4100953"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="4100960">(</span><span class="ident" id="4100961"><a href="/gostd/net/http/cookie.go.html#4100883">v</a></span><span class="op" id="4100962">)</span>&nbsp;<span class="op" id="4100964">!=</span>&nbsp;<span class="builtintype" id="4100967">nil</span>&nbsp;<span class="op" id="4100971">&amp;&amp;</span>&nbsp;<span class="op" id="4100974">!</span><span class="ident" id="4100975"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4100982">.</span><span class="ident" id="4100983"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="4100991">(</span><span class="ident" id="4100992"><a href="/gostd/net/http/cookie.go.html#4100883">v</a></span><span class="op" id="4100993">,</span>&nbsp;<span class="string" id="4100995">&#34;:&#34;</span><span class="op" id="4100998">)</span>&nbsp;<span class="op" id="4101000">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101004">return</span>&nbsp;<span class="builtintype" id="4101011">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101020">return</span>&nbsp;<span class="builtintype" id="4101027">false</span><br>
<span class="lineno"></span><span class="op" id="4101033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="4101036">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="4101110">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4101180">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="4101211">func</span>&nbsp;<span class="ident" id="4101216">isCookieDomainName</span><span class="op" id="4101234">(</span><span class="ident" id="4101235">s</span>&nbsp;<span class="builtintype" id="4101237">string</span><span class="op" id="4101243">)</span>&nbsp;<span class="builtintype" id="4101245">bool</span>&nbsp;<span class="op" id="4101250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101253">if</span>&nbsp;<span class="builtinfunc" id="4101256">len</span><span class="op" id="4101259">(</span><span class="ident" id="4101260"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span><span class="op" id="4101261">)</span>&nbsp;<span class="op" id="4101263">==</span>&nbsp;<span class="num" id="4101266">0</span>&nbsp;<span class="op" id="4101268">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101272">return</span>&nbsp;<span class="builtintype" id="4101279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101289">if</span>&nbsp;<span class="builtinfunc" id="4101292">len</span><span class="op" id="4101295">(</span><span class="ident" id="4101296"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span><span class="op" id="4101297">)</span>&nbsp;<span class="op" id="4101299">&gt;</span>&nbsp;<span class="num" id="4101301">255</span>&nbsp;<span class="op" id="4101305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101309">return</span>&nbsp;<span class="builtintype" id="4101316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101323">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101327">if</span>&nbsp;<span class="ident" id="4101330"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span><span class="op" id="4101331">[</span><span class="num" id="4101332">0</span><span class="op" id="4101333">]</span>&nbsp;<span class="op" id="4101335">==</span>&nbsp;<span class="string" id="4101338">&#39;.&#39;</span>&nbsp;<span class="op" id="4101342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101346">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101409"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span>&nbsp;<span class="op" id="4101411">=</span>&nbsp;<span class="ident" id="4101413"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span><span class="op" id="4101414">[</span><span class="num" id="4101415">1</span><span class="op" id="4101416">:</span><span class="op" id="4101417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101420">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101423">last</span>&nbsp;<span class="op" id="4101428">:=</span>&nbsp;<span class="builtintype" id="4101431">byte</span><span class="op" id="4101435">(</span><span class="string" id="4101436">&#39;.&#39;</span><span class="op" id="4101439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101442">ok</span>&nbsp;<span class="op" id="4101445">:=</span>&nbsp;<span class="builtintype" id="4101448">false</span>&nbsp;<span class="comment" id="4101454">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101487">partlen</span>&nbsp;<span class="op" id="4101495">:=</span>&nbsp;<span class="num" id="4101498">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101501">for</span>&nbsp;<span class="ident" id="4101505">i</span>&nbsp;<span class="op" id="4101507">:=</span>&nbsp;<span class="num" id="4101510">0</span><span class="op" id="4101511">;</span>&nbsp;<span class="ident" id="4101513"><a href="/gostd/net/http/cookie.go.html#4101505">i</a></span>&nbsp;<span class="op" id="4101515">&lt;</span>&nbsp;<span class="builtinfunc" id="4101517">len</span><span class="op" id="4101520">(</span><span class="ident" id="4101521"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span><span class="op" id="4101522">)</span><span class="op" id="4101523">;</span>&nbsp;<span class="ident" id="4101525"><a href="/gostd/net/http/cookie.go.html#4101505">i</a></span><span class="op" id="4101526">++</span>&nbsp;<span class="op" id="4101529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101533">c</span>&nbsp;<span class="op" id="4101535">:=</span>&nbsp;<span class="ident" id="4101538"><a href="/gostd/net/http/cookie.go.html#4101235">s</a></span><span class="op" id="4101539">[</span><span class="ident" id="4101540"><a href="/gostd/net/http/cookie.go.html#4101505">i</a></span><span class="op" id="4101541">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101545">switch</span>&nbsp;<span class="op" id="4101552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101556">default</span><span class="op" id="4101563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101568">return</span>&nbsp;<span class="builtintype" id="4101575">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101583">case</span>&nbsp;<span class="string" id="4101588">&#39;a&#39;</span>&nbsp;<span class="op" id="4101592">&lt;=</span>&nbsp;<span class="ident" id="4101595"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101597">&amp;&amp;</span>&nbsp;<span class="ident" id="4101600"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101602">&lt;=</span>&nbsp;<span class="string" id="4101605">&#39;z&#39;</span>&nbsp;<span class="op" id="4101609">||</span>&nbsp;<span class="string" id="4101612">&#39;A&#39;</span>&nbsp;<span class="op" id="4101616">&lt;=</span>&nbsp;<span class="ident" id="4101619"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101621">&amp;&amp;</span>&nbsp;<span class="ident" id="4101624"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101626">&lt;=</span>&nbsp;<span class="string" id="4101629">&#39;Z&#39;</span><span class="op" id="4101632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101637">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101693"><a href="/gostd/net/http/cookie.go.html#4101442">ok</a></span>&nbsp;<span class="op" id="4101696">=</span>&nbsp;<span class="builtintype" id="4101698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101706"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span><span class="op" id="4101713">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101718">case</span>&nbsp;<span class="string" id="4101723">&#39;0&#39;</span>&nbsp;<span class="op" id="4101727">&lt;=</span>&nbsp;<span class="ident" id="4101730"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101732">&amp;&amp;</span>&nbsp;<span class="ident" id="4101735"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101737">&lt;=</span>&nbsp;<span class="string" id="4101740">&#39;9&#39;</span><span class="op" id="4101743">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101748">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101759"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span><span class="op" id="4101766">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101771">case</span>&nbsp;<span class="ident" id="4101776"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101778">==</span>&nbsp;<span class="string" id="4101781">&#39;-&#39;</span><span class="op" id="4101784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101789">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101827">if</span>&nbsp;<span class="ident" id="4101830"><a href="/gostd/net/http/cookie.go.html#4101423">last</a></span>&nbsp;<span class="op" id="4101835">==</span>&nbsp;<span class="string" id="4101838">&#39;.&#39;</span>&nbsp;<span class="op" id="4101842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101848">return</span>&nbsp;<span class="builtintype" id="4101855">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101864">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4101869"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span><span class="op" id="4101876">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101881">case</span>&nbsp;<span class="ident" id="4101886"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span>&nbsp;<span class="op" id="4101888">==</span>&nbsp;<span class="string" id="4101891">&#39;.&#39;</span><span class="op" id="4101894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4101899">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101942">if</span>&nbsp;<span class="ident" id="4101945"><a href="/gostd/net/http/cookie.go.html#4101423">last</a></span>&nbsp;<span class="op" id="4101950">==</span>&nbsp;<span class="string" id="4101953">&#39;.&#39;</span>&nbsp;<span class="op" id="4101957">||</span>&nbsp;<span class="ident" id="4101960"><a href="/gostd/net/http/cookie.go.html#4101423">last</a></span>&nbsp;<span class="op" id="4101965">==</span>&nbsp;<span class="string" id="4101968">&#39;-&#39;</span>&nbsp;<span class="op" id="4101972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101978">return</span>&nbsp;<span class="builtintype" id="4101985">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4101994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4101999">if</span>&nbsp;<span class="ident" id="4102002"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span>&nbsp;<span class="op" id="4102010">&gt;</span>&nbsp;<span class="num" id="4102012">63</span>&nbsp;<span class="op" id="4102015">||</span>&nbsp;<span class="ident" id="4102018"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span>&nbsp;<span class="op" id="4102026">==</span>&nbsp;<span class="num" id="4102029">0</span>&nbsp;<span class="op" id="4102031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102037">return</span>&nbsp;<span class="builtintype" id="4102044">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102058"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span>&nbsp;<span class="op" id="4102066">=</span>&nbsp;<span class="num" id="4102068">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102076"><a href="/gostd/net/http/cookie.go.html#4101423">last</a></span>&nbsp;<span class="op" id="4102081">=</span>&nbsp;<span class="ident" id="4102083"><a href="/gostd/net/http/cookie.go.html#4101533">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102089">if</span>&nbsp;<span class="ident" id="4102092"><a href="/gostd/net/http/cookie.go.html#4101423">last</a></span>&nbsp;<span class="op" id="4102097">==</span>&nbsp;<span class="string" id="4102100">&#39;-&#39;</span>&nbsp;<span class="op" id="4102104">||</span>&nbsp;<span class="ident" id="4102107"><a href="/gostd/net/http/cookie.go.html#4101487">partlen</a></span>&nbsp;<span class="op" id="4102115">&gt;</span>&nbsp;<span class="num" id="4102117">63</span>&nbsp;<span class="op" id="4102120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102124">return</span>&nbsp;<span class="builtintype" id="4102131">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102142">return</span>&nbsp;<span class="ident" id="4102149"><a href="/gostd/net/http/cookie.go.html#4101442">ok</a></span><br>
<span class="lineno"></span><span class="op" id="4102152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4102155">var</span>&nbsp;<span class="ident" id="4102159">cookieNameSanitizer</span>&nbsp;<span class="op" id="4102179">=</span>&nbsp;<span class="ident" id="4102181"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4102188">.</span><span class="ident" id="4102189"><a href="/gostd/strings/replace.go.html#2949056">NewReplacer</a></span><span class="op" id="4102200">(</span><span class="string" id="4102201">&#34;\n&#34;</span><span class="op" id="4102205">,</span>&nbsp;<span class="string" id="4102207">&#34;-&#34;</span><span class="op" id="4102210">,</span>&nbsp;<span class="string" id="4102212">&#34;\r&#34;</span><span class="op" id="4102216">,</span>&nbsp;<span class="string" id="4102218">&#34;-&#34;</span><span class="op" id="4102221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4102224">func</span>&nbsp;<span class="ident" id="4102229">sanitizeCookieName</span><span class="op" id="4102247">(</span><span class="ident" id="4102248">n</span>&nbsp;<span class="builtintype" id="4102250">string</span><span class="op" id="4102256">)</span>&nbsp;<span class="builtintype" id="4102258">string</span>&nbsp;<span class="op" id="4102265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102268">return</span>&nbsp;<span class="ident" id="4102275"><a href="/gostd/net/http/cookie.go.html#4102159">cookieNameSanitizer</a></span><span class="op" id="4102294">.</span><span class="ident" id="4102295"><a href="/gostd/strings/replace.go.html#2950171">Replace</a></span><span class="op" id="4102302">(</span><span class="ident" id="4102303"><a href="/gostd/net/http/cookie.go.html#4102248">n</a></span><span class="op" id="4102304">)</span><br>
<span class="lineno"></span><span class="op" id="4102306">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="4102309">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="4102361">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="4102432">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="4102500">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="4102551">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="4102603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="4102632">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="4102699">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="4102768">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="4102794">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="4102850">func</span>&nbsp;<span class="ident" id="4102855">sanitizeCookieValue</span><span class="op" id="4102874">(</span><span class="ident" id="4102875">v</span>&nbsp;<span class="builtintype" id="4102877">string</span><span class="op" id="4102883">)</span>&nbsp;<span class="builtintype" id="4102885">string</span>&nbsp;<span class="op" id="4102892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4102895"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span>&nbsp;<span class="op" id="4102897">=</span>&nbsp;<span class="ident" id="4102899"><a href="/gostd/net/http/cookie.go.html#4103507">sanitizeOrWarn</a></span><span class="op" id="4102913">(</span><span class="string" id="4102914">&#34;Cookie.Value&#34;</span><span class="op" id="4102928">,</span>&nbsp;<span class="ident" id="4102930"><a href="/gostd/net/http/cookie.go.html#4103108">validCookieValueByte</a></span><span class="op" id="4102950">,</span>&nbsp;<span class="ident" id="4102952"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4102953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102956">if</span>&nbsp;<span class="builtinfunc" id="4102959">len</span><span class="op" id="4102962">(</span><span class="ident" id="4102963"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4102964">)</span>&nbsp;<span class="op" id="4102966">==</span>&nbsp;<span class="num" id="4102969">0</span>&nbsp;<span class="op" id="4102971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102975">return</span>&nbsp;<span class="ident" id="4102982"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4102985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4102988">if</span>&nbsp;<span class="ident" id="4102991"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4102992">[</span><span class="num" id="4102993">0</span><span class="op" id="4102994">]</span>&nbsp;<span class="op" id="4102996">==</span>&nbsp;<span class="string" id="4102999">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4103003">||</span>&nbsp;<span class="ident" id="4103006"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4103007">[</span><span class="num" id="4103008">0</span><span class="op" id="4103009">]</span>&nbsp;<span class="op" id="4103011">==</span>&nbsp;<span class="string" id="4103014">&#39;,&#39;</span>&nbsp;<span class="op" id="4103018">||</span>&nbsp;<span class="ident" id="4103021"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4103022">[</span><span class="builtinfunc" id="4103023">len</span><span class="op" id="4103026">(</span><span class="ident" id="4103027"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4103028">)</span><span class="op" id="4103029">-</span><span class="num" id="4103030">1</span><span class="op" id="4103031">]</span>&nbsp;<span class="op" id="4103033">==</span>&nbsp;<span class="string" id="4103036">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4103040">||</span>&nbsp;<span class="ident" id="4103043"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4103044">[</span><span class="builtinfunc" id="4103045">len</span><span class="op" id="4103048">(</span><span class="ident" id="4103049"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><span class="op" id="4103050">)</span><span class="op" id="4103051">-</span><span class="num" id="4103052">1</span><span class="op" id="4103053">]</span>&nbsp;<span class="op" id="4103055">==</span>&nbsp;<span class="string" id="4103058">&#39;,&#39;</span>&nbsp;<span class="op" id="4103062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103066">return</span>&nbsp;<span class="string" id="4103073">`&#34;`</span>&nbsp;<span class="op" id="4103077">+</span>&nbsp;<span class="ident" id="4103079"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span>&nbsp;<span class="op" id="4103081">+</span>&nbsp;<span class="string" id="4103083">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103091">return</span>&nbsp;<span class="ident" id="4103098"><a href="/gostd/net/http/cookie.go.html#4102875">v</a></span><br>
<span class="lineno">310</span><span class="op" id="4103100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4103103">func</span>&nbsp;<span class="ident" id="4103108">validCookieValueByte</span><span class="op" id="4103128">(</span><span class="ident" id="4103129">b</span>&nbsp;<span class="builtintype" id="4103131">byte</span><span class="op" id="4103135">)</span>&nbsp;<span class="builtintype" id="4103137">bool</span>&nbsp;<span class="op" id="4103142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103145">return</span>&nbsp;<span class="num" id="4103152">0x20</span>&nbsp;<span class="op" id="4103157">&lt;=</span>&nbsp;<span class="ident" id="4103160"><a href="/gostd/net/http/cookie.go.html#4103129">b</a></span>&nbsp;<span class="op" id="4103162">&amp;&amp;</span>&nbsp;<span class="ident" id="4103165"><a href="/gostd/net/http/cookie.go.html#4103129">b</a></span>&nbsp;<span class="op" id="4103167">&lt;</span>&nbsp;<span class="num" id="4103169">0x7f</span>&nbsp;<span class="op" id="4103174">&amp;&amp;</span>&nbsp;<span class="ident" id="4103177"><a href="/gostd/net/http/cookie.go.html#4103129">b</a></span>&nbsp;<span class="op" id="4103179">!=</span>&nbsp;<span class="string" id="4103182">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4103186">&amp;&amp;</span>&nbsp;<span class="ident" id="4103189"><a href="/gostd/net/http/cookie.go.html#4103129">b</a></span>&nbsp;<span class="op" id="4103191">!=</span>&nbsp;<span class="string" id="4103194">&#39;;&#39;</span>&nbsp;<span class="op" id="4103198">&amp;&amp;</span>&nbsp;<span class="ident" id="4103201"><a href="/gostd/net/http/cookie.go.html#4103129">b</a></span>&nbsp;<span class="op" id="4103203">!=</span>&nbsp;<span class="string" id="4103206">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="4103211">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="4103214">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="4103256">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="4103309">func</span>&nbsp;<span class="ident" id="4103314">sanitizeCookiePath</span><span class="op" id="4103332">(</span><span class="ident" id="4103333">v</span>&nbsp;<span class="builtintype" id="4103335">string</span><span class="op" id="4103341">)</span>&nbsp;<span class="builtintype" id="4103343">string</span>&nbsp;<span class="op" id="4103350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103353">return</span>&nbsp;<span class="ident" id="4103360"><a href="/gostd/net/http/cookie.go.html#4103507">sanitizeOrWarn</a></span><span class="op" id="4103374">(</span><span class="string" id="4103375">&#34;Cookie.Path&#34;</span><span class="op" id="4103388">,</span>&nbsp;<span class="ident" id="4103390"><a href="/gostd/net/http/cookie.go.html#4103422">validCookiePathByte</a></span><span class="op" id="4103409">,</span>&nbsp;<span class="ident" id="4103411"><a href="/gostd/net/http/cookie.go.html#4103333">v</a></span><span class="op" id="4103412">)</span><br>
<span class="lineno">320</span><span class="op" id="4103414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4103417">func</span>&nbsp;<span class="ident" id="4103422">validCookiePathByte</span><span class="op" id="4103441">(</span><span class="ident" id="4103442">b</span>&nbsp;<span class="builtintype" id="4103444">byte</span><span class="op" id="4103448">)</span>&nbsp;<span class="builtintype" id="4103450">bool</span>&nbsp;<span class="op" id="4103455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103458">return</span>&nbsp;<span class="num" id="4103465">0x20</span>&nbsp;<span class="op" id="4103470">&lt;=</span>&nbsp;<span class="ident" id="4103473"><a href="/gostd/net/http/cookie.go.html#4103442">b</a></span>&nbsp;<span class="op" id="4103475">&amp;&amp;</span>&nbsp;<span class="ident" id="4103478"><a href="/gostd/net/http/cookie.go.html#4103442">b</a></span>&nbsp;<span class="op" id="4103480">&lt;</span>&nbsp;<span class="num" id="4103482">0x7f</span>&nbsp;<span class="op" id="4103487">&amp;&amp;</span>&nbsp;<span class="ident" id="4103490"><a href="/gostd/net/http/cookie.go.html#4103442">b</a></span>&nbsp;<span class="op" id="4103492">!=</span>&nbsp;<span class="string" id="4103495">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="4103499">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4103502">func</span>&nbsp;<span class="ident" id="4103507">sanitizeOrWarn</span><span class="op" id="4103521">(</span><span class="ident" id="4103522">fieldName</span>&nbsp;<span class="builtintype" id="4103532">string</span><span class="op" id="4103538">,</span>&nbsp;<span class="ident" id="4103540">valid</span>&nbsp;<span class="keyword" id="4103546">func</span><span class="op" id="4103550">(</span><span class="builtintype" id="4103551">byte</span><span class="op" id="4103555">)</span>&nbsp;<span class="builtintype" id="4103557">bool</span><span class="op" id="4103561">,</span>&nbsp;<span class="ident" id="4103563">v</span>&nbsp;<span class="builtintype" id="4103565">string</span><span class="op" id="4103571">)</span>&nbsp;<span class="builtintype" id="4103573">string</span>&nbsp;<span class="op" id="4103580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103583">ok</span>&nbsp;<span class="op" id="4103586">:=</span>&nbsp;<span class="builtintype" id="4103589">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103595">for</span>&nbsp;<span class="ident" id="4103599">i</span>&nbsp;<span class="op" id="4103601">:=</span>&nbsp;<span class="num" id="4103604">0</span><span class="op" id="4103605">;</span>&nbsp;<span class="ident" id="4103607"><a href="/gostd/net/http/cookie.go.html#4103599">i</a></span>&nbsp;<span class="op" id="4103609">&lt;</span>&nbsp;<span class="builtinfunc" id="4103611">len</span><span class="op" id="4103614">(</span><span class="ident" id="4103615"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><span class="op" id="4103616">)</span><span class="op" id="4103617">;</span>&nbsp;<span class="ident" id="4103619"><a href="/gostd/net/http/cookie.go.html#4103599">i</a></span><span class="op" id="4103620">++</span>&nbsp;<span class="op" id="4103623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103627">if</span>&nbsp;<span class="ident" id="4103630"><a href="/gostd/net/http/cookie.go.html#4103540">valid</a></span><span class="op" id="4103635">(</span><span class="ident" id="4103636"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><span class="op" id="4103637">[</span><span class="ident" id="4103638"><a href="/gostd/net/http/cookie.go.html#4103599">i</a></span><span class="op" id="4103639">]</span><span class="op" id="4103640">)</span>&nbsp;<span class="op" id="4103642">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103647">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103662"><a href="/gostd/net/http/cookie.go.html#4095712">log</a></span><span class="op" id="4103665">.</span><span class="ident" id="4103666"><a href="/gostd/log/log.go.html#4078664">Printf</a></span><span class="op" id="4103672">(</span><span class="string" id="4103673">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="4103730">,</span>&nbsp;<span class="ident" id="4103732"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><span class="op" id="4103733">[</span><span class="ident" id="4103734"><a href="/gostd/net/http/cookie.go.html#4103599">i</a></span><span class="op" id="4103735">]</span><span class="op" id="4103736">,</span>&nbsp;<span class="ident" id="4103738"><a href="/gostd/net/http/cookie.go.html#4103522">fieldName</a></span><span class="op" id="4103747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103751"><a href="/gostd/net/http/cookie.go.html#4103583">ok</a></span>&nbsp;<span class="op" id="4103754">=</span>&nbsp;<span class="builtintype" id="4103756">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103764">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103774">if</span>&nbsp;<span class="ident" id="4103777"><a href="/gostd/net/http/cookie.go.html#4103583">ok</a></span>&nbsp;<span class="op" id="4103780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103784">return</span>&nbsp;<span class="ident" id="4103791"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103797">buf</span>&nbsp;<span class="op" id="4103801">:=</span>&nbsp;<span class="builtinfunc" id="4103804">make</span><span class="op" id="4103808">(</span><span class="op" id="4103809">[</span><span class="op" id="4103810">]</span><span class="builtintype" id="4103811">byte</span><span class="op" id="4103815">,</span>&nbsp;<span class="num" id="4103817">0</span><span class="op" id="4103818">,</span>&nbsp;<span class="builtinfunc" id="4103820">len</span><span class="op" id="4103823">(</span><span class="ident" id="4103824"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><span class="op" id="4103825">)</span><span class="op" id="4103826">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103829">for</span>&nbsp;<span class="ident" id="4103833">i</span>&nbsp;<span class="op" id="4103835">:=</span>&nbsp;<span class="num" id="4103838">0</span><span class="op" id="4103839">;</span>&nbsp;<span class="ident" id="4103841"><a href="/gostd/net/http/cookie.go.html#4103833">i</a></span>&nbsp;<span class="op" id="4103843">&lt;</span>&nbsp;<span class="builtinfunc" id="4103845">len</span><span class="op" id="4103848">(</span><span class="ident" id="4103849"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><span class="op" id="4103850">)</span><span class="op" id="4103851">;</span>&nbsp;<span class="ident" id="4103853"><a href="/gostd/net/http/cookie.go.html#4103833">i</a></span><span class="op" id="4103854">++</span>&nbsp;<span class="op" id="4103857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103861">if</span>&nbsp;<span class="ident" id="4103864">b</span>&nbsp;<span class="op" id="4103866">:=</span>&nbsp;<span class="ident" id="4103869"><a href="/gostd/net/http/cookie.go.html#4103563">v</a></span><span class="op" id="4103870">[</span><span class="ident" id="4103871"><a href="/gostd/net/http/cookie.go.html#4103833">i</a></span><span class="op" id="4103872">]</span><span class="op" id="4103873">;</span>&nbsp;<span class="ident" id="4103875"><a href="/gostd/net/http/cookie.go.html#4103540">valid</a></span><span class="op" id="4103880">(</span><span class="ident" id="4103881"><a href="/gostd/net/http/cookie.go.html#4103864">b</a></span><span class="op" id="4103882">)</span>&nbsp;<span class="op" id="4103884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103889"><a href="/gostd/net/http/cookie.go.html#4103797">buf</a></span>&nbsp;<span class="op" id="4103893">=</span>&nbsp;<span class="builtinfunc" id="4103895">append</span><span class="op" id="4103901">(</span><span class="ident" id="4103902"><a href="/gostd/net/http/cookie.go.html#4103797">buf</a></span><span class="op" id="4103905">,</span>&nbsp;<span class="ident" id="4103907"><a href="/gostd/net/http/cookie.go.html#4103864">b</a></span><span class="op" id="4103908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4103915">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4103918">return</span>&nbsp;<span class="builtintype" id="4103925">string</span><span class="op" id="4103931">(</span><span class="ident" id="4103932"><a href="/gostd/net/http/cookie.go.html#4103797">buf</a></span><span class="op" id="4103935">)</span><br>
<span class="lineno"></span><span class="op" id="4103937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4103940">func</span>&nbsp;<span class="ident" id="4103945">parseCookieValue</span><span class="op" id="4103961">(</span><span class="ident" id="4103962">raw</span>&nbsp;<span class="builtintype" id="4103966">string</span><span class="op" id="4103972">,</span>&nbsp;<span class="ident" id="4103974">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="4103991">bool</span><span class="op" id="4103995">)</span>&nbsp;<span class="op" id="4103997">(</span><span class="builtintype" id="4103998">string</span><span class="op" id="4104004">,</span>&nbsp;<span class="builtintype" id="4104006">bool</span><span class="op" id="4104010">)</span>&nbsp;<span class="op" id="4104012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4104015">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104049">if</span>&nbsp;<span class="ident" id="4104052"><a href="/gostd/net/http/cookie.go.html#4103974">allowDoubleQuote</a></span>&nbsp;<span class="op" id="4104069">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4104072">len</span><span class="op" id="4104075">(</span><span class="ident" id="4104076"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104079">)</span>&nbsp;<span class="op" id="4104081">&gt;</span>&nbsp;<span class="num" id="4104083">1</span>&nbsp;<span class="op" id="4104085">&amp;&amp;</span>&nbsp;<span class="ident" id="4104088"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104091">[</span><span class="num" id="4104092">0</span><span class="op" id="4104093">]</span>&nbsp;<span class="op" id="4104095">==</span>&nbsp;<span class="string" id="4104098">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4104102">&amp;&amp;</span>&nbsp;<span class="ident" id="4104105"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104108">[</span><span class="builtinfunc" id="4104109">len</span><span class="op" id="4104112">(</span><span class="ident" id="4104113"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104116">)</span><span class="op" id="4104117">-</span><span class="num" id="4104118">1</span><span class="op" id="4104119">]</span>&nbsp;<span class="op" id="4104121">==</span>&nbsp;<span class="string" id="4104124">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="4104128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4104132"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span>&nbsp;<span class="op" id="4104136">=</span>&nbsp;<span class="ident" id="4104138"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104141">[</span><span class="num" id="4104142">1</span>&nbsp;<span class="op" id="4104144">:</span>&nbsp;<span class="builtinfunc" id="4104146">len</span><span class="op" id="4104149">(</span><span class="ident" id="4104150"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104153">)</span><span class="op" id="4104154">-</span><span class="num" id="4104155">1</span><span class="op" id="4104156">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104162">for</span>&nbsp;<span class="ident" id="4104166">i</span>&nbsp;<span class="op" id="4104168">:=</span>&nbsp;<span class="num" id="4104171">0</span><span class="op" id="4104172">;</span>&nbsp;<span class="ident" id="4104174"><a href="/gostd/net/http/cookie.go.html#4104166">i</a></span>&nbsp;<span class="op" id="4104176">&lt;</span>&nbsp;<span class="builtinfunc" id="4104178">len</span><span class="op" id="4104181">(</span><span class="ident" id="4104182"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104185">)</span><span class="op" id="4104186">;</span>&nbsp;<span class="ident" id="4104188"><a href="/gostd/net/http/cookie.go.html#4104166">i</a></span><span class="op" id="4104189">++</span>&nbsp;<span class="op" id="4104192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104196">if</span>&nbsp;<span class="op" id="4104199">!</span><span class="ident" id="4104200"><a href="/gostd/net/http/cookie.go.html#4103108">validCookieValueByte</a></span><span class="op" id="4104220">(</span><span class="ident" id="4104221"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104224">[</span><span class="ident" id="4104225"><a href="/gostd/net/http/cookie.go.html#4104166">i</a></span><span class="op" id="4104226">]</span><span class="op" id="4104227">)</span>&nbsp;<span class="op" id="4104229">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104234">return</span>&nbsp;<span class="string" id="4104241">&#34;&#34;</span><span class="op" id="4104243">,</span>&nbsp;<span class="builtintype" id="4104245">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4104256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104259">return</span>&nbsp;<span class="ident" id="4104266"><a href="/gostd/net/http/cookie.go.html#4103962">raw</a></span><span class="op" id="4104269">,</span>&nbsp;<span class="builtintype" id="4104271">true</span><br>
<span class="lineno"></span><span class="op" id="4104276">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="4104279">func</span>&nbsp;<span class="ident" id="4104284">isCookieNameValid</span><span class="op" id="4104301">(</span><span class="ident" id="4104302">raw</span>&nbsp;<span class="builtintype" id="4104306">string</span><span class="op" id="4104312">)</span>&nbsp;<span class="builtintype" id="4104314">bool</span>&nbsp;<span class="op" id="4104319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4104322">return</span>&nbsp;<span class="ident" id="4104329"><a href="/gostd/net/http/cookie.go.html#4095737">strings</a></span><span class="op" id="4104336">.</span><span class="ident" id="4104337"><a href="/gostd/strings/strings.go.html#2980485">IndexFunc</a></span><span class="op" id="4104346">(</span><span class="ident" id="4104347"><a href="/gostd/net/http/cookie.go.html#4104302">raw</a></span><span class="op" id="4104350">,</span>&nbsp;<span class="ident" id="4104352"><a href="/gostd/net/http/lex.go.html#4133749">isNotToken</a></span><span class="op" id="4104362">)</span>&nbsp;<span class="op" id="4104364">&lt;</span>&nbsp;<span class="num" id="4104366">0</span><br>
<span class="lineno"></span><span class="op" id="4104368">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
