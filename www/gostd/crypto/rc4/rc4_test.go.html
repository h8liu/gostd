<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8245877">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8245932">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8245986">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8246037">package</span>&nbsp;<span class="ident" id="8246045">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8246050">import</span>&nbsp;<span class="op" id="8246057">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8246060">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8246069">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8246076">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8246086">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8246089">type</span>&nbsp;<span class="ident" id="8246094">rc4Test</span>&nbsp;<span class="keyword" id="8246102">struct</span>&nbsp;<span class="op" id="8246109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8246112">key</span><span class="op" id="8246115">,</span>&nbsp;<span class="ident" id="8246117">keystream</span>&nbsp;<span class="op" id="8246127">[</span><span class="op" id="8246128">]</span><span class="builtintype" id="8246129">byte</span><br>
<span class="lineno">15</span><span class="op" id="8246134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8246137">var</span>&nbsp;<span class="ident" id="8246141">golden</span>&nbsp;<span class="op" id="8246148">=</span>&nbsp;<span class="op" id="8246150">[</span><span class="op" id="8246151">]</span><span class="ident" id="8246152">rc4Test</span><span class="op" id="8246159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8246162">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8246225">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246303">[</span><span class="op" id="8246304">]</span><span class="builtintype" id="8246305">byte</span><span class="op" id="8246309">{</span><span class="num" id="8246310">0x01</span><span class="op" id="8246314">,</span>&nbsp;<span class="num" id="8246316">0x23</span><span class="op" id="8246320">,</span>&nbsp;<span class="num" id="8246322">0x45</span><span class="op" id="8246326">,</span>&nbsp;<span class="num" id="8246328">0x67</span><span class="op" id="8246332">,</span>&nbsp;<span class="num" id="8246334">0x89</span><span class="op" id="8246338">,</span>&nbsp;<span class="num" id="8246340">0xab</span><span class="op" id="8246344">,</span>&nbsp;<span class="num" id="8246346">0xcd</span><span class="op" id="8246350">,</span>&nbsp;<span class="num" id="8246352">0xef</span><span class="op" id="8246356">}</span><span class="op" id="8246357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246361">[</span><span class="op" id="8246362">]</span><span class="builtintype" id="8246363">byte</span><span class="op" id="8246367">{</span><span class="num" id="8246368">0x74</span><span class="op" id="8246372">,</span>&nbsp;<span class="num" id="8246374">0x94</span><span class="op" id="8246378">,</span>&nbsp;<span class="num" id="8246380">0xc2</span><span class="op" id="8246384">,</span>&nbsp;<span class="num" id="8246386">0xe7</span><span class="op" id="8246390">,</span>&nbsp;<span class="num" id="8246392">0x10</span><span class="op" id="8246396">,</span>&nbsp;<span class="num" id="8246398">0x4b</span><span class="op" id="8246402">,</span>&nbsp;<span class="num" id="8246404">0x08</span><span class="op" id="8246408">,</span>&nbsp;<span class="num" id="8246410">0x79</span><span class="op" id="8246414">}</span><span class="op" id="8246415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246418">}</span><span class="op" id="8246419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246422">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246426">[</span><span class="op" id="8246427">]</span><span class="builtintype" id="8246428">byte</span><span class="op" id="8246432">{</span><span class="num" id="8246433">0x00</span><span class="op" id="8246437">,</span>&nbsp;<span class="num" id="8246439">0x00</span><span class="op" id="8246443">,</span>&nbsp;<span class="num" id="8246445">0x00</span><span class="op" id="8246449">,</span>&nbsp;<span class="num" id="8246451">0x00</span><span class="op" id="8246455">,</span>&nbsp;<span class="num" id="8246457">0x00</span><span class="op" id="8246461">,</span>&nbsp;<span class="num" id="8246463">0x00</span><span class="op" id="8246467">,</span>&nbsp;<span class="num" id="8246469">0x00</span><span class="op" id="8246473">,</span>&nbsp;<span class="num" id="8246475">0x00</span><span class="op" id="8246479">}</span><span class="op" id="8246480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246484">[</span><span class="op" id="8246485">]</span><span class="builtintype" id="8246486">byte</span><span class="op" id="8246490">{</span><span class="num" id="8246491">0xde</span><span class="op" id="8246495">,</span>&nbsp;<span class="num" id="8246497">0x18</span><span class="op" id="8246501">,</span>&nbsp;<span class="num" id="8246503">0x89</span><span class="op" id="8246507">,</span>&nbsp;<span class="num" id="8246509">0x41</span><span class="op" id="8246513">,</span>&nbsp;<span class="num" id="8246515">0xa3</span><span class="op" id="8246519">,</span>&nbsp;<span class="num" id="8246521">0x37</span><span class="op" id="8246525">,</span>&nbsp;<span class="num" id="8246527">0x5d</span><span class="op" id="8246531">,</span>&nbsp;<span class="num" id="8246533">0x3a</span><span class="op" id="8246537">}</span><span class="op" id="8246538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246541">}</span><span class="op" id="8246542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246549">[</span><span class="op" id="8246550">]</span><span class="builtintype" id="8246551">byte</span><span class="op" id="8246555">{</span><span class="num" id="8246556">0xef</span><span class="op" id="8246560">,</span>&nbsp;<span class="num" id="8246562">0x01</span><span class="op" id="8246566">,</span>&nbsp;<span class="num" id="8246568">0x23</span><span class="op" id="8246572">,</span>&nbsp;<span class="num" id="8246574">0x45</span><span class="op" id="8246578">}</span><span class="op" id="8246579">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246583">[</span><span class="op" id="8246584">]</span><span class="builtintype" id="8246585">byte</span><span class="op" id="8246589">{</span><span class="num" id="8246590">0xd6</span><span class="op" id="8246594">,</span>&nbsp;<span class="num" id="8246596">0xa1</span><span class="op" id="8246600">,</span>&nbsp;<span class="num" id="8246602">0x41</span><span class="op" id="8246606">,</span>&nbsp;<span class="num" id="8246608">0xa7</span><span class="op" id="8246612">,</span>&nbsp;<span class="num" id="8246614">0xec</span><span class="op" id="8246618">,</span>&nbsp;<span class="num" id="8246620">0x3c</span><span class="op" id="8246624">,</span>&nbsp;<span class="num" id="8246626">0x38</span><span class="op" id="8246630">,</span>&nbsp;<span class="num" id="8246632">0xdf</span><span class="op" id="8246636">,</span>&nbsp;<span class="num" id="8246638">0xbd</span><span class="op" id="8246642">,</span>&nbsp;<span class="num" id="8246644">0x61</span><span class="op" id="8246648">}</span><span class="op" id="8246649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246652">}</span><span class="op" id="8246653">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8246657">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246732">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246736">[</span><span class="op" id="8246737">]</span><span class="builtintype" id="8246738">byte</span><span class="op" id="8246742">{</span><span class="num" id="8246743">0x4b</span><span class="op" id="8246747">,</span>&nbsp;<span class="num" id="8246749">0x65</span><span class="op" id="8246753">,</span>&nbsp;<span class="num" id="8246755">0x79</span><span class="op" id="8246759">}</span><span class="op" id="8246760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246764">[</span><span class="op" id="8246765">]</span><span class="builtintype" id="8246766">byte</span><span class="op" id="8246770">{</span><span class="num" id="8246771">0xeb</span><span class="op" id="8246775">,</span>&nbsp;<span class="num" id="8246777">0x9f</span><span class="op" id="8246781">,</span>&nbsp;<span class="num" id="8246783">0x77</span><span class="op" id="8246787">,</span>&nbsp;<span class="num" id="8246789">0x81</span><span class="op" id="8246793">,</span>&nbsp;<span class="num" id="8246795">0xb7</span><span class="op" id="8246799">,</span>&nbsp;<span class="num" id="8246801">0x34</span><span class="op" id="8246805">,</span>&nbsp;<span class="num" id="8246807">0xca</span><span class="op" id="8246811">,</span>&nbsp;<span class="num" id="8246813">0x72</span><span class="op" id="8246817">,</span>&nbsp;<span class="num" id="8246819">0xa7</span><span class="op" id="8246823">,</span>&nbsp;<span class="num" id="8246825">0x19</span><span class="op" id="8246829">}</span><span class="op" id="8246830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246833">}</span><span class="op" id="8246834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246841">[</span><span class="op" id="8246842">]</span><span class="builtintype" id="8246843">byte</span><span class="op" id="8246847">{</span><span class="num" id="8246848">0x57</span><span class="op" id="8246852">,</span>&nbsp;<span class="num" id="8246854">0x69</span><span class="op" id="8246858">,</span>&nbsp;<span class="num" id="8246860">0x6b</span><span class="op" id="8246864">,</span>&nbsp;<span class="num" id="8246866">0x69</span><span class="op" id="8246870">}</span><span class="op" id="8246871">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246875">[</span><span class="op" id="8246876">]</span><span class="builtintype" id="8246877">byte</span><span class="op" id="8246881">{</span><span class="num" id="8246882">0x60</span><span class="op" id="8246886">,</span>&nbsp;<span class="num" id="8246888">0x44</span><span class="op" id="8246892">,</span>&nbsp;<span class="num" id="8246894">0xdb</span><span class="op" id="8246898">,</span>&nbsp;<span class="num" id="8246900">0x6d</span><span class="op" id="8246904">,</span>&nbsp;<span class="num" id="8246906">0x41</span><span class="op" id="8246910">,</span>&nbsp;<span class="num" id="8246912">0xb7</span><span class="op" id="8246916">}</span><span class="op" id="8246917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246920">}</span><span class="op" id="8246921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246928">[</span><span class="op" id="8246929">]</span><span class="builtintype" id="8246930">byte</span><span class="op" id="8246934">{</span><span class="num" id="8246935">0x00</span><span class="op" id="8246939">,</span>&nbsp;<span class="num" id="8246941">0x00</span><span class="op" id="8246945">,</span>&nbsp;<span class="num" id="8246947">0x00</span><span class="op" id="8246951">,</span>&nbsp;<span class="num" id="8246953">0x00</span><span class="op" id="8246957">,</span>&nbsp;<span class="num" id="8246959">0x00</span><span class="op" id="8246963">,</span>&nbsp;<span class="num" id="8246965">0x00</span><span class="op" id="8246969">,</span>&nbsp;<span class="num" id="8246971">0x00</span><span class="op" id="8246975">,</span>&nbsp;<span class="num" id="8246977">0x00</span><span class="op" id="8246981">}</span><span class="op" id="8246982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8246986">[</span><span class="op" id="8246987">]</span><span class="builtintype" id="8246988">byte</span><span class="op" id="8246992">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8246997">0xde</span><span class="op" id="8247001">,</span>&nbsp;<span class="num" id="8247003">0x18</span><span class="op" id="8247007">,</span>&nbsp;<span class="num" id="8247009">0x89</span><span class="op" id="8247013">,</span>&nbsp;<span class="num" id="8247015">0x41</span><span class="op" id="8247019">,</span>&nbsp;<span class="num" id="8247021">0xa3</span><span class="op" id="8247025">,</span>&nbsp;<span class="num" id="8247027">0x37</span><span class="op" id="8247031">,</span>&nbsp;<span class="num" id="8247033">0x5d</span><span class="op" id="8247037">,</span>&nbsp;<span class="num" id="8247039">0x3a</span><span class="op" id="8247043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247048">0x8a</span><span class="op" id="8247052">,</span>&nbsp;<span class="num" id="8247054">0x06</span><span class="op" id="8247058">,</span>&nbsp;<span class="num" id="8247060">0x1e</span><span class="op" id="8247064">,</span>&nbsp;<span class="num" id="8247066">0x67</span><span class="op" id="8247070">,</span>&nbsp;<span class="num" id="8247072">0x57</span><span class="op" id="8247076">,</span>&nbsp;<span class="num" id="8247078">0x6e</span><span class="op" id="8247082">,</span>&nbsp;<span class="num" id="8247084">0x92</span><span class="op" id="8247088">,</span>&nbsp;<span class="num" id="8247090">0x6d</span><span class="op" id="8247094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247099">0xc7</span><span class="op" id="8247103">,</span>&nbsp;<span class="num" id="8247105">0x1a</span><span class="op" id="8247109">,</span>&nbsp;<span class="num" id="8247111">0x7f</span><span class="op" id="8247115">,</span>&nbsp;<span class="num" id="8247117">0xa3</span><span class="op" id="8247121">,</span>&nbsp;<span class="num" id="8247123">0xf0</span><span class="op" id="8247127">,</span>&nbsp;<span class="num" id="8247129">0xcc</span><span class="op" id="8247133">,</span>&nbsp;<span class="num" id="8247135">0xeb</span><span class="op" id="8247139">,</span>&nbsp;<span class="num" id="8247141">0x97</span><span class="op" id="8247145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247150">0x45</span><span class="op" id="8247154">,</span>&nbsp;<span class="num" id="8247156">0x2b</span><span class="op" id="8247160">,</span>&nbsp;<span class="num" id="8247162">0x4d</span><span class="op" id="8247166">,</span>&nbsp;<span class="num" id="8247168">0x32</span><span class="op" id="8247172">,</span>&nbsp;<span class="num" id="8247174">0x27</span><span class="op" id="8247178">,</span>&nbsp;<span class="num" id="8247180">0x96</span><span class="op" id="8247184">,</span>&nbsp;<span class="num" id="8247186">0x5f</span><span class="op" id="8247190">,</span>&nbsp;<span class="num" id="8247192">0x9e</span><span class="op" id="8247196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247201">0xa8</span><span class="op" id="8247205">,</span>&nbsp;<span class="num" id="8247207">0xcc</span><span class="op" id="8247211">,</span>&nbsp;<span class="num" id="8247213">0x75</span><span class="op" id="8247217">,</span>&nbsp;<span class="num" id="8247219">0x07</span><span class="op" id="8247223">,</span>&nbsp;<span class="num" id="8247225">0x6d</span><span class="op" id="8247229">,</span>&nbsp;<span class="num" id="8247231">0x9f</span><span class="op" id="8247235">,</span>&nbsp;<span class="num" id="8247237">0xb9</span><span class="op" id="8247241">,</span>&nbsp;<span class="num" id="8247243">0xc5</span><span class="op" id="8247247">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247252">0x41</span><span class="op" id="8247256">,</span>&nbsp;<span class="num" id="8247258">0x7a</span><span class="op" id="8247262">,</span>&nbsp;<span class="num" id="8247264">0xa5</span><span class="op" id="8247268">,</span>&nbsp;<span class="num" id="8247270">0xcb</span><span class="op" id="8247274">,</span>&nbsp;<span class="num" id="8247276">0x30</span><span class="op" id="8247280">,</span>&nbsp;<span class="num" id="8247282">0xfc</span><span class="op" id="8247286">,</span>&nbsp;<span class="num" id="8247288">0x22</span><span class="op" id="8247292">,</span>&nbsp;<span class="num" id="8247294">0x19</span><span class="op" id="8247298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247303">0x8b</span><span class="op" id="8247307">,</span>&nbsp;<span class="num" id="8247309">0x34</span><span class="op" id="8247313">,</span>&nbsp;<span class="num" id="8247315">0x98</span><span class="op" id="8247319">,</span>&nbsp;<span class="num" id="8247321">0x2d</span><span class="op" id="8247325">,</span>&nbsp;<span class="num" id="8247327">0xbb</span><span class="op" id="8247331">,</span>&nbsp;<span class="num" id="8247333">0x62</span><span class="op" id="8247337">,</span>&nbsp;<span class="num" id="8247339">0x9e</span><span class="op" id="8247343">,</span>&nbsp;<span class="num" id="8247345">0xc0</span><span class="op" id="8247349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247354">0x4b</span><span class="op" id="8247358">,</span>&nbsp;<span class="num" id="8247360">0x4f</span><span class="op" id="8247364">,</span>&nbsp;<span class="num" id="8247366">0x8b</span><span class="op" id="8247370">,</span>&nbsp;<span class="num" id="8247372">0x05</span><span class="op" id="8247376">,</span>&nbsp;<span class="num" id="8247378">0xa0</span><span class="op" id="8247382">,</span>&nbsp;<span class="num" id="8247384">0x71</span><span class="op" id="8247388">,</span>&nbsp;<span class="num" id="8247390">0x08</span><span class="op" id="8247394">,</span>&nbsp;<span class="num" id="8247396">0x50</span><span class="op" id="8247400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247405">0x92</span><span class="op" id="8247409">,</span>&nbsp;<span class="num" id="8247411">0xa0</span><span class="op" id="8247415">,</span>&nbsp;<span class="num" id="8247417">0xc3</span><span class="op" id="8247421">,</span>&nbsp;<span class="num" id="8247423">0x58</span><span class="op" id="8247427">,</span>&nbsp;<span class="num" id="8247429">0x4a</span><span class="op" id="8247433">,</span>&nbsp;<span class="num" id="8247435">0x48</span><span class="op" id="8247439">,</span>&nbsp;<span class="num" id="8247441">0xe4</span><span class="op" id="8247445">,</span>&nbsp;<span class="num" id="8247447">0xa3</span><span class="op" id="8247451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247456">0x0a</span><span class="op" id="8247460">,</span>&nbsp;<span class="num" id="8247462">0x39</span><span class="op" id="8247466">,</span>&nbsp;<span class="num" id="8247468">0x7b</span><span class="op" id="8247472">,</span>&nbsp;<span class="num" id="8247474">0x8a</span><span class="op" id="8247478">,</span>&nbsp;<span class="num" id="8247480">0xcd</span><span class="op" id="8247484">,</span>&nbsp;<span class="num" id="8247486">0x1d</span><span class="op" id="8247490">,</span>&nbsp;<span class="num" id="8247492">0x00</span><span class="op" id="8247496">,</span>&nbsp;<span class="num" id="8247498">0x9e</span><span class="op" id="8247502">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247507">0xc8</span><span class="op" id="8247511">,</span>&nbsp;<span class="num" id="8247513">0x7d</span><span class="op" id="8247517">,</span>&nbsp;<span class="num" id="8247519">0x68</span><span class="op" id="8247523">,</span>&nbsp;<span class="num" id="8247525">0x11</span><span class="op" id="8247529">,</span>&nbsp;<span class="num" id="8247531">0xf2</span><span class="op" id="8247535">,</span>&nbsp;<span class="num" id="8247537">0x2c</span><span class="op" id="8247541">,</span>&nbsp;<span class="num" id="8247543">0xf4</span><span class="op" id="8247547">,</span>&nbsp;<span class="num" id="8247549">0x9c</span><span class="op" id="8247553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247558">0xa3</span><span class="op" id="8247562">,</span>&nbsp;<span class="num" id="8247564">0xe5</span><span class="op" id="8247568">,</span>&nbsp;<span class="num" id="8247570">0x93</span><span class="op" id="8247574">,</span>&nbsp;<span class="num" id="8247576">0x54</span><span class="op" id="8247580">,</span>&nbsp;<span class="num" id="8247582">0xb9</span><span class="op" id="8247586">,</span>&nbsp;<span class="num" id="8247588">0x45</span><span class="op" id="8247592">,</span>&nbsp;<span class="num" id="8247594">0x15</span><span class="op" id="8247598">,</span>&nbsp;<span class="num" id="8247600">0x35</span><span class="op" id="8247604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247609">0xa2</span><span class="op" id="8247613">,</span>&nbsp;<span class="num" id="8247615">0x18</span><span class="op" id="8247619">,</span>&nbsp;<span class="num" id="8247621">0x7a</span><span class="op" id="8247625">,</span>&nbsp;<span class="num" id="8247627">0x86</span><span class="op" id="8247631">,</span>&nbsp;<span class="num" id="8247633">0x42</span><span class="op" id="8247637">,</span>&nbsp;<span class="num" id="8247639">0x6c</span><span class="op" id="8247643">,</span>&nbsp;<span class="num" id="8247645">0xca</span><span class="op" id="8247649">,</span>&nbsp;<span class="num" id="8247651">0x7d</span><span class="op" id="8247655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247660">0x5e</span><span class="op" id="8247664">,</span>&nbsp;<span class="num" id="8247666">0x82</span><span class="op" id="8247670">,</span>&nbsp;<span class="num" id="8247672">0x3e</span><span class="op" id="8247676">,</span>&nbsp;<span class="num" id="8247678">0xba</span><span class="op" id="8247682">,</span>&nbsp;<span class="num" id="8247684">0x00</span><span class="op" id="8247688">,</span>&nbsp;<span class="num" id="8247690">0x44</span><span class="op" id="8247694">,</span>&nbsp;<span class="num" id="8247696">0x12</span><span class="op" id="8247700">,</span>&nbsp;<span class="num" id="8247702">0x67</span><span class="op" id="8247706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247711">0x12</span><span class="op" id="8247715">,</span>&nbsp;<span class="num" id="8247717">0x57</span><span class="op" id="8247721">,</span>&nbsp;<span class="num" id="8247723">0xb8</span><span class="op" id="8247727">,</span>&nbsp;<span class="num" id="8247729">0xd8</span><span class="op" id="8247733">,</span>&nbsp;<span class="num" id="8247735">0x60</span><span class="op" id="8247739">,</span>&nbsp;<span class="num" id="8247741">0xae</span><span class="op" id="8247745">,</span>&nbsp;<span class="num" id="8247747">0x4c</span><span class="op" id="8247751">,</span>&nbsp;<span class="num" id="8247753">0xbd</span><span class="op" id="8247757">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247762">0x4c</span><span class="op" id="8247766">,</span>&nbsp;<span class="num" id="8247768">0x49</span><span class="op" id="8247772">,</span>&nbsp;<span class="num" id="8247774">0x06</span><span class="op" id="8247778">,</span>&nbsp;<span class="num" id="8247780">0xbb</span><span class="op" id="8247784">,</span>&nbsp;<span class="num" id="8247786">0xc5</span><span class="op" id="8247790">,</span>&nbsp;<span class="num" id="8247792">0x35</span><span class="op" id="8247796">,</span>&nbsp;<span class="num" id="8247798">0xef</span><span class="op" id="8247802">,</span>&nbsp;<span class="num" id="8247804">0xe1</span><span class="op" id="8247808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247813">0x58</span><span class="op" id="8247817">,</span>&nbsp;<span class="num" id="8247819">0x7f</span><span class="op" id="8247823">,</span>&nbsp;<span class="num" id="8247825">0x08</span><span class="op" id="8247829">,</span>&nbsp;<span class="num" id="8247831">0xdb</span><span class="op" id="8247835">,</span>&nbsp;<span class="num" id="8247837">0x33</span><span class="op" id="8247841">,</span>&nbsp;<span class="num" id="8247843">0x95</span><span class="op" id="8247847">,</span>&nbsp;<span class="num" id="8247849">0x5c</span><span class="op" id="8247853">,</span>&nbsp;<span class="num" id="8247855">0xdb</span><span class="op" id="8247859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247864">0xcb</span><span class="op" id="8247868">,</span>&nbsp;<span class="num" id="8247870">0xad</span><span class="op" id="8247874">,</span>&nbsp;<span class="num" id="8247876">0x9b</span><span class="op" id="8247880">,</span>&nbsp;<span class="num" id="8247882">0x10</span><span class="op" id="8247886">,</span>&nbsp;<span class="num" id="8247888">0xf5</span><span class="op" id="8247892">,</span>&nbsp;<span class="num" id="8247894">0x3f</span><span class="op" id="8247898">,</span>&nbsp;<span class="num" id="8247900">0xc4</span><span class="op" id="8247904">,</span>&nbsp;<span class="num" id="8247906">0xe5</span><span class="op" id="8247910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247915">0x2c</span><span class="op" id="8247919">,</span>&nbsp;<span class="num" id="8247921">0x59</span><span class="op" id="8247925">,</span>&nbsp;<span class="num" id="8247927">0x15</span><span class="op" id="8247931">,</span>&nbsp;<span class="num" id="8247933">0x65</span><span class="op" id="8247937">,</span>&nbsp;<span class="num" id="8247939">0x51</span><span class="op" id="8247943">,</span>&nbsp;<span class="num" id="8247945">0x84</span><span class="op" id="8247949">,</span>&nbsp;<span class="num" id="8247951">0x87</span><span class="op" id="8247955">,</span>&nbsp;<span class="num" id="8247957">0xfe</span><span class="op" id="8247961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8247966">0x08</span><span class="op" id="8247970">,</span>&nbsp;<span class="num" id="8247972">0x4d</span><span class="op" id="8247976">,</span>&nbsp;<span class="num" id="8247978">0x0e</span><span class="op" id="8247982">,</span>&nbsp;<span class="num" id="8247984">0x3f</span><span class="op" id="8247988">,</span>&nbsp;<span class="num" id="8247990">0x03</span><span class="op" id="8247994">,</span>&nbsp;<span class="num" id="8247996">0xde</span><span class="op" id="8248000">,</span>&nbsp;<span class="num" id="8248002">0xbc</span><span class="op" id="8248006">,</span>&nbsp;<span class="num" id="8248008">0xc9</span><span class="op" id="8248012">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248017">0xda</span><span class="op" id="8248021">,</span>&nbsp;<span class="num" id="8248023">0x1c</span><span class="op" id="8248027">,</span>&nbsp;<span class="num" id="8248029">0xe9</span><span class="op" id="8248033">,</span>&nbsp;<span class="num" id="8248035">0x0d</span><span class="op" id="8248039">,</span>&nbsp;<span class="num" id="8248041">0x08</span><span class="op" id="8248045">,</span>&nbsp;<span class="num" id="8248047">0x5c</span><span class="op" id="8248051">,</span>&nbsp;<span class="num" id="8248053">0x2d</span><span class="op" id="8248057">,</span>&nbsp;<span class="num" id="8248059">0x8a</span><span class="op" id="8248063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248068">0x19</span><span class="op" id="8248072">,</span>&nbsp;<span class="num" id="8248074">0xd8</span><span class="op" id="8248078">,</span>&nbsp;<span class="num" id="8248080">0x37</span><span class="op" id="8248084">,</span>&nbsp;<span class="num" id="8248086">0x30</span><span class="op" id="8248090">,</span>&nbsp;<span class="num" id="8248092">0x86</span><span class="op" id="8248096">,</span>&nbsp;<span class="num" id="8248098">0x16</span><span class="op" id="8248102">,</span>&nbsp;<span class="num" id="8248104">0x36</span><span class="op" id="8248108">,</span>&nbsp;<span class="num" id="8248110">0x92</span><span class="op" id="8248114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248119">0x14</span><span class="op" id="8248123">,</span>&nbsp;<span class="num" id="8248125">0x2b</span><span class="op" id="8248129">,</span>&nbsp;<span class="num" id="8248131">0xd8</span><span class="op" id="8248135">,</span>&nbsp;<span class="num" id="8248137">0xfc</span><span class="op" id="8248141">,</span>&nbsp;<span class="num" id="8248143">0x5d</span><span class="op" id="8248147">,</span>&nbsp;<span class="num" id="8248149">0x7a</span><span class="op" id="8248153">,</span>&nbsp;<span class="num" id="8248155">0x73</span><span class="op" id="8248159">,</span>&nbsp;<span class="num" id="8248161">0x49</span><span class="op" id="8248165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248170">0x6a</span><span class="op" id="8248174">,</span>&nbsp;<span class="num" id="8248176">0x8e</span><span class="op" id="8248180">,</span>&nbsp;<span class="num" id="8248182">0x59</span><span class="op" id="8248186">,</span>&nbsp;<span class="num" id="8248188">0xee</span><span class="op" id="8248192">,</span>&nbsp;<span class="num" id="8248194">0x7e</span><span class="op" id="8248198">,</span>&nbsp;<span class="num" id="8248200">0xcf</span><span class="op" id="8248204">,</span>&nbsp;<span class="num" id="8248206">0x6b</span><span class="op" id="8248210">,</span>&nbsp;<span class="num" id="8248212">0x94</span><span class="op" id="8248216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248221">0x06</span><span class="op" id="8248225">,</span>&nbsp;<span class="num" id="8248227">0x63</span><span class="op" id="8248231">,</span>&nbsp;<span class="num" id="8248233">0xf4</span><span class="op" id="8248237">,</span>&nbsp;<span class="num" id="8248239">0xa6</span><span class="op" id="8248243">,</span>&nbsp;<span class="num" id="8248245">0xbe</span><span class="op" id="8248249">,</span>&nbsp;<span class="num" id="8248251">0xe6</span><span class="op" id="8248255">,</span>&nbsp;<span class="num" id="8248257">0x5b</span><span class="op" id="8248261">,</span>&nbsp;<span class="num" id="8248263">0xd2</span><span class="op" id="8248267">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248272">0xc8</span><span class="op" id="8248276">,</span>&nbsp;<span class="num" id="8248278">0x5c</span><span class="op" id="8248282">,</span>&nbsp;<span class="num" id="8248284">0x46</span><span class="op" id="8248288">,</span>&nbsp;<span class="num" id="8248290">0x98</span><span class="op" id="8248294">,</span>&nbsp;<span class="num" id="8248296">0x6c</span><span class="op" id="8248300">,</span>&nbsp;<span class="num" id="8248302">0x1b</span><span class="op" id="8248306">,</span>&nbsp;<span class="num" id="8248308">0xef</span><span class="op" id="8248312">,</span>&nbsp;<span class="num" id="8248314">0x34</span><span class="op" id="8248318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248323">0x90</span><span class="op" id="8248327">,</span>&nbsp;<span class="num" id="8248329">0xd3</span><span class="op" id="8248333">,</span>&nbsp;<span class="num" id="8248335">0x7b</span><span class="op" id="8248339">,</span>&nbsp;<span class="num" id="8248341">0x38</span><span class="op" id="8248345">,</span>&nbsp;<span class="num" id="8248347">0xda</span><span class="op" id="8248351">,</span>&nbsp;<span class="num" id="8248353">0x85</span><span class="op" id="8248357">,</span>&nbsp;<span class="num" id="8248359">0xd3</span><span class="op" id="8248363">,</span>&nbsp;<span class="num" id="8248365">0x2e</span><span class="op" id="8248369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8248374">0x97</span><span class="op" id="8248378">,</span>&nbsp;<span class="num" id="8248380">0x39</span><span class="op" id="8248384">,</span>&nbsp;<span class="num" id="8248386">0xcb</span><span class="op" id="8248390">,</span>&nbsp;<span class="num" id="8248392">0x23</span><span class="op" id="8248396">,</span>&nbsp;<span class="num" id="8248398">0x4a</span><span class="op" id="8248402">,</span>&nbsp;<span class="num" id="8248404">0x2b</span><span class="op" id="8248408">,</span>&nbsp;<span class="num" id="8248410">0xe7</span><span class="op" id="8248414">,</span>&nbsp;<span class="num" id="8248416">0x40</span><span class="op" id="8248420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8248424">}</span><span class="op" id="8248425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8248428">}</span><span class="op" id="8248429">,</span><br>
<span class="lineno">75</span><span class="op" id="8248431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8248434">func</span>&nbsp;<span class="ident" id="8248439">testEncrypt</span><span class="op" id="8248450">(</span><span class="ident" id="8248451">t</span>&nbsp;<span class="op" id="8248453">*</span><span class="ident" id="8248454">testing</span><span class="op" id="8248461">.</span><span class="ident" id="8248462">T</span><span class="op" id="8248463">,</span>&nbsp;<span class="ident" id="8248465">desc</span>&nbsp;<span class="builtintype" id="8248470">string</span><span class="op" id="8248476">,</span>&nbsp;<span class="ident" id="8248478">c</span>&nbsp;<span class="op" id="8248480">*</span><span class="ident" id="8248481">Cipher</span><span class="op" id="8248487">,</span>&nbsp;<span class="ident" id="8248489">src</span><span class="op" id="8248492">,</span>&nbsp;<span class="ident" id="8248494">expect</span>&nbsp;<span class="op" id="8248501">[</span><span class="op" id="8248502">]</span><span class="builtintype" id="8248503">byte</span><span class="op" id="8248507">)</span>&nbsp;<span class="op" id="8248509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248512">dst</span>&nbsp;<span class="op" id="8248516">:=</span>&nbsp;<span class="builtinfunc" id="8248519">make</span><span class="op" id="8248523">(</span><span class="op" id="8248524">[</span><span class="op" id="8248525">]</span><span class="builtintype" id="8248526">byte</span><span class="op" id="8248530">,</span>&nbsp;<span class="builtinfunc" id="8248532">len</span><span class="op" id="8248535">(</span><span class="ident" id="8248536">src</span><span class="op" id="8248539">)</span><span class="op" id="8248540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248543">c</span><span class="op" id="8248544">.</span><span class="ident" id="8248545">XORKeyStream</span><span class="op" id="8248557">(</span><span class="ident" id="8248558">dst</span><span class="op" id="8248561">,</span>&nbsp;<span class="ident" id="8248563">src</span><span class="op" id="8248566">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8248569">for</span>&nbsp;<span class="ident" id="8248573">i</span><span class="op" id="8248574">,</span>&nbsp;<span class="ident" id="8248576">v</span>&nbsp;<span class="op" id="8248578">:=</span>&nbsp;<span class="keyword" id="8248581">range</span>&nbsp;<span class="ident" id="8248587">dst</span>&nbsp;<span class="op" id="8248591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8248595">if</span>&nbsp;<span class="ident" id="8248598">v</span>&nbsp;<span class="op" id="8248600">!=</span>&nbsp;<span class="ident" id="8248603">expect</span><span class="op" id="8248609">[</span><span class="ident" id="8248610">i</span><span class="op" id="8248611">]</span>&nbsp;<span class="op" id="8248613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248618">t</span><span class="op" id="8248619">.</span><span class="ident" id="8248620">Fatalf</span><span class="op" id="8248626">(</span><span class="string" id="8248627">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="8248671">,</span>&nbsp;<span class="ident" id="8248673">desc</span><span class="op" id="8248677">,</span>&nbsp;<span class="ident" id="8248679">i</span><span class="op" id="8248680">,</span>&nbsp;<span class="ident" id="8248682">dst</span><span class="op" id="8248685">,</span>&nbsp;<span class="ident" id="8248687">expect</span><span class="op" id="8248693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8248697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8248700">}</span><br>
<span class="lineno">85</span><span class="op" id="8248702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8248705">func</span>&nbsp;<span class="ident" id="8248710">TestGolden</span><span class="op" id="8248720">(</span><span class="ident" id="8248721">t</span>&nbsp;<span class="op" id="8248723">*</span><span class="ident" id="8248724">testing</span><span class="op" id="8248731">.</span><span class="ident" id="8248732">T</span><span class="op" id="8248733">)</span>&nbsp;<span class="op" id="8248735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8248738">for</span>&nbsp;<span class="ident" id="8248742">gi</span><span class="op" id="8248744">,</span>&nbsp;<span class="ident" id="8248746">g</span>&nbsp;<span class="op" id="8248748">:=</span>&nbsp;<span class="keyword" id="8248751">range</span>&nbsp;<span class="ident" id="8248757">golden</span>&nbsp;<span class="op" id="8248764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248768">data</span>&nbsp;<span class="op" id="8248773">:=</span>&nbsp;<span class="builtinfunc" id="8248776">make</span><span class="op" id="8248780">(</span><span class="op" id="8248781">[</span><span class="op" id="8248782">]</span><span class="builtintype" id="8248783">byte</span><span class="op" id="8248787">,</span>&nbsp;<span class="builtinfunc" id="8248789">len</span><span class="op" id="8248792">(</span><span class="ident" id="8248793">g</span><span class="op" id="8248794">.</span><span class="ident" id="8248795">keystream</span><span class="op" id="8248804">)</span><span class="op" id="8248805">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8248809">for</span>&nbsp;<span class="ident" id="8248813">i</span>&nbsp;<span class="op" id="8248815">:=</span>&nbsp;<span class="keyword" id="8248818">range</span>&nbsp;<span class="ident" id="8248824">data</span>&nbsp;<span class="op" id="8248829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248834">data</span><span class="op" id="8248838">[</span><span class="ident" id="8248839">i</span><span class="op" id="8248840">]</span>&nbsp;<span class="op" id="8248842">=</span>&nbsp;<span class="builtintype" id="8248844">byte</span><span class="op" id="8248848">(</span><span class="ident" id="8248849">i</span><span class="op" id="8248850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8248854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248859">expect</span>&nbsp;<span class="op" id="8248866">:=</span>&nbsp;<span class="builtinfunc" id="8248869">make</span><span class="op" id="8248873">(</span><span class="op" id="8248874">[</span><span class="op" id="8248875">]</span><span class="builtintype" id="8248876">byte</span><span class="op" id="8248880">,</span>&nbsp;<span class="builtinfunc" id="8248882">len</span><span class="op" id="8248885">(</span><span class="ident" id="8248886">g</span><span class="op" id="8248887">.</span><span class="ident" id="8248888">keystream</span><span class="op" id="8248897">)</span><span class="op" id="8248898">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8248902">for</span>&nbsp;<span class="ident" id="8248906">i</span>&nbsp;<span class="op" id="8248908">:=</span>&nbsp;<span class="keyword" id="8248911">range</span>&nbsp;<span class="ident" id="8248917">expect</span>&nbsp;<span class="op" id="8248924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8248929">expect</span><span class="op" id="8248935">[</span><span class="ident" id="8248936">i</span><span class="op" id="8248937">]</span>&nbsp;<span class="op" id="8248939">=</span>&nbsp;<span class="builtintype" id="8248941">byte</span><span class="op" id="8248945">(</span><span class="ident" id="8248946">i</span><span class="op" id="8248947">)</span>&nbsp;<span class="op" id="8248949">^</span>&nbsp;<span class="ident" id="8248951">g</span><span class="op" id="8248952">.</span><span class="ident" id="8248953">keystream</span><span class="op" id="8248962">[</span><span class="ident" id="8248963">i</span><span class="op" id="8248964">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8248968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8248973">for</span>&nbsp;<span class="ident" id="8248977">size</span>&nbsp;<span class="op" id="8248982">:=</span>&nbsp;<span class="num" id="8248985">1</span><span class="op" id="8248986">;</span>&nbsp;<span class="ident" id="8248988">size</span>&nbsp;<span class="op" id="8248993">&lt;=</span>&nbsp;<span class="builtinfunc" id="8248996">len</span><span class="op" id="8248999">(</span><span class="ident" id="8249000">g</span><span class="op" id="8249001">.</span><span class="ident" id="8249002">keystream</span><span class="op" id="8249011">)</span><span class="op" id="8249012">;</span>&nbsp;<span class="ident" id="8249014">size</span><span class="op" id="8249018">++</span>&nbsp;<span class="op" id="8249021">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249026">c</span><span class="op" id="8249027">,</span>&nbsp;<span class="ident" id="8249029">err</span>&nbsp;<span class="op" id="8249033">:=</span>&nbsp;<span class="ident" id="8249036">NewCipher</span><span class="op" id="8249045">(</span><span class="ident" id="8249046">g</span><span class="op" id="8249047">.</span><span class="ident" id="8249048">key</span><span class="op" id="8249051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8249056">if</span>&nbsp;<span class="ident" id="8249059">err</span>&nbsp;<span class="op" id="8249063">!=</span>&nbsp;<span class="ident" id="8249066">nil</span>&nbsp;<span class="op" id="8249070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249076">t</span><span class="op" id="8249077">.</span><span class="ident" id="8249078">Fatalf</span><span class="op" id="8249084">(</span><span class="string" id="8249085">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="8249105">,</span>&nbsp;<span class="ident" id="8249107">gi</span><span class="op" id="8249109">,</span>&nbsp;<span class="ident" id="8249111">err</span><span class="op" id="8249114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249125">off</span>&nbsp;<span class="op" id="8249129">:=</span>&nbsp;<span class="num" id="8249132">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8249137">for</span>&nbsp;<span class="ident" id="8249141">off</span>&nbsp;<span class="op" id="8249145">&lt;</span>&nbsp;<span class="builtinfunc" id="8249147">len</span><span class="op" id="8249150">(</span><span class="ident" id="8249151">g</span><span class="op" id="8249152">.</span><span class="ident" id="8249153">keystream</span><span class="op" id="8249162">)</span>&nbsp;<span class="op" id="8249164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249170">n</span>&nbsp;<span class="op" id="8249172">:=</span>&nbsp;<span class="builtinfunc" id="8249175">len</span><span class="op" id="8249178">(</span><span class="ident" id="8249179">g</span><span class="op" id="8249180">.</span><span class="ident" id="8249181">keystream</span><span class="op" id="8249190">)</span>&nbsp;<span class="op" id="8249192">-</span>&nbsp;<span class="ident" id="8249194">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8249202">if</span>&nbsp;<span class="ident" id="8249205">n</span>&nbsp;<span class="op" id="8249207">&gt;</span>&nbsp;<span class="ident" id="8249209">size</span>&nbsp;<span class="op" id="8249214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249221">n</span>&nbsp;<span class="op" id="8249223">=</span>&nbsp;<span class="ident" id="8249225">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249240">desc</span>&nbsp;<span class="op" id="8249245">:=</span>&nbsp;<span class="ident" id="8249248">fmt</span><span class="op" id="8249251">.</span><span class="ident" id="8249252">Sprintf</span><span class="op" id="8249259">(</span><span class="string" id="8249260">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="8249273">,</span>&nbsp;<span class="ident" id="8249275">gi</span><span class="op" id="8249277">,</span>&nbsp;<span class="ident" id="8249279">off</span><span class="op" id="8249282">,</span>&nbsp;<span class="ident" id="8249284">off</span><span class="op" id="8249287">+</span><span class="ident" id="8249288">n</span><span class="op" id="8249289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249295">testEncrypt</span><span class="op" id="8249306">(</span><span class="ident" id="8249307">t</span><span class="op" id="8249308">,</span>&nbsp;<span class="ident" id="8249310">desc</span><span class="op" id="8249314">,</span>&nbsp;<span class="ident" id="8249316">c</span><span class="op" id="8249317">,</span>&nbsp;<span class="ident" id="8249319">data</span><span class="op" id="8249323">[</span><span class="ident" id="8249324">off</span><span class="op" id="8249327">:</span><span class="ident" id="8249328">off</span><span class="op" id="8249331">+</span><span class="ident" id="8249332">n</span><span class="op" id="8249333">]</span><span class="op" id="8249334">,</span>&nbsp;<span class="ident" id="8249336">expect</span><span class="op" id="8249342">[</span><span class="ident" id="8249343">off</span><span class="op" id="8249346">:</span><span class="ident" id="8249347">off</span><span class="op" id="8249350">+</span><span class="ident" id="8249351">n</span><span class="op" id="8249352">]</span><span class="op" id="8249353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249359">off</span>&nbsp;<span class="op" id="8249363">+=</span>&nbsp;<span class="ident" id="8249366">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249371">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249378">}</span><br>
<span class="lineno"></span><span class="op" id="8249380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8249383">func</span>&nbsp;<span class="ident" id="8249388">TestBlock</span><span class="op" id="8249397">(</span><span class="ident" id="8249398">t</span>&nbsp;<span class="op" id="8249400">*</span><span class="ident" id="8249401">testing</span><span class="op" id="8249408">.</span><span class="ident" id="8249409">T</span><span class="op" id="8249410">)</span>&nbsp;<span class="op" id="8249412">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249415">testBlock</span><span class="op" id="8249424">(</span><span class="ident" id="8249425">t</span><span class="op" id="8249426">,</span>&nbsp;<span class="op" id="8249428">(</span><span class="op" id="8249429">*</span><span class="ident" id="8249430">Cipher</span><span class="op" id="8249436">)</span><span class="op" id="8249437">.</span><span class="ident" id="8249438">XORKeyStream</span><span class="op" id="8249450">)</span><br>
<span class="lineno"></span><span class="op" id="8249452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8249455">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="8249484">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="8249551">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="8249595">func</span>&nbsp;<span class="ident" id="8249600">TestBlockGeneric</span><span class="op" id="8249616">(</span><span class="ident" id="8249617">t</span>&nbsp;<span class="op" id="8249619">*</span><span class="ident" id="8249620">testing</span><span class="op" id="8249627">.</span><span class="ident" id="8249628">T</span><span class="op" id="8249629">)</span>&nbsp;<span class="op" id="8249631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249634">testBlock</span><span class="op" id="8249643">(</span><span class="ident" id="8249644">t</span><span class="op" id="8249645">,</span>&nbsp;<span class="op" id="8249647">(</span><span class="op" id="8249648">*</span><span class="ident" id="8249649">Cipher</span><span class="op" id="8249655">)</span><span class="op" id="8249656">.</span><span class="ident" id="8249657">xorKeyStreamGeneric</span><span class="op" id="8249676">)</span><br>
<span class="lineno"></span><span class="op" id="8249678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8249681">func</span>&nbsp;<span class="ident" id="8249686">testBlock</span><span class="op" id="8249695">(</span><span class="ident" id="8249696">t</span>&nbsp;<span class="op" id="8249698">*</span><span class="ident" id="8249699">testing</span><span class="op" id="8249706">.</span><span class="ident" id="8249707">T</span><span class="op" id="8249708">,</span>&nbsp;<span class="ident" id="8249710">xor</span>&nbsp;<span class="keyword" id="8249714">func</span><span class="op" id="8249718">(</span><span class="ident" id="8249719">c</span>&nbsp;<span class="op" id="8249721">*</span><span class="ident" id="8249722">Cipher</span><span class="op" id="8249728">,</span>&nbsp;<span class="ident" id="8249730">dst</span><span class="op" id="8249733">,</span>&nbsp;<span class="ident" id="8249735">src</span>&nbsp;<span class="op" id="8249739">[</span><span class="op" id="8249740">]</span><span class="builtintype" id="8249741">byte</span><span class="op" id="8249745">)</span><span class="op" id="8249746">)</span>&nbsp;<span class="op" id="8249748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249751">c1a</span><span class="op" id="8249754">,</span>&nbsp;<span class="ident" id="8249756">_</span>&nbsp;<span class="op" id="8249758">:=</span>&nbsp;<span class="ident" id="8249761">NewCipher</span><span class="op" id="8249770">(</span><span class="ident" id="8249771">golden</span><span class="op" id="8249777">[</span><span class="num" id="8249778">0</span><span class="op" id="8249779">]</span><span class="op" id="8249780">.</span><span class="ident" id="8249781">key</span><span class="op" id="8249784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249787">c1b</span><span class="op" id="8249790">,</span>&nbsp;<span class="ident" id="8249792">_</span>&nbsp;<span class="op" id="8249794">:=</span>&nbsp;<span class="ident" id="8249797">NewCipher</span><span class="op" id="8249806">(</span><span class="ident" id="8249807">golden</span><span class="op" id="8249813">[</span><span class="num" id="8249814">1</span><span class="op" id="8249815">]</span><span class="op" id="8249816">.</span><span class="ident" id="8249817">key</span><span class="op" id="8249820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249823">data1</span>&nbsp;<span class="op" id="8249829">:=</span>&nbsp;<span class="builtinfunc" id="8249832">make</span><span class="op" id="8249836">(</span><span class="op" id="8249837">[</span><span class="op" id="8249838">]</span><span class="builtintype" id="8249839">byte</span><span class="op" id="8249843">,</span>&nbsp;<span class="num" id="8249845">1</span><span class="op" id="8249846">&lt;&lt;</span><span class="num" id="8249848">20</span><span class="op" id="8249850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8249853">for</span>&nbsp;<span class="ident" id="8249857">i</span>&nbsp;<span class="op" id="8249859">:=</span>&nbsp;<span class="keyword" id="8249862">range</span>&nbsp;<span class="ident" id="8249868">data1</span>&nbsp;<span class="op" id="8249874">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249878">xor</span><span class="op" id="8249881">(</span><span class="ident" id="8249882">c1a</span><span class="op" id="8249885">,</span>&nbsp;<span class="ident" id="8249887">data1</span><span class="op" id="8249892">[</span><span class="ident" id="8249893">i</span><span class="op" id="8249894">:</span><span class="ident" id="8249895">i</span><span class="op" id="8249896">+</span><span class="num" id="8249897">1</span><span class="op" id="8249898">]</span><span class="op" id="8249899">,</span>&nbsp;<span class="ident" id="8249901">data1</span><span class="op" id="8249906">[</span><span class="ident" id="8249907">i</span><span class="op" id="8249908">:</span><span class="ident" id="8249909">i</span><span class="op" id="8249910">+</span><span class="num" id="8249911">1</span><span class="op" id="8249912">]</span><span class="op" id="8249913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249917">xor</span><span class="op" id="8249920">(</span><span class="ident" id="8249921">c1b</span><span class="op" id="8249924">,</span>&nbsp;<span class="ident" id="8249926">data1</span><span class="op" id="8249931">[</span><span class="ident" id="8249932">i</span><span class="op" id="8249933">:</span><span class="ident" id="8249934">i</span><span class="op" id="8249935">+</span><span class="num" id="8249936">1</span><span class="op" id="8249937">]</span><span class="op" id="8249938">,</span>&nbsp;<span class="ident" id="8249940">data1</span><span class="op" id="8249945">[</span><span class="ident" id="8249946">i</span><span class="op" id="8249947">:</span><span class="ident" id="8249948">i</span><span class="op" id="8249949">+</span><span class="num" id="8249950">1</span><span class="op" id="8249951">]</span><span class="op" id="8249952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8249955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249959">c2a</span><span class="op" id="8249962">,</span>&nbsp;<span class="ident" id="8249964">_</span>&nbsp;<span class="op" id="8249966">:=</span>&nbsp;<span class="ident" id="8249969">NewCipher</span><span class="op" id="8249978">(</span><span class="ident" id="8249979">golden</span><span class="op" id="8249985">[</span><span class="num" id="8249986">0</span><span class="op" id="8249987">]</span><span class="op" id="8249988">.</span><span class="ident" id="8249989">key</span><span class="op" id="8249992">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8249995">c2b</span><span class="op" id="8249998">,</span>&nbsp;<span class="ident" id="8250000">_</span>&nbsp;<span class="op" id="8250002">:=</span>&nbsp;<span class="ident" id="8250005">NewCipher</span><span class="op" id="8250014">(</span><span class="ident" id="8250015">golden</span><span class="op" id="8250021">[</span><span class="num" id="8250022">1</span><span class="op" id="8250023">]</span><span class="op" id="8250024">.</span><span class="ident" id="8250025">key</span><span class="op" id="8250028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250031">data2</span>&nbsp;<span class="op" id="8250037">:=</span>&nbsp;<span class="builtinfunc" id="8250040">make</span><span class="op" id="8250044">(</span><span class="op" id="8250045">[</span><span class="op" id="8250046">]</span><span class="builtintype" id="8250047">byte</span><span class="op" id="8250051">,</span>&nbsp;<span class="num" id="8250053">1</span><span class="op" id="8250054">&lt;&lt;</span><span class="num" id="8250056">20</span><span class="op" id="8250058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250061">xor</span><span class="op" id="8250064">(</span><span class="ident" id="8250065">c2a</span><span class="op" id="8250068">,</span>&nbsp;<span class="ident" id="8250070">data2</span><span class="op" id="8250075">,</span>&nbsp;<span class="ident" id="8250077">data2</span><span class="op" id="8250082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250085">xor</span><span class="op" id="8250088">(</span><span class="ident" id="8250089">c2b</span><span class="op" id="8250092">,</span>&nbsp;<span class="ident" id="8250094">data2</span><span class="op" id="8250099">,</span>&nbsp;<span class="ident" id="8250101">data2</span><span class="op" id="8250106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8250110">if</span>&nbsp;<span class="op" id="8250113">!</span><span class="ident" id="8250114">bytes</span><span class="op" id="8250119">.</span><span class="ident" id="8250120">Equal</span><span class="op" id="8250125">(</span><span class="ident" id="8250126">data1</span><span class="op" id="8250131">,</span>&nbsp;<span class="ident" id="8250133">data2</span><span class="op" id="8250138">)</span>&nbsp;<span class="op" id="8250140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250144">t</span><span class="op" id="8250145">.</span><span class="ident" id="8250146">Fatalf</span><span class="op" id="8250152">(</span><span class="string" id="8250153">&#34;bad&nbsp;block&#34;</span><span class="op" id="8250164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8250167">}</span><br>
<span class="lineno"></span><span class="op" id="8250169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8250172">func</span>&nbsp;<span class="ident" id="8250177">benchmark</span><span class="op" id="8250186">(</span><span class="ident" id="8250187">b</span>&nbsp;<span class="op" id="8250189">*</span><span class="ident" id="8250190">testing</span><span class="op" id="8250197">.</span><span class="ident" id="8250198">B</span><span class="op" id="8250199">,</span>&nbsp;<span class="ident" id="8250201">size</span>&nbsp;<span class="ident" id="8250206">int64</span><span class="op" id="8250211">)</span>&nbsp;<span class="op" id="8250213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250216">buf</span>&nbsp;<span class="op" id="8250220">:=</span>&nbsp;<span class="builtinfunc" id="8250223">make</span><span class="op" id="8250227">(</span><span class="op" id="8250228">[</span><span class="op" id="8250229">]</span><span class="builtintype" id="8250230">byte</span><span class="op" id="8250234">,</span>&nbsp;<span class="ident" id="8250236">size</span><span class="op" id="8250240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250243">c</span><span class="op" id="8250244">,</span>&nbsp;<span class="ident" id="8250246">err</span>&nbsp;<span class="op" id="8250250">:=</span>&nbsp;<span class="ident" id="8250253">NewCipher</span><span class="op" id="8250262">(</span><span class="ident" id="8250263">golden</span><span class="op" id="8250269">[</span><span class="num" id="8250270">0</span><span class="op" id="8250271">]</span><span class="op" id="8250272">.</span><span class="ident" id="8250273">key</span><span class="op" id="8250276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8250279">if</span>&nbsp;<span class="ident" id="8250282">err</span>&nbsp;<span class="op" id="8250286">!=</span>&nbsp;<span class="ident" id="8250289">nil</span>&nbsp;<span class="op" id="8250293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8250297">panic</span><span class="op" id="8250302">(</span><span class="ident" id="8250303">err</span><span class="op" id="8250306">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8250309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250312">b</span><span class="op" id="8250313">.</span><span class="ident" id="8250314">SetBytes</span><span class="op" id="8250322">(</span><span class="ident" id="8250323">size</span><span class="op" id="8250327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8250331">for</span>&nbsp;<span class="ident" id="8250335">i</span>&nbsp;<span class="op" id="8250337">:=</span>&nbsp;<span class="num" id="8250340">0</span><span class="op" id="8250341">;</span>&nbsp;<span class="ident" id="8250343">i</span>&nbsp;<span class="op" id="8250345">&lt;</span>&nbsp;<span class="ident" id="8250347">b</span><span class="op" id="8250348">.</span><span class="ident" id="8250349">N</span><span class="op" id="8250350">;</span>&nbsp;<span class="ident" id="8250352">i</span><span class="op" id="8250353">++</span>&nbsp;<span class="op" id="8250356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250360">c</span><span class="op" id="8250361">.</span><span class="ident" id="8250362">XORKeyStream</span><span class="op" id="8250374">(</span><span class="ident" id="8250375">buf</span><span class="op" id="8250378">,</span>&nbsp;<span class="ident" id="8250380">buf</span><span class="op" id="8250383">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8250386">}</span><br>
<span class="lineno"></span><span class="op" id="8250388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8250391">func</span>&nbsp;<span class="ident" id="8250396">BenchmarkRC4_128</span><span class="op" id="8250412">(</span><span class="ident" id="8250413">b</span>&nbsp;<span class="op" id="8250415">*</span><span class="ident" id="8250416">testing</span><span class="op" id="8250423">.</span><span class="ident" id="8250424">B</span><span class="op" id="8250425">)</span>&nbsp;<span class="op" id="8250427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250430">benchmark</span><span class="op" id="8250439">(</span><span class="ident" id="8250440">b</span><span class="op" id="8250441">,</span>&nbsp;<span class="num" id="8250443">128</span><span class="op" id="8250446">)</span><br>
<span class="lineno">165</span><span class="op" id="8250448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8250451">func</span>&nbsp;<span class="ident" id="8250456">BenchmarkRC4_1K</span><span class="op" id="8250471">(</span><span class="ident" id="8250472">b</span>&nbsp;<span class="op" id="8250474">*</span><span class="ident" id="8250475">testing</span><span class="op" id="8250482">.</span><span class="ident" id="8250483">B</span><span class="op" id="8250484">)</span>&nbsp;<span class="op" id="8250486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250489">benchmark</span><span class="op" id="8250498">(</span><span class="ident" id="8250499">b</span><span class="op" id="8250500">,</span>&nbsp;<span class="num" id="8250502">1024</span><span class="op" id="8250506">)</span><br>
<span class="lineno"></span><span class="op" id="8250508">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8250511">func</span>&nbsp;<span class="ident" id="8250516">BenchmarkRC4_8K</span><span class="op" id="8250531">(</span><span class="ident" id="8250532">b</span>&nbsp;<span class="op" id="8250534">*</span><span class="ident" id="8250535">testing</span><span class="op" id="8250542">.</span><span class="ident" id="8250543">B</span><span class="op" id="8250544">)</span>&nbsp;<span class="op" id="8250546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8250549">benchmark</span><span class="op" id="8250558">(</span><span class="ident" id="8250559">b</span><span class="op" id="8250560">,</span>&nbsp;<span class="num" id="8250562">8096</span><span class="op" id="8250566">)</span><br>
<span class="lineno"></span><span class="op" id="8250568">}</span>
</div>
</body>
</html>
