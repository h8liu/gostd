<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5898899">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5898954">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5899008">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5899059">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="5899135">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="5899210">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5899282">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="5899358">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="5899434">//</span><br>
<span class="lineno"></span><span class="comment" id="5899437">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="5899515">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5899583">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="5899659">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="5899711">//</span><br>
<span class="lineno"></span><span class="comment" id="5899714">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="5899738">//</span><br>
<span class="lineno"></span><span class="comment" id="5899741">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="5899766">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="5899781">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5899800">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="5899828">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="5899857">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="5899876">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="5899881">//</span><br>
<span class="lineno"></span><span class="keyword" id="5899884">package</span>&nbsp;<span class="ident" id="5899892">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5899901">import</span>&nbsp;<span class="op" id="5899908">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5899911">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5899920">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5899927">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5899933">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5899939">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5899950">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="5899965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5899968">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5900025">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="5900061">type</span>&nbsp;<span class="ident" id="5900066">Position</span>&nbsp;<span class="keyword" id="5900075">struct</span>&nbsp;<span class="op" id="5900082">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900085">Filename</span>&nbsp;<span class="builtintype" id="5900094">string</span>&nbsp;<span class="comment" id="5900101">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900122">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5900131">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5900138">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900169">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5900178">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5900185">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900216">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5900225">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5900232">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="5900291">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5900294">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="5900344">func</span>&nbsp;<span class="op" id="5900349">(</span><span class="ident" id="5900350">pos</span>&nbsp;<span class="op" id="5900354">*</span><span class="ident" id="5900355">Position</span><span class="op" id="5900363">)</span>&nbsp;<span class="ident" id="5900365">IsValid</span><span class="op" id="5900372">(</span><span class="op" id="5900373">)</span>&nbsp;<span class="builtintype" id="5900375">bool</span>&nbsp;<span class="op" id="5900380">{</span>&nbsp;<span class="keyword" id="5900382">return</span>&nbsp;<span class="ident" id="5900389">pos</span><span class="op" id="5900392">.</span><span class="ident" id="5900393">Line</span>&nbsp;<span class="op" id="5900398">&gt;</span>&nbsp;<span class="num" id="5900400">0</span>&nbsp;<span class="op" id="5900402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5900405">func</span>&nbsp;<span class="op" id="5900410">(</span><span class="ident" id="5900411">pos</span>&nbsp;<span class="ident" id="5900415">Position</span><span class="op" id="5900423">)</span>&nbsp;<span class="ident" id="5900425">String</span><span class="op" id="5900431">(</span><span class="op" id="5900432">)</span>&nbsp;<span class="builtintype" id="5900434">string</span>&nbsp;<span class="op" id="5900441">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900444">s</span>&nbsp;<span class="op" id="5900446">:=</span>&nbsp;<span class="ident" id="5900449">pos</span><span class="op" id="5900452">.</span><span class="ident" id="5900453">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900463">if</span>&nbsp;<span class="ident" id="5900466">pos</span><span class="op" id="5900469">.</span><span class="ident" id="5900470">IsValid</span><span class="op" id="5900477">(</span><span class="op" id="5900478">)</span>&nbsp;<span class="op" id="5900480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900484">if</span>&nbsp;<span class="ident" id="5900487">s</span>&nbsp;<span class="op" id="5900489">!=</span>&nbsp;<span class="string" id="5900492">&#34;&#34;</span>&nbsp;<span class="op" id="5900495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900500">s</span>&nbsp;<span class="op" id="5900502">+=</span>&nbsp;<span class="string" id="5900505">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900511">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900515">s</span>&nbsp;<span class="op" id="5900517">+=</span>&nbsp;<span class="ident" id="5900520">fmt</span><span class="op" id="5900523">.</span><span class="ident" id="5900524">Sprintf</span><span class="op" id="5900531">(</span><span class="string" id="5900532">&#34;%d:%d&#34;</span><span class="op" id="5900539">,</span>&nbsp;<span class="ident" id="5900541">pos</span><span class="op" id="5900544">.</span><span class="ident" id="5900545">Line</span><span class="op" id="5900549">,</span>&nbsp;<span class="ident" id="5900551">pos</span><span class="op" id="5900554">.</span><span class="ident" id="5900555">Column</span><span class="op" id="5900561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900567">if</span>&nbsp;<span class="ident" id="5900570">s</span>&nbsp;<span class="op" id="5900572">==</span>&nbsp;<span class="string" id="5900575">&#34;&#34;</span>&nbsp;<span class="op" id="5900578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5900582">s</span>&nbsp;<span class="op" id="5900584">=</span>&nbsp;<span class="string" id="5900586">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5900593">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5900596">return</span>&nbsp;<span class="ident" id="5900603">s</span><br>
<span class="lineno"></span><span class="op" id="5900605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5900608">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="5900680">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="5900753">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="5900819">//</span><br>
<span class="lineno"></span><span class="comment" id="5900822">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="5900862">//</span><br>
<span class="lineno"></span><span class="comment" id="5900865">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="5900938">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="5901011">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="5901085">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="5901158">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="5901215">//</span><br>
<span class="lineno">75</span><span class="keyword" id="5901218">const</span>&nbsp;<span class="op" id="5901224">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901227">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5901242">=</span>&nbsp;<span class="num" id="5901244">1</span>&nbsp;<span class="op" id="5901246">&lt;&lt;</span>&nbsp;<span class="op" id="5901249">-</span><span class="ident" id="5901250">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901257">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5901272">=</span>&nbsp;<span class="num" id="5901274">1</span>&nbsp;<span class="op" id="5901276">&lt;&lt;</span>&nbsp;<span class="op" id="5901279">-</span><span class="ident" id="5901280">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901285">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5901300">=</span>&nbsp;<span class="num" id="5901302">1</span>&nbsp;<span class="op" id="5901304">&lt;&lt;</span>&nbsp;<span class="op" id="5901307">-</span><span class="ident" id="5901308">Float</span>&nbsp;<span class="comment" id="5901314">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901332">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5901347">=</span>&nbsp;<span class="num" id="5901349">1</span>&nbsp;<span class="op" id="5901351">&lt;&lt;</span>&nbsp;<span class="op" id="5901354">-</span><span class="ident" id="5901355">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901361">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5901376">=</span>&nbsp;<span class="num" id="5901378">1</span>&nbsp;<span class="op" id="5901380">&lt;&lt;</span>&nbsp;<span class="op" id="5901383">-</span><span class="ident" id="5901384">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901392">ScanRawStrings</span>&nbsp;<span class="op" id="5901407">=</span>&nbsp;<span class="num" id="5901409">1</span>&nbsp;<span class="op" id="5901411">&lt;&lt;</span>&nbsp;<span class="op" id="5901414">-</span><span class="ident" id="5901415">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901426">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5901441">=</span>&nbsp;<span class="num" id="5901443">1</span>&nbsp;<span class="op" id="5901445">&lt;&lt;</span>&nbsp;<span class="op" id="5901448">-</span><span class="ident" id="5901449">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901458">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5901473">=</span>&nbsp;<span class="num" id="5901475">1</span>&nbsp;<span class="op" id="5901477">&lt;&lt;</span>&nbsp;<span class="op" id="5901480">-</span><span class="ident" id="5901481">skipComment</span>&nbsp;<span class="comment" id="5901493">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901551">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5901566">=</span>&nbsp;<span class="ident" id="5901568">ScanIdents</span>&nbsp;<span class="op" id="5901579">|</span>&nbsp;<span class="ident" id="5901581">ScanFloats</span>&nbsp;<span class="op" id="5901592">|</span>&nbsp;<span class="ident" id="5901594">ScanChars</span>&nbsp;<span class="op" id="5901604">|</span>&nbsp;<span class="ident" id="5901606">ScanStrings</span>&nbsp;<span class="op" id="5901618">|</span>&nbsp;<span class="ident" id="5901620">ScanRawStrings</span>&nbsp;<span class="op" id="5901635">|</span>&nbsp;<span class="ident" id="5901637">ScanComments</span>&nbsp;<span class="op" id="5901650">|</span>&nbsp;<span class="ident" id="5901652">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="5901665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5901668">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5901745">const</span>&nbsp;<span class="op" id="5901751">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901754">EOF</span>&nbsp;<span class="op" id="5901758">=</span>&nbsp;<span class="op" id="5901760">-</span><span class="op" id="5901761">(</span><span class="ident" id="5901762">iota</span>&nbsp;<span class="op" id="5901767">+</span>&nbsp;<span class="num" id="5901769">1</span><span class="op" id="5901770">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901773">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901780">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901785">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901792">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901798">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901806">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901817">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901826">skipComment</span><br>
<span class="lineno"></span><span class="op" id="5901838">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="5901841">var</span>&nbsp;<span class="ident" id="5901845">tokenString</span>&nbsp;<span class="op" id="5901857">=</span>&nbsp;<span class="keyword" id="5901859">map</span><span class="op" id="5901862">[</span><span class="builtintype" id="5901863">rune</span><span class="op" id="5901867">]</span><span class="builtintype" id="5901868">string</span><span class="op" id="5901874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901877">EOF</span><span class="op" id="5901880">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5901888">&#34;EOF&#34;</span><span class="op" id="5901893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901896">Ident</span><span class="op" id="5901901">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5901907">&#34;Ident&#34;</span><span class="op" id="5901914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901917">Int</span><span class="op" id="5901920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5901928">&#34;Int&#34;</span><span class="op" id="5901933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901936">Float</span><span class="op" id="5901941">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5901947">&#34;Float&#34;</span><span class="op" id="5901954">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901957">Char</span><span class="op" id="5901961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5901968">&#34;Char&#34;</span><span class="op" id="5901974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901977">String</span><span class="op" id="5901983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5901988">&#34;String&#34;</span><span class="op" id="5901996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5901999">RawString</span><span class="op" id="5902008">:</span>&nbsp;<span class="string" id="5902010">&#34;RawString&#34;</span><span class="op" id="5902021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902024">Comment</span><span class="op" id="5902031">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5902035">&#34;Comment&#34;</span><span class="op" id="5902044">,</span><br>
<span class="lineno"></span><span class="op" id="5902046">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5902049">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="5902125">func</span>&nbsp;<span class="ident" id="5902130">TokenString</span><span class="op" id="5902141">(</span><span class="ident" id="5902142">tok</span>&nbsp;<span class="builtintype" id="5902146">rune</span><span class="op" id="5902150">)</span>&nbsp;<span class="builtintype" id="5902152">string</span>&nbsp;<span class="op" id="5902159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902162">if</span>&nbsp;<span class="ident" id="5902165">s</span><span class="op" id="5902166">,</span>&nbsp;<span class="ident" id="5902168">found</span>&nbsp;<span class="op" id="5902174">:=</span>&nbsp;<span class="ident" id="5902177">tokenString</span><span class="op" id="5902188">[</span><span class="ident" id="5902189">tok</span><span class="op" id="5902192">]</span><span class="op" id="5902193">;</span>&nbsp;<span class="ident" id="5902195">found</span>&nbsp;<span class="op" id="5902201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902205">return</span>&nbsp;<span class="ident" id="5902212">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5902215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5902218">return</span>&nbsp;<span class="ident" id="5902225">fmt</span><span class="op" id="5902228">.</span><span class="ident" id="5902229">Sprintf</span><span class="op" id="5902236">(</span><span class="string" id="5902237">&#34;%q&#34;</span><span class="op" id="5902241">,</span>&nbsp;<span class="builtintype" id="5902243">string</span><span class="op" id="5902249">(</span><span class="ident" id="5902250">tok</span><span class="op" id="5902253">)</span><span class="op" id="5902254">)</span><br>
<span class="lineno"></span><span class="op" id="5902256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5902259">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="5902332">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="5902382">const</span>&nbsp;<span class="ident" id="5902388">GoWhitespace</span>&nbsp;<span class="op" id="5902401">=</span>&nbsp;<span class="num" id="5902403">1</span><span class="op" id="5902404">&lt;&lt;</span><span class="string" id="5902406">&#39;\t&#39;</span>&nbsp;<span class="op" id="5902411">|</span>&nbsp;<span class="num" id="5902413">1</span><span class="op" id="5902414">&lt;&lt;</span><span class="string" id="5902416">&#39;\n&#39;</span>&nbsp;<span class="op" id="5902421">|</span>&nbsp;<span class="num" id="5902423">1</span><span class="op" id="5902424">&lt;&lt;</span><span class="string" id="5902426">&#39;\r&#39;</span>&nbsp;<span class="op" id="5902431">|</span>&nbsp;<span class="num" id="5902433">1</span><span class="op" id="5902434">&lt;&lt;</span><span class="string" id="5902436">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5902441">const</span>&nbsp;<span class="ident" id="5902447">bufLen</span>&nbsp;<span class="op" id="5902454">=</span>&nbsp;<span class="num" id="5902456">1024</span>&nbsp;<span class="comment" id="5902461">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5902486">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5902570">type</span>&nbsp;<span class="ident" id="5902575">Scanner</span>&nbsp;<span class="keyword" id="5902583">struct</span>&nbsp;<span class="op" id="5902590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902593">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902603">src</span>&nbsp;<span class="ident" id="5902607">io</span><span class="op" id="5902609">.</span><span class="ident" id="5902610">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902619">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902637">srcBuf</span>&nbsp;<span class="op" id="5902644">[</span><span class="ident" id="5902645">bufLen</span>&nbsp;<span class="op" id="5902652">+</span>&nbsp;<span class="num" id="5902654">1</span><span class="op" id="5902655">]</span><span class="builtintype" id="5902656">byte</span>&nbsp;<span class="comment" id="5902661">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902709">srcPos</span>&nbsp;<span class="builtintype" id="5902716">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5902733">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902769">srcEnd</span>&nbsp;<span class="builtintype" id="5902776">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5902793">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5902824">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902844">srcBufOffset</span>&nbsp;<span class="builtintype" id="5902857">int</span>&nbsp;<span class="comment" id="5902861">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902900">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5902913">int</span>&nbsp;<span class="comment" id="5902917">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902932">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5902945">int</span>&nbsp;<span class="comment" id="5902949">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5902969">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="5902982">int</span>&nbsp;<span class="comment" id="5902986">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903055">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="5903068">int</span>&nbsp;<span class="comment" id="5903072">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903111">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903133">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903206">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903281">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903311">tokBuf</span>&nbsp;<span class="ident" id="5903318">bytes</span><span class="op" id="5903323">.</span><span class="ident" id="5903324">Buffer</span>&nbsp;<span class="comment" id="5903331">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903381">tokPos</span>&nbsp;<span class="builtintype" id="5903388">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5903401">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903460">tokEnd</span>&nbsp;<span class="builtintype" id="5903467">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5903480">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903520">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903549">ch</span>&nbsp;<span class="builtintype" id="5903552">rune</span>&nbsp;<span class="comment" id="5903557">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903594">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903654">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903711">Error</span>&nbsp;<span class="keyword" id="5903717">func</span><span class="op" id="5903721">(</span><span class="ident" id="5903722">s</span>&nbsp;<span class="op" id="5903724">*</span><span class="ident" id="5903725">Scanner</span><span class="op" id="5903732">,</span>&nbsp;<span class="ident" id="5903734">msg</span>&nbsp;<span class="builtintype" id="5903738">string</span><span class="op" id="5903744">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903748">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903813">ErrorCount</span>&nbsp;<span class="builtintype" id="5903824">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903830">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903901">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5903971">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5903996">Mode</span>&nbsp;<span class="builtintype" id="5904001">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904008">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904074">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904145">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904218">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5904282">Whitespace</span>&nbsp;<span class="ident" id="5904293">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904302">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904369">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904435">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904498">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904564">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5904624">IsIdentRune</span>&nbsp;<span class="keyword" id="5904636">func</span><span class="op" id="5904640">(</span><span class="ident" id="5904641">ch</span>&nbsp;<span class="builtintype" id="5904644">rune</span><span class="op" id="5904648">,</span>&nbsp;<span class="ident" id="5904650">i</span>&nbsp;<span class="builtintype" id="5904652">int</span><span class="op" id="5904655">)</span>&nbsp;<span class="builtintype" id="5904657">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904664">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904728">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904791">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904855">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904920">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5904987">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905014">Position</span><br>
<span class="lineno">185</span><span class="op" id="5905023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5905026">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="5905089">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="5905162">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="5905204">func</span>&nbsp;<span class="op" id="5905209">(</span><span class="ident" id="5905210">s</span>&nbsp;<span class="op" id="5905212">*</span><span class="ident" id="5905213">Scanner</span><span class="op" id="5905220">)</span>&nbsp;<span class="ident" id="5905222">Init</span><span class="op" id="5905226">(</span><span class="ident" id="5905227">src</span>&nbsp;<span class="ident" id="5905231">io</span><span class="op" id="5905233">.</span><span class="ident" id="5905234">Reader</span><span class="op" id="5905240">)</span>&nbsp;<span class="op" id="5905242">*</span><span class="ident" id="5905243">Scanner</span>&nbsp;<span class="op" id="5905251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905254">s</span><span class="op" id="5905255">.</span><span class="ident" id="5905256">src</span>&nbsp;<span class="op" id="5905260">=</span>&nbsp;<span class="ident" id="5905262">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905268">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905297">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905361">s</span><span class="op" id="5905362">.</span><span class="ident" id="5905363">srcBuf</span><span class="op" id="5905369">[</span><span class="num" id="5905370">0</span><span class="op" id="5905371">]</span>&nbsp;<span class="op" id="5905373">=</span>&nbsp;<span class="ident" id="5905375">utf8</span><span class="op" id="5905379">.</span><span class="ident" id="5905380">RuneSelf</span>&nbsp;<span class="comment" id="5905389">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905402">s</span><span class="op" id="5905403">.</span><span class="ident" id="5905404">srcPos</span>&nbsp;<span class="op" id="5905411">=</span>&nbsp;<span class="num" id="5905413">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905416">s</span><span class="op" id="5905417">.</span><span class="ident" id="5905418">srcEnd</span>&nbsp;<span class="op" id="5905425">=</span>&nbsp;<span class="num" id="5905427">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905431">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905462">s</span><span class="op" id="5905463">.</span><span class="ident" id="5905464">srcBufOffset</span>&nbsp;<span class="op" id="5905477">=</span>&nbsp;<span class="num" id="5905479">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905482">s</span><span class="op" id="5905483">.</span><span class="ident" id="5905484">line</span>&nbsp;<span class="op" id="5905489">=</span>&nbsp;<span class="num" id="5905491">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905494">s</span><span class="op" id="5905495">.</span><span class="ident" id="5905496">column</span>&nbsp;<span class="op" id="5905503">=</span>&nbsp;<span class="num" id="5905505">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905508">s</span><span class="op" id="5905509">.</span><span class="ident" id="5905510">lastLineLen</span>&nbsp;<span class="op" id="5905522">=</span>&nbsp;<span class="num" id="5905524">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905527">s</span><span class="op" id="5905528">.</span><span class="ident" id="5905529">lastCharLen</span>&nbsp;<span class="op" id="5905541">=</span>&nbsp;<span class="num" id="5905543">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905547">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905580">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905621">s</span><span class="op" id="5905622">.</span><span class="ident" id="5905623">tokPos</span>&nbsp;<span class="op" id="5905630">=</span>&nbsp;<span class="op" id="5905632">-</span><span class="num" id="5905633">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905637">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905677">s</span><span class="op" id="5905678">.</span><span class="ident" id="5905679">ch</span>&nbsp;<span class="op" id="5905682">=</span>&nbsp;<span class="op" id="5905684">-</span><span class="num" id="5905685">1</span>&nbsp;<span class="comment" id="5905687">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5905709">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905738">s</span><span class="op" id="5905739">.</span><span class="ident" id="5905740">Error</span>&nbsp;<span class="op" id="5905746">=</span>&nbsp;<span class="ident" id="5905748">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905753">s</span><span class="op" id="5905754">.</span><span class="ident" id="5905755">ErrorCount</span>&nbsp;<span class="op" id="5905766">=</span>&nbsp;<span class="num" id="5905768">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905771">s</span><span class="op" id="5905772">.</span><span class="ident" id="5905773">Mode</span>&nbsp;<span class="op" id="5905778">=</span>&nbsp;<span class="ident" id="5905780">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905790">s</span><span class="op" id="5905791">.</span><span class="ident" id="5905792">Whitespace</span>&nbsp;<span class="op" id="5905803">=</span>&nbsp;<span class="ident" id="5905805">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5905819">s</span><span class="op" id="5905820">.</span><span class="ident" id="5905821">Line</span>&nbsp;<span class="op" id="5905826">=</span>&nbsp;<span class="num" id="5905828">0</span>&nbsp;<span class="comment" id="5905830">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5905861">return</span>&nbsp;<span class="ident" id="5905868">s</span><br>
<span class="lineno"></span><span class="op" id="5905870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5905873">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5905947">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="5906022">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="5906096">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="5906123">func</span>&nbsp;<span class="op" id="5906128">(</span><span class="ident" id="5906129">s</span>&nbsp;<span class="op" id="5906131">*</span><span class="ident" id="5906132">Scanner</span><span class="op" id="5906139">)</span>&nbsp;<span class="ident" id="5906141">next</span><span class="op" id="5906145">(</span><span class="op" id="5906146">)</span>&nbsp;<span class="builtintype" id="5906148">rune</span>&nbsp;<span class="op" id="5906153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5906156">ch</span><span class="op" id="5906158">,</span>&nbsp;<span class="ident" id="5906160">width</span>&nbsp;<span class="op" id="5906166">:=</span>&nbsp;<span class="builtintype" id="5906169">rune</span><span class="op" id="5906173">(</span><span class="ident" id="5906174">s</span><span class="op" id="5906175">.</span><span class="ident" id="5906176">srcBuf</span><span class="op" id="5906182">[</span><span class="ident" id="5906183">s</span><span class="op" id="5906184">.</span><span class="ident" id="5906185">srcPos</span><span class="op" id="5906191">]</span><span class="op" id="5906192">)</span><span class="op" id="5906193">,</span>&nbsp;<span class="num" id="5906195">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5906199">if</span>&nbsp;<span class="ident" id="5906202">ch</span>&nbsp;<span class="op" id="5906205">&gt;=</span>&nbsp;<span class="ident" id="5906208">utf8</span><span class="op" id="5906212">.</span><span class="ident" id="5906213">RuneSelf</span>&nbsp;<span class="op" id="5906222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906226">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5906276">for</span>&nbsp;<span class="ident" id="5906280">s</span><span class="op" id="5906281">.</span><span class="ident" id="5906282">srcPos</span><span class="op" id="5906288">+</span><span class="ident" id="5906289">utf8</span><span class="op" id="5906293">.</span><span class="ident" id="5906294">UTFMax</span>&nbsp;<span class="op" id="5906301">&gt;</span>&nbsp;<span class="ident" id="5906303">s</span><span class="op" id="5906304">.</span><span class="ident" id="5906305">srcEnd</span>&nbsp;<span class="op" id="5906312">&amp;&amp;</span>&nbsp;<span class="op" id="5906315">!</span><span class="ident" id="5906316">utf8</span><span class="op" id="5906320">.</span><span class="ident" id="5906321">FullRune</span><span class="op" id="5906329">(</span><span class="ident" id="5906330">s</span><span class="op" id="5906331">.</span><span class="ident" id="5906332">srcBuf</span><span class="op" id="5906338">[</span><span class="ident" id="5906339">s</span><span class="op" id="5906340">.</span><span class="ident" id="5906341">srcPos</span><span class="op" id="5906347">:</span><span class="ident" id="5906348">s</span><span class="op" id="5906349">.</span><span class="ident" id="5906350">srcEnd</span><span class="op" id="5906356">]</span><span class="op" id="5906357">)</span>&nbsp;<span class="op" id="5906359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906364">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906414">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5906448">if</span>&nbsp;<span class="ident" id="5906451">s</span><span class="op" id="5906452">.</span><span class="ident" id="5906453">tokPos</span>&nbsp;<span class="op" id="5906460">&gt;=</span>&nbsp;<span class="num" id="5906463">0</span>&nbsp;<span class="op" id="5906465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5906471">s</span><span class="op" id="5906472">.</span><span class="ident" id="5906473">tokBuf</span><span class="op" id="5906479">.</span><span class="ident" id="5906480">Write</span><span class="op" id="5906485">(</span><span class="ident" id="5906486">s</span><span class="op" id="5906487">.</span><span class="ident" id="5906488">srcBuf</span><span class="op" id="5906494">[</span><span class="ident" id="5906495">s</span><span class="op" id="5906496">.</span><span class="ident" id="5906497">tokPos</span><span class="op" id="5906503">:</span><span class="ident" id="5906504">s</span><span class="op" id="5906505">.</span><span class="ident" id="5906506">srcPos</span><span class="op" id="5906512">]</span><span class="op" id="5906513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5906519">s</span><span class="op" id="5906520">.</span><span class="ident" id="5906521">tokPos</span>&nbsp;<span class="op" id="5906528">=</span>&nbsp;<span class="num" id="5906530">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906536">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5906568">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906573">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5906620">copy</span><span class="op" id="5906624">(</span><span class="ident" id="5906625">s</span><span class="op" id="5906626">.</span><span class="ident" id="5906627">srcBuf</span><span class="op" id="5906633">[</span><span class="num" id="5906634">0</span><span class="op" id="5906635">:</span><span class="op" id="5906636">]</span><span class="op" id="5906637">,</span>&nbsp;<span class="ident" id="5906639">s</span><span class="op" id="5906640">.</span><span class="ident" id="5906641">srcBuf</span><span class="op" id="5906647">[</span><span class="ident" id="5906648">s</span><span class="op" id="5906649">.</span><span class="ident" id="5906650">srcPos</span><span class="op" id="5906656">:</span><span class="ident" id="5906657">s</span><span class="op" id="5906658">.</span><span class="ident" id="5906659">srcEnd</span><span class="op" id="5906665">]</span><span class="op" id="5906666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5906671">s</span><span class="op" id="5906672">.</span><span class="ident" id="5906673">srcBufOffset</span>&nbsp;<span class="op" id="5906686">+=</span>&nbsp;<span class="ident" id="5906689">s</span><span class="op" id="5906690">.</span><span class="ident" id="5906691">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906701">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906723">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906778">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906833">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5906889">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5906947">i</span>&nbsp;<span class="op" id="5906949">:=</span>&nbsp;<span class="ident" id="5906952">s</span><span class="op" id="5906953">.</span><span class="ident" id="5906954">srcEnd</span>&nbsp;<span class="op" id="5906961">-</span>&nbsp;<span class="ident" id="5906963">s</span><span class="op" id="5906964">.</span><span class="ident" id="5906965">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5906975">n</span><span class="op" id="5906976">,</span>&nbsp;<span class="ident" id="5906978">err</span>&nbsp;<span class="op" id="5906982">:=</span>&nbsp;<span class="ident" id="5906985">s</span><span class="op" id="5906986">.</span><span class="ident" id="5906987">src</span><span class="op" id="5906990">.</span><span class="ident" id="5906991">Read</span><span class="op" id="5906995">(</span><span class="ident" id="5906996">s</span><span class="op" id="5906997">.</span><span class="ident" id="5906998">srcBuf</span><span class="op" id="5907004">[</span><span class="ident" id="5907005">i</span><span class="op" id="5907006">:</span><span class="ident" id="5907007">bufLen</span><span class="op" id="5907013">]</span><span class="op" id="5907014">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907019">s</span><span class="op" id="5907020">.</span><span class="ident" id="5907021">srcPos</span>&nbsp;<span class="op" id="5907028">=</span>&nbsp;<span class="num" id="5907030">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907035">s</span><span class="op" id="5907036">.</span><span class="ident" id="5907037">srcEnd</span>&nbsp;<span class="op" id="5907044">=</span>&nbsp;<span class="ident" id="5907046">i</span>&nbsp;<span class="op" id="5907048">+</span>&nbsp;<span class="ident" id="5907050">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907055">s</span><span class="op" id="5907056">.</span><span class="ident" id="5907057">srcBuf</span><span class="op" id="5907063">[</span><span class="ident" id="5907064">s</span><span class="op" id="5907065">.</span><span class="ident" id="5907066">srcEnd</span><span class="op" id="5907072">]</span>&nbsp;<span class="op" id="5907074">=</span>&nbsp;<span class="ident" id="5907076">utf8</span><span class="op" id="5907080">.</span><span class="ident" id="5907081">RuneSelf</span>&nbsp;<span class="comment" id="5907090">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907105">if</span>&nbsp;<span class="ident" id="5907108">err</span>&nbsp;<span class="op" id="5907112">!=</span>&nbsp;<span class="ident" id="5907115">nil</span>&nbsp;<span class="op" id="5907119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907125">if</span>&nbsp;<span class="ident" id="5907128">err</span>&nbsp;<span class="op" id="5907132">!=</span>&nbsp;<span class="ident" id="5907135">io</span><span class="op" id="5907137">.</span><span class="ident" id="5907138">EOF</span>&nbsp;<span class="op" id="5907142">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907149">s</span><span class="op" id="5907150">.</span><span class="builtintype" id="5907151">error</span><span class="op" id="5907156">(</span><span class="ident" id="5907157">err</span><span class="op" id="5907160">.</span><span class="ident" id="5907161">Error</span><span class="op" id="5907166">(</span><span class="op" id="5907167">)</span><span class="op" id="5907168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907180">if</span>&nbsp;<span class="ident" id="5907183">s</span><span class="op" id="5907184">.</span><span class="ident" id="5907185">srcEnd</span>&nbsp;<span class="op" id="5907192">==</span>&nbsp;<span class="num" id="5907195">0</span>&nbsp;<span class="op" id="5907197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907204">if</span>&nbsp;<span class="ident" id="5907207">s</span><span class="op" id="5907208">.</span><span class="ident" id="5907209">lastCharLen</span>&nbsp;<span class="op" id="5907221">&gt;</span>&nbsp;<span class="num" id="5907223">0</span>&nbsp;<span class="op" id="5907225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907233">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907273">s</span><span class="op" id="5907274">.</span><span class="ident" id="5907275">column</span><span class="op" id="5907281">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907296">s</span><span class="op" id="5907297">.</span><span class="ident" id="5907298">lastCharLen</span>&nbsp;<span class="op" id="5907310">=</span>&nbsp;<span class="num" id="5907312">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907319">return</span>&nbsp;<span class="ident" id="5907326">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907334">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907340">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907387">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907434">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907481">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907528">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907545">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907568">ch</span>&nbsp;<span class="op" id="5907571">=</span>&nbsp;<span class="builtintype" id="5907573">rune</span><span class="op" id="5907577">(</span><span class="ident" id="5907578">s</span><span class="op" id="5907579">.</span><span class="ident" id="5907580">srcBuf</span><span class="op" id="5907586">[</span><span class="ident" id="5907587">s</span><span class="op" id="5907588">.</span><span class="ident" id="5907589">srcPos</span><span class="op" id="5907595">]</span><span class="op" id="5907596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907600">if</span>&nbsp;<span class="ident" id="5907603">ch</span>&nbsp;<span class="op" id="5907606">&gt;=</span>&nbsp;<span class="ident" id="5907609">utf8</span><span class="op" id="5907613">.</span><span class="ident" id="5907614">RuneSelf</span>&nbsp;<span class="op" id="5907623">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907628">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907659">ch</span><span class="op" id="5907661">,</span>&nbsp;<span class="ident" id="5907663">width</span>&nbsp;<span class="op" id="5907669">=</span>&nbsp;<span class="ident" id="5907671">utf8</span><span class="op" id="5907675">.</span><span class="ident" id="5907676">DecodeRune</span><span class="op" id="5907686">(</span><span class="ident" id="5907687">s</span><span class="op" id="5907688">.</span><span class="ident" id="5907689">srcBuf</span><span class="op" id="5907695">[</span><span class="ident" id="5907696">s</span><span class="op" id="5907697">.</span><span class="ident" id="5907698">srcPos</span><span class="op" id="5907704">:</span><span class="ident" id="5907705">s</span><span class="op" id="5907706">.</span><span class="ident" id="5907707">srcEnd</span><span class="op" id="5907713">]</span><span class="op" id="5907714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907719">if</span>&nbsp;<span class="ident" id="5907722">ch</span>&nbsp;<span class="op" id="5907725">==</span>&nbsp;<span class="ident" id="5907728">utf8</span><span class="op" id="5907732">.</span><span class="ident" id="5907733">RuneError</span>&nbsp;<span class="op" id="5907743">&amp;&amp;</span>&nbsp;<span class="ident" id="5907746">width</span>&nbsp;<span class="op" id="5907752">==</span>&nbsp;<span class="num" id="5907755">1</span>&nbsp;<span class="op" id="5907757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907763">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907805">s</span><span class="op" id="5907806">.</span><span class="ident" id="5907807">srcPos</span>&nbsp;<span class="op" id="5907814">+=</span>&nbsp;<span class="ident" id="5907817">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907827">s</span><span class="op" id="5907828">.</span><span class="ident" id="5907829">lastCharLen</span>&nbsp;<span class="op" id="5907841">=</span>&nbsp;<span class="ident" id="5907843">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907853">s</span><span class="op" id="5907854">.</span><span class="ident" id="5907855">column</span><span class="op" id="5907861">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907868">s</span><span class="op" id="5907869">.</span><span class="builtintype" id="5907870">error</span><span class="op" id="5907875">(</span><span class="string" id="5907876">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="5907900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5907906">return</span>&nbsp;<span class="ident" id="5907913">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907919">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5907926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907930">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907942">s</span><span class="op" id="5907943">.</span><span class="ident" id="5907944">srcPos</span>&nbsp;<span class="op" id="5907951">+=</span>&nbsp;<span class="ident" id="5907954">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907961">s</span><span class="op" id="5907962">.</span><span class="ident" id="5907963">lastCharLen</span>&nbsp;<span class="op" id="5907975">=</span>&nbsp;<span class="ident" id="5907977">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5907984">s</span><span class="op" id="5907985">.</span><span class="ident" id="5907986">column</span><span class="op" id="5907992">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5907997">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908020">switch</span>&nbsp;<span class="ident" id="5908027">ch</span>&nbsp;<span class="op" id="5908030">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908033">case</span>&nbsp;<span class="num" id="5908038">0</span><span class="op" id="5908039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5908043">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908083">s</span><span class="op" id="5908084">.</span><span class="builtintype" id="5908085">error</span><span class="op" id="5908090">(</span><span class="string" id="5908091">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="5908114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908117">case</span>&nbsp;<span class="string" id="5908122">&#39;\n&#39;</span><span class="op" id="5908126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908130">s</span><span class="op" id="5908131">.</span><span class="ident" id="5908132">line</span><span class="op" id="5908136">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908141">s</span><span class="op" id="5908142">.</span><span class="ident" id="5908143">lastLineLen</span>&nbsp;<span class="op" id="5908155">=</span>&nbsp;<span class="ident" id="5908157">s</span><span class="op" id="5908158">.</span><span class="ident" id="5908159">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908168">s</span><span class="op" id="5908169">.</span><span class="ident" id="5908170">column</span>&nbsp;<span class="op" id="5908177">=</span>&nbsp;<span class="num" id="5908179">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5908182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908186">return</span>&nbsp;<span class="ident" id="5908193">ch</span><br>
<span class="lineno">305</span><span class="op" id="5908196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5908199">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="5908253">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="5908308">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="5908366">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5908424">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5908477">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5908506">func</span>&nbsp;<span class="op" id="5908511">(</span><span class="ident" id="5908512">s</span>&nbsp;<span class="op" id="5908514">*</span><span class="ident" id="5908515">Scanner</span><span class="op" id="5908522">)</span>&nbsp;<span class="ident" id="5908524">Next</span><span class="op" id="5908528">(</span><span class="op" id="5908529">)</span>&nbsp;<span class="builtintype" id="5908531">rune</span>&nbsp;<span class="op" id="5908536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908539">s</span><span class="op" id="5908540">.</span><span class="ident" id="5908541">tokPos</span>&nbsp;<span class="op" id="5908548">=</span>&nbsp;<span class="op" id="5908550">-</span><span class="num" id="5908551">1</span>&nbsp;<span class="comment" id="5908553">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908582">s</span><span class="op" id="5908583">.</span><span class="ident" id="5908584">Line</span>&nbsp;<span class="op" id="5908589">=</span>&nbsp;<span class="num" id="5908591">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5908596">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908626">ch</span>&nbsp;<span class="op" id="5908629">:=</span>&nbsp;<span class="ident" id="5908632">s</span><span class="op" id="5908633">.</span><span class="ident" id="5908634">Peek</span><span class="op" id="5908638">(</span><span class="op" id="5908639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908642">s</span><span class="op" id="5908643">.</span><span class="ident" id="5908644">ch</span>&nbsp;<span class="op" id="5908647">=</span>&nbsp;<span class="ident" id="5908649">s</span><span class="op" id="5908650">.</span><span class="ident" id="5908651">next</span><span class="op" id="5908655">(</span><span class="op" id="5908656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908659">return</span>&nbsp;<span class="ident" id="5908666">ch</span><br>
<span class="lineno"></span><span class="op" id="5908669">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5908672">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="5908747">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="5908819">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="5908847">func</span>&nbsp;<span class="op" id="5908852">(</span><span class="ident" id="5908853">s</span>&nbsp;<span class="op" id="5908855">*</span><span class="ident" id="5908856">Scanner</span><span class="op" id="5908863">)</span>&nbsp;<span class="ident" id="5908865">Peek</span><span class="op" id="5908869">(</span><span class="op" id="5908870">)</span>&nbsp;<span class="builtintype" id="5908872">rune</span>&nbsp;<span class="op" id="5908877">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908880">if</span>&nbsp;<span class="ident" id="5908883">s</span><span class="op" id="5908884">.</span><span class="ident" id="5908885">ch</span>&nbsp;<span class="op" id="5908888">&lt;</span>&nbsp;<span class="num" id="5908890">0</span>&nbsp;<span class="op" id="5908892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5908896">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908952">s</span><span class="op" id="5908953">.</span><span class="ident" id="5908954">ch</span>&nbsp;<span class="op" id="5908957">=</span>&nbsp;<span class="ident" id="5908959">s</span><span class="op" id="5908960">.</span><span class="ident" id="5908961">next</span><span class="op" id="5908965">(</span><span class="op" id="5908966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5908970">if</span>&nbsp;<span class="ident" id="5908973">s</span><span class="op" id="5908974">.</span><span class="ident" id="5908975">ch</span>&nbsp;<span class="op" id="5908978">==</span>&nbsp;<span class="string" id="5908981">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="5908990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5908995">s</span><span class="op" id="5908996">.</span><span class="ident" id="5908997">ch</span>&nbsp;<span class="op" id="5909000">=</span>&nbsp;<span class="ident" id="5909002">s</span><span class="op" id="5909003">.</span><span class="ident" id="5909004">next</span><span class="op" id="5909008">(</span><span class="op" id="5909009">)</span>&nbsp;<span class="comment" id="5909011">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909033">return</span>&nbsp;<span class="ident" id="5909040">s</span><span class="op" id="5909041">.</span><span class="ident" id="5909042">ch</span><br>
<span class="lineno"></span><span class="op" id="5909045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5909048">func</span>&nbsp;<span class="op" id="5909053">(</span><span class="ident" id="5909054">s</span>&nbsp;<span class="op" id="5909056">*</span><span class="ident" id="5909057">Scanner</span><span class="op" id="5909064">)</span>&nbsp;<span class="builtintype" id="5909066">error</span><span class="op" id="5909071">(</span><span class="ident" id="5909072">msg</span>&nbsp;<span class="builtintype" id="5909076">string</span><span class="op" id="5909082">)</span>&nbsp;<span class="op" id="5909084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909087">s</span><span class="op" id="5909088">.</span><span class="ident" id="5909089">ErrorCount</span><span class="op" id="5909099">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909103">if</span>&nbsp;<span class="ident" id="5909106">s</span><span class="op" id="5909107">.</span><span class="ident" id="5909108">Error</span>&nbsp;<span class="op" id="5909114">!=</span>&nbsp;<span class="ident" id="5909117">nil</span>&nbsp;<span class="op" id="5909121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909125">s</span><span class="op" id="5909126">.</span><span class="ident" id="5909127">Error</span><span class="op" id="5909132">(</span><span class="ident" id="5909133">s</span><span class="op" id="5909134">,</span>&nbsp;<span class="ident" id="5909136">msg</span><span class="op" id="5909139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909143">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909154">pos</span>&nbsp;<span class="op" id="5909158">:=</span>&nbsp;<span class="ident" id="5909161">s</span><span class="op" id="5909162">.</span><span class="ident" id="5909163">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909173">if</span>&nbsp;<span class="op" id="5909176">!</span><span class="ident" id="5909177">pos</span><span class="op" id="5909180">.</span><span class="ident" id="5909181">IsValid</span><span class="op" id="5909188">(</span><span class="op" id="5909189">)</span>&nbsp;<span class="op" id="5909191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909195">pos</span>&nbsp;<span class="op" id="5909199">=</span>&nbsp;<span class="ident" id="5909201">s</span><span class="op" id="5909202">.</span><span class="ident" id="5909203">Pos</span><span class="op" id="5909206">(</span><span class="op" id="5909207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909210">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909213">fmt</span><span class="op" id="5909216">.</span><span class="ident" id="5909217">Fprintf</span><span class="op" id="5909224">(</span><span class="ident" id="5909225">os</span><span class="op" id="5909227">.</span><span class="ident" id="5909228">Stderr</span><span class="op" id="5909234">,</span>&nbsp;<span class="string" id="5909236">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="5909246">,</span>&nbsp;<span class="ident" id="5909248">pos</span><span class="op" id="5909251">,</span>&nbsp;<span class="ident" id="5909253">msg</span><span class="op" id="5909256">)</span><br>
<span class="lineno"></span><span class="op" id="5909258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5909261">func</span>&nbsp;<span class="op" id="5909266">(</span><span class="ident" id="5909267">s</span>&nbsp;<span class="op" id="5909269">*</span><span class="ident" id="5909270">Scanner</span><span class="op" id="5909277">)</span>&nbsp;<span class="ident" id="5909279">isIdentRune</span><span class="op" id="5909290">(</span><span class="ident" id="5909291">ch</span>&nbsp;<span class="builtintype" id="5909294">rune</span><span class="op" id="5909298">,</span>&nbsp;<span class="ident" id="5909300">i</span>&nbsp;<span class="builtintype" id="5909302">int</span><span class="op" id="5909305">)</span>&nbsp;<span class="builtintype" id="5909307">bool</span>&nbsp;<span class="op" id="5909312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909315">if</span>&nbsp;<span class="ident" id="5909318">s</span><span class="op" id="5909319">.</span><span class="ident" id="5909320">IsIdentRune</span>&nbsp;<span class="op" id="5909332">!=</span>&nbsp;<span class="ident" id="5909335">nil</span>&nbsp;<span class="op" id="5909339">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909343">return</span>&nbsp;<span class="ident" id="5909350">s</span><span class="op" id="5909351">.</span><span class="ident" id="5909352">IsIdentRune</span><span class="op" id="5909363">(</span><span class="ident" id="5909364">ch</span><span class="op" id="5909366">,</span>&nbsp;<span class="ident" id="5909368">i</span><span class="op" id="5909369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909375">return</span>&nbsp;<span class="ident" id="5909382">ch</span>&nbsp;<span class="op" id="5909385">==</span>&nbsp;<span class="string" id="5909388">&#39;_&#39;</span>&nbsp;<span class="op" id="5909392">||</span>&nbsp;<span class="ident" id="5909395">unicode</span><span class="op" id="5909402">.</span><span class="ident" id="5909403">IsLetter</span><span class="op" id="5909411">(</span><span class="ident" id="5909412">ch</span><span class="op" id="5909414">)</span>&nbsp;<span class="op" id="5909416">||</span>&nbsp;<span class="ident" id="5909419">unicode</span><span class="op" id="5909426">.</span><span class="ident" id="5909427">IsDigit</span><span class="op" id="5909434">(</span><span class="ident" id="5909435">ch</span><span class="op" id="5909437">)</span>&nbsp;<span class="op" id="5909439">&amp;&amp;</span>&nbsp;<span class="ident" id="5909442">i</span>&nbsp;<span class="op" id="5909444">&gt;</span>&nbsp;<span class="num" id="5909446">0</span><br>
<span class="lineno"></span><span class="op" id="5909448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5909451">func</span>&nbsp;<span class="op" id="5909456">(</span><span class="ident" id="5909457">s</span>&nbsp;<span class="op" id="5909459">*</span><span class="ident" id="5909460">Scanner</span><span class="op" id="5909467">)</span>&nbsp;<span class="ident" id="5909469">scanIdentifier</span><span class="op" id="5909483">(</span><span class="op" id="5909484">)</span>&nbsp;<span class="builtintype" id="5909486">rune</span>&nbsp;<span class="op" id="5909491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5909494">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909561">ch</span>&nbsp;<span class="op" id="5909564">:=</span>&nbsp;<span class="ident" id="5909567">s</span><span class="op" id="5909568">.</span><span class="ident" id="5909569">next</span><span class="op" id="5909573">(</span><span class="op" id="5909574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909577">for</span>&nbsp;<span class="ident" id="5909581">i</span>&nbsp;<span class="op" id="5909583">:=</span>&nbsp;<span class="num" id="5909586">1</span><span class="op" id="5909587">;</span>&nbsp;<span class="ident" id="5909589">s</span><span class="op" id="5909590">.</span><span class="ident" id="5909591">isIdentRune</span><span class="op" id="5909602">(</span><span class="ident" id="5909603">ch</span><span class="op" id="5909605">,</span>&nbsp;<span class="ident" id="5909607">i</span><span class="op" id="5909608">)</span><span class="op" id="5909609">;</span>&nbsp;<span class="ident" id="5909611">i</span><span class="op" id="5909612">++</span>&nbsp;<span class="op" id="5909615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5909619">ch</span>&nbsp;<span class="op" id="5909622">=</span>&nbsp;<span class="ident" id="5909624">s</span><span class="op" id="5909625">.</span><span class="ident" id="5909626">next</span><span class="op" id="5909630">(</span><span class="op" id="5909631">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909637">return</span>&nbsp;<span class="ident" id="5909644">ch</span><br>
<span class="lineno"></span><span class="op" id="5909647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5909650">func</span>&nbsp;<span class="ident" id="5909655">digitVal</span><span class="op" id="5909663">(</span><span class="ident" id="5909664">ch</span>&nbsp;<span class="builtintype" id="5909667">rune</span><span class="op" id="5909671">)</span>&nbsp;<span class="builtintype" id="5909673">int</span>&nbsp;<span class="op" id="5909677">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909680">switch</span>&nbsp;<span class="op" id="5909687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909690">case</span>&nbsp;<span class="string" id="5909695">&#39;0&#39;</span>&nbsp;<span class="op" id="5909699">&lt;=</span>&nbsp;<span class="ident" id="5909702">ch</span>&nbsp;<span class="op" id="5909705">&amp;&amp;</span>&nbsp;<span class="ident" id="5909708">ch</span>&nbsp;<span class="op" id="5909711">&lt;=</span>&nbsp;<span class="string" id="5909714">&#39;9&#39;</span><span class="op" id="5909717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909721">return</span>&nbsp;<span class="builtintype" id="5909728">int</span><span class="op" id="5909731">(</span><span class="ident" id="5909732">ch</span>&nbsp;<span class="op" id="5909735">-</span>&nbsp;<span class="string" id="5909737">&#39;0&#39;</span><span class="op" id="5909740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909743">case</span>&nbsp;<span class="string" id="5909748">&#39;a&#39;</span>&nbsp;<span class="op" id="5909752">&lt;=</span>&nbsp;<span class="ident" id="5909755">ch</span>&nbsp;<span class="op" id="5909758">&amp;&amp;</span>&nbsp;<span class="ident" id="5909761">ch</span>&nbsp;<span class="op" id="5909764">&lt;=</span>&nbsp;<span class="string" id="5909767">&#39;f&#39;</span><span class="op" id="5909770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909774">return</span>&nbsp;<span class="builtintype" id="5909781">int</span><span class="op" id="5909784">(</span><span class="ident" id="5909785">ch</span>&nbsp;<span class="op" id="5909788">-</span>&nbsp;<span class="string" id="5909790">&#39;a&#39;</span>&nbsp;<span class="op" id="5909794">+</span>&nbsp;<span class="num" id="5909796">10</span><span class="op" id="5909798">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909801">case</span>&nbsp;<span class="string" id="5909806">&#39;A&#39;</span>&nbsp;<span class="op" id="5909810">&lt;=</span>&nbsp;<span class="ident" id="5909813">ch</span>&nbsp;<span class="op" id="5909816">&amp;&amp;</span>&nbsp;<span class="ident" id="5909819">ch</span>&nbsp;<span class="op" id="5909822">&lt;=</span>&nbsp;<span class="string" id="5909825">&#39;F&#39;</span><span class="op" id="5909828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909832">return</span>&nbsp;<span class="builtintype" id="5909839">int</span><span class="op" id="5909842">(</span><span class="ident" id="5909843">ch</span>&nbsp;<span class="op" id="5909846">-</span>&nbsp;<span class="string" id="5909848">&#39;A&#39;</span>&nbsp;<span class="op" id="5909852">+</span>&nbsp;<span class="num" id="5909854">10</span><span class="op" id="5909856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5909859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5909862">return</span>&nbsp;<span class="num" id="5909869">16</span>&nbsp;<span class="comment" id="5909872">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="5909907">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="5909910">func</span>&nbsp;<span class="ident" id="5909915">isDecimal</span><span class="op" id="5909924">(</span><span class="ident" id="5909925">ch</span>&nbsp;<span class="builtintype" id="5909928">rune</span><span class="op" id="5909932">)</span>&nbsp;<span class="builtintype" id="5909934">bool</span>&nbsp;<span class="op" id="5909939">{</span>&nbsp;<span class="keyword" id="5909941">return</span>&nbsp;<span class="string" id="5909948">&#39;0&#39;</span>&nbsp;<span class="op" id="5909952">&lt;=</span>&nbsp;<span class="ident" id="5909955">ch</span>&nbsp;<span class="op" id="5909958">&amp;&amp;</span>&nbsp;<span class="ident" id="5909961">ch</span>&nbsp;<span class="op" id="5909964">&lt;=</span>&nbsp;<span class="string" id="5909967">&#39;9&#39;</span>&nbsp;<span class="op" id="5909971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5909974">func</span>&nbsp;<span class="op" id="5909979">(</span><span class="ident" id="5909980">s</span>&nbsp;<span class="op" id="5909982">*</span><span class="ident" id="5909983">Scanner</span><span class="op" id="5909990">)</span>&nbsp;<span class="ident" id="5909992">scanMantissa</span><span class="op" id="5910004">(</span><span class="ident" id="5910005">ch</span>&nbsp;<span class="builtintype" id="5910008">rune</span><span class="op" id="5910012">)</span>&nbsp;<span class="builtintype" id="5910014">rune</span>&nbsp;<span class="op" id="5910019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910022">for</span>&nbsp;<span class="ident" id="5910026">isDecimal</span><span class="op" id="5910035">(</span><span class="ident" id="5910036">ch</span><span class="op" id="5910038">)</span>&nbsp;<span class="op" id="5910040">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910044">ch</span>&nbsp;<span class="op" id="5910047">=</span>&nbsp;<span class="ident" id="5910049">s</span><span class="op" id="5910050">.</span><span class="ident" id="5910051">next</span><span class="op" id="5910055">(</span><span class="op" id="5910056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910062">return</span>&nbsp;<span class="ident" id="5910069">ch</span><br>
<span class="lineno"></span><span class="op" id="5910072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5910075">func</span>&nbsp;<span class="op" id="5910080">(</span><span class="ident" id="5910081">s</span>&nbsp;<span class="op" id="5910083">*</span><span class="ident" id="5910084">Scanner</span><span class="op" id="5910091">)</span>&nbsp;<span class="ident" id="5910093">scanFraction</span><span class="op" id="5910105">(</span><span class="ident" id="5910106">ch</span>&nbsp;<span class="builtintype" id="5910109">rune</span><span class="op" id="5910113">)</span>&nbsp;<span class="builtintype" id="5910115">rune</span>&nbsp;<span class="op" id="5910120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910123">if</span>&nbsp;<span class="ident" id="5910126">ch</span>&nbsp;<span class="op" id="5910129">==</span>&nbsp;<span class="string" id="5910132">&#39;.&#39;</span>&nbsp;<span class="op" id="5910136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910140">ch</span>&nbsp;<span class="op" id="5910143">=</span>&nbsp;<span class="ident" id="5910145">s</span><span class="op" id="5910146">.</span><span class="ident" id="5910147">scanMantissa</span><span class="op" id="5910159">(</span><span class="ident" id="5910160">s</span><span class="op" id="5910161">.</span><span class="ident" id="5910162">next</span><span class="op" id="5910166">(</span><span class="op" id="5910167">)</span><span class="op" id="5910168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910174">return</span>&nbsp;<span class="ident" id="5910181">ch</span><br>
<span class="lineno">390</span><span class="op" id="5910184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5910187">func</span>&nbsp;<span class="op" id="5910192">(</span><span class="ident" id="5910193">s</span>&nbsp;<span class="op" id="5910195">*</span><span class="ident" id="5910196">Scanner</span><span class="op" id="5910203">)</span>&nbsp;<span class="ident" id="5910205">scanExponent</span><span class="op" id="5910217">(</span><span class="ident" id="5910218">ch</span>&nbsp;<span class="builtintype" id="5910221">rune</span><span class="op" id="5910225">)</span>&nbsp;<span class="builtintype" id="5910227">rune</span>&nbsp;<span class="op" id="5910232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910235">if</span>&nbsp;<span class="ident" id="5910238">ch</span>&nbsp;<span class="op" id="5910241">==</span>&nbsp;<span class="string" id="5910244">&#39;e&#39;</span>&nbsp;<span class="op" id="5910248">||</span>&nbsp;<span class="ident" id="5910251">ch</span>&nbsp;<span class="op" id="5910254">==</span>&nbsp;<span class="string" id="5910257">&#39;E&#39;</span>&nbsp;<span class="op" id="5910261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910265">ch</span>&nbsp;<span class="op" id="5910268">=</span>&nbsp;<span class="ident" id="5910270">s</span><span class="op" id="5910271">.</span><span class="ident" id="5910272">next</span><span class="op" id="5910276">(</span><span class="op" id="5910277">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910281">if</span>&nbsp;<span class="ident" id="5910284">ch</span>&nbsp;<span class="op" id="5910287">==</span>&nbsp;<span class="string" id="5910290">&#39;-&#39;</span>&nbsp;<span class="op" id="5910294">||</span>&nbsp;<span class="ident" id="5910297">ch</span>&nbsp;<span class="op" id="5910300">==</span>&nbsp;<span class="string" id="5910303">&#39;+&#39;</span>&nbsp;<span class="op" id="5910307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910312">ch</span>&nbsp;<span class="op" id="5910315">=</span>&nbsp;<span class="ident" id="5910317">s</span><span class="op" id="5910318">.</span><span class="ident" id="5910319">next</span><span class="op" id="5910323">(</span><span class="op" id="5910324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910332">ch</span>&nbsp;<span class="op" id="5910335">=</span>&nbsp;<span class="ident" id="5910337">s</span><span class="op" id="5910338">.</span><span class="ident" id="5910339">scanMantissa</span><span class="op" id="5910351">(</span><span class="ident" id="5910352">ch</span><span class="op" id="5910354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910357">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910360">return</span>&nbsp;<span class="ident" id="5910367">ch</span><br>
<span class="lineno"></span><span class="op" id="5910370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5910373">func</span>&nbsp;<span class="op" id="5910378">(</span><span class="ident" id="5910379">s</span>&nbsp;<span class="op" id="5910381">*</span><span class="ident" id="5910382">Scanner</span><span class="op" id="5910389">)</span>&nbsp;<span class="ident" id="5910391">scanNumber</span><span class="op" id="5910401">(</span><span class="ident" id="5910402">ch</span>&nbsp;<span class="builtintype" id="5910405">rune</span><span class="op" id="5910409">)</span>&nbsp;<span class="op" id="5910411">(</span><span class="builtintype" id="5910412">rune</span><span class="op" id="5910416">,</span>&nbsp;<span class="builtintype" id="5910418">rune</span><span class="op" id="5910422">)</span>&nbsp;<span class="op" id="5910424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5910427">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910445">if</span>&nbsp;<span class="ident" id="5910448">ch</span>&nbsp;<span class="op" id="5910451">==</span>&nbsp;<span class="string" id="5910454">&#39;0&#39;</span>&nbsp;<span class="op" id="5910458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5910462">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910480">ch</span>&nbsp;<span class="op" id="5910483">=</span>&nbsp;<span class="ident" id="5910485">s</span><span class="op" id="5910486">.</span><span class="ident" id="5910487">next</span><span class="op" id="5910491">(</span><span class="op" id="5910492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910496">if</span>&nbsp;<span class="ident" id="5910499">ch</span>&nbsp;<span class="op" id="5910502">==</span>&nbsp;<span class="string" id="5910505">&#39;x&#39;</span>&nbsp;<span class="op" id="5910509">||</span>&nbsp;<span class="ident" id="5910512">ch</span>&nbsp;<span class="op" id="5910515">==</span>&nbsp;<span class="string" id="5910518">&#39;X&#39;</span>&nbsp;<span class="op" id="5910522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5910527">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910549">ch</span>&nbsp;<span class="op" id="5910552">=</span>&nbsp;<span class="ident" id="5910554">s</span><span class="op" id="5910555">.</span><span class="ident" id="5910556">next</span><span class="op" id="5910560">(</span><span class="op" id="5910561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910566">hasMantissa</span>&nbsp;<span class="op" id="5910578">:=</span>&nbsp;<span class="builtintype" id="5910581">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910590">for</span>&nbsp;<span class="ident" id="5910594">digitVal</span><span class="op" id="5910602">(</span><span class="ident" id="5910603">ch</span><span class="op" id="5910605">)</span>&nbsp;<span class="op" id="5910607">&lt;</span>&nbsp;<span class="num" id="5910609">16</span>&nbsp;<span class="op" id="5910612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910618">ch</span>&nbsp;<span class="op" id="5910621">=</span>&nbsp;<span class="ident" id="5910623">s</span><span class="op" id="5910624">.</span><span class="ident" id="5910625">next</span><span class="op" id="5910629">(</span><span class="op" id="5910630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910636">hasMantissa</span>&nbsp;<span class="op" id="5910648">=</span>&nbsp;<span class="builtintype" id="5910650">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910663">if</span>&nbsp;<span class="op" id="5910666">!</span><span class="ident" id="5910667">hasMantissa</span>&nbsp;<span class="op" id="5910679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910685">s</span><span class="op" id="5910686">.</span><span class="builtintype" id="5910687">error</span><span class="op" id="5910692">(</span><span class="string" id="5910693">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="5910721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910730">}</span>&nbsp;<span class="keyword" id="5910732">else</span>&nbsp;<span class="op" id="5910737">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5910742">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910767">has8or9</span>&nbsp;<span class="op" id="5910775">:=</span>&nbsp;<span class="builtintype" id="5910778">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910787">for</span>&nbsp;<span class="ident" id="5910791">isDecimal</span><span class="op" id="5910800">(</span><span class="ident" id="5910801">ch</span><span class="op" id="5910803">)</span>&nbsp;<span class="op" id="5910805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910811">if</span>&nbsp;<span class="ident" id="5910814">ch</span>&nbsp;<span class="op" id="5910817">&gt;</span>&nbsp;<span class="string" id="5910819">&#39;7&#39;</span>&nbsp;<span class="op" id="5910823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910830">has8or9</span>&nbsp;<span class="op" id="5910838">=</span>&nbsp;<span class="builtintype" id="5910840">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910855">ch</span>&nbsp;<span class="op" id="5910858">=</span>&nbsp;<span class="ident" id="5910860">s</span><span class="op" id="5910861">.</span><span class="ident" id="5910862">next</span><span class="op" id="5910866">(</span><span class="op" id="5910867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5910872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5910877">if</span>&nbsp;<span class="ident" id="5910880">s</span><span class="op" id="5910881">.</span><span class="ident" id="5910882">Mode</span><span class="op" id="5910886">&amp;</span><span class="ident" id="5910887">ScanFloats</span>&nbsp;<span class="op" id="5910898">!=</span>&nbsp;<span class="num" id="5910901">0</span>&nbsp;<span class="op" id="5910903">&amp;&amp;</span>&nbsp;<span class="op" id="5910906">(</span><span class="ident" id="5910907">ch</span>&nbsp;<span class="op" id="5910910">==</span>&nbsp;<span class="string" id="5910913">&#39;.&#39;</span>&nbsp;<span class="op" id="5910917">||</span>&nbsp;<span class="ident" id="5910920">ch</span>&nbsp;<span class="op" id="5910923">==</span>&nbsp;<span class="string" id="5910926">&#39;e&#39;</span>&nbsp;<span class="op" id="5910930">||</span>&nbsp;<span class="ident" id="5910933">ch</span>&nbsp;<span class="op" id="5910936">==</span>&nbsp;<span class="string" id="5910939">&#39;E&#39;</span><span class="op" id="5910942">)</span>&nbsp;<span class="op" id="5910944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5910950">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910963">ch</span>&nbsp;<span class="op" id="5910966">=</span>&nbsp;<span class="ident" id="5910968">s</span><span class="op" id="5910969">.</span><span class="ident" id="5910970">scanFraction</span><span class="op" id="5910982">(</span><span class="ident" id="5910983">ch</span><span class="op" id="5910985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5910991">ch</span>&nbsp;<span class="op" id="5910994">=</span>&nbsp;<span class="ident" id="5910996">s</span><span class="op" id="5910997">.</span><span class="ident" id="5910998">scanExponent</span><span class="op" id="5911010">(</span><span class="ident" id="5911011">ch</span><span class="op" id="5911013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911019">return</span>&nbsp;<span class="ident" id="5911026">Float</span><span class="op" id="5911031">,</span>&nbsp;<span class="ident" id="5911033">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5911044">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911060">if</span>&nbsp;<span class="ident" id="5911063">has8or9</span>&nbsp;<span class="op" id="5911071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911077">s</span><span class="op" id="5911078">.</span><span class="builtintype" id="5911079">error</span><span class="op" id="5911084">(</span><span class="string" id="5911085">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="5911107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911120">return</span>&nbsp;<span class="ident" id="5911127">Int</span><span class="op" id="5911130">,</span>&nbsp;<span class="ident" id="5911132">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5911139">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911164">ch</span>&nbsp;<span class="op" id="5911167">=</span>&nbsp;<span class="ident" id="5911169">s</span><span class="op" id="5911170">.</span><span class="ident" id="5911171">scanMantissa</span><span class="op" id="5911183">(</span><span class="ident" id="5911184">ch</span><span class="op" id="5911186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911189">if</span>&nbsp;<span class="ident" id="5911192">s</span><span class="op" id="5911193">.</span><span class="ident" id="5911194">Mode</span><span class="op" id="5911198">&amp;</span><span class="ident" id="5911199">ScanFloats</span>&nbsp;<span class="op" id="5911210">!=</span>&nbsp;<span class="num" id="5911213">0</span>&nbsp;<span class="op" id="5911215">&amp;&amp;</span>&nbsp;<span class="op" id="5911218">(</span><span class="ident" id="5911219">ch</span>&nbsp;<span class="op" id="5911222">==</span>&nbsp;<span class="string" id="5911225">&#39;.&#39;</span>&nbsp;<span class="op" id="5911229">||</span>&nbsp;<span class="ident" id="5911232">ch</span>&nbsp;<span class="op" id="5911235">==</span>&nbsp;<span class="string" id="5911238">&#39;e&#39;</span>&nbsp;<span class="op" id="5911242">||</span>&nbsp;<span class="ident" id="5911245">ch</span>&nbsp;<span class="op" id="5911248">==</span>&nbsp;<span class="string" id="5911251">&#39;E&#39;</span><span class="op" id="5911254">)</span>&nbsp;<span class="op" id="5911256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5911260">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911271">ch</span>&nbsp;<span class="op" id="5911274">=</span>&nbsp;<span class="ident" id="5911276">s</span><span class="op" id="5911277">.</span><span class="ident" id="5911278">scanFraction</span><span class="op" id="5911290">(</span><span class="ident" id="5911291">ch</span><span class="op" id="5911293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911297">ch</span>&nbsp;<span class="op" id="5911300">=</span>&nbsp;<span class="ident" id="5911302">s</span><span class="op" id="5911303">.</span><span class="ident" id="5911304">scanExponent</span><span class="op" id="5911316">(</span><span class="ident" id="5911317">ch</span><span class="op" id="5911319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911323">return</span>&nbsp;<span class="ident" id="5911330">Float</span><span class="op" id="5911335">,</span>&nbsp;<span class="ident" id="5911337">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911344">return</span>&nbsp;<span class="ident" id="5911351">Int</span><span class="op" id="5911354">,</span>&nbsp;<span class="ident" id="5911356">ch</span><br>
<span class="lineno">450</span><span class="op" id="5911359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5911362">func</span>&nbsp;<span class="op" id="5911367">(</span><span class="ident" id="5911368">s</span>&nbsp;<span class="op" id="5911370">*</span><span class="ident" id="5911371">Scanner</span><span class="op" id="5911378">)</span>&nbsp;<span class="ident" id="5911380">scanDigits</span><span class="op" id="5911390">(</span><span class="ident" id="5911391">ch</span>&nbsp;<span class="builtintype" id="5911394">rune</span><span class="op" id="5911398">,</span>&nbsp;<span class="ident" id="5911400">base</span><span class="op" id="5911404">,</span>&nbsp;<span class="ident" id="5911406">n</span>&nbsp;<span class="builtintype" id="5911408">int</span><span class="op" id="5911411">)</span>&nbsp;<span class="builtintype" id="5911413">rune</span>&nbsp;<span class="op" id="5911418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911421">for</span>&nbsp;<span class="ident" id="5911425">n</span>&nbsp;<span class="op" id="5911427">&gt;</span>&nbsp;<span class="num" id="5911429">0</span>&nbsp;<span class="op" id="5911431">&amp;&amp;</span>&nbsp;<span class="ident" id="5911434">digitVal</span><span class="op" id="5911442">(</span><span class="ident" id="5911443">ch</span><span class="op" id="5911445">)</span>&nbsp;<span class="op" id="5911447">&lt;</span>&nbsp;<span class="ident" id="5911449">base</span>&nbsp;<span class="op" id="5911454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911458">ch</span>&nbsp;<span class="op" id="5911461">=</span>&nbsp;<span class="ident" id="5911463">s</span><span class="op" id="5911464">.</span><span class="ident" id="5911465">next</span><span class="op" id="5911469">(</span><span class="op" id="5911470">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911474">n</span><span class="op" id="5911475">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911482">if</span>&nbsp;<span class="ident" id="5911485">n</span>&nbsp;<span class="op" id="5911487">&gt;</span>&nbsp;<span class="num" id="5911489">0</span>&nbsp;<span class="op" id="5911491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911495">s</span><span class="op" id="5911496">.</span><span class="builtintype" id="5911497">error</span><span class="op" id="5911502">(</span><span class="string" id="5911503">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5911524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5911527">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911530">return</span>&nbsp;<span class="ident" id="5911537">ch</span><br>
<span class="lineno"></span><span class="op" id="5911540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5911543">func</span>&nbsp;<span class="op" id="5911548">(</span><span class="ident" id="5911549">s</span>&nbsp;<span class="op" id="5911551">*</span><span class="ident" id="5911552">Scanner</span><span class="op" id="5911559">)</span>&nbsp;<span class="ident" id="5911561">scanEscape</span><span class="op" id="5911571">(</span><span class="ident" id="5911572">quote</span>&nbsp;<span class="builtintype" id="5911578">rune</span><span class="op" id="5911582">)</span>&nbsp;<span class="builtintype" id="5911584">rune</span>&nbsp;<span class="op" id="5911589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911592">ch</span>&nbsp;<span class="op" id="5911595">:=</span>&nbsp;<span class="ident" id="5911598">s</span><span class="op" id="5911599">.</span><span class="ident" id="5911600">next</span><span class="op" id="5911604">(</span><span class="op" id="5911605">)</span>&nbsp;<span class="comment" id="5911607">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911636">switch</span>&nbsp;<span class="ident" id="5911643">ch</span>&nbsp;<span class="op" id="5911646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911649">case</span>&nbsp;<span class="string" id="5911654">&#39;a&#39;</span><span class="op" id="5911657">,</span>&nbsp;<span class="string" id="5911659">&#39;b&#39;</span><span class="op" id="5911662">,</span>&nbsp;<span class="string" id="5911664">&#39;f&#39;</span><span class="op" id="5911667">,</span>&nbsp;<span class="string" id="5911669">&#39;n&#39;</span><span class="op" id="5911672">,</span>&nbsp;<span class="string" id="5911674">&#39;r&#39;</span><span class="op" id="5911677">,</span>&nbsp;<span class="string" id="5911679">&#39;t&#39;</span><span class="op" id="5911682">,</span>&nbsp;<span class="string" id="5911684">&#39;v&#39;</span><span class="op" id="5911687">,</span>&nbsp;<span class="string" id="5911689">&#39;\\&#39;</span><span class="op" id="5911693">,</span>&nbsp;<span class="ident" id="5911695">quote</span><span class="op" id="5911700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5911704">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911723">ch</span>&nbsp;<span class="op" id="5911726">=</span>&nbsp;<span class="ident" id="5911728">s</span><span class="op" id="5911729">.</span><span class="ident" id="5911730">next</span><span class="op" id="5911734">(</span><span class="op" id="5911735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911738">case</span>&nbsp;<span class="string" id="5911743">&#39;0&#39;</span><span class="op" id="5911746">,</span>&nbsp;<span class="string" id="5911748">&#39;1&#39;</span><span class="op" id="5911751">,</span>&nbsp;<span class="string" id="5911753">&#39;2&#39;</span><span class="op" id="5911756">,</span>&nbsp;<span class="string" id="5911758">&#39;3&#39;</span><span class="op" id="5911761">,</span>&nbsp;<span class="string" id="5911763">&#39;4&#39;</span><span class="op" id="5911766">,</span>&nbsp;<span class="string" id="5911768">&#39;5&#39;</span><span class="op" id="5911771">,</span>&nbsp;<span class="string" id="5911773">&#39;6&#39;</span><span class="op" id="5911776">,</span>&nbsp;<span class="string" id="5911778">&#39;7&#39;</span><span class="op" id="5911781">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911785">ch</span>&nbsp;<span class="op" id="5911788">=</span>&nbsp;<span class="ident" id="5911790">s</span><span class="op" id="5911791">.</span><span class="ident" id="5911792">scanDigits</span><span class="op" id="5911802">(</span><span class="ident" id="5911803">ch</span><span class="op" id="5911805">,</span>&nbsp;<span class="num" id="5911807">8</span><span class="op" id="5911808">,</span>&nbsp;<span class="num" id="5911810">3</span><span class="op" id="5911811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911814">case</span>&nbsp;<span class="string" id="5911819">&#39;x&#39;</span><span class="op" id="5911822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911826">ch</span>&nbsp;<span class="op" id="5911829">=</span>&nbsp;<span class="ident" id="5911831">s</span><span class="op" id="5911832">.</span><span class="ident" id="5911833">scanDigits</span><span class="op" id="5911843">(</span><span class="ident" id="5911844">s</span><span class="op" id="5911845">.</span><span class="ident" id="5911846">next</span><span class="op" id="5911850">(</span><span class="op" id="5911851">)</span><span class="op" id="5911852">,</span>&nbsp;<span class="num" id="5911854">16</span><span class="op" id="5911856">,</span>&nbsp;<span class="num" id="5911858">2</span><span class="op" id="5911859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911862">case</span>&nbsp;<span class="string" id="5911867">&#39;u&#39;</span><span class="op" id="5911870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911874">ch</span>&nbsp;<span class="op" id="5911877">=</span>&nbsp;<span class="ident" id="5911879">s</span><span class="op" id="5911880">.</span><span class="ident" id="5911881">scanDigits</span><span class="op" id="5911891">(</span><span class="ident" id="5911892">s</span><span class="op" id="5911893">.</span><span class="ident" id="5911894">next</span><span class="op" id="5911898">(</span><span class="op" id="5911899">)</span><span class="op" id="5911900">,</span>&nbsp;<span class="num" id="5911902">16</span><span class="op" id="5911904">,</span>&nbsp;<span class="num" id="5911906">4</span><span class="op" id="5911907">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911910">case</span>&nbsp;<span class="string" id="5911915">&#39;U&#39;</span><span class="op" id="5911918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911922">ch</span>&nbsp;<span class="op" id="5911925">=</span>&nbsp;<span class="ident" id="5911927">s</span><span class="op" id="5911928">.</span><span class="ident" id="5911929">scanDigits</span><span class="op" id="5911939">(</span><span class="ident" id="5911940">s</span><span class="op" id="5911941">.</span><span class="ident" id="5911942">next</span><span class="op" id="5911946">(</span><span class="op" id="5911947">)</span><span class="op" id="5911948">,</span>&nbsp;<span class="num" id="5911950">16</span><span class="op" id="5911952">,</span>&nbsp;<span class="num" id="5911954">8</span><span class="op" id="5911955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5911958">default</span><span class="op" id="5911965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5911969">s</span><span class="op" id="5911970">.</span><span class="builtintype" id="5911971">error</span><span class="op" id="5911976">(</span><span class="string" id="5911977">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="5911998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912001">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912004">return</span>&nbsp;<span class="ident" id="5912011">ch</span><br>
<span class="lineno"></span><span class="op" id="5912014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5912017">func</span>&nbsp;<span class="op" id="5912022">(</span><span class="ident" id="5912023">s</span>&nbsp;<span class="op" id="5912025">*</span><span class="ident" id="5912026">Scanner</span><span class="op" id="5912033">)</span>&nbsp;<span class="ident" id="5912035">scanString</span><span class="op" id="5912045">(</span><span class="ident" id="5912046">quote</span>&nbsp;<span class="builtintype" id="5912052">rune</span><span class="op" id="5912056">)</span>&nbsp;<span class="op" id="5912058">(</span><span class="ident" id="5912059">n</span>&nbsp;<span class="builtintype" id="5912061">int</span><span class="op" id="5912064">)</span>&nbsp;<span class="op" id="5912066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912069">ch</span>&nbsp;<span class="op" id="5912072">:=</span>&nbsp;<span class="ident" id="5912075">s</span><span class="op" id="5912076">.</span><span class="ident" id="5912077">next</span><span class="op" id="5912081">(</span><span class="op" id="5912082">)</span>&nbsp;<span class="comment" id="5912084">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912115">for</span>&nbsp;<span class="ident" id="5912119">ch</span>&nbsp;<span class="op" id="5912122">!=</span>&nbsp;<span class="ident" id="5912125">quote</span>&nbsp;<span class="op" id="5912131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912135">if</span>&nbsp;<span class="ident" id="5912138">ch</span>&nbsp;<span class="op" id="5912141">==</span>&nbsp;<span class="string" id="5912144">&#39;\n&#39;</span>&nbsp;<span class="op" id="5912149">||</span>&nbsp;<span class="ident" id="5912152">ch</span>&nbsp;<span class="op" id="5912155">&lt;</span>&nbsp;<span class="num" id="5912157">0</span>&nbsp;<span class="op" id="5912159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912164">s</span><span class="op" id="5912165">.</span><span class="builtintype" id="5912166">error</span><span class="op" id="5912171">(</span><span class="string" id="5912172">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5912196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912201">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912210">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912214">if</span>&nbsp;<span class="ident" id="5912217">ch</span>&nbsp;<span class="op" id="5912220">==</span>&nbsp;<span class="string" id="5912223">&#39;\\&#39;</span>&nbsp;<span class="op" id="5912228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912233">ch</span>&nbsp;<span class="op" id="5912236">=</span>&nbsp;<span class="ident" id="5912238">s</span><span class="op" id="5912239">.</span><span class="ident" id="5912240">scanEscape</span><span class="op" id="5912250">(</span><span class="ident" id="5912251">quote</span><span class="op" id="5912256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912260">}</span>&nbsp;<span class="keyword" id="5912262">else</span>&nbsp;<span class="op" id="5912267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912272">ch</span>&nbsp;<span class="op" id="5912275">=</span>&nbsp;<span class="ident" id="5912277">s</span><span class="op" id="5912278">.</span><span class="ident" id="5912279">next</span><span class="op" id="5912283">(</span><span class="op" id="5912284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912288">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912292">n</span><span class="op" id="5912293">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912300">return</span><br>
<span class="lineno"></span><span class="op" id="5912307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="5912310">func</span>&nbsp;<span class="op" id="5912315">(</span><span class="ident" id="5912316">s</span>&nbsp;<span class="op" id="5912318">*</span><span class="ident" id="5912319">Scanner</span><span class="op" id="5912326">)</span>&nbsp;<span class="ident" id="5912328">scanRawString</span><span class="op" id="5912341">(</span><span class="op" id="5912342">)</span>&nbsp;<span class="op" id="5912344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912347">ch</span>&nbsp;<span class="op" id="5912350">:=</span>&nbsp;<span class="ident" id="5912353">s</span><span class="op" id="5912354">.</span><span class="ident" id="5912355">next</span><span class="op" id="5912359">(</span><span class="op" id="5912360">)</span>&nbsp;<span class="comment" id="5912362">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912391">for</span>&nbsp;<span class="ident" id="5912395">ch</span>&nbsp;<span class="op" id="5912398">!=</span>&nbsp;<span class="string" id="5912401">&#39;`&#39;</span>&nbsp;<span class="op" id="5912405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912409">if</span>&nbsp;<span class="ident" id="5912412">ch</span>&nbsp;<span class="op" id="5912415">&lt;</span>&nbsp;<span class="num" id="5912417">0</span>&nbsp;<span class="op" id="5912419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912424">s</span><span class="op" id="5912425">.</span><span class="builtintype" id="5912426">error</span><span class="op" id="5912431">(</span><span class="string" id="5912432">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5912456">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912461">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912474">ch</span>&nbsp;<span class="op" id="5912477">=</span>&nbsp;<span class="ident" id="5912479">s</span><span class="op" id="5912480">.</span><span class="ident" id="5912481">next</span><span class="op" id="5912485">(</span><span class="op" id="5912486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912489">}</span><br>
<span class="lineno"></span><span class="op" id="5912491">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="5912494">func</span>&nbsp;<span class="op" id="5912499">(</span><span class="ident" id="5912500">s</span>&nbsp;<span class="op" id="5912502">*</span><span class="ident" id="5912503">Scanner</span><span class="op" id="5912510">)</span>&nbsp;<span class="ident" id="5912512">scanChar</span><span class="op" id="5912520">(</span><span class="op" id="5912521">)</span>&nbsp;<span class="op" id="5912523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912526">if</span>&nbsp;<span class="ident" id="5912529">s</span><span class="op" id="5912530">.</span><span class="ident" id="5912531">scanString</span><span class="op" id="5912541">(</span><span class="string" id="5912542">&#39;\&#39;&#39;</span><span class="op" id="5912546">)</span>&nbsp;<span class="op" id="5912548">!=</span>&nbsp;<span class="num" id="5912551">1</span>&nbsp;<span class="op" id="5912553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912557">s</span><span class="op" id="5912558">.</span><span class="builtintype" id="5912559">error</span><span class="op" id="5912564">(</span><span class="string" id="5912565">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="5912587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912590">}</span><br>
<span class="lineno">515</span><span class="op" id="5912592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5912595">func</span>&nbsp;<span class="op" id="5912600">(</span><span class="ident" id="5912601">s</span>&nbsp;<span class="op" id="5912603">*</span><span class="ident" id="5912604">Scanner</span><span class="op" id="5912611">)</span>&nbsp;<span class="ident" id="5912613">scanComment</span><span class="op" id="5912624">(</span><span class="ident" id="5912625">ch</span>&nbsp;<span class="builtintype" id="5912628">rune</span><span class="op" id="5912632">)</span>&nbsp;<span class="builtintype" id="5912634">rune</span>&nbsp;<span class="op" id="5912639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5912642">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912669">if</span>&nbsp;<span class="ident" id="5912672">ch</span>&nbsp;<span class="op" id="5912675">==</span>&nbsp;<span class="string" id="5912678">&#39;/&#39;</span>&nbsp;<span class="op" id="5912682">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5912686">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912704">ch</span>&nbsp;<span class="op" id="5912707">=</span>&nbsp;<span class="ident" id="5912709">s</span><span class="op" id="5912710">.</span><span class="ident" id="5912711">next</span><span class="op" id="5912715">(</span><span class="op" id="5912716">)</span>&nbsp;<span class="comment" id="5912718">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912749">for</span>&nbsp;<span class="ident" id="5912753">ch</span>&nbsp;<span class="op" id="5912756">!=</span>&nbsp;<span class="string" id="5912759">&#39;\n&#39;</span>&nbsp;<span class="op" id="5912764">&amp;&amp;</span>&nbsp;<span class="ident" id="5912767">ch</span>&nbsp;<span class="op" id="5912770">&gt;=</span>&nbsp;<span class="num" id="5912773">0</span>&nbsp;<span class="op" id="5912775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912780">ch</span>&nbsp;<span class="op" id="5912783">=</span>&nbsp;<span class="ident" id="5912785">s</span><span class="op" id="5912786">.</span><span class="ident" id="5912787">next</span><span class="op" id="5912791">(</span><span class="op" id="5912792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912796">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912800">return</span>&nbsp;<span class="ident" id="5912807">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5912815">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912835">ch</span>&nbsp;<span class="op" id="5912838">=</span>&nbsp;<span class="ident" id="5912840">s</span><span class="op" id="5912841">.</span><span class="ident" id="5912842">next</span><span class="op" id="5912846">(</span><span class="op" id="5912847">)</span>&nbsp;<span class="comment" id="5912849">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912879">for</span>&nbsp;<span class="op" id="5912883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912887">if</span>&nbsp;<span class="ident" id="5912890">ch</span>&nbsp;<span class="op" id="5912893">&lt;</span>&nbsp;<span class="num" id="5912895">0</span>&nbsp;<span class="op" id="5912897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912902">s</span><span class="op" id="5912903">.</span><span class="builtintype" id="5912904">error</span><span class="op" id="5912909">(</span><span class="string" id="5912910">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="5912934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912939">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5912947">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912951">ch0</span>&nbsp;<span class="op" id="5912955">:=</span>&nbsp;<span class="ident" id="5912958">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5912963">ch</span>&nbsp;<span class="op" id="5912966">=</span>&nbsp;<span class="ident" id="5912968">s</span><span class="op" id="5912969">.</span><span class="ident" id="5912970">next</span><span class="op" id="5912974">(</span><span class="op" id="5912975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5912979">if</span>&nbsp;<span class="ident" id="5912982">ch0</span>&nbsp;<span class="op" id="5912986">==</span>&nbsp;<span class="string" id="5912989">&#39;*&#39;</span>&nbsp;<span class="op" id="5912993">&amp;&amp;</span>&nbsp;<span class="ident" id="5912996">ch</span>&nbsp;<span class="op" id="5912999">==</span>&nbsp;<span class="string" id="5913002">&#39;/&#39;</span>&nbsp;<span class="op" id="5913006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913011">ch</span>&nbsp;<span class="op" id="5913014">=</span>&nbsp;<span class="ident" id="5913016">s</span><span class="op" id="5913017">.</span><span class="ident" id="5913018">next</span><span class="op" id="5913022">(</span><span class="op" id="5913023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5913028">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5913036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5913039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5913042">return</span>&nbsp;<span class="ident" id="5913049">ch</span><br>
<span class="lineno"></span><span class="op" id="5913052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="5913055">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="5913133">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5913214">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5913294">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="5913372">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="5913397">func</span>&nbsp;<span class="op" id="5913402">(</span><span class="ident" id="5913403">s</span>&nbsp;<span class="op" id="5913405">*</span><span class="ident" id="5913406">Scanner</span><span class="op" id="5913413">)</span>&nbsp;<span class="ident" id="5913415">Scan</span><span class="op" id="5913419">(</span><span class="op" id="5913420">)</span>&nbsp;<span class="builtintype" id="5913422">rune</span>&nbsp;<span class="op" id="5913427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913430">ch</span>&nbsp;<span class="op" id="5913433">:=</span>&nbsp;<span class="ident" id="5913436">s</span><span class="op" id="5913437">.</span><span class="ident" id="5913438">Peek</span><span class="op" id="5913442">(</span><span class="op" id="5913443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913447">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913477">s</span><span class="op" id="5913478">.</span><span class="ident" id="5913479">tokPos</span>&nbsp;<span class="op" id="5913486">=</span>&nbsp;<span class="op" id="5913488">-</span><span class="num" id="5913489">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913492">s</span><span class="op" id="5913493">.</span><span class="ident" id="5913494">Line</span>&nbsp;<span class="op" id="5913499">=</span>&nbsp;<span class="num" id="5913501">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="5913504">redo</span><span class="op" id="5913508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913511">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5913532">for</span>&nbsp;<span class="ident" id="5913536">s</span><span class="op" id="5913537">.</span><span class="ident" id="5913538">Whitespace</span><span class="op" id="5913548">&amp;</span><span class="op" id="5913549">(</span><span class="num" id="5913550">1</span><span class="op" id="5913551">&lt;&lt;</span><span class="builtintype" id="5913553">uint</span><span class="op" id="5913557">(</span><span class="ident" id="5913558">ch</span><span class="op" id="5913560">)</span><span class="op" id="5913561">)</span>&nbsp;<span class="op" id="5913563">!=</span>&nbsp;<span class="num" id="5913566">0</span>&nbsp;<span class="op" id="5913568">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913572">ch</span>&nbsp;<span class="op" id="5913575">=</span>&nbsp;<span class="ident" id="5913577">s</span><span class="op" id="5913578">.</span><span class="ident" id="5913579">next</span><span class="op" id="5913583">(</span><span class="op" id="5913584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5913587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913591">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913623">s</span><span class="op" id="5913624">.</span><span class="ident" id="5913625">tokBuf</span><span class="op" id="5913631">.</span><span class="ident" id="5913632">Reset</span><span class="op" id="5913637">(</span><span class="op" id="5913638">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913641">s</span><span class="op" id="5913642">.</span><span class="ident" id="5913643">tokPos</span>&nbsp;<span class="op" id="5913650">=</span>&nbsp;<span class="ident" id="5913652">s</span><span class="op" id="5913653">.</span><span class="ident" id="5913654">srcPos</span>&nbsp;<span class="op" id="5913661">-</span>&nbsp;<span class="ident" id="5913663">s</span><span class="op" id="5913664">.</span><span class="ident" id="5913665">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913679">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913702">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913766">s</span><span class="op" id="5913767">.</span><span class="ident" id="5913768">Offset</span>&nbsp;<span class="op" id="5913775">=</span>&nbsp;<span class="ident" id="5913777">s</span><span class="op" id="5913778">.</span><span class="ident" id="5913779">srcBufOffset</span>&nbsp;<span class="op" id="5913792">+</span>&nbsp;<span class="ident" id="5913794">s</span><span class="op" id="5913795">.</span><span class="ident" id="5913796">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5913804">if</span>&nbsp;<span class="ident" id="5913807">s</span><span class="op" id="5913808">.</span><span class="ident" id="5913809">column</span>&nbsp;<span class="op" id="5913816">&gt;</span>&nbsp;<span class="num" id="5913818">0</span>&nbsp;<span class="op" id="5913820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913824">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913872">s</span><span class="op" id="5913873">.</span><span class="ident" id="5913874">Line</span>&nbsp;<span class="op" id="5913879">=</span>&nbsp;<span class="ident" id="5913881">s</span><span class="op" id="5913882">.</span><span class="ident" id="5913883">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5913890">s</span><span class="op" id="5913891">.</span><span class="ident" id="5913892">Column</span>&nbsp;<span class="op" id="5913899">=</span>&nbsp;<span class="ident" id="5913901">s</span><span class="op" id="5913902">.</span><span class="ident" id="5913903">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5913911">}</span>&nbsp;<span class="keyword" id="5913913">else</span>&nbsp;<span class="op" id="5913918">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913922">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5913953">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5914003">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914051">s</span><span class="op" id="5914052">.</span><span class="ident" id="5914053">Line</span>&nbsp;<span class="op" id="5914058">=</span>&nbsp;<span class="ident" id="5914060">s</span><span class="op" id="5914061">.</span><span class="ident" id="5914062">line</span>&nbsp;<span class="op" id="5914067">-</span>&nbsp;<span class="num" id="5914069">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914073">s</span><span class="op" id="5914074">.</span><span class="ident" id="5914075">Column</span>&nbsp;<span class="op" id="5914082">=</span>&nbsp;<span class="ident" id="5914084">s</span><span class="op" id="5914085">.</span><span class="ident" id="5914086">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5914103">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914129">tok</span>&nbsp;<span class="op" id="5914133">:=</span>&nbsp;<span class="ident" id="5914136">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914140">switch</span>&nbsp;<span class="op" id="5914147">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914150">case</span>&nbsp;<span class="ident" id="5914155">s</span><span class="op" id="5914156">.</span><span class="ident" id="5914157">isIdentRune</span><span class="op" id="5914168">(</span><span class="ident" id="5914169">ch</span><span class="op" id="5914171">,</span>&nbsp;<span class="num" id="5914173">0</span><span class="op" id="5914174">)</span><span class="op" id="5914175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914179">if</span>&nbsp;<span class="ident" id="5914182">s</span><span class="op" id="5914183">.</span><span class="ident" id="5914184">Mode</span><span class="op" id="5914188">&amp;</span><span class="ident" id="5914189">ScanIdents</span>&nbsp;<span class="op" id="5914200">!=</span>&nbsp;<span class="num" id="5914203">0</span>&nbsp;<span class="op" id="5914205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914210">tok</span>&nbsp;<span class="op" id="5914214">=</span>&nbsp;<span class="ident" id="5914216">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914225">ch</span>&nbsp;<span class="op" id="5914228">=</span>&nbsp;<span class="ident" id="5914230">s</span><span class="op" id="5914231">.</span><span class="ident" id="5914232">scanIdentifier</span><span class="op" id="5914246">(</span><span class="op" id="5914247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914251">}</span>&nbsp;<span class="keyword" id="5914253">else</span>&nbsp;<span class="op" id="5914258">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914263">ch</span>&nbsp;<span class="op" id="5914266">=</span>&nbsp;<span class="ident" id="5914268">s</span><span class="op" id="5914269">.</span><span class="ident" id="5914270">next</span><span class="op" id="5914274">(</span><span class="op" id="5914275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914282">case</span>&nbsp;<span class="ident" id="5914287">isDecimal</span><span class="op" id="5914296">(</span><span class="ident" id="5914297">ch</span><span class="op" id="5914299">)</span><span class="op" id="5914300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914304">if</span>&nbsp;<span class="ident" id="5914307">s</span><span class="op" id="5914308">.</span><span class="ident" id="5914309">Mode</span><span class="op" id="5914313">&amp;</span><span class="op" id="5914314">(</span><span class="ident" id="5914315">ScanInts</span><span class="op" id="5914323">|</span><span class="ident" id="5914324">ScanFloats</span><span class="op" id="5914334">)</span>&nbsp;<span class="op" id="5914336">!=</span>&nbsp;<span class="num" id="5914339">0</span>&nbsp;<span class="op" id="5914341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914346">tok</span><span class="op" id="5914349">,</span>&nbsp;<span class="ident" id="5914351">ch</span>&nbsp;<span class="op" id="5914354">=</span>&nbsp;<span class="ident" id="5914356">s</span><span class="op" id="5914357">.</span><span class="ident" id="5914358">scanNumber</span><span class="op" id="5914368">(</span><span class="ident" id="5914369">ch</span><span class="op" id="5914371">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914375">}</span>&nbsp;<span class="keyword" id="5914377">else</span>&nbsp;<span class="op" id="5914382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914387">ch</span>&nbsp;<span class="op" id="5914390">=</span>&nbsp;<span class="ident" id="5914392">s</span><span class="op" id="5914393">.</span><span class="ident" id="5914394">next</span><span class="op" id="5914398">(</span><span class="op" id="5914399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914406">default</span><span class="op" id="5914413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914417">switch</span>&nbsp;<span class="ident" id="5914424">ch</span>&nbsp;<span class="op" id="5914427">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914431">case</span>&nbsp;<span class="string" id="5914436">&#39;&#34;&#39;</span><span class="op" id="5914439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914444">if</span>&nbsp;<span class="ident" id="5914447">s</span><span class="op" id="5914448">.</span><span class="ident" id="5914449">Mode</span><span class="op" id="5914453">&amp;</span><span class="ident" id="5914454">ScanStrings</span>&nbsp;<span class="op" id="5914466">!=</span>&nbsp;<span class="num" id="5914469">0</span>&nbsp;<span class="op" id="5914471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914477">s</span><span class="op" id="5914478">.</span><span class="ident" id="5914479">scanString</span><span class="op" id="5914489">(</span><span class="string" id="5914490">&#39;&#34;&#39;</span><span class="op" id="5914493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914499">tok</span>&nbsp;<span class="op" id="5914503">=</span>&nbsp;<span class="ident" id="5914505">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914515">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914520">ch</span>&nbsp;<span class="op" id="5914523">=</span>&nbsp;<span class="ident" id="5914525">s</span><span class="op" id="5914526">.</span><span class="ident" id="5914527">next</span><span class="op" id="5914531">(</span><span class="op" id="5914532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914536">case</span>&nbsp;<span class="string" id="5914541">&#39;\&#39;&#39;</span><span class="op" id="5914545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914550">if</span>&nbsp;<span class="ident" id="5914553">s</span><span class="op" id="5914554">.</span><span class="ident" id="5914555">Mode</span><span class="op" id="5914559">&amp;</span><span class="ident" id="5914560">ScanChars</span>&nbsp;<span class="op" id="5914570">!=</span>&nbsp;<span class="num" id="5914573">0</span>&nbsp;<span class="op" id="5914575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914581">s</span><span class="op" id="5914582">.</span><span class="ident" id="5914583">scanChar</span><span class="op" id="5914591">(</span><span class="op" id="5914592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914598">tok</span>&nbsp;<span class="op" id="5914602">=</span>&nbsp;<span class="ident" id="5914604">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914617">ch</span>&nbsp;<span class="op" id="5914620">=</span>&nbsp;<span class="ident" id="5914622">s</span><span class="op" id="5914623">.</span><span class="ident" id="5914624">next</span><span class="op" id="5914628">(</span><span class="op" id="5914629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914633">case</span>&nbsp;<span class="string" id="5914638">&#39;.&#39;</span><span class="op" id="5914641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914646">ch</span>&nbsp;<span class="op" id="5914649">=</span>&nbsp;<span class="ident" id="5914651">s</span><span class="op" id="5914652">.</span><span class="ident" id="5914653">next</span><span class="op" id="5914657">(</span><span class="op" id="5914658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914663">if</span>&nbsp;<span class="ident" id="5914666">isDecimal</span><span class="op" id="5914675">(</span><span class="ident" id="5914676">ch</span><span class="op" id="5914678">)</span>&nbsp;<span class="op" id="5914680">&amp;&amp;</span>&nbsp;<span class="ident" id="5914683">s</span><span class="op" id="5914684">.</span><span class="ident" id="5914685">Mode</span><span class="op" id="5914689">&amp;</span><span class="ident" id="5914690">ScanFloats</span>&nbsp;<span class="op" id="5914701">!=</span>&nbsp;<span class="num" id="5914704">0</span>&nbsp;<span class="op" id="5914706">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914712">tok</span>&nbsp;<span class="op" id="5914716">=</span>&nbsp;<span class="ident" id="5914718">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914728">ch</span>&nbsp;<span class="op" id="5914731">=</span>&nbsp;<span class="ident" id="5914733">s</span><span class="op" id="5914734">.</span><span class="ident" id="5914735">scanMantissa</span><span class="op" id="5914747">(</span><span class="ident" id="5914748">ch</span><span class="op" id="5914750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914756">ch</span>&nbsp;<span class="op" id="5914759">=</span>&nbsp;<span class="ident" id="5914761">s</span><span class="op" id="5914762">.</span><span class="ident" id="5914763">scanExponent</span><span class="op" id="5914775">(</span><span class="ident" id="5914776">ch</span><span class="op" id="5914778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5914783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914787">case</span>&nbsp;<span class="string" id="5914792">&#39;/&#39;</span><span class="op" id="5914795">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914800">ch</span>&nbsp;<span class="op" id="5914803">=</span>&nbsp;<span class="ident" id="5914805">s</span><span class="op" id="5914806">.</span><span class="ident" id="5914807">next</span><span class="op" id="5914811">(</span><span class="op" id="5914812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914817">if</span>&nbsp;<span class="op" id="5914820">(</span><span class="ident" id="5914821">ch</span>&nbsp;<span class="op" id="5914824">==</span>&nbsp;<span class="string" id="5914827">&#39;/&#39;</span>&nbsp;<span class="op" id="5914831">||</span>&nbsp;<span class="ident" id="5914834">ch</span>&nbsp;<span class="op" id="5914837">==</span>&nbsp;<span class="string" id="5914840">&#39;*&#39;</span><span class="op" id="5914843">)</span>&nbsp;<span class="op" id="5914845">&amp;&amp;</span>&nbsp;<span class="ident" id="5914848">s</span><span class="op" id="5914849">.</span><span class="ident" id="5914850">Mode</span><span class="op" id="5914854">&amp;</span><span class="ident" id="5914855">ScanComments</span>&nbsp;<span class="op" id="5914868">!=</span>&nbsp;<span class="num" id="5914871">0</span>&nbsp;<span class="op" id="5914873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914879">if</span>&nbsp;<span class="ident" id="5914882">s</span><span class="op" id="5914883">.</span><span class="ident" id="5914884">Mode</span><span class="op" id="5914888">&amp;</span><span class="ident" id="5914889">SkipComments</span>&nbsp;<span class="op" id="5914902">!=</span>&nbsp;<span class="num" id="5914905">0</span>&nbsp;<span class="op" id="5914907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914914">s</span><span class="op" id="5914915">.</span><span class="ident" id="5914916">tokPos</span>&nbsp;<span class="op" id="5914923">=</span>&nbsp;<span class="op" id="5914925">-</span><span class="num" id="5914926">1</span>&nbsp;<span class="comment" id="5914928">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5914961">ch</span>&nbsp;<span class="op" id="5914964">=</span>&nbsp;<span class="ident" id="5914966">s</span><span class="op" id="5914967">.</span><span class="ident" id="5914968">scanComment</span><span class="op" id="5914979">(</span><span class="ident" id="5914980">ch</span><span class="op" id="5914982">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5914989">goto</span>&nbsp;<span class="ident" id="5914994">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5915003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915009">ch</span>&nbsp;<span class="op" id="5915012">=</span>&nbsp;<span class="ident" id="5915014">s</span><span class="op" id="5915015">.</span><span class="ident" id="5915016">scanComment</span><span class="op" id="5915027">(</span><span class="ident" id="5915028">ch</span><span class="op" id="5915030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915036">tok</span>&nbsp;<span class="op" id="5915040">=</span>&nbsp;<span class="ident" id="5915042">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5915053">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915057">case</span>&nbsp;<span class="string" id="5915062">&#39;`&#39;</span><span class="op" id="5915065">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915070">if</span>&nbsp;<span class="ident" id="5915073">s</span><span class="op" id="5915074">.</span><span class="ident" id="5915075">Mode</span><span class="op" id="5915079">&amp;</span><span class="ident" id="5915080">ScanRawStrings</span>&nbsp;<span class="op" id="5915095">!=</span>&nbsp;<span class="num" id="5915098">0</span>&nbsp;<span class="op" id="5915100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915106">s</span><span class="op" id="5915107">.</span><span class="ident" id="5915108">scanRawString</span><span class="op" id="5915121">(</span><span class="op" id="5915122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915128">tok</span>&nbsp;<span class="op" id="5915132">=</span>&nbsp;<span class="ident" id="5915134">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5915144">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915149">ch</span>&nbsp;<span class="op" id="5915152">=</span>&nbsp;<span class="ident" id="5915154">s</span><span class="op" id="5915155">.</span><span class="ident" id="5915156">next</span><span class="op" id="5915160">(</span><span class="op" id="5915161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915165">default</span><span class="op" id="5915172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915177">ch</span>&nbsp;<span class="op" id="5915180">=</span>&nbsp;<span class="ident" id="5915182">s</span><span class="op" id="5915183">.</span><span class="ident" id="5915184">next</span><span class="op" id="5915188">(</span><span class="op" id="5915189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5915193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5915196">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5915200">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915222">s</span><span class="op" id="5915223">.</span><span class="ident" id="5915224">tokEnd</span>&nbsp;<span class="op" id="5915231">=</span>&nbsp;<span class="ident" id="5915233">s</span><span class="op" id="5915234">.</span><span class="ident" id="5915235">srcPos</span>&nbsp;<span class="op" id="5915242">-</span>&nbsp;<span class="ident" id="5915244">s</span><span class="op" id="5915245">.</span><span class="ident" id="5915246">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915260">s</span><span class="op" id="5915261">.</span><span class="ident" id="5915262">ch</span>&nbsp;<span class="op" id="5915265">=</span>&nbsp;<span class="ident" id="5915267">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915271">return</span>&nbsp;<span class="ident" id="5915278">tok</span><br>
<span class="lineno"></span><span class="op" id="5915282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5915285">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="5915348">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="5915417">func</span>&nbsp;<span class="op" id="5915422">(</span><span class="ident" id="5915423">s</span>&nbsp;<span class="op" id="5915425">*</span><span class="ident" id="5915426">Scanner</span><span class="op" id="5915433">)</span>&nbsp;<span class="ident" id="5915435">Pos</span><span class="op" id="5915438">(</span><span class="op" id="5915439">)</span>&nbsp;<span class="op" id="5915441">(</span><span class="ident" id="5915442">pos</span>&nbsp;<span class="ident" id="5915446">Position</span><span class="op" id="5915454">)</span>&nbsp;<span class="op" id="5915456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915459">pos</span><span class="op" id="5915462">.</span><span class="ident" id="5915463">Filename</span>&nbsp;<span class="op" id="5915472">=</span>&nbsp;<span class="ident" id="5915474">s</span><span class="op" id="5915475">.</span><span class="ident" id="5915476">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915486">pos</span><span class="op" id="5915489">.</span><span class="ident" id="5915490">Offset</span>&nbsp;<span class="op" id="5915497">=</span>&nbsp;<span class="ident" id="5915499">s</span><span class="op" id="5915500">.</span><span class="ident" id="5915501">srcBufOffset</span>&nbsp;<span class="op" id="5915514">+</span>&nbsp;<span class="ident" id="5915516">s</span><span class="op" id="5915517">.</span><span class="ident" id="5915518">srcPos</span>&nbsp;<span class="op" id="5915525">-</span>&nbsp;<span class="ident" id="5915527">s</span><span class="op" id="5915528">.</span><span class="ident" id="5915529">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915542">switch</span>&nbsp;<span class="op" id="5915549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915552">case</span>&nbsp;<span class="ident" id="5915557">s</span><span class="op" id="5915558">.</span><span class="ident" id="5915559">column</span>&nbsp;<span class="op" id="5915566">&gt;</span>&nbsp;<span class="num" id="5915568">0</span><span class="op" id="5915569">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5915573">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915621">pos</span><span class="op" id="5915624">.</span><span class="ident" id="5915625">Line</span>&nbsp;<span class="op" id="5915630">=</span>&nbsp;<span class="ident" id="5915632">s</span><span class="op" id="5915633">.</span><span class="ident" id="5915634">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915641">pos</span><span class="op" id="5915644">.</span><span class="ident" id="5915645">Column</span>&nbsp;<span class="op" id="5915652">=</span>&nbsp;<span class="ident" id="5915654">s</span><span class="op" id="5915655">.</span><span class="ident" id="5915656">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915664">case</span>&nbsp;<span class="ident" id="5915669">s</span><span class="op" id="5915670">.</span><span class="ident" id="5915671">lastLineLen</span>&nbsp;<span class="op" id="5915683">&gt;</span>&nbsp;<span class="num" id="5915685">0</span><span class="op" id="5915686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5915690">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915721">pos</span><span class="op" id="5915724">.</span><span class="ident" id="5915725">Line</span>&nbsp;<span class="op" id="5915730">=</span>&nbsp;<span class="ident" id="5915732">s</span><span class="op" id="5915733">.</span><span class="ident" id="5915734">line</span>&nbsp;<span class="op" id="5915739">-</span>&nbsp;<span class="num" id="5915741">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915745">pos</span><span class="op" id="5915748">.</span><span class="ident" id="5915749">Column</span>&nbsp;<span class="op" id="5915756">=</span>&nbsp;<span class="ident" id="5915758">s</span><span class="op" id="5915759">.</span><span class="ident" id="5915760">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915773">default</span><span class="op" id="5915780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5915784">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915820">pos</span><span class="op" id="5915823">.</span><span class="ident" id="5915824">Line</span>&nbsp;<span class="op" id="5915829">=</span>&nbsp;<span class="num" id="5915831">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5915835">pos</span><span class="op" id="5915838">.</span><span class="ident" id="5915839">Column</span>&nbsp;<span class="op" id="5915846">=</span>&nbsp;<span class="num" id="5915848">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5915851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5915854">return</span><br>
<span class="lineno"></span><span class="op" id="5915861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="5915864">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="5915946">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="5915977">func</span>&nbsp;<span class="op" id="5915982">(</span><span class="ident" id="5915983">s</span>&nbsp;<span class="op" id="5915985">*</span><span class="ident" id="5915986">Scanner</span><span class="op" id="5915993">)</span>&nbsp;<span class="ident" id="5915995">TokenText</span><span class="op" id="5916004">(</span><span class="op" id="5916005">)</span>&nbsp;<span class="builtintype" id="5916007">string</span>&nbsp;<span class="op" id="5916014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5916017">if</span>&nbsp;<span class="ident" id="5916020">s</span><span class="op" id="5916021">.</span><span class="ident" id="5916022">tokPos</span>&nbsp;<span class="op" id="5916029">&lt;</span>&nbsp;<span class="num" id="5916031">0</span>&nbsp;<span class="op" id="5916033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5916037">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5916056">return</span>&nbsp;<span class="string" id="5916063">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5916067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5916071">if</span>&nbsp;<span class="ident" id="5916074">s</span><span class="op" id="5916075">.</span><span class="ident" id="5916076">tokEnd</span>&nbsp;<span class="op" id="5916083">&lt;</span>&nbsp;<span class="num" id="5916085">0</span>&nbsp;<span class="op" id="5916087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5916091">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5916154">s</span><span class="op" id="5916155">.</span><span class="ident" id="5916156">tokEnd</span>&nbsp;<span class="op" id="5916163">=</span>&nbsp;<span class="ident" id="5916165">s</span><span class="op" id="5916166">.</span><span class="ident" id="5916167">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5916175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5916179">if</span>&nbsp;<span class="ident" id="5916182">s</span><span class="op" id="5916183">.</span><span class="ident" id="5916184">tokBuf</span><span class="op" id="5916190">.</span><span class="ident" id="5916191">Len</span><span class="op" id="5916194">(</span><span class="op" id="5916195">)</span>&nbsp;<span class="op" id="5916197">==</span>&nbsp;<span class="num" id="5916200">0</span>&nbsp;<span class="op" id="5916202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5916206">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5916265">return</span>&nbsp;<span class="builtintype" id="5916272">string</span><span class="op" id="5916278">(</span><span class="ident" id="5916279">s</span><span class="op" id="5916280">.</span><span class="ident" id="5916281">srcBuf</span><span class="op" id="5916287">[</span><span class="ident" id="5916288">s</span><span class="op" id="5916289">.</span><span class="ident" id="5916290">tokPos</span><span class="op" id="5916296">:</span><span class="ident" id="5916297">s</span><span class="op" id="5916298">.</span><span class="ident" id="5916299">tokEnd</span><span class="op" id="5916305">]</span><span class="op" id="5916306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5916309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5916313">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5916378">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5916420">s</span><span class="op" id="5916421">.</span><span class="ident" id="5916422">tokBuf</span><span class="op" id="5916428">.</span><span class="ident" id="5916429">Write</span><span class="op" id="5916434">(</span><span class="ident" id="5916435">s</span><span class="op" id="5916436">.</span><span class="ident" id="5916437">srcBuf</span><span class="op" id="5916443">[</span><span class="ident" id="5916444">s</span><span class="op" id="5916445">.</span><span class="ident" id="5916446">tokPos</span><span class="op" id="5916452">:</span><span class="ident" id="5916453">s</span><span class="op" id="5916454">.</span><span class="ident" id="5916455">tokEnd</span><span class="op" id="5916461">]</span><span class="op" id="5916462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5916465">s</span><span class="op" id="5916466">.</span><span class="ident" id="5916467">tokPos</span>&nbsp;<span class="op" id="5916474">=</span>&nbsp;<span class="ident" id="5916476">s</span><span class="op" id="5916477">.</span><span class="ident" id="5916478">tokEnd</span>&nbsp;<span class="comment" id="5916485">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5916528">return</span>&nbsp;<span class="ident" id="5916535">s</span><span class="op" id="5916536">.</span><span class="ident" id="5916537">tokBuf</span><span class="op" id="5916543">.</span><span class="ident" id="5916544">String</span><span class="op" id="5916550">(</span><span class="op" id="5916551">)</span><br>
<span class="lineno"></span><span class="op" id="5916553">}</span>
</div>
</body>
</html>
