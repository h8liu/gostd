<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2248159">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2248214">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2248268">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2248319">package</span>&nbsp;<span class="ident" id="2248327">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248336">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="2248407">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2248470">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="2248542">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="2248566">type</span>&nbsp;<span class="ident" id="2248571">extFloat</span>&nbsp;<span class="keyword" id="2248580">struct</span>&nbsp;<span class="op" id="2248587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248590">mant</span>&nbsp;<span class="ident" id="2248595">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248603">exp</span>&nbsp;&nbsp;<span class="builtintype" id="2248608">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248613">neg</span>&nbsp;&nbsp;<span class="builtintype" id="2248618">bool</span><br>
<span class="lineno">15</span><span class="op" id="2248623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2248626">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="2248681">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="2248728">const</span>&nbsp;<span class="op" id="2248734">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248737">firstPowerOfTen</span>&nbsp;<span class="op" id="2248753">=</span>&nbsp;<span class="op" id="2248755">-</span><span class="num" id="2248756">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2248761">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="2248777">=</span>&nbsp;<span class="num" id="2248779">8</span><br>
<span class="lineno"></span><span class="op" id="2248781">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2248784">var</span>&nbsp;<span class="ident" id="2248788">smallPowersOfTen</span>&nbsp;<span class="op" id="2248805">=</span>&nbsp;<span class="op" id="2248807">[</span><span class="op" id="2248808">...</span><span class="op" id="2248811">]</span><span class="ident" id="2248812">extFloat</span><span class="op" id="2248820">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248823">{</span><span class="num" id="2248824">1</span>&nbsp;<span class="op" id="2248826">&lt;&lt;</span>&nbsp;<span class="num" id="2248829">63</span><span class="op" id="2248831">,</span>&nbsp;<span class="op" id="2248833">-</span><span class="num" id="2248834">63</span><span class="op" id="2248836">,</span>&nbsp;<span class="builtintype" id="2248838">false</span><span class="op" id="2248843">}</span><span class="op" id="2248844">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248853">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248859">{</span><span class="num" id="2248860">0xa</span>&nbsp;<span class="op" id="2248864">&lt;&lt;</span>&nbsp;<span class="num" id="2248867">60</span><span class="op" id="2248869">,</span>&nbsp;<span class="op" id="2248871">-</span><span class="num" id="2248872">60</span><span class="op" id="2248874">,</span>&nbsp;<span class="builtintype" id="2248876">false</span><span class="op" id="2248881">}</span><span class="op" id="2248882">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248889">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248897">{</span><span class="num" id="2248898">0x64</span>&nbsp;<span class="op" id="2248903">&lt;&lt;</span>&nbsp;<span class="num" id="2248906">57</span><span class="op" id="2248908">,</span>&nbsp;<span class="op" id="2248910">-</span><span class="num" id="2248911">57</span><span class="op" id="2248913">,</span>&nbsp;<span class="builtintype" id="2248915">false</span><span class="op" id="2248920">}</span><span class="op" id="2248921">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248927">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248935">{</span><span class="num" id="2248936">0x3e8</span>&nbsp;<span class="op" id="2248942">&lt;&lt;</span>&nbsp;<span class="num" id="2248945">54</span><span class="op" id="2248947">,</span>&nbsp;<span class="op" id="2248949">-</span><span class="num" id="2248950">54</span><span class="op" id="2248952">,</span>&nbsp;<span class="builtintype" id="2248954">false</span><span class="op" id="2248959">}</span><span class="op" id="2248960">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2248965">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2248973">{</span><span class="num" id="2248974">0x2710</span>&nbsp;<span class="op" id="2248981">&lt;&lt;</span>&nbsp;<span class="num" id="2248984">50</span><span class="op" id="2248986">,</span>&nbsp;<span class="op" id="2248988">-</span><span class="num" id="2248989">50</span><span class="op" id="2248991">,</span>&nbsp;<span class="builtintype" id="2248993">false</span><span class="op" id="2248998">}</span><span class="op" id="2248999">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2249003">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249011">{</span><span class="num" id="2249012">0x186a0</span>&nbsp;<span class="op" id="2249020">&lt;&lt;</span>&nbsp;<span class="num" id="2249023">47</span><span class="op" id="2249025">,</span>&nbsp;<span class="op" id="2249027">-</span><span class="num" id="2249028">47</span><span class="op" id="2249030">,</span>&nbsp;<span class="builtintype" id="2249032">false</span><span class="op" id="2249037">}</span><span class="op" id="2249038">,</span>&nbsp;&nbsp;<span class="comment" id="2249041">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249049">{</span><span class="num" id="2249050">0xf4240</span>&nbsp;<span class="op" id="2249058">&lt;&lt;</span>&nbsp;<span class="num" id="2249061">44</span><span class="op" id="2249063">,</span>&nbsp;<span class="op" id="2249065">-</span><span class="num" id="2249066">44</span><span class="op" id="2249068">,</span>&nbsp;<span class="builtintype" id="2249070">false</span><span class="op" id="2249075">}</span><span class="op" id="2249076">,</span>&nbsp;&nbsp;<span class="comment" id="2249079">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249087">{</span><span class="num" id="2249088">0x989680</span>&nbsp;<span class="op" id="2249097">&lt;&lt;</span>&nbsp;<span class="num" id="2249100">40</span><span class="op" id="2249102">,</span>&nbsp;<span class="op" id="2249104">-</span><span class="num" id="2249105">40</span><span class="op" id="2249107">,</span>&nbsp;<span class="builtintype" id="2249109">false</span><span class="op" id="2249114">}</span><span class="op" id="2249115">,</span>&nbsp;<span class="comment" id="2249117">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="2249124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2249127">var</span>&nbsp;<span class="ident" id="2249131">powersOfTen</span>&nbsp;<span class="op" id="2249143">=</span>&nbsp;<span class="op" id="2249145">[</span><span class="op" id="2249146">...</span><span class="op" id="2249149">]</span><span class="ident" id="2249150">extFloat</span><span class="op" id="2249158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249161">{</span><span class="num" id="2249162">0xfa8fd5a0081c0288</span><span class="op" id="2249180">,</span>&nbsp;<span class="op" id="2249182">-</span><span class="num" id="2249183">1220</span><span class="op" id="2249187">,</span>&nbsp;<span class="builtintype" id="2249189">false</span><span class="op" id="2249194">}</span><span class="op" id="2249195">,</span>&nbsp;<span class="comment" id="2249197">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249209">{</span><span class="num" id="2249210">0xbaaee17fa23ebf76</span><span class="op" id="2249228">,</span>&nbsp;<span class="op" id="2249230">-</span><span class="num" id="2249231">1193</span><span class="op" id="2249235">,</span>&nbsp;<span class="builtintype" id="2249237">false</span><span class="op" id="2249242">}</span><span class="op" id="2249243">,</span>&nbsp;<span class="comment" id="2249245">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249257">{</span><span class="num" id="2249258">0x8b16fb203055ac76</span><span class="op" id="2249276">,</span>&nbsp;<span class="op" id="2249278">-</span><span class="num" id="2249279">1166</span><span class="op" id="2249283">,</span>&nbsp;<span class="builtintype" id="2249285">false</span><span class="op" id="2249290">}</span><span class="op" id="2249291">,</span>&nbsp;<span class="comment" id="2249293">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249305">{</span><span class="num" id="2249306">0xcf42894a5dce35ea</span><span class="op" id="2249324">,</span>&nbsp;<span class="op" id="2249326">-</span><span class="num" id="2249327">1140</span><span class="op" id="2249331">,</span>&nbsp;<span class="builtintype" id="2249333">false</span><span class="op" id="2249338">}</span><span class="op" id="2249339">,</span>&nbsp;<span class="comment" id="2249341">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249353">{</span><span class="num" id="2249354">0x9a6bb0aa55653b2d</span><span class="op" id="2249372">,</span>&nbsp;<span class="op" id="2249374">-</span><span class="num" id="2249375">1113</span><span class="op" id="2249379">,</span>&nbsp;<span class="builtintype" id="2249381">false</span><span class="op" id="2249386">}</span><span class="op" id="2249387">,</span>&nbsp;<span class="comment" id="2249389">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249401">{</span><span class="num" id="2249402">0xe61acf033d1a45df</span><span class="op" id="2249420">,</span>&nbsp;<span class="op" id="2249422">-</span><span class="num" id="2249423">1087</span><span class="op" id="2249427">,</span>&nbsp;<span class="builtintype" id="2249429">false</span><span class="op" id="2249434">}</span><span class="op" id="2249435">,</span>&nbsp;<span class="comment" id="2249437">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249449">{</span><span class="num" id="2249450">0xab70fe17c79ac6ca</span><span class="op" id="2249468">,</span>&nbsp;<span class="op" id="2249470">-</span><span class="num" id="2249471">1060</span><span class="op" id="2249475">,</span>&nbsp;<span class="builtintype" id="2249477">false</span><span class="op" id="2249482">}</span><span class="op" id="2249483">,</span>&nbsp;<span class="comment" id="2249485">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249497">{</span><span class="num" id="2249498">0xff77b1fcbebcdc4f</span><span class="op" id="2249516">,</span>&nbsp;<span class="op" id="2249518">-</span><span class="num" id="2249519">1034</span><span class="op" id="2249523">,</span>&nbsp;<span class="builtintype" id="2249525">false</span><span class="op" id="2249530">}</span><span class="op" id="2249531">,</span>&nbsp;<span class="comment" id="2249533">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249545">{</span><span class="num" id="2249546">0xbe5691ef416bd60c</span><span class="op" id="2249564">,</span>&nbsp;<span class="op" id="2249566">-</span><span class="num" id="2249567">1007</span><span class="op" id="2249571">,</span>&nbsp;<span class="builtintype" id="2249573">false</span><span class="op" id="2249578">}</span><span class="op" id="2249579">,</span>&nbsp;<span class="comment" id="2249581">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249593">{</span><span class="num" id="2249594">0x8dd01fad907ffc3c</span><span class="op" id="2249612">,</span>&nbsp;<span class="op" id="2249614">-</span><span class="num" id="2249615">980</span><span class="op" id="2249618">,</span>&nbsp;<span class="builtintype" id="2249620">false</span><span class="op" id="2249625">}</span><span class="op" id="2249626">,</span>&nbsp;&nbsp;<span class="comment" id="2249629">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249641">{</span><span class="num" id="2249642">0xd3515c2831559a83</span><span class="op" id="2249660">,</span>&nbsp;<span class="op" id="2249662">-</span><span class="num" id="2249663">954</span><span class="op" id="2249666">,</span>&nbsp;<span class="builtintype" id="2249668">false</span><span class="op" id="2249673">}</span><span class="op" id="2249674">,</span>&nbsp;&nbsp;<span class="comment" id="2249677">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249689">{</span><span class="num" id="2249690">0x9d71ac8fada6c9b5</span><span class="op" id="2249708">,</span>&nbsp;<span class="op" id="2249710">-</span><span class="num" id="2249711">927</span><span class="op" id="2249714">,</span>&nbsp;<span class="builtintype" id="2249716">false</span><span class="op" id="2249721">}</span><span class="op" id="2249722">,</span>&nbsp;&nbsp;<span class="comment" id="2249725">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249737">{</span><span class="num" id="2249738">0xea9c227723ee8bcb</span><span class="op" id="2249756">,</span>&nbsp;<span class="op" id="2249758">-</span><span class="num" id="2249759">901</span><span class="op" id="2249762">,</span>&nbsp;<span class="builtintype" id="2249764">false</span><span class="op" id="2249769">}</span><span class="op" id="2249770">,</span>&nbsp;&nbsp;<span class="comment" id="2249773">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249785">{</span><span class="num" id="2249786">0xaecc49914078536d</span><span class="op" id="2249804">,</span>&nbsp;<span class="op" id="2249806">-</span><span class="num" id="2249807">874</span><span class="op" id="2249810">,</span>&nbsp;<span class="builtintype" id="2249812">false</span><span class="op" id="2249817">}</span><span class="op" id="2249818">,</span>&nbsp;&nbsp;<span class="comment" id="2249821">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249833">{</span><span class="num" id="2249834">0x823c12795db6ce57</span><span class="op" id="2249852">,</span>&nbsp;<span class="op" id="2249854">-</span><span class="num" id="2249855">847</span><span class="op" id="2249858">,</span>&nbsp;<span class="builtintype" id="2249860">false</span><span class="op" id="2249865">}</span><span class="op" id="2249866">,</span>&nbsp;&nbsp;<span class="comment" id="2249869">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249881">{</span><span class="num" id="2249882">0xc21094364dfb5637</span><span class="op" id="2249900">,</span>&nbsp;<span class="op" id="2249902">-</span><span class="num" id="2249903">821</span><span class="op" id="2249906">,</span>&nbsp;<span class="builtintype" id="2249908">false</span><span class="op" id="2249913">}</span><span class="op" id="2249914">,</span>&nbsp;&nbsp;<span class="comment" id="2249917">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249929">{</span><span class="num" id="2249930">0x9096ea6f3848984f</span><span class="op" id="2249948">,</span>&nbsp;<span class="op" id="2249950">-</span><span class="num" id="2249951">794</span><span class="op" id="2249954">,</span>&nbsp;<span class="builtintype" id="2249956">false</span><span class="op" id="2249961">}</span><span class="op" id="2249962">,</span>&nbsp;&nbsp;<span class="comment" id="2249965">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2249977">{</span><span class="num" id="2249978">0xd77485cb25823ac7</span><span class="op" id="2249996">,</span>&nbsp;<span class="op" id="2249998">-</span><span class="num" id="2249999">768</span><span class="op" id="2250002">,</span>&nbsp;<span class="builtintype" id="2250004">false</span><span class="op" id="2250009">}</span><span class="op" id="2250010">,</span>&nbsp;&nbsp;<span class="comment" id="2250013">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250025">{</span><span class="num" id="2250026">0xa086cfcd97bf97f4</span><span class="op" id="2250044">,</span>&nbsp;<span class="op" id="2250046">-</span><span class="num" id="2250047">741</span><span class="op" id="2250050">,</span>&nbsp;<span class="builtintype" id="2250052">false</span><span class="op" id="2250057">}</span><span class="op" id="2250058">,</span>&nbsp;&nbsp;<span class="comment" id="2250061">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250073">{</span><span class="num" id="2250074">0xef340a98172aace5</span><span class="op" id="2250092">,</span>&nbsp;<span class="op" id="2250094">-</span><span class="num" id="2250095">715</span><span class="op" id="2250098">,</span>&nbsp;<span class="builtintype" id="2250100">false</span><span class="op" id="2250105">}</span><span class="op" id="2250106">,</span>&nbsp;&nbsp;<span class="comment" id="2250109">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250121">{</span><span class="num" id="2250122">0xb23867fb2a35b28e</span><span class="op" id="2250140">,</span>&nbsp;<span class="op" id="2250142">-</span><span class="num" id="2250143">688</span><span class="op" id="2250146">,</span>&nbsp;<span class="builtintype" id="2250148">false</span><span class="op" id="2250153">}</span><span class="op" id="2250154">,</span>&nbsp;&nbsp;<span class="comment" id="2250157">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250169">{</span><span class="num" id="2250170">0x84c8d4dfd2c63f3b</span><span class="op" id="2250188">,</span>&nbsp;<span class="op" id="2250190">-</span><span class="num" id="2250191">661</span><span class="op" id="2250194">,</span>&nbsp;<span class="builtintype" id="2250196">false</span><span class="op" id="2250201">}</span><span class="op" id="2250202">,</span>&nbsp;&nbsp;<span class="comment" id="2250205">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250217">{</span><span class="num" id="2250218">0xc5dd44271ad3cdba</span><span class="op" id="2250236">,</span>&nbsp;<span class="op" id="2250238">-</span><span class="num" id="2250239">635</span><span class="op" id="2250242">,</span>&nbsp;<span class="builtintype" id="2250244">false</span><span class="op" id="2250249">}</span><span class="op" id="2250250">,</span>&nbsp;&nbsp;<span class="comment" id="2250253">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250265">{</span><span class="num" id="2250266">0x936b9fcebb25c996</span><span class="op" id="2250284">,</span>&nbsp;<span class="op" id="2250286">-</span><span class="num" id="2250287">608</span><span class="op" id="2250290">,</span>&nbsp;<span class="builtintype" id="2250292">false</span><span class="op" id="2250297">}</span><span class="op" id="2250298">,</span>&nbsp;&nbsp;<span class="comment" id="2250301">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250313">{</span><span class="num" id="2250314">0xdbac6c247d62a584</span><span class="op" id="2250332">,</span>&nbsp;<span class="op" id="2250334">-</span><span class="num" id="2250335">582</span><span class="op" id="2250338">,</span>&nbsp;<span class="builtintype" id="2250340">false</span><span class="op" id="2250345">}</span><span class="op" id="2250346">,</span>&nbsp;&nbsp;<span class="comment" id="2250349">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250361">{</span><span class="num" id="2250362">0xa3ab66580d5fdaf6</span><span class="op" id="2250380">,</span>&nbsp;<span class="op" id="2250382">-</span><span class="num" id="2250383">555</span><span class="op" id="2250386">,</span>&nbsp;<span class="builtintype" id="2250388">false</span><span class="op" id="2250393">}</span><span class="op" id="2250394">,</span>&nbsp;&nbsp;<span class="comment" id="2250397">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250409">{</span><span class="num" id="2250410">0xf3e2f893dec3f126</span><span class="op" id="2250428">,</span>&nbsp;<span class="op" id="2250430">-</span><span class="num" id="2250431">529</span><span class="op" id="2250434">,</span>&nbsp;<span class="builtintype" id="2250436">false</span><span class="op" id="2250441">}</span><span class="op" id="2250442">,</span>&nbsp;&nbsp;<span class="comment" id="2250445">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250457">{</span><span class="num" id="2250458">0xb5b5ada8aaff80b8</span><span class="op" id="2250476">,</span>&nbsp;<span class="op" id="2250478">-</span><span class="num" id="2250479">502</span><span class="op" id="2250482">,</span>&nbsp;<span class="builtintype" id="2250484">false</span><span class="op" id="2250489">}</span><span class="op" id="2250490">,</span>&nbsp;&nbsp;<span class="comment" id="2250493">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250505">{</span><span class="num" id="2250506">0x87625f056c7c4a8b</span><span class="op" id="2250524">,</span>&nbsp;<span class="op" id="2250526">-</span><span class="num" id="2250527">475</span><span class="op" id="2250530">,</span>&nbsp;<span class="builtintype" id="2250532">false</span><span class="op" id="2250537">}</span><span class="op" id="2250538">,</span>&nbsp;&nbsp;<span class="comment" id="2250541">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250553">{</span><span class="num" id="2250554">0xc9bcff6034c13053</span><span class="op" id="2250572">,</span>&nbsp;<span class="op" id="2250574">-</span><span class="num" id="2250575">449</span><span class="op" id="2250578">,</span>&nbsp;<span class="builtintype" id="2250580">false</span><span class="op" id="2250585">}</span><span class="op" id="2250586">,</span>&nbsp;&nbsp;<span class="comment" id="2250589">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250601">{</span><span class="num" id="2250602">0x964e858c91ba2655</span><span class="op" id="2250620">,</span>&nbsp;<span class="op" id="2250622">-</span><span class="num" id="2250623">422</span><span class="op" id="2250626">,</span>&nbsp;<span class="builtintype" id="2250628">false</span><span class="op" id="2250633">}</span><span class="op" id="2250634">,</span>&nbsp;&nbsp;<span class="comment" id="2250637">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250649">{</span><span class="num" id="2250650">0xdff9772470297ebd</span><span class="op" id="2250668">,</span>&nbsp;<span class="op" id="2250670">-</span><span class="num" id="2250671">396</span><span class="op" id="2250674">,</span>&nbsp;<span class="builtintype" id="2250676">false</span><span class="op" id="2250681">}</span><span class="op" id="2250682">,</span>&nbsp;&nbsp;<span class="comment" id="2250685">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250697">{</span><span class="num" id="2250698">0xa6dfbd9fb8e5b88f</span><span class="op" id="2250716">,</span>&nbsp;<span class="op" id="2250718">-</span><span class="num" id="2250719">369</span><span class="op" id="2250722">,</span>&nbsp;<span class="builtintype" id="2250724">false</span><span class="op" id="2250729">}</span><span class="op" id="2250730">,</span>&nbsp;&nbsp;<span class="comment" id="2250733">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250744">{</span><span class="num" id="2250745">0xf8a95fcf88747d94</span><span class="op" id="2250763">,</span>&nbsp;<span class="op" id="2250765">-</span><span class="num" id="2250766">343</span><span class="op" id="2250769">,</span>&nbsp;<span class="builtintype" id="2250771">false</span><span class="op" id="2250776">}</span><span class="op" id="2250777">,</span>&nbsp;&nbsp;<span class="comment" id="2250780">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250791">{</span><span class="num" id="2250792">0xb94470938fa89bcf</span><span class="op" id="2250810">,</span>&nbsp;<span class="op" id="2250812">-</span><span class="num" id="2250813">316</span><span class="op" id="2250816">,</span>&nbsp;<span class="builtintype" id="2250818">false</span><span class="op" id="2250823">}</span><span class="op" id="2250824">,</span>&nbsp;&nbsp;<span class="comment" id="2250827">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250838">{</span><span class="num" id="2250839">0x8a08f0f8bf0f156b</span><span class="op" id="2250857">,</span>&nbsp;<span class="op" id="2250859">-</span><span class="num" id="2250860">289</span><span class="op" id="2250863">,</span>&nbsp;<span class="builtintype" id="2250865">false</span><span class="op" id="2250870">}</span><span class="op" id="2250871">,</span>&nbsp;&nbsp;<span class="comment" id="2250874">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250885">{</span><span class="num" id="2250886">0xcdb02555653131b6</span><span class="op" id="2250904">,</span>&nbsp;<span class="op" id="2250906">-</span><span class="num" id="2250907">263</span><span class="op" id="2250910">,</span>&nbsp;<span class="builtintype" id="2250912">false</span><span class="op" id="2250917">}</span><span class="op" id="2250918">,</span>&nbsp;&nbsp;<span class="comment" id="2250921">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250932">{</span><span class="num" id="2250933">0x993fe2c6d07b7fac</span><span class="op" id="2250951">,</span>&nbsp;<span class="op" id="2250953">-</span><span class="num" id="2250954">236</span><span class="op" id="2250957">,</span>&nbsp;<span class="builtintype" id="2250959">false</span><span class="op" id="2250964">}</span><span class="op" id="2250965">,</span>&nbsp;&nbsp;<span class="comment" id="2250968">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2250979">{</span><span class="num" id="2250980">0xe45c10c42a2b3b06</span><span class="op" id="2250998">,</span>&nbsp;<span class="op" id="2251000">-</span><span class="num" id="2251001">210</span><span class="op" id="2251004">,</span>&nbsp;<span class="builtintype" id="2251006">false</span><span class="op" id="2251011">}</span><span class="op" id="2251012">,</span>&nbsp;&nbsp;<span class="comment" id="2251015">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251026">{</span><span class="num" id="2251027">0xaa242499697392d3</span><span class="op" id="2251045">,</span>&nbsp;<span class="op" id="2251047">-</span><span class="num" id="2251048">183</span><span class="op" id="2251051">,</span>&nbsp;<span class="builtintype" id="2251053">false</span><span class="op" id="2251058">}</span><span class="op" id="2251059">,</span>&nbsp;&nbsp;<span class="comment" id="2251062">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251073">{</span><span class="num" id="2251074">0xfd87b5f28300ca0e</span><span class="op" id="2251092">,</span>&nbsp;<span class="op" id="2251094">-</span><span class="num" id="2251095">157</span><span class="op" id="2251098">,</span>&nbsp;<span class="builtintype" id="2251100">false</span><span class="op" id="2251105">}</span><span class="op" id="2251106">,</span>&nbsp;&nbsp;<span class="comment" id="2251109">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251120">{</span><span class="num" id="2251121">0xbce5086492111aeb</span><span class="op" id="2251139">,</span>&nbsp;<span class="op" id="2251141">-</span><span class="num" id="2251142">130</span><span class="op" id="2251145">,</span>&nbsp;<span class="builtintype" id="2251147">false</span><span class="op" id="2251152">}</span><span class="op" id="2251153">,</span>&nbsp;&nbsp;<span class="comment" id="2251156">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251167">{</span><span class="num" id="2251168">0x8cbccc096f5088cc</span><span class="op" id="2251186">,</span>&nbsp;<span class="op" id="2251188">-</span><span class="num" id="2251189">103</span><span class="op" id="2251192">,</span>&nbsp;<span class="builtintype" id="2251194">false</span><span class="op" id="2251199">}</span><span class="op" id="2251200">,</span>&nbsp;&nbsp;<span class="comment" id="2251203">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251214">{</span><span class="num" id="2251215">0xd1b71758e219652c</span><span class="op" id="2251233">,</span>&nbsp;<span class="op" id="2251235">-</span><span class="num" id="2251236">77</span><span class="op" id="2251238">,</span>&nbsp;<span class="builtintype" id="2251240">false</span><span class="op" id="2251245">}</span><span class="op" id="2251246">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251250">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251260">{</span><span class="num" id="2251261">0x9c40000000000000</span><span class="op" id="2251279">,</span>&nbsp;<span class="op" id="2251281">-</span><span class="num" id="2251282">50</span><span class="op" id="2251284">,</span>&nbsp;<span class="builtintype" id="2251286">false</span><span class="op" id="2251291">}</span><span class="op" id="2251292">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251296">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251305">{</span><span class="num" id="2251306">0xe8d4a51000000000</span><span class="op" id="2251324">,</span>&nbsp;<span class="op" id="2251326">-</span><span class="num" id="2251327">24</span><span class="op" id="2251329">,</span>&nbsp;<span class="builtintype" id="2251331">false</span><span class="op" id="2251336">}</span><span class="op" id="2251337">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251341">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251351">{</span><span class="num" id="2251352">0xad78ebc5ac620000</span><span class="op" id="2251370">,</span>&nbsp;<span class="num" id="2251372">3</span><span class="op" id="2251373">,</span>&nbsp;<span class="builtintype" id="2251375">false</span><span class="op" id="2251380">}</span><span class="op" id="2251381">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251387">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251397">{</span><span class="num" id="2251398">0x813f3978f8940984</span><span class="op" id="2251416">,</span>&nbsp;<span class="num" id="2251418">30</span><span class="op" id="2251420">,</span>&nbsp;<span class="builtintype" id="2251422">false</span><span class="op" id="2251427">}</span><span class="op" id="2251428">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251433">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251443">{</span><span class="num" id="2251444">0xc097ce7bc90715b3</span><span class="op" id="2251462">,</span>&nbsp;<span class="num" id="2251464">56</span><span class="op" id="2251466">,</span>&nbsp;<span class="builtintype" id="2251468">false</span><span class="op" id="2251473">}</span><span class="op" id="2251474">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251479">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251489">{</span><span class="num" id="2251490">0x8f7e32ce7bea5c70</span><span class="op" id="2251508">,</span>&nbsp;<span class="num" id="2251510">83</span><span class="op" id="2251512">,</span>&nbsp;<span class="builtintype" id="2251514">false</span><span class="op" id="2251519">}</span><span class="op" id="2251520">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2251525">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251535">{</span><span class="num" id="2251536">0xd5d238a4abe98068</span><span class="op" id="2251554">,</span>&nbsp;<span class="num" id="2251556">109</span><span class="op" id="2251559">,</span>&nbsp;<span class="builtintype" id="2251561">false</span><span class="op" id="2251566">}</span><span class="op" id="2251567">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251571">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251581">{</span><span class="num" id="2251582">0x9f4f2726179a2245</span><span class="op" id="2251600">,</span>&nbsp;<span class="num" id="2251602">136</span><span class="op" id="2251605">,</span>&nbsp;<span class="builtintype" id="2251607">false</span><span class="op" id="2251612">}</span><span class="op" id="2251613">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251617">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251627">{</span><span class="num" id="2251628">0xed63a231d4c4fb27</span><span class="op" id="2251646">,</span>&nbsp;<span class="num" id="2251648">162</span><span class="op" id="2251651">,</span>&nbsp;<span class="builtintype" id="2251653">false</span><span class="op" id="2251658">}</span><span class="op" id="2251659">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251663">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251673">{</span><span class="num" id="2251674">0xb0de65388cc8ada8</span><span class="op" id="2251692">,</span>&nbsp;<span class="num" id="2251694">189</span><span class="op" id="2251697">,</span>&nbsp;<span class="builtintype" id="2251699">false</span><span class="op" id="2251704">}</span><span class="op" id="2251705">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251709">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251719">{</span><span class="num" id="2251720">0x83c7088e1aab65db</span><span class="op" id="2251738">,</span>&nbsp;<span class="num" id="2251740">216</span><span class="op" id="2251743">,</span>&nbsp;<span class="builtintype" id="2251745">false</span><span class="op" id="2251750">}</span><span class="op" id="2251751">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251755">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251765">{</span><span class="num" id="2251766">0xc45d1df942711d9a</span><span class="op" id="2251784">,</span>&nbsp;<span class="num" id="2251786">242</span><span class="op" id="2251789">,</span>&nbsp;<span class="builtintype" id="2251791">false</span><span class="op" id="2251796">}</span><span class="op" id="2251797">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251801">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251811">{</span><span class="num" id="2251812">0x924d692ca61be758</span><span class="op" id="2251830">,</span>&nbsp;<span class="num" id="2251832">269</span><span class="op" id="2251835">,</span>&nbsp;<span class="builtintype" id="2251837">false</span><span class="op" id="2251842">}</span><span class="op" id="2251843">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251847">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251858">{</span><span class="num" id="2251859">0xda01ee641a708dea</span><span class="op" id="2251877">,</span>&nbsp;<span class="num" id="2251879">295</span><span class="op" id="2251882">,</span>&nbsp;<span class="builtintype" id="2251884">false</span><span class="op" id="2251889">}</span><span class="op" id="2251890">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251894">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251905">{</span><span class="num" id="2251906">0xa26da3999aef774a</span><span class="op" id="2251924">,</span>&nbsp;<span class="num" id="2251926">322</span><span class="op" id="2251929">,</span>&nbsp;<span class="builtintype" id="2251931">false</span><span class="op" id="2251936">}</span><span class="op" id="2251937">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251941">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251952">{</span><span class="num" id="2251953">0xf209787bb47d6b85</span><span class="op" id="2251971">,</span>&nbsp;<span class="num" id="2251973">348</span><span class="op" id="2251976">,</span>&nbsp;<span class="builtintype" id="2251978">false</span><span class="op" id="2251983">}</span><span class="op" id="2251984">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2251988">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2251999">{</span><span class="num" id="2252000">0xb454e4a179dd1877</span><span class="op" id="2252018">,</span>&nbsp;<span class="num" id="2252020">375</span><span class="op" id="2252023">,</span>&nbsp;<span class="builtintype" id="2252025">false</span><span class="op" id="2252030">}</span><span class="op" id="2252031">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252035">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252046">{</span><span class="num" id="2252047">0x865b86925b9bc5c2</span><span class="op" id="2252065">,</span>&nbsp;<span class="num" id="2252067">402</span><span class="op" id="2252070">,</span>&nbsp;<span class="builtintype" id="2252072">false</span><span class="op" id="2252077">}</span><span class="op" id="2252078">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252082">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252093">{</span><span class="num" id="2252094">0xc83553c5c8965d3d</span><span class="op" id="2252112">,</span>&nbsp;<span class="num" id="2252114">428</span><span class="op" id="2252117">,</span>&nbsp;<span class="builtintype" id="2252119">false</span><span class="op" id="2252124">}</span><span class="op" id="2252125">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252129">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252140">{</span><span class="num" id="2252141">0x952ab45cfa97a0b3</span><span class="op" id="2252159">,</span>&nbsp;<span class="num" id="2252161">455</span><span class="op" id="2252164">,</span>&nbsp;<span class="builtintype" id="2252166">false</span><span class="op" id="2252171">}</span><span class="op" id="2252172">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252176">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252187">{</span><span class="num" id="2252188">0xde469fbd99a05fe3</span><span class="op" id="2252206">,</span>&nbsp;<span class="num" id="2252208">481</span><span class="op" id="2252211">,</span>&nbsp;<span class="builtintype" id="2252213">false</span><span class="op" id="2252218">}</span><span class="op" id="2252219">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252223">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252234">{</span><span class="num" id="2252235">0xa59bc234db398c25</span><span class="op" id="2252253">,</span>&nbsp;<span class="num" id="2252255">508</span><span class="op" id="2252258">,</span>&nbsp;<span class="builtintype" id="2252260">false</span><span class="op" id="2252265">}</span><span class="op" id="2252266">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252270">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252281">{</span><span class="num" id="2252282">0xf6c69a72a3989f5c</span><span class="op" id="2252300">,</span>&nbsp;<span class="num" id="2252302">534</span><span class="op" id="2252305">,</span>&nbsp;<span class="builtintype" id="2252307">false</span><span class="op" id="2252312">}</span><span class="op" id="2252313">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252317">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252328">{</span><span class="num" id="2252329">0xb7dcbf5354e9bece</span><span class="op" id="2252347">,</span>&nbsp;<span class="num" id="2252349">561</span><span class="op" id="2252352">,</span>&nbsp;<span class="builtintype" id="2252354">false</span><span class="op" id="2252359">}</span><span class="op" id="2252360">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252364">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252375">{</span><span class="num" id="2252376">0x88fcf317f22241e2</span><span class="op" id="2252394">,</span>&nbsp;<span class="num" id="2252396">588</span><span class="op" id="2252399">,</span>&nbsp;<span class="builtintype" id="2252401">false</span><span class="op" id="2252406">}</span><span class="op" id="2252407">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252411">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252422">{</span><span class="num" id="2252423">0xcc20ce9bd35c78a5</span><span class="op" id="2252441">,</span>&nbsp;<span class="num" id="2252443">614</span><span class="op" id="2252446">,</span>&nbsp;<span class="builtintype" id="2252448">false</span><span class="op" id="2252453">}</span><span class="op" id="2252454">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252458">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252469">{</span><span class="num" id="2252470">0x98165af37b2153df</span><span class="op" id="2252488">,</span>&nbsp;<span class="num" id="2252490">641</span><span class="op" id="2252493">,</span>&nbsp;<span class="builtintype" id="2252495">false</span><span class="op" id="2252500">}</span><span class="op" id="2252501">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252505">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252516">{</span><span class="num" id="2252517">0xe2a0b5dc971f303a</span><span class="op" id="2252535">,</span>&nbsp;<span class="num" id="2252537">667</span><span class="op" id="2252540">,</span>&nbsp;<span class="builtintype" id="2252542">false</span><span class="op" id="2252547">}</span><span class="op" id="2252548">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252552">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252563">{</span><span class="num" id="2252564">0xa8d9d1535ce3b396</span><span class="op" id="2252582">,</span>&nbsp;<span class="num" id="2252584">694</span><span class="op" id="2252587">,</span>&nbsp;<span class="builtintype" id="2252589">false</span><span class="op" id="2252594">}</span><span class="op" id="2252595">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252599">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252610">{</span><span class="num" id="2252611">0xfb9b7cd9a4a7443c</span><span class="op" id="2252629">,</span>&nbsp;<span class="num" id="2252631">720</span><span class="op" id="2252634">,</span>&nbsp;<span class="builtintype" id="2252636">false</span><span class="op" id="2252641">}</span><span class="op" id="2252642">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252646">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252657">{</span><span class="num" id="2252658">0xbb764c4ca7a44410</span><span class="op" id="2252676">,</span>&nbsp;<span class="num" id="2252678">747</span><span class="op" id="2252681">,</span>&nbsp;<span class="builtintype" id="2252683">false</span><span class="op" id="2252688">}</span><span class="op" id="2252689">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252693">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252704">{</span><span class="num" id="2252705">0x8bab8eefb6409c1a</span><span class="op" id="2252723">,</span>&nbsp;<span class="num" id="2252725">774</span><span class="op" id="2252728">,</span>&nbsp;<span class="builtintype" id="2252730">false</span><span class="op" id="2252735">}</span><span class="op" id="2252736">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252740">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252751">{</span><span class="num" id="2252752">0xd01fef10a657842c</span><span class="op" id="2252770">,</span>&nbsp;<span class="num" id="2252772">800</span><span class="op" id="2252775">,</span>&nbsp;<span class="builtintype" id="2252777">false</span><span class="op" id="2252782">}</span><span class="op" id="2252783">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252787">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252798">{</span><span class="num" id="2252799">0x9b10a4e5e9913129</span><span class="op" id="2252817">,</span>&nbsp;<span class="num" id="2252819">827</span><span class="op" id="2252822">,</span>&nbsp;<span class="builtintype" id="2252824">false</span><span class="op" id="2252829">}</span><span class="op" id="2252830">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252834">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252845">{</span><span class="num" id="2252846">0xe7109bfba19c0c9d</span><span class="op" id="2252864">,</span>&nbsp;<span class="num" id="2252866">853</span><span class="op" id="2252869">,</span>&nbsp;<span class="builtintype" id="2252871">false</span><span class="op" id="2252876">}</span><span class="op" id="2252877">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252881">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252892">{</span><span class="num" id="2252893">0xac2820d9623bf429</span><span class="op" id="2252911">,</span>&nbsp;<span class="num" id="2252913">880</span><span class="op" id="2252916">,</span>&nbsp;<span class="builtintype" id="2252918">false</span><span class="op" id="2252923">}</span><span class="op" id="2252924">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252928">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252939">{</span><span class="num" id="2252940">0x80444b5e7aa7cf85</span><span class="op" id="2252958">,</span>&nbsp;<span class="num" id="2252960">907</span><span class="op" id="2252963">,</span>&nbsp;<span class="builtintype" id="2252965">false</span><span class="op" id="2252970">}</span><span class="op" id="2252971">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2252975">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2252986">{</span><span class="num" id="2252987">0xbf21e44003acdd2d</span><span class="op" id="2253005">,</span>&nbsp;<span class="num" id="2253007">933</span><span class="op" id="2253010">,</span>&nbsp;<span class="builtintype" id="2253012">false</span><span class="op" id="2253017">}</span><span class="op" id="2253018">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2253022">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253033">{</span><span class="num" id="2253034">0x8e679c2f5e44ff8f</span><span class="op" id="2253052">,</span>&nbsp;<span class="num" id="2253054">960</span><span class="op" id="2253057">,</span>&nbsp;<span class="builtintype" id="2253059">false</span><span class="op" id="2253064">}</span><span class="op" id="2253065">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2253069">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253080">{</span><span class="num" id="2253081">0xd433179d9c8cb841</span><span class="op" id="2253099">,</span>&nbsp;<span class="num" id="2253101">986</span><span class="op" id="2253104">,</span>&nbsp;<span class="builtintype" id="2253106">false</span><span class="op" id="2253111">}</span><span class="op" id="2253112">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2253116">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253127">{</span><span class="num" id="2253128">0x9e19db92b4e31ba9</span><span class="op" id="2253146">,</span>&nbsp;<span class="num" id="2253148">1013</span><span class="op" id="2253152">,</span>&nbsp;<span class="builtintype" id="2253154">false</span><span class="op" id="2253159">}</span><span class="op" id="2253160">,</span>&nbsp;&nbsp;<span class="comment" id="2253163">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253174">{</span><span class="num" id="2253175">0xeb96bf6ebadf77d9</span><span class="op" id="2253193">,</span>&nbsp;<span class="num" id="2253195">1039</span><span class="op" id="2253199">,</span>&nbsp;<span class="builtintype" id="2253201">false</span><span class="op" id="2253206">}</span><span class="op" id="2253207">,</span>&nbsp;&nbsp;<span class="comment" id="2253210">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253221">{</span><span class="num" id="2253222">0xaf87023b9bf0ee6b</span><span class="op" id="2253240">,</span>&nbsp;<span class="num" id="2253242">1066</span><span class="op" id="2253246">,</span>&nbsp;<span class="builtintype" id="2253248">false</span><span class="op" id="2253253">}</span><span class="op" id="2253254">,</span>&nbsp;&nbsp;<span class="comment" id="2253257">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="2253267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2253270">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="2253338">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2253401">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="2253436">func</span>&nbsp;<span class="op" id="2253441">(</span><span class="ident" id="2253442">f</span>&nbsp;<span class="op" id="2253444">*</span><span class="ident" id="2253445">extFloat</span><span class="op" id="2253453">)</span>&nbsp;<span class="ident" id="2253455">floatBits</span><span class="op" id="2253464">(</span><span class="ident" id="2253465">flt</span>&nbsp;<span class="op" id="2253469">*</span><span class="ident" id="2253470">floatInfo</span><span class="op" id="2253479">)</span>&nbsp;<span class="op" id="2253481">(</span><span class="ident" id="2253482">bits</span>&nbsp;<span class="ident" id="2253487">uint64</span><span class="op" id="2253493">,</span>&nbsp;<span class="ident" id="2253495">overflow</span>&nbsp;<span class="builtintype" id="2253504">bool</span><span class="op" id="2253508">)</span>&nbsp;<span class="op" id="2253510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253513">f</span><span class="op" id="2253514">.</span><span class="ident" id="2253515">Normalize</span><span class="op" id="2253524">(</span><span class="op" id="2253525">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253529">exp</span>&nbsp;<span class="op" id="2253533">:=</span>&nbsp;<span class="ident" id="2253536">f</span><span class="op" id="2253537">.</span><span class="ident" id="2253538">exp</span>&nbsp;<span class="op" id="2253542">+</span>&nbsp;<span class="num" id="2253544">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253549">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253573">if</span>&nbsp;<span class="ident" id="2253576">exp</span>&nbsp;<span class="op" id="2253580">&lt;</span>&nbsp;<span class="ident" id="2253582">flt</span><span class="op" id="2253585">.</span><span class="ident" id="2253586">bias</span><span class="op" id="2253590">+</span><span class="num" id="2253591">1</span>&nbsp;<span class="op" id="2253593">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253597">n</span>&nbsp;<span class="op" id="2253599">:=</span>&nbsp;<span class="ident" id="2253602">flt</span><span class="op" id="2253605">.</span><span class="ident" id="2253606">bias</span>&nbsp;<span class="op" id="2253611">+</span>&nbsp;<span class="num" id="2253613">1</span>&nbsp;<span class="op" id="2253615">-</span>&nbsp;<span class="ident" id="2253617">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253623">f</span><span class="op" id="2253624">.</span><span class="ident" id="2253625">mant</span>&nbsp;<span class="op" id="2253630">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2253634">uint</span><span class="op" id="2253638">(</span><span class="ident" id="2253639">n</span><span class="op" id="2253640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253644">exp</span>&nbsp;<span class="op" id="2253648">+=</span>&nbsp;<span class="ident" id="2253651">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253658">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253716">mant</span>&nbsp;<span class="op" id="2253721">:=</span>&nbsp;<span class="ident" id="2253724">f</span><span class="op" id="2253725">.</span><span class="ident" id="2253726">mant</span>&nbsp;<span class="op" id="2253731">&gt;&gt;</span>&nbsp;<span class="op" id="2253734">(</span><span class="num" id="2253735">63</span>&nbsp;<span class="op" id="2253738">-</span>&nbsp;<span class="ident" id="2253740">flt</span><span class="op" id="2253743">.</span><span class="ident" id="2253744">mantbits</span><span class="op" id="2253752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253755">if</span>&nbsp;<span class="ident" id="2253758">f</span><span class="op" id="2253759">.</span><span class="ident" id="2253760">mant</span><span class="op" id="2253764">&amp;</span><span class="op" id="2253765">(</span><span class="num" id="2253766">1</span><span class="op" id="2253767">&lt;&lt;</span><span class="op" id="2253769">(</span><span class="num" id="2253770">62</span><span class="op" id="2253772">-</span><span class="ident" id="2253773">flt</span><span class="op" id="2253776">.</span><span class="ident" id="2253777">mantbits</span><span class="op" id="2253785">)</span><span class="op" id="2253786">)</span>&nbsp;<span class="op" id="2253788">!=</span>&nbsp;<span class="num" id="2253791">0</span>&nbsp;<span class="op" id="2253793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253797">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253812">mant</span>&nbsp;<span class="op" id="2253817">+=</span>&nbsp;<span class="num" id="2253820">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253827">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253876">if</span>&nbsp;<span class="ident" id="2253879">mant</span>&nbsp;<span class="op" id="2253884">==</span>&nbsp;<span class="num" id="2253887">2</span><span class="op" id="2253888">&lt;&lt;</span><span class="ident" id="2253890">flt</span><span class="op" id="2253893">.</span><span class="ident" id="2253894">mantbits</span>&nbsp;<span class="op" id="2253903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253907">mant</span>&nbsp;<span class="op" id="2253912">&gt;&gt;=</span>&nbsp;<span class="num" id="2253916">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253920">exp</span><span class="op" id="2253923">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2253927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253931">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2253947">if</span>&nbsp;<span class="ident" id="2253950">exp</span><span class="op" id="2253953">-</span><span class="ident" id="2253954">flt</span><span class="op" id="2253957">.</span><span class="ident" id="2253958">bias</span>&nbsp;<span class="op" id="2253963">&gt;=</span>&nbsp;<span class="num" id="2253966">1</span><span class="op" id="2253967">&lt;&lt;</span><span class="ident" id="2253969">flt</span><span class="op" id="2253972">.</span><span class="ident" id="2253973">expbits</span><span class="op" id="2253980">-</span><span class="num" id="2253981">1</span>&nbsp;<span class="op" id="2253983">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2253987">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2253998">mant</span>&nbsp;<span class="op" id="2254003">=</span>&nbsp;<span class="num" id="2254005">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254009">exp</span>&nbsp;<span class="op" id="2254013">=</span>&nbsp;<span class="num" id="2254015">1</span><span class="op" id="2254016">&lt;&lt;</span><span class="ident" id="2254018">flt</span><span class="op" id="2254021">.</span><span class="ident" id="2254022">expbits</span>&nbsp;<span class="op" id="2254030">-</span>&nbsp;<span class="num" id="2254032">1</span>&nbsp;<span class="op" id="2254034">+</span>&nbsp;<span class="ident" id="2254036">flt</span><span class="op" id="2254039">.</span><span class="ident" id="2254040">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254047">overflow</span>&nbsp;<span class="op" id="2254056">=</span>&nbsp;<span class="builtintype" id="2254058">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254064">}</span>&nbsp;<span class="keyword" id="2254066">else</span>&nbsp;<span class="keyword" id="2254071">if</span>&nbsp;<span class="ident" id="2254074">mant</span><span class="op" id="2254078">&amp;</span><span class="op" id="2254079">(</span><span class="num" id="2254080">1</span><span class="op" id="2254081">&lt;&lt;</span><span class="ident" id="2254083">flt</span><span class="op" id="2254086">.</span><span class="ident" id="2254087">mantbits</span><span class="op" id="2254095">)</span>&nbsp;<span class="op" id="2254097">==</span>&nbsp;<span class="num" id="2254100">0</span>&nbsp;<span class="op" id="2254102">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254106">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254125">exp</span>&nbsp;<span class="op" id="2254129">=</span>&nbsp;<span class="ident" id="2254131">flt</span><span class="op" id="2254134">.</span><span class="ident" id="2254135">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254144">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254163">bits</span>&nbsp;<span class="op" id="2254168">=</span>&nbsp;<span class="ident" id="2254170">mant</span>&nbsp;<span class="op" id="2254175">&amp;</span>&nbsp;<span class="op" id="2254177">(</span><span class="ident" id="2254178">uint64</span><span class="op" id="2254184">(</span><span class="num" id="2254185">1</span><span class="op" id="2254186">)</span><span class="op" id="2254187">&lt;&lt;</span><span class="ident" id="2254189">flt</span><span class="op" id="2254192">.</span><span class="ident" id="2254193">mantbits</span>&nbsp;<span class="op" id="2254202">-</span>&nbsp;<span class="num" id="2254204">1</span><span class="op" id="2254205">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254208">bits</span>&nbsp;<span class="op" id="2254213">|=</span>&nbsp;<span class="ident" id="2254216">uint64</span><span class="op" id="2254222">(</span><span class="op" id="2254223">(</span><span class="ident" id="2254224">exp</span><span class="op" id="2254227">-</span><span class="ident" id="2254228">flt</span><span class="op" id="2254231">.</span><span class="ident" id="2254232">bias</span><span class="op" id="2254236">)</span><span class="op" id="2254237">&amp;</span><span class="op" id="2254238">(</span><span class="num" id="2254239">1</span><span class="op" id="2254240">&lt;&lt;</span><span class="ident" id="2254242">flt</span><span class="op" id="2254245">.</span><span class="ident" id="2254246">expbits</span><span class="op" id="2254253">-</span><span class="num" id="2254254">1</span><span class="op" id="2254255">)</span><span class="op" id="2254256">)</span>&nbsp;<span class="op" id="2254258">&lt;&lt;</span>&nbsp;<span class="ident" id="2254261">flt</span><span class="op" id="2254264">.</span><span class="ident" id="2254265">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254275">if</span>&nbsp;<span class="ident" id="2254278">f</span><span class="op" id="2254279">.</span><span class="ident" id="2254280">neg</span>&nbsp;<span class="op" id="2254284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254288">bits</span>&nbsp;<span class="op" id="2254293">|=</span>&nbsp;<span class="num" id="2254296">1</span>&nbsp;<span class="op" id="2254298">&lt;&lt;</span>&nbsp;<span class="op" id="2254301">(</span><span class="ident" id="2254302">flt</span><span class="op" id="2254305">.</span><span class="ident" id="2254306">mantbits</span>&nbsp;<span class="op" id="2254315">+</span>&nbsp;<span class="ident" id="2254317">flt</span><span class="op" id="2254320">.</span><span class="ident" id="2254321">expbits</span><span class="op" id="2254328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254334">return</span><br>
<span class="lineno">170</span><span class="op" id="2254341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2254344">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2254402">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2254465">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="2254525">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2254596">func</span>&nbsp;<span class="op" id="2254601">(</span><span class="ident" id="2254602">f</span>&nbsp;<span class="op" id="2254604">*</span><span class="ident" id="2254605">extFloat</span><span class="op" id="2254613">)</span>&nbsp;<span class="ident" id="2254615">AssignComputeBounds</span><span class="op" id="2254634">(</span><span class="ident" id="2254635">mant</span>&nbsp;<span class="ident" id="2254640">uint64</span><span class="op" id="2254646">,</span>&nbsp;<span class="ident" id="2254648">exp</span>&nbsp;<span class="builtintype" id="2254652">int</span><span class="op" id="2254655">,</span>&nbsp;<span class="ident" id="2254657">neg</span>&nbsp;<span class="builtintype" id="2254661">bool</span><span class="op" id="2254665">,</span>&nbsp;<span class="ident" id="2254667">flt</span>&nbsp;<span class="op" id="2254671">*</span><span class="ident" id="2254672">floatInfo</span><span class="op" id="2254681">)</span>&nbsp;<span class="op" id="2254683">(</span><span class="ident" id="2254684">lower</span><span class="op" id="2254689">,</span>&nbsp;<span class="ident" id="2254691">upper</span>&nbsp;<span class="ident" id="2254697">extFloat</span><span class="op" id="2254705">)</span>&nbsp;<span class="op" id="2254707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254710">f</span><span class="op" id="2254711">.</span><span class="ident" id="2254712">mant</span>&nbsp;<span class="op" id="2254717">=</span>&nbsp;<span class="ident" id="2254719">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254725">f</span><span class="op" id="2254726">.</span><span class="ident" id="2254727">exp</span>&nbsp;<span class="op" id="2254731">=</span>&nbsp;<span class="ident" id="2254733">exp</span>&nbsp;<span class="op" id="2254737">-</span>&nbsp;<span class="builtintype" id="2254739">int</span><span class="op" id="2254742">(</span><span class="ident" id="2254743">flt</span><span class="op" id="2254746">.</span><span class="ident" id="2254747">mantbits</span><span class="op" id="2254755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254758">f</span><span class="op" id="2254759">.</span><span class="ident" id="2254760">neg</span>&nbsp;<span class="op" id="2254764">=</span>&nbsp;<span class="ident" id="2254766">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254771">if</span>&nbsp;<span class="ident" id="2254774">f</span><span class="op" id="2254775">.</span><span class="ident" id="2254776">exp</span>&nbsp;<span class="op" id="2254780">&lt;=</span>&nbsp;<span class="num" id="2254783">0</span>&nbsp;<span class="op" id="2254785">&amp;&amp;</span>&nbsp;<span class="ident" id="2254788">mant</span>&nbsp;<span class="op" id="2254793">==</span>&nbsp;<span class="op" id="2254796">(</span><span class="ident" id="2254797">mant</span><span class="op" id="2254801">&gt;&gt;</span><span class="builtintype" id="2254803">uint</span><span class="op" id="2254807">(</span><span class="op" id="2254808">-</span><span class="ident" id="2254809">f</span><span class="op" id="2254810">.</span><span class="ident" id="2254811">exp</span><span class="op" id="2254814">)</span><span class="op" id="2254815">)</span><span class="op" id="2254816">&lt;&lt;</span><span class="builtintype" id="2254818">uint</span><span class="op" id="2254822">(</span><span class="op" id="2254823">-</span><span class="ident" id="2254824">f</span><span class="op" id="2254825">.</span><span class="ident" id="2254826">exp</span><span class="op" id="2254829">)</span>&nbsp;<span class="op" id="2254831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2254835">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254857">f</span><span class="op" id="2254858">.</span><span class="ident" id="2254859">mant</span>&nbsp;<span class="op" id="2254864">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="2254868">uint</span><span class="op" id="2254872">(</span><span class="op" id="2254873">-</span><span class="ident" id="2254874">f</span><span class="op" id="2254875">.</span><span class="ident" id="2254876">exp</span><span class="op" id="2254879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254883">f</span><span class="op" id="2254884">.</span><span class="ident" id="2254885">exp</span>&nbsp;<span class="op" id="2254889">=</span>&nbsp;<span class="num" id="2254891">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2254895">return</span>&nbsp;<span class="op" id="2254902">*</span><span class="ident" id="2254903">f</span><span class="op" id="2254904">,</span>&nbsp;<span class="op" id="2254906">*</span><span class="ident" id="2254907">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2254910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254913">expBiased</span>&nbsp;<span class="op" id="2254923">:=</span>&nbsp;<span class="ident" id="2254926">exp</span>&nbsp;<span class="op" id="2254930">-</span>&nbsp;<span class="ident" id="2254932">flt</span><span class="op" id="2254935">.</span><span class="ident" id="2254936">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2254943">upper</span>&nbsp;<span class="op" id="2254949">=</span>&nbsp;<span class="ident" id="2254951">extFloat</span><span class="op" id="2254959">{</span><span class="ident" id="2254960">mant</span><span class="op" id="2254964">:</span>&nbsp;<span class="num" id="2254966">2</span><span class="op" id="2254967">*</span><span class="ident" id="2254968">f</span><span class="op" id="2254969">.</span><span class="ident" id="2254970">mant</span>&nbsp;<span class="op" id="2254975">+</span>&nbsp;<span class="num" id="2254977">1</span><span class="op" id="2254978">,</span>&nbsp;<span class="ident" id="2254980">exp</span><span class="op" id="2254983">:</span>&nbsp;<span class="ident" id="2254985">f</span><span class="op" id="2254986">.</span><span class="ident" id="2254987">exp</span>&nbsp;<span class="op" id="2254991">-</span>&nbsp;<span class="num" id="2254993">1</span><span class="op" id="2254994">,</span>&nbsp;<span class="ident" id="2254996">neg</span><span class="op" id="2254999">:</span>&nbsp;<span class="ident" id="2255001">f</span><span class="op" id="2255002">.</span><span class="ident" id="2255003">neg</span><span class="op" id="2255006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255009">if</span>&nbsp;<span class="ident" id="2255012">mant</span>&nbsp;<span class="op" id="2255017">!=</span>&nbsp;<span class="num" id="2255020">1</span><span class="op" id="2255021">&lt;&lt;</span><span class="ident" id="2255023">flt</span><span class="op" id="2255026">.</span><span class="ident" id="2255027">mantbits</span>&nbsp;<span class="op" id="2255036">||</span>&nbsp;<span class="ident" id="2255039">expBiased</span>&nbsp;<span class="op" id="2255049">==</span>&nbsp;<span class="num" id="2255052">1</span>&nbsp;<span class="op" id="2255054">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255058">lower</span>&nbsp;<span class="op" id="2255064">=</span>&nbsp;<span class="ident" id="2255066">extFloat</span><span class="op" id="2255074">{</span><span class="ident" id="2255075">mant</span><span class="op" id="2255079">:</span>&nbsp;<span class="num" id="2255081">2</span><span class="op" id="2255082">*</span><span class="ident" id="2255083">f</span><span class="op" id="2255084">.</span><span class="ident" id="2255085">mant</span>&nbsp;<span class="op" id="2255090">-</span>&nbsp;<span class="num" id="2255092">1</span><span class="op" id="2255093">,</span>&nbsp;<span class="ident" id="2255095">exp</span><span class="op" id="2255098">:</span>&nbsp;<span class="ident" id="2255100">f</span><span class="op" id="2255101">.</span><span class="ident" id="2255102">exp</span>&nbsp;<span class="op" id="2255106">-</span>&nbsp;<span class="num" id="2255108">1</span><span class="op" id="2255109">,</span>&nbsp;<span class="ident" id="2255111">neg</span><span class="op" id="2255114">:</span>&nbsp;<span class="ident" id="2255116">f</span><span class="op" id="2255117">.</span><span class="ident" id="2255118">neg</span><span class="op" id="2255121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255124">}</span>&nbsp;<span class="keyword" id="2255126">else</span>&nbsp;<span class="op" id="2255131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255135">lower</span>&nbsp;<span class="op" id="2255141">=</span>&nbsp;<span class="ident" id="2255143">extFloat</span><span class="op" id="2255151">{</span><span class="ident" id="2255152">mant</span><span class="op" id="2255156">:</span>&nbsp;<span class="num" id="2255158">4</span><span class="op" id="2255159">*</span><span class="ident" id="2255160">f</span><span class="op" id="2255161">.</span><span class="ident" id="2255162">mant</span>&nbsp;<span class="op" id="2255167">-</span>&nbsp;<span class="num" id="2255169">1</span><span class="op" id="2255170">,</span>&nbsp;<span class="ident" id="2255172">exp</span><span class="op" id="2255175">:</span>&nbsp;<span class="ident" id="2255177">f</span><span class="op" id="2255178">.</span><span class="ident" id="2255179">exp</span>&nbsp;<span class="op" id="2255183">-</span>&nbsp;<span class="num" id="2255185">2</span><span class="op" id="2255186">,</span>&nbsp;<span class="ident" id="2255188">neg</span><span class="op" id="2255191">:</span>&nbsp;<span class="ident" id="2255193">f</span><span class="op" id="2255194">.</span><span class="ident" id="2255195">neg</span><span class="op" id="2255198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255204">return</span><br>
<span class="lineno">195</span><span class="op" id="2255211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2255214">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2255283">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="2255354">func</span>&nbsp;<span class="op" id="2255359">(</span><span class="ident" id="2255360">f</span>&nbsp;<span class="op" id="2255362">*</span><span class="ident" id="2255363">extFloat</span><span class="op" id="2255371">)</span>&nbsp;<span class="ident" id="2255373">Normalize</span><span class="op" id="2255382">(</span><span class="op" id="2255383">)</span>&nbsp;<span class="op" id="2255385">(</span><span class="ident" id="2255386">shift</span>&nbsp;<span class="builtintype" id="2255392">uint</span><span class="op" id="2255396">)</span>&nbsp;<span class="op" id="2255398">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255401">mant</span><span class="op" id="2255405">,</span>&nbsp;<span class="ident" id="2255407">exp</span>&nbsp;<span class="op" id="2255411">:=</span>&nbsp;<span class="ident" id="2255414">f</span><span class="op" id="2255415">.</span><span class="ident" id="2255416">mant</span><span class="op" id="2255420">,</span>&nbsp;<span class="ident" id="2255422">f</span><span class="op" id="2255423">.</span><span class="ident" id="2255424">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255429">if</span>&nbsp;<span class="ident" id="2255432">mant</span>&nbsp;<span class="op" id="2255437">==</span>&nbsp;<span class="num" id="2255440">0</span>&nbsp;<span class="op" id="2255442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255446">return</span>&nbsp;<span class="num" id="2255453">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255459">if</span>&nbsp;<span class="ident" id="2255462">mant</span><span class="op" id="2255466">&gt;&gt;</span><span class="op" id="2255468">(</span><span class="num" id="2255469">64</span><span class="op" id="2255471">-</span><span class="num" id="2255472">32</span><span class="op" id="2255474">)</span>&nbsp;<span class="op" id="2255476">==</span>&nbsp;<span class="num" id="2255479">0</span>&nbsp;<span class="op" id="2255481">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255485">mant</span>&nbsp;<span class="op" id="2255490">&lt;&lt;=</span>&nbsp;<span class="num" id="2255494">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255499">exp</span>&nbsp;<span class="op" id="2255503">-=</span>&nbsp;<span class="num" id="2255506">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255513">if</span>&nbsp;<span class="ident" id="2255516">mant</span><span class="op" id="2255520">&gt;&gt;</span><span class="op" id="2255522">(</span><span class="num" id="2255523">64</span><span class="op" id="2255525">-</span><span class="num" id="2255526">16</span><span class="op" id="2255528">)</span>&nbsp;<span class="op" id="2255530">==</span>&nbsp;<span class="num" id="2255533">0</span>&nbsp;<span class="op" id="2255535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255539">mant</span>&nbsp;<span class="op" id="2255544">&lt;&lt;=</span>&nbsp;<span class="num" id="2255548">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255553">exp</span>&nbsp;<span class="op" id="2255557">-=</span>&nbsp;<span class="num" id="2255560">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255567">if</span>&nbsp;<span class="ident" id="2255570">mant</span><span class="op" id="2255574">&gt;&gt;</span><span class="op" id="2255576">(</span><span class="num" id="2255577">64</span><span class="op" id="2255579">-</span><span class="num" id="2255580">8</span><span class="op" id="2255581">)</span>&nbsp;<span class="op" id="2255583">==</span>&nbsp;<span class="num" id="2255586">0</span>&nbsp;<span class="op" id="2255588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255592">mant</span>&nbsp;<span class="op" id="2255597">&lt;&lt;=</span>&nbsp;<span class="num" id="2255601">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255605">exp</span>&nbsp;<span class="op" id="2255609">-=</span>&nbsp;<span class="num" id="2255612">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255618">if</span>&nbsp;<span class="ident" id="2255621">mant</span><span class="op" id="2255625">&gt;&gt;</span><span class="op" id="2255627">(</span><span class="num" id="2255628">64</span><span class="op" id="2255630">-</span><span class="num" id="2255631">4</span><span class="op" id="2255632">)</span>&nbsp;<span class="op" id="2255634">==</span>&nbsp;<span class="num" id="2255637">0</span>&nbsp;<span class="op" id="2255639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255643">mant</span>&nbsp;<span class="op" id="2255648">&lt;&lt;=</span>&nbsp;<span class="num" id="2255652">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255656">exp</span>&nbsp;<span class="op" id="2255660">-=</span>&nbsp;<span class="num" id="2255663">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255666">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255669">if</span>&nbsp;<span class="ident" id="2255672">mant</span><span class="op" id="2255676">&gt;&gt;</span><span class="op" id="2255678">(</span><span class="num" id="2255679">64</span><span class="op" id="2255681">-</span><span class="num" id="2255682">2</span><span class="op" id="2255683">)</span>&nbsp;<span class="op" id="2255685">==</span>&nbsp;<span class="num" id="2255688">0</span>&nbsp;<span class="op" id="2255690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255694">mant</span>&nbsp;<span class="op" id="2255699">&lt;&lt;=</span>&nbsp;<span class="num" id="2255703">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255707">exp</span>&nbsp;<span class="op" id="2255711">-=</span>&nbsp;<span class="num" id="2255714">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255720">if</span>&nbsp;<span class="ident" id="2255723">mant</span><span class="op" id="2255727">&gt;&gt;</span><span class="op" id="2255729">(</span><span class="num" id="2255730">64</span><span class="op" id="2255732">-</span><span class="num" id="2255733">1</span><span class="op" id="2255734">)</span>&nbsp;<span class="op" id="2255736">==</span>&nbsp;<span class="num" id="2255739">0</span>&nbsp;<span class="op" id="2255741">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255745">mant</span>&nbsp;<span class="op" id="2255750">&lt;&lt;=</span>&nbsp;<span class="num" id="2255754">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255758">exp</span>&nbsp;<span class="op" id="2255762">-=</span>&nbsp;<span class="num" id="2255765">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2255768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255771">shift</span>&nbsp;<span class="op" id="2255777">=</span>&nbsp;<span class="builtintype" id="2255779">uint</span><span class="op" id="2255783">(</span><span class="ident" id="2255784">f</span><span class="op" id="2255785">.</span><span class="ident" id="2255786">exp</span>&nbsp;<span class="op" id="2255790">-</span>&nbsp;<span class="ident" id="2255792">exp</span><span class="op" id="2255795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255798">f</span><span class="op" id="2255799">.</span><span class="ident" id="2255800">mant</span><span class="op" id="2255804">,</span>&nbsp;<span class="ident" id="2255806">f</span><span class="op" id="2255807">.</span><span class="ident" id="2255808">exp</span>&nbsp;<span class="op" id="2255812">=</span>&nbsp;<span class="ident" id="2255814">mant</span><span class="op" id="2255818">,</span>&nbsp;<span class="ident" id="2255820">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2255825">return</span><br>
<span class="lineno"></span><span class="op" id="2255832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2255835">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="2255907">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="2255930">func</span>&nbsp;<span class="op" id="2255935">(</span><span class="ident" id="2255936">f</span>&nbsp;<span class="op" id="2255938">*</span><span class="ident" id="2255939">extFloat</span><span class="op" id="2255947">)</span>&nbsp;<span class="ident" id="2255949">Multiply</span><span class="op" id="2255957">(</span><span class="ident" id="2255958">g</span>&nbsp;<span class="ident" id="2255960">extFloat</span><span class="op" id="2255968">)</span>&nbsp;<span class="op" id="2255970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2255973">fhi</span><span class="op" id="2255976">,</span>&nbsp;<span class="ident" id="2255978">flo</span>&nbsp;<span class="op" id="2255982">:=</span>&nbsp;<span class="ident" id="2255985">f</span><span class="op" id="2255986">.</span><span class="ident" id="2255987">mant</span><span class="op" id="2255991">&gt;&gt;</span><span class="num" id="2255993">32</span><span class="op" id="2255995">,</span>&nbsp;<span class="ident" id="2255997">uint64</span><span class="op" id="2256003">(</span><span class="builtintype" id="2256004">uint32</span><span class="op" id="2256010">(</span><span class="ident" id="2256011">f</span><span class="op" id="2256012">.</span><span class="ident" id="2256013">mant</span><span class="op" id="2256017">)</span><span class="op" id="2256018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256021">ghi</span><span class="op" id="2256024">,</span>&nbsp;<span class="ident" id="2256026">glo</span>&nbsp;<span class="op" id="2256030">:=</span>&nbsp;<span class="ident" id="2256033">g</span><span class="op" id="2256034">.</span><span class="ident" id="2256035">mant</span><span class="op" id="2256039">&gt;&gt;</span><span class="num" id="2256041">32</span><span class="op" id="2256043">,</span>&nbsp;<span class="ident" id="2256045">uint64</span><span class="op" id="2256051">(</span><span class="builtintype" id="2256052">uint32</span><span class="op" id="2256058">(</span><span class="ident" id="2256059">g</span><span class="op" id="2256060">.</span><span class="ident" id="2256061">mant</span><span class="op" id="2256065">)</span><span class="op" id="2256066">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256070">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256090">cross1</span>&nbsp;<span class="op" id="2256097">:=</span>&nbsp;<span class="ident" id="2256100">fhi</span>&nbsp;<span class="op" id="2256104">*</span>&nbsp;<span class="ident" id="2256106">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256111">cross2</span>&nbsp;<span class="op" id="2256118">:=</span>&nbsp;<span class="ident" id="2256121">flo</span>&nbsp;<span class="op" id="2256125">*</span>&nbsp;<span class="ident" id="2256127">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256133">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256202">f</span><span class="op" id="2256203">.</span><span class="ident" id="2256204">mant</span>&nbsp;<span class="op" id="2256209">=</span>&nbsp;<span class="ident" id="2256211">fhi</span><span class="op" id="2256214">*</span><span class="ident" id="2256215">ghi</span>&nbsp;<span class="op" id="2256219">+</span>&nbsp;<span class="op" id="2256221">(</span><span class="ident" id="2256222">cross1</span>&nbsp;<span class="op" id="2256229">&gt;&gt;</span>&nbsp;<span class="num" id="2256232">32</span><span class="op" id="2256234">)</span>&nbsp;<span class="op" id="2256236">+</span>&nbsp;<span class="op" id="2256238">(</span><span class="ident" id="2256239">cross2</span>&nbsp;<span class="op" id="2256246">&gt;&gt;</span>&nbsp;<span class="num" id="2256249">32</span><span class="op" id="2256251">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256254">rem</span>&nbsp;<span class="op" id="2256258">:=</span>&nbsp;<span class="ident" id="2256261">uint64</span><span class="op" id="2256267">(</span><span class="builtintype" id="2256268">uint32</span><span class="op" id="2256274">(</span><span class="ident" id="2256275">cross1</span><span class="op" id="2256281">)</span><span class="op" id="2256282">)</span>&nbsp;<span class="op" id="2256284">+</span>&nbsp;<span class="ident" id="2256286">uint64</span><span class="op" id="2256292">(</span><span class="builtintype" id="2256293">uint32</span><span class="op" id="2256299">(</span><span class="ident" id="2256300">cross2</span><span class="op" id="2256306">)</span><span class="op" id="2256307">)</span>&nbsp;<span class="op" id="2256309">+</span>&nbsp;<span class="op" id="2256311">(</span><span class="op" id="2256312">(</span><span class="ident" id="2256313">flo</span>&nbsp;<span class="op" id="2256317">*</span>&nbsp;<span class="ident" id="2256319">glo</span><span class="op" id="2256322">)</span>&nbsp;<span class="op" id="2256324">&gt;&gt;</span>&nbsp;<span class="num" id="2256327">32</span><span class="op" id="2256329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2256332">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256346">rem</span>&nbsp;<span class="op" id="2256350">+=</span>&nbsp;<span class="op" id="2256353">(</span><span class="num" id="2256354">1</span>&nbsp;<span class="op" id="2256356">&lt;&lt;</span>&nbsp;<span class="num" id="2256359">31</span><span class="op" id="2256361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256365">f</span><span class="op" id="2256366">.</span><span class="ident" id="2256367">mant</span>&nbsp;<span class="op" id="2256372">+=</span>&nbsp;<span class="op" id="2256375">(</span><span class="ident" id="2256376">rem</span>&nbsp;<span class="op" id="2256380">&gt;&gt;</span>&nbsp;<span class="num" id="2256383">32</span><span class="op" id="2256385">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256388">f</span><span class="op" id="2256389">.</span><span class="ident" id="2256390">exp</span>&nbsp;<span class="op" id="2256394">=</span>&nbsp;<span class="ident" id="2256396">f</span><span class="op" id="2256397">.</span><span class="ident" id="2256398">exp</span>&nbsp;<span class="op" id="2256402">+</span>&nbsp;<span class="ident" id="2256404">g</span><span class="op" id="2256405">.</span><span class="ident" id="2256406">exp</span>&nbsp;<span class="op" id="2256410">+</span>&nbsp;<span class="num" id="2256412">64</span><br>
<span class="lineno"></span><span class="op" id="2256415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2256418">var</span>&nbsp;<span class="ident" id="2256422">uint64pow10</span>&nbsp;<span class="op" id="2256434">=</span>&nbsp;<span class="op" id="2256436">[</span><span class="op" id="2256437">...</span><span class="op" id="2256440">]</span><span class="ident" id="2256441">uint64</span><span class="op" id="2256447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2256450">1</span><span class="op" id="2256451">,</span>&nbsp;<span class="num" id="2256453">1e1</span><span class="op" id="2256456">,</span>&nbsp;<span class="num" id="2256458">1e2</span><span class="op" id="2256461">,</span>&nbsp;<span class="num" id="2256463">1e3</span><span class="op" id="2256466">,</span>&nbsp;<span class="num" id="2256468">1e4</span><span class="op" id="2256471">,</span>&nbsp;<span class="num" id="2256473">1e5</span><span class="op" id="2256476">,</span>&nbsp;<span class="num" id="2256478">1e6</span><span class="op" id="2256481">,</span>&nbsp;<span class="num" id="2256483">1e7</span><span class="op" id="2256486">,</span>&nbsp;<span class="num" id="2256488">1e8</span><span class="op" id="2256491">,</span>&nbsp;<span class="num" id="2256493">1e9</span><span class="op" id="2256496">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2256499">1e10</span><span class="op" id="2256503">,</span>&nbsp;<span class="num" id="2256505">1e11</span><span class="op" id="2256509">,</span>&nbsp;<span class="num" id="2256511">1e12</span><span class="op" id="2256515">,</span>&nbsp;<span class="num" id="2256517">1e13</span><span class="op" id="2256521">,</span>&nbsp;<span class="num" id="2256523">1e14</span><span class="op" id="2256527">,</span>&nbsp;<span class="num" id="2256529">1e15</span><span class="op" id="2256533">,</span>&nbsp;<span class="num" id="2256535">1e16</span><span class="op" id="2256539">,</span>&nbsp;<span class="num" id="2256541">1e17</span><span class="op" id="2256545">,</span>&nbsp;<span class="num" id="2256547">1e18</span><span class="op" id="2256551">,</span>&nbsp;<span class="num" id="2256553">1e19</span><span class="op" id="2256557">,</span><br>
<span class="lineno"></span><span class="op" id="2256559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2256562">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2256630">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="2256700">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2256763">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="2256792">func</span>&nbsp;<span class="op" id="2256797">(</span><span class="ident" id="2256798">f</span>&nbsp;<span class="op" id="2256800">*</span><span class="ident" id="2256801">extFloat</span><span class="op" id="2256809">)</span>&nbsp;<span class="ident" id="2256811">AssignDecimal</span><span class="op" id="2256824">(</span><span class="ident" id="2256825">mantissa</span>&nbsp;<span class="ident" id="2256834">uint64</span><span class="op" id="2256840">,</span>&nbsp;<span class="ident" id="2256842">exp10</span>&nbsp;<span class="builtintype" id="2256848">int</span><span class="op" id="2256851">,</span>&nbsp;<span class="ident" id="2256853">neg</span>&nbsp;<span class="builtintype" id="2256857">bool</span><span class="op" id="2256861">,</span>&nbsp;<span class="ident" id="2256863">trunc</span>&nbsp;<span class="builtintype" id="2256869">bool</span><span class="op" id="2256873">,</span>&nbsp;<span class="ident" id="2256875">flt</span>&nbsp;<span class="op" id="2256879">*</span><span class="ident" id="2256880">floatInfo</span><span class="op" id="2256889">)</span>&nbsp;<span class="op" id="2256891">(</span><span class="ident" id="2256892">ok</span>&nbsp;<span class="builtintype" id="2256895">bool</span><span class="op" id="2256899">)</span>&nbsp;<span class="op" id="2256901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256904">const</span>&nbsp;<span class="ident" id="2256910">uint64digits</span>&nbsp;<span class="op" id="2256923">=</span>&nbsp;<span class="num" id="2256925">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2256929">const</span>&nbsp;<span class="ident" id="2256935">errorscale</span>&nbsp;<span class="op" id="2256946">=</span>&nbsp;<span class="num" id="2256948">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2256951">errors</span>&nbsp;<span class="op" id="2256958">:=</span>&nbsp;<span class="num" id="2256961">0</span>&nbsp;<span class="comment" id="2256963">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257021">if</span>&nbsp;<span class="ident" id="2257024">trunc</span>&nbsp;<span class="op" id="2257030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257034">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257073">errors</span>&nbsp;<span class="op" id="2257080">+=</span>&nbsp;<span class="ident" id="2257083">errorscale</span>&nbsp;<span class="op" id="2257094">/</span>&nbsp;<span class="num" id="2257096">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257099">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257103">f</span><span class="op" id="2257104">.</span><span class="ident" id="2257105">mant</span>&nbsp;<span class="op" id="2257110">=</span>&nbsp;<span class="ident" id="2257112">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257122">f</span><span class="op" id="2257123">.</span><span class="ident" id="2257124">exp</span>&nbsp;<span class="op" id="2257128">=</span>&nbsp;<span class="num" id="2257130">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257133">f</span><span class="op" id="2257134">.</span><span class="ident" id="2257135">neg</span>&nbsp;<span class="op" id="2257139">=</span>&nbsp;<span class="ident" id="2257141">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257147">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257178">i</span>&nbsp;<span class="op" id="2257180">:=</span>&nbsp;<span class="op" id="2257183">(</span><span class="ident" id="2257184">exp10</span>&nbsp;<span class="op" id="2257190">-</span>&nbsp;<span class="ident" id="2257192">firstPowerOfTen</span><span class="op" id="2257207">)</span>&nbsp;<span class="op" id="2257209">/</span>&nbsp;<span class="ident" id="2257211">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257227">if</span>&nbsp;<span class="ident" id="2257230">exp10</span>&nbsp;<span class="op" id="2257236">&lt;</span>&nbsp;<span class="ident" id="2257238">firstPowerOfTen</span>&nbsp;<span class="op" id="2257254">||</span>&nbsp;<span class="ident" id="2257257">i</span>&nbsp;<span class="op" id="2257259">&gt;=</span>&nbsp;<span class="builtinfunc" id="2257262">len</span><span class="op" id="2257265">(</span><span class="ident" id="2257266">powersOfTen</span><span class="op" id="2257277">)</span>&nbsp;<span class="op" id="2257279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257283">return</span>&nbsp;<span class="builtintype" id="2257290">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257297">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257300">adjExp</span>&nbsp;<span class="op" id="2257307">:=</span>&nbsp;<span class="op" id="2257310">(</span><span class="ident" id="2257311">exp10</span>&nbsp;<span class="op" id="2257317">-</span>&nbsp;<span class="ident" id="2257319">firstPowerOfTen</span><span class="op" id="2257334">)</span>&nbsp;<span class="op" id="2257336">%</span>&nbsp;<span class="ident" id="2257338">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257355">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257383">if</span>&nbsp;<span class="ident" id="2257386">adjExp</span>&nbsp;<span class="op" id="2257393">&lt;</span>&nbsp;<span class="ident" id="2257395">uint64digits</span>&nbsp;<span class="op" id="2257408">&amp;&amp;</span>&nbsp;<span class="ident" id="2257411">mantissa</span>&nbsp;<span class="op" id="2257420">&lt;</span>&nbsp;<span class="ident" id="2257422">uint64pow10</span><span class="op" id="2257433">[</span><span class="ident" id="2257434">uint64digits</span><span class="op" id="2257446">-</span><span class="ident" id="2257447">adjExp</span><span class="op" id="2257453">]</span>&nbsp;<span class="op" id="2257455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257459">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257502">f</span><span class="op" id="2257503">.</span><span class="ident" id="2257504">mant</span>&nbsp;<span class="op" id="2257509">*=</span>&nbsp;<span class="ident" id="2257512">uint64pow10</span><span class="op" id="2257523">[</span><span class="ident" id="2257524">adjExp</span><span class="op" id="2257530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257534">f</span><span class="op" id="2257535">.</span><span class="ident" id="2257536">Normalize</span><span class="op" id="2257545">(</span><span class="op" id="2257546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257549">}</span>&nbsp;<span class="keyword" id="2257551">else</span>&nbsp;<span class="op" id="2257556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257560">f</span><span class="op" id="2257561">.</span><span class="ident" id="2257562">Normalize</span><span class="op" id="2257571">(</span><span class="op" id="2257572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257576">f</span><span class="op" id="2257577">.</span><span class="ident" id="2257578">Multiply</span><span class="op" id="2257586">(</span><span class="ident" id="2257587">smallPowersOfTen</span><span class="op" id="2257603">[</span><span class="ident" id="2257604">adjExp</span><span class="op" id="2257610">]</span><span class="op" id="2257611">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257615">errors</span>&nbsp;<span class="op" id="2257622">+=</span>&nbsp;<span class="ident" id="2257625">errorscale</span>&nbsp;<span class="op" id="2257636">/</span>&nbsp;<span class="num" id="2257638">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257645">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257690">f</span><span class="op" id="2257691">.</span><span class="ident" id="2257692">Multiply</span><span class="op" id="2257700">(</span><span class="ident" id="2257701">powersOfTen</span><span class="op" id="2257712">[</span><span class="ident" id="2257713">i</span><span class="op" id="2257714">]</span><span class="op" id="2257715">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2257718">if</span>&nbsp;<span class="ident" id="2257721">errors</span>&nbsp;<span class="op" id="2257728">&gt;</span>&nbsp;<span class="num" id="2257730">0</span>&nbsp;<span class="op" id="2257732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257736">errors</span>&nbsp;<span class="op" id="2257743">+=</span>&nbsp;<span class="num" id="2257746">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2257749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257752">errors</span>&nbsp;<span class="op" id="2257759">+=</span>&nbsp;<span class="ident" id="2257762">errorscale</span>&nbsp;<span class="op" id="2257773">/</span>&nbsp;<span class="num" id="2257775">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257779">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257793">shift</span>&nbsp;<span class="op" id="2257799">:=</span>&nbsp;<span class="ident" id="2257802">f</span><span class="op" id="2257803">.</span><span class="ident" id="2257804">Normalize</span><span class="op" id="2257813">(</span><span class="op" id="2257814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2257817">errors</span>&nbsp;<span class="op" id="2257824">&lt;&lt;=</span>&nbsp;<span class="ident" id="2257828">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257836">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257886">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2257953">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258021">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258090">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258094">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2258151">denormalExp</span>&nbsp;<span class="op" id="2258163">:=</span>&nbsp;<span class="ident" id="2258166">flt</span><span class="op" id="2258169">.</span><span class="ident" id="2258170">bias</span>&nbsp;<span class="op" id="2258175">-</span>&nbsp;<span class="num" id="2258177">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2258181">var</span>&nbsp;<span class="ident" id="2258185">extrabits</span>&nbsp;<span class="builtintype" id="2258195">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2258201">if</span>&nbsp;<span class="ident" id="2258204">f</span><span class="op" id="2258205">.</span><span class="ident" id="2258206">exp</span>&nbsp;<span class="op" id="2258210">&lt;=</span>&nbsp;<span class="ident" id="2258213">denormalExp</span>&nbsp;<span class="op" id="2258225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258229">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2258283">extrabits</span>&nbsp;<span class="op" id="2258293">=</span>&nbsp;<span class="builtintype" id="2258295">uint</span><span class="op" id="2258299">(</span><span class="num" id="2258300">63</span>&nbsp;<span class="op" id="2258303">-</span>&nbsp;<span class="ident" id="2258305">flt</span><span class="op" id="2258308">.</span><span class="ident" id="2258309">mantbits</span>&nbsp;<span class="op" id="2258318">+</span>&nbsp;<span class="num" id="2258320">1</span>&nbsp;<span class="op" id="2258322">+</span>&nbsp;<span class="builtintype" id="2258324">uint</span><span class="op" id="2258328">(</span><span class="ident" id="2258329">denormalExp</span><span class="op" id="2258340">-</span><span class="ident" id="2258341">f</span><span class="op" id="2258342">.</span><span class="ident" id="2258343">exp</span><span class="op" id="2258346">)</span><span class="op" id="2258347">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258350">}</span>&nbsp;<span class="keyword" id="2258352">else</span>&nbsp;<span class="op" id="2258357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2258361">extrabits</span>&nbsp;<span class="op" id="2258371">=</span>&nbsp;<span class="builtintype" id="2258373">uint</span><span class="op" id="2258377">(</span><span class="num" id="2258378">63</span>&nbsp;<span class="op" id="2258381">-</span>&nbsp;<span class="ident" id="2258383">flt</span><span class="op" id="2258386">.</span><span class="ident" id="2258387">mantbits</span><span class="op" id="2258395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2258402">halfway</span>&nbsp;<span class="op" id="2258410">:=</span>&nbsp;<span class="ident" id="2258413">uint64</span><span class="op" id="2258419">(</span><span class="num" id="2258420">1</span><span class="op" id="2258421">)</span>&nbsp;<span class="op" id="2258423">&lt;&lt;</span>&nbsp;<span class="op" id="2258426">(</span><span class="ident" id="2258427">extrabits</span>&nbsp;<span class="op" id="2258437">-</span>&nbsp;<span class="num" id="2258439">1</span><span class="op" id="2258440">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2258443">mant_extra</span>&nbsp;<span class="op" id="2258454">:=</span>&nbsp;<span class="ident" id="2258457">f</span><span class="op" id="2258458">.</span><span class="ident" id="2258459">mant</span>&nbsp;<span class="op" id="2258464">&amp;</span>&nbsp;<span class="op" id="2258466">(</span><span class="num" id="2258467">1</span><span class="op" id="2258468">&lt;&lt;</span><span class="ident" id="2258470">extrabits</span>&nbsp;<span class="op" id="2258480">-</span>&nbsp;<span class="num" id="2258482">1</span><span class="op" id="2258483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258487">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258553">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2258618">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2258660">if</span>&nbsp;<span class="ident" id="2258663">int64</span><span class="op" id="2258668">(</span><span class="ident" id="2258669">halfway</span><span class="op" id="2258676">)</span><span class="op" id="2258677">-</span><span class="ident" id="2258678">int64</span><span class="op" id="2258683">(</span><span class="ident" id="2258684">errors</span><span class="op" id="2258690">)</span>&nbsp;<span class="op" id="2258692">&lt;</span>&nbsp;<span class="ident" id="2258694">int64</span><span class="op" id="2258699">(</span><span class="ident" id="2258700">mant_extra</span><span class="op" id="2258710">)</span>&nbsp;<span class="op" id="2258712">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2258717">int64</span><span class="op" id="2258722">(</span><span class="ident" id="2258723">mant_extra</span><span class="op" id="2258733">)</span>&nbsp;<span class="op" id="2258735">&lt;</span>&nbsp;<span class="ident" id="2258737">int64</span><span class="op" id="2258742">(</span><span class="ident" id="2258743">halfway</span><span class="op" id="2258750">)</span><span class="op" id="2258751">+</span><span class="ident" id="2258752">int64</span><span class="op" id="2258757">(</span><span class="ident" id="2258758">errors</span><span class="op" id="2258764">)</span>&nbsp;<span class="op" id="2258766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2258770">return</span>&nbsp;<span class="builtintype" id="2258777">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2258784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2258787">return</span>&nbsp;<span class="builtintype" id="2258794">true</span><br>
<span class="lineno">330</span><span class="op" id="2258799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2258802">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="2258872">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2258939">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="2259005">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="2259066">func</span>&nbsp;<span class="op" id="2259071">(</span><span class="ident" id="2259072">f</span>&nbsp;<span class="op" id="2259074">*</span><span class="ident" id="2259075">extFloat</span><span class="op" id="2259083">)</span>&nbsp;<span class="ident" id="2259085">frexp10</span><span class="op" id="2259092">(</span><span class="op" id="2259093">)</span>&nbsp;<span class="op" id="2259095">(</span><span class="ident" id="2259096">exp10</span><span class="op" id="2259101">,</span>&nbsp;<span class="ident" id="2259103">index</span>&nbsp;<span class="builtintype" id="2259109">int</span><span class="op" id="2259112">)</span>&nbsp;<span class="op" id="2259114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259117">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259186">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259256">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259325">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259398">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259409">const</span>&nbsp;<span class="ident" id="2259415">expMin</span>&nbsp;<span class="op" id="2259422">=</span>&nbsp;<span class="op" id="2259424">-</span><span class="num" id="2259425">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259429">const</span>&nbsp;<span class="ident" id="2259435">expMax</span>&nbsp;<span class="op" id="2259442">=</span>&nbsp;<span class="op" id="2259444">-</span><span class="num" id="2259445">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259449">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259512">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2259543">approxExp10</span>&nbsp;<span class="op" id="2259555">:=</span>&nbsp;<span class="op" id="2259558">(</span><span class="op" id="2259559">(</span><span class="ident" id="2259560">expMin</span><span class="op" id="2259566">+</span><span class="ident" id="2259567">expMax</span><span class="op" id="2259573">)</span><span class="op" id="2259574">/</span><span class="num" id="2259575">2</span>&nbsp;<span class="op" id="2259577">-</span>&nbsp;<span class="ident" id="2259579">f</span><span class="op" id="2259580">.</span><span class="ident" id="2259581">exp</span><span class="op" id="2259584">)</span>&nbsp;<span class="op" id="2259586">*</span>&nbsp;<span class="num" id="2259588">28</span>&nbsp;<span class="op" id="2259591">/</span>&nbsp;<span class="num" id="2259593">93</span>&nbsp;<span class="comment" id="2259596">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2259634">i</span>&nbsp;<span class="op" id="2259636">:=</span>&nbsp;<span class="op" id="2259639">(</span><span class="ident" id="2259640">approxExp10</span>&nbsp;<span class="op" id="2259652">-</span>&nbsp;<span class="ident" id="2259654">firstPowerOfTen</span><span class="op" id="2259669">)</span>&nbsp;<span class="op" id="2259671">/</span>&nbsp;<span class="ident" id="2259673">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="2259688">Loop</span><span class="op" id="2259692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259695">for</span>&nbsp;<span class="op" id="2259699">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2259703">exp</span>&nbsp;<span class="op" id="2259707">:=</span>&nbsp;<span class="ident" id="2259710">f</span><span class="op" id="2259711">.</span><span class="ident" id="2259712">exp</span>&nbsp;<span class="op" id="2259716">+</span>&nbsp;<span class="ident" id="2259718">powersOfTen</span><span class="op" id="2259729">[</span><span class="ident" id="2259730">i</span><span class="op" id="2259731">]</span><span class="op" id="2259732">.</span><span class="ident" id="2259733">exp</span>&nbsp;<span class="op" id="2259737">+</span>&nbsp;<span class="num" id="2259739">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259744">switch</span>&nbsp;<span class="op" id="2259751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259755">case</span>&nbsp;<span class="ident" id="2259760">exp</span>&nbsp;<span class="op" id="2259764">&lt;</span>&nbsp;<span class="ident" id="2259766">expMin</span><span class="op" id="2259772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2259777">i</span><span class="op" id="2259778">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259783">case</span>&nbsp;<span class="ident" id="2259788">exp</span>&nbsp;<span class="op" id="2259792">&gt;</span>&nbsp;<span class="ident" id="2259794">expMax</span><span class="op" id="2259800">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2259805">i</span><span class="op" id="2259806">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259811">default</span><span class="op" id="2259818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259823">break</span>&nbsp;<span class="ident" id="2259829">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2259839">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259842">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2259906">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2259969">f</span><span class="op" id="2259970">.</span><span class="ident" id="2259971">Multiply</span><span class="op" id="2259979">(</span><span class="ident" id="2259980">powersOfTen</span><span class="op" id="2259991">[</span><span class="ident" id="2259992">i</span><span class="op" id="2259993">]</span><span class="op" id="2259994">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2259998">return</span>&nbsp;<span class="op" id="2260005">-</span><span class="op" id="2260006">(</span><span class="ident" id="2260007">firstPowerOfTen</span>&nbsp;<span class="op" id="2260023">+</span>&nbsp;<span class="ident" id="2260025">i</span><span class="op" id="2260026">*</span><span class="ident" id="2260027">stepPowerOfTen</span><span class="op" id="2260041">)</span><span class="op" id="2260042">,</span>&nbsp;<span class="ident" id="2260044">i</span><br>
<span class="lineno">365</span><span class="op" id="2260046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2260049">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="2260117">func</span>&nbsp;<span class="ident" id="2260122">frexp10Many</span><span class="op" id="2260133">(</span><span class="ident" id="2260134">a</span><span class="op" id="2260135">,</span>&nbsp;<span class="ident" id="2260137">b</span><span class="op" id="2260138">,</span>&nbsp;<span class="ident" id="2260140">c</span>&nbsp;<span class="op" id="2260142">*</span><span class="ident" id="2260143">extFloat</span><span class="op" id="2260151">)</span>&nbsp;<span class="op" id="2260153">(</span><span class="ident" id="2260154">exp10</span>&nbsp;<span class="builtintype" id="2260160">int</span><span class="op" id="2260163">)</span>&nbsp;<span class="op" id="2260165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260168">exp10</span><span class="op" id="2260173">,</span>&nbsp;<span class="ident" id="2260175">i</span>&nbsp;<span class="op" id="2260177">:=</span>&nbsp;<span class="ident" id="2260180">c</span><span class="op" id="2260181">.</span><span class="ident" id="2260182">frexp10</span><span class="op" id="2260189">(</span><span class="op" id="2260190">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260193">a</span><span class="op" id="2260194">.</span><span class="ident" id="2260195">Multiply</span><span class="op" id="2260203">(</span><span class="ident" id="2260204">powersOfTen</span><span class="op" id="2260215">[</span><span class="ident" id="2260216">i</span><span class="op" id="2260217">]</span><span class="op" id="2260218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260221">b</span><span class="op" id="2260222">.</span><span class="ident" id="2260223">Multiply</span><span class="op" id="2260231">(</span><span class="ident" id="2260232">powersOfTen</span><span class="op" id="2260243">[</span><span class="ident" id="2260244">i</span><span class="op" id="2260245">]</span><span class="op" id="2260246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260249">return</span><br>
<span class="lineno"></span><span class="op" id="2260256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="2260259">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="2260318">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="2260374">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="2260413">func</span>&nbsp;<span class="op" id="2260418">(</span><span class="ident" id="2260419">f</span>&nbsp;<span class="op" id="2260421">*</span><span class="ident" id="2260422">extFloat</span><span class="op" id="2260430">)</span>&nbsp;<span class="ident" id="2260432">FixedDecimal</span><span class="op" id="2260444">(</span><span class="ident" id="2260445">d</span>&nbsp;<span class="op" id="2260447">*</span><span class="ident" id="2260448">decimalSlice</span><span class="op" id="2260460">,</span>&nbsp;<span class="ident" id="2260462">n</span>&nbsp;<span class="builtintype" id="2260464">int</span><span class="op" id="2260467">)</span>&nbsp;<span class="builtintype" id="2260469">bool</span>&nbsp;<span class="op" id="2260474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260477">if</span>&nbsp;<span class="ident" id="2260480">f</span><span class="op" id="2260481">.</span><span class="ident" id="2260482">mant</span>&nbsp;<span class="op" id="2260487">==</span>&nbsp;<span class="num" id="2260490">0</span>&nbsp;<span class="op" id="2260492">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260496">d</span><span class="op" id="2260497">.</span><span class="ident" id="2260498">nd</span>&nbsp;<span class="op" id="2260501">=</span>&nbsp;<span class="num" id="2260503">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260507">d</span><span class="op" id="2260508">.</span><span class="ident" id="2260509">dp</span>&nbsp;<span class="op" id="2260512">=</span>&nbsp;<span class="num" id="2260514">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260518">d</span><span class="op" id="2260519">.</span><span class="ident" id="2260520">neg</span>&nbsp;<span class="op" id="2260524">=</span>&nbsp;<span class="ident" id="2260526">f</span><span class="op" id="2260527">.</span><span class="ident" id="2260528">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260534">return</span>&nbsp;<span class="builtintype" id="2260541">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260547">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2260550">if</span>&nbsp;<span class="ident" id="2260553">n</span>&nbsp;<span class="op" id="2260555">==</span>&nbsp;<span class="num" id="2260558">0</span>&nbsp;<span class="op" id="2260560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2260564">panic</span><span class="op" id="2260569">(</span><span class="string" id="2260570">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="2260637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2260640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260643">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260708">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260731">f</span><span class="op" id="2260732">.</span><span class="ident" id="2260733">Normalize</span><span class="op" id="2260742">(</span><span class="op" id="2260743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260746">exp10</span><span class="op" id="2260751">,</span>&nbsp;<span class="ident" id="2260753">_</span>&nbsp;<span class="op" id="2260755">:=</span>&nbsp;<span class="ident" id="2260758">f</span><span class="op" id="2260759">.</span><span class="ident" id="2260760">frexp10</span><span class="op" id="2260767">(</span><span class="op" id="2260768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260772">shift</span>&nbsp;<span class="op" id="2260778">:=</span>&nbsp;<span class="builtintype" id="2260781">uint</span><span class="op" id="2260785">(</span><span class="op" id="2260786">-</span><span class="ident" id="2260787">f</span><span class="op" id="2260788">.</span><span class="ident" id="2260789">exp</span><span class="op" id="2260792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260795">integer</span>&nbsp;<span class="op" id="2260803">:=</span>&nbsp;<span class="builtintype" id="2260806">uint32</span><span class="op" id="2260812">(</span><span class="ident" id="2260813">f</span><span class="op" id="2260814">.</span><span class="ident" id="2260815">mant</span>&nbsp;<span class="op" id="2260820">&gt;&gt;</span>&nbsp;<span class="ident" id="2260823">shift</span><span class="op" id="2260828">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260831">fraction</span>&nbsp;<span class="op" id="2260840">:=</span>&nbsp;<span class="ident" id="2260843">f</span><span class="op" id="2260844">.</span><span class="ident" id="2260845">mant</span>&nbsp;<span class="op" id="2260850">-</span>&nbsp;<span class="op" id="2260852">(</span><span class="ident" id="2260853">uint64</span><span class="op" id="2260859">(</span><span class="ident" id="2260860">integer</span><span class="op" id="2260867">)</span>&nbsp;<span class="op" id="2260869">&lt;&lt;</span>&nbsp;<span class="ident" id="2260872">shift</span><span class="op" id="2260877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260880">ε</span>&nbsp;<span class="op" id="2260883">:=</span>&nbsp;<span class="ident" id="2260886">uint64</span><span class="op" id="2260892">(</span><span class="num" id="2260893">1</span><span class="op" id="2260894">)</span>&nbsp;<span class="comment" id="2260896">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2260953">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2260986">needed</span>&nbsp;<span class="op" id="2260993">:=</span>&nbsp;<span class="ident" id="2260996">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2261005">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261044">integerDigits</span>&nbsp;<span class="op" id="2261058">:=</span>&nbsp;<span class="num" id="2261061">0</span>&nbsp;<span class="comment" id="2261063">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261108">pow10</span>&nbsp;<span class="op" id="2261114">:=</span>&nbsp;<span class="ident" id="2261117">uint64</span><span class="op" id="2261123">(</span><span class="num" id="2261124">1</span><span class="op" id="2261125">)</span>&nbsp;<span class="comment" id="2261127">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261171">for</span>&nbsp;<span class="ident" id="2261175">i</span><span class="op" id="2261176">,</span>&nbsp;<span class="ident" id="2261178">pow</span>&nbsp;<span class="op" id="2261182">:=</span>&nbsp;<span class="num" id="2261185">0</span><span class="op" id="2261186">,</span>&nbsp;<span class="ident" id="2261188">uint64</span><span class="op" id="2261194">(</span><span class="num" id="2261195">1</span><span class="op" id="2261196">)</span><span class="op" id="2261197">;</span>&nbsp;<span class="ident" id="2261199">i</span>&nbsp;<span class="op" id="2261201">&lt;</span>&nbsp;<span class="num" id="2261203">20</span><span class="op" id="2261205">;</span>&nbsp;<span class="ident" id="2261207">i</span><span class="op" id="2261208">++</span>&nbsp;<span class="op" id="2261211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261215">if</span>&nbsp;<span class="ident" id="2261218">pow</span>&nbsp;<span class="op" id="2261222">&gt;</span>&nbsp;<span class="ident" id="2261224">uint64</span><span class="op" id="2261230">(</span><span class="ident" id="2261231">integer</span><span class="op" id="2261238">)</span>&nbsp;<span class="op" id="2261240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261245">integerDigits</span>&nbsp;<span class="op" id="2261259">=</span>&nbsp;<span class="ident" id="2261261">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261266">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261278">pow</span>&nbsp;<span class="op" id="2261282">*=</span>&nbsp;<span class="num" id="2261285">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261292">rest</span>&nbsp;<span class="op" id="2261297">:=</span>&nbsp;<span class="ident" id="2261300">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261309">if</span>&nbsp;<span class="ident" id="2261312">integerDigits</span>&nbsp;<span class="op" id="2261326">&gt;</span>&nbsp;<span class="ident" id="2261328">needed</span>&nbsp;<span class="op" id="2261335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2261339">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261402">pow10</span>&nbsp;<span class="op" id="2261408">=</span>&nbsp;<span class="ident" id="2261410">uint64pow10</span><span class="op" id="2261421">[</span><span class="ident" id="2261422">integerDigits</span><span class="op" id="2261435">-</span><span class="ident" id="2261436">needed</span><span class="op" id="2261442">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261446">integer</span>&nbsp;<span class="op" id="2261454">/=</span>&nbsp;<span class="builtintype" id="2261457">uint32</span><span class="op" id="2261463">(</span><span class="ident" id="2261464">pow10</span><span class="op" id="2261469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261473">rest</span>&nbsp;<span class="op" id="2261478">-=</span>&nbsp;<span class="ident" id="2261481">integer</span>&nbsp;<span class="op" id="2261489">*</span>&nbsp;<span class="builtintype" id="2261491">uint32</span><span class="op" id="2261497">(</span><span class="ident" id="2261498">pow10</span><span class="op" id="2261503">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261506">}</span>&nbsp;<span class="keyword" id="2261508">else</span>&nbsp;<span class="op" id="2261513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261517">rest</span>&nbsp;<span class="op" id="2261522">=</span>&nbsp;<span class="num" id="2261524">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2261531">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261596">var</span>&nbsp;<span class="ident" id="2261600">buf</span>&nbsp;<span class="op" id="2261604">[</span><span class="num" id="2261605">32</span><span class="op" id="2261607">]</span><span class="builtintype" id="2261608">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261614">pos</span>&nbsp;<span class="op" id="2261618">:=</span>&nbsp;<span class="builtinfunc" id="2261621">len</span><span class="op" id="2261624">(</span><span class="ident" id="2261625">buf</span><span class="op" id="2261628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261631">for</span>&nbsp;<span class="ident" id="2261635">v</span>&nbsp;<span class="op" id="2261637">:=</span>&nbsp;<span class="ident" id="2261640">integer</span><span class="op" id="2261647">;</span>&nbsp;<span class="ident" id="2261649">v</span>&nbsp;<span class="op" id="2261651">&gt;</span>&nbsp;<span class="num" id="2261653">0</span><span class="op" id="2261654">;</span>&nbsp;<span class="op" id="2261656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261660">v1</span>&nbsp;<span class="op" id="2261663">:=</span>&nbsp;<span class="ident" id="2261666">v</span>&nbsp;<span class="op" id="2261668">/</span>&nbsp;<span class="num" id="2261670">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261675">v</span>&nbsp;<span class="op" id="2261677">-=</span>&nbsp;<span class="num" id="2261680">10</span>&nbsp;<span class="op" id="2261683">*</span>&nbsp;<span class="ident" id="2261685">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261690">pos</span><span class="op" id="2261693">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261698">buf</span><span class="op" id="2261701">[</span><span class="ident" id="2261702">pos</span><span class="op" id="2261705">]</span>&nbsp;<span class="op" id="2261707">=</span>&nbsp;<span class="builtintype" id="2261709">byte</span><span class="op" id="2261713">(</span><span class="ident" id="2261714">v</span>&nbsp;<span class="op" id="2261716">+</span>&nbsp;<span class="string" id="2261718">&#39;0&#39;</span><span class="op" id="2261721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261725">v</span>&nbsp;<span class="op" id="2261727">=</span>&nbsp;<span class="ident" id="2261729">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261736">for</span>&nbsp;<span class="ident" id="2261740">i</span>&nbsp;<span class="op" id="2261742">:=</span>&nbsp;<span class="ident" id="2261745">pos</span><span class="op" id="2261748">;</span>&nbsp;<span class="ident" id="2261750">i</span>&nbsp;<span class="op" id="2261752">&lt;</span>&nbsp;<span class="builtinfunc" id="2261754">len</span><span class="op" id="2261757">(</span><span class="ident" id="2261758">buf</span><span class="op" id="2261761">)</span><span class="op" id="2261762">;</span>&nbsp;<span class="ident" id="2261764">i</span><span class="op" id="2261765">++</span>&nbsp;<span class="op" id="2261768">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261772">d</span><span class="op" id="2261773">.</span><span class="ident" id="2261774">d</span><span class="op" id="2261775">[</span><span class="ident" id="2261776">i</span><span class="op" id="2261777">-</span><span class="ident" id="2261778">pos</span><span class="op" id="2261781">]</span>&nbsp;<span class="op" id="2261783">=</span>&nbsp;<span class="ident" id="2261785">buf</span><span class="op" id="2261788">[</span><span class="ident" id="2261789">i</span><span class="op" id="2261790">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261796">nd</span>&nbsp;<span class="op" id="2261799">:=</span>&nbsp;<span class="builtinfunc" id="2261802">len</span><span class="op" id="2261805">(</span><span class="ident" id="2261806">buf</span><span class="op" id="2261809">)</span>&nbsp;<span class="op" id="2261811">-</span>&nbsp;<span class="ident" id="2261813">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261818">d</span><span class="op" id="2261819">.</span><span class="ident" id="2261820">nd</span>&nbsp;<span class="op" id="2261823">=</span>&nbsp;<span class="ident" id="2261825">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261829">d</span><span class="op" id="2261830">.</span><span class="ident" id="2261831">dp</span>&nbsp;<span class="op" id="2261834">=</span>&nbsp;<span class="ident" id="2261836">integerDigits</span>&nbsp;<span class="op" id="2261850">+</span>&nbsp;<span class="ident" id="2261852">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2261859">needed</span>&nbsp;<span class="op" id="2261866">-=</span>&nbsp;<span class="ident" id="2261869">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261874">if</span>&nbsp;<span class="ident" id="2261877">needed</span>&nbsp;<span class="op" id="2261884">&gt;</span>&nbsp;<span class="num" id="2261886">0</span>&nbsp;<span class="op" id="2261888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2261892">if</span>&nbsp;<span class="ident" id="2261895">rest</span>&nbsp;<span class="op" id="2261900">!=</span>&nbsp;<span class="num" id="2261903">0</span>&nbsp;<span class="op" id="2261905">||</span>&nbsp;<span class="ident" id="2261908">pow10</span>&nbsp;<span class="op" id="2261914">!=</span>&nbsp;<span class="num" id="2261917">1</span>&nbsp;<span class="op" id="2261919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2261924">panic</span><span class="op" id="2261929">(</span><span class="string" id="2261930">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="2261981">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2261985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2261989">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262054">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262094">for</span>&nbsp;<span class="ident" id="2262098">needed</span>&nbsp;<span class="op" id="2262105">&gt;</span>&nbsp;<span class="num" id="2262107">0</span>&nbsp;<span class="op" id="2262109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262114">fraction</span>&nbsp;<span class="op" id="2262123">*=</span>&nbsp;<span class="num" id="2262126">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262132">ε</span>&nbsp;<span class="op" id="2262135">*=</span>&nbsp;<span class="num" id="2262138">10</span>&nbsp;<span class="comment" id="2262141">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262193">if</span>&nbsp;<span class="num" id="2262196">2</span><span class="op" id="2262197">*</span><span class="ident" id="2262198">ε</span>&nbsp;<span class="op" id="2262201">&gt;</span>&nbsp;<span class="num" id="2262203">1</span><span class="op" id="2262204">&lt;&lt;</span><span class="ident" id="2262206">shift</span>&nbsp;<span class="op" id="2262212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262218">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2262292">return</span>&nbsp;<span class="builtintype" id="2262299">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262308">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262313">digit</span>&nbsp;<span class="op" id="2262319">:=</span>&nbsp;<span class="ident" id="2262322">fraction</span>&nbsp;<span class="op" id="2262331">&gt;&gt;</span>&nbsp;<span class="ident" id="2262334">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262343">d</span><span class="op" id="2262344">.</span><span class="ident" id="2262345">d</span><span class="op" id="2262346">[</span><span class="ident" id="2262347">nd</span><span class="op" id="2262349">]</span>&nbsp;<span class="op" id="2262351">=</span>&nbsp;<span class="builtintype" id="2262353">byte</span><span class="op" id="2262357">(</span><span class="ident" id="2262358">digit</span>&nbsp;<span class="op" id="2262364">+</span>&nbsp;<span class="string" id="2262366">&#39;0&#39;</span><span class="op" id="2262369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262374">fraction</span>&nbsp;<span class="op" id="2262383">-=</span>&nbsp;<span class="ident" id="2262386">digit</span>&nbsp;<span class="op" id="2262392">&lt;&lt;</span>&nbsp;<span class="ident" id="2262395">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262404">nd</span><span class="op" id="2262406">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262412">needed</span><span class="op" id="2262418">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2262427">d</span><span class="op" id="2262428">.</span><span class="ident" id="2262429">nd</span>&nbsp;<span class="op" id="2262432">=</span>&nbsp;<span class="ident" id="2262434">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2262438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262442">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262524">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262608">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262623">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262627">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262659">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262710">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262763">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262849">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262853">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262899">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262930">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262983">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2262987">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263057">ok</span>&nbsp;<span class="op" id="2263060">:=</span>&nbsp;<span class="ident" id="2263063">adjustLastDigitFixed</span><span class="op" id="2263083">(</span><span class="ident" id="2263084">d</span><span class="op" id="2263085">,</span>&nbsp;<span class="ident" id="2263087">uint64</span><span class="op" id="2263093">(</span><span class="ident" id="2263094">rest</span><span class="op" id="2263098">)</span><span class="op" id="2263099">&lt;&lt;</span><span class="ident" id="2263101">shift</span><span class="op" id="2263106">|</span><span class="ident" id="2263107">fraction</span><span class="op" id="2263115">,</span>&nbsp;<span class="ident" id="2263117">pow10</span><span class="op" id="2263122">,</span>&nbsp;<span class="ident" id="2263124">shift</span><span class="op" id="2263129">,</span>&nbsp;<span class="ident" id="2263131">ε</span><span class="op" id="2263133">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263136">if</span>&nbsp;<span class="op" id="2263139">!</span><span class="ident" id="2263140">ok</span>&nbsp;<span class="op" id="2263143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263147">return</span>&nbsp;<span class="builtintype" id="2263154">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2263161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2263164">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263189">for</span>&nbsp;<span class="ident" id="2263193">i</span>&nbsp;<span class="op" id="2263195">:=</span>&nbsp;<span class="ident" id="2263198">d</span><span class="op" id="2263199">.</span><span class="ident" id="2263200">nd</span>&nbsp;<span class="op" id="2263203">-</span>&nbsp;<span class="num" id="2263205">1</span><span class="op" id="2263206">;</span>&nbsp;<span class="ident" id="2263208">i</span>&nbsp;<span class="op" id="2263210">&gt;=</span>&nbsp;<span class="num" id="2263213">0</span><span class="op" id="2263214">;</span>&nbsp;<span class="ident" id="2263216">i</span><span class="op" id="2263217">--</span>&nbsp;<span class="op" id="2263220">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263224">if</span>&nbsp;<span class="ident" id="2263227">d</span><span class="op" id="2263228">.</span><span class="ident" id="2263229">d</span><span class="op" id="2263230">[</span><span class="ident" id="2263231">i</span><span class="op" id="2263232">]</span>&nbsp;<span class="op" id="2263234">!=</span>&nbsp;<span class="string" id="2263237">&#39;0&#39;</span>&nbsp;<span class="op" id="2263241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263246">d</span><span class="op" id="2263247">.</span><span class="ident" id="2263248">nd</span>&nbsp;<span class="op" id="2263251">=</span>&nbsp;<span class="ident" id="2263253">i</span>&nbsp;<span class="op" id="2263255">+</span>&nbsp;<span class="num" id="2263257">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263262">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2263270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2263273">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263276">return</span>&nbsp;<span class="builtintype" id="2263283">true</span><br>
<span class="lineno"></span><span class="op" id="2263288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2263291">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="2263374">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="2263454">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2263532">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="2263553">//</span><br>
<span class="lineno"></span><span class="comment" id="2263556">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="2263641">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="2263726">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="2263766">func</span>&nbsp;<span class="ident" id="2263771">adjustLastDigitFixed</span><span class="op" id="2263791">(</span><span class="ident" id="2263792">d</span>&nbsp;<span class="op" id="2263794">*</span><span class="ident" id="2263795">decimalSlice</span><span class="op" id="2263807">,</span>&nbsp;<span class="ident" id="2263809">num</span><span class="op" id="2263812">,</span>&nbsp;<span class="ident" id="2263814">den</span>&nbsp;<span class="ident" id="2263818">uint64</span><span class="op" id="2263824">,</span>&nbsp;<span class="ident" id="2263826">shift</span>&nbsp;<span class="builtintype" id="2263832">uint</span><span class="op" id="2263836">,</span>&nbsp;<span class="ident" id="2263838">ε</span>&nbsp;<span class="ident" id="2263841">uint64</span><span class="op" id="2263847">)</span>&nbsp;<span class="builtintype" id="2263849">bool</span>&nbsp;<span class="op" id="2263854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263857">if</span>&nbsp;<span class="ident" id="2263860">num</span>&nbsp;<span class="op" id="2263864">&gt;</span>&nbsp;<span class="ident" id="2263866">den</span><span class="op" id="2263869">&lt;&lt;</span><span class="ident" id="2263871">shift</span>&nbsp;<span class="op" id="2263877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2263881">panic</span><span class="op" id="2263886">(</span><span class="string" id="2263887">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="2263938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2263941">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2263944">if</span>&nbsp;<span class="num" id="2263947">2</span><span class="op" id="2263948">*</span><span class="ident" id="2263949">ε</span>&nbsp;<span class="op" id="2263952">&gt;</span>&nbsp;<span class="ident" id="2263954">den</span><span class="op" id="2263957">&lt;&lt;</span><span class="ident" id="2263959">shift</span>&nbsp;<span class="op" id="2263965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2263969">panic</span><span class="op" id="2263974">(</span><span class="string" id="2263975">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="2264005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264011">if</span>&nbsp;<span class="num" id="2264014">2</span><span class="op" id="2264015">*</span><span class="op" id="2264016">(</span><span class="ident" id="2264017">num</span><span class="op" id="2264020">+</span><span class="ident" id="2264021">ε</span><span class="op" id="2264023">)</span>&nbsp;<span class="op" id="2264025">&lt;</span>&nbsp;<span class="ident" id="2264027">den</span><span class="op" id="2264030">&lt;&lt;</span><span class="ident" id="2264032">shift</span>&nbsp;<span class="op" id="2264038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264042">return</span>&nbsp;<span class="builtintype" id="2264049">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264058">if</span>&nbsp;<span class="num" id="2264061">2</span><span class="op" id="2264062">*</span><span class="op" id="2264063">(</span><span class="ident" id="2264064">num</span><span class="op" id="2264067">-</span><span class="ident" id="2264068">ε</span><span class="op" id="2264070">)</span>&nbsp;<span class="op" id="2264072">&gt;</span>&nbsp;<span class="ident" id="2264074">den</span><span class="op" id="2264077">&lt;&lt;</span><span class="ident" id="2264079">shift</span>&nbsp;<span class="op" id="2264085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264089">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264112">i</span>&nbsp;<span class="op" id="2264114">:=</span>&nbsp;<span class="ident" id="2264117">d</span><span class="op" id="2264118">.</span><span class="ident" id="2264119">nd</span>&nbsp;<span class="op" id="2264122">-</span>&nbsp;<span class="num" id="2264124">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264128">for</span>&nbsp;<span class="op" id="2264132">;</span>&nbsp;<span class="ident" id="2264134">i</span>&nbsp;<span class="op" id="2264136">&gt;=</span>&nbsp;<span class="num" id="2264139">0</span><span class="op" id="2264140">;</span>&nbsp;<span class="ident" id="2264142">i</span><span class="op" id="2264143">--</span>&nbsp;<span class="op" id="2264146">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264151">if</span>&nbsp;<span class="ident" id="2264154">d</span><span class="op" id="2264155">.</span><span class="ident" id="2264156">d</span><span class="op" id="2264157">[</span><span class="ident" id="2264158">i</span><span class="op" id="2264159">]</span>&nbsp;<span class="op" id="2264161">==</span>&nbsp;<span class="string" id="2264164">&#39;9&#39;</span>&nbsp;<span class="op" id="2264168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264174">d</span><span class="op" id="2264175">.</span><span class="ident" id="2264176">nd</span><span class="op" id="2264178">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264184">}</span>&nbsp;<span class="keyword" id="2264186">else</span>&nbsp;<span class="op" id="2264191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264197">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264206">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264214">if</span>&nbsp;<span class="ident" id="2264217">i</span>&nbsp;<span class="op" id="2264219">&lt;</span>&nbsp;<span class="num" id="2264221">0</span>&nbsp;<span class="op" id="2264223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264228">d</span><span class="op" id="2264229">.</span><span class="ident" id="2264230">d</span><span class="op" id="2264231">[</span><span class="num" id="2264232">0</span><span class="op" id="2264233">]</span>&nbsp;<span class="op" id="2264235">=</span>&nbsp;<span class="string" id="2264237">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264244">d</span><span class="op" id="2264245">.</span><span class="ident" id="2264246">nd</span>&nbsp;<span class="op" id="2264249">=</span>&nbsp;<span class="num" id="2264251">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264256">d</span><span class="op" id="2264257">.</span><span class="ident" id="2264258">dp</span><span class="op" id="2264260">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264265">}</span>&nbsp;<span class="keyword" id="2264267">else</span>&nbsp;<span class="op" id="2264272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264277">d</span><span class="op" id="2264278">.</span><span class="ident" id="2264279">d</span><span class="op" id="2264280">[</span><span class="ident" id="2264281">i</span><span class="op" id="2264282">]</span><span class="op" id="2264283">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264292">return</span>&nbsp;<span class="builtintype" id="2264299">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264305">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264308">return</span>&nbsp;<span class="builtintype" id="2264315">false</span><br>
<span class="lineno"></span><span class="op" id="2264321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2264324">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2264396">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="2264470">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2264548">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2264578">func</span>&nbsp;<span class="op" id="2264583">(</span><span class="ident" id="2264584">f</span>&nbsp;<span class="op" id="2264586">*</span><span class="ident" id="2264587">extFloat</span><span class="op" id="2264595">)</span>&nbsp;<span class="ident" id="2264597">ShortestDecimal</span><span class="op" id="2264612">(</span><span class="ident" id="2264613">d</span>&nbsp;<span class="op" id="2264615">*</span><span class="ident" id="2264616">decimalSlice</span><span class="op" id="2264628">,</span>&nbsp;<span class="ident" id="2264630">lower</span><span class="op" id="2264635">,</span>&nbsp;<span class="ident" id="2264637">upper</span>&nbsp;<span class="op" id="2264643">*</span><span class="ident" id="2264644">extFloat</span><span class="op" id="2264652">)</span>&nbsp;<span class="builtintype" id="2264654">bool</span>&nbsp;<span class="op" id="2264659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264662">if</span>&nbsp;<span class="ident" id="2264665">f</span><span class="op" id="2264666">.</span><span class="ident" id="2264667">mant</span>&nbsp;<span class="op" id="2264672">==</span>&nbsp;<span class="num" id="2264675">0</span>&nbsp;<span class="op" id="2264677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264681">d</span><span class="op" id="2264682">.</span><span class="ident" id="2264683">nd</span>&nbsp;<span class="op" id="2264686">=</span>&nbsp;<span class="num" id="2264688">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264692">d</span><span class="op" id="2264693">.</span><span class="ident" id="2264694">dp</span>&nbsp;<span class="op" id="2264697">=</span>&nbsp;<span class="num" id="2264699">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264703">d</span><span class="op" id="2264704">.</span><span class="ident" id="2264705">neg</span>&nbsp;<span class="op" id="2264709">=</span>&nbsp;<span class="ident" id="2264711">f</span><span class="op" id="2264712">.</span><span class="ident" id="2264713">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264719">return</span>&nbsp;<span class="builtintype" id="2264726">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264735">if</span>&nbsp;<span class="ident" id="2264738">f</span><span class="op" id="2264739">.</span><span class="ident" id="2264740">exp</span>&nbsp;<span class="op" id="2264744">==</span>&nbsp;<span class="num" id="2264747">0</span>&nbsp;<span class="op" id="2264749">&amp;&amp;</span>&nbsp;<span class="op" id="2264752">*</span><span class="ident" id="2264753">lower</span>&nbsp;<span class="op" id="2264759">==</span>&nbsp;<span class="op" id="2264762">*</span><span class="ident" id="2264763">f</span>&nbsp;<span class="op" id="2264765">&amp;&amp;</span>&nbsp;<span class="op" id="2264768">*</span><span class="ident" id="2264769">lower</span>&nbsp;<span class="op" id="2264775">==</span>&nbsp;<span class="op" id="2264778">*</span><span class="ident" id="2264779">upper</span>&nbsp;<span class="op" id="2264785">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264789">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264812">var</span>&nbsp;<span class="ident" id="2264816">buf</span>&nbsp;<span class="op" id="2264820">[</span><span class="num" id="2264821">24</span><span class="op" id="2264823">]</span><span class="builtintype" id="2264824">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264831">n</span>&nbsp;<span class="op" id="2264833">:=</span>&nbsp;<span class="builtinfunc" id="2264836">len</span><span class="op" id="2264839">(</span><span class="ident" id="2264840">buf</span><span class="op" id="2264843">)</span>&nbsp;<span class="op" id="2264845">-</span>&nbsp;<span class="num" id="2264847">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264851">for</span>&nbsp;<span class="ident" id="2264855">v</span>&nbsp;<span class="op" id="2264857">:=</span>&nbsp;<span class="ident" id="2264860">f</span><span class="op" id="2264861">.</span><span class="ident" id="2264862">mant</span><span class="op" id="2264866">;</span>&nbsp;<span class="ident" id="2264868">v</span>&nbsp;<span class="op" id="2264870">&gt;</span>&nbsp;<span class="num" id="2264872">0</span><span class="op" id="2264873">;</span>&nbsp;<span class="op" id="2264875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264880">v1</span>&nbsp;<span class="op" id="2264883">:=</span>&nbsp;<span class="ident" id="2264886">v</span>&nbsp;<span class="op" id="2264888">/</span>&nbsp;<span class="num" id="2264890">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264896">v</span>&nbsp;<span class="op" id="2264898">-=</span>&nbsp;<span class="num" id="2264901">10</span>&nbsp;<span class="op" id="2264904">*</span>&nbsp;<span class="ident" id="2264906">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264912">buf</span><span class="op" id="2264915">[</span><span class="ident" id="2264916">n</span><span class="op" id="2264917">]</span>&nbsp;<span class="op" id="2264919">=</span>&nbsp;<span class="builtintype" id="2264921">byte</span><span class="op" id="2264925">(</span><span class="ident" id="2264926">v</span>&nbsp;<span class="op" id="2264928">+</span>&nbsp;<span class="string" id="2264930">&#39;0&#39;</span><span class="op" id="2264933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264938">n</span><span class="op" id="2264939">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264945">v</span>&nbsp;<span class="op" id="2264947">=</span>&nbsp;<span class="ident" id="2264949">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2264954">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264958">nd</span>&nbsp;<span class="op" id="2264961">:=</span>&nbsp;<span class="builtinfunc" id="2264964">len</span><span class="op" id="2264967">(</span><span class="ident" id="2264968">buf</span><span class="op" id="2264971">)</span>&nbsp;<span class="op" id="2264973">-</span>&nbsp;<span class="ident" id="2264975">n</span>&nbsp;<span class="op" id="2264977">-</span>&nbsp;<span class="num" id="2264979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2264983">for</span>&nbsp;<span class="ident" id="2264987">i</span>&nbsp;<span class="op" id="2264989">:=</span>&nbsp;<span class="num" id="2264992">0</span><span class="op" id="2264993">;</span>&nbsp;<span class="ident" id="2264995">i</span>&nbsp;<span class="op" id="2264997">&lt;</span>&nbsp;<span class="ident" id="2264999">nd</span><span class="op" id="2265001">;</span>&nbsp;<span class="ident" id="2265003">i</span><span class="op" id="2265004">++</span>&nbsp;<span class="op" id="2265007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265012">d</span><span class="op" id="2265013">.</span><span class="ident" id="2265014">d</span><span class="op" id="2265015">[</span><span class="ident" id="2265016">i</span><span class="op" id="2265017">]</span>&nbsp;<span class="op" id="2265019">=</span>&nbsp;<span class="ident" id="2265021">buf</span><span class="op" id="2265024">[</span><span class="ident" id="2265025">n</span><span class="op" id="2265026">+</span><span class="num" id="2265027">1</span><span class="op" id="2265028">+</span><span class="ident" id="2265029">i</span><span class="op" id="2265030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265038">d</span><span class="op" id="2265039">.</span><span class="ident" id="2265040">nd</span><span class="op" id="2265042">,</span>&nbsp;<span class="ident" id="2265044">d</span><span class="op" id="2265045">.</span><span class="ident" id="2265046">dp</span>&nbsp;<span class="op" id="2265049">=</span>&nbsp;<span class="ident" id="2265051">nd</span><span class="op" id="2265053">,</span>&nbsp;<span class="ident" id="2265055">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265060">for</span>&nbsp;<span class="ident" id="2265064">d</span><span class="op" id="2265065">.</span><span class="ident" id="2265066">nd</span>&nbsp;<span class="op" id="2265069">&gt;</span>&nbsp;<span class="num" id="2265071">0</span>&nbsp;<span class="op" id="2265073">&amp;&amp;</span>&nbsp;<span class="ident" id="2265076">d</span><span class="op" id="2265077">.</span><span class="ident" id="2265078">d</span><span class="op" id="2265079">[</span><span class="ident" id="2265080">d</span><span class="op" id="2265081">.</span><span class="ident" id="2265082">nd</span><span class="op" id="2265084">-</span><span class="num" id="2265085">1</span><span class="op" id="2265086">]</span>&nbsp;<span class="op" id="2265088">==</span>&nbsp;<span class="string" id="2265091">&#39;0&#39;</span>&nbsp;<span class="op" id="2265095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265100">d</span><span class="op" id="2265101">.</span><span class="ident" id="2265102">nd</span><span class="op" id="2265104">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265113">if</span>&nbsp;<span class="ident" id="2265116">d</span><span class="op" id="2265117">.</span><span class="ident" id="2265118">nd</span>&nbsp;<span class="op" id="2265121">==</span>&nbsp;<span class="num" id="2265124">0</span>&nbsp;<span class="op" id="2265126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265131">d</span><span class="op" id="2265132">.</span><span class="ident" id="2265133">dp</span>&nbsp;<span class="op" id="2265136">=</span>&nbsp;<span class="num" id="2265138">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265146">d</span><span class="op" id="2265147">.</span><span class="ident" id="2265148">neg</span>&nbsp;<span class="op" id="2265152">=</span>&nbsp;<span class="ident" id="2265154">f</span><span class="op" id="2265155">.</span><span class="ident" id="2265156">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265162">return</span>&nbsp;<span class="builtintype" id="2265169">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265178">upper</span><span class="op" id="2265183">.</span><span class="ident" id="2265184">Normalize</span><span class="op" id="2265193">(</span><span class="op" id="2265194">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265197">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265223">if</span>&nbsp;<span class="ident" id="2265226">f</span><span class="op" id="2265227">.</span><span class="ident" id="2265228">exp</span>&nbsp;<span class="op" id="2265232">&gt;</span>&nbsp;<span class="ident" id="2265234">upper</span><span class="op" id="2265239">.</span><span class="ident" id="2265240">exp</span>&nbsp;<span class="op" id="2265244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265248">f</span><span class="op" id="2265249">.</span><span class="ident" id="2265250">mant</span>&nbsp;<span class="op" id="2265255">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2265259">uint</span><span class="op" id="2265263">(</span><span class="ident" id="2265264">f</span><span class="op" id="2265265">.</span><span class="ident" id="2265266">exp</span>&nbsp;<span class="op" id="2265270">-</span>&nbsp;<span class="ident" id="2265272">upper</span><span class="op" id="2265277">.</span><span class="ident" id="2265278">exp</span><span class="op" id="2265281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265285">f</span><span class="op" id="2265286">.</span><span class="ident" id="2265287">exp</span>&nbsp;<span class="op" id="2265291">=</span>&nbsp;<span class="ident" id="2265293">upper</span><span class="op" id="2265298">.</span><span class="ident" id="2265299">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265304">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2265307">if</span>&nbsp;<span class="ident" id="2265310">lower</span><span class="op" id="2265315">.</span><span class="ident" id="2265316">exp</span>&nbsp;<span class="op" id="2265320">&gt;</span>&nbsp;<span class="ident" id="2265322">upper</span><span class="op" id="2265327">.</span><span class="ident" id="2265328">exp</span>&nbsp;<span class="op" id="2265332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265336">lower</span><span class="op" id="2265341">.</span><span class="ident" id="2265342">mant</span>&nbsp;<span class="op" id="2265347">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="2265351">uint</span><span class="op" id="2265355">(</span><span class="ident" id="2265356">lower</span><span class="op" id="2265361">.</span><span class="ident" id="2265362">exp</span>&nbsp;<span class="op" id="2265366">-</span>&nbsp;<span class="ident" id="2265368">upper</span><span class="op" id="2265373">.</span><span class="ident" id="2265374">exp</span><span class="op" id="2265377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265381">lower</span><span class="op" id="2265386">.</span><span class="ident" id="2265387">exp</span>&nbsp;<span class="op" id="2265391">=</span>&nbsp;<span class="ident" id="2265393">upper</span><span class="op" id="2265398">.</span><span class="ident" id="2265399">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2265404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265408">exp10</span>&nbsp;<span class="op" id="2265414">:=</span>&nbsp;<span class="ident" id="2265417">frexp10Many</span><span class="op" id="2265428">(</span><span class="ident" id="2265429">lower</span><span class="op" id="2265434">,</span>&nbsp;<span class="ident" id="2265436">f</span><span class="op" id="2265437">,</span>&nbsp;<span class="ident" id="2265439">upper</span><span class="op" id="2265444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265447">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265527">upper</span><span class="op" id="2265532">.</span><span class="ident" id="2265533">mant</span><span class="op" id="2265537">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265541">lower</span><span class="op" id="2265546">.</span><span class="ident" id="2265547">mant</span><span class="op" id="2265551">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265556">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265627">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265673">shift</span>&nbsp;<span class="op" id="2265679">:=</span>&nbsp;<span class="builtintype" id="2265682">uint</span><span class="op" id="2265686">(</span><span class="op" id="2265687">-</span><span class="ident" id="2265688">upper</span><span class="op" id="2265693">.</span><span class="ident" id="2265694">exp</span><span class="op" id="2265697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265700">integer</span>&nbsp;<span class="op" id="2265708">:=</span>&nbsp;<span class="builtintype" id="2265711">uint32</span><span class="op" id="2265717">(</span><span class="ident" id="2265718">upper</span><span class="op" id="2265723">.</span><span class="ident" id="2265724">mant</span>&nbsp;<span class="op" id="2265729">&gt;&gt;</span>&nbsp;<span class="ident" id="2265732">shift</span><span class="op" id="2265737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265740">fraction</span>&nbsp;<span class="op" id="2265749">:=</span>&nbsp;<span class="ident" id="2265752">upper</span><span class="op" id="2265757">.</span><span class="ident" id="2265758">mant</span>&nbsp;<span class="op" id="2265763">-</span>&nbsp;<span class="op" id="2265765">(</span><span class="ident" id="2265766">uint64</span><span class="op" id="2265772">(</span><span class="ident" id="2265773">integer</span><span class="op" id="2265780">)</span>&nbsp;<span class="op" id="2265782">&lt;&lt;</span>&nbsp;<span class="ident" id="2265785">shift</span><span class="op" id="2265790">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265794">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265859">allowance</span>&nbsp;<span class="op" id="2265869">:=</span>&nbsp;<span class="ident" id="2265872">upper</span><span class="op" id="2265877">.</span><span class="ident" id="2265878">mant</span>&nbsp;<span class="op" id="2265883">-</span>&nbsp;<span class="ident" id="2265885">lower</span><span class="op" id="2265890">.</span><span class="ident" id="2265891">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265897">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265952">targetDiff</span>&nbsp;<span class="op" id="2265963">:=</span>&nbsp;<span class="ident" id="2265966">upper</span><span class="op" id="2265971">.</span><span class="ident" id="2265972">mant</span>&nbsp;<span class="op" id="2265977">-</span>&nbsp;<span class="ident" id="2265979">f</span><span class="op" id="2265980">.</span><span class="ident" id="2265981">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265988">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266037">var</span>&nbsp;<span class="ident" id="2266041">integerDigits</span>&nbsp;<span class="builtintype" id="2266055">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266060">for</span>&nbsp;<span class="ident" id="2266064">i</span><span class="op" id="2266065">,</span>&nbsp;<span class="ident" id="2266067">pow</span>&nbsp;<span class="op" id="2266071">:=</span>&nbsp;<span class="num" id="2266074">0</span><span class="op" id="2266075">,</span>&nbsp;<span class="ident" id="2266077">uint64</span><span class="op" id="2266083">(</span><span class="num" id="2266084">1</span><span class="op" id="2266085">)</span><span class="op" id="2266086">;</span>&nbsp;<span class="ident" id="2266088">i</span>&nbsp;<span class="op" id="2266090">&lt;</span>&nbsp;<span class="num" id="2266092">20</span><span class="op" id="2266094">;</span>&nbsp;<span class="ident" id="2266096">i</span><span class="op" id="2266097">++</span>&nbsp;<span class="op" id="2266100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266104">if</span>&nbsp;<span class="ident" id="2266107">pow</span>&nbsp;<span class="op" id="2266111">&gt;</span>&nbsp;<span class="ident" id="2266113">uint64</span><span class="op" id="2266119">(</span><span class="ident" id="2266120">integer</span><span class="op" id="2266127">)</span>&nbsp;<span class="op" id="2266129">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266134">integerDigits</span>&nbsp;<span class="op" id="2266148">=</span>&nbsp;<span class="ident" id="2266150">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266155">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2266163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266167">pow</span>&nbsp;<span class="op" id="2266171">*=</span>&nbsp;<span class="num" id="2266174">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2266178">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266181">for</span>&nbsp;<span class="ident" id="2266185">i</span>&nbsp;<span class="op" id="2266187">:=</span>&nbsp;<span class="num" id="2266190">0</span><span class="op" id="2266191">;</span>&nbsp;<span class="ident" id="2266193">i</span>&nbsp;<span class="op" id="2266195">&lt;</span>&nbsp;<span class="ident" id="2266197">integerDigits</span><span class="op" id="2266210">;</span>&nbsp;<span class="ident" id="2266212">i</span><span class="op" id="2266213">++</span>&nbsp;<span class="op" id="2266216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266220">pow</span>&nbsp;<span class="op" id="2266224">:=</span>&nbsp;<span class="ident" id="2266227">uint64pow10</span><span class="op" id="2266238">[</span><span class="ident" id="2266239">integerDigits</span><span class="op" id="2266252">-</span><span class="ident" id="2266253">i</span><span class="op" id="2266254">-</span><span class="num" id="2266255">1</span><span class="op" id="2266256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266260">digit</span>&nbsp;<span class="op" id="2266266">:=</span>&nbsp;<span class="ident" id="2266269">integer</span>&nbsp;<span class="op" id="2266277">/</span>&nbsp;<span class="builtintype" id="2266279">uint32</span><span class="op" id="2266285">(</span><span class="ident" id="2266286">pow</span><span class="op" id="2266289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266293">d</span><span class="op" id="2266294">.</span><span class="ident" id="2266295">d</span><span class="op" id="2266296">[</span><span class="ident" id="2266297">i</span><span class="op" id="2266298">]</span>&nbsp;<span class="op" id="2266300">=</span>&nbsp;<span class="builtintype" id="2266302">byte</span><span class="op" id="2266306">(</span><span class="ident" id="2266307">digit</span>&nbsp;<span class="op" id="2266313">+</span>&nbsp;<span class="string" id="2266315">&#39;0&#39;</span><span class="op" id="2266318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266322">integer</span>&nbsp;<span class="op" id="2266330">-=</span>&nbsp;<span class="ident" id="2266333">digit</span>&nbsp;<span class="op" id="2266339">*</span>&nbsp;<span class="builtintype" id="2266341">uint32</span><span class="op" id="2266347">(</span><span class="ident" id="2266348">pow</span><span class="op" id="2266351">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266355">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266393">if</span>&nbsp;<span class="ident" id="2266396">currentDiff</span>&nbsp;<span class="op" id="2266408">:=</span>&nbsp;<span class="ident" id="2266411">uint64</span><span class="op" id="2266417">(</span><span class="ident" id="2266418">integer</span><span class="op" id="2266425">)</span><span class="op" id="2266426">&lt;&lt;</span><span class="ident" id="2266428">shift</span>&nbsp;<span class="op" id="2266434">+</span>&nbsp;<span class="ident" id="2266436">fraction</span><span class="op" id="2266444">;</span>&nbsp;<span class="ident" id="2266446">currentDiff</span>&nbsp;<span class="op" id="2266458">&lt;</span>&nbsp;<span class="ident" id="2266460">allowance</span>&nbsp;<span class="op" id="2266470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266475">d</span><span class="op" id="2266476">.</span><span class="ident" id="2266477">nd</span>&nbsp;<span class="op" id="2266480">=</span>&nbsp;<span class="ident" id="2266482">i</span>&nbsp;<span class="op" id="2266484">+</span>&nbsp;<span class="num" id="2266486">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266491">d</span><span class="op" id="2266492">.</span><span class="ident" id="2266493">dp</span>&nbsp;<span class="op" id="2266496">=</span>&nbsp;<span class="ident" id="2266498">integerDigits</span>&nbsp;<span class="op" id="2266512">+</span>&nbsp;<span class="ident" id="2266514">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266523">d</span><span class="op" id="2266524">.</span><span class="ident" id="2266525">neg</span>&nbsp;<span class="op" id="2266529">=</span>&nbsp;<span class="ident" id="2266531">f</span><span class="op" id="2266532">.</span><span class="ident" id="2266533">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266540">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266610">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266648">return</span>&nbsp;<span class="ident" id="2266655">adjustLastDigit</span><span class="op" id="2266670">(</span><span class="ident" id="2266671">d</span><span class="op" id="2266672">,</span>&nbsp;<span class="ident" id="2266674">currentDiff</span><span class="op" id="2266685">,</span>&nbsp;<span class="ident" id="2266687">targetDiff</span><span class="op" id="2266697">,</span>&nbsp;<span class="ident" id="2266699">allowance</span><span class="op" id="2266708">,</span>&nbsp;<span class="ident" id="2266710">pow</span><span class="op" id="2266713">&lt;&lt;</span><span class="ident" id="2266715">shift</span><span class="op" id="2266720">,</span>&nbsp;<span class="num" id="2266722">2</span><span class="op" id="2266723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2266727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2266730">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266733">d</span><span class="op" id="2266734">.</span><span class="ident" id="2266735">nd</span>&nbsp;<span class="op" id="2266738">=</span>&nbsp;<span class="ident" id="2266740">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266755">d</span><span class="op" id="2266756">.</span><span class="ident" id="2266757">dp</span>&nbsp;<span class="op" id="2266760">=</span>&nbsp;<span class="ident" id="2266762">d</span><span class="op" id="2266763">.</span><span class="ident" id="2266764">nd</span>&nbsp;<span class="op" id="2266767">+</span>&nbsp;<span class="ident" id="2266769">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266776">d</span><span class="op" id="2266777">.</span><span class="ident" id="2266778">neg</span>&nbsp;<span class="op" id="2266782">=</span>&nbsp;<span class="ident" id="2266784">f</span><span class="op" id="2266785">.</span><span class="ident" id="2266786">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266792">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2266866">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266942">var</span>&nbsp;<span class="ident" id="2266946">digit</span>&nbsp;<span class="builtintype" id="2266952">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266957">multiplier</span>&nbsp;<span class="op" id="2266968">:=</span>&nbsp;<span class="ident" id="2266971">uint64</span><span class="op" id="2266977">(</span><span class="num" id="2266978">1</span><span class="op" id="2266979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266982">for</span>&nbsp;<span class="op" id="2266986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266990">fraction</span>&nbsp;<span class="op" id="2266999">*=</span>&nbsp;<span class="num" id="2267002">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267007">multiplier</span>&nbsp;<span class="op" id="2267018">*=</span>&nbsp;<span class="num" id="2267021">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267026">digit</span>&nbsp;<span class="op" id="2267032">=</span>&nbsp;<span class="builtintype" id="2267034">int</span><span class="op" id="2267037">(</span><span class="ident" id="2267038">fraction</span>&nbsp;<span class="op" id="2267047">&gt;&gt;</span>&nbsp;<span class="ident" id="2267050">shift</span><span class="op" id="2267055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267059">d</span><span class="op" id="2267060">.</span><span class="ident" id="2267061">d</span><span class="op" id="2267062">[</span><span class="ident" id="2267063">d</span><span class="op" id="2267064">.</span><span class="ident" id="2267065">nd</span><span class="op" id="2267067">]</span>&nbsp;<span class="op" id="2267069">=</span>&nbsp;<span class="builtintype" id="2267071">byte</span><span class="op" id="2267075">(</span><span class="ident" id="2267076">digit</span>&nbsp;<span class="op" id="2267082">+</span>&nbsp;<span class="string" id="2267084">&#39;0&#39;</span><span class="op" id="2267087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267091">d</span><span class="op" id="2267092">.</span><span class="ident" id="2267093">nd</span><span class="op" id="2267095">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267100">fraction</span>&nbsp;<span class="op" id="2267109">-=</span>&nbsp;<span class="ident" id="2267112">uint64</span><span class="op" id="2267118">(</span><span class="ident" id="2267119">digit</span><span class="op" id="2267124">)</span>&nbsp;<span class="op" id="2267126">&lt;&lt;</span>&nbsp;<span class="ident" id="2267129">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267137">if</span>&nbsp;<span class="ident" id="2267140">fraction</span>&nbsp;<span class="op" id="2267149">&lt;</span>&nbsp;<span class="ident" id="2267151">allowance</span><span class="op" id="2267160">*</span><span class="ident" id="2267161">multiplier</span>&nbsp;<span class="op" id="2267172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267177">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267250">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267327">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267376">return</span>&nbsp;<span class="ident" id="2267383">adjustLastDigit</span><span class="op" id="2267398">(</span><span class="ident" id="2267399">d</span><span class="op" id="2267400">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267406">fraction</span><span class="op" id="2267414">,</span>&nbsp;<span class="ident" id="2267416">targetDiff</span><span class="op" id="2267426">*</span><span class="ident" id="2267427">multiplier</span><span class="op" id="2267437">,</span>&nbsp;<span class="ident" id="2267439">allowance</span><span class="op" id="2267448">*</span><span class="ident" id="2267449">multiplier</span><span class="op" id="2267459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2267465">1</span><span class="op" id="2267466">&lt;&lt;</span><span class="ident" id="2267468">shift</span><span class="op" id="2267473">,</span>&nbsp;<span class="ident" id="2267475">multiplier</span><span class="op" id="2267485">*</span><span class="num" id="2267486">2</span><span class="op" id="2267487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267494">}</span><br>
<span class="lineno"></span><span class="op" id="2267496">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2267499">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2267567">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="2267635">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2267703">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="2267763">func</span>&nbsp;<span class="ident" id="2267768">adjustLastDigit</span><span class="op" id="2267783">(</span><span class="ident" id="2267784">d</span>&nbsp;<span class="op" id="2267786">*</span><span class="ident" id="2267787">decimalSlice</span><span class="op" id="2267799">,</span>&nbsp;<span class="ident" id="2267801">currentDiff</span><span class="op" id="2267812">,</span>&nbsp;<span class="ident" id="2267814">targetDiff</span><span class="op" id="2267824">,</span>&nbsp;<span class="ident" id="2267826">maxDiff</span><span class="op" id="2267833">,</span>&nbsp;<span class="ident" id="2267835">ulpDecimal</span><span class="op" id="2267845">,</span>&nbsp;<span class="ident" id="2267847">ulpBinary</span>&nbsp;<span class="ident" id="2267857">uint64</span><span class="op" id="2267863">)</span>&nbsp;<span class="builtintype" id="2267865">bool</span>&nbsp;<span class="op" id="2267870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267873">if</span>&nbsp;<span class="ident" id="2267876">ulpDecimal</span>&nbsp;<span class="op" id="2267887">&lt;</span>&nbsp;<span class="num" id="2267889">2</span><span class="op" id="2267890">*</span><span class="ident" id="2267891">ulpBinary</span>&nbsp;<span class="op" id="2267901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267905">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267937">return</span>&nbsp;<span class="builtintype" id="2267944">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267951">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267954">for</span>&nbsp;<span class="ident" id="2267958">currentDiff</span><span class="op" id="2267969">+</span><span class="ident" id="2267970">ulpDecimal</span><span class="op" id="2267980">/</span><span class="num" id="2267981">2</span><span class="op" id="2267982">+</span><span class="ident" id="2267983">ulpBinary</span>&nbsp;<span class="op" id="2267993">&lt;</span>&nbsp;<span class="ident" id="2267995">targetDiff</span>&nbsp;<span class="op" id="2268006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268010">d</span><span class="op" id="2268011">.</span><span class="ident" id="2268012">d</span><span class="op" id="2268013">[</span><span class="ident" id="2268014">d</span><span class="op" id="2268015">.</span><span class="ident" id="2268016">nd</span><span class="op" id="2268018">-</span><span class="num" id="2268019">1</span><span class="op" id="2268020">]</span><span class="op" id="2268021">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268026">currentDiff</span>&nbsp;<span class="op" id="2268038">+=</span>&nbsp;<span class="ident" id="2268041">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268056">if</span>&nbsp;<span class="ident" id="2268059">currentDiff</span><span class="op" id="2268070">+</span><span class="ident" id="2268071">ulpDecimal</span>&nbsp;<span class="op" id="2268082">&lt;=</span>&nbsp;<span class="ident" id="2268085">targetDiff</span><span class="op" id="2268095">+</span><span class="ident" id="2268096">ulpDecimal</span><span class="op" id="2268106">/</span><span class="num" id="2268107">2</span><span class="op" id="2268108">+</span><span class="ident" id="2268109">ulpBinary</span>&nbsp;<span class="op" id="2268119">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268123">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268176">return</span>&nbsp;<span class="builtintype" id="2268183">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268193">if</span>&nbsp;<span class="ident" id="2268196">currentDiff</span>&nbsp;<span class="op" id="2268208">&lt;</span>&nbsp;<span class="ident" id="2268210">ulpBinary</span>&nbsp;<span class="op" id="2268220">||</span>&nbsp;<span class="ident" id="2268223">currentDiff</span>&nbsp;<span class="op" id="2268235">&gt;</span>&nbsp;<span class="ident" id="2268237">maxDiff</span><span class="op" id="2268244">-</span><span class="ident" id="2268245">ulpBinary</span>&nbsp;<span class="op" id="2268255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268259">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268280">return</span>&nbsp;<span class="builtintype" id="2268287">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268297">if</span>&nbsp;<span class="ident" id="2268300">d</span><span class="op" id="2268301">.</span><span class="ident" id="2268302">nd</span>&nbsp;<span class="op" id="2268305">==</span>&nbsp;<span class="num" id="2268308">1</span>&nbsp;<span class="op" id="2268310">&amp;&amp;</span>&nbsp;<span class="ident" id="2268313">d</span><span class="op" id="2268314">.</span><span class="ident" id="2268315">d</span><span class="op" id="2268316">[</span><span class="num" id="2268317">0</span><span class="op" id="2268318">]</span>&nbsp;<span class="op" id="2268320">==</span>&nbsp;<span class="string" id="2268323">&#39;0&#39;</span>&nbsp;<span class="op" id="2268327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268331">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268374">d</span><span class="op" id="2268375">.</span><span class="ident" id="2268376">nd</span>&nbsp;<span class="op" id="2268379">=</span>&nbsp;<span class="num" id="2268381">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268385">d</span><span class="op" id="2268386">.</span><span class="ident" id="2268387">dp</span>&nbsp;<span class="op" id="2268390">=</span>&nbsp;<span class="num" id="2268392">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268398">return</span>&nbsp;<span class="builtintype" id="2268405">true</span><br>
<span class="lineno"></span><span class="op" id="2268410">}</span>
</div>
</body>
</html>
