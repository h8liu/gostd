<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1926813">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1926868">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1926922">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1926973">package</span>&nbsp;<span class="ident" id="1926981">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1926987">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1927027">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1927087">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="1927151">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="1927209">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1927267">//</span><br>
<span class="lineno"></span><span class="comment" id="1927270">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="1927284">//</span><br>
<span class="lineno"></span><span class="comment" id="1927287">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="1927309">//</span><br>
<span class="lineno">20</span><span class="comment" id="1927312">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1927325">//</span><br>
<span class="lineno"></span><span class="comment" id="1927328">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="1927351">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="1927368">//</span><br>
<span class="lineno">25</span><span class="comment" id="1927371">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1927387">//</span><br>
<span class="lineno"></span><span class="comment" id="1927390">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="1927467">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="1927537">//</span><br>
<span class="lineno">30</span><span class="comment" id="1927540">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="1927596">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1927646">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1927674">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="1927728">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="1927756">//</span><br>
<span class="lineno"></span><span class="comment" id="1927759">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1927772">//</span><br>
<span class="lineno"></span><span class="comment" id="1927775">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="1927815">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="1927874">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="1927935">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="1927996">//</span><br>
<span class="lineno"></span><span class="comment" id="1927999">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="1928077">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="1928153">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="1928195">//</span><br>
<span class="lineno"></span><span class="comment" id="1928198">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="1928212">//</span><br>
<span class="lineno"></span><span class="comment" id="1928215">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="1928239">//</span><br>
<span class="lineno"></span><span class="comment" id="1928242">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="1928255">//</span><br>
<span class="lineno"></span><span class="comment" id="1928258">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="1928281">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="1928298">//</span><br>
<span class="lineno"></span><span class="comment" id="1928301">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="1928317">//</span><br>
<span class="lineno"></span><span class="comment" id="1928320">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="1928397">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="1928467">//</span><br>
<span class="lineno"></span><span class="comment" id="1928470">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="1928526">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1928578">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1928606">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="1928658">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="1928686">//</span><br>
<span class="lineno"></span><span class="comment" id="1928689">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="1928702">//</span><br>
<span class="lineno"></span><span class="comment" id="1928705">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="1928745">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="1928804">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="1928865">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="1928926">//</span><br>
<span class="lineno"></span><span class="comment" id="1928929">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="1928977">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="1929041">//</span><br>
<span class="lineno"></span><span class="comment" id="1929044">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="1929105">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1929175">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="1929250">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1929317">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="1929390">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1929462">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="1929476">//</span><br>
<span class="lineno">85</span><span class="comment" id="1929479">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1929545">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="1929611">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="1929624">//</span><br>
<span class="lineno"></span><span class="comment" id="1929627">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="1929651">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1929681">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="1929701">var</span>&nbsp;<span class="ident" id="1929705">_sin</span>&nbsp;<span class="op" id="1929710">=</span>&nbsp;<span class="op" id="1929712">[</span><span class="op" id="1929713">...</span><span class="op" id="1929716">]</span><span class="builtintype" id="1929717">float64</span><span class="op" id="1929724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1929727">1.58962301576546568060E-10</span><span class="op" id="1929753">,</span>&nbsp;<span class="comment" id="1929755">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929778">-</span><span class="num" id="1929779">2.50507477628578072866E-8</span><span class="op" id="1929804">,</span>&nbsp;<span class="comment" id="1929806">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1929829">2.75573136213857245213E-6</span><span class="op" id="1929854">,</span>&nbsp;&nbsp;<span class="comment" id="1929857">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929880">-</span><span class="num" id="1929881">1.98412698295895385996E-4</span><span class="op" id="1929906">,</span>&nbsp;<span class="comment" id="1929908">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1929931">8.33333333332211858878E-3</span><span class="op" id="1929956">,</span>&nbsp;&nbsp;<span class="comment" id="1929959">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1929982">-</span><span class="num" id="1929983">1.66666666666666307295E-1</span><span class="op" id="1930008">,</span>&nbsp;<span class="comment" id="1930010">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="1930032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1930035">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="1930055">var</span>&nbsp;<span class="ident" id="1930059">_cos</span>&nbsp;<span class="op" id="1930064">=</span>&nbsp;<span class="op" id="1930066">[</span><span class="op" id="1930067">...</span><span class="op" id="1930070">]</span><span class="builtintype" id="1930071">float64</span><span class="op" id="1930078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930081">-</span><span class="num" id="1930082">1.13585365213876817300E-11</span><span class="op" id="1930108">,</span>&nbsp;<span class="comment" id="1930110">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1930133">2.08757008419747316778E-9</span><span class="op" id="1930158">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1930162">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930185">-</span><span class="num" id="1930186">2.75573141792967388112E-7</span><span class="op" id="1930211">,</span>&nbsp;&nbsp;<span class="comment" id="1930214">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1930237">2.48015872888517045348E-5</span><span class="op" id="1930262">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1930266">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930289">-</span><span class="num" id="1930290">1.38888888888730564116E-3</span><span class="op" id="1930315">,</span>&nbsp;&nbsp;<span class="comment" id="1930318">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1930341">4.16666666666665929218E-2</span><span class="op" id="1930366">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1930370">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="1930392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1930395">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1930447">//</span><br>
<span class="lineno"></span><span class="comment" id="1930450">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="1930472">//&nbsp;&nbsp;&nbsp;&nbspCos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1930492">//&nbsp;&nbsp;&nbsp;&nbspCos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1930510">func</span>&nbsp;<span class="ident" id="1930515">Cos</span><span class="op" id="1930518">(</span><span class="ident" id="1930519">x</span>&nbsp;<span class="builtintype" id="1930521">float64</span><span class="op" id="1930528">)</span>&nbsp;<span class="builtintype" id="1930530">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1930539">func</span>&nbsp;<span class="ident" id="1930544">cos</span><span class="op" id="1930547">(</span><span class="ident" id="1930548">x</span>&nbsp;<span class="builtintype" id="1930550">float64</span><span class="op" id="1930557">)</span>&nbsp;<span class="builtintype" id="1930559">float64</span>&nbsp;<span class="op" id="1930567">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930570">const</span>&nbsp;<span class="op" id="1930576">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930580">PI4A</span>&nbsp;<span class="op" id="1930585">=</span>&nbsp;<span class="num" id="1930587">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1930641">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930694">PI4B</span>&nbsp;<span class="op" id="1930699">=</span>&nbsp;<span class="num" id="1930701">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1930755">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930780">PI4C</span>&nbsp;<span class="op" id="1930785">=</span>&nbsp;<span class="num" id="1930787">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1930841">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930866">M4PI</span>&nbsp;<span class="op" id="1930871">=</span>&nbsp;<span class="num" id="1930873">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="1930927">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930939">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930957">switch</span>&nbsp;<span class="op" id="1930964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930967">case</span>&nbsp;<span class="ident" id="1930972">IsNaN</span><span class="op" id="1930977">(</span><span class="ident" id="1930978">x</span><span class="op" id="1930979">)</span>&nbsp;<span class="op" id="1930981">||</span>&nbsp;<span class="ident" id="1930984">IsInf</span><span class="op" id="1930989">(</span><span class="ident" id="1930990">x</span><span class="op" id="1930991">,</span>&nbsp;<span class="num" id="1930993">0</span><span class="op" id="1930994">)</span><span class="op" id="1930995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1930999">return</span>&nbsp;<span class="ident" id="1931006">NaN</span><span class="op" id="1931009">(</span><span class="op" id="1931010">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931017">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931044">sign</span>&nbsp;<span class="op" id="1931049">:=</span>&nbsp;<span class="builtintype" id="1931052">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931059">if</span>&nbsp;<span class="ident" id="1931062">x</span>&nbsp;<span class="op" id="1931064">&lt;</span>&nbsp;<span class="num" id="1931066">0</span>&nbsp;<span class="op" id="1931068">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931072">x</span>&nbsp;<span class="op" id="1931074">=</span>&nbsp;<span class="op" id="1931076">-</span><span class="ident" id="1931077">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931084">j</span>&nbsp;<span class="op" id="1931086">:=</span>&nbsp;<span class="ident" id="1931089">int64</span><span class="op" id="1931094">(</span><span class="ident" id="1931095">x</span>&nbsp;<span class="op" id="1931097">*</span>&nbsp;<span class="ident" id="1931099">M4PI</span><span class="op" id="1931103">)</span>&nbsp;<span class="comment" id="1931105">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931175">y</span>&nbsp;<span class="op" id="1931177">:=</span>&nbsp;<span class="builtintype" id="1931180">float64</span><span class="op" id="1931187">(</span><span class="ident" id="1931188">j</span><span class="op" id="1931189">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1931196">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931236">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931260">if</span>&nbsp;<span class="ident" id="1931263">j</span><span class="op" id="1931264">&amp;</span><span class="num" id="1931265">1</span>&nbsp;<span class="op" id="1931267">==</span>&nbsp;<span class="num" id="1931270">1</span>&nbsp;<span class="op" id="1931272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931276">j</span>&nbsp;<span class="op" id="1931278">+=</span>&nbsp;<span class="num" id="1931281">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931285">y</span>&nbsp;<span class="op" id="1931287">+=</span>&nbsp;<span class="num" id="1931290">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931296">j</span>&nbsp;<span class="op" id="1931298">&amp;=</span>&nbsp;<span class="num" id="1931301">7</span>&nbsp;<span class="comment" id="1931303">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931347">if</span>&nbsp;<span class="ident" id="1931350">j</span>&nbsp;<span class="op" id="1931352">&gt;</span>&nbsp;<span class="num" id="1931354">3</span>&nbsp;<span class="op" id="1931356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931360">j</span>&nbsp;<span class="op" id="1931362">-=</span>&nbsp;<span class="num" id="1931365">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931369">sign</span>&nbsp;<span class="op" id="1931374">=</span>&nbsp;<span class="op" id="1931376">!</span><span class="ident" id="1931377">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931386">if</span>&nbsp;<span class="ident" id="1931389">j</span>&nbsp;<span class="op" id="1931391">&gt;</span>&nbsp;<span class="num" id="1931393">1</span>&nbsp;<span class="op" id="1931395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931399">sign</span>&nbsp;<span class="op" id="1931404">=</span>&nbsp;<span class="op" id="1931406">!</span><span class="ident" id="1931407">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931417">z</span>&nbsp;<span class="op" id="1931419">:=</span>&nbsp;<span class="op" id="1931422">(</span><span class="op" id="1931423">(</span><span class="ident" id="1931424">x</span>&nbsp;<span class="op" id="1931426">-</span>&nbsp;<span class="ident" id="1931428">y</span><span class="op" id="1931429">*</span><span class="ident" id="1931430">PI4A</span><span class="op" id="1931434">)</span>&nbsp;<span class="op" id="1931436">-</span>&nbsp;<span class="ident" id="1931438">y</span><span class="op" id="1931439">*</span><span class="ident" id="1931440">PI4B</span><span class="op" id="1931444">)</span>&nbsp;<span class="op" id="1931446">-</span>&nbsp;<span class="ident" id="1931448">y</span><span class="op" id="1931449">*</span><span class="ident" id="1931450">PI4C</span>&nbsp;<span class="comment" id="1931455">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931497">zz</span>&nbsp;<span class="op" id="1931500">:=</span>&nbsp;<span class="ident" id="1931503">z</span>&nbsp;<span class="op" id="1931505">*</span>&nbsp;<span class="ident" id="1931507">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931510">if</span>&nbsp;<span class="ident" id="1931513">j</span>&nbsp;<span class="op" id="1931515">==</span>&nbsp;<span class="num" id="1931518">1</span>&nbsp;<span class="op" id="1931520">||</span>&nbsp;<span class="ident" id="1931523">j</span>&nbsp;<span class="op" id="1931525">==</span>&nbsp;<span class="num" id="1931528">2</span>&nbsp;<span class="op" id="1931530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931534">y</span>&nbsp;<span class="op" id="1931536">=</span>&nbsp;<span class="ident" id="1931538">z</span>&nbsp;<span class="op" id="1931540">+</span>&nbsp;<span class="ident" id="1931542">z</span><span class="op" id="1931543">*</span><span class="ident" id="1931544">zz</span><span class="op" id="1931546">*</span><span class="op" id="1931547">(</span><span class="op" id="1931548">(</span><span class="op" id="1931549">(</span><span class="op" id="1931550">(</span><span class="op" id="1931551">(</span><span class="op" id="1931552">(</span><span class="ident" id="1931553">_sin</span><span class="op" id="1931557">[</span><span class="num" id="1931558">0</span><span class="op" id="1931559">]</span><span class="op" id="1931560">*</span><span class="ident" id="1931561">zz</span><span class="op" id="1931563">)</span><span class="op" id="1931564">+</span><span class="ident" id="1931565">_sin</span><span class="op" id="1931569">[</span><span class="num" id="1931570">1</span><span class="op" id="1931571">]</span><span class="op" id="1931572">)</span><span class="op" id="1931573">*</span><span class="ident" id="1931574">zz</span><span class="op" id="1931576">+</span><span class="ident" id="1931577">_sin</span><span class="op" id="1931581">[</span><span class="num" id="1931582">2</span><span class="op" id="1931583">]</span><span class="op" id="1931584">)</span><span class="op" id="1931585">*</span><span class="ident" id="1931586">zz</span><span class="op" id="1931588">+</span><span class="ident" id="1931589">_sin</span><span class="op" id="1931593">[</span><span class="num" id="1931594">3</span><span class="op" id="1931595">]</span><span class="op" id="1931596">)</span><span class="op" id="1931597">*</span><span class="ident" id="1931598">zz</span><span class="op" id="1931600">+</span><span class="ident" id="1931601">_sin</span><span class="op" id="1931605">[</span><span class="num" id="1931606">4</span><span class="op" id="1931607">]</span><span class="op" id="1931608">)</span><span class="op" id="1931609">*</span><span class="ident" id="1931610">zz</span><span class="op" id="1931612">+</span><span class="ident" id="1931613">_sin</span><span class="op" id="1931617">[</span><span class="num" id="1931618">5</span><span class="op" id="1931619">]</span><span class="op" id="1931620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931623">}</span>&nbsp;<span class="keyword" id="1931625">else</span>&nbsp;<span class="op" id="1931630">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931634">y</span>&nbsp;<span class="op" id="1931636">=</span>&nbsp;<span class="num" id="1931638">1.0</span>&nbsp;<span class="op" id="1931642">-</span>&nbsp;<span class="num" id="1931644">0.5</span><span class="op" id="1931647">*</span><span class="ident" id="1931648">zz</span>&nbsp;<span class="op" id="1931651">+</span>&nbsp;<span class="ident" id="1931653">zz</span><span class="op" id="1931655">*</span><span class="ident" id="1931656">zz</span><span class="op" id="1931658">*</span><span class="op" id="1931659">(</span><span class="op" id="1931660">(</span><span class="op" id="1931661">(</span><span class="op" id="1931662">(</span><span class="op" id="1931663">(</span><span class="op" id="1931664">(</span><span class="ident" id="1931665">_cos</span><span class="op" id="1931669">[</span><span class="num" id="1931670">0</span><span class="op" id="1931671">]</span><span class="op" id="1931672">*</span><span class="ident" id="1931673">zz</span><span class="op" id="1931675">)</span><span class="op" id="1931676">+</span><span class="ident" id="1931677">_cos</span><span class="op" id="1931681">[</span><span class="num" id="1931682">1</span><span class="op" id="1931683">]</span><span class="op" id="1931684">)</span><span class="op" id="1931685">*</span><span class="ident" id="1931686">zz</span><span class="op" id="1931688">+</span><span class="ident" id="1931689">_cos</span><span class="op" id="1931693">[</span><span class="num" id="1931694">2</span><span class="op" id="1931695">]</span><span class="op" id="1931696">)</span><span class="op" id="1931697">*</span><span class="ident" id="1931698">zz</span><span class="op" id="1931700">+</span><span class="ident" id="1931701">_cos</span><span class="op" id="1931705">[</span><span class="num" id="1931706">3</span><span class="op" id="1931707">]</span><span class="op" id="1931708">)</span><span class="op" id="1931709">*</span><span class="ident" id="1931710">zz</span><span class="op" id="1931712">+</span><span class="ident" id="1931713">_cos</span><span class="op" id="1931717">[</span><span class="num" id="1931718">4</span><span class="op" id="1931719">]</span><span class="op" id="1931720">)</span><span class="op" id="1931721">*</span><span class="ident" id="1931722">zz</span><span class="op" id="1931724">+</span><span class="ident" id="1931725">_cos</span><span class="op" id="1931729">[</span><span class="num" id="1931730">5</span><span class="op" id="1931731">]</span><span class="op" id="1931732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931738">if</span>&nbsp;<span class="ident" id="1931741">sign</span>&nbsp;<span class="op" id="1931746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931750">y</span>&nbsp;<span class="op" id="1931752">=</span>&nbsp;<span class="op" id="1931754">-</span><span class="ident" id="1931755">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1931758">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931761">return</span>&nbsp;<span class="ident" id="1931768">y</span><br>
<span class="lineno"></span><span class="op" id="1931770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1931773">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1931823">//</span><br>
<span class="lineno">170</span><span class="comment" id="1931826">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1931848">//&nbsp;&nbsp;&nbsp;&nbspSin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1931866">//&nbsp;&nbsp;&nbsp;&nbspSin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1931886">//&nbsp;&nbsp;&nbsp;&nbspSin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1931904">func</span>&nbsp;<span class="ident" id="1931909">Sin</span><span class="op" id="1931912">(</span><span class="ident" id="1931913">x</span>&nbsp;<span class="builtintype" id="1931915">float64</span><span class="op" id="1931922">)</span>&nbsp;<span class="builtintype" id="1931924">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="1931933">func</span>&nbsp;<span class="ident" id="1931938">sin</span><span class="op" id="1931941">(</span><span class="ident" id="1931942">x</span>&nbsp;<span class="builtintype" id="1931944">float64</span><span class="op" id="1931951">)</span>&nbsp;<span class="builtintype" id="1931953">float64</span>&nbsp;<span class="op" id="1931961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1931964">const</span>&nbsp;<span class="op" id="1931970">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931974">PI4A</span>&nbsp;<span class="op" id="1931979">=</span>&nbsp;<span class="num" id="1931981">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932035">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932088">PI4B</span>&nbsp;<span class="op" id="1932093">=</span>&nbsp;<span class="num" id="1932095">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932149">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932174">PI4C</span>&nbsp;<span class="op" id="1932179">=</span>&nbsp;<span class="num" id="1932181">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932235">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932260">M4PI</span>&nbsp;<span class="op" id="1932265">=</span>&nbsp;<span class="num" id="1932267">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="1932321">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932333">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932351">switch</span>&nbsp;<span class="op" id="1932358">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932361">case</span>&nbsp;<span class="ident" id="1932366">x</span>&nbsp;<span class="op" id="1932368">==</span>&nbsp;<span class="num" id="1932371">0</span>&nbsp;<span class="op" id="1932373">||</span>&nbsp;<span class="ident" id="1932376">IsNaN</span><span class="op" id="1932381">(</span><span class="ident" id="1932382">x</span><span class="op" id="1932383">)</span><span class="op" id="1932384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932388">return</span>&nbsp;<span class="ident" id="1932395">x</span>&nbsp;<span class="comment" id="1932397">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932421">case</span>&nbsp;<span class="ident" id="1932426">IsInf</span><span class="op" id="1932431">(</span><span class="ident" id="1932432">x</span><span class="op" id="1932433">,</span>&nbsp;<span class="num" id="1932435">0</span><span class="op" id="1932436">)</span><span class="op" id="1932437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932441">return</span>&nbsp;<span class="ident" id="1932448">NaN</span><span class="op" id="1932451">(</span><span class="op" id="1932452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932455">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932459">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932504">sign</span>&nbsp;<span class="op" id="1932509">:=</span>&nbsp;<span class="builtintype" id="1932512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932519">if</span>&nbsp;<span class="ident" id="1932522">x</span>&nbsp;<span class="op" id="1932524">&lt;</span>&nbsp;<span class="num" id="1932526">0</span>&nbsp;<span class="op" id="1932528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932532">x</span>&nbsp;<span class="op" id="1932534">=</span>&nbsp;<span class="op" id="1932536">-</span><span class="ident" id="1932537">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932541">sign</span>&nbsp;<span class="op" id="1932546">=</span>&nbsp;<span class="builtintype" id="1932548">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932558">j</span>&nbsp;<span class="op" id="1932560">:=</span>&nbsp;<span class="ident" id="1932563">int64</span><span class="op" id="1932568">(</span><span class="ident" id="1932569">x</span>&nbsp;<span class="op" id="1932571">*</span>&nbsp;<span class="ident" id="1932573">M4PI</span><span class="op" id="1932577">)</span>&nbsp;<span class="comment" id="1932579">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932649">y</span>&nbsp;<span class="op" id="1932651">:=</span>&nbsp;<span class="builtintype" id="1932654">float64</span><span class="op" id="1932661">(</span><span class="ident" id="1932662">j</span><span class="op" id="1932663">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932670">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932710">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932734">if</span>&nbsp;<span class="ident" id="1932737">j</span><span class="op" id="1932738">&amp;</span><span class="num" id="1932739">1</span>&nbsp;<span class="op" id="1932741">==</span>&nbsp;<span class="num" id="1932744">1</span>&nbsp;<span class="op" id="1932746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932750">j</span>&nbsp;<span class="op" id="1932752">+=</span>&nbsp;<span class="num" id="1932755">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932759">y</span>&nbsp;<span class="op" id="1932761">+=</span>&nbsp;<span class="num" id="1932764">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932770">j</span>&nbsp;<span class="op" id="1932772">&amp;=</span>&nbsp;<span class="num" id="1932775">7</span>&nbsp;<span class="comment" id="1932777">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932821">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932843">if</span>&nbsp;<span class="ident" id="1932846">j</span>&nbsp;<span class="op" id="1932848">&gt;</span>&nbsp;<span class="num" id="1932850">3</span>&nbsp;<span class="op" id="1932852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932856">sign</span>&nbsp;<span class="op" id="1932861">=</span>&nbsp;<span class="op" id="1932863">!</span><span class="ident" id="1932864">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932871">j</span>&nbsp;<span class="op" id="1932873">-=</span>&nbsp;<span class="num" id="1932876">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1932879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932883">z</span>&nbsp;<span class="op" id="1932885">:=</span>&nbsp;<span class="op" id="1932888">(</span><span class="op" id="1932889">(</span><span class="ident" id="1932890">x</span>&nbsp;<span class="op" id="1932892">-</span>&nbsp;<span class="ident" id="1932894">y</span><span class="op" id="1932895">*</span><span class="ident" id="1932896">PI4A</span><span class="op" id="1932900">)</span>&nbsp;<span class="op" id="1932902">-</span>&nbsp;<span class="ident" id="1932904">y</span><span class="op" id="1932905">*</span><span class="ident" id="1932906">PI4B</span><span class="op" id="1932910">)</span>&nbsp;<span class="op" id="1932912">-</span>&nbsp;<span class="ident" id="1932914">y</span><span class="op" id="1932915">*</span><span class="ident" id="1932916">PI4C</span>&nbsp;<span class="comment" id="1932921">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932963">zz</span>&nbsp;<span class="op" id="1932966">:=</span>&nbsp;<span class="ident" id="1932969">z</span>&nbsp;<span class="op" id="1932971">*</span>&nbsp;<span class="ident" id="1932973">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1932976">if</span>&nbsp;<span class="ident" id="1932979">j</span>&nbsp;<span class="op" id="1932981">==</span>&nbsp;<span class="num" id="1932984">1</span>&nbsp;<span class="op" id="1932986">||</span>&nbsp;<span class="ident" id="1932989">j</span>&nbsp;<span class="op" id="1932991">==</span>&nbsp;<span class="num" id="1932994">2</span>&nbsp;<span class="op" id="1932996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933000">y</span>&nbsp;<span class="op" id="1933002">=</span>&nbsp;<span class="num" id="1933004">1.0</span>&nbsp;<span class="op" id="1933008">-</span>&nbsp;<span class="num" id="1933010">0.5</span><span class="op" id="1933013">*</span><span class="ident" id="1933014">zz</span>&nbsp;<span class="op" id="1933017">+</span>&nbsp;<span class="ident" id="1933019">zz</span><span class="op" id="1933021">*</span><span class="ident" id="1933022">zz</span><span class="op" id="1933024">*</span><span class="op" id="1933025">(</span><span class="op" id="1933026">(</span><span class="op" id="1933027">(</span><span class="op" id="1933028">(</span><span class="op" id="1933029">(</span><span class="op" id="1933030">(</span><span class="ident" id="1933031">_cos</span><span class="op" id="1933035">[</span><span class="num" id="1933036">0</span><span class="op" id="1933037">]</span><span class="op" id="1933038">*</span><span class="ident" id="1933039">zz</span><span class="op" id="1933041">)</span><span class="op" id="1933042">+</span><span class="ident" id="1933043">_cos</span><span class="op" id="1933047">[</span><span class="num" id="1933048">1</span><span class="op" id="1933049">]</span><span class="op" id="1933050">)</span><span class="op" id="1933051">*</span><span class="ident" id="1933052">zz</span><span class="op" id="1933054">+</span><span class="ident" id="1933055">_cos</span><span class="op" id="1933059">[</span><span class="num" id="1933060">2</span><span class="op" id="1933061">]</span><span class="op" id="1933062">)</span><span class="op" id="1933063">*</span><span class="ident" id="1933064">zz</span><span class="op" id="1933066">+</span><span class="ident" id="1933067">_cos</span><span class="op" id="1933071">[</span><span class="num" id="1933072">3</span><span class="op" id="1933073">]</span><span class="op" id="1933074">)</span><span class="op" id="1933075">*</span><span class="ident" id="1933076">zz</span><span class="op" id="1933078">+</span><span class="ident" id="1933079">_cos</span><span class="op" id="1933083">[</span><span class="num" id="1933084">4</span><span class="op" id="1933085">]</span><span class="op" id="1933086">)</span><span class="op" id="1933087">*</span><span class="ident" id="1933088">zz</span><span class="op" id="1933090">+</span><span class="ident" id="1933091">_cos</span><span class="op" id="1933095">[</span><span class="num" id="1933096">5</span><span class="op" id="1933097">]</span><span class="op" id="1933098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933101">}</span>&nbsp;<span class="keyword" id="1933103">else</span>&nbsp;<span class="op" id="1933108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933112">y</span>&nbsp;<span class="op" id="1933114">=</span>&nbsp;<span class="ident" id="1933116">z</span>&nbsp;<span class="op" id="1933118">+</span>&nbsp;<span class="ident" id="1933120">z</span><span class="op" id="1933121">*</span><span class="ident" id="1933122">zz</span><span class="op" id="1933124">*</span><span class="op" id="1933125">(</span><span class="op" id="1933126">(</span><span class="op" id="1933127">(</span><span class="op" id="1933128">(</span><span class="op" id="1933129">(</span><span class="op" id="1933130">(</span><span class="ident" id="1933131">_sin</span><span class="op" id="1933135">[</span><span class="num" id="1933136">0</span><span class="op" id="1933137">]</span><span class="op" id="1933138">*</span><span class="ident" id="1933139">zz</span><span class="op" id="1933141">)</span><span class="op" id="1933142">+</span><span class="ident" id="1933143">_sin</span><span class="op" id="1933147">[</span><span class="num" id="1933148">1</span><span class="op" id="1933149">]</span><span class="op" id="1933150">)</span><span class="op" id="1933151">*</span><span class="ident" id="1933152">zz</span><span class="op" id="1933154">+</span><span class="ident" id="1933155">_sin</span><span class="op" id="1933159">[</span><span class="num" id="1933160">2</span><span class="op" id="1933161">]</span><span class="op" id="1933162">)</span><span class="op" id="1933163">*</span><span class="ident" id="1933164">zz</span><span class="op" id="1933166">+</span><span class="ident" id="1933167">_sin</span><span class="op" id="1933171">[</span><span class="num" id="1933172">3</span><span class="op" id="1933173">]</span><span class="op" id="1933174">)</span><span class="op" id="1933175">*</span><span class="ident" id="1933176">zz</span><span class="op" id="1933178">+</span><span class="ident" id="1933179">_sin</span><span class="op" id="1933183">[</span><span class="num" id="1933184">4</span><span class="op" id="1933185">]</span><span class="op" id="1933186">)</span><span class="op" id="1933187">*</span><span class="ident" id="1933188">zz</span><span class="op" id="1933190">+</span><span class="ident" id="1933191">_sin</span><span class="op" id="1933195">[</span><span class="num" id="1933196">5</span><span class="op" id="1933197">]</span><span class="op" id="1933198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933201">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933204">if</span>&nbsp;<span class="ident" id="1933207">sign</span>&nbsp;<span class="op" id="1933212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933216">y</span>&nbsp;<span class="op" id="1933218">=</span>&nbsp;<span class="op" id="1933220">-</span><span class="ident" id="1933221">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933227">return</span>&nbsp;<span class="ident" id="1933234">y</span><br>
<span class="lineno"></span><span class="op" id="1933236">}</span>
</div>
</body>
</html>
