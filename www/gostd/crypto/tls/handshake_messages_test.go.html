<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html" class="current">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8269923">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8269978">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8270032">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8270083">package</span>&nbsp;<span class="ident" id="8270091">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8270096">import</span>&nbsp;<span class="op" id="8270103">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8270106">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8270119">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8270130">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8270141">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8270157">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8270160">var</span>&nbsp;<span class="ident" id="8270164">tests</span>&nbsp;<span class="op" id="8270170">=</span>&nbsp;<span class="op" id="8270172">[</span><span class="op" id="8270173">]</span><span class="keyword" id="8270174">interface</span><span class="op" id="8270183">{</span><span class="op" id="8270184">}</span><span class="op" id="8270185">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270188">&amp;</span><span class="ident" id="8270189">clientHelloMsg</span><span class="op" id="8270203">{</span><span class="op" id="8270204">}</span><span class="op" id="8270205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270208">&amp;</span><span class="ident" id="8270209">serverHelloMsg</span><span class="op" id="8270223">{</span><span class="op" id="8270224">}</span><span class="op" id="8270225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270228">&amp;</span><span class="ident" id="8270229">finishedMsg</span><span class="op" id="8270240">{</span><span class="op" id="8270241">}</span><span class="op" id="8270242">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270246">&amp;</span><span class="ident" id="8270247">certificateMsg</span><span class="op" id="8270261">{</span><span class="op" id="8270262">}</span><span class="op" id="8270263">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270266">&amp;</span><span class="ident" id="8270267">certificateRequestMsg</span><span class="op" id="8270288">{</span><span class="op" id="8270289">}</span><span class="op" id="8270290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270293">&amp;</span><span class="ident" id="8270294">certificateVerifyMsg</span><span class="op" id="8270314">{</span><span class="op" id="8270315">}</span><span class="op" id="8270316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270319">&amp;</span><span class="ident" id="8270320">certificateStatusMsg</span><span class="op" id="8270340">{</span><span class="op" id="8270341">}</span><span class="op" id="8270342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270345">&amp;</span><span class="ident" id="8270346">clientKeyExchangeMsg</span><span class="op" id="8270366">{</span><span class="op" id="8270367">}</span><span class="op" id="8270368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270371">&amp;</span><span class="ident" id="8270372">nextProtoMsg</span><span class="op" id="8270384">{</span><span class="op" id="8270385">}</span><span class="op" id="8270386">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270389">&amp;</span><span class="ident" id="8270390">newSessionTicketMsg</span><span class="op" id="8270409">{</span><span class="op" id="8270410">}</span><span class="op" id="8270411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270414">&amp;</span><span class="ident" id="8270415">sessionState</span><span class="op" id="8270427">{</span><span class="op" id="8270428">}</span><span class="op" id="8270429">,</span><br>
<span class="lineno"></span><span class="op" id="8270431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8270434">type</span>&nbsp;<span class="ident" id="8270439">testMessage</span>&nbsp;<span class="keyword" id="8270451">interface</span>&nbsp;<span class="op" id="8270461">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270464">marshal</span><span class="op" id="8270471">(</span><span class="op" id="8270472">)</span>&nbsp;<span class="op" id="8270474">[</span><span class="op" id="8270475">]</span><span class="builtintype" id="8270476">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270482">unmarshal</span><span class="op" id="8270491">(</span><span class="op" id="8270492">[</span><span class="op" id="8270493">]</span><span class="builtintype" id="8270494">byte</span><span class="op" id="8270498">)</span>&nbsp;<span class="builtintype" id="8270500">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270506">equal</span><span class="op" id="8270511">(</span><span class="keyword" id="8270512">interface</span><span class="op" id="8270521">{</span><span class="op" id="8270522">}</span><span class="op" id="8270523">)</span>&nbsp;<span class="builtintype" id="8270525">bool</span><br>
<span class="lineno"></span><span class="op" id="8270530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8270533">func</span>&nbsp;<span class="ident" id="8270538">TestMarshalUnmarshal</span><span class="op" id="8270558">(</span><span class="ident" id="8270559">t</span>&nbsp;<span class="op" id="8270561">*</span><span class="ident" id="8270562">testing</span><span class="op" id="8270569">.</span><span class="ident" id="8270570">T</span><span class="op" id="8270571">)</span>&nbsp;<span class="op" id="8270573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270576">rand</span>&nbsp;<span class="op" id="8270581">:=</span>&nbsp;<span class="ident" id="8270584">rand</span><span class="op" id="8270588">.</span><span class="ident" id="8270589">New</span><span class="op" id="8270592">(</span><span class="ident" id="8270593">rand</span><span class="op" id="8270597">.</span><span class="ident" id="8270598">NewSource</span><span class="op" id="8270607">(</span><span class="num" id="8270608">0</span><span class="op" id="8270609">)</span><span class="op" id="8270610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270614">for</span>&nbsp;<span class="ident" id="8270618">i</span><span class="op" id="8270619">,</span>&nbsp;<span class="ident" id="8270621">iface</span>&nbsp;<span class="op" id="8270627">:=</span>&nbsp;<span class="keyword" id="8270630">range</span>&nbsp;<span class="ident" id="8270636">tests</span>&nbsp;<span class="op" id="8270642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270646">ty</span>&nbsp;<span class="op" id="8270649">:=</span>&nbsp;<span class="ident" id="8270652">reflect</span><span class="op" id="8270659">.</span><span class="ident" id="8270660">ValueOf</span><span class="op" id="8270667">(</span><span class="ident" id="8270668">iface</span><span class="op" id="8270673">)</span><span class="op" id="8270674">.</span><span class="ident" id="8270675">Type</span><span class="op" id="8270679">(</span><span class="op" id="8270680">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270685">n</span>&nbsp;<span class="op" id="8270687">:=</span>&nbsp;<span class="num" id="8270690">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270696">if</span>&nbsp;<span class="ident" id="8270699">testing</span><span class="op" id="8270706">.</span><span class="ident" id="8270707">Short</span><span class="op" id="8270712">(</span><span class="op" id="8270713">)</span>&nbsp;<span class="op" id="8270715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270720">n</span>&nbsp;<span class="op" id="8270722">=</span>&nbsp;<span class="num" id="8270724">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270728">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270732">for</span>&nbsp;<span class="ident" id="8270736">j</span>&nbsp;<span class="op" id="8270738">:=</span>&nbsp;<span class="num" id="8270741">0</span><span class="op" id="8270742">;</span>&nbsp;<span class="ident" id="8270744">j</span>&nbsp;<span class="op" id="8270746">&lt;</span>&nbsp;<span class="ident" id="8270748">n</span><span class="op" id="8270749">;</span>&nbsp;<span class="ident" id="8270751">j</span><span class="op" id="8270752">++</span>&nbsp;<span class="op" id="8270755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270760">v</span><span class="op" id="8270761">,</span>&nbsp;<span class="ident" id="8270763">ok</span>&nbsp;<span class="op" id="8270766">:=</span>&nbsp;<span class="ident" id="8270769">quick</span><span class="op" id="8270774">.</span><span class="ident" id="8270775">Value</span><span class="op" id="8270780">(</span><span class="ident" id="8270781">ty</span><span class="op" id="8270783">,</span>&nbsp;<span class="ident" id="8270785">rand</span><span class="op" id="8270789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270794">if</span>&nbsp;<span class="op" id="8270797">!</span><span class="ident" id="8270798">ok</span>&nbsp;<span class="op" id="8270801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270807">t</span><span class="op" id="8270808">.</span><span class="ident" id="8270809">Errorf</span><span class="op" id="8270815">(</span><span class="string" id="8270816">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="8270845">,</span>&nbsp;<span class="ident" id="8270847">i</span><span class="op" id="8270848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270854">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270869">m1</span>&nbsp;<span class="op" id="8270872">:=</span>&nbsp;<span class="ident" id="8270875">v</span><span class="op" id="8270876">.</span><span class="ident" id="8270877">Interface</span><span class="op" id="8270886">(</span><span class="op" id="8270887">)</span><span class="op" id="8270888">.</span><span class="op" id="8270889">(</span><span class="ident" id="8270890">testMessage</span><span class="op" id="8270901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270906">marshaled</span>&nbsp;<span class="op" id="8270916">:=</span>&nbsp;<span class="ident" id="8270919">m1</span><span class="op" id="8270921">.</span><span class="ident" id="8270922">marshal</span><span class="op" id="8270929">(</span><span class="op" id="8270930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270935">m2</span>&nbsp;<span class="op" id="8270938">:=</span>&nbsp;<span class="ident" id="8270941">iface</span><span class="op" id="8270946">.</span><span class="op" id="8270947">(</span><span class="ident" id="8270948">testMessage</span><span class="op" id="8270959">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270964">if</span>&nbsp;<span class="op" id="8270967">!</span><span class="ident" id="8270968">m2</span><span class="op" id="8270970">.</span><span class="ident" id="8270971">unmarshal</span><span class="op" id="8270980">(</span><span class="ident" id="8270981">marshaled</span><span class="op" id="8270990">)</span>&nbsp;<span class="op" id="8270992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270998">t</span><span class="op" id="8270999">.</span><span class="ident" id="8271000">Errorf</span><span class="op" id="8271006">(</span><span class="string" id="8271007">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="8271039">,</span>&nbsp;<span class="ident" id="8271041">i</span><span class="op" id="8271042">,</span>&nbsp;<span class="ident" id="8271044">m1</span><span class="op" id="8271046">,</span>&nbsp;<span class="ident" id="8271048">marshaled</span><span class="op" id="8271057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271063">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271077">m2</span><span class="op" id="8271079">.</span><span class="ident" id="8271080">marshal</span><span class="op" id="8271087">(</span><span class="op" id="8271088">)</span>&nbsp;<span class="comment" id="8271090">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271138">if</span>&nbsp;<span class="op" id="8271141">!</span><span class="ident" id="8271142">m1</span><span class="op" id="8271144">.</span><span class="ident" id="8271145">equal</span><span class="op" id="8271150">(</span><span class="ident" id="8271151">m2</span><span class="op" id="8271153">)</span>&nbsp;<span class="op" id="8271155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271161">t</span><span class="op" id="8271162">.</span><span class="ident" id="8271163">Errorf</span><span class="op" id="8271169">(</span><span class="string" id="8271170">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="8271195">,</span>&nbsp;<span class="ident" id="8271197">i</span><span class="op" id="8271198">,</span>&nbsp;<span class="ident" id="8271200">m2</span><span class="op" id="8271202">,</span>&nbsp;<span class="ident" id="8271204">m1</span><span class="op" id="8271206">,</span>&nbsp;<span class="ident" id="8271208">marshaled</span><span class="op" id="8271217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271223">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271232">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271238">if</span>&nbsp;<span class="ident" id="8271241">i</span>&nbsp;<span class="op" id="8271243">&gt;=</span>&nbsp;<span class="num" id="8271246">3</span>&nbsp;<span class="op" id="8271248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271254">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271305">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271353">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271405">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271451">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271491">for</span>&nbsp;<span class="ident" id="8271495">j</span>&nbsp;<span class="op" id="8271497">:=</span>&nbsp;<span class="num" id="8271500">0</span><span class="op" id="8271501">;</span>&nbsp;<span class="ident" id="8271503">j</span>&nbsp;<span class="op" id="8271505">&lt;</span>&nbsp;<span class="builtinfunc" id="8271507">len</span><span class="op" id="8271510">(</span><span class="ident" id="8271511">marshaled</span><span class="op" id="8271520">)</span><span class="op" id="8271521">;</span>&nbsp;<span class="ident" id="8271523">j</span><span class="op" id="8271524">++</span>&nbsp;<span class="op" id="8271527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271534">if</span>&nbsp;<span class="ident" id="8271537">m2</span><span class="op" id="8271539">.</span><span class="ident" id="8271540">unmarshal</span><span class="op" id="8271549">(</span><span class="ident" id="8271550">marshaled</span><span class="op" id="8271559">[</span><span class="num" id="8271560">0</span><span class="op" id="8271561">:</span><span class="ident" id="8271562">j</span><span class="op" id="8271563">]</span><span class="op" id="8271564">)</span>&nbsp;<span class="op" id="8271566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271574">t</span><span class="op" id="8271575">.</span><span class="ident" id="8271576">Errorf</span><span class="op" id="8271582">(</span><span class="string" id="8271583">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="8271629">,</span>&nbsp;<span class="ident" id="8271631">i</span><span class="op" id="8271632">,</span>&nbsp;<span class="ident" id="8271634">j</span><span class="op" id="8271635">,</span>&nbsp;<span class="ident" id="8271637">m1</span><span class="op" id="8271639">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271647">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271673">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271676">}</span><br>
<span class="lineno"></span><span class="op" id="8271678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8271681">func</span>&nbsp;<span class="ident" id="8271686">TestFuzz</span><span class="op" id="8271694">(</span><span class="ident" id="8271695">t</span>&nbsp;<span class="op" id="8271697">*</span><span class="ident" id="8271698">testing</span><span class="op" id="8271705">.</span><span class="ident" id="8271706">T</span><span class="op" id="8271707">)</span>&nbsp;<span class="op" id="8271709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271712">rand</span>&nbsp;<span class="op" id="8271717">:=</span>&nbsp;<span class="ident" id="8271720">rand</span><span class="op" id="8271724">.</span><span class="ident" id="8271725">New</span><span class="op" id="8271728">(</span><span class="ident" id="8271729">rand</span><span class="op" id="8271733">.</span><span class="ident" id="8271734">NewSource</span><span class="op" id="8271743">(</span><span class="num" id="8271744">0</span><span class="op" id="8271745">)</span><span class="op" id="8271746">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271749">for</span>&nbsp;<span class="ident" id="8271753">_</span><span class="op" id="8271754">,</span>&nbsp;<span class="ident" id="8271756">iface</span>&nbsp;<span class="op" id="8271762">:=</span>&nbsp;<span class="keyword" id="8271765">range</span>&nbsp;<span class="ident" id="8271771">tests</span>&nbsp;<span class="op" id="8271777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271781">m</span>&nbsp;<span class="op" id="8271783">:=</span>&nbsp;<span class="ident" id="8271786">iface</span><span class="op" id="8271791">.</span><span class="op" id="8271792">(</span><span class="ident" id="8271793">testMessage</span><span class="op" id="8271804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271809">for</span>&nbsp;<span class="ident" id="8271813">j</span>&nbsp;<span class="op" id="8271815">:=</span>&nbsp;<span class="num" id="8271818">0</span><span class="op" id="8271819">;</span>&nbsp;<span class="ident" id="8271821">j</span>&nbsp;<span class="op" id="8271823">&lt;</span>&nbsp;<span class="num" id="8271825">1000</span><span class="op" id="8271829">;</span>&nbsp;<span class="ident" id="8271831">j</span><span class="op" id="8271832">++</span>&nbsp;<span class="op" id="8271835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8271840">len</span>&nbsp;<span class="op" id="8271844">:=</span>&nbsp;<span class="ident" id="8271847">rand</span><span class="op" id="8271851">.</span><span class="ident" id="8271852">Intn</span><span class="op" id="8271856">(</span><span class="num" id="8271857">100</span><span class="op" id="8271860">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271865">bytes</span>&nbsp;<span class="op" id="8271871">:=</span>&nbsp;<span class="ident" id="8271874">randomBytes</span><span class="op" id="8271885">(</span><span class="builtinfunc" id="8271886">len</span><span class="op" id="8271889">,</span>&nbsp;<span class="ident" id="8271891">rand</span><span class="op" id="8271895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271900">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271960">m</span><span class="op" id="8271961">.</span><span class="ident" id="8271962">unmarshal</span><span class="op" id="8271971">(</span><span class="ident" id="8271972">bytes</span><span class="op" id="8271977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271984">}</span><br>
<span class="lineno">95</span><span class="op" id="8271986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8271989">func</span>&nbsp;<span class="ident" id="8271994">randomBytes</span><span class="op" id="8272005">(</span><span class="ident" id="8272006">n</span>&nbsp;<span class="builtintype" id="8272008">int</span><span class="op" id="8272011">,</span>&nbsp;<span class="ident" id="8272013">rand</span>&nbsp;<span class="op" id="8272018">*</span><span class="ident" id="8272019">rand</span><span class="op" id="8272023">.</span><span class="ident" id="8272024">Rand</span><span class="op" id="8272028">)</span>&nbsp;<span class="op" id="8272030">[</span><span class="op" id="8272031">]</span><span class="builtintype" id="8272032">byte</span>&nbsp;<span class="op" id="8272037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272040">r</span>&nbsp;<span class="op" id="8272042">:=</span>&nbsp;<span class="builtinfunc" id="8272045">make</span><span class="op" id="8272049">(</span><span class="op" id="8272050">[</span><span class="op" id="8272051">]</span><span class="builtintype" id="8272052">byte</span><span class="op" id="8272056">,</span>&nbsp;<span class="ident" id="8272058">n</span><span class="op" id="8272059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272062">for</span>&nbsp;<span class="ident" id="8272066">i</span>&nbsp;<span class="op" id="8272068">:=</span>&nbsp;<span class="num" id="8272071">0</span><span class="op" id="8272072">;</span>&nbsp;<span class="ident" id="8272074">i</span>&nbsp;<span class="op" id="8272076">&lt;</span>&nbsp;<span class="ident" id="8272078">n</span><span class="op" id="8272079">;</span>&nbsp;<span class="ident" id="8272081">i</span><span class="op" id="8272082">++</span>&nbsp;<span class="op" id="8272085">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272089">r</span><span class="op" id="8272090">[</span><span class="ident" id="8272091">i</span><span class="op" id="8272092">]</span>&nbsp;<span class="op" id="8272094">=</span>&nbsp;<span class="builtintype" id="8272096">byte</span><span class="op" id="8272100">(</span><span class="ident" id="8272101">rand</span><span class="op" id="8272105">.</span><span class="ident" id="8272106">Int31</span><span class="op" id="8272111">(</span><span class="op" id="8272112">)</span><span class="op" id="8272113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272119">return</span>&nbsp;<span class="ident" id="8272126">r</span><br>
<span class="lineno"></span><span class="op" id="8272128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="8272131">func</span>&nbsp;<span class="ident" id="8272136">randomString</span><span class="op" id="8272148">(</span><span class="ident" id="8272149">n</span>&nbsp;<span class="builtintype" id="8272151">int</span><span class="op" id="8272154">,</span>&nbsp;<span class="ident" id="8272156">rand</span>&nbsp;<span class="op" id="8272161">*</span><span class="ident" id="8272162">rand</span><span class="op" id="8272166">.</span><span class="ident" id="8272167">Rand</span><span class="op" id="8272171">)</span>&nbsp;<span class="builtintype" id="8272173">string</span>&nbsp;<span class="op" id="8272180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272183">b</span>&nbsp;<span class="op" id="8272185">:=</span>&nbsp;<span class="ident" id="8272188">randomBytes</span><span class="op" id="8272199">(</span><span class="ident" id="8272200">n</span><span class="op" id="8272201">,</span>&nbsp;<span class="ident" id="8272203">rand</span><span class="op" id="8272207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272210">return</span>&nbsp;<span class="builtintype" id="8272217">string</span><span class="op" id="8272223">(</span><span class="ident" id="8272224">b</span><span class="op" id="8272225">)</span><br>
<span class="lineno"></span><span class="op" id="8272227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8272230">func</span>&nbsp;<span class="op" id="8272235">(</span><span class="op" id="8272236">*</span><span class="ident" id="8272237">clientHelloMsg</span><span class="op" id="8272251">)</span>&nbsp;<span class="ident" id="8272253">Generate</span><span class="op" id="8272261">(</span><span class="ident" id="8272262">rand</span>&nbsp;<span class="op" id="8272267">*</span><span class="ident" id="8272268">rand</span><span class="op" id="8272272">.</span><span class="ident" id="8272273">Rand</span><span class="op" id="8272277">,</span>&nbsp;<span class="ident" id="8272279">size</span>&nbsp;<span class="builtintype" id="8272284">int</span><span class="op" id="8272287">)</span>&nbsp;<span class="ident" id="8272289">reflect</span><span class="op" id="8272296">.</span><span class="ident" id="8272297">Value</span>&nbsp;<span class="op" id="8272303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272306">m</span>&nbsp;<span class="op" id="8272308">:=</span>&nbsp;<span class="op" id="8272311">&amp;</span><span class="ident" id="8272312">clientHelloMsg</span><span class="op" id="8272326">{</span><span class="op" id="8272327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272330">m</span><span class="op" id="8272331">.</span><span class="ident" id="8272332">vers</span>&nbsp;<span class="op" id="8272337">=</span>&nbsp;<span class="builtintype" id="8272339">uint16</span><span class="op" id="8272345">(</span><span class="ident" id="8272346">rand</span><span class="op" id="8272350">.</span><span class="ident" id="8272351">Intn</span><span class="op" id="8272355">(</span><span class="num" id="8272356">65536</span><span class="op" id="8272361">)</span><span class="op" id="8272362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272365">m</span><span class="op" id="8272366">.</span><span class="ident" id="8272367">random</span>&nbsp;<span class="op" id="8272374">=</span>&nbsp;<span class="ident" id="8272376">randomBytes</span><span class="op" id="8272387">(</span><span class="num" id="8272388">32</span><span class="op" id="8272390">,</span>&nbsp;<span class="ident" id="8272392">rand</span><span class="op" id="8272396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272399">m</span><span class="op" id="8272400">.</span><span class="ident" id="8272401">sessionId</span>&nbsp;<span class="op" id="8272411">=</span>&nbsp;<span class="ident" id="8272413">randomBytes</span><span class="op" id="8272424">(</span><span class="ident" id="8272425">rand</span><span class="op" id="8272429">.</span><span class="ident" id="8272430">Intn</span><span class="op" id="8272434">(</span><span class="num" id="8272435">32</span><span class="op" id="8272437">)</span><span class="op" id="8272438">,</span>&nbsp;<span class="ident" id="8272440">rand</span><span class="op" id="8272444">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272447">m</span><span class="op" id="8272448">.</span><span class="ident" id="8272449">cipherSuites</span>&nbsp;<span class="op" id="8272462">=</span>&nbsp;<span class="builtinfunc" id="8272464">make</span><span class="op" id="8272468">(</span><span class="op" id="8272469">[</span><span class="op" id="8272470">]</span><span class="builtintype" id="8272471">uint16</span><span class="op" id="8272477">,</span>&nbsp;<span class="ident" id="8272479">rand</span><span class="op" id="8272483">.</span><span class="ident" id="8272484">Intn</span><span class="op" id="8272488">(</span><span class="num" id="8272489">63</span><span class="op" id="8272491">)</span><span class="op" id="8272492">+</span><span class="num" id="8272493">1</span><span class="op" id="8272494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272497">for</span>&nbsp;<span class="ident" id="8272501">i</span>&nbsp;<span class="op" id="8272503">:=</span>&nbsp;<span class="num" id="8272506">0</span><span class="op" id="8272507">;</span>&nbsp;<span class="ident" id="8272509">i</span>&nbsp;<span class="op" id="8272511">&lt;</span>&nbsp;<span class="builtinfunc" id="8272513">len</span><span class="op" id="8272516">(</span><span class="ident" id="8272517">m</span><span class="op" id="8272518">.</span><span class="ident" id="8272519">cipherSuites</span><span class="op" id="8272531">)</span><span class="op" id="8272532">;</span>&nbsp;<span class="ident" id="8272534">i</span><span class="op" id="8272535">++</span>&nbsp;<span class="op" id="8272538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272542">m</span><span class="op" id="8272543">.</span><span class="ident" id="8272544">cipherSuites</span><span class="op" id="8272556">[</span><span class="ident" id="8272557">i</span><span class="op" id="8272558">]</span>&nbsp;<span class="op" id="8272560">=</span>&nbsp;<span class="builtintype" id="8272562">uint16</span><span class="op" id="8272568">(</span><span class="ident" id="8272569">rand</span><span class="op" id="8272573">.</span><span class="ident" id="8272574">Int31</span><span class="op" id="8272579">(</span><span class="op" id="8272580">)</span><span class="op" id="8272581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272587">m</span><span class="op" id="8272588">.</span><span class="ident" id="8272589">compressionMethods</span>&nbsp;<span class="op" id="8272608">=</span>&nbsp;<span class="ident" id="8272610">randomBytes</span><span class="op" id="8272621">(</span><span class="ident" id="8272622">rand</span><span class="op" id="8272626">.</span><span class="ident" id="8272627">Intn</span><span class="op" id="8272631">(</span><span class="num" id="8272632">63</span><span class="op" id="8272634">)</span><span class="op" id="8272635">+</span><span class="num" id="8272636">1</span><span class="op" id="8272637">,</span>&nbsp;<span class="ident" id="8272639">rand</span><span class="op" id="8272643">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272646">if</span>&nbsp;<span class="ident" id="8272649">rand</span><span class="op" id="8272653">.</span><span class="ident" id="8272654">Intn</span><span class="op" id="8272658">(</span><span class="num" id="8272659">10</span><span class="op" id="8272661">)</span>&nbsp;<span class="op" id="8272663">&gt;</span>&nbsp;<span class="num" id="8272665">5</span>&nbsp;<span class="op" id="8272667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272671">m</span><span class="op" id="8272672">.</span><span class="ident" id="8272673">nextProtoNeg</span>&nbsp;<span class="op" id="8272686">=</span>&nbsp;<span class="builtintype" id="8272688">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272697">if</span>&nbsp;<span class="ident" id="8272700">rand</span><span class="op" id="8272704">.</span><span class="ident" id="8272705">Intn</span><span class="op" id="8272709">(</span><span class="num" id="8272710">10</span><span class="op" id="8272712">)</span>&nbsp;<span class="op" id="8272714">&gt;</span>&nbsp;<span class="num" id="8272716">5</span>&nbsp;<span class="op" id="8272718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272722">m</span><span class="op" id="8272723">.</span><span class="ident" id="8272724">serverName</span>&nbsp;<span class="op" id="8272735">=</span>&nbsp;<span class="ident" id="8272737">randomString</span><span class="op" id="8272749">(</span><span class="ident" id="8272750">rand</span><span class="op" id="8272754">.</span><span class="ident" id="8272755">Intn</span><span class="op" id="8272759">(</span><span class="num" id="8272760">255</span><span class="op" id="8272763">)</span><span class="op" id="8272764">,</span>&nbsp;<span class="ident" id="8272766">rand</span><span class="op" id="8272770">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272776">m</span><span class="op" id="8272777">.</span><span class="ident" id="8272778">ocspStapling</span>&nbsp;<span class="op" id="8272791">=</span>&nbsp;<span class="ident" id="8272793">rand</span><span class="op" id="8272797">.</span><span class="ident" id="8272798">Intn</span><span class="op" id="8272802">(</span><span class="num" id="8272803">10</span><span class="op" id="8272805">)</span>&nbsp;<span class="op" id="8272807">&gt;</span>&nbsp;<span class="num" id="8272809">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272812">m</span><span class="op" id="8272813">.</span><span class="ident" id="8272814">supportedPoints</span>&nbsp;<span class="op" id="8272830">=</span>&nbsp;<span class="ident" id="8272832">randomBytes</span><span class="op" id="8272843">(</span><span class="ident" id="8272844">rand</span><span class="op" id="8272848">.</span><span class="ident" id="8272849">Intn</span><span class="op" id="8272853">(</span><span class="num" id="8272854">5</span><span class="op" id="8272855">)</span><span class="op" id="8272856">+</span><span class="num" id="8272857">1</span><span class="op" id="8272858">,</span>&nbsp;<span class="ident" id="8272860">rand</span><span class="op" id="8272864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272867">m</span><span class="op" id="8272868">.</span><span class="ident" id="8272869">supportedCurves</span>&nbsp;<span class="op" id="8272885">=</span>&nbsp;<span class="builtinfunc" id="8272887">make</span><span class="op" id="8272891">(</span><span class="op" id="8272892">[</span><span class="op" id="8272893">]</span><span class="ident" id="8272894">CurveID</span><span class="op" id="8272901">,</span>&nbsp;<span class="ident" id="8272903">rand</span><span class="op" id="8272907">.</span><span class="ident" id="8272908">Intn</span><span class="op" id="8272912">(</span><span class="num" id="8272913">5</span><span class="op" id="8272914">)</span><span class="op" id="8272915">+</span><span class="num" id="8272916">1</span><span class="op" id="8272917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8272920">for</span>&nbsp;<span class="ident" id="8272924">i</span>&nbsp;<span class="op" id="8272926">:=</span>&nbsp;<span class="keyword" id="8272929">range</span>&nbsp;<span class="ident" id="8272935">m</span><span class="op" id="8272936">.</span><span class="ident" id="8272937">supportedCurves</span>&nbsp;<span class="op" id="8272953">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8272957">m</span><span class="op" id="8272958">.</span><span class="ident" id="8272959">supportedCurves</span><span class="op" id="8272974">[</span><span class="ident" id="8272975">i</span><span class="op" id="8272976">]</span>&nbsp;<span class="op" id="8272978">=</span>&nbsp;<span class="ident" id="8272980">CurveID</span><span class="op" id="8272987">(</span><span class="ident" id="8272988">rand</span><span class="op" id="8272992">.</span><span class="ident" id="8272993">Intn</span><span class="op" id="8272997">(</span><span class="num" id="8272998">30000</span><span class="op" id="8273003">)</span><span class="op" id="8273004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273010">if</span>&nbsp;<span class="ident" id="8273013">rand</span><span class="op" id="8273017">.</span><span class="ident" id="8273018">Intn</span><span class="op" id="8273022">(</span><span class="num" id="8273023">10</span><span class="op" id="8273025">)</span>&nbsp;<span class="op" id="8273027">&gt;</span>&nbsp;<span class="num" id="8273029">5</span>&nbsp;<span class="op" id="8273031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273035">m</span><span class="op" id="8273036">.</span><span class="ident" id="8273037">ticketSupported</span>&nbsp;<span class="op" id="8273053">=</span>&nbsp;<span class="builtintype" id="8273055">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273062">if</span>&nbsp;<span class="ident" id="8273065">rand</span><span class="op" id="8273069">.</span><span class="ident" id="8273070">Intn</span><span class="op" id="8273074">(</span><span class="num" id="8273075">10</span><span class="op" id="8273077">)</span>&nbsp;<span class="op" id="8273079">&gt;</span>&nbsp;<span class="num" id="8273081">5</span>&nbsp;<span class="op" id="8273083">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273088">m</span><span class="op" id="8273089">.</span><span class="ident" id="8273090">sessionTicket</span>&nbsp;<span class="op" id="8273104">=</span>&nbsp;<span class="ident" id="8273106">randomBytes</span><span class="op" id="8273117">(</span><span class="ident" id="8273118">rand</span><span class="op" id="8273122">.</span><span class="ident" id="8273123">Intn</span><span class="op" id="8273127">(</span><span class="num" id="8273128">300</span><span class="op" id="8273131">)</span><span class="op" id="8273132">,</span>&nbsp;<span class="ident" id="8273134">rand</span><span class="op" id="8273138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273148">if</span>&nbsp;<span class="ident" id="8273151">rand</span><span class="op" id="8273155">.</span><span class="ident" id="8273156">Intn</span><span class="op" id="8273160">(</span><span class="num" id="8273161">10</span><span class="op" id="8273163">)</span>&nbsp;<span class="op" id="8273165">&gt;</span>&nbsp;<span class="num" id="8273167">5</span>&nbsp;<span class="op" id="8273169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273173">m</span><span class="op" id="8273174">.</span><span class="ident" id="8273175">signatureAndHashes</span>&nbsp;<span class="op" id="8273194">=</span>&nbsp;<span class="ident" id="8273196">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273232">m</span><span class="op" id="8273233">.</span><span class="ident" id="8273234">alpnProtocols</span>&nbsp;<span class="op" id="8273248">=</span>&nbsp;<span class="builtinfunc" id="8273250">make</span><span class="op" id="8273254">(</span><span class="op" id="8273255">[</span><span class="op" id="8273256">]</span><span class="builtintype" id="8273257">string</span><span class="op" id="8273263">,</span>&nbsp;<span class="ident" id="8273265">rand</span><span class="op" id="8273269">.</span><span class="ident" id="8273270">Intn</span><span class="op" id="8273274">(</span><span class="num" id="8273275">5</span><span class="op" id="8273276">)</span><span class="op" id="8273277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273280">for</span>&nbsp;<span class="ident" id="8273284">i</span>&nbsp;<span class="op" id="8273286">:=</span>&nbsp;<span class="keyword" id="8273289">range</span>&nbsp;<span class="ident" id="8273295">m</span><span class="op" id="8273296">.</span><span class="ident" id="8273297">alpnProtocols</span>&nbsp;<span class="op" id="8273311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273315">m</span><span class="op" id="8273316">.</span><span class="ident" id="8273317">alpnProtocols</span><span class="op" id="8273330">[</span><span class="ident" id="8273331">i</span><span class="op" id="8273332">]</span>&nbsp;<span class="op" id="8273334">=</span>&nbsp;<span class="ident" id="8273336">randomString</span><span class="op" id="8273348">(</span><span class="ident" id="8273349">rand</span><span class="op" id="8273353">.</span><span class="ident" id="8273354">Intn</span><span class="op" id="8273358">(</span><span class="num" id="8273359">20</span><span class="op" id="8273361">)</span><span class="op" id="8273362">+</span><span class="num" id="8273363">1</span><span class="op" id="8273364">,</span>&nbsp;<span class="ident" id="8273366">rand</span><span class="op" id="8273370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273373">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273377">return</span>&nbsp;<span class="ident" id="8273384">reflect</span><span class="op" id="8273391">.</span><span class="ident" id="8273392">ValueOf</span><span class="op" id="8273399">(</span><span class="ident" id="8273400">m</span><span class="op" id="8273401">)</span><br>
<span class="lineno"></span><span class="op" id="8273403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8273406">func</span>&nbsp;<span class="op" id="8273411">(</span><span class="op" id="8273412">*</span><span class="ident" id="8273413">serverHelloMsg</span><span class="op" id="8273427">)</span>&nbsp;<span class="ident" id="8273429">Generate</span><span class="op" id="8273437">(</span><span class="ident" id="8273438">rand</span>&nbsp;<span class="op" id="8273443">*</span><span class="ident" id="8273444">rand</span><span class="op" id="8273448">.</span><span class="ident" id="8273449">Rand</span><span class="op" id="8273453">,</span>&nbsp;<span class="ident" id="8273455">size</span>&nbsp;<span class="builtintype" id="8273460">int</span><span class="op" id="8273463">)</span>&nbsp;<span class="ident" id="8273465">reflect</span><span class="op" id="8273472">.</span><span class="ident" id="8273473">Value</span>&nbsp;<span class="op" id="8273479">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273482">m</span>&nbsp;<span class="op" id="8273484">:=</span>&nbsp;<span class="op" id="8273487">&amp;</span><span class="ident" id="8273488">serverHelloMsg</span><span class="op" id="8273502">{</span><span class="op" id="8273503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273506">m</span><span class="op" id="8273507">.</span><span class="ident" id="8273508">vers</span>&nbsp;<span class="op" id="8273513">=</span>&nbsp;<span class="builtintype" id="8273515">uint16</span><span class="op" id="8273521">(</span><span class="ident" id="8273522">rand</span><span class="op" id="8273526">.</span><span class="ident" id="8273527">Intn</span><span class="op" id="8273531">(</span><span class="num" id="8273532">65536</span><span class="op" id="8273537">)</span><span class="op" id="8273538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273541">m</span><span class="op" id="8273542">.</span><span class="ident" id="8273543">random</span>&nbsp;<span class="op" id="8273550">=</span>&nbsp;<span class="ident" id="8273552">randomBytes</span><span class="op" id="8273563">(</span><span class="num" id="8273564">32</span><span class="op" id="8273566">,</span>&nbsp;<span class="ident" id="8273568">rand</span><span class="op" id="8273572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273575">m</span><span class="op" id="8273576">.</span><span class="ident" id="8273577">sessionId</span>&nbsp;<span class="op" id="8273587">=</span>&nbsp;<span class="ident" id="8273589">randomBytes</span><span class="op" id="8273600">(</span><span class="ident" id="8273601">rand</span><span class="op" id="8273605">.</span><span class="ident" id="8273606">Intn</span><span class="op" id="8273610">(</span><span class="num" id="8273611">32</span><span class="op" id="8273613">)</span><span class="op" id="8273614">,</span>&nbsp;<span class="ident" id="8273616">rand</span><span class="op" id="8273620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273623">m</span><span class="op" id="8273624">.</span><span class="ident" id="8273625">cipherSuite</span>&nbsp;<span class="op" id="8273637">=</span>&nbsp;<span class="builtintype" id="8273639">uint16</span><span class="op" id="8273645">(</span><span class="ident" id="8273646">rand</span><span class="op" id="8273650">.</span><span class="ident" id="8273651">Int31</span><span class="op" id="8273656">(</span><span class="op" id="8273657">)</span><span class="op" id="8273658">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273661">m</span><span class="op" id="8273662">.</span><span class="ident" id="8273663">compressionMethod</span>&nbsp;<span class="op" id="8273681">=</span>&nbsp;<span class="builtintype" id="8273683">uint8</span><span class="op" id="8273688">(</span><span class="ident" id="8273689">rand</span><span class="op" id="8273693">.</span><span class="ident" id="8273694">Intn</span><span class="op" id="8273698">(</span><span class="num" id="8273699">256</span><span class="op" id="8273702">)</span><span class="op" id="8273703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273707">if</span>&nbsp;<span class="ident" id="8273710">rand</span><span class="op" id="8273714">.</span><span class="ident" id="8273715">Intn</span><span class="op" id="8273719">(</span><span class="num" id="8273720">10</span><span class="op" id="8273722">)</span>&nbsp;<span class="op" id="8273724">&gt;</span>&nbsp;<span class="num" id="8273726">5</span>&nbsp;<span class="op" id="8273728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273732">m</span><span class="op" id="8273733">.</span><span class="ident" id="8273734">nextProtoNeg</span>&nbsp;<span class="op" id="8273747">=</span>&nbsp;<span class="builtintype" id="8273749">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273757">n</span>&nbsp;<span class="op" id="8273759">:=</span>&nbsp;<span class="ident" id="8273762">rand</span><span class="op" id="8273766">.</span><span class="ident" id="8273767">Intn</span><span class="op" id="8273771">(</span><span class="num" id="8273772">10</span><span class="op" id="8273774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273778">m</span><span class="op" id="8273779">.</span><span class="ident" id="8273780">nextProtos</span>&nbsp;<span class="op" id="8273791">=</span>&nbsp;<span class="builtinfunc" id="8273793">make</span><span class="op" id="8273797">(</span><span class="op" id="8273798">[</span><span class="op" id="8273799">]</span><span class="builtintype" id="8273800">string</span><span class="op" id="8273806">,</span>&nbsp;<span class="ident" id="8273808">n</span><span class="op" id="8273809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273813">for</span>&nbsp;<span class="ident" id="8273817">i</span>&nbsp;<span class="op" id="8273819">:=</span>&nbsp;<span class="num" id="8273822">0</span><span class="op" id="8273823">;</span>&nbsp;<span class="ident" id="8273825">i</span>&nbsp;<span class="op" id="8273827">&lt;</span>&nbsp;<span class="ident" id="8273829">n</span><span class="op" id="8273830">;</span>&nbsp;<span class="ident" id="8273832">i</span><span class="op" id="8273833">++</span>&nbsp;<span class="op" id="8273836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273841">m</span><span class="op" id="8273842">.</span><span class="ident" id="8273843">nextProtos</span><span class="op" id="8273853">[</span><span class="ident" id="8273854">i</span><span class="op" id="8273855">]</span>&nbsp;<span class="op" id="8273857">=</span>&nbsp;<span class="ident" id="8273859">randomString</span><span class="op" id="8273871">(</span><span class="num" id="8273872">20</span><span class="op" id="8273874">,</span>&nbsp;<span class="ident" id="8273876">rand</span><span class="op" id="8273880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273884">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273891">if</span>&nbsp;<span class="ident" id="8273894">rand</span><span class="op" id="8273898">.</span><span class="ident" id="8273899">Intn</span><span class="op" id="8273903">(</span><span class="num" id="8273904">10</span><span class="op" id="8273906">)</span>&nbsp;<span class="op" id="8273908">&gt;</span>&nbsp;<span class="num" id="8273910">5</span>&nbsp;<span class="op" id="8273912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273916">m</span><span class="op" id="8273917">.</span><span class="ident" id="8273918">ocspStapling</span>&nbsp;<span class="op" id="8273931">=</span>&nbsp;<span class="builtintype" id="8273933">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273939">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8273942">if</span>&nbsp;<span class="ident" id="8273945">rand</span><span class="op" id="8273949">.</span><span class="ident" id="8273950">Intn</span><span class="op" id="8273954">(</span><span class="num" id="8273955">10</span><span class="op" id="8273957">)</span>&nbsp;<span class="op" id="8273959">&gt;</span>&nbsp;<span class="num" id="8273961">5</span>&nbsp;<span class="op" id="8273963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273967">m</span><span class="op" id="8273968">.</span><span class="ident" id="8273969">ticketSupported</span>&nbsp;<span class="op" id="8273985">=</span>&nbsp;<span class="builtintype" id="8273987">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273996">m</span><span class="op" id="8273997">.</span><span class="ident" id="8273998">alpnProtocol</span>&nbsp;<span class="op" id="8274011">=</span>&nbsp;<span class="ident" id="8274013">randomString</span><span class="op" id="8274025">(</span><span class="ident" id="8274026">rand</span><span class="op" id="8274030">.</span><span class="ident" id="8274031">Intn</span><span class="op" id="8274035">(</span><span class="num" id="8274036">32</span><span class="op" id="8274038">)</span><span class="op" id="8274039">+</span><span class="num" id="8274040">1</span><span class="op" id="8274041">,</span>&nbsp;<span class="ident" id="8274043">rand</span><span class="op" id="8274047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274051">return</span>&nbsp;<span class="ident" id="8274058">reflect</span><span class="op" id="8274065">.</span><span class="ident" id="8274066">ValueOf</span><span class="op" id="8274073">(</span><span class="ident" id="8274074">m</span><span class="op" id="8274075">)</span><br>
<span class="lineno"></span><span class="op" id="8274077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8274080">func</span>&nbsp;<span class="op" id="8274085">(</span><span class="op" id="8274086">*</span><span class="ident" id="8274087">certificateMsg</span><span class="op" id="8274101">)</span>&nbsp;<span class="ident" id="8274103">Generate</span><span class="op" id="8274111">(</span><span class="ident" id="8274112">rand</span>&nbsp;<span class="op" id="8274117">*</span><span class="ident" id="8274118">rand</span><span class="op" id="8274122">.</span><span class="ident" id="8274123">Rand</span><span class="op" id="8274127">,</span>&nbsp;<span class="ident" id="8274129">size</span>&nbsp;<span class="builtintype" id="8274134">int</span><span class="op" id="8274137">)</span>&nbsp;<span class="ident" id="8274139">reflect</span><span class="op" id="8274146">.</span><span class="ident" id="8274147">Value</span>&nbsp;<span class="op" id="8274153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274156">m</span>&nbsp;<span class="op" id="8274158">:=</span>&nbsp;<span class="op" id="8274161">&amp;</span><span class="ident" id="8274162">certificateMsg</span><span class="op" id="8274176">{</span><span class="op" id="8274177">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274180">numCerts</span>&nbsp;<span class="op" id="8274189">:=</span>&nbsp;<span class="ident" id="8274192">rand</span><span class="op" id="8274196">.</span><span class="ident" id="8274197">Intn</span><span class="op" id="8274201">(</span><span class="num" id="8274202">20</span><span class="op" id="8274204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274207">m</span><span class="op" id="8274208">.</span><span class="ident" id="8274209">certificates</span>&nbsp;<span class="op" id="8274222">=</span>&nbsp;<span class="builtinfunc" id="8274224">make</span><span class="op" id="8274228">(</span><span class="op" id="8274229">[</span><span class="op" id="8274230">]</span><span class="op" id="8274231">[</span><span class="op" id="8274232">]</span><span class="builtintype" id="8274233">byte</span><span class="op" id="8274237">,</span>&nbsp;<span class="ident" id="8274239">numCerts</span><span class="op" id="8274247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274250">for</span>&nbsp;<span class="ident" id="8274254">i</span>&nbsp;<span class="op" id="8274256">:=</span>&nbsp;<span class="num" id="8274259">0</span><span class="op" id="8274260">;</span>&nbsp;<span class="ident" id="8274262">i</span>&nbsp;<span class="op" id="8274264">&lt;</span>&nbsp;<span class="ident" id="8274266">numCerts</span><span class="op" id="8274274">;</span>&nbsp;<span class="ident" id="8274276">i</span><span class="op" id="8274277">++</span>&nbsp;<span class="op" id="8274280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274284">m</span><span class="op" id="8274285">.</span><span class="ident" id="8274286">certificates</span><span class="op" id="8274298">[</span><span class="ident" id="8274299">i</span><span class="op" id="8274300">]</span>&nbsp;<span class="op" id="8274302">=</span>&nbsp;<span class="ident" id="8274304">randomBytes</span><span class="op" id="8274315">(</span><span class="ident" id="8274316">rand</span><span class="op" id="8274320">.</span><span class="ident" id="8274321">Intn</span><span class="op" id="8274325">(</span><span class="num" id="8274326">10</span><span class="op" id="8274328">)</span><span class="op" id="8274329">+</span><span class="num" id="8274330">1</span><span class="op" id="8274331">,</span>&nbsp;<span class="ident" id="8274333">rand</span><span class="op" id="8274337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274340">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274343">return</span>&nbsp;<span class="ident" id="8274350">reflect</span><span class="op" id="8274357">.</span><span class="ident" id="8274358">ValueOf</span><span class="op" id="8274365">(</span><span class="ident" id="8274366">m</span><span class="op" id="8274367">)</span><br>
<span class="lineno"></span><span class="op" id="8274369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8274372">func</span>&nbsp;<span class="op" id="8274377">(</span><span class="op" id="8274378">*</span><span class="ident" id="8274379">certificateRequestMsg</span><span class="op" id="8274400">)</span>&nbsp;<span class="ident" id="8274402">Generate</span><span class="op" id="8274410">(</span><span class="ident" id="8274411">rand</span>&nbsp;<span class="op" id="8274416">*</span><span class="ident" id="8274417">rand</span><span class="op" id="8274421">.</span><span class="ident" id="8274422">Rand</span><span class="op" id="8274426">,</span>&nbsp;<span class="ident" id="8274428">size</span>&nbsp;<span class="builtintype" id="8274433">int</span><span class="op" id="8274436">)</span>&nbsp;<span class="ident" id="8274438">reflect</span><span class="op" id="8274445">.</span><span class="ident" id="8274446">Value</span>&nbsp;<span class="op" id="8274452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274455">m</span>&nbsp;<span class="op" id="8274457">:=</span>&nbsp;<span class="op" id="8274460">&amp;</span><span class="ident" id="8274461">certificateRequestMsg</span><span class="op" id="8274482">{</span><span class="op" id="8274483">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274486">m</span><span class="op" id="8274487">.</span><span class="ident" id="8274488">certificateTypes</span>&nbsp;<span class="op" id="8274505">=</span>&nbsp;<span class="ident" id="8274507">randomBytes</span><span class="op" id="8274518">(</span><span class="ident" id="8274519">rand</span><span class="op" id="8274523">.</span><span class="ident" id="8274524">Intn</span><span class="op" id="8274528">(</span><span class="num" id="8274529">5</span><span class="op" id="8274530">)</span><span class="op" id="8274531">+</span><span class="num" id="8274532">1</span><span class="op" id="8274533">,</span>&nbsp;<span class="ident" id="8274535">rand</span><span class="op" id="8274539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274542">numCAs</span>&nbsp;<span class="op" id="8274549">:=</span>&nbsp;<span class="ident" id="8274552">rand</span><span class="op" id="8274556">.</span><span class="ident" id="8274557">Intn</span><span class="op" id="8274561">(</span><span class="num" id="8274562">100</span><span class="op" id="8274565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274568">m</span><span class="op" id="8274569">.</span><span class="ident" id="8274570">certificateAuthorities</span>&nbsp;<span class="op" id="8274593">=</span>&nbsp;<span class="builtinfunc" id="8274595">make</span><span class="op" id="8274599">(</span><span class="op" id="8274600">[</span><span class="op" id="8274601">]</span><span class="op" id="8274602">[</span><span class="op" id="8274603">]</span><span class="builtintype" id="8274604">byte</span><span class="op" id="8274608">,</span>&nbsp;<span class="ident" id="8274610">numCAs</span><span class="op" id="8274616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274619">for</span>&nbsp;<span class="ident" id="8274623">i</span>&nbsp;<span class="op" id="8274625">:=</span>&nbsp;<span class="num" id="8274628">0</span><span class="op" id="8274629">;</span>&nbsp;<span class="ident" id="8274631">i</span>&nbsp;<span class="op" id="8274633">&lt;</span>&nbsp;<span class="ident" id="8274635">numCAs</span><span class="op" id="8274641">;</span>&nbsp;<span class="ident" id="8274643">i</span><span class="op" id="8274644">++</span>&nbsp;<span class="op" id="8274647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274651">m</span><span class="op" id="8274652">.</span><span class="ident" id="8274653">certificateAuthorities</span><span class="op" id="8274675">[</span><span class="ident" id="8274676">i</span><span class="op" id="8274677">]</span>&nbsp;<span class="op" id="8274679">=</span>&nbsp;<span class="ident" id="8274681">randomBytes</span><span class="op" id="8274692">(</span><span class="ident" id="8274693">rand</span><span class="op" id="8274697">.</span><span class="ident" id="8274698">Intn</span><span class="op" id="8274702">(</span><span class="num" id="8274703">15</span><span class="op" id="8274705">)</span><span class="op" id="8274706">+</span><span class="num" id="8274707">1</span><span class="op" id="8274708">,</span>&nbsp;<span class="ident" id="8274710">rand</span><span class="op" id="8274714">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274720">return</span>&nbsp;<span class="ident" id="8274727">reflect</span><span class="op" id="8274734">.</span><span class="ident" id="8274735">ValueOf</span><span class="op" id="8274742">(</span><span class="ident" id="8274743">m</span><span class="op" id="8274744">)</span><br>
<span class="lineno"></span><span class="op" id="8274746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8274749">func</span>&nbsp;<span class="op" id="8274754">(</span><span class="op" id="8274755">*</span><span class="ident" id="8274756">certificateVerifyMsg</span><span class="op" id="8274776">)</span>&nbsp;<span class="ident" id="8274778">Generate</span><span class="op" id="8274786">(</span><span class="ident" id="8274787">rand</span>&nbsp;<span class="op" id="8274792">*</span><span class="ident" id="8274793">rand</span><span class="op" id="8274797">.</span><span class="ident" id="8274798">Rand</span><span class="op" id="8274802">,</span>&nbsp;<span class="ident" id="8274804">size</span>&nbsp;<span class="builtintype" id="8274809">int</span><span class="op" id="8274812">)</span>&nbsp;<span class="ident" id="8274814">reflect</span><span class="op" id="8274821">.</span><span class="ident" id="8274822">Value</span>&nbsp;<span class="op" id="8274828">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274831">m</span>&nbsp;<span class="op" id="8274833">:=</span>&nbsp;<span class="op" id="8274836">&amp;</span><span class="ident" id="8274837">certificateVerifyMsg</span><span class="op" id="8274857">{</span><span class="op" id="8274858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274861">m</span><span class="op" id="8274862">.</span><span class="ident" id="8274863">signature</span>&nbsp;<span class="op" id="8274873">=</span>&nbsp;<span class="ident" id="8274875">randomBytes</span><span class="op" id="8274886">(</span><span class="ident" id="8274887">rand</span><span class="op" id="8274891">.</span><span class="ident" id="8274892">Intn</span><span class="op" id="8274896">(</span><span class="num" id="8274897">15</span><span class="op" id="8274899">)</span><span class="op" id="8274900">+</span><span class="num" id="8274901">1</span><span class="op" id="8274902">,</span>&nbsp;<span class="ident" id="8274904">rand</span><span class="op" id="8274908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274911">return</span>&nbsp;<span class="ident" id="8274918">reflect</span><span class="op" id="8274925">.</span><span class="ident" id="8274926">ValueOf</span><span class="op" id="8274933">(</span><span class="ident" id="8274934">m</span><span class="op" id="8274935">)</span><br>
<span class="lineno"></span><span class="op" id="8274937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="8274940">func</span>&nbsp;<span class="op" id="8274945">(</span><span class="op" id="8274946">*</span><span class="ident" id="8274947">certificateStatusMsg</span><span class="op" id="8274967">)</span>&nbsp;<span class="ident" id="8274969">Generate</span><span class="op" id="8274977">(</span><span class="ident" id="8274978">rand</span>&nbsp;<span class="op" id="8274983">*</span><span class="ident" id="8274984">rand</span><span class="op" id="8274988">.</span><span class="ident" id="8274989">Rand</span><span class="op" id="8274993">,</span>&nbsp;<span class="ident" id="8274995">size</span>&nbsp;<span class="builtintype" id="8275000">int</span><span class="op" id="8275003">)</span>&nbsp;<span class="ident" id="8275005">reflect</span><span class="op" id="8275012">.</span><span class="ident" id="8275013">Value</span>&nbsp;<span class="op" id="8275019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275022">m</span>&nbsp;<span class="op" id="8275024">:=</span>&nbsp;<span class="op" id="8275027">&amp;</span><span class="ident" id="8275028">certificateStatusMsg</span><span class="op" id="8275048">{</span><span class="op" id="8275049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275052">if</span>&nbsp;<span class="ident" id="8275055">rand</span><span class="op" id="8275059">.</span><span class="ident" id="8275060">Intn</span><span class="op" id="8275064">(</span><span class="num" id="8275065">10</span><span class="op" id="8275067">)</span>&nbsp;<span class="op" id="8275069">&gt;</span>&nbsp;<span class="num" id="8275071">5</span>&nbsp;<span class="op" id="8275073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275077">m</span><span class="op" id="8275078">.</span><span class="ident" id="8275079">statusType</span>&nbsp;<span class="op" id="8275090">=</span>&nbsp;<span class="ident" id="8275092">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275109">m</span><span class="op" id="8275110">.</span><span class="ident" id="8275111">response</span>&nbsp;<span class="op" id="8275120">=</span>&nbsp;<span class="ident" id="8275122">randomBytes</span><span class="op" id="8275133">(</span><span class="ident" id="8275134">rand</span><span class="op" id="8275138">.</span><span class="ident" id="8275139">Intn</span><span class="op" id="8275143">(</span><span class="num" id="8275144">10</span><span class="op" id="8275146">)</span><span class="op" id="8275147">+</span><span class="num" id="8275148">1</span><span class="op" id="8275149">,</span>&nbsp;<span class="ident" id="8275151">rand</span><span class="op" id="8275155">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275158">}</span>&nbsp;<span class="keyword" id="8275160">else</span>&nbsp;<span class="op" id="8275165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275169">m</span><span class="op" id="8275170">.</span><span class="ident" id="8275171">statusType</span>&nbsp;<span class="op" id="8275182">=</span>&nbsp;<span class="num" id="8275184">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275191">return</span>&nbsp;<span class="ident" id="8275198">reflect</span><span class="op" id="8275205">.</span><span class="ident" id="8275206">ValueOf</span><span class="op" id="8275213">(</span><span class="ident" id="8275214">m</span><span class="op" id="8275215">)</span><br>
<span class="lineno"></span><span class="op" id="8275217">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="8275220">func</span>&nbsp;<span class="op" id="8275225">(</span><span class="op" id="8275226">*</span><span class="ident" id="8275227">clientKeyExchangeMsg</span><span class="op" id="8275247">)</span>&nbsp;<span class="ident" id="8275249">Generate</span><span class="op" id="8275257">(</span><span class="ident" id="8275258">rand</span>&nbsp;<span class="op" id="8275263">*</span><span class="ident" id="8275264">rand</span><span class="op" id="8275268">.</span><span class="ident" id="8275269">Rand</span><span class="op" id="8275273">,</span>&nbsp;<span class="ident" id="8275275">size</span>&nbsp;<span class="builtintype" id="8275280">int</span><span class="op" id="8275283">)</span>&nbsp;<span class="ident" id="8275285">reflect</span><span class="op" id="8275292">.</span><span class="ident" id="8275293">Value</span>&nbsp;<span class="op" id="8275299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275302">m</span>&nbsp;<span class="op" id="8275304">:=</span>&nbsp;<span class="op" id="8275307">&amp;</span><span class="ident" id="8275308">clientKeyExchangeMsg</span><span class="op" id="8275328">{</span><span class="op" id="8275329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275332">m</span><span class="op" id="8275333">.</span><span class="ident" id="8275334">ciphertext</span>&nbsp;<span class="op" id="8275345">=</span>&nbsp;<span class="ident" id="8275347">randomBytes</span><span class="op" id="8275358">(</span><span class="ident" id="8275359">rand</span><span class="op" id="8275363">.</span><span class="ident" id="8275364">Intn</span><span class="op" id="8275368">(</span><span class="num" id="8275369">1000</span><span class="op" id="8275373">)</span><span class="op" id="8275374">+</span><span class="num" id="8275375">1</span><span class="op" id="8275376">,</span>&nbsp;<span class="ident" id="8275378">rand</span><span class="op" id="8275382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275385">return</span>&nbsp;<span class="ident" id="8275392">reflect</span><span class="op" id="8275399">.</span><span class="ident" id="8275400">ValueOf</span><span class="op" id="8275407">(</span><span class="ident" id="8275408">m</span><span class="op" id="8275409">)</span><br>
<span class="lineno">220</span><span class="op" id="8275411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8275414">func</span>&nbsp;<span class="op" id="8275419">(</span><span class="op" id="8275420">*</span><span class="ident" id="8275421">finishedMsg</span><span class="op" id="8275432">)</span>&nbsp;<span class="ident" id="8275434">Generate</span><span class="op" id="8275442">(</span><span class="ident" id="8275443">rand</span>&nbsp;<span class="op" id="8275448">*</span><span class="ident" id="8275449">rand</span><span class="op" id="8275453">.</span><span class="ident" id="8275454">Rand</span><span class="op" id="8275458">,</span>&nbsp;<span class="ident" id="8275460">size</span>&nbsp;<span class="builtintype" id="8275465">int</span><span class="op" id="8275468">)</span>&nbsp;<span class="ident" id="8275470">reflect</span><span class="op" id="8275477">.</span><span class="ident" id="8275478">Value</span>&nbsp;<span class="op" id="8275484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275487">m</span>&nbsp;<span class="op" id="8275489">:=</span>&nbsp;<span class="op" id="8275492">&amp;</span><span class="ident" id="8275493">finishedMsg</span><span class="op" id="8275504">{</span><span class="op" id="8275505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275508">m</span><span class="op" id="8275509">.</span><span class="ident" id="8275510">verifyData</span>&nbsp;<span class="op" id="8275521">=</span>&nbsp;<span class="ident" id="8275523">randomBytes</span><span class="op" id="8275534">(</span><span class="num" id="8275535">12</span><span class="op" id="8275537">,</span>&nbsp;<span class="ident" id="8275539">rand</span><span class="op" id="8275543">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275546">return</span>&nbsp;<span class="ident" id="8275553">reflect</span><span class="op" id="8275560">.</span><span class="ident" id="8275561">ValueOf</span><span class="op" id="8275568">(</span><span class="ident" id="8275569">m</span><span class="op" id="8275570">)</span><br>
<span class="lineno"></span><span class="op" id="8275572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8275575">func</span>&nbsp;<span class="op" id="8275580">(</span><span class="op" id="8275581">*</span><span class="ident" id="8275582">nextProtoMsg</span><span class="op" id="8275594">)</span>&nbsp;<span class="ident" id="8275596">Generate</span><span class="op" id="8275604">(</span><span class="ident" id="8275605">rand</span>&nbsp;<span class="op" id="8275610">*</span><span class="ident" id="8275611">rand</span><span class="op" id="8275615">.</span><span class="ident" id="8275616">Rand</span><span class="op" id="8275620">,</span>&nbsp;<span class="ident" id="8275622">size</span>&nbsp;<span class="builtintype" id="8275627">int</span><span class="op" id="8275630">)</span>&nbsp;<span class="ident" id="8275632">reflect</span><span class="op" id="8275639">.</span><span class="ident" id="8275640">Value</span>&nbsp;<span class="op" id="8275646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275649">m</span>&nbsp;<span class="op" id="8275651">:=</span>&nbsp;<span class="op" id="8275654">&amp;</span><span class="ident" id="8275655">nextProtoMsg</span><span class="op" id="8275667">{</span><span class="op" id="8275668">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275671">m</span><span class="op" id="8275672">.</span><span class="ident" id="8275673">proto</span>&nbsp;<span class="op" id="8275679">=</span>&nbsp;<span class="ident" id="8275681">randomString</span><span class="op" id="8275693">(</span><span class="ident" id="8275694">rand</span><span class="op" id="8275698">.</span><span class="ident" id="8275699">Intn</span><span class="op" id="8275703">(</span><span class="num" id="8275704">255</span><span class="op" id="8275707">)</span><span class="op" id="8275708">,</span>&nbsp;<span class="ident" id="8275710">rand</span><span class="op" id="8275714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275717">return</span>&nbsp;<span class="ident" id="8275724">reflect</span><span class="op" id="8275731">.</span><span class="ident" id="8275732">ValueOf</span><span class="op" id="8275739">(</span><span class="ident" id="8275740">m</span><span class="op" id="8275741">)</span><br>
<span class="lineno"></span><span class="op" id="8275743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8275746">func</span>&nbsp;<span class="op" id="8275751">(</span><span class="op" id="8275752">*</span><span class="ident" id="8275753">newSessionTicketMsg</span><span class="op" id="8275772">)</span>&nbsp;<span class="ident" id="8275774">Generate</span><span class="op" id="8275782">(</span><span class="ident" id="8275783">rand</span>&nbsp;<span class="op" id="8275788">*</span><span class="ident" id="8275789">rand</span><span class="op" id="8275793">.</span><span class="ident" id="8275794">Rand</span><span class="op" id="8275798">,</span>&nbsp;<span class="ident" id="8275800">size</span>&nbsp;<span class="builtintype" id="8275805">int</span><span class="op" id="8275808">)</span>&nbsp;<span class="ident" id="8275810">reflect</span><span class="op" id="8275817">.</span><span class="ident" id="8275818">Value</span>&nbsp;<span class="op" id="8275824">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275827">m</span>&nbsp;<span class="op" id="8275829">:=</span>&nbsp;<span class="op" id="8275832">&amp;</span><span class="ident" id="8275833">newSessionTicketMsg</span><span class="op" id="8275852">{</span><span class="op" id="8275853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275856">m</span><span class="op" id="8275857">.</span><span class="ident" id="8275858">ticket</span>&nbsp;<span class="op" id="8275865">=</span>&nbsp;<span class="ident" id="8275867">randomBytes</span><span class="op" id="8275878">(</span><span class="ident" id="8275879">rand</span><span class="op" id="8275883">.</span><span class="ident" id="8275884">Intn</span><span class="op" id="8275888">(</span><span class="num" id="8275889">4</span><span class="op" id="8275890">)</span><span class="op" id="8275891">,</span>&nbsp;<span class="ident" id="8275893">rand</span><span class="op" id="8275897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275900">return</span>&nbsp;<span class="ident" id="8275907">reflect</span><span class="op" id="8275914">.</span><span class="ident" id="8275915">ValueOf</span><span class="op" id="8275922">(</span><span class="ident" id="8275923">m</span><span class="op" id="8275924">)</span><br>
<span class="lineno"></span><span class="op" id="8275926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8275929">func</span>&nbsp;<span class="op" id="8275934">(</span><span class="op" id="8275935">*</span><span class="ident" id="8275936">sessionState</span><span class="op" id="8275948">)</span>&nbsp;<span class="ident" id="8275950">Generate</span><span class="op" id="8275958">(</span><span class="ident" id="8275959">rand</span>&nbsp;<span class="op" id="8275964">*</span><span class="ident" id="8275965">rand</span><span class="op" id="8275969">.</span><span class="ident" id="8275970">Rand</span><span class="op" id="8275974">,</span>&nbsp;<span class="ident" id="8275976">size</span>&nbsp;<span class="builtintype" id="8275981">int</span><span class="op" id="8275984">)</span>&nbsp;<span class="ident" id="8275986">reflect</span><span class="op" id="8275993">.</span><span class="ident" id="8275994">Value</span>&nbsp;<span class="op" id="8276000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276003">s</span>&nbsp;<span class="op" id="8276005">:=</span>&nbsp;<span class="op" id="8276008">&amp;</span><span class="ident" id="8276009">sessionState</span><span class="op" id="8276021">{</span><span class="op" id="8276022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276025">s</span><span class="op" id="8276026">.</span><span class="ident" id="8276027">vers</span>&nbsp;<span class="op" id="8276032">=</span>&nbsp;<span class="builtintype" id="8276034">uint16</span><span class="op" id="8276040">(</span><span class="ident" id="8276041">rand</span><span class="op" id="8276045">.</span><span class="ident" id="8276046">Intn</span><span class="op" id="8276050">(</span><span class="num" id="8276051">10000</span><span class="op" id="8276056">)</span><span class="op" id="8276057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276060">s</span><span class="op" id="8276061">.</span><span class="ident" id="8276062">cipherSuite</span>&nbsp;<span class="op" id="8276074">=</span>&nbsp;<span class="builtintype" id="8276076">uint16</span><span class="op" id="8276082">(</span><span class="ident" id="8276083">rand</span><span class="op" id="8276087">.</span><span class="ident" id="8276088">Intn</span><span class="op" id="8276092">(</span><span class="num" id="8276093">10000</span><span class="op" id="8276098">)</span><span class="op" id="8276099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276102">s</span><span class="op" id="8276103">.</span><span class="ident" id="8276104">masterSecret</span>&nbsp;<span class="op" id="8276117">=</span>&nbsp;<span class="ident" id="8276119">randomBytes</span><span class="op" id="8276130">(</span><span class="ident" id="8276131">rand</span><span class="op" id="8276135">.</span><span class="ident" id="8276136">Intn</span><span class="op" id="8276140">(</span><span class="num" id="8276141">100</span><span class="op" id="8276144">)</span><span class="op" id="8276145">,</span>&nbsp;<span class="ident" id="8276147">rand</span><span class="op" id="8276151">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276154">numCerts</span>&nbsp;<span class="op" id="8276163">:=</span>&nbsp;<span class="ident" id="8276166">rand</span><span class="op" id="8276170">.</span><span class="ident" id="8276171">Intn</span><span class="op" id="8276175">(</span><span class="num" id="8276176">20</span><span class="op" id="8276178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276181">s</span><span class="op" id="8276182">.</span><span class="ident" id="8276183">certificates</span>&nbsp;<span class="op" id="8276196">=</span>&nbsp;<span class="builtinfunc" id="8276198">make</span><span class="op" id="8276202">(</span><span class="op" id="8276203">[</span><span class="op" id="8276204">]</span><span class="op" id="8276205">[</span><span class="op" id="8276206">]</span><span class="builtintype" id="8276207">byte</span><span class="op" id="8276211">,</span>&nbsp;<span class="ident" id="8276213">numCerts</span><span class="op" id="8276221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8276224">for</span>&nbsp;<span class="ident" id="8276228">i</span>&nbsp;<span class="op" id="8276230">:=</span>&nbsp;<span class="num" id="8276233">0</span><span class="op" id="8276234">;</span>&nbsp;<span class="ident" id="8276236">i</span>&nbsp;<span class="op" id="8276238">&lt;</span>&nbsp;<span class="ident" id="8276240">numCerts</span><span class="op" id="8276248">;</span>&nbsp;<span class="ident" id="8276250">i</span><span class="op" id="8276251">++</span>&nbsp;<span class="op" id="8276254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8276258">s</span><span class="op" id="8276259">.</span><span class="ident" id="8276260">certificates</span><span class="op" id="8276272">[</span><span class="ident" id="8276273">i</span><span class="op" id="8276274">]</span>&nbsp;<span class="op" id="8276276">=</span>&nbsp;<span class="ident" id="8276278">randomBytes</span><span class="op" id="8276289">(</span><span class="ident" id="8276290">rand</span><span class="op" id="8276294">.</span><span class="ident" id="8276295">Intn</span><span class="op" id="8276299">(</span><span class="num" id="8276300">10</span><span class="op" id="8276302">)</span><span class="op" id="8276303">+</span><span class="num" id="8276304">1</span><span class="op" id="8276305">,</span>&nbsp;<span class="ident" id="8276307">rand</span><span class="op" id="8276311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276314">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8276317">return</span>&nbsp;<span class="ident" id="8276324">reflect</span><span class="op" id="8276331">.</span><span class="ident" id="8276332">ValueOf</span><span class="op" id="8276339">(</span><span class="ident" id="8276340">s</span><span class="op" id="8276341">)</span><br>
<span class="lineno"></span><span class="op" id="8276343">}</span>
</div>
</body>
</html>
