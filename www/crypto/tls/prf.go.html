<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4236275">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4236330">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4236384">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4236435">package</span>&nbsp;<span class="ident" id="4236443">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4236448">import</span>&nbsp;<span class="op" id="4236455">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4236458">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4236468">&#34;crypto/hmac&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4236483">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4236497">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4236512">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4236529">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4236536">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4236539">//&nbsp;Split&nbsp;a&nbsp;premaster&nbsp;secret&nbsp;in&nbsp;two&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;4346,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4236611">func</span>&nbsp;<span class="ident" id="4236616">splitPreMasterSecret</span><span class="op" id="4236636">(</span><span class="ident" id="4236637">secret</span>&nbsp;<span class="op" id="4236644">[</span><span class="op" id="4236645">]</span><span class="builtintype" id="4236646">byte</span><span class="op" id="4236650">)</span>&nbsp;<span class="op" id="4236652">(</span><span class="ident" id="4236653">s1</span><span class="op" id="4236655">,</span>&nbsp;<span class="ident" id="4236657">s2</span>&nbsp;<span class="op" id="4236660">[</span><span class="op" id="4236661">]</span><span class="builtintype" id="4236662">byte</span><span class="op" id="4236666">)</span>&nbsp;<span class="op" id="4236668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236671"><a href="/crypto/tls/prf.go.html#4236653">s1</a></span>&nbsp;<span class="op" id="4236674">=</span>&nbsp;<span class="ident" id="4236676"><a href="/crypto/tls/prf.go.html#4236637">secret</a></span><span class="op" id="4236682">[</span><span class="num" id="4236683">0</span>&nbsp;<span class="op" id="4236685">:</span>&nbsp;<span class="op" id="4236687">(</span><span class="builtinfunc" id="4236688">len</span><span class="op" id="4236691">(</span><span class="ident" id="4236692"><a href="/crypto/tls/prf.go.html#4236637">secret</a></span><span class="op" id="4236698">)</span><span class="op" id="4236699">+</span><span class="num" id="4236700">1</span><span class="op" id="4236701">)</span><span class="op" id="4236702">/</span><span class="num" id="4236703">2</span><span class="op" id="4236704">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236707"><a href="/crypto/tls/prf.go.html#4236657">s2</a></span>&nbsp;<span class="op" id="4236710">=</span>&nbsp;<span class="ident" id="4236712"><a href="/crypto/tls/prf.go.html#4236637">secret</a></span><span class="op" id="4236718">[</span><span class="builtinfunc" id="4236719">len</span><span class="op" id="4236722">(</span><span class="ident" id="4236723"><a href="/crypto/tls/prf.go.html#4236637">secret</a></span><span class="op" id="4236729">)</span><span class="op" id="4236730">/</span><span class="num" id="4236731">2</span><span class="op" id="4236732">:</span><span class="op" id="4236733">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4236736">return</span><br>
<span class="lineno"></span><span class="op" id="4236743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4236746">//&nbsp;pHash&nbsp;implements&nbsp;the&nbsp;P_hash&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4346,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4236822">func</span>&nbsp;<span class="ident" id="4236827">pHash</span><span class="op" id="4236832">(</span><span class="ident" id="4236833">result</span><span class="op" id="4236839">,</span>&nbsp;<span class="ident" id="4236841">secret</span><span class="op" id="4236847">,</span>&nbsp;<span class="ident" id="4236849">seed</span>&nbsp;<span class="op" id="4236854">[</span><span class="op" id="4236855">]</span><span class="builtintype" id="4236856">byte</span><span class="op" id="4236860">,</span>&nbsp;<span class="ident" id="4236862">hash</span>&nbsp;<span class="keyword" id="4236867">func</span><span class="op" id="4236871">(</span><span class="op" id="4236872">)</span>&nbsp;<span class="ident" id="4236874"><a href="/crypto/tls/prf.go.html#4236529">hash</a></span><span class="op" id="4236878">.</span><span class="ident" id="4236879">Hash</span><span class="op" id="4236883">)</span>&nbsp;<span class="op" id="4236885">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236888">h</span>&nbsp;<span class="op" id="4236890">:=</span>&nbsp;<span class="ident" id="4236893"><a href="/crypto/tls/prf.go.html#4236468">hmac</a></span><span class="op" id="4236897">.</span><span class="ident" id="4236898">New</span><span class="op" id="4236901">(</span><span class="ident" id="4236902"><a href="/crypto/tls/prf.go.html#4236862">hash</a></span><span class="op" id="4236906">,</span>&nbsp;<span class="ident" id="4236908"><a href="/crypto/tls/prf.go.html#4236841">secret</a></span><span class="op" id="4236914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236917"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4236918">.</span><span class="ident" id="4236919">Write</span><span class="op" id="4236924">(</span><span class="ident" id="4236925"><a href="/crypto/tls/prf.go.html#4236849">seed</a></span><span class="op" id="4236929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236932">a</span>&nbsp;<span class="op" id="4236934">:=</span>&nbsp;<span class="ident" id="4236937"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4236938">.</span><span class="ident" id="4236939">Sum</span><span class="op" id="4236942">(</span><span class="ident" id="4236943">nil</span><span class="op" id="4236946">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236950">j</span>&nbsp;<span class="op" id="4236952">:=</span>&nbsp;<span class="num" id="4236955">0</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4236958">for</span>&nbsp;<span class="ident" id="4236962"><a href="/crypto/tls/prf.go.html#4236950">j</a></span>&nbsp;<span class="op" id="4236964">&lt;</span>&nbsp;<span class="builtinfunc" id="4236966">len</span><span class="op" id="4236969">(</span><span class="ident" id="4236970"><a href="/crypto/tls/prf.go.html#4236833">result</a></span><span class="op" id="4236976">)</span>&nbsp;<span class="op" id="4236978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236982"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4236983">.</span><span class="ident" id="4236984">Reset</span><span class="op" id="4236989">(</span><span class="op" id="4236990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4236994"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4236995">.</span><span class="ident" id="4236996">Write</span><span class="op" id="4237001">(</span><span class="ident" id="4237002"><a href="/crypto/tls/prf.go.html#4236932">a</a></span><span class="op" id="4237003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237007"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4237008">.</span><span class="ident" id="4237009">Write</span><span class="op" id="4237014">(</span><span class="ident" id="4237015"><a href="/crypto/tls/prf.go.html#4236849">seed</a></span><span class="op" id="4237019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237023">b</span>&nbsp;<span class="op" id="4237025">:=</span>&nbsp;<span class="ident" id="4237028"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4237029">.</span><span class="ident" id="4237030">Sum</span><span class="op" id="4237033">(</span><span class="ident" id="4237034">nil</span><span class="op" id="4237037">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237041">todo</span>&nbsp;<span class="op" id="4237046">:=</span>&nbsp;<span class="builtinfunc" id="4237049">len</span><span class="op" id="4237052">(</span><span class="ident" id="4237053"><a href="/crypto/tls/prf.go.html#4237023">b</a></span><span class="op" id="4237054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4237058">if</span>&nbsp;<span class="ident" id="4237061"><a href="/crypto/tls/prf.go.html#4236950">j</a></span><span class="op" id="4237062">+</span><span class="ident" id="4237063"><a href="/crypto/tls/prf.go.html#4237041">todo</a></span>&nbsp;<span class="op" id="4237068">&gt;</span>&nbsp;<span class="builtinfunc" id="4237070">len</span><span class="op" id="4237073">(</span><span class="ident" id="4237074"><a href="/crypto/tls/prf.go.html#4236833">result</a></span><span class="op" id="4237080">)</span>&nbsp;<span class="op" id="4237082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237087"><a href="/crypto/tls/prf.go.html#4237041">todo</a></span>&nbsp;<span class="op" id="4237092">=</span>&nbsp;<span class="builtinfunc" id="4237094">len</span><span class="op" id="4237097">(</span><span class="ident" id="4237098"><a href="/crypto/tls/prf.go.html#4236833">result</a></span><span class="op" id="4237104">)</span>&nbsp;<span class="op" id="4237106">-</span>&nbsp;<span class="ident" id="4237108"><a href="/crypto/tls/prf.go.html#4236950">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4237112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4237116">copy</span><span class="op" id="4237120">(</span><span class="ident" id="4237121"><a href="/crypto/tls/prf.go.html#4236833">result</a></span><span class="op" id="4237127">[</span><span class="ident" id="4237128"><a href="/crypto/tls/prf.go.html#4236950">j</a></span><span class="op" id="4237129">:</span><span class="ident" id="4237130"><a href="/crypto/tls/prf.go.html#4236950">j</a></span><span class="op" id="4237131">+</span><span class="ident" id="4237132"><a href="/crypto/tls/prf.go.html#4237041">todo</a></span><span class="op" id="4237136">]</span><span class="op" id="4237137">,</span>&nbsp;<span class="ident" id="4237139"><a href="/crypto/tls/prf.go.html#4237023">b</a></span><span class="op" id="4237140">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237144"><a href="/crypto/tls/prf.go.html#4236950">j</a></span>&nbsp;<span class="op" id="4237146">+=</span>&nbsp;<span class="ident" id="4237149"><a href="/crypto/tls/prf.go.html#4237041">todo</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237157"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4237158">.</span><span class="ident" id="4237159">Reset</span><span class="op" id="4237164">(</span><span class="op" id="4237165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237169"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4237170">.</span><span class="ident" id="4237171">Write</span><span class="op" id="4237176">(</span><span class="ident" id="4237177"><a href="/crypto/tls/prf.go.html#4236932">a</a></span><span class="op" id="4237178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237182"><a href="/crypto/tls/prf.go.html#4236932">a</a></span>&nbsp;<span class="op" id="4237184">=</span>&nbsp;<span class="ident" id="4237186"><a href="/crypto/tls/prf.go.html#4236888">h</a></span><span class="op" id="4237187">.</span><span class="ident" id="4237188">Sum</span><span class="op" id="4237191">(</span><span class="ident" id="4237192">nil</span><span class="op" id="4237195">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4237198">}</span><br>
<span class="lineno"></span><span class="op" id="4237200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4237203">//&nbsp;prf10&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4237294">func</span>&nbsp;<span class="ident" id="4237299">prf10</span><span class="op" id="4237304">(</span><span class="ident" id="4237305">result</span><span class="op" id="4237311">,</span>&nbsp;<span class="ident" id="4237313">secret</span><span class="op" id="4237319">,</span>&nbsp;<span class="ident" id="4237321">label</span><span class="op" id="4237326">,</span>&nbsp;<span class="ident" id="4237328">seed</span>&nbsp;<span class="op" id="4237333">[</span><span class="op" id="4237334">]</span><span class="builtintype" id="4237335">byte</span><span class="op" id="4237339">)</span>&nbsp;<span class="op" id="4237341">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237344">hashSHA1</span>&nbsp;<span class="op" id="4237353">:=</span>&nbsp;<span class="ident" id="4237356"><a href="/crypto/tls/prf.go.html#4236497">sha1</a></span><span class="op" id="4237360">.</span><span class="ident" id="4237361">New</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237366">hashMD5</span>&nbsp;<span class="op" id="4237374">:=</span>&nbsp;<span class="ident" id="4237377"><a href="/crypto/tls/prf.go.html#4236483">md5</a></span><span class="op" id="4237380">.</span><span class="ident" id="4237381">New</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237387">labelAndSeed</span>&nbsp;<span class="op" id="4237400">:=</span>&nbsp;<span class="builtinfunc" id="4237403">make</span><span class="op" id="4237407">(</span><span class="op" id="4237408">[</span><span class="op" id="4237409">]</span><span class="builtintype" id="4237410">byte</span><span class="op" id="4237414">,</span>&nbsp;<span class="builtinfunc" id="4237416">len</span><span class="op" id="4237419">(</span><span class="ident" id="4237420"><a href="/crypto/tls/prf.go.html#4237321">label</a></span><span class="op" id="4237425">)</span><span class="op" id="4237426">+</span><span class="builtinfunc" id="4237427">len</span><span class="op" id="4237430">(</span><span class="ident" id="4237431"><a href="/crypto/tls/prf.go.html#4237328">seed</a></span><span class="op" id="4237435">)</span><span class="op" id="4237436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4237439">copy</span><span class="op" id="4237443">(</span><span class="ident" id="4237444"><a href="/crypto/tls/prf.go.html#4237387">labelAndSeed</a></span><span class="op" id="4237456">,</span>&nbsp;<span class="ident" id="4237458"><a href="/crypto/tls/prf.go.html#4237321">label</a></span><span class="op" id="4237463">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4237466">copy</span><span class="op" id="4237470">(</span><span class="ident" id="4237471"><a href="/crypto/tls/prf.go.html#4237387">labelAndSeed</a></span><span class="op" id="4237483">[</span><span class="builtinfunc" id="4237484">len</span><span class="op" id="4237487">(</span><span class="ident" id="4237488"><a href="/crypto/tls/prf.go.html#4237321">label</a></span><span class="op" id="4237493">)</span><span class="op" id="4237494">:</span><span class="op" id="4237495">]</span><span class="op" id="4237496">,</span>&nbsp;<span class="ident" id="4237498"><a href="/crypto/tls/prf.go.html#4237328">seed</a></span><span class="op" id="4237502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237506">s1</span><span class="op" id="4237508">,</span>&nbsp;<span class="ident" id="4237510">s2</span>&nbsp;<span class="op" id="4237513">:=</span>&nbsp;<span class="ident" id="4237516"><a href="/crypto/tls/prf.go.html#4236616">splitPreMasterSecret</a></span><span class="op" id="4237536">(</span><span class="ident" id="4237537"><a href="/crypto/tls/prf.go.html#4237313">secret</a></span><span class="op" id="4237543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237546"><a href="/crypto/tls/prf.go.html#4236827">pHash</a></span><span class="op" id="4237551">(</span><span class="ident" id="4237552"><a href="/crypto/tls/prf.go.html#4237305">result</a></span><span class="op" id="4237558">,</span>&nbsp;<span class="ident" id="4237560"><a href="/crypto/tls/prf.go.html#4237506">s1</a></span><span class="op" id="4237562">,</span>&nbsp;<span class="ident" id="4237564"><a href="/crypto/tls/prf.go.html#4237387">labelAndSeed</a></span><span class="op" id="4237576">,</span>&nbsp;<span class="ident" id="4237578"><a href="/crypto/tls/prf.go.html#4237366">hashMD5</a></span><span class="op" id="4237585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237588">result2</span>&nbsp;<span class="op" id="4237596">:=</span>&nbsp;<span class="builtinfunc" id="4237599">make</span><span class="op" id="4237603">(</span><span class="op" id="4237604">[</span><span class="op" id="4237605">]</span><span class="builtintype" id="4237606">byte</span><span class="op" id="4237610">,</span>&nbsp;<span class="builtinfunc" id="4237612">len</span><span class="op" id="4237615">(</span><span class="ident" id="4237616"><a href="/crypto/tls/prf.go.html#4237305">result</a></span><span class="op" id="4237622">)</span><span class="op" id="4237623">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237626"><a href="/crypto/tls/prf.go.html#4236827">pHash</a></span><span class="op" id="4237631">(</span><span class="ident" id="4237632"><a href="/crypto/tls/prf.go.html#4237588">result2</a></span><span class="op" id="4237639">,</span>&nbsp;<span class="ident" id="4237641"><a href="/crypto/tls/prf.go.html#4237510">s2</a></span><span class="op" id="4237643">,</span>&nbsp;<span class="ident" id="4237645"><a href="/crypto/tls/prf.go.html#4237387">labelAndSeed</a></span><span class="op" id="4237657">,</span>&nbsp;<span class="ident" id="4237659"><a href="/crypto/tls/prf.go.html#4237344">hashSHA1</a></span><span class="op" id="4237667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4237671">for</span>&nbsp;<span class="ident" id="4237675">i</span><span class="op" id="4237676">,</span>&nbsp;<span class="ident" id="4237678">b</span>&nbsp;<span class="op" id="4237680">:=</span>&nbsp;<span class="keyword" id="4237683">range</span>&nbsp;<span class="ident" id="4237689"><a href="/crypto/tls/prf.go.html#4237588">result2</a></span>&nbsp;<span class="op" id="4237697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237701"><a href="/crypto/tls/prf.go.html#4237305">result</a></span><span class="op" id="4237707">[</span><span class="ident" id="4237708"><a href="/crypto/tls/prf.go.html#4237675">i</a></span><span class="op" id="4237709">]</span>&nbsp;<span class="op" id="4237711">^=</span>&nbsp;<span class="ident" id="4237714"><a href="/crypto/tls/prf.go.html#4237678">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4237717">}</span><br>
<span class="lineno">65</span><span class="op" id="4237719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4237722">//&nbsp;prf12&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.2&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4237813">func</span>&nbsp;<span class="ident" id="4237818">prf12</span><span class="op" id="4237823">(</span><span class="ident" id="4237824">result</span><span class="op" id="4237830">,</span>&nbsp;<span class="ident" id="4237832">secret</span><span class="op" id="4237838">,</span>&nbsp;<span class="ident" id="4237840">label</span><span class="op" id="4237845">,</span>&nbsp;<span class="ident" id="4237847">seed</span>&nbsp;<span class="op" id="4237852">[</span><span class="op" id="4237853">]</span><span class="builtintype" id="4237854">byte</span><span class="op" id="4237858">)</span>&nbsp;<span class="op" id="4237860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237863">labelAndSeed</span>&nbsp;<span class="op" id="4237876">:=</span>&nbsp;<span class="builtinfunc" id="4237879">make</span><span class="op" id="4237883">(</span><span class="op" id="4237884">[</span><span class="op" id="4237885">]</span><span class="builtintype" id="4237886">byte</span><span class="op" id="4237890">,</span>&nbsp;<span class="builtinfunc" id="4237892">len</span><span class="op" id="4237895">(</span><span class="ident" id="4237896"><a href="/crypto/tls/prf.go.html#4237840">label</a></span><span class="op" id="4237901">)</span><span class="op" id="4237902">+</span><span class="builtinfunc" id="4237903">len</span><span class="op" id="4237906">(</span><span class="ident" id="4237907"><a href="/crypto/tls/prf.go.html#4237847">seed</a></span><span class="op" id="4237911">)</span><span class="op" id="4237912">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4237915">copy</span><span class="op" id="4237919">(</span><span class="ident" id="4237920"><a href="/crypto/tls/prf.go.html#4237863">labelAndSeed</a></span><span class="op" id="4237932">,</span>&nbsp;<span class="ident" id="4237934"><a href="/crypto/tls/prf.go.html#4237840">label</a></span><span class="op" id="4237939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4237942">copy</span><span class="op" id="4237946">(</span><span class="ident" id="4237947"><a href="/crypto/tls/prf.go.html#4237863">labelAndSeed</a></span><span class="op" id="4237959">[</span><span class="builtinfunc" id="4237960">len</span><span class="op" id="4237963">(</span><span class="ident" id="4237964"><a href="/crypto/tls/prf.go.html#4237840">label</a></span><span class="op" id="4237969">)</span><span class="op" id="4237970">:</span><span class="op" id="4237971">]</span><span class="op" id="4237972">,</span>&nbsp;<span class="ident" id="4237974"><a href="/crypto/tls/prf.go.html#4237847">seed</a></span><span class="op" id="4237978">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4237982"><a href="/crypto/tls/prf.go.html#4236827">pHash</a></span><span class="op" id="4237987">(</span><span class="ident" id="4237988"><a href="/crypto/tls/prf.go.html#4237824">result</a></span><span class="op" id="4237994">,</span>&nbsp;<span class="ident" id="4237996"><a href="/crypto/tls/prf.go.html#4237832">secret</a></span><span class="op" id="4238002">,</span>&nbsp;<span class="ident" id="4238004"><a href="/crypto/tls/prf.go.html#4237863">labelAndSeed</a></span><span class="op" id="4238016">,</span>&nbsp;<span class="ident" id="4238018"><a href="/crypto/tls/prf.go.html#4236512">sha256</a></span><span class="op" id="4238024">.</span><span class="ident" id="4238025">New</span><span class="op" id="4238028">)</span><br>
<span class="lineno"></span><span class="op" id="4238030">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4238033">//&nbsp;prf30&nbsp;implements&nbsp;the&nbsp;SSL&nbsp;3.0&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4238103">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;6.</span><br>
<span class="lineno"></span><span class="keyword" id="4238176">func</span>&nbsp;<span class="ident" id="4238181">prf30</span><span class="op" id="4238186">(</span><span class="ident" id="4238187">result</span><span class="op" id="4238193">,</span>&nbsp;<span class="ident" id="4238195">secret</span><span class="op" id="4238201">,</span>&nbsp;<span class="ident" id="4238203">label</span><span class="op" id="4238208">,</span>&nbsp;<span class="ident" id="4238210">seed</span>&nbsp;<span class="op" id="4238215">[</span><span class="op" id="4238216">]</span><span class="builtintype" id="4238217">byte</span><span class="op" id="4238221">)</span>&nbsp;<span class="op" id="4238223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238226">hashSHA1</span>&nbsp;<span class="op" id="4238235">:=</span>&nbsp;<span class="ident" id="4238238"><a href="/crypto/tls/prf.go.html#4236497">sha1</a></span><span class="op" id="4238242">.</span><span class="ident" id="4238243">New</span><span class="op" id="4238246">(</span><span class="op" id="4238247">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238250">hashMD5</span>&nbsp;<span class="op" id="4238258">:=</span>&nbsp;<span class="ident" id="4238261"><a href="/crypto/tls/prf.go.html#4236483">md5</a></span><span class="op" id="4238264">.</span><span class="ident" id="4238265">New</span><span class="op" id="4238268">(</span><span class="op" id="4238269">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238273">done</span>&nbsp;<span class="op" id="4238278">:=</span>&nbsp;<span class="num" id="4238281">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238284">i</span>&nbsp;<span class="op" id="4238286">:=</span>&nbsp;<span class="num" id="4238289">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4238292">//&nbsp;RFC5246&nbsp;section&nbsp;6.3&nbsp;says&nbsp;that&nbsp;the&nbsp;largest&nbsp;PRF&nbsp;output&nbsp;needed&nbsp;is&nbsp;128</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4238363">//&nbsp;bytes.&nbsp;Since&nbsp;no&nbsp;more&nbsp;ciphersuites&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;SSLv3,&nbsp;this&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4238435">//&nbsp;remain&nbsp;true.&nbsp;Each&nbsp;iteration&nbsp;gives&nbsp;us&nbsp;16&nbsp;bytes&nbsp;so&nbsp;10&nbsp;iterations&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4238507">//&nbsp;be&nbsp;sufficient.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4238526">var</span>&nbsp;<span class="ident" id="4238530">b</span>&nbsp;<span class="op" id="4238532">[</span><span class="num" id="4238533">11</span><span class="op" id="4238535">]</span><span class="builtintype" id="4238536">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4238542">for</span>&nbsp;<span class="ident" id="4238546"><a href="/crypto/tls/prf.go.html#4238273">done</a></span>&nbsp;<span class="op" id="4238551">&lt;</span>&nbsp;<span class="builtinfunc" id="4238553">len</span><span class="op" id="4238556">(</span><span class="ident" id="4238557"><a href="/crypto/tls/prf.go.html#4238187">result</a></span><span class="op" id="4238563">)</span>&nbsp;<span class="op" id="4238565">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4238569">for</span>&nbsp;<span class="ident" id="4238573">j</span>&nbsp;<span class="op" id="4238575">:=</span>&nbsp;<span class="num" id="4238578">0</span><span class="op" id="4238579">;</span>&nbsp;<span class="ident" id="4238581"><a href="/crypto/tls/prf.go.html#4238573">j</a></span>&nbsp;<span class="op" id="4238583">&lt;=</span>&nbsp;<span class="ident" id="4238586"><a href="/crypto/tls/prf.go.html#4238284">i</a></span><span class="op" id="4238587">;</span>&nbsp;<span class="ident" id="4238589"><a href="/crypto/tls/prf.go.html#4238573">j</a></span><span class="op" id="4238590">++</span>&nbsp;<span class="op" id="4238593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238598"><a href="/crypto/tls/prf.go.html#4238530">b</a></span><span class="op" id="4238599">[</span><span class="ident" id="4238600"><a href="/crypto/tls/prf.go.html#4238573">j</a></span><span class="op" id="4238601">]</span>&nbsp;<span class="op" id="4238603">=</span>&nbsp;<span class="string" id="4238605">&#39;A&#39;</span>&nbsp;<span class="op" id="4238609">+</span>&nbsp;<span class="builtintype" id="4238611">byte</span><span class="op" id="4238615">(</span><span class="ident" id="4238616"><a href="/crypto/tls/prf.go.html#4238284">i</a></span><span class="op" id="4238617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4238621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238626"><a href="/crypto/tls/prf.go.html#4238226">hashSHA1</a></span><span class="op" id="4238634">.</span><span class="ident" id="4238635">Reset</span><span class="op" id="4238640">(</span><span class="op" id="4238641">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238645"><a href="/crypto/tls/prf.go.html#4238226">hashSHA1</a></span><span class="op" id="4238653">.</span><span class="ident" id="4238654">Write</span><span class="op" id="4238659">(</span><span class="ident" id="4238660"><a href="/crypto/tls/prf.go.html#4238530">b</a></span><span class="op" id="4238661">[</span><span class="op" id="4238662">:</span><span class="ident" id="4238663"><a href="/crypto/tls/prf.go.html#4238284">i</a></span><span class="op" id="4238664">+</span><span class="num" id="4238665">1</span><span class="op" id="4238666">]</span><span class="op" id="4238667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238671"><a href="/crypto/tls/prf.go.html#4238226">hashSHA1</a></span><span class="op" id="4238679">.</span><span class="ident" id="4238680">Write</span><span class="op" id="4238685">(</span><span class="ident" id="4238686"><a href="/crypto/tls/prf.go.html#4238195">secret</a></span><span class="op" id="4238692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238696"><a href="/crypto/tls/prf.go.html#4238226">hashSHA1</a></span><span class="op" id="4238704">.</span><span class="ident" id="4238705">Write</span><span class="op" id="4238710">(</span><span class="ident" id="4238711"><a href="/crypto/tls/prf.go.html#4238210">seed</a></span><span class="op" id="4238715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238719">digest</span>&nbsp;<span class="op" id="4238726">:=</span>&nbsp;<span class="ident" id="4238729"><a href="/crypto/tls/prf.go.html#4238226">hashSHA1</a></span><span class="op" id="4238737">.</span><span class="ident" id="4238738">Sum</span><span class="op" id="4238741">(</span><span class="ident" id="4238742">nil</span><span class="op" id="4238745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238750"><a href="/crypto/tls/prf.go.html#4238250">hashMD5</a></span><span class="op" id="4238757">.</span><span class="ident" id="4238758">Reset</span><span class="op" id="4238763">(</span><span class="op" id="4238764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238768"><a href="/crypto/tls/prf.go.html#4238250">hashMD5</a></span><span class="op" id="4238775">.</span><span class="ident" id="4238776">Write</span><span class="op" id="4238781">(</span><span class="ident" id="4238782"><a href="/crypto/tls/prf.go.html#4238195">secret</a></span><span class="op" id="4238788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238792"><a href="/crypto/tls/prf.go.html#4238250">hashMD5</a></span><span class="op" id="4238799">.</span><span class="ident" id="4238800">Write</span><span class="op" id="4238805">(</span><span class="ident" id="4238806"><a href="/crypto/tls/prf.go.html#4238719">digest</a></span><span class="op" id="4238812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238817"><a href="/crypto/tls/prf.go.html#4238273">done</a></span>&nbsp;<span class="op" id="4238822">+=</span>&nbsp;<span class="builtinfunc" id="4238825">copy</span><span class="op" id="4238829">(</span><span class="ident" id="4238830"><a href="/crypto/tls/prf.go.html#4238187">result</a></span><span class="op" id="4238836">[</span><span class="ident" id="4238837"><a href="/crypto/tls/prf.go.html#4238273">done</a></span><span class="op" id="4238841">:</span><span class="op" id="4238842">]</span><span class="op" id="4238843">,</span>&nbsp;<span class="ident" id="4238845"><a href="/crypto/tls/prf.go.html#4238250">hashMD5</a></span><span class="op" id="4238852">.</span><span class="ident" id="4238853">Sum</span><span class="op" id="4238856">(</span><span class="ident" id="4238857">nil</span><span class="op" id="4238860">)</span><span class="op" id="4238861">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238865"><a href="/crypto/tls/prf.go.html#4238284">i</a></span><span class="op" id="4238866">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4238870">}</span><br>
<span class="lineno"></span><span class="op" id="4238872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4238875">const</span>&nbsp;<span class="op" id="4238881">(</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238884">tlsRandomLength</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4238905">=</span>&nbsp;<span class="num" id="4238907">32</span>&nbsp;<span class="comment" id="4238910">//&nbsp;Length&nbsp;of&nbsp;a&nbsp;random&nbsp;nonce&nbsp;in&nbsp;TLS&nbsp;1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4238951">masterSecretLength</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4238972">=</span>&nbsp;<span class="num" id="4238974">48</span>&nbsp;<span class="comment" id="4238977">//&nbsp;Length&nbsp;of&nbsp;a&nbsp;master&nbsp;secret&nbsp;in&nbsp;TLS&nbsp;1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4239019">finishedVerifyLength</span>&nbsp;<span class="op" id="4239040">=</span>&nbsp;<span class="num" id="4239042">12</span>&nbsp;<span class="comment" id="4239045">//&nbsp;Length&nbsp;of&nbsp;verify_data&nbsp;in&nbsp;a&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="op" id="4239093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4239096">var</span>&nbsp;<span class="ident" id="4239100">masterSecretLabel</span>&nbsp;<span class="op" id="4239118">=</span>&nbsp;<span class="op" id="4239120">[</span><span class="op" id="4239121">]</span><span class="builtintype" id="4239122">byte</span><span class="op" id="4239126">(</span><span class="string" id="4239127">&#34;master&nbsp;secret&#34;</span><span class="op" id="4239142">)</span><br>
<span class="lineno"></span><span class="keyword" id="4239144">var</span>&nbsp;<span class="ident" id="4239148">keyExpansionLabel</span>&nbsp;<span class="op" id="4239166">=</span>&nbsp;<span class="op" id="4239168">[</span><span class="op" id="4239169">]</span><span class="builtintype" id="4239170">byte</span><span class="op" id="4239174">(</span><span class="string" id="4239175">&#34;key&nbsp;expansion&#34;</span><span class="op" id="4239190">)</span><br>
<span class="lineno"></span><span class="keyword" id="4239192">var</span>&nbsp;<span class="ident" id="4239196">clientFinishedLabel</span>&nbsp;<span class="op" id="4239216">=</span>&nbsp;<span class="op" id="4239218">[</span><span class="op" id="4239219">]</span><span class="builtintype" id="4239220">byte</span><span class="op" id="4239224">(</span><span class="string" id="4239225">&#34;client&nbsp;finished&#34;</span><span class="op" id="4239242">)</span><br>
<span class="lineno"></span><span class="keyword" id="4239244">var</span>&nbsp;<span class="ident" id="4239248">serverFinishedLabel</span>&nbsp;<span class="op" id="4239268">=</span>&nbsp;<span class="op" id="4239270">[</span><span class="op" id="4239271">]</span><span class="builtintype" id="4239272">byte</span><span class="op" id="4239276">(</span><span class="string" id="4239277">&#34;server&nbsp;finished&#34;</span><span class="op" id="4239294">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="4239297">func</span>&nbsp;<span class="ident" id="4239302">prfForVersion</span><span class="op" id="4239315">(</span><span class="ident" id="4239316">version</span>&nbsp;<span class="builtintype" id="4239324">uint16</span><span class="op" id="4239330">)</span>&nbsp;<span class="keyword" id="4239332">func</span><span class="op" id="4239336">(</span><span class="ident" id="4239337">result</span><span class="op" id="4239343">,</span>&nbsp;<span class="ident" id="4239345">secret</span><span class="op" id="4239351">,</span>&nbsp;<span class="ident" id="4239353">label</span><span class="op" id="4239358">,</span>&nbsp;<span class="ident" id="4239360">seed</span>&nbsp;<span class="op" id="4239365">[</span><span class="op" id="4239366">]</span><span class="builtintype" id="4239367">byte</span><span class="op" id="4239371">)</span>&nbsp;<span class="op" id="4239373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239376">switch</span>&nbsp;<span class="ident" id="4239383"><a href="/crypto/tls/prf.go.html#4239316">version</a></span>&nbsp;<span class="op" id="4239391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239394">case</span>&nbsp;<span class="ident" id="4239399"><a href="/crypto/tls/common.go.html#4108136">VersionSSL30</a></span><span class="op" id="4239411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239415">return</span>&nbsp;<span class="ident" id="4239422"><a href="/crypto/tls/prf.go.html#4238181">prf30</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239429">case</span>&nbsp;<span class="ident" id="4239434"><a href="/crypto/tls/common.go.html#4108159">VersionTLS10</a></span><span class="op" id="4239446">,</span>&nbsp;<span class="ident" id="4239448"><a href="/crypto/tls/common.go.html#4108182">VersionTLS11</a></span><span class="op" id="4239460">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239464">return</span>&nbsp;<span class="ident" id="4239471"><a href="/crypto/tls/prf.go.html#4237299">prf10</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239478">case</span>&nbsp;<span class="ident" id="4239483"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span><span class="op" id="4239495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239499">return</span>&nbsp;<span class="ident" id="4239506"><a href="/crypto/tls/prf.go.html#4237818">prf12</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239513">default</span><span class="op" id="4239520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4239524">panic</span><span class="op" id="4239529">(</span><span class="string" id="4239530">&#34;unknown&nbsp;version&#34;</span><span class="op" id="4239547">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4239550">}</span><br>
<span class="lineno"></span><span class="op" id="4239552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4239555">//&nbsp;masterFromPreMasterSecret&nbsp;generates&nbsp;the&nbsp;master&nbsp;secret&nbsp;from&nbsp;the&nbsp;pre-master</span><br>
<span class="lineno"></span><span class="comment" id="4239632">//&nbsp;secret.&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5246#section-8.1</span><br>
<span class="lineno">135</span><span class="keyword" id="4239694">func</span>&nbsp;<span class="ident" id="4239699">masterFromPreMasterSecret</span><span class="op" id="4239724">(</span><span class="ident" id="4239725">version</span>&nbsp;<span class="builtintype" id="4239733">uint16</span><span class="op" id="4239739">,</span>&nbsp;<span class="ident" id="4239741">preMasterSecret</span><span class="op" id="4239756">,</span>&nbsp;<span class="ident" id="4239758">clientRandom</span><span class="op" id="4239770">,</span>&nbsp;<span class="ident" id="4239772">serverRandom</span>&nbsp;<span class="op" id="4239785">[</span><span class="op" id="4239786">]</span><span class="builtintype" id="4239787">byte</span><span class="op" id="4239791">)</span>&nbsp;<span class="op" id="4239793">[</span><span class="op" id="4239794">]</span><span class="builtintype" id="4239795">byte</span>&nbsp;<span class="op" id="4239800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4239803">var</span>&nbsp;<span class="ident" id="4239807">seed</span>&nbsp;<span class="op" id="4239812">[</span><span class="ident" id="4239813"><a href="/crypto/tls/prf.go.html#4238884">tlsRandomLength</a></span>&nbsp;<span class="op" id="4239829">*</span>&nbsp;<span class="num" id="4239831">2</span><span class="op" id="4239832">]</span><span class="builtintype" id="4239833">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4239839">copy</span><span class="op" id="4239843">(</span><span class="ident" id="4239844"><a href="/crypto/tls/prf.go.html#4239807">seed</a></span><span class="op" id="4239848">[</span><span class="num" id="4239849">0</span><span class="op" id="4239850">:</span><span class="builtinfunc" id="4239851">len</span><span class="op" id="4239854">(</span><span class="ident" id="4239855"><a href="/crypto/tls/prf.go.html#4239758">clientRandom</a></span><span class="op" id="4239867">)</span><span class="op" id="4239868">]</span><span class="op" id="4239869">,</span>&nbsp;<span class="ident" id="4239871"><a href="/crypto/tls/prf.go.html#4239758">clientRandom</a></span><span class="op" id="4239883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4239886">copy</span><span class="op" id="4239890">(</span><span class="ident" id="4239891"><a href="/crypto/tls/prf.go.html#4239807">seed</a></span><span class="op" id="4239895">[</span><span class="builtinfunc" id="4239896">len</span><span class="op" id="4239899">(</span><span class="ident" id="4239900"><a href="/crypto/tls/prf.go.html#4239758">clientRandom</a></span><span class="op" id="4239912">)</span><span class="op" id="4239913">:</span><span class="op" id="4239914">]</span><span class="op" id="4239915">,</span>&nbsp;<span class="ident" id="4239917"><a href="/crypto/tls/prf.go.html#4239772">serverRandom</a></span><span class="op" id="4239929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4239932">masterSecret</span>&nbsp;<span class="op" id="4239945">:=</span>&nbsp;<span class="builtinfunc" id="4239948">make</span><span class="op" id="4239952">(</span><span class="op" id="4239953">[</span><span class="op" id="4239954">]</span><span class="builtintype" id="4239955">byte</span><span class="op" id="4239959">,</span>&nbsp;<span class="ident" id="4239961"><a href="/crypto/tls/prf.go.html#4238951">masterSecretLength</a></span><span class="op" id="4239979">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4239982"><a href="/crypto/tls/prf.go.html#4239302">prfForVersion</a></span><span class="op" id="4239995">(</span><span class="ident" id="4239996"><a href="/crypto/tls/prf.go.html#4239725">version</a></span><span class="op" id="4240003">)</span><span class="op" id="4240004">(</span><span class="ident" id="4240005"><a href="/crypto/tls/prf.go.html#4239932">masterSecret</a></span><span class="op" id="4240017">,</span>&nbsp;<span class="ident" id="4240019"><a href="/crypto/tls/prf.go.html#4239741">preMasterSecret</a></span><span class="op" id="4240034">,</span>&nbsp;<span class="ident" id="4240036"><a href="/crypto/tls/prf.go.html#4239100">masterSecretLabel</a></span><span class="op" id="4240053">,</span>&nbsp;<span class="ident" id="4240055"><a href="/crypto/tls/prf.go.html#4239807">seed</a></span><span class="op" id="4240059">[</span><span class="num" id="4240060">0</span><span class="op" id="4240061">:</span><span class="op" id="4240062">]</span><span class="op" id="4240063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4240066">return</span>&nbsp;<span class="ident" id="4240073"><a href="/crypto/tls/prf.go.html#4239932">masterSecret</a></span><br>
<span class="lineno"></span><span class="op" id="4240086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4240089">//&nbsp;keysFromMasterSecret&nbsp;generates&nbsp;the&nbsp;connection&nbsp;keys&nbsp;from&nbsp;the&nbsp;master</span><br>
<span class="lineno">145</span><span class="comment" id="4240159">//&nbsp;secret,&nbsp;given&nbsp;the&nbsp;lengths&nbsp;of&nbsp;the&nbsp;MAC&nbsp;key,&nbsp;cipher&nbsp;key&nbsp;and&nbsp;IV,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4240237">//&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4240263">func</span>&nbsp;<span class="ident" id="4240268">keysFromMasterSecret</span><span class="op" id="4240288">(</span><span class="ident" id="4240289">version</span>&nbsp;<span class="builtintype" id="4240297">uint16</span><span class="op" id="4240303">,</span>&nbsp;<span class="ident" id="4240305">masterSecret</span><span class="op" id="4240317">,</span>&nbsp;<span class="ident" id="4240319">clientRandom</span><span class="op" id="4240331">,</span>&nbsp;<span class="ident" id="4240333">serverRandom</span>&nbsp;<span class="op" id="4240346">[</span><span class="op" id="4240347">]</span><span class="builtintype" id="4240348">byte</span><span class="op" id="4240352">,</span>&nbsp;<span class="ident" id="4240354">macLen</span><span class="op" id="4240360">,</span>&nbsp;<span class="ident" id="4240362">keyLen</span><span class="op" id="4240368">,</span>&nbsp;<span class="ident" id="4240370">ivLen</span>&nbsp;<span class="builtintype" id="4240376">int</span><span class="op" id="4240379">)</span>&nbsp;<span class="op" id="4240381">(</span><span class="ident" id="4240382">clientMAC</span><span class="op" id="4240391">,</span>&nbsp;<span class="ident" id="4240393">serverMAC</span><span class="op" id="4240402">,</span>&nbsp;<span class="ident" id="4240404">clientKey</span><span class="op" id="4240413">,</span>&nbsp;<span class="ident" id="4240415">serverKey</span><span class="op" id="4240424">,</span>&nbsp;<span class="ident" id="4240426">clientIV</span><span class="op" id="4240434">,</span>&nbsp;<span class="ident" id="4240436">serverIV</span>&nbsp;<span class="op" id="4240445">[</span><span class="op" id="4240446">]</span><span class="builtintype" id="4240447">byte</span><span class="op" id="4240451">)</span>&nbsp;<span class="op" id="4240453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4240456">var</span>&nbsp;<span class="ident" id="4240460">seed</span>&nbsp;<span class="op" id="4240465">[</span><span class="ident" id="4240466"><a href="/crypto/tls/prf.go.html#4238884">tlsRandomLength</a></span>&nbsp;<span class="op" id="4240482">*</span>&nbsp;<span class="num" id="4240484">2</span><span class="op" id="4240485">]</span><span class="builtintype" id="4240486">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4240492">copy</span><span class="op" id="4240496">(</span><span class="ident" id="4240497"><a href="/crypto/tls/prf.go.html#4240460">seed</a></span><span class="op" id="4240501">[</span><span class="num" id="4240502">0</span><span class="op" id="4240503">:</span><span class="builtinfunc" id="4240504">len</span><span class="op" id="4240507">(</span><span class="ident" id="4240508"><a href="/crypto/tls/prf.go.html#4240319">clientRandom</a></span><span class="op" id="4240520">)</span><span class="op" id="4240521">]</span><span class="op" id="4240522">,</span>&nbsp;<span class="ident" id="4240524"><a href="/crypto/tls/prf.go.html#4240333">serverRandom</a></span><span class="op" id="4240536">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4240539">copy</span><span class="op" id="4240543">(</span><span class="ident" id="4240544"><a href="/crypto/tls/prf.go.html#4240460">seed</a></span><span class="op" id="4240548">[</span><span class="builtinfunc" id="4240549">len</span><span class="op" id="4240552">(</span><span class="ident" id="4240553"><a href="/crypto/tls/prf.go.html#4240333">serverRandom</a></span><span class="op" id="4240565">)</span><span class="op" id="4240566">:</span><span class="op" id="4240567">]</span><span class="op" id="4240568">,</span>&nbsp;<span class="ident" id="4240570"><a href="/crypto/tls/prf.go.html#4240319">clientRandom</a></span><span class="op" id="4240582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240586">n</span>&nbsp;<span class="op" id="4240588">:=</span>&nbsp;<span class="num" id="4240591">2</span><span class="op" id="4240592">*</span><span class="ident" id="4240593"><a href="/crypto/tls/prf.go.html#4240354">macLen</a></span>&nbsp;<span class="op" id="4240600">+</span>&nbsp;<span class="num" id="4240602">2</span><span class="op" id="4240603">*</span><span class="ident" id="4240604"><a href="/crypto/tls/prf.go.html#4240362">keyLen</a></span>&nbsp;<span class="op" id="4240611">+</span>&nbsp;<span class="num" id="4240613">2</span><span class="op" id="4240614">*</span><span class="ident" id="4240615"><a href="/crypto/tls/prf.go.html#4240370">ivLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240622">keyMaterial</span>&nbsp;<span class="op" id="4240634">:=</span>&nbsp;<span class="builtinfunc" id="4240637">make</span><span class="op" id="4240641">(</span><span class="op" id="4240642">[</span><span class="op" id="4240643">]</span><span class="builtintype" id="4240644">byte</span><span class="op" id="4240648">,</span>&nbsp;<span class="ident" id="4240650"><a href="/crypto/tls/prf.go.html#4240586">n</a></span><span class="op" id="4240651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240654"><a href="/crypto/tls/prf.go.html#4239302">prfForVersion</a></span><span class="op" id="4240667">(</span><span class="ident" id="4240668"><a href="/crypto/tls/prf.go.html#4240289">version</a></span><span class="op" id="4240675">)</span><span class="op" id="4240676">(</span><span class="ident" id="4240677"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240688">,</span>&nbsp;<span class="ident" id="4240690"><a href="/crypto/tls/prf.go.html#4240305">masterSecret</a></span><span class="op" id="4240702">,</span>&nbsp;<span class="ident" id="4240704"><a href="/crypto/tls/prf.go.html#4239148">keyExpansionLabel</a></span><span class="op" id="4240721">,</span>&nbsp;<span class="ident" id="4240723"><a href="/crypto/tls/prf.go.html#4240460">seed</a></span><span class="op" id="4240727">[</span><span class="num" id="4240728">0</span><span class="op" id="4240729">:</span><span class="op" id="4240730">]</span><span class="op" id="4240731">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240734"><a href="/crypto/tls/prf.go.html#4240382">clientMAC</a></span>&nbsp;<span class="op" id="4240744">=</span>&nbsp;<span class="ident" id="4240746"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240757">[</span><span class="op" id="4240758">:</span><span class="ident" id="4240759"><a href="/crypto/tls/prf.go.html#4240354">macLen</a></span><span class="op" id="4240765">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240768"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span>&nbsp;<span class="op" id="4240780">=</span>&nbsp;<span class="ident" id="4240782"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240793">[</span><span class="ident" id="4240794"><a href="/crypto/tls/prf.go.html#4240354">macLen</a></span><span class="op" id="4240800">:</span><span class="op" id="4240801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240804"><a href="/crypto/tls/prf.go.html#4240393">serverMAC</a></span>&nbsp;<span class="op" id="4240814">=</span>&nbsp;<span class="ident" id="4240816"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240827">[</span><span class="op" id="4240828">:</span><span class="ident" id="4240829"><a href="/crypto/tls/prf.go.html#4240354">macLen</a></span><span class="op" id="4240835">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240838"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span>&nbsp;<span class="op" id="4240850">=</span>&nbsp;<span class="ident" id="4240852"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240863">[</span><span class="ident" id="4240864"><a href="/crypto/tls/prf.go.html#4240354">macLen</a></span><span class="op" id="4240870">:</span><span class="op" id="4240871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240874"><a href="/crypto/tls/prf.go.html#4240404">clientKey</a></span>&nbsp;<span class="op" id="4240884">=</span>&nbsp;<span class="ident" id="4240886"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240897">[</span><span class="op" id="4240898">:</span><span class="ident" id="4240899"><a href="/crypto/tls/prf.go.html#4240362">keyLen</a></span><span class="op" id="4240905">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240908"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span>&nbsp;<span class="op" id="4240920">=</span>&nbsp;<span class="ident" id="4240922"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240933">[</span><span class="ident" id="4240934"><a href="/crypto/tls/prf.go.html#4240362">keyLen</a></span><span class="op" id="4240940">:</span><span class="op" id="4240941">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240944"><a href="/crypto/tls/prf.go.html#4240415">serverKey</a></span>&nbsp;<span class="op" id="4240954">=</span>&nbsp;<span class="ident" id="4240956"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4240967">[</span><span class="op" id="4240968">:</span><span class="ident" id="4240969"><a href="/crypto/tls/prf.go.html#4240362">keyLen</a></span><span class="op" id="4240975">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4240978"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span>&nbsp;<span class="op" id="4240990">=</span>&nbsp;<span class="ident" id="4240992"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4241003">[</span><span class="ident" id="4241004"><a href="/crypto/tls/prf.go.html#4240362">keyLen</a></span><span class="op" id="4241010">:</span><span class="op" id="4241011">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241014"><a href="/crypto/tls/prf.go.html#4240426">clientIV</a></span>&nbsp;<span class="op" id="4241023">=</span>&nbsp;<span class="ident" id="4241025"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4241036">[</span><span class="op" id="4241037">:</span><span class="ident" id="4241038"><a href="/crypto/tls/prf.go.html#4240370">ivLen</a></span><span class="op" id="4241043">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241046"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span>&nbsp;<span class="op" id="4241058">=</span>&nbsp;<span class="ident" id="4241060"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4241071">[</span><span class="ident" id="4241072"><a href="/crypto/tls/prf.go.html#4240370">ivLen</a></span><span class="op" id="4241077">:</span><span class="op" id="4241078">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241081"><a href="/crypto/tls/prf.go.html#4240436">serverIV</a></span>&nbsp;<span class="op" id="4241090">=</span>&nbsp;<span class="ident" id="4241092"><a href="/crypto/tls/prf.go.html#4240622">keyMaterial</a></span><span class="op" id="4241103">[</span><span class="op" id="4241104">:</span><span class="ident" id="4241105"><a href="/crypto/tls/prf.go.html#4240370">ivLen</a></span><span class="op" id="4241110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241113">return</span><br>
<span class="lineno"></span><span class="op" id="4241120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4241123">func</span>&nbsp;<span class="ident" id="4241128">newFinishedHash</span><span class="op" id="4241143">(</span><span class="ident" id="4241144">version</span>&nbsp;<span class="builtintype" id="4241152">uint16</span><span class="op" id="4241158">)</span>&nbsp;<span class="ident" id="4241160"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span>&nbsp;<span class="op" id="4241173">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241176">if</span>&nbsp;<span class="ident" id="4241179"><a href="/crypto/tls/prf.go.html#4241144">version</a></span>&nbsp;<span class="op" id="4241187">&gt;=</span>&nbsp;<span class="ident" id="4241190"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span>&nbsp;<span class="op" id="4241203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241207">return</span>&nbsp;<span class="ident" id="4241214"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span><span class="op" id="4241226">{</span><span class="ident" id="4241227"><a href="/crypto/tls/prf.go.html#4236512">sha256</a></span><span class="op" id="4241233">.</span><span class="ident" id="4241234">New</span><span class="op" id="4241237">(</span><span class="op" id="4241238">)</span><span class="op" id="4241239">,</span>&nbsp;<span class="ident" id="4241241"><a href="/crypto/tls/prf.go.html#4236512">sha256</a></span><span class="op" id="4241247">.</span><span class="ident" id="4241248">New</span><span class="op" id="4241251">(</span><span class="op" id="4241252">)</span><span class="op" id="4241253">,</span>&nbsp;<span class="ident" id="4241255">nil</span><span class="op" id="4241258">,</span>&nbsp;<span class="ident" id="4241260">nil</span><span class="op" id="4241263">,</span>&nbsp;<span class="ident" id="4241265"><a href="/crypto/tls/prf.go.html#4241144">version</a></span><span class="op" id="4241272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4241275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241278">return</span>&nbsp;<span class="ident" id="4241285"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span><span class="op" id="4241297">{</span><span class="ident" id="4241298"><a href="/crypto/tls/prf.go.html#4236497">sha1</a></span><span class="op" id="4241302">.</span><span class="ident" id="4241303">New</span><span class="op" id="4241306">(</span><span class="op" id="4241307">)</span><span class="op" id="4241308">,</span>&nbsp;<span class="ident" id="4241310"><a href="/crypto/tls/prf.go.html#4236497">sha1</a></span><span class="op" id="4241314">.</span><span class="ident" id="4241315">New</span><span class="op" id="4241318">(</span><span class="op" id="4241319">)</span><span class="op" id="4241320">,</span>&nbsp;<span class="ident" id="4241322"><a href="/crypto/tls/prf.go.html#4236483">md5</a></span><span class="op" id="4241325">.</span><span class="ident" id="4241326">New</span><span class="op" id="4241329">(</span><span class="op" id="4241330">)</span><span class="op" id="4241331">,</span>&nbsp;<span class="ident" id="4241333"><a href="/crypto/tls/prf.go.html#4236483">md5</a></span><span class="op" id="4241336">.</span><span class="ident" id="4241337">New</span><span class="op" id="4241340">(</span><span class="op" id="4241341">)</span><span class="op" id="4241342">,</span>&nbsp;<span class="ident" id="4241344"><a href="/crypto/tls/prf.go.html#4241144">version</a></span><span class="op" id="4241351">}</span><br>
<span class="lineno"></span><span class="op" id="4241353">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4241356">//&nbsp;A&nbsp;finishedHash&nbsp;calculates&nbsp;the&nbsp;hash&nbsp;of&nbsp;a&nbsp;set&nbsp;of&nbsp;handshake&nbsp;messages&nbsp;suitable</span><br>
<span class="lineno"></span><span class="comment" id="4241434">//&nbsp;for&nbsp;including&nbsp;in&nbsp;a&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="4241474">type</span>&nbsp;<span class="ident" id="4241479">finishedHash</span>&nbsp;<span class="keyword" id="4241492">struct</span>&nbsp;<span class="op" id="4241499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241502">client</span>&nbsp;<span class="ident" id="4241509"><a href="/crypto/tls/prf.go.html#4236529">hash</a></span><span class="op" id="4241513">.</span><span class="ident" id="4241514">Hash</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241520">server</span>&nbsp;<span class="ident" id="4241527"><a href="/crypto/tls/prf.go.html#4236529">hash</a></span><span class="op" id="4241531">.</span><span class="ident" id="4241532">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4241539">//&nbsp;Prior&nbsp;to&nbsp;TLS&nbsp;1.2,&nbsp;an&nbsp;additional&nbsp;MD5&nbsp;hash&nbsp;is&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241597">clientMD5</span>&nbsp;<span class="ident" id="4241607"><a href="/crypto/tls/prf.go.html#4236529">hash</a></span><span class="op" id="4241611">.</span><span class="ident" id="4241612">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241618">serverMD5</span>&nbsp;<span class="ident" id="4241628"><a href="/crypto/tls/prf.go.html#4236529">hash</a></span><span class="op" id="4241632">.</span><span class="ident" id="4241633">Hash</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241640">version</span>&nbsp;<span class="builtintype" id="4241648">uint16</span><br>
<span class="lineno"></span><span class="op" id="4241655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4241658">func</span>&nbsp;<span class="op" id="4241663">(</span><span class="ident" id="4241664">h</span>&nbsp;<span class="ident" id="4241666"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span><span class="op" id="4241678">)</span>&nbsp;<span class="ident" id="4241680">Write</span><span class="op" id="4241685">(</span><span class="ident" id="4241686">msg</span>&nbsp;<span class="op" id="4241690">[</span><span class="op" id="4241691">]</span><span class="builtintype" id="4241692">byte</span><span class="op" id="4241696">)</span>&nbsp;<span class="op" id="4241698">(</span><span class="ident" id="4241699">n</span>&nbsp;<span class="builtintype" id="4241701">int</span><span class="op" id="4241704">,</span>&nbsp;<span class="ident" id="4241706">err</span>&nbsp;<span class="builtintype" id="4241710">error</span><span class="op" id="4241715">)</span>&nbsp;<span class="op" id="4241717">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241720"><a href="/crypto/tls/prf.go.html#4241664">h</a></span><span class="op" id="4241721">.</span><span class="ident" id="4241722">client</span><span class="op" id="4241728">.</span><span class="ident" id="4241729">Write</span><span class="op" id="4241734">(</span><span class="ident" id="4241735"><a href="/crypto/tls/prf.go.html#4241686">msg</a></span><span class="op" id="4241738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241741"><a href="/crypto/tls/prf.go.html#4241664">h</a></span><span class="op" id="4241742">.</span><span class="ident" id="4241743">server</span><span class="op" id="4241749">.</span><span class="ident" id="4241750">Write</span><span class="op" id="4241755">(</span><span class="ident" id="4241756"><a href="/crypto/tls/prf.go.html#4241686">msg</a></span><span class="op" id="4241759">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241763">if</span>&nbsp;<span class="ident" id="4241766"><a href="/crypto/tls/prf.go.html#4241664">h</a></span><span class="op" id="4241767">.</span><span class="ident" id="4241768">version</span>&nbsp;<span class="op" id="4241776">&lt;</span>&nbsp;<span class="ident" id="4241778"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span>&nbsp;<span class="op" id="4241791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241795"><a href="/crypto/tls/prf.go.html#4241664">h</a></span><span class="op" id="4241796">.</span><span class="ident" id="4241797">clientMD5</span><span class="op" id="4241806">.</span><span class="ident" id="4241807">Write</span><span class="op" id="4241812">(</span><span class="ident" id="4241813"><a href="/crypto/tls/prf.go.html#4241686">msg</a></span><span class="op" id="4241816">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4241820"><a href="/crypto/tls/prf.go.html#4241664">h</a></span><span class="op" id="4241821">.</span><span class="ident" id="4241822">serverMD5</span><span class="op" id="4241831">.</span><span class="ident" id="4241832">Write</span><span class="op" id="4241837">(</span><span class="ident" id="4241838"><a href="/crypto/tls/prf.go.html#4241686">msg</a></span><span class="op" id="4241841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4241844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4241847">return</span>&nbsp;<span class="builtinfunc" id="4241854">len</span><span class="op" id="4241857">(</span><span class="ident" id="4241858"><a href="/crypto/tls/prf.go.html#4241686">msg</a></span><span class="op" id="4241861">)</span><span class="op" id="4241862">,</span>&nbsp;<span class="ident" id="4241864">nil</span><br>
<span class="lineno"></span><span class="op" id="4241868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="4241871">//&nbsp;finishedSum30&nbsp;calculates&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;SSLv3</span><br>
<span class="lineno"></span><span class="comment" id="4241949">//&nbsp;Finished&nbsp;message&nbsp;given&nbsp;the&nbsp;MD5&nbsp;and&nbsp;SHA1&nbsp;hashes&nbsp;of&nbsp;a&nbsp;set&nbsp;of&nbsp;handshake</span><br>
<span class="lineno"></span><span class="comment" id="4242021">//&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="4242034">func</span>&nbsp;<span class="ident" id="4242039">finishedSum30</span><span class="op" id="4242052">(</span><span class="ident" id="4242053">md5</span><span class="op" id="4242056">,</span>&nbsp;<span class="ident" id="4242058">sha1</span>&nbsp;<span class="ident" id="4242063"><a href="/crypto/tls/prf.go.html#4236529">hash</a></span><span class="op" id="4242067">.</span><span class="ident" id="4242068">Hash</span><span class="op" id="4242072">,</span>&nbsp;<span class="ident" id="4242074">masterSecret</span>&nbsp;<span class="op" id="4242087">[</span><span class="op" id="4242088">]</span><span class="builtintype" id="4242089">byte</span><span class="op" id="4242093">,</span>&nbsp;<span class="ident" id="4242095">magic</span>&nbsp;<span class="op" id="4242101">[</span><span class="num" id="4242102">4</span><span class="op" id="4242103">]</span><span class="builtintype" id="4242104">byte</span><span class="op" id="4242108">)</span>&nbsp;<span class="op" id="4242110">[</span><span class="op" id="4242111">]</span><span class="builtintype" id="4242112">byte</span>&nbsp;<span class="op" id="4242117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242120"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242123">.</span><span class="ident" id="4242124">Write</span><span class="op" id="4242129">(</span><span class="ident" id="4242130"><a href="/crypto/tls/prf.go.html#4242095">magic</a></span><span class="op" id="4242135">[</span><span class="op" id="4242136">:</span><span class="op" id="4242137">]</span><span class="op" id="4242138">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242141"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242144">.</span><span class="ident" id="4242145">Write</span><span class="op" id="4242150">(</span><span class="ident" id="4242151"><a href="/crypto/tls/prf.go.html#4242074">masterSecret</a></span><span class="op" id="4242163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242166"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242169">.</span><span class="ident" id="4242170">Write</span><span class="op" id="4242175">(</span><span class="ident" id="4242176"><a href="/crypto/tls/cipher_suites.go.html#4104657">ssl30Pad1</a></span><span class="op" id="4242185">[</span><span class="op" id="4242186">:</span><span class="op" id="4242187">]</span><span class="op" id="4242188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242191">md5Digest</span>&nbsp;<span class="op" id="4242201">:=</span>&nbsp;<span class="ident" id="4242204"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242207">.</span><span class="ident" id="4242208">Sum</span><span class="op" id="4242211">(</span><span class="ident" id="4242212">nil</span><span class="op" id="4242215">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242219"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242222">.</span><span class="ident" id="4242223">Reset</span><span class="op" id="4242228">(</span><span class="op" id="4242229">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242232"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242235">.</span><span class="ident" id="4242236">Write</span><span class="op" id="4242241">(</span><span class="ident" id="4242242"><a href="/crypto/tls/prf.go.html#4242074">masterSecret</a></span><span class="op" id="4242254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242257"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242260">.</span><span class="ident" id="4242261">Write</span><span class="op" id="4242266">(</span><span class="ident" id="4242267"><a href="/crypto/tls/cipher_suites.go.html#4104971">ssl30Pad2</a></span><span class="op" id="4242276">[</span><span class="op" id="4242277">:</span><span class="op" id="4242278">]</span><span class="op" id="4242279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242282"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242285">.</span><span class="ident" id="4242286">Write</span><span class="op" id="4242291">(</span><span class="ident" id="4242292"><a href="/crypto/tls/prf.go.html#4242191">md5Digest</a></span><span class="op" id="4242301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242304"><a href="/crypto/tls/prf.go.html#4242191">md5Digest</a></span>&nbsp;<span class="op" id="4242314">=</span>&nbsp;<span class="ident" id="4242316"><a href="/crypto/tls/prf.go.html#4242053">md5</a></span><span class="op" id="4242319">.</span><span class="ident" id="4242320">Sum</span><span class="op" id="4242323">(</span><span class="ident" id="4242324">nil</span><span class="op" id="4242327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242331"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242335">.</span><span class="ident" id="4242336">Write</span><span class="op" id="4242341">(</span><span class="ident" id="4242342"><a href="/crypto/tls/prf.go.html#4242095">magic</a></span><span class="op" id="4242347">[</span><span class="op" id="4242348">:</span><span class="op" id="4242349">]</span><span class="op" id="4242350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242353"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242357">.</span><span class="ident" id="4242358">Write</span><span class="op" id="4242363">(</span><span class="ident" id="4242364"><a href="/crypto/tls/prf.go.html#4242074">masterSecret</a></span><span class="op" id="4242376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242379"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242383">.</span><span class="ident" id="4242384">Write</span><span class="op" id="4242389">(</span><span class="ident" id="4242390"><a href="/crypto/tls/cipher_suites.go.html#4104657">ssl30Pad1</a></span><span class="op" id="4242399">[</span><span class="op" id="4242400">:</span><span class="num" id="4242401">40</span><span class="op" id="4242403">]</span><span class="op" id="4242404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242407">sha1Digest</span>&nbsp;<span class="op" id="4242418">:=</span>&nbsp;<span class="ident" id="4242421"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242425">.</span><span class="ident" id="4242426">Sum</span><span class="op" id="4242429">(</span><span class="ident" id="4242430">nil</span><span class="op" id="4242433">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242437"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242441">.</span><span class="ident" id="4242442">Reset</span><span class="op" id="4242447">(</span><span class="op" id="4242448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242451"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242455">.</span><span class="ident" id="4242456">Write</span><span class="op" id="4242461">(</span><span class="ident" id="4242462"><a href="/crypto/tls/prf.go.html#4242074">masterSecret</a></span><span class="op" id="4242474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242477"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242481">.</span><span class="ident" id="4242482">Write</span><span class="op" id="4242487">(</span><span class="ident" id="4242488"><a href="/crypto/tls/cipher_suites.go.html#4104971">ssl30Pad2</a></span><span class="op" id="4242497">[</span><span class="op" id="4242498">:</span><span class="num" id="4242499">40</span><span class="op" id="4242501">]</span><span class="op" id="4242502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242505"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242509">.</span><span class="ident" id="4242510">Write</span><span class="op" id="4242515">(</span><span class="ident" id="4242516"><a href="/crypto/tls/prf.go.html#4242407">sha1Digest</a></span><span class="op" id="4242526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242529"><a href="/crypto/tls/prf.go.html#4242407">sha1Digest</a></span>&nbsp;<span class="op" id="4242540">=</span>&nbsp;<span class="ident" id="4242542"><a href="/crypto/tls/prf.go.html#4242058">sha1</a></span><span class="op" id="4242546">.</span><span class="ident" id="4242547">Sum</span><span class="op" id="4242550">(</span><span class="ident" id="4242551">nil</span><span class="op" id="4242554">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4242558">ret</span>&nbsp;<span class="op" id="4242562">:=</span>&nbsp;<span class="builtinfunc" id="4242565">make</span><span class="op" id="4242569">(</span><span class="op" id="4242570">[</span><span class="op" id="4242571">]</span><span class="builtintype" id="4242572">byte</span><span class="op" id="4242576">,</span>&nbsp;<span class="builtinfunc" id="4242578">len</span><span class="op" id="4242581">(</span><span class="ident" id="4242582"><a href="/crypto/tls/prf.go.html#4242191">md5Digest</a></span><span class="op" id="4242591">)</span><span class="op" id="4242592">+</span><span class="builtinfunc" id="4242593">len</span><span class="op" id="4242596">(</span><span class="ident" id="4242597"><a href="/crypto/tls/prf.go.html#4242407">sha1Digest</a></span><span class="op" id="4242607">)</span><span class="op" id="4242608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4242611">copy</span><span class="op" id="4242615">(</span><span class="ident" id="4242616"><a href="/crypto/tls/prf.go.html#4242558">ret</a></span><span class="op" id="4242619">,</span>&nbsp;<span class="ident" id="4242621"><a href="/crypto/tls/prf.go.html#4242191">md5Digest</a></span><span class="op" id="4242630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4242633">copy</span><span class="op" id="4242637">(</span><span class="ident" id="4242638"><a href="/crypto/tls/prf.go.html#4242558">ret</a></span><span class="op" id="4242641">[</span><span class="builtinfunc" id="4242642">len</span><span class="op" id="4242645">(</span><span class="ident" id="4242646"><a href="/crypto/tls/prf.go.html#4242191">md5Digest</a></span><span class="op" id="4242655">)</span><span class="op" id="4242656">:</span><span class="op" id="4242657">]</span><span class="op" id="4242658">,</span>&nbsp;<span class="ident" id="4242660"><a href="/crypto/tls/prf.go.html#4242407">sha1Digest</a></span><span class="op" id="4242670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242673">return</span>&nbsp;<span class="ident" id="4242680"><a href="/crypto/tls/prf.go.html#4242558">ret</a></span><br>
<span class="lineno">230</span><span class="op" id="4242684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4242687">var</span>&nbsp;<span class="ident" id="4242691">ssl3ClientFinishedMagic</span>&nbsp;<span class="op" id="4242715">=</span>&nbsp;<span class="op" id="4242717">[</span><span class="num" id="4242718">4</span><span class="op" id="4242719">]</span><span class="builtintype" id="4242720">byte</span><span class="op" id="4242724">{</span><span class="num" id="4242725">0x43</span><span class="op" id="4242729">,</span>&nbsp;<span class="num" id="4242731">0x4c</span><span class="op" id="4242735">,</span>&nbsp;<span class="num" id="4242737">0x4e</span><span class="op" id="4242741">,</span>&nbsp;<span class="num" id="4242743">0x54</span><span class="op" id="4242747">}</span><br>
<span class="lineno"></span><span class="keyword" id="4242749">var</span>&nbsp;<span class="ident" id="4242753">ssl3ServerFinishedMagic</span>&nbsp;<span class="op" id="4242777">=</span>&nbsp;<span class="op" id="4242779">[</span><span class="num" id="4242780">4</span><span class="op" id="4242781">]</span><span class="builtintype" id="4242782">byte</span><span class="op" id="4242786">{</span><span class="num" id="4242787">0x53</span><span class="op" id="4242791">,</span>&nbsp;<span class="num" id="4242793">0x52</span><span class="op" id="4242797">,</span>&nbsp;<span class="num" id="4242799">0x56</span><span class="op" id="4242803">,</span>&nbsp;<span class="num" id="4242805">0x52</span><span class="op" id="4242809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="4242812">//&nbsp;clientSum&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;client&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4242886">//&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="4242907">func</span>&nbsp;<span class="op" id="4242912">(</span><span class="ident" id="4242913">h</span>&nbsp;<span class="ident" id="4242915"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span><span class="op" id="4242927">)</span>&nbsp;<span class="ident" id="4242929">clientSum</span><span class="op" id="4242938">(</span><span class="ident" id="4242939">masterSecret</span>&nbsp;<span class="op" id="4242952">[</span><span class="op" id="4242953">]</span><span class="builtintype" id="4242954">byte</span><span class="op" id="4242958">)</span>&nbsp;<span class="op" id="4242960">[</span><span class="op" id="4242961">]</span><span class="builtintype" id="4242962">byte</span>&nbsp;<span class="op" id="4242967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4242970">if</span>&nbsp;<span class="ident" id="4242973"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4242974">.</span><span class="ident" id="4242975">version</span>&nbsp;<span class="op" id="4242983">==</span>&nbsp;<span class="ident" id="4242986"><a href="/crypto/tls/common.go.html#4108136">VersionSSL30</a></span>&nbsp;<span class="op" id="4242999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243003">return</span>&nbsp;<span class="ident" id="4243010"><a href="/crypto/tls/prf.go.html#4242039">finishedSum30</a></span><span class="op" id="4243023">(</span><span class="ident" id="4243024"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4243025">.</span><span class="ident" id="4243026">clientMD5</span><span class="op" id="4243035">,</span>&nbsp;<span class="ident" id="4243037"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4243038">.</span><span class="ident" id="4243039">client</span><span class="op" id="4243045">,</span>&nbsp;<span class="ident" id="4243047"><a href="/crypto/tls/prf.go.html#4242939">masterSecret</a></span><span class="op" id="4243059">,</span>&nbsp;<span class="ident" id="4243061"><a href="/crypto/tls/prf.go.html#4242691">ssl3ClientFinishedMagic</a></span><span class="op" id="4243084">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243091">out</span>&nbsp;<span class="op" id="4243095">:=</span>&nbsp;<span class="builtinfunc" id="4243098">make</span><span class="op" id="4243102">(</span><span class="op" id="4243103">[</span><span class="op" id="4243104">]</span><span class="builtintype" id="4243105">byte</span><span class="op" id="4243109">,</span>&nbsp;<span class="ident" id="4243111"><a href="/crypto/tls/prf.go.html#4239019">finishedVerifyLength</a></span><span class="op" id="4243131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243134">if</span>&nbsp;<span class="ident" id="4243137"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4243138">.</span><span class="ident" id="4243139">version</span>&nbsp;<span class="op" id="4243147">&gt;=</span>&nbsp;<span class="ident" id="4243150"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span>&nbsp;<span class="op" id="4243163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243167">seed</span>&nbsp;<span class="op" id="4243172">:=</span>&nbsp;<span class="ident" id="4243175"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4243176">.</span><span class="ident" id="4243177">client</span><span class="op" id="4243183">.</span><span class="ident" id="4243184">Sum</span><span class="op" id="4243187">(</span><span class="ident" id="4243188">nil</span><span class="op" id="4243191">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243195"><a href="/crypto/tls/prf.go.html#4237818">prf12</a></span><span class="op" id="4243200">(</span><span class="ident" id="4243201"><a href="/crypto/tls/prf.go.html#4243091">out</a></span><span class="op" id="4243204">,</span>&nbsp;<span class="ident" id="4243206"><a href="/crypto/tls/prf.go.html#4242939">masterSecret</a></span><span class="op" id="4243218">,</span>&nbsp;<span class="ident" id="4243220"><a href="/crypto/tls/prf.go.html#4239196">clientFinishedLabel</a></span><span class="op" id="4243239">,</span>&nbsp;<span class="ident" id="4243241"><a href="/crypto/tls/prf.go.html#4243167">seed</a></span><span class="op" id="4243245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243248">}</span>&nbsp;<span class="keyword" id="4243250">else</span>&nbsp;<span class="op" id="4243255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243259">seed</span>&nbsp;<span class="op" id="4243264">:=</span>&nbsp;<span class="builtinfunc" id="4243267">make</span><span class="op" id="4243271">(</span><span class="op" id="4243272">[</span><span class="op" id="4243273">]</span><span class="builtintype" id="4243274">byte</span><span class="op" id="4243278">,</span>&nbsp;<span class="num" id="4243280">0</span><span class="op" id="4243281">,</span>&nbsp;<span class="ident" id="4243283"><a href="/crypto/tls/prf.go.html#4236483">md5</a></span><span class="op" id="4243286">.</span><span class="ident" id="4243287">Size</span><span class="op" id="4243291">+</span><span class="ident" id="4243292"><a href="/crypto/tls/prf.go.html#4236497">sha1</a></span><span class="op" id="4243296">.</span><span class="ident" id="4243297">Size</span><span class="op" id="4243301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243305"><a href="/crypto/tls/prf.go.html#4243259">seed</a></span>&nbsp;<span class="op" id="4243310">=</span>&nbsp;<span class="ident" id="4243312"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4243313">.</span><span class="ident" id="4243314">clientMD5</span><span class="op" id="4243323">.</span><span class="ident" id="4243324">Sum</span><span class="op" id="4243327">(</span><span class="ident" id="4243328"><a href="/crypto/tls/prf.go.html#4243259">seed</a></span><span class="op" id="4243332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243336"><a href="/crypto/tls/prf.go.html#4243259">seed</a></span>&nbsp;<span class="op" id="4243341">=</span>&nbsp;<span class="ident" id="4243343"><a href="/crypto/tls/prf.go.html#4242913">h</a></span><span class="op" id="4243344">.</span><span class="ident" id="4243345">client</span><span class="op" id="4243351">.</span><span class="ident" id="4243352">Sum</span><span class="op" id="4243355">(</span><span class="ident" id="4243356"><a href="/crypto/tls/prf.go.html#4243259">seed</a></span><span class="op" id="4243360">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243364"><a href="/crypto/tls/prf.go.html#4237299">prf10</a></span><span class="op" id="4243369">(</span><span class="ident" id="4243370"><a href="/crypto/tls/prf.go.html#4243091">out</a></span><span class="op" id="4243373">,</span>&nbsp;<span class="ident" id="4243375"><a href="/crypto/tls/prf.go.html#4242939">masterSecret</a></span><span class="op" id="4243387">,</span>&nbsp;<span class="ident" id="4243389"><a href="/crypto/tls/prf.go.html#4239196">clientFinishedLabel</a></span><span class="op" id="4243408">,</span>&nbsp;<span class="ident" id="4243410"><a href="/crypto/tls/prf.go.html#4243259">seed</a></span><span class="op" id="4243414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243420">return</span>&nbsp;<span class="ident" id="4243427"><a href="/crypto/tls/prf.go.html#4243091">out</a></span><br>
<span class="lineno"></span><span class="op" id="4243431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4243434">//&nbsp;serverSum&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;server&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4243508">//&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="4243529">func</span>&nbsp;<span class="op" id="4243534">(</span><span class="ident" id="4243535">h</span>&nbsp;<span class="ident" id="4243537"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span><span class="op" id="4243549">)</span>&nbsp;<span class="ident" id="4243551">serverSum</span><span class="op" id="4243560">(</span><span class="ident" id="4243561">masterSecret</span>&nbsp;<span class="op" id="4243574">[</span><span class="op" id="4243575">]</span><span class="builtintype" id="4243576">byte</span><span class="op" id="4243580">)</span>&nbsp;<span class="op" id="4243582">[</span><span class="op" id="4243583">]</span><span class="builtintype" id="4243584">byte</span>&nbsp;<span class="op" id="4243589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243592">if</span>&nbsp;<span class="ident" id="4243595"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243596">.</span><span class="ident" id="4243597">version</span>&nbsp;<span class="op" id="4243605">==</span>&nbsp;<span class="ident" id="4243608"><a href="/crypto/tls/common.go.html#4108136">VersionSSL30</a></span>&nbsp;<span class="op" id="4243621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243625">return</span>&nbsp;<span class="ident" id="4243632"><a href="/crypto/tls/prf.go.html#4242039">finishedSum30</a></span><span class="op" id="4243645">(</span><span class="ident" id="4243646"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243647">.</span><span class="ident" id="4243648">serverMD5</span><span class="op" id="4243657">,</span>&nbsp;<span class="ident" id="4243659"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243660">.</span><span class="ident" id="4243661">server</span><span class="op" id="4243667">,</span>&nbsp;<span class="ident" id="4243669"><a href="/crypto/tls/prf.go.html#4243561">masterSecret</a></span><span class="op" id="4243681">,</span>&nbsp;<span class="ident" id="4243683"><a href="/crypto/tls/prf.go.html#4242753">ssl3ServerFinishedMagic</a></span><span class="op" id="4243706">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243713">out</span>&nbsp;<span class="op" id="4243717">:=</span>&nbsp;<span class="builtinfunc" id="4243720">make</span><span class="op" id="4243724">(</span><span class="op" id="4243725">[</span><span class="op" id="4243726">]</span><span class="builtintype" id="4243727">byte</span><span class="op" id="4243731">,</span>&nbsp;<span class="ident" id="4243733"><a href="/crypto/tls/prf.go.html#4239019">finishedVerifyLength</a></span><span class="op" id="4243753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4243756">if</span>&nbsp;<span class="ident" id="4243759"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243760">.</span><span class="ident" id="4243761">version</span>&nbsp;<span class="op" id="4243769">&gt;=</span>&nbsp;<span class="ident" id="4243772"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span>&nbsp;<span class="op" id="4243785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243789">seed</span>&nbsp;<span class="op" id="4243794">:=</span>&nbsp;<span class="ident" id="4243797"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243798">.</span><span class="ident" id="4243799">server</span><span class="op" id="4243805">.</span><span class="ident" id="4243806">Sum</span><span class="op" id="4243809">(</span><span class="ident" id="4243810">nil</span><span class="op" id="4243813">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243817"><a href="/crypto/tls/prf.go.html#4237818">prf12</a></span><span class="op" id="4243822">(</span><span class="ident" id="4243823"><a href="/crypto/tls/prf.go.html#4243713">out</a></span><span class="op" id="4243826">,</span>&nbsp;<span class="ident" id="4243828"><a href="/crypto/tls/prf.go.html#4243561">masterSecret</a></span><span class="op" id="4243840">,</span>&nbsp;<span class="ident" id="4243842"><a href="/crypto/tls/prf.go.html#4239248">serverFinishedLabel</a></span><span class="op" id="4243861">,</span>&nbsp;<span class="ident" id="4243863"><a href="/crypto/tls/prf.go.html#4243789">seed</a></span><span class="op" id="4243867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4243870">}</span>&nbsp;<span class="keyword" id="4243872">else</span>&nbsp;<span class="op" id="4243877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243881">seed</span>&nbsp;<span class="op" id="4243886">:=</span>&nbsp;<span class="builtinfunc" id="4243889">make</span><span class="op" id="4243893">(</span><span class="op" id="4243894">[</span><span class="op" id="4243895">]</span><span class="builtintype" id="4243896">byte</span><span class="op" id="4243900">,</span>&nbsp;<span class="num" id="4243902">0</span><span class="op" id="4243903">,</span>&nbsp;<span class="ident" id="4243905"><a href="/crypto/tls/prf.go.html#4236483">md5</a></span><span class="op" id="4243908">.</span><span class="ident" id="4243909">Size</span><span class="op" id="4243913">+</span><span class="ident" id="4243914"><a href="/crypto/tls/prf.go.html#4236497">sha1</a></span><span class="op" id="4243918">.</span><span class="ident" id="4243919">Size</span><span class="op" id="4243923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243927"><a href="/crypto/tls/prf.go.html#4243881">seed</a></span>&nbsp;<span class="op" id="4243932">=</span>&nbsp;<span class="ident" id="4243934"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243935">.</span><span class="ident" id="4243936">serverMD5</span><span class="op" id="4243945">.</span><span class="ident" id="4243946">Sum</span><span class="op" id="4243949">(</span><span class="ident" id="4243950"><a href="/crypto/tls/prf.go.html#4243881">seed</a></span><span class="op" id="4243954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243958"><a href="/crypto/tls/prf.go.html#4243881">seed</a></span>&nbsp;<span class="op" id="4243963">=</span>&nbsp;<span class="ident" id="4243965"><a href="/crypto/tls/prf.go.html#4243535">h</a></span><span class="op" id="4243966">.</span><span class="ident" id="4243967">server</span><span class="op" id="4243973">.</span><span class="ident" id="4243974">Sum</span><span class="op" id="4243977">(</span><span class="ident" id="4243978"><a href="/crypto/tls/prf.go.html#4243881">seed</a></span><span class="op" id="4243982">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4243986"><a href="/crypto/tls/prf.go.html#4237299">prf10</a></span><span class="op" id="4243991">(</span><span class="ident" id="4243992"><a href="/crypto/tls/prf.go.html#4243713">out</a></span><span class="op" id="4243995">,</span>&nbsp;<span class="ident" id="4243997"><a href="/crypto/tls/prf.go.html#4243561">masterSecret</a></span><span class="op" id="4244009">,</span>&nbsp;<span class="ident" id="4244011"><a href="/crypto/tls/prf.go.html#4239248">serverFinishedLabel</a></span><span class="op" id="4244030">,</span>&nbsp;<span class="ident" id="4244032"><a href="/crypto/tls/prf.go.html#4243881">seed</a></span><span class="op" id="4244036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4244039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4244042">return</span>&nbsp;<span class="ident" id="4244049"><a href="/crypto/tls/prf.go.html#4243713">out</a></span><br>
<span class="lineno"></span><span class="op" id="4244053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4244056">//&nbsp;hashForClientCertificate&nbsp;returns&nbsp;a&nbsp;digest,&nbsp;hash&nbsp;function,&nbsp;and&nbsp;TLS&nbsp;1.2&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4244134">//&nbsp;id&nbsp;suitable&nbsp;for&nbsp;signing&nbsp;by&nbsp;a&nbsp;TLS&nbsp;client&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4244190">func</span>&nbsp;<span class="op" id="4244195">(</span><span class="ident" id="4244196">h</span>&nbsp;<span class="ident" id="4244198"><a href="/crypto/tls/prf.go.html#4241479">finishedHash</a></span><span class="op" id="4244210">)</span>&nbsp;<span class="ident" id="4244212">hashForClientCertificate</span><span class="op" id="4244236">(</span><span class="ident" id="4244237">sigType</span>&nbsp;<span class="builtintype" id="4244245">uint8</span><span class="op" id="4244250">)</span>&nbsp;<span class="op" id="4244252">(</span><span class="op" id="4244253">[</span><span class="op" id="4244254">]</span><span class="builtintype" id="4244255">byte</span><span class="op" id="4244259">,</span>&nbsp;<span class="ident" id="4244261"><a href="/crypto/tls/prf.go.html#4236458">crypto</a></span><span class="op" id="4244267">.</span><span class="ident" id="4244268">Hash</span><span class="op" id="4244272">,</span>&nbsp;<span class="builtintype" id="4244274">uint8</span><span class="op" id="4244279">)</span>&nbsp;<span class="op" id="4244281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4244284">if</span>&nbsp;<span class="ident" id="4244287"><a href="/crypto/tls/prf.go.html#4244196">h</a></span><span class="op" id="4244288">.</span><span class="ident" id="4244289">version</span>&nbsp;<span class="op" id="4244297">&gt;=</span>&nbsp;<span class="ident" id="4244300"><a href="/crypto/tls/common.go.html#4108205">VersionTLS12</a></span>&nbsp;<span class="op" id="4244313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4244317">digest</span>&nbsp;<span class="op" id="4244324">:=</span>&nbsp;<span class="ident" id="4244327"><a href="/crypto/tls/prf.go.html#4244196">h</a></span><span class="op" id="4244328">.</span><span class="ident" id="4244329">server</span><span class="op" id="4244335">.</span><span class="ident" id="4244336">Sum</span><span class="op" id="4244339">(</span><span class="ident" id="4244340">nil</span><span class="op" id="4244343">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4244347">return</span>&nbsp;<span class="ident" id="4244354"><a href="/crypto/tls/prf.go.html#4244317">digest</a></span><span class="op" id="4244360">,</span>&nbsp;<span class="ident" id="4244362"><a href="/crypto/tls/prf.go.html#4236458">crypto</a></span><span class="op" id="4244368">.</span><span class="ident" id="4244369">SHA256</span><span class="op" id="4244375">,</span>&nbsp;<span class="ident" id="4244377"><a href="/crypto/tls/common.go.html#4111189">hashSHA256</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4244389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4244392">if</span>&nbsp;<span class="ident" id="4244395"><a href="/crypto/tls/prf.go.html#4244237">sigType</a></span>&nbsp;<span class="op" id="4244403">==</span>&nbsp;<span class="ident" id="4244406"><a href="/crypto/tls/common.go.html#4111314">signatureECDSA</a></span>&nbsp;<span class="op" id="4244421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4244425">digest</span>&nbsp;<span class="op" id="4244432">:=</span>&nbsp;<span class="ident" id="4244435"><a href="/crypto/tls/prf.go.html#4244196">h</a></span><span class="op" id="4244436">.</span><span class="ident" id="4244437">server</span><span class="op" id="4244443">.</span><span class="ident" id="4244444">Sum</span><span class="op" id="4244447">(</span><span class="ident" id="4244448">nil</span><span class="op" id="4244451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4244455">return</span>&nbsp;<span class="ident" id="4244462"><a href="/crypto/tls/prf.go.html#4244425">digest</a></span><span class="op" id="4244468">,</span>&nbsp;<span class="ident" id="4244470"><a href="/crypto/tls/prf.go.html#4236458">crypto</a></span><span class="op" id="4244476">.</span><span class="ident" id="4244477">SHA1</span><span class="op" id="4244481">,</span>&nbsp;<span class="ident" id="4244483"><a href="/crypto/tls/common.go.html#4111167">hashSHA1</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4244493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4244497">digest</span>&nbsp;<span class="op" id="4244504">:=</span>&nbsp;<span class="builtinfunc" id="4244507">make</span><span class="op" id="4244511">(</span><span class="op" id="4244512">[</span><span class="op" id="4244513">]</span><span class="builtintype" id="4244514">byte</span><span class="op" id="4244518">,</span>&nbsp;<span class="num" id="4244520">0</span><span class="op" id="4244521">,</span>&nbsp;<span class="num" id="4244523">36</span><span class="op" id="4244525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4244528"><a href="/crypto/tls/prf.go.html#4244497">digest</a></span>&nbsp;<span class="op" id="4244535">=</span>&nbsp;<span class="ident" id="4244537"><a href="/crypto/tls/prf.go.html#4244196">h</a></span><span class="op" id="4244538">.</span><span class="ident" id="4244539">serverMD5</span><span class="op" id="4244548">.</span><span class="ident" id="4244549">Sum</span><span class="op" id="4244552">(</span><span class="ident" id="4244553"><a href="/crypto/tls/prf.go.html#4244497">digest</a></span><span class="op" id="4244559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4244562"><a href="/crypto/tls/prf.go.html#4244497">digest</a></span>&nbsp;<span class="op" id="4244569">=</span>&nbsp;<span class="ident" id="4244571"><a href="/crypto/tls/prf.go.html#4244196">h</a></span><span class="op" id="4244572">.</span><span class="ident" id="4244573">server</span><span class="op" id="4244579">.</span><span class="ident" id="4244580">Sum</span><span class="op" id="4244583">(</span><span class="ident" id="4244584"><a href="/crypto/tls/prf.go.html#4244497">digest</a></span><span class="op" id="4244590">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4244593">return</span>&nbsp;<span class="ident" id="4244600"><a href="/crypto/tls/prf.go.html#4244497">digest</a></span><span class="op" id="4244606">,</span>&nbsp;<span class="ident" id="4244608"><a href="/crypto/tls/prf.go.html#4236458">crypto</a></span><span class="op" id="4244614">.</span><span class="ident" id="4244615">MD5SHA1</span><span class="op" id="4244622">,</span>&nbsp;<span class="num" id="4244624">0</span>&nbsp;<span class="comment" id="4244626">/*&nbsp;not&nbsp;specified&nbsp;in&nbsp;TLS&nbsp;1.2.&nbsp;*/</span><br>
<span class="lineno"></span><span class="op" id="4244658">}</span>
</div>
</body>
</html>
