<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1548365">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1548420">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1548474">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1548525">package</span>&nbsp;<span class="ident" id="1548533">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1548539">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1548589">//</span><br>
<span class="lineno"></span><span class="comment" id="1548592">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="1548614">//&nbsp;&nbsp;&nbsp;&nbspExp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1548634">//&nbsp;&nbsp;&nbsp;&nbspExp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1548652">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="1548696">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="1548733">func</span>&nbsp;<span class="ident" id="1548738">Exp</span><span class="op" id="1548741">(</span><span class="ident" id="1548742">x</span>&nbsp;<span class="builtintype" id="1548744">float64</span><span class="op" id="1548751">)</span>&nbsp;<span class="builtintype" id="1548753">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="1548762">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1548822">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="1548880">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1548939">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="1548969">//</span><br>
<span class="lineno"></span><span class="comment" id="1548972">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1549028">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1549097">//</span><br>
<span class="lineno"></span><span class="comment" id="1549100">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="1549156">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1549213">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1549230">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1549286">//</span><br>
<span class="lineno"></span><span class="comment" id="1549289">//</span><br>
<span class="lineno">30</span><span class="comment" id="1549292">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="1549302">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1549335">//</span><br>
<span class="lineno"></span><span class="comment" id="1549338">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="1549348">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="1549376">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="1549435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1549483">//</span><br>
<span class="lineno"></span><span class="comment" id="1549486">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="1549535">//</span><br>
<span class="lineno">40</span><span class="comment" id="1549538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="1549597">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="1549615">//</span><br>
<span class="lineno"></span><span class="comment" id="1549618">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1549684">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="1549718">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="1549732">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1549807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1549875">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1549944">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="1550010">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1550031">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="1550101">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="1550168">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1550180">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="1550232">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="1550281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1550325">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="1550372">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="1550407">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="1550444">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1550480">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1550523">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="1550590">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="1550634">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="1550648">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="1550706">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="1550767">//</span><br>
<span class="lineno"></span><span class="comment" id="1550770">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="1550807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="1550836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="1550870">//</span><br>
<span class="lineno"></span><span class="comment" id="1550873">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1550891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="1550933">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="1550961">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="1551014">//</span><br>
<span class="lineno"></span><span class="comment" id="1551017">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1551030">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1551100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="1551140">//</span><br>
<span class="lineno"></span><span class="comment" id="1551143">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="1551158">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="1551182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="1551250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="1551319">//</span><br>
<span class="lineno"></span><span class="comment" id="1551322">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1551336">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1551402">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1551466">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="1551532">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1551577">func</span>&nbsp;<span class="ident" id="1551582">exp</span><span class="op" id="1551585">(</span><span class="ident" id="1551586">x</span>&nbsp;<span class="builtintype" id="1551588">float64</span><span class="op" id="1551595">)</span>&nbsp;<span class="builtintype" id="1551597">float64</span>&nbsp;<span class="op" id="1551605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551608">const</span>&nbsp;<span class="op" id="1551614">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1551618">Ln2Hi</span>&nbsp;<span class="op" id="1551624">=</span>&nbsp;<span class="num" id="1551626">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1551655">Ln2Lo</span>&nbsp;<span class="op" id="1551661">=</span>&nbsp;<span class="num" id="1551663">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1551692">Log2e</span>&nbsp;<span class="op" id="1551698">=</span>&nbsp;<span class="num" id="1551700">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1551730">Overflow</span>&nbsp;&nbsp;<span class="op" id="1551740">=</span>&nbsp;<span class="num" id="1551742">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1551771">Underflow</span>&nbsp;<span class="op" id="1551781">=</span>&nbsp;<span class="op" id="1551783">-</span><span class="num" id="1551784">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1551813">NearZero</span>&nbsp;&nbsp;<span class="op" id="1551823">=</span>&nbsp;<span class="num" id="1551825">1.0</span>&nbsp;<span class="op" id="1551829">/</span>&nbsp;<span class="op" id="1551831">(</span><span class="num" id="1551832">1</span>&nbsp;<span class="op" id="1551834">&lt;&lt;</span>&nbsp;<span class="num" id="1551837">28</span><span class="op" id="1551839">)</span>&nbsp;<span class="comment" id="1551841">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1551852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1551856">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551874">switch</span>&nbsp;<span class="op" id="1551881">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551884">case</span>&nbsp;<span class="ident" id="1551889">IsNaN</span><span class="op" id="1551894">(</span><span class="ident" id="1551895">x</span><span class="op" id="1551896">)</span>&nbsp;<span class="op" id="1551898">||</span>&nbsp;<span class="ident" id="1551901">IsInf</span><span class="op" id="1551906">(</span><span class="ident" id="1551907">x</span><span class="op" id="1551908">,</span>&nbsp;<span class="num" id="1551910">1</span><span class="op" id="1551911">)</span><span class="op" id="1551912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551916">return</span>&nbsp;<span class="ident" id="1551923">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551926">case</span>&nbsp;<span class="ident" id="1551931">IsInf</span><span class="op" id="1551936">(</span><span class="ident" id="1551937">x</span><span class="op" id="1551938">,</span>&nbsp;<span class="op" id="1551940">-</span><span class="num" id="1551941">1</span><span class="op" id="1551942">)</span><span class="op" id="1551943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551947">return</span>&nbsp;<span class="num" id="1551954">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551957">case</span>&nbsp;<span class="ident" id="1551962">x</span>&nbsp;<span class="op" id="1551964">&gt;</span>&nbsp;<span class="ident" id="1551966">Overflow</span><span class="op" id="1551974">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551978">return</span>&nbsp;<span class="ident" id="1551985">Inf</span><span class="op" id="1551988">(</span><span class="num" id="1551989">1</span><span class="op" id="1551990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1551993">case</span>&nbsp;<span class="ident" id="1551998">x</span>&nbsp;<span class="op" id="1552000">&lt;</span>&nbsp;<span class="ident" id="1552002">Underflow</span><span class="op" id="1552011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552015">return</span>&nbsp;<span class="num" id="1552022">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552025">case</span>&nbsp;<span class="op" id="1552030">-</span><span class="ident" id="1552031">NearZero</span>&nbsp;<span class="op" id="1552040">&lt;</span>&nbsp;<span class="ident" id="1552042">x</span>&nbsp;<span class="op" id="1552044">&amp;&amp;</span>&nbsp;<span class="ident" id="1552047">x</span>&nbsp;<span class="op" id="1552049">&lt;</span>&nbsp;<span class="ident" id="1552051">NearZero</span><span class="op" id="1552059">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552063">return</span>&nbsp;<span class="num" id="1552070">1</span>&nbsp;<span class="op" id="1552072">+</span>&nbsp;<span class="ident" id="1552074">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1552077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1552081">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552138">var</span>&nbsp;<span class="ident" id="1552142">k</span>&nbsp;<span class="builtintype" id="1552144">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552149">switch</span>&nbsp;<span class="op" id="1552156">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552159">case</span>&nbsp;<span class="ident" id="1552164">x</span>&nbsp;<span class="op" id="1552166">&lt;</span>&nbsp;<span class="num" id="1552168">0</span><span class="op" id="1552169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552173">k</span>&nbsp;<span class="op" id="1552175">=</span>&nbsp;<span class="builtintype" id="1552177">int</span><span class="op" id="1552180">(</span><span class="ident" id="1552181">Log2e</span><span class="op" id="1552186">*</span><span class="ident" id="1552187">x</span>&nbsp;<span class="op" id="1552189">-</span>&nbsp;<span class="num" id="1552191">0.5</span><span class="op" id="1552194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552197">case</span>&nbsp;<span class="ident" id="1552202">x</span>&nbsp;<span class="op" id="1552204">&gt;</span>&nbsp;<span class="num" id="1552206">0</span><span class="op" id="1552207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552211">k</span>&nbsp;<span class="op" id="1552213">=</span>&nbsp;<span class="builtintype" id="1552215">int</span><span class="op" id="1552218">(</span><span class="ident" id="1552219">Log2e</span><span class="op" id="1552224">*</span><span class="ident" id="1552225">x</span>&nbsp;<span class="op" id="1552227">+</span>&nbsp;<span class="num" id="1552229">0.5</span><span class="op" id="1552232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1552235">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552238">hi</span>&nbsp;<span class="op" id="1552241">:=</span>&nbsp;<span class="ident" id="1552244">x</span>&nbsp;<span class="op" id="1552246">-</span>&nbsp;<span class="builtintype" id="1552248">float64</span><span class="op" id="1552255">(</span><span class="ident" id="1552256">k</span><span class="op" id="1552257">)</span><span class="op" id="1552258">*</span><span class="ident" id="1552259">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552266">lo</span>&nbsp;<span class="op" id="1552269">:=</span>&nbsp;<span class="builtintype" id="1552272">float64</span><span class="op" id="1552279">(</span><span class="ident" id="1552280">k</span><span class="op" id="1552281">)</span>&nbsp;<span class="op" id="1552283">*</span>&nbsp;<span class="ident" id="1552285">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1552293">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552305">return</span>&nbsp;<span class="ident" id="1552312">expmulti</span><span class="op" id="1552320">(</span><span class="ident" id="1552321">hi</span><span class="op" id="1552323">,</span>&nbsp;<span class="ident" id="1552325">lo</span><span class="op" id="1552327">,</span>&nbsp;<span class="ident" id="1552329">k</span><span class="op" id="1552330">)</span><br>
<span class="lineno">130</span><span class="op" id="1552332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1552335">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1552386">//</span><br>
<span class="lineno"></span><span class="comment" id="1552389">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="1552427">func</span>&nbsp;<span class="ident" id="1552432">Exp2</span><span class="op" id="1552436">(</span><span class="ident" id="1552437">x</span>&nbsp;<span class="builtintype" id="1552439">float64</span><span class="op" id="1552446">)</span>&nbsp;<span class="builtintype" id="1552448">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1552457">func</span>&nbsp;<span class="ident" id="1552462">exp2</span><span class="op" id="1552466">(</span><span class="ident" id="1552467">x</span>&nbsp;<span class="builtintype" id="1552469">float64</span><span class="op" id="1552476">)</span>&nbsp;<span class="builtintype" id="1552478">float64</span>&nbsp;<span class="op" id="1552486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552489">const</span>&nbsp;<span class="op" id="1552495">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552499">Ln2Hi</span>&nbsp;<span class="op" id="1552505">=</span>&nbsp;<span class="num" id="1552507">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552536">Ln2Lo</span>&nbsp;<span class="op" id="1552542">=</span>&nbsp;<span class="num" id="1552544">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552574">Overflow</span>&nbsp;&nbsp;<span class="op" id="1552584">=</span>&nbsp;<span class="num" id="1552586">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552611">Underflow</span>&nbsp;<span class="op" id="1552621">=</span>&nbsp;<span class="op" id="1552623">-</span><span class="num" id="1552624">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1552636">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1552640">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552658">switch</span>&nbsp;<span class="op" id="1552665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552668">case</span>&nbsp;<span class="ident" id="1552673">IsNaN</span><span class="op" id="1552678">(</span><span class="ident" id="1552679">x</span><span class="op" id="1552680">)</span>&nbsp;<span class="op" id="1552682">||</span>&nbsp;<span class="ident" id="1552685">IsInf</span><span class="op" id="1552690">(</span><span class="ident" id="1552691">x</span><span class="op" id="1552692">,</span>&nbsp;<span class="num" id="1552694">1</span><span class="op" id="1552695">)</span><span class="op" id="1552696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552700">return</span>&nbsp;<span class="ident" id="1552707">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552710">case</span>&nbsp;<span class="ident" id="1552715">IsInf</span><span class="op" id="1552720">(</span><span class="ident" id="1552721">x</span><span class="op" id="1552722">,</span>&nbsp;<span class="op" id="1552724">-</span><span class="num" id="1552725">1</span><span class="op" id="1552726">)</span><span class="op" id="1552727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552731">return</span>&nbsp;<span class="num" id="1552738">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552741">case</span>&nbsp;<span class="ident" id="1552746">x</span>&nbsp;<span class="op" id="1552748">&gt;</span>&nbsp;<span class="ident" id="1552750">Overflow</span><span class="op" id="1552758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552762">return</span>&nbsp;<span class="ident" id="1552769">Inf</span><span class="op" id="1552772">(</span><span class="num" id="1552773">1</span><span class="op" id="1552774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552777">case</span>&nbsp;<span class="ident" id="1552782">x</span>&nbsp;<span class="op" id="1552784">&lt;</span>&nbsp;<span class="ident" id="1552786">Underflow</span><span class="op" id="1552795">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552799">return</span>&nbsp;<span class="num" id="1552806">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1552809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1552813">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1552876">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552925">var</span>&nbsp;<span class="ident" id="1552929">k</span>&nbsp;<span class="builtintype" id="1552931">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552936">switch</span>&nbsp;<span class="op" id="1552943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552946">case</span>&nbsp;<span class="ident" id="1552951">x</span>&nbsp;<span class="op" id="1552953">&gt;</span>&nbsp;<span class="num" id="1552955">0</span><span class="op" id="1552956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552960">k</span>&nbsp;<span class="op" id="1552962">=</span>&nbsp;<span class="builtintype" id="1552964">int</span><span class="op" id="1552967">(</span><span class="ident" id="1552968">x</span>&nbsp;<span class="op" id="1552970">+</span>&nbsp;<span class="num" id="1552972">0.5</span><span class="op" id="1552975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1552978">case</span>&nbsp;<span class="ident" id="1552983">x</span>&nbsp;<span class="op" id="1552985">&lt;</span>&nbsp;<span class="num" id="1552987">0</span><span class="op" id="1552988">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1552992">k</span>&nbsp;<span class="op" id="1552994">=</span>&nbsp;<span class="builtintype" id="1552996">int</span><span class="op" id="1552999">(</span><span class="ident" id="1553000">x</span>&nbsp;<span class="op" id="1553002">-</span>&nbsp;<span class="num" id="1553004">0.5</span><span class="op" id="1553007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1553010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553013">t</span>&nbsp;<span class="op" id="1553015">:=</span>&nbsp;<span class="ident" id="1553018">x</span>&nbsp;<span class="op" id="1553020">-</span>&nbsp;<span class="builtintype" id="1553022">float64</span><span class="op" id="1553029">(</span><span class="ident" id="1553030">k</span><span class="op" id="1553031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553034">hi</span>&nbsp;<span class="op" id="1553037">:=</span>&nbsp;<span class="ident" id="1553040">t</span>&nbsp;<span class="op" id="1553042">*</span>&nbsp;<span class="ident" id="1553044">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553051">lo</span>&nbsp;<span class="op" id="1553054">:=</span>&nbsp;<span class="op" id="1553057">-</span><span class="ident" id="1553058">t</span>&nbsp;<span class="op" id="1553060">*</span>&nbsp;<span class="ident" id="1553062">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1553070">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1553082">return</span>&nbsp;<span class="ident" id="1553089">expmulti</span><span class="op" id="1553097">(</span><span class="ident" id="1553098">hi</span><span class="op" id="1553100">,</span>&nbsp;<span class="ident" id="1553102">lo</span><span class="op" id="1553104">,</span>&nbsp;<span class="ident" id="1553106">k</span><span class="op" id="1553107">)</span><br>
<span class="lineno"></span><span class="op" id="1553109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="1553112">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="1553180">func</span>&nbsp;<span class="ident" id="1553185">expmulti</span><span class="op" id="1553193">(</span><span class="ident" id="1553194">hi</span><span class="op" id="1553196">,</span>&nbsp;<span class="ident" id="1553198">lo</span>&nbsp;<span class="builtintype" id="1553201">float64</span><span class="op" id="1553208">,</span>&nbsp;<span class="ident" id="1553210">k</span>&nbsp;<span class="builtintype" id="1553212">int</span><span class="op" id="1553215">)</span>&nbsp;<span class="builtintype" id="1553217">float64</span>&nbsp;<span class="op" id="1553225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1553228">const</span>&nbsp;<span class="op" id="1553234">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553238">P1</span>&nbsp;<span class="op" id="1553241">=</span>&nbsp;<span class="num" id="1553243">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="1553271">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553302">P2</span>&nbsp;<span class="op" id="1553305">=</span>&nbsp;<span class="op" id="1553307">-</span><span class="num" id="1553308">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="1553335">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553366">P3</span>&nbsp;<span class="op" id="1553369">=</span>&nbsp;<span class="num" id="1553371">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="1553399">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553430">P4</span>&nbsp;<span class="op" id="1553433">=</span>&nbsp;<span class="op" id="1553435">-</span><span class="num" id="1553436">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="1553463">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553494">P5</span>&nbsp;<span class="op" id="1553497">=</span>&nbsp;<span class="num" id="1553499">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="1553527">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1553557">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553561">r</span>&nbsp;<span class="op" id="1553563">:=</span>&nbsp;<span class="ident" id="1553566">hi</span>&nbsp;<span class="op" id="1553569">-</span>&nbsp;<span class="ident" id="1553571">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553575">t</span>&nbsp;<span class="op" id="1553577">:=</span>&nbsp;<span class="ident" id="1553580">r</span>&nbsp;<span class="op" id="1553582">*</span>&nbsp;<span class="ident" id="1553584">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553587">c</span>&nbsp;<span class="op" id="1553589">:=</span>&nbsp;<span class="ident" id="1553592">r</span>&nbsp;<span class="op" id="1553594">-</span>&nbsp;<span class="ident" id="1553596">t</span><span class="op" id="1553597">*</span><span class="op" id="1553598">(</span><span class="ident" id="1553599">P1</span><span class="op" id="1553601">+</span><span class="ident" id="1553602">t</span><span class="op" id="1553603">*</span><span class="op" id="1553604">(</span><span class="ident" id="1553605">P2</span><span class="op" id="1553607">+</span><span class="ident" id="1553608">t</span><span class="op" id="1553609">*</span><span class="op" id="1553610">(</span><span class="ident" id="1553611">P3</span><span class="op" id="1553613">+</span><span class="ident" id="1553614">t</span><span class="op" id="1553615">*</span><span class="op" id="1553616">(</span><span class="ident" id="1553617">P4</span><span class="op" id="1553619">+</span><span class="ident" id="1553620">t</span><span class="op" id="1553621">*</span><span class="ident" id="1553622">P5</span><span class="op" id="1553624">)</span><span class="op" id="1553625">)</span><span class="op" id="1553626">)</span><span class="op" id="1553627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1553630">y</span>&nbsp;<span class="op" id="1553632">:=</span>&nbsp;<span class="num" id="1553635">1</span>&nbsp;<span class="op" id="1553637">-</span>&nbsp;<span class="op" id="1553639">(</span><span class="op" id="1553640">(</span><span class="ident" id="1553641">lo</span>&nbsp;<span class="op" id="1553644">-</span>&nbsp;<span class="op" id="1553646">(</span><span class="ident" id="1553647">r</span><span class="op" id="1553648">*</span><span class="ident" id="1553649">c</span><span class="op" id="1553650">)</span><span class="op" id="1553651">/</span><span class="op" id="1553652">(</span><span class="num" id="1553653">2</span><span class="op" id="1553654">-</span><span class="ident" id="1553655">c</span><span class="op" id="1553656">)</span><span class="op" id="1553657">)</span>&nbsp;<span class="op" id="1553659">-</span>&nbsp;<span class="ident" id="1553661">hi</span><span class="op" id="1553663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1553666">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1553719">return</span>&nbsp;<span class="ident" id="1553726">Ldexp</span><span class="op" id="1553731">(</span><span class="ident" id="1553732">y</span><span class="op" id="1553733">,</span>&nbsp;<span class="ident" id="1553735">k</span><span class="op" id="1553736">)</span><br>
<span class="lineno"></span><span class="op" id="1553738">}</span>
</div>
</body>
</html>
