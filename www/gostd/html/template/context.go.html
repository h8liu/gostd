<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html" class="current">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5115353">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5115408">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5115462">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5115513">package</span>&nbsp;<span class="ident" id="5115521">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5115531">import</span>&nbsp;<span class="op" id="5115538">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5115541">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5115547">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5115550">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5115627">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="5115697">//</span><br>
<span class="lineno"></span><span class="comment" id="5115700">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5115775">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5115818">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="5115868">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="5115906">type</span>&nbsp;<span class="ident" id="5115911">context</span>&nbsp;<span class="keyword" id="5115919">struct</span>&nbsp;<span class="op" id="5115926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115929">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5115937">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115944">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5115952">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115959">urlPart</span>&nbsp;<span class="ident" id="5115967">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115976">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5115984">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115991">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5115999">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116005">element</span>&nbsp;<span class="ident" id="5116013">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116022">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5116030">*</span><span class="ident" id="5116031">Error</span><br>
<span class="lineno"></span><span class="op" id="5116037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5116040">func</span>&nbsp;<span class="op" id="5116045">(</span><span class="ident" id="5116046">c</span>&nbsp;<span class="ident" id="5116048">context</span><span class="op" id="5116055">)</span>&nbsp;<span class="ident" id="5116057">String</span><span class="op" id="5116063">(</span><span class="op" id="5116064">)</span>&nbsp;<span class="builtintype" id="5116066">string</span>&nbsp;<span class="op" id="5116073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116076">return</span>&nbsp;<span class="ident" id="5116083">fmt</span><span class="op" id="5116086">.</span><span class="ident" id="5116087">Sprintf</span><span class="op" id="5116094">(</span><span class="string" id="5116095">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="5116119">,</span>&nbsp;<span class="ident" id="5116121">c</span><span class="op" id="5116122">.</span><span class="ident" id="5116123">state</span><span class="op" id="5116128">,</span>&nbsp;<span class="ident" id="5116130">c</span><span class="op" id="5116131">.</span><span class="ident" id="5116132">delim</span><span class="op" id="5116137">,</span>&nbsp;<span class="ident" id="5116139">c</span><span class="op" id="5116140">.</span><span class="ident" id="5116141">urlPart</span><span class="op" id="5116148">,</span>&nbsp;<span class="ident" id="5116150">c</span><span class="op" id="5116151">.</span><span class="ident" id="5116152">jsCtx</span><span class="op" id="5116157">,</span>&nbsp;<span class="ident" id="5116159">c</span><span class="op" id="5116160">.</span><span class="ident" id="5116161">attr</span><span class="op" id="5116165">,</span>&nbsp;<span class="ident" id="5116167">c</span><span class="op" id="5116168">.</span><span class="ident" id="5116169">element</span><span class="op" id="5116176">,</span>&nbsp;<span class="ident" id="5116178">c</span><span class="op" id="5116179">.</span><span class="ident" id="5116180">err</span><span class="op" id="5116183">)</span><br>
<span class="lineno">30</span><span class="op" id="5116185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5116188">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="5116234">func</span>&nbsp;<span class="op" id="5116239">(</span><span class="ident" id="5116240">c</span>&nbsp;<span class="ident" id="5116242">context</span><span class="op" id="5116249">)</span>&nbsp;<span class="ident" id="5116251">eq</span><span class="op" id="5116253">(</span><span class="ident" id="5116254">d</span>&nbsp;<span class="ident" id="5116256">context</span><span class="op" id="5116263">)</span>&nbsp;<span class="builtintype" id="5116265">bool</span>&nbsp;<span class="op" id="5116270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116273">return</span>&nbsp;<span class="ident" id="5116280">c</span><span class="op" id="5116281">.</span><span class="ident" id="5116282">state</span>&nbsp;<span class="op" id="5116288">==</span>&nbsp;<span class="ident" id="5116291">d</span><span class="op" id="5116292">.</span><span class="ident" id="5116293">state</span>&nbsp;<span class="op" id="5116299">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116304">c</span><span class="op" id="5116305">.</span><span class="ident" id="5116306">delim</span>&nbsp;<span class="op" id="5116312">==</span>&nbsp;<span class="ident" id="5116315">d</span><span class="op" id="5116316">.</span><span class="ident" id="5116317">delim</span>&nbsp;<span class="op" id="5116323">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116328">c</span><span class="op" id="5116329">.</span><span class="ident" id="5116330">urlPart</span>&nbsp;<span class="op" id="5116338">==</span>&nbsp;<span class="ident" id="5116341">d</span><span class="op" id="5116342">.</span><span class="ident" id="5116343">urlPart</span>&nbsp;<span class="op" id="5116351">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116356">c</span><span class="op" id="5116357">.</span><span class="ident" id="5116358">jsCtx</span>&nbsp;<span class="op" id="5116364">==</span>&nbsp;<span class="ident" id="5116367">d</span><span class="op" id="5116368">.</span><span class="ident" id="5116369">jsCtx</span>&nbsp;<span class="op" id="5116375">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116380">c</span><span class="op" id="5116381">.</span><span class="ident" id="5116382">attr</span>&nbsp;<span class="op" id="5116387">==</span>&nbsp;<span class="ident" id="5116390">d</span><span class="op" id="5116391">.</span><span class="ident" id="5116392">attr</span>&nbsp;<span class="op" id="5116397">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116402">c</span><span class="op" id="5116403">.</span><span class="ident" id="5116404">element</span>&nbsp;<span class="op" id="5116412">==</span>&nbsp;<span class="ident" id="5116415">d</span><span class="op" id="5116416">.</span><span class="ident" id="5116417">element</span>&nbsp;<span class="op" id="5116425">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116430">c</span><span class="op" id="5116431">.</span><span class="ident" id="5116432">err</span>&nbsp;<span class="op" id="5116436">==</span>&nbsp;<span class="ident" id="5116439">d</span><span class="op" id="5116440">.</span><span class="ident" id="5116441">err</span><br>
<span class="lineno"></span><span class="op" id="5116445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5116448">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5116526">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="5116582">func</span>&nbsp;<span class="op" id="5116587">(</span><span class="ident" id="5116588">c</span>&nbsp;<span class="ident" id="5116590">context</span><span class="op" id="5116597">)</span>&nbsp;<span class="ident" id="5116599">mangle</span><span class="op" id="5116605">(</span><span class="ident" id="5116606">templateName</span>&nbsp;<span class="builtintype" id="5116619">string</span><span class="op" id="5116625">)</span>&nbsp;<span class="builtintype" id="5116627">string</span>&nbsp;<span class="op" id="5116634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5116637">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116709">if</span>&nbsp;<span class="ident" id="5116712">c</span><span class="op" id="5116713">.</span><span class="ident" id="5116714">state</span>&nbsp;<span class="op" id="5116720">==</span>&nbsp;<span class="ident" id="5116723">stateText</span>&nbsp;<span class="op" id="5116733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116737">return</span>&nbsp;<span class="ident" id="5116744">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5116758">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116761">s</span>&nbsp;<span class="op" id="5116763">:=</span>&nbsp;<span class="ident" id="5116766">templateName</span>&nbsp;<span class="op" id="5116779">+</span>&nbsp;<span class="string" id="5116781">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="5116798">+</span>&nbsp;<span class="ident" id="5116800">c</span><span class="op" id="5116801">.</span><span class="ident" id="5116802">state</span><span class="op" id="5116807">.</span><span class="ident" id="5116808">String</span><span class="op" id="5116814">(</span><span class="op" id="5116815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116818">if</span>&nbsp;<span class="ident" id="5116821">c</span><span class="op" id="5116822">.</span><span class="ident" id="5116823">delim</span>&nbsp;<span class="op" id="5116829">!=</span>&nbsp;<span class="num" id="5116832">0</span>&nbsp;<span class="op" id="5116834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116838">s</span>&nbsp;<span class="op" id="5116840">+=</span>&nbsp;<span class="string" id="5116843">&#34;_&#34;</span>&nbsp;<span class="op" id="5116847">+</span>&nbsp;<span class="ident" id="5116849">c</span><span class="op" id="5116850">.</span><span class="ident" id="5116851">delim</span><span class="op" id="5116856">.</span><span class="ident" id="5116857">String</span><span class="op" id="5116863">(</span><span class="op" id="5116864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5116867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116870">if</span>&nbsp;<span class="ident" id="5116873">c</span><span class="op" id="5116874">.</span><span class="ident" id="5116875">urlPart</span>&nbsp;<span class="op" id="5116883">!=</span>&nbsp;<span class="num" id="5116886">0</span>&nbsp;<span class="op" id="5116888">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116892">s</span>&nbsp;<span class="op" id="5116894">+=</span>&nbsp;<span class="string" id="5116897">&#34;_&#34;</span>&nbsp;<span class="op" id="5116901">+</span>&nbsp;<span class="ident" id="5116903">c</span><span class="op" id="5116904">.</span><span class="ident" id="5116905">urlPart</span><span class="op" id="5116912">.</span><span class="ident" id="5116913">String</span><span class="op" id="5116919">(</span><span class="op" id="5116920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5116923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116926">if</span>&nbsp;<span class="ident" id="5116929">c</span><span class="op" id="5116930">.</span><span class="ident" id="5116931">jsCtx</span>&nbsp;<span class="op" id="5116937">!=</span>&nbsp;<span class="num" id="5116940">0</span>&nbsp;<span class="op" id="5116942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116946">s</span>&nbsp;<span class="op" id="5116948">+=</span>&nbsp;<span class="string" id="5116951">&#34;_&#34;</span>&nbsp;<span class="op" id="5116955">+</span>&nbsp;<span class="ident" id="5116957">c</span><span class="op" id="5116958">.</span><span class="ident" id="5116959">jsCtx</span><span class="op" id="5116964">.</span><span class="ident" id="5116965">String</span><span class="op" id="5116971">(</span><span class="op" id="5116972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5116975">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5116978">if</span>&nbsp;<span class="ident" id="5116981">c</span><span class="op" id="5116982">.</span><span class="ident" id="5116983">attr</span>&nbsp;<span class="op" id="5116988">!=</span>&nbsp;<span class="num" id="5116991">0</span>&nbsp;<span class="op" id="5116993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5116997">s</span>&nbsp;<span class="op" id="5116999">+=</span>&nbsp;<span class="string" id="5117002">&#34;_&#34;</span>&nbsp;<span class="op" id="5117006">+</span>&nbsp;<span class="ident" id="5117008">c</span><span class="op" id="5117009">.</span><span class="ident" id="5117010">attr</span><span class="op" id="5117014">.</span><span class="ident" id="5117015">String</span><span class="op" id="5117021">(</span><span class="op" id="5117022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5117025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5117028">if</span>&nbsp;<span class="ident" id="5117031">c</span><span class="op" id="5117032">.</span><span class="ident" id="5117033">element</span>&nbsp;<span class="op" id="5117041">!=</span>&nbsp;<span class="num" id="5117044">0</span>&nbsp;<span class="op" id="5117046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5117050">s</span>&nbsp;<span class="op" id="5117052">+=</span>&nbsp;<span class="string" id="5117055">&#34;_&#34;</span>&nbsp;<span class="op" id="5117059">+</span>&nbsp;<span class="ident" id="5117061">c</span><span class="op" id="5117062">.</span><span class="ident" id="5117063">element</span><span class="op" id="5117070">.</span><span class="ident" id="5117071">String</span><span class="op" id="5117077">(</span><span class="op" id="5117078">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5117081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5117084">return</span>&nbsp;<span class="ident" id="5117091">s</span><br>
<span class="lineno"></span><span class="op" id="5117093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5117096">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="5117147">//</span><br>
<span class="lineno"></span><span class="comment" id="5117150">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="5117229">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5117306">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="5117379">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="5117459">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5117489">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5117527">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5117605">type</span>&nbsp;<span class="ident" id="5117610">state</span>&nbsp;<span class="builtintype" id="5117616">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5117623">const</span>&nbsp;<span class="op" id="5117629">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5117632">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5117693">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5117756">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5117806">stateText</span>&nbsp;<span class="ident" id="5117816">state</span>&nbsp;<span class="op" id="5117822">=</span>&nbsp;<span class="ident" id="5117824">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5117830">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5117896">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5117906">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5117957">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118009">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118024">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118094">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118159">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118175">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118247">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118299">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118317">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118374">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118388">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118460">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118530">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118543">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118612">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118623">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118692">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118702">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118764">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118773">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118839">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118853">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118919">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5118933">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5118994">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119009">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119077">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119094">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119157">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119173">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119238">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119248">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119308">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119323">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119383">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119398">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119462">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119477">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119541">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119556">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119611">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119624">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119686">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119704">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119761">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119778">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5119840">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119867">stateError</span><br>
<span class="lineno"></span><span class="op" id="5119878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5119881">var</span>&nbsp;<span class="ident" id="5119885">stateNames</span>&nbsp;<span class="op" id="5119896">=</span>&nbsp;<span class="op" id="5119898">[</span><span class="op" id="5119899">...</span><span class="op" id="5119902">]</span><span class="builtintype" id="5119903">string</span><span class="op" id="5119909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119912">stateText</span><span class="op" id="5119921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5119930">&#34;stateText&#34;</span><span class="op" id="5119941">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119944">stateTag</span><span class="op" id="5119952">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5119962">&#34;stateTag&#34;</span><span class="op" id="5119972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5119975">stateAttrName</span><span class="op" id="5119988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5119993">&#34;stateAttrName&#34;</span><span class="op" id="5120008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120011">stateAfterName</span><span class="op" id="5120025">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5120029">&#34;stateAfterName&#34;</span><span class="op" id="5120045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120048">stateBeforeValue</span><span class="op" id="5120064">:</span>&nbsp;<span class="string" id="5120066">&#34;stateBeforeValue&#34;</span><span class="op" id="5120084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120087">stateHTMLCmt</span><span class="op" id="5120099">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120105">&#34;stateHTMLCmt&#34;</span><span class="op" id="5120119">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120122">stateRCDATA</span><span class="op" id="5120133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120140">&#34;stateRCDATA&#34;</span><span class="op" id="5120153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120156">stateAttr</span><span class="op" id="5120165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120174">&#34;stateAttr&#34;</span><span class="op" id="5120185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120188">stateURL</span><span class="op" id="5120196">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120206">&#34;stateURL&#34;</span><span class="op" id="5120216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120219">stateJS</span><span class="op" id="5120226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120237">&#34;stateJS&#34;</span><span class="op" id="5120246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120249">stateJSDqStr</span><span class="op" id="5120261">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120267">&#34;stateJSDqStr&#34;</span><span class="op" id="5120281">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120284">stateJSSqStr</span><span class="op" id="5120296">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120302">&#34;stateJSSqStr&#34;</span><span class="op" id="5120316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120319">stateJSRegexp</span><span class="op" id="5120332">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120337">&#34;stateJSRegexp&#34;</span><span class="op" id="5120352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120355">stateJSBlockCmt</span><span class="op" id="5120370">:</span>&nbsp;&nbsp;<span class="string" id="5120373">&#34;stateJSBlockCmt&#34;</span><span class="op" id="5120390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120393">stateJSLineCmt</span><span class="op" id="5120407">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5120411">&#34;stateJSLineCmt&#34;</span><span class="op" id="5120427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120430">stateCSS</span><span class="op" id="5120438">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120448">&#34;stateCSS&#34;</span><span class="op" id="5120458">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120461">stateCSSDqStr</span><span class="op" id="5120474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120479">&#34;stateCSSDqStr&#34;</span><span class="op" id="5120494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120497">stateCSSSqStr</span><span class="op" id="5120510">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120515">&#34;stateCSSSqStr&#34;</span><span class="op" id="5120530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120533">stateCSSDqURL</span><span class="op" id="5120546">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120551">&#34;stateCSSDqURL&#34;</span><span class="op" id="5120566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120569">stateCSSSqURL</span><span class="op" id="5120582">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120587">&#34;stateCSSSqURL&#34;</span><span class="op" id="5120602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120605">stateCSSURL</span><span class="op" id="5120616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120623">&#34;stateCSSURL&#34;</span><span class="op" id="5120636">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120639">stateCSSBlockCmt</span><span class="op" id="5120655">:</span>&nbsp;<span class="string" id="5120657">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="5120675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120678">stateCSSLineCmt</span><span class="op" id="5120693">:</span>&nbsp;&nbsp;<span class="string" id="5120696">&#34;stateCSSLineCmt&#34;</span><span class="op" id="5120713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5120716">stateError</span><span class="op" id="5120726">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5120734">&#34;stateError&#34;</span><span class="op" id="5120746">,</span><br>
<span class="lineno"></span><span class="op" id="5120748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5120751">func</span>&nbsp;<span class="op" id="5120756">(</span><span class="ident" id="5120757">s</span>&nbsp;<span class="ident" id="5120759">state</span><span class="op" id="5120764">)</span>&nbsp;<span class="ident" id="5120766">String</span><span class="op" id="5120772">(</span><span class="op" id="5120773">)</span>&nbsp;<span class="builtintype" id="5120775">string</span>&nbsp;<span class="op" id="5120782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5120785">if</span>&nbsp;<span class="builtintype" id="5120788">int</span><span class="op" id="5120791">(</span><span class="ident" id="5120792">s</span><span class="op" id="5120793">)</span>&nbsp;<span class="op" id="5120795">&lt;</span>&nbsp;<span class="builtinfunc" id="5120797">len</span><span class="op" id="5120800">(</span><span class="ident" id="5120801">stateNames</span><span class="op" id="5120811">)</span>&nbsp;<span class="op" id="5120813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5120817">return</span>&nbsp;<span class="ident" id="5120824">stateNames</span><span class="op" id="5120834">[</span><span class="ident" id="5120835">s</span><span class="op" id="5120836">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5120839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5120842">return</span>&nbsp;<span class="ident" id="5120849">fmt</span><span class="op" id="5120852">.</span><span class="ident" id="5120853">Sprintf</span><span class="op" id="5120860">(</span><span class="string" id="5120861">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="5120879">,</span>&nbsp;<span class="builtintype" id="5120881">int</span><span class="op" id="5120884">(</span><span class="ident" id="5120885">s</span><span class="op" id="5120886">)</span><span class="op" id="5120887">)</span><br>
<span class="lineno">170</span><span class="op" id="5120889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5120892">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5120968">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="5121025">func</span>&nbsp;<span class="ident" id="5121030">isComment</span><span class="op" id="5121039">(</span><span class="ident" id="5121040">s</span>&nbsp;<span class="ident" id="5121042">state</span><span class="op" id="5121047">)</span>&nbsp;<span class="builtintype" id="5121049">bool</span>&nbsp;<span class="op" id="5121054">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121057">switch</span>&nbsp;<span class="ident" id="5121064">s</span>&nbsp;<span class="op" id="5121066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121069">case</span>&nbsp;<span class="ident" id="5121074">stateHTMLCmt</span><span class="op" id="5121086">,</span>&nbsp;<span class="ident" id="5121088">stateJSBlockCmt</span><span class="op" id="5121103">,</span>&nbsp;<span class="ident" id="5121105">stateJSLineCmt</span><span class="op" id="5121119">,</span>&nbsp;<span class="ident" id="5121121">stateCSSBlockCmt</span><span class="op" id="5121137">,</span>&nbsp;<span class="ident" id="5121139">stateCSSLineCmt</span><span class="op" id="5121154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121158">return</span>&nbsp;<span class="builtintype" id="5121165">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5121171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121174">return</span>&nbsp;<span class="builtintype" id="5121181">false</span><br>
<span class="lineno">180</span><span class="op" id="5121187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5121190">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5121252">func</span>&nbsp;<span class="ident" id="5121257">isInTag</span><span class="op" id="5121264">(</span><span class="ident" id="5121265">s</span>&nbsp;<span class="ident" id="5121267">state</span><span class="op" id="5121272">)</span>&nbsp;<span class="builtintype" id="5121274">bool</span>&nbsp;<span class="op" id="5121279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121282">switch</span>&nbsp;<span class="ident" id="5121289">s</span>&nbsp;<span class="op" id="5121291">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121294">case</span>&nbsp;<span class="ident" id="5121299">stateTag</span><span class="op" id="5121307">,</span>&nbsp;<span class="ident" id="5121309">stateAttrName</span><span class="op" id="5121322">,</span>&nbsp;<span class="ident" id="5121324">stateAfterName</span><span class="op" id="5121338">,</span>&nbsp;<span class="ident" id="5121340">stateBeforeValue</span><span class="op" id="5121356">,</span>&nbsp;<span class="ident" id="5121358">stateAttr</span><span class="op" id="5121367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121371">return</span>&nbsp;<span class="builtintype" id="5121378">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5121384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5121387">return</span>&nbsp;<span class="builtintype" id="5121394">false</span><br>
<span class="lineno"></span><span class="op" id="5121400">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5121403">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="5121471">type</span>&nbsp;<span class="ident" id="5121476">delim</span>&nbsp;<span class="builtintype" id="5121482">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5121489">const</span>&nbsp;<span class="op" id="5121495">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5121498">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121542">delimNone</span>&nbsp;<span class="ident" id="5121552">delim</span>&nbsp;<span class="op" id="5121558">=</span>&nbsp;<span class="ident" id="5121560">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5121566">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121640">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5121658">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121732">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5121750">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5121820">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121846">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="5121865">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="5121868">var</span>&nbsp;<span class="ident" id="5121872">delimNames</span>&nbsp;<span class="op" id="5121883">=</span>&nbsp;<span class="op" id="5121885">[</span><span class="op" id="5121886">...</span><span class="op" id="5121889">]</span><span class="builtintype" id="5121890">string</span><span class="op" id="5121896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121899">delimNone</span><span class="op" id="5121908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5121919">&#34;delimNone&#34;</span><span class="op" id="5121930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121933">delimDoubleQuote</span><span class="op" id="5121949">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5121953">&#34;delimDoubleQuote&#34;</span><span class="op" id="5121971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5121974">delimSingleQuote</span><span class="op" id="5121990">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5121994">&#34;delimSingleQuote&#34;</span><span class="op" id="5122012">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122015">delimSpaceOrTagEnd</span><span class="op" id="5122033">:</span>&nbsp;<span class="string" id="5122035">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="5122055">,</span><br>
<span class="lineno"></span><span class="op" id="5122057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122060">func</span>&nbsp;<span class="op" id="5122065">(</span><span class="ident" id="5122066">d</span>&nbsp;<span class="ident" id="5122068">delim</span><span class="op" id="5122073">)</span>&nbsp;<span class="ident" id="5122075">String</span><span class="op" id="5122081">(</span><span class="op" id="5122082">)</span>&nbsp;<span class="builtintype" id="5122084">string</span>&nbsp;<span class="op" id="5122091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5122094">if</span>&nbsp;<span class="builtintype" id="5122097">int</span><span class="op" id="5122100">(</span><span class="ident" id="5122101">d</span><span class="op" id="5122102">)</span>&nbsp;<span class="op" id="5122104">&lt;</span>&nbsp;<span class="builtinfunc" id="5122106">len</span><span class="op" id="5122109">(</span><span class="ident" id="5122110">delimNames</span><span class="op" id="5122120">)</span>&nbsp;<span class="op" id="5122122">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5122126">return</span>&nbsp;<span class="ident" id="5122133">delimNames</span><span class="op" id="5122143">[</span><span class="ident" id="5122144">d</span><span class="op" id="5122145">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5122148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5122151">return</span>&nbsp;<span class="ident" id="5122158">fmt</span><span class="op" id="5122161">.</span><span class="ident" id="5122162">Sprintf</span><span class="op" id="5122169">(</span><span class="string" id="5122170">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="5122188">,</span>&nbsp;<span class="builtintype" id="5122190">int</span><span class="op" id="5122193">(</span><span class="ident" id="5122194">d</span><span class="op" id="5122195">)</span><span class="op" id="5122196">)</span><br>
<span class="lineno"></span><span class="op" id="5122198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5122201">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5122281">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="5122305">type</span>&nbsp;<span class="ident" id="5122310">urlPart</span>&nbsp;<span class="builtintype" id="5122318">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122325">const</span>&nbsp;<span class="op" id="5122331">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122334">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122402">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122441">urlPartNone</span>&nbsp;<span class="ident" id="5122453">urlPart</span>&nbsp;<span class="op" id="5122461">=</span>&nbsp;<span class="ident" id="5122463">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122469">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122543">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122584">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122601">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122670">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122705">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122725">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5122794">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122825">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="5122840">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5122843">var</span>&nbsp;<span class="ident" id="5122847">urlPartNames</span>&nbsp;<span class="op" id="5122860">=</span>&nbsp;<span class="op" id="5122862">[</span><span class="op" id="5122863">...</span><span class="op" id="5122866">]</span><span class="builtintype" id="5122867">string</span><span class="op" id="5122873">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122876">urlPartNone</span><span class="op" id="5122887">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5122896">&#34;urlPartNone&#34;</span><span class="op" id="5122909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122912">urlPartPreQuery</span><span class="op" id="5122927">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5122932">&#34;urlPartPreQuery&#34;</span><span class="op" id="5122949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122952">urlPartQueryOrFrag</span><span class="op" id="5122970">:</span>&nbsp;<span class="string" id="5122972">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="5122992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5122995">urlPartUnknown</span><span class="op" id="5123009">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5123015">&#34;urlPartUnknown&#34;</span><span class="op" id="5123031">,</span><br>
<span class="lineno"></span><span class="op" id="5123033">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5123036">func</span>&nbsp;<span class="op" id="5123041">(</span><span class="ident" id="5123042">u</span>&nbsp;<span class="ident" id="5123044">urlPart</span><span class="op" id="5123051">)</span>&nbsp;<span class="ident" id="5123053">String</span><span class="op" id="5123059">(</span><span class="op" id="5123060">)</span>&nbsp;<span class="builtintype" id="5123062">string</span>&nbsp;<span class="op" id="5123069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123072">if</span>&nbsp;<span class="builtintype" id="5123075">int</span><span class="op" id="5123078">(</span><span class="ident" id="5123079">u</span><span class="op" id="5123080">)</span>&nbsp;<span class="op" id="5123082">&lt;</span>&nbsp;<span class="builtinfunc" id="5123084">len</span><span class="op" id="5123087">(</span><span class="ident" id="5123088">urlPartNames</span><span class="op" id="5123100">)</span>&nbsp;<span class="op" id="5123102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123106">return</span>&nbsp;<span class="ident" id="5123113">urlPartNames</span><span class="op" id="5123125">[</span><span class="ident" id="5123126">u</span><span class="op" id="5123127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5123130">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123133">return</span>&nbsp;<span class="ident" id="5123140">fmt</span><span class="op" id="5123143">.</span><span class="ident" id="5123144">Sprintf</span><span class="op" id="5123151">(</span><span class="string" id="5123152">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="5123172">,</span>&nbsp;<span class="builtintype" id="5123174">int</span><span class="op" id="5123177">(</span><span class="ident" id="5123178">u</span><span class="op" id="5123179">)</span><span class="op" id="5123180">)</span><br>
<span class="lineno"></span><span class="op" id="5123182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5123185">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5123260">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="5123282">type</span>&nbsp;<span class="ident" id="5123287">jsCtx</span>&nbsp;<span class="builtintype" id="5123293">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5123300">const</span>&nbsp;<span class="op" id="5123306">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5123309">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5123374">jsCtxRegexp</span>&nbsp;<span class="ident" id="5123386">jsCtx</span>&nbsp;<span class="op" id="5123392">=</span>&nbsp;<span class="ident" id="5123394">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5123400">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5123467">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5123479">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5123552">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="5123565">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5123568">func</span>&nbsp;<span class="op" id="5123573">(</span><span class="ident" id="5123574">c</span>&nbsp;<span class="ident" id="5123576">jsCtx</span><span class="op" id="5123581">)</span>&nbsp;<span class="ident" id="5123583">String</span><span class="op" id="5123589">(</span><span class="op" id="5123590">)</span>&nbsp;<span class="builtintype" id="5123592">string</span>&nbsp;<span class="op" id="5123599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123602">switch</span>&nbsp;<span class="ident" id="5123609">c</span>&nbsp;<span class="op" id="5123611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123614">case</span>&nbsp;<span class="ident" id="5123619">jsCtxRegexp</span><span class="op" id="5123630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123634">return</span>&nbsp;<span class="string" id="5123641">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123656">case</span>&nbsp;<span class="ident" id="5123661">jsCtxDivOp</span><span class="op" id="5123671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123675">return</span>&nbsp;<span class="string" id="5123682">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123696">case</span>&nbsp;<span class="ident" id="5123701">jsCtxUnknown</span><span class="op" id="5123713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123717">return</span>&nbsp;<span class="string" id="5123724">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5123740">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5123743">return</span>&nbsp;<span class="ident" id="5123750">fmt</span><span class="op" id="5123753">.</span><span class="ident" id="5123754">Sprintf</span><span class="op" id="5123761">(</span><span class="string" id="5123762">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="5123780">,</span>&nbsp;<span class="builtintype" id="5123782">int</span><span class="op" id="5123785">(</span><span class="ident" id="5123786">c</span><span class="op" id="5123787">)</span><span class="op" id="5123788">)</span><br>
<span class="lineno"></span><span class="op" id="5123790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5123793">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="5123873">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="5123953">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5124027">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5124106">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5124137">type</span>&nbsp;<span class="ident" id="5124142">element</span>&nbsp;<span class="builtintype" id="5124150">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5124157">const</span>&nbsp;<span class="op" id="5124163">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5124166">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124236">elementNone</span>&nbsp;<span class="ident" id="5124248">element</span>&nbsp;<span class="op" id="5124256">=</span>&nbsp;<span class="ident" id="5124258">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5124264">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124328">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5124343">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124405">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5124419">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124485">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5124502">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124562">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="5124575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5124578">var</span>&nbsp;<span class="ident" id="5124582">elementNames</span>&nbsp;<span class="op" id="5124595">=</span>&nbsp;<span class="op" id="5124597">[</span><span class="op" id="5124598">...</span><span class="op" id="5124601">]</span><span class="builtintype" id="5124602">string</span><span class="op" id="5124608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124611">elementNone</span><span class="op" id="5124622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5124628">&#34;elementNone&#34;</span><span class="op" id="5124641">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124644">elementScript</span><span class="op" id="5124657">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5124661">&#34;elementScript&#34;</span><span class="op" id="5124676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124679">elementStyle</span><span class="op" id="5124691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5124696">&#34;elementStyle&#34;</span><span class="op" id="5124710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124713">elementTextarea</span><span class="op" id="5124728">:</span>&nbsp;<span class="string" id="5124730">&#34;elementTextarea&#34;</span><span class="op" id="5124747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5124750">elementTitle</span><span class="op" id="5124762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5124767">&#34;elementTitle&#34;</span><span class="op" id="5124781">,</span><br>
<span class="lineno"></span><span class="op" id="5124783">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="5124786">func</span>&nbsp;<span class="op" id="5124791">(</span><span class="ident" id="5124792">e</span>&nbsp;<span class="ident" id="5124794">element</span><span class="op" id="5124801">)</span>&nbsp;<span class="ident" id="5124803">String</span><span class="op" id="5124809">(</span><span class="op" id="5124810">)</span>&nbsp;<span class="builtintype" id="5124812">string</span>&nbsp;<span class="op" id="5124819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5124822">if</span>&nbsp;<span class="builtintype" id="5124825">int</span><span class="op" id="5124828">(</span><span class="ident" id="5124829">e</span><span class="op" id="5124830">)</span>&nbsp;<span class="op" id="5124832">&lt;</span>&nbsp;<span class="builtinfunc" id="5124834">len</span><span class="op" id="5124837">(</span><span class="ident" id="5124838">elementNames</span><span class="op" id="5124850">)</span>&nbsp;<span class="op" id="5124852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5124856">return</span>&nbsp;<span class="ident" id="5124863">elementNames</span><span class="op" id="5124875">[</span><span class="ident" id="5124876">e</span><span class="op" id="5124877">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5124880">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5124883">return</span>&nbsp;<span class="ident" id="5124890">fmt</span><span class="op" id="5124893">.</span><span class="ident" id="5124894">Sprintf</span><span class="op" id="5124901">(</span><span class="string" id="5124902">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="5124922">,</span>&nbsp;<span class="builtintype" id="5124924">int</span><span class="op" id="5124927">(</span><span class="ident" id="5124928">e</span><span class="op" id="5124929">)</span><span class="op" id="5124930">)</span><br>
<span class="lineno"></span><span class="op" id="5124932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5124935">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5125010">type</span>&nbsp;<span class="ident" id="5125015">attr</span>&nbsp;<span class="builtintype" id="5125020">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5125027">const</span>&nbsp;<span class="op" id="5125033">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5125036">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125100">attrNone</span>&nbsp;<span class="ident" id="5125109">attr</span>&nbsp;<span class="op" id="5125114">=</span>&nbsp;<span class="ident" id="5125116">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5125122">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125180">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5125192">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125261">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5125272">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125334">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="5125342">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5125345">var</span>&nbsp;<span class="ident" id="5125349">attrNames</span>&nbsp;<span class="op" id="5125359">=</span>&nbsp;<span class="op" id="5125361">[</span><span class="op" id="5125362">...</span><span class="op" id="5125365">]</span><span class="builtintype" id="5125366">string</span><span class="op" id="5125372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125375">attrNone</span><span class="op" id="5125383">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5125387">&#34;attrNone&#34;</span><span class="op" id="5125397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125400">attrScript</span><span class="op" id="5125410">:</span>&nbsp;<span class="string" id="5125412">&#34;attrScript&#34;</span><span class="op" id="5125424">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125427">attrStyle</span><span class="op" id="5125436">:</span>&nbsp;&nbsp;<span class="string" id="5125439">&#34;attrStyle&#34;</span><span class="op" id="5125450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5125453">attrURL</span><span class="op" id="5125460">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5125465">&#34;attrURL&#34;</span><span class="op" id="5125474">,</span><br>
<span class="lineno"></span><span class="op" id="5125476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5125479">func</span>&nbsp;<span class="op" id="5125484">(</span><span class="ident" id="5125485">a</span>&nbsp;<span class="ident" id="5125487">attr</span><span class="op" id="5125491">)</span>&nbsp;<span class="ident" id="5125493">String</span><span class="op" id="5125499">(</span><span class="op" id="5125500">)</span>&nbsp;<span class="builtintype" id="5125502">string</span>&nbsp;<span class="op" id="5125509">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5125512">if</span>&nbsp;<span class="builtintype" id="5125515">int</span><span class="op" id="5125518">(</span><span class="ident" id="5125519">a</span><span class="op" id="5125520">)</span>&nbsp;<span class="op" id="5125522">&lt;</span>&nbsp;<span class="builtinfunc" id="5125524">len</span><span class="op" id="5125527">(</span><span class="ident" id="5125528">attrNames</span><span class="op" id="5125537">)</span>&nbsp;<span class="op" id="5125539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5125543">return</span>&nbsp;<span class="ident" id="5125550">attrNames</span><span class="op" id="5125559">[</span><span class="ident" id="5125560">a</span><span class="op" id="5125561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5125564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5125567">return</span>&nbsp;<span class="ident" id="5125574">fmt</span><span class="op" id="5125577">.</span><span class="ident" id="5125578">Sprintf</span><span class="op" id="5125585">(</span><span class="string" id="5125586">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="5125603">,</span>&nbsp;<span class="builtintype" id="5125605">int</span><span class="op" id="5125608">(</span><span class="ident" id="5125609">a</span><span class="op" id="5125610">)</span><span class="op" id="5125611">)</span><br>
<span class="lineno"></span><span class="op" id="5125613">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
