<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html" class="current">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3033922">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3033977">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3034031">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3034082">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3034121">//</span><br>
<span class="lineno"></span><span class="comment" id="3034124">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3034184">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3034223">//</span><br>
<span class="lineno">10</span><span class="comment" id="3034226">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3034286">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3034351">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3034418">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3034442">//</span><br>
<span class="lineno">15</span><span class="comment" id="3034445">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3034509">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3034579">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3034642">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3034675">//</span><br>
<span class="lineno">20</span><span class="comment" id="3034678">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3034754">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3034821">package</span>&nbsp;<span class="ident" id="3034829">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3034834">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3034853">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3034872">const</span>&nbsp;<span class="op" id="3034878">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3034881">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3034933">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3034946">=</span>&nbsp;<span class="num" id="3034948">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3034951">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3034964">=</span>&nbsp;<span class="num" id="3034966">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3034969">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3034982">=</span>&nbsp;<span class="num" id="3034984">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3034987">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035000">=</span>&nbsp;<span class="num" id="3035002">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035005">dnsTypeCNAME</span>&nbsp;<span class="op" id="3035018">=</span>&nbsp;<span class="num" id="3035020">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035023">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035036">=</span>&nbsp;<span class="num" id="3035038">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035041">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035054">=</span>&nbsp;<span class="num" id="3035056">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035059">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035072">=</span>&nbsp;<span class="num" id="3035074">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035077">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035090">=</span>&nbsp;<span class="num" id="3035092">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035095">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3035108">=</span>&nbsp;<span class="num" id="3035110">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035114">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035127">=</span>&nbsp;<span class="num" id="3035129">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035133">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035146">=</span>&nbsp;<span class="num" id="3035148">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035152">dnsTypeHINFO</span>&nbsp;<span class="op" id="3035165">=</span>&nbsp;<span class="num" id="3035167">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035171">dnsTypeMINFO</span>&nbsp;<span class="op" id="3035184">=</span>&nbsp;<span class="num" id="3035186">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035190">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035203">=</span>&nbsp;<span class="num" id="3035205">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035209">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035222">=</span>&nbsp;<span class="num" id="3035224">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035228">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3035241">=</span>&nbsp;<span class="num" id="3035243">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035247">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035260">=</span>&nbsp;<span class="num" id="3035262">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035267">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035300">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3035313">=</span>&nbsp;<span class="num" id="3035315">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035320">dnsTypeMAILB</span>&nbsp;<span class="op" id="3035333">=</span>&nbsp;<span class="num" id="3035335">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035340">dnsTypeMAILA</span>&nbsp;<span class="op" id="3035353">=</span>&nbsp;<span class="num" id="3035355">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035360">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035373">=</span>&nbsp;<span class="num" id="3035375">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035381">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035410">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3035425">=</span>&nbsp;<span class="num" id="3035427">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035430">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3035445">=</span>&nbsp;<span class="num" id="3035447">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035450">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3035465">=</span>&nbsp;<span class="num" id="3035467">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035470">dnsClassHESIOD</span>&nbsp;<span class="op" id="3035485">=</span>&nbsp;<span class="num" id="3035487">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035490">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035505">=</span>&nbsp;<span class="num" id="3035507">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035513">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035530">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035553">=</span>&nbsp;<span class="num" id="3035555">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035558">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035581">=</span>&nbsp;<span class="num" id="3035583">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035586">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3035609">=</span>&nbsp;<span class="num" id="3035611">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035614">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035637">=</span>&nbsp;<span class="num" id="3035639">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035642">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3035665">=</span>&nbsp;<span class="num" id="3035667">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3035670">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3035693">=</span>&nbsp;<span class="num" id="3035695">5</span><br>
<span class="lineno"></span><span class="op" id="3035697">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3035700">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3035767">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3035794">type</span>&nbsp;<span class="ident" id="3035799">dnsStruct</span>&nbsp;<span class="keyword" id="3035809">interface</span>&nbsp;<span class="op" id="3035819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035822">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035879">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035937">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3035993">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3036043">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3036099">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3036141">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3036197">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036235">Walk</span><span class="op" id="3036239">(</span><span class="ident" id="3036240">f</span>&nbsp;<span class="keyword" id="3036242">func</span><span class="op" id="3036246">(</span><span class="ident" id="3036247">v</span>&nbsp;<span class="keyword" id="3036249">interface</span><span class="op" id="3036258">{</span><span class="op" id="3036259">}</span><span class="op" id="3036260">,</span>&nbsp;<span class="ident" id="3036262">name</span><span class="op" id="3036266">,</span>&nbsp;<span class="ident" id="3036268">tag</span>&nbsp;<span class="builtintype" id="3036272">string</span><span class="op" id="3036278">)</span>&nbsp;<span class="op" id="3036280">(</span><span class="ident" id="3036281">ok</span>&nbsp;<span class="builtintype" id="3036284">bool</span><span class="op" id="3036288">)</span><span class="op" id="3036289">)</span>&nbsp;<span class="op" id="3036291">(</span><span class="ident" id="3036292">ok</span>&nbsp;<span class="builtintype" id="3036295">bool</span><span class="op" id="3036299">)</span><br>
<span class="lineno"></span><span class="op" id="3036301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3036304">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3036350">type</span>&nbsp;<span class="ident" id="3036355">dnsHeader</span>&nbsp;<span class="keyword" id="3036365">struct</span>&nbsp;<span class="op" id="3036372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036375">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3036410">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036418">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3036453">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036461">Qdcount</span><span class="op" id="3036468">,</span>&nbsp;<span class="ident" id="3036470">Ancount</span><span class="op" id="3036477">,</span>&nbsp;<span class="ident" id="3036479">Nscount</span><span class="op" id="3036486">,</span>&nbsp;<span class="ident" id="3036488">Arcount</span>&nbsp;<span class="builtintype" id="3036496">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3036503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3036506">func</span>&nbsp;<span class="op" id="3036511">(</span><span class="ident" id="3036512">h</span>&nbsp;<span class="op" id="3036514">*</span><span class="ident" id="3036515">dnsHeader</span><span class="op" id="3036524">)</span>&nbsp;<span class="ident" id="3036526">Walk</span><span class="op" id="3036530">(</span><span class="ident" id="3036531">f</span>&nbsp;<span class="keyword" id="3036533">func</span><span class="op" id="3036537">(</span><span class="ident" id="3036538">v</span>&nbsp;<span class="keyword" id="3036540">interface</span><span class="op" id="3036549">{</span><span class="op" id="3036550">}</span><span class="op" id="3036551">,</span>&nbsp;<span class="ident" id="3036553">name</span><span class="op" id="3036557">,</span>&nbsp;<span class="ident" id="3036559">tag</span>&nbsp;<span class="builtintype" id="3036563">string</span><span class="op" id="3036569">)</span>&nbsp;<span class="builtintype" id="3036571">bool</span><span class="op" id="3036575">)</span>&nbsp;<span class="builtintype" id="3036577">bool</span>&nbsp;<span class="op" id="3036582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3036585">return</span>&nbsp;<span class="ident" id="3036592">f</span><span class="op" id="3036593">(</span><span class="op" id="3036594">&amp;</span><span class="ident" id="3036595">h</span><span class="op" id="3036596">.</span><span class="ident" id="3036597">Id</span><span class="op" id="3036599">,</span>&nbsp;<span class="string" id="3036601">&#34;Id&#34;</span><span class="op" id="3036605">,</span>&nbsp;<span class="string" id="3036607">&#34;&#34;</span><span class="op" id="3036609">)</span>&nbsp;<span class="op" id="3036611">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036616">f</span><span class="op" id="3036617">(</span><span class="op" id="3036618">&amp;</span><span class="ident" id="3036619">h</span><span class="op" id="3036620">.</span><span class="ident" id="3036621">Bits</span><span class="op" id="3036625">,</span>&nbsp;<span class="string" id="3036627">&#34;Bits&#34;</span><span class="op" id="3036633">,</span>&nbsp;<span class="string" id="3036635">&#34;&#34;</span><span class="op" id="3036637">)</span>&nbsp;<span class="op" id="3036639">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036644">f</span><span class="op" id="3036645">(</span><span class="op" id="3036646">&amp;</span><span class="ident" id="3036647">h</span><span class="op" id="3036648">.</span><span class="ident" id="3036649">Qdcount</span><span class="op" id="3036656">,</span>&nbsp;<span class="string" id="3036658">&#34;Qdcount&#34;</span><span class="op" id="3036667">,</span>&nbsp;<span class="string" id="3036669">&#34;&#34;</span><span class="op" id="3036671">)</span>&nbsp;<span class="op" id="3036673">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036678">f</span><span class="op" id="3036679">(</span><span class="op" id="3036680">&amp;</span><span class="ident" id="3036681">h</span><span class="op" id="3036682">.</span><span class="ident" id="3036683">Ancount</span><span class="op" id="3036690">,</span>&nbsp;<span class="string" id="3036692">&#34;Ancount&#34;</span><span class="op" id="3036701">,</span>&nbsp;<span class="string" id="3036703">&#34;&#34;</span><span class="op" id="3036705">)</span>&nbsp;<span class="op" id="3036707">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036712">f</span><span class="op" id="3036713">(</span><span class="op" id="3036714">&amp;</span><span class="ident" id="3036715">h</span><span class="op" id="3036716">.</span><span class="ident" id="3036717">Nscount</span><span class="op" id="3036724">,</span>&nbsp;<span class="string" id="3036726">&#34;Nscount&#34;</span><span class="op" id="3036735">,</span>&nbsp;<span class="string" id="3036737">&#34;&#34;</span><span class="op" id="3036739">)</span>&nbsp;<span class="op" id="3036741">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036746">f</span><span class="op" id="3036747">(</span><span class="op" id="3036748">&amp;</span><span class="ident" id="3036749">h</span><span class="op" id="3036750">.</span><span class="ident" id="3036751">Arcount</span><span class="op" id="3036758">,</span>&nbsp;<span class="string" id="3036760">&#34;Arcount&#34;</span><span class="op" id="3036769">,</span>&nbsp;<span class="string" id="3036771">&#34;&#34;</span><span class="op" id="3036773">)</span><br>
<span class="lineno"></span><span class="op" id="3036775">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3036778">const</span>&nbsp;<span class="op" id="3036784">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3036787">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036806">_QR</span>&nbsp;<span class="op" id="3036810">=</span>&nbsp;<span class="num" id="3036812">1</span>&nbsp;<span class="op" id="3036814">&lt;&lt;</span>&nbsp;<span class="num" id="3036817">15</span>&nbsp;<span class="comment" id="3036820">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036852">_AA</span>&nbsp;<span class="op" id="3036856">=</span>&nbsp;<span class="num" id="3036858">1</span>&nbsp;<span class="op" id="3036860">&lt;&lt;</span>&nbsp;<span class="num" id="3036863">10</span>&nbsp;<span class="comment" id="3036866">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036884">_TC</span>&nbsp;<span class="op" id="3036888">=</span>&nbsp;<span class="num" id="3036890">1</span>&nbsp;<span class="op" id="3036892">&lt;&lt;</span>&nbsp;<span class="num" id="3036895">9</span>&nbsp;&nbsp;<span class="comment" id="3036898">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036912">_RD</span>&nbsp;<span class="op" id="3036916">=</span>&nbsp;<span class="num" id="3036918">1</span>&nbsp;<span class="op" id="3036920">&lt;&lt;</span>&nbsp;<span class="num" id="3036923">8</span>&nbsp;&nbsp;<span class="comment" id="3036926">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3036948">_RA</span>&nbsp;<span class="op" id="3036952">=</span>&nbsp;<span class="num" id="3036954">1</span>&nbsp;<span class="op" id="3036956">&lt;&lt;</span>&nbsp;<span class="num" id="3036959">7</span>&nbsp;&nbsp;<span class="comment" id="3036962">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3036985">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3036988">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3037004">type</span>&nbsp;<span class="ident" id="3037009">dnsQuestion</span>&nbsp;<span class="keyword" id="3037021">struct</span>&nbsp;<span class="op" id="3037028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037031">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3037038">string</span>&nbsp;<span class="string" id="3037045">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3037065">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037127">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3037134">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037142">Qclass</span>&nbsp;<span class="builtintype" id="3037149">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3037156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3037159">func</span>&nbsp;<span class="op" id="3037164">(</span><span class="ident" id="3037165">q</span>&nbsp;<span class="op" id="3037167">*</span><span class="ident" id="3037168">dnsQuestion</span><span class="op" id="3037179">)</span>&nbsp;<span class="ident" id="3037181">Walk</span><span class="op" id="3037185">(</span><span class="ident" id="3037186">f</span>&nbsp;<span class="keyword" id="3037188">func</span><span class="op" id="3037192">(</span><span class="ident" id="3037193">v</span>&nbsp;<span class="keyword" id="3037195">interface</span><span class="op" id="3037204">{</span><span class="op" id="3037205">}</span><span class="op" id="3037206">,</span>&nbsp;<span class="ident" id="3037208">name</span><span class="op" id="3037212">,</span>&nbsp;<span class="ident" id="3037214">tag</span>&nbsp;<span class="builtintype" id="3037218">string</span><span class="op" id="3037224">)</span>&nbsp;<span class="builtintype" id="3037226">bool</span><span class="op" id="3037230">)</span>&nbsp;<span class="builtintype" id="3037232">bool</span>&nbsp;<span class="op" id="3037237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3037240">return</span>&nbsp;<span class="ident" id="3037247">f</span><span class="op" id="3037248">(</span><span class="op" id="3037249">&amp;</span><span class="ident" id="3037250">q</span><span class="op" id="3037251">.</span><span class="ident" id="3037252">Name</span><span class="op" id="3037256">,</span>&nbsp;<span class="string" id="3037258">&#34;Name&#34;</span><span class="op" id="3037264">,</span>&nbsp;<span class="string" id="3037266">&#34;domain&#34;</span><span class="op" id="3037274">)</span>&nbsp;<span class="op" id="3037276">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037281">f</span><span class="op" id="3037282">(</span><span class="op" id="3037283">&amp;</span><span class="ident" id="3037284">q</span><span class="op" id="3037285">.</span><span class="ident" id="3037286">Qtype</span><span class="op" id="3037291">,</span>&nbsp;<span class="string" id="3037293">&#34;Qtype&#34;</span><span class="op" id="3037300">,</span>&nbsp;<span class="string" id="3037302">&#34;&#34;</span><span class="op" id="3037304">)</span>&nbsp;<span class="op" id="3037306">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037311">f</span><span class="op" id="3037312">(</span><span class="op" id="3037313">&amp;</span><span class="ident" id="3037314">q</span><span class="op" id="3037315">.</span><span class="ident" id="3037316">Qclass</span><span class="op" id="3037322">,</span>&nbsp;<span class="string" id="3037324">&#34;Qclass&#34;</span><span class="op" id="3037332">,</span>&nbsp;<span class="string" id="3037334">&#34;&#34;</span><span class="op" id="3037336">)</span><br>
<span class="lineno"></span><span class="op" id="3037338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3037341">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3037378">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3037415">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3037454">type</span>&nbsp;<span class="ident" id="3037459">dnsRR_Header</span>&nbsp;<span class="keyword" id="3037472">struct</span>&nbsp;<span class="op" id="3037479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037482">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3037491">string</span>&nbsp;<span class="string" id="3037498">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037519">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3037528">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037536">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3037545">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037553">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3037562">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037570">Rdlength</span>&nbsp;<span class="builtintype" id="3037579">uint16</span>&nbsp;<span class="comment" id="3037586">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3037617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3037620">func</span>&nbsp;<span class="op" id="3037625">(</span><span class="ident" id="3037626">h</span>&nbsp;<span class="op" id="3037628">*</span><span class="ident" id="3037629">dnsRR_Header</span><span class="op" id="3037641">)</span>&nbsp;<span class="ident" id="3037643">Header</span><span class="op" id="3037649">(</span><span class="op" id="3037650">)</span>&nbsp;<span class="op" id="3037652">*</span><span class="ident" id="3037653">dnsRR_Header</span>&nbsp;<span class="op" id="3037666">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3037669">return</span>&nbsp;<span class="ident" id="3037676">h</span><br>
<span class="lineno"></span><span class="op" id="3037678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3037681">func</span>&nbsp;<span class="op" id="3037686">(</span><span class="ident" id="3037687">h</span>&nbsp;<span class="op" id="3037689">*</span><span class="ident" id="3037690">dnsRR_Header</span><span class="op" id="3037702">)</span>&nbsp;<span class="ident" id="3037704">Walk</span><span class="op" id="3037708">(</span><span class="ident" id="3037709">f</span>&nbsp;<span class="keyword" id="3037711">func</span><span class="op" id="3037715">(</span><span class="ident" id="3037716">v</span>&nbsp;<span class="keyword" id="3037718">interface</span><span class="op" id="3037727">{</span><span class="op" id="3037728">}</span><span class="op" id="3037729">,</span>&nbsp;<span class="ident" id="3037731">name</span><span class="op" id="3037735">,</span>&nbsp;<span class="ident" id="3037737">tag</span>&nbsp;<span class="builtintype" id="3037741">string</span><span class="op" id="3037747">)</span>&nbsp;<span class="builtintype" id="3037749">bool</span><span class="op" id="3037753">)</span>&nbsp;<span class="builtintype" id="3037755">bool</span>&nbsp;<span class="op" id="3037760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3037763">return</span>&nbsp;<span class="ident" id="3037770">f</span><span class="op" id="3037771">(</span><span class="op" id="3037772">&amp;</span><span class="ident" id="3037773">h</span><span class="op" id="3037774">.</span><span class="ident" id="3037775">Name</span><span class="op" id="3037779">,</span>&nbsp;<span class="string" id="3037781">&#34;Name&#34;</span><span class="op" id="3037787">,</span>&nbsp;<span class="string" id="3037789">&#34;domain&#34;</span><span class="op" id="3037797">)</span>&nbsp;<span class="op" id="3037799">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037804">f</span><span class="op" id="3037805">(</span><span class="op" id="3037806">&amp;</span><span class="ident" id="3037807">h</span><span class="op" id="3037808">.</span><span class="ident" id="3037809">Rrtype</span><span class="op" id="3037815">,</span>&nbsp;<span class="string" id="3037817">&#34;Rrtype&#34;</span><span class="op" id="3037825">,</span>&nbsp;<span class="string" id="3037827">&#34;&#34;</span><span class="op" id="3037829">)</span>&nbsp;<span class="op" id="3037831">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037836">f</span><span class="op" id="3037837">(</span><span class="op" id="3037838">&amp;</span><span class="ident" id="3037839">h</span><span class="op" id="3037840">.</span><span class="ident" id="3037841">Class</span><span class="op" id="3037846">,</span>&nbsp;<span class="string" id="3037848">&#34;Class&#34;</span><span class="op" id="3037855">,</span>&nbsp;<span class="string" id="3037857">&#34;&#34;</span><span class="op" id="3037859">)</span>&nbsp;<span class="op" id="3037861">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037866">f</span><span class="op" id="3037867">(</span><span class="op" id="3037868">&amp;</span><span class="ident" id="3037869">h</span><span class="op" id="3037870">.</span><span class="ident" id="3037871">Ttl</span><span class="op" id="3037874">,</span>&nbsp;<span class="string" id="3037876">&#34;Ttl&#34;</span><span class="op" id="3037881">,</span>&nbsp;<span class="string" id="3037883">&#34;&#34;</span><span class="op" id="3037885">)</span>&nbsp;<span class="op" id="3037887">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037892">f</span><span class="op" id="3037893">(</span><span class="op" id="3037894">&amp;</span><span class="ident" id="3037895">h</span><span class="op" id="3037896">.</span><span class="ident" id="3037897">Rdlength</span><span class="op" id="3037905">,</span>&nbsp;<span class="string" id="3037907">&#34;Rdlength&#34;</span><span class="op" id="3037917">,</span>&nbsp;<span class="string" id="3037919">&#34;&#34;</span><span class="op" id="3037921">)</span><br>
<span class="lineno"></span><span class="op" id="3037923">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3037926">type</span>&nbsp;<span class="ident" id="3037931">dnsRR</span>&nbsp;<span class="keyword" id="3037937">interface</span>&nbsp;<span class="op" id="3037947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037950">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3037961">Header</span><span class="op" id="3037967">(</span><span class="op" id="3037968">)</span>&nbsp;<span class="op" id="3037970">*</span><span class="ident" id="3037971">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3037984">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3037987">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038036">type</span>&nbsp;<span class="ident" id="3038041">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3038053">struct</span>&nbsp;<span class="op" id="3038060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038063">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3038069">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038083">Cname</span>&nbsp;<span class="builtintype" id="3038089">string</span>&nbsp;<span class="string" id="3038096">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3038116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038119">func</span>&nbsp;<span class="op" id="3038124">(</span><span class="ident" id="3038125">rr</span>&nbsp;<span class="op" id="3038128">*</span><span class="ident" id="3038129">dnsRR_CNAME</span><span class="op" id="3038140">)</span>&nbsp;<span class="ident" id="3038142">Header</span><span class="op" id="3038148">(</span><span class="op" id="3038149">)</span>&nbsp;<span class="op" id="3038151">*</span><span class="ident" id="3038152">dnsRR_Header</span>&nbsp;<span class="op" id="3038165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3038168">return</span>&nbsp;<span class="op" id="3038175">&amp;</span><span class="ident" id="3038176">rr</span><span class="op" id="3038178">.</span><span class="ident" id="3038179">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3038183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038186">func</span>&nbsp;<span class="op" id="3038191">(</span><span class="ident" id="3038192">rr</span>&nbsp;<span class="op" id="3038195">*</span><span class="ident" id="3038196">dnsRR_CNAME</span><span class="op" id="3038207">)</span>&nbsp;<span class="ident" id="3038209">Walk</span><span class="op" id="3038213">(</span><span class="ident" id="3038214">f</span>&nbsp;<span class="keyword" id="3038216">func</span><span class="op" id="3038220">(</span><span class="ident" id="3038221">v</span>&nbsp;<span class="keyword" id="3038223">interface</span><span class="op" id="3038232">{</span><span class="op" id="3038233">}</span><span class="op" id="3038234">,</span>&nbsp;<span class="ident" id="3038236">name</span><span class="op" id="3038240">,</span>&nbsp;<span class="ident" id="3038242">tag</span>&nbsp;<span class="builtintype" id="3038246">string</span><span class="op" id="3038252">)</span>&nbsp;<span class="builtintype" id="3038254">bool</span><span class="op" id="3038258">)</span>&nbsp;<span class="builtintype" id="3038260">bool</span>&nbsp;<span class="op" id="3038265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3038268">return</span>&nbsp;<span class="ident" id="3038275">rr</span><span class="op" id="3038277">.</span><span class="ident" id="3038278">Hdr</span><span class="op" id="3038281">.</span><span class="ident" id="3038282">Walk</span><span class="op" id="3038286">(</span><span class="ident" id="3038287">f</span><span class="op" id="3038288">)</span>&nbsp;<span class="op" id="3038290">&amp;&amp;</span>&nbsp;<span class="ident" id="3038293">f</span><span class="op" id="3038294">(</span><span class="op" id="3038295">&amp;</span><span class="ident" id="3038296">rr</span><span class="op" id="3038298">.</span><span class="ident" id="3038299">Cname</span><span class="op" id="3038304">,</span>&nbsp;<span class="string" id="3038306">&#34;Cname&#34;</span><span class="op" id="3038313">,</span>&nbsp;<span class="string" id="3038315">&#34;domain&#34;</span><span class="op" id="3038323">)</span><br>
<span class="lineno"></span><span class="op" id="3038325">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3038328">type</span>&nbsp;<span class="ident" id="3038333">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3038345">struct</span>&nbsp;<span class="op" id="3038352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038355">Hdr</span>&nbsp;<span class="ident" id="3038359">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038373">Cpu</span>&nbsp;<span class="builtintype" id="3038377">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038385">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3038389">string</span><br>
<span class="lineno">170</span><span class="op" id="3038396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038399">func</span>&nbsp;<span class="op" id="3038404">(</span><span class="ident" id="3038405">rr</span>&nbsp;<span class="op" id="3038408">*</span><span class="ident" id="3038409">dnsRR_HINFO</span><span class="op" id="3038420">)</span>&nbsp;<span class="ident" id="3038422">Header</span><span class="op" id="3038428">(</span><span class="op" id="3038429">)</span>&nbsp;<span class="op" id="3038431">*</span><span class="ident" id="3038432">dnsRR_Header</span>&nbsp;<span class="op" id="3038445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3038448">return</span>&nbsp;<span class="op" id="3038455">&amp;</span><span class="ident" id="3038456">rr</span><span class="op" id="3038458">.</span><span class="ident" id="3038459">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3038463">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3038466">func</span>&nbsp;<span class="op" id="3038471">(</span><span class="ident" id="3038472">rr</span>&nbsp;<span class="op" id="3038475">*</span><span class="ident" id="3038476">dnsRR_HINFO</span><span class="op" id="3038487">)</span>&nbsp;<span class="ident" id="3038489">Walk</span><span class="op" id="3038493">(</span><span class="ident" id="3038494">f</span>&nbsp;<span class="keyword" id="3038496">func</span><span class="op" id="3038500">(</span><span class="ident" id="3038501">v</span>&nbsp;<span class="keyword" id="3038503">interface</span><span class="op" id="3038512">{</span><span class="op" id="3038513">}</span><span class="op" id="3038514">,</span>&nbsp;<span class="ident" id="3038516">name</span><span class="op" id="3038520">,</span>&nbsp;<span class="ident" id="3038522">tag</span>&nbsp;<span class="builtintype" id="3038526">string</span><span class="op" id="3038532">)</span>&nbsp;<span class="builtintype" id="3038534">bool</span><span class="op" id="3038538">)</span>&nbsp;<span class="builtintype" id="3038540">bool</span>&nbsp;<span class="op" id="3038545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3038548">return</span>&nbsp;<span class="ident" id="3038555">rr</span><span class="op" id="3038557">.</span><span class="ident" id="3038558">Hdr</span><span class="op" id="3038561">.</span><span class="ident" id="3038562">Walk</span><span class="op" id="3038566">(</span><span class="ident" id="3038567">f</span><span class="op" id="3038568">)</span>&nbsp;<span class="op" id="3038570">&amp;&amp;</span>&nbsp;<span class="ident" id="3038573">f</span><span class="op" id="3038574">(</span><span class="op" id="3038575">&amp;</span><span class="ident" id="3038576">rr</span><span class="op" id="3038578">.</span><span class="ident" id="3038579">Cpu</span><span class="op" id="3038582">,</span>&nbsp;<span class="string" id="3038584">&#34;Cpu&#34;</span><span class="op" id="3038589">,</span>&nbsp;<span class="string" id="3038591">&#34;&#34;</span><span class="op" id="3038593">)</span>&nbsp;<span class="op" id="3038595">&amp;&amp;</span>&nbsp;<span class="ident" id="3038598">f</span><span class="op" id="3038599">(</span><span class="op" id="3038600">&amp;</span><span class="ident" id="3038601">rr</span><span class="op" id="3038603">.</span><span class="ident" id="3038604">Os</span><span class="op" id="3038606">,</span>&nbsp;<span class="string" id="3038608">&#34;Os&#34;</span><span class="op" id="3038612">,</span>&nbsp;<span class="string" id="3038614">&#34;&#34;</span><span class="op" id="3038616">)</span><br>
<span class="lineno"></span><span class="op" id="3038618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3038621">type</span>&nbsp;<span class="ident" id="3038626">dnsRR_MB</span>&nbsp;<span class="keyword" id="3038635">struct</span>&nbsp;<span class="op" id="3038642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038645">Hdr</span>&nbsp;<span class="ident" id="3038649">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038663">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3038667">string</span>&nbsp;<span class="string" id="3038674">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3038694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3038697">func</span>&nbsp;<span class="op" id="3038702">(</span><span class="ident" id="3038703">rr</span>&nbsp;<span class="op" id="3038706">*</span><span class="ident" id="3038707">dnsRR_MB</span><span class="op" id="3038715">)</span>&nbsp;<span class="ident" id="3038717">Header</span><span class="op" id="3038723">(</span><span class="op" id="3038724">)</span>&nbsp;<span class="op" id="3038726">*</span><span class="ident" id="3038727">dnsRR_Header</span>&nbsp;<span class="op" id="3038740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3038743">return</span>&nbsp;<span class="op" id="3038750">&amp;</span><span class="ident" id="3038751">rr</span><span class="op" id="3038753">.</span><span class="ident" id="3038754">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3038758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038761">func</span>&nbsp;<span class="op" id="3038766">(</span><span class="ident" id="3038767">rr</span>&nbsp;<span class="op" id="3038770">*</span><span class="ident" id="3038771">dnsRR_MB</span><span class="op" id="3038779">)</span>&nbsp;<span class="ident" id="3038781">Walk</span><span class="op" id="3038785">(</span><span class="ident" id="3038786">f</span>&nbsp;<span class="keyword" id="3038788">func</span><span class="op" id="3038792">(</span><span class="ident" id="3038793">v</span>&nbsp;<span class="keyword" id="3038795">interface</span><span class="op" id="3038804">{</span><span class="op" id="3038805">}</span><span class="op" id="3038806">,</span>&nbsp;<span class="ident" id="3038808">name</span><span class="op" id="3038812">,</span>&nbsp;<span class="ident" id="3038814">tag</span>&nbsp;<span class="builtintype" id="3038818">string</span><span class="op" id="3038824">)</span>&nbsp;<span class="builtintype" id="3038826">bool</span><span class="op" id="3038830">)</span>&nbsp;<span class="builtintype" id="3038832">bool</span>&nbsp;<span class="op" id="3038837">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3038840">return</span>&nbsp;<span class="ident" id="3038847">rr</span><span class="op" id="3038849">.</span><span class="ident" id="3038850">Hdr</span><span class="op" id="3038853">.</span><span class="ident" id="3038854">Walk</span><span class="op" id="3038858">(</span><span class="ident" id="3038859">f</span><span class="op" id="3038860">)</span>&nbsp;<span class="op" id="3038862">&amp;&amp;</span>&nbsp;<span class="ident" id="3038865">f</span><span class="op" id="3038866">(</span><span class="op" id="3038867">&amp;</span><span class="ident" id="3038868">rr</span><span class="op" id="3038870">.</span><span class="ident" id="3038871">Mb</span><span class="op" id="3038873">,</span>&nbsp;<span class="string" id="3038875">&#34;Mb&#34;</span><span class="op" id="3038879">,</span>&nbsp;<span class="string" id="3038881">&#34;domain&#34;</span><span class="op" id="3038889">)</span><br>
<span class="lineno"></span><span class="op" id="3038891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038894">type</span>&nbsp;<span class="ident" id="3038899">dnsRR_MG</span>&nbsp;<span class="keyword" id="3038908">struct</span>&nbsp;<span class="op" id="3038915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038918">Hdr</span>&nbsp;<span class="ident" id="3038922">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3038936">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3038940">string</span>&nbsp;<span class="string" id="3038947">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3038967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3038970">func</span>&nbsp;<span class="op" id="3038975">(</span><span class="ident" id="3038976">rr</span>&nbsp;<span class="op" id="3038979">*</span><span class="ident" id="3038980">dnsRR_MG</span><span class="op" id="3038988">)</span>&nbsp;<span class="ident" id="3038990">Header</span><span class="op" id="3038996">(</span><span class="op" id="3038997">)</span>&nbsp;<span class="op" id="3038999">*</span><span class="ident" id="3039000">dnsRR_Header</span>&nbsp;<span class="op" id="3039013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039016">return</span>&nbsp;<span class="op" id="3039023">&amp;</span><span class="ident" id="3039024">rr</span><span class="op" id="3039026">.</span><span class="ident" id="3039027">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3039031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3039034">func</span>&nbsp;<span class="op" id="3039039">(</span><span class="ident" id="3039040">rr</span>&nbsp;<span class="op" id="3039043">*</span><span class="ident" id="3039044">dnsRR_MG</span><span class="op" id="3039052">)</span>&nbsp;<span class="ident" id="3039054">Walk</span><span class="op" id="3039058">(</span><span class="ident" id="3039059">f</span>&nbsp;<span class="keyword" id="3039061">func</span><span class="op" id="3039065">(</span><span class="ident" id="3039066">v</span>&nbsp;<span class="keyword" id="3039068">interface</span><span class="op" id="3039077">{</span><span class="op" id="3039078">}</span><span class="op" id="3039079">,</span>&nbsp;<span class="ident" id="3039081">name</span><span class="op" id="3039085">,</span>&nbsp;<span class="ident" id="3039087">tag</span>&nbsp;<span class="builtintype" id="3039091">string</span><span class="op" id="3039097">)</span>&nbsp;<span class="builtintype" id="3039099">bool</span><span class="op" id="3039103">)</span>&nbsp;<span class="builtintype" id="3039105">bool</span>&nbsp;<span class="op" id="3039110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039113">return</span>&nbsp;<span class="ident" id="3039120">rr</span><span class="op" id="3039122">.</span><span class="ident" id="3039123">Hdr</span><span class="op" id="3039126">.</span><span class="ident" id="3039127">Walk</span><span class="op" id="3039131">(</span><span class="ident" id="3039132">f</span><span class="op" id="3039133">)</span>&nbsp;<span class="op" id="3039135">&amp;&amp;</span>&nbsp;<span class="ident" id="3039138">f</span><span class="op" id="3039139">(</span><span class="op" id="3039140">&amp;</span><span class="ident" id="3039141">rr</span><span class="op" id="3039143">.</span><span class="ident" id="3039144">Mg</span><span class="op" id="3039146">,</span>&nbsp;<span class="string" id="3039148">&#34;Mg&#34;</span><span class="op" id="3039152">,</span>&nbsp;<span class="string" id="3039154">&#34;domain&#34;</span><span class="op" id="3039162">)</span><br>
<span class="lineno"></span><span class="op" id="3039164">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3039167">type</span>&nbsp;<span class="ident" id="3039172">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3039184">struct</span>&nbsp;<span class="op" id="3039191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039194">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3039200">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039214">Rmail</span>&nbsp;<span class="builtintype" id="3039220">string</span>&nbsp;<span class="string" id="3039227">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039248">Email</span>&nbsp;<span class="builtintype" id="3039254">string</span>&nbsp;<span class="string" id="3039261">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3039281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3039284">func</span>&nbsp;<span class="op" id="3039289">(</span><span class="ident" id="3039290">rr</span>&nbsp;<span class="op" id="3039293">*</span><span class="ident" id="3039294">dnsRR_MINFO</span><span class="op" id="3039305">)</span>&nbsp;<span class="ident" id="3039307">Header</span><span class="op" id="3039313">(</span><span class="op" id="3039314">)</span>&nbsp;<span class="op" id="3039316">*</span><span class="ident" id="3039317">dnsRR_Header</span>&nbsp;<span class="op" id="3039330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039333">return</span>&nbsp;<span class="op" id="3039340">&amp;</span><span class="ident" id="3039341">rr</span><span class="op" id="3039343">.</span><span class="ident" id="3039344">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3039348">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3039351">func</span>&nbsp;<span class="op" id="3039356">(</span><span class="ident" id="3039357">rr</span>&nbsp;<span class="op" id="3039360">*</span><span class="ident" id="3039361">dnsRR_MINFO</span><span class="op" id="3039372">)</span>&nbsp;<span class="ident" id="3039374">Walk</span><span class="op" id="3039378">(</span><span class="ident" id="3039379">f</span>&nbsp;<span class="keyword" id="3039381">func</span><span class="op" id="3039385">(</span><span class="ident" id="3039386">v</span>&nbsp;<span class="keyword" id="3039388">interface</span><span class="op" id="3039397">{</span><span class="op" id="3039398">}</span><span class="op" id="3039399">,</span>&nbsp;<span class="ident" id="3039401">name</span><span class="op" id="3039405">,</span>&nbsp;<span class="ident" id="3039407">tag</span>&nbsp;<span class="builtintype" id="3039411">string</span><span class="op" id="3039417">)</span>&nbsp;<span class="builtintype" id="3039419">bool</span><span class="op" id="3039423">)</span>&nbsp;<span class="builtintype" id="3039425">bool</span>&nbsp;<span class="op" id="3039430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039433">return</span>&nbsp;<span class="ident" id="3039440">rr</span><span class="op" id="3039442">.</span><span class="ident" id="3039443">Hdr</span><span class="op" id="3039446">.</span><span class="ident" id="3039447">Walk</span><span class="op" id="3039451">(</span><span class="ident" id="3039452">f</span><span class="op" id="3039453">)</span>&nbsp;<span class="op" id="3039455">&amp;&amp;</span>&nbsp;<span class="ident" id="3039458">f</span><span class="op" id="3039459">(</span><span class="op" id="3039460">&amp;</span><span class="ident" id="3039461">rr</span><span class="op" id="3039463">.</span><span class="ident" id="3039464">Rmail</span><span class="op" id="3039469">,</span>&nbsp;<span class="string" id="3039471">&#34;Rmail&#34;</span><span class="op" id="3039478">,</span>&nbsp;<span class="string" id="3039480">&#34;domain&#34;</span><span class="op" id="3039488">)</span>&nbsp;<span class="op" id="3039490">&amp;&amp;</span>&nbsp;<span class="ident" id="3039493">f</span><span class="op" id="3039494">(</span><span class="op" id="3039495">&amp;</span><span class="ident" id="3039496">rr</span><span class="op" id="3039498">.</span><span class="ident" id="3039499">Email</span><span class="op" id="3039504">,</span>&nbsp;<span class="string" id="3039506">&#34;Email&#34;</span><span class="op" id="3039513">,</span>&nbsp;<span class="string" id="3039515">&#34;domain&#34;</span><span class="op" id="3039523">)</span><br>
<span class="lineno"></span><span class="op" id="3039525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3039528">type</span>&nbsp;<span class="ident" id="3039533">dnsRR_MR</span>&nbsp;<span class="keyword" id="3039542">struct</span>&nbsp;<span class="op" id="3039549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039552">Hdr</span>&nbsp;<span class="ident" id="3039556">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039570">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3039574">string</span>&nbsp;<span class="string" id="3039581">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3039601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3039604">func</span>&nbsp;<span class="op" id="3039609">(</span><span class="ident" id="3039610">rr</span>&nbsp;<span class="op" id="3039613">*</span><span class="ident" id="3039614">dnsRR_MR</span><span class="op" id="3039622">)</span>&nbsp;<span class="ident" id="3039624">Header</span><span class="op" id="3039630">(</span><span class="op" id="3039631">)</span>&nbsp;<span class="op" id="3039633">*</span><span class="ident" id="3039634">dnsRR_Header</span>&nbsp;<span class="op" id="3039647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039650">return</span>&nbsp;<span class="op" id="3039657">&amp;</span><span class="ident" id="3039658">rr</span><span class="op" id="3039660">.</span><span class="ident" id="3039661">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3039665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3039668">func</span>&nbsp;<span class="op" id="3039673">(</span><span class="ident" id="3039674">rr</span>&nbsp;<span class="op" id="3039677">*</span><span class="ident" id="3039678">dnsRR_MR</span><span class="op" id="3039686">)</span>&nbsp;<span class="ident" id="3039688">Walk</span><span class="op" id="3039692">(</span><span class="ident" id="3039693">f</span>&nbsp;<span class="keyword" id="3039695">func</span><span class="op" id="3039699">(</span><span class="ident" id="3039700">v</span>&nbsp;<span class="keyword" id="3039702">interface</span><span class="op" id="3039711">{</span><span class="op" id="3039712">}</span><span class="op" id="3039713">,</span>&nbsp;<span class="ident" id="3039715">name</span><span class="op" id="3039719">,</span>&nbsp;<span class="ident" id="3039721">tag</span>&nbsp;<span class="builtintype" id="3039725">string</span><span class="op" id="3039731">)</span>&nbsp;<span class="builtintype" id="3039733">bool</span><span class="op" id="3039737">)</span>&nbsp;<span class="builtintype" id="3039739">bool</span>&nbsp;<span class="op" id="3039744">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039747">return</span>&nbsp;<span class="ident" id="3039754">rr</span><span class="op" id="3039756">.</span><span class="ident" id="3039757">Hdr</span><span class="op" id="3039760">.</span><span class="ident" id="3039761">Walk</span><span class="op" id="3039765">(</span><span class="ident" id="3039766">f</span><span class="op" id="3039767">)</span>&nbsp;<span class="op" id="3039769">&amp;&amp;</span>&nbsp;<span class="ident" id="3039772">f</span><span class="op" id="3039773">(</span><span class="op" id="3039774">&amp;</span><span class="ident" id="3039775">rr</span><span class="op" id="3039777">.</span><span class="ident" id="3039778">Mr</span><span class="op" id="3039780">,</span>&nbsp;<span class="string" id="3039782">&#34;Mr&#34;</span><span class="op" id="3039786">,</span>&nbsp;<span class="string" id="3039788">&#34;domain&#34;</span><span class="op" id="3039796">)</span><br>
<span class="lineno"></span><span class="op" id="3039798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3039801">type</span>&nbsp;<span class="ident" id="3039806">dnsRR_MX</span>&nbsp;<span class="keyword" id="3039815">struct</span>&nbsp;<span class="op" id="3039822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039825">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3039830">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039844">Pref</span>&nbsp;<span class="builtintype" id="3039849">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3039857">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3039862">string</span>&nbsp;<span class="string" id="3039869">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3039889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3039892">func</span>&nbsp;<span class="op" id="3039897">(</span><span class="ident" id="3039898">rr</span>&nbsp;<span class="op" id="3039901">*</span><span class="ident" id="3039902">dnsRR_MX</span><span class="op" id="3039910">)</span>&nbsp;<span class="ident" id="3039912">Header</span><span class="op" id="3039918">(</span><span class="op" id="3039919">)</span>&nbsp;<span class="op" id="3039921">*</span><span class="ident" id="3039922">dnsRR_Header</span>&nbsp;<span class="op" id="3039935">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3039938">return</span>&nbsp;<span class="op" id="3039945">&amp;</span><span class="ident" id="3039946">rr</span><span class="op" id="3039948">.</span><span class="ident" id="3039949">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3039953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3039956">func</span>&nbsp;<span class="op" id="3039961">(</span><span class="ident" id="3039962">rr</span>&nbsp;<span class="op" id="3039965">*</span><span class="ident" id="3039966">dnsRR_MX</span><span class="op" id="3039974">)</span>&nbsp;<span class="ident" id="3039976">Walk</span><span class="op" id="3039980">(</span><span class="ident" id="3039981">f</span>&nbsp;<span class="keyword" id="3039983">func</span><span class="op" id="3039987">(</span><span class="ident" id="3039988">v</span>&nbsp;<span class="keyword" id="3039990">interface</span><span class="op" id="3039999">{</span><span class="op" id="3040000">}</span><span class="op" id="3040001">,</span>&nbsp;<span class="ident" id="3040003">name</span><span class="op" id="3040007">,</span>&nbsp;<span class="ident" id="3040009">tag</span>&nbsp;<span class="builtintype" id="3040013">string</span><span class="op" id="3040019">)</span>&nbsp;<span class="builtintype" id="3040021">bool</span><span class="op" id="3040025">)</span>&nbsp;<span class="builtintype" id="3040027">bool</span>&nbsp;<span class="op" id="3040032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3040035">return</span>&nbsp;<span class="ident" id="3040042">rr</span><span class="op" id="3040044">.</span><span class="ident" id="3040045">Hdr</span><span class="op" id="3040048">.</span><span class="ident" id="3040049">Walk</span><span class="op" id="3040053">(</span><span class="ident" id="3040054">f</span><span class="op" id="3040055">)</span>&nbsp;<span class="op" id="3040057">&amp;&amp;</span>&nbsp;<span class="ident" id="3040060">f</span><span class="op" id="3040061">(</span><span class="op" id="3040062">&amp;</span><span class="ident" id="3040063">rr</span><span class="op" id="3040065">.</span><span class="ident" id="3040066">Pref</span><span class="op" id="3040070">,</span>&nbsp;<span class="string" id="3040072">&#34;Pref&#34;</span><span class="op" id="3040078">,</span>&nbsp;<span class="string" id="3040080">&#34;&#34;</span><span class="op" id="3040082">)</span>&nbsp;<span class="op" id="3040084">&amp;&amp;</span>&nbsp;<span class="ident" id="3040087">f</span><span class="op" id="3040088">(</span><span class="op" id="3040089">&amp;</span><span class="ident" id="3040090">rr</span><span class="op" id="3040092">.</span><span class="ident" id="3040093">Mx</span><span class="op" id="3040095">,</span>&nbsp;<span class="string" id="3040097">&#34;Mx&#34;</span><span class="op" id="3040101">,</span>&nbsp;<span class="string" id="3040103">&#34;domain&#34;</span><span class="op" id="3040111">)</span><br>
<span class="lineno">245</span><span class="op" id="3040113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3040116">type</span>&nbsp;<span class="ident" id="3040121">dnsRR_NS</span>&nbsp;<span class="keyword" id="3040130">struct</span>&nbsp;<span class="op" id="3040137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040140">Hdr</span>&nbsp;<span class="ident" id="3040144">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040158">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3040162">string</span>&nbsp;<span class="string" id="3040169">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3040189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3040192">func</span>&nbsp;<span class="op" id="3040197">(</span><span class="ident" id="3040198">rr</span>&nbsp;<span class="op" id="3040201">*</span><span class="ident" id="3040202">dnsRR_NS</span><span class="op" id="3040210">)</span>&nbsp;<span class="ident" id="3040212">Header</span><span class="op" id="3040218">(</span><span class="op" id="3040219">)</span>&nbsp;<span class="op" id="3040221">*</span><span class="ident" id="3040222">dnsRR_Header</span>&nbsp;<span class="op" id="3040235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3040238">return</span>&nbsp;<span class="op" id="3040245">&amp;</span><span class="ident" id="3040246">rr</span><span class="op" id="3040248">.</span><span class="ident" id="3040249">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3040253">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3040256">func</span>&nbsp;<span class="op" id="3040261">(</span><span class="ident" id="3040262">rr</span>&nbsp;<span class="op" id="3040265">*</span><span class="ident" id="3040266">dnsRR_NS</span><span class="op" id="3040274">)</span>&nbsp;<span class="ident" id="3040276">Walk</span><span class="op" id="3040280">(</span><span class="ident" id="3040281">f</span>&nbsp;<span class="keyword" id="3040283">func</span><span class="op" id="3040287">(</span><span class="ident" id="3040288">v</span>&nbsp;<span class="keyword" id="3040290">interface</span><span class="op" id="3040299">{</span><span class="op" id="3040300">}</span><span class="op" id="3040301">,</span>&nbsp;<span class="ident" id="3040303">name</span><span class="op" id="3040307">,</span>&nbsp;<span class="ident" id="3040309">tag</span>&nbsp;<span class="builtintype" id="3040313">string</span><span class="op" id="3040319">)</span>&nbsp;<span class="builtintype" id="3040321">bool</span><span class="op" id="3040325">)</span>&nbsp;<span class="builtintype" id="3040327">bool</span>&nbsp;<span class="op" id="3040332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3040335">return</span>&nbsp;<span class="ident" id="3040342">rr</span><span class="op" id="3040344">.</span><span class="ident" id="3040345">Hdr</span><span class="op" id="3040348">.</span><span class="ident" id="3040349">Walk</span><span class="op" id="3040353">(</span><span class="ident" id="3040354">f</span><span class="op" id="3040355">)</span>&nbsp;<span class="op" id="3040357">&amp;&amp;</span>&nbsp;<span class="ident" id="3040360">f</span><span class="op" id="3040361">(</span><span class="op" id="3040362">&amp;</span><span class="ident" id="3040363">rr</span><span class="op" id="3040365">.</span><span class="ident" id="3040366">Ns</span><span class="op" id="3040368">,</span>&nbsp;<span class="string" id="3040370">&#34;Ns&#34;</span><span class="op" id="3040374">,</span>&nbsp;<span class="string" id="3040376">&#34;domain&#34;</span><span class="op" id="3040384">)</span><br>
<span class="lineno"></span><span class="op" id="3040386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3040389">type</span>&nbsp;<span class="ident" id="3040394">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3040404">struct</span>&nbsp;<span class="op" id="3040411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040414">Hdr</span>&nbsp;<span class="ident" id="3040418">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040432">Ptr</span>&nbsp;<span class="builtintype" id="3040436">string</span>&nbsp;<span class="string" id="3040443">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3040463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3040466">func</span>&nbsp;<span class="op" id="3040471">(</span><span class="ident" id="3040472">rr</span>&nbsp;<span class="op" id="3040475">*</span><span class="ident" id="3040476">dnsRR_PTR</span><span class="op" id="3040485">)</span>&nbsp;<span class="ident" id="3040487">Header</span><span class="op" id="3040493">(</span><span class="op" id="3040494">)</span>&nbsp;<span class="op" id="3040496">*</span><span class="ident" id="3040497">dnsRR_Header</span>&nbsp;<span class="op" id="3040510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3040513">return</span>&nbsp;<span class="op" id="3040520">&amp;</span><span class="ident" id="3040521">rr</span><span class="op" id="3040523">.</span><span class="ident" id="3040524">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3040528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3040531">func</span>&nbsp;<span class="op" id="3040536">(</span><span class="ident" id="3040537">rr</span>&nbsp;<span class="op" id="3040540">*</span><span class="ident" id="3040541">dnsRR_PTR</span><span class="op" id="3040550">)</span>&nbsp;<span class="ident" id="3040552">Walk</span><span class="op" id="3040556">(</span><span class="ident" id="3040557">f</span>&nbsp;<span class="keyword" id="3040559">func</span><span class="op" id="3040563">(</span><span class="ident" id="3040564">v</span>&nbsp;<span class="keyword" id="3040566">interface</span><span class="op" id="3040575">{</span><span class="op" id="3040576">}</span><span class="op" id="3040577">,</span>&nbsp;<span class="ident" id="3040579">name</span><span class="op" id="3040583">,</span>&nbsp;<span class="ident" id="3040585">tag</span>&nbsp;<span class="builtintype" id="3040589">string</span><span class="op" id="3040595">)</span>&nbsp;<span class="builtintype" id="3040597">bool</span><span class="op" id="3040601">)</span>&nbsp;<span class="builtintype" id="3040603">bool</span>&nbsp;<span class="op" id="3040608">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3040611">return</span>&nbsp;<span class="ident" id="3040618">rr</span><span class="op" id="3040620">.</span><span class="ident" id="3040621">Hdr</span><span class="op" id="3040624">.</span><span class="ident" id="3040625">Walk</span><span class="op" id="3040629">(</span><span class="ident" id="3040630">f</span><span class="op" id="3040631">)</span>&nbsp;<span class="op" id="3040633">&amp;&amp;</span>&nbsp;<span class="ident" id="3040636">f</span><span class="op" id="3040637">(</span><span class="op" id="3040638">&amp;</span><span class="ident" id="3040639">rr</span><span class="op" id="3040641">.</span><span class="ident" id="3040642">Ptr</span><span class="op" id="3040645">,</span>&nbsp;<span class="string" id="3040647">&#34;Ptr&#34;</span><span class="op" id="3040652">,</span>&nbsp;<span class="string" id="3040654">&#34;domain&#34;</span><span class="op" id="3040662">)</span><br>
<span class="lineno"></span><span class="op" id="3040664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3040667">type</span>&nbsp;<span class="ident" id="3040672">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3040682">struct</span>&nbsp;<span class="op" id="3040689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040692">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040700">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040714">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3040722">string</span>&nbsp;<span class="string" id="3040729">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040750">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3040758">string</span>&nbsp;<span class="string" id="3040765">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040786">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3040794">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040802">Refresh</span>&nbsp;<span class="builtintype" id="3040810">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040818">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3040826">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040834">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3040842">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3040850">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3040858">uint32</span><br>
<span class="lineno"></span><span class="op" id="3040865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3040868">func</span>&nbsp;<span class="op" id="3040873">(</span><span class="ident" id="3040874">rr</span>&nbsp;<span class="op" id="3040877">*</span><span class="ident" id="3040878">dnsRR_SOA</span><span class="op" id="3040887">)</span>&nbsp;<span class="ident" id="3040889">Header</span><span class="op" id="3040895">(</span><span class="op" id="3040896">)</span>&nbsp;<span class="op" id="3040898">*</span><span class="ident" id="3040899">dnsRR_Header</span>&nbsp;<span class="op" id="3040912">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3040915">return</span>&nbsp;<span class="op" id="3040922">&amp;</span><span class="ident" id="3040923">rr</span><span class="op" id="3040925">.</span><span class="ident" id="3040926">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3040930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3040933">func</span>&nbsp;<span class="op" id="3040938">(</span><span class="ident" id="3040939">rr</span>&nbsp;<span class="op" id="3040942">*</span><span class="ident" id="3040943">dnsRR_SOA</span><span class="op" id="3040952">)</span>&nbsp;<span class="ident" id="3040954">Walk</span><span class="op" id="3040958">(</span><span class="ident" id="3040959">f</span>&nbsp;<span class="keyword" id="3040961">func</span><span class="op" id="3040965">(</span><span class="ident" id="3040966">v</span>&nbsp;<span class="keyword" id="3040968">interface</span><span class="op" id="3040977">{</span><span class="op" id="3040978">}</span><span class="op" id="3040979">,</span>&nbsp;<span class="ident" id="3040981">name</span><span class="op" id="3040985">,</span>&nbsp;<span class="ident" id="3040987">tag</span>&nbsp;<span class="builtintype" id="3040991">string</span><span class="op" id="3040997">)</span>&nbsp;<span class="builtintype" id="3040999">bool</span><span class="op" id="3041003">)</span>&nbsp;<span class="builtintype" id="3041005">bool</span>&nbsp;<span class="op" id="3041010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3041013">return</span>&nbsp;<span class="ident" id="3041020">rr</span><span class="op" id="3041022">.</span><span class="ident" id="3041023">Hdr</span><span class="op" id="3041026">.</span><span class="ident" id="3041027">Walk</span><span class="op" id="3041031">(</span><span class="ident" id="3041032">f</span><span class="op" id="3041033">)</span>&nbsp;<span class="op" id="3041035">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041040">f</span><span class="op" id="3041041">(</span><span class="op" id="3041042">&amp;</span><span class="ident" id="3041043">rr</span><span class="op" id="3041045">.</span><span class="ident" id="3041046">Ns</span><span class="op" id="3041048">,</span>&nbsp;<span class="string" id="3041050">&#34;Ns&#34;</span><span class="op" id="3041054">,</span>&nbsp;<span class="string" id="3041056">&#34;domain&#34;</span><span class="op" id="3041064">)</span>&nbsp;<span class="op" id="3041066">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041071">f</span><span class="op" id="3041072">(</span><span class="op" id="3041073">&amp;</span><span class="ident" id="3041074">rr</span><span class="op" id="3041076">.</span><span class="ident" id="3041077">Mbox</span><span class="op" id="3041081">,</span>&nbsp;<span class="string" id="3041083">&#34;Mbox&#34;</span><span class="op" id="3041089">,</span>&nbsp;<span class="string" id="3041091">&#34;domain&#34;</span><span class="op" id="3041099">)</span>&nbsp;<span class="op" id="3041101">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041106">f</span><span class="op" id="3041107">(</span><span class="op" id="3041108">&amp;</span><span class="ident" id="3041109">rr</span><span class="op" id="3041111">.</span><span class="ident" id="3041112">Serial</span><span class="op" id="3041118">,</span>&nbsp;<span class="string" id="3041120">&#34;Serial&#34;</span><span class="op" id="3041128">,</span>&nbsp;<span class="string" id="3041130">&#34;&#34;</span><span class="op" id="3041132">)</span>&nbsp;<span class="op" id="3041134">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041139">f</span><span class="op" id="3041140">(</span><span class="op" id="3041141">&amp;</span><span class="ident" id="3041142">rr</span><span class="op" id="3041144">.</span><span class="ident" id="3041145">Refresh</span><span class="op" id="3041152">,</span>&nbsp;<span class="string" id="3041154">&#34;Refresh&#34;</span><span class="op" id="3041163">,</span>&nbsp;<span class="string" id="3041165">&#34;&#34;</span><span class="op" id="3041167">)</span>&nbsp;<span class="op" id="3041169">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041174">f</span><span class="op" id="3041175">(</span><span class="op" id="3041176">&amp;</span><span class="ident" id="3041177">rr</span><span class="op" id="3041179">.</span><span class="ident" id="3041180">Retry</span><span class="op" id="3041185">,</span>&nbsp;<span class="string" id="3041187">&#34;Retry&#34;</span><span class="op" id="3041194">,</span>&nbsp;<span class="string" id="3041196">&#34;&#34;</span><span class="op" id="3041198">)</span>&nbsp;<span class="op" id="3041200">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041205">f</span><span class="op" id="3041206">(</span><span class="op" id="3041207">&amp;</span><span class="ident" id="3041208">rr</span><span class="op" id="3041210">.</span><span class="ident" id="3041211">Expire</span><span class="op" id="3041217">,</span>&nbsp;<span class="string" id="3041219">&#34;Expire&#34;</span><span class="op" id="3041227">,</span>&nbsp;<span class="string" id="3041229">&#34;&#34;</span><span class="op" id="3041231">)</span>&nbsp;<span class="op" id="3041233">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041238">f</span><span class="op" id="3041239">(</span><span class="op" id="3041240">&amp;</span><span class="ident" id="3041241">rr</span><span class="op" id="3041243">.</span><span class="ident" id="3041244">Minttl</span><span class="op" id="3041250">,</span>&nbsp;<span class="string" id="3041252">&#34;Minttl&#34;</span><span class="op" id="3041260">,</span>&nbsp;<span class="string" id="3041262">&#34;&#34;</span><span class="op" id="3041264">)</span><br>
<span class="lineno"></span><span class="op" id="3041266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3041269">type</span>&nbsp;<span class="ident" id="3041274">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3041284">struct</span>&nbsp;<span class="op" id="3041291">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041294">Hdr</span>&nbsp;<span class="ident" id="3041298">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041312">Txt</span>&nbsp;<span class="builtintype" id="3041316">string</span>&nbsp;<span class="comment" id="3041323">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3041342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3041345">func</span>&nbsp;<span class="op" id="3041350">(</span><span class="ident" id="3041351">rr</span>&nbsp;<span class="op" id="3041354">*</span><span class="ident" id="3041355">dnsRR_TXT</span><span class="op" id="3041364">)</span>&nbsp;<span class="ident" id="3041366">Header</span><span class="op" id="3041372">(</span><span class="op" id="3041373">)</span>&nbsp;<span class="op" id="3041375">*</span><span class="ident" id="3041376">dnsRR_Header</span>&nbsp;<span class="op" id="3041389">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3041392">return</span>&nbsp;<span class="op" id="3041399">&amp;</span><span class="ident" id="3041400">rr</span><span class="op" id="3041402">.</span><span class="ident" id="3041403">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3041407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3041410">func</span>&nbsp;<span class="op" id="3041415">(</span><span class="ident" id="3041416">rr</span>&nbsp;<span class="op" id="3041419">*</span><span class="ident" id="3041420">dnsRR_TXT</span><span class="op" id="3041429">)</span>&nbsp;<span class="ident" id="3041431">Walk</span><span class="op" id="3041435">(</span><span class="ident" id="3041436">f</span>&nbsp;<span class="keyword" id="3041438">func</span><span class="op" id="3041442">(</span><span class="ident" id="3041443">v</span>&nbsp;<span class="keyword" id="3041445">interface</span><span class="op" id="3041454">{</span><span class="op" id="3041455">}</span><span class="op" id="3041456">,</span>&nbsp;<span class="ident" id="3041458">name</span><span class="op" id="3041462">,</span>&nbsp;<span class="ident" id="3041464">tag</span>&nbsp;<span class="builtintype" id="3041468">string</span><span class="op" id="3041474">)</span>&nbsp;<span class="builtintype" id="3041476">bool</span><span class="op" id="3041480">)</span>&nbsp;<span class="builtintype" id="3041482">bool</span>&nbsp;<span class="op" id="3041487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3041490">return</span>&nbsp;<span class="ident" id="3041497">rr</span><span class="op" id="3041499">.</span><span class="ident" id="3041500">Hdr</span><span class="op" id="3041503">.</span><span class="ident" id="3041504">Walk</span><span class="op" id="3041508">(</span><span class="ident" id="3041509">f</span><span class="op" id="3041510">)</span>&nbsp;<span class="op" id="3041512">&amp;&amp;</span>&nbsp;<span class="ident" id="3041515">f</span><span class="op" id="3041516">(</span><span class="op" id="3041517">&amp;</span><span class="ident" id="3041518">rr</span><span class="op" id="3041520">.</span><span class="ident" id="3041521">Txt</span><span class="op" id="3041524">,</span>&nbsp;<span class="string" id="3041526">&#34;Txt&#34;</span><span class="op" id="3041531">,</span>&nbsp;<span class="string" id="3041533">&#34;&#34;</span><span class="op" id="3041535">)</span><br>
<span class="lineno">310</span><span class="op" id="3041537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3041540">type</span>&nbsp;<span class="ident" id="3041545">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3041555">struct</span>&nbsp;<span class="op" id="3041562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041565">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041574">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041588">Priority</span>&nbsp;<span class="builtintype" id="3041597">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041605">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3041614">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041622">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3041631">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041639">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3041648">string</span>&nbsp;<span class="string" id="3041655">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3041675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3041678">func</span>&nbsp;<span class="op" id="3041683">(</span><span class="ident" id="3041684">rr</span>&nbsp;<span class="op" id="3041687">*</span><span class="ident" id="3041688">dnsRR_SRV</span><span class="op" id="3041697">)</span>&nbsp;<span class="ident" id="3041699">Header</span><span class="op" id="3041705">(</span><span class="op" id="3041706">)</span>&nbsp;<span class="op" id="3041708">*</span><span class="ident" id="3041709">dnsRR_Header</span>&nbsp;<span class="op" id="3041722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3041725">return</span>&nbsp;<span class="op" id="3041732">&amp;</span><span class="ident" id="3041733">rr</span><span class="op" id="3041735">.</span><span class="ident" id="3041736">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3041740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3041743">func</span>&nbsp;<span class="op" id="3041748">(</span><span class="ident" id="3041749">rr</span>&nbsp;<span class="op" id="3041752">*</span><span class="ident" id="3041753">dnsRR_SRV</span><span class="op" id="3041762">)</span>&nbsp;<span class="ident" id="3041764">Walk</span><span class="op" id="3041768">(</span><span class="ident" id="3041769">f</span>&nbsp;<span class="keyword" id="3041771">func</span><span class="op" id="3041775">(</span><span class="ident" id="3041776">v</span>&nbsp;<span class="keyword" id="3041778">interface</span><span class="op" id="3041787">{</span><span class="op" id="3041788">}</span><span class="op" id="3041789">,</span>&nbsp;<span class="ident" id="3041791">name</span><span class="op" id="3041795">,</span>&nbsp;<span class="ident" id="3041797">tag</span>&nbsp;<span class="builtintype" id="3041801">string</span><span class="op" id="3041807">)</span>&nbsp;<span class="builtintype" id="3041809">bool</span><span class="op" id="3041813">)</span>&nbsp;<span class="builtintype" id="3041815">bool</span>&nbsp;<span class="op" id="3041820">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3041823">return</span>&nbsp;<span class="ident" id="3041830">rr</span><span class="op" id="3041832">.</span><span class="ident" id="3041833">Hdr</span><span class="op" id="3041836">.</span><span class="ident" id="3041837">Walk</span><span class="op" id="3041841">(</span><span class="ident" id="3041842">f</span><span class="op" id="3041843">)</span>&nbsp;<span class="op" id="3041845">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041850">f</span><span class="op" id="3041851">(</span><span class="op" id="3041852">&amp;</span><span class="ident" id="3041853">rr</span><span class="op" id="3041855">.</span><span class="ident" id="3041856">Priority</span><span class="op" id="3041864">,</span>&nbsp;<span class="string" id="3041866">&#34;Priority&#34;</span><span class="op" id="3041876">,</span>&nbsp;<span class="string" id="3041878">&#34;&#34;</span><span class="op" id="3041880">)</span>&nbsp;<span class="op" id="3041882">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041887">f</span><span class="op" id="3041888">(</span><span class="op" id="3041889">&amp;</span><span class="ident" id="3041890">rr</span><span class="op" id="3041892">.</span><span class="ident" id="3041893">Weight</span><span class="op" id="3041899">,</span>&nbsp;<span class="string" id="3041901">&#34;Weight&#34;</span><span class="op" id="3041909">,</span>&nbsp;<span class="string" id="3041911">&#34;&#34;</span><span class="op" id="3041913">)</span>&nbsp;<span class="op" id="3041915">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041920">f</span><span class="op" id="3041921">(</span><span class="op" id="3041922">&amp;</span><span class="ident" id="3041923">rr</span><span class="op" id="3041925">.</span><span class="ident" id="3041926">Port</span><span class="op" id="3041930">,</span>&nbsp;<span class="string" id="3041932">&#34;Port&#34;</span><span class="op" id="3041938">,</span>&nbsp;<span class="string" id="3041940">&#34;&#34;</span><span class="op" id="3041942">)</span>&nbsp;<span class="op" id="3041944">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3041949">f</span><span class="op" id="3041950">(</span><span class="op" id="3041951">&amp;</span><span class="ident" id="3041952">rr</span><span class="op" id="3041954">.</span><span class="ident" id="3041955">Target</span><span class="op" id="3041961">,</span>&nbsp;<span class="string" id="3041963">&#34;Target&#34;</span><span class="op" id="3041971">,</span>&nbsp;<span class="string" id="3041973">&#34;domain&#34;</span><span class="op" id="3041981">)</span><br>
<span class="lineno">330</span><span class="op" id="3041983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3041986">type</span>&nbsp;<span class="ident" id="3041991">dnsRR_A</span>&nbsp;<span class="keyword" id="3041999">struct</span>&nbsp;<span class="op" id="3042006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3042009">Hdr</span>&nbsp;<span class="ident" id="3042013">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3042027">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3042031">uint32</span>&nbsp;<span class="string" id="3042038">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3042051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3042054">func</span>&nbsp;<span class="op" id="3042059">(</span><span class="ident" id="3042060">rr</span>&nbsp;<span class="op" id="3042063">*</span><span class="ident" id="3042064">dnsRR_A</span><span class="op" id="3042071">)</span>&nbsp;<span class="ident" id="3042073">Header</span><span class="op" id="3042079">(</span><span class="op" id="3042080">)</span>&nbsp;<span class="op" id="3042082">*</span><span class="ident" id="3042083">dnsRR_Header</span>&nbsp;<span class="op" id="3042096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3042099">return</span>&nbsp;<span class="op" id="3042106">&amp;</span><span class="ident" id="3042107">rr</span><span class="op" id="3042109">.</span><span class="ident" id="3042110">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3042114">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3042117">func</span>&nbsp;<span class="op" id="3042122">(</span><span class="ident" id="3042123">rr</span>&nbsp;<span class="op" id="3042126">*</span><span class="ident" id="3042127">dnsRR_A</span><span class="op" id="3042134">)</span>&nbsp;<span class="ident" id="3042136">Walk</span><span class="op" id="3042140">(</span><span class="ident" id="3042141">f</span>&nbsp;<span class="keyword" id="3042143">func</span><span class="op" id="3042147">(</span><span class="ident" id="3042148">v</span>&nbsp;<span class="keyword" id="3042150">interface</span><span class="op" id="3042159">{</span><span class="op" id="3042160">}</span><span class="op" id="3042161">,</span>&nbsp;<span class="ident" id="3042163">name</span><span class="op" id="3042167">,</span>&nbsp;<span class="ident" id="3042169">tag</span>&nbsp;<span class="builtintype" id="3042173">string</span><span class="op" id="3042179">)</span>&nbsp;<span class="builtintype" id="3042181">bool</span><span class="op" id="3042185">)</span>&nbsp;<span class="builtintype" id="3042187">bool</span>&nbsp;<span class="op" id="3042192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3042195">return</span>&nbsp;<span class="ident" id="3042202">rr</span><span class="op" id="3042204">.</span><span class="ident" id="3042205">Hdr</span><span class="op" id="3042208">.</span><span class="ident" id="3042209">Walk</span><span class="op" id="3042213">(</span><span class="ident" id="3042214">f</span><span class="op" id="3042215">)</span>&nbsp;<span class="op" id="3042217">&amp;&amp;</span>&nbsp;<span class="ident" id="3042220">f</span><span class="op" id="3042221">(</span><span class="op" id="3042222">&amp;</span><span class="ident" id="3042223">rr</span><span class="op" id="3042225">.</span><span class="ident" id="3042226">A</span><span class="op" id="3042227">,</span>&nbsp;<span class="string" id="3042229">&#34;A&#34;</span><span class="op" id="3042232">,</span>&nbsp;<span class="string" id="3042234">&#34;ipv4&#34;</span><span class="op" id="3042240">)</span><br>
<span class="lineno"></span><span class="op" id="3042242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3042245">type</span>&nbsp;<span class="ident" id="3042250">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3042261">struct</span>&nbsp;<span class="op" id="3042268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3042271">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3042276">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3042290">AAAA</span>&nbsp;<span class="op" id="3042295">[</span><span class="num" id="3042296">16</span><span class="op" id="3042298">]</span><span class="builtintype" id="3042299">byte</span>&nbsp;<span class="string" id="3042304">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3042317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3042320">func</span>&nbsp;<span class="op" id="3042325">(</span><span class="ident" id="3042326">rr</span>&nbsp;<span class="op" id="3042329">*</span><span class="ident" id="3042330">dnsRR_AAAA</span><span class="op" id="3042340">)</span>&nbsp;<span class="ident" id="3042342">Header</span><span class="op" id="3042348">(</span><span class="op" id="3042349">)</span>&nbsp;<span class="op" id="3042351">*</span><span class="ident" id="3042352">dnsRR_Header</span>&nbsp;<span class="op" id="3042365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3042368">return</span>&nbsp;<span class="op" id="3042375">&amp;</span><span class="ident" id="3042376">rr</span><span class="op" id="3042378">.</span><span class="ident" id="3042379">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3042383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3042386">func</span>&nbsp;<span class="op" id="3042391">(</span><span class="ident" id="3042392">rr</span>&nbsp;<span class="op" id="3042395">*</span><span class="ident" id="3042396">dnsRR_AAAA</span><span class="op" id="3042406">)</span>&nbsp;<span class="ident" id="3042408">Walk</span><span class="op" id="3042412">(</span><span class="ident" id="3042413">f</span>&nbsp;<span class="keyword" id="3042415">func</span><span class="op" id="3042419">(</span><span class="ident" id="3042420">v</span>&nbsp;<span class="keyword" id="3042422">interface</span><span class="op" id="3042431">{</span><span class="op" id="3042432">}</span><span class="op" id="3042433">,</span>&nbsp;<span class="ident" id="3042435">name</span><span class="op" id="3042439">,</span>&nbsp;<span class="ident" id="3042441">tag</span>&nbsp;<span class="builtintype" id="3042445">string</span><span class="op" id="3042451">)</span>&nbsp;<span class="builtintype" id="3042453">bool</span><span class="op" id="3042457">)</span>&nbsp;<span class="builtintype" id="3042459">bool</span>&nbsp;<span class="op" id="3042464">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3042467">return</span>&nbsp;<span class="ident" id="3042474">rr</span><span class="op" id="3042476">.</span><span class="ident" id="3042477">Hdr</span><span class="op" id="3042480">.</span><span class="ident" id="3042481">Walk</span><span class="op" id="3042485">(</span><span class="ident" id="3042486">f</span><span class="op" id="3042487">)</span>&nbsp;<span class="op" id="3042489">&amp;&amp;</span>&nbsp;<span class="ident" id="3042492">f</span><span class="op" id="3042493">(</span><span class="ident" id="3042494">rr</span><span class="op" id="3042496">.</span><span class="ident" id="3042497">AAAA</span><span class="op" id="3042501">[</span><span class="op" id="3042502">:</span><span class="op" id="3042503">]</span><span class="op" id="3042504">,</span>&nbsp;<span class="string" id="3042506">&#34;AAAA&#34;</span><span class="op" id="3042512">,</span>&nbsp;<span class="string" id="3042514">&#34;ipv6&#34;</span><span class="op" id="3042520">)</span><br>
<span class="lineno"></span><span class="op" id="3042522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3042525">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3042551">//</span><br>
<span class="lineno">360</span><span class="comment" id="3042554">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3042616">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3042683">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3042745">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3042811">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3042833">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3042879">var</span>&nbsp;<span class="ident" id="3042883">rr_mk</span>&nbsp;<span class="op" id="3042889">=</span>&nbsp;<span class="keyword" id="3042891">map</span><span class="op" id="3042894">[</span><span class="builtintype" id="3042895">int</span><span class="op" id="3042898">]</span><span class="keyword" id="3042899">func</span><span class="op" id="3042903">(</span><span class="op" id="3042904">)</span>&nbsp;<span class="ident" id="3042906">dnsRR</span><span class="op" id="3042911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3042914">dnsTypeCNAME</span><span class="op" id="3042926">:</span>&nbsp;<span class="keyword" id="3042928">func</span><span class="op" id="3042932">(</span><span class="op" id="3042933">)</span>&nbsp;<span class="ident" id="3042935">dnsRR</span>&nbsp;<span class="op" id="3042941">{</span>&nbsp;<span class="keyword" id="3042943">return</span>&nbsp;<span class="builtinfunc" id="3042950">new</span><span class="op" id="3042953">(</span><span class="ident" id="3042954">dnsRR_CNAME</span><span class="op" id="3042965">)</span>&nbsp;<span class="op" id="3042967">}</span><span class="op" id="3042968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3042971">dnsTypeHINFO</span><span class="op" id="3042983">:</span>&nbsp;<span class="keyword" id="3042985">func</span><span class="op" id="3042989">(</span><span class="op" id="3042990">)</span>&nbsp;<span class="ident" id="3042992">dnsRR</span>&nbsp;<span class="op" id="3042998">{</span>&nbsp;<span class="keyword" id="3043000">return</span>&nbsp;<span class="builtinfunc" id="3043007">new</span><span class="op" id="3043010">(</span><span class="ident" id="3043011">dnsRR_HINFO</span><span class="op" id="3043022">)</span>&nbsp;<span class="op" id="3043024">}</span><span class="op" id="3043025">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043028">dnsTypeMB</span><span class="op" id="3043037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043042">func</span><span class="op" id="3043046">(</span><span class="op" id="3043047">)</span>&nbsp;<span class="ident" id="3043049">dnsRR</span>&nbsp;<span class="op" id="3043055">{</span>&nbsp;<span class="keyword" id="3043057">return</span>&nbsp;<span class="builtinfunc" id="3043064">new</span><span class="op" id="3043067">(</span><span class="ident" id="3043068">dnsRR_MB</span><span class="op" id="3043076">)</span>&nbsp;<span class="op" id="3043078">}</span><span class="op" id="3043079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043082">dnsTypeMG</span><span class="op" id="3043091">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043096">func</span><span class="op" id="3043100">(</span><span class="op" id="3043101">)</span>&nbsp;<span class="ident" id="3043103">dnsRR</span>&nbsp;<span class="op" id="3043109">{</span>&nbsp;<span class="keyword" id="3043111">return</span>&nbsp;<span class="builtinfunc" id="3043118">new</span><span class="op" id="3043121">(</span><span class="ident" id="3043122">dnsRR_MG</span><span class="op" id="3043130">)</span>&nbsp;<span class="op" id="3043132">}</span><span class="op" id="3043133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043136">dnsTypeMINFO</span><span class="op" id="3043148">:</span>&nbsp;<span class="keyword" id="3043150">func</span><span class="op" id="3043154">(</span><span class="op" id="3043155">)</span>&nbsp;<span class="ident" id="3043157">dnsRR</span>&nbsp;<span class="op" id="3043163">{</span>&nbsp;<span class="keyword" id="3043165">return</span>&nbsp;<span class="builtinfunc" id="3043172">new</span><span class="op" id="3043175">(</span><span class="ident" id="3043176">dnsRR_MINFO</span><span class="op" id="3043187">)</span>&nbsp;<span class="op" id="3043189">}</span><span class="op" id="3043190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043193">dnsTypeMR</span><span class="op" id="3043202">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043207">func</span><span class="op" id="3043211">(</span><span class="op" id="3043212">)</span>&nbsp;<span class="ident" id="3043214">dnsRR</span>&nbsp;<span class="op" id="3043220">{</span>&nbsp;<span class="keyword" id="3043222">return</span>&nbsp;<span class="builtinfunc" id="3043229">new</span><span class="op" id="3043232">(</span><span class="ident" id="3043233">dnsRR_MR</span><span class="op" id="3043241">)</span>&nbsp;<span class="op" id="3043243">}</span><span class="op" id="3043244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043247">dnsTypeMX</span><span class="op" id="3043256">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043261">func</span><span class="op" id="3043265">(</span><span class="op" id="3043266">)</span>&nbsp;<span class="ident" id="3043268">dnsRR</span>&nbsp;<span class="op" id="3043274">{</span>&nbsp;<span class="keyword" id="3043276">return</span>&nbsp;<span class="builtinfunc" id="3043283">new</span><span class="op" id="3043286">(</span><span class="ident" id="3043287">dnsRR_MX</span><span class="op" id="3043295">)</span>&nbsp;<span class="op" id="3043297">}</span><span class="op" id="3043298">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043301">dnsTypeNS</span><span class="op" id="3043310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043315">func</span><span class="op" id="3043319">(</span><span class="op" id="3043320">)</span>&nbsp;<span class="ident" id="3043322">dnsRR</span>&nbsp;<span class="op" id="3043328">{</span>&nbsp;<span class="keyword" id="3043330">return</span>&nbsp;<span class="builtinfunc" id="3043337">new</span><span class="op" id="3043340">(</span><span class="ident" id="3043341">dnsRR_NS</span><span class="op" id="3043349">)</span>&nbsp;<span class="op" id="3043351">}</span><span class="op" id="3043352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043355">dnsTypePTR</span><span class="op" id="3043365">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043369">func</span><span class="op" id="3043373">(</span><span class="op" id="3043374">)</span>&nbsp;<span class="ident" id="3043376">dnsRR</span>&nbsp;<span class="op" id="3043382">{</span>&nbsp;<span class="keyword" id="3043384">return</span>&nbsp;<span class="builtinfunc" id="3043391">new</span><span class="op" id="3043394">(</span><span class="ident" id="3043395">dnsRR_PTR</span><span class="op" id="3043404">)</span>&nbsp;<span class="op" id="3043406">}</span><span class="op" id="3043407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043410">dnsTypeSOA</span><span class="op" id="3043420">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043424">func</span><span class="op" id="3043428">(</span><span class="op" id="3043429">)</span>&nbsp;<span class="ident" id="3043431">dnsRR</span>&nbsp;<span class="op" id="3043437">{</span>&nbsp;<span class="keyword" id="3043439">return</span>&nbsp;<span class="builtinfunc" id="3043446">new</span><span class="op" id="3043449">(</span><span class="ident" id="3043450">dnsRR_SOA</span><span class="op" id="3043459">)</span>&nbsp;<span class="op" id="3043461">}</span><span class="op" id="3043462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043465">dnsTypeTXT</span><span class="op" id="3043475">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043479">func</span><span class="op" id="3043483">(</span><span class="op" id="3043484">)</span>&nbsp;<span class="ident" id="3043486">dnsRR</span>&nbsp;<span class="op" id="3043492">{</span>&nbsp;<span class="keyword" id="3043494">return</span>&nbsp;<span class="builtinfunc" id="3043501">new</span><span class="op" id="3043504">(</span><span class="ident" id="3043505">dnsRR_TXT</span><span class="op" id="3043514">)</span>&nbsp;<span class="op" id="3043516">}</span><span class="op" id="3043517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043520">dnsTypeSRV</span><span class="op" id="3043530">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043534">func</span><span class="op" id="3043538">(</span><span class="op" id="3043539">)</span>&nbsp;<span class="ident" id="3043541">dnsRR</span>&nbsp;<span class="op" id="3043547">{</span>&nbsp;<span class="keyword" id="3043549">return</span>&nbsp;<span class="builtinfunc" id="3043556">new</span><span class="op" id="3043559">(</span><span class="ident" id="3043560">dnsRR_SRV</span><span class="op" id="3043569">)</span>&nbsp;<span class="op" id="3043571">}</span><span class="op" id="3043572">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043575">dnsTypeA</span><span class="op" id="3043583">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043589">func</span><span class="op" id="3043593">(</span><span class="op" id="3043594">)</span>&nbsp;<span class="ident" id="3043596">dnsRR</span>&nbsp;<span class="op" id="3043602">{</span>&nbsp;<span class="keyword" id="3043604">return</span>&nbsp;<span class="builtinfunc" id="3043611">new</span><span class="op" id="3043614">(</span><span class="ident" id="3043615">dnsRR_A</span><span class="op" id="3043622">)</span>&nbsp;<span class="op" id="3043624">}</span><span class="op" id="3043625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043628">dnsTypeAAAA</span><span class="op" id="3043639">:</span>&nbsp;&nbsp;<span class="keyword" id="3043642">func</span><span class="op" id="3043646">(</span><span class="op" id="3043647">)</span>&nbsp;<span class="ident" id="3043649">dnsRR</span>&nbsp;<span class="op" id="3043655">{</span>&nbsp;<span class="keyword" id="3043657">return</span>&nbsp;<span class="builtinfunc" id="3043664">new</span><span class="op" id="3043667">(</span><span class="ident" id="3043668">dnsRR_AAAA</span><span class="op" id="3043678">)</span>&nbsp;<span class="op" id="3043680">}</span><span class="op" id="3043681">,</span><br>
<span class="lineno"></span><span class="op" id="3043683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3043686">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3043726">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3043776">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3043835">func</span>&nbsp;<span class="ident" id="3043840">packDomainName</span><span class="op" id="3043854">(</span><span class="ident" id="3043855">s</span>&nbsp;<span class="builtintype" id="3043857">string</span><span class="op" id="3043863">,</span>&nbsp;<span class="ident" id="3043865">msg</span>&nbsp;<span class="op" id="3043869">[</span><span class="op" id="3043870">]</span><span class="builtintype" id="3043871">byte</span><span class="op" id="3043875">,</span>&nbsp;<span class="ident" id="3043877">off</span>&nbsp;<span class="builtintype" id="3043881">int</span><span class="op" id="3043884">)</span>&nbsp;<span class="op" id="3043886">(</span><span class="ident" id="3043887">off1</span>&nbsp;<span class="builtintype" id="3043892">int</span><span class="op" id="3043895">,</span>&nbsp;<span class="ident" id="3043897">ok</span>&nbsp;<span class="builtintype" id="3043900">bool</span><span class="op" id="3043904">)</span>&nbsp;<span class="op" id="3043906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3043909">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3043952">if</span>&nbsp;<span class="ident" id="3043955">n</span>&nbsp;<span class="op" id="3043957">:=</span>&nbsp;<span class="builtinfunc" id="3043960">len</span><span class="op" id="3043963">(</span><span class="ident" id="3043964">s</span><span class="op" id="3043965">)</span><span class="op" id="3043966">;</span>&nbsp;<span class="ident" id="3043968">n</span>&nbsp;<span class="op" id="3043970">==</span>&nbsp;<span class="num" id="3043973">0</span>&nbsp;<span class="op" id="3043975">||</span>&nbsp;<span class="ident" id="3043978">s</span><span class="op" id="3043979">[</span><span class="ident" id="3043980">n</span><span class="op" id="3043981">-</span><span class="num" id="3043982">1</span><span class="op" id="3043983">]</span>&nbsp;<span class="op" id="3043985">!=</span>&nbsp;<span class="string" id="3043988">&#39;.&#39;</span>&nbsp;<span class="op" id="3043992">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3043996">s</span>&nbsp;<span class="op" id="3043998">+=</span>&nbsp;<span class="string" id="3044001">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3044006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3044010">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3044051">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3044097">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3044132">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044178">tot</span>&nbsp;<span class="op" id="3044182">:=</span>&nbsp;<span class="builtinfunc" id="3044185">len</span><span class="op" id="3044188">(</span><span class="ident" id="3044189">s</span><span class="op" id="3044190">)</span>&nbsp;<span class="op" id="3044192">+</span>&nbsp;<span class="num" id="3044194">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044197">if</span>&nbsp;<span class="ident" id="3044200">off</span><span class="op" id="3044203">+</span><span class="ident" id="3044204">tot</span>&nbsp;<span class="op" id="3044208">&gt;</span>&nbsp;<span class="builtinfunc" id="3044210">len</span><span class="op" id="3044213">(</span><span class="ident" id="3044214">msg</span><span class="op" id="3044217">)</span>&nbsp;<span class="op" id="3044219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044223">return</span>&nbsp;<span class="builtinfunc" id="3044230">len</span><span class="op" id="3044233">(</span><span class="ident" id="3044234">msg</span><span class="op" id="3044237">)</span><span class="op" id="3044238">,</span>&nbsp;<span class="builtintype" id="3044240">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3044247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3044251">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044307">begin</span>&nbsp;<span class="op" id="3044313">:=</span>&nbsp;<span class="num" id="3044316">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044319">for</span>&nbsp;<span class="ident" id="3044323">i</span>&nbsp;<span class="op" id="3044325">:=</span>&nbsp;<span class="num" id="3044328">0</span><span class="op" id="3044329">;</span>&nbsp;<span class="ident" id="3044331">i</span>&nbsp;<span class="op" id="3044333">&lt;</span>&nbsp;<span class="builtinfunc" id="3044335">len</span><span class="op" id="3044338">(</span><span class="ident" id="3044339">s</span><span class="op" id="3044340">)</span><span class="op" id="3044341">;</span>&nbsp;<span class="ident" id="3044343">i</span><span class="op" id="3044344">++</span>&nbsp;<span class="op" id="3044347">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044351">if</span>&nbsp;<span class="ident" id="3044354">s</span><span class="op" id="3044355">[</span><span class="ident" id="3044356">i</span><span class="op" id="3044357">]</span>&nbsp;<span class="op" id="3044359">==</span>&nbsp;<span class="string" id="3044362">&#39;.&#39;</span>&nbsp;<span class="op" id="3044366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044371">if</span>&nbsp;<span class="ident" id="3044374">i</span><span class="op" id="3044375">-</span><span class="ident" id="3044376">begin</span>&nbsp;<span class="op" id="3044382">&gt;=</span>&nbsp;<span class="num" id="3044385">1</span><span class="op" id="3044386">&lt;&lt;</span><span class="num" id="3044388">6</span>&nbsp;<span class="op" id="3044390">{</span>&nbsp;<span class="comment" id="3044392">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044436">return</span>&nbsp;<span class="builtinfunc" id="3044443">len</span><span class="op" id="3044446">(</span><span class="ident" id="3044447">msg</span><span class="op" id="3044450">)</span><span class="op" id="3044451">,</span>&nbsp;<span class="builtintype" id="3044453">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3044462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044467">msg</span><span class="op" id="3044470">[</span><span class="ident" id="3044471">off</span><span class="op" id="3044474">]</span>&nbsp;<span class="op" id="3044476">=</span>&nbsp;<span class="builtintype" id="3044478">byte</span><span class="op" id="3044482">(</span><span class="ident" id="3044483">i</span>&nbsp;<span class="op" id="3044485">-</span>&nbsp;<span class="ident" id="3044487">begin</span><span class="op" id="3044492">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044497">off</span><span class="op" id="3044500">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044506">for</span>&nbsp;<span class="ident" id="3044510">j</span>&nbsp;<span class="op" id="3044512">:=</span>&nbsp;<span class="ident" id="3044515">begin</span><span class="op" id="3044520">;</span>&nbsp;<span class="ident" id="3044522">j</span>&nbsp;<span class="op" id="3044524">&lt;</span>&nbsp;<span class="ident" id="3044526">i</span><span class="op" id="3044527">;</span>&nbsp;<span class="ident" id="3044529">j</span><span class="op" id="3044530">++</span>&nbsp;<span class="op" id="3044533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044539">msg</span><span class="op" id="3044542">[</span><span class="ident" id="3044543">off</span><span class="op" id="3044546">]</span>&nbsp;<span class="op" id="3044548">=</span>&nbsp;<span class="ident" id="3044550">s</span><span class="op" id="3044551">[</span><span class="ident" id="3044552">j</span><span class="op" id="3044553">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044559">off</span><span class="op" id="3044562">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3044568">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044573">begin</span>&nbsp;<span class="op" id="3044579">=</span>&nbsp;<span class="ident" id="3044581">i</span>&nbsp;<span class="op" id="3044583">+</span>&nbsp;<span class="num" id="3044585">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3044589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3044592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044595">msg</span><span class="op" id="3044598">[</span><span class="ident" id="3044599">off</span><span class="op" id="3044602">]</span>&nbsp;<span class="op" id="3044604">=</span>&nbsp;<span class="num" id="3044606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3044609">off</span><span class="op" id="3044612">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3044616">return</span>&nbsp;<span class="ident" id="3044623">off</span><span class="op" id="3044626">,</span>&nbsp;<span class="builtintype" id="3044628">true</span><br>
<span class="lineno"></span><span class="op" id="3044633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3044636">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3044661">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3044726">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3044791">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3044852">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3044913">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3044976">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3045045">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3045083">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3045132">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3045198">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3045244">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3045306">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3045367">func</span>&nbsp;<span class="ident" id="3045372">unpackDomainName</span><span class="op" id="3045388">(</span><span class="ident" id="3045389">msg</span>&nbsp;<span class="op" id="3045393">[</span><span class="op" id="3045394">]</span><span class="builtintype" id="3045395">byte</span><span class="op" id="3045399">,</span>&nbsp;<span class="ident" id="3045401">off</span>&nbsp;<span class="builtintype" id="3045405">int</span><span class="op" id="3045408">)</span>&nbsp;<span class="op" id="3045410">(</span><span class="ident" id="3045411">s</span>&nbsp;<span class="builtintype" id="3045413">string</span><span class="op" id="3045419">,</span>&nbsp;<span class="ident" id="3045421">off1</span>&nbsp;<span class="builtintype" id="3045426">int</span><span class="op" id="3045429">,</span>&nbsp;<span class="ident" id="3045431">ok</span>&nbsp;<span class="builtintype" id="3045434">bool</span><span class="op" id="3045438">)</span>&nbsp;<span class="op" id="3045440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3045443">s</span>&nbsp;<span class="op" id="3045445">=</span>&nbsp;<span class="string" id="3045447">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3045451">ptr</span>&nbsp;<span class="op" id="3045455">:=</span>&nbsp;<span class="num" id="3045458">0</span>&nbsp;<span class="comment" id="3045460">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3045491">Loop</span><span class="op" id="3045495">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045498">for</span>&nbsp;<span class="op" id="3045502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045506">if</span>&nbsp;<span class="ident" id="3045509">off</span>&nbsp;<span class="op" id="3045513">&gt;=</span>&nbsp;<span class="builtinfunc" id="3045516">len</span><span class="op" id="3045519">(</span><span class="ident" id="3045520">msg</span><span class="op" id="3045523">)</span>&nbsp;<span class="op" id="3045525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045530">return</span>&nbsp;<span class="string" id="3045537">&#34;&#34;</span><span class="op" id="3045539">,</span>&nbsp;<span class="builtinfunc" id="3045541">len</span><span class="op" id="3045544">(</span><span class="ident" id="3045545">msg</span><span class="op" id="3045548">)</span><span class="op" id="3045549">,</span>&nbsp;<span class="builtintype" id="3045551">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3045559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3045563">c</span>&nbsp;<span class="op" id="3045565">:=</span>&nbsp;<span class="builtintype" id="3045568">int</span><span class="op" id="3045571">(</span><span class="ident" id="3045572">msg</span><span class="op" id="3045575">[</span><span class="ident" id="3045576">off</span><span class="op" id="3045579">]</span><span class="op" id="3045580">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3045584">off</span><span class="op" id="3045587">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045592">switch</span>&nbsp;<span class="ident" id="3045599">c</span>&nbsp;<span class="op" id="3045601">&amp;</span>&nbsp;<span class="num" id="3045603">0xC0</span>&nbsp;<span class="op" id="3045608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045612">case</span>&nbsp;<span class="num" id="3045617">0x00</span><span class="op" id="3045621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045626">if</span>&nbsp;<span class="ident" id="3045629">c</span>&nbsp;<span class="op" id="3045631">==</span>&nbsp;<span class="num" id="3045634">0x00</span>&nbsp;<span class="op" id="3045639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3045645">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045664">break</span>&nbsp;<span class="ident" id="3045670">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3045678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3045683">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045704">if</span>&nbsp;<span class="ident" id="3045707">off</span><span class="op" id="3045710">+</span><span class="ident" id="3045711">c</span>&nbsp;<span class="op" id="3045713">&gt;</span>&nbsp;<span class="builtinfunc" id="3045715">len</span><span class="op" id="3045718">(</span><span class="ident" id="3045719">msg</span><span class="op" id="3045722">)</span>&nbsp;<span class="op" id="3045724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045730">return</span>&nbsp;<span class="string" id="3045737">&#34;&#34;</span><span class="op" id="3045739">,</span>&nbsp;<span class="builtinfunc" id="3045741">len</span><span class="op" id="3045744">(</span><span class="ident" id="3045745">msg</span><span class="op" id="3045748">)</span><span class="op" id="3045749">,</span>&nbsp;<span class="builtintype" id="3045751">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3045760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3045765">s</span>&nbsp;<span class="op" id="3045767">+=</span>&nbsp;<span class="builtintype" id="3045770">string</span><span class="op" id="3045776">(</span><span class="ident" id="3045777">msg</span><span class="op" id="3045780">[</span><span class="ident" id="3045781">off</span><span class="op" id="3045784">:</span><span class="ident" id="3045785">off</span><span class="op" id="3045788">+</span><span class="ident" id="3045789">c</span><span class="op" id="3045790">]</span><span class="op" id="3045791">)</span>&nbsp;<span class="op" id="3045793">+</span>&nbsp;<span class="string" id="3045795">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3045802">off</span>&nbsp;<span class="op" id="3045806">+=</span>&nbsp;<span class="ident" id="3045809">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3045813">case</span>&nbsp;<span class="num" id="3045818">0xC0</span><span class="op" id="3045822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3045827">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3045867">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3045908">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3045955">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3046001">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046029">if</span>&nbsp;<span class="ident" id="3046032">off</span>&nbsp;<span class="op" id="3046036">&gt;=</span>&nbsp;<span class="builtinfunc" id="3046039">len</span><span class="op" id="3046042">(</span><span class="ident" id="3046043">msg</span><span class="op" id="3046046">)</span>&nbsp;<span class="op" id="3046048">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046054">return</span>&nbsp;<span class="string" id="3046061">&#34;&#34;</span><span class="op" id="3046063">,</span>&nbsp;<span class="builtinfunc" id="3046065">len</span><span class="op" id="3046068">(</span><span class="ident" id="3046069">msg</span><span class="op" id="3046072">)</span><span class="op" id="3046073">,</span>&nbsp;<span class="builtintype" id="3046075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046089">c1</span>&nbsp;<span class="op" id="3046092">:=</span>&nbsp;<span class="ident" id="3046095">msg</span><span class="op" id="3046098">[</span><span class="ident" id="3046099">off</span><span class="op" id="3046102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046107">off</span><span class="op" id="3046110">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046116">if</span>&nbsp;<span class="ident" id="3046119">ptr</span>&nbsp;<span class="op" id="3046123">==</span>&nbsp;<span class="num" id="3046126">0</span>&nbsp;<span class="op" id="3046128">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046134">off1</span>&nbsp;<span class="op" id="3046139">=</span>&nbsp;<span class="ident" id="3046141">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046153">if</span>&nbsp;<span class="ident" id="3046156">ptr</span><span class="op" id="3046159">++</span><span class="op" id="3046161">;</span>&nbsp;<span class="ident" id="3046163">ptr</span>&nbsp;<span class="op" id="3046167">&gt;</span>&nbsp;<span class="num" id="3046169">10</span>&nbsp;<span class="op" id="3046172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046178">return</span>&nbsp;<span class="string" id="3046185">&#34;&#34;</span><span class="op" id="3046187">,</span>&nbsp;<span class="builtinfunc" id="3046189">len</span><span class="op" id="3046192">(</span><span class="ident" id="3046193">msg</span><span class="op" id="3046196">)</span><span class="op" id="3046197">,</span>&nbsp;<span class="builtintype" id="3046199">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046208">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046213">off</span>&nbsp;<span class="op" id="3046217">=</span>&nbsp;<span class="op" id="3046219">(</span><span class="ident" id="3046220">c</span><span class="op" id="3046221">^</span><span class="num" id="3046222">0xC0</span><span class="op" id="3046226">)</span><span class="op" id="3046227">&lt;&lt;</span><span class="num" id="3046229">8</span>&nbsp;<span class="op" id="3046231">|</span>&nbsp;<span class="builtintype" id="3046233">int</span><span class="op" id="3046236">(</span><span class="ident" id="3046237">c1</span><span class="op" id="3046239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046243">default</span><span class="op" id="3046250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3046255">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046288">return</span>&nbsp;<span class="string" id="3046295">&#34;&#34;</span><span class="op" id="3046297">,</span>&nbsp;<span class="builtinfunc" id="3046299">len</span><span class="op" id="3046302">(</span><span class="ident" id="3046303">msg</span><span class="op" id="3046306">)</span><span class="op" id="3046307">,</span>&nbsp;<span class="builtintype" id="3046309">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046317">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046323">if</span>&nbsp;<span class="ident" id="3046326">ptr</span>&nbsp;<span class="op" id="3046330">==</span>&nbsp;<span class="num" id="3046333">0</span>&nbsp;<span class="op" id="3046335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046339">off1</span>&nbsp;<span class="op" id="3046344">=</span>&nbsp;<span class="ident" id="3046346">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046354">return</span>&nbsp;<span class="ident" id="3046361">s</span><span class="op" id="3046362">,</span>&nbsp;<span class="ident" id="3046364">off1</span><span class="op" id="3046368">,</span>&nbsp;<span class="builtintype" id="3046370">true</span><br>
<span class="lineno">485</span><span class="op" id="3046375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3046378">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3046448">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3046509">func</span>&nbsp;<span class="ident" id="3046514">packStruct</span><span class="op" id="3046524">(</span><span class="ident" id="3046525">any</span>&nbsp;<span class="ident" id="3046529">dnsStruct</span><span class="op" id="3046538">,</span>&nbsp;<span class="ident" id="3046540">msg</span>&nbsp;<span class="op" id="3046544">[</span><span class="op" id="3046545">]</span><span class="builtintype" id="3046546">byte</span><span class="op" id="3046550">,</span>&nbsp;<span class="ident" id="3046552">off</span>&nbsp;<span class="builtintype" id="3046556">int</span><span class="op" id="3046559">)</span>&nbsp;<span class="op" id="3046561">(</span><span class="ident" id="3046562">off1</span>&nbsp;<span class="builtintype" id="3046567">int</span><span class="op" id="3046570">,</span>&nbsp;<span class="ident" id="3046572">ok</span>&nbsp;<span class="builtintype" id="3046575">bool</span><span class="op" id="3046579">)</span>&nbsp;<span class="op" id="3046581">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046584">ok</span>&nbsp;<span class="op" id="3046587">=</span>&nbsp;<span class="ident" id="3046589">any</span><span class="op" id="3046592">.</span><span class="ident" id="3046593">Walk</span><span class="op" id="3046597">(</span><span class="keyword" id="3046598">func</span><span class="op" id="3046602">(</span><span class="ident" id="3046603">field</span>&nbsp;<span class="keyword" id="3046609">interface</span><span class="op" id="3046618">{</span><span class="op" id="3046619">}</span><span class="op" id="3046620">,</span>&nbsp;<span class="ident" id="3046622">name</span><span class="op" id="3046626">,</span>&nbsp;<span class="ident" id="3046628">tag</span>&nbsp;<span class="builtintype" id="3046632">string</span><span class="op" id="3046638">)</span>&nbsp;<span class="builtintype" id="3046640">bool</span>&nbsp;<span class="op" id="3046645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046649">switch</span>&nbsp;<span class="ident" id="3046656">fv</span>&nbsp;<span class="op" id="3046659">:=</span>&nbsp;<span class="ident" id="3046662">field</span><span class="op" id="3046667">.</span><span class="op" id="3046668">(</span><span class="keyword" id="3046669">type</span><span class="op" id="3046673">)</span>&nbsp;<span class="op" id="3046675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046679">default</span><span class="op" id="3046686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3046691">println</span><span class="op" id="3046698">(</span><span class="string" id="3046699">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3046731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046736">return</span>&nbsp;<span class="builtintype" id="3046743">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046751">case</span>&nbsp;<span class="op" id="3046756">*</span><span class="builtintype" id="3046757">uint16</span><span class="op" id="3046763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046768">i</span>&nbsp;<span class="op" id="3046770">:=</span>&nbsp;<span class="op" id="3046773">*</span><span class="ident" id="3046774">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046780">if</span>&nbsp;<span class="ident" id="3046783">off</span><span class="op" id="3046786">+</span><span class="num" id="3046787">2</span>&nbsp;<span class="op" id="3046789">&gt;</span>&nbsp;<span class="builtinfunc" id="3046791">len</span><span class="op" id="3046794">(</span><span class="ident" id="3046795">msg</span><span class="op" id="3046798">)</span>&nbsp;<span class="op" id="3046800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046806">return</span>&nbsp;<span class="builtintype" id="3046813">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3046822">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046827">msg</span><span class="op" id="3046830">[</span><span class="ident" id="3046831">off</span><span class="op" id="3046834">]</span>&nbsp;<span class="op" id="3046836">=</span>&nbsp;<span class="builtintype" id="3046838">byte</span><span class="op" id="3046842">(</span><span class="ident" id="3046843">i</span>&nbsp;<span class="op" id="3046845">&gt;&gt;</span>&nbsp;<span class="num" id="3046848">8</span><span class="op" id="3046849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046854">msg</span><span class="op" id="3046857">[</span><span class="ident" id="3046858">off</span><span class="op" id="3046861">+</span><span class="num" id="3046862">1</span><span class="op" id="3046863">]</span>&nbsp;<span class="op" id="3046865">=</span>&nbsp;<span class="builtintype" id="3046867">byte</span><span class="op" id="3046871">(</span><span class="ident" id="3046872">i</span><span class="op" id="3046873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046878">off</span>&nbsp;<span class="op" id="3046882">+=</span>&nbsp;<span class="num" id="3046885">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3046889">case</span>&nbsp;<span class="op" id="3046894">*</span><span class="builtintype" id="3046895">uint32</span><span class="op" id="3046901">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046906">i</span>&nbsp;<span class="op" id="3046908">:=</span>&nbsp;<span class="op" id="3046911">*</span><span class="ident" id="3046912">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046918">msg</span><span class="op" id="3046921">[</span><span class="ident" id="3046922">off</span><span class="op" id="3046925">]</span>&nbsp;<span class="op" id="3046927">=</span>&nbsp;<span class="builtintype" id="3046929">byte</span><span class="op" id="3046933">(</span><span class="ident" id="3046934">i</span>&nbsp;<span class="op" id="3046936">&gt;&gt;</span>&nbsp;<span class="num" id="3046939">24</span><span class="op" id="3046941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046946">msg</span><span class="op" id="3046949">[</span><span class="ident" id="3046950">off</span><span class="op" id="3046953">+</span><span class="num" id="3046954">1</span><span class="op" id="3046955">]</span>&nbsp;<span class="op" id="3046957">=</span>&nbsp;<span class="builtintype" id="3046959">byte</span><span class="op" id="3046963">(</span><span class="ident" id="3046964">i</span>&nbsp;<span class="op" id="3046966">&gt;&gt;</span>&nbsp;<span class="num" id="3046969">16</span><span class="op" id="3046971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3046976">msg</span><span class="op" id="3046979">[</span><span class="ident" id="3046980">off</span><span class="op" id="3046983">+</span><span class="num" id="3046984">2</span><span class="op" id="3046985">]</span>&nbsp;<span class="op" id="3046987">=</span>&nbsp;<span class="builtintype" id="3046989">byte</span><span class="op" id="3046993">(</span><span class="ident" id="3046994">i</span>&nbsp;<span class="op" id="3046996">&gt;&gt;</span>&nbsp;<span class="num" id="3046999">8</span><span class="op" id="3047000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047005">msg</span><span class="op" id="3047008">[</span><span class="ident" id="3047009">off</span><span class="op" id="3047012">+</span><span class="num" id="3047013">3</span><span class="op" id="3047014">]</span>&nbsp;<span class="op" id="3047016">=</span>&nbsp;<span class="builtintype" id="3047018">byte</span><span class="op" id="3047022">(</span><span class="ident" id="3047023">i</span><span class="op" id="3047024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047029">off</span>&nbsp;<span class="op" id="3047033">+=</span>&nbsp;<span class="num" id="3047036">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047040">case</span>&nbsp;<span class="op" id="3047045">[</span><span class="op" id="3047046">]</span><span class="builtintype" id="3047047">byte</span><span class="op" id="3047051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047056">n</span>&nbsp;<span class="op" id="3047058">:=</span>&nbsp;<span class="builtinfunc" id="3047061">len</span><span class="op" id="3047064">(</span><span class="ident" id="3047065">fv</span><span class="op" id="3047067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047072">if</span>&nbsp;<span class="ident" id="3047075">off</span><span class="op" id="3047078">+</span><span class="ident" id="3047079">n</span>&nbsp;<span class="op" id="3047081">&gt;</span>&nbsp;<span class="builtinfunc" id="3047083">len</span><span class="op" id="3047086">(</span><span class="ident" id="3047087">msg</span><span class="op" id="3047090">)</span>&nbsp;<span class="op" id="3047092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047098">return</span>&nbsp;<span class="builtintype" id="3047105">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047114">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3047119">copy</span><span class="op" id="3047123">(</span><span class="ident" id="3047124">msg</span><span class="op" id="3047127">[</span><span class="ident" id="3047128">off</span><span class="op" id="3047131">:</span><span class="ident" id="3047132">off</span><span class="op" id="3047135">+</span><span class="ident" id="3047136">n</span><span class="op" id="3047137">]</span><span class="op" id="3047138">,</span>&nbsp;<span class="ident" id="3047140">fv</span><span class="op" id="3047142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047147">off</span>&nbsp;<span class="op" id="3047151">+=</span>&nbsp;<span class="ident" id="3047154">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047158">case</span>&nbsp;<span class="op" id="3047163">*</span><span class="builtintype" id="3047164">string</span><span class="op" id="3047170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047175">s</span>&nbsp;<span class="op" id="3047177">:=</span>&nbsp;<span class="op" id="3047180">*</span><span class="ident" id="3047181">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047187">switch</span>&nbsp;<span class="ident" id="3047194">tag</span>&nbsp;<span class="op" id="3047198">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047203">default</span><span class="op" id="3047210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3047216">println</span><span class="op" id="3047223">(</span><span class="string" id="3047224">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3047254">,</span>&nbsp;<span class="ident" id="3047256">tag</span><span class="op" id="3047259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047265">return</span>&nbsp;<span class="builtintype" id="3047272">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047281">case</span>&nbsp;<span class="string" id="3047286">&#34;domain&#34;</span><span class="op" id="3047294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047300">off</span><span class="op" id="3047303">,</span>&nbsp;<span class="ident" id="3047305">ok</span>&nbsp;<span class="op" id="3047308">=</span>&nbsp;<span class="ident" id="3047310">packDomainName</span><span class="op" id="3047324">(</span><span class="ident" id="3047325">s</span><span class="op" id="3047326">,</span>&nbsp;<span class="ident" id="3047328">msg</span><span class="op" id="3047331">,</span>&nbsp;<span class="ident" id="3047333">off</span><span class="op" id="3047336">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047342">if</span>&nbsp;<span class="op" id="3047345">!</span><span class="ident" id="3047346">ok</span>&nbsp;<span class="op" id="3047349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047356">return</span>&nbsp;<span class="builtintype" id="3047363">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047378">case</span>&nbsp;<span class="string" id="3047383">&#34;&#34;</span><span class="op" id="3047385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3047391">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047429">if</span>&nbsp;<span class="builtinfunc" id="3047432">len</span><span class="op" id="3047435">(</span><span class="ident" id="3047436">s</span><span class="op" id="3047437">)</span>&nbsp;<span class="op" id="3047439">&gt;</span>&nbsp;<span class="num" id="3047441">255</span>&nbsp;<span class="op" id="3047445">||</span>&nbsp;<span class="ident" id="3047448">off</span><span class="op" id="3047451">+</span><span class="num" id="3047452">1</span><span class="op" id="3047453">+</span><span class="builtinfunc" id="3047454">len</span><span class="op" id="3047457">(</span><span class="ident" id="3047458">s</span><span class="op" id="3047459">)</span>&nbsp;<span class="op" id="3047461">&gt;</span>&nbsp;<span class="builtinfunc" id="3047463">len</span><span class="op" id="3047466">(</span><span class="ident" id="3047467">msg</span><span class="op" id="3047470">)</span>&nbsp;<span class="op" id="3047472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047479">return</span>&nbsp;<span class="builtintype" id="3047486">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047502">msg</span><span class="op" id="3047505">[</span><span class="ident" id="3047506">off</span><span class="op" id="3047509">]</span>&nbsp;<span class="op" id="3047511">=</span>&nbsp;<span class="builtintype" id="3047513">byte</span><span class="op" id="3047517">(</span><span class="builtinfunc" id="3047518">len</span><span class="op" id="3047521">(</span><span class="ident" id="3047522">s</span><span class="op" id="3047523">)</span><span class="op" id="3047524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047530">off</span><span class="op" id="3047533">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047540">off</span>&nbsp;<span class="op" id="3047544">+=</span>&nbsp;<span class="builtinfunc" id="3047547">copy</span><span class="op" id="3047551">(</span><span class="ident" id="3047552">msg</span><span class="op" id="3047555">[</span><span class="ident" id="3047556">off</span><span class="op" id="3047559">:</span><span class="op" id="3047560">]</span><span class="op" id="3047561">,</span>&nbsp;<span class="ident" id="3047563">s</span><span class="op" id="3047564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047577">return</span>&nbsp;<span class="builtintype" id="3047584">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047590">}</span><span class="op" id="3047591">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047594">if</span>&nbsp;<span class="op" id="3047597">!</span><span class="ident" id="3047598">ok</span>&nbsp;<span class="op" id="3047601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047605">return</span>&nbsp;<span class="builtinfunc" id="3047612">len</span><span class="op" id="3047615">(</span><span class="ident" id="3047616">msg</span><span class="op" id="3047619">)</span><span class="op" id="3047620">,</span>&nbsp;<span class="builtintype" id="3047622">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3047629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047632">return</span>&nbsp;<span class="ident" id="3047639">off</span><span class="op" id="3047642">,</span>&nbsp;<span class="builtintype" id="3047644">true</span><br>
<span class="lineno"></span><span class="op" id="3047649">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3047652">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:]into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3047717">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3047778">func</span>&nbsp;<span class="ident" id="3047783">unpackStruct</span><span class="op" id="3047795">(</span><span class="ident" id="3047796">any</span>&nbsp;<span class="ident" id="3047800">dnsStruct</span><span class="op" id="3047809">,</span>&nbsp;<span class="ident" id="3047811">msg</span>&nbsp;<span class="op" id="3047815">[</span><span class="op" id="3047816">]</span><span class="builtintype" id="3047817">byte</span><span class="op" id="3047821">,</span>&nbsp;<span class="ident" id="3047823">off</span>&nbsp;<span class="builtintype" id="3047827">int</span><span class="op" id="3047830">)</span>&nbsp;<span class="op" id="3047832">(</span><span class="ident" id="3047833">off1</span>&nbsp;<span class="builtintype" id="3047838">int</span><span class="op" id="3047841">,</span>&nbsp;<span class="ident" id="3047843">ok</span>&nbsp;<span class="builtintype" id="3047846">bool</span><span class="op" id="3047850">)</span>&nbsp;<span class="op" id="3047852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3047855">ok</span>&nbsp;<span class="op" id="3047858">=</span>&nbsp;<span class="ident" id="3047860">any</span><span class="op" id="3047863">.</span><span class="ident" id="3047864">Walk</span><span class="op" id="3047868">(</span><span class="keyword" id="3047869">func</span><span class="op" id="3047873">(</span><span class="ident" id="3047874">field</span>&nbsp;<span class="keyword" id="3047880">interface</span><span class="op" id="3047889">{</span><span class="op" id="3047890">}</span><span class="op" id="3047891">,</span>&nbsp;<span class="ident" id="3047893">name</span><span class="op" id="3047897">,</span>&nbsp;<span class="ident" id="3047899">tag</span>&nbsp;<span class="builtintype" id="3047903">string</span><span class="op" id="3047909">)</span>&nbsp;<span class="builtintype" id="3047911">bool</span>&nbsp;<span class="op" id="3047916">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047920">switch</span>&nbsp;<span class="ident" id="3047927">fv</span>&nbsp;<span class="op" id="3047930">:=</span>&nbsp;<span class="ident" id="3047933">field</span><span class="op" id="3047938">.</span><span class="op" id="3047939">(</span><span class="keyword" id="3047940">type</span><span class="op" id="3047944">)</span>&nbsp;<span class="op" id="3047946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3047950">default</span><span class="op" id="3047957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3047962">println</span><span class="op" id="3047969">(</span><span class="string" id="3047970">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3048002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048007">return</span>&nbsp;<span class="builtintype" id="3048014">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048022">case</span>&nbsp;<span class="op" id="3048027">*</span><span class="builtintype" id="3048028">uint16</span><span class="op" id="3048034">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048039">if</span>&nbsp;<span class="ident" id="3048042">off</span><span class="op" id="3048045">+</span><span class="num" id="3048046">2</span>&nbsp;<span class="op" id="3048048">&gt;</span>&nbsp;<span class="builtinfunc" id="3048050">len</span><span class="op" id="3048053">(</span><span class="ident" id="3048054">msg</span><span class="op" id="3048057">)</span>&nbsp;<span class="op" id="3048059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048065">return</span>&nbsp;<span class="builtintype" id="3048072">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048086">*</span><span class="ident" id="3048087">fv</span>&nbsp;<span class="op" id="3048090">=</span>&nbsp;<span class="builtintype" id="3048092">uint16</span><span class="op" id="3048098">(</span><span class="ident" id="3048099">msg</span><span class="op" id="3048102">[</span><span class="ident" id="3048103">off</span><span class="op" id="3048106">]</span><span class="op" id="3048107">)</span><span class="op" id="3048108">&lt;&lt;</span><span class="num" id="3048110">8</span>&nbsp;<span class="op" id="3048112">|</span>&nbsp;<span class="builtintype" id="3048114">uint16</span><span class="op" id="3048120">(</span><span class="ident" id="3048121">msg</span><span class="op" id="3048124">[</span><span class="ident" id="3048125">off</span><span class="op" id="3048128">+</span><span class="num" id="3048129">1</span><span class="op" id="3048130">]</span><span class="op" id="3048131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048136">off</span>&nbsp;<span class="op" id="3048140">+=</span>&nbsp;<span class="num" id="3048143">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048147">case</span>&nbsp;<span class="op" id="3048152">*</span><span class="builtintype" id="3048153">uint32</span><span class="op" id="3048159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048164">if</span>&nbsp;<span class="ident" id="3048167">off</span><span class="op" id="3048170">+</span><span class="num" id="3048171">4</span>&nbsp;<span class="op" id="3048173">&gt;</span>&nbsp;<span class="builtinfunc" id="3048175">len</span><span class="op" id="3048178">(</span><span class="ident" id="3048179">msg</span><span class="op" id="3048182">)</span>&nbsp;<span class="op" id="3048184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048190">return</span>&nbsp;<span class="builtintype" id="3048197">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048211">*</span><span class="ident" id="3048212">fv</span>&nbsp;<span class="op" id="3048215">=</span>&nbsp;<span class="builtintype" id="3048217">uint32</span><span class="op" id="3048223">(</span><span class="ident" id="3048224">msg</span><span class="op" id="3048227">[</span><span class="ident" id="3048228">off</span><span class="op" id="3048231">]</span><span class="op" id="3048232">)</span><span class="op" id="3048233">&lt;&lt;</span><span class="num" id="3048235">24</span>&nbsp;<span class="op" id="3048238">|</span>&nbsp;<span class="builtintype" id="3048240">uint32</span><span class="op" id="3048246">(</span><span class="ident" id="3048247">msg</span><span class="op" id="3048250">[</span><span class="ident" id="3048251">off</span><span class="op" id="3048254">+</span><span class="num" id="3048255">1</span><span class="op" id="3048256">]</span><span class="op" id="3048257">)</span><span class="op" id="3048258">&lt;&lt;</span><span class="num" id="3048260">16</span>&nbsp;<span class="op" id="3048263">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3048269">uint32</span><span class="op" id="3048275">(</span><span class="ident" id="3048276">msg</span><span class="op" id="3048279">[</span><span class="ident" id="3048280">off</span><span class="op" id="3048283">+</span><span class="num" id="3048284">2</span><span class="op" id="3048285">]</span><span class="op" id="3048286">)</span><span class="op" id="3048287">&lt;&lt;</span><span class="num" id="3048289">8</span>&nbsp;<span class="op" id="3048291">|</span>&nbsp;<span class="builtintype" id="3048293">uint32</span><span class="op" id="3048299">(</span><span class="ident" id="3048300">msg</span><span class="op" id="3048303">[</span><span class="ident" id="3048304">off</span><span class="op" id="3048307">+</span><span class="num" id="3048308">3</span><span class="op" id="3048309">]</span><span class="op" id="3048310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048315">off</span>&nbsp;<span class="op" id="3048319">+=</span>&nbsp;<span class="num" id="3048322">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048326">case</span>&nbsp;<span class="op" id="3048331">[</span><span class="op" id="3048332">]</span><span class="builtintype" id="3048333">byte</span><span class="op" id="3048337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048342">n</span>&nbsp;<span class="op" id="3048344">:=</span>&nbsp;<span class="builtinfunc" id="3048347">len</span><span class="op" id="3048350">(</span><span class="ident" id="3048351">fv</span><span class="op" id="3048353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048358">if</span>&nbsp;<span class="ident" id="3048361">off</span><span class="op" id="3048364">+</span><span class="ident" id="3048365">n</span>&nbsp;<span class="op" id="3048367">&gt;</span>&nbsp;<span class="builtinfunc" id="3048369">len</span><span class="op" id="3048372">(</span><span class="ident" id="3048373">msg</span><span class="op" id="3048376">)</span>&nbsp;<span class="op" id="3048378">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048384">return</span>&nbsp;<span class="builtintype" id="3048391">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3048405">copy</span><span class="op" id="3048409">(</span><span class="ident" id="3048410">fv</span><span class="op" id="3048412">,</span>&nbsp;<span class="ident" id="3048414">msg</span><span class="op" id="3048417">[</span><span class="ident" id="3048418">off</span><span class="op" id="3048421">:</span><span class="ident" id="3048422">off</span><span class="op" id="3048425">+</span><span class="ident" id="3048426">n</span><span class="op" id="3048427">]</span><span class="op" id="3048428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048433">off</span>&nbsp;<span class="op" id="3048437">+=</span>&nbsp;<span class="ident" id="3048440">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048444">case</span>&nbsp;<span class="op" id="3048449">*</span><span class="builtintype" id="3048450">string</span><span class="op" id="3048456">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048461">var</span>&nbsp;<span class="ident" id="3048465">s</span>&nbsp;<span class="builtintype" id="3048467">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048477">switch</span>&nbsp;<span class="ident" id="3048484">tag</span>&nbsp;<span class="op" id="3048488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048493">default</span><span class="op" id="3048500">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3048506">println</span><span class="op" id="3048513">(</span><span class="string" id="3048514">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3048544">,</span>&nbsp;<span class="ident" id="3048546">tag</span><span class="op" id="3048549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048555">return</span>&nbsp;<span class="builtintype" id="3048562">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048571">case</span>&nbsp;<span class="string" id="3048576">&#34;domain&#34;</span><span class="op" id="3048584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048590">s</span><span class="op" id="3048591">,</span>&nbsp;<span class="ident" id="3048593">off</span><span class="op" id="3048596">,</span>&nbsp;<span class="ident" id="3048598">ok</span>&nbsp;<span class="op" id="3048601">=</span>&nbsp;<span class="ident" id="3048603">unpackDomainName</span><span class="op" id="3048619">(</span><span class="ident" id="3048620">msg</span><span class="op" id="3048623">,</span>&nbsp;<span class="ident" id="3048625">off</span><span class="op" id="3048628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048634">if</span>&nbsp;<span class="op" id="3048637">!</span><span class="ident" id="3048638">ok</span>&nbsp;<span class="op" id="3048641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048648">return</span>&nbsp;<span class="builtintype" id="3048655">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048665">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048670">case</span>&nbsp;<span class="string" id="3048675">&#34;&#34;</span><span class="op" id="3048677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048683">if</span>&nbsp;<span class="ident" id="3048686">off</span>&nbsp;<span class="op" id="3048690">&gt;=</span>&nbsp;<span class="builtinfunc" id="3048693">len</span><span class="op" id="3048696">(</span><span class="ident" id="3048697">msg</span><span class="op" id="3048700">)</span>&nbsp;<span class="op" id="3048702">||</span>&nbsp;<span class="ident" id="3048705">off</span><span class="op" id="3048708">+</span><span class="num" id="3048709">1</span><span class="op" id="3048710">+</span><span class="builtintype" id="3048711">int</span><span class="op" id="3048714">(</span><span class="ident" id="3048715">msg</span><span class="op" id="3048718">[</span><span class="ident" id="3048719">off</span><span class="op" id="3048722">]</span><span class="op" id="3048723">)</span>&nbsp;<span class="op" id="3048725">&gt;</span>&nbsp;<span class="builtinfunc" id="3048727">len</span><span class="op" id="3048730">(</span><span class="ident" id="3048731">msg</span><span class="op" id="3048734">)</span>&nbsp;<span class="op" id="3048736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048743">return</span>&nbsp;<span class="builtintype" id="3048750">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048766">n</span>&nbsp;<span class="op" id="3048768">:=</span>&nbsp;<span class="builtintype" id="3048771">int</span><span class="op" id="3048774">(</span><span class="ident" id="3048775">msg</span><span class="op" id="3048778">[</span><span class="ident" id="3048779">off</span><span class="op" id="3048782">]</span><span class="op" id="3048783">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048789">off</span><span class="op" id="3048792">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048799">b</span>&nbsp;<span class="op" id="3048801">:=</span>&nbsp;<span class="builtinfunc" id="3048804">make</span><span class="op" id="3048808">(</span><span class="op" id="3048809">[</span><span class="op" id="3048810">]</span><span class="builtintype" id="3048811">byte</span><span class="op" id="3048815">,</span>&nbsp;<span class="ident" id="3048817">n</span><span class="op" id="3048818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048824">for</span>&nbsp;<span class="ident" id="3048828">i</span>&nbsp;<span class="op" id="3048830">:=</span>&nbsp;<span class="num" id="3048833">0</span><span class="op" id="3048834">;</span>&nbsp;<span class="ident" id="3048836">i</span>&nbsp;<span class="op" id="3048838">&lt;</span>&nbsp;<span class="ident" id="3048840">n</span><span class="op" id="3048841">;</span>&nbsp;<span class="ident" id="3048843">i</span><span class="op" id="3048844">++</span>&nbsp;<span class="op" id="3048847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048854">b</span><span class="op" id="3048855">[</span><span class="ident" id="3048856">i</span><span class="op" id="3048857">]</span>&nbsp;<span class="op" id="3048859">=</span>&nbsp;<span class="ident" id="3048861">msg</span><span class="op" id="3048864">[</span><span class="ident" id="3048865">off</span><span class="op" id="3048868">+</span><span class="ident" id="3048869">i</span><span class="op" id="3048870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048876">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048882">off</span>&nbsp;<span class="op" id="3048886">+=</span>&nbsp;<span class="ident" id="3048889">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3048895">s</span>&nbsp;<span class="op" id="3048897">=</span>&nbsp;<span class="builtintype" id="3048899">string</span><span class="op" id="3048905">(</span><span class="ident" id="3048906">b</span><span class="op" id="3048907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048917">*</span><span class="ident" id="3048918">fv</span>&nbsp;<span class="op" id="3048921">=</span>&nbsp;<span class="ident" id="3048923">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048927">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048931">return</span>&nbsp;<span class="builtintype" id="3048938">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048944">}</span><span class="op" id="3048945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048948">if</span>&nbsp;<span class="op" id="3048951">!</span><span class="ident" id="3048952">ok</span>&nbsp;<span class="op" id="3048955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048959">return</span>&nbsp;<span class="builtinfunc" id="3048966">len</span><span class="op" id="3048969">(</span><span class="ident" id="3048970">msg</span><span class="op" id="3048973">)</span><span class="op" id="3048974">,</span>&nbsp;<span class="builtintype" id="3048976">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3048983">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3048986">return</span>&nbsp;<span class="ident" id="3048993">off</span><span class="op" id="3048996">,</span>&nbsp;<span class="builtintype" id="3048998">true</span><br>
<span class="lineno"></span><span class="op" id="3049003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3049006">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3049073">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3049093">func</span>&nbsp;<span class="ident" id="3049098">printStruct</span><span class="op" id="3049109">(</span><span class="ident" id="3049110">any</span>&nbsp;<span class="ident" id="3049114">dnsStruct</span><span class="op" id="3049123">)</span>&nbsp;<span class="builtintype" id="3049125">string</span>&nbsp;<span class="op" id="3049132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049135">s</span>&nbsp;<span class="op" id="3049137">:=</span>&nbsp;<span class="string" id="3049140">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049145">i</span>&nbsp;<span class="op" id="3049147">:=</span>&nbsp;<span class="num" id="3049150">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049153">any</span><span class="op" id="3049156">.</span><span class="ident" id="3049157">Walk</span><span class="op" id="3049161">(</span><span class="keyword" id="3049162">func</span><span class="op" id="3049166">(</span><span class="ident" id="3049167">val</span>&nbsp;<span class="keyword" id="3049171">interface</span><span class="op" id="3049180">{</span><span class="op" id="3049181">}</span><span class="op" id="3049182">,</span>&nbsp;<span class="ident" id="3049184">name</span><span class="op" id="3049188">,</span>&nbsp;<span class="ident" id="3049190">tag</span>&nbsp;<span class="builtintype" id="3049194">string</span><span class="op" id="3049200">)</span>&nbsp;<span class="builtintype" id="3049202">bool</span>&nbsp;<span class="op" id="3049207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049211">i</span><span class="op" id="3049212">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049217">if</span>&nbsp;<span class="ident" id="3049220">i</span>&nbsp;<span class="op" id="3049222">&gt;</span>&nbsp;<span class="num" id="3049224">1</span>&nbsp;<span class="op" id="3049226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049231">s</span>&nbsp;<span class="op" id="3049233">+=</span>&nbsp;<span class="string" id="3049236">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3049243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049247">s</span>&nbsp;<span class="op" id="3049249">+=</span>&nbsp;<span class="ident" id="3049252">name</span>&nbsp;<span class="op" id="3049257">+</span>&nbsp;<span class="string" id="3049259">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049265">switch</span>&nbsp;<span class="ident" id="3049272">tag</span>&nbsp;<span class="op" id="3049276">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049280">case</span>&nbsp;<span class="string" id="3049285">&#34;ipv4&#34;</span><span class="op" id="3049291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049296">i</span>&nbsp;<span class="op" id="3049298">:=</span>&nbsp;<span class="op" id="3049301">*</span><span class="ident" id="3049302">val</span><span class="op" id="3049305">.</span><span class="op" id="3049306">(</span><span class="op" id="3049307">*</span><span class="builtintype" id="3049308">uint32</span><span class="op" id="3049314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049319">s</span>&nbsp;<span class="op" id="3049321">+=</span>&nbsp;<span class="ident" id="3049324">IPv4</span><span class="op" id="3049328">(</span><span class="builtintype" id="3049329">byte</span><span class="op" id="3049333">(</span><span class="ident" id="3049334">i</span><span class="op" id="3049335">&gt;&gt;</span><span class="num" id="3049337">24</span><span class="op" id="3049339">)</span><span class="op" id="3049340">,</span>&nbsp;<span class="builtintype" id="3049342">byte</span><span class="op" id="3049346">(</span><span class="ident" id="3049347">i</span><span class="op" id="3049348">&gt;&gt;</span><span class="num" id="3049350">16</span><span class="op" id="3049352">)</span><span class="op" id="3049353">,</span>&nbsp;<span class="builtintype" id="3049355">byte</span><span class="op" id="3049359">(</span><span class="ident" id="3049360">i</span><span class="op" id="3049361">&gt;&gt;</span><span class="num" id="3049363">8</span><span class="op" id="3049364">)</span><span class="op" id="3049365">,</span>&nbsp;<span class="builtintype" id="3049367">byte</span><span class="op" id="3049371">(</span><span class="ident" id="3049372">i</span><span class="op" id="3049373">)</span><span class="op" id="3049374">)</span><span class="op" id="3049375">.</span><span class="ident" id="3049376">String</span><span class="op" id="3049382">(</span><span class="op" id="3049383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049387">case</span>&nbsp;<span class="string" id="3049392">&#34;ipv6&#34;</span><span class="op" id="3049398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049403">i</span>&nbsp;<span class="op" id="3049405">:=</span>&nbsp;<span class="ident" id="3049408">val</span><span class="op" id="3049411">.</span><span class="op" id="3049412">(</span><span class="op" id="3049413">[</span><span class="op" id="3049414">]</span><span class="builtintype" id="3049415">byte</span><span class="op" id="3049419">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049424">s</span>&nbsp;<span class="op" id="3049426">+=</span>&nbsp;<span class="ident" id="3049429">IP</span><span class="op" id="3049431">(</span><span class="ident" id="3049432">i</span><span class="op" id="3049433">)</span><span class="op" id="3049434">.</span><span class="ident" id="3049435">String</span><span class="op" id="3049441">(</span><span class="op" id="3049442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049446">default</span><span class="op" id="3049453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049458">var</span>&nbsp;<span class="ident" id="3049462">i</span>&nbsp;<span class="ident" id="3049464">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049473">switch</span>&nbsp;<span class="ident" id="3049480">v</span>&nbsp;<span class="op" id="3049482">:=</span>&nbsp;<span class="ident" id="3049485">val</span><span class="op" id="3049488">.</span><span class="op" id="3049489">(</span><span class="keyword" id="3049490">type</span><span class="op" id="3049494">)</span>&nbsp;<span class="op" id="3049496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049501">default</span><span class="op" id="3049508">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3049514">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049542">s</span>&nbsp;<span class="op" id="3049544">+=</span>&nbsp;<span class="string" id="3049547">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049568">return</span>&nbsp;<span class="builtintype" id="3049575">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049583">case</span>&nbsp;<span class="op" id="3049588">*</span><span class="builtintype" id="3049589">string</span><span class="op" id="3049595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049601">s</span>&nbsp;<span class="op" id="3049603">+=</span>&nbsp;<span class="op" id="3049606">*</span><span class="ident" id="3049607">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049613">return</span>&nbsp;<span class="builtintype" id="3049620">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049628">case</span>&nbsp;<span class="op" id="3049633">[</span><span class="op" id="3049634">]</span><span class="builtintype" id="3049635">byte</span><span class="op" id="3049639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049645">s</span>&nbsp;<span class="op" id="3049647">+=</span>&nbsp;<span class="builtintype" id="3049650">string</span><span class="op" id="3049656">(</span><span class="ident" id="3049657">v</span><span class="op" id="3049658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049664">return</span>&nbsp;<span class="builtintype" id="3049671">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049679">case</span>&nbsp;<span class="op" id="3049684">*</span><span class="builtintype" id="3049685">bool</span><span class="op" id="3049689">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049695">if</span>&nbsp;<span class="op" id="3049698">*</span><span class="ident" id="3049699">v</span>&nbsp;<span class="op" id="3049701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049708">s</span>&nbsp;<span class="op" id="3049710">+=</span>&nbsp;<span class="string" id="3049713">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3049724">}</span>&nbsp;<span class="keyword" id="3049726">else</span>&nbsp;<span class="op" id="3049731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049738">s</span>&nbsp;<span class="op" id="3049740">+=</span>&nbsp;<span class="string" id="3049743">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3049755">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049761">return</span>&nbsp;<span class="builtintype" id="3049768">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049776">case</span>&nbsp;<span class="op" id="3049781">*</span><span class="builtintype" id="3049782">int</span><span class="op" id="3049785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049791">i</span>&nbsp;<span class="op" id="3049793">=</span>&nbsp;<span class="ident" id="3049795">int64</span><span class="op" id="3049800">(</span><span class="op" id="3049801">*</span><span class="ident" id="3049802">v</span><span class="op" id="3049803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049808">case</span>&nbsp;<span class="op" id="3049813">*</span><span class="builtintype" id="3049814">uint</span><span class="op" id="3049818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049824">i</span>&nbsp;<span class="op" id="3049826">=</span>&nbsp;<span class="ident" id="3049828">int64</span><span class="op" id="3049833">(</span><span class="op" id="3049834">*</span><span class="ident" id="3049835">v</span><span class="op" id="3049836">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049841">case</span>&nbsp;<span class="op" id="3049846">*</span><span class="builtintype" id="3049847">uint8</span><span class="op" id="3049852">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049858">i</span>&nbsp;<span class="op" id="3049860">=</span>&nbsp;<span class="ident" id="3049862">int64</span><span class="op" id="3049867">(</span><span class="op" id="3049868">*</span><span class="ident" id="3049869">v</span><span class="op" id="3049870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049875">case</span>&nbsp;<span class="op" id="3049880">*</span><span class="builtintype" id="3049881">uint16</span><span class="op" id="3049887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049893">i</span>&nbsp;<span class="op" id="3049895">=</span>&nbsp;<span class="ident" id="3049897">int64</span><span class="op" id="3049902">(</span><span class="op" id="3049903">*</span><span class="ident" id="3049904">v</span><span class="op" id="3049905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049910">case</span>&nbsp;<span class="op" id="3049915">*</span><span class="builtintype" id="3049916">uint32</span><span class="op" id="3049922">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049928">i</span>&nbsp;<span class="op" id="3049930">=</span>&nbsp;<span class="ident" id="3049932">int64</span><span class="op" id="3049937">(</span><span class="op" id="3049938">*</span><span class="ident" id="3049939">v</span><span class="op" id="3049940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049945">case</span>&nbsp;<span class="op" id="3049950">*</span><span class="ident" id="3049951">uint64</span><span class="op" id="3049957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049963">i</span>&nbsp;<span class="op" id="3049965">=</span>&nbsp;<span class="ident" id="3049967">int64</span><span class="op" id="3049972">(</span><span class="op" id="3049973">*</span><span class="ident" id="3049974">v</span><span class="op" id="3049975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3049980">case</span>&nbsp;<span class="op" id="3049985">*</span><span class="builtintype" id="3049986">uintptr</span><span class="op" id="3049993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3049999">i</span>&nbsp;<span class="op" id="3050001">=</span>&nbsp;<span class="ident" id="3050003">int64</span><span class="op" id="3050008">(</span><span class="op" id="3050009">*</span><span class="ident" id="3050010">v</span><span class="op" id="3050011">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050021">s</span>&nbsp;<span class="op" id="3050023">+=</span>&nbsp;<span class="ident" id="3050026">itoa</span><span class="op" id="3050030">(</span><span class="builtintype" id="3050031">int</span><span class="op" id="3050034">(</span><span class="ident" id="3050035">i</span><span class="op" id="3050036">)</span><span class="op" id="3050037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050045">return</span>&nbsp;<span class="builtintype" id="3050052">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050058">}</span><span class="op" id="3050059">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050062">s</span>&nbsp;<span class="op" id="3050064">+=</span>&nbsp;<span class="string" id="3050067">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050072">return</span>&nbsp;<span class="ident" id="3050079">s</span><br>
<span class="lineno"></span><span class="op" id="3050081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3050084">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3050111">func</span>&nbsp;<span class="ident" id="3050116">packRR</span><span class="op" id="3050122">(</span><span class="ident" id="3050123">rr</span>&nbsp;<span class="ident" id="3050126">dnsRR</span><span class="op" id="3050131">,</span>&nbsp;<span class="ident" id="3050133">msg</span>&nbsp;<span class="op" id="3050137">[</span><span class="op" id="3050138">]</span><span class="builtintype" id="3050139">byte</span><span class="op" id="3050143">,</span>&nbsp;<span class="ident" id="3050145">off</span>&nbsp;<span class="builtintype" id="3050149">int</span><span class="op" id="3050152">)</span>&nbsp;<span class="op" id="3050154">(</span><span class="ident" id="3050155">off2</span>&nbsp;<span class="builtintype" id="3050160">int</span><span class="op" id="3050163">,</span>&nbsp;<span class="ident" id="3050165">ok</span>&nbsp;<span class="builtintype" id="3050168">bool</span><span class="op" id="3050172">)</span>&nbsp;<span class="op" id="3050174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050177">var</span>&nbsp;<span class="ident" id="3050181">off1</span>&nbsp;<span class="builtintype" id="3050186">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050191">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050234">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050271">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050327">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050353">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050375">off1</span><span class="op" id="3050379">,</span>&nbsp;<span class="ident" id="3050381">ok</span>&nbsp;<span class="op" id="3050384">=</span>&nbsp;<span class="ident" id="3050386">packStruct</span><span class="op" id="3050396">(</span><span class="ident" id="3050397">rr</span><span class="op" id="3050399">.</span><span class="ident" id="3050400">Header</span><span class="op" id="3050406">(</span><span class="op" id="3050407">)</span><span class="op" id="3050408">,</span>&nbsp;<span class="ident" id="3050410">msg</span><span class="op" id="3050413">,</span>&nbsp;<span class="ident" id="3050415">off</span><span class="op" id="3050418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050421">off2</span><span class="op" id="3050425">,</span>&nbsp;<span class="ident" id="3050427">ok</span>&nbsp;<span class="op" id="3050430">=</span>&nbsp;<span class="ident" id="3050432">packStruct</span><span class="op" id="3050442">(</span><span class="ident" id="3050443">rr</span><span class="op" id="3050445">,</span>&nbsp;<span class="ident" id="3050447">msg</span><span class="op" id="3050450">,</span>&nbsp;<span class="ident" id="3050452">off</span><span class="op" id="3050455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050458">if</span>&nbsp;<span class="op" id="3050461">!</span><span class="ident" id="3050462">ok</span>&nbsp;<span class="op" id="3050465">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050469">return</span>&nbsp;<span class="builtinfunc" id="3050476">len</span><span class="op" id="3050479">(</span><span class="ident" id="3050480">msg</span><span class="op" id="3050483">)</span><span class="op" id="3050484">,</span>&nbsp;<span class="builtintype" id="3050486">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050496">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050556">rr</span><span class="op" id="3050558">.</span><span class="ident" id="3050559">Header</span><span class="op" id="3050565">(</span><span class="op" id="3050566">)</span><span class="op" id="3050567">.</span><span class="ident" id="3050568">Rdlength</span>&nbsp;<span class="op" id="3050577">=</span>&nbsp;<span class="builtintype" id="3050579">uint16</span><span class="op" id="3050585">(</span><span class="ident" id="3050586">off2</span>&nbsp;<span class="op" id="3050591">-</span>&nbsp;<span class="ident" id="3050593">off1</span><span class="op" id="3050597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050600">packStruct</span><span class="op" id="3050610">(</span><span class="ident" id="3050611">rr</span><span class="op" id="3050613">.</span><span class="ident" id="3050614">Header</span><span class="op" id="3050620">(</span><span class="op" id="3050621">)</span><span class="op" id="3050622">,</span>&nbsp;<span class="ident" id="3050624">msg</span><span class="op" id="3050627">,</span>&nbsp;<span class="ident" id="3050629">off</span><span class="op" id="3050632">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050635">return</span>&nbsp;<span class="ident" id="3050642">off2</span><span class="op" id="3050646">,</span>&nbsp;<span class="builtintype" id="3050648">true</span><br>
<span class="lineno"></span><span class="op" id="3050653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3050656">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3050685">func</span>&nbsp;<span class="ident" id="3050690">unpackRR</span><span class="op" id="3050698">(</span><span class="ident" id="3050699">msg</span>&nbsp;<span class="op" id="3050703">[</span><span class="op" id="3050704">]</span><span class="builtintype" id="3050705">byte</span><span class="op" id="3050709">,</span>&nbsp;<span class="ident" id="3050711">off</span>&nbsp;<span class="builtintype" id="3050715">int</span><span class="op" id="3050718">)</span>&nbsp;<span class="op" id="3050720">(</span><span class="ident" id="3050721">rr</span>&nbsp;<span class="ident" id="3050724">dnsRR</span><span class="op" id="3050729">,</span>&nbsp;<span class="ident" id="3050731">off1</span>&nbsp;<span class="builtintype" id="3050736">int</span><span class="op" id="3050739">,</span>&nbsp;<span class="ident" id="3050741">ok</span>&nbsp;<span class="builtintype" id="3050744">bool</span><span class="op" id="3050748">)</span>&nbsp;<span class="op" id="3050750">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050753">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050812">var</span>&nbsp;<span class="ident" id="3050816">h</span>&nbsp;<span class="ident" id="3050818">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050832">off0</span>&nbsp;<span class="op" id="3050837">:=</span>&nbsp;<span class="ident" id="3050840">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050845">if</span>&nbsp;<span class="ident" id="3050848">off</span><span class="op" id="3050851">,</span>&nbsp;<span class="ident" id="3050853">ok</span>&nbsp;<span class="op" id="3050856">=</span>&nbsp;<span class="ident" id="3050858">unpackStruct</span><span class="op" id="3050870">(</span><span class="op" id="3050871">&amp;</span><span class="ident" id="3050872">h</span><span class="op" id="3050873">,</span>&nbsp;<span class="ident" id="3050875">msg</span><span class="op" id="3050878">,</span>&nbsp;<span class="ident" id="3050880">off</span><span class="op" id="3050883">)</span><span class="op" id="3050884">;</span>&nbsp;<span class="op" id="3050886">!</span><span class="ident" id="3050887">ok</span>&nbsp;<span class="op" id="3050890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3050894">return</span>&nbsp;<span class="ident" id="3050901">nil</span><span class="op" id="3050904">,</span>&nbsp;<span class="builtinfunc" id="3050906">len</span><span class="op" id="3050909">(</span><span class="ident" id="3050910">msg</span><span class="op" id="3050913">)</span><span class="op" id="3050914">,</span>&nbsp;<span class="builtintype" id="3050916">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3050923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3050926">end</span>&nbsp;<span class="op" id="3050930">:=</span>&nbsp;<span class="ident" id="3050933">off</span>&nbsp;<span class="op" id="3050937">+</span>&nbsp;<span class="builtintype" id="3050939">int</span><span class="op" id="3050942">(</span><span class="ident" id="3050943">h</span><span class="op" id="3050944">.</span><span class="ident" id="3050945">Rdlength</span><span class="op" id="3050953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3050957">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3051000">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051051">mk</span><span class="op" id="3051053">,</span>&nbsp;<span class="ident" id="3051055">known</span>&nbsp;<span class="op" id="3051061">:=</span>&nbsp;<span class="ident" id="3051064">rr_mk</span><span class="op" id="3051069">[</span><span class="builtintype" id="3051070">int</span><span class="op" id="3051073">(</span><span class="ident" id="3051074">h</span><span class="op" id="3051075">.</span><span class="ident" id="3051076">Rrtype</span><span class="op" id="3051082">)</span><span class="op" id="3051083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051086">if</span>&nbsp;<span class="op" id="3051089">!</span><span class="ident" id="3051090">known</span>&nbsp;<span class="op" id="3051096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051100">return</span>&nbsp;<span class="op" id="3051107">&amp;</span><span class="ident" id="3051108">h</span><span class="op" id="3051109">,</span>&nbsp;<span class="ident" id="3051111">end</span><span class="op" id="3051114">,</span>&nbsp;<span class="builtintype" id="3051116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3051122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051125">rr</span>&nbsp;<span class="op" id="3051128">=</span>&nbsp;<span class="ident" id="3051130">mk</span><span class="op" id="3051132">(</span><span class="op" id="3051133">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051136">off</span><span class="op" id="3051139">,</span>&nbsp;<span class="ident" id="3051141">ok</span>&nbsp;<span class="op" id="3051144">=</span>&nbsp;<span class="ident" id="3051146">unpackStruct</span><span class="op" id="3051158">(</span><span class="ident" id="3051159">rr</span><span class="op" id="3051161">,</span>&nbsp;<span class="ident" id="3051163">msg</span><span class="op" id="3051166">,</span>&nbsp;<span class="ident" id="3051168">off0</span><span class="op" id="3051172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051175">if</span>&nbsp;<span class="ident" id="3051178">off</span>&nbsp;<span class="op" id="3051182">!=</span>&nbsp;<span class="ident" id="3051185">end</span>&nbsp;<span class="op" id="3051189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051193">return</span>&nbsp;<span class="op" id="3051200">&amp;</span><span class="ident" id="3051201">h</span><span class="op" id="3051202">,</span>&nbsp;<span class="ident" id="3051204">end</span><span class="op" id="3051207">,</span>&nbsp;<span class="builtintype" id="3051209">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3051215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051218">return</span>&nbsp;<span class="ident" id="3051225">rr</span><span class="op" id="3051227">,</span>&nbsp;<span class="ident" id="3051229">off</span><span class="op" id="3051232">,</span>&nbsp;<span class="ident" id="3051234">ok</span><br>
<span class="lineno">710</span><span class="op" id="3051237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3051240">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3051283">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3051329">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3051377">type</span>&nbsp;<span class="ident" id="3051382">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3051392">struct</span>&nbsp;<span class="op" id="3051399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051402">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051422">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051430">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051450">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051456">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051476">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051481">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051501">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051507">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051527">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051533">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051553">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051559">recursion_available</span>&nbsp;<span class="builtintype" id="3051579">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051585">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3051605">int</span><br>
<span class="lineno">725</span><span class="op" id="3051609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3051612">func</span>&nbsp;<span class="op" id="3051617">(</span><span class="ident" id="3051618">h</span>&nbsp;<span class="op" id="3051620">*</span><span class="ident" id="3051621">dnsMsgHdr</span><span class="op" id="3051630">)</span>&nbsp;<span class="ident" id="3051632">Walk</span><span class="op" id="3051636">(</span><span class="ident" id="3051637">f</span>&nbsp;<span class="keyword" id="3051639">func</span><span class="op" id="3051643">(</span><span class="ident" id="3051644">v</span>&nbsp;<span class="keyword" id="3051646">interface</span><span class="op" id="3051655">{</span><span class="op" id="3051656">}</span><span class="op" id="3051657">,</span>&nbsp;<span class="ident" id="3051659">name</span><span class="op" id="3051663">,</span>&nbsp;<span class="ident" id="3051665">tag</span>&nbsp;<span class="builtintype" id="3051669">string</span><span class="op" id="3051675">)</span>&nbsp;<span class="builtintype" id="3051677">bool</span><span class="op" id="3051681">)</span>&nbsp;<span class="builtintype" id="3051683">bool</span>&nbsp;<span class="op" id="3051688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3051691">return</span>&nbsp;<span class="ident" id="3051698">f</span><span class="op" id="3051699">(</span><span class="op" id="3051700">&amp;</span><span class="ident" id="3051701">h</span><span class="op" id="3051702">.</span><span class="ident" id="3051703">id</span><span class="op" id="3051705">,</span>&nbsp;<span class="string" id="3051707">&#34;id&#34;</span><span class="op" id="3051711">,</span>&nbsp;<span class="string" id="3051713">&#34;&#34;</span><span class="op" id="3051715">)</span>&nbsp;<span class="op" id="3051717">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051722">f</span><span class="op" id="3051723">(</span><span class="op" id="3051724">&amp;</span><span class="ident" id="3051725">h</span><span class="op" id="3051726">.</span><span class="ident" id="3051727">response</span><span class="op" id="3051735">,</span>&nbsp;<span class="string" id="3051737">&#34;response&#34;</span><span class="op" id="3051747">,</span>&nbsp;<span class="string" id="3051749">&#34;&#34;</span><span class="op" id="3051751">)</span>&nbsp;<span class="op" id="3051753">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051758">f</span><span class="op" id="3051759">(</span><span class="op" id="3051760">&amp;</span><span class="ident" id="3051761">h</span><span class="op" id="3051762">.</span><span class="ident" id="3051763">opcode</span><span class="op" id="3051769">,</span>&nbsp;<span class="string" id="3051771">&#34;opcode&#34;</span><span class="op" id="3051779">,</span>&nbsp;<span class="string" id="3051781">&#34;&#34;</span><span class="op" id="3051783">)</span>&nbsp;<span class="op" id="3051785">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051790">f</span><span class="op" id="3051791">(</span><span class="op" id="3051792">&amp;</span><span class="ident" id="3051793">h</span><span class="op" id="3051794">.</span><span class="ident" id="3051795">authoritative</span><span class="op" id="3051808">,</span>&nbsp;<span class="string" id="3051810">&#34;authoritative&#34;</span><span class="op" id="3051825">,</span>&nbsp;<span class="string" id="3051827">&#34;&#34;</span><span class="op" id="3051829">)</span>&nbsp;<span class="op" id="3051831">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051836">f</span><span class="op" id="3051837">(</span><span class="op" id="3051838">&amp;</span><span class="ident" id="3051839">h</span><span class="op" id="3051840">.</span><span class="ident" id="3051841">truncated</span><span class="op" id="3051850">,</span>&nbsp;<span class="string" id="3051852">&#34;truncated&#34;</span><span class="op" id="3051863">,</span>&nbsp;<span class="string" id="3051865">&#34;&#34;</span><span class="op" id="3051867">)</span>&nbsp;<span class="op" id="3051869">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051874">f</span><span class="op" id="3051875">(</span><span class="op" id="3051876">&amp;</span><span class="ident" id="3051877">h</span><span class="op" id="3051878">.</span><span class="ident" id="3051879">recursion_desired</span><span class="op" id="3051896">,</span>&nbsp;<span class="string" id="3051898">&#34;recursion_desired&#34;</span><span class="op" id="3051917">,</span>&nbsp;<span class="string" id="3051919">&#34;&#34;</span><span class="op" id="3051921">)</span>&nbsp;<span class="op" id="3051923">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051928">f</span><span class="op" id="3051929">(</span><span class="op" id="3051930">&amp;</span><span class="ident" id="3051931">h</span><span class="op" id="3051932">.</span><span class="ident" id="3051933">recursion_available</span><span class="op" id="3051952">,</span>&nbsp;<span class="string" id="3051954">&#34;recursion_available&#34;</span><span class="op" id="3051975">,</span>&nbsp;<span class="string" id="3051977">&#34;&#34;</span><span class="op" id="3051979">)</span>&nbsp;<span class="op" id="3051981">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3051986">f</span><span class="op" id="3051987">(</span><span class="op" id="3051988">&amp;</span><span class="ident" id="3051989">h</span><span class="op" id="3051990">.</span><span class="ident" id="3051991">rcode</span><span class="op" id="3051996">,</span>&nbsp;<span class="string" id="3051998">&#34;rcode&#34;</span><span class="op" id="3052005">,</span>&nbsp;<span class="string" id="3052007">&#34;&#34;</span><span class="op" id="3052009">)</span><br>
<span class="lineno"></span><span class="op" id="3052011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3052014">type</span>&nbsp;<span class="ident" id="3052019">dnsMsg</span>&nbsp;<span class="keyword" id="3052026">struct</span>&nbsp;<span class="op" id="3052033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052036">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052047">question</span>&nbsp;<span class="op" id="3052056">[</span><span class="op" id="3052057">]</span><span class="ident" id="3052058">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052071">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3052080">[</span><span class="op" id="3052081">]</span><span class="ident" id="3052082">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052089">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052098">[</span><span class="op" id="3052099">]</span><span class="ident" id="3052100">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052107">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052116">[</span><span class="op" id="3052117">]</span><span class="ident" id="3052118">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3052124">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3052127">func</span>&nbsp;<span class="op" id="3052132">(</span><span class="ident" id="3052133">dns</span>&nbsp;<span class="op" id="3052137">*</span><span class="ident" id="3052138">dnsMsg</span><span class="op" id="3052144">)</span>&nbsp;<span class="ident" id="3052146">Pack</span><span class="op" id="3052150">(</span><span class="op" id="3052151">)</span>&nbsp;<span class="op" id="3052153">(</span><span class="ident" id="3052154">msg</span>&nbsp;<span class="op" id="3052158">[</span><span class="op" id="3052159">]</span><span class="builtintype" id="3052160">byte</span><span class="op" id="3052164">,</span>&nbsp;<span class="ident" id="3052166">ok</span>&nbsp;<span class="builtintype" id="3052169">bool</span><span class="op" id="3052173">)</span>&nbsp;<span class="op" id="3052175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052178">var</span>&nbsp;<span class="ident" id="3052182">dh</span>&nbsp;<span class="ident" id="3052185">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3052197">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052253">dh</span><span class="op" id="3052255">.</span><span class="ident" id="3052256">Id</span>&nbsp;<span class="op" id="3052259">=</span>&nbsp;<span class="ident" id="3052261">dns</span><span class="op" id="3052264">.</span><span class="ident" id="3052265">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052269">dh</span><span class="op" id="3052271">.</span><span class="ident" id="3052272">Bits</span>&nbsp;<span class="op" id="3052277">=</span>&nbsp;<span class="builtintype" id="3052279">uint16</span><span class="op" id="3052285">(</span><span class="ident" id="3052286">dns</span><span class="op" id="3052289">.</span><span class="ident" id="3052290">opcode</span><span class="op" id="3052296">)</span><span class="op" id="3052297">&lt;&lt;</span><span class="num" id="3052299">11</span>&nbsp;<span class="op" id="3052302">|</span>&nbsp;<span class="builtintype" id="3052304">uint16</span><span class="op" id="3052310">(</span><span class="ident" id="3052311">dns</span><span class="op" id="3052314">.</span><span class="ident" id="3052315">rcode</span><span class="op" id="3052320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052323">if</span>&nbsp;<span class="ident" id="3052326">dns</span><span class="op" id="3052329">.</span><span class="ident" id="3052330">recursion_available</span>&nbsp;<span class="op" id="3052350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052354">dh</span><span class="op" id="3052356">.</span><span class="ident" id="3052357">Bits</span>&nbsp;<span class="op" id="3052362">|=</span>&nbsp;<span class="ident" id="3052365">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052370">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052373">if</span>&nbsp;<span class="ident" id="3052376">dns</span><span class="op" id="3052379">.</span><span class="ident" id="3052380">recursion_desired</span>&nbsp;<span class="op" id="3052398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052402">dh</span><span class="op" id="3052404">.</span><span class="ident" id="3052405">Bits</span>&nbsp;<span class="op" id="3052410">|=</span>&nbsp;<span class="ident" id="3052413">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052421">if</span>&nbsp;<span class="ident" id="3052424">dns</span><span class="op" id="3052427">.</span><span class="ident" id="3052428">truncated</span>&nbsp;<span class="op" id="3052438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052442">dh</span><span class="op" id="3052444">.</span><span class="ident" id="3052445">Bits</span>&nbsp;<span class="op" id="3052450">|=</span>&nbsp;<span class="ident" id="3052453">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052461">if</span>&nbsp;<span class="ident" id="3052464">dns</span><span class="op" id="3052467">.</span><span class="ident" id="3052468">authoritative</span>&nbsp;<span class="op" id="3052482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052486">dh</span><span class="op" id="3052488">.</span><span class="ident" id="3052489">Bits</span>&nbsp;<span class="op" id="3052494">|=</span>&nbsp;<span class="ident" id="3052497">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3052505">if</span>&nbsp;<span class="ident" id="3052508">dns</span><span class="op" id="3052511">.</span><span class="ident" id="3052512">response</span>&nbsp;<span class="op" id="3052521">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052525">dh</span><span class="op" id="3052527">.</span><span class="ident" id="3052528">Bits</span>&nbsp;<span class="op" id="3052533">|=</span>&nbsp;<span class="ident" id="3052536">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3052541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3052545">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052580">question</span>&nbsp;<span class="op" id="3052589">:=</span>&nbsp;<span class="ident" id="3052592">dns</span><span class="op" id="3052595">.</span><span class="ident" id="3052596">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052606">answer</span>&nbsp;<span class="op" id="3052613">:=</span>&nbsp;<span class="ident" id="3052616">dns</span><span class="op" id="3052619">.</span><span class="ident" id="3052620">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052628">ns</span>&nbsp;<span class="op" id="3052631">:=</span>&nbsp;<span class="ident" id="3052634">dns</span><span class="op" id="3052637">.</span><span class="ident" id="3052638">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052642">extra</span>&nbsp;<span class="op" id="3052648">:=</span>&nbsp;<span class="ident" id="3052651">dns</span><span class="op" id="3052654">.</span><span class="ident" id="3052655">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052663">dh</span><span class="op" id="3052665">.</span><span class="ident" id="3052666">Qdcount</span>&nbsp;<span class="op" id="3052674">=</span>&nbsp;<span class="builtintype" id="3052676">uint16</span><span class="op" id="3052682">(</span><span class="builtinfunc" id="3052683">len</span><span class="op" id="3052686">(</span><span class="ident" id="3052687">question</span><span class="op" id="3052695">)</span><span class="op" id="3052696">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052699">dh</span><span class="op" id="3052701">.</span><span class="ident" id="3052702">Ancount</span>&nbsp;<span class="op" id="3052710">=</span>&nbsp;<span class="builtintype" id="3052712">uint16</span><span class="op" id="3052718">(</span><span class="builtinfunc" id="3052719">len</span><span class="op" id="3052722">(</span><span class="ident" id="3052723">answer</span><span class="op" id="3052729">)</span><span class="op" id="3052730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052733">dh</span><span class="op" id="3052735">.</span><span class="ident" id="3052736">Nscount</span>&nbsp;<span class="op" id="3052744">=</span>&nbsp;<span class="builtintype" id="3052746">uint16</span><span class="op" id="3052752">(</span><span class="builtinfunc" id="3052753">len</span><span class="op" id="3052756">(</span><span class="ident" id="3052757">ns</span><span class="op" id="3052759">)</span><span class="op" id="3052760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052763">dh</span><span class="op" id="3052765">.</span><span class="ident" id="3052766">Arcount</span>&nbsp;<span class="op" id="3052774">=</span>&nbsp;<span class="builtintype" id="3052776">uint16</span><span class="op" id="3052782">(</span><span class="builtinfunc" id="3052783">len</span><span class="op" id="3052786">(</span><span class="ident" id="3052787">extra</span><span class="op" id="3052792">)</span><span class="op" id="3052793">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3052797">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3052846">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3052892">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3052930">msg</span>&nbsp;<span class="op" id="3052934">=</span>&nbsp;<span class="builtinfunc" id="3052936">make</span><span class="op" id="3052940">(</span><span class="op" id="3052941">[</span><span class="op" id="3052942">]</span><span class="builtintype" id="3052943">byte</span><span class="op" id="3052947">,</span>&nbsp;<span class="num" id="3052949">2000</span><span class="op" id="3052953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3052957">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053001">off</span>&nbsp;<span class="op" id="3053005">:=</span>&nbsp;<span class="num" id="3053008">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053011">off</span><span class="op" id="3053014">,</span>&nbsp;<span class="ident" id="3053016">ok</span>&nbsp;<span class="op" id="3053019">=</span>&nbsp;<span class="ident" id="3053021">packStruct</span><span class="op" id="3053031">(</span><span class="op" id="3053032">&amp;</span><span class="ident" id="3053033">dh</span><span class="op" id="3053035">,</span>&nbsp;<span class="ident" id="3053037">msg</span><span class="op" id="3053040">,</span>&nbsp;<span class="ident" id="3053042">off</span><span class="op" id="3053045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053048">for</span>&nbsp;<span class="ident" id="3053052">i</span>&nbsp;<span class="op" id="3053054">:=</span>&nbsp;<span class="num" id="3053057">0</span><span class="op" id="3053058">;</span>&nbsp;<span class="ident" id="3053060">i</span>&nbsp;<span class="op" id="3053062">&lt;</span>&nbsp;<span class="builtinfunc" id="3053064">len</span><span class="op" id="3053067">(</span><span class="ident" id="3053068">question</span><span class="op" id="3053076">)</span><span class="op" id="3053077">;</span>&nbsp;<span class="ident" id="3053079">i</span><span class="op" id="3053080">++</span>&nbsp;<span class="op" id="3053083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053087">off</span><span class="op" id="3053090">,</span>&nbsp;<span class="ident" id="3053092">ok</span>&nbsp;<span class="op" id="3053095">=</span>&nbsp;<span class="ident" id="3053097">packStruct</span><span class="op" id="3053107">(</span><span class="op" id="3053108">&amp;</span><span class="ident" id="3053109">question</span><span class="op" id="3053117">[</span><span class="ident" id="3053118">i</span><span class="op" id="3053119">]</span><span class="op" id="3053120">,</span>&nbsp;<span class="ident" id="3053122">msg</span><span class="op" id="3053125">,</span>&nbsp;<span class="ident" id="3053127">off</span><span class="op" id="3053130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053133">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053136">for</span>&nbsp;<span class="ident" id="3053140">i</span>&nbsp;<span class="op" id="3053142">:=</span>&nbsp;<span class="num" id="3053145">0</span><span class="op" id="3053146">;</span>&nbsp;<span class="ident" id="3053148">i</span>&nbsp;<span class="op" id="3053150">&lt;</span>&nbsp;<span class="builtinfunc" id="3053152">len</span><span class="op" id="3053155">(</span><span class="ident" id="3053156">answer</span><span class="op" id="3053162">)</span><span class="op" id="3053163">;</span>&nbsp;<span class="ident" id="3053165">i</span><span class="op" id="3053166">++</span>&nbsp;<span class="op" id="3053169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053173">off</span><span class="op" id="3053176">,</span>&nbsp;<span class="ident" id="3053178">ok</span>&nbsp;<span class="op" id="3053181">=</span>&nbsp;<span class="ident" id="3053183">packRR</span><span class="op" id="3053189">(</span><span class="ident" id="3053190">answer</span><span class="op" id="3053196">[</span><span class="ident" id="3053197">i</span><span class="op" id="3053198">]</span><span class="op" id="3053199">,</span>&nbsp;<span class="ident" id="3053201">msg</span><span class="op" id="3053204">,</span>&nbsp;<span class="ident" id="3053206">off</span><span class="op" id="3053209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053215">for</span>&nbsp;<span class="ident" id="3053219">i</span>&nbsp;<span class="op" id="3053221">:=</span>&nbsp;<span class="num" id="3053224">0</span><span class="op" id="3053225">;</span>&nbsp;<span class="ident" id="3053227">i</span>&nbsp;<span class="op" id="3053229">&lt;</span>&nbsp;<span class="builtinfunc" id="3053231">len</span><span class="op" id="3053234">(</span><span class="ident" id="3053235">ns</span><span class="op" id="3053237">)</span><span class="op" id="3053238">;</span>&nbsp;<span class="ident" id="3053240">i</span><span class="op" id="3053241">++</span>&nbsp;<span class="op" id="3053244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053248">off</span><span class="op" id="3053251">,</span>&nbsp;<span class="ident" id="3053253">ok</span>&nbsp;<span class="op" id="3053256">=</span>&nbsp;<span class="ident" id="3053258">packRR</span><span class="op" id="3053264">(</span><span class="ident" id="3053265">ns</span><span class="op" id="3053267">[</span><span class="ident" id="3053268">i</span><span class="op" id="3053269">]</span><span class="op" id="3053270">,</span>&nbsp;<span class="ident" id="3053272">msg</span><span class="op" id="3053275">,</span>&nbsp;<span class="ident" id="3053277">off</span><span class="op" id="3053280">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053286">for</span>&nbsp;<span class="ident" id="3053290">i</span>&nbsp;<span class="op" id="3053292">:=</span>&nbsp;<span class="num" id="3053295">0</span><span class="op" id="3053296">;</span>&nbsp;<span class="ident" id="3053298">i</span>&nbsp;<span class="op" id="3053300">&lt;</span>&nbsp;<span class="builtinfunc" id="3053302">len</span><span class="op" id="3053305">(</span><span class="ident" id="3053306">extra</span><span class="op" id="3053311">)</span><span class="op" id="3053312">;</span>&nbsp;<span class="ident" id="3053314">i</span><span class="op" id="3053315">++</span>&nbsp;<span class="op" id="3053318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053322">off</span><span class="op" id="3053325">,</span>&nbsp;<span class="ident" id="3053327">ok</span>&nbsp;<span class="op" id="3053330">=</span>&nbsp;<span class="ident" id="3053332">packRR</span><span class="op" id="3053338">(</span><span class="ident" id="3053339">extra</span><span class="op" id="3053344">[</span><span class="ident" id="3053345">i</span><span class="op" id="3053346">]</span><span class="op" id="3053347">,</span>&nbsp;<span class="ident" id="3053349">msg</span><span class="op" id="3053352">,</span>&nbsp;<span class="ident" id="3053354">off</span><span class="op" id="3053357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053363">if</span>&nbsp;<span class="op" id="3053366">!</span><span class="ident" id="3053367">ok</span>&nbsp;<span class="op" id="3053370">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053374">return</span>&nbsp;<span class="ident" id="3053381">nil</span><span class="op" id="3053384">,</span>&nbsp;<span class="builtintype" id="3053386">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053396">return</span>&nbsp;<span class="ident" id="3053403">msg</span><span class="op" id="3053406">[</span><span class="num" id="3053407">0</span><span class="op" id="3053408">:</span><span class="ident" id="3053409">off</span><span class="op" id="3053412">]</span><span class="op" id="3053413">,</span>&nbsp;<span class="builtintype" id="3053415">true</span><br>
<span class="lineno"></span><span class="op" id="3053420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3053423">func</span>&nbsp;<span class="op" id="3053428">(</span><span class="ident" id="3053429">dns</span>&nbsp;<span class="op" id="3053433">*</span><span class="ident" id="3053434">dnsMsg</span><span class="op" id="3053440">)</span>&nbsp;<span class="ident" id="3053442">Unpack</span><span class="op" id="3053448">(</span><span class="ident" id="3053449">msg</span>&nbsp;<span class="op" id="3053453">[</span><span class="op" id="3053454">]</span><span class="builtintype" id="3053455">byte</span><span class="op" id="3053459">)</span>&nbsp;<span class="builtintype" id="3053461">bool</span>&nbsp;<span class="op" id="3053466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3053469">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053481">var</span>&nbsp;<span class="ident" id="3053485">dh</span>&nbsp;<span class="ident" id="3053488">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053499">off</span>&nbsp;<span class="op" id="3053503">:=</span>&nbsp;<span class="num" id="3053506">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053509">var</span>&nbsp;<span class="ident" id="3053513">ok</span>&nbsp;<span class="builtintype" id="3053516">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053522">if</span>&nbsp;<span class="ident" id="3053525">off</span><span class="op" id="3053528">,</span>&nbsp;<span class="ident" id="3053530">ok</span>&nbsp;<span class="op" id="3053533">=</span>&nbsp;<span class="ident" id="3053535">unpackStruct</span><span class="op" id="3053547">(</span><span class="op" id="3053548">&amp;</span><span class="ident" id="3053549">dh</span><span class="op" id="3053551">,</span>&nbsp;<span class="ident" id="3053553">msg</span><span class="op" id="3053556">,</span>&nbsp;<span class="ident" id="3053558">off</span><span class="op" id="3053561">)</span><span class="op" id="3053562">;</span>&nbsp;<span class="op" id="3053564">!</span><span class="ident" id="3053565">ok</span>&nbsp;<span class="op" id="3053568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3053572">return</span>&nbsp;<span class="builtintype" id="3053579">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3053586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053589">dns</span><span class="op" id="3053592">.</span><span class="ident" id="3053593">id</span>&nbsp;<span class="op" id="3053596">=</span>&nbsp;<span class="ident" id="3053598">dh</span><span class="op" id="3053600">.</span><span class="ident" id="3053601">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053605">dns</span><span class="op" id="3053608">.</span><span class="ident" id="3053609">response</span>&nbsp;<span class="op" id="3053618">=</span>&nbsp;<span class="op" id="3053620">(</span><span class="ident" id="3053621">dh</span><span class="op" id="3053623">.</span><span class="ident" id="3053624">Bits</span>&nbsp;<span class="op" id="3053629">&amp;</span>&nbsp;<span class="ident" id="3053631">_QR</span><span class="op" id="3053634">)</span>&nbsp;<span class="op" id="3053636">!=</span>&nbsp;<span class="num" id="3053639">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053642">dns</span><span class="op" id="3053645">.</span><span class="ident" id="3053646">opcode</span>&nbsp;<span class="op" id="3053653">=</span>&nbsp;<span class="builtintype" id="3053655">int</span><span class="op" id="3053658">(</span><span class="ident" id="3053659">dh</span><span class="op" id="3053661">.</span><span class="ident" id="3053662">Bits</span><span class="op" id="3053666">&gt;&gt;</span><span class="num" id="3053668">11</span><span class="op" id="3053670">)</span>&nbsp;<span class="op" id="3053672">&amp;</span>&nbsp;<span class="num" id="3053674">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053679">dns</span><span class="op" id="3053682">.</span><span class="ident" id="3053683">authoritative</span>&nbsp;<span class="op" id="3053697">=</span>&nbsp;<span class="op" id="3053699">(</span><span class="ident" id="3053700">dh</span><span class="op" id="3053702">.</span><span class="ident" id="3053703">Bits</span>&nbsp;<span class="op" id="3053708">&amp;</span>&nbsp;<span class="ident" id="3053710">_AA</span><span class="op" id="3053713">)</span>&nbsp;<span class="op" id="3053715">!=</span>&nbsp;<span class="num" id="3053718">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053721">dns</span><span class="op" id="3053724">.</span><span class="ident" id="3053725">truncated</span>&nbsp;<span class="op" id="3053735">=</span>&nbsp;<span class="op" id="3053737">(</span><span class="ident" id="3053738">dh</span><span class="op" id="3053740">.</span><span class="ident" id="3053741">Bits</span>&nbsp;<span class="op" id="3053746">&amp;</span>&nbsp;<span class="ident" id="3053748">_TC</span><span class="op" id="3053751">)</span>&nbsp;<span class="op" id="3053753">!=</span>&nbsp;<span class="num" id="3053756">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053759">dns</span><span class="op" id="3053762">.</span><span class="ident" id="3053763">recursion_desired</span>&nbsp;<span class="op" id="3053781">=</span>&nbsp;<span class="op" id="3053783">(</span><span class="ident" id="3053784">dh</span><span class="op" id="3053786">.</span><span class="ident" id="3053787">Bits</span>&nbsp;<span class="op" id="3053792">&amp;</span>&nbsp;<span class="ident" id="3053794">_RD</span><span class="op" id="3053797">)</span>&nbsp;<span class="op" id="3053799">!=</span>&nbsp;<span class="num" id="3053802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053805">dns</span><span class="op" id="3053808">.</span><span class="ident" id="3053809">recursion_available</span>&nbsp;<span class="op" id="3053829">=</span>&nbsp;<span class="op" id="3053831">(</span><span class="ident" id="3053832">dh</span><span class="op" id="3053834">.</span><span class="ident" id="3053835">Bits</span>&nbsp;<span class="op" id="3053840">&amp;</span>&nbsp;<span class="ident" id="3053842">_RA</span><span class="op" id="3053845">)</span>&nbsp;<span class="op" id="3053847">!=</span>&nbsp;<span class="num" id="3053850">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053853">dns</span><span class="op" id="3053856">.</span><span class="ident" id="3053857">rcode</span>&nbsp;<span class="op" id="3053863">=</span>&nbsp;<span class="builtintype" id="3053865">int</span><span class="op" id="3053868">(</span><span class="ident" id="3053869">dh</span><span class="op" id="3053871">.</span><span class="ident" id="3053872">Bits</span>&nbsp;<span class="op" id="3053877">&amp;</span>&nbsp;<span class="num" id="3053879">0xF</span><span class="op" id="3053882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3053886">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053898">dns</span><span class="op" id="3053901">.</span><span class="ident" id="3053902">question</span>&nbsp;<span class="op" id="3053911">=</span>&nbsp;<span class="builtinfunc" id="3053913">make</span><span class="op" id="3053917">(</span><span class="op" id="3053918">[</span><span class="op" id="3053919">]</span><span class="ident" id="3053920">dnsQuestion</span><span class="op" id="3053931">,</span>&nbsp;<span class="ident" id="3053933">dh</span><span class="op" id="3053935">.</span><span class="ident" id="3053936">Qdcount</span><span class="op" id="3053943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053946">dns</span><span class="op" id="3053949">.</span><span class="ident" id="3053950">answer</span>&nbsp;<span class="op" id="3053957">=</span>&nbsp;<span class="builtinfunc" id="3053959">make</span><span class="op" id="3053963">(</span><span class="op" id="3053964">[</span><span class="op" id="3053965">]</span><span class="ident" id="3053966">dnsRR</span><span class="op" id="3053971">,</span>&nbsp;<span class="num" id="3053973">0</span><span class="op" id="3053974">,</span>&nbsp;<span class="ident" id="3053976">dh</span><span class="op" id="3053978">.</span><span class="ident" id="3053979">Ancount</span><span class="op" id="3053986">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3053989">dns</span><span class="op" id="3053992">.</span><span class="ident" id="3053993">ns</span>&nbsp;<span class="op" id="3053996">=</span>&nbsp;<span class="builtinfunc" id="3053998">make</span><span class="op" id="3054002">(</span><span class="op" id="3054003">[</span><span class="op" id="3054004">]</span><span class="ident" id="3054005">dnsRR</span><span class="op" id="3054010">,</span>&nbsp;<span class="num" id="3054012">0</span><span class="op" id="3054013">,</span>&nbsp;<span class="ident" id="3054015">dh</span><span class="op" id="3054017">.</span><span class="ident" id="3054018">Nscount</span><span class="op" id="3054025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054028">dns</span><span class="op" id="3054031">.</span><span class="ident" id="3054032">extra</span>&nbsp;<span class="op" id="3054038">=</span>&nbsp;<span class="builtinfunc" id="3054040">make</span><span class="op" id="3054044">(</span><span class="op" id="3054045">[</span><span class="op" id="3054046">]</span><span class="ident" id="3054047">dnsRR</span><span class="op" id="3054052">,</span>&nbsp;<span class="num" id="3054054">0</span><span class="op" id="3054055">,</span>&nbsp;<span class="ident" id="3054057">dh</span><span class="op" id="3054059">.</span><span class="ident" id="3054060">Arcount</span><span class="op" id="3054067">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054071">var</span>&nbsp;<span class="ident" id="3054075">rec</span>&nbsp;<span class="ident" id="3054079">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054087">for</span>&nbsp;<span class="ident" id="3054091">i</span>&nbsp;<span class="op" id="3054093">:=</span>&nbsp;<span class="num" id="3054096">0</span><span class="op" id="3054097">;</span>&nbsp;<span class="ident" id="3054099">i</span>&nbsp;<span class="op" id="3054101">&lt;</span>&nbsp;<span class="builtinfunc" id="3054103">len</span><span class="op" id="3054106">(</span><span class="ident" id="3054107">dns</span><span class="op" id="3054110">.</span><span class="ident" id="3054111">question</span><span class="op" id="3054119">)</span><span class="op" id="3054120">;</span>&nbsp;<span class="ident" id="3054122">i</span><span class="op" id="3054123">++</span>&nbsp;<span class="op" id="3054126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054130">off</span><span class="op" id="3054133">,</span>&nbsp;<span class="ident" id="3054135">ok</span>&nbsp;<span class="op" id="3054138">=</span>&nbsp;<span class="ident" id="3054140">unpackStruct</span><span class="op" id="3054152">(</span><span class="op" id="3054153">&amp;</span><span class="ident" id="3054154">dns</span><span class="op" id="3054157">.</span><span class="ident" id="3054158">question</span><span class="op" id="3054166">[</span><span class="ident" id="3054167">i</span><span class="op" id="3054168">]</span><span class="op" id="3054169">,</span>&nbsp;<span class="ident" id="3054171">msg</span><span class="op" id="3054174">,</span>&nbsp;<span class="ident" id="3054176">off</span><span class="op" id="3054179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054185">for</span>&nbsp;<span class="ident" id="3054189">i</span>&nbsp;<span class="op" id="3054191">:=</span>&nbsp;<span class="num" id="3054194">0</span><span class="op" id="3054195">;</span>&nbsp;<span class="ident" id="3054197">i</span>&nbsp;<span class="op" id="3054199">&lt;</span>&nbsp;<span class="builtintype" id="3054201">int</span><span class="op" id="3054204">(</span><span class="ident" id="3054205">dh</span><span class="op" id="3054207">.</span><span class="ident" id="3054208">Ancount</span><span class="op" id="3054215">)</span><span class="op" id="3054216">;</span>&nbsp;<span class="ident" id="3054218">i</span><span class="op" id="3054219">++</span>&nbsp;<span class="op" id="3054222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054226">rec</span><span class="op" id="3054229">,</span>&nbsp;<span class="ident" id="3054231">off</span><span class="op" id="3054234">,</span>&nbsp;<span class="ident" id="3054236">ok</span>&nbsp;<span class="op" id="3054239">=</span>&nbsp;<span class="ident" id="3054241">unpackRR</span><span class="op" id="3054249">(</span><span class="ident" id="3054250">msg</span><span class="op" id="3054253">,</span>&nbsp;<span class="ident" id="3054255">off</span><span class="op" id="3054258">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054262">if</span>&nbsp;<span class="op" id="3054265">!</span><span class="ident" id="3054266">ok</span>&nbsp;<span class="op" id="3054269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054274">return</span>&nbsp;<span class="builtintype" id="3054281">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054293">dns</span><span class="op" id="3054296">.</span><span class="ident" id="3054297">answer</span>&nbsp;<span class="op" id="3054304">=</span>&nbsp;<span class="builtinfunc" id="3054306">append</span><span class="op" id="3054312">(</span><span class="ident" id="3054313">dns</span><span class="op" id="3054316">.</span><span class="ident" id="3054317">answer</span><span class="op" id="3054323">,</span>&nbsp;<span class="ident" id="3054325">rec</span><span class="op" id="3054328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054331">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054334">for</span>&nbsp;<span class="ident" id="3054338">i</span>&nbsp;<span class="op" id="3054340">:=</span>&nbsp;<span class="num" id="3054343">0</span><span class="op" id="3054344">;</span>&nbsp;<span class="ident" id="3054346">i</span>&nbsp;<span class="op" id="3054348">&lt;</span>&nbsp;<span class="builtintype" id="3054350">int</span><span class="op" id="3054353">(</span><span class="ident" id="3054354">dh</span><span class="op" id="3054356">.</span><span class="ident" id="3054357">Nscount</span><span class="op" id="3054364">)</span><span class="op" id="3054365">;</span>&nbsp;<span class="ident" id="3054367">i</span><span class="op" id="3054368">++</span>&nbsp;<span class="op" id="3054371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054375">rec</span><span class="op" id="3054378">,</span>&nbsp;<span class="ident" id="3054380">off</span><span class="op" id="3054383">,</span>&nbsp;<span class="ident" id="3054385">ok</span>&nbsp;<span class="op" id="3054388">=</span>&nbsp;<span class="ident" id="3054390">unpackRR</span><span class="op" id="3054398">(</span><span class="ident" id="3054399">msg</span><span class="op" id="3054402">,</span>&nbsp;<span class="ident" id="3054404">off</span><span class="op" id="3054407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054411">if</span>&nbsp;<span class="op" id="3054414">!</span><span class="ident" id="3054415">ok</span>&nbsp;<span class="op" id="3054418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054423">return</span>&nbsp;<span class="builtintype" id="3054430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054438">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054442">dns</span><span class="op" id="3054445">.</span><span class="ident" id="3054446">ns</span>&nbsp;<span class="op" id="3054449">=</span>&nbsp;<span class="builtinfunc" id="3054451">append</span><span class="op" id="3054457">(</span><span class="ident" id="3054458">dns</span><span class="op" id="3054461">.</span><span class="ident" id="3054462">ns</span><span class="op" id="3054464">,</span>&nbsp;<span class="ident" id="3054466">rec</span><span class="op" id="3054469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054475">for</span>&nbsp;<span class="ident" id="3054479">i</span>&nbsp;<span class="op" id="3054481">:=</span>&nbsp;<span class="num" id="3054484">0</span><span class="op" id="3054485">;</span>&nbsp;<span class="ident" id="3054487">i</span>&nbsp;<span class="op" id="3054489">&lt;</span>&nbsp;<span class="builtintype" id="3054491">int</span><span class="op" id="3054494">(</span><span class="ident" id="3054495">dh</span><span class="op" id="3054497">.</span><span class="ident" id="3054498">Arcount</span><span class="op" id="3054505">)</span><span class="op" id="3054506">;</span>&nbsp;<span class="ident" id="3054508">i</span><span class="op" id="3054509">++</span>&nbsp;<span class="op" id="3054512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054516">rec</span><span class="op" id="3054519">,</span>&nbsp;<span class="ident" id="3054521">off</span><span class="op" id="3054524">,</span>&nbsp;<span class="ident" id="3054526">ok</span>&nbsp;<span class="op" id="3054529">=</span>&nbsp;<span class="ident" id="3054531">unpackRR</span><span class="op" id="3054539">(</span><span class="ident" id="3054540">msg</span><span class="op" id="3054543">,</span>&nbsp;<span class="ident" id="3054545">off</span><span class="op" id="3054548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054552">if</span>&nbsp;<span class="op" id="3054555">!</span><span class="ident" id="3054556">ok</span>&nbsp;<span class="op" id="3054559">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054564">return</span>&nbsp;<span class="builtintype" id="3054571">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054583">dns</span><span class="op" id="3054586">.</span><span class="ident" id="3054587">extra</span>&nbsp;<span class="op" id="3054593">=</span>&nbsp;<span class="builtinfunc" id="3054595">append</span><span class="op" id="3054601">(</span><span class="ident" id="3054602">dns</span><span class="op" id="3054605">.</span><span class="ident" id="3054606">extra</span><span class="op" id="3054611">,</span>&nbsp;<span class="ident" id="3054613">rec</span><span class="op" id="3054616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3054622">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3054647">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;println(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3054710">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054716">return</span>&nbsp;<span class="builtintype" id="3054723">true</span><br>
<span class="lineno"></span><span class="op" id="3054728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3054731">func</span>&nbsp;<span class="op" id="3054736">(</span><span class="ident" id="3054737">dns</span>&nbsp;<span class="op" id="3054741">*</span><span class="ident" id="3054742">dnsMsg</span><span class="op" id="3054748">)</span>&nbsp;<span class="ident" id="3054750">String</span><span class="op" id="3054756">(</span><span class="op" id="3054757">)</span>&nbsp;<span class="builtintype" id="3054759">string</span>&nbsp;<span class="op" id="3054766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054769">s</span>&nbsp;<span class="op" id="3054771">:=</span>&nbsp;<span class="string" id="3054774">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3054782">+</span>&nbsp;<span class="ident" id="3054784">printStruct</span><span class="op" id="3054795">(</span><span class="op" id="3054796">&amp;</span><span class="ident" id="3054797">dns</span><span class="op" id="3054800">.</span><span class="ident" id="3054801">dnsMsgHdr</span><span class="op" id="3054810">)</span>&nbsp;<span class="op" id="3054812">+</span>&nbsp;<span class="string" id="3054814">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054820">if</span>&nbsp;<span class="builtinfunc" id="3054823">len</span><span class="op" id="3054826">(</span><span class="ident" id="3054827">dns</span><span class="op" id="3054830">.</span><span class="ident" id="3054831">question</span><span class="op" id="3054839">)</span>&nbsp;<span class="op" id="3054841">&gt;</span>&nbsp;<span class="num" id="3054843">0</span>&nbsp;<span class="op" id="3054845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054849">s</span>&nbsp;<span class="op" id="3054851">+=</span>&nbsp;<span class="string" id="3054854">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054873">for</span>&nbsp;<span class="ident" id="3054877">i</span>&nbsp;<span class="op" id="3054879">:=</span>&nbsp;<span class="num" id="3054882">0</span><span class="op" id="3054883">;</span>&nbsp;<span class="ident" id="3054885">i</span>&nbsp;<span class="op" id="3054887">&lt;</span>&nbsp;<span class="builtinfunc" id="3054889">len</span><span class="op" id="3054892">(</span><span class="ident" id="3054893">dns</span><span class="op" id="3054896">.</span><span class="ident" id="3054897">question</span><span class="op" id="3054905">)</span><span class="op" id="3054906">;</span>&nbsp;<span class="ident" id="3054908">i</span><span class="op" id="3054909">++</span>&nbsp;<span class="op" id="3054912">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054917">s</span>&nbsp;<span class="op" id="3054919">+=</span>&nbsp;<span class="ident" id="3054922">printStruct</span><span class="op" id="3054933">(</span><span class="op" id="3054934">&amp;</span><span class="ident" id="3054935">dns</span><span class="op" id="3054938">.</span><span class="ident" id="3054939">question</span><span class="op" id="3054947">[</span><span class="ident" id="3054948">i</span><span class="op" id="3054949">]</span><span class="op" id="3054950">)</span>&nbsp;<span class="op" id="3054952">+</span>&nbsp;<span class="string" id="3054954">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3054964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3054967">if</span>&nbsp;<span class="builtinfunc" id="3054970">len</span><span class="op" id="3054973">(</span><span class="ident" id="3054974">dns</span><span class="op" id="3054977">.</span><span class="ident" id="3054978">answer</span><span class="op" id="3054984">)</span>&nbsp;<span class="op" id="3054986">&gt;</span>&nbsp;<span class="num" id="3054988">0</span>&nbsp;<span class="op" id="3054990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3054994">s</span>&nbsp;<span class="op" id="3054996">+=</span>&nbsp;<span class="string" id="3054999">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055016">for</span>&nbsp;<span class="ident" id="3055020">i</span>&nbsp;<span class="op" id="3055022">:=</span>&nbsp;<span class="num" id="3055025">0</span><span class="op" id="3055026">;</span>&nbsp;<span class="ident" id="3055028">i</span>&nbsp;<span class="op" id="3055030">&lt;</span>&nbsp;<span class="builtinfunc" id="3055032">len</span><span class="op" id="3055035">(</span><span class="ident" id="3055036">dns</span><span class="op" id="3055039">.</span><span class="ident" id="3055040">answer</span><span class="op" id="3055046">)</span><span class="op" id="3055047">;</span>&nbsp;<span class="ident" id="3055049">i</span><span class="op" id="3055050">++</span>&nbsp;<span class="op" id="3055053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055058">s</span>&nbsp;<span class="op" id="3055060">+=</span>&nbsp;<span class="ident" id="3055063">printStruct</span><span class="op" id="3055074">(</span><span class="ident" id="3055075">dns</span><span class="op" id="3055078">.</span><span class="ident" id="3055079">answer</span><span class="op" id="3055085">[</span><span class="ident" id="3055086">i</span><span class="op" id="3055087">]</span><span class="op" id="3055088">)</span>&nbsp;<span class="op" id="3055090">+</span>&nbsp;<span class="string" id="3055092">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3055099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3055102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055105">if</span>&nbsp;<span class="builtinfunc" id="3055108">len</span><span class="op" id="3055111">(</span><span class="ident" id="3055112">dns</span><span class="op" id="3055115">.</span><span class="ident" id="3055116">ns</span><span class="op" id="3055118">)</span>&nbsp;<span class="op" id="3055120">&gt;</span>&nbsp;<span class="num" id="3055122">0</span>&nbsp;<span class="op" id="3055124">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055128">s</span>&nbsp;<span class="op" id="3055130">+=</span>&nbsp;<span class="string" id="3055133">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055155">for</span>&nbsp;<span class="ident" id="3055159">i</span>&nbsp;<span class="op" id="3055161">:=</span>&nbsp;<span class="num" id="3055164">0</span><span class="op" id="3055165">;</span>&nbsp;<span class="ident" id="3055167">i</span>&nbsp;<span class="op" id="3055169">&lt;</span>&nbsp;<span class="builtinfunc" id="3055171">len</span><span class="op" id="3055174">(</span><span class="ident" id="3055175">dns</span><span class="op" id="3055178">.</span><span class="ident" id="3055179">ns</span><span class="op" id="3055181">)</span><span class="op" id="3055182">;</span>&nbsp;<span class="ident" id="3055184">i</span><span class="op" id="3055185">++</span>&nbsp;<span class="op" id="3055188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055193">s</span>&nbsp;<span class="op" id="3055195">+=</span>&nbsp;<span class="ident" id="3055198">printStruct</span><span class="op" id="3055209">(</span><span class="ident" id="3055210">dns</span><span class="op" id="3055213">.</span><span class="ident" id="3055214">ns</span><span class="op" id="3055216">[</span><span class="ident" id="3055217">i</span><span class="op" id="3055218">]</span><span class="op" id="3055219">)</span>&nbsp;<span class="op" id="3055221">+</span>&nbsp;<span class="string" id="3055223">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3055230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3055233">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055236">if</span>&nbsp;<span class="builtinfunc" id="3055239">len</span><span class="op" id="3055242">(</span><span class="ident" id="3055243">dns</span><span class="op" id="3055246">.</span><span class="ident" id="3055247">extra</span><span class="op" id="3055252">)</span>&nbsp;<span class="op" id="3055254">&gt;</span>&nbsp;<span class="num" id="3055256">0</span>&nbsp;<span class="op" id="3055258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055262">s</span>&nbsp;<span class="op" id="3055264">+=</span>&nbsp;<span class="string" id="3055267">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055282">for</span>&nbsp;<span class="ident" id="3055286">i</span>&nbsp;<span class="op" id="3055288">:=</span>&nbsp;<span class="num" id="3055291">0</span><span class="op" id="3055292">;</span>&nbsp;<span class="ident" id="3055294">i</span>&nbsp;<span class="op" id="3055296">&lt;</span>&nbsp;<span class="builtinfunc" id="3055298">len</span><span class="op" id="3055301">(</span><span class="ident" id="3055302">dns</span><span class="op" id="3055305">.</span><span class="ident" id="3055306">extra</span><span class="op" id="3055311">)</span><span class="op" id="3055312">;</span>&nbsp;<span class="ident" id="3055314">i</span><span class="op" id="3055315">++</span>&nbsp;<span class="op" id="3055318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3055323">s</span>&nbsp;<span class="op" id="3055325">+=</span>&nbsp;<span class="ident" id="3055328">printStruct</span><span class="op" id="3055339">(</span><span class="ident" id="3055340">dns</span><span class="op" id="3055343">.</span><span class="ident" id="3055344">extra</span><span class="op" id="3055349">[</span><span class="ident" id="3055350">i</span><span class="op" id="3055351">]</span><span class="op" id="3055352">)</span>&nbsp;<span class="op" id="3055354">+</span>&nbsp;<span class="string" id="3055356">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3055363">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3055366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3055369">return</span>&nbsp;<span class="ident" id="3055376">s</span><br>
<span class="lineno"></span><span class="op" id="3055378">}</span>
</div>
</body>
</html>
