<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4028115">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4028170">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4028224">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4028275">package</span>&nbsp;<span class="ident" id="4028283">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4028288">import</span>&nbsp;<span class="op" id="4028295">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4028298">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4028315">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4028325">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4028328">//&nbsp;The&nbsp;AES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4028360">const</span>&nbsp;<span class="ident" id="4028366">BlockSize</span>&nbsp;<span class="op" id="4028376">=</span>&nbsp;<span class="num" id="4028378">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4028382">//&nbsp;A&nbsp;cipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;AES&nbsp;encryption&nbsp;using&nbsp;a&nbsp;particular&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4028451">type</span>&nbsp;<span class="ident" id="4028456">aesCipher</span>&nbsp;<span class="keyword" id="4028466">struct</span>&nbsp;<span class="op" id="4028473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028476">enc</span>&nbsp;<span class="op" id="4028480">[</span><span class="op" id="4028481">]</span><span class="builtintype" id="4028482">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028490">dec</span>&nbsp;<span class="op" id="4028494">[</span><span class="op" id="4028495">]</span><span class="builtintype" id="4028496">uint32</span><br>
<span class="lineno"></span><span class="op" id="4028503">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4028506">type</span>&nbsp;<span class="ident" id="4028511">KeySizeError</span>&nbsp;<span class="builtintype" id="4028524">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4028529">func</span>&nbsp;<span class="op" id="4028534">(</span><span class="ident" id="4028535">k</span>&nbsp;<span class="ident" id="4028537"><a href="/crypto/aes/cipher.go.html#4028511">KeySizeError</a></span><span class="op" id="4028549">)</span>&nbsp;<span class="ident" id="4028551">Error</span><span class="op" id="4028556">(</span><span class="op" id="4028557">)</span>&nbsp;<span class="builtintype" id="4028559">string</span>&nbsp;<span class="op" id="4028566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028569">return</span>&nbsp;<span class="string" id="4028576">&#34;crypto/aes:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4028608">+</span>&nbsp;<span class="ident" id="4028610"><a href="/crypto/aes/cipher.go.html#4028315">strconv</a></span><span class="op" id="4028617">.</span><span class="ident" id="4028618">Itoa</span><span class="op" id="4028622">(</span><span class="builtintype" id="4028623">int</span><span class="op" id="4028626">(</span><span class="ident" id="4028627"><a href="/crypto/aes/cipher.go.html#4028535">k</a></span><span class="op" id="4028628">)</span><span class="op" id="4028629">)</span><br>
<span class="lineno">25</span><span class="op" id="4028631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4028634">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="comment" id="4028687">//&nbsp;The&nbsp;key&nbsp;argument&nbsp;should&nbsp;be&nbsp;the&nbsp;AES&nbsp;key,</span><br>
<span class="lineno"></span><span class="comment" id="4028730">//&nbsp;either&nbsp;16,&nbsp;24,&nbsp;or&nbsp;32&nbsp;bytes&nbsp;to&nbsp;select</span><br>
<span class="lineno">30</span><span class="comment" id="4028770">//&nbsp;AES-128,&nbsp;AES-192,&nbsp;or&nbsp;AES-256.</span><br>
<span class="lineno"></span><span class="keyword" id="4028803">func</span>&nbsp;<span class="ident" id="4028808">NewCipher</span><span class="op" id="4028817">(</span><span class="ident" id="4028818">key</span>&nbsp;<span class="op" id="4028822">[</span><span class="op" id="4028823">]</span><span class="builtintype" id="4028824">byte</span><span class="op" id="4028828">)</span>&nbsp;<span class="op" id="4028830">(</span><span class="ident" id="4028831"><a href="/crypto/aes/cipher.go.html#4028298">cipher</a></span><span class="op" id="4028837">.</span><span class="ident" id="4028838">Block</span><span class="op" id="4028843">,</span>&nbsp;<span class="builtintype" id="4028845">error</span><span class="op" id="4028850">)</span>&nbsp;<span class="op" id="4028852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028855">k</span>&nbsp;<span class="op" id="4028857">:=</span>&nbsp;<span class="builtinfunc" id="4028860">len</span><span class="op" id="4028863">(</span><span class="ident" id="4028864"><a href="/crypto/aes/cipher.go.html#4028818">key</a></span><span class="op" id="4028867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028870">switch</span>&nbsp;<span class="ident" id="4028877"><a href="/crypto/aes/cipher.go.html#4028855">k</a></span>&nbsp;<span class="op" id="4028879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028882">default</span><span class="op" id="4028889">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028893">return</span>&nbsp;<span class="ident" id="4028900">nil</span><span class="op" id="4028903">,</span>&nbsp;<span class="ident" id="4028905"><a href="/crypto/aes/cipher.go.html#4028511">KeySizeError</a></span><span class="op" id="4028917">(</span><span class="ident" id="4028918"><a href="/crypto/aes/cipher.go.html#4028855">k</a></span><span class="op" id="4028919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028922">case</span>&nbsp;<span class="num" id="4028927">16</span><span class="op" id="4028929">,</span>&nbsp;<span class="num" id="4028931">24</span><span class="op" id="4028933">,</span>&nbsp;<span class="num" id="4028935">32</span><span class="op" id="4028937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4028941">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4028948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028952">n</span>&nbsp;<span class="op" id="4028954">:=</span>&nbsp;<span class="ident" id="4028957"><a href="/crypto/aes/cipher.go.html#4028855">k</a></span>&nbsp;<span class="op" id="4028959">+</span>&nbsp;<span class="num" id="4028961">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028965">c</span>&nbsp;<span class="op" id="4028967">:=</span>&nbsp;<span class="op" id="4028970">&amp;</span><span class="ident" id="4028971"><a href="/crypto/aes/cipher.go.html#4028456">aesCipher</a></span><span class="op" id="4028980">{</span><span class="builtinfunc" id="4028981">make</span><span class="op" id="4028985">(</span><span class="op" id="4028986">[</span><span class="op" id="4028987">]</span><span class="builtintype" id="4028988">uint32</span><span class="op" id="4028994">,</span>&nbsp;<span class="ident" id="4028996"><a href="/crypto/aes/cipher.go.html#4028952">n</a></span><span class="op" id="4028997">)</span><span class="op" id="4028998">,</span>&nbsp;<span class="builtinfunc" id="4029000">make</span><span class="op" id="4029004">(</span><span class="op" id="4029005">[</span><span class="op" id="4029006">]</span><span class="builtintype" id="4029007">uint32</span><span class="op" id="4029013">,</span>&nbsp;<span class="ident" id="4029015"><a href="/crypto/aes/cipher.go.html#4028952">n</a></span><span class="op" id="4029016">)</span><span class="op" id="4029017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029020"><a href="/crypto/aes/cipher_asm.go.html#4030362">expandKey</a></span><span class="op" id="4029029">(</span><span class="ident" id="4029030"><a href="/crypto/aes/cipher.go.html#4028818">key</a></span><span class="op" id="4029033">,</span>&nbsp;<span class="ident" id="4029035"><a href="/crypto/aes/cipher.go.html#4028965">c</a></span><span class="op" id="4029036">.</span><span class="ident" id="4029037">enc</span><span class="op" id="4029040">,</span>&nbsp;<span class="ident" id="4029042"><a href="/crypto/aes/cipher.go.html#4028965">c</a></span><span class="op" id="4029043">.</span><span class="ident" id="4029044">dec</span><span class="op" id="4029047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029050">return</span>&nbsp;<span class="ident" id="4029057"><a href="/crypto/aes/cipher.go.html#4028965">c</a></span><span class="op" id="4029058">,</span>&nbsp;<span class="ident" id="4029060">nil</span><br>
<span class="lineno"></span><span class="op" id="4029064">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="4029067">func</span>&nbsp;<span class="op" id="4029072">(</span><span class="ident" id="4029073">c</span>&nbsp;<span class="op" id="4029075">*</span><span class="ident" id="4029076"><a href="/crypto/aes/cipher.go.html#4028456">aesCipher</a></span><span class="op" id="4029085">)</span>&nbsp;<span class="ident" id="4029087">BlockSize</span><span class="op" id="4029096">(</span><span class="op" id="4029097">)</span>&nbsp;<span class="builtintype" id="4029099">int</span>&nbsp;<span class="op" id="4029103">{</span>&nbsp;<span class="keyword" id="4029105">return</span>&nbsp;<span class="ident" id="4029112"><a href="/crypto/aes/cipher.go.html#4028366">BlockSize</a></span>&nbsp;<span class="op" id="4029122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4029125">func</span>&nbsp;<span class="op" id="4029130">(</span><span class="ident" id="4029131">c</span>&nbsp;<span class="op" id="4029133">*</span><span class="ident" id="4029134"><a href="/crypto/aes/cipher.go.html#4028456">aesCipher</a></span><span class="op" id="4029143">)</span>&nbsp;<span class="ident" id="4029145">Encrypt</span><span class="op" id="4029152">(</span><span class="ident" id="4029153">dst</span><span class="op" id="4029156">,</span>&nbsp;<span class="ident" id="4029158">src</span>&nbsp;<span class="op" id="4029162">[</span><span class="op" id="4029163">]</span><span class="builtintype" id="4029164">byte</span><span class="op" id="4029168">)</span>&nbsp;<span class="op" id="4029170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029173">if</span>&nbsp;<span class="builtinfunc" id="4029176">len</span><span class="op" id="4029179">(</span><span class="ident" id="4029180"><a href="/crypto/aes/cipher.go.html#4029158">src</a></span><span class="op" id="4029183">)</span>&nbsp;<span class="op" id="4029185">&lt;</span>&nbsp;<span class="ident" id="4029187"><a href="/crypto/aes/cipher.go.html#4028366">BlockSize</a></span>&nbsp;<span class="op" id="4029197">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4029201">panic</span><span class="op" id="4029206">(</span><span class="string" id="4029207">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="4029241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029247">if</span>&nbsp;<span class="builtinfunc" id="4029250">len</span><span class="op" id="4029253">(</span><span class="ident" id="4029254"><a href="/crypto/aes/cipher.go.html#4029153">dst</a></span><span class="op" id="4029257">)</span>&nbsp;<span class="op" id="4029259">&lt;</span>&nbsp;<span class="ident" id="4029261"><a href="/crypto/aes/cipher.go.html#4028366">BlockSize</a></span>&nbsp;<span class="op" id="4029271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4029275">panic</span><span class="op" id="4029280">(</span><span class="string" id="4029281">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="4029316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029319">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029322"><a href="/crypto/aes/cipher_asm.go.html#4030028">encryptBlock</a></span><span class="op" id="4029334">(</span><span class="ident" id="4029335"><a href="/crypto/aes/cipher.go.html#4029131">c</a></span><span class="op" id="4029336">.</span><span class="ident" id="4029337">enc</span><span class="op" id="4029340">,</span>&nbsp;<span class="ident" id="4029342"><a href="/crypto/aes/cipher.go.html#4029153">dst</a></span><span class="op" id="4029345">,</span>&nbsp;<span class="ident" id="4029347"><a href="/crypto/aes/cipher.go.html#4029158">src</a></span><span class="op" id="4029350">)</span><br>
<span class="lineno"></span><span class="op" id="4029352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4029355">func</span>&nbsp;<span class="op" id="4029360">(</span><span class="ident" id="4029361">c</span>&nbsp;<span class="op" id="4029363">*</span><span class="ident" id="4029364"><a href="/crypto/aes/cipher.go.html#4028456">aesCipher</a></span><span class="op" id="4029373">)</span>&nbsp;<span class="ident" id="4029375">Decrypt</span><span class="op" id="4029382">(</span><span class="ident" id="4029383">dst</span><span class="op" id="4029386">,</span>&nbsp;<span class="ident" id="4029388">src</span>&nbsp;<span class="op" id="4029392">[</span><span class="op" id="4029393">]</span><span class="builtintype" id="4029394">byte</span><span class="op" id="4029398">)</span>&nbsp;<span class="op" id="4029400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029403">if</span>&nbsp;<span class="builtinfunc" id="4029406">len</span><span class="op" id="4029409">(</span><span class="ident" id="4029410"><a href="/crypto/aes/cipher.go.html#4029388">src</a></span><span class="op" id="4029413">)</span>&nbsp;<span class="op" id="4029415">&lt;</span>&nbsp;<span class="ident" id="4029417"><a href="/crypto/aes/cipher.go.html#4028366">BlockSize</a></span>&nbsp;<span class="op" id="4029427">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4029431">panic</span><span class="op" id="4029436">(</span><span class="string" id="4029437">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="4029471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029477">if</span>&nbsp;<span class="builtinfunc" id="4029480">len</span><span class="op" id="4029483">(</span><span class="ident" id="4029484"><a href="/crypto/aes/cipher.go.html#4029383">dst</a></span><span class="op" id="4029487">)</span>&nbsp;<span class="op" id="4029489">&lt;</span>&nbsp;<span class="ident" id="4029491"><a href="/crypto/aes/cipher.go.html#4028366">BlockSize</a></span>&nbsp;<span class="op" id="4029501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4029505">panic</span><span class="op" id="4029510">(</span><span class="string" id="4029511">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="4029546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029549">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029552"><a href="/crypto/aes/cipher_asm.go.html#4030195">decryptBlock</a></span><span class="op" id="4029564">(</span><span class="ident" id="4029565"><a href="/crypto/aes/cipher.go.html#4029361">c</a></span><span class="op" id="4029566">.</span><span class="ident" id="4029567">dec</span><span class="op" id="4029570">,</span>&nbsp;<span class="ident" id="4029572"><a href="/crypto/aes/cipher.go.html#4029383">dst</a></span><span class="op" id="4029575">,</span>&nbsp;<span class="ident" id="4029577"><a href="/crypto/aes/cipher.go.html#4029388">src</a></span><span class="op" id="4029580">)</span><br>
<span class="lineno"></span><span class="op" id="4029582">}</span>
</div>
</body>
</html>
