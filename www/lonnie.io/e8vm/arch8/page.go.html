<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5304515">package</span>&nbsp;<span class="ident" id="5304523">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5304530">import</span>&nbsp;<span class="op" id="5304537">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5304540">&#34;encoding/binary&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5304558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304561">//&nbsp;PageSize&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;a&nbsp;page&nbsp;contains.</span><br>
<span class="lineno"></span><span class="keyword" id="5304613">const</span>&nbsp;<span class="ident" id="5304619">PageSize</span>&nbsp;<span class="op" id="5304628">=</span>&nbsp;<span class="num" id="5304630">4096</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="5304636">//&nbsp;Page&nbsp;is&nbsp;a&nbsp;memory&nbsp;addressable&nbsp;area&nbsp;of&nbsp;PageSize&nbsp;bytes</span><br>
<span class="lineno"></span><span class="keyword" id="5304691">type</span>&nbsp;<span class="ident" id="5304696">page</span>&nbsp;<span class="keyword" id="5304701">struct</span>&nbsp;<span class="op" id="5304708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304711">Bytes</span>&nbsp;<span class="op" id="5304717">[</span><span class="op" id="5304718">]</span><span class="builtintype" id="5304719">byte</span><br>
<span class="lineno"></span><span class="op" id="5304724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5304727">//&nbsp;NewPage&nbsp;creates&nbsp;a&nbsp;new&nbsp;empty&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="5304764">func</span>&nbsp;<span class="ident" id="5304769">newPage</span><span class="op" id="5304776">(</span><span class="op" id="5304777">)</span>&nbsp;<span class="op" id="5304779">*</span><span class="ident" id="5304780"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304696">page</a></span>&nbsp;<span class="op" id="5304785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304788">return</span>&nbsp;<span class="op" id="5304795">&amp;</span><span class="ident" id="5304796"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304696">page</a></span><span class="op" id="5304800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5304804">Bytes</span><span class="op" id="5304809">:</span>&nbsp;<span class="builtinfunc" id="5304811">make</span><span class="op" id="5304815">(</span><span class="op" id="5304816">[</span><span class="op" id="5304817">]</span><span class="builtintype" id="5304818">byte</span><span class="op" id="5304822">,</span>&nbsp;<span class="ident" id="5304824"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><span class="op" id="5304832">)</span><span class="op" id="5304833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5304836">}</span><br>
<span class="lineno">20</span><span class="op" id="5304838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5304841">//&nbsp;ReadByte&nbsp;reads&nbsp;a&nbsp;byte&nbsp;at&nbsp;the&nbsp;particular&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="5304892">//&nbsp;When&nbsp;offset&nbsp;is&nbsp;larger&nbsp;than&nbsp;offset,&nbsp;it&nbsp;uses&nbsp;the&nbsp;modular.</span><br>
<span class="lineno"></span><span class="keyword" id="5304951">func</span>&nbsp;<span class="op" id="5304956">(</span><span class="ident" id="5304957">p</span>&nbsp;<span class="op" id="5304959">*</span><span class="ident" id="5304960"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304696">page</a></span><span class="op" id="5304964">)</span>&nbsp;<span class="ident" id="5304966">ReadByte</span><span class="op" id="5304974">(</span><span class="ident" id="5304975">offset</span>&nbsp;<span class="builtintype" id="5304982">uint32</span><span class="op" id="5304988">)</span>&nbsp;<span class="builtintype" id="5304990">byte</span>&nbsp;<span class="op" id="5304995">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5304998">return</span>&nbsp;<span class="ident" id="5305005"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304957">p</a></span><span class="op" id="5305006">.</span><span class="ident" id="5305007">Bytes</span><span class="op" id="5305012">[</span><span class="ident" id="5305013"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304975">offset</a></span><span class="op" id="5305019">%</span><span class="ident" id="5305020"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><span class="op" id="5305028">]</span><br>
<span class="lineno"></span><span class="op" id="5305030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305033">//&nbsp;WriteByte&nbsp;writes&nbsp;a&nbsp;byte&nbsp;into&nbsp;the&nbsp;page&nbsp;at&nbsp;a&nbsp;particular&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="5305098">//&nbsp;When&nbsp;offset&nbsp;is&nbsp;larger&nbsp;than&nbsp;offset,&nbsp;it&nbsp;uses&nbsp;the&nbsp;modular.</span><br>
<span class="lineno">30</span><span class="keyword" id="5305157">func</span>&nbsp;<span class="op" id="5305162">(</span><span class="ident" id="5305163">p</span>&nbsp;<span class="op" id="5305165">*</span><span class="ident" id="5305166"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304696">page</a></span><span class="op" id="5305170">)</span>&nbsp;<span class="ident" id="5305172">WriteByte</span><span class="op" id="5305181">(</span><span class="ident" id="5305182">offset</span>&nbsp;<span class="builtintype" id="5305189">uint32</span><span class="op" id="5305195">,</span>&nbsp;<span class="ident" id="5305197">b</span>&nbsp;<span class="builtintype" id="5305199">byte</span><span class="op" id="5305203">)</span>&nbsp;<span class="op" id="5305205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305208"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305163">p</a></span><span class="op" id="5305209">.</span><span class="ident" id="5305210">Bytes</span><span class="op" id="5305215">[</span><span class="ident" id="5305216"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305182">offset</a></span><span class="op" id="5305222">%</span><span class="ident" id="5305223"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><span class="op" id="5305231">]</span>&nbsp;<span class="op" id="5305233">=</span>&nbsp;<span class="ident" id="5305235"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305197">b</a></span><br>
<span class="lineno"></span><span class="op" id="5305237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305240">//&nbsp;The&nbsp;machines&nbsp;endian.</span><br>
<span class="lineno">35</span><span class="keyword" id="5305264">var</span>&nbsp;<span class="ident" id="5305268">Endian</span>&nbsp;<span class="op" id="5305275">=</span>&nbsp;<span class="ident" id="5305277"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304540">binary</a></span><span class="op" id="5305283">.</span><span class="ident" id="5305284">LittleEndian</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5305298">func</span>&nbsp;<span class="ident" id="5305303">wordOff</span><span class="op" id="5305310">(</span><span class="ident" id="5305311">offset</span>&nbsp;<span class="builtintype" id="5305318">uint32</span><span class="op" id="5305324">)</span>&nbsp;<span class="builtintype" id="5305326">uint32</span>&nbsp;<span class="op" id="5305333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305336">return</span>&nbsp;<span class="op" id="5305343">(</span><span class="ident" id="5305344"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305311">offset</a></span>&nbsp;<span class="op" id="5305351">%</span>&nbsp;<span class="ident" id="5305353"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304619">PageSize</a></span><span class="op" id="5305361">)</span>&nbsp;<span class="op" id="5305363">&amp;</span>&nbsp;<span class="op" id="5305365">^</span><span class="builtintype" id="5305366">uint32</span><span class="op" id="5305372">(</span><span class="num" id="5305373">0x3</span><span class="op" id="5305376">)</span><br>
<span class="lineno"></span><span class="op" id="5305378">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="5305381">//&nbsp;ReadWord&nbsp;reads&nbsp;the&nbsp;word&nbsp;at&nbsp;the&nbsp;particular&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="5305434">//&nbsp;When&nbsp;offset&nbsp;is&nbsp;larger&nbsp;than&nbsp;offset,&nbsp;it&nbsp;uses&nbsp;the&nbsp;modular.</span><br>
<span class="lineno"></span><span class="comment" id="5305493">//&nbsp;When&nbsp;offset&nbsp;is&nbsp;not&nbsp;4-byte&nbsp;aligned,&nbsp;it&nbsp;aligns&nbsp;down.</span><br>
<span class="lineno"></span><span class="keyword" id="5305547">func</span>&nbsp;<span class="op" id="5305552">(</span><span class="ident" id="5305553">p</span>&nbsp;<span class="op" id="5305555">*</span><span class="ident" id="5305556"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304696">page</a></span><span class="op" id="5305560">)</span>&nbsp;<span class="ident" id="5305562">ReadWord</span><span class="op" id="5305570">(</span><span class="ident" id="5305571">offset</span>&nbsp;<span class="builtintype" id="5305578">uint32</span><span class="op" id="5305584">)</span>&nbsp;<span class="builtintype" id="5305586">uint32</span>&nbsp;<span class="op" id="5305593">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305596"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305571">offset</a></span>&nbsp;<span class="op" id="5305603">=</span>&nbsp;<span class="ident" id="5305605"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305303">wordOff</a></span><span class="op" id="5305612">(</span><span class="ident" id="5305613"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305571">offset</a></span><span class="op" id="5305619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5305622">return</span>&nbsp;<span class="ident" id="5305629"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305268">Endian</a></span><span class="op" id="5305635">.</span><span class="ident" id="5305636">Uint32</span><span class="op" id="5305642">(</span><span class="ident" id="5305643"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305553">p</a></span><span class="op" id="5305644">.</span><span class="ident" id="5305645">Bytes</span><span class="op" id="5305650">[</span><span class="ident" id="5305651"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305571">offset</a></span>&nbsp;<span class="op" id="5305658">:</span>&nbsp;<span class="ident" id="5305660"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305571">offset</a></span><span class="op" id="5305666">+</span><span class="num" id="5305667">4</span><span class="op" id="5305668">]</span><span class="op" id="5305669">)</span><br>
<span class="lineno"></span><span class="op" id="5305671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5305674">//&nbsp;WriteWord&nbsp;writes&nbsp;the&nbsp;word&nbsp;at&nbsp;the&nbsp;particular&nbsp;offset.</span><br>
<span class="lineno">50</span><span class="comment" id="5305729">//&nbsp;When&nbsp;offset&nbsp;is&nbsp;larger&nbsp;than&nbsp;offset,&nbsp;it&nbsp;uses&nbsp;the&nbsp;modular.</span><br>
<span class="lineno"></span><span class="comment" id="5305788">//&nbsp;When&nbsp;offset&nbsp;is&nbsp;not&nbsp;4-byte&nbsp;aligned,&nbsp;it&nbsp;aligns&nbsp;down.</span><br>
<span class="lineno"></span><span class="keyword" id="5305842">func</span>&nbsp;<span class="op" id="5305847">(</span><span class="ident" id="5305848">p</span>&nbsp;<span class="op" id="5305850">*</span><span class="ident" id="5305851"><a href="/lonnie.io/e8vm/arch8/page.go.html#5304696">page</a></span><span class="op" id="5305855">)</span>&nbsp;<span class="ident" id="5305857">WriteWord</span><span class="op" id="5305866">(</span><span class="ident" id="5305867">offset</span>&nbsp;<span class="builtintype" id="5305874">uint32</span><span class="op" id="5305880">,</span>&nbsp;<span class="ident" id="5305882">w</span>&nbsp;<span class="builtintype" id="5305884">uint32</span><span class="op" id="5305890">)</span>&nbsp;<span class="op" id="5305892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305895"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305867">offset</a></span>&nbsp;<span class="op" id="5305902">=</span>&nbsp;<span class="ident" id="5305904"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305303">wordOff</a></span><span class="op" id="5305911">(</span><span class="ident" id="5305912"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305867">offset</a></span><span class="op" id="5305918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5305921"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305268">Endian</a></span><span class="op" id="5305927">.</span><span class="ident" id="5305928">PutUint32</span><span class="op" id="5305937">(</span><span class="ident" id="5305938"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305848">p</a></span><span class="op" id="5305939">.</span><span class="ident" id="5305940">Bytes</span><span class="op" id="5305945">[</span><span class="ident" id="5305946"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305867">offset</a></span><span class="op" id="5305952">:</span><span class="ident" id="5305953"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305867">offset</a></span><span class="op" id="5305959">+</span><span class="num" id="5305960">4</span><span class="op" id="5305961">]</span><span class="op" id="5305962">,</span>&nbsp;<span class="ident" id="5305964"><a href="/lonnie.io/e8vm/arch8/page.go.html#5305882">w</a></span><span class="op" id="5305965">)</span><br>
<span class="lineno">55</span><span class="op" id="5305967">}</span>
</div>
</body>
</html>
