<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html" class="current">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2197084">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2197139">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2197193">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2197244">package</span>&nbsp;<span class="ident" id="2197252">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2197258">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2197308">//</span><br>
<span class="lineno"></span><span class="comment" id="2197311">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2197333">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2197353">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2197371">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2197415">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2197452">func</span>&nbsp;<span class="ident" id="2197457">Exp</span><span class="op" id="2197460">(</span><span class="ident" id="2197461">x</span>&nbsp;<span class="builtintype" id="2197463">float64</span><span class="op" id="2197470">)</span>&nbsp;<span class="builtintype" id="2197472">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2197481">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2197541">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2197599">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2197658">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2197688">//</span><br>
<span class="lineno"></span><span class="comment" id="2197691">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2197747">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2197816">//</span><br>
<span class="lineno"></span><span class="comment" id="2197819">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2197875">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2197932">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2197949">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2198005">//</span><br>
<span class="lineno"></span><span class="comment" id="2198008">//</span><br>
<span class="lineno">30</span><span class="comment" id="2198011">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2198021">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2198054">//</span><br>
<span class="lineno"></span><span class="comment" id="2198057">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2198067">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2198095">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2198154">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2198202">//</span><br>
<span class="lineno"></span><span class="comment" id="2198205">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2198254">//</span><br>
<span class="lineno">40</span><span class="comment" id="2198257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2198316">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2198334">//</span><br>
<span class="lineno"></span><span class="comment" id="2198337">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2198403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2198437">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2198451">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2198526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2198594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2198663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2198729">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2198750">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2198820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2198887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2198899">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2198951">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2199000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2199044">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2199091">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2199126">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2199163">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2199199">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2199242">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2199309">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2199353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2199367">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2199425">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2199486">//</span><br>
<span class="lineno"></span><span class="comment" id="2199489">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2199526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2199555">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2199589">//</span><br>
<span class="lineno"></span><span class="comment" id="2199592">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2199610">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2199652">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2199680">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2199733">//</span><br>
<span class="lineno"></span><span class="comment" id="2199736">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2199749">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2199819">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2199859">//</span><br>
<span class="lineno"></span><span class="comment" id="2199862">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2199877">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2199901">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2199969">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2200038">//</span><br>
<span class="lineno"></span><span class="comment" id="2200041">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2200055">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2200121">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2200185">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2200251">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2200296">func</span>&nbsp;<span class="ident" id="2200301">exp</span><span class="op" id="2200304">(</span><span class="ident" id="2200305">x</span>&nbsp;<span class="builtintype" id="2200307">float64</span><span class="op" id="2200314">)</span>&nbsp;<span class="builtintype" id="2200316">float64</span>&nbsp;<span class="op" id="2200324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200327">const</span>&nbsp;<span class="op" id="2200333">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200337">Ln2Hi</span>&nbsp;<span class="op" id="2200343">=</span>&nbsp;<span class="num" id="2200345">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200374">Ln2Lo</span>&nbsp;<span class="op" id="2200380">=</span>&nbsp;<span class="num" id="2200382">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200411">Log2e</span>&nbsp;<span class="op" id="2200417">=</span>&nbsp;<span class="num" id="2200419">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200449">Overflow</span>&nbsp;&nbsp;<span class="op" id="2200459">=</span>&nbsp;<span class="num" id="2200461">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200490">Underflow</span>&nbsp;<span class="op" id="2200500">=</span>&nbsp;<span class="op" id="2200502">-</span><span class="num" id="2200503">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200532">NearZero</span>&nbsp;&nbsp;<span class="op" id="2200542">=</span>&nbsp;<span class="num" id="2200544">1.0</span>&nbsp;<span class="op" id="2200548">/</span>&nbsp;<span class="op" id="2200550">(</span><span class="num" id="2200551">1</span>&nbsp;<span class="op" id="2200553">&lt;&lt;</span>&nbsp;<span class="num" id="2200556">28</span><span class="op" id="2200558">)</span>&nbsp;<span class="comment" id="2200560">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2200575">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200593">switch</span>&nbsp;<span class="op" id="2200600">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200603">case</span>&nbsp;<span class="ident" id="2200608">IsNaN</span><span class="op" id="2200613">(</span><span class="ident" id="2200614">x</span><span class="op" id="2200615">)</span>&nbsp;<span class="op" id="2200617">||</span>&nbsp;<span class="ident" id="2200620">IsInf</span><span class="op" id="2200625">(</span><span class="ident" id="2200626">x</span><span class="op" id="2200627">,</span>&nbsp;<span class="num" id="2200629">1</span><span class="op" id="2200630">)</span><span class="op" id="2200631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200635">return</span>&nbsp;<span class="ident" id="2200642">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200645">case</span>&nbsp;<span class="ident" id="2200650">IsInf</span><span class="op" id="2200655">(</span><span class="ident" id="2200656">x</span><span class="op" id="2200657">,</span>&nbsp;<span class="op" id="2200659">-</span><span class="num" id="2200660">1</span><span class="op" id="2200661">)</span><span class="op" id="2200662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200666">return</span>&nbsp;<span class="num" id="2200673">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200676">case</span>&nbsp;<span class="ident" id="2200681">x</span>&nbsp;<span class="op" id="2200683">&gt;</span>&nbsp;<span class="ident" id="2200685">Overflow</span><span class="op" id="2200693">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200697">return</span>&nbsp;<span class="ident" id="2200704">Inf</span><span class="op" id="2200707">(</span><span class="num" id="2200708">1</span><span class="op" id="2200709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200712">case</span>&nbsp;<span class="ident" id="2200717">x</span>&nbsp;<span class="op" id="2200719">&lt;</span>&nbsp;<span class="ident" id="2200721">Underflow</span><span class="op" id="2200730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200734">return</span>&nbsp;<span class="num" id="2200741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200744">case</span>&nbsp;<span class="op" id="2200749">-</span><span class="ident" id="2200750">NearZero</span>&nbsp;<span class="op" id="2200759">&lt;</span>&nbsp;<span class="ident" id="2200761">x</span>&nbsp;<span class="op" id="2200763">&amp;&amp;</span>&nbsp;<span class="ident" id="2200766">x</span>&nbsp;<span class="op" id="2200768">&lt;</span>&nbsp;<span class="ident" id="2200770">NearZero</span><span class="op" id="2200778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200782">return</span>&nbsp;<span class="num" id="2200789">1</span>&nbsp;<span class="op" id="2200791">+</span>&nbsp;<span class="ident" id="2200793">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2200800">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200857">var</span>&nbsp;<span class="ident" id="2200861">k</span>&nbsp;<span class="builtintype" id="2200863">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200868">switch</span>&nbsp;<span class="op" id="2200875">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200878">case</span>&nbsp;<span class="ident" id="2200883">x</span>&nbsp;<span class="op" id="2200885">&lt;</span>&nbsp;<span class="num" id="2200887">0</span><span class="op" id="2200888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200892">k</span>&nbsp;<span class="op" id="2200894">=</span>&nbsp;<span class="builtintype" id="2200896">int</span><span class="op" id="2200899">(</span><span class="ident" id="2200900">Log2e</span><span class="op" id="2200905">*</span><span class="ident" id="2200906">x</span>&nbsp;<span class="op" id="2200908">-</span>&nbsp;<span class="num" id="2200910">0.5</span><span class="op" id="2200913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2200916">case</span>&nbsp;<span class="ident" id="2200921">x</span>&nbsp;<span class="op" id="2200923">&gt;</span>&nbsp;<span class="num" id="2200925">0</span><span class="op" id="2200926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200930">k</span>&nbsp;<span class="op" id="2200932">=</span>&nbsp;<span class="builtintype" id="2200934">int</span><span class="op" id="2200937">(</span><span class="ident" id="2200938">Log2e</span><span class="op" id="2200943">*</span><span class="ident" id="2200944">x</span>&nbsp;<span class="op" id="2200946">+</span>&nbsp;<span class="num" id="2200948">0.5</span><span class="op" id="2200951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200954">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200957">hi</span>&nbsp;<span class="op" id="2200960">:=</span>&nbsp;<span class="ident" id="2200963">x</span>&nbsp;<span class="op" id="2200965">-</span>&nbsp;<span class="builtintype" id="2200967">float64</span><span class="op" id="2200974">(</span><span class="ident" id="2200975">k</span><span class="op" id="2200976">)</span><span class="op" id="2200977">*</span><span class="ident" id="2200978">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200985">lo</span>&nbsp;<span class="op" id="2200988">:=</span>&nbsp;<span class="builtintype" id="2200991">float64</span><span class="op" id="2200998">(</span><span class="ident" id="2200999">k</span><span class="op" id="2201000">)</span>&nbsp;<span class="op" id="2201002">*</span>&nbsp;<span class="ident" id="2201004">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201012">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201024">return</span>&nbsp;<span class="ident" id="2201031">expmulti</span><span class="op" id="2201039">(</span><span class="ident" id="2201040">hi</span><span class="op" id="2201042">,</span>&nbsp;<span class="ident" id="2201044">lo</span><span class="op" id="2201046">,</span>&nbsp;<span class="ident" id="2201048">k</span><span class="op" id="2201049">)</span><br>
<span class="lineno">130</span><span class="op" id="2201051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2201054">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2201105">//</span><br>
<span class="lineno"></span><span class="comment" id="2201108">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2201146">func</span>&nbsp;<span class="ident" id="2201151">Exp2</span><span class="op" id="2201155">(</span><span class="ident" id="2201156">x</span>&nbsp;<span class="builtintype" id="2201158">float64</span><span class="op" id="2201165">)</span>&nbsp;<span class="builtintype" id="2201167">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2201176">func</span>&nbsp;<span class="ident" id="2201181">exp2</span><span class="op" id="2201185">(</span><span class="ident" id="2201186">x</span>&nbsp;<span class="builtintype" id="2201188">float64</span><span class="op" id="2201195">)</span>&nbsp;<span class="builtintype" id="2201197">float64</span>&nbsp;<span class="op" id="2201205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201208">const</span>&nbsp;<span class="op" id="2201214">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201218">Ln2Hi</span>&nbsp;<span class="op" id="2201224">=</span>&nbsp;<span class="num" id="2201226">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201255">Ln2Lo</span>&nbsp;<span class="op" id="2201261">=</span>&nbsp;<span class="num" id="2201263">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201293">Overflow</span>&nbsp;&nbsp;<span class="op" id="2201303">=</span>&nbsp;<span class="num" id="2201305">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201330">Underflow</span>&nbsp;<span class="op" id="2201340">=</span>&nbsp;<span class="op" id="2201342">-</span><span class="num" id="2201343">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2201355">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201359">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201377">switch</span>&nbsp;<span class="op" id="2201384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201387">case</span>&nbsp;<span class="ident" id="2201392">IsNaN</span><span class="op" id="2201397">(</span><span class="ident" id="2201398">x</span><span class="op" id="2201399">)</span>&nbsp;<span class="op" id="2201401">||</span>&nbsp;<span class="ident" id="2201404">IsInf</span><span class="op" id="2201409">(</span><span class="ident" id="2201410">x</span><span class="op" id="2201411">,</span>&nbsp;<span class="num" id="2201413">1</span><span class="op" id="2201414">)</span><span class="op" id="2201415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201419">return</span>&nbsp;<span class="ident" id="2201426">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201429">case</span>&nbsp;<span class="ident" id="2201434">IsInf</span><span class="op" id="2201439">(</span><span class="ident" id="2201440">x</span><span class="op" id="2201441">,</span>&nbsp;<span class="op" id="2201443">-</span><span class="num" id="2201444">1</span><span class="op" id="2201445">)</span><span class="op" id="2201446">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201450">return</span>&nbsp;<span class="num" id="2201457">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201460">case</span>&nbsp;<span class="ident" id="2201465">x</span>&nbsp;<span class="op" id="2201467">&gt;</span>&nbsp;<span class="ident" id="2201469">Overflow</span><span class="op" id="2201477">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201481">return</span>&nbsp;<span class="ident" id="2201488">Inf</span><span class="op" id="2201491">(</span><span class="num" id="2201492">1</span><span class="op" id="2201493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201496">case</span>&nbsp;<span class="ident" id="2201501">x</span>&nbsp;<span class="op" id="2201503">&lt;</span>&nbsp;<span class="ident" id="2201505">Underflow</span><span class="op" id="2201514">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201518">return</span>&nbsp;<span class="num" id="2201525">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2201528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201532">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201595">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201644">var</span>&nbsp;<span class="ident" id="2201648">k</span>&nbsp;<span class="builtintype" id="2201650">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201655">switch</span>&nbsp;<span class="op" id="2201662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201665">case</span>&nbsp;<span class="ident" id="2201670">x</span>&nbsp;<span class="op" id="2201672">&gt;</span>&nbsp;<span class="num" id="2201674">0</span><span class="op" id="2201675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201679">k</span>&nbsp;<span class="op" id="2201681">=</span>&nbsp;<span class="builtintype" id="2201683">int</span><span class="op" id="2201686">(</span><span class="ident" id="2201687">x</span>&nbsp;<span class="op" id="2201689">+</span>&nbsp;<span class="num" id="2201691">0.5</span><span class="op" id="2201694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201697">case</span>&nbsp;<span class="ident" id="2201702">x</span>&nbsp;<span class="op" id="2201704">&lt;</span>&nbsp;<span class="num" id="2201706">0</span><span class="op" id="2201707">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201711">k</span>&nbsp;<span class="op" id="2201713">=</span>&nbsp;<span class="builtintype" id="2201715">int</span><span class="op" id="2201718">(</span><span class="ident" id="2201719">x</span>&nbsp;<span class="op" id="2201721">-</span>&nbsp;<span class="num" id="2201723">0.5</span><span class="op" id="2201726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2201729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201732">t</span>&nbsp;<span class="op" id="2201734">:=</span>&nbsp;<span class="ident" id="2201737">x</span>&nbsp;<span class="op" id="2201739">-</span>&nbsp;<span class="builtintype" id="2201741">float64</span><span class="op" id="2201748">(</span><span class="ident" id="2201749">k</span><span class="op" id="2201750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201753">hi</span>&nbsp;<span class="op" id="2201756">:=</span>&nbsp;<span class="ident" id="2201759">t</span>&nbsp;<span class="op" id="2201761">*</span>&nbsp;<span class="ident" id="2201763">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201770">lo</span>&nbsp;<span class="op" id="2201773">:=</span>&nbsp;<span class="op" id="2201776">-</span><span class="ident" id="2201777">t</span>&nbsp;<span class="op" id="2201779">*</span>&nbsp;<span class="ident" id="2201781">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201789">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201801">return</span>&nbsp;<span class="ident" id="2201808">expmulti</span><span class="op" id="2201816">(</span><span class="ident" id="2201817">hi</span><span class="op" id="2201819">,</span>&nbsp;<span class="ident" id="2201821">lo</span><span class="op" id="2201823">,</span>&nbsp;<span class="ident" id="2201825">k</span><span class="op" id="2201826">)</span><br>
<span class="lineno"></span><span class="op" id="2201828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2201831">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2201899">func</span>&nbsp;<span class="ident" id="2201904">expmulti</span><span class="op" id="2201912">(</span><span class="ident" id="2201913">hi</span><span class="op" id="2201915">,</span>&nbsp;<span class="ident" id="2201917">lo</span>&nbsp;<span class="builtintype" id="2201920">float64</span><span class="op" id="2201927">,</span>&nbsp;<span class="ident" id="2201929">k</span>&nbsp;<span class="builtintype" id="2201931">int</span><span class="op" id="2201934">)</span>&nbsp;<span class="builtintype" id="2201936">float64</span>&nbsp;<span class="op" id="2201944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2201947">const</span>&nbsp;<span class="op" id="2201953">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201957">P1</span>&nbsp;<span class="op" id="2201960">=</span>&nbsp;<span class="num" id="2201962">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2201990">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202021">P2</span>&nbsp;<span class="op" id="2202024">=</span>&nbsp;<span class="op" id="2202026">-</span><span class="num" id="2202027">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2202054">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202085">P3</span>&nbsp;<span class="op" id="2202088">=</span>&nbsp;<span class="num" id="2202090">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2202118">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202149">P4</span>&nbsp;<span class="op" id="2202152">=</span>&nbsp;<span class="op" id="2202154">-</span><span class="num" id="2202155">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2202182">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202213">P5</span>&nbsp;<span class="op" id="2202216">=</span>&nbsp;<span class="num" id="2202218">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2202246">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2202276">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202280">r</span>&nbsp;<span class="op" id="2202282">:=</span>&nbsp;<span class="ident" id="2202285">hi</span>&nbsp;<span class="op" id="2202288">-</span>&nbsp;<span class="ident" id="2202290">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202294">t</span>&nbsp;<span class="op" id="2202296">:=</span>&nbsp;<span class="ident" id="2202299">r</span>&nbsp;<span class="op" id="2202301">*</span>&nbsp;<span class="ident" id="2202303">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202306">c</span>&nbsp;<span class="op" id="2202308">:=</span>&nbsp;<span class="ident" id="2202311">r</span>&nbsp;<span class="op" id="2202313">-</span>&nbsp;<span class="ident" id="2202315">t</span><span class="op" id="2202316">*</span><span class="op" id="2202317">(</span><span class="ident" id="2202318">P1</span><span class="op" id="2202320">+</span><span class="ident" id="2202321">t</span><span class="op" id="2202322">*</span><span class="op" id="2202323">(</span><span class="ident" id="2202324">P2</span><span class="op" id="2202326">+</span><span class="ident" id="2202327">t</span><span class="op" id="2202328">*</span><span class="op" id="2202329">(</span><span class="ident" id="2202330">P3</span><span class="op" id="2202332">+</span><span class="ident" id="2202333">t</span><span class="op" id="2202334">*</span><span class="op" id="2202335">(</span><span class="ident" id="2202336">P4</span><span class="op" id="2202338">+</span><span class="ident" id="2202339">t</span><span class="op" id="2202340">*</span><span class="ident" id="2202341">P5</span><span class="op" id="2202343">)</span><span class="op" id="2202344">)</span><span class="op" id="2202345">)</span><span class="op" id="2202346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202349">y</span>&nbsp;<span class="op" id="2202351">:=</span>&nbsp;<span class="num" id="2202354">1</span>&nbsp;<span class="op" id="2202356">-</span>&nbsp;<span class="op" id="2202358">(</span><span class="op" id="2202359">(</span><span class="ident" id="2202360">lo</span>&nbsp;<span class="op" id="2202363">-</span>&nbsp;<span class="op" id="2202365">(</span><span class="ident" id="2202366">r</span><span class="op" id="2202367">*</span><span class="ident" id="2202368">c</span><span class="op" id="2202369">)</span><span class="op" id="2202370">/</span><span class="op" id="2202371">(</span><span class="num" id="2202372">2</span><span class="op" id="2202373">-</span><span class="ident" id="2202374">c</span><span class="op" id="2202375">)</span><span class="op" id="2202376">)</span>&nbsp;<span class="op" id="2202378">-</span>&nbsp;<span class="ident" id="2202380">hi</span><span class="op" id="2202382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2202385">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2202438">return</span>&nbsp;<span class="ident" id="2202445">Ldexp</span><span class="op" id="2202450">(</span><span class="ident" id="2202451">y</span><span class="op" id="2202452">,</span>&nbsp;<span class="ident" id="2202454">k</span><span class="op" id="2202455">)</span><br>
<span class="lineno"></span><span class="op" id="2202457">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
