<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2354509">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2354564">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2354618">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2354669">package</span>&nbsp;<span class="ident" id="2354677">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2354681">import</span>&nbsp;<span class="op" id="2354688">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2354691">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2354702">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2354709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2354712">func</span>&nbsp;<span class="ident" id="2354717">sameFile</span><span class="op" id="2354725">(</span><span class="ident" id="2354726">fs1</span><span class="op" id="2354729">,</span>&nbsp;<span class="ident" id="2354731">fs2</span>&nbsp;<span class="op" id="2354735">*</span><span class="ident" id="2354736">fileStat</span><span class="op" id="2354744">)</span>&nbsp;<span class="builtintype" id="2354746">bool</span>&nbsp;<span class="op" id="2354751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354754">stat1</span>&nbsp;<span class="op" id="2354760">:=</span>&nbsp;<span class="ident" id="2354763">fs1</span><span class="op" id="2354766">.</span><span class="ident" id="2354767">sys</span><span class="op" id="2354770">.</span><span class="op" id="2354771">(</span><span class="op" id="2354772">*</span><span class="ident" id="2354773">syscall</span><span class="op" id="2354780">.</span><span class="ident" id="2354781">Stat_t</span><span class="op" id="2354787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354790">stat2</span>&nbsp;<span class="op" id="2354796">:=</span>&nbsp;<span class="ident" id="2354799">fs2</span><span class="op" id="2354802">.</span><span class="ident" id="2354803">sys</span><span class="op" id="2354806">.</span><span class="op" id="2354807">(</span><span class="op" id="2354808">*</span><span class="ident" id="2354809">syscall</span><span class="op" id="2354816">.</span><span class="ident" id="2354817">Stat_t</span><span class="op" id="2354823">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354826">return</span>&nbsp;<span class="ident" id="2354833">stat1</span><span class="op" id="2354838">.</span><span class="ident" id="2354839">Dev</span>&nbsp;<span class="op" id="2354843">==</span>&nbsp;<span class="ident" id="2354846">stat2</span><span class="op" id="2354851">.</span><span class="ident" id="2354852">Dev</span>&nbsp;<span class="op" id="2354856">&amp;&amp;</span>&nbsp;<span class="ident" id="2354859">stat1</span><span class="op" id="2354864">.</span><span class="ident" id="2354865">Ino</span>&nbsp;<span class="op" id="2354869">==</span>&nbsp;<span class="ident" id="2354872">stat2</span><span class="op" id="2354877">.</span><span class="ident" id="2354878">Ino</span><br>
<span class="lineno"></span><span class="op" id="2354882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2354885">func</span>&nbsp;<span class="ident" id="2354890">fileInfoFromStat</span><span class="op" id="2354906">(</span><span class="ident" id="2354907">st</span>&nbsp;<span class="op" id="2354910">*</span><span class="ident" id="2354911">syscall</span><span class="op" id="2354918">.</span><span class="ident" id="2354919">Stat_t</span><span class="op" id="2354925">,</span>&nbsp;<span class="ident" id="2354927">name</span>&nbsp;<span class="builtintype" id="2354932">string</span><span class="op" id="2354938">)</span>&nbsp;<span class="ident" id="2354940">FileInfo</span>&nbsp;<span class="op" id="2354949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354952">fs</span>&nbsp;<span class="op" id="2354955">:=</span>&nbsp;<span class="op" id="2354958">&amp;</span><span class="ident" id="2354959">fileStat</span><span class="op" id="2354967">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354971">name</span><span class="op" id="2354975">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2354980">basename</span><span class="op" id="2354988">(</span><span class="ident" id="2354989">name</span><span class="op" id="2354993">)</span><span class="op" id="2354994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354998">size</span><span class="op" id="2355002">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355007">int64</span><span class="op" id="2355012">(</span><span class="ident" id="2355013">st</span><span class="op" id="2355015">.</span><span class="ident" id="2355016">Size</span><span class="op" id="2355020">)</span><span class="op" id="2355021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355025">modTime</span><span class="op" id="2355032">:</span>&nbsp;<span class="ident" id="2355034">timespecToTime</span><span class="op" id="2355048">(</span><span class="ident" id="2355049">st</span><span class="op" id="2355051">.</span><span class="ident" id="2355052">Mtim</span><span class="op" id="2355056">)</span><span class="op" id="2355057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355061">sys</span><span class="op" id="2355064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2355070">st</span><span class="op" id="2355072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355075">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355078">fs</span><span class="op" id="2355080">.</span><span class="ident" id="2355081">mode</span>&nbsp;<span class="op" id="2355086">=</span>&nbsp;<span class="ident" id="2355088">FileMode</span><span class="op" id="2355096">(</span><span class="ident" id="2355097">st</span><span class="op" id="2355099">.</span><span class="ident" id="2355100">Mode</span>&nbsp;<span class="op" id="2355105">&amp;</span>&nbsp;<span class="num" id="2355107">0777</span><span class="op" id="2355111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355114">switch</span>&nbsp;<span class="ident" id="2355121">st</span><span class="op" id="2355123">.</span><span class="ident" id="2355124">Mode</span>&nbsp;<span class="op" id="2355129">&amp;</span>&nbsp;<span class="ident" id="2355131">syscall</span><span class="op" id="2355138">.</span><span class="ident" id="2355139">S_IFMT</span>&nbsp;<span class="op" id="2355146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355149">case</span>&nbsp;<span class="ident" id="2355154">syscall</span><span class="op" id="2355161">.</span><span class="ident" id="2355162">S_IFBLK</span><span class="op" id="2355169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355173">fs</span><span class="op" id="2355175">.</span><span class="ident" id="2355176">mode</span>&nbsp;<span class="op" id="2355181">|=</span>&nbsp;<span class="ident" id="2355184">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355196">case</span>&nbsp;<span class="ident" id="2355201">syscall</span><span class="op" id="2355208">.</span><span class="ident" id="2355209">S_IFCHR</span><span class="op" id="2355216">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355220">fs</span><span class="op" id="2355222">.</span><span class="ident" id="2355223">mode</span>&nbsp;<span class="op" id="2355228">|=</span>&nbsp;<span class="ident" id="2355231">ModeDevice</span>&nbsp;<span class="op" id="2355242">|</span>&nbsp;<span class="ident" id="2355244">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355260">case</span>&nbsp;<span class="ident" id="2355265">syscall</span><span class="op" id="2355272">.</span><span class="ident" id="2355273">S_IFDIR</span><span class="op" id="2355280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355284">fs</span><span class="op" id="2355286">.</span><span class="ident" id="2355287">mode</span>&nbsp;<span class="op" id="2355292">|=</span>&nbsp;<span class="ident" id="2355295">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355304">case</span>&nbsp;<span class="ident" id="2355309">syscall</span><span class="op" id="2355316">.</span><span class="ident" id="2355317">S_IFIFO</span><span class="op" id="2355324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355328">fs</span><span class="op" id="2355330">.</span><span class="ident" id="2355331">mode</span>&nbsp;<span class="op" id="2355336">|=</span>&nbsp;<span class="ident" id="2355339">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355354">case</span>&nbsp;<span class="ident" id="2355359">syscall</span><span class="op" id="2355366">.</span><span class="ident" id="2355367">S_IFLNK</span><span class="op" id="2355374">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355378">fs</span><span class="op" id="2355380">.</span><span class="ident" id="2355381">mode</span>&nbsp;<span class="op" id="2355386">|=</span>&nbsp;<span class="ident" id="2355389">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355402">case</span>&nbsp;<span class="ident" id="2355407">syscall</span><span class="op" id="2355414">.</span><span class="ident" id="2355415">S_IFREG</span><span class="op" id="2355422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355426">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355444">case</span>&nbsp;<span class="ident" id="2355449">syscall</span><span class="op" id="2355456">.</span><span class="ident" id="2355457">S_IFSOCK</span><span class="op" id="2355465">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355469">fs</span><span class="op" id="2355471">.</span><span class="ident" id="2355472">mode</span>&nbsp;<span class="op" id="2355477">|=</span>&nbsp;<span class="ident" id="2355480">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355495">if</span>&nbsp;<span class="ident" id="2355498">st</span><span class="op" id="2355500">.</span><span class="ident" id="2355501">Mode</span><span class="op" id="2355505">&amp;</span><span class="ident" id="2355506">syscall</span><span class="op" id="2355513">.</span><span class="ident" id="2355514">S_ISGID</span>&nbsp;<span class="op" id="2355522">!=</span>&nbsp;<span class="num" id="2355525">0</span>&nbsp;<span class="op" id="2355527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355531">fs</span><span class="op" id="2355533">.</span><span class="ident" id="2355534">mode</span>&nbsp;<span class="op" id="2355539">|=</span>&nbsp;<span class="ident" id="2355542">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355554">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355557">if</span>&nbsp;<span class="ident" id="2355560">st</span><span class="op" id="2355562">.</span><span class="ident" id="2355563">Mode</span><span class="op" id="2355567">&amp;</span><span class="ident" id="2355568">syscall</span><span class="op" id="2355575">.</span><span class="ident" id="2355576">S_ISUID</span>&nbsp;<span class="op" id="2355584">!=</span>&nbsp;<span class="num" id="2355587">0</span>&nbsp;<span class="op" id="2355589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355593">fs</span><span class="op" id="2355595">.</span><span class="ident" id="2355596">mode</span>&nbsp;<span class="op" id="2355601">|=</span>&nbsp;<span class="ident" id="2355604">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355619">if</span>&nbsp;<span class="ident" id="2355622">st</span><span class="op" id="2355624">.</span><span class="ident" id="2355625">Mode</span><span class="op" id="2355629">&amp;</span><span class="ident" id="2355630">syscall</span><span class="op" id="2355637">.</span><span class="ident" id="2355638">S_ISVTX</span>&nbsp;<span class="op" id="2355646">!=</span>&nbsp;<span class="num" id="2355649">0</span>&nbsp;<span class="op" id="2355651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355655">fs</span><span class="op" id="2355657">.</span><span class="ident" id="2355658">mode</span>&nbsp;<span class="op" id="2355663">|=</span>&nbsp;<span class="ident" id="2355666">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355681">return</span>&nbsp;<span class="ident" id="2355688">fs</span><br>
<span class="lineno"></span><span class="op" id="2355691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2355694">func</span>&nbsp;<span class="ident" id="2355699">timespecToTime</span><span class="op" id="2355713">(</span><span class="ident" id="2355714">ts</span>&nbsp;<span class="ident" id="2355717">syscall</span><span class="op" id="2355724">.</span><span class="ident" id="2355725">Timespec</span><span class="op" id="2355733">)</span>&nbsp;<span class="ident" id="2355735">time</span><span class="op" id="2355739">.</span><span class="ident" id="2355740">Time</span>&nbsp;<span class="op" id="2355745">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355748">return</span>&nbsp;<span class="ident" id="2355755">time</span><span class="op" id="2355759">.</span><span class="ident" id="2355760">Unix</span><span class="op" id="2355764">(</span><span class="ident" id="2355765">int64</span><span class="op" id="2355770">(</span><span class="ident" id="2355771">ts</span><span class="op" id="2355773">.</span><span class="ident" id="2355774">Sec</span><span class="op" id="2355777">)</span><span class="op" id="2355778">,</span>&nbsp;<span class="ident" id="2355780">int64</span><span class="op" id="2355785">(</span><span class="ident" id="2355786">ts</span><span class="op" id="2355788">.</span><span class="ident" id="2355789">Nsec</span><span class="op" id="2355793">)</span><span class="op" id="2355794">)</span><br>
<span class="lineno"></span><span class="op" id="2355796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2355799">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2355815">func</span>&nbsp;<span class="ident" id="2355820">atime</span><span class="op" id="2355825">(</span><span class="ident" id="2355826">fi</span>&nbsp;<span class="ident" id="2355829">FileInfo</span><span class="op" id="2355837">)</span>&nbsp;<span class="ident" id="2355839">time</span><span class="op" id="2355843">.</span><span class="ident" id="2355844">Time</span>&nbsp;<span class="op" id="2355849">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355852">return</span>&nbsp;<span class="ident" id="2355859">timespecToTime</span><span class="op" id="2355873">(</span><span class="ident" id="2355874">fi</span><span class="op" id="2355876">.</span><span class="ident" id="2355877">Sys</span><span class="op" id="2355880">(</span><span class="op" id="2355881">)</span><span class="op" id="2355882">.</span><span class="op" id="2355883">(</span><span class="op" id="2355884">*</span><span class="ident" id="2355885">syscall</span><span class="op" id="2355892">.</span><span class="ident" id="2355893">Stat_t</span><span class="op" id="2355899">)</span><span class="op" id="2355900">.</span><span class="ident" id="2355901">Atim</span><span class="op" id="2355905">)</span><br>
<span class="lineno"></span><span class="op" id="2355907">}</span>
</div>
</body>
</html>
