<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html" class="current">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7404105">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7404161">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7404215">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7404266">package</span>&nbsp;<span class="ident" id="7404274">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7404281">import</span>&nbsp;<span class="op" id="7404288">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404291">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404297">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404303">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404320">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404331">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404342">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7404353">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7404363">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7404366">func</span>&nbsp;<span class="ident" id="7404371">TestMatch</span><span class="op" id="7404380">(</span><span class="ident" id="7404381">t</span>&nbsp;<span class="op" id="7404383">*</span><span class="ident" id="7404384">testing</span><span class="op" id="7404391">.</span><span class="ident" id="7404392">T</span><span class="op" id="7404393">)</span>&nbsp;<span class="op" id="7404395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404398">ctxt</span>&nbsp;<span class="op" id="7404403">:=</span>&nbsp;<span class="ident" id="7404406">Default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404415">what</span>&nbsp;<span class="op" id="7404420">:=</span>&nbsp;<span class="string" id="7404423">&#34;default&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404434">match</span>&nbsp;<span class="op" id="7404440">:=</span>&nbsp;<span class="keyword" id="7404443">func</span><span class="op" id="7404447">(</span><span class="ident" id="7404448">tag</span>&nbsp;<span class="builtintype" id="7404452">string</span><span class="op" id="7404458">,</span>&nbsp;<span class="ident" id="7404460">want</span>&nbsp;<span class="keyword" id="7404465">map</span><span class="op" id="7404468">[</span><span class="builtintype" id="7404469">string</span><span class="op" id="7404475">]</span><span class="builtintype" id="7404476">bool</span><span class="op" id="7404480">)</span>&nbsp;<span class="op" id="7404482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404486">m</span>&nbsp;<span class="op" id="7404488">:=</span>&nbsp;<span class="builtinfunc" id="7404491">make</span><span class="op" id="7404495">(</span><span class="keyword" id="7404496">map</span><span class="op" id="7404499">[</span><span class="builtintype" id="7404500">string</span><span class="op" id="7404506">]</span><span class="builtintype" id="7404507">bool</span><span class="op" id="7404511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7404515">if</span>&nbsp;<span class="op" id="7404518">!</span><span class="ident" id="7404519">ctxt</span><span class="op" id="7404523">.</span><span class="ident" id="7404524">match</span><span class="op" id="7404529">(</span><span class="ident" id="7404530">tag</span><span class="op" id="7404533">,</span>&nbsp;<span class="ident" id="7404535">m</span><span class="op" id="7404536">)</span>&nbsp;<span class="op" id="7404538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404543">t</span><span class="op" id="7404544">.</span><span class="ident" id="7404545">Errorf</span><span class="op" id="7404551">(</span><span class="string" id="7404552">&#34;%s&nbsp;context&nbsp;should&nbsp;match&nbsp;%s,&nbsp;does&nbsp;not&#34;</span><span class="op" id="7404590">,</span>&nbsp;<span class="ident" id="7404592">what</span><span class="op" id="7404596">,</span>&nbsp;<span class="ident" id="7404598">tag</span><span class="op" id="7404601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7404605">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7404609">if</span>&nbsp;<span class="op" id="7404612">!</span><span class="ident" id="7404613">reflect</span><span class="op" id="7404620">.</span><span class="ident" id="7404621">DeepEqual</span><span class="op" id="7404630">(</span><span class="ident" id="7404631">m</span><span class="op" id="7404632">,</span>&nbsp;<span class="ident" id="7404634">want</span><span class="op" id="7404638">)</span>&nbsp;<span class="op" id="7404640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404645">t</span><span class="op" id="7404646">.</span><span class="ident" id="7404647">Errorf</span><span class="op" id="7404653">(</span><span class="string" id="7404654">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7404677">,</span>&nbsp;<span class="ident" id="7404679">tag</span><span class="op" id="7404682">,</span>&nbsp;<span class="ident" id="7404684">m</span><span class="op" id="7404685">,</span>&nbsp;<span class="ident" id="7404687">want</span><span class="op" id="7404691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7404695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7404698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404701">nomatch</span>&nbsp;<span class="op" id="7404709">:=</span>&nbsp;<span class="keyword" id="7404712">func</span><span class="op" id="7404716">(</span><span class="ident" id="7404717">tag</span>&nbsp;<span class="builtintype" id="7404721">string</span><span class="op" id="7404727">,</span>&nbsp;<span class="ident" id="7404729">want</span>&nbsp;<span class="keyword" id="7404734">map</span><span class="op" id="7404737">[</span><span class="builtintype" id="7404738">string</span><span class="op" id="7404744">]</span><span class="builtintype" id="7404745">bool</span><span class="op" id="7404749">)</span>&nbsp;<span class="op" id="7404751">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404755">m</span>&nbsp;<span class="op" id="7404757">:=</span>&nbsp;<span class="builtinfunc" id="7404760">make</span><span class="op" id="7404764">(</span><span class="keyword" id="7404765">map</span><span class="op" id="7404768">[</span><span class="builtintype" id="7404769">string</span><span class="op" id="7404775">]</span><span class="builtintype" id="7404776">bool</span><span class="op" id="7404780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7404784">if</span>&nbsp;<span class="ident" id="7404787">ctxt</span><span class="op" id="7404791">.</span><span class="ident" id="7404792">match</span><span class="op" id="7404797">(</span><span class="ident" id="7404798">tag</span><span class="op" id="7404801">,</span>&nbsp;<span class="ident" id="7404803">m</span><span class="op" id="7404804">)</span>&nbsp;<span class="op" id="7404806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404811">t</span><span class="op" id="7404812">.</span><span class="ident" id="7404813">Errorf</span><span class="op" id="7404819">(</span><span class="string" id="7404820">&#34;%s&nbsp;context&nbsp;should&nbsp;NOT&nbsp;match&nbsp;%s,&nbsp;does&#34;</span><span class="op" id="7404858">,</span>&nbsp;<span class="ident" id="7404860">what</span><span class="op" id="7404864">,</span>&nbsp;<span class="ident" id="7404866">tag</span><span class="op" id="7404869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7404873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7404877">if</span>&nbsp;<span class="op" id="7404880">!</span><span class="ident" id="7404881">reflect</span><span class="op" id="7404888">.</span><span class="ident" id="7404889">DeepEqual</span><span class="op" id="7404898">(</span><span class="ident" id="7404899">m</span><span class="op" id="7404900">,</span>&nbsp;<span class="ident" id="7404902">want</span><span class="op" id="7404906">)</span>&nbsp;<span class="op" id="7404908">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404913">t</span><span class="op" id="7404914">.</span><span class="ident" id="7404915">Errorf</span><span class="op" id="7404921">(</span><span class="string" id="7404922">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7404945">,</span>&nbsp;<span class="ident" id="7404947">tag</span><span class="op" id="7404950">,</span>&nbsp;<span class="ident" id="7404952">m</span><span class="op" id="7404953">,</span>&nbsp;<span class="ident" id="7404955">want</span><span class="op" id="7404959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7404963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7404966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7404970">match</span><span class="op" id="7404975">(</span><span class="ident" id="7404976">runtime</span><span class="op" id="7404983">.</span><span class="ident" id="7404984">GOOS</span><span class="op" id="7404988">+</span><span class="string" id="7404989">&#34;,&#34;</span><span class="op" id="7404992">+</span><span class="ident" id="7404993">runtime</span><span class="op" id="7405000">.</span><span class="ident" id="7405001">GOARCH</span><span class="op" id="7405007">,</span>&nbsp;<span class="keyword" id="7405009">map</span><span class="op" id="7405012">[</span><span class="builtintype" id="7405013">string</span><span class="op" id="7405019">]</span><span class="builtintype" id="7405020">bool</span><span class="op" id="7405024">{</span><span class="ident" id="7405025">runtime</span><span class="op" id="7405032">.</span><span class="ident" id="7405033">GOOS</span><span class="op" id="7405037">:</span>&nbsp;<span class="builtintype" id="7405039">true</span><span class="op" id="7405043">,</span>&nbsp;<span class="ident" id="7405045">runtime</span><span class="op" id="7405052">.</span><span class="ident" id="7405053">GOARCH</span><span class="op" id="7405059">:</span>&nbsp;<span class="builtintype" id="7405061">true</span><span class="op" id="7405065">}</span><span class="op" id="7405066">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405069">match</span><span class="op" id="7405074">(</span><span class="ident" id="7405075">runtime</span><span class="op" id="7405082">.</span><span class="ident" id="7405083">GOOS</span><span class="op" id="7405087">+</span><span class="string" id="7405088">&#34;,&#34;</span><span class="op" id="7405091">+</span><span class="ident" id="7405092">runtime</span><span class="op" id="7405099">.</span><span class="ident" id="7405100">GOARCH</span><span class="op" id="7405106">+</span><span class="string" id="7405107">&#34;,!foo&#34;</span><span class="op" id="7405114">,</span>&nbsp;<span class="keyword" id="7405116">map</span><span class="op" id="7405119">[</span><span class="builtintype" id="7405120">string</span><span class="op" id="7405126">]</span><span class="builtintype" id="7405127">bool</span><span class="op" id="7405131">{</span><span class="ident" id="7405132">runtime</span><span class="op" id="7405139">.</span><span class="ident" id="7405140">GOOS</span><span class="op" id="7405144">:</span>&nbsp;<span class="builtintype" id="7405146">true</span><span class="op" id="7405150">,</span>&nbsp;<span class="ident" id="7405152">runtime</span><span class="op" id="7405159">.</span><span class="ident" id="7405160">GOARCH</span><span class="op" id="7405166">:</span>&nbsp;<span class="builtintype" id="7405168">true</span><span class="op" id="7405172">,</span>&nbsp;<span class="string" id="7405174">&#34;foo&#34;</span><span class="op" id="7405179">:</span>&nbsp;<span class="builtintype" id="7405181">true</span><span class="op" id="7405185">}</span><span class="op" id="7405186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405189">nomatch</span><span class="op" id="7405196">(</span><span class="ident" id="7405197">runtime</span><span class="op" id="7405204">.</span><span class="ident" id="7405205">GOOS</span><span class="op" id="7405209">+</span><span class="string" id="7405210">&#34;,&#34;</span><span class="op" id="7405213">+</span><span class="ident" id="7405214">runtime</span><span class="op" id="7405221">.</span><span class="ident" id="7405222">GOARCH</span><span class="op" id="7405228">+</span><span class="string" id="7405229">&#34;,foo&#34;</span><span class="op" id="7405235">,</span>&nbsp;<span class="keyword" id="7405237">map</span><span class="op" id="7405240">[</span><span class="builtintype" id="7405241">string</span><span class="op" id="7405247">]</span><span class="builtintype" id="7405248">bool</span><span class="op" id="7405252">{</span><span class="ident" id="7405253">runtime</span><span class="op" id="7405260">.</span><span class="ident" id="7405261">GOOS</span><span class="op" id="7405265">:</span>&nbsp;<span class="builtintype" id="7405267">true</span><span class="op" id="7405271">,</span>&nbsp;<span class="ident" id="7405273">runtime</span><span class="op" id="7405280">.</span><span class="ident" id="7405281">GOARCH</span><span class="op" id="7405287">:</span>&nbsp;<span class="builtintype" id="7405289">true</span><span class="op" id="7405293">,</span>&nbsp;<span class="string" id="7405295">&#34;foo&#34;</span><span class="op" id="7405300">:</span>&nbsp;<span class="builtintype" id="7405302">true</span><span class="op" id="7405306">}</span><span class="op" id="7405307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405311">what</span>&nbsp;<span class="op" id="7405316">=</span>&nbsp;<span class="string" id="7405318">&#34;modified&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405330">ctxt</span><span class="op" id="7405334">.</span><span class="ident" id="7405335">BuildTags</span>&nbsp;<span class="op" id="7405345">=</span>&nbsp;<span class="op" id="7405347">[</span><span class="op" id="7405348">]</span><span class="builtintype" id="7405349">string</span><span class="op" id="7405355">{</span><span class="string" id="7405356">&#34;foo&#34;</span><span class="op" id="7405361">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405364">match</span><span class="op" id="7405369">(</span><span class="ident" id="7405370">runtime</span><span class="op" id="7405377">.</span><span class="ident" id="7405378">GOOS</span><span class="op" id="7405382">+</span><span class="string" id="7405383">&#34;,&#34;</span><span class="op" id="7405386">+</span><span class="ident" id="7405387">runtime</span><span class="op" id="7405394">.</span><span class="ident" id="7405395">GOARCH</span><span class="op" id="7405401">,</span>&nbsp;<span class="keyword" id="7405403">map</span><span class="op" id="7405406">[</span><span class="builtintype" id="7405407">string</span><span class="op" id="7405413">]</span><span class="builtintype" id="7405414">bool</span><span class="op" id="7405418">{</span><span class="ident" id="7405419">runtime</span><span class="op" id="7405426">.</span><span class="ident" id="7405427">GOOS</span><span class="op" id="7405431">:</span>&nbsp;<span class="builtintype" id="7405433">true</span><span class="op" id="7405437">,</span>&nbsp;<span class="ident" id="7405439">runtime</span><span class="op" id="7405446">.</span><span class="ident" id="7405447">GOARCH</span><span class="op" id="7405453">:</span>&nbsp;<span class="builtintype" id="7405455">true</span><span class="op" id="7405459">}</span><span class="op" id="7405460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405463">match</span><span class="op" id="7405468">(</span><span class="ident" id="7405469">runtime</span><span class="op" id="7405476">.</span><span class="ident" id="7405477">GOOS</span><span class="op" id="7405481">+</span><span class="string" id="7405482">&#34;,&#34;</span><span class="op" id="7405485">+</span><span class="ident" id="7405486">runtime</span><span class="op" id="7405493">.</span><span class="ident" id="7405494">GOARCH</span><span class="op" id="7405500">+</span><span class="string" id="7405501">&#34;,foo&#34;</span><span class="op" id="7405507">,</span>&nbsp;<span class="keyword" id="7405509">map</span><span class="op" id="7405512">[</span><span class="builtintype" id="7405513">string</span><span class="op" id="7405519">]</span><span class="builtintype" id="7405520">bool</span><span class="op" id="7405524">{</span><span class="ident" id="7405525">runtime</span><span class="op" id="7405532">.</span><span class="ident" id="7405533">GOOS</span><span class="op" id="7405537">:</span>&nbsp;<span class="builtintype" id="7405539">true</span><span class="op" id="7405543">,</span>&nbsp;<span class="ident" id="7405545">runtime</span><span class="op" id="7405552">.</span><span class="ident" id="7405553">GOARCH</span><span class="op" id="7405559">:</span>&nbsp;<span class="builtintype" id="7405561">true</span><span class="op" id="7405565">,</span>&nbsp;<span class="string" id="7405567">&#34;foo&#34;</span><span class="op" id="7405572">:</span>&nbsp;<span class="builtintype" id="7405574">true</span><span class="op" id="7405578">}</span><span class="op" id="7405579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405582">nomatch</span><span class="op" id="7405589">(</span><span class="ident" id="7405590">runtime</span><span class="op" id="7405597">.</span><span class="ident" id="7405598">GOOS</span><span class="op" id="7405602">+</span><span class="string" id="7405603">&#34;,&#34;</span><span class="op" id="7405606">+</span><span class="ident" id="7405607">runtime</span><span class="op" id="7405614">.</span><span class="ident" id="7405615">GOARCH</span><span class="op" id="7405621">+</span><span class="string" id="7405622">&#34;,!foo&#34;</span><span class="op" id="7405629">,</span>&nbsp;<span class="keyword" id="7405631">map</span><span class="op" id="7405634">[</span><span class="builtintype" id="7405635">string</span><span class="op" id="7405641">]</span><span class="builtintype" id="7405642">bool</span><span class="op" id="7405646">{</span><span class="ident" id="7405647">runtime</span><span class="op" id="7405654">.</span><span class="ident" id="7405655">GOOS</span><span class="op" id="7405659">:</span>&nbsp;<span class="builtintype" id="7405661">true</span><span class="op" id="7405665">,</span>&nbsp;<span class="ident" id="7405667">runtime</span><span class="op" id="7405674">.</span><span class="ident" id="7405675">GOARCH</span><span class="op" id="7405681">:</span>&nbsp;<span class="builtintype" id="7405683">true</span><span class="op" id="7405687">,</span>&nbsp;<span class="string" id="7405689">&#34;foo&#34;</span><span class="op" id="7405694">:</span>&nbsp;<span class="builtintype" id="7405696">true</span><span class="op" id="7405700">}</span><span class="op" id="7405701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405704">match</span><span class="op" id="7405709">(</span><span class="ident" id="7405710">runtime</span><span class="op" id="7405717">.</span><span class="ident" id="7405718">GOOS</span><span class="op" id="7405722">+</span><span class="string" id="7405723">&#34;,&#34;</span><span class="op" id="7405726">+</span><span class="ident" id="7405727">runtime</span><span class="op" id="7405734">.</span><span class="ident" id="7405735">GOARCH</span><span class="op" id="7405741">+</span><span class="string" id="7405742">&#34;,!bar&#34;</span><span class="op" id="7405749">,</span>&nbsp;<span class="keyword" id="7405751">map</span><span class="op" id="7405754">[</span><span class="builtintype" id="7405755">string</span><span class="op" id="7405761">]</span><span class="builtintype" id="7405762">bool</span><span class="op" id="7405766">{</span><span class="ident" id="7405767">runtime</span><span class="op" id="7405774">.</span><span class="ident" id="7405775">GOOS</span><span class="op" id="7405779">:</span>&nbsp;<span class="builtintype" id="7405781">true</span><span class="op" id="7405785">,</span>&nbsp;<span class="ident" id="7405787">runtime</span><span class="op" id="7405794">.</span><span class="ident" id="7405795">GOARCH</span><span class="op" id="7405801">:</span>&nbsp;<span class="builtintype" id="7405803">true</span><span class="op" id="7405807">,</span>&nbsp;<span class="string" id="7405809">&#34;bar&#34;</span><span class="op" id="7405814">:</span>&nbsp;<span class="builtintype" id="7405816">true</span><span class="op" id="7405820">}</span><span class="op" id="7405821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405824">nomatch</span><span class="op" id="7405831">(</span><span class="ident" id="7405832">runtime</span><span class="op" id="7405839">.</span><span class="ident" id="7405840">GOOS</span><span class="op" id="7405844">+</span><span class="string" id="7405845">&#34;,&#34;</span><span class="op" id="7405848">+</span><span class="ident" id="7405849">runtime</span><span class="op" id="7405856">.</span><span class="ident" id="7405857">GOARCH</span><span class="op" id="7405863">+</span><span class="string" id="7405864">&#34;,bar&#34;</span><span class="op" id="7405870">,</span>&nbsp;<span class="keyword" id="7405872">map</span><span class="op" id="7405875">[</span><span class="builtintype" id="7405876">string</span><span class="op" id="7405882">]</span><span class="builtintype" id="7405883">bool</span><span class="op" id="7405887">{</span><span class="ident" id="7405888">runtime</span><span class="op" id="7405895">.</span><span class="ident" id="7405896">GOOS</span><span class="op" id="7405900">:</span>&nbsp;<span class="builtintype" id="7405902">true</span><span class="op" id="7405906">,</span>&nbsp;<span class="ident" id="7405908">runtime</span><span class="op" id="7405915">.</span><span class="ident" id="7405916">GOARCH</span><span class="op" id="7405922">:</span>&nbsp;<span class="builtintype" id="7405924">true</span><span class="op" id="7405928">,</span>&nbsp;<span class="string" id="7405930">&#34;bar&#34;</span><span class="op" id="7405935">:</span>&nbsp;<span class="builtintype" id="7405937">true</span><span class="op" id="7405941">}</span><span class="op" id="7405942">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7405945">nomatch</span><span class="op" id="7405952">(</span><span class="string" id="7405953">&#34;!&#34;</span><span class="op" id="7405956">,</span>&nbsp;<span class="keyword" id="7405958">map</span><span class="op" id="7405961">[</span><span class="builtintype" id="7405962">string</span><span class="op" id="7405968">]</span><span class="builtintype" id="7405969">bool</span><span class="op" id="7405973">{</span><span class="op" id="7405974">}</span><span class="op" id="7405975">)</span><br>
<span class="lineno"></span><span class="op" id="7405977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7405980">func</span>&nbsp;<span class="ident" id="7405985">TestDotSlashImport</span><span class="op" id="7406003">(</span><span class="ident" id="7406004">t</span>&nbsp;<span class="op" id="7406006">*</span><span class="ident" id="7406007">testing</span><span class="op" id="7406014">.</span><span class="ident" id="7406015">T</span><span class="op" id="7406016">)</span>&nbsp;<span class="op" id="7406018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406021">p</span><span class="op" id="7406022">,</span>&nbsp;<span class="ident" id="7406024">err</span>&nbsp;<span class="op" id="7406028">:=</span>&nbsp;<span class="ident" id="7406031">ImportDir</span><span class="op" id="7406040">(</span><span class="string" id="7406041">&#34;testdata/other&#34;</span><span class="op" id="7406057">,</span>&nbsp;<span class="num" id="7406059">0</span><span class="op" id="7406060">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406063">if</span>&nbsp;<span class="ident" id="7406066">err</span>&nbsp;<span class="op" id="7406070">!=</span>&nbsp;<span class="builtintype" id="7406073">nil</span>&nbsp;<span class="op" id="7406077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406081">t</span><span class="op" id="7406082">.</span><span class="ident" id="7406083">Fatal</span><span class="op" id="7406088">(</span><span class="ident" id="7406089">err</span><span class="op" id="7406092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406098">if</span>&nbsp;<span class="builtinfunc" id="7406101">len</span><span class="op" id="7406104">(</span><span class="ident" id="7406105">p</span><span class="op" id="7406106">.</span><span class="ident" id="7406107">Imports</span><span class="op" id="7406114">)</span>&nbsp;<span class="op" id="7406116">!=</span>&nbsp;<span class="num" id="7406119">1</span>&nbsp;<span class="op" id="7406121">||</span>&nbsp;<span class="ident" id="7406124">p</span><span class="op" id="7406125">.</span><span class="ident" id="7406126">Imports</span><span class="op" id="7406133">[</span><span class="num" id="7406134">0</span><span class="op" id="7406135">]</span>&nbsp;<span class="op" id="7406137">!=</span>&nbsp;<span class="string" id="7406140">&#34;./file&#34;</span>&nbsp;<span class="op" id="7406149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406153">t</span><span class="op" id="7406154">.</span><span class="ident" id="7406155">Fatalf</span><span class="op" id="7406161">(</span><span class="string" id="7406162">&#34;testdata/other:&nbsp;Imports=%v,&nbsp;want&nbsp;[./file]&#34;</span><span class="op" id="7406205">,</span>&nbsp;<span class="ident" id="7406207">p</span><span class="op" id="7406208">.</span><span class="ident" id="7406209">Imports</span><span class="op" id="7406216">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406223">p1</span><span class="op" id="7406225">,</span>&nbsp;<span class="ident" id="7406227">err</span>&nbsp;<span class="op" id="7406231">:=</span>&nbsp;<span class="ident" id="7406234">Import</span><span class="op" id="7406240">(</span><span class="string" id="7406241">&#34;./file&#34;</span><span class="op" id="7406249">,</span>&nbsp;<span class="string" id="7406251">&#34;testdata/other&#34;</span><span class="op" id="7406267">,</span>&nbsp;<span class="num" id="7406269">0</span><span class="op" id="7406270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406273">if</span>&nbsp;<span class="ident" id="7406276">err</span>&nbsp;<span class="op" id="7406280">!=</span>&nbsp;<span class="builtintype" id="7406283">nil</span>&nbsp;<span class="op" id="7406287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406291">t</span><span class="op" id="7406292">.</span><span class="ident" id="7406293">Fatal</span><span class="op" id="7406298">(</span><span class="ident" id="7406299">err</span><span class="op" id="7406302">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406308">if</span>&nbsp;<span class="ident" id="7406311">p1</span><span class="op" id="7406313">.</span><span class="ident" id="7406314">Name</span>&nbsp;<span class="op" id="7406319">!=</span>&nbsp;<span class="string" id="7406322">&#34;file&#34;</span>&nbsp;<span class="op" id="7406329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406333">t</span><span class="op" id="7406334">.</span><span class="ident" id="7406335">Fatalf</span><span class="op" id="7406341">(</span><span class="string" id="7406342">&#34;./file:&nbsp;Name=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7406368">,</span>&nbsp;<span class="ident" id="7406370">p1</span><span class="op" id="7406372">.</span><span class="ident" id="7406373">Name</span><span class="op" id="7406377">,</span>&nbsp;<span class="string" id="7406379">&#34;file&#34;</span><span class="op" id="7406385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406391">dir</span>&nbsp;<span class="op" id="7406395">:=</span>&nbsp;<span class="ident" id="7406398">filepath</span><span class="op" id="7406406">.</span><span class="ident" id="7406407">Clean</span><span class="op" id="7406412">(</span><span class="string" id="7406413">&#34;testdata/other/file&#34;</span><span class="op" id="7406434">)</span>&nbsp;<span class="comment" id="7406436">//&nbsp;Clean&nbsp;to&nbsp;use&nbsp;\&nbsp;on&nbsp;Windows</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406466">if</span>&nbsp;<span class="ident" id="7406469">p1</span><span class="op" id="7406471">.</span><span class="ident" id="7406472">Dir</span>&nbsp;<span class="op" id="7406476">!=</span>&nbsp;<span class="ident" id="7406479">dir</span>&nbsp;<span class="op" id="7406483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406487">t</span><span class="op" id="7406488">.</span><span class="ident" id="7406489">Fatalf</span><span class="op" id="7406495">(</span><span class="string" id="7406496">&#34;./file:&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7406521">,</span>&nbsp;<span class="ident" id="7406523">p1</span><span class="op" id="7406525">.</span><span class="ident" id="7406526">Name</span><span class="op" id="7406530">,</span>&nbsp;<span class="ident" id="7406532">dir</span><span class="op" id="7406535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406538">}</span><br>
<span class="lineno"></span><span class="op" id="7406540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7406543">func</span>&nbsp;<span class="ident" id="7406548">TestEmptyImport</span><span class="op" id="7406563">(</span><span class="ident" id="7406564">t</span>&nbsp;<span class="op" id="7406566">*</span><span class="ident" id="7406567">testing</span><span class="op" id="7406574">.</span><span class="ident" id="7406575">T</span><span class="op" id="7406576">)</span>&nbsp;<span class="op" id="7406578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406581">p</span><span class="op" id="7406582">,</span>&nbsp;<span class="ident" id="7406584">err</span>&nbsp;<span class="op" id="7406588">:=</span>&nbsp;<span class="ident" id="7406591">Import</span><span class="op" id="7406597">(</span><span class="string" id="7406598">&#34;&#34;</span><span class="op" id="7406600">,</span>&nbsp;<span class="ident" id="7406602">Default</span><span class="op" id="7406609">.</span><span class="ident" id="7406610">GOROOT</span><span class="op" id="7406616">,</span>&nbsp;<span class="ident" id="7406618">FindOnly</span><span class="op" id="7406626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406629">if</span>&nbsp;<span class="ident" id="7406632">err</span>&nbsp;<span class="op" id="7406636">==</span>&nbsp;<span class="builtintype" id="7406639">nil</span>&nbsp;<span class="op" id="7406643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406647">t</span><span class="op" id="7406648">.</span><span class="ident" id="7406649">Fatal</span><span class="op" id="7406654">(</span><span class="string" id="7406655">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;error.`</span><span class="op" id="7406687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406690">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406693">if</span>&nbsp;<span class="ident" id="7406696">p</span>&nbsp;<span class="op" id="7406698">==</span>&nbsp;<span class="builtintype" id="7406701">nil</span>&nbsp;<span class="op" id="7406705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406709">t</span><span class="op" id="7406710">.</span><span class="ident" id="7406711">Fatal</span><span class="op" id="7406716">(</span><span class="string" id="7406717">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;package.`</span><span class="op" id="7406751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406757">if</span>&nbsp;<span class="ident" id="7406760">p</span><span class="op" id="7406761">.</span><span class="ident" id="7406762">ImportPath</span>&nbsp;<span class="op" id="7406773">!=</span>&nbsp;<span class="string" id="7406776">&#34;&#34;</span>&nbsp;<span class="op" id="7406779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406783">t</span><span class="op" id="7406784">.</span><span class="ident" id="7406785">Fatalf</span><span class="op" id="7406791">(</span><span class="string" id="7406792">&#34;ImportPath=%q,&nbsp;want&nbsp;%q.&#34;</span><span class="op" id="7406817">,</span>&nbsp;<span class="ident" id="7406819">p</span><span class="op" id="7406820">.</span><span class="ident" id="7406821">ImportPath</span><span class="op" id="7406831">,</span>&nbsp;<span class="string" id="7406833">&#34;&#34;</span><span class="op" id="7406835">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7406838">}</span><br>
<span class="lineno"></span><span class="op" id="7406840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7406843">func</span>&nbsp;<span class="ident" id="7406848">TestEmptyFolderImport</span><span class="op" id="7406869">(</span><span class="ident" id="7406870">t</span>&nbsp;<span class="op" id="7406872">*</span><span class="ident" id="7406873">testing</span><span class="op" id="7406880">.</span><span class="ident" id="7406881">T</span><span class="op" id="7406882">)</span>&nbsp;<span class="op" id="7406884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406887">_</span><span class="op" id="7406888">,</span>&nbsp;<span class="ident" id="7406890">err</span>&nbsp;<span class="op" id="7406894">:=</span>&nbsp;<span class="ident" id="7406897">Import</span><span class="op" id="7406903">(</span><span class="string" id="7406904">&#34;.&#34;</span><span class="op" id="7406907">,</span>&nbsp;<span class="string" id="7406909">&#34;testdata/empty&#34;</span><span class="op" id="7406925">,</span>&nbsp;<span class="num" id="7406927">0</span><span class="op" id="7406928">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7406931">if</span>&nbsp;<span class="ident" id="7406934">_</span><span class="op" id="7406935">,</span>&nbsp;<span class="ident" id="7406937">ok</span>&nbsp;<span class="op" id="7406940">:=</span>&nbsp;<span class="ident" id="7406943">err</span><span class="op" id="7406946">.</span><span class="op" id="7406947">(</span><span class="op" id="7406948">*</span><span class="ident" id="7406949">NoGoError</span><span class="op" id="7406958">)</span><span class="op" id="7406959">;</span>&nbsp;<span class="op" id="7406961">!</span><span class="ident" id="7406962">ok</span>&nbsp;<span class="op" id="7406965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7406969">t</span><span class="op" id="7406970">.</span><span class="ident" id="7406971">Fatal</span><span class="op" id="7406976">(</span><span class="string" id="7406977">`Import(&#34;testdata/empty&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;NoGoError.`</span><span class="op" id="7407029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407032">}</span><br>
<span class="lineno"></span><span class="op" id="7407034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7407037">func</span>&nbsp;<span class="ident" id="7407042">TestMultiplePackageImport</span><span class="op" id="7407067">(</span><span class="ident" id="7407068">t</span>&nbsp;<span class="op" id="7407070">*</span><span class="ident" id="7407071">testing</span><span class="op" id="7407078">.</span><span class="ident" id="7407079">T</span><span class="op" id="7407080">)</span>&nbsp;<span class="op" id="7407082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407085">_</span><span class="op" id="7407086">,</span>&nbsp;<span class="ident" id="7407088">err</span>&nbsp;<span class="op" id="7407092">:=</span>&nbsp;<span class="ident" id="7407095">Import</span><span class="op" id="7407101">(</span><span class="string" id="7407102">&#34;.&#34;</span><span class="op" id="7407105">,</span>&nbsp;<span class="string" id="7407107">&#34;testdata/multi&#34;</span><span class="op" id="7407123">,</span>&nbsp;<span class="num" id="7407125">0</span><span class="op" id="7407126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407129">if</span>&nbsp;<span class="ident" id="7407132">_</span><span class="op" id="7407133">,</span>&nbsp;<span class="ident" id="7407135">ok</span>&nbsp;<span class="op" id="7407138">:=</span>&nbsp;<span class="ident" id="7407141">err</span><span class="op" id="7407144">.</span><span class="op" id="7407145">(</span><span class="op" id="7407146">*</span><span class="ident" id="7407147">MultiplePackageError</span><span class="op" id="7407167">)</span><span class="op" id="7407168">;</span>&nbsp;<span class="op" id="7407170">!</span><span class="ident" id="7407171">ok</span>&nbsp;<span class="op" id="7407174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407178">t</span><span class="op" id="7407179">.</span><span class="ident" id="7407180">Fatal</span><span class="op" id="7407185">(</span><span class="string" id="7407186">`Import(&#34;testdata/multi&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;MultiplePackageError.`</span><span class="op" id="7407249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407252">}</span><br>
<span class="lineno">100</span><span class="op" id="7407254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7407257">func</span>&nbsp;<span class="ident" id="7407262">TestLocalDirectory</span><span class="op" id="7407280">(</span><span class="ident" id="7407281">t</span>&nbsp;<span class="op" id="7407283">*</span><span class="ident" id="7407284">testing</span><span class="op" id="7407291">.</span><span class="ident" id="7407292">T</span><span class="op" id="7407293">)</span>&nbsp;<span class="op" id="7407295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407298">cwd</span><span class="op" id="7407301">,</span>&nbsp;<span class="ident" id="7407303">err</span>&nbsp;<span class="op" id="7407307">:=</span>&nbsp;<span class="ident" id="7407310">os</span><span class="op" id="7407312">.</span><span class="ident" id="7407313">Getwd</span><span class="op" id="7407318">(</span><span class="op" id="7407319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407322">if</span>&nbsp;<span class="ident" id="7407325">err</span>&nbsp;<span class="op" id="7407329">!=</span>&nbsp;<span class="builtintype" id="7407332">nil</span>&nbsp;<span class="op" id="7407336">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407340">t</span><span class="op" id="7407341">.</span><span class="ident" id="7407342">Fatal</span><span class="op" id="7407347">(</span><span class="ident" id="7407348">err</span><span class="op" id="7407351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407358">p</span><span class="op" id="7407359">,</span>&nbsp;<span class="ident" id="7407361">err</span>&nbsp;<span class="op" id="7407365">:=</span>&nbsp;<span class="ident" id="7407368">ImportDir</span><span class="op" id="7407377">(</span><span class="ident" id="7407378">cwd</span><span class="op" id="7407381">,</span>&nbsp;<span class="num" id="7407383">0</span><span class="op" id="7407384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407387">if</span>&nbsp;<span class="ident" id="7407390">err</span>&nbsp;<span class="op" id="7407394">!=</span>&nbsp;<span class="builtintype" id="7407397">nil</span>&nbsp;<span class="op" id="7407401">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407405">t</span><span class="op" id="7407406">.</span><span class="ident" id="7407407">Fatal</span><span class="op" id="7407412">(</span><span class="ident" id="7407413">err</span><span class="op" id="7407416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407422">if</span>&nbsp;<span class="ident" id="7407425">p</span><span class="op" id="7407426">.</span><span class="ident" id="7407427">ImportPath</span>&nbsp;<span class="op" id="7407438">!=</span>&nbsp;<span class="string" id="7407441">&#34;go/build&#34;</span>&nbsp;<span class="op" id="7407452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407456">t</span><span class="op" id="7407457">.</span><span class="ident" id="7407458">Fatalf</span><span class="op" id="7407464">(</span><span class="string" id="7407465">&#34;ImportPath=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7407489">,</span>&nbsp;<span class="ident" id="7407491">p</span><span class="op" id="7407492">.</span><span class="ident" id="7407493">ImportPath</span><span class="op" id="7407503">,</span>&nbsp;<span class="string" id="7407505">&#34;go/build&#34;</span><span class="op" id="7407515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7407518">}</span><br>
<span class="lineno">115</span><span class="op" id="7407520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7407523">func</span>&nbsp;<span class="ident" id="7407528">TestShouldBuild</span><span class="op" id="7407543">(</span><span class="ident" id="7407544">t</span>&nbsp;<span class="op" id="7407546">*</span><span class="ident" id="7407547">testing</span><span class="op" id="7407554">.</span><span class="ident" id="7407555">T</span><span class="op" id="7407556">)</span>&nbsp;<span class="op" id="7407558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407561">const</span>&nbsp;<span class="ident" id="7407567">file1</span>&nbsp;<span class="op" id="7407573">=</span>&nbsp;<span class="string" id="7407575">&#34;//&nbsp;+build&nbsp;tag1\n\n&#34;</span>&nbsp;<span class="op" id="7407596">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407600">&#34;package&nbsp;main\n&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407618">want1</span>&nbsp;<span class="op" id="7407624">:=</span>&nbsp;<span class="keyword" id="7407627">map</span><span class="op" id="7407630">[</span><span class="builtintype" id="7407631">string</span><span class="op" id="7407637">]</span><span class="builtintype" id="7407638">bool</span><span class="op" id="7407642">{</span><span class="string" id="7407643">&#34;tag1&#34;</span><span class="op" id="7407649">:</span>&nbsp;<span class="builtintype" id="7407651">true</span><span class="op" id="7407655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407659">const</span>&nbsp;<span class="ident" id="7407665">file2</span>&nbsp;<span class="op" id="7407671">=</span>&nbsp;<span class="string" id="7407673">&#34;//&nbsp;+build&nbsp;cgo\n\n&#34;</span>&nbsp;<span class="op" id="7407693">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407697">&#34;//&nbsp;This&nbsp;package&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;tags&nbsp;like\n&#34;</span>&nbsp;<span class="op" id="7407749">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407753">&#34;//&nbsp;+build&nbsp;tag1\n&#34;</span>&nbsp;<span class="op" id="7407772">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407776">&#34;package&nbsp;build&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7407793">want2</span>&nbsp;<span class="op" id="7407799">:=</span>&nbsp;<span class="keyword" id="7407802">map</span><span class="op" id="7407805">[</span><span class="builtintype" id="7407806">string</span><span class="op" id="7407812">]</span><span class="builtintype" id="7407813">bool</span><span class="op" id="7407817">{</span><span class="string" id="7407818">&#34;cgo&#34;</span><span class="op" id="7407823">:</span>&nbsp;<span class="builtintype" id="7407825">true</span><span class="op" id="7407829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7407833">const</span>&nbsp;<span class="ident" id="7407839">file3</span>&nbsp;<span class="op" id="7407845">=</span>&nbsp;<span class="string" id="7407847">&#34;//&nbsp;Copyright&nbsp;The&nbsp;Go&nbsp;Authors.\n\n&#34;</span>&nbsp;<span class="op" id="7407882">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407886">&#34;package&nbsp;build\n\n&#34;</span>&nbsp;<span class="op" id="7407906">+</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407910">&#34;//&nbsp;shouldBuild&nbsp;checks&nbsp;tags&nbsp;given&nbsp;by&nbsp;lines&nbsp;of&nbsp;the&nbsp;form\n&#34;</span>&nbsp;<span class="op" id="7407968">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407972">&#34;//&nbsp;+build&nbsp;tag\n&#34;</span>&nbsp;<span class="op" id="7407990">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7407994">&#34;func&nbsp;shouldBuild(content&nbsp;[]byte)\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408032">want3</span>&nbsp;<span class="op" id="7408038">:=</span>&nbsp;<span class="keyword" id="7408041">map</span><span class="op" id="7408044">[</span><span class="builtintype" id="7408045">string</span><span class="op" id="7408051">]</span><span class="builtintype" id="7408052">bool</span><span class="op" id="7408056">{</span><span class="op" id="7408057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408061">ctx</span>&nbsp;<span class="op" id="7408065">:=</span>&nbsp;<span class="op" id="7408068">&amp;</span><span class="ident" id="7408069">Context</span><span class="op" id="7408076">{</span><span class="ident" id="7408077">BuildTags</span><span class="op" id="7408086">:</span>&nbsp;<span class="op" id="7408088">[</span><span class="op" id="7408089">]</span><span class="builtintype" id="7408090">string</span><span class="op" id="7408096">{</span><span class="string" id="7408097">&#34;tag1&#34;</span><span class="op" id="7408103">}</span><span class="op" id="7408104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408107">m</span>&nbsp;<span class="op" id="7408109">:=</span>&nbsp;<span class="keyword" id="7408112">map</span><span class="op" id="7408115">[</span><span class="builtintype" id="7408116">string</span><span class="op" id="7408122">]</span><span class="builtintype" id="7408123">bool</span><span class="op" id="7408127">{</span><span class="op" id="7408128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408131">if</span>&nbsp;<span class="op" id="7408134">!</span><span class="ident" id="7408135">ctx</span><span class="op" id="7408138">.</span><span class="ident" id="7408139">shouldBuild</span><span class="op" id="7408150">(</span><span class="op" id="7408151">[</span><span class="op" id="7408152">]</span><span class="builtintype" id="7408153">byte</span><span class="op" id="7408157">(</span><span class="ident" id="7408158">file1</span><span class="op" id="7408163">)</span><span class="op" id="7408164">,</span>&nbsp;<span class="ident" id="7408166">m</span><span class="op" id="7408167">)</span>&nbsp;<span class="op" id="7408169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408173">t</span><span class="op" id="7408174">.</span><span class="ident" id="7408175">Errorf</span><span class="op" id="7408181">(</span><span class="string" id="7408182">&#34;shouldBuild(file1)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7408221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408224">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408227">if</span>&nbsp;<span class="op" id="7408230">!</span><span class="ident" id="7408231">reflect</span><span class="op" id="7408238">.</span><span class="ident" id="7408239">DeepEqual</span><span class="op" id="7408248">(</span><span class="ident" id="7408249">m</span><span class="op" id="7408250">,</span>&nbsp;<span class="ident" id="7408252">want1</span><span class="op" id="7408257">)</span>&nbsp;<span class="op" id="7408259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408263">t</span><span class="op" id="7408264">.</span><span class="ident" id="7408265">Errorf</span><span class="op" id="7408271">(</span><span class="string" id="7408272">&#34;shoudBuild(file1)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7408310">,</span>&nbsp;<span class="ident" id="7408312">m</span><span class="op" id="7408313">,</span>&nbsp;<span class="ident" id="7408315">want1</span><span class="op" id="7408320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408327">m</span>&nbsp;<span class="op" id="7408329">=</span>&nbsp;<span class="keyword" id="7408331">map</span><span class="op" id="7408334">[</span><span class="builtintype" id="7408335">string</span><span class="op" id="7408341">]</span><span class="builtintype" id="7408342">bool</span><span class="op" id="7408346">{</span><span class="op" id="7408347">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408350">if</span>&nbsp;<span class="ident" id="7408353">ctx</span><span class="op" id="7408356">.</span><span class="ident" id="7408357">shouldBuild</span><span class="op" id="7408368">(</span><span class="op" id="7408369">[</span><span class="op" id="7408370">]</span><span class="builtintype" id="7408371">byte</span><span class="op" id="7408375">(</span><span class="ident" id="7408376">file2</span><span class="op" id="7408381">)</span><span class="op" id="7408382">,</span>&nbsp;<span class="ident" id="7408384">m</span><span class="op" id="7408385">)</span>&nbsp;<span class="op" id="7408387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408391">t</span><span class="op" id="7408392">.</span><span class="ident" id="7408393">Errorf</span><span class="op" id="7408399">(</span><span class="string" id="7408400">&#34;shouldBuild(file2)&nbsp;=&nbsp;true,&nbsp;want&nbsp;fakse&#34;</span><span class="op" id="7408439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408445">if</span>&nbsp;<span class="op" id="7408448">!</span><span class="ident" id="7408449">reflect</span><span class="op" id="7408456">.</span><span class="ident" id="7408457">DeepEqual</span><span class="op" id="7408466">(</span><span class="ident" id="7408467">m</span><span class="op" id="7408468">,</span>&nbsp;<span class="ident" id="7408470">want2</span><span class="op" id="7408475">)</span>&nbsp;<span class="op" id="7408477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408481">t</span><span class="op" id="7408482">.</span><span class="ident" id="7408483">Errorf</span><span class="op" id="7408489">(</span><span class="string" id="7408490">&#34;shoudBuild(file2)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7408528">,</span>&nbsp;<span class="ident" id="7408530">m</span><span class="op" id="7408531">,</span>&nbsp;<span class="ident" id="7408533">want2</span><span class="op" id="7408538">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408545">m</span>&nbsp;<span class="op" id="7408547">=</span>&nbsp;<span class="keyword" id="7408549">map</span><span class="op" id="7408552">[</span><span class="builtintype" id="7408553">string</span><span class="op" id="7408559">]</span><span class="builtintype" id="7408560">bool</span><span class="op" id="7408564">{</span><span class="op" id="7408565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408568">ctx</span>&nbsp;<span class="op" id="7408572">=</span>&nbsp;<span class="op" id="7408574">&amp;</span><span class="ident" id="7408575">Context</span><span class="op" id="7408582">{</span><span class="ident" id="7408583">BuildTags</span><span class="op" id="7408592">:</span>&nbsp;<span class="builtintype" id="7408594">nil</span><span class="op" id="7408597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408600">if</span>&nbsp;<span class="op" id="7408603">!</span><span class="ident" id="7408604">ctx</span><span class="op" id="7408607">.</span><span class="ident" id="7408608">shouldBuild</span><span class="op" id="7408619">(</span><span class="op" id="7408620">[</span><span class="op" id="7408621">]</span><span class="builtintype" id="7408622">byte</span><span class="op" id="7408626">(</span><span class="ident" id="7408627">file3</span><span class="op" id="7408632">)</span><span class="op" id="7408633">,</span>&nbsp;<span class="ident" id="7408635">m</span><span class="op" id="7408636">)</span>&nbsp;<span class="op" id="7408638">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408642">t</span><span class="op" id="7408643">.</span><span class="ident" id="7408644">Errorf</span><span class="op" id="7408650">(</span><span class="string" id="7408651">&#34;shouldBuild(file3)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="7408690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408696">if</span>&nbsp;<span class="op" id="7408699">!</span><span class="ident" id="7408700">reflect</span><span class="op" id="7408707">.</span><span class="ident" id="7408708">DeepEqual</span><span class="op" id="7408717">(</span><span class="ident" id="7408718">m</span><span class="op" id="7408719">,</span>&nbsp;<span class="ident" id="7408721">want3</span><span class="op" id="7408726">)</span>&nbsp;<span class="op" id="7408728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408732">t</span><span class="op" id="7408733">.</span><span class="ident" id="7408734">Errorf</span><span class="op" id="7408740">(</span><span class="string" id="7408741">&#34;shoudBuild(file3)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7408779">,</span>&nbsp;<span class="ident" id="7408781">m</span><span class="op" id="7408782">,</span>&nbsp;<span class="ident" id="7408784">want3</span><span class="op" id="7408789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408792">}</span><br>
<span class="lineno">160</span><span class="op" id="7408794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7408797">type</span>&nbsp;<span class="ident" id="7408802">readNopCloser</span>&nbsp;<span class="keyword" id="7408816">struct</span>&nbsp;<span class="op" id="7408823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408826">io</span><span class="op" id="7408828">.</span><span class="ident" id="7408829">Reader</span><br>
<span class="lineno"></span><span class="op" id="7408836">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="7408839">func</span>&nbsp;<span class="op" id="7408844">(</span><span class="ident" id="7408845">r</span>&nbsp;<span class="ident" id="7408847">readNopCloser</span><span class="op" id="7408860">)</span>&nbsp;<span class="ident" id="7408862">Close</span><span class="op" id="7408867">(</span><span class="op" id="7408868">)</span>&nbsp;<span class="builtintype" id="7408870">error</span>&nbsp;<span class="op" id="7408876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7408879">return</span>&nbsp;<span class="builtintype" id="7408886">nil</span><br>
<span class="lineno"></span><span class="op" id="7408890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7408893">var</span>&nbsp;<span class="op" id="7408897">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408900">ctxtP9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7408912">=</span>&nbsp;<span class="ident" id="7408914">Context</span><span class="op" id="7408921">{</span><span class="ident" id="7408922">GOARCH</span><span class="op" id="7408928">:</span>&nbsp;<span class="string" id="7408930">&#34;arm&#34;</span><span class="op" id="7408935">,</span>&nbsp;<span class="ident" id="7408937">GOOS</span><span class="op" id="7408941">:</span>&nbsp;<span class="string" id="7408943">&#34;plan9&#34;</span><span class="op" id="7408950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7408953">ctxtAndroid</span>&nbsp;<span class="op" id="7408965">=</span>&nbsp;<span class="ident" id="7408967">Context</span><span class="op" id="7408974">{</span><span class="ident" id="7408975">GOARCH</span><span class="op" id="7408981">:</span>&nbsp;<span class="string" id="7408983">&#34;arm&#34;</span><span class="op" id="7408988">,</span>&nbsp;<span class="ident" id="7408990">GOOS</span><span class="op" id="7408994">:</span>&nbsp;<span class="string" id="7408996">&#34;android&#34;</span><span class="op" id="7409005">}</span><br>
<span class="lineno"></span><span class="op" id="7409007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7409010">var</span>&nbsp;<span class="ident" id="7409014">matchFileTests</span>&nbsp;<span class="op" id="7409029">=</span>&nbsp;<span class="op" id="7409031">[</span><span class="op" id="7409032">]</span><span class="keyword" id="7409033">struct</span>&nbsp;<span class="op" id="7409040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409043">ctxt</span>&nbsp;&nbsp;<span class="ident" id="7409049">Context</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409058">name</span>&nbsp;&nbsp;<span class="builtintype" id="7409064">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409072">data</span>&nbsp;&nbsp;<span class="builtintype" id="7409078">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409086">match</span>&nbsp;<span class="builtintype" id="7409092">bool</span><br>
<span class="lineno">180</span><span class="op" id="7409097">}</span><span class="op" id="7409098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409101">{</span><span class="ident" id="7409102">ctxtP9</span><span class="op" id="7409108">,</span>&nbsp;<span class="string" id="7409110">&#34;foo_arm.go&#34;</span><span class="op" id="7409122">,</span>&nbsp;<span class="string" id="7409124">&#34;&#34;</span><span class="op" id="7409126">,</span>&nbsp;<span class="builtintype" id="7409128">true</span><span class="op" id="7409132">}</span><span class="op" id="7409133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409136">{</span><span class="ident" id="7409137">ctxtP9</span><span class="op" id="7409143">,</span>&nbsp;<span class="string" id="7409145">&#34;foo1_arm.go&#34;</span><span class="op" id="7409158">,</span>&nbsp;<span class="string" id="7409160">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7409195">,</span>&nbsp;<span class="builtintype" id="7409197">false</span><span class="op" id="7409202">}</span><span class="op" id="7409203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409206">{</span><span class="ident" id="7409207">ctxtP9</span><span class="op" id="7409213">,</span>&nbsp;<span class="string" id="7409215">&#34;foo_darwin.go&#34;</span><span class="op" id="7409230">,</span>&nbsp;<span class="string" id="7409232">&#34;&#34;</span><span class="op" id="7409234">,</span>&nbsp;<span class="builtintype" id="7409236">false</span><span class="op" id="7409241">}</span><span class="op" id="7409242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409245">{</span><span class="ident" id="7409246">ctxtP9</span><span class="op" id="7409252">,</span>&nbsp;<span class="string" id="7409254">&#34;foo.go&#34;</span><span class="op" id="7409262">,</span>&nbsp;<span class="string" id="7409264">&#34;&#34;</span><span class="op" id="7409266">,</span>&nbsp;<span class="builtintype" id="7409268">true</span><span class="op" id="7409272">}</span><span class="op" id="7409273">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409276">{</span><span class="ident" id="7409277">ctxtP9</span><span class="op" id="7409283">,</span>&nbsp;<span class="string" id="7409285">&#34;foo1.go&#34;</span><span class="op" id="7409294">,</span>&nbsp;<span class="string" id="7409296">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="7409331">,</span>&nbsp;<span class="builtintype" id="7409333">false</span><span class="op" id="7409338">}</span><span class="op" id="7409339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409342">{</span><span class="ident" id="7409343">ctxtP9</span><span class="op" id="7409349">,</span>&nbsp;<span class="string" id="7409351">&#34;foo.badsuffix&#34;</span><span class="op" id="7409366">,</span>&nbsp;<span class="string" id="7409368">&#34;&#34;</span><span class="op" id="7409370">,</span>&nbsp;<span class="builtintype" id="7409372">false</span><span class="op" id="7409377">}</span><span class="op" id="7409378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409381">{</span><span class="ident" id="7409382">ctxtAndroid</span><span class="op" id="7409393">,</span>&nbsp;<span class="string" id="7409395">&#34;foo_linux.go&#34;</span><span class="op" id="7409409">,</span>&nbsp;<span class="string" id="7409411">&#34;&#34;</span><span class="op" id="7409413">,</span>&nbsp;<span class="builtintype" id="7409415">true</span><span class="op" id="7409419">}</span><span class="op" id="7409420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409423">{</span><span class="ident" id="7409424">ctxtAndroid</span><span class="op" id="7409435">,</span>&nbsp;<span class="string" id="7409437">&#34;foo_android.go&#34;</span><span class="op" id="7409453">,</span>&nbsp;<span class="string" id="7409455">&#34;&#34;</span><span class="op" id="7409457">,</span>&nbsp;<span class="builtintype" id="7409459">true</span><span class="op" id="7409463">}</span><span class="op" id="7409464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409467">{</span><span class="ident" id="7409468">ctxtAndroid</span><span class="op" id="7409479">,</span>&nbsp;<span class="string" id="7409481">&#34;foo_plan9.go&#34;</span><span class="op" id="7409495">,</span>&nbsp;<span class="string" id="7409497">&#34;&#34;</span><span class="op" id="7409499">,</span>&nbsp;<span class="builtintype" id="7409501">false</span><span class="op" id="7409506">}</span><span class="op" id="7409507">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409510">{</span><span class="ident" id="7409511">ctxtAndroid</span><span class="op" id="7409522">,</span>&nbsp;<span class="string" id="7409524">&#34;android.go&#34;</span><span class="op" id="7409536">,</span>&nbsp;<span class="string" id="7409538">&#34;&#34;</span><span class="op" id="7409540">,</span>&nbsp;<span class="builtintype" id="7409542">true</span><span class="op" id="7409546">}</span><span class="op" id="7409547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409550">{</span><span class="ident" id="7409551">ctxtAndroid</span><span class="op" id="7409562">,</span>&nbsp;<span class="string" id="7409564">&#34;plan9.go&#34;</span><span class="op" id="7409574">,</span>&nbsp;<span class="string" id="7409576">&#34;&#34;</span><span class="op" id="7409578">,</span>&nbsp;<span class="builtintype" id="7409580">true</span><span class="op" id="7409584">}</span><span class="op" id="7409585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409588">{</span><span class="ident" id="7409589">ctxtAndroid</span><span class="op" id="7409600">,</span>&nbsp;<span class="string" id="7409602">&#34;plan9_test.go&#34;</span><span class="op" id="7409617">,</span>&nbsp;<span class="string" id="7409619">&#34;&#34;</span><span class="op" id="7409621">,</span>&nbsp;<span class="builtintype" id="7409623">true</span><span class="op" id="7409627">}</span><span class="op" id="7409628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409631">{</span><span class="ident" id="7409632">ctxtAndroid</span><span class="op" id="7409643">,</span>&nbsp;<span class="string" id="7409645">&#34;arm.s&#34;</span><span class="op" id="7409652">,</span>&nbsp;<span class="string" id="7409654">&#34;&#34;</span><span class="op" id="7409656">,</span>&nbsp;<span class="builtintype" id="7409658">true</span><span class="op" id="7409662">}</span><span class="op" id="7409663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409666">{</span><span class="ident" id="7409667">ctxtAndroid</span><span class="op" id="7409678">,</span>&nbsp;<span class="string" id="7409680">&#34;amd64.s&#34;</span><span class="op" id="7409689">,</span>&nbsp;<span class="string" id="7409691">&#34;&#34;</span><span class="op" id="7409693">,</span>&nbsp;<span class="builtintype" id="7409695">true</span><span class="op" id="7409699">}</span><span class="op" id="7409700">,</span><br>
<span class="lineno">195</span><span class="op" id="7409702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7409705">func</span>&nbsp;<span class="ident" id="7409710">TestMatchFile</span><span class="op" id="7409723">(</span><span class="ident" id="7409724">t</span>&nbsp;<span class="op" id="7409726">*</span><span class="ident" id="7409727">testing</span><span class="op" id="7409734">.</span><span class="ident" id="7409735">T</span><span class="op" id="7409736">)</span>&nbsp;<span class="op" id="7409738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409741">for</span>&nbsp;<span class="ident" id="7409745">_</span><span class="op" id="7409746">,</span>&nbsp;<span class="ident" id="7409748">tt</span>&nbsp;<span class="op" id="7409751">:=</span>&nbsp;<span class="keyword" id="7409754">range</span>&nbsp;<span class="ident" id="7409760">matchFileTests</span>&nbsp;<span class="op" id="7409775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409779">ctxt</span>&nbsp;<span class="op" id="7409784">:=</span>&nbsp;<span class="ident" id="7409787">tt</span><span class="op" id="7409789">.</span><span class="ident" id="7409790">ctxt</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409797">ctxt</span><span class="op" id="7409801">.</span><span class="ident" id="7409802">OpenFile</span>&nbsp;<span class="op" id="7409811">=</span>&nbsp;<span class="keyword" id="7409813">func</span><span class="op" id="7409817">(</span><span class="ident" id="7409818">path</span>&nbsp;<span class="builtintype" id="7409823">string</span><span class="op" id="7409829">)</span>&nbsp;<span class="op" id="7409831">(</span><span class="ident" id="7409832">r</span>&nbsp;<span class="ident" id="7409834">io</span><span class="op" id="7409836">.</span><span class="ident" id="7409837">ReadCloser</span><span class="op" id="7409847">,</span>&nbsp;<span class="ident" id="7409849">err</span>&nbsp;<span class="builtintype" id="7409853">error</span><span class="op" id="7409858">)</span>&nbsp;<span class="op" id="7409860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409865">if</span>&nbsp;<span class="ident" id="7409868">path</span>&nbsp;<span class="op" id="7409873">!=</span>&nbsp;<span class="string" id="7409876">&#34;x+&#34;</span><span class="op" id="7409880">+</span><span class="ident" id="7409881">tt</span><span class="op" id="7409883">.</span><span class="ident" id="7409884">name</span>&nbsp;<span class="op" id="7409889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7409895">t</span><span class="op" id="7409896">.</span><span class="ident" id="7409897">Fatalf</span><span class="op" id="7409903">(</span><span class="string" id="7409904">&#34;OpenFile&nbsp;asked&nbsp;for&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7409940">,</span>&nbsp;<span class="ident" id="7409942">path</span><span class="op" id="7409946">,</span>&nbsp;<span class="string" id="7409948">&#34;x+&#34;</span><span class="op" id="7409952">+</span><span class="ident" id="7409953">tt</span><span class="op" id="7409955">.</span><span class="ident" id="7409956">name</span><span class="op" id="7409960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7409965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7409970">return</span>&nbsp;<span class="op" id="7409977">&amp;</span><span class="ident" id="7409978">readNopCloser</span><span class="op" id="7409991">{</span><span class="ident" id="7409992">strings</span><span class="op" id="7409999">.</span><span class="ident" id="7410000">NewReader</span><span class="op" id="7410009">(</span><span class="ident" id="7410010">tt</span><span class="op" id="7410012">.</span><span class="ident" id="7410013">data</span><span class="op" id="7410017">)</span><span class="op" id="7410018">}</span><span class="op" id="7410019">,</span>&nbsp;<span class="builtintype" id="7410021">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410031">ctxt</span><span class="op" id="7410035">.</span><span class="ident" id="7410036">JoinPath</span>&nbsp;<span class="op" id="7410045">=</span>&nbsp;<span class="keyword" id="7410047">func</span><span class="op" id="7410051">(</span><span class="ident" id="7410052">elem</span>&nbsp;<span class="op" id="7410057">...</span><span class="builtintype" id="7410060">string</span><span class="op" id="7410066">)</span>&nbsp;<span class="builtintype" id="7410068">string</span>&nbsp;<span class="op" id="7410075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410080">return</span>&nbsp;<span class="ident" id="7410087">strings</span><span class="op" id="7410094">.</span><span class="ident" id="7410095">Join</span><span class="op" id="7410099">(</span><span class="ident" id="7410100">elem</span><span class="op" id="7410104">,</span>&nbsp;<span class="string" id="7410106">&#34;+&#34;</span><span class="op" id="7410109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410117">match</span><span class="op" id="7410122">,</span>&nbsp;<span class="ident" id="7410124">err</span>&nbsp;<span class="op" id="7410128">:=</span>&nbsp;<span class="ident" id="7410131">ctxt</span><span class="op" id="7410135">.</span><span class="ident" id="7410136">MatchFile</span><span class="op" id="7410145">(</span><span class="string" id="7410146">&#34;x&#34;</span><span class="op" id="7410149">,</span>&nbsp;<span class="ident" id="7410151">tt</span><span class="op" id="7410153">.</span><span class="ident" id="7410154">name</span><span class="op" id="7410158">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410162">if</span>&nbsp;<span class="ident" id="7410165">match</span>&nbsp;<span class="op" id="7410171">!=</span>&nbsp;<span class="ident" id="7410174">tt</span><span class="op" id="7410176">.</span><span class="ident" id="7410177">match</span>&nbsp;<span class="op" id="7410183">||</span>&nbsp;<span class="ident" id="7410186">err</span>&nbsp;<span class="op" id="7410190">!=</span>&nbsp;<span class="builtintype" id="7410193">nil</span>&nbsp;<span class="op" id="7410197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410202">t</span><span class="op" id="7410203">.</span><span class="ident" id="7410204">Fatalf</span><span class="op" id="7410210">(</span><span class="string" id="7410211">&#34;MatchFile(%q)&nbsp;=&nbsp;%v,&nbsp;%v,&nbsp;want&nbsp;%v,&nbsp;nil&#34;</span><span class="op" id="7410249">,</span>&nbsp;<span class="ident" id="7410251">tt</span><span class="op" id="7410253">.</span><span class="ident" id="7410254">name</span><span class="op" id="7410258">,</span>&nbsp;<span class="ident" id="7410260">match</span><span class="op" id="7410265">,</span>&nbsp;<span class="ident" id="7410267">err</span><span class="op" id="7410270">,</span>&nbsp;<span class="ident" id="7410272">tt</span><span class="op" id="7410274">.</span><span class="ident" id="7410275">match</span><span class="op" id="7410280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410287">}</span><br>
<span class="lineno"></span><span class="op" id="7410289">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7410292">func</span>&nbsp;<span class="ident" id="7410297">TestImportCmd</span><span class="op" id="7410310">(</span><span class="ident" id="7410311">t</span>&nbsp;<span class="op" id="7410313">*</span><span class="ident" id="7410314">testing</span><span class="op" id="7410321">.</span><span class="ident" id="7410322">T</span><span class="op" id="7410323">)</span>&nbsp;<span class="op" id="7410325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410328">p</span><span class="op" id="7410329">,</span>&nbsp;<span class="ident" id="7410331">err</span>&nbsp;<span class="op" id="7410335">:=</span>&nbsp;<span class="ident" id="7410338">Import</span><span class="op" id="7410344">(</span><span class="string" id="7410345">&#34;cmd/internal/objfile&#34;</span><span class="op" id="7410367">,</span>&nbsp;<span class="string" id="7410369">&#34;&#34;</span><span class="op" id="7410371">,</span>&nbsp;<span class="num" id="7410373">0</span><span class="op" id="7410374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410377">if</span>&nbsp;<span class="ident" id="7410380">err</span>&nbsp;<span class="op" id="7410384">!=</span>&nbsp;<span class="builtintype" id="7410387">nil</span>&nbsp;<span class="op" id="7410391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410395">t</span><span class="op" id="7410396">.</span><span class="ident" id="7410397">Fatal</span><span class="op" id="7410402">(</span><span class="ident" id="7410403">err</span><span class="op" id="7410406">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7410412">if</span>&nbsp;<span class="op" id="7410415">!</span><span class="ident" id="7410416">strings</span><span class="op" id="7410423">.</span><span class="ident" id="7410424">HasSuffix</span><span class="op" id="7410433">(</span><span class="ident" id="7410434">filepath</span><span class="op" id="7410442">.</span><span class="ident" id="7410443">ToSlash</span><span class="op" id="7410450">(</span><span class="ident" id="7410451">p</span><span class="op" id="7410452">.</span><span class="ident" id="7410453">Dir</span><span class="op" id="7410456">)</span><span class="op" id="7410457">,</span>&nbsp;<span class="string" id="7410459">&#34;src/cmd/internal/objfile&#34;</span><span class="op" id="7410485">)</span>&nbsp;<span class="op" id="7410487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7410491">t</span><span class="op" id="7410492">.</span><span class="ident" id="7410493">Fatalf</span><span class="op" id="7410499">(</span><span class="string" id="7410500">&#34;Import&nbsp;cmd/internal/objfile&nbsp;returned&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7410554">,</span>&nbsp;<span class="ident" id="7410556">filepath</span><span class="op" id="7410564">.</span><span class="ident" id="7410565">ToSlash</span><span class="op" id="7410572">(</span><span class="ident" id="7410573">p</span><span class="op" id="7410574">.</span><span class="ident" id="7410575">Dir</span><span class="op" id="7410578">)</span><span class="op" id="7410579">,</span>&nbsp;<span class="string" id="7410581">&#34;.../src/cmd/internal/objfile&#34;</span><span class="op" id="7410611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7410614">}</span><br>
<span class="lineno"></span><span class="op" id="7410616">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
