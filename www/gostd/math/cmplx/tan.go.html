<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6233587">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6233642">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6233696">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6233747">package</span>&nbsp;<span class="ident" id="6233755">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6233762">import</span>&nbsp;<span class="string" id="6233769">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6233777">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6233837">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6233907">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6233965">//</span><br>
<span class="lineno"></span><span class="comment" id="6233968">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6234016">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6234080">//</span><br>
<span class="lineno"></span><span class="comment" id="6234083">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6234144">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6234214">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6234289">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6234356">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6234429">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6234501">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6234515">//</span><br>
<span class="lineno"></span><span class="comment" id="6234518">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6234584">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6234650">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6234663">//</span><br>
<span class="lineno"></span><span class="comment" id="6234666">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6234690">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6234720">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6234748">//</span><br>
<span class="lineno"></span><span class="comment" id="6234751">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6234767">//</span><br>
<span class="lineno">35</span><span class="comment" id="6234770">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6234776">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6234795">//</span><br>
<span class="lineno"></span><span class="comment" id="6234798">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6234806">//</span><br>
<span class="lineno">40</span><span class="comment" id="6234809">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6234843">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="6234878">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6234911">//</span><br>
<span class="lineno"></span><span class="comment" id="6234914">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="6234975">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="6235031">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="6235060">//</span><br>
<span class="lineno"></span><span class="comment" id="6235063">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="6235090">//</span><br>
<span class="lineno">50</span><span class="comment" id="6235093">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6235106">//</span><br>
<span class="lineno"></span><span class="comment" id="6235109">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6235149">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6235207">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="6235267">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6235327">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6235388">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6235421">func</span>&nbsp;<span class="ident" id="6235426">Tan</span><span class="op" id="6235429">(</span><span class="ident" id="6235430">x</span>&nbsp;<span class="builtintype" id="6235432">complex128</span><span class="op" id="6235442">)</span>&nbsp;<span class="builtintype" id="6235444">complex128</span>&nbsp;<span class="op" id="6235455">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235458">d</span>&nbsp;<span class="op" id="6235460">:=</span>&nbsp;<span class="ident" id="6235463">math</span><span class="op" id="6235467">.</span><span class="ident" id="6235468">Cos</span><span class="op" id="6235471">(</span><span class="num" id="6235472">2</span><span class="op" id="6235473">*</span><span class="builtinfunc" id="6235474">real</span><span class="op" id="6235478">(</span><span class="ident" id="6235479">x</span><span class="op" id="6235480">)</span><span class="op" id="6235481">)</span>&nbsp;<span class="op" id="6235483">+</span>&nbsp;<span class="ident" id="6235485">math</span><span class="op" id="6235489">.</span><span class="ident" id="6235490">Cosh</span><span class="op" id="6235494">(</span><span class="num" id="6235495">2</span><span class="op" id="6235496">*</span><span class="builtinfunc" id="6235497">imag</span><span class="op" id="6235501">(</span><span class="ident" id="6235502">x</span><span class="op" id="6235503">)</span><span class="op" id="6235504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235507">if</span>&nbsp;<span class="ident" id="6235510">math</span><span class="op" id="6235514">.</span><span class="ident" id="6235515">Abs</span><span class="op" id="6235518">(</span><span class="ident" id="6235519">d</span><span class="op" id="6235520">)</span>&nbsp;<span class="op" id="6235522">&lt;</span>&nbsp;<span class="num" id="6235524">0.25</span>&nbsp;<span class="op" id="6235529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235533">d</span>&nbsp;<span class="op" id="6235535">=</span>&nbsp;<span class="ident" id="6235537">tanSeries</span><span class="op" id="6235546">(</span><span class="ident" id="6235547">x</span><span class="op" id="6235548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235554">if</span>&nbsp;<span class="ident" id="6235557">d</span>&nbsp;<span class="op" id="6235559">==</span>&nbsp;<span class="num" id="6235562">0</span>&nbsp;<span class="op" id="6235564">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235568">return</span>&nbsp;<span class="ident" id="6235575">Inf</span><span class="op" id="6235578">(</span><span class="op" id="6235579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235585">return</span>&nbsp;<span class="builtinfunc" id="6235592">complex</span><span class="op" id="6235599">(</span><span class="ident" id="6235600">math</span><span class="op" id="6235604">.</span><span class="ident" id="6235605">Sin</span><span class="op" id="6235608">(</span><span class="num" id="6235609">2</span><span class="op" id="6235610">*</span><span class="builtinfunc" id="6235611">real</span><span class="op" id="6235615">(</span><span class="ident" id="6235616">x</span><span class="op" id="6235617">)</span><span class="op" id="6235618">)</span><span class="op" id="6235619">/</span><span class="ident" id="6235620">d</span><span class="op" id="6235621">,</span>&nbsp;<span class="ident" id="6235623">math</span><span class="op" id="6235627">.</span><span class="ident" id="6235628">Sinh</span><span class="op" id="6235632">(</span><span class="num" id="6235633">2</span><span class="op" id="6235634">*</span><span class="builtinfunc" id="6235635">imag</span><span class="op" id="6235639">(</span><span class="ident" id="6235640">x</span><span class="op" id="6235641">)</span><span class="op" id="6235642">)</span><span class="op" id="6235643">/</span><span class="ident" id="6235644">d</span><span class="op" id="6235645">)</span><br>
<span class="lineno"></span><span class="op" id="6235647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6235650">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6235680">//</span><br>
<span class="lineno"></span><span class="comment" id="6235683">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6235699">//</span><br>
<span class="lineno"></span><span class="comment" id="6235702">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="6235760">//</span><br>
<span class="lineno"></span><span class="comment" id="6235763">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6235776">//</span><br>
<span class="lineno"></span><span class="comment" id="6235779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6235819">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="6235877">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6235938">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6235983">func</span>&nbsp;<span class="ident" id="6235988">Tanh</span><span class="op" id="6235992">(</span><span class="ident" id="6235993">x</span>&nbsp;<span class="builtintype" id="6235995">complex128</span><span class="op" id="6236005">)</span>&nbsp;<span class="builtintype" id="6236007">complex128</span>&nbsp;<span class="op" id="6236018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236021">d</span>&nbsp;<span class="op" id="6236023">:=</span>&nbsp;<span class="ident" id="6236026">math</span><span class="op" id="6236030">.</span><span class="ident" id="6236031">Cosh</span><span class="op" id="6236035">(</span><span class="num" id="6236036">2</span><span class="op" id="6236037">*</span><span class="builtinfunc" id="6236038">real</span><span class="op" id="6236042">(</span><span class="ident" id="6236043">x</span><span class="op" id="6236044">)</span><span class="op" id="6236045">)</span>&nbsp;<span class="op" id="6236047">+</span>&nbsp;<span class="ident" id="6236049">math</span><span class="op" id="6236053">.</span><span class="ident" id="6236054">Cos</span><span class="op" id="6236057">(</span><span class="num" id="6236058">2</span><span class="op" id="6236059">*</span><span class="builtinfunc" id="6236060">imag</span><span class="op" id="6236064">(</span><span class="ident" id="6236065">x</span><span class="op" id="6236066">)</span><span class="op" id="6236067">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236070">if</span>&nbsp;<span class="ident" id="6236073">d</span>&nbsp;<span class="op" id="6236075">==</span>&nbsp;<span class="num" id="6236078">0</span>&nbsp;<span class="op" id="6236080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236084">return</span>&nbsp;<span class="ident" id="6236091">Inf</span><span class="op" id="6236094">(</span><span class="op" id="6236095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236101">return</span>&nbsp;<span class="builtinfunc" id="6236108">complex</span><span class="op" id="6236115">(</span><span class="ident" id="6236116">math</span><span class="op" id="6236120">.</span><span class="ident" id="6236121">Sinh</span><span class="op" id="6236125">(</span><span class="num" id="6236126">2</span><span class="op" id="6236127">*</span><span class="builtinfunc" id="6236128">real</span><span class="op" id="6236132">(</span><span class="ident" id="6236133">x</span><span class="op" id="6236134">)</span><span class="op" id="6236135">)</span><span class="op" id="6236136">/</span><span class="ident" id="6236137">d</span><span class="op" id="6236138">,</span>&nbsp;<span class="ident" id="6236140">math</span><span class="op" id="6236144">.</span><span class="ident" id="6236145">Sin</span><span class="op" id="6236148">(</span><span class="num" id="6236149">2</span><span class="op" id="6236150">*</span><span class="builtinfunc" id="6236151">imag</span><span class="op" id="6236155">(</span><span class="ident" id="6236156">x</span><span class="op" id="6236157">)</span><span class="op" id="6236158">)</span><span class="op" id="6236159">/</span><span class="ident" id="6236160">d</span><span class="op" id="6236161">)</span><br>
<span class="lineno"></span><span class="op" id="6236163">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="6236166">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="6236220">func</span>&nbsp;<span class="ident" id="6236225">reducePi</span><span class="op" id="6236233">(</span><span class="ident" id="6236234">x</span>&nbsp;<span class="builtintype" id="6236236">float64</span><span class="op" id="6236243">)</span>&nbsp;<span class="builtintype" id="6236245">float64</span>&nbsp;<span class="op" id="6236253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236256">const</span>&nbsp;<span class="op" id="6236262">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6236266">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236303">DP1</span>&nbsp;<span class="op" id="6236307">=</span>&nbsp;<span class="num" id="6236309">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236336">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236363">DP2</span>&nbsp;<span class="op" id="6236367">=</span>&nbsp;<span class="num" id="6236369">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="6236396">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236423">DP3</span>&nbsp;<span class="op" id="6236427">=</span>&nbsp;<span class="num" id="6236429">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="6236456">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236485">t</span>&nbsp;<span class="op" id="6236487">:=</span>&nbsp;<span class="ident" id="6236490">x</span>&nbsp;<span class="op" id="6236492">/</span>&nbsp;<span class="ident" id="6236494">math</span><span class="op" id="6236498">.</span><span class="ident" id="6236499">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236503">if</span>&nbsp;<span class="ident" id="6236506">t</span>&nbsp;<span class="op" id="6236508">&gt;=</span>&nbsp;<span class="num" id="6236511">0</span>&nbsp;<span class="op" id="6236513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236517">t</span>&nbsp;<span class="op" id="6236519">+=</span>&nbsp;<span class="num" id="6236522">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236527">}</span>&nbsp;<span class="keyword" id="6236529">else</span>&nbsp;<span class="op" id="6236534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236538">t</span>&nbsp;<span class="op" id="6236540">-=</span>&nbsp;<span class="num" id="6236543">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6236548">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236551">t</span>&nbsp;<span class="op" id="6236553">=</span>&nbsp;<span class="builtintype" id="6236555">float64</span><span class="op" id="6236562">(</span><span class="ident" id="6236563">int64</span><span class="op" id="6236568">(</span><span class="ident" id="6236569">t</span><span class="op" id="6236570">)</span><span class="op" id="6236571">)</span>&nbsp;<span class="comment" id="6236573">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236601">return</span>&nbsp;<span class="op" id="6236608">(</span><span class="op" id="6236609">(</span><span class="ident" id="6236610">x</span>&nbsp;<span class="op" id="6236612">-</span>&nbsp;<span class="ident" id="6236614">t</span><span class="op" id="6236615">*</span><span class="ident" id="6236616">DP1</span><span class="op" id="6236619">)</span>&nbsp;<span class="op" id="6236621">-</span>&nbsp;<span class="ident" id="6236623">t</span><span class="op" id="6236624">*</span><span class="ident" id="6236625">DP2</span><span class="op" id="6236628">)</span>&nbsp;<span class="op" id="6236630">-</span>&nbsp;<span class="ident" id="6236632">t</span><span class="op" id="6236633">*</span><span class="ident" id="6236634">DP3</span><br>
<span class="lineno"></span><span class="op" id="6236638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6236641">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="6236691">func</span>&nbsp;<span class="ident" id="6236696">tanSeries</span><span class="op" id="6236705">(</span><span class="ident" id="6236706">z</span>&nbsp;<span class="builtintype" id="6236708">complex128</span><span class="op" id="6236718">)</span>&nbsp;<span class="builtintype" id="6236720">float64</span>&nbsp;<span class="op" id="6236728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236731">const</span>&nbsp;<span class="ident" id="6236737">MACHEP</span>&nbsp;<span class="op" id="6236744">=</span>&nbsp;<span class="num" id="6236746">1.0</span>&nbsp;<span class="op" id="6236750">/</span>&nbsp;<span class="op" id="6236752">(</span><span class="num" id="6236753">1</span>&nbsp;<span class="op" id="6236755">&lt;&lt;</span>&nbsp;<span class="num" id="6236758">53</span><span class="op" id="6236760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236763">x</span>&nbsp;<span class="op" id="6236765">:=</span>&nbsp;<span class="ident" id="6236768">math</span><span class="op" id="6236772">.</span><span class="ident" id="6236773">Abs</span><span class="op" id="6236776">(</span><span class="num" id="6236777">2</span>&nbsp;<span class="op" id="6236779">*</span>&nbsp;<span class="builtinfunc" id="6236781">real</span><span class="op" id="6236785">(</span><span class="ident" id="6236786">z</span><span class="op" id="6236787">)</span><span class="op" id="6236788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236791">y</span>&nbsp;<span class="op" id="6236793">:=</span>&nbsp;<span class="ident" id="6236796">math</span><span class="op" id="6236800">.</span><span class="ident" id="6236801">Abs</span><span class="op" id="6236804">(</span><span class="num" id="6236805">2</span>&nbsp;<span class="op" id="6236807">*</span>&nbsp;<span class="builtinfunc" id="6236809">imag</span><span class="op" id="6236813">(</span><span class="ident" id="6236814">z</span><span class="op" id="6236815">)</span><span class="op" id="6236816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236819">x</span>&nbsp;<span class="op" id="6236821">=</span>&nbsp;<span class="ident" id="6236823">reducePi</span><span class="op" id="6236831">(</span><span class="ident" id="6236832">x</span><span class="op" id="6236833">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236836">x</span>&nbsp;<span class="op" id="6236838">=</span>&nbsp;<span class="ident" id="6236840">x</span>&nbsp;<span class="op" id="6236842">*</span>&nbsp;<span class="ident" id="6236844">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236847">y</span>&nbsp;<span class="op" id="6236849">=</span>&nbsp;<span class="ident" id="6236851">y</span>&nbsp;<span class="op" id="6236853">*</span>&nbsp;<span class="ident" id="6236855">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236858">x2</span>&nbsp;<span class="op" id="6236861">:=</span>&nbsp;<span class="num" id="6236864">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236869">y2</span>&nbsp;<span class="op" id="6236872">:=</span>&nbsp;<span class="num" id="6236875">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236880">f</span>&nbsp;<span class="op" id="6236882">:=</span>&nbsp;<span class="num" id="6236885">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236890">rn</span>&nbsp;<span class="op" id="6236893">:=</span>&nbsp;<span class="num" id="6236896">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236901">d</span>&nbsp;<span class="op" id="6236903">:=</span>&nbsp;<span class="num" id="6236906">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6236911">for</span>&nbsp;<span class="op" id="6236915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236919">rn</span>&nbsp;<span class="op" id="6236922">+=</span>&nbsp;<span class="num" id="6236925">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236929">f</span>&nbsp;<span class="op" id="6236931">*=</span>&nbsp;<span class="ident" id="6236934">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236939">rn</span>&nbsp;<span class="op" id="6236942">+=</span>&nbsp;<span class="num" id="6236945">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236949">f</span>&nbsp;<span class="op" id="6236951">*=</span>&nbsp;<span class="ident" id="6236954">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236959">x2</span>&nbsp;<span class="op" id="6236962">*=</span>&nbsp;<span class="ident" id="6236965">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236969">y2</span>&nbsp;<span class="op" id="6236972">*=</span>&nbsp;<span class="ident" id="6236975">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236979">t</span>&nbsp;<span class="op" id="6236981">:=</span>&nbsp;<span class="ident" id="6236984">y2</span>&nbsp;<span class="op" id="6236987">+</span>&nbsp;<span class="ident" id="6236989">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236994">t</span>&nbsp;<span class="op" id="6236996">/=</span>&nbsp;<span class="ident" id="6236999">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237003">d</span>&nbsp;<span class="op" id="6237005">+=</span>&nbsp;<span class="ident" id="6237008">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237013">rn</span>&nbsp;<span class="op" id="6237016">+=</span>&nbsp;<span class="num" id="6237019">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237023">f</span>&nbsp;<span class="op" id="6237025">*=</span>&nbsp;<span class="ident" id="6237028">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237033">rn</span>&nbsp;<span class="op" id="6237036">+=</span>&nbsp;<span class="num" id="6237039">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237043">f</span>&nbsp;<span class="op" id="6237045">*=</span>&nbsp;<span class="ident" id="6237048">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237053">x2</span>&nbsp;<span class="op" id="6237056">*=</span>&nbsp;<span class="ident" id="6237059">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237063">y2</span>&nbsp;<span class="op" id="6237066">*=</span>&nbsp;<span class="ident" id="6237069">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237073">t</span>&nbsp;<span class="op" id="6237075">=</span>&nbsp;<span class="ident" id="6237077">y2</span>&nbsp;<span class="op" id="6237080">-</span>&nbsp;<span class="ident" id="6237082">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237087">t</span>&nbsp;<span class="op" id="6237089">/=</span>&nbsp;<span class="ident" id="6237092">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237096">d</span>&nbsp;<span class="op" id="6237098">+=</span>&nbsp;<span class="ident" id="6237101">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237105">if</span>&nbsp;<span class="ident" id="6237108">math</span><span class="op" id="6237112">.</span><span class="ident" id="6237113">Abs</span><span class="op" id="6237116">(</span><span class="ident" id="6237117">t</span><span class="op" id="6237118">/</span><span class="ident" id="6237119">d</span><span class="op" id="6237120">)</span>&nbsp;<span class="op" id="6237122">&lt;=</span>&nbsp;<span class="ident" id="6237125">MACHEP</span>&nbsp;<span class="op" id="6237132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237137">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237145">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237151">return</span>&nbsp;<span class="ident" id="6237158">d</span><br>
<span class="lineno"></span><span class="op" id="6237160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6237163">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="6237193">//</span><br>
<span class="lineno"></span><span class="comment" id="6237196">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6237212">//</span><br>
<span class="lineno"></span><span class="comment" id="6237215">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6237221">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="6237240">//</span><br>
<span class="lineno"></span><span class="comment" id="6237243">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6237251">//</span><br>
<span class="lineno"></span><span class="comment" id="6237254">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6237288">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="6237323">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="6237356">//</span><br>
<span class="lineno"></span><span class="comment" id="6237359">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6237414">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="6237471">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="6237494">//</span><br>
<span class="lineno"></span><span class="comment" id="6237497">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6237510">//</span><br>
<span class="lineno"></span><span class="comment" id="6237513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6237553">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="6237611">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="6237671">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6237731">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6237772">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="6237807">func</span>&nbsp;<span class="ident" id="6237812">Cot</span><span class="op" id="6237815">(</span><span class="ident" id="6237816">x</span>&nbsp;<span class="builtintype" id="6237818">complex128</span><span class="op" id="6237828">)</span>&nbsp;<span class="builtintype" id="6237830">complex128</span>&nbsp;<span class="op" id="6237841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237844">d</span>&nbsp;<span class="op" id="6237846">:=</span>&nbsp;<span class="ident" id="6237849">math</span><span class="op" id="6237853">.</span><span class="ident" id="6237854">Cosh</span><span class="op" id="6237858">(</span><span class="num" id="6237859">2</span><span class="op" id="6237860">*</span><span class="builtinfunc" id="6237861">imag</span><span class="op" id="6237865">(</span><span class="ident" id="6237866">x</span><span class="op" id="6237867">)</span><span class="op" id="6237868">)</span>&nbsp;<span class="op" id="6237870">-</span>&nbsp;<span class="ident" id="6237872">math</span><span class="op" id="6237876">.</span><span class="ident" id="6237877">Cos</span><span class="op" id="6237880">(</span><span class="num" id="6237881">2</span><span class="op" id="6237882">*</span><span class="builtinfunc" id="6237883">real</span><span class="op" id="6237887">(</span><span class="ident" id="6237888">x</span><span class="op" id="6237889">)</span><span class="op" id="6237890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237893">if</span>&nbsp;<span class="ident" id="6237896">math</span><span class="op" id="6237900">.</span><span class="ident" id="6237901">Abs</span><span class="op" id="6237904">(</span><span class="ident" id="6237905">d</span><span class="op" id="6237906">)</span>&nbsp;<span class="op" id="6237908">&lt;</span>&nbsp;<span class="num" id="6237910">0.25</span>&nbsp;<span class="op" id="6237915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237919">d</span>&nbsp;<span class="op" id="6237921">=</span>&nbsp;<span class="ident" id="6237923">tanSeries</span><span class="op" id="6237932">(</span><span class="ident" id="6237933">x</span><span class="op" id="6237934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237937">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237940">if</span>&nbsp;<span class="ident" id="6237943">d</span>&nbsp;<span class="op" id="6237945">==</span>&nbsp;<span class="num" id="6237948">0</span>&nbsp;<span class="op" id="6237950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237954">return</span>&nbsp;<span class="ident" id="6237961">Inf</span><span class="op" id="6237964">(</span><span class="op" id="6237965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6237968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6237971">return</span>&nbsp;<span class="builtinfunc" id="6237978">complex</span><span class="op" id="6237985">(</span><span class="ident" id="6237986">math</span><span class="op" id="6237990">.</span><span class="ident" id="6237991">Sin</span><span class="op" id="6237994">(</span><span class="num" id="6237995">2</span><span class="op" id="6237996">*</span><span class="builtinfunc" id="6237997">real</span><span class="op" id="6238001">(</span><span class="ident" id="6238002">x</span><span class="op" id="6238003">)</span><span class="op" id="6238004">)</span><span class="op" id="6238005">/</span><span class="ident" id="6238006">d</span><span class="op" id="6238007">,</span>&nbsp;<span class="op" id="6238009">-</span><span class="ident" id="6238010">math</span><span class="op" id="6238014">.</span><span class="ident" id="6238015">Sinh</span><span class="op" id="6238019">(</span><span class="num" id="6238020">2</span><span class="op" id="6238021">*</span><span class="builtinfunc" id="6238022">imag</span><span class="op" id="6238026">(</span><span class="ident" id="6238027">x</span><span class="op" id="6238028">)</span><span class="op" id="6238029">)</span><span class="op" id="6238030">/</span><span class="ident" id="6238031">d</span><span class="op" id="6238032">)</span><br>
<span class="lineno"></span><span class="op" id="6238034">}</span>
</div>
</body>
</html>
