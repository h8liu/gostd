<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2492417">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2492472">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2492526">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2492577">//&nbsp;Package&nbsp;time&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;measuring&nbsp;and&nbsp;displaying&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2492651">//</span><br>
<span class="lineno"></span><span class="comment" id="2492654">//&nbsp;The&nbsp;calendrical&nbsp;calculations&nbsp;always&nbsp;assume&nbsp;a&nbsp;Gregorian&nbsp;calendar.</span><br>
<span class="lineno"></span><span class="keyword" id="2492722">package</span>&nbsp;<span class="ident" id="2492730">time</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2492736">import</span>&nbsp;<span class="string" id="2492743">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2492753">//&nbsp;A&nbsp;Time&nbsp;represents&nbsp;an&nbsp;instant&nbsp;in&nbsp;time&nbsp;with&nbsp;nanosecond&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="2492820">//</span><br>
<span class="lineno"></span><span class="comment" id="2492823">//&nbsp;Programs&nbsp;using&nbsp;times&nbsp;should&nbsp;typically&nbsp;store&nbsp;and&nbsp;pass&nbsp;them&nbsp;as&nbsp;values,</span><br>
<span class="lineno">15</span><span class="comment" id="2492895">//&nbsp;not&nbsp;pointers.&nbsp;&nbsp;That&nbsp;is,&nbsp;time&nbsp;variables&nbsp;and&nbsp;struct&nbsp;fields&nbsp;should&nbsp;be&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2492968">//&nbsp;type&nbsp;time.Time,&nbsp;not&nbsp;*time.Time.&nbsp;&nbsp;A&nbsp;Time&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2493032">//&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="2493071">//</span><br>
<span class="lineno"></span><span class="comment" id="2493074">//&nbsp;Time&nbsp;instants&nbsp;can&nbsp;be&nbsp;compared&nbsp;using&nbsp;the&nbsp;Before,&nbsp;After,&nbsp;and&nbsp;Equal&nbsp;methods.</span><br>
<span class="lineno">20</span><span class="comment" id="2493151">//&nbsp;The&nbsp;Sub&nbsp;method&nbsp;subtracts&nbsp;two&nbsp;instants,&nbsp;producing&nbsp;a&nbsp;Duration.</span><br>
<span class="lineno"></span><span class="comment" id="2493215">//&nbsp;The&nbsp;Add&nbsp;method&nbsp;adds&nbsp;a&nbsp;Time&nbsp;and&nbsp;a&nbsp;Duration,&nbsp;producing&nbsp;a&nbsp;Time.</span><br>
<span class="lineno"></span><span class="comment" id="2493279">//</span><br>
<span class="lineno"></span><span class="comment" id="2493282">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;Time&nbsp;is&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2493359">//&nbsp;As&nbsp;this&nbsp;time&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;come&nbsp;up&nbsp;in&nbsp;practice,&nbsp;the&nbsp;IsZero&nbsp;method&nbsp;gives</span><br>
<span class="lineno">25</span><span class="comment" id="2493435">//&nbsp;a&nbsp;simple&nbsp;way&nbsp;of&nbsp;detecting&nbsp;a&nbsp;time&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;initialized&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment" id="2493513">//</span><br>
<span class="lineno"></span><span class="comment" id="2493516">//&nbsp;Each&nbsp;Time&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;Location,&nbsp;consulted&nbsp;when&nbsp;computing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2493593">//&nbsp;presentation&nbsp;form&nbsp;of&nbsp;the&nbsp;time,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;Format,&nbsp;Hour,&nbsp;and&nbsp;Year&nbsp;methods.</span><br>
<span class="lineno"></span><span class="comment" id="2493674">//&nbsp;The&nbsp;methods&nbsp;Local,&nbsp;UTC,&nbsp;and&nbsp;In&nbsp;return&nbsp;a&nbsp;Time&nbsp;with&nbsp;a&nbsp;specific&nbsp;location.</span><br>
<span class="lineno">30</span><span class="comment" id="2493748">//&nbsp;Changing&nbsp;the&nbsp;location&nbsp;in&nbsp;this&nbsp;way&nbsp;changes&nbsp;only&nbsp;the&nbsp;presentation;&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2493828">//&nbsp;change&nbsp;the&nbsp;instant&nbsp;in&nbsp;time&nbsp;being&nbsp;denoted&nbsp;and&nbsp;therefore&nbsp;does&nbsp;not&nbsp;affect&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2493906">//&nbsp;computations&nbsp;described&nbsp;in&nbsp;earlier&nbsp;paragraphs.</span><br>
<span class="lineno"></span><span class="comment" id="2493955">//</span><br>
<span class="lineno"></span><span class="comment" id="2493958">//&nbsp;Note&nbsp;that&nbsp;the&nbsp;Go&nbsp;==&nbsp;operator&nbsp;compares&nbsp;not&nbsp;just&nbsp;the&nbsp;time&nbsp;instant&nbsp;but&nbsp;also&nbsp;the</span><br>
<span class="lineno">35</span><span class="comment" id="2494038">//&nbsp;Location.&nbsp;Therefore,&nbsp;Time&nbsp;values&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;as&nbsp;map&nbsp;or&nbsp;database&nbsp;keys</span><br>
<span class="lineno"></span><span class="comment" id="2494117">//&nbsp;without&nbsp;first&nbsp;guaranteeing&nbsp;that&nbsp;the&nbsp;identical&nbsp;Location&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2494196">//&nbsp;values,&nbsp;which&nbsp;can&nbsp;be&nbsp;achieved&nbsp;through&nbsp;use&nbsp;of&nbsp;the&nbsp;UTC&nbsp;or&nbsp;Local&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2494269">//</span><br>
<span class="lineno"></span><span class="keyword" id="2494272">type</span>&nbsp;<span class="ident" id="2494277">Time</span>&nbsp;<span class="keyword" id="2494282">struct</span>&nbsp;<span class="op" id="2494289">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494292">//&nbsp;sec&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed&nbsp;since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494342">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2494378">sec</span>&nbsp;<span class="ident" id="2494382">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494390">//&nbsp;nsec&nbsp;specifies&nbsp;a&nbsp;non-negative&nbsp;nanosecond</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494435">//&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;named&nbsp;by&nbsp;Seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494482">//&nbsp;It&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2494526">nsec</span>&nbsp;<span class="builtintype" id="2494531">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494539">//&nbsp;loc&nbsp;specifies&nbsp;the&nbsp;Location&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494593">//&nbsp;determine&nbsp;the&nbsp;minute,&nbsp;hour,&nbsp;month,&nbsp;day,&nbsp;and&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494646">//&nbsp;that&nbsp;correspond&nbsp;to&nbsp;this&nbsp;Time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494680">//&nbsp;Only&nbsp;the&nbsp;zero&nbsp;Time&nbsp;has&nbsp;a&nbsp;nil&nbsp;Location.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2494723">//&nbsp;In&nbsp;that&nbsp;case&nbsp;it&nbsp;is&nbsp;interpreted&nbsp;to&nbsp;mean&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2494771">loc</span>&nbsp;<span class="op" id="2494775">*</span><span class="ident" id="2494776">Location</span><br>
<span class="lineno">55</span><span class="op" id="2494785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2494788">//&nbsp;After&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;after&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2494844">func</span>&nbsp;<span class="op" id="2494849">(</span><span class="ident" id="2494850">t</span>&nbsp;<span class="ident" id="2494852">Time</span><span class="op" id="2494856">)</span>&nbsp;<span class="ident" id="2494858">After</span><span class="op" id="2494863">(</span><span class="ident" id="2494864">u</span>&nbsp;<span class="ident" id="2494866">Time</span><span class="op" id="2494870">)</span>&nbsp;<span class="builtintype" id="2494872">bool</span>&nbsp;<span class="op" id="2494877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2494880">return</span>&nbsp;<span class="ident" id="2494887">t</span><span class="op" id="2494888">.</span><span class="ident" id="2494889">sec</span>&nbsp;<span class="op" id="2494893">&gt;</span>&nbsp;<span class="ident" id="2494895">u</span><span class="op" id="2494896">.</span><span class="ident" id="2494897">sec</span>&nbsp;<span class="op" id="2494901">||</span>&nbsp;<span class="ident" id="2494904">t</span><span class="op" id="2494905">.</span><span class="ident" id="2494906">sec</span>&nbsp;<span class="op" id="2494910">==</span>&nbsp;<span class="ident" id="2494913">u</span><span class="op" id="2494914">.</span><span class="ident" id="2494915">sec</span>&nbsp;<span class="op" id="2494919">&amp;&amp;</span>&nbsp;<span class="ident" id="2494922">t</span><span class="op" id="2494923">.</span><span class="ident" id="2494924">nsec</span>&nbsp;<span class="op" id="2494929">&gt;</span>&nbsp;<span class="ident" id="2494931">u</span><span class="op" id="2494932">.</span><span class="ident" id="2494933">nsec</span><br>
<span class="lineno">60</span><span class="op" id="2494938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2494941">//&nbsp;Before&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;before&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2494999">func</span>&nbsp;<span class="op" id="2495004">(</span><span class="ident" id="2495005">t</span>&nbsp;<span class="ident" id="2495007">Time</span><span class="op" id="2495011">)</span>&nbsp;<span class="ident" id="2495013">Before</span><span class="op" id="2495019">(</span><span class="ident" id="2495020">u</span>&nbsp;<span class="ident" id="2495022">Time</span><span class="op" id="2495026">)</span>&nbsp;<span class="builtintype" id="2495028">bool</span>&nbsp;<span class="op" id="2495033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2495036">return</span>&nbsp;<span class="ident" id="2495043">t</span><span class="op" id="2495044">.</span><span class="ident" id="2495045">sec</span>&nbsp;<span class="op" id="2495049">&lt;</span>&nbsp;<span class="ident" id="2495051">u</span><span class="op" id="2495052">.</span><span class="ident" id="2495053">sec</span>&nbsp;<span class="op" id="2495057">||</span>&nbsp;<span class="ident" id="2495060">t</span><span class="op" id="2495061">.</span><span class="ident" id="2495062">sec</span>&nbsp;<span class="op" id="2495066">==</span>&nbsp;<span class="ident" id="2495069">u</span><span class="op" id="2495070">.</span><span class="ident" id="2495071">sec</span>&nbsp;<span class="op" id="2495075">&amp;&amp;</span>&nbsp;<span class="ident" id="2495078">t</span><span class="op" id="2495079">.</span><span class="ident" id="2495080">nsec</span>&nbsp;<span class="op" id="2495085">&lt;</span>&nbsp;<span class="ident" id="2495087">u</span><span class="op" id="2495088">.</span><span class="ident" id="2495089">nsec</span><br>
<span class="lineno">65</span><span class="op" id="2495094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2495097">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;t&nbsp;and&nbsp;u&nbsp;represent&nbsp;the&nbsp;same&nbsp;time&nbsp;instant.</span><br>
<span class="lineno"></span><span class="comment" id="2495163">//&nbsp;Two&nbsp;times&nbsp;can&nbsp;be&nbsp;equal&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;different&nbsp;locations.</span><br>
<span class="lineno"></span><span class="comment" id="2495230">//&nbsp;For&nbsp;example,&nbsp;6:00&nbsp;+0200&nbsp;CEST&nbsp;and&nbsp;4:00&nbsp;UTC&nbsp;are&nbsp;Equal.</span><br>
<span class="lineno">70</span><span class="comment" id="2495286">//&nbsp;This&nbsp;comparison&nbsp;is&nbsp;different&nbsp;from&nbsp;using&nbsp;t&nbsp;==&nbsp;u,&nbsp;which&nbsp;also&nbsp;compares</span><br>
<span class="lineno"></span><span class="comment" id="2495357">//&nbsp;the&nbsp;locations.</span><br>
<span class="lineno"></span><span class="keyword" id="2495375">func</span>&nbsp;<span class="op" id="2495380">(</span><span class="ident" id="2495381">t</span>&nbsp;<span class="ident" id="2495383">Time</span><span class="op" id="2495387">)</span>&nbsp;<span class="ident" id="2495389">Equal</span><span class="op" id="2495394">(</span><span class="ident" id="2495395">u</span>&nbsp;<span class="ident" id="2495397">Time</span><span class="op" id="2495401">)</span>&nbsp;<span class="builtintype" id="2495403">bool</span>&nbsp;<span class="op" id="2495408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2495411">return</span>&nbsp;<span class="ident" id="2495418">t</span><span class="op" id="2495419">.</span><span class="ident" id="2495420">sec</span>&nbsp;<span class="op" id="2495424">==</span>&nbsp;<span class="ident" id="2495427">u</span><span class="op" id="2495428">.</span><span class="ident" id="2495429">sec</span>&nbsp;<span class="op" id="2495433">&amp;&amp;</span>&nbsp;<span class="ident" id="2495436">t</span><span class="op" id="2495437">.</span><span class="ident" id="2495438">nsec</span>&nbsp;<span class="op" id="2495443">==</span>&nbsp;<span class="ident" id="2495446">u</span><span class="op" id="2495447">.</span><span class="ident" id="2495448">nsec</span><br>
<span class="lineno"></span><span class="op" id="2495453">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2495456">//&nbsp;A&nbsp;Month&nbsp;specifies&nbsp;a&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;(January&nbsp;=&nbsp;1,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2495517">type</span>&nbsp;<span class="ident" id="2495522">Month</span>&nbsp;<span class="builtintype" id="2495528">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2495533">const</span>&nbsp;<span class="op" id="2495539">(</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495542">January</span>&nbsp;<span class="ident" id="2495550">Month</span>&nbsp;<span class="op" id="2495556">=</span>&nbsp;<span class="num" id="2495558">1</span>&nbsp;<span class="op" id="2495560">+</span>&nbsp;<span class="ident" id="2495562">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495568">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495578">March</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495585">April</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495592">May</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495597">June</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495603">July</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495609">August</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495617">September</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495628">October</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495637">November</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2495647">December</span><br>
<span class="lineno"></span><span class="op" id="2495656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2495659">var</span>&nbsp;<span class="ident" id="2495663">months</span>&nbsp;<span class="op" id="2495670">=</span>&nbsp;<span class="op" id="2495672">[</span><span class="op" id="2495673">...</span><span class="op" id="2495676">]</span><span class="builtintype" id="2495677">string</span><span class="op" id="2495683">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495686">&#34;January&#34;</span><span class="op" id="2495695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495698">&#34;February&#34;</span><span class="op" id="2495708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495711">&#34;March&#34;</span><span class="op" id="2495718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495721">&#34;April&#34;</span><span class="op" id="2495728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495731">&#34;May&#34;</span><span class="op" id="2495736">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495739">&#34;June&#34;</span><span class="op" id="2495745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495748">&#34;July&#34;</span><span class="op" id="2495754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495757">&#34;August&#34;</span><span class="op" id="2495765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495768">&#34;September&#34;</span><span class="op" id="2495779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495782">&#34;October&#34;</span><span class="op" id="2495791">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495794">&#34;November&#34;</span><span class="op" id="2495804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2495807">&#34;December&#34;</span><span class="op" id="2495817">,</span><br>
<span class="lineno"></span><span class="op" id="2495819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2495822">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;month&nbsp;(&#34;January&#34;,&nbsp;&#34;February&#34;,&nbsp;...).</span><br>
<span class="lineno">110</span><span class="keyword" id="2495900">func</span>&nbsp;<span class="op" id="2495905">(</span><span class="ident" id="2495906">m</span>&nbsp;<span class="ident" id="2495908">Month</span><span class="op" id="2495913">)</span>&nbsp;<span class="ident" id="2495915">String</span><span class="op" id="2495921">(</span><span class="op" id="2495922">)</span>&nbsp;<span class="builtintype" id="2495924">string</span>&nbsp;<span class="op" id="2495931">{</span>&nbsp;<span class="keyword" id="2495933">return</span>&nbsp;<span class="ident" id="2495940">months</span><span class="op" id="2495946">[</span><span class="ident" id="2495947">m</span><span class="op" id="2495948">-</span><span class="num" id="2495949">1</span><span class="op" id="2495950">]</span>&nbsp;<span class="op" id="2495952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2495955">//&nbsp;A&nbsp;Weekday&nbsp;specifies&nbsp;a&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;(Sunday&nbsp;=&nbsp;0,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2496015">type</span>&nbsp;<span class="ident" id="2496020">Weekday</span>&nbsp;<span class="builtintype" id="2496028">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2496033">const</span>&nbsp;<span class="op" id="2496039">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496042">Sunday</span>&nbsp;<span class="ident" id="2496049">Weekday</span>&nbsp;<span class="op" id="2496057">=</span>&nbsp;<span class="ident" id="2496059">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496065">Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496073">Tuesday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496082">Wednesday</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496093">Thursday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496103">Friday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2496111">Saturday</span><br>
<span class="lineno"></span><span class="op" id="2496120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2496123">var</span>&nbsp;<span class="ident" id="2496127">days</span>&nbsp;<span class="op" id="2496132">=</span>&nbsp;<span class="op" id="2496134">[</span><span class="op" id="2496135">...</span><span class="op" id="2496138">]</span><span class="builtintype" id="2496139">string</span><span class="op" id="2496145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496148">&#34;Sunday&#34;</span><span class="op" id="2496156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496159">&#34;Monday&#34;</span><span class="op" id="2496167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496170">&#34;Tuesday&#34;</span><span class="op" id="2496179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496182">&#34;Wednesday&#34;</span><span class="op" id="2496193">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496196">&#34;Thursday&#34;</span><span class="op" id="2496206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496209">&#34;Friday&#34;</span><span class="op" id="2496217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2496220">&#34;Saturday&#34;</span><span class="op" id="2496230">,</span><br>
<span class="lineno"></span><span class="op" id="2496232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2496235">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;day&nbsp;(&#34;Sunday&#34;,&nbsp;&#34;Monday&#34;,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2496308">func</span>&nbsp;<span class="op" id="2496313">(</span><span class="ident" id="2496314">d</span>&nbsp;<span class="ident" id="2496316">Weekday</span><span class="op" id="2496323">)</span>&nbsp;<span class="ident" id="2496325">String</span><span class="op" id="2496331">(</span><span class="op" id="2496332">)</span>&nbsp;<span class="builtintype" id="2496334">string</span>&nbsp;<span class="op" id="2496341">{</span>&nbsp;<span class="keyword" id="2496343">return</span>&nbsp;<span class="ident" id="2496350">days</span><span class="op" id="2496354">[</span><span class="ident" id="2496355">d</span><span class="op" id="2496356">]</span>&nbsp;<span class="op" id="2496358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2496361">//&nbsp;Computations&nbsp;on&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2496386">//</span><br>
<span class="lineno">140</span><span class="comment" id="2496389">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Time&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2496435">//&nbsp;&nbsp;&nbsp;&nbspJanuary&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC</span><br>
<span class="lineno"></span><span class="comment" id="2496480">//&nbsp;which&nbsp;(1)&nbsp;looks&nbsp;like&nbsp;a&nbsp;zero,&nbsp;or&nbsp;as&nbsp;close&nbsp;as&nbsp;you&nbsp;can&nbsp;get&nbsp;in&nbsp;a&nbsp;date</span><br>
<span class="lineno"></span><span class="comment" id="2496549">//&nbsp;(1-1-1&nbsp;00:00:00&nbsp;UTC),&nbsp;(2)&nbsp;is&nbsp;unlikely&nbsp;enough&nbsp;to&nbsp;arise&nbsp;in&nbsp;practice&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2496621">//&nbsp;be&nbsp;a&nbsp;suitable&nbsp;&#34;not&nbsp;set&#34;&nbsp;sentinel,&nbsp;unlike&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;and&nbsp;(3)&nbsp;has&nbsp;a</span><br>
<span class="lineno">145</span><span class="comment" id="2496691">//&nbsp;non-negative&nbsp;year&nbsp;even&nbsp;in&nbsp;time&nbsp;zones&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;unlike&nbsp;1-1-0</span><br>
<span class="lineno"></span><span class="comment" id="2496757">//&nbsp;00:00:00&nbsp;UTC,&nbsp;which&nbsp;would&nbsp;be&nbsp;12-31-(-1)&nbsp;19:00:00&nbsp;in&nbsp;New&nbsp;York.</span><br>
<span class="lineno"></span><span class="comment" id="2496822">//</span><br>
<span class="lineno"></span><span class="comment" id="2496825">//&nbsp;The&nbsp;zero&nbsp;Time&nbsp;value&nbsp;does&nbsp;not&nbsp;force&nbsp;a&nbsp;specific&nbsp;epoch&nbsp;for&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2496893">//&nbsp;representation.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;use&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;internally,&nbsp;we</span><br>
<span class="lineno">150</span><span class="comment" id="2496963">//&nbsp;could&nbsp;define&nbsp;that&nbsp;to&nbsp;distinguish&nbsp;a&nbsp;zero&nbsp;value&nbsp;from&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2497034">//&nbsp;time&nbsp;would&nbsp;be&nbsp;represented&nbsp;by&nbsp;sec=-1,&nbsp;nsec=1e9.&nbsp;&nbsp;However,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2497102">//&nbsp;suggest&nbsp;a&nbsp;representation,&nbsp;namely&nbsp;using&nbsp;1-1-1&nbsp;00:00:00&nbsp;UTC&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2497170">//&nbsp;epoch,&nbsp;and&nbsp;that&#39;s&nbsp;what&nbsp;we&nbsp;do.</span><br>
<span class="lineno"></span><span class="comment" id="2497203">//</span><br>
<span class="lineno">155</span><span class="comment" id="2497206">//&nbsp;The&nbsp;Add&nbsp;and&nbsp;Sub&nbsp;computations&nbsp;are&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;choice&nbsp;of&nbsp;epoch.</span><br>
<span class="lineno"></span><span class="comment" id="2497276">//</span><br>
<span class="lineno"></span><span class="comment" id="2497279">//&nbsp;The&nbsp;presentation&nbsp;computations&nbsp;-&nbsp;year,&nbsp;month,&nbsp;minute,&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2497351">//&nbsp;rely&nbsp;heavily&nbsp;on&nbsp;division&nbsp;and&nbsp;modulus&nbsp;by&nbsp;positive&nbsp;constants.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span><span class="comment" id="2497419">//&nbsp;calendrical&nbsp;calculations&nbsp;we&nbsp;want&nbsp;these&nbsp;divisions&nbsp;to&nbsp;round&nbsp;down,&nbsp;even</span><br>
<span class="lineno">160</span><span class="comment" id="2497491">//&nbsp;for&nbsp;negative&nbsp;values,&nbsp;so&nbsp;that&nbsp;the&nbsp;remainder&nbsp;is&nbsp;always&nbsp;positive,&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2497561">//&nbsp;Go&#39;s&nbsp;division&nbsp;(like&nbsp;most&nbsp;hardware&nbsp;division&nbsp;instructions)&nbsp;rounds&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2497631">//&nbsp;zero.&nbsp;&nbsp;We&nbsp;can&nbsp;still&nbsp;do&nbsp;those&nbsp;computations&nbsp;and&nbsp;then&nbsp;adjust&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="2497703">//&nbsp;for&nbsp;a&nbsp;negative&nbsp;numerator,&nbsp;but&nbsp;it&#39;s&nbsp;annoying&nbsp;to&nbsp;write&nbsp;the&nbsp;adjustment</span><br>
<span class="lineno"></span><span class="comment" id="2497774">//&nbsp;over&nbsp;and&nbsp;over.&nbsp;&nbsp;Instead,&nbsp;we&nbsp;can&nbsp;change&nbsp;to&nbsp;a&nbsp;different&nbsp;epoch&nbsp;so&nbsp;long</span><br>
<span class="lineno">165</span><span class="comment" id="2497845">//&nbsp;ago&nbsp;that&nbsp;all&nbsp;the&nbsp;times&nbsp;we&nbsp;care&nbsp;about&nbsp;will&nbsp;be&nbsp;positive,&nbsp;and&nbsp;then&nbsp;round</span><br>
<span class="lineno"></span><span class="comment" id="2497918">//&nbsp;to&nbsp;zero&nbsp;and&nbsp;round&nbsp;down&nbsp;coincide.&nbsp;&nbsp;These&nbsp;presentation&nbsp;routines&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2497991">//&nbsp;have&nbsp;to&nbsp;add&nbsp;the&nbsp;zone&nbsp;offset,&nbsp;so&nbsp;adding&nbsp;the&nbsp;translation&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2498056">//&nbsp;alternate&nbsp;epoch&nbsp;is&nbsp;cheap.&nbsp;&nbsp;For&nbsp;example,&nbsp;having&nbsp;a&nbsp;non-negative&nbsp;time&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2498128">//&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">170</span><span class="comment" id="2498155">//</span><br>
<span class="lineno"></span><span class="comment" id="2498158">//&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2498174">//</span><br>
<span class="lineno"></span><span class="comment" id="2498177">//&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2498191">//</span><br>
<span class="lineno">175</span><span class="comment" id="2498194">//&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2498210">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="2498226">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspsec&nbsp;+=&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2498240">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="2498245">//</span><br>
<span class="lineno">180</span><span class="comment" id="2498248">//&nbsp;everywhere.</span><br>
<span class="lineno"></span><span class="comment" id="2498263">//</span><br>
<span class="lineno"></span><span class="comment" id="2498266">//&nbsp;The&nbsp;calendar&nbsp;runs&nbsp;on&nbsp;an&nbsp;exact&nbsp;400&nbsp;year&nbsp;cycle:&nbsp;a&nbsp;400-year&nbsp;calendar</span><br>
<span class="lineno"></span><span class="comment" id="2498335">//&nbsp;printed&nbsp;for&nbsp;1970-2469&nbsp;will&nbsp;apply&nbsp;as&nbsp;well&nbsp;to&nbsp;2470-2869.&nbsp;&nbsp;Even&nbsp;the&nbsp;days</span><br>
<span class="lineno"></span><span class="comment" id="2498408">//&nbsp;of&nbsp;the&nbsp;week&nbsp;match&nbsp;up.&nbsp;&nbsp;It&nbsp;simplifies&nbsp;the&nbsp;computations&nbsp;to&nbsp;choose&nbsp;the</span><br>
<span class="lineno">185</span><span class="comment" id="2498479">//&nbsp;cycle&nbsp;boundaries&nbsp;so&nbsp;that&nbsp;the&nbsp;exceptional&nbsp;years&nbsp;are&nbsp;always&nbsp;delayed&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2498551">//&nbsp;long&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&nbsp;means&nbsp;choosing&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2498623">//&nbsp;that&nbsp;the&nbsp;first&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;4th&nbsp;year,&nbsp;the&nbsp;first&nbsp;missed&nbsp;leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2498695">//&nbsp;is&nbsp;the&nbsp;100th&nbsp;year,&nbsp;and&nbsp;the&nbsp;missed&nbsp;missed&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;400th&nbsp;year.</span><br>
<span class="lineno"></span><span class="comment" id="2498768">//&nbsp;So&nbsp;we&#39;d&nbsp;prefer&nbsp;instead&nbsp;to&nbsp;print&nbsp;a&nbsp;calendar&nbsp;for&nbsp;2001-2400&nbsp;and&nbsp;reuse&nbsp;it</span><br>
<span class="lineno">190</span><span class="comment" id="2498841">//&nbsp;for&nbsp;2401-2800.</span><br>
<span class="lineno"></span><span class="comment" id="2498859">//</span><br>
<span class="lineno"></span><span class="comment" id="2498862">//&nbsp;Finally,&nbsp;it&#39;s&nbsp;convenient&nbsp;if&nbsp;the&nbsp;delta&nbsp;between&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2498930">//&nbsp;long-ago&nbsp;epoch&nbsp;is&nbsp;representable&nbsp;by&nbsp;an&nbsp;int64&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2498987">//</span><br>
<span class="lineno">195</span><span class="comment" id="2498990">//&nbsp;These&nbsp;three&nbsp;considerations—choose&nbsp;an&nbsp;epoch&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2499065">//&nbsp;uses&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;that&nbsp;is&nbsp;no&nbsp;more&nbsp;than&nbsp;2⁶³&nbsp;seconds</span><br>
<span class="lineno"></span><span class="comment" id="2499140">//&nbsp;earlier&nbsp;than&nbsp;1970—bring&nbsp;us&nbsp;to&nbsp;the&nbsp;year&nbsp;-292277022399.&nbsp;&nbsp;We&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2499212">//&nbsp;this&nbsp;year&nbsp;as&nbsp;the&nbsp;absolute&nbsp;zero&nbsp;year,&nbsp;and&nbsp;to&nbsp;times&nbsp;measured&nbsp;as&nbsp;a&nbsp;uint64</span><br>
<span class="lineno"></span><span class="comment" id="2499286">//&nbsp;seconds&nbsp;since&nbsp;this&nbsp;year&nbsp;as&nbsp;absolute&nbsp;times.</span><br>
<span class="lineno">200</span><span class="comment" id="2499332">//</span><br>
<span class="lineno"></span><span class="comment" id="2499335">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1—the&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2499411">//&nbsp;used&nbsp;for&nbsp;Time&#39;s&nbsp;sec&nbsp;field—are&nbsp;called&nbsp;internal&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2499469">//</span><br>
<span class="lineno"></span><span class="comment" id="2499472">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1970&nbsp;are&nbsp;called&nbsp;Unix</span><br>
<span class="lineno">205</span><span class="comment" id="2499546">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2499556">//</span><br>
<span class="lineno"></span><span class="comment" id="2499559">//&nbsp;It&nbsp;is&nbsp;tempting&nbsp;to&nbsp;just&nbsp;use&nbsp;the&nbsp;year&nbsp;1&nbsp;as&nbsp;the&nbsp;absolute&nbsp;epoch,&nbsp;defining</span><br>
<span class="lineno"></span><span class="comment" id="2499632">//&nbsp;that&nbsp;the&nbsp;routines&nbsp;are&nbsp;only&nbsp;valid&nbsp;for&nbsp;years&nbsp;&gt;=&nbsp;1.&nbsp;&nbsp;However,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2499698">//&nbsp;routines&nbsp;would&nbsp;then&nbsp;be&nbsp;invalid&nbsp;when&nbsp;displaying&nbsp;the&nbsp;epoch&nbsp;in&nbsp;time&nbsp;zones</span><br>
<span class="lineno">210</span><span class="comment" id="2499772">//&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;since&nbsp;it&nbsp;is&nbsp;year&nbsp;0.&nbsp;&nbsp;It&nbsp;doesn&#39;t&nbsp;seem&nbsp;tenable&nbsp;to&nbsp;say&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2499845">//&nbsp;printing&nbsp;the&nbsp;zero&nbsp;time&nbsp;correctly&nbsp;isn&#39;t&nbsp;supported&nbsp;in&nbsp;half&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2499914">//&nbsp;zones.&nbsp;&nbsp;By&nbsp;comparison,&nbsp;it&#39;s&nbsp;reasonable&nbsp;to&nbsp;mishandle&nbsp;some&nbsp;times&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2499983">//&nbsp;the&nbsp;year&nbsp;-292277022399.</span><br>
<span class="lineno"></span><span class="comment" id="2500010">//</span><br>
<span class="lineno">215</span><span class="comment" id="2500013">//&nbsp;All&nbsp;this&nbsp;is&nbsp;opaque&nbsp;to&nbsp;clients&nbsp;of&nbsp;the&nbsp;API&nbsp;and&nbsp;can&nbsp;be&nbsp;changed&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2500081">//&nbsp;better&nbsp;implementation&nbsp;presents&nbsp;itself.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2500124">const</span>&nbsp;<span class="op" id="2500130">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500133">//&nbsp;The&nbsp;unsigned&nbsp;zero&nbsp;year&nbsp;for&nbsp;internal&nbsp;calculations.</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500187">//&nbsp;Must&nbsp;be&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;times&nbsp;before&nbsp;it&nbsp;will&nbsp;not&nbsp;compute&nbsp;correctly,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500258">//&nbsp;but&nbsp;otherwise&nbsp;can&nbsp;be&nbsp;changed&nbsp;at&nbsp;will.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500300">absoluteZeroYear</span>&nbsp;<span class="op" id="2500317">=</span>&nbsp;<span class="op" id="2500319">-</span><span class="num" id="2500320">292277022399</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500335">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Time.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500366">//&nbsp;Assumed&nbsp;by&nbsp;the&nbsp;unixToInternal&nbsp;computation&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500419">internalYear</span>&nbsp;<span class="op" id="2500432">=</span>&nbsp;<span class="num" id="2500434">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500438">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Unix&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500474">unixYear</span>&nbsp;<span class="op" id="2500483">=</span>&nbsp;<span class="num" id="2500485">1970</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500492">//&nbsp;Offsets&nbsp;to&nbsp;convert&nbsp;between&nbsp;internal&nbsp;and&nbsp;absolute&nbsp;or&nbsp;Unix&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500560">absoluteToInternal</span>&nbsp;<span class="ident" id="2500579">int64</span>&nbsp;<span class="op" id="2500585">=</span>&nbsp;<span class="op" id="2500587">(</span><span class="ident" id="2500588">absoluteZeroYear</span>&nbsp;<span class="op" id="2500605">-</span>&nbsp;<span class="ident" id="2500607">internalYear</span><span class="op" id="2500619">)</span>&nbsp;<span class="op" id="2500621">*</span>&nbsp;<span class="num" id="2500623">365.2425</span>&nbsp;<span class="op" id="2500632">*</span>&nbsp;<span class="ident" id="2500634">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500649">internalToAbsolute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2500674">=</span>&nbsp;<span class="op" id="2500676">-</span><span class="ident" id="2500677">absoluteToInternal</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500698">unixToInternal</span>&nbsp;<span class="ident" id="2500713">int64</span>&nbsp;<span class="op" id="2500719">=</span>&nbsp;<span class="op" id="2500721">(</span><span class="num" id="2500722">1969</span><span class="op" id="2500726">*</span><span class="num" id="2500727">365</span>&nbsp;<span class="op" id="2500731">+</span>&nbsp;<span class="num" id="2500733">1969</span><span class="op" id="2500737">/</span><span class="num" id="2500738">4</span>&nbsp;<span class="op" id="2500740">-</span>&nbsp;<span class="num" id="2500742">1969</span><span class="op" id="2500746">/</span><span class="num" id="2500747">100</span>&nbsp;<span class="op" id="2500751">+</span>&nbsp;<span class="num" id="2500753">1969</span><span class="op" id="2500757">/</span><span class="num" id="2500758">400</span><span class="op" id="2500761">)</span>&nbsp;<span class="op" id="2500763">*</span>&nbsp;<span class="ident" id="2500765">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500780">internalToUnix</span>&nbsp;<span class="ident" id="2500795">int64</span>&nbsp;<span class="op" id="2500801">=</span>&nbsp;<span class="op" id="2500803">-</span><span class="ident" id="2500804">unixToInternal</span><br>
<span class="lineno"></span><span class="op" id="2500819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2500822">//&nbsp;IsZero&nbsp;reports&nbsp;whether&nbsp;t&nbsp;represents&nbsp;the&nbsp;zero&nbsp;time&nbsp;instant,</span><br>
<span class="lineno">240</span><span class="comment" id="2500884">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2500920">func</span>&nbsp;<span class="op" id="2500925">(</span><span class="ident" id="2500926">t</span>&nbsp;<span class="ident" id="2500928">Time</span><span class="op" id="2500932">)</span>&nbsp;<span class="ident" id="2500934">IsZero</span><span class="op" id="2500940">(</span><span class="op" id="2500941">)</span>&nbsp;<span class="builtintype" id="2500943">bool</span>&nbsp;<span class="op" id="2500948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2500951">return</span>&nbsp;<span class="ident" id="2500958">t</span><span class="op" id="2500959">.</span><span class="ident" id="2500960">sec</span>&nbsp;<span class="op" id="2500964">==</span>&nbsp;<span class="num" id="2500967">0</span>&nbsp;<span class="op" id="2500969">&amp;&amp;</span>&nbsp;<span class="ident" id="2500972">t</span><span class="op" id="2500973">.</span><span class="ident" id="2500974">nsec</span>&nbsp;<span class="op" id="2500979">==</span>&nbsp;<span class="num" id="2500982">0</span><br>
<span class="lineno"></span><span class="op" id="2500984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2500987">//&nbsp;abs&nbsp;returns&nbsp;the&nbsp;time&nbsp;t&nbsp;as&nbsp;an&nbsp;absolute&nbsp;time,&nbsp;adjusted&nbsp;by&nbsp;the&nbsp;zone&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2501063">//&nbsp;It&nbsp;is&nbsp;called&nbsp;when&nbsp;computing&nbsp;a&nbsp;presentation&nbsp;property&nbsp;like&nbsp;Month&nbsp;or&nbsp;Hour.</span><br>
<span class="lineno"></span><span class="keyword" id="2501138">func</span>&nbsp;<span class="op" id="2501143">(</span><span class="ident" id="2501144">t</span>&nbsp;<span class="ident" id="2501146">Time</span><span class="op" id="2501150">)</span>&nbsp;<span class="ident" id="2501152">abs</span><span class="op" id="2501155">(</span><span class="op" id="2501156">)</span>&nbsp;<span class="ident" id="2501158">uint64</span>&nbsp;<span class="op" id="2501165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501168">l</span>&nbsp;<span class="op" id="2501170">:=</span>&nbsp;<span class="ident" id="2501173">t</span><span class="op" id="2501174">.</span><span class="ident" id="2501175">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501180">//&nbsp;Avoid&nbsp;function&nbsp;calls&nbsp;when&nbsp;possible.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501220">if</span>&nbsp;<span class="ident" id="2501223">l</span>&nbsp;<span class="op" id="2501225">==</span>&nbsp;<span class="ident" id="2501228">nil</span>&nbsp;<span class="op" id="2501232">||</span>&nbsp;<span class="ident" id="2501235">l</span>&nbsp;<span class="op" id="2501237">==</span>&nbsp;<span class="op" id="2501240">&amp;</span><span class="ident" id="2501241">localLoc</span>&nbsp;<span class="op" id="2501250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501254">l</span>&nbsp;<span class="op" id="2501256">=</span>&nbsp;<span class="ident" id="2501258">l</span><span class="op" id="2501259">.</span><span class="ident" id="2501260">get</span><span class="op" id="2501263">(</span><span class="op" id="2501264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501270">sec</span>&nbsp;<span class="op" id="2501274">:=</span>&nbsp;<span class="ident" id="2501277">t</span><span class="op" id="2501278">.</span><span class="ident" id="2501279">sec</span>&nbsp;<span class="op" id="2501283">+</span>&nbsp;<span class="ident" id="2501285">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501301">if</span>&nbsp;<span class="ident" id="2501304">l</span>&nbsp;<span class="op" id="2501306">!=</span>&nbsp;<span class="op" id="2501309">&amp;</span><span class="ident" id="2501310">utcLoc</span>&nbsp;<span class="op" id="2501317">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501321">if</span>&nbsp;<span class="ident" id="2501324">l</span><span class="op" id="2501325">.</span><span class="ident" id="2501326">cacheZone</span>&nbsp;<span class="op" id="2501336">!=</span>&nbsp;<span class="ident" id="2501339">nil</span>&nbsp;<span class="op" id="2501343">&amp;&amp;</span>&nbsp;<span class="ident" id="2501346">l</span><span class="op" id="2501347">.</span><span class="ident" id="2501348">cacheStart</span>&nbsp;<span class="op" id="2501359">&lt;=</span>&nbsp;<span class="ident" id="2501362">sec</span>&nbsp;<span class="op" id="2501366">&amp;&amp;</span>&nbsp;<span class="ident" id="2501369">sec</span>&nbsp;<span class="op" id="2501373">&lt;</span>&nbsp;<span class="ident" id="2501375">l</span><span class="op" id="2501376">.</span><span class="ident" id="2501377">cacheEnd</span>&nbsp;<span class="op" id="2501386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501391">sec</span>&nbsp;<span class="op" id="2501395">+=</span>&nbsp;<span class="ident" id="2501398">int64</span><span class="op" id="2501403">(</span><span class="ident" id="2501404">l</span><span class="op" id="2501405">.</span><span class="ident" id="2501406">cacheZone</span><span class="op" id="2501415">.</span><span class="ident" id="2501416">offset</span><span class="op" id="2501422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501426">}</span>&nbsp;<span class="keyword" id="2501428">else</span>&nbsp;<span class="op" id="2501433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501438">_</span><span class="op" id="2501439">,</span>&nbsp;<span class="ident" id="2501441">offset</span><span class="op" id="2501447">,</span>&nbsp;<span class="ident" id="2501449">_</span><span class="op" id="2501450">,</span>&nbsp;<span class="ident" id="2501452">_</span><span class="op" id="2501453">,</span>&nbsp;<span class="ident" id="2501455">_</span>&nbsp;<span class="op" id="2501457">:=</span>&nbsp;<span class="ident" id="2501460">l</span><span class="op" id="2501461">.</span><span class="ident" id="2501462">lookup</span><span class="op" id="2501468">(</span><span class="ident" id="2501469">sec</span><span class="op" id="2501472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501477">sec</span>&nbsp;<span class="op" id="2501481">+=</span>&nbsp;<span class="ident" id="2501484">int64</span><span class="op" id="2501489">(</span><span class="ident" id="2501490">offset</span><span class="op" id="2501496">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501506">return</span>&nbsp;<span class="ident" id="2501513">uint64</span><span class="op" id="2501519">(</span><span class="ident" id="2501520">sec</span>&nbsp;<span class="op" id="2501524">+</span>&nbsp;<span class="op" id="2501526">(</span><span class="ident" id="2501527">unixToInternal</span>&nbsp;<span class="op" id="2501542">+</span>&nbsp;<span class="ident" id="2501544">internalToAbsolute</span><span class="op" id="2501562">)</span><span class="op" id="2501563">)</span><br>
<span class="lineno"></span><span class="op" id="2501565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2501568">//&nbsp;locabs&nbsp;is&nbsp;a&nbsp;combination&nbsp;of&nbsp;the&nbsp;Zone&nbsp;and&nbsp;abs&nbsp;methods,</span><br>
<span class="lineno"></span><span class="comment" id="2501624">//&nbsp;extracting&nbsp;both&nbsp;return&nbsp;values&nbsp;from&nbsp;a&nbsp;single&nbsp;zone&nbsp;lookup.</span><br>
<span class="lineno"></span><span class="keyword" id="2501684">func</span>&nbsp;<span class="op" id="2501689">(</span><span class="ident" id="2501690">t</span>&nbsp;<span class="ident" id="2501692">Time</span><span class="op" id="2501696">)</span>&nbsp;<span class="ident" id="2501698">locabs</span><span class="op" id="2501704">(</span><span class="op" id="2501705">)</span>&nbsp;<span class="op" id="2501707">(</span><span class="ident" id="2501708">name</span>&nbsp;<span class="builtintype" id="2501713">string</span><span class="op" id="2501719">,</span>&nbsp;<span class="ident" id="2501721">offset</span>&nbsp;<span class="builtintype" id="2501728">int</span><span class="op" id="2501731">,</span>&nbsp;<span class="ident" id="2501733">abs</span>&nbsp;<span class="ident" id="2501737">uint64</span><span class="op" id="2501743">)</span>&nbsp;<span class="op" id="2501745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501748">l</span>&nbsp;<span class="op" id="2501750">:=</span>&nbsp;<span class="ident" id="2501753">t</span><span class="op" id="2501754">.</span><span class="ident" id="2501755">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501760">if</span>&nbsp;<span class="ident" id="2501763">l</span>&nbsp;<span class="op" id="2501765">==</span>&nbsp;<span class="ident" id="2501768">nil</span>&nbsp;<span class="op" id="2501772">||</span>&nbsp;<span class="ident" id="2501775">l</span>&nbsp;<span class="op" id="2501777">==</span>&nbsp;<span class="op" id="2501780">&amp;</span><span class="ident" id="2501781">localLoc</span>&nbsp;<span class="op" id="2501790">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501794">l</span>&nbsp;<span class="op" id="2501796">=</span>&nbsp;<span class="ident" id="2501798">l</span><span class="op" id="2501799">.</span><span class="ident" id="2501800">get</span><span class="op" id="2501803">(</span><span class="op" id="2501804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2501807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501810">//&nbsp;Avoid&nbsp;function&nbsp;call&nbsp;if&nbsp;we&nbsp;hit&nbsp;the&nbsp;local&nbsp;time&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501866">sec</span>&nbsp;<span class="op" id="2501870">:=</span>&nbsp;<span class="ident" id="2501873">t</span><span class="op" id="2501874">.</span><span class="ident" id="2501875">sec</span>&nbsp;<span class="op" id="2501879">+</span>&nbsp;<span class="ident" id="2501881">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501897">if</span>&nbsp;<span class="ident" id="2501900">l</span>&nbsp;<span class="op" id="2501902">!=</span>&nbsp;<span class="op" id="2501905">&amp;</span><span class="ident" id="2501906">utcLoc</span>&nbsp;<span class="op" id="2501913">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2501917">if</span>&nbsp;<span class="ident" id="2501920">l</span><span class="op" id="2501921">.</span><span class="ident" id="2501922">cacheZone</span>&nbsp;<span class="op" id="2501932">!=</span>&nbsp;<span class="ident" id="2501935">nil</span>&nbsp;<span class="op" id="2501939">&amp;&amp;</span>&nbsp;<span class="ident" id="2501942">l</span><span class="op" id="2501943">.</span><span class="ident" id="2501944">cacheStart</span>&nbsp;<span class="op" id="2501955">&lt;=</span>&nbsp;<span class="ident" id="2501958">sec</span>&nbsp;<span class="op" id="2501962">&amp;&amp;</span>&nbsp;<span class="ident" id="2501965">sec</span>&nbsp;<span class="op" id="2501969">&lt;</span>&nbsp;<span class="ident" id="2501971">l</span><span class="op" id="2501972">.</span><span class="ident" id="2501973">cacheEnd</span>&nbsp;<span class="op" id="2501982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501987">name</span>&nbsp;<span class="op" id="2501992">=</span>&nbsp;<span class="ident" id="2501994">l</span><span class="op" id="2501995">.</span><span class="ident" id="2501996">cacheZone</span><span class="op" id="2502005">.</span><span class="ident" id="2502006">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502014">offset</span>&nbsp;<span class="op" id="2502021">=</span>&nbsp;<span class="ident" id="2502023">l</span><span class="op" id="2502024">.</span><span class="ident" id="2502025">cacheZone</span><span class="op" id="2502034">.</span><span class="ident" id="2502035">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502044">}</span>&nbsp;<span class="keyword" id="2502046">else</span>&nbsp;<span class="op" id="2502051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502056">name</span><span class="op" id="2502060">,</span>&nbsp;<span class="ident" id="2502062">offset</span><span class="op" id="2502068">,</span>&nbsp;<span class="ident" id="2502070">_</span><span class="op" id="2502071">,</span>&nbsp;<span class="ident" id="2502073">_</span><span class="op" id="2502074">,</span>&nbsp;<span class="ident" id="2502076">_</span>&nbsp;<span class="op" id="2502078">=</span>&nbsp;<span class="ident" id="2502080">l</span><span class="op" id="2502081">.</span><span class="ident" id="2502082">lookup</span><span class="op" id="2502088">(</span><span class="ident" id="2502089">sec</span><span class="op" id="2502092">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502100">sec</span>&nbsp;<span class="op" id="2502104">+=</span>&nbsp;<span class="ident" id="2502107">int64</span><span class="op" id="2502112">(</span><span class="ident" id="2502113">offset</span><span class="op" id="2502119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502122">}</span>&nbsp;<span class="keyword" id="2502124">else</span>&nbsp;<span class="op" id="2502129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502133">name</span>&nbsp;<span class="op" id="2502138">=</span>&nbsp;<span class="string" id="2502140">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2502147">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502150">abs</span>&nbsp;<span class="op" id="2502154">=</span>&nbsp;<span class="ident" id="2502156">uint64</span><span class="op" id="2502162">(</span><span class="ident" id="2502163">sec</span>&nbsp;<span class="op" id="2502167">+</span>&nbsp;<span class="op" id="2502169">(</span><span class="ident" id="2502170">unixToInternal</span>&nbsp;<span class="op" id="2502185">+</span>&nbsp;<span class="ident" id="2502187">internalToAbsolute</span><span class="op" id="2502205">)</span><span class="op" id="2502206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502209">return</span><br>
<span class="lineno"></span><span class="op" id="2502216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502219">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno">290</span><span class="keyword" id="2502279">func</span>&nbsp;<span class="op" id="2502284">(</span><span class="ident" id="2502285">t</span>&nbsp;<span class="ident" id="2502287">Time</span><span class="op" id="2502291">)</span>&nbsp;<span class="ident" id="2502293">Date</span><span class="op" id="2502297">(</span><span class="op" id="2502298">)</span>&nbsp;<span class="op" id="2502300">(</span><span class="ident" id="2502301">year</span>&nbsp;<span class="builtintype" id="2502306">int</span><span class="op" id="2502309">,</span>&nbsp;<span class="ident" id="2502311">month</span>&nbsp;<span class="ident" id="2502317">Month</span><span class="op" id="2502322">,</span>&nbsp;<span class="ident" id="2502324">day</span>&nbsp;<span class="builtintype" id="2502328">int</span><span class="op" id="2502331">)</span>&nbsp;<span class="op" id="2502333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502336">year</span><span class="op" id="2502340">,</span>&nbsp;<span class="ident" id="2502342">month</span><span class="op" id="2502347">,</span>&nbsp;<span class="ident" id="2502349">day</span><span class="op" id="2502352">,</span>&nbsp;<span class="ident" id="2502354">_</span>&nbsp;<span class="op" id="2502356">=</span>&nbsp;<span class="ident" id="2502358">t</span><span class="op" id="2502359">.</span><span class="ident" id="2502360">date</span><span class="op" id="2502364">(</span><span class="ident" id="2502365">true</span><span class="op" id="2502369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502372">return</span><br>
<span class="lineno"></span><span class="op" id="2502379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="2502382">//&nbsp;Year&nbsp;returns&nbsp;the&nbsp;year&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2502426">func</span>&nbsp;<span class="op" id="2502431">(</span><span class="ident" id="2502432">t</span>&nbsp;<span class="ident" id="2502434">Time</span><span class="op" id="2502438">)</span>&nbsp;<span class="ident" id="2502440">Year</span><span class="op" id="2502444">(</span><span class="op" id="2502445">)</span>&nbsp;<span class="builtintype" id="2502447">int</span>&nbsp;<span class="op" id="2502451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502454">year</span><span class="op" id="2502458">,</span>&nbsp;<span class="ident" id="2502460">_</span><span class="op" id="2502461">,</span>&nbsp;<span class="ident" id="2502463">_</span><span class="op" id="2502464">,</span>&nbsp;<span class="ident" id="2502466">_</span>&nbsp;<span class="op" id="2502468">:=</span>&nbsp;<span class="ident" id="2502471">t</span><span class="op" id="2502472">.</span><span class="ident" id="2502473">date</span><span class="op" id="2502477">(</span><span class="ident" id="2502478">false</span><span class="op" id="2502483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502486">return</span>&nbsp;<span class="ident" id="2502493">year</span><br>
<span class="lineno"></span><span class="op" id="2502498">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2502501">//&nbsp;Month&nbsp;returns&nbsp;the&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2502556">func</span>&nbsp;<span class="op" id="2502561">(</span><span class="ident" id="2502562">t</span>&nbsp;<span class="ident" id="2502564">Time</span><span class="op" id="2502568">)</span>&nbsp;<span class="ident" id="2502570">Month</span><span class="op" id="2502575">(</span><span class="op" id="2502576">)</span>&nbsp;<span class="ident" id="2502578">Month</span>&nbsp;<span class="op" id="2502584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502587">_</span><span class="op" id="2502588">,</span>&nbsp;<span class="ident" id="2502590">month</span><span class="op" id="2502595">,</span>&nbsp;<span class="ident" id="2502597">_</span><span class="op" id="2502598">,</span>&nbsp;<span class="ident" id="2502600">_</span>&nbsp;<span class="op" id="2502602">:=</span>&nbsp;<span class="ident" id="2502605">t</span><span class="op" id="2502606">.</span><span class="ident" id="2502607">date</span><span class="op" id="2502611">(</span><span class="ident" id="2502612">true</span><span class="op" id="2502616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502619">return</span>&nbsp;<span class="ident" id="2502626">month</span><br>
<span class="lineno">305</span><span class="op" id="2502632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502635">//&nbsp;Day&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2502687">func</span>&nbsp;<span class="op" id="2502692">(</span><span class="ident" id="2502693">t</span>&nbsp;<span class="ident" id="2502695">Time</span><span class="op" id="2502699">)</span>&nbsp;<span class="ident" id="2502701">Day</span><span class="op" id="2502704">(</span><span class="op" id="2502705">)</span>&nbsp;<span class="builtintype" id="2502707">int</span>&nbsp;<span class="op" id="2502711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502714">_</span><span class="op" id="2502715">,</span>&nbsp;<span class="ident" id="2502717">_</span><span class="op" id="2502718">,</span>&nbsp;<span class="ident" id="2502720">day</span><span class="op" id="2502723">,</span>&nbsp;<span class="ident" id="2502725">_</span>&nbsp;<span class="op" id="2502727">:=</span>&nbsp;<span class="ident" id="2502730">t</span><span class="op" id="2502731">.</span><span class="ident" id="2502732">date</span><span class="op" id="2502736">(</span><span class="ident" id="2502737">true</span><span class="op" id="2502741">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502744">return</span>&nbsp;<span class="ident" id="2502751">day</span><br>
<span class="lineno"></span><span class="op" id="2502755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502758">//&nbsp;Weekday&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2502813">func</span>&nbsp;<span class="op" id="2502818">(</span><span class="ident" id="2502819">t</span>&nbsp;<span class="ident" id="2502821">Time</span><span class="op" id="2502825">)</span>&nbsp;<span class="ident" id="2502827">Weekday</span><span class="op" id="2502834">(</span><span class="op" id="2502835">)</span>&nbsp;<span class="ident" id="2502837">Weekday</span>&nbsp;<span class="op" id="2502845">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2502848">return</span>&nbsp;<span class="ident" id="2502855">absWeekday</span><span class="op" id="2502865">(</span><span class="ident" id="2502866">t</span><span class="op" id="2502867">.</span><span class="ident" id="2502868">abs</span><span class="op" id="2502871">(</span><span class="op" id="2502872">)</span><span class="op" id="2502873">)</span><br>
<span class="lineno"></span><span class="op" id="2502875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502878">//&nbsp;absWeekday&nbsp;is&nbsp;like&nbsp;Weekday&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2502942">func</span>&nbsp;<span class="ident" id="2502947">absWeekday</span><span class="op" id="2502957">(</span><span class="ident" id="2502958">abs</span>&nbsp;<span class="ident" id="2502962">uint64</span><span class="op" id="2502968">)</span>&nbsp;<span class="ident" id="2502970">Weekday</span>&nbsp;<span class="op" id="2502978">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502981">//&nbsp;January&nbsp;1&nbsp;of&nbsp;the&nbsp;absolute&nbsp;year,&nbsp;like&nbsp;January&nbsp;1&nbsp;of&nbsp;2001,&nbsp;was&nbsp;a&nbsp;Monday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503055">sec</span>&nbsp;<span class="op" id="2503059">:=</span>&nbsp;<span class="op" id="2503062">(</span><span class="ident" id="2503063">abs</span>&nbsp;<span class="op" id="2503067">+</span>&nbsp;<span class="ident" id="2503069">uint64</span><span class="op" id="2503075">(</span><span class="ident" id="2503076">Monday</span><span class="op" id="2503082">)</span><span class="op" id="2503083">*</span><span class="ident" id="2503084">secondsPerDay</span><span class="op" id="2503097">)</span>&nbsp;<span class="op" id="2503099">%</span>&nbsp;<span class="ident" id="2503101">secondsPerWeek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503117">return</span>&nbsp;<span class="ident" id="2503124">Weekday</span><span class="op" id="2503131">(</span><span class="builtintype" id="2503132">int</span><span class="op" id="2503135">(</span><span class="ident" id="2503136">sec</span><span class="op" id="2503139">)</span>&nbsp;<span class="op" id="2503141">/</span>&nbsp;<span class="ident" id="2503143">secondsPerDay</span><span class="op" id="2503156">)</span><br>
<span class="lineno"></span><span class="op" id="2503158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="comment" id="2503161">//&nbsp;ISOWeek&nbsp;returns&nbsp;the&nbsp;ISO&nbsp;8601&nbsp;year&nbsp;and&nbsp;week&nbsp;number&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="2503233">//&nbsp;Week&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;53.&nbsp;Jan&nbsp;01&nbsp;to&nbsp;Jan&nbsp;03&nbsp;of&nbsp;year&nbsp;n&nbsp;might&nbsp;belong&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2503305">//&nbsp;week&nbsp;52&nbsp;or&nbsp;53&nbsp;of&nbsp;year&nbsp;n-1,&nbsp;and&nbsp;Dec&nbsp;29&nbsp;to&nbsp;Dec&nbsp;31&nbsp;might&nbsp;belong&nbsp;to&nbsp;week&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2503379">//&nbsp;of&nbsp;year&nbsp;n+1.</span><br>
<span class="lineno"></span><span class="keyword" id="2503395">func</span>&nbsp;<span class="op" id="2503400">(</span><span class="ident" id="2503401">t</span>&nbsp;<span class="ident" id="2503403">Time</span><span class="op" id="2503407">)</span>&nbsp;<span class="ident" id="2503409">ISOWeek</span><span class="op" id="2503416">(</span><span class="op" id="2503417">)</span>&nbsp;<span class="op" id="2503419">(</span><span class="ident" id="2503420">year</span><span class="op" id="2503424">,</span>&nbsp;<span class="ident" id="2503426">week</span>&nbsp;<span class="builtintype" id="2503431">int</span><span class="op" id="2503434">)</span>&nbsp;<span class="op" id="2503436">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503439">year</span><span class="op" id="2503443">,</span>&nbsp;<span class="ident" id="2503445">month</span><span class="op" id="2503450">,</span>&nbsp;<span class="ident" id="2503452">day</span><span class="op" id="2503455">,</span>&nbsp;<span class="ident" id="2503457">yday</span>&nbsp;<span class="op" id="2503462">:=</span>&nbsp;<span class="ident" id="2503465">t</span><span class="op" id="2503466">.</span><span class="ident" id="2503467">date</span><span class="op" id="2503471">(</span><span class="ident" id="2503472">true</span><span class="op" id="2503476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503479">wday</span>&nbsp;<span class="op" id="2503484">:=</span>&nbsp;<span class="builtintype" id="2503487">int</span><span class="op" id="2503490">(</span><span class="ident" id="2503491">t</span><span class="op" id="2503492">.</span><span class="ident" id="2503493">Weekday</span><span class="op" id="2503500">(</span><span class="op" id="2503501">)</span><span class="op" id="2503502">+</span><span class="num" id="2503503">6</span><span class="op" id="2503504">)</span>&nbsp;<span class="op" id="2503506">%</span>&nbsp;<span class="num" id="2503508">7</span>&nbsp;<span class="comment" id="2503510">//&nbsp;weekday&nbsp;but&nbsp;Monday&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2503538">const</span>&nbsp;<span class="op" id="2503544">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503548">Mon</span>&nbsp;<span class="builtintype" id="2503552">int</span>&nbsp;<span class="op" id="2503556">=</span>&nbsp;<span class="ident" id="2503558">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503565">Tue</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503571">Wed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503577">Thu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503583">Fri</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503589">Sat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503595">Sun</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2503600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503604">//&nbsp;Calculate&nbsp;week&nbsp;as&nbsp;number&nbsp;of&nbsp;Mondays&nbsp;in&nbsp;year&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503658">//&nbsp;and&nbsp;including&nbsp;today,&nbsp;plus&nbsp;1&nbsp;because&nbsp;the&nbsp;first&nbsp;week&nbsp;is&nbsp;week&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503724">//&nbsp;Putting&nbsp;the&nbsp;+&nbsp;1&nbsp;inside&nbsp;the&nbsp;numerator&nbsp;as&nbsp;a&nbsp;+&nbsp;7&nbsp;keeps&nbsp;the</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503784">//&nbsp;numerator&nbsp;from&nbsp;being&nbsp;negative,&nbsp;which&nbsp;would&nbsp;cause&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503843">//&nbsp;round&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503866">week</span>&nbsp;<span class="op" id="2503871">=</span>&nbsp;<span class="op" id="2503873">(</span><span class="ident" id="2503874">yday</span>&nbsp;<span class="op" id="2503879">-</span>&nbsp;<span class="ident" id="2503881">wday</span>&nbsp;<span class="op" id="2503886">+</span>&nbsp;<span class="num" id="2503888">7</span><span class="op" id="2503889">)</span>&nbsp;<span class="op" id="2503891">/</span>&nbsp;<span class="num" id="2503893">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503897">//&nbsp;The&nbsp;week&nbsp;number&nbsp;is&nbsp;now&nbsp;correct&nbsp;under&nbsp;the&nbsp;assumption</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503953">//&nbsp;that&nbsp;the&nbsp;first&nbsp;Monday&nbsp;of&nbsp;the&nbsp;year&nbsp;is&nbsp;in&nbsp;week&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504005">//&nbsp;If&nbsp;Jan&nbsp;1&nbsp;is&nbsp;a&nbsp;Tuesday,&nbsp;Wednesday,&nbsp;or&nbsp;Thursday,&nbsp;the&nbsp;first&nbsp;Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504073">//&nbsp;is&nbsp;actually&nbsp;in&nbsp;week&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504100">jan1wday</span>&nbsp;<span class="op" id="2504109">:=</span>&nbsp;<span class="op" id="2504112">(</span><span class="ident" id="2504113">wday</span>&nbsp;<span class="op" id="2504118">-</span>&nbsp;<span class="ident" id="2504120">yday</span>&nbsp;<span class="op" id="2504125">+</span>&nbsp;<span class="num" id="2504127">7</span><span class="op" id="2504128">*</span><span class="num" id="2504129">53</span><span class="op" id="2504131">)</span>&nbsp;<span class="op" id="2504133">%</span>&nbsp;<span class="num" id="2504135">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504138">if</span>&nbsp;<span class="ident" id="2504141">Tue</span>&nbsp;<span class="op" id="2504145">&lt;=</span>&nbsp;<span class="ident" id="2504148">jan1wday</span>&nbsp;<span class="op" id="2504157">&amp;&amp;</span>&nbsp;<span class="ident" id="2504160">jan1wday</span>&nbsp;<span class="op" id="2504169">&lt;=</span>&nbsp;<span class="ident" id="2504172">Thu</span>&nbsp;<span class="op" id="2504176">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504180">week</span><span class="op" id="2504184">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504192">//&nbsp;If&nbsp;the&nbsp;week&nbsp;number&nbsp;is&nbsp;still&nbsp;0,&nbsp;we&#39;re&nbsp;in&nbsp;early&nbsp;January&nbsp;but&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504257">//&nbsp;the&nbsp;last&nbsp;week&nbsp;of&nbsp;last&nbsp;year.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504289">if</span>&nbsp;<span class="ident" id="2504292">week</span>&nbsp;<span class="op" id="2504297">==</span>&nbsp;<span class="num" id="2504300">0</span>&nbsp;<span class="op" id="2504302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504306">year</span><span class="op" id="2504310">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504315">week</span>&nbsp;<span class="op" id="2504320">=</span>&nbsp;<span class="num" id="2504322">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504327">//&nbsp;A&nbsp;year&nbsp;has&nbsp;53&nbsp;weeks&nbsp;when&nbsp;Jan&nbsp;1&nbsp;or&nbsp;Dec&nbsp;31&nbsp;is&nbsp;a&nbsp;Thursday,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504388">//&nbsp;meaning&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Friday</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504436">//&nbsp;or&nbsp;it&nbsp;was&nbsp;a&nbsp;leap&nbsp;year&nbsp;and&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Saturday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504505">if</span>&nbsp;<span class="ident" id="2504508">jan1wday</span>&nbsp;<span class="op" id="2504517">==</span>&nbsp;<span class="ident" id="2504520">Fri</span>&nbsp;<span class="op" id="2504524">||</span>&nbsp;<span class="op" id="2504527">(</span><span class="ident" id="2504528">jan1wday</span>&nbsp;<span class="op" id="2504537">==</span>&nbsp;<span class="ident" id="2504540">Sat</span>&nbsp;<span class="op" id="2504544">&amp;&amp;</span>&nbsp;<span class="ident" id="2504547">isLeap</span><span class="op" id="2504553">(</span><span class="ident" id="2504554">year</span><span class="op" id="2504558">)</span><span class="op" id="2504559">)</span>&nbsp;<span class="op" id="2504561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504566">week</span><span class="op" id="2504570">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504578">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504582">//&nbsp;December&nbsp;29&nbsp;to&nbsp;31&nbsp;are&nbsp;in&nbsp;week&nbsp;1&nbsp;of&nbsp;next&nbsp;year&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504634">//&nbsp;they&nbsp;are&nbsp;after&nbsp;the&nbsp;last&nbsp;Thursday&nbsp;of&nbsp;the&nbsp;year&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2504687">//&nbsp;December&nbsp;31&nbsp;is&nbsp;a&nbsp;Monday,&nbsp;Tuesday,&nbsp;or&nbsp;Wednesday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504739">if</span>&nbsp;<span class="ident" id="2504742">month</span>&nbsp;<span class="op" id="2504748">==</span>&nbsp;<span class="ident" id="2504751">December</span>&nbsp;<span class="op" id="2504760">&amp;&amp;</span>&nbsp;<span class="ident" id="2504763">day</span>&nbsp;<span class="op" id="2504767">&gt;=</span>&nbsp;<span class="num" id="2504770">29</span>&nbsp;<span class="op" id="2504773">&amp;&amp;</span>&nbsp;<span class="ident" id="2504776">wday</span>&nbsp;<span class="op" id="2504781">&lt;</span>&nbsp;<span class="ident" id="2504783">Thu</span>&nbsp;<span class="op" id="2504787">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504791">if</span>&nbsp;<span class="ident" id="2504794">dec31wday</span>&nbsp;<span class="op" id="2504804">:=</span>&nbsp;<span class="op" id="2504807">(</span><span class="ident" id="2504808">wday</span>&nbsp;<span class="op" id="2504813">+</span>&nbsp;<span class="num" id="2504815">31</span>&nbsp;<span class="op" id="2504818">-</span>&nbsp;<span class="ident" id="2504820">day</span><span class="op" id="2504823">)</span>&nbsp;<span class="op" id="2504825">%</span>&nbsp;<span class="num" id="2504827">7</span><span class="op" id="2504828">;</span>&nbsp;<span class="ident" id="2504830">Mon</span>&nbsp;<span class="op" id="2504834">&lt;=</span>&nbsp;<span class="ident" id="2504837">dec31wday</span>&nbsp;<span class="op" id="2504847">&amp;&amp;</span>&nbsp;<span class="ident" id="2504850">dec31wday</span>&nbsp;<span class="op" id="2504860">&lt;=</span>&nbsp;<span class="ident" id="2504863">Wed</span>&nbsp;<span class="op" id="2504867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504872">year</span><span class="op" id="2504876">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504882">week</span>&nbsp;<span class="op" id="2504887">=</span>&nbsp;<span class="num" id="2504889">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2504896">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2504900">return</span><br>
<span class="lineno"></span><span class="op" id="2504907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504910">//&nbsp;Clock&nbsp;returns&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;second&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno">385</span><span class="keyword" id="2504987">func</span>&nbsp;<span class="op" id="2504992">(</span><span class="ident" id="2504993">t</span>&nbsp;<span class="ident" id="2504995">Time</span><span class="op" id="2504999">)</span>&nbsp;<span class="ident" id="2505001">Clock</span><span class="op" id="2505006">(</span><span class="op" id="2505007">)</span>&nbsp;<span class="op" id="2505009">(</span><span class="ident" id="2505010">hour</span><span class="op" id="2505014">,</span>&nbsp;<span class="ident" id="2505016">min</span><span class="op" id="2505019">,</span>&nbsp;<span class="ident" id="2505021">sec</span>&nbsp;<span class="builtintype" id="2505025">int</span><span class="op" id="2505028">)</span>&nbsp;<span class="op" id="2505030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505033">return</span>&nbsp;<span class="ident" id="2505040">absClock</span><span class="op" id="2505048">(</span><span class="ident" id="2505049">t</span><span class="op" id="2505050">.</span><span class="ident" id="2505051">abs</span><span class="op" id="2505054">(</span><span class="op" id="2505055">)</span><span class="op" id="2505056">)</span><br>
<span class="lineno"></span><span class="op" id="2505058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505061">//&nbsp;absClock&nbsp;is&nbsp;like&nbsp;clock&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="2505121">func</span>&nbsp;<span class="ident" id="2505126">absClock</span><span class="op" id="2505134">(</span><span class="ident" id="2505135">abs</span>&nbsp;<span class="ident" id="2505139">uint64</span><span class="op" id="2505145">)</span>&nbsp;<span class="op" id="2505147">(</span><span class="ident" id="2505148">hour</span><span class="op" id="2505152">,</span>&nbsp;<span class="ident" id="2505154">min</span><span class="op" id="2505157">,</span>&nbsp;<span class="ident" id="2505159">sec</span>&nbsp;<span class="builtintype" id="2505163">int</span><span class="op" id="2505166">)</span>&nbsp;<span class="op" id="2505168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505171">sec</span>&nbsp;<span class="op" id="2505175">=</span>&nbsp;<span class="builtintype" id="2505177">int</span><span class="op" id="2505180">(</span><span class="ident" id="2505181">abs</span>&nbsp;<span class="op" id="2505185">%</span>&nbsp;<span class="ident" id="2505187">secondsPerDay</span><span class="op" id="2505200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505203">hour</span>&nbsp;<span class="op" id="2505208">=</span>&nbsp;<span class="ident" id="2505210">sec</span>&nbsp;<span class="op" id="2505214">/</span>&nbsp;<span class="ident" id="2505216">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505232">sec</span>&nbsp;<span class="op" id="2505236">-=</span>&nbsp;<span class="ident" id="2505239">hour</span>&nbsp;<span class="op" id="2505244">*</span>&nbsp;<span class="ident" id="2505246">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505262">min</span>&nbsp;<span class="op" id="2505266">=</span>&nbsp;<span class="ident" id="2505268">sec</span>&nbsp;<span class="op" id="2505272">/</span>&nbsp;<span class="ident" id="2505274">secondsPerMinute</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505292">sec</span>&nbsp;<span class="op" id="2505296">-=</span>&nbsp;<span class="ident" id="2505299">min</span>&nbsp;<span class="op" id="2505303">*</span>&nbsp;<span class="ident" id="2505305">secondsPerMinute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505323">return</span><br>
<span class="lineno"></span><span class="op" id="2505330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505333">//&nbsp;Hour&nbsp;returns&nbsp;the&nbsp;hour&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;23].</span><br>
<span class="lineno">400</span><span class="keyword" id="2505411">func</span>&nbsp;<span class="op" id="2505416">(</span><span class="ident" id="2505417">t</span>&nbsp;<span class="ident" id="2505419">Time</span><span class="op" id="2505423">)</span>&nbsp;<span class="ident" id="2505425">Hour</span><span class="op" id="2505429">(</span><span class="op" id="2505430">)</span>&nbsp;<span class="builtintype" id="2505432">int</span>&nbsp;<span class="op" id="2505436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505439">return</span>&nbsp;<span class="builtintype" id="2505446">int</span><span class="op" id="2505449">(</span><span class="ident" id="2505450">t</span><span class="op" id="2505451">.</span><span class="ident" id="2505452">abs</span><span class="op" id="2505455">(</span><span class="op" id="2505456">)</span><span class="op" id="2505457">%</span><span class="ident" id="2505458">secondsPerDay</span><span class="op" id="2505471">)</span>&nbsp;<span class="op" id="2505473">/</span>&nbsp;<span class="ident" id="2505475">secondsPerHour</span><br>
<span class="lineno"></span><span class="op" id="2505490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505493">//&nbsp;Minute&nbsp;returns&nbsp;the&nbsp;minute&nbsp;offset&nbsp;within&nbsp;the&nbsp;hour&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">405</span><span class="keyword" id="2505583">func</span>&nbsp;<span class="op" id="2505588">(</span><span class="ident" id="2505589">t</span>&nbsp;<span class="ident" id="2505591">Time</span><span class="op" id="2505595">)</span>&nbsp;<span class="ident" id="2505597">Minute</span><span class="op" id="2505603">(</span><span class="op" id="2505604">)</span>&nbsp;<span class="builtintype" id="2505606">int</span>&nbsp;<span class="op" id="2505610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505613">return</span>&nbsp;<span class="builtintype" id="2505620">int</span><span class="op" id="2505623">(</span><span class="ident" id="2505624">t</span><span class="op" id="2505625">.</span><span class="ident" id="2505626">abs</span><span class="op" id="2505629">(</span><span class="op" id="2505630">)</span><span class="op" id="2505631">%</span><span class="ident" id="2505632">secondsPerHour</span><span class="op" id="2505646">)</span>&nbsp;<span class="op" id="2505648">/</span>&nbsp;<span class="ident" id="2505650">secondsPerMinute</span><br>
<span class="lineno"></span><span class="op" id="2505667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505670">//&nbsp;Second&nbsp;returns&nbsp;the&nbsp;second&nbsp;offset&nbsp;within&nbsp;the&nbsp;minute&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">410</span><span class="keyword" id="2505762">func</span>&nbsp;<span class="op" id="2505767">(</span><span class="ident" id="2505768">t</span>&nbsp;<span class="ident" id="2505770">Time</span><span class="op" id="2505774">)</span>&nbsp;<span class="ident" id="2505776">Second</span><span class="op" id="2505782">(</span><span class="op" id="2505783">)</span>&nbsp;<span class="builtintype" id="2505785">int</span>&nbsp;<span class="op" id="2505789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505792">return</span>&nbsp;<span class="builtintype" id="2505799">int</span><span class="op" id="2505802">(</span><span class="ident" id="2505803">t</span><span class="op" id="2505804">.</span><span class="ident" id="2505805">abs</span><span class="op" id="2505808">(</span><span class="op" id="2505809">)</span>&nbsp;<span class="op" id="2505811">%</span>&nbsp;<span class="ident" id="2505813">secondsPerMinute</span><span class="op" id="2505829">)</span><br>
<span class="lineno"></span><span class="op" id="2505831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505834">//&nbsp;Nanosecond&nbsp;returns&nbsp;the&nbsp;nanosecond&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;specified&nbsp;by&nbsp;t,</span><br>
<span class="lineno">415</span><span class="comment" id="2505912">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2505944">func</span>&nbsp;<span class="op" id="2505949">(</span><span class="ident" id="2505950">t</span>&nbsp;<span class="ident" id="2505952">Time</span><span class="op" id="2505956">)</span>&nbsp;<span class="ident" id="2505958">Nanosecond</span><span class="op" id="2505968">(</span><span class="op" id="2505969">)</span>&nbsp;<span class="builtintype" id="2505971">int</span>&nbsp;<span class="op" id="2505975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2505978">return</span>&nbsp;<span class="builtintype" id="2505985">int</span><span class="op" id="2505988">(</span><span class="ident" id="2505989">t</span><span class="op" id="2505990">.</span><span class="ident" id="2505991">nsec</span><span class="op" id="2505995">)</span><br>
<span class="lineno"></span><span class="op" id="2505997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2506000">//&nbsp;YearDay&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[1,365]&nbsp;for&nbsp;non-leap&nbsp;years,</span><br>
<span class="lineno"></span><span class="comment" id="2506096">//&nbsp;and&nbsp;[1,366]&nbsp;in&nbsp;leap&nbsp;years.</span><br>
<span class="lineno"></span><span class="keyword" id="2506126">func</span>&nbsp;<span class="op" id="2506131">(</span><span class="ident" id="2506132">t</span>&nbsp;<span class="ident" id="2506134">Time</span><span class="op" id="2506138">)</span>&nbsp;<span class="ident" id="2506140">YearDay</span><span class="op" id="2506147">(</span><span class="op" id="2506148">)</span>&nbsp;<span class="builtintype" id="2506150">int</span>&nbsp;<span class="op" id="2506154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506157">_</span><span class="op" id="2506158">,</span>&nbsp;<span class="ident" id="2506160">_</span><span class="op" id="2506161">,</span>&nbsp;<span class="ident" id="2506163">_</span><span class="op" id="2506164">,</span>&nbsp;<span class="ident" id="2506166">yday</span>&nbsp;<span class="op" id="2506171">:=</span>&nbsp;<span class="ident" id="2506174">t</span><span class="op" id="2506175">.</span><span class="ident" id="2506176">date</span><span class="op" id="2506180">(</span><span class="ident" id="2506181">false</span><span class="op" id="2506186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2506189">return</span>&nbsp;<span class="ident" id="2506196">yday</span>&nbsp;<span class="op" id="2506201">+</span>&nbsp;<span class="num" id="2506203">1</span><br>
<span class="lineno">425</span><span class="op" id="2506205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2506208">//&nbsp;A&nbsp;Duration&nbsp;represents&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;two&nbsp;instants</span><br>
<span class="lineno"></span><span class="comment" id="2506271">//&nbsp;as&nbsp;an&nbsp;int64&nbsp;nanosecond&nbsp;count.&nbsp;&nbsp;The&nbsp;representation&nbsp;limits&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2506335">//&nbsp;largest&nbsp;representable&nbsp;duration&nbsp;to&nbsp;approximately&nbsp;290&nbsp;years.</span><br>
<span class="lineno">430</span><span class="keyword" id="2506397">type</span>&nbsp;<span class="ident" id="2506402">Duration</span>&nbsp;<span class="ident" id="2506411">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2506418">const</span>&nbsp;<span class="op" id="2506424">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506427">minDuration</span>&nbsp;<span class="ident" id="2506439">Duration</span>&nbsp;<span class="op" id="2506448">=</span>&nbsp;<span class="op" id="2506450">-</span><span class="num" id="2506451">1</span>&nbsp;<span class="op" id="2506453">&lt;&lt;</span>&nbsp;<span class="num" id="2506456">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506460">maxDuration</span>&nbsp;<span class="ident" id="2506472">Duration</span>&nbsp;<span class="op" id="2506481">=</span>&nbsp;<span class="num" id="2506483">1</span><span class="op" id="2506484">&lt;&lt;</span><span class="num" id="2506486">63</span>&nbsp;<span class="op" id="2506489">-</span>&nbsp;<span class="num" id="2506491">1</span><br>
<span class="lineno">435</span><span class="op" id="2506493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2506496">//&nbsp;Common&nbsp;durations.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;definition&nbsp;for&nbsp;units&nbsp;of&nbsp;Day&nbsp;or&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2506568">//&nbsp;to&nbsp;avoid&nbsp;confusion&nbsp;across&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;zone&nbsp;transitions.</span><br>
<span class="lineno"></span><span class="comment" id="2506637">//</span><br>
<span class="lineno">440</span><span class="comment" id="2506640">//&nbsp;To&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;units&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;divide:</span><br>
<span class="lineno"></span><span class="comment" id="2506695">//&nbsp;&nbsp;&nbsp;&nbspsecond&nbsp;:=&nbsp;time.Second</span><br>
<span class="lineno"></span><span class="comment" id="2506720">//&nbsp;&nbsp;&nbsp;&nbspfmt.Print(int64(second/time.Millisecond))&nbsp;//&nbsp;prints&nbsp;1000</span><br>
<span class="lineno"></span><span class="comment" id="2506780">//</span><br>
<span class="lineno"></span><span class="comment" id="2506783">//&nbsp;To&nbsp;convert&nbsp;an&nbsp;integer&nbsp;number&nbsp;of&nbsp;units&nbsp;to&nbsp;a&nbsp;Duration,&nbsp;multiply:</span><br>
<span class="lineno">445</span><span class="comment" id="2506849">//&nbsp;&nbsp;&nbsp;&nbspseconds&nbsp;:=&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2506866">//&nbsp;&nbsp;&nbsp;&nbspfmt.Print(time.Duration(seconds)*time.Second)&nbsp;//&nbsp;prints&nbsp;10s</span><br>
<span class="lineno"></span><span class="comment" id="2506929">//</span><br>
<span class="lineno"></span><span class="keyword" id="2506932">const</span>&nbsp;<span class="op" id="2506938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506941">Nanosecond</span>&nbsp;&nbsp;<span class="ident" id="2506953">Duration</span>&nbsp;<span class="op" id="2506962">=</span>&nbsp;<span class="num" id="2506964">1</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506967">Microsecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506988">=</span>&nbsp;<span class="num" id="2506990">1000</span>&nbsp;<span class="op" id="2506995">*</span>&nbsp;<span class="ident" id="2506997">Nanosecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507009">Millisecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507030">=</span>&nbsp;<span class="num" id="2507032">1000</span>&nbsp;<span class="op" id="2507037">*</span>&nbsp;<span class="ident" id="2507039">Microsecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507052">Second</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507073">=</span>&nbsp;<span class="num" id="2507075">1000</span>&nbsp;<span class="op" id="2507080">*</span>&nbsp;<span class="ident" id="2507082">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507095">Minute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507116">=</span>&nbsp;<span class="num" id="2507118">60</span>&nbsp;<span class="op" id="2507121">*</span>&nbsp;<span class="ident" id="2507123">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507131">Hour</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507152">=</span>&nbsp;<span class="num" id="2507154">60</span>&nbsp;<span class="op" id="2507157">*</span>&nbsp;<span class="ident" id="2507159">Minute</span><br>
<span class="lineno">455</span><span class="op" id="2507166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2507169">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;the&nbsp;duration&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;72h3m0.5s&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2507247">//&nbsp;Leading&nbsp;zero&nbsp;units&nbsp;are&nbsp;omitted.&nbsp;&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;durations&nbsp;less&nbsp;than&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2507326">//&nbsp;second&nbsp;format&nbsp;use&nbsp;a&nbsp;smaller&nbsp;unit&nbsp;(milli-,&nbsp;micro-,&nbsp;or&nbsp;nanoseconds)&nbsp;to&nbsp;ensure</span><br>
<span class="lineno">460</span><span class="comment" id="2507405">//&nbsp;that&nbsp;the&nbsp;leading&nbsp;digit&nbsp;is&nbsp;non-zero.&nbsp;&nbsp;The&nbsp;zero&nbsp;duration&nbsp;formats&nbsp;as&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="2507477">//&nbsp;with&nbsp;no&nbsp;unit.</span><br>
<span class="lineno"></span><span class="keyword" id="2507494">func</span>&nbsp;<span class="op" id="2507499">(</span><span class="ident" id="2507500">d</span>&nbsp;<span class="ident" id="2507502">Duration</span><span class="op" id="2507510">)</span>&nbsp;<span class="ident" id="2507512">String</span><span class="op" id="2507518">(</span><span class="op" id="2507519">)</span>&nbsp;<span class="builtintype" id="2507521">string</span>&nbsp;<span class="op" id="2507528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2507531">//&nbsp;Largest&nbsp;time&nbsp;is&nbsp;2540400h10m10.000000000s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507576">var</span>&nbsp;<span class="ident" id="2507580">buf</span>&nbsp;<span class="op" id="2507584">[</span><span class="num" id="2507585">32</span><span class="op" id="2507587">]</span><span class="builtintype" id="2507588">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507594">w</span>&nbsp;<span class="op" id="2507596">:=</span>&nbsp;<span class="builtinfunc" id="2507599">len</span><span class="op" id="2507602">(</span><span class="ident" id="2507603">buf</span><span class="op" id="2507606">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507610">u</span>&nbsp;<span class="op" id="2507612">:=</span>&nbsp;<span class="ident" id="2507615">uint64</span><span class="op" id="2507621">(</span><span class="ident" id="2507622">d</span><span class="op" id="2507623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507626">neg</span>&nbsp;<span class="op" id="2507630">:=</span>&nbsp;<span class="ident" id="2507633">d</span>&nbsp;<span class="op" id="2507635">&lt;</span>&nbsp;<span class="num" id="2507637">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507640">if</span>&nbsp;<span class="ident" id="2507643">neg</span>&nbsp;<span class="op" id="2507647">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507651">u</span>&nbsp;<span class="op" id="2507653">=</span>&nbsp;<span class="op" id="2507655">-</span><span class="ident" id="2507656">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2507659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507663">if</span>&nbsp;<span class="ident" id="2507666">u</span>&nbsp;<span class="op" id="2507668">&lt;</span>&nbsp;<span class="ident" id="2507670">uint64</span><span class="op" id="2507676">(</span><span class="ident" id="2507677">Second</span><span class="op" id="2507683">)</span>&nbsp;<span class="op" id="2507685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2507689">//&nbsp;Special&nbsp;case:&nbsp;if&nbsp;duration&nbsp;is&nbsp;smaller&nbsp;than&nbsp;a&nbsp;second,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2507746">//&nbsp;use&nbsp;smaller&nbsp;units,&nbsp;like&nbsp;1.2ms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507781">var</span>&nbsp;<span class="ident" id="2507785">prec</span>&nbsp;<span class="builtintype" id="2507790">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507796">w</span><span class="op" id="2507797">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507802">buf</span><span class="op" id="2507805">[</span><span class="ident" id="2507806">w</span><span class="op" id="2507807">]</span>&nbsp;<span class="op" id="2507809">=</span>&nbsp;<span class="string" id="2507811">&#39;s&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507817">w</span><span class="op" id="2507818">--</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507823">switch</span>&nbsp;<span class="op" id="2507830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507834">case</span>&nbsp;<span class="ident" id="2507839">u</span>&nbsp;<span class="op" id="2507841">==</span>&nbsp;<span class="num" id="2507844">0</span><span class="op" id="2507845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507850">return</span>&nbsp;<span class="string" id="2507857">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507863">case</span>&nbsp;<span class="ident" id="2507868">u</span>&nbsp;<span class="op" id="2507870">&lt;</span>&nbsp;<span class="ident" id="2507872">uint64</span><span class="op" id="2507878">(</span><span class="ident" id="2507879">Microsecond</span><span class="op" id="2507890">)</span><span class="op" id="2507891">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2507896">//&nbsp;print&nbsp;nanoseconds</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507920">prec</span>&nbsp;<span class="op" id="2507925">=</span>&nbsp;<span class="num" id="2507927">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507932">buf</span><span class="op" id="2507935">[</span><span class="ident" id="2507936">w</span><span class="op" id="2507937">]</span>&nbsp;<span class="op" id="2507939">=</span>&nbsp;<span class="string" id="2507941">&#39;n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2507947">case</span>&nbsp;<span class="ident" id="2507952">u</span>&nbsp;<span class="op" id="2507954">&lt;</span>&nbsp;<span class="ident" id="2507956">uint64</span><span class="op" id="2507962">(</span><span class="ident" id="2507963">Millisecond</span><span class="op" id="2507974">)</span><span class="op" id="2507975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2507980">//&nbsp;print&nbsp;microseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508005">prec</span>&nbsp;<span class="op" id="2508010">=</span>&nbsp;<span class="num" id="2508012">3</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508017">//&nbsp;U+00B5&nbsp;&#39;µ&#39;&nbsp;micro&nbsp;sign&nbsp;==&nbsp;0xC2&nbsp;0xB5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508059">w</span><span class="op" id="2508060">--</span>&nbsp;<span class="comment" id="2508063">//&nbsp;Need&nbsp;room&nbsp;for&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2508094">copy</span><span class="op" id="2508098">(</span><span class="ident" id="2508099">buf</span><span class="op" id="2508102">[</span><span class="ident" id="2508103">w</span><span class="op" id="2508104">:</span><span class="op" id="2508105">]</span><span class="op" id="2508106">,</span>&nbsp;<span class="string" id="2508108">&#34;µ&#34;</span><span class="op" id="2508112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508116">default</span><span class="op" id="2508123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508128">//&nbsp;print&nbsp;milliseconds</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508153">prec</span>&nbsp;<span class="op" id="2508158">=</span>&nbsp;<span class="num" id="2508160">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508165">buf</span><span class="op" id="2508168">[</span><span class="ident" id="2508169">w</span><span class="op" id="2508170">]</span>&nbsp;<span class="op" id="2508172">=</span>&nbsp;<span class="string" id="2508174">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508184">w</span><span class="op" id="2508185">,</span>&nbsp;<span class="ident" id="2508187">u</span>&nbsp;<span class="op" id="2508189">=</span>&nbsp;<span class="ident" id="2508191">fmtFrac</span><span class="op" id="2508198">(</span><span class="ident" id="2508199">buf</span><span class="op" id="2508202">[</span><span class="op" id="2508203">:</span><span class="ident" id="2508204">w</span><span class="op" id="2508205">]</span><span class="op" id="2508206">,</span>&nbsp;<span class="ident" id="2508208">u</span><span class="op" id="2508209">,</span>&nbsp;<span class="ident" id="2508211">prec</span><span class="op" id="2508215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508219">w</span>&nbsp;<span class="op" id="2508221">=</span>&nbsp;<span class="ident" id="2508223">fmtInt</span><span class="op" id="2508229">(</span><span class="ident" id="2508230">buf</span><span class="op" id="2508233">[</span><span class="op" id="2508234">:</span><span class="ident" id="2508235">w</span><span class="op" id="2508236">]</span><span class="op" id="2508237">,</span>&nbsp;<span class="ident" id="2508239">u</span><span class="op" id="2508240">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508243">}</span>&nbsp;<span class="keyword" id="2508245">else</span>&nbsp;<span class="op" id="2508250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508254">w</span><span class="op" id="2508255">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508260">buf</span><span class="op" id="2508263">[</span><span class="ident" id="2508264">w</span><span class="op" id="2508265">]</span>&nbsp;<span class="op" id="2508267">=</span>&nbsp;<span class="string" id="2508269">&#39;s&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508276">w</span><span class="op" id="2508277">,</span>&nbsp;<span class="ident" id="2508279">u</span>&nbsp;<span class="op" id="2508281">=</span>&nbsp;<span class="ident" id="2508283">fmtFrac</span><span class="op" id="2508290">(</span><span class="ident" id="2508291">buf</span><span class="op" id="2508294">[</span><span class="op" id="2508295">:</span><span class="ident" id="2508296">w</span><span class="op" id="2508297">]</span><span class="op" id="2508298">,</span>&nbsp;<span class="ident" id="2508300">u</span><span class="op" id="2508301">,</span>&nbsp;<span class="num" id="2508303">9</span><span class="op" id="2508304">)</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508309">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508339">w</span>&nbsp;<span class="op" id="2508341">=</span>&nbsp;<span class="ident" id="2508343">fmtInt</span><span class="op" id="2508349">(</span><span class="ident" id="2508350">buf</span><span class="op" id="2508353">[</span><span class="op" id="2508354">:</span><span class="ident" id="2508355">w</span><span class="op" id="2508356">]</span><span class="op" id="2508357">,</span>&nbsp;<span class="ident" id="2508359">u</span><span class="op" id="2508360">%</span><span class="num" id="2508361">60</span><span class="op" id="2508363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508367">u</span>&nbsp;<span class="op" id="2508369">/=</span>&nbsp;<span class="num" id="2508372">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508378">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508408">if</span>&nbsp;<span class="ident" id="2508411">u</span>&nbsp;<span class="op" id="2508413">&gt;</span>&nbsp;<span class="num" id="2508415">0</span>&nbsp;<span class="op" id="2508417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508422">w</span><span class="op" id="2508423">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508429">buf</span><span class="op" id="2508432">[</span><span class="ident" id="2508433">w</span><span class="op" id="2508434">]</span>&nbsp;<span class="op" id="2508436">=</span>&nbsp;<span class="string" id="2508438">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508445">w</span>&nbsp;<span class="op" id="2508447">=</span>&nbsp;<span class="ident" id="2508449">fmtInt</span><span class="op" id="2508455">(</span><span class="ident" id="2508456">buf</span><span class="op" id="2508459">[</span><span class="op" id="2508460">:</span><span class="ident" id="2508461">w</span><span class="op" id="2508462">]</span><span class="op" id="2508463">,</span>&nbsp;<span class="ident" id="2508465">u</span><span class="op" id="2508466">%</span><span class="num" id="2508467">60</span><span class="op" id="2508469">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508474">u</span>&nbsp;<span class="op" id="2508476">/=</span>&nbsp;<span class="num" id="2508479">60</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508486">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;hours</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2508515">//&nbsp;Stop&nbsp;at&nbsp;hours&nbsp;because&nbsp;days&nbsp;can&nbsp;be&nbsp;different&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508574">if</span>&nbsp;<span class="ident" id="2508577">u</span>&nbsp;<span class="op" id="2508579">&gt;</span>&nbsp;<span class="num" id="2508581">0</span>&nbsp;<span class="op" id="2508583">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508589">w</span><span class="op" id="2508590">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508597">buf</span><span class="op" id="2508600">[</span><span class="ident" id="2508601">w</span><span class="op" id="2508602">]</span>&nbsp;<span class="op" id="2508604">=</span>&nbsp;<span class="string" id="2508606">&#39;h&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508614">w</span>&nbsp;<span class="op" id="2508616">=</span>&nbsp;<span class="ident" id="2508618">fmtInt</span><span class="op" id="2508624">(</span><span class="ident" id="2508625">buf</span><span class="op" id="2508628">[</span><span class="op" id="2508629">:</span><span class="ident" id="2508630">w</span><span class="op" id="2508631">]</span><span class="op" id="2508632">,</span>&nbsp;<span class="ident" id="2508634">u</span><span class="op" id="2508635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508644">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508651">if</span>&nbsp;<span class="ident" id="2508654">neg</span>&nbsp;<span class="op" id="2508658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508662">w</span><span class="op" id="2508663">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508668">buf</span><span class="op" id="2508671">[</span><span class="ident" id="2508672">w</span><span class="op" id="2508673">]</span>&nbsp;<span class="op" id="2508675">=</span>&nbsp;<span class="string" id="2508677">&#39;-&#39;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2508682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2508686">return</span>&nbsp;<span class="builtintype" id="2508693">string</span><span class="op" id="2508699">(</span><span class="ident" id="2508700">buf</span><span class="op" id="2508703">[</span><span class="ident" id="2508704">w</span><span class="op" id="2508705">:</span><span class="op" id="2508706">]</span><span class="op" id="2508707">)</span><br>
<span class="lineno"></span><span class="op" id="2508709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="2508712">//&nbsp;fmtFrac&nbsp;formats&nbsp;the&nbsp;fraction&nbsp;of&nbsp;v/10**prec&nbsp;(e.g.,&nbsp;&#34;.12345&#34;)&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2508784">//&nbsp;tail&nbsp;of&nbsp;buf,&nbsp;omitting&nbsp;trailing&nbsp;zeros.&nbsp;&nbsp;it&nbsp;omits&nbsp;the&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2508847">//&nbsp;point&nbsp;too&nbsp;when&nbsp;the&nbsp;fraction&nbsp;is&nbsp;0.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2508916">//&nbsp;output&nbsp;bytes&nbsp;begin&nbsp;and&nbsp;the&nbsp;value&nbsp;v/10**prec.</span><br>
<span class="lineno"></span><span class="keyword" id="2508964">func</span>&nbsp;<span class="ident" id="2508969">fmtFrac</span><span class="op" id="2508976">(</span><span class="ident" id="2508977">buf</span>&nbsp;<span class="op" id="2508981">[</span><span class="op" id="2508982">]</span><span class="builtintype" id="2508983">byte</span><span class="op" id="2508987">,</span>&nbsp;<span class="ident" id="2508989">v</span>&nbsp;<span class="ident" id="2508991">uint64</span><span class="op" id="2508997">,</span>&nbsp;<span class="ident" id="2508999">prec</span>&nbsp;<span class="builtintype" id="2509004">int</span><span class="op" id="2509007">)</span>&nbsp;<span class="op" id="2509009">(</span><span class="ident" id="2509010">nw</span>&nbsp;<span class="builtintype" id="2509013">int</span><span class="op" id="2509016">,</span>&nbsp;<span class="ident" id="2509018">nv</span>&nbsp;<span class="ident" id="2509021">uint64</span><span class="op" id="2509027">)</span>&nbsp;<span class="op" id="2509029">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509032">//&nbsp;Omit&nbsp;trailing&nbsp;zeros&nbsp;up&nbsp;to&nbsp;and&nbsp;including&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509091">w</span>&nbsp;<span class="op" id="2509093">:=</span>&nbsp;<span class="builtinfunc" id="2509096">len</span><span class="op" id="2509099">(</span><span class="ident" id="2509100">buf</span><span class="op" id="2509103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2509106">print</span>&nbsp;<span class="op" id="2509112">:=</span>&nbsp;<span class="ident" id="2509115">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509122">for</span>&nbsp;<span class="ident" id="2509126">i</span>&nbsp;<span class="op" id="2509128">:=</span>&nbsp;<span class="num" id="2509131">0</span><span class="op" id="2509132">;</span>&nbsp;<span class="ident" id="2509134">i</span>&nbsp;<span class="op" id="2509136">&lt;</span>&nbsp;<span class="ident" id="2509138">prec</span><span class="op" id="2509142">;</span>&nbsp;<span class="ident" id="2509144">i</span><span class="op" id="2509145">++</span>&nbsp;<span class="op" id="2509148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509152">digit</span>&nbsp;<span class="op" id="2509158">:=</span>&nbsp;<span class="ident" id="2509161">v</span>&nbsp;<span class="op" id="2509163">%</span>&nbsp;<span class="num" id="2509165">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2509170">print</span>&nbsp;<span class="op" id="2509176">=</span>&nbsp;<span class="builtinfunc" id="2509178">print</span>&nbsp;<span class="op" id="2509184">||</span>&nbsp;<span class="ident" id="2509187">digit</span>&nbsp;<span class="op" id="2509193">!=</span>&nbsp;<span class="num" id="2509196">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509200">if</span>&nbsp;<span class="builtinfunc" id="2509203">print</span>&nbsp;<span class="op" id="2509209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509214">w</span><span class="op" id="2509215">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509221">buf</span><span class="op" id="2509224">[</span><span class="ident" id="2509225">w</span><span class="op" id="2509226">]</span>&nbsp;<span class="op" id="2509228">=</span>&nbsp;<span class="builtintype" id="2509230">byte</span><span class="op" id="2509234">(</span><span class="ident" id="2509235">digit</span><span class="op" id="2509240">)</span>&nbsp;<span class="op" id="2509242">+</span>&nbsp;<span class="string" id="2509244">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509250">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509254">v</span>&nbsp;<span class="op" id="2509256">/=</span>&nbsp;<span class="num" id="2509259">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509266">if</span>&nbsp;<span class="builtinfunc" id="2509269">print</span>&nbsp;<span class="op" id="2509275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509279">w</span><span class="op" id="2509280">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509285">buf</span><span class="op" id="2509288">[</span><span class="ident" id="2509289">w</span><span class="op" id="2509290">]</span>&nbsp;<span class="op" id="2509292">=</span>&nbsp;<span class="string" id="2509294">&#39;.&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509302">return</span>&nbsp;<span class="ident" id="2509309">w</span><span class="op" id="2509310">,</span>&nbsp;<span class="ident" id="2509312">v</span><br>
<span class="lineno"></span><span class="op" id="2509314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2509317">//&nbsp;fmtInt&nbsp;formats&nbsp;v&nbsp;into&nbsp;the&nbsp;tail&nbsp;of&nbsp;buf.</span><br>
<span class="lineno">560</span><span class="comment" id="2509359">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the&nbsp;output&nbsp;begins.</span><br>
<span class="lineno"></span><span class="keyword" id="2509408">func</span>&nbsp;<span class="ident" id="2509413">fmtInt</span><span class="op" id="2509419">(</span><span class="ident" id="2509420">buf</span>&nbsp;<span class="op" id="2509424">[</span><span class="op" id="2509425">]</span><span class="builtintype" id="2509426">byte</span><span class="op" id="2509430">,</span>&nbsp;<span class="ident" id="2509432">v</span>&nbsp;<span class="ident" id="2509434">uint64</span><span class="op" id="2509440">)</span>&nbsp;<span class="builtintype" id="2509442">int</span>&nbsp;<span class="op" id="2509446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509449">w</span>&nbsp;<span class="op" id="2509451">:=</span>&nbsp;<span class="builtinfunc" id="2509454">len</span><span class="op" id="2509457">(</span><span class="ident" id="2509458">buf</span><span class="op" id="2509461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509464">if</span>&nbsp;<span class="ident" id="2509467">v</span>&nbsp;<span class="op" id="2509469">==</span>&nbsp;<span class="num" id="2509472">0</span>&nbsp;<span class="op" id="2509474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509478">w</span><span class="op" id="2509479">--</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509484">buf</span><span class="op" id="2509487">[</span><span class="ident" id="2509488">w</span><span class="op" id="2509489">]</span>&nbsp;<span class="op" id="2509491">=</span>&nbsp;<span class="string" id="2509493">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509498">}</span>&nbsp;<span class="keyword" id="2509500">else</span>&nbsp;<span class="op" id="2509505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509509">for</span>&nbsp;<span class="ident" id="2509513">v</span>&nbsp;<span class="op" id="2509515">&gt;</span>&nbsp;<span class="num" id="2509517">0</span>&nbsp;<span class="op" id="2509519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509524">w</span><span class="op" id="2509525">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509531">buf</span><span class="op" id="2509534">[</span><span class="ident" id="2509535">w</span><span class="op" id="2509536">]</span>&nbsp;<span class="op" id="2509538">=</span>&nbsp;<span class="builtintype" id="2509540">byte</span><span class="op" id="2509544">(</span><span class="ident" id="2509545">v</span><span class="op" id="2509546">%</span><span class="num" id="2509547">10</span><span class="op" id="2509549">)</span>&nbsp;<span class="op" id="2509551">+</span>&nbsp;<span class="string" id="2509553">&#39;0&#39;</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509560">v</span>&nbsp;<span class="op" id="2509562">/=</span>&nbsp;<span class="num" id="2509565">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509576">return</span>&nbsp;<span class="ident" id="2509583">w</span><br>
<span class="lineno"></span><span class="op" id="2509585">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="2509588">//&nbsp;Nanoseconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;an&nbsp;integer&nbsp;nanosecond&nbsp;count.</span><br>
<span class="lineno"></span><span class="keyword" id="2509656">func</span>&nbsp;<span class="op" id="2509661">(</span><span class="ident" id="2509662">d</span>&nbsp;<span class="ident" id="2509664">Duration</span><span class="op" id="2509672">)</span>&nbsp;<span class="ident" id="2509674">Nanoseconds</span><span class="op" id="2509685">(</span><span class="op" id="2509686">)</span>&nbsp;<span class="ident" id="2509688">int64</span>&nbsp;<span class="op" id="2509694">{</span>&nbsp;<span class="keyword" id="2509696">return</span>&nbsp;<span class="ident" id="2509703">int64</span><span class="op" id="2509708">(</span><span class="ident" id="2509709">d</span><span class="op" id="2509710">)</span>&nbsp;<span class="op" id="2509712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2509715">//&nbsp;These&nbsp;methods&nbsp;return&nbsp;float64&nbsp;because&nbsp;the&nbsp;dominant</span><br>
<span class="lineno">580</span><span class="comment" id="2509768">//&nbsp;use&nbsp;case&nbsp;is&nbsp;for&nbsp;printing&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;like&nbsp;1.5s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2509835">//&nbsp;a&nbsp;truncation&nbsp;to&nbsp;integer&nbsp;would&nbsp;make&nbsp;them&nbsp;not&nbsp;useful&nbsp;in&nbsp;those&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="2509905">//&nbsp;Splitting&nbsp;the&nbsp;integer&nbsp;and&nbsp;fraction&nbsp;ourselves&nbsp;guarantees&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2509969">//&nbsp;converting&nbsp;the&nbsp;returned&nbsp;float64&nbsp;to&nbsp;an&nbsp;integer&nbsp;rounds&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2510034">//&nbsp;way&nbsp;that&nbsp;a&nbsp;pure&nbsp;integer&nbsp;conversion&nbsp;would&nbsp;have,&nbsp;even&nbsp;in&nbsp;cases</span><br>
<span class="lineno">585</span><span class="comment" id="2510098">//&nbsp;where,&nbsp;say,&nbsp;float64(d.Nanoseconds())/1e9&nbsp;would&nbsp;have&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2510161">//&nbsp;differently.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2510178">//&nbsp;Seconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;seconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2510249">func</span>&nbsp;<span class="op" id="2510254">(</span><span class="ident" id="2510255">d</span>&nbsp;<span class="ident" id="2510257">Duration</span><span class="op" id="2510265">)</span>&nbsp;<span class="ident" id="2510267">Seconds</span><span class="op" id="2510274">(</span><span class="op" id="2510275">)</span>&nbsp;<span class="builtintype" id="2510277">float64</span>&nbsp;<span class="op" id="2510285">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510288">sec</span>&nbsp;<span class="op" id="2510292">:=</span>&nbsp;<span class="ident" id="2510295">d</span>&nbsp;<span class="op" id="2510297">/</span>&nbsp;<span class="ident" id="2510299">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510307">nsec</span>&nbsp;<span class="op" id="2510312">:=</span>&nbsp;<span class="ident" id="2510315">d</span>&nbsp;<span class="op" id="2510317">%</span>&nbsp;<span class="ident" id="2510319">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510327">return</span>&nbsp;<span class="builtintype" id="2510334">float64</span><span class="op" id="2510341">(</span><span class="ident" id="2510342">sec</span><span class="op" id="2510345">)</span>&nbsp;<span class="op" id="2510347">+</span>&nbsp;<span class="builtintype" id="2510349">float64</span><span class="op" id="2510356">(</span><span class="ident" id="2510357">nsec</span><span class="op" id="2510361">)</span><span class="op" id="2510362">*</span><span class="num" id="2510363">1e-9</span><br>
<span class="lineno"></span><span class="op" id="2510368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2510371">//&nbsp;Minutes&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;minutes.</span><br>
<span class="lineno"></span><span class="keyword" id="2510442">func</span>&nbsp;<span class="op" id="2510447">(</span><span class="ident" id="2510448">d</span>&nbsp;<span class="ident" id="2510450">Duration</span><span class="op" id="2510458">)</span>&nbsp;<span class="ident" id="2510460">Minutes</span><span class="op" id="2510467">(</span><span class="op" id="2510468">)</span>&nbsp;<span class="builtintype" id="2510470">float64</span>&nbsp;<span class="op" id="2510478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510481">min</span>&nbsp;<span class="op" id="2510485">:=</span>&nbsp;<span class="ident" id="2510488">d</span>&nbsp;<span class="op" id="2510490">/</span>&nbsp;<span class="ident" id="2510492">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510500">nsec</span>&nbsp;<span class="op" id="2510505">:=</span>&nbsp;<span class="ident" id="2510508">d</span>&nbsp;<span class="op" id="2510510">%</span>&nbsp;<span class="ident" id="2510512">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510520">return</span>&nbsp;<span class="builtintype" id="2510527">float64</span><span class="op" id="2510534">(</span><span class="ident" id="2510535">min</span><span class="op" id="2510538">)</span>&nbsp;<span class="op" id="2510540">+</span>&nbsp;<span class="builtintype" id="2510542">float64</span><span class="op" id="2510549">(</span><span class="ident" id="2510550">nsec</span><span class="op" id="2510554">)</span><span class="op" id="2510555">*</span><span class="op" id="2510556">(</span><span class="num" id="2510557">1e-9</span><span class="op" id="2510561">/</span><span class="num" id="2510562">60</span><span class="op" id="2510564">)</span><br>
<span class="lineno">600</span><span class="op" id="2510566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2510569">//&nbsp;Hours&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;hours.</span><br>
<span class="lineno"></span><span class="keyword" id="2510636">func</span>&nbsp;<span class="op" id="2510641">(</span><span class="ident" id="2510642">d</span>&nbsp;<span class="ident" id="2510644">Duration</span><span class="op" id="2510652">)</span>&nbsp;<span class="ident" id="2510654">Hours</span><span class="op" id="2510659">(</span><span class="op" id="2510660">)</span>&nbsp;<span class="builtintype" id="2510662">float64</span>&nbsp;<span class="op" id="2510670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510673">hour</span>&nbsp;<span class="op" id="2510678">:=</span>&nbsp;<span class="ident" id="2510681">d</span>&nbsp;<span class="op" id="2510683">/</span>&nbsp;<span class="ident" id="2510685">Hour</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510691">nsec</span>&nbsp;<span class="op" id="2510696">:=</span>&nbsp;<span class="ident" id="2510699">d</span>&nbsp;<span class="op" id="2510701">%</span>&nbsp;<span class="ident" id="2510703">Hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510709">return</span>&nbsp;<span class="builtintype" id="2510716">float64</span><span class="op" id="2510723">(</span><span class="ident" id="2510724">hour</span><span class="op" id="2510728">)</span>&nbsp;<span class="op" id="2510730">+</span>&nbsp;<span class="builtintype" id="2510732">float64</span><span class="op" id="2510739">(</span><span class="ident" id="2510740">nsec</span><span class="op" id="2510744">)</span><span class="op" id="2510745">*</span><span class="op" id="2510746">(</span><span class="num" id="2510747">1e-9</span><span class="op" id="2510751">/</span><span class="num" id="2510752">60</span><span class="op" id="2510754">/</span><span class="num" id="2510755">60</span><span class="op" id="2510757">)</span><br>
<span class="lineno"></span><span class="op" id="2510759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2510762">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;time&nbsp;t+d.</span><br>
<span class="lineno">610</span><span class="keyword" id="2510791">func</span>&nbsp;<span class="op" id="2510796">(</span><span class="ident" id="2510797">t</span>&nbsp;<span class="ident" id="2510799">Time</span><span class="op" id="2510803">)</span>&nbsp;<span class="ident" id="2510805">Add</span><span class="op" id="2510808">(</span><span class="ident" id="2510809">d</span>&nbsp;<span class="ident" id="2510811">Duration</span><span class="op" id="2510819">)</span>&nbsp;<span class="ident" id="2510821">Time</span>&nbsp;<span class="op" id="2510826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510829">t</span><span class="op" id="2510830">.</span><span class="ident" id="2510831">sec</span>&nbsp;<span class="op" id="2510835">+=</span>&nbsp;<span class="ident" id="2510838">int64</span><span class="op" id="2510843">(</span><span class="ident" id="2510844">d</span>&nbsp;<span class="op" id="2510846">/</span>&nbsp;<span class="num" id="2510848">1e9</span><span class="op" id="2510851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510854">nsec</span>&nbsp;<span class="op" id="2510859">:=</span>&nbsp;<span class="builtintype" id="2510862">int32</span><span class="op" id="2510867">(</span><span class="ident" id="2510868">t</span><span class="op" id="2510869">.</span><span class="ident" id="2510870">nsec</span><span class="op" id="2510874">)</span>&nbsp;<span class="op" id="2510876">+</span>&nbsp;<span class="builtintype" id="2510878">int32</span><span class="op" id="2510883">(</span><span class="ident" id="2510884">d</span><span class="op" id="2510885">%</span><span class="num" id="2510886">1e9</span><span class="op" id="2510889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510892">if</span>&nbsp;<span class="ident" id="2510895">nsec</span>&nbsp;<span class="op" id="2510900">&gt;=</span>&nbsp;<span class="num" id="2510903">1e9</span>&nbsp;<span class="op" id="2510907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510911">t</span><span class="op" id="2510912">.</span><span class="ident" id="2510913">sec</span><span class="op" id="2510916">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510921">nsec</span>&nbsp;<span class="op" id="2510926">-=</span>&nbsp;<span class="num" id="2510929">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510934">}</span>&nbsp;<span class="keyword" id="2510936">else</span>&nbsp;<span class="keyword" id="2510941">if</span>&nbsp;<span class="ident" id="2510944">nsec</span>&nbsp;<span class="op" id="2510949">&lt;</span>&nbsp;<span class="num" id="2510951">0</span>&nbsp;<span class="op" id="2510953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510957">t</span><span class="op" id="2510958">.</span><span class="ident" id="2510959">sec</span><span class="op" id="2510962">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510967">nsec</span>&nbsp;<span class="op" id="2510972">+=</span>&nbsp;<span class="num" id="2510975">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510980">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510983">t</span><span class="op" id="2510984">.</span><span class="ident" id="2510985">nsec</span>&nbsp;<span class="op" id="2510990">=</span>&nbsp;<span class="ident" id="2510992">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510998">return</span>&nbsp;<span class="ident" id="2511005">t</span><br>
<span class="lineno"></span><span class="op" id="2511007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2511010">//&nbsp;Sub&nbsp;returns&nbsp;the&nbsp;duration&nbsp;t-u.&nbsp;If&nbsp;the&nbsp;result&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)</span><br>
<span class="lineno">625</span><span class="comment" id="2511090">//&nbsp;value&nbsp;that&nbsp;can&nbsp;be&nbsp;stored&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)&nbsp;duration</span><br>
<span class="lineno"></span><span class="comment" id="2511167">//&nbsp;will&nbsp;be&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="2511188">//&nbsp;To&nbsp;compute&nbsp;t-d&nbsp;for&nbsp;a&nbsp;duration&nbsp;d,&nbsp;use&nbsp;t.Add(-d).</span><br>
<span class="lineno"></span><span class="keyword" id="2511239">func</span>&nbsp;<span class="op" id="2511244">(</span><span class="ident" id="2511245">t</span>&nbsp;<span class="ident" id="2511247">Time</span><span class="op" id="2511251">)</span>&nbsp;<span class="ident" id="2511253">Sub</span><span class="op" id="2511256">(</span><span class="ident" id="2511257">u</span>&nbsp;<span class="ident" id="2511259">Time</span><span class="op" id="2511263">)</span>&nbsp;<span class="ident" id="2511265">Duration</span>&nbsp;<span class="op" id="2511274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511277">d</span>&nbsp;<span class="op" id="2511279">:=</span>&nbsp;<span class="ident" id="2511282">Duration</span><span class="op" id="2511290">(</span><span class="ident" id="2511291">t</span><span class="op" id="2511292">.</span><span class="ident" id="2511293">sec</span><span class="op" id="2511296">-</span><span class="ident" id="2511297">u</span><span class="op" id="2511298">.</span><span class="ident" id="2511299">sec</span><span class="op" id="2511302">)</span><span class="op" id="2511303">*</span><span class="ident" id="2511304">Second</span>&nbsp;<span class="op" id="2511311">+</span>&nbsp;<span class="ident" id="2511313">Duration</span><span class="op" id="2511321">(</span><span class="builtintype" id="2511322">int32</span><span class="op" id="2511327">(</span><span class="ident" id="2511328">t</span><span class="op" id="2511329">.</span><span class="ident" id="2511330">nsec</span><span class="op" id="2511334">)</span><span class="op" id="2511335">-</span><span class="builtintype" id="2511336">int32</span><span class="op" id="2511341">(</span><span class="ident" id="2511342">u</span><span class="op" id="2511343">.</span><span class="ident" id="2511344">nsec</span><span class="op" id="2511348">)</span><span class="op" id="2511349">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2511352">//&nbsp;Check&nbsp;for&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511389">switch</span>&nbsp;<span class="op" id="2511396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511399">case</span>&nbsp;<span class="ident" id="2511404">u</span><span class="op" id="2511405">.</span><span class="ident" id="2511406">Add</span><span class="op" id="2511409">(</span><span class="ident" id="2511410">d</span><span class="op" id="2511411">)</span><span class="op" id="2511412">.</span><span class="ident" id="2511413">Equal</span><span class="op" id="2511418">(</span><span class="ident" id="2511419">t</span><span class="op" id="2511420">)</span><span class="op" id="2511421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511425">return</span>&nbsp;<span class="ident" id="2511432">d</span>&nbsp;<span class="comment" id="2511434">//&nbsp;d&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511451">case</span>&nbsp;<span class="ident" id="2511456">t</span><span class="op" id="2511457">.</span><span class="ident" id="2511458">Before</span><span class="op" id="2511464">(</span><span class="ident" id="2511465">u</span><span class="op" id="2511466">)</span><span class="op" id="2511467">:</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511471">return</span>&nbsp;<span class="ident" id="2511478">minDuration</span>&nbsp;<span class="comment" id="2511490">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;negative&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511525">default</span><span class="op" id="2511532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511536">return</span>&nbsp;<span class="ident" id="2511543">maxDuration</span>&nbsp;<span class="comment" id="2511555">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;positive&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511590">}</span><br>
<span class="lineno"></span><span class="op" id="2511592">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2511595">//&nbsp;Since&nbsp;returns&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;since&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2511638">//&nbsp;It&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;time.Now().Sub(t).</span><br>
<span class="lineno"></span><span class="keyword" id="2511680">func</span>&nbsp;<span class="ident" id="2511685">Since</span><span class="op" id="2511690">(</span><span class="ident" id="2511691">t</span>&nbsp;<span class="ident" id="2511693">Time</span><span class="op" id="2511697">)</span>&nbsp;<span class="ident" id="2511699">Duration</span>&nbsp;<span class="op" id="2511708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511711">return</span>&nbsp;<span class="ident" id="2511718">Now</span><span class="op" id="2511721">(</span><span class="op" id="2511722">)</span><span class="op" id="2511723">.</span><span class="ident" id="2511724">Sub</span><span class="op" id="2511727">(</span><span class="ident" id="2511728">t</span><span class="op" id="2511729">)</span><br>
<span class="lineno">645</span><span class="op" id="2511731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2511734">//&nbsp;AddDate&nbsp;returns&nbsp;the&nbsp;time&nbsp;corresponding&nbsp;to&nbsp;adding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2511790">//&nbsp;given&nbsp;number&nbsp;of&nbsp;years,&nbsp;months,&nbsp;and&nbsp;days&nbsp;to&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2511839">//&nbsp;For&nbsp;example,&nbsp;AddDate(-1,&nbsp;2,&nbsp;3)&nbsp;applied&nbsp;to&nbsp;January&nbsp;1,&nbsp;2011</span><br>
<span class="lineno">650</span><span class="comment" id="2511900">//&nbsp;returns&nbsp;March&nbsp;4,&nbsp;2010.</span><br>
<span class="lineno"></span><span class="comment" id="2511926">//</span><br>
<span class="lineno"></span><span class="comment" id="2511929">//&nbsp;AddDate&nbsp;normalizes&nbsp;its&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;Date&nbsp;does,</span><br>
<span class="lineno"></span><span class="comment" id="2511994">//&nbsp;so,&nbsp;for&nbsp;example,&nbsp;adding&nbsp;one&nbsp;month&nbsp;to&nbsp;October&nbsp;31&nbsp;yields</span><br>
<span class="lineno"></span><span class="comment" id="2512052">//&nbsp;December&nbsp;1,&nbsp;the&nbsp;normalized&nbsp;form&nbsp;for&nbsp;November&nbsp;31.</span><br>
<span class="lineno">655</span><span class="keyword" id="2512104">func</span>&nbsp;<span class="op" id="2512109">(</span><span class="ident" id="2512110">t</span>&nbsp;<span class="ident" id="2512112">Time</span><span class="op" id="2512116">)</span>&nbsp;<span class="ident" id="2512118">AddDate</span><span class="op" id="2512125">(</span><span class="ident" id="2512126">years</span>&nbsp;<span class="builtintype" id="2512132">int</span><span class="op" id="2512135">,</span>&nbsp;<span class="ident" id="2512137">months</span>&nbsp;<span class="builtintype" id="2512144">int</span><span class="op" id="2512147">,</span>&nbsp;<span class="ident" id="2512149">days</span>&nbsp;<span class="builtintype" id="2512154">int</span><span class="op" id="2512157">)</span>&nbsp;<span class="ident" id="2512159">Time</span>&nbsp;<span class="op" id="2512164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512167">year</span><span class="op" id="2512171">,</span>&nbsp;<span class="ident" id="2512173">month</span><span class="op" id="2512178">,</span>&nbsp;<span class="ident" id="2512180">day</span>&nbsp;<span class="op" id="2512184">:=</span>&nbsp;<span class="ident" id="2512187">t</span><span class="op" id="2512188">.</span><span class="ident" id="2512189">Date</span><span class="op" id="2512193">(</span><span class="op" id="2512194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512197">hour</span><span class="op" id="2512201">,</span>&nbsp;<span class="ident" id="2512203">min</span><span class="op" id="2512206">,</span>&nbsp;<span class="ident" id="2512208">sec</span>&nbsp;<span class="op" id="2512212">:=</span>&nbsp;<span class="ident" id="2512215">t</span><span class="op" id="2512216">.</span><span class="ident" id="2512217">Clock</span><span class="op" id="2512222">(</span><span class="op" id="2512223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512226">return</span>&nbsp;<span class="ident" id="2512233">Date</span><span class="op" id="2512237">(</span><span class="ident" id="2512238">year</span><span class="op" id="2512242">+</span><span class="ident" id="2512243">years</span><span class="op" id="2512248">,</span>&nbsp;<span class="ident" id="2512250">month</span><span class="op" id="2512255">+</span><span class="ident" id="2512256">Month</span><span class="op" id="2512261">(</span><span class="ident" id="2512262">months</span><span class="op" id="2512268">)</span><span class="op" id="2512269">,</span>&nbsp;<span class="ident" id="2512271">day</span><span class="op" id="2512274">+</span><span class="ident" id="2512275">days</span><span class="op" id="2512279">,</span>&nbsp;<span class="ident" id="2512281">hour</span><span class="op" id="2512285">,</span>&nbsp;<span class="ident" id="2512287">min</span><span class="op" id="2512290">,</span>&nbsp;<span class="ident" id="2512292">sec</span><span class="op" id="2512295">,</span>&nbsp;<span class="builtintype" id="2512297">int</span><span class="op" id="2512300">(</span><span class="ident" id="2512301">t</span><span class="op" id="2512302">.</span><span class="ident" id="2512303">nsec</span><span class="op" id="2512307">)</span><span class="op" id="2512308">,</span>&nbsp;<span class="ident" id="2512310">t</span><span class="op" id="2512311">.</span><span class="ident" id="2512312">loc</span><span class="op" id="2512315">)</span><br>
<span class="lineno"></span><span class="op" id="2512317">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="keyword" id="2512320">const</span>&nbsp;<span class="op" id="2512326">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512329">secondsPerMinute</span>&nbsp;<span class="op" id="2512346">=</span>&nbsp;<span class="num" id="2512348">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512352">secondsPerHour</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2512369">=</span>&nbsp;<span class="num" id="2512371">60</span>&nbsp;<span class="op" id="2512374">*</span>&nbsp;<span class="num" id="2512376">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512380">secondsPerDay</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512397">=</span>&nbsp;<span class="num" id="2512399">24</span>&nbsp;<span class="op" id="2512402">*</span>&nbsp;<span class="ident" id="2512404">secondsPerHour</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512420">secondsPerWeek</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2512437">=</span>&nbsp;<span class="num" id="2512439">7</span>&nbsp;<span class="op" id="2512441">*</span>&nbsp;<span class="ident" id="2512443">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512458">daysPer400Years</span>&nbsp;&nbsp;<span class="op" id="2512475">=</span>&nbsp;<span class="num" id="2512477">365</span><span class="op" id="2512480">*</span><span class="num" id="2512481">400</span>&nbsp;<span class="op" id="2512485">+</span>&nbsp;<span class="num" id="2512487">97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512491">daysPer100Years</span>&nbsp;&nbsp;<span class="op" id="2512508">=</span>&nbsp;<span class="num" id="2512510">365</span><span class="op" id="2512513">*</span><span class="num" id="2512514">100</span>&nbsp;<span class="op" id="2512518">+</span>&nbsp;<span class="num" id="2512520">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512524">daysPer4Years</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2512541">=</span>&nbsp;<span class="num" id="2512543">365</span><span class="op" id="2512546">*</span><span class="num" id="2512547">4</span>&nbsp;<span class="op" id="2512549">+</span>&nbsp;<span class="num" id="2512551">1</span><br>
<span class="lineno"></span><span class="op" id="2512553">)</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="2512556">//&nbsp;date&nbsp;computes&nbsp;the&nbsp;year,&nbsp;day&nbsp;of&nbsp;year,&nbsp;and&nbsp;when&nbsp;full=true,</span><br>
<span class="lineno"></span><span class="comment" id="2512616">//&nbsp;the&nbsp;month&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2512656">func</span>&nbsp;<span class="op" id="2512661">(</span><span class="ident" id="2512662">t</span>&nbsp;<span class="ident" id="2512664">Time</span><span class="op" id="2512668">)</span>&nbsp;<span class="ident" id="2512670">date</span><span class="op" id="2512674">(</span><span class="ident" id="2512675">full</span>&nbsp;<span class="builtintype" id="2512680">bool</span><span class="op" id="2512684">)</span>&nbsp;<span class="op" id="2512686">(</span><span class="ident" id="2512687">year</span>&nbsp;<span class="builtintype" id="2512692">int</span><span class="op" id="2512695">,</span>&nbsp;<span class="ident" id="2512697">month</span>&nbsp;<span class="ident" id="2512703">Month</span><span class="op" id="2512708">,</span>&nbsp;<span class="ident" id="2512710">day</span>&nbsp;<span class="builtintype" id="2512714">int</span><span class="op" id="2512717">,</span>&nbsp;<span class="ident" id="2512719">yday</span>&nbsp;<span class="builtintype" id="2512724">int</span><span class="op" id="2512727">)</span>&nbsp;<span class="op" id="2512729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512732">return</span>&nbsp;<span class="ident" id="2512739">absDate</span><span class="op" id="2512746">(</span><span class="ident" id="2512747">t</span><span class="op" id="2512748">.</span><span class="ident" id="2512749">abs</span><span class="op" id="2512752">(</span><span class="op" id="2512753">)</span><span class="op" id="2512754">,</span>&nbsp;<span class="ident" id="2512756">full</span><span class="op" id="2512760">)</span><br>
<span class="lineno">675</span><span class="op" id="2512762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2512765">//&nbsp;absDate&nbsp;is&nbsp;like&nbsp;date&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2512823">func</span>&nbsp;<span class="ident" id="2512828">absDate</span><span class="op" id="2512835">(</span><span class="ident" id="2512836">abs</span>&nbsp;<span class="ident" id="2512840">uint64</span><span class="op" id="2512846">,</span>&nbsp;<span class="ident" id="2512848">full</span>&nbsp;<span class="builtintype" id="2512853">bool</span><span class="op" id="2512857">)</span>&nbsp;<span class="op" id="2512859">(</span><span class="ident" id="2512860">year</span>&nbsp;<span class="builtintype" id="2512865">int</span><span class="op" id="2512868">,</span>&nbsp;<span class="ident" id="2512870">month</span>&nbsp;<span class="ident" id="2512876">Month</span><span class="op" id="2512881">,</span>&nbsp;<span class="ident" id="2512883">day</span>&nbsp;<span class="builtintype" id="2512887">int</span><span class="op" id="2512890">,</span>&nbsp;<span class="ident" id="2512892">yday</span>&nbsp;<span class="builtintype" id="2512897">int</span><span class="op" id="2512900">)</span>&nbsp;<span class="op" id="2512902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2512905">//&nbsp;Split&nbsp;into&nbsp;time&nbsp;and&nbsp;day.</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512934">d</span>&nbsp;<span class="op" id="2512936">:=</span>&nbsp;<span class="ident" id="2512939">abs</span>&nbsp;<span class="op" id="2512943">/</span>&nbsp;<span class="ident" id="2512945">secondsPerDay</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2512961">//&nbsp;Account&nbsp;for&nbsp;400&nbsp;year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512994">n</span>&nbsp;<span class="op" id="2512996">:=</span>&nbsp;<span class="ident" id="2512999">d</span>&nbsp;<span class="op" id="2513001">/</span>&nbsp;<span class="ident" id="2513003">daysPer400Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513020">y</span>&nbsp;<span class="op" id="2513022">:=</span>&nbsp;<span class="num" id="2513025">400</span>&nbsp;<span class="op" id="2513029">*</span>&nbsp;<span class="ident" id="2513031">n</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513034">d</span>&nbsp;<span class="op" id="2513036">-=</span>&nbsp;<span class="ident" id="2513039">daysPer400Years</span>&nbsp;<span class="op" id="2513055">*</span>&nbsp;<span class="ident" id="2513057">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513061">//&nbsp;Cut&nbsp;off&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513090">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;one&nbsp;extra&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513153">//&nbsp;of&nbsp;that&nbsp;year,&nbsp;day&nbsp;/&nbsp;daysPer100Years&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513217">//&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513264">n</span>&nbsp;<span class="op" id="2513266">=</span>&nbsp;<span class="ident" id="2513268">d</span>&nbsp;<span class="op" id="2513270">/</span>&nbsp;<span class="ident" id="2513272">daysPer100Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513289">n</span>&nbsp;<span class="op" id="2513291">-=</span>&nbsp;<span class="ident" id="2513294">n</span>&nbsp;<span class="op" id="2513296">&gt;&gt;</span>&nbsp;<span class="num" id="2513299">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513302">y</span>&nbsp;<span class="op" id="2513304">+=</span>&nbsp;<span class="num" id="2513307">100</span>&nbsp;<span class="op" id="2513311">*</span>&nbsp;<span class="ident" id="2513313">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513316">d</span>&nbsp;<span class="op" id="2513318">-=</span>&nbsp;<span class="ident" id="2513321">daysPer100Years</span>&nbsp;<span class="op" id="2513337">*</span>&nbsp;<span class="ident" id="2513339">n</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513343">//&nbsp;Cut&nbsp;off&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513370">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;a&nbsp;missing&nbsp;leap&nbsp;year,&nbsp;which&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513429">//&nbsp;affect&nbsp;the&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513457">n</span>&nbsp;<span class="op" id="2513459">=</span>&nbsp;<span class="ident" id="2513461">d</span>&nbsp;<span class="op" id="2513463">/</span>&nbsp;<span class="ident" id="2513465">daysPer4Years</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513480">y</span>&nbsp;<span class="op" id="2513482">+=</span>&nbsp;<span class="num" id="2513485">4</span>&nbsp;<span class="op" id="2513487">*</span>&nbsp;<span class="ident" id="2513489">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513492">d</span>&nbsp;<span class="op" id="2513494">-=</span>&nbsp;<span class="ident" id="2513497">daysPer4Years</span>&nbsp;<span class="op" id="2513511">*</span>&nbsp;<span class="ident" id="2513513">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513517">//&nbsp;Cut&nbsp;off&nbsp;years&nbsp;within&nbsp;a&nbsp;4-year&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513558">//&nbsp;The&nbsp;last&nbsp;year&nbsp;is&nbsp;a&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day&nbsp;of&nbsp;that&nbsp;year,</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513625">//&nbsp;day&nbsp;/&nbsp;365&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.&nbsp;&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513686">//&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513711">n</span>&nbsp;<span class="op" id="2513713">=</span>&nbsp;<span class="ident" id="2513715">d</span>&nbsp;<span class="op" id="2513717">/</span>&nbsp;<span class="num" id="2513719">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513724">n</span>&nbsp;<span class="op" id="2513726">-=</span>&nbsp;<span class="ident" id="2513729">n</span>&nbsp;<span class="op" id="2513731">&gt;&gt;</span>&nbsp;<span class="num" id="2513734">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513737">y</span>&nbsp;<span class="op" id="2513739">+=</span>&nbsp;<span class="ident" id="2513742">n</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513745">d</span>&nbsp;<span class="op" id="2513747">-=</span>&nbsp;<span class="num" id="2513750">365</span>&nbsp;<span class="op" id="2513754">*</span>&nbsp;<span class="ident" id="2513756">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513760">year</span>&nbsp;<span class="op" id="2513765">=</span>&nbsp;<span class="builtintype" id="2513767">int</span><span class="op" id="2513770">(</span><span class="ident" id="2513771">int64</span><span class="op" id="2513776">(</span><span class="ident" id="2513777">y</span><span class="op" id="2513778">)</span>&nbsp;<span class="op" id="2513780">+</span>&nbsp;<span class="ident" id="2513782">absoluteZeroYear</span><span class="op" id="2513798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513801">yday</span>&nbsp;<span class="op" id="2513806">=</span>&nbsp;<span class="builtintype" id="2513808">int</span><span class="op" id="2513811">(</span><span class="ident" id="2513812">d</span><span class="op" id="2513813">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513817">if</span>&nbsp;<span class="op" id="2513820">!</span><span class="ident" id="2513821">full</span>&nbsp;<span class="op" id="2513826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513830">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513842">day</span>&nbsp;<span class="op" id="2513846">=</span>&nbsp;<span class="ident" id="2513848">yday</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513854">if</span>&nbsp;<span class="ident" id="2513857">isLeap</span><span class="op" id="2513863">(</span><span class="ident" id="2513864">year</span><span class="op" id="2513868">)</span>&nbsp;<span class="op" id="2513870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513874">//&nbsp;Leap&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513889">switch</span>&nbsp;<span class="op" id="2513896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513900">case</span>&nbsp;<span class="ident" id="2513905">day</span>&nbsp;<span class="op" id="2513909">&gt;</span>&nbsp;<span class="num" id="2513911">31</span><span class="op" id="2513913">+</span><span class="num" id="2513914">29</span><span class="op" id="2513916">-</span><span class="num" id="2513917">1</span><span class="op" id="2513918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2513923">//&nbsp;After&nbsp;leap&nbsp;day;&nbsp;pretend&nbsp;it&nbsp;wasn&#39;t&nbsp;there.</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513970">day</span><span class="op" id="2513973">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513978">case</span>&nbsp;<span class="ident" id="2513983">day</span>&nbsp;<span class="op" id="2513987">==</span>&nbsp;<span class="num" id="2513990">31</span><span class="op" id="2513992">+</span><span class="num" id="2513993">29</span><span class="op" id="2513995">-</span><span class="num" id="2513996">1</span><span class="op" id="2513997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514002">//&nbsp;Leap&nbsp;day.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514018">month</span>&nbsp;<span class="op" id="2514024">=</span>&nbsp;<span class="ident" id="2514026">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514038">day</span>&nbsp;<span class="op" id="2514042">=</span>&nbsp;<span class="num" id="2514044">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514050">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514066">//&nbsp;Estimate&nbsp;month&nbsp;on&nbsp;assumption&nbsp;that&nbsp;every&nbsp;month&nbsp;has&nbsp;31&nbsp;days.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2514129">//&nbsp;The&nbsp;estimate&nbsp;may&nbsp;be&nbsp;too&nbsp;low&nbsp;by&nbsp;at&nbsp;most&nbsp;one&nbsp;month,&nbsp;so&nbsp;adjust.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514194">month</span>&nbsp;<span class="op" id="2514200">=</span>&nbsp;<span class="ident" id="2514202">Month</span><span class="op" id="2514207">(</span><span class="ident" id="2514208">day</span>&nbsp;<span class="op" id="2514212">/</span>&nbsp;<span class="num" id="2514214">31</span><span class="op" id="2514216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514219">end</span>&nbsp;<span class="op" id="2514223">:=</span>&nbsp;<span class="builtintype" id="2514226">int</span><span class="op" id="2514229">(</span><span class="ident" id="2514230">daysBefore</span><span class="op" id="2514240">[</span><span class="ident" id="2514241">month</span><span class="op" id="2514246">+</span><span class="num" id="2514247">1</span><span class="op" id="2514248">]</span><span class="op" id="2514249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514252">var</span>&nbsp;<span class="ident" id="2514256">begin</span>&nbsp;<span class="builtintype" id="2514262">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514267">if</span>&nbsp;<span class="ident" id="2514270">day</span>&nbsp;<span class="op" id="2514274">&gt;=</span>&nbsp;<span class="ident" id="2514277">end</span>&nbsp;<span class="op" id="2514281">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514285">month</span><span class="op" id="2514290">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514295">begin</span>&nbsp;<span class="op" id="2514301">=</span>&nbsp;<span class="ident" id="2514303">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514308">}</span>&nbsp;<span class="keyword" id="2514310">else</span>&nbsp;<span class="op" id="2514315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514319">begin</span>&nbsp;<span class="op" id="2514325">=</span>&nbsp;<span class="builtintype" id="2514327">int</span><span class="op" id="2514330">(</span><span class="ident" id="2514331">daysBefore</span><span class="op" id="2514341">[</span><span class="ident" id="2514342">month</span><span class="op" id="2514347">]</span><span class="op" id="2514348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514351">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514355">month</span><span class="op" id="2514360">++</span>&nbsp;<span class="comment" id="2514363">//&nbsp;because&nbsp;January&nbsp;is&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514388">day</span>&nbsp;<span class="op" id="2514392">=</span>&nbsp;<span class="ident" id="2514394">day</span>&nbsp;<span class="op" id="2514398">-</span>&nbsp;<span class="ident" id="2514400">begin</span>&nbsp;<span class="op" id="2514406">+</span>&nbsp;<span class="num" id="2514408">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514411">return</span><br>
<span class="lineno"></span><span class="op" id="2514418">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="comment" id="2514421">//&nbsp;daysBefore[m]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;a&nbsp;non-leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2514483">//&nbsp;before&nbsp;month&nbsp;m&nbsp;begins.&nbsp;&nbsp;There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;m=12,&nbsp;counting</span><br>
<span class="lineno"></span><span class="comment" id="2514547">//&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;before&nbsp;January&nbsp;of&nbsp;next&nbsp;year&nbsp;(365).</span><br>
<span class="lineno"></span><span class="keyword" id="2514604">var</span>&nbsp;<span class="ident" id="2514608">daysBefore</span>&nbsp;<span class="op" id="2514619">=</span>&nbsp;<span class="op" id="2514621">[</span><span class="op" id="2514622">...</span><span class="op" id="2514625">]</span><span class="builtintype" id="2514626">int32</span><span class="op" id="2514631">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514634">0</span><span class="op" id="2514635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514638">31</span><span class="op" id="2514640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514643">31</span>&nbsp;<span class="op" id="2514646">+</span>&nbsp;<span class="num" id="2514648">28</span><span class="op" id="2514650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514653">31</span>&nbsp;<span class="op" id="2514656">+</span>&nbsp;<span class="num" id="2514658">28</span>&nbsp;<span class="op" id="2514661">+</span>&nbsp;<span class="num" id="2514663">31</span><span class="op" id="2514665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514668">31</span>&nbsp;<span class="op" id="2514671">+</span>&nbsp;<span class="num" id="2514673">28</span>&nbsp;<span class="op" id="2514676">+</span>&nbsp;<span class="num" id="2514678">31</span>&nbsp;<span class="op" id="2514681">+</span>&nbsp;<span class="num" id="2514683">30</span><span class="op" id="2514685">,</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514688">31</span>&nbsp;<span class="op" id="2514691">+</span>&nbsp;<span class="num" id="2514693">28</span>&nbsp;<span class="op" id="2514696">+</span>&nbsp;<span class="num" id="2514698">31</span>&nbsp;<span class="op" id="2514701">+</span>&nbsp;<span class="num" id="2514703">30</span>&nbsp;<span class="op" id="2514706">+</span>&nbsp;<span class="num" id="2514708">31</span><span class="op" id="2514710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514713">31</span>&nbsp;<span class="op" id="2514716">+</span>&nbsp;<span class="num" id="2514718">28</span>&nbsp;<span class="op" id="2514721">+</span>&nbsp;<span class="num" id="2514723">31</span>&nbsp;<span class="op" id="2514726">+</span>&nbsp;<span class="num" id="2514728">30</span>&nbsp;<span class="op" id="2514731">+</span>&nbsp;<span class="num" id="2514733">31</span>&nbsp;<span class="op" id="2514736">+</span>&nbsp;<span class="num" id="2514738">30</span><span class="op" id="2514740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514743">31</span>&nbsp;<span class="op" id="2514746">+</span>&nbsp;<span class="num" id="2514748">28</span>&nbsp;<span class="op" id="2514751">+</span>&nbsp;<span class="num" id="2514753">31</span>&nbsp;<span class="op" id="2514756">+</span>&nbsp;<span class="num" id="2514758">30</span>&nbsp;<span class="op" id="2514761">+</span>&nbsp;<span class="num" id="2514763">31</span>&nbsp;<span class="op" id="2514766">+</span>&nbsp;<span class="num" id="2514768">30</span>&nbsp;<span class="op" id="2514771">+</span>&nbsp;<span class="num" id="2514773">31</span><span class="op" id="2514775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514778">31</span>&nbsp;<span class="op" id="2514781">+</span>&nbsp;<span class="num" id="2514783">28</span>&nbsp;<span class="op" id="2514786">+</span>&nbsp;<span class="num" id="2514788">31</span>&nbsp;<span class="op" id="2514791">+</span>&nbsp;<span class="num" id="2514793">30</span>&nbsp;<span class="op" id="2514796">+</span>&nbsp;<span class="num" id="2514798">31</span>&nbsp;<span class="op" id="2514801">+</span>&nbsp;<span class="num" id="2514803">30</span>&nbsp;<span class="op" id="2514806">+</span>&nbsp;<span class="num" id="2514808">31</span>&nbsp;<span class="op" id="2514811">+</span>&nbsp;<span class="num" id="2514813">31</span><span class="op" id="2514815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514818">31</span>&nbsp;<span class="op" id="2514821">+</span>&nbsp;<span class="num" id="2514823">28</span>&nbsp;<span class="op" id="2514826">+</span>&nbsp;<span class="num" id="2514828">31</span>&nbsp;<span class="op" id="2514831">+</span>&nbsp;<span class="num" id="2514833">30</span>&nbsp;<span class="op" id="2514836">+</span>&nbsp;<span class="num" id="2514838">31</span>&nbsp;<span class="op" id="2514841">+</span>&nbsp;<span class="num" id="2514843">30</span>&nbsp;<span class="op" id="2514846">+</span>&nbsp;<span class="num" id="2514848">31</span>&nbsp;<span class="op" id="2514851">+</span>&nbsp;<span class="num" id="2514853">31</span>&nbsp;<span class="op" id="2514856">+</span>&nbsp;<span class="num" id="2514858">30</span><span class="op" id="2514860">,</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514863">31</span>&nbsp;<span class="op" id="2514866">+</span>&nbsp;<span class="num" id="2514868">28</span>&nbsp;<span class="op" id="2514871">+</span>&nbsp;<span class="num" id="2514873">31</span>&nbsp;<span class="op" id="2514876">+</span>&nbsp;<span class="num" id="2514878">30</span>&nbsp;<span class="op" id="2514881">+</span>&nbsp;<span class="num" id="2514883">31</span>&nbsp;<span class="op" id="2514886">+</span>&nbsp;<span class="num" id="2514888">30</span>&nbsp;<span class="op" id="2514891">+</span>&nbsp;<span class="num" id="2514893">31</span>&nbsp;<span class="op" id="2514896">+</span>&nbsp;<span class="num" id="2514898">31</span>&nbsp;<span class="op" id="2514901">+</span>&nbsp;<span class="num" id="2514903">30</span>&nbsp;<span class="op" id="2514906">+</span>&nbsp;<span class="num" id="2514908">31</span><span class="op" id="2514910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514913">31</span>&nbsp;<span class="op" id="2514916">+</span>&nbsp;<span class="num" id="2514918">28</span>&nbsp;<span class="op" id="2514921">+</span>&nbsp;<span class="num" id="2514923">31</span>&nbsp;<span class="op" id="2514926">+</span>&nbsp;<span class="num" id="2514928">30</span>&nbsp;<span class="op" id="2514931">+</span>&nbsp;<span class="num" id="2514933">31</span>&nbsp;<span class="op" id="2514936">+</span>&nbsp;<span class="num" id="2514938">30</span>&nbsp;<span class="op" id="2514941">+</span>&nbsp;<span class="num" id="2514943">31</span>&nbsp;<span class="op" id="2514946">+</span>&nbsp;<span class="num" id="2514948">31</span>&nbsp;<span class="op" id="2514951">+</span>&nbsp;<span class="num" id="2514953">30</span>&nbsp;<span class="op" id="2514956">+</span>&nbsp;<span class="num" id="2514958">31</span>&nbsp;<span class="op" id="2514961">+</span>&nbsp;<span class="num" id="2514963">30</span><span class="op" id="2514965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2514968">31</span>&nbsp;<span class="op" id="2514971">+</span>&nbsp;<span class="num" id="2514973">28</span>&nbsp;<span class="op" id="2514976">+</span>&nbsp;<span class="num" id="2514978">31</span>&nbsp;<span class="op" id="2514981">+</span>&nbsp;<span class="num" id="2514983">30</span>&nbsp;<span class="op" id="2514986">+</span>&nbsp;<span class="num" id="2514988">31</span>&nbsp;<span class="op" id="2514991">+</span>&nbsp;<span class="num" id="2514993">30</span>&nbsp;<span class="op" id="2514996">+</span>&nbsp;<span class="num" id="2514998">31</span>&nbsp;<span class="op" id="2515001">+</span>&nbsp;<span class="num" id="2515003">31</span>&nbsp;<span class="op" id="2515006">+</span>&nbsp;<span class="num" id="2515008">30</span>&nbsp;<span class="op" id="2515011">+</span>&nbsp;<span class="num" id="2515013">31</span>&nbsp;<span class="op" id="2515016">+</span>&nbsp;<span class="num" id="2515018">30</span>&nbsp;<span class="op" id="2515021">+</span>&nbsp;<span class="num" id="2515023">31</span><span class="op" id="2515025">,</span><br>
<span class="lineno"></span><span class="op" id="2515027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span><span class="keyword" id="2515030">func</span>&nbsp;<span class="ident" id="2515035">daysIn</span><span class="op" id="2515041">(</span><span class="ident" id="2515042">m</span>&nbsp;<span class="ident" id="2515044">Month</span><span class="op" id="2515049">,</span>&nbsp;<span class="ident" id="2515051">year</span>&nbsp;<span class="builtintype" id="2515056">int</span><span class="op" id="2515059">)</span>&nbsp;<span class="builtintype" id="2515061">int</span>&nbsp;<span class="op" id="2515065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515068">if</span>&nbsp;<span class="ident" id="2515071">m</span>&nbsp;<span class="op" id="2515073">==</span>&nbsp;<span class="ident" id="2515076">February</span>&nbsp;<span class="op" id="2515085">&amp;&amp;</span>&nbsp;<span class="ident" id="2515088">isLeap</span><span class="op" id="2515094">(</span><span class="ident" id="2515095">year</span><span class="op" id="2515099">)</span>&nbsp;<span class="op" id="2515101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515105">return</span>&nbsp;<span class="num" id="2515112">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515119">return</span>&nbsp;<span class="builtintype" id="2515126">int</span><span class="op" id="2515129">(</span><span class="ident" id="2515130">daysBefore</span><span class="op" id="2515140">[</span><span class="ident" id="2515141">m</span><span class="op" id="2515142">]</span>&nbsp;<span class="op" id="2515144">-</span>&nbsp;<span class="ident" id="2515146">daysBefore</span><span class="op" id="2515156">[</span><span class="ident" id="2515157">m</span><span class="op" id="2515158">-</span><span class="num" id="2515159">1</span><span class="op" id="2515160">]</span><span class="op" id="2515161">)</span><br>
<span class="lineno">775</span><span class="op" id="2515163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515166">//&nbsp;Provided&nbsp;by&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="2515198">func</span>&nbsp;<span class="ident" id="2515203">now</span><span class="op" id="2515206">(</span><span class="op" id="2515207">)</span>&nbsp;<span class="op" id="2515209">(</span><span class="ident" id="2515210">sec</span>&nbsp;<span class="ident" id="2515214">int64</span><span class="op" id="2515219">,</span>&nbsp;<span class="ident" id="2515221">nsec</span>&nbsp;<span class="builtintype" id="2515226">int32</span><span class="op" id="2515231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="comment" id="2515234">//&nbsp;Now&nbsp;returns&nbsp;the&nbsp;current&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2515273">func</span>&nbsp;<span class="ident" id="2515278">Now</span><span class="op" id="2515281">(</span><span class="op" id="2515282">)</span>&nbsp;<span class="ident" id="2515284">Time</span>&nbsp;<span class="op" id="2515289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515292">sec</span><span class="op" id="2515295">,</span>&nbsp;<span class="ident" id="2515297">nsec</span>&nbsp;<span class="op" id="2515302">:=</span>&nbsp;<span class="ident" id="2515305">now</span><span class="op" id="2515308">(</span><span class="op" id="2515309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515312">return</span>&nbsp;<span class="ident" id="2515319">Time</span><span class="op" id="2515323">{</span><span class="ident" id="2515324">sec</span>&nbsp;<span class="op" id="2515328">+</span>&nbsp;<span class="ident" id="2515330">unixToInternal</span><span class="op" id="2515344">,</span>&nbsp;<span class="ident" id="2515346">nsec</span><span class="op" id="2515350">,</span>&nbsp;<span class="ident" id="2515352">Local</span><span class="op" id="2515357">}</span><br>
<span class="lineno"></span><span class="op" id="2515359">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="comment" id="2515362">//&nbsp;UTC&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2515409">func</span>&nbsp;<span class="op" id="2515414">(</span><span class="ident" id="2515415">t</span>&nbsp;<span class="ident" id="2515417">Time</span><span class="op" id="2515421">)</span>&nbsp;<span class="ident" id="2515423">UTC</span><span class="op" id="2515426">(</span><span class="op" id="2515427">)</span>&nbsp;<span class="ident" id="2515429">Time</span>&nbsp;<span class="op" id="2515434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515437">t</span><span class="op" id="2515438">.</span><span class="ident" id="2515439">loc</span>&nbsp;<span class="op" id="2515443">=</span>&nbsp;<span class="ident" id="2515445">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515450">return</span>&nbsp;<span class="ident" id="2515457">t</span><br>
<span class="lineno">790</span><span class="op" id="2515459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515462">//&nbsp;Local&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2515518">func</span>&nbsp;<span class="op" id="2515523">(</span><span class="ident" id="2515524">t</span>&nbsp;<span class="ident" id="2515526">Time</span><span class="op" id="2515530">)</span>&nbsp;<span class="ident" id="2515532">Local</span><span class="op" id="2515537">(</span><span class="op" id="2515538">)</span>&nbsp;<span class="ident" id="2515540">Time</span>&nbsp;<span class="op" id="2515545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515548">t</span><span class="op" id="2515549">.</span><span class="ident" id="2515550">loc</span>&nbsp;<span class="op" id="2515554">=</span>&nbsp;<span class="ident" id="2515556">Local</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515563">return</span>&nbsp;<span class="ident" id="2515570">t</span><br>
<span class="lineno"></span><span class="op" id="2515572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515575">//&nbsp;In&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;information&nbsp;set&nbsp;to&nbsp;loc.</span><br>
<span class="lineno"></span><span class="comment" id="2515633">//</span><br>
<span class="lineno">800</span><span class="comment" id="2515636">//&nbsp;In&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2515664">func</span>&nbsp;<span class="op" id="2515669">(</span><span class="ident" id="2515670">t</span>&nbsp;<span class="ident" id="2515672">Time</span><span class="op" id="2515676">)</span>&nbsp;<span class="ident" id="2515678">In</span><span class="op" id="2515680">(</span><span class="ident" id="2515681">loc</span>&nbsp;<span class="op" id="2515685">*</span><span class="ident" id="2515686">Location</span><span class="op" id="2515694">)</span>&nbsp;<span class="ident" id="2515696">Time</span>&nbsp;<span class="op" id="2515701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515704">if</span>&nbsp;<span class="ident" id="2515707">loc</span>&nbsp;<span class="op" id="2515711">==</span>&nbsp;<span class="ident" id="2515714">nil</span>&nbsp;<span class="op" id="2515718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515722">panic</span><span class="op" id="2515727">(</span><span class="string" id="2515728">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Time.In&#34;</span><span class="op" id="2515771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515774">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515777">t</span><span class="op" id="2515778">.</span><span class="ident" id="2515779">loc</span>&nbsp;<span class="op" id="2515783">=</span>&nbsp;<span class="ident" id="2515785">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515790">return</span>&nbsp;<span class="ident" id="2515797">t</span><br>
<span class="lineno"></span><span class="op" id="2515799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515802">//&nbsp;Location&nbsp;returns&nbsp;the&nbsp;time&nbsp;zone&nbsp;information&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno">810</span><span class="keyword" id="2515867">func</span>&nbsp;<span class="op" id="2515872">(</span><span class="ident" id="2515873">t</span>&nbsp;<span class="ident" id="2515875">Time</span><span class="op" id="2515879">)</span>&nbsp;<span class="ident" id="2515881">Location</span><span class="op" id="2515889">(</span><span class="op" id="2515890">)</span>&nbsp;<span class="op" id="2515892">*</span><span class="ident" id="2515893">Location</span>&nbsp;<span class="op" id="2515902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515905">l</span>&nbsp;<span class="op" id="2515907">:=</span>&nbsp;<span class="ident" id="2515910">t</span><span class="op" id="2515911">.</span><span class="ident" id="2515912">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515917">if</span>&nbsp;<span class="ident" id="2515920">l</span>&nbsp;<span class="op" id="2515922">==</span>&nbsp;<span class="ident" id="2515925">nil</span>&nbsp;<span class="op" id="2515929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515933">l</span>&nbsp;<span class="op" id="2515935">=</span>&nbsp;<span class="ident" id="2515937">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515942">}</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515945">return</span>&nbsp;<span class="ident" id="2515952">l</span><br>
<span class="lineno"></span><span class="op" id="2515954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2515957">//&nbsp;Zone&nbsp;computes&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;effect&nbsp;at&nbsp;time&nbsp;t,&nbsp;returning&nbsp;the&nbsp;abbreviated</span><br>
<span class="lineno"></span><span class="comment" id="2516035">//&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;)&nbsp;and&nbsp;its&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC.</span><br>
<span class="lineno">820</span><span class="keyword" id="2516110">func</span>&nbsp;<span class="op" id="2516115">(</span><span class="ident" id="2516116">t</span>&nbsp;<span class="ident" id="2516118">Time</span><span class="op" id="2516122">)</span>&nbsp;<span class="ident" id="2516124">Zone</span><span class="op" id="2516128">(</span><span class="op" id="2516129">)</span>&nbsp;<span class="op" id="2516131">(</span><span class="ident" id="2516132">name</span>&nbsp;<span class="builtintype" id="2516137">string</span><span class="op" id="2516143">,</span>&nbsp;<span class="ident" id="2516145">offset</span>&nbsp;<span class="builtintype" id="2516152">int</span><span class="op" id="2516155">)</span>&nbsp;<span class="op" id="2516157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516160">name</span><span class="op" id="2516164">,</span>&nbsp;<span class="ident" id="2516166">offset</span><span class="op" id="2516172">,</span>&nbsp;<span class="ident" id="2516174">_</span><span class="op" id="2516175">,</span>&nbsp;<span class="ident" id="2516177">_</span><span class="op" id="2516178">,</span>&nbsp;<span class="ident" id="2516180">_</span>&nbsp;<span class="op" id="2516182">=</span>&nbsp;<span class="ident" id="2516184">t</span><span class="op" id="2516185">.</span><span class="ident" id="2516186">loc</span><span class="op" id="2516189">.</span><span class="ident" id="2516190">lookup</span><span class="op" id="2516196">(</span><span class="ident" id="2516197">t</span><span class="op" id="2516198">.</span><span class="ident" id="2516199">sec</span>&nbsp;<span class="op" id="2516203">+</span>&nbsp;<span class="ident" id="2516205">internalToUnix</span><span class="op" id="2516219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516222">return</span><br>
<span class="lineno"></span><span class="op" id="2516229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="2516232">//&nbsp;Unix&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2516296">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2516326">func</span>&nbsp;<span class="op" id="2516331">(</span><span class="ident" id="2516332">t</span>&nbsp;<span class="ident" id="2516334">Time</span><span class="op" id="2516338">)</span>&nbsp;<span class="ident" id="2516340">Unix</span><span class="op" id="2516344">(</span><span class="op" id="2516345">)</span>&nbsp;<span class="ident" id="2516347">int64</span>&nbsp;<span class="op" id="2516353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516356">return</span>&nbsp;<span class="ident" id="2516363">t</span><span class="op" id="2516364">.</span><span class="ident" id="2516365">sec</span>&nbsp;<span class="op" id="2516369">+</span>&nbsp;<span class="ident" id="2516371">internalToUnix</span><br>
<span class="lineno"></span><span class="op" id="2516386">}</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span><span class="comment" id="2516389">//&nbsp;UnixNano&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;nanoseconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2516461">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.&nbsp;The&nbsp;result&nbsp;is&nbsp;undefined&nbsp;if&nbsp;the&nbsp;Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2516532">//&nbsp;in&nbsp;nanoseconds&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;an&nbsp;int64.&nbsp;Note&nbsp;that&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2516600">//&nbsp;means&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;UnixNano&nbsp;on&nbsp;the&nbsp;zero&nbsp;Time&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">835</span><span class="keyword" id="2516671">func</span>&nbsp;<span class="op" id="2516676">(</span><span class="ident" id="2516677">t</span>&nbsp;<span class="ident" id="2516679">Time</span><span class="op" id="2516683">)</span>&nbsp;<span class="ident" id="2516685">UnixNano</span><span class="op" id="2516693">(</span><span class="op" id="2516694">)</span>&nbsp;<span class="ident" id="2516696">int64</span>&nbsp;<span class="op" id="2516702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516705">return</span>&nbsp;<span class="op" id="2516712">(</span><span class="ident" id="2516713">t</span><span class="op" id="2516714">.</span><span class="ident" id="2516715">sec</span><span class="op" id="2516718">+</span><span class="ident" id="2516719">internalToUnix</span><span class="op" id="2516733">)</span><span class="op" id="2516734">*</span><span class="num" id="2516735">1e9</span>&nbsp;<span class="op" id="2516739">+</span>&nbsp;<span class="ident" id="2516741">int64</span><span class="op" id="2516746">(</span><span class="ident" id="2516747">t</span><span class="op" id="2516748">.</span><span class="ident" id="2516749">nsec</span><span class="op" id="2516753">)</span><br>
<span class="lineno"></span><span class="op" id="2516755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2516758">const</span>&nbsp;<span class="ident" id="2516764">timeBinaryVersion</span>&nbsp;<span class="builtintype" id="2516782">byte</span>&nbsp;<span class="op" id="2516787">=</span>&nbsp;<span class="num" id="2516789">1</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="comment" id="2516792">//&nbsp;MarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2516860">func</span>&nbsp;<span class="op" id="2516865">(</span><span class="ident" id="2516866">t</span>&nbsp;<span class="ident" id="2516868">Time</span><span class="op" id="2516872">)</span>&nbsp;<span class="ident" id="2516874">MarshalBinary</span><span class="op" id="2516887">(</span><span class="op" id="2516888">)</span>&nbsp;<span class="op" id="2516890">(</span><span class="op" id="2516891">[</span><span class="op" id="2516892">]</span><span class="builtintype" id="2516893">byte</span><span class="op" id="2516897">,</span>&nbsp;<span class="builtintype" id="2516899">error</span><span class="op" id="2516904">)</span>&nbsp;<span class="op" id="2516906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516909">var</span>&nbsp;<span class="ident" id="2516913">offsetMin</span>&nbsp;<span class="builtintype" id="2516923">int16</span>&nbsp;<span class="comment" id="2516929">//&nbsp;minutes&nbsp;east&nbsp;of&nbsp;UTC.&nbsp;-1&nbsp;is&nbsp;UTC.</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516966">if</span>&nbsp;<span class="ident" id="2516969">t</span><span class="op" id="2516970">.</span><span class="ident" id="2516971">Location</span><span class="op" id="2516979">(</span><span class="op" id="2516980">)</span>&nbsp;<span class="op" id="2516982">==</span>&nbsp;<span class="op" id="2516985">&amp;</span><span class="ident" id="2516986">utcLoc</span>&nbsp;<span class="op" id="2516993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516997">offsetMin</span>&nbsp;<span class="op" id="2517007">=</span>&nbsp;<span class="op" id="2517009">-</span><span class="num" id="2517010">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517013">}</span>&nbsp;<span class="keyword" id="2517015">else</span>&nbsp;<span class="op" id="2517020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517024">_</span><span class="op" id="2517025">,</span>&nbsp;<span class="ident" id="2517027">offset</span>&nbsp;<span class="op" id="2517034">:=</span>&nbsp;<span class="ident" id="2517037">t</span><span class="op" id="2517038">.</span><span class="ident" id="2517039">Zone</span><span class="op" id="2517043">(</span><span class="op" id="2517044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517048">if</span>&nbsp;<span class="ident" id="2517051">offset</span><span class="op" id="2517057">%</span><span class="num" id="2517058">60</span>&nbsp;<span class="op" id="2517061">!=</span>&nbsp;<span class="num" id="2517064">0</span>&nbsp;<span class="op" id="2517066">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517071">return</span>&nbsp;<span class="ident" id="2517078">nil</span><span class="op" id="2517081">,</span>&nbsp;<span class="ident" id="2517083">errors</span><span class="op" id="2517089">.</span><span class="ident" id="2517090">New</span><span class="op" id="2517093">(</span><span class="string" id="2517094">&#34;Time.MarshalBinary:&nbsp;zone&nbsp;offset&nbsp;has&nbsp;fractional&nbsp;minute&#34;</span><span class="op" id="2517149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517157">offset</span>&nbsp;<span class="op" id="2517164">/=</span>&nbsp;<span class="num" id="2517167">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517172">if</span>&nbsp;<span class="ident" id="2517175">offset</span>&nbsp;<span class="op" id="2517182">&lt;</span>&nbsp;<span class="op" id="2517184">-</span><span class="num" id="2517185">32768</span>&nbsp;<span class="op" id="2517191">||</span>&nbsp;<span class="ident" id="2517194">offset</span>&nbsp;<span class="op" id="2517201">==</span>&nbsp;<span class="op" id="2517204">-</span><span class="num" id="2517205">1</span>&nbsp;<span class="op" id="2517207">||</span>&nbsp;<span class="ident" id="2517210">offset</span>&nbsp;<span class="op" id="2517217">&gt;</span>&nbsp;<span class="num" id="2517219">32767</span>&nbsp;<span class="op" id="2517225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517230">return</span>&nbsp;<span class="ident" id="2517237">nil</span><span class="op" id="2517240">,</span>&nbsp;<span class="ident" id="2517242">errors</span><span class="op" id="2517248">.</span><span class="ident" id="2517249">New</span><span class="op" id="2517252">(</span><span class="string" id="2517253">&#34;Time.MarshalBinary:&nbsp;unexpected&nbsp;zone&nbsp;offset&#34;</span><span class="op" id="2517297">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517305">offsetMin</span>&nbsp;<span class="op" id="2517315">=</span>&nbsp;<span class="builtintype" id="2517317">int16</span><span class="op" id="2517322">(</span><span class="ident" id="2517323">offset</span><span class="op" id="2517329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517336">enc</span>&nbsp;<span class="op" id="2517340">:=</span>&nbsp;<span class="op" id="2517343">[</span><span class="op" id="2517344">]</span><span class="builtintype" id="2517345">byte</span><span class="op" id="2517349">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517353">timeBinaryVersion</span><span class="op" id="2517370">,</span>&nbsp;<span class="comment" id="2517372">//&nbsp;byte&nbsp;0&nbsp;:&nbsp;version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517394">byte</span><span class="op" id="2517398">(</span><span class="ident" id="2517399">t</span><span class="op" id="2517400">.</span><span class="ident" id="2517401">sec</span>&nbsp;<span class="op" id="2517405">&gt;&gt;</span>&nbsp;<span class="num" id="2517408">56</span><span class="op" id="2517410">)</span><span class="op" id="2517411">,</span>&nbsp;<span class="comment" id="2517413">//&nbsp;bytes&nbsp;1-8:&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517437">byte</span><span class="op" id="2517441">(</span><span class="ident" id="2517442">t</span><span class="op" id="2517443">.</span><span class="ident" id="2517444">sec</span>&nbsp;<span class="op" id="2517448">&gt;&gt;</span>&nbsp;<span class="num" id="2517451">48</span><span class="op" id="2517453">)</span><span class="op" id="2517454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517458">byte</span><span class="op" id="2517462">(</span><span class="ident" id="2517463">t</span><span class="op" id="2517464">.</span><span class="ident" id="2517465">sec</span>&nbsp;<span class="op" id="2517469">&gt;&gt;</span>&nbsp;<span class="num" id="2517472">40</span><span class="op" id="2517474">)</span><span class="op" id="2517475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517479">byte</span><span class="op" id="2517483">(</span><span class="ident" id="2517484">t</span><span class="op" id="2517485">.</span><span class="ident" id="2517486">sec</span>&nbsp;<span class="op" id="2517490">&gt;&gt;</span>&nbsp;<span class="num" id="2517493">32</span><span class="op" id="2517495">)</span><span class="op" id="2517496">,</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517500">byte</span><span class="op" id="2517504">(</span><span class="ident" id="2517505">t</span><span class="op" id="2517506">.</span><span class="ident" id="2517507">sec</span>&nbsp;<span class="op" id="2517511">&gt;&gt;</span>&nbsp;<span class="num" id="2517514">24</span><span class="op" id="2517516">)</span><span class="op" id="2517517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517521">byte</span><span class="op" id="2517525">(</span><span class="ident" id="2517526">t</span><span class="op" id="2517527">.</span><span class="ident" id="2517528">sec</span>&nbsp;<span class="op" id="2517532">&gt;&gt;</span>&nbsp;<span class="num" id="2517535">16</span><span class="op" id="2517537">)</span><span class="op" id="2517538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517542">byte</span><span class="op" id="2517546">(</span><span class="ident" id="2517547">t</span><span class="op" id="2517548">.</span><span class="ident" id="2517549">sec</span>&nbsp;<span class="op" id="2517553">&gt;&gt;</span>&nbsp;<span class="num" id="2517556">8</span><span class="op" id="2517557">)</span><span class="op" id="2517558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517562">byte</span><span class="op" id="2517566">(</span><span class="ident" id="2517567">t</span><span class="op" id="2517568">.</span><span class="ident" id="2517569">sec</span><span class="op" id="2517572">)</span><span class="op" id="2517573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517577">byte</span><span class="op" id="2517581">(</span><span class="ident" id="2517582">t</span><span class="op" id="2517583">.</span><span class="ident" id="2517584">nsec</span>&nbsp;<span class="op" id="2517589">&gt;&gt;</span>&nbsp;<span class="num" id="2517592">24</span><span class="op" id="2517594">)</span><span class="op" id="2517595">,</span>&nbsp;<span class="comment" id="2517597">//&nbsp;bytes&nbsp;9-12:&nbsp;nanoseconds</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517626">byte</span><span class="op" id="2517630">(</span><span class="ident" id="2517631">t</span><span class="op" id="2517632">.</span><span class="ident" id="2517633">nsec</span>&nbsp;<span class="op" id="2517638">&gt;&gt;</span>&nbsp;<span class="num" id="2517641">16</span><span class="op" id="2517643">)</span><span class="op" id="2517644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517648">byte</span><span class="op" id="2517652">(</span><span class="ident" id="2517653">t</span><span class="op" id="2517654">.</span><span class="ident" id="2517655">nsec</span>&nbsp;<span class="op" id="2517660">&gt;&gt;</span>&nbsp;<span class="num" id="2517663">8</span><span class="op" id="2517664">)</span><span class="op" id="2517665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517669">byte</span><span class="op" id="2517673">(</span><span class="ident" id="2517674">t</span><span class="op" id="2517675">.</span><span class="ident" id="2517676">nsec</span><span class="op" id="2517680">)</span><span class="op" id="2517681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517685">byte</span><span class="op" id="2517689">(</span><span class="ident" id="2517690">offsetMin</span>&nbsp;<span class="op" id="2517700">&gt;&gt;</span>&nbsp;<span class="num" id="2517703">8</span><span class="op" id="2517704">)</span><span class="op" id="2517705">,</span>&nbsp;<span class="comment" id="2517707">//&nbsp;bytes&nbsp;13-14:&nbsp;zone&nbsp;offset&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2517748">byte</span><span class="op" id="2517752">(</span><span class="ident" id="2517753">offsetMin</span><span class="op" id="2517762">)</span><span class="op" id="2517763">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2517766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517770">return</span>&nbsp;<span class="ident" id="2517777">enc</span><span class="op" id="2517780">,</span>&nbsp;<span class="ident" id="2517782">nil</span><br>
<span class="lineno"></span><span class="op" id="2517786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">880</span><span class="comment" id="2517789">//&nbsp;UnmarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2517861">func</span>&nbsp;<span class="op" id="2517866">(</span><span class="ident" id="2517867">t</span>&nbsp;<span class="op" id="2517869">*</span><span class="ident" id="2517870">Time</span><span class="op" id="2517874">)</span>&nbsp;<span class="ident" id="2517876">UnmarshalBinary</span><span class="op" id="2517891">(</span><span class="ident" id="2517892">data</span>&nbsp;<span class="op" id="2517897">[</span><span class="op" id="2517898">]</span><span class="builtintype" id="2517899">byte</span><span class="op" id="2517903">)</span>&nbsp;<span class="builtintype" id="2517905">error</span>&nbsp;<span class="op" id="2517911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517914">buf</span>&nbsp;<span class="op" id="2517918">:=</span>&nbsp;<span class="ident" id="2517921">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517927">if</span>&nbsp;<span class="builtinfunc" id="2517930">len</span><span class="op" id="2517933">(</span><span class="ident" id="2517934">buf</span><span class="op" id="2517937">)</span>&nbsp;<span class="op" id="2517939">==</span>&nbsp;<span class="num" id="2517942">0</span>&nbsp;<span class="op" id="2517944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2517948">return</span>&nbsp;<span class="ident" id="2517955">errors</span><span class="op" id="2517961">.</span><span class="ident" id="2517962">New</span><span class="op" id="2517965">(</span><span class="string" id="2517966">&#34;Time.UnmarshalBinary:&nbsp;no&nbsp;data&#34;</span><span class="op" id="2517997">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518004">if</span>&nbsp;<span class="ident" id="2518007">buf</span><span class="op" id="2518010">[</span><span class="num" id="2518011">0</span><span class="op" id="2518012">]</span>&nbsp;<span class="op" id="2518014">!=</span>&nbsp;<span class="ident" id="2518017">timeBinaryVersion</span>&nbsp;<span class="op" id="2518035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518039">return</span>&nbsp;<span class="ident" id="2518046">errors</span><span class="op" id="2518052">.</span><span class="ident" id="2518053">New</span><span class="op" id="2518056">(</span><span class="string" id="2518057">&#34;Time.UnmarshalBinary:&nbsp;unsupported&nbsp;version&#34;</span><span class="op" id="2518100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518103">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518107">if</span>&nbsp;<span class="builtinfunc" id="2518110">len</span><span class="op" id="2518113">(</span><span class="ident" id="2518114">buf</span><span class="op" id="2518117">)</span>&nbsp;<span class="op" id="2518119">!=</span>&nbsp;<span class="comment" id="2518122">/*version*/</span>&nbsp;<span class="num" id="2518134">1</span><span class="op" id="2518135">+</span>&nbsp;<span class="comment" id="2518137">/*sec*/</span>&nbsp;<span class="num" id="2518145">8</span><span class="op" id="2518146">+</span>&nbsp;<span class="comment" id="2518148">/*nsec*/</span>&nbsp;<span class="num" id="2518157">4</span><span class="op" id="2518158">+</span>&nbsp;<span class="comment" id="2518160">/*zone&nbsp;offset*/</span>&nbsp;<span class="num" id="2518176">2</span>&nbsp;<span class="op" id="2518178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518182">return</span>&nbsp;<span class="ident" id="2518189">errors</span><span class="op" id="2518195">.</span><span class="ident" id="2518196">New</span><span class="op" id="2518199">(</span><span class="string" id="2518200">&#34;Time.UnmarshalBinary:&nbsp;invalid&nbsp;length&#34;</span><span class="op" id="2518238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518245">buf</span>&nbsp;<span class="op" id="2518249">=</span>&nbsp;<span class="ident" id="2518251">buf</span><span class="op" id="2518254">[</span><span class="num" id="2518255">1</span><span class="op" id="2518256">:</span><span class="op" id="2518257">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518260">t</span><span class="op" id="2518261">.</span><span class="ident" id="2518262">sec</span>&nbsp;<span class="op" id="2518266">=</span>&nbsp;<span class="ident" id="2518268">int64</span><span class="op" id="2518273">(</span><span class="ident" id="2518274">buf</span><span class="op" id="2518277">[</span><span class="num" id="2518278">7</span><span class="op" id="2518279">]</span><span class="op" id="2518280">)</span>&nbsp;<span class="op" id="2518282">|</span>&nbsp;<span class="ident" id="2518284">int64</span><span class="op" id="2518289">(</span><span class="ident" id="2518290">buf</span><span class="op" id="2518293">[</span><span class="num" id="2518294">6</span><span class="op" id="2518295">]</span><span class="op" id="2518296">)</span><span class="op" id="2518297">&lt;&lt;</span><span class="num" id="2518299">8</span>&nbsp;<span class="op" id="2518301">|</span>&nbsp;<span class="ident" id="2518303">int64</span><span class="op" id="2518308">(</span><span class="ident" id="2518309">buf</span><span class="op" id="2518312">[</span><span class="num" id="2518313">5</span><span class="op" id="2518314">]</span><span class="op" id="2518315">)</span><span class="op" id="2518316">&lt;&lt;</span><span class="num" id="2518318">16</span>&nbsp;<span class="op" id="2518321">|</span>&nbsp;<span class="ident" id="2518323">int64</span><span class="op" id="2518328">(</span><span class="ident" id="2518329">buf</span><span class="op" id="2518332">[</span><span class="num" id="2518333">4</span><span class="op" id="2518334">]</span><span class="op" id="2518335">)</span><span class="op" id="2518336">&lt;&lt;</span><span class="num" id="2518338">24</span>&nbsp;<span class="op" id="2518341">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518345">int64</span><span class="op" id="2518350">(</span><span class="ident" id="2518351">buf</span><span class="op" id="2518354">[</span><span class="num" id="2518355">3</span><span class="op" id="2518356">]</span><span class="op" id="2518357">)</span><span class="op" id="2518358">&lt;&lt;</span><span class="num" id="2518360">32</span>&nbsp;<span class="op" id="2518363">|</span>&nbsp;<span class="ident" id="2518365">int64</span><span class="op" id="2518370">(</span><span class="ident" id="2518371">buf</span><span class="op" id="2518374">[</span><span class="num" id="2518375">2</span><span class="op" id="2518376">]</span><span class="op" id="2518377">)</span><span class="op" id="2518378">&lt;&lt;</span><span class="num" id="2518380">40</span>&nbsp;<span class="op" id="2518383">|</span>&nbsp;<span class="ident" id="2518385">int64</span><span class="op" id="2518390">(</span><span class="ident" id="2518391">buf</span><span class="op" id="2518394">[</span><span class="num" id="2518395">1</span><span class="op" id="2518396">]</span><span class="op" id="2518397">)</span><span class="op" id="2518398">&lt;&lt;</span><span class="num" id="2518400">48</span>&nbsp;<span class="op" id="2518403">|</span>&nbsp;<span class="ident" id="2518405">int64</span><span class="op" id="2518410">(</span><span class="ident" id="2518411">buf</span><span class="op" id="2518414">[</span><span class="num" id="2518415">0</span><span class="op" id="2518416">]</span><span class="op" id="2518417">)</span><span class="op" id="2518418">&lt;&lt;</span><span class="num" id="2518420">56</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518425">buf</span>&nbsp;<span class="op" id="2518429">=</span>&nbsp;<span class="ident" id="2518431">buf</span><span class="op" id="2518434">[</span><span class="num" id="2518435">8</span><span class="op" id="2518436">:</span><span class="op" id="2518437">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518440">t</span><span class="op" id="2518441">.</span><span class="ident" id="2518442">nsec</span>&nbsp;<span class="op" id="2518447">=</span>&nbsp;<span class="builtintype" id="2518449">int32</span><span class="op" id="2518454">(</span><span class="ident" id="2518455">buf</span><span class="op" id="2518458">[</span><span class="num" id="2518459">3</span><span class="op" id="2518460">]</span><span class="op" id="2518461">)</span>&nbsp;<span class="op" id="2518463">|</span>&nbsp;<span class="builtintype" id="2518465">int32</span><span class="op" id="2518470">(</span><span class="ident" id="2518471">buf</span><span class="op" id="2518474">[</span><span class="num" id="2518475">2</span><span class="op" id="2518476">]</span><span class="op" id="2518477">)</span><span class="op" id="2518478">&lt;&lt;</span><span class="num" id="2518480">8</span>&nbsp;<span class="op" id="2518482">|</span>&nbsp;<span class="builtintype" id="2518484">int32</span><span class="op" id="2518489">(</span><span class="ident" id="2518490">buf</span><span class="op" id="2518493">[</span><span class="num" id="2518494">1</span><span class="op" id="2518495">]</span><span class="op" id="2518496">)</span><span class="op" id="2518497">&lt;&lt;</span><span class="num" id="2518499">16</span>&nbsp;<span class="op" id="2518502">|</span>&nbsp;<span class="builtintype" id="2518504">int32</span><span class="op" id="2518509">(</span><span class="ident" id="2518510">buf</span><span class="op" id="2518513">[</span><span class="num" id="2518514">0</span><span class="op" id="2518515">]</span><span class="op" id="2518516">)</span><span class="op" id="2518517">&lt;&lt;</span><span class="num" id="2518519">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518524">buf</span>&nbsp;<span class="op" id="2518528">=</span>&nbsp;<span class="ident" id="2518530">buf</span><span class="op" id="2518533">[</span><span class="num" id="2518534">4</span><span class="op" id="2518535">:</span><span class="op" id="2518536">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518539">offset</span>&nbsp;<span class="op" id="2518546">:=</span>&nbsp;<span class="builtintype" id="2518549">int</span><span class="op" id="2518552">(</span><span class="builtintype" id="2518553">int16</span><span class="op" id="2518558">(</span><span class="ident" id="2518559">buf</span><span class="op" id="2518562">[</span><span class="num" id="2518563">1</span><span class="op" id="2518564">]</span><span class="op" id="2518565">)</span><span class="op" id="2518566">|</span><span class="builtintype" id="2518567">int16</span><span class="op" id="2518572">(</span><span class="ident" id="2518573">buf</span><span class="op" id="2518576">[</span><span class="num" id="2518577">0</span><span class="op" id="2518578">]</span><span class="op" id="2518579">)</span><span class="op" id="2518580">&lt;&lt;</span><span class="num" id="2518582">8</span><span class="op" id="2518583">)</span>&nbsp;<span class="op" id="2518585">*</span>&nbsp;<span class="num" id="2518587">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518592">if</span>&nbsp;<span class="ident" id="2518595">offset</span>&nbsp;<span class="op" id="2518602">==</span>&nbsp;<span class="op" id="2518605">-</span><span class="num" id="2518606">1</span><span class="op" id="2518607">*</span><span class="num" id="2518608">60</span>&nbsp;<span class="op" id="2518611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518615">t</span><span class="op" id="2518616">.</span><span class="ident" id="2518617">loc</span>&nbsp;<span class="op" id="2518621">=</span>&nbsp;<span class="op" id="2518623">&amp;</span><span class="ident" id="2518624">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518632">}</span>&nbsp;<span class="keyword" id="2518634">else</span>&nbsp;<span class="keyword" id="2518639">if</span>&nbsp;<span class="ident" id="2518642">_</span><span class="op" id="2518643">,</span>&nbsp;<span class="ident" id="2518645">localoff</span><span class="op" id="2518653">,</span>&nbsp;<span class="ident" id="2518655">_</span><span class="op" id="2518656">,</span>&nbsp;<span class="ident" id="2518658">_</span><span class="op" id="2518659">,</span>&nbsp;<span class="ident" id="2518661">_</span>&nbsp;<span class="op" id="2518663">:=</span>&nbsp;<span class="ident" id="2518666">Local</span><span class="op" id="2518671">.</span><span class="ident" id="2518672">lookup</span><span class="op" id="2518678">(</span><span class="ident" id="2518679">t</span><span class="op" id="2518680">.</span><span class="ident" id="2518681">sec</span>&nbsp;<span class="op" id="2518685">+</span>&nbsp;<span class="ident" id="2518687">internalToUnix</span><span class="op" id="2518701">)</span><span class="op" id="2518702">;</span>&nbsp;<span class="ident" id="2518704">offset</span>&nbsp;<span class="op" id="2518711">==</span>&nbsp;<span class="ident" id="2518714">localoff</span>&nbsp;<span class="op" id="2518723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518727">t</span><span class="op" id="2518728">.</span><span class="ident" id="2518729">loc</span>&nbsp;<span class="op" id="2518733">=</span>&nbsp;<span class="ident" id="2518735">Local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518742">}</span>&nbsp;<span class="keyword" id="2518744">else</span>&nbsp;<span class="op" id="2518749">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518753">t</span><span class="op" id="2518754">.</span><span class="ident" id="2518755">loc</span>&nbsp;<span class="op" id="2518759">=</span>&nbsp;<span class="ident" id="2518761">FixedZone</span><span class="op" id="2518770">(</span><span class="string" id="2518771">&#34;&#34;</span><span class="op" id="2518773">,</span>&nbsp;<span class="ident" id="2518775">offset</span><span class="op" id="2518781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518788">return</span>&nbsp;<span class="ident" id="2518795">nil</span><br>
<span class="lineno"></span><span class="op" id="2518799">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="2518802">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;GobEncoder,&nbsp;GobDecoder,&nbsp;MarshalJSON,&nbsp;UnmarshalJSON&nbsp;in&nbsp;Go&nbsp;2.</span><br>
<span class="lineno"></span><span class="comment" id="2518883">//&nbsp;The&nbsp;same&nbsp;semantics&nbsp;will&nbsp;be&nbsp;provided&nbsp;by&nbsp;the&nbsp;generic&nbsp;MarshalBinary,&nbsp;MarshalText,</span><br>
<span class="lineno"></span><span class="comment" id="2518965">//&nbsp;UnmarshalBinary,&nbsp;UnmarshalText.</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span><span class="comment" id="2519001">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2519055">func</span>&nbsp;<span class="op" id="2519060">(</span><span class="ident" id="2519061">t</span>&nbsp;<span class="ident" id="2519063">Time</span><span class="op" id="2519067">)</span>&nbsp;<span class="ident" id="2519069">GobEncode</span><span class="op" id="2519078">(</span><span class="op" id="2519079">)</span>&nbsp;<span class="op" id="2519081">(</span><span class="op" id="2519082">[</span><span class="op" id="2519083">]</span><span class="builtintype" id="2519084">byte</span><span class="op" id="2519088">,</span>&nbsp;<span class="builtintype" id="2519090">error</span><span class="op" id="2519095">)</span>&nbsp;<span class="op" id="2519097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519100">return</span>&nbsp;<span class="ident" id="2519107">t</span><span class="op" id="2519108">.</span><span class="ident" id="2519109">MarshalBinary</span><span class="op" id="2519122">(</span><span class="op" id="2519123">)</span><br>
<span class="lineno"></span><span class="op" id="2519125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="comment" id="2519128">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2519182">func</span>&nbsp;<span class="op" id="2519187">(</span><span class="ident" id="2519188">t</span>&nbsp;<span class="op" id="2519190">*</span><span class="ident" id="2519191">Time</span><span class="op" id="2519195">)</span>&nbsp;<span class="ident" id="2519197">GobDecode</span><span class="op" id="2519206">(</span><span class="ident" id="2519207">data</span>&nbsp;<span class="op" id="2519212">[</span><span class="op" id="2519213">]</span><span class="builtintype" id="2519214">byte</span><span class="op" id="2519218">)</span>&nbsp;<span class="builtintype" id="2519220">error</span>&nbsp;<span class="op" id="2519226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519229">return</span>&nbsp;<span class="ident" id="2519236">t</span><span class="op" id="2519237">.</span><span class="ident" id="2519238">UnmarshalBinary</span><span class="op" id="2519253">(</span><span class="ident" id="2519254">data</span><span class="op" id="2519258">)</span><br>
<span class="lineno"></span><span class="op" id="2519260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="2519263">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2519319">//&nbsp;The&nbsp;time&nbsp;is&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2519414">func</span>&nbsp;<span class="op" id="2519419">(</span><span class="ident" id="2519420">t</span>&nbsp;<span class="ident" id="2519422">Time</span><span class="op" id="2519426">)</span>&nbsp;<span class="ident" id="2519428">MarshalJSON</span><span class="op" id="2519439">(</span><span class="op" id="2519440">)</span>&nbsp;<span class="op" id="2519442">(</span><span class="op" id="2519443">[</span><span class="op" id="2519444">]</span><span class="builtintype" id="2519445">byte</span><span class="op" id="2519449">,</span>&nbsp;<span class="builtintype" id="2519451">error</span><span class="op" id="2519456">)</span>&nbsp;<span class="op" id="2519458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519461">if</span>&nbsp;<span class="ident" id="2519464">y</span>&nbsp;<span class="op" id="2519466">:=</span>&nbsp;<span class="ident" id="2519469">t</span><span class="op" id="2519470">.</span><span class="ident" id="2519471">Year</span><span class="op" id="2519475">(</span><span class="op" id="2519476">)</span><span class="op" id="2519477">;</span>&nbsp;<span class="ident" id="2519479">y</span>&nbsp;<span class="op" id="2519481">&lt;</span>&nbsp;<span class="num" id="2519483">0</span>&nbsp;<span class="op" id="2519485">||</span>&nbsp;<span class="ident" id="2519488">y</span>&nbsp;<span class="op" id="2519490">&gt;=</span>&nbsp;<span class="num" id="2519493">10000</span>&nbsp;<span class="op" id="2519499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519503">//&nbsp;RFC&nbsp;3339&nbsp;is&nbsp;clear&nbsp;that&nbsp;years&nbsp;are&nbsp;4&nbsp;digits&nbsp;exactly.</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519559">//&nbsp;See&nbsp;golang.org/issue/4556#c15&nbsp;for&nbsp;more&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519615">return</span>&nbsp;<span class="ident" id="2519622">nil</span><span class="op" id="2519625">,</span>&nbsp;<span class="ident" id="2519627">errors</span><span class="op" id="2519633">.</span><span class="ident" id="2519634">New</span><span class="op" id="2519637">(</span><span class="string" id="2519638">&#34;Time.MarshalJSON:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2519688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519694">return</span>&nbsp;<span class="op" id="2519701">[</span><span class="op" id="2519702">]</span><span class="builtintype" id="2519703">byte</span><span class="op" id="2519707">(</span><span class="ident" id="2519708">t</span><span class="op" id="2519709">.</span><span class="ident" id="2519710">Format</span><span class="op" id="2519716">(</span><span class="string" id="2519717">`&#34;`</span>&nbsp;<span class="op" id="2519721">+</span>&nbsp;<span class="ident" id="2519723">RFC3339Nano</span>&nbsp;<span class="op" id="2519735">+</span>&nbsp;<span class="string" id="2519737">`&#34;`</span><span class="op" id="2519740">)</span><span class="op" id="2519741">)</span><span class="op" id="2519742">,</span>&nbsp;<span class="ident" id="2519744">nil</span><br>
<span class="lineno"></span><span class="op" id="2519748">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="comment" id="2519751">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2519811">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="2519877">func</span>&nbsp;<span class="op" id="2519882">(</span><span class="ident" id="2519883">t</span>&nbsp;<span class="op" id="2519885">*</span><span class="ident" id="2519886">Time</span><span class="op" id="2519890">)</span>&nbsp;<span class="ident" id="2519892">UnmarshalJSON</span><span class="op" id="2519905">(</span><span class="ident" id="2519906">data</span>&nbsp;<span class="op" id="2519911">[</span><span class="op" id="2519912">]</span><span class="builtintype" id="2519913">byte</span><span class="op" id="2519917">)</span>&nbsp;<span class="op" id="2519919">(</span><span class="ident" id="2519920">err</span>&nbsp;<span class="builtintype" id="2519924">error</span><span class="op" id="2519929">)</span>&nbsp;<span class="op" id="2519931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519934">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519990">*</span><span class="ident" id="2519991">t</span><span class="op" id="2519992">,</span>&nbsp;<span class="ident" id="2519994">err</span>&nbsp;<span class="op" id="2519998">=</span>&nbsp;<span class="ident" id="2520000">Parse</span><span class="op" id="2520005">(</span><span class="string" id="2520006">`&#34;`</span><span class="op" id="2520009">+</span><span class="ident" id="2520010">RFC3339</span><span class="op" id="2520017">+</span><span class="string" id="2520018">`&#34;`</span><span class="op" id="2520021">,</span>&nbsp;<span class="builtintype" id="2520023">string</span><span class="op" id="2520029">(</span><span class="ident" id="2520030">data</span><span class="op" id="2520034">)</span><span class="op" id="2520035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520038">return</span><br>
<span class="lineno"></span><span class="op" id="2520045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2520048">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno">950</span><span class="comment" id="2520112">//&nbsp;The&nbsp;time&nbsp;is&nbsp;formatted&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2520201">func</span>&nbsp;<span class="op" id="2520206">(</span><span class="ident" id="2520207">t</span>&nbsp;<span class="ident" id="2520209">Time</span><span class="op" id="2520213">)</span>&nbsp;<span class="ident" id="2520215">MarshalText</span><span class="op" id="2520226">(</span><span class="op" id="2520227">)</span>&nbsp;<span class="op" id="2520229">(</span><span class="op" id="2520230">[</span><span class="op" id="2520231">]</span><span class="builtintype" id="2520232">byte</span><span class="op" id="2520236">,</span>&nbsp;<span class="builtintype" id="2520238">error</span><span class="op" id="2520243">)</span>&nbsp;<span class="op" id="2520245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520248">if</span>&nbsp;<span class="ident" id="2520251">y</span>&nbsp;<span class="op" id="2520253">:=</span>&nbsp;<span class="ident" id="2520256">t</span><span class="op" id="2520257">.</span><span class="ident" id="2520258">Year</span><span class="op" id="2520262">(</span><span class="op" id="2520263">)</span><span class="op" id="2520264">;</span>&nbsp;<span class="ident" id="2520266">y</span>&nbsp;<span class="op" id="2520268">&lt;</span>&nbsp;<span class="num" id="2520270">0</span>&nbsp;<span class="op" id="2520272">||</span>&nbsp;<span class="ident" id="2520275">y</span>&nbsp;<span class="op" id="2520277">&gt;=</span>&nbsp;<span class="num" id="2520280">10000</span>&nbsp;<span class="op" id="2520286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520290">return</span>&nbsp;<span class="ident" id="2520297">nil</span><span class="op" id="2520300">,</span>&nbsp;<span class="ident" id="2520302">errors</span><span class="op" id="2520308">.</span><span class="ident" id="2520309">New</span><span class="op" id="2520312">(</span><span class="string" id="2520313">&#34;Time.MarshalText:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2520363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520366">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520369">return</span>&nbsp;<span class="op" id="2520376">[</span><span class="op" id="2520377">]</span><span class="builtintype" id="2520378">byte</span><span class="op" id="2520382">(</span><span class="ident" id="2520383">t</span><span class="op" id="2520384">.</span><span class="ident" id="2520385">Format</span><span class="op" id="2520391">(</span><span class="ident" id="2520392">RFC3339Nano</span><span class="op" id="2520403">)</span><span class="op" id="2520404">)</span><span class="op" id="2520405">,</span>&nbsp;<span class="ident" id="2520407">nil</span><br>
<span class="lineno"></span><span class="op" id="2520411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2520414">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2520482">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno">960</span><span class="keyword" id="2520532">func</span>&nbsp;<span class="op" id="2520537">(</span><span class="ident" id="2520538">t</span>&nbsp;<span class="op" id="2520540">*</span><span class="ident" id="2520541">Time</span><span class="op" id="2520545">)</span>&nbsp;<span class="ident" id="2520547">UnmarshalText</span><span class="op" id="2520560">(</span><span class="ident" id="2520561">data</span>&nbsp;<span class="op" id="2520566">[</span><span class="op" id="2520567">]</span><span class="builtintype" id="2520568">byte</span><span class="op" id="2520572">)</span>&nbsp;<span class="op" id="2520574">(</span><span class="ident" id="2520575">err</span>&nbsp;<span class="builtintype" id="2520579">error</span><span class="op" id="2520584">)</span>&nbsp;<span class="op" id="2520586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520589">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520645">*</span><span class="ident" id="2520646">t</span><span class="op" id="2520647">,</span>&nbsp;<span class="ident" id="2520649">err</span>&nbsp;<span class="op" id="2520653">=</span>&nbsp;<span class="ident" id="2520655">Parse</span><span class="op" id="2520660">(</span><span class="ident" id="2520661">RFC3339</span><span class="op" id="2520668">,</span>&nbsp;<span class="builtintype" id="2520670">string</span><span class="op" id="2520676">(</span><span class="ident" id="2520677">data</span><span class="op" id="2520681">)</span><span class="op" id="2520682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520685">return</span><br>
<span class="lineno"></span><span class="op" id="2520692">}</span><br>
<span class="lineno">965</span><br>
<span class="lineno"></span><span class="comment" id="2520695">//&nbsp;Unix&nbsp;returns&nbsp;the&nbsp;local&nbsp;Time&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;given&nbsp;Unix&nbsp;time,</span><br>
<span class="lineno"></span><span class="comment" id="2520764">//&nbsp;sec&nbsp;seconds&nbsp;and&nbsp;nsec&nbsp;nanoseconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2520827">//&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;pass&nbsp;nsec&nbsp;outside&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2520889">func</span>&nbsp;<span class="ident" id="2520894">Unix</span><span class="op" id="2520898">(</span><span class="ident" id="2520899">sec</span>&nbsp;<span class="ident" id="2520903">int64</span><span class="op" id="2520908">,</span>&nbsp;<span class="ident" id="2520910">nsec</span>&nbsp;<span class="ident" id="2520915">int64</span><span class="op" id="2520920">)</span>&nbsp;<span class="ident" id="2520922">Time</span>&nbsp;<span class="op" id="2520927">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520930">if</span>&nbsp;<span class="ident" id="2520933">nsec</span>&nbsp;<span class="op" id="2520938">&lt;</span>&nbsp;<span class="num" id="2520940">0</span>&nbsp;<span class="op" id="2520942">||</span>&nbsp;<span class="ident" id="2520945">nsec</span>&nbsp;<span class="op" id="2520950">&gt;=</span>&nbsp;<span class="num" id="2520953">1e9</span>&nbsp;<span class="op" id="2520957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520961">n</span>&nbsp;<span class="op" id="2520963">:=</span>&nbsp;<span class="ident" id="2520966">nsec</span>&nbsp;<span class="op" id="2520971">/</span>&nbsp;<span class="num" id="2520973">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520979">sec</span>&nbsp;<span class="op" id="2520983">+=</span>&nbsp;<span class="ident" id="2520986">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520990">nsec</span>&nbsp;<span class="op" id="2520995">-=</span>&nbsp;<span class="ident" id="2520998">n</span>&nbsp;<span class="op" id="2521000">*</span>&nbsp;<span class="num" id="2521002">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521008">if</span>&nbsp;<span class="ident" id="2521011">nsec</span>&nbsp;<span class="op" id="2521016">&lt;</span>&nbsp;<span class="num" id="2521018">0</span>&nbsp;<span class="op" id="2521020">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521025">nsec</span>&nbsp;<span class="op" id="2521030">+=</span>&nbsp;<span class="num" id="2521033">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521040">sec</span><span class="op" id="2521043">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521054">return</span>&nbsp;<span class="ident" id="2521061">Time</span><span class="op" id="2521065">{</span><span class="ident" id="2521066">sec</span>&nbsp;<span class="op" id="2521070">+</span>&nbsp;<span class="ident" id="2521072">unixToInternal</span><span class="op" id="2521086">,</span>&nbsp;<span class="builtintype" id="2521088">int32</span><span class="op" id="2521093">(</span><span class="ident" id="2521094">nsec</span><span class="op" id="2521098">)</span><span class="op" id="2521099">,</span>&nbsp;<span class="ident" id="2521101">Local</span><span class="op" id="2521106">}</span><br>
<span class="lineno">980</span><span class="op" id="2521108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2521111">func</span>&nbsp;<span class="ident" id="2521116">isLeap</span><span class="op" id="2521122">(</span><span class="ident" id="2521123">year</span>&nbsp;<span class="builtintype" id="2521128">int</span><span class="op" id="2521131">)</span>&nbsp;<span class="builtintype" id="2521133">bool</span>&nbsp;<span class="op" id="2521138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521141">return</span>&nbsp;<span class="ident" id="2521148">year</span><span class="op" id="2521152">%</span><span class="num" id="2521153">4</span>&nbsp;<span class="op" id="2521155">==</span>&nbsp;<span class="num" id="2521158">0</span>&nbsp;<span class="op" id="2521160">&amp;&amp;</span>&nbsp;<span class="op" id="2521163">(</span><span class="ident" id="2521164">year</span><span class="op" id="2521168">%</span><span class="num" id="2521169">100</span>&nbsp;<span class="op" id="2521173">!=</span>&nbsp;<span class="num" id="2521176">0</span>&nbsp;<span class="op" id="2521178">||</span>&nbsp;<span class="ident" id="2521181">year</span><span class="op" id="2521185">%</span><span class="num" id="2521186">400</span>&nbsp;<span class="op" id="2521190">==</span>&nbsp;<span class="num" id="2521193">0</span><span class="op" id="2521194">)</span><br>
<span class="lineno"></span><span class="op" id="2521196">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="2521199">//&nbsp;norm&nbsp;returns&nbsp;nhi,&nbsp;nlo&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2521234">//&nbsp;&nbsp;&nbsp;&nbsphi&nbsp;*&nbsp;base&nbsp;+&nbsp;lo&nbsp;==&nbsp;nhi&nbsp;*&nbsp;base&nbsp;+&nbsp;nlo</span><br>
<span class="lineno"></span><span class="comment" id="2521272">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&lt;=&nbsp;nlo&nbsp;&lt;&nbsp;base</span><br>
<span class="lineno"></span><span class="keyword" id="2521291">func</span>&nbsp;<span class="ident" id="2521296">norm</span><span class="op" id="2521300">(</span><span class="ident" id="2521301">hi</span><span class="op" id="2521303">,</span>&nbsp;<span class="ident" id="2521305">lo</span><span class="op" id="2521307">,</span>&nbsp;<span class="ident" id="2521309">base</span>&nbsp;<span class="builtintype" id="2521314">int</span><span class="op" id="2521317">)</span>&nbsp;<span class="op" id="2521319">(</span><span class="ident" id="2521320">nhi</span><span class="op" id="2521323">,</span>&nbsp;<span class="ident" id="2521325">nlo</span>&nbsp;<span class="builtintype" id="2521329">int</span><span class="op" id="2521332">)</span>&nbsp;<span class="op" id="2521334">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521337">if</span>&nbsp;<span class="ident" id="2521340">lo</span>&nbsp;<span class="op" id="2521343">&lt;</span>&nbsp;<span class="num" id="2521345">0</span>&nbsp;<span class="op" id="2521347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521351">n</span>&nbsp;<span class="op" id="2521353">:=</span>&nbsp;<span class="op" id="2521356">(</span><span class="op" id="2521357">-</span><span class="ident" id="2521358">lo</span><span class="op" id="2521360">-</span><span class="num" id="2521361">1</span><span class="op" id="2521362">)</span><span class="op" id="2521363">/</span><span class="ident" id="2521364">base</span>&nbsp;<span class="op" id="2521369">+</span>&nbsp;<span class="num" id="2521371">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521375">hi</span>&nbsp;<span class="op" id="2521378">-=</span>&nbsp;<span class="ident" id="2521381">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521385">lo</span>&nbsp;<span class="op" id="2521388">+=</span>&nbsp;<span class="ident" id="2521391">n</span>&nbsp;<span class="op" id="2521393">*</span>&nbsp;<span class="ident" id="2521395">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521401">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521404">if</span>&nbsp;<span class="ident" id="2521407">lo</span>&nbsp;<span class="op" id="2521410">&gt;=</span>&nbsp;<span class="ident" id="2521413">base</span>&nbsp;<span class="op" id="2521418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521422">n</span>&nbsp;<span class="op" id="2521424">:=</span>&nbsp;<span class="ident" id="2521427">lo</span>&nbsp;<span class="op" id="2521430">/</span>&nbsp;<span class="ident" id="2521432">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521439">hi</span>&nbsp;<span class="op" id="2521442">+=</span>&nbsp;<span class="ident" id="2521445">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521449">lo</span>&nbsp;<span class="op" id="2521452">-=</span>&nbsp;<span class="ident" id="2521455">n</span>&nbsp;<span class="op" id="2521457">*</span>&nbsp;<span class="ident" id="2521459">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2521465">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521468">return</span>&nbsp;<span class="ident" id="2521475">hi</span><span class="op" id="2521477">,</span>&nbsp;<span class="ident" id="2521479">lo</span><br>
<span class="lineno"></span><span class="op" id="2521482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2521485">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;Time&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2521527">//&nbsp;&nbsp;&nbsp;&nbspyyyy-mm-dd&nbsp;hh:mm:ss&nbsp;+&nbsp;nsec&nbsp;nanoseconds</span><br>
<span class="lineno">1005</span><span class="comment" id="2521569">//&nbsp;in&nbsp;the&nbsp;appropriate&nbsp;zone&nbsp;for&nbsp;that&nbsp;time&nbsp;in&nbsp;the&nbsp;given&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="2521633">//</span><br>
<span class="lineno"></span><span class="comment" id="2521636">//&nbsp;The&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;min,&nbsp;sec,&nbsp;and&nbsp;nsec&nbsp;values&nbsp;may&nbsp;be&nbsp;outside</span><br>
<span class="lineno"></span><span class="comment" id="2521702">//&nbsp;their&nbsp;usual&nbsp;ranges&nbsp;and&nbsp;will&nbsp;be&nbsp;normalized&nbsp;during&nbsp;the&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2521770">//&nbsp;For&nbsp;example,&nbsp;October&nbsp;32&nbsp;converts&nbsp;to&nbsp;November&nbsp;1.</span><br>
<span class="lineno">1010</span><span class="comment" id="2521821">//</span><br>
<span class="lineno"></span><span class="comment" id="2521824">//&nbsp;A&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;transition&nbsp;skips&nbsp;or&nbsp;repeats&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2521886">//&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;United&nbsp;States,&nbsp;March&nbsp;13,&nbsp;2011&nbsp;2:15am&nbsp;never&nbsp;occurred,</span><br>
<span class="lineno"></span><span class="comment" id="2521962">//&nbsp;while&nbsp;November&nbsp;6,&nbsp;2011&nbsp;1:15am&nbsp;occurred&nbsp;twice.&nbsp;&nbsp;In&nbsp;such&nbsp;cases,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2522031">//&nbsp;choice&nbsp;of&nbsp;time&nbsp;zone,&nbsp;and&nbsp;therefore&nbsp;the&nbsp;time,&nbsp;is&nbsp;not&nbsp;well-defined.</span><br>
<span class="lineno">1015</span><span class="comment" id="2522100">//&nbsp;Date&nbsp;returns&nbsp;a&nbsp;time&nbsp;that&nbsp;is&nbsp;correct&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;zones&nbsp;involved</span><br>
<span class="lineno"></span><span class="comment" id="2522172">//&nbsp;in&nbsp;the&nbsp;transition,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;guarantee&nbsp;which.</span><br>
<span class="lineno"></span><span class="comment" id="2522227">//</span><br>
<span class="lineno"></span><span class="comment" id="2522230">//&nbsp;Date&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2522260">func</span>&nbsp;<span class="ident" id="2522265">Date</span><span class="op" id="2522269">(</span><span class="ident" id="2522270">year</span>&nbsp;<span class="builtintype" id="2522275">int</span><span class="op" id="2522278">,</span>&nbsp;<span class="ident" id="2522280">month</span>&nbsp;<span class="ident" id="2522286">Month</span><span class="op" id="2522291">,</span>&nbsp;<span class="ident" id="2522293">day</span><span class="op" id="2522296">,</span>&nbsp;<span class="ident" id="2522298">hour</span><span class="op" id="2522302">,</span>&nbsp;<span class="ident" id="2522304">min</span><span class="op" id="2522307">,</span>&nbsp;<span class="ident" id="2522309">sec</span><span class="op" id="2522312">,</span>&nbsp;<span class="ident" id="2522314">nsec</span>&nbsp;<span class="builtintype" id="2522319">int</span><span class="op" id="2522322">,</span>&nbsp;<span class="ident" id="2522324">loc</span>&nbsp;<span class="op" id="2522328">*</span><span class="ident" id="2522329">Location</span><span class="op" id="2522337">)</span>&nbsp;<span class="ident" id="2522339">Time</span>&nbsp;<span class="op" id="2522344">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522347">if</span>&nbsp;<span class="ident" id="2522350">loc</span>&nbsp;<span class="op" id="2522354">==</span>&nbsp;<span class="ident" id="2522357">nil</span>&nbsp;<span class="op" id="2522361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2522365">panic</span><span class="op" id="2522370">(</span><span class="string" id="2522371">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Date&#34;</span><span class="op" id="2522411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522418">//&nbsp;Normalize&nbsp;month,&nbsp;overflowing&nbsp;into&nbsp;year.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522462">m</span>&nbsp;<span class="op" id="2522464">:=</span>&nbsp;<span class="builtintype" id="2522467">int</span><span class="op" id="2522470">(</span><span class="ident" id="2522471">month</span><span class="op" id="2522476">)</span>&nbsp;<span class="op" id="2522478">-</span>&nbsp;<span class="num" id="2522480">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522483">year</span><span class="op" id="2522487">,</span>&nbsp;<span class="ident" id="2522489">m</span>&nbsp;<span class="op" id="2522491">=</span>&nbsp;<span class="ident" id="2522493">norm</span><span class="op" id="2522497">(</span><span class="ident" id="2522498">year</span><span class="op" id="2522502">,</span>&nbsp;<span class="ident" id="2522504">m</span><span class="op" id="2522505">,</span>&nbsp;<span class="num" id="2522507">12</span><span class="op" id="2522509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522512">month</span>&nbsp;<span class="op" id="2522518">=</span>&nbsp;<span class="ident" id="2522520">Month</span><span class="op" id="2522525">(</span><span class="ident" id="2522526">m</span><span class="op" id="2522527">)</span>&nbsp;<span class="op" id="2522529">+</span>&nbsp;<span class="num" id="2522531">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522535">//&nbsp;Normalize&nbsp;nsec,&nbsp;sec,&nbsp;min,&nbsp;hour,&nbsp;overflowing&nbsp;into&nbsp;day.</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522593">sec</span><span class="op" id="2522596">,</span>&nbsp;<span class="ident" id="2522598">nsec</span>&nbsp;<span class="op" id="2522603">=</span>&nbsp;<span class="ident" id="2522605">norm</span><span class="op" id="2522609">(</span><span class="ident" id="2522610">sec</span><span class="op" id="2522613">,</span>&nbsp;<span class="ident" id="2522615">nsec</span><span class="op" id="2522619">,</span>&nbsp;<span class="num" id="2522621">1e9</span><span class="op" id="2522624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522627">min</span><span class="op" id="2522630">,</span>&nbsp;<span class="ident" id="2522632">sec</span>&nbsp;<span class="op" id="2522636">=</span>&nbsp;<span class="ident" id="2522638">norm</span><span class="op" id="2522642">(</span><span class="ident" id="2522643">min</span><span class="op" id="2522646">,</span>&nbsp;<span class="ident" id="2522648">sec</span><span class="op" id="2522651">,</span>&nbsp;<span class="num" id="2522653">60</span><span class="op" id="2522655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522658">hour</span><span class="op" id="2522662">,</span>&nbsp;<span class="ident" id="2522664">min</span>&nbsp;<span class="op" id="2522668">=</span>&nbsp;<span class="ident" id="2522670">norm</span><span class="op" id="2522674">(</span><span class="ident" id="2522675">hour</span><span class="op" id="2522679">,</span>&nbsp;<span class="ident" id="2522681">min</span><span class="op" id="2522684">,</span>&nbsp;<span class="num" id="2522686">60</span><span class="op" id="2522688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522691">day</span><span class="op" id="2522694">,</span>&nbsp;<span class="ident" id="2522696">hour</span>&nbsp;<span class="op" id="2522701">=</span>&nbsp;<span class="ident" id="2522703">norm</span><span class="op" id="2522707">(</span><span class="ident" id="2522708">day</span><span class="op" id="2522711">,</span>&nbsp;<span class="ident" id="2522713">hour</span><span class="op" id="2522717">,</span>&nbsp;<span class="num" id="2522719">24</span><span class="op" id="2522721">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522725">y</span>&nbsp;<span class="op" id="2522727">:=</span>&nbsp;<span class="ident" id="2522730">uint64</span><span class="op" id="2522736">(</span><span class="ident" id="2522737">int64</span><span class="op" id="2522742">(</span><span class="ident" id="2522743">year</span><span class="op" id="2522747">)</span>&nbsp;<span class="op" id="2522749">-</span>&nbsp;<span class="ident" id="2522751">absoluteZeroYear</span><span class="op" id="2522767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522771">//&nbsp;Compute&nbsp;days&nbsp;since&nbsp;the&nbsp;absolute&nbsp;epoch.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522815">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;from&nbsp;400-year&nbsp;cycles.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522853">n</span>&nbsp;<span class="op" id="2522855">:=</span>&nbsp;<span class="ident" id="2522858">y</span>&nbsp;<span class="op" id="2522860">/</span>&nbsp;<span class="num" id="2522862">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522867">y</span>&nbsp;<span class="op" id="2522869">-=</span>&nbsp;<span class="num" id="2522872">400</span>&nbsp;<span class="op" id="2522876">*</span>&nbsp;<span class="ident" id="2522878">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522881">d</span>&nbsp;<span class="op" id="2522883">:=</span>&nbsp;<span class="ident" id="2522886">daysPer400Years</span>&nbsp;<span class="op" id="2522902">*</span>&nbsp;<span class="ident" id="2522904">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522908">//&nbsp;Add&nbsp;in&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522936">n</span>&nbsp;<span class="op" id="2522938">=</span>&nbsp;<span class="ident" id="2522940">y</span>&nbsp;<span class="op" id="2522942">/</span>&nbsp;<span class="num" id="2522944">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522949">y</span>&nbsp;<span class="op" id="2522951">-=</span>&nbsp;<span class="num" id="2522954">100</span>&nbsp;<span class="op" id="2522958">*</span>&nbsp;<span class="ident" id="2522960">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522963">d</span>&nbsp;<span class="op" id="2522965">+=</span>&nbsp;<span class="ident" id="2522968">daysPer100Years</span>&nbsp;<span class="op" id="2522984">*</span>&nbsp;<span class="ident" id="2522986">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522990">//&nbsp;Add&nbsp;in&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523016">n</span>&nbsp;<span class="op" id="2523018">=</span>&nbsp;<span class="ident" id="2523020">y</span>&nbsp;<span class="op" id="2523022">/</span>&nbsp;<span class="num" id="2523024">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523027">y</span>&nbsp;<span class="op" id="2523029">-=</span>&nbsp;<span class="num" id="2523032">4</span>&nbsp;<span class="op" id="2523034">*</span>&nbsp;<span class="ident" id="2523036">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523039">d</span>&nbsp;<span class="op" id="2523041">+=</span>&nbsp;<span class="ident" id="2523044">daysPer4Years</span>&nbsp;<span class="op" id="2523058">*</span>&nbsp;<span class="ident" id="2523060">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523064">//&nbsp;Add&nbsp;in&nbsp;non-leap&nbsp;years.</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523091">n</span>&nbsp;<span class="op" id="2523093">=</span>&nbsp;<span class="ident" id="2523095">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523098">d</span>&nbsp;<span class="op" id="2523100">+=</span>&nbsp;<span class="num" id="2523103">365</span>&nbsp;<span class="op" id="2523107">*</span>&nbsp;<span class="ident" id="2523109">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523113">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;this&nbsp;month.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523148">d</span>&nbsp;<span class="op" id="2523150">+=</span>&nbsp;<span class="ident" id="2523153">uint64</span><span class="op" id="2523159">(</span><span class="ident" id="2523160">daysBefore</span><span class="op" id="2523170">[</span><span class="ident" id="2523171">month</span><span class="op" id="2523176">-</span><span class="num" id="2523177">1</span><span class="op" id="2523178">]</span><span class="op" id="2523179">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523182">if</span>&nbsp;<span class="ident" id="2523185">isLeap</span><span class="op" id="2523191">(</span><span class="ident" id="2523192">year</span><span class="op" id="2523196">)</span>&nbsp;<span class="op" id="2523198">&amp;&amp;</span>&nbsp;<span class="ident" id="2523201">month</span>&nbsp;<span class="op" id="2523207">&gt;=</span>&nbsp;<span class="ident" id="2523210">March</span>&nbsp;<span class="op" id="2523216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523220">d</span><span class="op" id="2523221">++</span>&nbsp;<span class="comment" id="2523224">//&nbsp;February&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523244">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;today.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523274">d</span>&nbsp;<span class="op" id="2523276">+=</span>&nbsp;<span class="ident" id="2523279">uint64</span><span class="op" id="2523285">(</span><span class="ident" id="2523286">day</span>&nbsp;<span class="op" id="2523290">-</span>&nbsp;<span class="num" id="2523292">1</span><span class="op" id="2523293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523297">//&nbsp;Add&nbsp;in&nbsp;time&nbsp;elapsed&nbsp;today.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523328">abs</span>&nbsp;<span class="op" id="2523332">:=</span>&nbsp;<span class="ident" id="2523335">d</span>&nbsp;<span class="op" id="2523337">*</span>&nbsp;<span class="ident" id="2523339">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523354">abs</span>&nbsp;<span class="op" id="2523358">+=</span>&nbsp;<span class="ident" id="2523361">uint64</span><span class="op" id="2523367">(</span><span class="ident" id="2523368">hour</span><span class="op" id="2523372">*</span><span class="ident" id="2523373">secondsPerHour</span>&nbsp;<span class="op" id="2523388">+</span>&nbsp;<span class="ident" id="2523390">min</span><span class="op" id="2523393">*</span><span class="ident" id="2523394">secondsPerMinute</span>&nbsp;<span class="op" id="2523411">+</span>&nbsp;<span class="ident" id="2523413">sec</span><span class="op" id="2523416">)</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523420">unix</span>&nbsp;<span class="op" id="2523425">:=</span>&nbsp;<span class="ident" id="2523428">int64</span><span class="op" id="2523433">(</span><span class="ident" id="2523434">abs</span><span class="op" id="2523437">)</span>&nbsp;<span class="op" id="2523439">+</span>&nbsp;<span class="op" id="2523441">(</span><span class="ident" id="2523442">absoluteToInternal</span>&nbsp;<span class="op" id="2523461">+</span>&nbsp;<span class="ident" id="2523463">internalToUnix</span><span class="op" id="2523477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523481">//&nbsp;Look&nbsp;for&nbsp;zone&nbsp;offset&nbsp;for&nbsp;t,&nbsp;so&nbsp;we&nbsp;can&nbsp;adjust&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523538">//&nbsp;The&nbsp;lookup&nbsp;function&nbsp;expects&nbsp;UTC,&nbsp;so&nbsp;we&nbsp;pass&nbsp;t&nbsp;in&nbsp;the</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523595">//&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;too&nbsp;close&nbsp;to&nbsp;a&nbsp;zone&nbsp;transition,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523656">//&nbsp;and&nbsp;then&nbsp;adjust&nbsp;if&nbsp;it&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523686">_</span><span class="op" id="2523687">,</span>&nbsp;<span class="ident" id="2523689">offset</span><span class="op" id="2523695">,</span>&nbsp;<span class="ident" id="2523697">_</span><span class="op" id="2523698">,</span>&nbsp;<span class="ident" id="2523700">start</span><span class="op" id="2523705">,</span>&nbsp;<span class="ident" id="2523707">end</span>&nbsp;<span class="op" id="2523711">:=</span>&nbsp;<span class="ident" id="2523714">loc</span><span class="op" id="2523717">.</span><span class="ident" id="2523718">lookup</span><span class="op" id="2523724">(</span><span class="ident" id="2523725">unix</span><span class="op" id="2523729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523732">if</span>&nbsp;<span class="ident" id="2523735">offset</span>&nbsp;<span class="op" id="2523742">!=</span>&nbsp;<span class="num" id="2523745">0</span>&nbsp;<span class="op" id="2523747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523751">switch</span>&nbsp;<span class="ident" id="2523758">utc</span>&nbsp;<span class="op" id="2523762">:=</span>&nbsp;<span class="ident" id="2523765">unix</span>&nbsp;<span class="op" id="2523770">-</span>&nbsp;<span class="ident" id="2523772">int64</span><span class="op" id="2523777">(</span><span class="ident" id="2523778">offset</span><span class="op" id="2523784">)</span><span class="op" id="2523785">;</span>&nbsp;<span class="op" id="2523787">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523791">case</span>&nbsp;<span class="ident" id="2523796">utc</span>&nbsp;<span class="op" id="2523800">&lt;</span>&nbsp;<span class="ident" id="2523802">start</span><span class="op" id="2523807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523812">_</span><span class="op" id="2523813">,</span>&nbsp;<span class="ident" id="2523815">offset</span><span class="op" id="2523821">,</span>&nbsp;<span class="ident" id="2523823">_</span><span class="op" id="2523824">,</span>&nbsp;<span class="ident" id="2523826">_</span><span class="op" id="2523827">,</span>&nbsp;<span class="ident" id="2523829">_</span>&nbsp;<span class="op" id="2523831">=</span>&nbsp;<span class="ident" id="2523833">loc</span><span class="op" id="2523836">.</span><span class="ident" id="2523837">lookup</span><span class="op" id="2523843">(</span><span class="ident" id="2523844">start</span>&nbsp;<span class="op" id="2523850">-</span>&nbsp;<span class="num" id="2523852">1</span><span class="op" id="2523853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523857">case</span>&nbsp;<span class="ident" id="2523862">utc</span>&nbsp;<span class="op" id="2523866">&gt;=</span>&nbsp;<span class="ident" id="2523869">end</span><span class="op" id="2523872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523877">_</span><span class="op" id="2523878">,</span>&nbsp;<span class="ident" id="2523880">offset</span><span class="op" id="2523886">,</span>&nbsp;<span class="ident" id="2523888">_</span><span class="op" id="2523889">,</span>&nbsp;<span class="ident" id="2523891">_</span><span class="op" id="2523892">,</span>&nbsp;<span class="ident" id="2523894">_</span>&nbsp;<span class="op" id="2523896">=</span>&nbsp;<span class="ident" id="2523898">loc</span><span class="op" id="2523901">.</span><span class="ident" id="2523902">lookup</span><span class="op" id="2523908">(</span><span class="ident" id="2523909">end</span><span class="op" id="2523912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523916">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523920">unix</span>&nbsp;<span class="op" id="2523925">-=</span>&nbsp;<span class="ident" id="2523928">int64</span><span class="op" id="2523933">(</span><span class="ident" id="2523934">offset</span><span class="op" id="2523940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523947">return</span>&nbsp;<span class="ident" id="2523954">Time</span><span class="op" id="2523958">{</span><span class="ident" id="2523959">unix</span>&nbsp;<span class="op" id="2523964">+</span>&nbsp;<span class="ident" id="2523966">unixToInternal</span><span class="op" id="2523980">,</span>&nbsp;<span class="builtintype" id="2523982">int32</span><span class="op" id="2523987">(</span><span class="ident" id="2523988">nsec</span><span class="op" id="2523992">)</span><span class="op" id="2523993">,</span>&nbsp;<span class="ident" id="2523995">loc</span><span class="op" id="2523998">}</span><br>
<span class="lineno"></span><span class="op" id="2524000">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="2524003">//&nbsp;Truncate&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;down&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2524095">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Truncate&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2524139">func</span>&nbsp;<span class="op" id="2524144">(</span><span class="ident" id="2524145">t</span>&nbsp;<span class="ident" id="2524147">Time</span><span class="op" id="2524151">)</span>&nbsp;<span class="ident" id="2524153">Truncate</span><span class="op" id="2524161">(</span><span class="ident" id="2524162">d</span>&nbsp;<span class="ident" id="2524164">Duration</span><span class="op" id="2524172">)</span>&nbsp;<span class="ident" id="2524174">Time</span>&nbsp;<span class="op" id="2524179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524182">if</span>&nbsp;<span class="ident" id="2524185">d</span>&nbsp;<span class="op" id="2524187">&lt;=</span>&nbsp;<span class="num" id="2524190">0</span>&nbsp;<span class="op" id="2524192">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524196">return</span>&nbsp;<span class="ident" id="2524203">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524209">_</span><span class="op" id="2524210">,</span>&nbsp;<span class="ident" id="2524212">r</span>&nbsp;<span class="op" id="2524214">:=</span>&nbsp;<span class="ident" id="2524217">div</span><span class="op" id="2524220">(</span><span class="ident" id="2524221">t</span><span class="op" id="2524222">,</span>&nbsp;<span class="ident" id="2524224">d</span><span class="op" id="2524225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524228">return</span>&nbsp;<span class="ident" id="2524235">t</span><span class="op" id="2524236">.</span><span class="ident" id="2524237">Add</span><span class="op" id="2524240">(</span><span class="op" id="2524241">-</span><span class="ident" id="2524242">r</span><span class="op" id="2524243">)</span><br>
<span class="lineno"></span><span class="op" id="2524245">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="comment" id="2524248">//&nbsp;Round&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2524342">//&nbsp;The&nbsp;rounding&nbsp;behavior&nbsp;for&nbsp;halfway&nbsp;values&nbsp;is&nbsp;to&nbsp;round&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="2524402">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Round&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2524443">func</span>&nbsp;<span class="op" id="2524448">(</span><span class="ident" id="2524449">t</span>&nbsp;<span class="ident" id="2524451">Time</span><span class="op" id="2524455">)</span>&nbsp;<span class="ident" id="2524457">Round</span><span class="op" id="2524462">(</span><span class="ident" id="2524463">d</span>&nbsp;<span class="ident" id="2524465">Duration</span><span class="op" id="2524473">)</span>&nbsp;<span class="ident" id="2524475">Time</span>&nbsp;<span class="op" id="2524480">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524483">if</span>&nbsp;<span class="ident" id="2524486">d</span>&nbsp;<span class="op" id="2524488">&lt;=</span>&nbsp;<span class="num" id="2524491">0</span>&nbsp;<span class="op" id="2524493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524497">return</span>&nbsp;<span class="ident" id="2524504">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524510">_</span><span class="op" id="2524511">,</span>&nbsp;<span class="ident" id="2524513">r</span>&nbsp;<span class="op" id="2524515">:=</span>&nbsp;<span class="ident" id="2524518">div</span><span class="op" id="2524521">(</span><span class="ident" id="2524522">t</span><span class="op" id="2524523">,</span>&nbsp;<span class="ident" id="2524525">d</span><span class="op" id="2524526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524529">if</span>&nbsp;<span class="ident" id="2524532">r</span><span class="op" id="2524533">+</span><span class="ident" id="2524534">r</span>&nbsp;<span class="op" id="2524536">&lt;</span>&nbsp;<span class="ident" id="2524538">d</span>&nbsp;<span class="op" id="2524540">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524544">return</span>&nbsp;<span class="ident" id="2524551">t</span><span class="op" id="2524552">.</span><span class="ident" id="2524553">Add</span><span class="op" id="2524556">(</span><span class="op" id="2524557">-</span><span class="ident" id="2524558">r</span><span class="op" id="2524559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524565">return</span>&nbsp;<span class="ident" id="2524572">t</span><span class="op" id="2524573">.</span><span class="ident" id="2524574">Add</span><span class="op" id="2524577">(</span><span class="ident" id="2524578">d</span>&nbsp;<span class="op" id="2524580">-</span>&nbsp;<span class="ident" id="2524582">r</span><span class="op" id="2524583">)</span><br>
<span class="lineno"></span><span class="op" id="2524585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2524588">//&nbsp;div&nbsp;divides&nbsp;t&nbsp;by&nbsp;d&nbsp;and&nbsp;returns&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;and&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2524657">//&nbsp;We&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;anymore&nbsp;(round&nbsp;half&nbsp;up&nbsp;instead&nbsp;of&nbsp;round&nbsp;to&nbsp;even)</span><br>
<span class="lineno"></span><span class="comment" id="2524742">//&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;here&nbsp;in&nbsp;case&nbsp;we&nbsp;change&nbsp;our&nbsp;minds.</span><br>
<span class="lineno"></span><span class="keyword" id="2524794">func</span>&nbsp;<span class="ident" id="2524799">div</span><span class="op" id="2524802">(</span><span class="ident" id="2524803">t</span>&nbsp;<span class="ident" id="2524805">Time</span><span class="op" id="2524809">,</span>&nbsp;<span class="ident" id="2524811">d</span>&nbsp;<span class="ident" id="2524813">Duration</span><span class="op" id="2524821">)</span>&nbsp;<span class="op" id="2524823">(</span><span class="ident" id="2524824">qmod2</span>&nbsp;<span class="builtintype" id="2524830">int</span><span class="op" id="2524833">,</span>&nbsp;<span class="ident" id="2524835">r</span>&nbsp;<span class="ident" id="2524837">Duration</span><span class="op" id="2524845">)</span>&nbsp;<span class="op" id="2524847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524850">neg</span>&nbsp;<span class="op" id="2524854">:=</span>&nbsp;<span class="ident" id="2524857">false</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524864">nsec</span>&nbsp;<span class="op" id="2524869">:=</span>&nbsp;<span class="builtintype" id="2524872">int32</span><span class="op" id="2524877">(</span><span class="ident" id="2524878">t</span><span class="op" id="2524879">.</span><span class="ident" id="2524880">nsec</span><span class="op" id="2524884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524887">if</span>&nbsp;<span class="ident" id="2524890">t</span><span class="op" id="2524891">.</span><span class="ident" id="2524892">sec</span>&nbsp;<span class="op" id="2524896">&lt;</span>&nbsp;<span class="num" id="2524898">0</span>&nbsp;<span class="op" id="2524900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2524904">//&nbsp;Operate&nbsp;on&nbsp;absolute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524936">neg</span>&nbsp;<span class="op" id="2524940">=</span>&nbsp;<span class="ident" id="2524942">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524949">t</span><span class="op" id="2524950">.</span><span class="ident" id="2524951">sec</span>&nbsp;<span class="op" id="2524955">=</span>&nbsp;<span class="op" id="2524957">-</span><span class="ident" id="2524958">t</span><span class="op" id="2524959">.</span><span class="ident" id="2524960">sec</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524966">nsec</span>&nbsp;<span class="op" id="2524971">=</span>&nbsp;<span class="op" id="2524973">-</span><span class="ident" id="2524974">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524981">if</span>&nbsp;<span class="ident" id="2524984">nsec</span>&nbsp;<span class="op" id="2524989">&lt;</span>&nbsp;<span class="num" id="2524991">0</span>&nbsp;<span class="op" id="2524993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524998">nsec</span>&nbsp;<span class="op" id="2525003">+=</span>&nbsp;<span class="num" id="2525006">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525013">t</span><span class="op" id="2525014">.</span><span class="ident" id="2525015">sec</span><span class="op" id="2525018">--</span>&nbsp;<span class="comment" id="2525021">//&nbsp;t.sec&nbsp;&gt;=&nbsp;1&nbsp;before&nbsp;the&nbsp;--&nbsp;so&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525059">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525066">switch</span>&nbsp;<span class="op" id="2525073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525076">//&nbsp;Special&nbsp;case:&nbsp;2d&nbsp;divides&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525115">case</span>&nbsp;<span class="ident" id="2525120">d</span>&nbsp;<span class="op" id="2525122">&lt;</span>&nbsp;<span class="ident" id="2525124">Second</span>&nbsp;<span class="op" id="2525131">&amp;&amp;</span>&nbsp;<span class="ident" id="2525134">Second</span><span class="op" id="2525140">%</span><span class="op" id="2525141">(</span><span class="ident" id="2525142">d</span><span class="op" id="2525143">+</span><span class="ident" id="2525144">d</span><span class="op" id="2525145">)</span>&nbsp;<span class="op" id="2525147">==</span>&nbsp;<span class="num" id="2525150">0</span><span class="op" id="2525151">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525155">qmod2</span>&nbsp;<span class="op" id="2525161">=</span>&nbsp;<span class="builtintype" id="2525163">int</span><span class="op" id="2525166">(</span><span class="ident" id="2525167">nsec</span><span class="op" id="2525171">/</span><span class="builtintype" id="2525172">int32</span><span class="op" id="2525177">(</span><span class="ident" id="2525178">d</span><span class="op" id="2525179">)</span><span class="op" id="2525180">)</span>&nbsp;<span class="op" id="2525182">&amp;</span>&nbsp;<span class="num" id="2525184">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525188">r</span>&nbsp;<span class="op" id="2525190">=</span>&nbsp;<span class="ident" id="2525192">Duration</span><span class="op" id="2525200">(</span><span class="ident" id="2525201">nsec</span>&nbsp;<span class="op" id="2525206">%</span>&nbsp;<span class="builtintype" id="2525208">int32</span><span class="op" id="2525213">(</span><span class="ident" id="2525214">d</span><span class="op" id="2525215">)</span><span class="op" id="2525216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525220">//&nbsp;Special&nbsp;case:&nbsp;d&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525267">case</span>&nbsp;<span class="ident" id="2525272">d</span><span class="op" id="2525273">%</span><span class="ident" id="2525274">Second</span>&nbsp;<span class="op" id="2525281">==</span>&nbsp;<span class="num" id="2525284">0</span><span class="op" id="2525285">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525289">d1</span>&nbsp;<span class="op" id="2525292">:=</span>&nbsp;<span class="ident" id="2525295">int64</span><span class="op" id="2525300">(</span><span class="ident" id="2525301">d</span>&nbsp;<span class="op" id="2525303">/</span>&nbsp;<span class="ident" id="2525305">Second</span><span class="op" id="2525311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525315">qmod2</span>&nbsp;<span class="op" id="2525321">=</span>&nbsp;<span class="builtintype" id="2525323">int</span><span class="op" id="2525326">(</span><span class="ident" id="2525327">t</span><span class="op" id="2525328">.</span><span class="ident" id="2525329">sec</span><span class="op" id="2525332">/</span><span class="ident" id="2525333">d1</span><span class="op" id="2525335">)</span>&nbsp;<span class="op" id="2525337">&amp;</span>&nbsp;<span class="num" id="2525339">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525343">r</span>&nbsp;<span class="op" id="2525345">=</span>&nbsp;<span class="ident" id="2525347">Duration</span><span class="op" id="2525355">(</span><span class="ident" id="2525356">t</span><span class="op" id="2525357">.</span><span class="ident" id="2525358">sec</span><span class="op" id="2525361">%</span><span class="ident" id="2525362">d1</span><span class="op" id="2525364">)</span><span class="op" id="2525365">*</span><span class="ident" id="2525366">Second</span>&nbsp;<span class="op" id="2525373">+</span>&nbsp;<span class="ident" id="2525375">Duration</span><span class="op" id="2525383">(</span><span class="ident" id="2525384">nsec</span><span class="op" id="2525388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525392">//&nbsp;General&nbsp;case.</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525410">//&nbsp;This&nbsp;could&nbsp;be&nbsp;faster&nbsp;if&nbsp;more&nbsp;cleverness&nbsp;were&nbsp;applied,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525468">//&nbsp;but&nbsp;it&#39;s&nbsp;really&nbsp;only&nbsp;here&nbsp;to&nbsp;avoid&nbsp;special&nbsp;case&nbsp;restrictions&nbsp;in&nbsp;the&nbsp;API.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525545">//&nbsp;No&nbsp;one&nbsp;will&nbsp;care&nbsp;about&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525585">default</span><span class="op" id="2525592">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525596">//&nbsp;Compute&nbsp;nanoseconds&nbsp;as&nbsp;128-bit&nbsp;number.</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525640">sec</span>&nbsp;<span class="op" id="2525644">:=</span>&nbsp;<span class="ident" id="2525647">uint64</span><span class="op" id="2525653">(</span><span class="ident" id="2525654">t</span><span class="op" id="2525655">.</span><span class="ident" id="2525656">sec</span><span class="op" id="2525659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525663">tmp</span>&nbsp;<span class="op" id="2525667">:=</span>&nbsp;<span class="op" id="2525670">(</span><span class="ident" id="2525671">sec</span>&nbsp;<span class="op" id="2525675">&gt;&gt;</span>&nbsp;<span class="num" id="2525678">32</span><span class="op" id="2525680">)</span>&nbsp;<span class="op" id="2525682">*</span>&nbsp;<span class="num" id="2525684">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525690">u1</span>&nbsp;<span class="op" id="2525693">:=</span>&nbsp;<span class="ident" id="2525696">tmp</span>&nbsp;<span class="op" id="2525700">&gt;&gt;</span>&nbsp;<span class="num" id="2525703">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525708">u0</span>&nbsp;<span class="op" id="2525711">:=</span>&nbsp;<span class="ident" id="2525714">tmp</span>&nbsp;<span class="op" id="2525718">&lt;&lt;</span>&nbsp;<span class="num" id="2525721">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525726">tmp</span>&nbsp;<span class="op" id="2525730">=</span>&nbsp;<span class="ident" id="2525732">uint64</span><span class="op" id="2525738">(</span><span class="ident" id="2525739">sec</span><span class="op" id="2525742">&amp;</span><span class="num" id="2525743">0xFFFFFFFF</span><span class="op" id="2525753">)</span>&nbsp;<span class="op" id="2525755">*</span>&nbsp;<span class="num" id="2525757">1e9</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525763">u0x</span><span class="op" id="2525766">,</span>&nbsp;<span class="ident" id="2525768">u0</span>&nbsp;<span class="op" id="2525771">:=</span>&nbsp;<span class="ident" id="2525774">u0</span><span class="op" id="2525776">,</span>&nbsp;<span class="ident" id="2525778">u0</span><span class="op" id="2525780">+</span><span class="ident" id="2525781">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525787">if</span>&nbsp;<span class="ident" id="2525790">u0</span>&nbsp;<span class="op" id="2525793">&lt;</span>&nbsp;<span class="ident" id="2525795">u0x</span>&nbsp;<span class="op" id="2525799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525804">u1</span><span class="op" id="2525806">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525815">u0x</span><span class="op" id="2525818">,</span>&nbsp;<span class="ident" id="2525820">u0</span>&nbsp;<span class="op" id="2525823">=</span>&nbsp;<span class="ident" id="2525825">u0</span><span class="op" id="2525827">,</span>&nbsp;<span class="ident" id="2525829">u0</span><span class="op" id="2525831">+</span><span class="ident" id="2525832">uint64</span><span class="op" id="2525838">(</span><span class="ident" id="2525839">nsec</span><span class="op" id="2525843">)</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525847">if</span>&nbsp;<span class="ident" id="2525850">u0</span>&nbsp;<span class="op" id="2525853">&lt;</span>&nbsp;<span class="ident" id="2525855">u0x</span>&nbsp;<span class="op" id="2525859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525864">u1</span><span class="op" id="2525866">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525876">//&nbsp;Compute&nbsp;remainder&nbsp;by&nbsp;subtracting&nbsp;r&lt;&lt;k&nbsp;for&nbsp;decreasing&nbsp;k.</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525937">//&nbsp;Quotient&nbsp;parity&nbsp;is&nbsp;whether&nbsp;we&nbsp;subtract&nbsp;on&nbsp;last&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525996">d1</span>&nbsp;<span class="op" id="2525999">:=</span>&nbsp;<span class="ident" id="2526002">uint64</span><span class="op" id="2526008">(</span><span class="ident" id="2526009">d</span><span class="op" id="2526010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526014">for</span>&nbsp;<span class="ident" id="2526018">d1</span><span class="op" id="2526020">&gt;&gt;</span><span class="num" id="2526022">63</span>&nbsp;<span class="op" id="2526025">!=</span>&nbsp;<span class="num" id="2526028">1</span>&nbsp;<span class="op" id="2526030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526035">d1</span>&nbsp;<span class="op" id="2526038">&lt;&lt;=</span>&nbsp;<span class="num" id="2526042">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526046">}</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526050">d0</span>&nbsp;<span class="op" id="2526053">:=</span>&nbsp;<span class="ident" id="2526056">uint64</span><span class="op" id="2526062">(</span><span class="num" id="2526063">0</span><span class="op" id="2526064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526068">for</span>&nbsp;<span class="op" id="2526072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526077">qmod2</span>&nbsp;<span class="op" id="2526083">=</span>&nbsp;<span class="num" id="2526085">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526090">if</span>&nbsp;<span class="ident" id="2526093">u1</span>&nbsp;<span class="op" id="2526096">&gt;</span>&nbsp;<span class="ident" id="2526098">d1</span>&nbsp;<span class="op" id="2526101">||</span>&nbsp;<span class="ident" id="2526104">u1</span>&nbsp;<span class="op" id="2526107">==</span>&nbsp;<span class="ident" id="2526110">d1</span>&nbsp;<span class="op" id="2526113">&amp;&amp;</span>&nbsp;<span class="ident" id="2526116">u0</span>&nbsp;<span class="op" id="2526119">&gt;=</span>&nbsp;<span class="ident" id="2526122">d0</span>&nbsp;<span class="op" id="2526125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526131">//&nbsp;subtract</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526147">qmod2</span>&nbsp;<span class="op" id="2526153">=</span>&nbsp;<span class="num" id="2526155">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526161">u0x</span><span class="op" id="2526164">,</span>&nbsp;<span class="ident" id="2526166">u0</span>&nbsp;<span class="op" id="2526169">=</span>&nbsp;<span class="ident" id="2526171">u0</span><span class="op" id="2526173">,</span>&nbsp;<span class="ident" id="2526175">u0</span><span class="op" id="2526177">-</span><span class="ident" id="2526178">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526185">if</span>&nbsp;<span class="ident" id="2526188">u0</span>&nbsp;<span class="op" id="2526191">&gt;</span>&nbsp;<span class="ident" id="2526193">u0x</span>&nbsp;<span class="op" id="2526197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526204">u1</span><span class="op" id="2526206">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526213">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526219">u1</span>&nbsp;<span class="op" id="2526222">-=</span>&nbsp;<span class="ident" id="2526225">d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526236">if</span>&nbsp;<span class="ident" id="2526239">d1</span>&nbsp;<span class="op" id="2526242">==</span>&nbsp;<span class="num" id="2526245">0</span>&nbsp;<span class="op" id="2526247">&amp;&amp;</span>&nbsp;<span class="ident" id="2526250">d0</span>&nbsp;<span class="op" id="2526253">==</span>&nbsp;<span class="ident" id="2526256">uint64</span><span class="op" id="2526262">(</span><span class="ident" id="2526263">d</span><span class="op" id="2526264">)</span>&nbsp;<span class="op" id="2526266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526272">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526281">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526286">d0</span>&nbsp;<span class="op" id="2526289">&gt;&gt;=</span>&nbsp;<span class="num" id="2526293">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526298">d0</span>&nbsp;<span class="op" id="2526301">|=</span>&nbsp;<span class="op" id="2526304">(</span><span class="ident" id="2526305">d1</span>&nbsp;<span class="op" id="2526308">&amp;</span>&nbsp;<span class="num" id="2526310">1</span><span class="op" id="2526311">)</span>&nbsp;<span class="op" id="2526313">&lt;&lt;</span>&nbsp;<span class="num" id="2526316">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526322">d1</span>&nbsp;<span class="op" id="2526325">&gt;&gt;=</span>&nbsp;<span class="num" id="2526329">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526337">r</span>&nbsp;<span class="op" id="2526339">=</span>&nbsp;<span class="ident" id="2526341">Duration</span><span class="op" id="2526349">(</span><span class="ident" id="2526350">u0</span><span class="op" id="2526352">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526359">if</span>&nbsp;<span class="ident" id="2526362">neg</span>&nbsp;<span class="op" id="2526366">&amp;&amp;</span>&nbsp;<span class="ident" id="2526369">r</span>&nbsp;<span class="op" id="2526371">!=</span>&nbsp;<span class="num" id="2526374">0</span>&nbsp;<span class="op" id="2526376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526380">//&nbsp;If&nbsp;input&nbsp;was&nbsp;negative&nbsp;and&nbsp;not&nbsp;an&nbsp;exact&nbsp;multiple&nbsp;of&nbsp;d,&nbsp;we&nbsp;computed&nbsp;q,&nbsp;r&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526466">//&nbsp;&nbsp;&nbsp;&nbspq*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526484">//&nbsp;But&nbsp;the&nbsp;right&nbsp;answers&nbsp;are&nbsp;given&nbsp;by&nbsp;-(q-1),&nbsp;d-r:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526537">//&nbsp;&nbsp;&nbsp;&nbspq*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526555">//&nbsp;&nbsp;&nbsp;&nbsp-q*d&nbsp;-&nbsp;r&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526573">//&nbsp;&nbsp;&nbsp;&nbsp-(q-1)*d&nbsp;+&nbsp;(d&nbsp;-&nbsp;r)&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526601">qmod2</span>&nbsp;<span class="op" id="2526607">^=</span>&nbsp;<span class="num" id="2526610">1</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526614">r</span>&nbsp;<span class="op" id="2526616">=</span>&nbsp;<span class="ident" id="2526618">d</span>&nbsp;<span class="op" id="2526620">-</span>&nbsp;<span class="ident" id="2526622">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526628">return</span><br>
<span class="lineno"></span><span class="op" id="2526635">}</span>
</div>
</body>
</html>
