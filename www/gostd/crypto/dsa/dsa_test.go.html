<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6845442">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6845497">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6845551">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6845602">package</span>&nbsp;<span class="ident" id="6845610">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6845615">import</span>&nbsp;<span class="op" id="6845622">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845625">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845640">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6845652">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6845662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6845665">func</span>&nbsp;<span class="ident" id="6845670">testSignAndVerify</span><span class="op" id="6845687">(</span><span class="ident" id="6845688">t</span>&nbsp;<span class="op" id="6845690">*</span><span class="ident" id="6845691">testing</span><span class="op" id="6845698">.</span><span class="ident" id="6845699">T</span><span class="op" id="6845700">,</span>&nbsp;<span class="ident" id="6845702">i</span>&nbsp;<span class="builtintype" id="6845704">int</span><span class="op" id="6845707">,</span>&nbsp;<span class="ident" id="6845709">priv</span>&nbsp;<span class="op" id="6845714">*</span><span class="ident" id="6845715">PrivateKey</span><span class="op" id="6845725">)</span>&nbsp;<span class="op" id="6845727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845730">hashed</span>&nbsp;<span class="op" id="6845737">:=</span>&nbsp;<span class="op" id="6845740">[</span><span class="op" id="6845741">]</span><span class="builtintype" id="6845742">byte</span><span class="op" id="6845746">(</span><span class="string" id="6845747">&#34;testing&#34;</span><span class="op" id="6845756">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845759">r</span><span class="op" id="6845760">,</span>&nbsp;<span class="ident" id="6845762">s</span><span class="op" id="6845763">,</span>&nbsp;<span class="ident" id="6845765">err</span>&nbsp;<span class="op" id="6845769">:=</span>&nbsp;<span class="ident" id="6845772">Sign</span><span class="op" id="6845776">(</span><span class="ident" id="6845777">rand</span><span class="op" id="6845781">.</span><span class="ident" id="6845782">Reader</span><span class="op" id="6845788">,</span>&nbsp;<span class="ident" id="6845790">priv</span><span class="op" id="6845794">,</span>&nbsp;<span class="ident" id="6845796">hashed</span><span class="op" id="6845802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6845805">if</span>&nbsp;<span class="ident" id="6845808">err</span>&nbsp;<span class="op" id="6845812">!=</span>&nbsp;<span class="ident" id="6845815">nil</span>&nbsp;<span class="op" id="6845819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845823">t</span><span class="op" id="6845824">.</span><span class="ident" id="6845825">Errorf</span><span class="op" id="6845831">(</span><span class="string" id="6845832">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6845855">,</span>&nbsp;<span class="ident" id="6845857">i</span><span class="op" id="6845858">,</span>&nbsp;<span class="ident" id="6845860">err</span><span class="op" id="6845863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6845867">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845875">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6845879">if</span>&nbsp;<span class="op" id="6845882">!</span><span class="ident" id="6845883">Verify</span><span class="op" id="6845889">(</span><span class="op" id="6845890">&amp;</span><span class="ident" id="6845891">priv</span><span class="op" id="6845895">.</span><span class="ident" id="6845896">PublicKey</span><span class="op" id="6845905">,</span>&nbsp;<span class="ident" id="6845907">hashed</span><span class="op" id="6845913">,</span>&nbsp;<span class="ident" id="6845915">r</span><span class="op" id="6845916">,</span>&nbsp;<span class="ident" id="6845918">s</span><span class="op" id="6845919">)</span>&nbsp;<span class="op" id="6845921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845925">t</span><span class="op" id="6845926">.</span><span class="ident" id="6845927">Errorf</span><span class="op" id="6845933">(</span><span class="string" id="6845934">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6845953">,</span>&nbsp;<span class="ident" id="6845955">i</span><span class="op" id="6845956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845959">}</span><br>
<span class="lineno"></span><span class="op" id="6845961">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6845964">func</span>&nbsp;<span class="ident" id="6845969">testParameterGeneration</span><span class="op" id="6845992">(</span><span class="ident" id="6845993">t</span>&nbsp;<span class="op" id="6845995">*</span><span class="ident" id="6845996">testing</span><span class="op" id="6846003">.</span><span class="ident" id="6846004">T</span><span class="op" id="6846005">,</span>&nbsp;<span class="ident" id="6846007">sizes</span>&nbsp;<span class="ident" id="6846013">ParameterSizes</span><span class="op" id="6846027">,</span>&nbsp;<span class="ident" id="6846029">L</span><span class="op" id="6846030">,</span>&nbsp;<span class="ident" id="6846032">N</span>&nbsp;<span class="builtintype" id="6846034">int</span><span class="op" id="6846037">)</span>&nbsp;<span class="op" id="6846039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846042">var</span>&nbsp;<span class="ident" id="6846046">priv</span>&nbsp;<span class="ident" id="6846051">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846063">params</span>&nbsp;<span class="op" id="6846070">:=</span>&nbsp;<span class="op" id="6846073">&amp;</span><span class="ident" id="6846074">priv</span><span class="op" id="6846078">.</span><span class="ident" id="6846079">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846092">err</span>&nbsp;<span class="op" id="6846096">:=</span>&nbsp;<span class="ident" id="6846099">GenerateParameters</span><span class="op" id="6846117">(</span><span class="ident" id="6846118">params</span><span class="op" id="6846124">,</span>&nbsp;<span class="ident" id="6846126">rand</span><span class="op" id="6846130">.</span><span class="ident" id="6846131">Reader</span><span class="op" id="6846137">,</span>&nbsp;<span class="ident" id="6846139">sizes</span><span class="op" id="6846144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846147">if</span>&nbsp;<span class="ident" id="6846150">err</span>&nbsp;<span class="op" id="6846154">!=</span>&nbsp;<span class="ident" id="6846157">nil</span>&nbsp;<span class="op" id="6846161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846165">t</span><span class="op" id="6846166">.</span><span class="ident" id="6846167">Errorf</span><span class="op" id="6846173">(</span><span class="string" id="6846174">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="6846182">,</span>&nbsp;<span class="builtintype" id="6846184">int</span><span class="op" id="6846187">(</span><span class="ident" id="6846188">sizes</span><span class="op" id="6846193">)</span><span class="op" id="6846194">,</span>&nbsp;<span class="ident" id="6846196">err</span><span class="op" id="6846199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846203">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846211">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846215">if</span>&nbsp;<span class="ident" id="6846218">params</span><span class="op" id="6846224">.</span><span class="ident" id="6846225">P</span><span class="op" id="6846226">.</span><span class="ident" id="6846227">BitLen</span><span class="op" id="6846233">(</span><span class="op" id="6846234">)</span>&nbsp;<span class="op" id="6846236">!=</span>&nbsp;<span class="ident" id="6846239">L</span>&nbsp;<span class="op" id="6846241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846245">t</span><span class="op" id="6846246">.</span><span class="ident" id="6846247">Errorf</span><span class="op" id="6846253">(</span><span class="string" id="6846254">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6846288">,</span>&nbsp;<span class="builtintype" id="6846290">int</span><span class="op" id="6846293">(</span><span class="ident" id="6846294">sizes</span><span class="op" id="6846299">)</span><span class="op" id="6846300">,</span>&nbsp;<span class="ident" id="6846302">params</span><span class="op" id="6846308">.</span><span class="ident" id="6846309">P</span><span class="op" id="6846310">.</span><span class="ident" id="6846311">BitLen</span><span class="op" id="6846317">(</span><span class="op" id="6846318">)</span><span class="op" id="6846319">,</span>&nbsp;<span class="ident" id="6846321">L</span><span class="op" id="6846322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846329">if</span>&nbsp;<span class="ident" id="6846332">params</span><span class="op" id="6846338">.</span><span class="ident" id="6846339">Q</span><span class="op" id="6846340">.</span><span class="ident" id="6846341">BitLen</span><span class="op" id="6846347">(</span><span class="op" id="6846348">)</span>&nbsp;<span class="op" id="6846350">!=</span>&nbsp;<span class="ident" id="6846353">N</span>&nbsp;<span class="op" id="6846355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846359">t</span><span class="op" id="6846360">.</span><span class="ident" id="6846361">Errorf</span><span class="op" id="6846367">(</span><span class="string" id="6846368">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="6846397">,</span>&nbsp;<span class="builtintype" id="6846399">int</span><span class="op" id="6846402">(</span><span class="ident" id="6846403">sizes</span><span class="op" id="6846408">)</span><span class="op" id="6846409">,</span>&nbsp;<span class="ident" id="6846411">params</span><span class="op" id="6846417">.</span><span class="ident" id="6846418">Q</span><span class="op" id="6846419">.</span><span class="ident" id="6846420">BitLen</span><span class="op" id="6846426">(</span><span class="op" id="6846427">)</span><span class="op" id="6846428">,</span>&nbsp;<span class="ident" id="6846430">L</span><span class="op" id="6846431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846438">one</span>&nbsp;<span class="op" id="6846442">:=</span>&nbsp;<span class="builtinfunc" id="6846445">new</span><span class="op" id="6846448">(</span><span class="ident" id="6846449">big</span><span class="op" id="6846452">.</span><span class="ident" id="6846453">Int</span><span class="op" id="6846456">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846459">one</span><span class="op" id="6846462">.</span><span class="ident" id="6846463">SetInt64</span><span class="op" id="6846471">(</span><span class="num" id="6846472">1</span><span class="op" id="6846473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846476">pm1</span>&nbsp;<span class="op" id="6846480">:=</span>&nbsp;<span class="builtinfunc" id="6846483">new</span><span class="op" id="6846486">(</span><span class="ident" id="6846487">big</span><span class="op" id="6846490">.</span><span class="ident" id="6846491">Int</span><span class="op" id="6846494">)</span><span class="op" id="6846495">.</span><span class="ident" id="6846496">Sub</span><span class="op" id="6846499">(</span><span class="ident" id="6846500">params</span><span class="op" id="6846506">.</span><span class="ident" id="6846507">P</span><span class="op" id="6846508">,</span>&nbsp;<span class="ident" id="6846510">one</span><span class="op" id="6846513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846516">quo</span><span class="op" id="6846519">,</span>&nbsp;<span class="ident" id="6846521">rem</span>&nbsp;<span class="op" id="6846525">:=</span>&nbsp;<span class="builtinfunc" id="6846528">new</span><span class="op" id="6846531">(</span><span class="ident" id="6846532">big</span><span class="op" id="6846535">.</span><span class="ident" id="6846536">Int</span><span class="op" id="6846539">)</span><span class="op" id="6846540">.</span><span class="ident" id="6846541">DivMod</span><span class="op" id="6846547">(</span><span class="ident" id="6846548">pm1</span><span class="op" id="6846551">,</span>&nbsp;<span class="ident" id="6846553">params</span><span class="op" id="6846559">.</span><span class="ident" id="6846560">Q</span><span class="op" id="6846561">,</span>&nbsp;<span class="builtinfunc" id="6846563">new</span><span class="op" id="6846566">(</span><span class="ident" id="6846567">big</span><span class="op" id="6846570">.</span><span class="ident" id="6846571">Int</span><span class="op" id="6846574">)</span><span class="op" id="6846575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846578">if</span>&nbsp;<span class="ident" id="6846581">rem</span><span class="op" id="6846584">.</span><span class="ident" id="6846585">Sign</span><span class="op" id="6846589">(</span><span class="op" id="6846590">)</span>&nbsp;<span class="op" id="6846592">!=</span>&nbsp;<span class="num" id="6846595">0</span>&nbsp;<span class="op" id="6846597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846601">t</span><span class="op" id="6846602">.</span><span class="ident" id="6846603">Errorf</span><span class="op" id="6846609">(</span><span class="string" id="6846610">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="6846630">,</span>&nbsp;<span class="builtintype" id="6846632">int</span><span class="op" id="6846635">(</span><span class="ident" id="6846636">sizes</span><span class="op" id="6846641">)</span><span class="op" id="6846642">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846648">x</span>&nbsp;<span class="op" id="6846650">:=</span>&nbsp;<span class="builtinfunc" id="6846653">new</span><span class="op" id="6846656">(</span><span class="ident" id="6846657">big</span><span class="op" id="6846660">.</span><span class="ident" id="6846661">Int</span><span class="op" id="6846664">)</span><span class="op" id="6846665">.</span><span class="ident" id="6846666">Exp</span><span class="op" id="6846669">(</span><span class="ident" id="6846670">params</span><span class="op" id="6846676">.</span><span class="ident" id="6846677">G</span><span class="op" id="6846678">,</span>&nbsp;<span class="ident" id="6846680">quo</span><span class="op" id="6846683">,</span>&nbsp;<span class="ident" id="6846685">params</span><span class="op" id="6846691">.</span><span class="ident" id="6846692">P</span><span class="op" id="6846693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846696">if</span>&nbsp;<span class="ident" id="6846699">x</span><span class="op" id="6846700">.</span><span class="ident" id="6846701">Cmp</span><span class="op" id="6846704">(</span><span class="ident" id="6846705">one</span><span class="op" id="6846708">)</span>&nbsp;<span class="op" id="6846710">==</span>&nbsp;<span class="num" id="6846713">0</span>&nbsp;<span class="op" id="6846715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846719">t</span><span class="op" id="6846720">.</span><span class="ident" id="6846721">Errorf</span><span class="op" id="6846727">(</span><span class="string" id="6846728">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="6846751">,</span>&nbsp;<span class="builtintype" id="6846753">int</span><span class="op" id="6846756">(</span><span class="ident" id="6846757">sizes</span><span class="op" id="6846762">)</span><span class="op" id="6846763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846766">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846770">err</span>&nbsp;<span class="op" id="6846774">=</span>&nbsp;<span class="ident" id="6846776">GenerateKey</span><span class="op" id="6846787">(</span><span class="op" id="6846788">&amp;</span><span class="ident" id="6846789">priv</span><span class="op" id="6846793">,</span>&nbsp;<span class="ident" id="6846795">rand</span><span class="op" id="6846799">.</span><span class="ident" id="6846800">Reader</span><span class="op" id="6846806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846809">if</span>&nbsp;<span class="ident" id="6846812">err</span>&nbsp;<span class="op" id="6846816">!=</span>&nbsp;<span class="ident" id="6846819">nil</span>&nbsp;<span class="op" id="6846823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846827">t</span><span class="op" id="6846828">.</span><span class="ident" id="6846829">Errorf</span><span class="op" id="6846835">(</span><span class="string" id="6846836">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6846862">,</span>&nbsp;<span class="ident" id="6846864">err</span><span class="op" id="6846867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846871">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846883">testSignAndVerify</span><span class="op" id="6846900">(</span><span class="ident" id="6846901">t</span><span class="op" id="6846902">,</span>&nbsp;<span class="builtintype" id="6846904">int</span><span class="op" id="6846907">(</span><span class="ident" id="6846908">sizes</span><span class="op" id="6846913">)</span><span class="op" id="6846914">,</span>&nbsp;<span class="op" id="6846916">&amp;</span><span class="ident" id="6846917">priv</span><span class="op" id="6846921">)</span><br>
<span class="lineno"></span><span class="op" id="6846923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6846926">func</span>&nbsp;<span class="ident" id="6846931">TestParameterGeneration</span><span class="op" id="6846954">(</span><span class="ident" id="6846955">t</span>&nbsp;<span class="op" id="6846957">*</span><span class="ident" id="6846958">testing</span><span class="op" id="6846965">.</span><span class="ident" id="6846966">T</span><span class="op" id="6846967">)</span>&nbsp;<span class="op" id="6846969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846972">if</span>&nbsp;<span class="ident" id="6846975">testing</span><span class="op" id="6846982">.</span><span class="ident" id="6846983">Short</span><span class="op" id="6846988">(</span><span class="op" id="6846989">)</span>&nbsp;<span class="op" id="6846991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846995">t</span><span class="op" id="6846996">.</span><span class="ident" id="6846997">Skip</span><span class="op" id="6847001">(</span><span class="string" id="6847002">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="6847052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847059">testParameterGeneration</span><span class="op" id="6847082">(</span><span class="ident" id="6847083">t</span><span class="op" id="6847084">,</span>&nbsp;<span class="ident" id="6847086">L1024N160</span><span class="op" id="6847095">,</span>&nbsp;<span class="num" id="6847097">1024</span><span class="op" id="6847101">,</span>&nbsp;<span class="num" id="6847103">160</span><span class="op" id="6847106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847109">testParameterGeneration</span><span class="op" id="6847132">(</span><span class="ident" id="6847133">t</span><span class="op" id="6847134">,</span>&nbsp;<span class="ident" id="6847136">L2048N224</span><span class="op" id="6847145">,</span>&nbsp;<span class="num" id="6847147">2048</span><span class="op" id="6847151">,</span>&nbsp;<span class="num" id="6847153">224</span><span class="op" id="6847156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847159">testParameterGeneration</span><span class="op" id="6847182">(</span><span class="ident" id="6847183">t</span><span class="op" id="6847184">,</span>&nbsp;<span class="ident" id="6847186">L2048N256</span><span class="op" id="6847195">,</span>&nbsp;<span class="num" id="6847197">2048</span><span class="op" id="6847201">,</span>&nbsp;<span class="num" id="6847203">256</span><span class="op" id="6847206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847209">testParameterGeneration</span><span class="op" id="6847232">(</span><span class="ident" id="6847233">t</span><span class="op" id="6847234">,</span>&nbsp;<span class="ident" id="6847236">L3072N256</span><span class="op" id="6847245">,</span>&nbsp;<span class="num" id="6847247">3072</span><span class="op" id="6847251">,</span>&nbsp;<span class="num" id="6847253">256</span><span class="op" id="6847256">)</span><br>
<span class="lineno"></span><span class="op" id="6847258">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="6847261">func</span>&nbsp;<span class="ident" id="6847266">TestSignAndVerify</span><span class="op" id="6847283">(</span><span class="ident" id="6847284">t</span>&nbsp;<span class="op" id="6847286">*</span><span class="ident" id="6847287">testing</span><span class="op" id="6847294">.</span><span class="ident" id="6847295">T</span><span class="op" id="6847296">)</span>&nbsp;<span class="op" id="6847298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847301">var</span>&nbsp;<span class="ident" id="6847305">priv</span>&nbsp;<span class="ident" id="6847310">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847322">priv</span><span class="op" id="6847326">.</span><span class="ident" id="6847327">P</span><span class="op" id="6847328">,</span>&nbsp;<span class="ident" id="6847330">_</span>&nbsp;<span class="op" id="6847332">=</span>&nbsp;<span class="builtinfunc" id="6847334">new</span><span class="op" id="6847337">(</span><span class="ident" id="6847338">big</span><span class="op" id="6847341">.</span><span class="ident" id="6847342">Int</span><span class="op" id="6847345">)</span><span class="op" id="6847346">.</span><span class="ident" id="6847347">SetString</span><span class="op" id="6847356">(</span><span class="string" id="6847357">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="6847615">,</span>&nbsp;<span class="num" id="6847617">16</span><span class="op" id="6847619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847622">priv</span><span class="op" id="6847626">.</span><span class="ident" id="6847627">Q</span><span class="op" id="6847628">,</span>&nbsp;<span class="ident" id="6847630">_</span>&nbsp;<span class="op" id="6847632">=</span>&nbsp;<span class="builtinfunc" id="6847634">new</span><span class="op" id="6847637">(</span><span class="ident" id="6847638">big</span><span class="op" id="6847641">.</span><span class="ident" id="6847642">Int</span><span class="op" id="6847645">)</span><span class="op" id="6847646">.</span><span class="ident" id="6847647">SetString</span><span class="op" id="6847656">(</span><span class="string" id="6847657">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="6847699">,</span>&nbsp;<span class="num" id="6847701">16</span><span class="op" id="6847703">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847706">priv</span><span class="op" id="6847710">.</span><span class="ident" id="6847711">G</span><span class="op" id="6847712">,</span>&nbsp;<span class="ident" id="6847714">_</span>&nbsp;<span class="op" id="6847716">=</span>&nbsp;<span class="builtinfunc" id="6847718">new</span><span class="op" id="6847721">(</span><span class="ident" id="6847722">big</span><span class="op" id="6847725">.</span><span class="ident" id="6847726">Int</span><span class="op" id="6847729">)</span><span class="op" id="6847730">.</span><span class="ident" id="6847731">SetString</span><span class="op" id="6847740">(</span><span class="string" id="6847741">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="6847999">,</span>&nbsp;<span class="num" id="6848001">16</span><span class="op" id="6848003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848006">priv</span><span class="op" id="6848010">.</span><span class="ident" id="6848011">Y</span><span class="op" id="6848012">,</span>&nbsp;<span class="ident" id="6848014">_</span>&nbsp;<span class="op" id="6848016">=</span>&nbsp;<span class="builtinfunc" id="6848018">new</span><span class="op" id="6848021">(</span><span class="ident" id="6848022">big</span><span class="op" id="6848025">.</span><span class="ident" id="6848026">Int</span><span class="op" id="6848029">)</span><span class="op" id="6848030">.</span><span class="ident" id="6848031">SetString</span><span class="op" id="6848040">(</span><span class="string" id="6848041">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="6848299">,</span>&nbsp;<span class="num" id="6848301">16</span><span class="op" id="6848303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848306">priv</span><span class="op" id="6848310">.</span><span class="ident" id="6848311">X</span><span class="op" id="6848312">,</span>&nbsp;<span class="ident" id="6848314">_</span>&nbsp;<span class="op" id="6848316">=</span>&nbsp;<span class="builtinfunc" id="6848318">new</span><span class="op" id="6848321">(</span><span class="ident" id="6848322">big</span><span class="op" id="6848325">.</span><span class="ident" id="6848326">Int</span><span class="op" id="6848329">)</span><span class="op" id="6848330">.</span><span class="ident" id="6848331">SetString</span><span class="op" id="6848340">(</span><span class="string" id="6848341">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="6848383">,</span>&nbsp;<span class="num" id="6848385">16</span><span class="op" id="6848387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848391">testSignAndVerify</span><span class="op" id="6848408">(</span><span class="ident" id="6848409">t</span><span class="op" id="6848410">,</span>&nbsp;<span class="num" id="6848412">0</span><span class="op" id="6848413">,</span>&nbsp;<span class="op" id="6848415">&amp;</span><span class="ident" id="6848416">priv</span><span class="op" id="6848420">)</span><br>
<span class="lineno">85</span><span class="op" id="6848422">}</span>
</div>
</body>
</html>
