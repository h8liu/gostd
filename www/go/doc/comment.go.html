<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5714362">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5714417">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5714471">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5714522">//&nbsp;Godoc&nbsp;comment&nbsp;extraction&nbsp;and&nbsp;comment&nbsp;-&gt;&nbsp;HTML&nbsp;formatting.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714583">package</span>&nbsp;<span class="ident" id="5714591">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714596">import</span>&nbsp;<span class="op" id="5714603">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714606">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714612">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714622">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714633">&#34;text/template&#34;</span>&nbsp;<span class="comment" id="5714649">//&nbsp;for&nbsp;HTMLEscape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714668">&#34;unicode&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714679">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5714694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714697">var</span>&nbsp;<span class="op" id="5714701">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714704">ldquo</span>&nbsp;<span class="op" id="5714710">=</span>&nbsp;<span class="op" id="5714712">[</span><span class="op" id="5714713">]</span><span class="builtintype" id="5714714">byte</span><span class="op" id="5714718">(</span><span class="string" id="5714719">&#34;&amp;ldquo;&#34;</span><span class="op" id="5714728">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714731">rdquo</span>&nbsp;<span class="op" id="5714737">=</span>&nbsp;<span class="op" id="5714739">[</span><span class="op" id="5714740">]</span><span class="builtintype" id="5714741">byte</span><span class="op" id="5714745">(</span><span class="string" id="5714746">&#34;&amp;rdquo;&#34;</span><span class="op" id="5714755">)</span><br>
<span class="lineno"></span><span class="op" id="5714757">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5714760">//&nbsp;Escape&nbsp;comment&nbsp;text&nbsp;for&nbsp;HTML.&nbsp;If&nbsp;nice&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5714809">//&nbsp;also&nbsp;turn&nbsp;``&nbsp;into&nbsp;&amp;ldquo;&nbsp;and&nbsp;&#39;&#39;&nbsp;into&nbsp;&amp;rdquo;.</span><br>
<span class="lineno">25</span><span class="keyword" id="5714859">func</span>&nbsp;<span class="ident" id="5714864">commentEscape</span><span class="op" id="5714877">(</span><span class="ident" id="5714878">w</span>&nbsp;<span class="ident" id="5714880"><a href="/go/doc/comment.go.html#5714606">io</a></span><span class="op" id="5714882">.</span><span class="ident" id="5714883">Writer</span><span class="op" id="5714889">,</span>&nbsp;<span class="ident" id="5714891">text</span>&nbsp;<span class="builtintype" id="5714896">string</span><span class="op" id="5714902">,</span>&nbsp;<span class="ident" id="5714904">nice</span>&nbsp;<span class="builtintype" id="5714909">bool</span><span class="op" id="5714913">)</span>&nbsp;<span class="op" id="5714915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714918">last</span>&nbsp;<span class="op" id="5714923">:=</span>&nbsp;<span class="num" id="5714926">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714929">if</span>&nbsp;<span class="ident" id="5714932"><a href="/go/doc/comment.go.html#5714904">nice</a></span>&nbsp;<span class="op" id="5714937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714941">for</span>&nbsp;<span class="ident" id="5714945">i</span>&nbsp;<span class="op" id="5714947">:=</span>&nbsp;<span class="num" id="5714950">0</span><span class="op" id="5714951">;</span>&nbsp;<span class="ident" id="5714953"><a href="/go/doc/comment.go.html#5714945">i</a></span>&nbsp;<span class="op" id="5714955">&lt;</span>&nbsp;<span class="builtinfunc" id="5714957">len</span><span class="op" id="5714960">(</span><span class="ident" id="5714961"><a href="/go/doc/comment.go.html#5714891">text</a></span><span class="op" id="5714965">)</span><span class="op" id="5714966">-</span><span class="num" id="5714967">1</span><span class="op" id="5714968">;</span>&nbsp;<span class="ident" id="5714970"><a href="/go/doc/comment.go.html#5714945">i</a></span><span class="op" id="5714971">++</span>&nbsp;<span class="op" id="5714974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5714979">ch</span>&nbsp;<span class="op" id="5714982">:=</span>&nbsp;<span class="ident" id="5714985"><a href="/go/doc/comment.go.html#5714891">text</a></span><span class="op" id="5714989">[</span><span class="ident" id="5714990"><a href="/go/doc/comment.go.html#5714945">i</a></span><span class="op" id="5714991">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5714996">if</span>&nbsp;<span class="ident" id="5714999"><a href="/go/doc/comment.go.html#5714979">ch</a></span>&nbsp;<span class="op" id="5715002">==</span>&nbsp;<span class="ident" id="5715005"><a href="/go/doc/comment.go.html#5714891">text</a></span><span class="op" id="5715009">[</span><span class="ident" id="5715010"><a href="/go/doc/comment.go.html#5714945">i</a></span><span class="op" id="5715011">+</span><span class="num" id="5715012">1</span><span class="op" id="5715013">]</span>&nbsp;<span class="op" id="5715015">&amp;&amp;</span>&nbsp;<span class="op" id="5715018">(</span><span class="ident" id="5715019"><a href="/go/doc/comment.go.html#5714979">ch</a></span>&nbsp;<span class="op" id="5715022">==</span>&nbsp;<span class="string" id="5715025">&#39;`&#39;</span>&nbsp;<span class="op" id="5715029">||</span>&nbsp;<span class="ident" id="5715032"><a href="/go/doc/comment.go.html#5714979">ch</a></span>&nbsp;<span class="op" id="5715035">==</span>&nbsp;<span class="string" id="5715038">&#39;\&#39;&#39;</span><span class="op" id="5715042">)</span>&nbsp;<span class="op" id="5715044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715050"><a href="/go/doc/comment.go.html#5714633">template</a></span><span class="op" id="5715058">.</span><span class="ident" id="5715059">HTMLEscape</span><span class="op" id="5715069">(</span><span class="ident" id="5715070"><a href="/go/doc/comment.go.html#5714878">w</a></span><span class="op" id="5715071">,</span>&nbsp;<span class="op" id="5715073">[</span><span class="op" id="5715074">]</span><span class="builtintype" id="5715075">byte</span><span class="op" id="5715079">(</span><span class="ident" id="5715080"><a href="/go/doc/comment.go.html#5714891">text</a></span><span class="op" id="5715084">[</span><span class="ident" id="5715085"><a href="/go/doc/comment.go.html#5714918">last</a></span><span class="op" id="5715089">:</span><span class="ident" id="5715090"><a href="/go/doc/comment.go.html#5714945">i</a></span><span class="op" id="5715091">]</span><span class="op" id="5715092">)</span><span class="op" id="5715093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715099"><a href="/go/doc/comment.go.html#5714918">last</a></span>&nbsp;<span class="op" id="5715104">=</span>&nbsp;<span class="ident" id="5715106"><a href="/go/doc/comment.go.html#5714945">i</a></span>&nbsp;<span class="op" id="5715108">+</span>&nbsp;<span class="num" id="5715110">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715116">switch</span>&nbsp;<span class="ident" id="5715123"><a href="/go/doc/comment.go.html#5714979">ch</a></span>&nbsp;<span class="op" id="5715126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715132">case</span>&nbsp;<span class="string" id="5715137">&#39;`&#39;</span><span class="op" id="5715140">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715147"><a href="/go/doc/comment.go.html#5714878">w</a></span><span class="op" id="5715148">.</span><span class="ident" id="5715149">Write</span><span class="op" id="5715154">(</span><span class="ident" id="5715155"><a href="/go/doc/comment.go.html#5714704">ldquo</a></span><span class="op" id="5715160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715166">case</span>&nbsp;<span class="string" id="5715171">&#39;\&#39;&#39;</span><span class="op" id="5715175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715182"><a href="/go/doc/comment.go.html#5714878">w</a></span><span class="op" id="5715183">.</span><span class="ident" id="5715184">Write</span><span class="op" id="5715189">(</span><span class="ident" id="5715190"><a href="/go/doc/comment.go.html#5714731">rdquo</a></span><span class="op" id="5715195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715207"><a href="/go/doc/comment.go.html#5714945">i</a></span><span class="op" id="5715208">++</span>&nbsp;<span class="comment" id="5715211">//&nbsp;loop&nbsp;will&nbsp;add&nbsp;one&nbsp;more</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715250"><a href="/go/doc/comment.go.html#5714633">template</a></span><span class="op" id="5715258">.</span><span class="ident" id="5715259">HTMLEscape</span><span class="op" id="5715269">(</span><span class="ident" id="5715270"><a href="/go/doc/comment.go.html#5714878">w</a></span><span class="op" id="5715271">,</span>&nbsp;<span class="op" id="5715273">[</span><span class="op" id="5715274">]</span><span class="builtintype" id="5715275">byte</span><span class="op" id="5715279">(</span><span class="ident" id="5715280"><a href="/go/doc/comment.go.html#5714891">text</a></span><span class="op" id="5715284">[</span><span class="ident" id="5715285"><a href="/go/doc/comment.go.html#5714918">last</a></span><span class="op" id="5715289">:</span><span class="op" id="5715290">]</span><span class="op" id="5715291">)</span><span class="op" id="5715292">)</span><br>
<span class="lineno"></span><span class="op" id="5715294">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="5715297">const</span>&nbsp;<span class="op" id="5715303">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715306">//&nbsp;Regexp&nbsp;for&nbsp;Go&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715336">identRx</span>&nbsp;<span class="op" id="5715344">=</span>&nbsp;<span class="string" id="5715346">`[\pL_][\pL_0-9]*`</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715367">//&nbsp;Regexp&nbsp;for&nbsp;URLs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715387">protocol</span>&nbsp;<span class="op" id="5715396">=</span>&nbsp;<span class="string" id="5715398">`https?|ftp|file|gopher|mailto|news|nntp|telnet|wais|prospero`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715462">hostPart</span>&nbsp;<span class="op" id="5715471">=</span>&nbsp;<span class="string" id="5715473">`[a-zA-Z0-9_@\-]+`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715493">filePart</span>&nbsp;<span class="op" id="5715502">=</span>&nbsp;<span class="string" id="5715504">`[a-zA-Z0-9_?%#~&amp;/\-+=()]+`</span>&nbsp;<span class="comment" id="5715532">//&nbsp;parentheses&nbsp;may&nbsp;not&nbsp;be&nbsp;matching;&nbsp;see&nbsp;pairedParensPrefixLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715595">urlRx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715604">=</span>&nbsp;<span class="string" id="5715606">`(`</span>&nbsp;<span class="op" id="5715610">+</span>&nbsp;<span class="ident" id="5715612"><a href="/go/doc/comment.go.html#5715387">protocol</a></span>&nbsp;<span class="op" id="5715621">+</span>&nbsp;<span class="string" id="5715623">`)://`</span>&nbsp;<span class="op" id="5715630">+</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5715634">//&nbsp;http://</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715647"><a href="/go/doc/comment.go.html#5715462">hostPart</a></span>&nbsp;<span class="op" id="5715656">+</span>&nbsp;<span class="string" id="5715658">`([.:]`</span>&nbsp;<span class="op" id="5715666">+</span>&nbsp;<span class="ident" id="5715668"><a href="/go/doc/comment.go.html#5715462">hostPart</a></span>&nbsp;<span class="op" id="5715677">+</span>&nbsp;<span class="string" id="5715679">`)*/?`</span>&nbsp;<span class="op" id="5715686">+</span>&nbsp;<span class="comment" id="5715688">//&nbsp;//www.google.com:8080/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715716"><a href="/go/doc/comment.go.html#5715493">filePart</a></span>&nbsp;<span class="op" id="5715725">+</span>&nbsp;<span class="string" id="5715727">`([:.,]`</span>&nbsp;<span class="op" id="5715736">+</span>&nbsp;<span class="ident" id="5715738"><a href="/go/doc/comment.go.html#5715493">filePart</a></span>&nbsp;<span class="op" id="5715747">+</span>&nbsp;<span class="string" id="5715749">`)*`</span><br>
<span class="lineno"></span><span class="op" id="5715754">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5715757">var</span>&nbsp;<span class="ident" id="5715761">matchRx</span>&nbsp;<span class="op" id="5715769">=</span>&nbsp;<span class="ident" id="5715771"><a href="/go/doc/comment.go.html#5714612">regexp</a></span><span class="op" id="5715777">.</span><span class="ident" id="5715778">MustCompile</span><span class="op" id="5715789">(</span><span class="string" id="5715790">`(`</span>&nbsp;<span class="op" id="5715794">+</span>&nbsp;<span class="ident" id="5715796"><a href="/go/doc/comment.go.html#5715595">urlRx</a></span>&nbsp;<span class="op" id="5715802">+</span>&nbsp;<span class="string" id="5715804">`)|(`</span>&nbsp;<span class="op" id="5715810">+</span>&nbsp;<span class="ident" id="5715812"><a href="/go/doc/comment.go.html#5715336">identRx</a></span>&nbsp;<span class="op" id="5715820">+</span>&nbsp;<span class="string" id="5715822">`)`</span><span class="op" id="5715825">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="5715828">var</span>&nbsp;<span class="op" id="5715832">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715835">html_a</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715847">=</span>&nbsp;<span class="op" id="5715849">[</span><span class="op" id="5715850">]</span><span class="builtintype" id="5715851">byte</span><span class="op" id="5715855">(</span><span class="string" id="5715856">`&lt;a&nbsp;href=&#34;`</span><span class="op" id="5715867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715870">html_aq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715882">=</span>&nbsp;<span class="op" id="5715884">[</span><span class="op" id="5715885">]</span><span class="builtintype" id="5715886">byte</span><span class="op" id="5715890">(</span><span class="string" id="5715891">`&#34;&gt;`</span><span class="op" id="5715895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715898">html_enda</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5715910">=</span>&nbsp;<span class="op" id="5715912">[</span><span class="op" id="5715913">]</span><span class="builtintype" id="5715914">byte</span><span class="op" id="5715918">(</span><span class="string" id="5715919">&#34;&lt;/a&gt;&#34;</span><span class="op" id="5715925">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715928">html_i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715940">=</span>&nbsp;<span class="op" id="5715942">[</span><span class="op" id="5715943">]</span><span class="builtintype" id="5715944">byte</span><span class="op" id="5715948">(</span><span class="string" id="5715949">&#34;&lt;i&gt;&#34;</span><span class="op" id="5715954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715957">html_endi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5715969">=</span>&nbsp;<span class="op" id="5715971">[</span><span class="op" id="5715972">]</span><span class="builtintype" id="5715973">byte</span><span class="op" id="5715977">(</span><span class="string" id="5715978">&#34;&lt;/i&gt;&#34;</span><span class="op" id="5715984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715987">html_p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5715999">=</span>&nbsp;<span class="op" id="5716001">[</span><span class="op" id="5716002">]</span><span class="builtintype" id="5716003">byte</span><span class="op" id="5716007">(</span><span class="string" id="5716008">&#34;&lt;p&gt;\n&#34;</span><span class="op" id="5716015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716018">html_endp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5716030">=</span>&nbsp;<span class="op" id="5716032">[</span><span class="op" id="5716033">]</span><span class="builtintype" id="5716034">byte</span><span class="op" id="5716038">(</span><span class="string" id="5716039">&#34;&lt;/p&gt;\n&#34;</span><span class="op" id="5716047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716050">html_pre</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716062">=</span>&nbsp;<span class="op" id="5716064">[</span><span class="op" id="5716065">]</span><span class="builtintype" id="5716066">byte</span><span class="op" id="5716070">(</span><span class="string" id="5716071">&#34;&lt;pre&gt;&#34;</span><span class="op" id="5716078">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716081">html_endpre</span>&nbsp;<span class="op" id="5716093">=</span>&nbsp;<span class="op" id="5716095">[</span><span class="op" id="5716096">]</span><span class="builtintype" id="5716097">byte</span><span class="op" id="5716101">(</span><span class="string" id="5716102">&#34;&lt;/pre&gt;\n&#34;</span><span class="op" id="5716112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716115">html_h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716127">=</span>&nbsp;<span class="op" id="5716129">[</span><span class="op" id="5716130">]</span><span class="builtintype" id="5716131">byte</span><span class="op" id="5716135">(</span><span class="string" id="5716136">`&lt;h3&nbsp;id=&#34;`</span><span class="op" id="5716146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716149">html_hq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5716161">=</span>&nbsp;<span class="op" id="5716163">[</span><span class="op" id="5716164">]</span><span class="builtintype" id="5716165">byte</span><span class="op" id="5716169">(</span><span class="string" id="5716170">`&#34;&gt;`</span><span class="op" id="5716174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716177">html_endh</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5716189">=</span>&nbsp;<span class="op" id="5716191">[</span><span class="op" id="5716192">]</span><span class="builtintype" id="5716193">byte</span><span class="op" id="5716197">(</span><span class="string" id="5716198">&#34;&lt;/h3&gt;\n&#34;</span><span class="op" id="5716207">)</span><br>
<span class="lineno"></span><span class="op" id="5716209">)</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5716212">//&nbsp;pairedParensPrefixLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;longest&nbsp;prefix&nbsp;of&nbsp;s&nbsp;containing&nbsp;paired&nbsp;parentheses.</span><br>
<span class="lineno"></span><span class="keyword" id="5716314">func</span>&nbsp;<span class="ident" id="5716319">pairedParensPrefixLen</span><span class="op" id="5716340">(</span><span class="ident" id="5716341">s</span>&nbsp;<span class="builtintype" id="5716343">string</span><span class="op" id="5716349">)</span>&nbsp;<span class="builtintype" id="5716351">int</span>&nbsp;<span class="op" id="5716355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716358">parens</span>&nbsp;<span class="op" id="5716365">:=</span>&nbsp;<span class="num" id="5716368">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716371">l</span>&nbsp;<span class="op" id="5716373">:=</span>&nbsp;<span class="builtinfunc" id="5716376">len</span><span class="op" id="5716379">(</span><span class="ident" id="5716380"><a href="/go/doc/comment.go.html#5716341">s</a></span><span class="op" id="5716381">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716384">for</span>&nbsp;<span class="ident" id="5716388">i</span><span class="op" id="5716389">,</span>&nbsp;<span class="ident" id="5716391">ch</span>&nbsp;<span class="op" id="5716394">:=</span>&nbsp;<span class="keyword" id="5716397">range</span>&nbsp;<span class="ident" id="5716403"><a href="/go/doc/comment.go.html#5716341">s</a></span>&nbsp;<span class="op" id="5716405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716409">switch</span>&nbsp;<span class="ident" id="5716416"><a href="/go/doc/comment.go.html#5716391">ch</a></span>&nbsp;<span class="op" id="5716419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716423">case</span>&nbsp;<span class="string" id="5716428">&#39;(&#39;</span><span class="op" id="5716431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716436">if</span>&nbsp;<span class="ident" id="5716439"><a href="/go/doc/comment.go.html#5716358">parens</a></span>&nbsp;<span class="op" id="5716446">==</span>&nbsp;<span class="num" id="5716449">0</span>&nbsp;<span class="op" id="5716451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716457"><a href="/go/doc/comment.go.html#5716371">l</a></span>&nbsp;<span class="op" id="5716459">=</span>&nbsp;<span class="ident" id="5716461"><a href="/go/doc/comment.go.html#5716388">i</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716471"><a href="/go/doc/comment.go.html#5716358">parens</a></span><span class="op" id="5716477">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716482">case</span>&nbsp;<span class="string" id="5716487">&#39;)&#39;</span><span class="op" id="5716490">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716495"><a href="/go/doc/comment.go.html#5716358">parens</a></span><span class="op" id="5716501">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716507">if</span>&nbsp;<span class="ident" id="5716510"><a href="/go/doc/comment.go.html#5716358">parens</a></span>&nbsp;<span class="op" id="5716517">==</span>&nbsp;<span class="num" id="5716520">0</span>&nbsp;<span class="op" id="5716522">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716528"><a href="/go/doc/comment.go.html#5716371">l</a></span>&nbsp;<span class="op" id="5716530">=</span>&nbsp;<span class="builtinfunc" id="5716532">len</span><span class="op" id="5716535">(</span><span class="ident" id="5716536"><a href="/go/doc/comment.go.html#5716341">s</a></span><span class="op" id="5716537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716542">}</span>&nbsp;<span class="keyword" id="5716544">else</span>&nbsp;<span class="keyword" id="5716549">if</span>&nbsp;<span class="ident" id="5716552"><a href="/go/doc/comment.go.html#5716358">parens</a></span>&nbsp;<span class="op" id="5716559">&lt;</span>&nbsp;<span class="num" id="5716561">0</span>&nbsp;<span class="op" id="5716563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716569">return</span>&nbsp;<span class="ident" id="5716576"><a href="/go/doc/comment.go.html#5716388">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716585">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716591">return</span>&nbsp;<span class="ident" id="5716598"><a href="/go/doc/comment.go.html#5716371">l</a></span><br>
<span class="lineno"></span><span class="op" id="5716600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5716603">//&nbsp;Emphasize&nbsp;and&nbsp;escape&nbsp;a&nbsp;line&nbsp;of&nbsp;text&nbsp;for&nbsp;HTML.&nbsp;URLs&nbsp;are&nbsp;converted&nbsp;into&nbsp;links;</span><br>
<span class="lineno">100</span><span class="comment" id="5716683">//&nbsp;if&nbsp;the&nbsp;URL&nbsp;also&nbsp;appears&nbsp;in&nbsp;the&nbsp;words&nbsp;map,&nbsp;the&nbsp;link&nbsp;is&nbsp;taken&nbsp;from&nbsp;the&nbsp;map&nbsp;(if</span><br>
<span class="lineno"></span><span class="comment" id="5716763">//&nbsp;the&nbsp;corresponding&nbsp;map&nbsp;value&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;the&nbsp;URL&nbsp;is&nbsp;not&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="5716840">//&nbsp;into&nbsp;a&nbsp;link).&nbsp;Go&nbsp;identifiers&nbsp;that&nbsp;appear&nbsp;in&nbsp;the&nbsp;words&nbsp;map&nbsp;are&nbsp;italicized;&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5716920">//&nbsp;the&nbsp;corresponding&nbsp;map&nbsp;value&nbsp;is&nbsp;not&nbsp;the&nbsp;empty&nbsp;string,&nbsp;it&nbsp;is&nbsp;considered&nbsp;a&nbsp;URL</span><br>
<span class="lineno"></span><span class="comment" id="5716999">//&nbsp;and&nbsp;the&nbsp;word&nbsp;is&nbsp;converted&nbsp;into&nbsp;a&nbsp;link.&nbsp;If&nbsp;nice&nbsp;is&nbsp;set,&nbsp;the&nbsp;remaining&nbsp;text&#39;s</span><br>
<span class="lineno">105</span><span class="comment" id="5717078">//&nbsp;appearance&nbsp;is&nbsp;improved&nbsp;where&nbsp;it&nbsp;makes&nbsp;sense&nbsp;(e.g.,&nbsp;``&nbsp;is&nbsp;turned&nbsp;into&nbsp;&amp;ldquo;</span><br>
<span class="lineno"></span><span class="comment" id="5717158">//&nbsp;and&nbsp;&#39;&#39;&nbsp;into&nbsp;&amp;rdquo;).</span><br>
<span class="lineno"></span><span class="keyword" id="5717183">func</span>&nbsp;<span class="ident" id="5717188">emphasize</span><span class="op" id="5717197">(</span><span class="ident" id="5717198">w</span>&nbsp;<span class="ident" id="5717200"><a href="/go/doc/comment.go.html#5714606">io</a></span><span class="op" id="5717202">.</span><span class="ident" id="5717203">Writer</span><span class="op" id="5717209">,</span>&nbsp;<span class="ident" id="5717211">line</span>&nbsp;<span class="builtintype" id="5717216">string</span><span class="op" id="5717222">,</span>&nbsp;<span class="ident" id="5717224">words</span>&nbsp;<span class="keyword" id="5717230">map</span><span class="op" id="5717233">[</span><span class="builtintype" id="5717234">string</span><span class="op" id="5717240">]</span><span class="builtintype" id="5717241">string</span><span class="op" id="5717247">,</span>&nbsp;<span class="ident" id="5717249">nice</span>&nbsp;<span class="builtintype" id="5717254">bool</span><span class="op" id="5717258">)</span>&nbsp;<span class="op" id="5717260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717263">for</span>&nbsp;<span class="op" id="5717267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717271">m</span>&nbsp;<span class="op" id="5717273">:=</span>&nbsp;<span class="ident" id="5717276"><a href="/go/doc/comment.go.html#5715761">matchRx</a></span><span class="op" id="5717283">.</span><span class="ident" id="5717284">FindStringSubmatchIndex</span><span class="op" id="5717307">(</span><span class="ident" id="5717308"><a href="/go/doc/comment.go.html#5717211">line</a></span><span class="op" id="5717312">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717316">if</span>&nbsp;<span class="ident" id="5717319"><a href="/go/doc/comment.go.html#5717271">m</a></span>&nbsp;<span class="op" id="5717321">==</span>&nbsp;<span class="ident" id="5717324">nil</span>&nbsp;<span class="op" id="5717328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717333">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717345">//&nbsp;m&nbsp;&gt;=&nbsp;6&nbsp;(two&nbsp;parenthesized&nbsp;sub-regexps&nbsp;in&nbsp;matchRx,&nbsp;1st&nbsp;one&nbsp;is&nbsp;urlRx)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717419">//&nbsp;write&nbsp;text&nbsp;before&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717448"><a href="/go/doc/comment.go.html#5714864">commentEscape</a></span><span class="op" id="5717461">(</span><span class="ident" id="5717462"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5717463">,</span>&nbsp;<span class="ident" id="5717465"><a href="/go/doc/comment.go.html#5717211">line</a></span><span class="op" id="5717469">[</span><span class="num" id="5717470">0</span><span class="op" id="5717471">:</span><span class="ident" id="5717472"><a href="/go/doc/comment.go.html#5717271">m</a></span><span class="op" id="5717473">[</span><span class="num" id="5717474">0</span><span class="op" id="5717475">]</span><span class="op" id="5717476">]</span><span class="op" id="5717477">,</span>&nbsp;<span class="ident" id="5717479"><a href="/go/doc/comment.go.html#5717249">nice</a></span><span class="op" id="5717483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717488">//&nbsp;adjust&nbsp;match&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717519">match</span>&nbsp;<span class="op" id="5717525">:=</span>&nbsp;<span class="ident" id="5717528"><a href="/go/doc/comment.go.html#5717211">line</a></span><span class="op" id="5717532">[</span><span class="ident" id="5717533"><a href="/go/doc/comment.go.html#5717271">m</a></span><span class="op" id="5717534">[</span><span class="num" id="5717535">0</span><span class="op" id="5717536">]</span><span class="op" id="5717537">:</span><span class="ident" id="5717538"><a href="/go/doc/comment.go.html#5717271">m</a></span><span class="op" id="5717539">[</span><span class="num" id="5717540">1</span><span class="op" id="5717541">]</span><span class="op" id="5717542">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717546">if</span>&nbsp;<span class="ident" id="5717549">n</span>&nbsp;<span class="op" id="5717551">:=</span>&nbsp;<span class="ident" id="5717554"><a href="/go/doc/comment.go.html#5716319">pairedParensPrefixLen</a></span><span class="op" id="5717575">(</span><span class="ident" id="5717576"><a href="/go/doc/comment.go.html#5717519">match</a></span><span class="op" id="5717581">)</span><span class="op" id="5717582">;</span>&nbsp;<span class="ident" id="5717584"><a href="/go/doc/comment.go.html#5717549">n</a></span>&nbsp;<span class="op" id="5717586">&lt;</span>&nbsp;<span class="builtinfunc" id="5717588">len</span><span class="op" id="5717591">(</span><span class="ident" id="5717592"><a href="/go/doc/comment.go.html#5717519">match</a></span><span class="op" id="5717597">)</span>&nbsp;<span class="op" id="5717599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717604">//&nbsp;match&nbsp;contains&nbsp;unpaired&nbsp;parentheses&nbsp;(rare);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717654">//&nbsp;redo&nbsp;matching&nbsp;with&nbsp;shortened&nbsp;line&nbsp;for&nbsp;correct&nbsp;indices</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717714"><a href="/go/doc/comment.go.html#5717271">m</a></span>&nbsp;<span class="op" id="5717716">=</span>&nbsp;<span class="ident" id="5717718"><a href="/go/doc/comment.go.html#5715761">matchRx</a></span><span class="op" id="5717725">.</span><span class="ident" id="5717726">FindStringSubmatchIndex</span><span class="op" id="5717749">(</span><span class="ident" id="5717750"><a href="/go/doc/comment.go.html#5717211">line</a></span><span class="op" id="5717754">[</span><span class="op" id="5717755">:</span><span class="ident" id="5717756"><a href="/go/doc/comment.go.html#5717271">m</a></span><span class="op" id="5717757">[</span><span class="num" id="5717758">0</span><span class="op" id="5717759">]</span><span class="op" id="5717760">+</span><span class="ident" id="5717761"><a href="/go/doc/comment.go.html#5717549">n</a></span><span class="op" id="5717762">]</span><span class="op" id="5717763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717768"><a href="/go/doc/comment.go.html#5717519">match</a></span>&nbsp;<span class="op" id="5717774">=</span>&nbsp;<span class="ident" id="5717776"><a href="/go/doc/comment.go.html#5717519">match</a></span><span class="op" id="5717781">[</span><span class="op" id="5717782">:</span><span class="ident" id="5717783"><a href="/go/doc/comment.go.html#5717549">n</a></span><span class="op" id="5717784">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717793">//&nbsp;analyze&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717812">url</span>&nbsp;<span class="op" id="5717816">:=</span>&nbsp;<span class="string" id="5717819">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717824">italics</span>&nbsp;<span class="op" id="5717832">:=</span>&nbsp;<span class="builtintype" id="5717835">false</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717843">if</span>&nbsp;<span class="ident" id="5717846"><a href="/go/doc/comment.go.html#5717224">words</a></span>&nbsp;<span class="op" id="5717852">!=</span>&nbsp;<span class="ident" id="5717855">nil</span>&nbsp;<span class="op" id="5717859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717864"><a href="/go/doc/comment.go.html#5717812">url</a></span><span class="op" id="5717867">,</span>&nbsp;<span class="ident" id="5717869"><a href="/go/doc/comment.go.html#5717824">italics</a></span>&nbsp;<span class="op" id="5717877">=</span>&nbsp;<span class="ident" id="5717879"><a href="/go/doc/comment.go.html#5717224">words</a></span><span class="op" id="5717884">[</span><span class="ident" id="5717885"><a href="/go/doc/comment.go.html#5717519">match</a></span><span class="op" id="5717890">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717898">if</span>&nbsp;<span class="ident" id="5717901"><a href="/go/doc/comment.go.html#5717271">m</a></span><span class="op" id="5717902">[</span><span class="num" id="5717903">2</span><span class="op" id="5717904">]</span>&nbsp;<span class="op" id="5717906">&gt;=</span>&nbsp;<span class="num" id="5717909">0</span>&nbsp;<span class="op" id="5717911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5717916">//&nbsp;match&nbsp;against&nbsp;first&nbsp;parenthesized&nbsp;sub-regexp;&nbsp;must&nbsp;be&nbsp;match&nbsp;against&nbsp;urlRx</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717996">if</span>&nbsp;<span class="op" id="5717999">!</span><span class="ident" id="5718000"><a href="/go/doc/comment.go.html#5717824">italics</a></span>&nbsp;<span class="op" id="5718008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718014">//&nbsp;no&nbsp;alternative&nbsp;URL&nbsp;in&nbsp;words&nbsp;list,&nbsp;use&nbsp;match&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718073"><a href="/go/doc/comment.go.html#5717812">url</a></span>&nbsp;<span class="op" id="5718077">=</span>&nbsp;<span class="ident" id="5718079"><a href="/go/doc/comment.go.html#5717519">match</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718093"><a href="/go/doc/comment.go.html#5717824">italics</a></span>&nbsp;<span class="op" id="5718101">=</span>&nbsp;<span class="builtintype" id="5718103">false</span>&nbsp;<span class="comment" id="5718109">//&nbsp;don&#39;t&nbsp;italicize&nbsp;URLs</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718140">//&nbsp;write&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718157">if</span>&nbsp;<span class="builtinfunc" id="5718160">len</span><span class="op" id="5718163">(</span><span class="ident" id="5718164"><a href="/go/doc/comment.go.html#5717812">url</a></span><span class="op" id="5718167">)</span>&nbsp;<span class="op" id="5718169">&gt;</span>&nbsp;<span class="num" id="5718171">0</span>&nbsp;<span class="op" id="5718173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718178"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718179">.</span><span class="ident" id="5718180">Write</span><span class="op" id="5718185">(</span><span class="ident" id="5718186"><a href="/go/doc/comment.go.html#5715835">html_a</a></span><span class="op" id="5718192">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718197"><a href="/go/doc/comment.go.html#5714633">template</a></span><span class="op" id="5718205">.</span><span class="ident" id="5718206">HTMLEscape</span><span class="op" id="5718216">(</span><span class="ident" id="5718217"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718218">,</span>&nbsp;<span class="op" id="5718220">[</span><span class="op" id="5718221">]</span><span class="builtintype" id="5718222">byte</span><span class="op" id="5718226">(</span><span class="ident" id="5718227"><a href="/go/doc/comment.go.html#5717812">url</a></span><span class="op" id="5718230">)</span><span class="op" id="5718231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718236"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718237">.</span><span class="ident" id="5718238">Write</span><span class="op" id="5718243">(</span><span class="ident" id="5718244"><a href="/go/doc/comment.go.html#5715870">html_aq</a></span><span class="op" id="5718251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718259">if</span>&nbsp;<span class="ident" id="5718262"><a href="/go/doc/comment.go.html#5717824">italics</a></span>&nbsp;<span class="op" id="5718270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718275"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718276">.</span><span class="ident" id="5718277">Write</span><span class="op" id="5718282">(</span><span class="ident" id="5718283"><a href="/go/doc/comment.go.html#5715928">html_i</a></span><span class="op" id="5718289">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718297"><a href="/go/doc/comment.go.html#5714864">commentEscape</a></span><span class="op" id="5718310">(</span><span class="ident" id="5718311"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718312">,</span>&nbsp;<span class="ident" id="5718314"><a href="/go/doc/comment.go.html#5717519">match</a></span><span class="op" id="5718319">,</span>&nbsp;<span class="ident" id="5718321"><a href="/go/doc/comment.go.html#5717249">nice</a></span><span class="op" id="5718325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718329">if</span>&nbsp;<span class="ident" id="5718332"><a href="/go/doc/comment.go.html#5717824">italics</a></span>&nbsp;<span class="op" id="5718340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718345"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718346">.</span><span class="ident" id="5718347">Write</span><span class="op" id="5718352">(</span><span class="ident" id="5718353"><a href="/go/doc/comment.go.html#5715957">html_endi</a></span><span class="op" id="5718362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718366">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718370">if</span>&nbsp;<span class="builtinfunc" id="5718373">len</span><span class="op" id="5718376">(</span><span class="ident" id="5718377"><a href="/go/doc/comment.go.html#5717812">url</a></span><span class="op" id="5718380">)</span>&nbsp;<span class="op" id="5718382">&gt;</span>&nbsp;<span class="num" id="5718384">0</span>&nbsp;<span class="op" id="5718386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718391"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718392">.</span><span class="ident" id="5718393">Write</span><span class="op" id="5718398">(</span><span class="ident" id="5718399"><a href="/go/doc/comment.go.html#5715898">html_enda</a></span><span class="op" id="5718408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718417">//&nbsp;advance</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718430"><a href="/go/doc/comment.go.html#5717211">line</a></span>&nbsp;<span class="op" id="5718435">=</span>&nbsp;<span class="ident" id="5718437"><a href="/go/doc/comment.go.html#5717211">line</a></span><span class="op" id="5718441">[</span><span class="ident" id="5718442"><a href="/go/doc/comment.go.html#5717271">m</a></span><span class="op" id="5718443">[</span><span class="num" id="5718444">1</span><span class="op" id="5718445">]</span><span class="op" id="5718446">:</span><span class="op" id="5718447">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718453"><a href="/go/doc/comment.go.html#5714864">commentEscape</a></span><span class="op" id="5718466">(</span><span class="ident" id="5718467"><a href="/go/doc/comment.go.html#5717198">w</a></span><span class="op" id="5718468">,</span>&nbsp;<span class="ident" id="5718470"><a href="/go/doc/comment.go.html#5717211">line</a></span><span class="op" id="5718474">,</span>&nbsp;<span class="ident" id="5718476"><a href="/go/doc/comment.go.html#5717249">nice</a></span><span class="op" id="5718480">)</span><br>
<span class="lineno"></span><span class="op" id="5718482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5718485">func</span>&nbsp;<span class="ident" id="5718490">indentLen</span><span class="op" id="5718499">(</span><span class="ident" id="5718500">s</span>&nbsp;<span class="builtintype" id="5718502">string</span><span class="op" id="5718508">)</span>&nbsp;<span class="builtintype" id="5718510">int</span>&nbsp;<span class="op" id="5718514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718517">i</span>&nbsp;<span class="op" id="5718519">:=</span>&nbsp;<span class="num" id="5718522">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718525">for</span>&nbsp;<span class="ident" id="5718529"><a href="/go/doc/comment.go.html#5718517">i</a></span>&nbsp;<span class="op" id="5718531">&lt;</span>&nbsp;<span class="builtinfunc" id="5718533">len</span><span class="op" id="5718536">(</span><span class="ident" id="5718537"><a href="/go/doc/comment.go.html#5718500">s</a></span><span class="op" id="5718538">)</span>&nbsp;<span class="op" id="5718540">&amp;&amp;</span>&nbsp;<span class="op" id="5718543">(</span><span class="ident" id="5718544"><a href="/go/doc/comment.go.html#5718500">s</a></span><span class="op" id="5718545">[</span><span class="ident" id="5718546"><a href="/go/doc/comment.go.html#5718517">i</a></span><span class="op" id="5718547">]</span>&nbsp;<span class="op" id="5718549">==</span>&nbsp;<span class="string" id="5718552">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5718556">||</span>&nbsp;<span class="ident" id="5718559"><a href="/go/doc/comment.go.html#5718500">s</a></span><span class="op" id="5718560">[</span><span class="ident" id="5718561"><a href="/go/doc/comment.go.html#5718517">i</a></span><span class="op" id="5718562">]</span>&nbsp;<span class="op" id="5718564">==</span>&nbsp;<span class="string" id="5718567">&#39;\t&#39;</span><span class="op" id="5718571">)</span>&nbsp;<span class="op" id="5718573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718577"><a href="/go/doc/comment.go.html#5718517">i</a></span><span class="op" id="5718578">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718582">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718585">return</span>&nbsp;<span class="ident" id="5718592"><a href="/go/doc/comment.go.html#5718517">i</a></span><br>
<span class="lineno"></span><span class="op" id="5718594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5718597">func</span>&nbsp;<span class="ident" id="5718602">isBlank</span><span class="op" id="5718609">(</span><span class="ident" id="5718610">s</span>&nbsp;<span class="builtintype" id="5718612">string</span><span class="op" id="5718618">)</span>&nbsp;<span class="builtintype" id="5718620">bool</span>&nbsp;<span class="op" id="5718625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718628">return</span>&nbsp;<span class="builtinfunc" id="5718635">len</span><span class="op" id="5718638">(</span><span class="ident" id="5718639"><a href="/go/doc/comment.go.html#5718610">s</a></span><span class="op" id="5718640">)</span>&nbsp;<span class="op" id="5718642">==</span>&nbsp;<span class="num" id="5718645">0</span>&nbsp;<span class="op" id="5718647">||</span>&nbsp;<span class="op" id="5718650">(</span><span class="builtinfunc" id="5718651">len</span><span class="op" id="5718654">(</span><span class="ident" id="5718655"><a href="/go/doc/comment.go.html#5718610">s</a></span><span class="op" id="5718656">)</span>&nbsp;<span class="op" id="5718658">==</span>&nbsp;<span class="num" id="5718661">1</span>&nbsp;<span class="op" id="5718663">&amp;&amp;</span>&nbsp;<span class="ident" id="5718666"><a href="/go/doc/comment.go.html#5718610">s</a></span><span class="op" id="5718667">[</span><span class="num" id="5718668">0</span><span class="op" id="5718669">]</span>&nbsp;<span class="op" id="5718671">==</span>&nbsp;<span class="string" id="5718674">&#39;\n&#39;</span><span class="op" id="5718678">)</span><br>
<span class="lineno">175</span><span class="op" id="5718680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5718683">func</span>&nbsp;<span class="ident" id="5718688">commonPrefix</span><span class="op" id="5718700">(</span><span class="ident" id="5718701">a</span><span class="op" id="5718702">,</span>&nbsp;<span class="ident" id="5718704">b</span>&nbsp;<span class="builtintype" id="5718706">string</span><span class="op" id="5718712">)</span>&nbsp;<span class="builtintype" id="5718714">string</span>&nbsp;<span class="op" id="5718721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718724">i</span>&nbsp;<span class="op" id="5718726">:=</span>&nbsp;<span class="num" id="5718729">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718732">for</span>&nbsp;<span class="ident" id="5718736"><a href="/go/doc/comment.go.html#5718724">i</a></span>&nbsp;<span class="op" id="5718738">&lt;</span>&nbsp;<span class="builtinfunc" id="5718740">len</span><span class="op" id="5718743">(</span><span class="ident" id="5718744"><a href="/go/doc/comment.go.html#5718701">a</a></span><span class="op" id="5718745">)</span>&nbsp;<span class="op" id="5718747">&amp;&amp;</span>&nbsp;<span class="ident" id="5718750"><a href="/go/doc/comment.go.html#5718724">i</a></span>&nbsp;<span class="op" id="5718752">&lt;</span>&nbsp;<span class="builtinfunc" id="5718754">len</span><span class="op" id="5718757">(</span><span class="ident" id="5718758"><a href="/go/doc/comment.go.html#5718704">b</a></span><span class="op" id="5718759">)</span>&nbsp;<span class="op" id="5718761">&amp;&amp;</span>&nbsp;<span class="ident" id="5718764"><a href="/go/doc/comment.go.html#5718701">a</a></span><span class="op" id="5718765">[</span><span class="ident" id="5718766"><a href="/go/doc/comment.go.html#5718724">i</a></span><span class="op" id="5718767">]</span>&nbsp;<span class="op" id="5718769">==</span>&nbsp;<span class="ident" id="5718772"><a href="/go/doc/comment.go.html#5718704">b</a></span><span class="op" id="5718773">[</span><span class="ident" id="5718774"><a href="/go/doc/comment.go.html#5718724">i</a></span><span class="op" id="5718775">]</span>&nbsp;<span class="op" id="5718777">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718781"><a href="/go/doc/comment.go.html#5718724">i</a></span><span class="op" id="5718782">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718789">return</span>&nbsp;<span class="ident" id="5718796"><a href="/go/doc/comment.go.html#5718701">a</a></span><span class="op" id="5718797">[</span><span class="num" id="5718798">0</span><span class="op" id="5718799">:</span><span class="ident" id="5718800"><a href="/go/doc/comment.go.html#5718724">i</a></span><span class="op" id="5718801">]</span><br>
<span class="lineno"></span><span class="op" id="5718803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="5718806">func</span>&nbsp;<span class="ident" id="5718811">unindent</span><span class="op" id="5718819">(</span><span class="ident" id="5718820">block</span>&nbsp;<span class="op" id="5718826">[</span><span class="op" id="5718827">]</span><span class="builtintype" id="5718828">string</span><span class="op" id="5718834">)</span>&nbsp;<span class="op" id="5718836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718839">if</span>&nbsp;<span class="builtinfunc" id="5718842">len</span><span class="op" id="5718845">(</span><span class="ident" id="5718846"><a href="/go/doc/comment.go.html#5718820">block</a></span><span class="op" id="5718851">)</span>&nbsp;<span class="op" id="5718853">==</span>&nbsp;<span class="num" id="5718856">0</span>&nbsp;<span class="op" id="5718858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718862">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5718874">//&nbsp;compute&nbsp;maximum&nbsp;common&nbsp;white&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718914">prefix</span>&nbsp;<span class="op" id="5718921">:=</span>&nbsp;<span class="ident" id="5718924"><a href="/go/doc/comment.go.html#5718820">block</a></span><span class="op" id="5718929">[</span><span class="num" id="5718930">0</span><span class="op" id="5718931">]</span><span class="op" id="5718932">[</span><span class="num" id="5718933">0</span><span class="op" id="5718934">:</span><span class="ident" id="5718935"><a href="/go/doc/comment.go.html#5718490">indentLen</a></span><span class="op" id="5718944">(</span><span class="ident" id="5718945"><a href="/go/doc/comment.go.html#5718820">block</a></span><span class="op" id="5718950">[</span><span class="num" id="5718951">0</span><span class="op" id="5718952">]</span><span class="op" id="5718953">)</span><span class="op" id="5718954">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718957">for</span>&nbsp;<span class="ident" id="5718961">_</span><span class="op" id="5718962">,</span>&nbsp;<span class="ident" id="5718964">line</span>&nbsp;<span class="op" id="5718969">:=</span>&nbsp;<span class="keyword" id="5718972">range</span>&nbsp;<span class="ident" id="5718978"><a href="/go/doc/comment.go.html#5718820">block</a></span>&nbsp;<span class="op" id="5718984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718988">if</span>&nbsp;<span class="op" id="5718991">!</span><span class="ident" id="5718992"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5718999">(</span><span class="ident" id="5719000"><a href="/go/doc/comment.go.html#5718964">line</a></span><span class="op" id="5719004">)</span>&nbsp;<span class="op" id="5719006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719011"><a href="/go/doc/comment.go.html#5718914">prefix</a></span>&nbsp;<span class="op" id="5719018">=</span>&nbsp;<span class="ident" id="5719020"><a href="/go/doc/comment.go.html#5718688">commonPrefix</a></span><span class="op" id="5719032">(</span><span class="ident" id="5719033"><a href="/go/doc/comment.go.html#5718914">prefix</a></span><span class="op" id="5719039">,</span>&nbsp;<span class="ident" id="5719041"><a href="/go/doc/comment.go.html#5718964">line</a></span><span class="op" id="5719045">[</span><span class="num" id="5719046">0</span><span class="op" id="5719047">:</span><span class="ident" id="5719048"><a href="/go/doc/comment.go.html#5718490">indentLen</a></span><span class="op" id="5719057">(</span><span class="ident" id="5719058"><a href="/go/doc/comment.go.html#5718964">line</a></span><span class="op" id="5719062">)</span><span class="op" id="5719063">]</span><span class="op" id="5719064">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719074">n</span>&nbsp;<span class="op" id="5719076">:=</span>&nbsp;<span class="builtinfunc" id="5719079">len</span><span class="op" id="5719082">(</span><span class="ident" id="5719083"><a href="/go/doc/comment.go.html#5718914">prefix</a></span><span class="op" id="5719089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719093">//&nbsp;remove</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719104">for</span>&nbsp;<span class="ident" id="5719108">i</span><span class="op" id="5719109">,</span>&nbsp;<span class="ident" id="5719111">line</span>&nbsp;<span class="op" id="5719116">:=</span>&nbsp;<span class="keyword" id="5719119">range</span>&nbsp;<span class="ident" id="5719125"><a href="/go/doc/comment.go.html#5718820">block</a></span>&nbsp;<span class="op" id="5719131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719135">if</span>&nbsp;<span class="op" id="5719138">!</span><span class="ident" id="5719139"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5719146">(</span><span class="ident" id="5719147"><a href="/go/doc/comment.go.html#5719111">line</a></span><span class="op" id="5719151">)</span>&nbsp;<span class="op" id="5719153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719158"><a href="/go/doc/comment.go.html#5718820">block</a></span><span class="op" id="5719163">[</span><span class="ident" id="5719164"><a href="/go/doc/comment.go.html#5719108">i</a></span><span class="op" id="5719165">]</span>&nbsp;<span class="op" id="5719167">=</span>&nbsp;<span class="ident" id="5719169"><a href="/go/doc/comment.go.html#5719111">line</a></span><span class="op" id="5719173">[</span><span class="ident" id="5719174"><a href="/go/doc/comment.go.html#5719074">n</a></span><span class="op" id="5719175">:</span><span class="op" id="5719176">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719183">}</span><br>
<span class="lineno">205</span><span class="op" id="5719185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5719188">//&nbsp;heading&nbsp;returns&nbsp;the&nbsp;trimmed&nbsp;line&nbsp;if&nbsp;it&nbsp;passes&nbsp;as&nbsp;a&nbsp;section&nbsp;heading;</span><br>
<span class="lineno"></span><span class="comment" id="5719259">//&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5719301">func</span>&nbsp;<span class="ident" id="5719306">heading</span><span class="op" id="5719313">(</span><span class="ident" id="5719314">line</span>&nbsp;<span class="builtintype" id="5719319">string</span><span class="op" id="5719325">)</span>&nbsp;<span class="builtintype" id="5719327">string</span>&nbsp;<span class="op" id="5719334">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719337"><a href="/go/doc/comment.go.html#5719314">line</a></span>&nbsp;<span class="op" id="5719342">=</span>&nbsp;<span class="ident" id="5719344"><a href="/go/doc/comment.go.html#5714622">strings</a></span><span class="op" id="5719351">.</span><span class="ident" id="5719352">TrimSpace</span><span class="op" id="5719361">(</span><span class="ident" id="5719362"><a href="/go/doc/comment.go.html#5719314">line</a></span><span class="op" id="5719366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719369">if</span>&nbsp;<span class="builtinfunc" id="5719372">len</span><span class="op" id="5719375">(</span><span class="ident" id="5719376"><a href="/go/doc/comment.go.html#5719314">line</a></span><span class="op" id="5719380">)</span>&nbsp;<span class="op" id="5719382">==</span>&nbsp;<span class="num" id="5719385">0</span>&nbsp;<span class="op" id="5719387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719391">return</span>&nbsp;<span class="string" id="5719398">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719406">//&nbsp;a&nbsp;heading&nbsp;must&nbsp;start&nbsp;with&nbsp;an&nbsp;uppercase&nbsp;letter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719456">r</span><span class="op" id="5719457">,</span>&nbsp;<span class="ident" id="5719459">_</span>&nbsp;<span class="op" id="5719461">:=</span>&nbsp;<span class="ident" id="5719464"><a href="/go/doc/comment.go.html#5714679">utf8</a></span><span class="op" id="5719468">.</span><span class="ident" id="5719469">DecodeRuneInString</span><span class="op" id="5719487">(</span><span class="ident" id="5719488"><a href="/go/doc/comment.go.html#5719314">line</a></span><span class="op" id="5719492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719495">if</span>&nbsp;<span class="op" id="5719498">!</span><span class="ident" id="5719499"><a href="/go/doc/comment.go.html#5714668">unicode</a></span><span class="op" id="5719506">.</span><span class="ident" id="5719507">IsLetter</span><span class="op" id="5719515">(</span><span class="ident" id="5719516"><a href="/go/doc/comment.go.html#5719456">r</a></span><span class="op" id="5719517">)</span>&nbsp;<span class="op" id="5719519">||</span>&nbsp;<span class="op" id="5719522">!</span><span class="ident" id="5719523"><a href="/go/doc/comment.go.html#5714668">unicode</a></span><span class="op" id="5719530">.</span><span class="ident" id="5719531">IsUpper</span><span class="op" id="5719538">(</span><span class="ident" id="5719539"><a href="/go/doc/comment.go.html#5719456">r</a></span><span class="op" id="5719540">)</span>&nbsp;<span class="op" id="5719542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719546">return</span>&nbsp;<span class="string" id="5719553">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719557">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719561">//&nbsp;it&nbsp;must&nbsp;end&nbsp;in&nbsp;a&nbsp;letter&nbsp;or&nbsp;digit:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719599"><a href="/go/doc/comment.go.html#5719456">r</a></span><span class="op" id="5719600">,</span>&nbsp;<span class="ident" id="5719602">_</span>&nbsp;<span class="op" id="5719604">=</span>&nbsp;<span class="ident" id="5719606"><a href="/go/doc/comment.go.html#5714679">utf8</a></span><span class="op" id="5719610">.</span><span class="ident" id="5719611">DecodeLastRuneInString</span><span class="op" id="5719633">(</span><span class="ident" id="5719634"><a href="/go/doc/comment.go.html#5719314">line</a></span><span class="op" id="5719638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719641">if</span>&nbsp;<span class="op" id="5719644">!</span><span class="ident" id="5719645"><a href="/go/doc/comment.go.html#5714668">unicode</a></span><span class="op" id="5719652">.</span><span class="ident" id="5719653">IsLetter</span><span class="op" id="5719661">(</span><span class="ident" id="5719662"><a href="/go/doc/comment.go.html#5719456">r</a></span><span class="op" id="5719663">)</span>&nbsp;<span class="op" id="5719665">&amp;&amp;</span>&nbsp;<span class="op" id="5719668">!</span><span class="ident" id="5719669"><a href="/go/doc/comment.go.html#5714668">unicode</a></span><span class="op" id="5719676">.</span><span class="ident" id="5719677">IsDigit</span><span class="op" id="5719684">(</span><span class="ident" id="5719685"><a href="/go/doc/comment.go.html#5719456">r</a></span><span class="op" id="5719686">)</span>&nbsp;<span class="op" id="5719688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719692">return</span>&nbsp;<span class="string" id="5719699">&#34;&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719707">//&nbsp;exclude&nbsp;lines&nbsp;with&nbsp;illegal&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719749">if</span>&nbsp;<span class="ident" id="5719752"><a href="/go/doc/comment.go.html#5714622">strings</a></span><span class="op" id="5719759">.</span><span class="ident" id="5719760">IndexAny</span><span class="op" id="5719768">(</span><span class="ident" id="5719769"><a href="/go/doc/comment.go.html#5719314">line</a></span><span class="op" id="5719773">,</span>&nbsp;<span class="string" id="5719775">&#34;,.;:!?+*/=()[]{}_^&amp;~%#@&lt;\&#34;&gt;\\&#34;</span><span class="op" id="5719810">)</span>&nbsp;<span class="op" id="5719812">&gt;=</span>&nbsp;<span class="num" id="5719815">0</span>&nbsp;<span class="op" id="5719817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719821">return</span>&nbsp;<span class="string" id="5719828">&#34;&#34;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719836">//&nbsp;allow&nbsp;&#34;&#39;&#34;&nbsp;for&nbsp;possessive&nbsp;&#34;&#39;s&#34;&nbsp;only</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719875">for</span>&nbsp;<span class="ident" id="5719879">b</span>&nbsp;<span class="op" id="5719881">:=</span>&nbsp;<span class="ident" id="5719884"><a href="/go/doc/comment.go.html#5719314">line</a></span><span class="op" id="5719888">;</span>&nbsp;<span class="op" id="5719890">;</span>&nbsp;<span class="op" id="5719892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719896">i</span>&nbsp;<span class="op" id="5719898">:=</span>&nbsp;<span class="ident" id="5719901"><a href="/go/doc/comment.go.html#5714622">strings</a></span><span class="op" id="5719908">.</span><span class="ident" id="5719909">IndexRune</span><span class="op" id="5719918">(</span><span class="ident" id="5719919"><a href="/go/doc/comment.go.html#5719879">b</a></span><span class="op" id="5719920">,</span>&nbsp;<span class="string" id="5719922">&#39;\&#39;&#39;</span><span class="op" id="5719926">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719930">if</span>&nbsp;<span class="ident" id="5719933"><a href="/go/doc/comment.go.html#5719896">i</a></span>&nbsp;<span class="op" id="5719935">&lt;</span>&nbsp;<span class="num" id="5719937">0</span>&nbsp;<span class="op" id="5719939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719944">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719956">if</span>&nbsp;<span class="ident" id="5719959"><a href="/go/doc/comment.go.html#5719896">i</a></span><span class="op" id="5719960">+</span><span class="num" id="5719961">1</span>&nbsp;<span class="op" id="5719963">&gt;=</span>&nbsp;<span class="builtinfunc" id="5719966">len</span><span class="op" id="5719969">(</span><span class="ident" id="5719970"><a href="/go/doc/comment.go.html#5719879">b</a></span><span class="op" id="5719971">)</span>&nbsp;<span class="op" id="5719973">||</span>&nbsp;<span class="ident" id="5719976"><a href="/go/doc/comment.go.html#5719879">b</a></span><span class="op" id="5719977">[</span><span class="ident" id="5719978"><a href="/go/doc/comment.go.html#5719896">i</a></span><span class="op" id="5719979">+</span><span class="num" id="5719980">1</span><span class="op" id="5719981">]</span>&nbsp;<span class="op" id="5719983">!=</span>&nbsp;<span class="string" id="5719986">&#39;s&#39;</span>&nbsp;<span class="op" id="5719990">||</span>&nbsp;<span class="op" id="5719993">(</span><span class="ident" id="5719994"><a href="/go/doc/comment.go.html#5719896">i</a></span><span class="op" id="5719995">+</span><span class="num" id="5719996">2</span>&nbsp;<span class="op" id="5719998">&lt;</span>&nbsp;<span class="builtinfunc" id="5720000">len</span><span class="op" id="5720003">(</span><span class="ident" id="5720004"><a href="/go/doc/comment.go.html#5719879">b</a></span><span class="op" id="5720005">)</span>&nbsp;<span class="op" id="5720007">&amp;&amp;</span>&nbsp;<span class="ident" id="5720010"><a href="/go/doc/comment.go.html#5719879">b</a></span><span class="op" id="5720011">[</span><span class="ident" id="5720012"><a href="/go/doc/comment.go.html#5719896">i</a></span><span class="op" id="5720013">+</span><span class="num" id="5720014">2</span><span class="op" id="5720015">]</span>&nbsp;<span class="op" id="5720017">!=</span>&nbsp;<span class="string" id="5720020">&#39;&nbsp;&#39;</span><span class="op" id="5720023">)</span>&nbsp;<span class="op" id="5720025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720030">return</span>&nbsp;<span class="string" id="5720037">&#34;&#34;</span>&nbsp;<span class="comment" id="5720040">//&nbsp;not&nbsp;followed&nbsp;by&nbsp;&#34;s&nbsp;&#34;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720070"><a href="/go/doc/comment.go.html#5719879">b</a></span>&nbsp;<span class="op" id="5720072">=</span>&nbsp;<span class="ident" id="5720074"><a href="/go/doc/comment.go.html#5719879">b</a></span><span class="op" id="5720075">[</span><span class="ident" id="5720076"><a href="/go/doc/comment.go.html#5719896">i</a></span><span class="op" id="5720077">+</span><span class="num" id="5720078">2</span><span class="op" id="5720079">:</span><span class="op" id="5720080">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720087">return</span>&nbsp;<span class="ident" id="5720094"><a href="/go/doc/comment.go.html#5719314">line</a></span><br>
<span class="lineno">245</span><span class="op" id="5720099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5720102">type</span>&nbsp;<span class="ident" id="5720107">op</span>&nbsp;<span class="builtintype" id="5720110">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5720115">const</span>&nbsp;<span class="op" id="5720121">(</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720124">opPara</span>&nbsp;<span class="ident" id="5720131"><a href="/go/doc/comment.go.html#5720107">op</a></span>&nbsp;<span class="op" id="5720134">=</span>&nbsp;<span class="ident" id="5720136">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720142">opHead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720150">opPre</span><br>
<span class="lineno"></span><span class="op" id="5720156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="5720159">type</span>&nbsp;<span class="ident" id="5720164">block</span>&nbsp;<span class="keyword" id="5720170">struct</span>&nbsp;<span class="op" id="5720177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720180">op</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5720186"><a href="/go/doc/comment.go.html#5720107">op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720190">lines</span>&nbsp;<span class="op" id="5720196">[</span><span class="op" id="5720197">]</span><span class="builtintype" id="5720198">string</span><br>
<span class="lineno"></span><span class="op" id="5720205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="5720208">var</span>&nbsp;<span class="ident" id="5720212">nonAlphaNumRx</span>&nbsp;<span class="op" id="5720226">=</span>&nbsp;<span class="ident" id="5720228"><a href="/go/doc/comment.go.html#5714612">regexp</a></span><span class="op" id="5720234">.</span><span class="ident" id="5720235">MustCompile</span><span class="op" id="5720246">(</span><span class="string" id="5720247">`[^a-zA-Z0-9]`</span><span class="op" id="5720261">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5720264">func</span>&nbsp;<span class="ident" id="5720269">anchorID</span><span class="op" id="5720277">(</span><span class="ident" id="5720278">line</span>&nbsp;<span class="builtintype" id="5720283">string</span><span class="op" id="5720289">)</span>&nbsp;<span class="builtintype" id="5720291">string</span>&nbsp;<span class="op" id="5720298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5720301">//&nbsp;Add&nbsp;a&nbsp;&#34;hdr-&#34;&nbsp;prefix&nbsp;to&nbsp;avoid&nbsp;conflicting&nbsp;with&nbsp;IDs&nbsp;used&nbsp;for&nbsp;package&nbsp;symbols.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720381">return</span>&nbsp;<span class="string" id="5720388">&#34;hdr-&#34;</span>&nbsp;<span class="op" id="5720395">+</span>&nbsp;<span class="ident" id="5720397"><a href="/go/doc/comment.go.html#5720212">nonAlphaNumRx</a></span><span class="op" id="5720410">.</span><span class="ident" id="5720411">ReplaceAllString</span><span class="op" id="5720427">(</span><span class="ident" id="5720428"><a href="/go/doc/comment.go.html#5720278">line</a></span><span class="op" id="5720432">,</span>&nbsp;<span class="string" id="5720434">&#34;_&#34;</span><span class="op" id="5720437">)</span><br>
<span class="lineno">265</span><span class="op" id="5720439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5720442">//&nbsp;ToHTML&nbsp;converts&nbsp;comment&nbsp;text&nbsp;to&nbsp;formatted&nbsp;HTML.</span><br>
<span class="lineno"></span><span class="comment" id="5720493">//&nbsp;The&nbsp;comment&nbsp;was&nbsp;prepared&nbsp;by&nbsp;DocReader,</span><br>
<span class="lineno"></span><span class="comment" id="5720535">//&nbsp;so&nbsp;it&nbsp;is&nbsp;known&nbsp;not&nbsp;to&nbsp;have&nbsp;leading,&nbsp;trailing&nbsp;blank&nbsp;lines</span><br>
<span class="lineno">270</span><span class="comment" id="5720595">//&nbsp;nor&nbsp;to&nbsp;have&nbsp;trailing&nbsp;spaces&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;lines.</span><br>
<span class="lineno"></span><span class="comment" id="5720647">//&nbsp;The&nbsp;comment&nbsp;markers&nbsp;have&nbsp;already&nbsp;been&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="5720697">//</span><br>
<span class="lineno"></span><span class="comment" id="5720700">//&nbsp;Each&nbsp;span&nbsp;of&nbsp;unindented&nbsp;non-blank&nbsp;lines&nbsp;is&nbsp;converted&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="5720761">//&nbsp;a&nbsp;single&nbsp;paragraph.&nbsp;There&nbsp;is&nbsp;one&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule:&nbsp;a&nbsp;span&nbsp;that</span><br>
<span class="lineno">275</span><span class="comment" id="5720832">//&nbsp;consists&nbsp;of&nbsp;a&nbsp;single&nbsp;line,&nbsp;is&nbsp;followed&nbsp;by&nbsp;another&nbsp;paragraph&nbsp;span,</span><br>
<span class="lineno"></span><span class="comment" id="5720901">//&nbsp;begins&nbsp;with&nbsp;a&nbsp;capital&nbsp;letter,&nbsp;and&nbsp;contains&nbsp;no&nbsp;punctuation</span><br>
<span class="lineno"></span><span class="comment" id="5720962">//&nbsp;is&nbsp;formatted&nbsp;as&nbsp;a&nbsp;heading.</span><br>
<span class="lineno"></span><span class="comment" id="5720992">//</span><br>
<span class="lineno"></span><span class="comment" id="5720995">//&nbsp;A&nbsp;span&nbsp;of&nbsp;indented&nbsp;lines&nbsp;is&nbsp;converted&nbsp;into&nbsp;a&nbsp;&lt;pre&gt;&nbsp;block,</span><br>
<span class="lineno">280</span><span class="comment" id="5721056">//&nbsp;with&nbsp;the&nbsp;common&nbsp;indent&nbsp;prefix&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="5721098">//</span><br>
<span class="lineno"></span><span class="comment" id="5721101">//&nbsp;URLs&nbsp;in&nbsp;the&nbsp;comment&nbsp;text&nbsp;are&nbsp;converted&nbsp;into&nbsp;links;&nbsp;if&nbsp;the&nbsp;URL&nbsp;also&nbsp;appears</span><br>
<span class="lineno"></span><span class="comment" id="5721179">//&nbsp;in&nbsp;the&nbsp;words&nbsp;map,&nbsp;the&nbsp;link&nbsp;is&nbsp;taken&nbsp;from&nbsp;the&nbsp;map&nbsp;(if&nbsp;the&nbsp;corresponding&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="5721257">//&nbsp;value&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;the&nbsp;URL&nbsp;is&nbsp;not&nbsp;converted&nbsp;into&nbsp;a&nbsp;link).</span><br>
<span class="lineno">285</span><span class="comment" id="5721326">//</span><br>
<span class="lineno"></span><span class="comment" id="5721329">//&nbsp;Go&nbsp;identifiers&nbsp;that&nbsp;appear&nbsp;in&nbsp;the&nbsp;words&nbsp;map&nbsp;are&nbsp;italicized;&nbsp;if&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5721413">//&nbsp;map&nbsp;value&nbsp;is&nbsp;not&nbsp;the&nbsp;empty&nbsp;string,&nbsp;it&nbsp;is&nbsp;considered&nbsp;a&nbsp;URL&nbsp;and&nbsp;the&nbsp;word&nbsp;is&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="5721500">//&nbsp;into&nbsp;a&nbsp;link.</span><br>
<span class="lineno"></span><span class="keyword" id="5721516">func</span>&nbsp;<span class="ident" id="5721521">ToHTML</span><span class="op" id="5721527">(</span><span class="ident" id="5721528">w</span>&nbsp;<span class="ident" id="5721530"><a href="/go/doc/comment.go.html#5714606">io</a></span><span class="op" id="5721532">.</span><span class="ident" id="5721533">Writer</span><span class="op" id="5721539">,</span>&nbsp;<span class="ident" id="5721541">text</span>&nbsp;<span class="builtintype" id="5721546">string</span><span class="op" id="5721552">,</span>&nbsp;<span class="ident" id="5721554">words</span>&nbsp;<span class="keyword" id="5721560">map</span><span class="op" id="5721563">[</span><span class="builtintype" id="5721564">string</span><span class="op" id="5721570">]</span><span class="builtintype" id="5721571">string</span><span class="op" id="5721577">)</span>&nbsp;<span class="op" id="5721579">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721582">for</span>&nbsp;<span class="ident" id="5721586">_</span><span class="op" id="5721587">,</span>&nbsp;<span class="ident" id="5721589">b</span>&nbsp;<span class="op" id="5721591">:=</span>&nbsp;<span class="keyword" id="5721594">range</span>&nbsp;<span class="ident" id="5721600"><a href="/go/doc/comment.go.html#5722189">blocks</a></span><span class="op" id="5721606">(</span><span class="ident" id="5721607"><a href="/go/doc/comment.go.html#5721541">text</a></span><span class="op" id="5721611">)</span>&nbsp;<span class="op" id="5721613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721617">switch</span>&nbsp;<span class="ident" id="5721624"><a href="/go/doc/comment.go.html#5721589">b</a></span><span class="op" id="5721625">.</span><span class="ident" id="5721626">op</span>&nbsp;<span class="op" id="5721629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721633">case</span>&nbsp;<span class="ident" id="5721638"><a href="/go/doc/comment.go.html#5720124">opPara</a></span><span class="op" id="5721644">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721649"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721650">.</span><span class="ident" id="5721651">Write</span><span class="op" id="5721656">(</span><span class="ident" id="5721657"><a href="/go/doc/comment.go.html#5715987">html_p</a></span><span class="op" id="5721663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721668">for</span>&nbsp;<span class="ident" id="5721672">_</span><span class="op" id="5721673">,</span>&nbsp;<span class="ident" id="5721675">line</span>&nbsp;<span class="op" id="5721680">:=</span>&nbsp;<span class="keyword" id="5721683">range</span>&nbsp;<span class="ident" id="5721689"><a href="/go/doc/comment.go.html#5721589">b</a></span><span class="op" id="5721690">.</span><span class="ident" id="5721691">lines</span>&nbsp;<span class="op" id="5721697">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721703"><a href="/go/doc/comment.go.html#5717188">emphasize</a></span><span class="op" id="5721712">(</span><span class="ident" id="5721713"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721714">,</span>&nbsp;<span class="ident" id="5721716"><a href="/go/doc/comment.go.html#5721675">line</a></span><span class="op" id="5721720">,</span>&nbsp;<span class="ident" id="5721722"><a href="/go/doc/comment.go.html#5721554">words</a></span><span class="op" id="5721727">,</span>&nbsp;<span class="builtintype" id="5721729">true</span><span class="op" id="5721733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721743"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721744">.</span><span class="ident" id="5721745">Write</span><span class="op" id="5721750">(</span><span class="ident" id="5721751"><a href="/go/doc/comment.go.html#5716018">html_endp</a></span><span class="op" id="5721760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721764">case</span>&nbsp;<span class="ident" id="5721769"><a href="/go/doc/comment.go.html#5720142">opHead</a></span><span class="op" id="5721775">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721780"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721781">.</span><span class="ident" id="5721782">Write</span><span class="op" id="5721787">(</span><span class="ident" id="5721788"><a href="/go/doc/comment.go.html#5716115">html_h</a></span><span class="op" id="5721794">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721799">id</span>&nbsp;<span class="op" id="5721802">:=</span>&nbsp;<span class="string" id="5721805">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721811">for</span>&nbsp;<span class="ident" id="5721815">_</span><span class="op" id="5721816">,</span>&nbsp;<span class="ident" id="5721818">line</span>&nbsp;<span class="op" id="5721823">:=</span>&nbsp;<span class="keyword" id="5721826">range</span>&nbsp;<span class="ident" id="5721832"><a href="/go/doc/comment.go.html#5721589">b</a></span><span class="op" id="5721833">.</span><span class="ident" id="5721834">lines</span>&nbsp;<span class="op" id="5721840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721846">if</span>&nbsp;<span class="ident" id="5721849"><a href="/go/doc/comment.go.html#5721799">id</a></span>&nbsp;<span class="op" id="5721852">==</span>&nbsp;<span class="string" id="5721855">&#34;&#34;</span>&nbsp;<span class="op" id="5721858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721865"><a href="/go/doc/comment.go.html#5721799">id</a></span>&nbsp;<span class="op" id="5721868">=</span>&nbsp;<span class="ident" id="5721870"><a href="/go/doc/comment.go.html#5720269">anchorID</a></span><span class="op" id="5721878">(</span><span class="ident" id="5721879"><a href="/go/doc/comment.go.html#5721818">line</a></span><span class="op" id="5721883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721890"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721891">.</span><span class="ident" id="5721892">Write</span><span class="op" id="5721897">(</span><span class="op" id="5721898">[</span><span class="op" id="5721899">]</span><span class="builtintype" id="5721900">byte</span><span class="op" id="5721904">(</span><span class="ident" id="5721905"><a href="/go/doc/comment.go.html#5721799">id</a></span><span class="op" id="5721907">)</span><span class="op" id="5721908">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721915"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721916">.</span><span class="ident" id="5721917">Write</span><span class="op" id="5721922">(</span><span class="ident" id="5721923"><a href="/go/doc/comment.go.html#5716149">html_hq</a></span><span class="op" id="5721930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721942"><a href="/go/doc/comment.go.html#5714864">commentEscape</a></span><span class="op" id="5721955">(</span><span class="ident" id="5721956"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721957">,</span>&nbsp;<span class="ident" id="5721959"><a href="/go/doc/comment.go.html#5721818">line</a></span><span class="op" id="5721963">,</span>&nbsp;<span class="builtintype" id="5721965">true</span><span class="op" id="5721969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721979">if</span>&nbsp;<span class="ident" id="5721982"><a href="/go/doc/comment.go.html#5721799">id</a></span>&nbsp;<span class="op" id="5721985">==</span>&nbsp;<span class="string" id="5721988">&#34;&#34;</span>&nbsp;<span class="op" id="5721991">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721997"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5721998">.</span><span class="ident" id="5721999">Write</span><span class="op" id="5722004">(</span><span class="ident" id="5722005"><a href="/go/doc/comment.go.html#5716149">html_hq</a></span><span class="op" id="5722012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722022"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5722023">.</span><span class="ident" id="5722024">Write</span><span class="op" id="5722029">(</span><span class="ident" id="5722030"><a href="/go/doc/comment.go.html#5716177">html_endh</a></span><span class="op" id="5722039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722043">case</span>&nbsp;<span class="ident" id="5722048"><a href="/go/doc/comment.go.html#5720150">opPre</a></span><span class="op" id="5722053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722058"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5722059">.</span><span class="ident" id="5722060">Write</span><span class="op" id="5722065">(</span><span class="ident" id="5722066"><a href="/go/doc/comment.go.html#5716050">html_pre</a></span><span class="op" id="5722074">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722079">for</span>&nbsp;<span class="ident" id="5722083">_</span><span class="op" id="5722084">,</span>&nbsp;<span class="ident" id="5722086">line</span>&nbsp;<span class="op" id="5722091">:=</span>&nbsp;<span class="keyword" id="5722094">range</span>&nbsp;<span class="ident" id="5722100"><a href="/go/doc/comment.go.html#5721589">b</a></span><span class="op" id="5722101">.</span><span class="ident" id="5722102">lines</span>&nbsp;<span class="op" id="5722108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722114"><a href="/go/doc/comment.go.html#5717188">emphasize</a></span><span class="op" id="5722123">(</span><span class="ident" id="5722124"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5722125">,</span>&nbsp;<span class="ident" id="5722127"><a href="/go/doc/comment.go.html#5722086">line</a></span><span class="op" id="5722131">,</span>&nbsp;<span class="ident" id="5722133">nil</span><span class="op" id="5722136">,</span>&nbsp;<span class="builtintype" id="5722138">false</span><span class="op" id="5722143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722153"><a href="/go/doc/comment.go.html#5721528">w</a></span><span class="op" id="5722154">.</span><span class="ident" id="5722155">Write</span><span class="op" id="5722160">(</span><span class="ident" id="5722161"><a href="/go/doc/comment.go.html#5716081">html_endpre</a></span><span class="op" id="5722172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722176">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722179">}</span><br>
<span class="lineno"></span><span class="op" id="5722181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5722184">func</span>&nbsp;<span class="ident" id="5722189">blocks</span><span class="op" id="5722195">(</span><span class="ident" id="5722196">text</span>&nbsp;<span class="builtintype" id="5722201">string</span><span class="op" id="5722207">)</span>&nbsp;<span class="op" id="5722209">[</span><span class="op" id="5722210">]</span><span class="ident" id="5722211"><a href="/go/doc/comment.go.html#5720164">block</a></span>&nbsp;<span class="op" id="5722217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722220">var</span>&nbsp;<span class="op" id="5722224">(</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722228">out</span>&nbsp;&nbsp;<span class="op" id="5722233">[</span><span class="op" id="5722234">]</span><span class="ident" id="5722235"><a href="/go/doc/comment.go.html#5720164">block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722243">para</span>&nbsp;<span class="op" id="5722248">[</span><span class="op" id="5722249">]</span><span class="builtintype" id="5722250">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722260">lastWasBlank</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5722275">=</span>&nbsp;<span class="builtintype" id="5722277">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722285">lastWasHeading</span>&nbsp;<span class="op" id="5722300">=</span>&nbsp;<span class="builtintype" id="5722302">false</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5722313">close</span>&nbsp;<span class="op" id="5722319">:=</span>&nbsp;<span class="keyword" id="5722322">func</span><span class="op" id="5722326">(</span><span class="op" id="5722327">)</span>&nbsp;<span class="op" id="5722329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722333">if</span>&nbsp;<span class="ident" id="5722336"><a href="/go/doc/comment.go.html#5722243">para</a></span>&nbsp;<span class="op" id="5722341">!=</span>&nbsp;<span class="ident" id="5722344">nil</span>&nbsp;<span class="op" id="5722348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722353"><a href="/go/doc/comment.go.html#5722228">out</a></span>&nbsp;<span class="op" id="5722357">=</span>&nbsp;<span class="builtinfunc" id="5722359">append</span><span class="op" id="5722365">(</span><span class="ident" id="5722366"><a href="/go/doc/comment.go.html#5722228">out</a></span><span class="op" id="5722369">,</span>&nbsp;<span class="ident" id="5722371"><a href="/go/doc/comment.go.html#5720164">block</a></span><span class="op" id="5722376">{</span><span class="ident" id="5722377"><a href="/go/doc/comment.go.html#5720124">opPara</a></span><span class="op" id="5722383">,</span>&nbsp;<span class="ident" id="5722385"><a href="/go/doc/comment.go.html#5722243">para</a></span><span class="op" id="5722389">}</span><span class="op" id="5722390">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722395"><a href="/go/doc/comment.go.html#5722243">para</a></span>&nbsp;<span class="op" id="5722400">=</span>&nbsp;<span class="ident" id="5722402">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722415">lines</span>&nbsp;<span class="op" id="5722421">:=</span>&nbsp;<span class="ident" id="5722424"><a href="/go/doc/comment.go.html#5714622">strings</a></span><span class="op" id="5722431">.</span><span class="ident" id="5722432">SplitAfter</span><span class="op" id="5722442">(</span><span class="ident" id="5722443"><a href="/go/doc/comment.go.html#5722196">text</a></span><span class="op" id="5722447">,</span>&nbsp;<span class="string" id="5722449">&#34;\n&#34;</span><span class="op" id="5722453">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722456"><a href="/go/doc/comment.go.html#5718811">unindent</a></span><span class="op" id="5722464">(</span><span class="ident" id="5722465"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722473">for</span>&nbsp;<span class="ident" id="5722477">i</span>&nbsp;<span class="op" id="5722479">:=</span>&nbsp;<span class="num" id="5722482">0</span><span class="op" id="5722483">;</span>&nbsp;<span class="ident" id="5722485"><a href="/go/doc/comment.go.html#5722477">i</a></span>&nbsp;<span class="op" id="5722487">&lt;</span>&nbsp;<span class="builtinfunc" id="5722489">len</span><span class="op" id="5722492">(</span><span class="ident" id="5722493"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722498">)</span><span class="op" id="5722499">;</span>&nbsp;<span class="op" id="5722501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722505">line</span>&nbsp;<span class="op" id="5722510">:=</span>&nbsp;<span class="ident" id="5722513"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722518">[</span><span class="ident" id="5722519"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5722520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722524">if</span>&nbsp;<span class="ident" id="5722527"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5722534">(</span><span class="ident" id="5722535"><a href="/go/doc/comment.go.html#5722505">line</a></span><span class="op" id="5722539">)</span>&nbsp;<span class="op" id="5722541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722546">//&nbsp;close&nbsp;paragraph</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5722568"><a href="/go/doc/comment.go.html#5722313">close</a></span><span class="op" id="5722573">(</span><span class="op" id="5722574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722579"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5722580">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722586"><a href="/go/doc/comment.go.html#5722260">lastWasBlank</a></span>&nbsp;<span class="op" id="5722599">=</span>&nbsp;<span class="builtintype" id="5722601">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722609">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722620">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722624">if</span>&nbsp;<span class="ident" id="5722627"><a href="/go/doc/comment.go.html#5718490">indentLen</a></span><span class="op" id="5722636">(</span><span class="ident" id="5722637"><a href="/go/doc/comment.go.html#5722505">line</a></span><span class="op" id="5722641">)</span>&nbsp;<span class="op" id="5722643">&gt;</span>&nbsp;<span class="num" id="5722645">0</span>&nbsp;<span class="op" id="5722647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722652">//&nbsp;close&nbsp;paragraph</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5722674"><a href="/go/doc/comment.go.html#5722313">close</a></span><span class="op" id="5722679">(</span><span class="op" id="5722680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722686">//&nbsp;count&nbsp;indented&nbsp;or&nbsp;blank&nbsp;lines</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722722">j</span>&nbsp;<span class="op" id="5722724">:=</span>&nbsp;<span class="ident" id="5722727"><a href="/go/doc/comment.go.html#5722477">i</a></span>&nbsp;<span class="op" id="5722729">+</span>&nbsp;<span class="num" id="5722731">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722736">for</span>&nbsp;<span class="ident" id="5722740"><a href="/go/doc/comment.go.html#5722722">j</a></span>&nbsp;<span class="op" id="5722742">&lt;</span>&nbsp;<span class="builtinfunc" id="5722744">len</span><span class="op" id="5722747">(</span><span class="ident" id="5722748"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722753">)</span>&nbsp;<span class="op" id="5722755">&amp;&amp;</span>&nbsp;<span class="op" id="5722758">(</span><span class="ident" id="5722759"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5722766">(</span><span class="ident" id="5722767"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722772">[</span><span class="ident" id="5722773"><a href="/go/doc/comment.go.html#5722722">j</a></span><span class="op" id="5722774">]</span><span class="op" id="5722775">)</span>&nbsp;<span class="op" id="5722777">||</span>&nbsp;<span class="ident" id="5722780"><a href="/go/doc/comment.go.html#5718490">indentLen</a></span><span class="op" id="5722789">(</span><span class="ident" id="5722790"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722795">[</span><span class="ident" id="5722796"><a href="/go/doc/comment.go.html#5722722">j</a></span><span class="op" id="5722797">]</span><span class="op" id="5722798">)</span>&nbsp;<span class="op" id="5722800">&gt;</span>&nbsp;<span class="num" id="5722802">0</span><span class="op" id="5722803">)</span>&nbsp;<span class="op" id="5722805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722811"><a href="/go/doc/comment.go.html#5722722">j</a></span><span class="op" id="5722812">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722823">//&nbsp;but&nbsp;not&nbsp;trailing&nbsp;blank&nbsp;lines</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722858">for</span>&nbsp;<span class="ident" id="5722862"><a href="/go/doc/comment.go.html#5722722">j</a></span>&nbsp;<span class="op" id="5722864">&gt;</span>&nbsp;<span class="ident" id="5722866"><a href="/go/doc/comment.go.html#5722477">i</a></span>&nbsp;<span class="op" id="5722868">&amp;&amp;</span>&nbsp;<span class="ident" id="5722871"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5722878">(</span><span class="ident" id="5722879"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722884">[</span><span class="ident" id="5722885"><a href="/go/doc/comment.go.html#5722722">j</a></span><span class="op" id="5722886">-</span><span class="num" id="5722887">1</span><span class="op" id="5722888">]</span><span class="op" id="5722889">)</span>&nbsp;<span class="op" id="5722891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722897"><a href="/go/doc/comment.go.html#5722722">j</a></span><span class="op" id="5722898">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722909">pre</span>&nbsp;<span class="op" id="5722913">:=</span>&nbsp;<span class="ident" id="5722916"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5722921">[</span><span class="ident" id="5722922"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5722923">:</span><span class="ident" id="5722924"><a href="/go/doc/comment.go.html#5722722">j</a></span><span class="op" id="5722925">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722930"><a href="/go/doc/comment.go.html#5722477">i</a></span>&nbsp;<span class="op" id="5722932">=</span>&nbsp;<span class="ident" id="5722934"><a href="/go/doc/comment.go.html#5722722">j</a></span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722940"><a href="/go/doc/comment.go.html#5718811">unindent</a></span><span class="op" id="5722948">(</span><span class="ident" id="5722949"><a href="/go/doc/comment.go.html#5722909">pre</a></span><span class="op" id="5722952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722958">//&nbsp;put&nbsp;those&nbsp;lines&nbsp;in&nbsp;a&nbsp;pre&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722995"><a href="/go/doc/comment.go.html#5722228">out</a></span>&nbsp;<span class="op" id="5722999">=</span>&nbsp;<span class="builtinfunc" id="5723001">append</span><span class="op" id="5723007">(</span><span class="ident" id="5723008"><a href="/go/doc/comment.go.html#5722228">out</a></span><span class="op" id="5723011">,</span>&nbsp;<span class="ident" id="5723013"><a href="/go/doc/comment.go.html#5720164">block</a></span><span class="op" id="5723018">{</span><span class="ident" id="5723019"><a href="/go/doc/comment.go.html#5720150">opPre</a></span><span class="op" id="5723024">,</span>&nbsp;<span class="ident" id="5723026"><a href="/go/doc/comment.go.html#5722909">pre</a></span><span class="op" id="5723029">}</span><span class="op" id="5723030">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723035"><a href="/go/doc/comment.go.html#5722285">lastWasHeading</a></span>&nbsp;<span class="op" id="5723050">=</span>&nbsp;<span class="builtintype" id="5723052">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723061">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723077">if</span>&nbsp;<span class="ident" id="5723080"><a href="/go/doc/comment.go.html#5722260">lastWasBlank</a></span>&nbsp;<span class="op" id="5723093">&amp;&amp;</span>&nbsp;<span class="op" id="5723096">!</span><span class="ident" id="5723097"><a href="/go/doc/comment.go.html#5722285">lastWasHeading</a></span>&nbsp;<span class="op" id="5723112">&amp;&amp;</span>&nbsp;<span class="ident" id="5723115"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5723116">+</span><span class="num" id="5723117">2</span>&nbsp;<span class="op" id="5723119">&lt;</span>&nbsp;<span class="builtinfunc" id="5723121">len</span><span class="op" id="5723124">(</span><span class="ident" id="5723125"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5723130">)</span>&nbsp;<span class="op" id="5723132">&amp;&amp;</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723138"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5723145">(</span><span class="ident" id="5723146"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5723151">[</span><span class="ident" id="5723152"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5723153">+</span><span class="num" id="5723154">1</span><span class="op" id="5723155">]</span><span class="op" id="5723156">)</span>&nbsp;<span class="op" id="5723158">&amp;&amp;</span>&nbsp;<span class="op" id="5723161">!</span><span class="ident" id="5723162"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5723169">(</span><span class="ident" id="5723170"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5723175">[</span><span class="ident" id="5723176"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5723177">+</span><span class="num" id="5723178">2</span><span class="op" id="5723179">]</span><span class="op" id="5723180">)</span>&nbsp;<span class="op" id="5723182">&amp;&amp;</span>&nbsp;<span class="ident" id="5723185"><a href="/go/doc/comment.go.html#5718490">indentLen</a></span><span class="op" id="5723194">(</span><span class="ident" id="5723195"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5723200">[</span><span class="ident" id="5723201"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5723202">+</span><span class="num" id="5723203">2</span><span class="op" id="5723204">]</span><span class="op" id="5723205">)</span>&nbsp;<span class="op" id="5723207">==</span>&nbsp;<span class="num" id="5723210">0</span>&nbsp;<span class="op" id="5723212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723217">//&nbsp;current&nbsp;line&nbsp;is&nbsp;non-blank,&nbsp;surrounded&nbsp;by&nbsp;blank&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723276">//&nbsp;and&nbsp;the&nbsp;next&nbsp;non-blank&nbsp;line&nbsp;is&nbsp;not&nbsp;indented:&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723332">//&nbsp;might&nbsp;be&nbsp;a&nbsp;heading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723358">if</span>&nbsp;<span class="ident" id="5723361">head</span>&nbsp;<span class="op" id="5723366">:=</span>&nbsp;<span class="ident" id="5723369"><a href="/go/doc/comment.go.html#5719306">heading</a></span><span class="op" id="5723376">(</span><span class="ident" id="5723377"><a href="/go/doc/comment.go.html#5722505">line</a></span><span class="op" id="5723381">)</span><span class="op" id="5723382">;</span>&nbsp;<span class="ident" id="5723384"><a href="/go/doc/comment.go.html#5723361">head</a></span>&nbsp;<span class="op" id="5723389">!=</span>&nbsp;<span class="string" id="5723392">&#34;&#34;</span>&nbsp;<span class="op" id="5723395">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5723401"><a href="/go/doc/comment.go.html#5722313">close</a></span><span class="op" id="5723406">(</span><span class="op" id="5723407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723413"><a href="/go/doc/comment.go.html#5722228">out</a></span>&nbsp;<span class="op" id="5723417">=</span>&nbsp;<span class="builtinfunc" id="5723419">append</span><span class="op" id="5723425">(</span><span class="ident" id="5723426"><a href="/go/doc/comment.go.html#5722228">out</a></span><span class="op" id="5723429">,</span>&nbsp;<span class="ident" id="5723431"><a href="/go/doc/comment.go.html#5720164">block</a></span><span class="op" id="5723436">{</span><span class="ident" id="5723437"><a href="/go/doc/comment.go.html#5720142">opHead</a></span><span class="op" id="5723443">,</span>&nbsp;<span class="op" id="5723445">[</span><span class="op" id="5723446">]</span><span class="builtintype" id="5723447">string</span><span class="op" id="5723453">{</span><span class="ident" id="5723454"><a href="/go/doc/comment.go.html#5723361">head</a></span><span class="op" id="5723458">}</span><span class="op" id="5723459">}</span><span class="op" id="5723460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723466"><a href="/go/doc/comment.go.html#5722477">i</a></span>&nbsp;<span class="op" id="5723468">+=</span>&nbsp;<span class="num" id="5723471">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723477"><a href="/go/doc/comment.go.html#5722285">lastWasHeading</a></span>&nbsp;<span class="op" id="5723492">=</span>&nbsp;<span class="builtintype" id="5723494">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723503">continue</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723524">//&nbsp;open&nbsp;paragraph</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723544"><a href="/go/doc/comment.go.html#5722260">lastWasBlank</a></span>&nbsp;<span class="op" id="5723557">=</span>&nbsp;<span class="builtintype" id="5723559">false</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723567"><a href="/go/doc/comment.go.html#5722285">lastWasHeading</a></span>&nbsp;<span class="op" id="5723582">=</span>&nbsp;<span class="builtintype" id="5723584">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723592"><a href="/go/doc/comment.go.html#5722243">para</a></span>&nbsp;<span class="op" id="5723597">=</span>&nbsp;<span class="builtinfunc" id="5723599">append</span><span class="op" id="5723605">(</span><span class="ident" id="5723606"><a href="/go/doc/comment.go.html#5722243">para</a></span><span class="op" id="5723610">,</span>&nbsp;<span class="ident" id="5723612"><a href="/go/doc/comment.go.html#5722415">lines</a></span><span class="op" id="5723617">[</span><span class="ident" id="5723618"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5723619">]</span><span class="op" id="5723620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723624"><a href="/go/doc/comment.go.html#5722477">i</a></span><span class="op" id="5723625">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5723632"><a href="/go/doc/comment.go.html#5722313">close</a></span><span class="op" id="5723637">(</span><span class="op" id="5723638">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723642">return</span>&nbsp;<span class="ident" id="5723649"><a href="/go/doc/comment.go.html#5722228">out</a></span><br>
<span class="lineno"></span><span class="op" id="5723653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723656">//&nbsp;ToText&nbsp;prepares&nbsp;comment&nbsp;text&nbsp;for&nbsp;presentation&nbsp;in&nbsp;textual&nbsp;output.</span><br>
<span class="lineno">400</span><span class="comment" id="5723724">//&nbsp;It&nbsp;wraps&nbsp;paragraphs&nbsp;of&nbsp;text&nbsp;to&nbsp;width&nbsp;or&nbsp;fewer&nbsp;Unicode&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="5723793">//&nbsp;and&nbsp;then&nbsp;prefixes&nbsp;each&nbsp;line&nbsp;with&nbsp;the&nbsp;indent.&nbsp;&nbsp;In&nbsp;preformatted&nbsp;sections</span><br>
<span class="lineno"></span><span class="comment" id="5723867">//&nbsp;(such&nbsp;as&nbsp;program&nbsp;text),&nbsp;it&nbsp;prefixes&nbsp;each&nbsp;non-blank&nbsp;line&nbsp;with&nbsp;preIndent.</span><br>
<span class="lineno"></span><span class="keyword" id="5723942">func</span>&nbsp;<span class="ident" id="5723947">ToText</span><span class="op" id="5723953">(</span><span class="ident" id="5723954">w</span>&nbsp;<span class="ident" id="5723956"><a href="/go/doc/comment.go.html#5714606">io</a></span><span class="op" id="5723958">.</span><span class="ident" id="5723959">Writer</span><span class="op" id="5723965">,</span>&nbsp;<span class="ident" id="5723967">text</span>&nbsp;<span class="builtintype" id="5723972">string</span><span class="op" id="5723978">,</span>&nbsp;<span class="ident" id="5723980">indent</span><span class="op" id="5723986">,</span>&nbsp;<span class="ident" id="5723988">preIndent</span>&nbsp;<span class="builtintype" id="5723998">string</span><span class="op" id="5724004">,</span>&nbsp;<span class="ident" id="5724006">width</span>&nbsp;<span class="builtintype" id="5724012">int</span><span class="op" id="5724015">)</span>&nbsp;<span class="op" id="5724017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724020">l</span>&nbsp;<span class="op" id="5724022">:=</span>&nbsp;<span class="ident" id="5724025"><a href="/go/doc/comment.go.html#5724593">lineWrapper</a></span><span class="op" id="5724036">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724040">out</span><span class="op" id="5724043">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724048"><a href="/go/doc/comment.go.html#5723954">w</a></span><span class="op" id="5724049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724053">width</span><span class="op" id="5724058">:</span>&nbsp;&nbsp;<span class="ident" id="5724061"><a href="/go/doc/comment.go.html#5724006">width</a></span><span class="op" id="5724066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724070">indent</span><span class="op" id="5724076">:</span>&nbsp;<span class="ident" id="5724078"><a href="/go/doc/comment.go.html#5723980">indent</a></span><span class="op" id="5724084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724090">for</span>&nbsp;<span class="ident" id="5724094">_</span><span class="op" id="5724095">,</span>&nbsp;<span class="ident" id="5724097">b</span>&nbsp;<span class="op" id="5724099">:=</span>&nbsp;<span class="keyword" id="5724102">range</span>&nbsp;<span class="ident" id="5724108"><a href="/go/doc/comment.go.html#5722189">blocks</a></span><span class="op" id="5724114">(</span><span class="ident" id="5724115"><a href="/go/doc/comment.go.html#5723967">text</a></span><span class="op" id="5724119">)</span>&nbsp;<span class="op" id="5724121">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724125">switch</span>&nbsp;<span class="ident" id="5724132"><a href="/go/doc/comment.go.html#5724097">b</a></span><span class="op" id="5724133">.</span><span class="ident" id="5724134">op</span>&nbsp;<span class="op" id="5724137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724141">case</span>&nbsp;<span class="ident" id="5724146"><a href="/go/doc/comment.go.html#5720124">opPara</a></span><span class="op" id="5724152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724157">//&nbsp;l.write&nbsp;will&nbsp;add&nbsp;leading&nbsp;newline&nbsp;if&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724208">for</span>&nbsp;<span class="ident" id="5724212">_</span><span class="op" id="5724213">,</span>&nbsp;<span class="ident" id="5724215">line</span>&nbsp;<span class="op" id="5724220">:=</span>&nbsp;<span class="keyword" id="5724223">range</span>&nbsp;<span class="ident" id="5724229"><a href="/go/doc/comment.go.html#5724097">b</a></span><span class="op" id="5724230">.</span><span class="ident" id="5724231">lines</span>&nbsp;<span class="op" id="5724237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724243"><a href="/go/doc/comment.go.html#5724020">l</a></span><span class="op" id="5724244">.</span><span class="ident" id="5724245">write</span><span class="op" id="5724250">(</span><span class="ident" id="5724251"><a href="/go/doc/comment.go.html#5724215">line</a></span><span class="op" id="5724255">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724265"><a href="/go/doc/comment.go.html#5724020">l</a></span><span class="op" id="5724266">.</span><span class="ident" id="5724267">flush</span><span class="op" id="5724272">(</span><span class="op" id="5724273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724277">case</span>&nbsp;<span class="ident" id="5724282"><a href="/go/doc/comment.go.html#5720142">opHead</a></span><span class="op" id="5724288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724293"><a href="/go/doc/comment.go.html#5723954">w</a></span><span class="op" id="5724294">.</span><span class="ident" id="5724295">Write</span><span class="op" id="5724300">(</span><span class="ident" id="5724301"><a href="/go/doc/comment.go.html#5724721">nl</a></span><span class="op" id="5724303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724308">for</span>&nbsp;<span class="ident" id="5724312">_</span><span class="op" id="5724313">,</span>&nbsp;<span class="ident" id="5724315">line</span>&nbsp;<span class="op" id="5724320">:=</span>&nbsp;<span class="keyword" id="5724323">range</span>&nbsp;<span class="ident" id="5724329"><a href="/go/doc/comment.go.html#5724097">b</a></span><span class="op" id="5724330">.</span><span class="ident" id="5724331">lines</span>&nbsp;<span class="op" id="5724337">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724343"><a href="/go/doc/comment.go.html#5724020">l</a></span><span class="op" id="5724344">.</span><span class="ident" id="5724345">write</span><span class="op" id="5724350">(</span><span class="ident" id="5724351"><a href="/go/doc/comment.go.html#5724315">line</a></span>&nbsp;<span class="op" id="5724356">+</span>&nbsp;<span class="string" id="5724358">&#34;\n&#34;</span><span class="op" id="5724362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724372"><a href="/go/doc/comment.go.html#5724020">l</a></span><span class="op" id="5724373">.</span><span class="ident" id="5724374">flush</span><span class="op" id="5724379">(</span><span class="op" id="5724380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724384">case</span>&nbsp;<span class="ident" id="5724389"><a href="/go/doc/comment.go.html#5720150">opPre</a></span><span class="op" id="5724394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724399"><a href="/go/doc/comment.go.html#5723954">w</a></span><span class="op" id="5724400">.</span><span class="ident" id="5724401">Write</span><span class="op" id="5724406">(</span><span class="ident" id="5724407"><a href="/go/doc/comment.go.html#5724721">nl</a></span><span class="op" id="5724409">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724414">for</span>&nbsp;<span class="ident" id="5724418">_</span><span class="op" id="5724419">,</span>&nbsp;<span class="ident" id="5724421">line</span>&nbsp;<span class="op" id="5724426">:=</span>&nbsp;<span class="keyword" id="5724429">range</span>&nbsp;<span class="ident" id="5724435"><a href="/go/doc/comment.go.html#5724097">b</a></span><span class="op" id="5724436">.</span><span class="ident" id="5724437">lines</span>&nbsp;<span class="op" id="5724443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724449">if</span>&nbsp;<span class="ident" id="5724452"><a href="/go/doc/comment.go.html#5718602">isBlank</a></span><span class="op" id="5724459">(</span><span class="ident" id="5724460"><a href="/go/doc/comment.go.html#5724421">line</a></span><span class="op" id="5724464">)</span>&nbsp;<span class="op" id="5724466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724473"><a href="/go/doc/comment.go.html#5723954">w</a></span><span class="op" id="5724474">.</span><span class="ident" id="5724475">Write</span><span class="op" id="5724480">(</span><span class="op" id="5724481">[</span><span class="op" id="5724482">]</span><span class="builtintype" id="5724483">byte</span><span class="op" id="5724487">(</span><span class="string" id="5724488">&#34;\n&#34;</span><span class="op" id="5724492">)</span><span class="op" id="5724493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724499">}</span>&nbsp;<span class="keyword" id="5724501">else</span>&nbsp;<span class="op" id="5724506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724513"><a href="/go/doc/comment.go.html#5723954">w</a></span><span class="op" id="5724514">.</span><span class="ident" id="5724515">Write</span><span class="op" id="5724520">(</span><span class="op" id="5724521">[</span><span class="op" id="5724522">]</span><span class="builtintype" id="5724523">byte</span><span class="op" id="5724527">(</span><span class="ident" id="5724528"><a href="/go/doc/comment.go.html#5723988">preIndent</a></span><span class="op" id="5724537">)</span><span class="op" id="5724538">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724545"><a href="/go/doc/comment.go.html#5723954">w</a></span><span class="op" id="5724546">.</span><span class="ident" id="5724547">Write</span><span class="op" id="5724552">(</span><span class="op" id="5724553">[</span><span class="op" id="5724554">]</span><span class="builtintype" id="5724555">byte</span><span class="op" id="5724559">(</span><span class="ident" id="5724560"><a href="/go/doc/comment.go.html#5724421">line</a></span><span class="op" id="5724564">)</span><span class="op" id="5724565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724583">}</span><br>
<span class="lineno">435</span><span class="op" id="5724585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5724588">type</span>&nbsp;<span class="ident" id="5724593">lineWrapper</span>&nbsp;<span class="keyword" id="5724605">struct</span>&nbsp;<span class="op" id="5724612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724615">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5724625"><a href="/go/doc/comment.go.html#5714606">io</a></span><span class="op" id="5724627">.</span><span class="ident" id="5724628">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724636">printed</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5724646">bool</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724652">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5724662">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724667">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5724677">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724685">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5724695">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724700">pendSpace</span>&nbsp;<span class="builtintype" id="5724710">int</span><br>
<span class="lineno"></span><span class="op" id="5724714">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="5724717">var</span>&nbsp;<span class="ident" id="5724721">nl</span>&nbsp;<span class="op" id="5724724">=</span>&nbsp;<span class="op" id="5724726">[</span><span class="op" id="5724727">]</span><span class="builtintype" id="5724728">byte</span><span class="op" id="5724732">(</span><span class="string" id="5724733">&#34;\n&#34;</span><span class="op" id="5724737">)</span><br>
<span class="lineno"></span><span class="keyword" id="5724739">var</span>&nbsp;<span class="ident" id="5724743">space</span>&nbsp;<span class="op" id="5724749">=</span>&nbsp;<span class="op" id="5724751">[</span><span class="op" id="5724752">]</span><span class="builtintype" id="5724753">byte</span><span class="op" id="5724757">(</span><span class="string" id="5724758">&#34;&nbsp;&#34;</span><span class="op" id="5724761">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5724764">func</span>&nbsp;<span class="op" id="5724769">(</span><span class="ident" id="5724770">l</span>&nbsp;<span class="op" id="5724772">*</span><span class="ident" id="5724773"><a href="/go/doc/comment.go.html#5724593">lineWrapper</a></span><span class="op" id="5724784">)</span>&nbsp;<span class="ident" id="5724786">write</span><span class="op" id="5724791">(</span><span class="ident" id="5724792">text</span>&nbsp;<span class="builtintype" id="5724797">string</span><span class="op" id="5724803">)</span>&nbsp;<span class="op" id="5724805">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724808">if</span>&nbsp;<span class="ident" id="5724811"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5724812">.</span><span class="ident" id="5724813">n</span>&nbsp;<span class="op" id="5724815">==</span>&nbsp;<span class="num" id="5724818">0</span>&nbsp;<span class="op" id="5724820">&amp;&amp;</span>&nbsp;<span class="ident" id="5724823"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5724824">.</span><span class="ident" id="5724825">printed</span>&nbsp;<span class="op" id="5724833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724837"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5724838">.</span><span class="ident" id="5724839">out</span><span class="op" id="5724842">.</span><span class="ident" id="5724843">Write</span><span class="op" id="5724848">(</span><span class="ident" id="5724849"><a href="/go/doc/comment.go.html#5724721">nl</a></span><span class="op" id="5724851">)</span>&nbsp;<span class="comment" id="5724853">//&nbsp;blank&nbsp;line&nbsp;before&nbsp;new&nbsp;paragraph</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724892"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5724893">.</span><span class="ident" id="5724894">printed</span>&nbsp;<span class="op" id="5724902">=</span>&nbsp;<span class="builtintype" id="5724904">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724911">for</span>&nbsp;<span class="ident" id="5724915">_</span><span class="op" id="5724916">,</span>&nbsp;<span class="ident" id="5724918">f</span>&nbsp;<span class="op" id="5724920">:=</span>&nbsp;<span class="keyword" id="5724923">range</span>&nbsp;<span class="ident" id="5724929"><a href="/go/doc/comment.go.html#5714622">strings</a></span><span class="op" id="5724936">.</span><span class="ident" id="5724937">Fields</span><span class="op" id="5724943">(</span><span class="ident" id="5724944"><a href="/go/doc/comment.go.html#5724792">text</a></span><span class="op" id="5724948">)</span>&nbsp;<span class="op" id="5724950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724954">w</span>&nbsp;<span class="op" id="5724956">:=</span>&nbsp;<span class="ident" id="5724959"><a href="/go/doc/comment.go.html#5714679">utf8</a></span><span class="op" id="5724963">.</span><span class="ident" id="5724964">RuneCountInString</span><span class="op" id="5724981">(</span><span class="ident" id="5724982"><a href="/go/doc/comment.go.html#5724918">f</a></span><span class="op" id="5724983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724987">//&nbsp;wrap&nbsp;if&nbsp;line&nbsp;is&nbsp;too&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725017">if</span>&nbsp;<span class="ident" id="5725020"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725021">.</span><span class="ident" id="5725022">n</span>&nbsp;<span class="op" id="5725024">&gt;</span>&nbsp;<span class="num" id="5725026">0</span>&nbsp;<span class="op" id="5725028">&amp;&amp;</span>&nbsp;<span class="ident" id="5725031"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725032">.</span><span class="ident" id="5725033">n</span><span class="op" id="5725034">+</span><span class="ident" id="5725035"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725036">.</span><span class="ident" id="5725037">pendSpace</span><span class="op" id="5725046">+</span><span class="ident" id="5725047"><a href="/go/doc/comment.go.html#5724954">w</a></span>&nbsp;<span class="op" id="5725049">&gt;</span>&nbsp;<span class="ident" id="5725051"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725052">.</span><span class="ident" id="5725053">width</span>&nbsp;<span class="op" id="5725059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725064"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725065">.</span><span class="ident" id="5725066">out</span><span class="op" id="5725069">.</span><span class="ident" id="5725070">Write</span><span class="op" id="5725075">(</span><span class="ident" id="5725076"><a href="/go/doc/comment.go.html#5724721">nl</a></span><span class="op" id="5725078">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725083"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725084">.</span><span class="ident" id="5725085">n</span>&nbsp;<span class="op" id="5725087">=</span>&nbsp;<span class="num" id="5725089">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725094"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725095">.</span><span class="ident" id="5725096">pendSpace</span>&nbsp;<span class="op" id="5725106">=</span>&nbsp;<span class="num" id="5725108">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725116">if</span>&nbsp;<span class="ident" id="5725119"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725120">.</span><span class="ident" id="5725121">n</span>&nbsp;<span class="op" id="5725123">==</span>&nbsp;<span class="num" id="5725126">0</span>&nbsp;<span class="op" id="5725128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725133"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725134">.</span><span class="ident" id="5725135">out</span><span class="op" id="5725138">.</span><span class="ident" id="5725139">Write</span><span class="op" id="5725144">(</span><span class="op" id="5725145">[</span><span class="op" id="5725146">]</span><span class="builtintype" id="5725147">byte</span><span class="op" id="5725151">(</span><span class="ident" id="5725152"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725153">.</span><span class="ident" id="5725154">indent</span><span class="op" id="5725160">)</span><span class="op" id="5725161">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725169"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725170">.</span><span class="ident" id="5725171">out</span><span class="op" id="5725174">.</span><span class="ident" id="5725175">Write</span><span class="op" id="5725180">(</span><span class="ident" id="5725181"><a href="/go/doc/comment.go.html#5724743">space</a></span><span class="op" id="5725186">[</span><span class="op" id="5725187">:</span><span class="ident" id="5725188"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725189">.</span><span class="ident" id="5725190">pendSpace</span><span class="op" id="5725199">]</span><span class="op" id="5725200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725204"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725205">.</span><span class="ident" id="5725206">out</span><span class="op" id="5725209">.</span><span class="ident" id="5725210">Write</span><span class="op" id="5725215">(</span><span class="op" id="5725216">[</span><span class="op" id="5725217">]</span><span class="builtintype" id="5725218">byte</span><span class="op" id="5725222">(</span><span class="ident" id="5725223"><a href="/go/doc/comment.go.html#5724918">f</a></span><span class="op" id="5725224">)</span><span class="op" id="5725225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725229"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725230">.</span><span class="ident" id="5725231">n</span>&nbsp;<span class="op" id="5725233">+=</span>&nbsp;<span class="ident" id="5725236"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725237">.</span><span class="ident" id="5725238">pendSpace</span>&nbsp;<span class="op" id="5725248">+</span>&nbsp;<span class="ident" id="5725250"><a href="/go/doc/comment.go.html#5724954">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725254"><a href="/go/doc/comment.go.html#5724770">l</a></span><span class="op" id="5725255">.</span><span class="ident" id="5725256">pendSpace</span>&nbsp;<span class="op" id="5725266">=</span>&nbsp;<span class="num" id="5725268">1</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725271">}</span><br>
<span class="lineno"></span><span class="op" id="5725273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5725276">func</span>&nbsp;<span class="op" id="5725281">(</span><span class="ident" id="5725282">l</span>&nbsp;<span class="op" id="5725284">*</span><span class="ident" id="5725285"><a href="/go/doc/comment.go.html#5724593">lineWrapper</a></span><span class="op" id="5725296">)</span>&nbsp;<span class="ident" id="5725298">flush</span><span class="op" id="5725303">(</span><span class="op" id="5725304">)</span>&nbsp;<span class="op" id="5725306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725309">if</span>&nbsp;<span class="ident" id="5725312"><a href="/go/doc/comment.go.html#5725282">l</a></span><span class="op" id="5725313">.</span><span class="ident" id="5725314">n</span>&nbsp;<span class="op" id="5725316">==</span>&nbsp;<span class="num" id="5725319">0</span>&nbsp;<span class="op" id="5725321">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725336"><a href="/go/doc/comment.go.html#5725282">l</a></span><span class="op" id="5725337">.</span><span class="ident" id="5725338">out</span><span class="op" id="5725341">.</span><span class="ident" id="5725342">Write</span><span class="op" id="5725347">(</span><span class="ident" id="5725348"><a href="/go/doc/comment.go.html#5724721">nl</a></span><span class="op" id="5725350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725353"><a href="/go/doc/comment.go.html#5725282">l</a></span><span class="op" id="5725354">.</span><span class="ident" id="5725355">pendSpace</span>&nbsp;<span class="op" id="5725365">=</span>&nbsp;<span class="num" id="5725367">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725370"><a href="/go/doc/comment.go.html#5725282">l</a></span><span class="op" id="5725371">.</span><span class="ident" id="5725372">n</span>&nbsp;<span class="op" id="5725374">=</span>&nbsp;<span class="num" id="5725376">0</span><br>
<span class="lineno">480</span><span class="op" id="5725378">}</span>
</div>
</body>
</html>
