<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8532022">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8532078">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8532132">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8532183">package</span>&nbsp;<span class="ident" id="8532191">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532197">import</span>&nbsp;<span class="op" id="8532204">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532207">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532216">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532225">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532242">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532257">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532264">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532270">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532283">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532304">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532315">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532326">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532336">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532347">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8532357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532360">type</span>&nbsp;<span class="ident" id="8532365">respTest</span>&nbsp;<span class="keyword" id="8532374">struct</span>&nbsp;<span class="op" id="8532381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532384">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="8532389">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532397">Resp</span>&nbsp;<span class="ident" id="8532402">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532412">Body</span>&nbsp;<span class="builtintype" id="8532417">string</span><br>
<span class="lineno"></span><span class="op" id="8532424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532427">func</span>&nbsp;<span class="ident" id="8532432">dummyReq</span><span class="op" id="8532440">(</span><span class="ident" id="8532441">method</span>&nbsp;<span class="builtintype" id="8532448">string</span><span class="op" id="8532454">)</span>&nbsp;<span class="op" id="8532456">*</span><span class="ident" id="8532457">Request</span>&nbsp;<span class="op" id="8532465">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532468">return</span>&nbsp;<span class="op" id="8532475">&amp;</span><span class="ident" id="8532476">Request</span><span class="op" id="8532483">{</span><span class="ident" id="8532484">Method</span><span class="op" id="8532490">:</span>&nbsp;<span class="ident" id="8532492">method</span><span class="op" id="8532498">}</span><br>
<span class="lineno"></span><span class="op" id="8532500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532503">func</span>&nbsp;<span class="ident" id="8532508">dummyReq11</span><span class="op" id="8532518">(</span><span class="ident" id="8532519">method</span>&nbsp;<span class="builtintype" id="8532526">string</span><span class="op" id="8532532">)</span>&nbsp;<span class="op" id="8532534">*</span><span class="ident" id="8532535">Request</span>&nbsp;<span class="op" id="8532543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8532546">return</span>&nbsp;<span class="op" id="8532553">&amp;</span><span class="ident" id="8532554">Request</span><span class="op" id="8532561">{</span><span class="ident" id="8532562">Method</span><span class="op" id="8532568">:</span>&nbsp;<span class="ident" id="8532570">method</span><span class="op" id="8532576">,</span>&nbsp;<span class="ident" id="8532578">Proto</span><span class="op" id="8532583">:</span>&nbsp;<span class="string" id="8532585">&#34;HTTP/1.1&#34;</span><span class="op" id="8532595">,</span>&nbsp;<span class="ident" id="8532597">ProtoMajor</span><span class="op" id="8532607">:</span>&nbsp;<span class="num" id="8532609">1</span><span class="op" id="8532610">,</span>&nbsp;<span class="ident" id="8532612">ProtoMinor</span><span class="op" id="8532622">:</span>&nbsp;<span class="num" id="8532624">1</span><span class="op" id="8532625">}</span><br>
<span class="lineno">35</span><span class="op" id="8532627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8532630">var</span>&nbsp;<span class="ident" id="8532634">respTests</span>&nbsp;<span class="op" id="8532644">=</span>&nbsp;<span class="op" id="8532646">[</span><span class="op" id="8532647">]</span><span class="ident" id="8532648">respTest</span><span class="op" id="8532656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8532659">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532706">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532710">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8532732">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532737">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8532761">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532766">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8532773">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532778">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8532791">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532796">Response</span><span class="op" id="8532804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532809">Status</span><span class="op" id="8532815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8532821">&#34;200&nbsp;OK&#34;</span><span class="op" id="8532829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532834">StatusCode</span><span class="op" id="8532844">:</span>&nbsp;<span class="num" id="8532846">200</span><span class="op" id="8532849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532854">Proto</span><span class="op" id="8532859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8532866">&#34;HTTP/1.0&#34;</span><span class="op" id="8532876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532881">ProtoMajor</span><span class="op" id="8532891">:</span>&nbsp;<span class="num" id="8532893">1</span><span class="op" id="8532894">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532899">ProtoMinor</span><span class="op" id="8532909">:</span>&nbsp;<span class="num" id="8532911">0</span><span class="op" id="8532912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532917">Request</span><span class="op" id="8532924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8532929">dummyReq</span><span class="op" id="8532937">(</span><span class="string" id="8532938">&#34;GET&#34;</span><span class="op" id="8532943">)</span><span class="op" id="8532944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8532949">Header</span><span class="op" id="8532955">:</span>&nbsp;<span class="ident" id="8532957">Header</span><span class="op" id="8532963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8532969">&#34;Connection&#34;</span><span class="op" id="8532981">:</span>&nbsp;<span class="op" id="8532983">{</span><span class="string" id="8532984">&#34;close&#34;</span><span class="op" id="8532991">}</span><span class="op" id="8532992">,</span>&nbsp;<span class="comment" id="8532994">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533019">}</span><span class="op" id="8533020">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533025">Close</span><span class="op" id="8533030">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8533040">true</span><span class="op" id="8533044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533049">ContentLength</span><span class="op" id="8533062">:</span>&nbsp;<span class="op" id="8533064">-</span><span class="num" id="8533065">1</span><span class="op" id="8533066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533070">}</span><span class="op" id="8533071">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533076">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8533089">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533092">}</span><span class="op" id="8533093">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533097">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533155">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533179">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533183">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8533205">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533210">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8533217">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533222">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8533235">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533240">Response</span><span class="op" id="8533248">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533253">Status</span><span class="op" id="8533259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8533268">&#34;200&nbsp;OK&#34;</span><span class="op" id="8533276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533281">StatusCode</span><span class="op" id="8533291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8533296">200</span><span class="op" id="8533299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533304">Proto</span><span class="op" id="8533309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8533319">&#34;HTTP/1.1&#34;</span><span class="op" id="8533329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533334">ProtoMajor</span><span class="op" id="8533344">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8533349">1</span><span class="op" id="8533350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533355">ProtoMinor</span><span class="op" id="8533365">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8533370">1</span><span class="op" id="8533371">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533376">Header</span><span class="op" id="8533382">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533391">Header</span><span class="op" id="8533397">{</span><span class="op" id="8533398">}</span><span class="op" id="8533399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533404">Request</span><span class="op" id="8533411">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533419">dummyReq</span><span class="op" id="8533427">(</span><span class="string" id="8533428">&#34;GET&#34;</span><span class="op" id="8533433">)</span><span class="op" id="8533434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533439">Close</span><span class="op" id="8533444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8533454">true</span><span class="op" id="8533458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533463">ContentLength</span><span class="op" id="8533476">:</span>&nbsp;<span class="op" id="8533478">-</span><span class="num" id="8533479">1</span><span class="op" id="8533480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533484">}</span><span class="op" id="8533485">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533490">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8533503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533506">}</span><span class="op" id="8533507">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533511">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533575">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8533605">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533610">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8533617">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533622">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="8533650">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533655">Response</span><span class="op" id="8533663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533668">Status</span><span class="op" id="8533674">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8533683">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="8533699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533704">StatusCode</span><span class="op" id="8533714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8533719">204</span><span class="op" id="8533722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533727">Proto</span><span class="op" id="8533732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8533742">&#34;HTTP/1.1&#34;</span><span class="op" id="8533752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533757">ProtoMajor</span><span class="op" id="8533767">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8533772">1</span><span class="op" id="8533773">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533778">ProtoMinor</span><span class="op" id="8533788">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8533793">1</span><span class="op" id="8533794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533799">Header</span><span class="op" id="8533805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533814">Header</span><span class="op" id="8533820">{</span><span class="op" id="8533821">}</span><span class="op" id="8533822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533827">Request</span><span class="op" id="8533834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8533842">dummyReq</span><span class="op" id="8533850">(</span><span class="string" id="8533851">&#34;GET&#34;</span><span class="op" id="8533856">)</span><span class="op" id="8533857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533862">Close</span><span class="op" id="8533867">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8533877">false</span><span class="op" id="8533882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8533887">ContentLength</span><span class="op" id="8533900">:</span>&nbsp;<span class="num" id="8533902">0</span><span class="op" id="8533903">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533907">}</span><span class="op" id="8533908">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533913">&#34;&#34;</span><span class="op" id="8533915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533918">}</span><span class="op" id="8533919">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8533923">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8533967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533971">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8533993">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8533998">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8534023">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534028">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8534052">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534057">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8534064">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534069">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8534082">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534087">Response</span><span class="op" id="8534095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534100">Status</span><span class="op" id="8534106">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534112">&#34;200&nbsp;OK&#34;</span><span class="op" id="8534120">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534125">StatusCode</span><span class="op" id="8534135">:</span>&nbsp;<span class="num" id="8534137">200</span><span class="op" id="8534140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534145">Proto</span><span class="op" id="8534150">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534157">&#34;HTTP/1.0&#34;</span><span class="op" id="8534167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534172">ProtoMajor</span><span class="op" id="8534182">:</span>&nbsp;<span class="num" id="8534184">1</span><span class="op" id="8534185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534190">ProtoMinor</span><span class="op" id="8534200">:</span>&nbsp;<span class="num" id="8534202">0</span><span class="op" id="8534203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534208">Request</span><span class="op" id="8534215">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534220">dummyReq</span><span class="op" id="8534228">(</span><span class="string" id="8534229">&#34;GET&#34;</span><span class="op" id="8534234">)</span><span class="op" id="8534235">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534240">Header</span><span class="op" id="8534246">:</span>&nbsp;<span class="ident" id="8534248">Header</span><span class="op" id="8534254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534260">&#34;Connection&#34;</span><span class="op" id="8534272">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534278">{</span><span class="string" id="8534279">&#34;close&#34;</span><span class="op" id="8534286">}</span><span class="op" id="8534287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534293">&#34;Content-Length&#34;</span><span class="op" id="8534309">:</span>&nbsp;<span class="op" id="8534311">{</span><span class="string" id="8534312">&#34;10&#34;</span><span class="op" id="8534316">}</span><span class="op" id="8534317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534322">}</span><span class="op" id="8534323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534328">Close</span><span class="op" id="8534333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8534343">true</span><span class="op" id="8534347">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534352">ContentLength</span><span class="op" id="8534365">:</span>&nbsp;<span class="num" id="8534367">10</span><span class="op" id="8534369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534373">}</span><span class="op" id="8534374">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534379">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8534392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534395">}</span><span class="op" id="8534396">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8534400">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534449">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8534471">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534476">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8534509">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534514">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8534521">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534526">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8534535">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534540">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8534558">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534563">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="8534572">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534577">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="8534593">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534598">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8534606">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534611">&#34;\r\n&#34;</span><span class="op" id="8534617">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534622">Response</span><span class="op" id="8534630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534635">Status</span><span class="op" id="8534641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534653">&#34;200&nbsp;OK&#34;</span><span class="op" id="8534661">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534666">StatusCode</span><span class="op" id="8534676">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8534684">200</span><span class="op" id="8534687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534692">Proto</span><span class="op" id="8534697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534710">&#34;HTTP/1.1&#34;</span><span class="op" id="8534720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534725">ProtoMajor</span><span class="op" id="8534735">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8534743">1</span><span class="op" id="8534744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534749">ProtoMinor</span><span class="op" id="8534759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8534767">1</span><span class="op" id="8534768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534773">Request</span><span class="op" id="8534780">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534791">dummyReq</span><span class="op" id="8534799">(</span><span class="string" id="8534800">&#34;GET&#34;</span><span class="op" id="8534805">)</span><span class="op" id="8534806">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534811">Header</span><span class="op" id="8534817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534829">Header</span><span class="op" id="8534835">{</span><span class="op" id="8534836">}</span><span class="op" id="8534837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534842">Close</span><span class="op" id="8534847">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8534860">false</span><span class="op" id="8534865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534870">ContentLength</span><span class="op" id="8534883">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534888">-</span><span class="num" id="8534889">1</span><span class="op" id="8534890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8534895">TransferEncoding</span><span class="op" id="8534911">:</span>&nbsp;<span class="op" id="8534913">[</span><span class="op" id="8534914">]</span><span class="builtintype" id="8534915">string</span><span class="op" id="8534921">{</span><span class="string" id="8534922">&#34;chunked&#34;</span><span class="op" id="8534931">}</span><span class="op" id="8534932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534936">}</span><span class="op" id="8534937">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8534942">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="8534964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8534967">}</span><span class="op" id="8534968">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8534972">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535018">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8535040">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535045">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8535078">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535083">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="8535108">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535113">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8535120">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535125">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="8535134">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535139">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="8535157">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535162">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="8535170">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535175">&#34;\r\n&#34;</span><span class="op" id="8535181">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535186">Response</span><span class="op" id="8535194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535199">Status</span><span class="op" id="8535205">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535217">&#34;200&nbsp;OK&#34;</span><span class="op" id="8535225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535230">StatusCode</span><span class="op" id="8535240">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8535248">200</span><span class="op" id="8535251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535256">Proto</span><span class="op" id="8535261">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535274">&#34;HTTP/1.1&#34;</span><span class="op" id="8535284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535289">ProtoMajor</span><span class="op" id="8535299">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8535307">1</span><span class="op" id="8535308">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535313">ProtoMinor</span><span class="op" id="8535323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8535331">1</span><span class="op" id="8535332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535337">Request</span><span class="op" id="8535344">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535355">dummyReq</span><span class="op" id="8535363">(</span><span class="string" id="8535364">&#34;GET&#34;</span><span class="op" id="8535369">)</span><span class="op" id="8535370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535375">Header</span><span class="op" id="8535381">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535393">Header</span><span class="op" id="8535399">{</span><span class="op" id="8535400">}</span><span class="op" id="8535401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535406">Close</span><span class="op" id="8535411">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8535424">false</span><span class="op" id="8535429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535434">ContentLength</span><span class="op" id="8535447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535452">-</span><span class="num" id="8535453">1</span><span class="op" id="8535454">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535459">TransferEncoding</span><span class="op" id="8535475">:</span>&nbsp;<span class="op" id="8535477">[</span><span class="op" id="8535478">]</span><span class="builtintype" id="8535479">string</span><span class="op" id="8535485">{</span><span class="string" id="8535486">&#34;chunked&#34;</span><span class="op" id="8535495">}</span><span class="op" id="8535496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535500">}</span><span class="op" id="8535501">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535506">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8535519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535522">}</span><span class="op" id="8535523">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535527">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535582">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8535604">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535609">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="8535642">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535647">&#34;\r\n&#34;</span><span class="op" id="8535653">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535658">Response</span><span class="op" id="8535666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535671">Status</span><span class="op" id="8535677">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535689">&#34;200&nbsp;OK&#34;</span><span class="op" id="8535697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535702">StatusCode</span><span class="op" id="8535712">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8535720">200</span><span class="op" id="8535723">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535728">Proto</span><span class="op" id="8535733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535746">&#34;HTTP/1.1&#34;</span><span class="op" id="8535756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535761">ProtoMajor</span><span class="op" id="8535771">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8535779">1</span><span class="op" id="8535780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535785">ProtoMinor</span><span class="op" id="8535795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8535803">1</span><span class="op" id="8535804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535809">Request</span><span class="op" id="8535816">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535827">dummyReq</span><span class="op" id="8535835">(</span><span class="string" id="8535836">&#34;HEAD&#34;</span><span class="op" id="8535842">)</span><span class="op" id="8535843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535848">Header</span><span class="op" id="8535854">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535866">Header</span><span class="op" id="8535872">{</span><span class="op" id="8535873">}</span><span class="op" id="8535874">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535879">TransferEncoding</span><span class="op" id="8535895">:</span>&nbsp;<span class="op" id="8535897">[</span><span class="op" id="8535898">]</span><span class="builtintype" id="8535899">string</span><span class="op" id="8535905">{</span><span class="string" id="8535906">&#34;chunked&#34;</span><span class="op" id="8535915">}</span><span class="op" id="8535916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535921">Close</span><span class="op" id="8535926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8535939">false</span><span class="op" id="8535944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8535949">ContentLength</span><span class="op" id="8535962">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535967">-</span><span class="num" id="8535968">1</span><span class="op" id="8535969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535973">}</span><span class="op" id="8535974">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8535979">&#34;&#34;</span><span class="op" id="8535981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8535984">}</span><span class="op" id="8535985">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8535989">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536038">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536042">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8536064">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536069">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8536095">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536100">&#34;\r\n&#34;</span><span class="op" id="8536106">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536111">Response</span><span class="op" id="8536119">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536124">Status</span><span class="op" id="8536130">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536142">&#34;200&nbsp;OK&#34;</span><span class="op" id="8536150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536155">StatusCode</span><span class="op" id="8536165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536173">200</span><span class="op" id="8536176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536181">Proto</span><span class="op" id="8536186">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536199">&#34;HTTP/1.0&#34;</span><span class="op" id="8536209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536214">ProtoMajor</span><span class="op" id="8536224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536232">1</span><span class="op" id="8536233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536238">ProtoMinor</span><span class="op" id="8536248">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536256">0</span><span class="op" id="8536257">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536262">Request</span><span class="op" id="8536269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536280">dummyReq</span><span class="op" id="8536288">(</span><span class="string" id="8536289">&#34;HEAD&#34;</span><span class="op" id="8536295">)</span><span class="op" id="8536296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536301">Header</span><span class="op" id="8536307">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536319">Header</span><span class="op" id="8536325">{</span><span class="string" id="8536326">&#34;Content-Length&#34;</span><span class="op" id="8536342">:</span>&nbsp;<span class="op" id="8536344">{</span><span class="string" id="8536345">&#34;256&#34;</span><span class="op" id="8536350">}</span><span class="op" id="8536351">}</span><span class="op" id="8536352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536357">TransferEncoding</span><span class="op" id="8536373">:</span>&nbsp;<span class="ident" id="8536375">nil</span><span class="op" id="8536378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536383">Close</span><span class="op" id="8536388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8536401">true</span><span class="op" id="8536405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536410">ContentLength</span><span class="op" id="8536423">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536428">256</span><span class="op" id="8536431">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536435">}</span><span class="op" id="8536436">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536441">&#34;&#34;</span><span class="op" id="8536443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536446">}</span><span class="op" id="8536447">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8536451">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536518">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8536540">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536545">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="8536571">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536576">&#34;\r\n&#34;</span><span class="op" id="8536582">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536587">Response</span><span class="op" id="8536595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536600">Status</span><span class="op" id="8536606">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536618">&#34;200&nbsp;OK&#34;</span><span class="op" id="8536626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536631">StatusCode</span><span class="op" id="8536641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536649">200</span><span class="op" id="8536652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536657">Proto</span><span class="op" id="8536662">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536675">&#34;HTTP/1.1&#34;</span><span class="op" id="8536685">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536690">ProtoMajor</span><span class="op" id="8536700">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536708">1</span><span class="op" id="8536709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536714">ProtoMinor</span><span class="op" id="8536724">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536732">1</span><span class="op" id="8536733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536738">Request</span><span class="op" id="8536745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536756">dummyReq</span><span class="op" id="8536764">(</span><span class="string" id="8536765">&#34;HEAD&#34;</span><span class="op" id="8536771">)</span><span class="op" id="8536772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536777">Header</span><span class="op" id="8536783">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536795">Header</span><span class="op" id="8536801">{</span><span class="string" id="8536802">&#34;Content-Length&#34;</span><span class="op" id="8536818">:</span>&nbsp;<span class="op" id="8536820">{</span><span class="string" id="8536821">&#34;256&#34;</span><span class="op" id="8536826">}</span><span class="op" id="8536827">}</span><span class="op" id="8536828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536833">TransferEncoding</span><span class="op" id="8536849">:</span>&nbsp;<span class="ident" id="8536851">nil</span><span class="op" id="8536854">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536859">Close</span><span class="op" id="8536864">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8536877">false</span><span class="op" id="8536882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8536887">ContentLength</span><span class="op" id="8536900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8536905">256</span><span class="op" id="8536908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536912">}</span><span class="op" id="8536913">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536918">&#34;&#34;</span><span class="op" id="8536920">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536923">}</span><span class="op" id="8536924">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8536928">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8536991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8536995">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8537017">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537022">&#34;\r\n&#34;</span><span class="op" id="8537028">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537033">Response</span><span class="op" id="8537041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537046">Status</span><span class="op" id="8537052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537064">&#34;200&nbsp;OK&#34;</span><span class="op" id="8537072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537077">StatusCode</span><span class="op" id="8537087">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8537095">200</span><span class="op" id="8537098">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537103">Proto</span><span class="op" id="8537108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537121">&#34;HTTP/1.0&#34;</span><span class="op" id="8537131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537136">ProtoMajor</span><span class="op" id="8537146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8537154">1</span><span class="op" id="8537155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537160">ProtoMinor</span><span class="op" id="8537170">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8537178">0</span><span class="op" id="8537179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537184">Request</span><span class="op" id="8537191">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537202">dummyReq</span><span class="op" id="8537210">(</span><span class="string" id="8537211">&#34;HEAD&#34;</span><span class="op" id="8537217">)</span><span class="op" id="8537218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537223">Header</span><span class="op" id="8537229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537241">Header</span><span class="op" id="8537247">{</span><span class="op" id="8537248">}</span><span class="op" id="8537249">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537254">TransferEncoding</span><span class="op" id="8537270">:</span>&nbsp;<span class="ident" id="8537272">nil</span><span class="op" id="8537275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537280">Close</span><span class="op" id="8537285">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8537298">true</span><span class="op" id="8537302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537307">ContentLength</span><span class="op" id="8537320">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537325">-</span><span class="num" id="8537326">1</span><span class="op" id="8537327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537331">}</span><span class="op" id="8537332">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537337">&#34;&#34;</span><span class="op" id="8537339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537342">}</span><span class="op" id="8537343">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8537347">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537381">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537385">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8537407">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537412">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8537436">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537441">&#34;\r\n&#34;</span><span class="op" id="8537447">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537452">Response</span><span class="op" id="8537460">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537465">Status</span><span class="op" id="8537471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537477">&#34;200&nbsp;OK&#34;</span><span class="op" id="8537485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537490">StatusCode</span><span class="op" id="8537500">:</span>&nbsp;<span class="num" id="8537502">200</span><span class="op" id="8537505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537510">Proto</span><span class="op" id="8537515">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537522">&#34;HTTP/1.1&#34;</span><span class="op" id="8537532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537537">ProtoMajor</span><span class="op" id="8537547">:</span>&nbsp;<span class="num" id="8537549">1</span><span class="op" id="8537550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537555">ProtoMinor</span><span class="op" id="8537565">:</span>&nbsp;<span class="num" id="8537567">1</span><span class="op" id="8537568">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537573">Request</span><span class="op" id="8537580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537585">dummyReq</span><span class="op" id="8537593">(</span><span class="string" id="8537594">&#34;GET&#34;</span><span class="op" id="8537599">)</span><span class="op" id="8537600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537605">Header</span><span class="op" id="8537611">:</span>&nbsp;<span class="ident" id="8537613">Header</span><span class="op" id="8537619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537625">&#34;Content-Length&#34;</span><span class="op" id="8537641">:</span>&nbsp;<span class="op" id="8537643">{</span><span class="string" id="8537644">&#34;0&#34;</span><span class="op" id="8537647">}</span><span class="op" id="8537648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537653">}</span><span class="op" id="8537654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537659">Close</span><span class="op" id="8537664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8537674">false</span><span class="op" id="8537679">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537684">ContentLength</span><span class="op" id="8537697">:</span>&nbsp;<span class="num" id="8537699">0</span><span class="op" id="8537700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537704">}</span><span class="op" id="8537705">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537710">&#34;&#34;</span><span class="op" id="8537712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537715">}</span><span class="op" id="8537716">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8537720">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8537781">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8537809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8537813">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="8537836">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537840">Response</span><span class="op" id="8537848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537853">Status</span><span class="op" id="8537859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537868">&#34;303&nbsp;&#34;</span><span class="op" id="8537874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537879">StatusCode</span><span class="op" id="8537889">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8537894">303</span><span class="op" id="8537897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537902">Proto</span><span class="op" id="8537907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537917">&#34;HTTP/1.0&#34;</span><span class="op" id="8537927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537932">ProtoMajor</span><span class="op" id="8537942">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8537947">1</span><span class="op" id="8537948">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537953">ProtoMinor</span><span class="op" id="8537963">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8537968">0</span><span class="op" id="8537969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8537974">Request</span><span class="op" id="8537981">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537989">dummyReq</span><span class="op" id="8537997">(</span><span class="string" id="8537998">&#34;GET&#34;</span><span class="op" id="8538003">)</span><span class="op" id="8538004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538009">Header</span><span class="op" id="8538015">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538024">Header</span><span class="op" id="8538030">{</span><span class="op" id="8538031">}</span><span class="op" id="8538032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538037">Close</span><span class="op" id="8538042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8538052">true</span><span class="op" id="8538056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538061">ContentLength</span><span class="op" id="8538074">:</span>&nbsp;<span class="op" id="8538076">-</span><span class="num" id="8538077">1</span><span class="op" id="8538078">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538082">}</span><span class="op" id="8538083">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8538088">&#34;&#34;</span><span class="op" id="8538090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538093">}</span><span class="op" id="8538094">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8538098">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8538162">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8538226">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="8538248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538252">Response</span><span class="op" id="8538260">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538265">Status</span><span class="op" id="8538271">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538280">&#34;303&nbsp;&#34;</span><span class="op" id="8538286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538291">StatusCode</span><span class="op" id="8538301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8538306">303</span><span class="op" id="8538309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538314">Proto</span><span class="op" id="8538319">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538329">&#34;HTTP/1.0&#34;</span><span class="op" id="8538339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538344">ProtoMajor</span><span class="op" id="8538354">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8538359">1</span><span class="op" id="8538360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538365">ProtoMinor</span><span class="op" id="8538375">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8538380">0</span><span class="op" id="8538381">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538386">Request</span><span class="op" id="8538393">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538401">dummyReq</span><span class="op" id="8538409">(</span><span class="string" id="8538410">&#34;GET&#34;</span><span class="op" id="8538415">)</span><span class="op" id="8538416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538421">Header</span><span class="op" id="8538427">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538436">Header</span><span class="op" id="8538442">{</span><span class="op" id="8538443">}</span><span class="op" id="8538444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538449">Close</span><span class="op" id="8538454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8538464">true</span><span class="op" id="8538468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538473">ContentLength</span><span class="op" id="8538486">:</span>&nbsp;<span class="op" id="8538488">-</span><span class="num" id="8538489">1</span><span class="op" id="8538490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538494">}</span><span class="op" id="8538495">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8538500">&#34;&#34;</span><span class="op" id="8538502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538505">}</span><span class="op" id="8538506">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8538510">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8538591">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="8538712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538716">Response</span><span class="op" id="8538724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538729">Status</span><span class="op" id="8538735">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538741">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8538762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538767">StatusCode</span><span class="op" id="8538777">:</span>&nbsp;<span class="num" id="8538779">206</span><span class="op" id="8538782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538787">Proto</span><span class="op" id="8538792">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538799">&#34;HTTP/1.1&#34;</span><span class="op" id="8538809">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538814">ProtoMajor</span><span class="op" id="8538824">:</span>&nbsp;<span class="num" id="8538826">1</span><span class="op" id="8538827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538832">ProtoMinor</span><span class="op" id="8538842">:</span>&nbsp;<span class="num" id="8538844">1</span><span class="op" id="8538845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538850">Request</span><span class="op" id="8538857">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538862">dummyReq</span><span class="op" id="8538870">(</span><span class="string" id="8538871">&#34;GET&#34;</span><span class="op" id="8538876">)</span><span class="op" id="8538877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538882">Header</span><span class="op" id="8538888">:</span>&nbsp;<span class="ident" id="8538890">Header</span><span class="op" id="8538896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8538902">&#34;Content-Type&#34;</span><span class="op" id="8538916">:</span>&nbsp;<span class="op" id="8538918">[</span><span class="op" id="8538919">]</span><span class="builtintype" id="8538920">string</span><span class="op" id="8538926">{</span><span class="string" id="8538927">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="8538976">}</span><span class="op" id="8538977">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8538982">}</span><span class="op" id="8538983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8538988">Close</span><span class="op" id="8538993">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8539003">true</span><span class="op" id="8539007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539012">ContentLength</span><span class="op" id="8539025">:</span>&nbsp;<span class="op" id="8539027">-</span><span class="num" id="8539028">1</span><span class="op" id="8539029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539033">}</span><span class="op" id="8539034">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539039">&#34;some&nbsp;body&#34;</span><span class="op" id="8539050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539053">}</span><span class="op" id="8539054">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8539058">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539120">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539124">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8539146">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539151">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8539175">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539180">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8539187">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539192">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8539205">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539210">Response</span><span class="op" id="8539218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539223">Status</span><span class="op" id="8539229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539235">&#34;200&nbsp;OK&#34;</span><span class="op" id="8539243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539248">StatusCode</span><span class="op" id="8539258">:</span>&nbsp;<span class="num" id="8539260">200</span><span class="op" id="8539263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539268">Proto</span><span class="op" id="8539273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539280">&#34;HTTP/1.0&#34;</span><span class="op" id="8539290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539295">ProtoMajor</span><span class="op" id="8539305">:</span>&nbsp;<span class="num" id="8539307">1</span><span class="op" id="8539308">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539313">ProtoMinor</span><span class="op" id="8539323">:</span>&nbsp;<span class="num" id="8539325">0</span><span class="op" id="8539326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539331">Header</span><span class="op" id="8539337">:</span>&nbsp;<span class="ident" id="8539339">Header</span><span class="op" id="8539345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539351">&#34;Connection&#34;</span><span class="op" id="8539363">:</span>&nbsp;<span class="op" id="8539365">{</span><span class="string" id="8539366">&#34;close&#34;</span><span class="op" id="8539373">}</span><span class="op" id="8539374">,</span>&nbsp;<span class="comment" id="8539376">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539401">}</span><span class="op" id="8539402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539407">Close</span><span class="op" id="8539412">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8539422">true</span><span class="op" id="8539426">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539431">ContentLength</span><span class="op" id="8539444">:</span>&nbsp;<span class="op" id="8539446">-</span><span class="num" id="8539447">1</span><span class="op" id="8539448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539452">}</span><span class="op" id="8539453">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539458">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="8539471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539474">}</span><span class="op" id="8539475">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8539479">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8539526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539530">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="8539565">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539570">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="8539616">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539621">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="8539648">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539653">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="8539689">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539694">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8539722">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539727">&#34;foobar&#34;</span><span class="op" id="8539735">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539740">Response</span><span class="op" id="8539748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539753">Status</span><span class="op" id="8539759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539765">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="8539786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539791">StatusCode</span><span class="op" id="8539801">:</span>&nbsp;<span class="num" id="8539803">206</span><span class="op" id="8539806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539811">Proto</span><span class="op" id="8539816">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539823">&#34;HTTP/1.1&#34;</span><span class="op" id="8539833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539838">ProtoMajor</span><span class="op" id="8539848">:</span>&nbsp;<span class="num" id="8539850">1</span><span class="op" id="8539851">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539856">ProtoMinor</span><span class="op" id="8539866">:</span>&nbsp;<span class="num" id="8539868">1</span><span class="op" id="8539869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539874">Request</span><span class="op" id="8539881">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539886">dummyReq</span><span class="op" id="8539894">(</span><span class="string" id="8539895">&#34;GET&#34;</span><span class="op" id="8539900">)</span><span class="op" id="8539901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8539906">Header</span><span class="op" id="8539912">:</span>&nbsp;<span class="ident" id="8539914">Header</span><span class="op" id="8539920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539926">&#34;Accept-Ranges&#34;</span><span class="op" id="8539941">:</span>&nbsp;&nbsp;<span class="op" id="8539944">[</span><span class="op" id="8539945">]</span><span class="builtintype" id="8539946">string</span><span class="op" id="8539952">{</span><span class="string" id="8539953">&#34;bytes&#34;</span><span class="op" id="8539960">}</span><span class="op" id="8539961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8539967">&#34;Content-Length&#34;</span><span class="op" id="8539983">:</span>&nbsp;<span class="op" id="8539985">[</span><span class="op" id="8539986">]</span><span class="builtintype" id="8539987">string</span><span class="op" id="8539993">{</span><span class="string" id="8539994">&#34;6&#34;</span><span class="op" id="8539997">}</span><span class="op" id="8539998">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8540004">&#34;Content-Type&#34;</span><span class="op" id="8540018">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8540022">[</span><span class="op" id="8540023">]</span><span class="builtintype" id="8540024">string</span><span class="op" id="8540030">{</span><span class="string" id="8540031">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="8540058">}</span><span class="op" id="8540059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8540065">&#34;Content-Range&#34;</span><span class="op" id="8540080">:</span>&nbsp;&nbsp;<span class="op" id="8540083">[</span><span class="op" id="8540084">]</span><span class="builtintype" id="8540085">string</span><span class="op" id="8540091">{</span><span class="string" id="8540092">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="8540108">}</span><span class="op" id="8540109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540114">}</span><span class="op" id="8540115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540120">ContentLength</span><span class="op" id="8540133">:</span>&nbsp;<span class="num" id="8540135">6</span><span class="op" id="8540136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540140">}</span><span class="op" id="8540141">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8540146">&#34;foobar&#34;</span><span class="op" id="8540154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540157">}</span><span class="op" id="8540158">,</span><br>
<span class="lineno"></span><span class="op" id="8540160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="8540163">func</span>&nbsp;<span class="ident" id="8540168">TestReadResponse</span><span class="op" id="8540184">(</span><span class="ident" id="8540185">t</span>&nbsp;<span class="op" id="8540187">*</span><span class="ident" id="8540188">testing</span><span class="op" id="8540195">.</span><span class="ident" id="8540196">T</span><span class="op" id="8540197">)</span>&nbsp;<span class="op" id="8540199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540202">for</span>&nbsp;<span class="ident" id="8540206">i</span><span class="op" id="8540207">,</span>&nbsp;<span class="ident" id="8540209">tt</span>&nbsp;<span class="op" id="8540212">:=</span>&nbsp;<span class="keyword" id="8540215">range</span>&nbsp;<span class="ident" id="8540221">respTests</span>&nbsp;<span class="op" id="8540231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540235">resp</span><span class="op" id="8540239">,</span>&nbsp;<span class="ident" id="8540241">err</span>&nbsp;<span class="op" id="8540245">:=</span>&nbsp;<span class="ident" id="8540248">ReadResponse</span><span class="op" id="8540260">(</span><span class="ident" id="8540261">bufio</span><span class="op" id="8540266">.</span><span class="ident" id="8540267">NewReader</span><span class="op" id="8540276">(</span><span class="ident" id="8540277">strings</span><span class="op" id="8540284">.</span><span class="ident" id="8540285">NewReader</span><span class="op" id="8540294">(</span><span class="ident" id="8540295">tt</span><span class="op" id="8540297">.</span><span class="ident" id="8540298">Raw</span><span class="op" id="8540301">)</span><span class="op" id="8540302">)</span><span class="op" id="8540303">,</span>&nbsp;<span class="ident" id="8540305">tt</span><span class="op" id="8540307">.</span><span class="ident" id="8540308">Resp</span><span class="op" id="8540312">.</span><span class="ident" id="8540313">Request</span><span class="op" id="8540320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540324">if</span>&nbsp;<span class="ident" id="8540327">err</span>&nbsp;<span class="op" id="8540331">!=</span>&nbsp;<span class="ident" id="8540334">nil</span>&nbsp;<span class="op" id="8540338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540343">t</span><span class="op" id="8540344">.</span><span class="ident" id="8540345">Errorf</span><span class="op" id="8540351">(</span><span class="string" id="8540352">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8540361">,</span>&nbsp;<span class="ident" id="8540363">i</span><span class="op" id="8540364">,</span>&nbsp;<span class="ident" id="8540366">err</span><span class="op" id="8540369">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540374">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540389">rbody</span>&nbsp;<span class="op" id="8540395">:=</span>&nbsp;<span class="ident" id="8540398">resp</span><span class="op" id="8540402">.</span><span class="ident" id="8540403">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540410">resp</span><span class="op" id="8540414">.</span><span class="ident" id="8540415">Body</span>&nbsp;<span class="op" id="8540420">=</span>&nbsp;<span class="ident" id="8540422">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540428">diff</span><span class="op" id="8540432">(</span><span class="ident" id="8540433">t</span><span class="op" id="8540434">,</span>&nbsp;<span class="ident" id="8540436">fmt</span><span class="op" id="8540439">.</span><span class="ident" id="8540440">Sprintf</span><span class="op" id="8540447">(</span><span class="string" id="8540448">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="8540462">,</span>&nbsp;<span class="ident" id="8540464">i</span><span class="op" id="8540465">)</span><span class="op" id="8540466">,</span>&nbsp;<span class="ident" id="8540468">resp</span><span class="op" id="8540472">,</span>&nbsp;<span class="op" id="8540474">&amp;</span><span class="ident" id="8540475">tt</span><span class="op" id="8540477">.</span><span class="ident" id="8540478">Resp</span><span class="op" id="8540482">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540486">var</span>&nbsp;<span class="ident" id="8540490">bout</span>&nbsp;<span class="ident" id="8540495">bytes</span><span class="op" id="8540500">.</span><span class="ident" id="8540501">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540510">if</span>&nbsp;<span class="ident" id="8540513">rbody</span>&nbsp;<span class="op" id="8540519">!=</span>&nbsp;<span class="ident" id="8540522">nil</span>&nbsp;<span class="op" id="8540526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540531">_</span><span class="op" id="8540532">,</span>&nbsp;<span class="ident" id="8540534">err</span>&nbsp;<span class="op" id="8540538">=</span>&nbsp;<span class="ident" id="8540540">io</span><span class="op" id="8540542">.</span><span class="ident" id="8540543">Copy</span><span class="op" id="8540547">(</span><span class="op" id="8540548">&amp;</span><span class="ident" id="8540549">bout</span><span class="op" id="8540553">,</span>&nbsp;<span class="ident" id="8540555">rbody</span><span class="op" id="8540560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540565">if</span>&nbsp;<span class="ident" id="8540568">err</span>&nbsp;<span class="op" id="8540572">!=</span>&nbsp;<span class="ident" id="8540575">nil</span>&nbsp;<span class="op" id="8540579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540585">t</span><span class="op" id="8540586">.</span><span class="ident" id="8540587">Errorf</span><span class="op" id="8540593">(</span><span class="string" id="8540594">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8540603">,</span>&nbsp;<span class="ident" id="8540605">i</span><span class="op" id="8540606">,</span>&nbsp;<span class="ident" id="8540608">err</span><span class="op" id="8540611">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540617">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540634">rbody</span><span class="op" id="8540639">.</span><span class="ident" id="8540640">Close</span><span class="op" id="8540645">(</span><span class="op" id="8540646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540654">body</span>&nbsp;<span class="op" id="8540659">:=</span>&nbsp;<span class="ident" id="8540662">bout</span><span class="op" id="8540666">.</span><span class="ident" id="8540667">String</span><span class="op" id="8540673">(</span><span class="op" id="8540674">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540678">if</span>&nbsp;<span class="ident" id="8540681">body</span>&nbsp;<span class="op" id="8540686">!=</span>&nbsp;<span class="ident" id="8540689">tt</span><span class="op" id="8540691">.</span><span class="ident" id="8540692">Body</span>&nbsp;<span class="op" id="8540697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540702">t</span><span class="op" id="8540703">.</span><span class="ident" id="8540704">Errorf</span><span class="op" id="8540710">(</span><span class="string" id="8540711">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8540735">,</span>&nbsp;<span class="ident" id="8540737">i</span><span class="op" id="8540738">,</span>&nbsp;<span class="ident" id="8540740">body</span><span class="op" id="8540744">,</span>&nbsp;<span class="ident" id="8540746">tt</span><span class="op" id="8540748">.</span><span class="ident" id="8540749">Body</span><span class="op" id="8540753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540760">}</span><br>
<span class="lineno"></span><span class="op" id="8540762">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="8540765">func</span>&nbsp;<span class="ident" id="8540770">TestWriteResponse</span><span class="op" id="8540787">(</span><span class="ident" id="8540788">t</span>&nbsp;<span class="op" id="8540790">*</span><span class="ident" id="8540791">testing</span><span class="op" id="8540798">.</span><span class="ident" id="8540799">T</span><span class="op" id="8540800">)</span>&nbsp;<span class="op" id="8540802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540805">for</span>&nbsp;<span class="ident" id="8540809">i</span><span class="op" id="8540810">,</span>&nbsp;<span class="ident" id="8540812">tt</span>&nbsp;<span class="op" id="8540815">:=</span>&nbsp;<span class="keyword" id="8540818">range</span>&nbsp;<span class="ident" id="8540824">respTests</span>&nbsp;<span class="op" id="8540834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540838">resp</span><span class="op" id="8540842">,</span>&nbsp;<span class="ident" id="8540844">err</span>&nbsp;<span class="op" id="8540848">:=</span>&nbsp;<span class="ident" id="8540851">ReadResponse</span><span class="op" id="8540863">(</span><span class="ident" id="8540864">bufio</span><span class="op" id="8540869">.</span><span class="ident" id="8540870">NewReader</span><span class="op" id="8540879">(</span><span class="ident" id="8540880">strings</span><span class="op" id="8540887">.</span><span class="ident" id="8540888">NewReader</span><span class="op" id="8540897">(</span><span class="ident" id="8540898">tt</span><span class="op" id="8540900">.</span><span class="ident" id="8540901">Raw</span><span class="op" id="8540904">)</span><span class="op" id="8540905">)</span><span class="op" id="8540906">,</span>&nbsp;<span class="ident" id="8540908">tt</span><span class="op" id="8540910">.</span><span class="ident" id="8540911">Resp</span><span class="op" id="8540915">.</span><span class="ident" id="8540916">Request</span><span class="op" id="8540923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540927">if</span>&nbsp;<span class="ident" id="8540930">err</span>&nbsp;<span class="op" id="8540934">!=</span>&nbsp;<span class="ident" id="8540937">nil</span>&nbsp;<span class="op" id="8540941">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540946">t</span><span class="op" id="8540947">.</span><span class="ident" id="8540948">Errorf</span><span class="op" id="8540954">(</span><span class="string" id="8540955">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8540964">,</span>&nbsp;<span class="ident" id="8540966">i</span><span class="op" id="8540967">,</span>&nbsp;<span class="ident" id="8540969">err</span><span class="op" id="8540972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8540977">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8540988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8540992">err</span>&nbsp;<span class="op" id="8540996">=</span>&nbsp;<span class="ident" id="8540998">resp</span><span class="op" id="8541002">.</span><span class="ident" id="8541003">Write</span><span class="op" id="8541008">(</span><span class="ident" id="8541009">ioutil</span><span class="op" id="8541015">.</span><span class="ident" id="8541016">Discard</span><span class="op" id="8541023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541027">if</span>&nbsp;<span class="ident" id="8541030">err</span>&nbsp;<span class="op" id="8541034">!=</span>&nbsp;<span class="ident" id="8541037">nil</span>&nbsp;<span class="op" id="8541041">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541046">t</span><span class="op" id="8541047">.</span><span class="ident" id="8541048">Errorf</span><span class="op" id="8541054">(</span><span class="string" id="8541055">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="8541064">,</span>&nbsp;<span class="ident" id="8541066">i</span><span class="op" id="8541067">,</span>&nbsp;<span class="ident" id="8541069">err</span><span class="op" id="8541072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541077">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541091">}</span><br>
<span class="lineno"></span><span class="op" id="8541093">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="8541096">var</span>&nbsp;<span class="ident" id="8541100">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8541131">=</span>&nbsp;<span class="op" id="8541133">[</span><span class="op" id="8541134">]</span><span class="keyword" id="8541135">struct</span>&nbsp;<span class="op" id="8541142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541145">chunked</span><span class="op" id="8541152">,</span>&nbsp;<span class="ident" id="8541154">compressed</span>&nbsp;<span class="builtintype" id="8541165">bool</span><br>
<span class="lineno"></span><span class="op" id="8541170">}</span><span class="op" id="8541171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541174">{</span><span class="builtintype" id="8541175">false</span><span class="op" id="8541180">,</span>&nbsp;<span class="builtintype" id="8541182">false</span><span class="op" id="8541187">}</span><span class="op" id="8541188">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541191">{</span><span class="builtintype" id="8541192">true</span><span class="op" id="8541196">,</span>&nbsp;<span class="builtintype" id="8541198">false</span><span class="op" id="8541203">}</span><span class="op" id="8541204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541207">{</span><span class="builtintype" id="8541208">true</span><span class="op" id="8541212">,</span>&nbsp;<span class="builtintype" id="8541214">true</span><span class="op" id="8541218">}</span><span class="op" id="8541219">,</span><br>
<span class="lineno"></span><span class="op" id="8541221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8541224">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="8541289">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="8541358">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="8541407">func</span>&nbsp;<span class="ident" id="8541412">TestReadResponseCloseInMiddle</span><span class="op" id="8541441">(</span><span class="ident" id="8541442">t</span>&nbsp;<span class="op" id="8541444">*</span><span class="ident" id="8541445">testing</span><span class="op" id="8541452">.</span><span class="ident" id="8541453">T</span><span class="op" id="8541454">)</span>&nbsp;<span class="op" id="8541456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541459">for</span>&nbsp;<span class="ident" id="8541463">_</span><span class="op" id="8541464">,</span>&nbsp;<span class="ident" id="8541466">test</span>&nbsp;<span class="op" id="8541471">:=</span>&nbsp;<span class="keyword" id="8541474">range</span>&nbsp;<span class="ident" id="8541480">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="8541511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541515">fatalf</span>&nbsp;<span class="op" id="8541522">:=</span>&nbsp;<span class="keyword" id="8541525">func</span><span class="op" id="8541529">(</span><span class="ident" id="8541530">format</span>&nbsp;<span class="builtintype" id="8541537">string</span><span class="op" id="8541543">,</span>&nbsp;<span class="ident" id="8541545">args</span>&nbsp;<span class="op" id="8541550">...</span><span class="keyword" id="8541553">interface</span><span class="op" id="8541562">{</span><span class="op" id="8541563">}</span><span class="op" id="8541564">)</span>&nbsp;<span class="op" id="8541566">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541571">args</span>&nbsp;<span class="op" id="8541576">=</span>&nbsp;<span class="builtinfunc" id="8541578">append</span><span class="op" id="8541584">(</span><span class="op" id="8541585">[</span><span class="op" id="8541586">]</span><span class="keyword" id="8541587">interface</span><span class="op" id="8541596">{</span><span class="op" id="8541597">}</span><span class="op" id="8541598">{</span><span class="ident" id="8541599">test</span><span class="op" id="8541603">.</span><span class="ident" id="8541604">chunked</span><span class="op" id="8541611">,</span>&nbsp;<span class="ident" id="8541613">test</span><span class="op" id="8541617">.</span><span class="ident" id="8541618">compressed</span><span class="op" id="8541628">}</span><span class="op" id="8541629">,</span>&nbsp;<span class="ident" id="8541631">args</span><span class="op" id="8541635">...</span><span class="op" id="8541638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541643">t</span><span class="op" id="8541644">.</span><span class="ident" id="8541645">Fatalf</span><span class="op" id="8541651">(</span><span class="string" id="8541652">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="8541689">+</span><span class="ident" id="8541690">format</span><span class="op" id="8541696">,</span>&nbsp;<span class="ident" id="8541698">args</span><span class="op" id="8541702">...</span><span class="op" id="8541705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541713">checkErr</span>&nbsp;<span class="op" id="8541722">:=</span>&nbsp;<span class="keyword" id="8541725">func</span><span class="op" id="8541729">(</span><span class="ident" id="8541730">err</span>&nbsp;<span class="builtintype" id="8541734">error</span><span class="op" id="8541739">,</span>&nbsp;<span class="ident" id="8541741">msg</span>&nbsp;<span class="builtintype" id="8541745">string</span><span class="op" id="8541751">)</span>&nbsp;<span class="op" id="8541753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541758">if</span>&nbsp;<span class="ident" id="8541761">err</span>&nbsp;<span class="op" id="8541765">==</span>&nbsp;<span class="ident" id="8541768">nil</span>&nbsp;<span class="op" id="8541772">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541778">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541793">fatalf</span><span class="op" id="8541799">(</span><span class="ident" id="8541800">msg</span><span class="op" id="8541803">+</span><span class="string" id="8541804">&#34;:&nbsp;%v&#34;</span><span class="op" id="8541810">,</span>&nbsp;<span class="ident" id="8541812">err</span><span class="op" id="8541815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541823">var</span>&nbsp;<span class="ident" id="8541827">buf</span>&nbsp;<span class="ident" id="8541831">bytes</span><span class="op" id="8541836">.</span><span class="ident" id="8541837">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541846">buf</span><span class="op" id="8541849">.</span><span class="ident" id="8541850">WriteString</span><span class="op" id="8541861">(</span><span class="string" id="8541862">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="8541883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8541887">if</span>&nbsp;<span class="ident" id="8541890">test</span><span class="op" id="8541894">.</span><span class="ident" id="8541895">chunked</span>&nbsp;<span class="op" id="8541903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541908">buf</span><span class="op" id="8541911">.</span><span class="ident" id="8541912">WriteString</span><span class="op" id="8541923">(</span><span class="string" id="8541924">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="8541956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8541960">}</span>&nbsp;<span class="keyword" id="8541962">else</span>&nbsp;<span class="op" id="8541967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8541972">buf</span><span class="op" id="8541975">.</span><span class="ident" id="8541976">WriteString</span><span class="op" id="8541987">(</span><span class="string" id="8541988">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="8542017">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542025">var</span>&nbsp;<span class="ident" id="8542029">wr</span>&nbsp;<span class="ident" id="8542032">io</span><span class="op" id="8542034">.</span><span class="ident" id="8542035">Writer</span>&nbsp;<span class="op" id="8542042">=</span>&nbsp;<span class="op" id="8542044">&amp;</span><span class="ident" id="8542045">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542051">if</span>&nbsp;<span class="ident" id="8542054">test</span><span class="op" id="8542058">.</span><span class="ident" id="8542059">chunked</span>&nbsp;<span class="op" id="8542067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542072">wr</span>&nbsp;<span class="op" id="8542075">=</span>&nbsp;<span class="ident" id="8542077">internal</span><span class="op" id="8542085">.</span><span class="ident" id="8542086">NewChunkedWriter</span><span class="op" id="8542102">(</span><span class="ident" id="8542103">wr</span><span class="op" id="8542105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542109">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542113">if</span>&nbsp;<span class="ident" id="8542116">test</span><span class="op" id="8542120">.</span><span class="ident" id="8542121">compressed</span>&nbsp;<span class="op" id="8542132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542137">buf</span><span class="op" id="8542140">.</span><span class="ident" id="8542141">WriteString</span><span class="op" id="8542152">(</span><span class="string" id="8542153">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="8542181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542186">wr</span>&nbsp;<span class="op" id="8542189">=</span>&nbsp;<span class="ident" id="8542191">gzip</span><span class="op" id="8542195">.</span><span class="ident" id="8542196">NewWriter</span><span class="op" id="8542205">(</span><span class="ident" id="8542206">wr</span><span class="op" id="8542208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542216">buf</span><span class="op" id="8542219">.</span><span class="ident" id="8542220">WriteString</span><span class="op" id="8542231">(</span><span class="string" id="8542232">&#34;\r\n&#34;</span><span class="op" id="8542238">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542243">chunk</span>&nbsp;<span class="op" id="8542249">:=</span>&nbsp;<span class="ident" id="8542252">bytes</span><span class="op" id="8542257">.</span><span class="ident" id="8542258">Repeat</span><span class="op" id="8542264">(</span><span class="op" id="8542265">[</span><span class="op" id="8542266">]</span><span class="builtintype" id="8542267">byte</span><span class="op" id="8542271">{</span><span class="string" id="8542272">&#39;x&#39;</span><span class="op" id="8542275">}</span><span class="op" id="8542276">,</span>&nbsp;<span class="num" id="8542278">1000</span><span class="op" id="8542282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542286">for</span>&nbsp;<span class="ident" id="8542290">i</span>&nbsp;<span class="op" id="8542292">:=</span>&nbsp;<span class="num" id="8542295">0</span><span class="op" id="8542296">;</span>&nbsp;<span class="ident" id="8542298">i</span>&nbsp;<span class="op" id="8542300">&lt;</span>&nbsp;<span class="num" id="8542302">1000</span><span class="op" id="8542306">;</span>&nbsp;<span class="ident" id="8542308">i</span><span class="op" id="8542309">++</span>&nbsp;<span class="op" id="8542312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542317">if</span>&nbsp;<span class="ident" id="8542320">test</span><span class="op" id="8542324">.</span><span class="ident" id="8542325">compressed</span>&nbsp;<span class="op" id="8542336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8542342">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542385">_</span><span class="op" id="8542386">,</span>&nbsp;<span class="ident" id="8542388">err</span>&nbsp;<span class="op" id="8542392">:=</span>&nbsp;<span class="ident" id="8542395">io</span><span class="op" id="8542397">.</span><span class="ident" id="8542398">ReadFull</span><span class="op" id="8542406">(</span><span class="ident" id="8542407">rand</span><span class="op" id="8542411">.</span><span class="ident" id="8542412">Reader</span><span class="op" id="8542418">,</span>&nbsp;<span class="ident" id="8542420">chunk</span><span class="op" id="8542425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542431">checkErr</span><span class="op" id="8542439">(</span><span class="ident" id="8542440">err</span><span class="op" id="8542443">,</span>&nbsp;<span class="string" id="8542445">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="8542467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542477">wr</span><span class="op" id="8542479">.</span><span class="ident" id="8542480">Write</span><span class="op" id="8542485">(</span><span class="ident" id="8542486">chunk</span><span class="op" id="8542491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542495">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542499">if</span>&nbsp;<span class="ident" id="8542502">test</span><span class="op" id="8542506">.</span><span class="ident" id="8542507">compressed</span>&nbsp;<span class="op" id="8542518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542523">err</span>&nbsp;<span class="op" id="8542527">:=</span>&nbsp;<span class="ident" id="8542530">wr</span><span class="op" id="8542532">.</span><span class="op" id="8542533">(</span><span class="op" id="8542534">*</span><span class="ident" id="8542535">gzip</span><span class="op" id="8542539">.</span><span class="ident" id="8542540">Writer</span><span class="op" id="8542546">)</span><span class="op" id="8542547">.</span><span class="ident" id="8542548">Close</span><span class="op" id="8542553">(</span><span class="op" id="8542554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542559">checkErr</span><span class="op" id="8542567">(</span><span class="ident" id="8542568">err</span><span class="op" id="8542571">,</span>&nbsp;<span class="string" id="8542573">&#34;compressor&nbsp;close&#34;</span><span class="op" id="8542591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542599">if</span>&nbsp;<span class="ident" id="8542602">test</span><span class="op" id="8542606">.</span><span class="ident" id="8542607">chunked</span>&nbsp;<span class="op" id="8542615">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542620">buf</span><span class="op" id="8542623">.</span><span class="ident" id="8542624">WriteString</span><span class="op" id="8542635">(</span><span class="string" id="8542636">&#34;0\r\n\r\n&#34;</span><span class="op" id="8542647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542655">buf</span><span class="op" id="8542658">.</span><span class="ident" id="8542659">WriteString</span><span class="op" id="8542670">(</span><span class="string" id="8542671">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8542690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542695">bufr</span>&nbsp;<span class="op" id="8542700">:=</span>&nbsp;<span class="ident" id="8542703">bufio</span><span class="op" id="8542708">.</span><span class="ident" id="8542709">NewReader</span><span class="op" id="8542718">(</span><span class="op" id="8542719">&amp;</span><span class="ident" id="8542720">buf</span><span class="op" id="8542723">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542727">resp</span><span class="op" id="8542731">,</span>&nbsp;<span class="ident" id="8542733">err</span>&nbsp;<span class="op" id="8542737">:=</span>&nbsp;<span class="ident" id="8542740">ReadResponse</span><span class="op" id="8542752">(</span><span class="ident" id="8542753">bufr</span><span class="op" id="8542757">,</span>&nbsp;<span class="ident" id="8542759">dummyReq</span><span class="op" id="8542767">(</span><span class="string" id="8542768">&#34;GET&#34;</span><span class="op" id="8542773">)</span><span class="op" id="8542774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542778">checkErr</span><span class="op" id="8542786">(</span><span class="ident" id="8542787">err</span><span class="op" id="8542790">,</span>&nbsp;<span class="string" id="8542792">&#34;ReadResponse&#34;</span><span class="op" id="8542806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542810">expectedLength</span>&nbsp;<span class="op" id="8542825">:=</span>&nbsp;<span class="ident" id="8542828">int64</span><span class="op" id="8542833">(</span><span class="op" id="8542834">-</span><span class="num" id="8542835">1</span><span class="op" id="8542836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542840">if</span>&nbsp;<span class="op" id="8542843">!</span><span class="ident" id="8542844">test</span><span class="op" id="8542848">.</span><span class="ident" id="8542849">chunked</span>&nbsp;<span class="op" id="8542857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542862">expectedLength</span>&nbsp;<span class="op" id="8542877">=</span>&nbsp;<span class="num" id="8542879">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8542889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8542893">if</span>&nbsp;<span class="ident" id="8542896">resp</span><span class="op" id="8542900">.</span><span class="ident" id="8542901">ContentLength</span>&nbsp;<span class="op" id="8542915">!=</span>&nbsp;<span class="ident" id="8542918">expectedLength</span>&nbsp;<span class="op" id="8542933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8542938">fatalf</span><span class="op" id="8542944">(</span><span class="string" id="8542945">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8542982">,</span>&nbsp;<span class="ident" id="8542984">expectedLength</span><span class="op" id="8542998">,</span>&nbsp;<span class="ident" id="8543000">resp</span><span class="op" id="8543004">.</span><span class="ident" id="8543005">ContentLength</span><span class="op" id="8543018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8543026">if</span>&nbsp;<span class="ident" id="8543029">resp</span><span class="op" id="8543033">.</span><span class="ident" id="8543034">Body</span>&nbsp;<span class="op" id="8543039">==</span>&nbsp;<span class="ident" id="8543042">nil</span>&nbsp;<span class="op" id="8543046">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543051">fatalf</span><span class="op" id="8543057">(</span><span class="string" id="8543058">&#34;nil&nbsp;body&#34;</span><span class="op" id="8543068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8543076">if</span>&nbsp;<span class="ident" id="8543079">test</span><span class="op" id="8543083">.</span><span class="ident" id="8543084">compressed</span>&nbsp;<span class="op" id="8543095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543100">gzReader</span><span class="op" id="8543108">,</span>&nbsp;<span class="ident" id="8543110">err</span>&nbsp;<span class="op" id="8543114">:=</span>&nbsp;<span class="ident" id="8543117">gzip</span><span class="op" id="8543121">.</span><span class="ident" id="8543122">NewReader</span><span class="op" id="8543131">(</span><span class="ident" id="8543132">resp</span><span class="op" id="8543136">.</span><span class="ident" id="8543137">Body</span><span class="op" id="8543141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543146">checkErr</span><span class="op" id="8543154">(</span><span class="ident" id="8543155">err</span><span class="op" id="8543158">,</span>&nbsp;<span class="string" id="8543160">&#34;gzip.NewReader&#34;</span><span class="op" id="8543176">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543181">resp</span><span class="op" id="8543185">.</span><span class="ident" id="8543186">Body</span>&nbsp;<span class="op" id="8543191">=</span>&nbsp;<span class="op" id="8543193">&amp;</span><span class="ident" id="8543194">readerAndCloser</span><span class="op" id="8543209">{</span><span class="ident" id="8543210">gzReader</span><span class="op" id="8543218">,</span>&nbsp;<span class="ident" id="8543220">resp</span><span class="op" id="8543224">.</span><span class="ident" id="8543225">Body</span><span class="op" id="8543229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543238">rbuf</span>&nbsp;<span class="op" id="8543243">:=</span>&nbsp;<span class="builtinfunc" id="8543246">make</span><span class="op" id="8543250">(</span><span class="op" id="8543251">[</span><span class="op" id="8543252">]</span><span class="builtintype" id="8543253">byte</span><span class="op" id="8543257">,</span>&nbsp;<span class="num" id="8543259">2500</span><span class="op" id="8543263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543267">n</span><span class="op" id="8543268">,</span>&nbsp;<span class="ident" id="8543270">err</span>&nbsp;<span class="op" id="8543274">:=</span>&nbsp;<span class="ident" id="8543277">io</span><span class="op" id="8543279">.</span><span class="ident" id="8543280">ReadFull</span><span class="op" id="8543288">(</span><span class="ident" id="8543289">resp</span><span class="op" id="8543293">.</span><span class="ident" id="8543294">Body</span><span class="op" id="8543298">,</span>&nbsp;<span class="ident" id="8543300">rbuf</span><span class="op" id="8543304">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543308">checkErr</span><span class="op" id="8543316">(</span><span class="ident" id="8543317">err</span><span class="op" id="8543320">,</span>&nbsp;<span class="string" id="8543322">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="8543342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8543346">if</span>&nbsp;<span class="ident" id="8543349">n</span>&nbsp;<span class="op" id="8543351">!=</span>&nbsp;<span class="num" id="8543354">2500</span>&nbsp;<span class="op" id="8543359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543364">fatalf</span><span class="op" id="8543370">(</span><span class="string" id="8543371">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="8543400">,</span>&nbsp;<span class="ident" id="8543402">n</span><span class="op" id="8543403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8543411">if</span>&nbsp;<span class="ident" id="8543414">test</span><span class="op" id="8543418">.</span><span class="ident" id="8543419">compressed</span>&nbsp;<span class="op" id="8543430">==</span>&nbsp;<span class="builtintype" id="8543433">false</span>&nbsp;<span class="op" id="8543439">&amp;&amp;</span>&nbsp;<span class="op" id="8543442">!</span><span class="ident" id="8543443">bytes</span><span class="op" id="8543448">.</span><span class="ident" id="8543449">Equal</span><span class="op" id="8543454">(</span><span class="ident" id="8543455">bytes</span><span class="op" id="8543460">.</span><span class="ident" id="8543461">Repeat</span><span class="op" id="8543467">(</span><span class="op" id="8543468">[</span><span class="op" id="8543469">]</span><span class="builtintype" id="8543470">byte</span><span class="op" id="8543474">{</span><span class="string" id="8543475">&#39;x&#39;</span><span class="op" id="8543478">}</span><span class="op" id="8543479">,</span>&nbsp;<span class="num" id="8543481">2500</span><span class="op" id="8543485">)</span><span class="op" id="8543486">,</span>&nbsp;<span class="ident" id="8543488">rbuf</span><span class="op" id="8543492">)</span>&nbsp;<span class="op" id="8543494">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543499">fatalf</span><span class="op" id="8543505">(</span><span class="string" id="8543506">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8543545">,</span>&nbsp;<span class="builtintype" id="8543547">string</span><span class="op" id="8543553">(</span><span class="ident" id="8543554">rbuf</span><span class="op" id="8543558">)</span><span class="op" id="8543559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543567">resp</span><span class="op" id="8543571">.</span><span class="ident" id="8543572">Body</span><span class="op" id="8543576">.</span><span class="ident" id="8543577">Close</span><span class="op" id="8543582">(</span><span class="op" id="8543583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543588">rest</span><span class="op" id="8543592">,</span>&nbsp;<span class="ident" id="8543594">err</span>&nbsp;<span class="op" id="8543598">:=</span>&nbsp;<span class="ident" id="8543601">ioutil</span><span class="op" id="8543607">.</span><span class="ident" id="8543608">ReadAll</span><span class="op" id="8543615">(</span><span class="ident" id="8543616">bufr</span><span class="op" id="8543620">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543624">checkErr</span><span class="op" id="8543632">(</span><span class="ident" id="8543633">err</span><span class="op" id="8543636">,</span>&nbsp;<span class="string" id="8543638">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="8543660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8543664">if</span>&nbsp;<span class="ident" id="8543667">e</span><span class="op" id="8543668">,</span>&nbsp;<span class="ident" id="8543670">g</span>&nbsp;<span class="op" id="8543672">:=</span>&nbsp;<span class="string" id="8543675">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="8543694">,</span>&nbsp;<span class="builtintype" id="8543696">string</span><span class="op" id="8543702">(</span><span class="ident" id="8543703">rest</span><span class="op" id="8543707">)</span><span class="op" id="8543708">;</span>&nbsp;<span class="ident" id="8543710">e</span>&nbsp;<span class="op" id="8543712">!=</span>&nbsp;<span class="ident" id="8543715">g</span>&nbsp;<span class="op" id="8543717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543722">g</span>&nbsp;<span class="op" id="8543724">=</span>&nbsp;<span class="ident" id="8543726">regexp</span><span class="op" id="8543732">.</span><span class="ident" id="8543733">MustCompile</span><span class="op" id="8543744">(</span><span class="string" id="8543745">`(xx+)`</span><span class="op" id="8543752">)</span><span class="op" id="8543753">.</span><span class="ident" id="8543754">ReplaceAllStringFunc</span><span class="op" id="8543774">(</span><span class="ident" id="8543775">g</span><span class="op" id="8543776">,</span>&nbsp;<span class="keyword" id="8543778">func</span><span class="op" id="8543782">(</span><span class="ident" id="8543783">match</span>&nbsp;<span class="builtintype" id="8543789">string</span><span class="op" id="8543795">)</span>&nbsp;<span class="builtintype" id="8543797">string</span>&nbsp;<span class="op" id="8543804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8543810">return</span>&nbsp;<span class="ident" id="8543817">fmt</span><span class="op" id="8543820">.</span><span class="ident" id="8543821">Sprintf</span><span class="op" id="8543828">(</span><span class="string" id="8543829">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="8543846">,</span>&nbsp;<span class="builtinfunc" id="8543848">len</span><span class="op" id="8543851">(</span><span class="ident" id="8543852">match</span><span class="op" id="8543857">)</span><span class="op" id="8543858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543863">}</span><span class="op" id="8543864">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543869">fatalf</span><span class="op" id="8543875">(</span><span class="string" id="8543876">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8543905">,</span>&nbsp;<span class="ident" id="8543907">g</span><span class="op" id="8543908">,</span>&nbsp;<span class="ident" id="8543910">e</span><span class="op" id="8543911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8543918">}</span><br>
<span class="lineno"></span><span class="op" id="8543920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="8543923">func</span>&nbsp;<span class="ident" id="8543928">diff</span><span class="op" id="8543932">(</span><span class="ident" id="8543933">t</span>&nbsp;<span class="op" id="8543935">*</span><span class="ident" id="8543936">testing</span><span class="op" id="8543943">.</span><span class="ident" id="8543944">T</span><span class="op" id="8543945">,</span>&nbsp;<span class="ident" id="8543947">prefix</span>&nbsp;<span class="builtintype" id="8543954">string</span><span class="op" id="8543960">,</span>&nbsp;<span class="ident" id="8543962">have</span><span class="op" id="8543966">,</span>&nbsp;<span class="ident" id="8543968">want</span>&nbsp;<span class="keyword" id="8543973">interface</span><span class="op" id="8543982">{</span><span class="op" id="8543983">}</span><span class="op" id="8543984">)</span>&nbsp;<span class="op" id="8543986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8543989">hv</span>&nbsp;<span class="op" id="8543992">:=</span>&nbsp;<span class="ident" id="8543995">reflect</span><span class="op" id="8544002">.</span><span class="ident" id="8544003">ValueOf</span><span class="op" id="8544010">(</span><span class="ident" id="8544011">have</span><span class="op" id="8544015">)</span><span class="op" id="8544016">.</span><span class="ident" id="8544017">Elem</span><span class="op" id="8544021">(</span><span class="op" id="8544022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544025">wv</span>&nbsp;<span class="op" id="8544028">:=</span>&nbsp;<span class="ident" id="8544031">reflect</span><span class="op" id="8544038">.</span><span class="ident" id="8544039">ValueOf</span><span class="op" id="8544046">(</span><span class="ident" id="8544047">want</span><span class="op" id="8544051">)</span><span class="op" id="8544052">.</span><span class="ident" id="8544053">Elem</span><span class="op" id="8544057">(</span><span class="op" id="8544058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8544061">if</span>&nbsp;<span class="ident" id="8544064">hv</span><span class="op" id="8544066">.</span><span class="ident" id="8544067">Type</span><span class="op" id="8544071">(</span><span class="op" id="8544072">)</span>&nbsp;<span class="op" id="8544074">!=</span>&nbsp;<span class="ident" id="8544077">wv</span><span class="op" id="8544079">.</span><span class="ident" id="8544080">Type</span><span class="op" id="8544084">(</span><span class="op" id="8544085">)</span>&nbsp;<span class="op" id="8544087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544091">t</span><span class="op" id="8544092">.</span><span class="ident" id="8544093">Errorf</span><span class="op" id="8544099">(</span><span class="string" id="8544100">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8544130">,</span>&nbsp;<span class="ident" id="8544132">prefix</span><span class="op" id="8544138">,</span>&nbsp;<span class="ident" id="8544140">hv</span><span class="op" id="8544142">.</span><span class="ident" id="8544143">Type</span><span class="op" id="8544147">(</span><span class="op" id="8544148">)</span><span class="op" id="8544149">,</span>&nbsp;<span class="ident" id="8544151">wv</span><span class="op" id="8544153">.</span><span class="ident" id="8544154">Type</span><span class="op" id="8544158">(</span><span class="op" id="8544159">)</span><span class="op" id="8544160">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8544163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8544166">for</span>&nbsp;<span class="ident" id="8544170">i</span>&nbsp;<span class="op" id="8544172">:=</span>&nbsp;<span class="num" id="8544175">0</span><span class="op" id="8544176">;</span>&nbsp;<span class="ident" id="8544178">i</span>&nbsp;<span class="op" id="8544180">&lt;</span>&nbsp;<span class="ident" id="8544182">hv</span><span class="op" id="8544184">.</span><span class="ident" id="8544185">NumField</span><span class="op" id="8544193">(</span><span class="op" id="8544194">)</span><span class="op" id="8544195">;</span>&nbsp;<span class="ident" id="8544197">i</span><span class="op" id="8544198">++</span>&nbsp;<span class="op" id="8544201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544205">hf</span>&nbsp;<span class="op" id="8544208">:=</span>&nbsp;<span class="ident" id="8544211">hv</span><span class="op" id="8544213">.</span><span class="ident" id="8544214">Field</span><span class="op" id="8544219">(</span><span class="ident" id="8544220">i</span><span class="op" id="8544221">)</span><span class="op" id="8544222">.</span><span class="ident" id="8544223">Interface</span><span class="op" id="8544232">(</span><span class="op" id="8544233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544237">wf</span>&nbsp;<span class="op" id="8544240">:=</span>&nbsp;<span class="ident" id="8544243">wv</span><span class="op" id="8544245">.</span><span class="ident" id="8544246">Field</span><span class="op" id="8544251">(</span><span class="ident" id="8544252">i</span><span class="op" id="8544253">)</span><span class="op" id="8544254">.</span><span class="ident" id="8544255">Interface</span><span class="op" id="8544264">(</span><span class="op" id="8544265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8544269">if</span>&nbsp;<span class="op" id="8544272">!</span><span class="ident" id="8544273">reflect</span><span class="op" id="8544280">.</span><span class="ident" id="8544281">DeepEqual</span><span class="op" id="8544290">(</span><span class="ident" id="8544291">hf</span><span class="op" id="8544293">,</span>&nbsp;<span class="ident" id="8544295">wf</span><span class="op" id="8544297">)</span>&nbsp;<span class="op" id="8544299">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544304">t</span><span class="op" id="8544305">.</span><span class="ident" id="8544306">Errorf</span><span class="op" id="8544312">(</span><span class="string" id="8544313">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8544334">,</span>&nbsp;<span class="ident" id="8544336">prefix</span><span class="op" id="8544342">,</span>&nbsp;<span class="ident" id="8544344">hv</span><span class="op" id="8544346">.</span><span class="ident" id="8544347">Type</span><span class="op" id="8544351">(</span><span class="op" id="8544352">)</span><span class="op" id="8544353">.</span><span class="ident" id="8544354">Field</span><span class="op" id="8544359">(</span><span class="ident" id="8544360">i</span><span class="op" id="8544361">)</span><span class="op" id="8544362">.</span><span class="ident" id="8544363">Name</span><span class="op" id="8544367">,</span>&nbsp;<span class="ident" id="8544369">hf</span><span class="op" id="8544371">,</span>&nbsp;<span class="ident" id="8544373">wf</span><span class="op" id="8544375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8544379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8544382">}</span><br>
<span class="lineno"></span><span class="op" id="8544384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="8544387">type</span>&nbsp;<span class="ident" id="8544392">responseLocationTest</span>&nbsp;<span class="keyword" id="8544413">struct</span>&nbsp;<span class="op" id="8544420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544423">location</span>&nbsp;<span class="builtintype" id="8544432">string</span>&nbsp;<span class="comment" id="8544439">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544476">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544485">string</span>&nbsp;<span class="comment" id="8544492">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544523">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544532">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544540">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="8544549">error</span><br>
<span class="lineno">570</span><span class="op" id="8544555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8544558">var</span>&nbsp;<span class="ident" id="8544562">responseLocationTests</span>&nbsp;<span class="op" id="8544584">=</span>&nbsp;<span class="op" id="8544586">[</span><span class="op" id="8544587">]</span><span class="ident" id="8544588">responseLocationTest</span><span class="op" id="8544608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8544611">{</span><span class="string" id="8544612">&#34;/foo&#34;</span><span class="op" id="8544618">,</span>&nbsp;<span class="string" id="8544620">&#34;http://bar.com/baz&#34;</span><span class="op" id="8544640">,</span>&nbsp;<span class="string" id="8544642">&#34;http://bar.com/foo&#34;</span><span class="op" id="8544662">,</span>&nbsp;<span class="ident" id="8544664">nil</span><span class="op" id="8544667">}</span><span class="op" id="8544668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8544671">{</span><span class="string" id="8544672">&#34;http://foo.com/&#34;</span><span class="op" id="8544689">,</span>&nbsp;<span class="string" id="8544691">&#34;http://bar.com/baz&#34;</span><span class="op" id="8544711">,</span>&nbsp;<span class="string" id="8544713">&#34;http://foo.com/&#34;</span><span class="op" id="8544730">,</span>&nbsp;<span class="ident" id="8544732">nil</span><span class="op" id="8544735">}</span><span class="op" id="8544736">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8544739">{</span><span class="string" id="8544740">&#34;&#34;</span><span class="op" id="8544742">,</span>&nbsp;<span class="string" id="8544744">&#34;http://bar.com/baz&#34;</span><span class="op" id="8544764">,</span>&nbsp;<span class="string" id="8544766">&#34;&#34;</span><span class="op" id="8544768">,</span>&nbsp;<span class="ident" id="8544770">ErrNoLocation</span><span class="op" id="8544783">}</span><span class="op" id="8544784">,</span><br>
<span class="lineno"></span><span class="op" id="8544786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8544789">func</span>&nbsp;<span class="ident" id="8544794">TestLocationResponse</span><span class="op" id="8544814">(</span><span class="ident" id="8544815">t</span>&nbsp;<span class="op" id="8544817">*</span><span class="ident" id="8544818">testing</span><span class="op" id="8544825">.</span><span class="ident" id="8544826">T</span><span class="op" id="8544827">)</span>&nbsp;<span class="op" id="8544829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8544832">for</span>&nbsp;<span class="ident" id="8544836">i</span><span class="op" id="8544837">,</span>&nbsp;<span class="ident" id="8544839">tt</span>&nbsp;<span class="op" id="8544842">:=</span>&nbsp;<span class="keyword" id="8544845">range</span>&nbsp;<span class="ident" id="8544851">responseLocationTests</span>&nbsp;<span class="op" id="8544873">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544877">res</span>&nbsp;<span class="op" id="8544881">:=</span>&nbsp;<span class="builtinfunc" id="8544884">new</span><span class="op" id="8544887">(</span><span class="ident" id="8544888">Response</span><span class="op" id="8544896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544900">res</span><span class="op" id="8544903">.</span><span class="ident" id="8544904">Header</span>&nbsp;<span class="op" id="8544911">=</span>&nbsp;<span class="builtinfunc" id="8544913">make</span><span class="op" id="8544917">(</span><span class="ident" id="8544918">Header</span><span class="op" id="8544924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544928">res</span><span class="op" id="8544931">.</span><span class="ident" id="8544932">Header</span><span class="op" id="8544938">.</span><span class="ident" id="8544939">Set</span><span class="op" id="8544942">(</span><span class="string" id="8544943">&#34;Location&#34;</span><span class="op" id="8544953">,</span>&nbsp;<span class="ident" id="8544955">tt</span><span class="op" id="8544957">.</span><span class="ident" id="8544958">location</span><span class="op" id="8544966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8544970">if</span>&nbsp;<span class="ident" id="8544973">tt</span><span class="op" id="8544975">.</span><span class="ident" id="8544976">requrl</span>&nbsp;<span class="op" id="8544983">!=</span>&nbsp;<span class="string" id="8544986">&#34;&#34;</span>&nbsp;<span class="op" id="8544989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8544994">res</span><span class="op" id="8544997">.</span><span class="ident" id="8544998">Request</span>&nbsp;<span class="op" id="8545006">=</span>&nbsp;<span class="op" id="8545008">&amp;</span><span class="ident" id="8545009">Request</span><span class="op" id="8545016">{</span><span class="op" id="8545017">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545022">var</span>&nbsp;<span class="ident" id="8545026">err</span>&nbsp;<span class="builtintype" id="8545030">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545039">res</span><span class="op" id="8545042">.</span><span class="ident" id="8545043">Request</span><span class="op" id="8545050">.</span><span class="ident" id="8545051">URL</span><span class="op" id="8545054">,</span>&nbsp;<span class="ident" id="8545056">err</span>&nbsp;<span class="op" id="8545060">=</span>&nbsp;<span class="ident" id="8545062">url</span><span class="op" id="8545065">.</span><span class="ident" id="8545066">Parse</span><span class="op" id="8545071">(</span><span class="ident" id="8545072">tt</span><span class="op" id="8545074">.</span><span class="ident" id="8545075">requrl</span><span class="op" id="8545081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545086">if</span>&nbsp;<span class="ident" id="8545089">err</span>&nbsp;<span class="op" id="8545093">!=</span>&nbsp;<span class="ident" id="8545096">nil</span>&nbsp;<span class="op" id="8545100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545106">t</span><span class="op" id="8545107">.</span><span class="ident" id="8545108">Fatalf</span><span class="op" id="8545114">(</span><span class="string" id="8545115">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8545136">,</span>&nbsp;<span class="ident" id="8545138">tt</span><span class="op" id="8545140">.</span><span class="ident" id="8545141">requrl</span><span class="op" id="8545147">,</span>&nbsp;<span class="ident" id="8545149">err</span><span class="op" id="8545152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545157">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545166">got</span><span class="op" id="8545169">,</span>&nbsp;<span class="ident" id="8545171">err</span>&nbsp;<span class="op" id="8545175">:=</span>&nbsp;<span class="ident" id="8545178">res</span><span class="op" id="8545181">.</span><span class="ident" id="8545182">Location</span><span class="op" id="8545190">(</span><span class="op" id="8545191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545195">if</span>&nbsp;<span class="ident" id="8545198">tt</span><span class="op" id="8545200">.</span><span class="ident" id="8545201">wantErr</span>&nbsp;<span class="op" id="8545209">!=</span>&nbsp;<span class="ident" id="8545212">nil</span>&nbsp;<span class="op" id="8545216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545221">if</span>&nbsp;<span class="ident" id="8545224">err</span>&nbsp;<span class="op" id="8545228">==</span>&nbsp;<span class="ident" id="8545231">nil</span>&nbsp;<span class="op" id="8545235">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545241">t</span><span class="op" id="8545242">.</span><span class="ident" id="8545243">Errorf</span><span class="op" id="8545249">(</span><span class="string" id="8545250">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8545272">,</span>&nbsp;<span class="ident" id="8545274">i</span><span class="op" id="8545275">,</span>&nbsp;<span class="ident" id="8545277">tt</span><span class="op" id="8545279">.</span><span class="ident" id="8545280">wantErr</span><span class="op" id="8545287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545293">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545310">if</span>&nbsp;<span class="ident" id="8545313">g</span><span class="op" id="8545314">,</span>&nbsp;<span class="ident" id="8545316">e</span>&nbsp;<span class="op" id="8545318">:=</span>&nbsp;<span class="ident" id="8545321">err</span><span class="op" id="8545324">.</span><span class="ident" id="8545325">Error</span><span class="op" id="8545330">(</span><span class="op" id="8545331">)</span><span class="op" id="8545332">,</span>&nbsp;<span class="ident" id="8545334">tt</span><span class="op" id="8545336">.</span><span class="ident" id="8545337">wantErr</span><span class="op" id="8545344">.</span><span class="ident" id="8545345">Error</span><span class="op" id="8545350">(</span><span class="op" id="8545351">)</span><span class="op" id="8545352">;</span>&nbsp;<span class="ident" id="8545354">g</span>&nbsp;<span class="op" id="8545356">!=</span>&nbsp;<span class="ident" id="8545359">e</span>&nbsp;<span class="op" id="8545361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545367">t</span><span class="op" id="8545368">.</span><span class="ident" id="8545369">Errorf</span><span class="op" id="8545375">(</span><span class="string" id="8545376">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8545397">,</span>&nbsp;<span class="ident" id="8545399">i</span><span class="op" id="8545400">,</span>&nbsp;<span class="ident" id="8545402">g</span><span class="op" id="8545403">,</span>&nbsp;<span class="ident" id="8545405">e</span><span class="op" id="8545406">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545412">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545429">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545444">if</span>&nbsp;<span class="ident" id="8545447">err</span>&nbsp;<span class="op" id="8545451">!=</span>&nbsp;<span class="ident" id="8545454">nil</span>&nbsp;<span class="op" id="8545458">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545463">t</span><span class="op" id="8545464">.</span><span class="ident" id="8545465">Errorf</span><span class="op" id="8545471">(</span><span class="string" id="8545472">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="8545484">,</span>&nbsp;<span class="ident" id="8545486">i</span><span class="op" id="8545487">,</span>&nbsp;<span class="ident" id="8545489">err</span><span class="op" id="8545492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545497">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545512">if</span>&nbsp;<span class="ident" id="8545515">g</span><span class="op" id="8545516">,</span>&nbsp;<span class="ident" id="8545518">e</span>&nbsp;<span class="op" id="8545520">:=</span>&nbsp;<span class="ident" id="8545523">got</span><span class="op" id="8545526">.</span><span class="ident" id="8545527">String</span><span class="op" id="8545533">(</span><span class="op" id="8545534">)</span><span class="op" id="8545535">,</span>&nbsp;<span class="ident" id="8545537">tt</span><span class="op" id="8545539">.</span><span class="ident" id="8545540">want</span><span class="op" id="8545544">;</span>&nbsp;<span class="ident" id="8545546">g</span>&nbsp;<span class="op" id="8545548">!=</span>&nbsp;<span class="ident" id="8545551">e</span>&nbsp;<span class="op" id="8545553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545558">t</span><span class="op" id="8545559">.</span><span class="ident" id="8545560">Errorf</span><span class="op" id="8545566">(</span><span class="string" id="8545567">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8545593">,</span>&nbsp;<span class="ident" id="8545595">i</span><span class="op" id="8545596">,</span>&nbsp;<span class="ident" id="8545598">g</span><span class="op" id="8545599">,</span>&nbsp;<span class="ident" id="8545601">e</span><span class="op" id="8545602">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545609">}</span><br>
<span class="lineno"></span><span class="op" id="8545611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545614">func</span>&nbsp;<span class="ident" id="8545619">TestResponseStatusStutter</span><span class="op" id="8545644">(</span><span class="ident" id="8545645">t</span>&nbsp;<span class="op" id="8545647">*</span><span class="ident" id="8545648">testing</span><span class="op" id="8545655">.</span><span class="ident" id="8545656">T</span><span class="op" id="8545657">)</span>&nbsp;<span class="op" id="8545659">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545662">r</span>&nbsp;<span class="op" id="8545664">:=</span>&nbsp;<span class="op" id="8545667">&amp;</span><span class="ident" id="8545668">Response</span><span class="op" id="8545676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545680">Status</span><span class="op" id="8545686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8545692">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="8545709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545713">StatusCode</span><span class="op" id="8545723">:</span>&nbsp;<span class="num" id="8545725">123</span><span class="op" id="8545728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545732">ProtoMajor</span><span class="op" id="8545742">:</span>&nbsp;<span class="num" id="8545744">1</span><span class="op" id="8545745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545749">ProtoMinor</span><span class="op" id="8545759">:</span>&nbsp;<span class="num" id="8545761">3</span><span class="op" id="8545762">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545768">var</span>&nbsp;<span class="ident" id="8545772">buf</span>&nbsp;<span class="ident" id="8545776">bytes</span><span class="op" id="8545781">.</span><span class="ident" id="8545782">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545790">r</span><span class="op" id="8545791">.</span><span class="ident" id="8545792">Write</span><span class="op" id="8545797">(</span><span class="op" id="8545798">&amp;</span><span class="ident" id="8545799">buf</span><span class="op" id="8545802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545805">if</span>&nbsp;<span class="ident" id="8545808">strings</span><span class="op" id="8545815">.</span><span class="ident" id="8545816">Contains</span><span class="op" id="8545824">(</span><span class="ident" id="8545825">buf</span><span class="op" id="8545828">.</span><span class="ident" id="8545829">String</span><span class="op" id="8545835">(</span><span class="op" id="8545836">)</span><span class="op" id="8545837">,</span>&nbsp;<span class="string" id="8545839">&#34;123&nbsp;123&#34;</span><span class="op" id="8545848">)</span>&nbsp;<span class="op" id="8545850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8545854">t</span><span class="op" id="8545855">.</span><span class="ident" id="8545856">Errorf</span><span class="op" id="8545862">(</span><span class="string" id="8545863">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="8545886">,</span>&nbsp;<span class="ident" id="8545888">buf</span><span class="op" id="8545891">.</span><span class="ident" id="8545892">String</span><span class="op" id="8545898">(</span><span class="op" id="8545899">)</span><span class="op" id="8545900">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8545903">}</span><br>
<span class="lineno"></span><span class="op" id="8545905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545908">func</span>&nbsp;<span class="ident" id="8545913">TestResponseContentLengthShortBody</span><span class="op" id="8545947">(</span><span class="ident" id="8545948">t</span>&nbsp;<span class="op" id="8545950">*</span><span class="ident" id="8545951">testing</span><span class="op" id="8545958">.</span><span class="ident" id="8545959">T</span><span class="op" id="8545960">)</span>&nbsp;<span class="op" id="8545962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8545965">const</span>&nbsp;<span class="ident" id="8545971">shortBody</span>&nbsp;<span class="op" id="8545981">=</span>&nbsp;<span class="string" id="8545983">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546013">br</span>&nbsp;<span class="op" id="8546016">:=</span>&nbsp;<span class="ident" id="8546019">bufio</span><span class="op" id="8546024">.</span><span class="ident" id="8546025">NewReader</span><span class="op" id="8546034">(</span><span class="ident" id="8546035">strings</span><span class="op" id="8546042">.</span><span class="ident" id="8546043">NewReader</span><span class="op" id="8546052">(</span><span class="string" id="8546053">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="8546075">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546079">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="8546105">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546109">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8546116">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546120">shortBody</span><span class="op" id="8546129">)</span><span class="op" id="8546130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546133">res</span><span class="op" id="8546136">,</span>&nbsp;<span class="ident" id="8546138">err</span>&nbsp;<span class="op" id="8546142">:=</span>&nbsp;<span class="ident" id="8546145">ReadResponse</span><span class="op" id="8546157">(</span><span class="ident" id="8546158">br</span><span class="op" id="8546160">,</span>&nbsp;<span class="op" id="8546162">&amp;</span><span class="ident" id="8546163">Request</span><span class="op" id="8546170">{</span><span class="ident" id="8546171">Method</span><span class="op" id="8546177">:</span>&nbsp;<span class="string" id="8546179">&#34;GET&#34;</span><span class="op" id="8546184">}</span><span class="op" id="8546185">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546188">if</span>&nbsp;<span class="ident" id="8546191">err</span>&nbsp;<span class="op" id="8546195">!=</span>&nbsp;<span class="ident" id="8546198">nil</span>&nbsp;<span class="op" id="8546202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546206">t</span><span class="op" id="8546207">.</span><span class="ident" id="8546208">Fatal</span><span class="op" id="8546213">(</span><span class="ident" id="8546214">err</span><span class="op" id="8546217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546223">if</span>&nbsp;<span class="ident" id="8546226">res</span><span class="op" id="8546229">.</span><span class="ident" id="8546230">ContentLength</span>&nbsp;<span class="op" id="8546244">!=</span>&nbsp;<span class="num" id="8546247">123</span>&nbsp;<span class="op" id="8546251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546255">t</span><span class="op" id="8546256">.</span><span class="ident" id="8546257">Fatalf</span><span class="op" id="8546263">(</span><span class="string" id="8546264">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="8546295">,</span>&nbsp;<span class="ident" id="8546297">res</span><span class="op" id="8546300">.</span><span class="ident" id="8546301">ContentLength</span><span class="op" id="8546314">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546320">var</span>&nbsp;<span class="ident" id="8546324">buf</span>&nbsp;<span class="ident" id="8546328">bytes</span><span class="op" id="8546333">.</span><span class="ident" id="8546334">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546342">n</span><span class="op" id="8546343">,</span>&nbsp;<span class="ident" id="8546345">err</span>&nbsp;<span class="op" id="8546349">:=</span>&nbsp;<span class="ident" id="8546352">io</span><span class="op" id="8546354">.</span><span class="ident" id="8546355">Copy</span><span class="op" id="8546359">(</span><span class="op" id="8546360">&amp;</span><span class="ident" id="8546361">buf</span><span class="op" id="8546364">,</span>&nbsp;<span class="ident" id="8546366">res</span><span class="op" id="8546369">.</span><span class="ident" id="8546370">Body</span><span class="op" id="8546374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546377">if</span>&nbsp;<span class="ident" id="8546380">n</span>&nbsp;<span class="op" id="8546382">!=</span>&nbsp;<span class="ident" id="8546385">int64</span><span class="op" id="8546390">(</span><span class="builtinfunc" id="8546391">len</span><span class="op" id="8546394">(</span><span class="ident" id="8546395">shortBody</span><span class="op" id="8546404">)</span><span class="op" id="8546405">)</span>&nbsp;<span class="op" id="8546407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546411">t</span><span class="op" id="8546412">.</span><span class="ident" id="8546413">Errorf</span><span class="op" id="8546419">(</span><span class="string" id="8546420">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="8546455">,</span>&nbsp;<span class="ident" id="8546457">n</span><span class="op" id="8546458">,</span>&nbsp;<span class="builtinfunc" id="8546460">len</span><span class="op" id="8546463">(</span><span class="ident" id="8546464">shortBody</span><span class="op" id="8546473">)</span><span class="op" id="8546474">,</span>&nbsp;<span class="ident" id="8546476">shortBody</span><span class="op" id="8546485">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546491">if</span>&nbsp;<span class="ident" id="8546494">buf</span><span class="op" id="8546497">.</span><span class="ident" id="8546498">String</span><span class="op" id="8546504">(</span><span class="op" id="8546505">)</span>&nbsp;<span class="op" id="8546507">!=</span>&nbsp;<span class="ident" id="8546510">shortBody</span>&nbsp;<span class="op" id="8546520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546524">t</span><span class="op" id="8546525">.</span><span class="ident" id="8546526">Errorf</span><span class="op" id="8546532">(</span><span class="string" id="8546533">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8546556">,</span>&nbsp;<span class="ident" id="8546558">buf</span><span class="op" id="8546561">.</span><span class="ident" id="8546562">String</span><span class="op" id="8546568">(</span><span class="op" id="8546569">)</span><span class="op" id="8546570">,</span>&nbsp;<span class="ident" id="8546572">shortBody</span><span class="op" id="8546581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546587">if</span>&nbsp;<span class="ident" id="8546590">err</span>&nbsp;<span class="op" id="8546594">!=</span>&nbsp;<span class="ident" id="8546597">io</span><span class="op" id="8546599">.</span><span class="ident" id="8546600">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8546617">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546621">t</span><span class="op" id="8546622">.</span><span class="ident" id="8546623">Errorf</span><span class="op" id="8546629">(</span><span class="string" id="8546630">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8546677">,</span>&nbsp;<span class="ident" id="8546679">err</span><span class="op" id="8546682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546685">}</span><br>
<span class="lineno"></span><span class="op" id="8546687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8546690">func</span>&nbsp;<span class="ident" id="8546695">TestReadResponseUnexpectedEOF</span><span class="op" id="8546724">(</span><span class="ident" id="8546725">t</span>&nbsp;<span class="op" id="8546727">*</span><span class="ident" id="8546728">testing</span><span class="op" id="8546735">.</span><span class="ident" id="8546736">T</span><span class="op" id="8546737">)</span>&nbsp;<span class="op" id="8546739">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546742">br</span>&nbsp;<span class="op" id="8546745">:=</span>&nbsp;<span class="ident" id="8546748">bufio</span><span class="op" id="8546753">.</span><span class="ident" id="8546754">NewReader</span><span class="op" id="8546763">(</span><span class="ident" id="8546764">strings</span><span class="op" id="8546771">.</span><span class="ident" id="8546772">NewReader</span><span class="op" id="8546781">(</span><span class="string" id="8546782">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="8546819">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8546823">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="8546853">)</span><span class="op" id="8546854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546857">_</span><span class="op" id="8546858">,</span>&nbsp;<span class="ident" id="8546860">err</span>&nbsp;<span class="op" id="8546864">:=</span>&nbsp;<span class="ident" id="8546867">ReadResponse</span><span class="op" id="8546879">(</span><span class="ident" id="8546880">br</span><span class="op" id="8546882">,</span>&nbsp;<span class="ident" id="8546884">nil</span><span class="op" id="8546887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8546890">if</span>&nbsp;<span class="ident" id="8546893">err</span>&nbsp;<span class="op" id="8546897">!=</span>&nbsp;<span class="ident" id="8546900">io</span><span class="op" id="8546902">.</span><span class="ident" id="8546903">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="8546920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8546924">t</span><span class="op" id="8546925">.</span><span class="ident" id="8546926">Errorf</span><span class="op" id="8546932">(</span><span class="string" id="8546933">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="8546978">,</span>&nbsp;<span class="ident" id="8546980">err</span><span class="op" id="8546983">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8546986">}</span><br>
<span class="lineno"></span><span class="op" id="8546988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8546991">func</span>&nbsp;<span class="ident" id="8546996">TestNeedsSniff</span><span class="op" id="8547010">(</span><span class="ident" id="8547011">t</span>&nbsp;<span class="op" id="8547013">*</span><span class="ident" id="8547014">testing</span><span class="op" id="8547021">.</span><span class="ident" id="8547022">T</span><span class="op" id="8547023">)</span>&nbsp;<span class="op" id="8547025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8547028">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547080">r</span>&nbsp;<span class="op" id="8547082">:=</span>&nbsp;<span class="op" id="8547085">&amp;</span><span class="ident" id="8547086">response</span><span class="op" id="8547094">{</span><span class="op" id="8547095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547098">if</span>&nbsp;<span class="ident" id="8547101">got</span><span class="op" id="8547104">,</span>&nbsp;<span class="ident" id="8547106">want</span>&nbsp;<span class="op" id="8547111">:=</span>&nbsp;<span class="ident" id="8547114">r</span><span class="op" id="8547115">.</span><span class="ident" id="8547116">needsSniff</span><span class="op" id="8547126">(</span><span class="op" id="8547127">)</span><span class="op" id="8547128">,</span>&nbsp;<span class="builtintype" id="8547130">true</span><span class="op" id="8547134">;</span>&nbsp;<span class="ident" id="8547136">got</span>&nbsp;<span class="op" id="8547140">!=</span>&nbsp;<span class="ident" id="8547143">want</span>&nbsp;<span class="op" id="8547148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547152">t</span><span class="op" id="8547153">.</span><span class="ident" id="8547154">Errorf</span><span class="op" id="8547160">(</span><span class="string" id="8547161">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8547187">,</span>&nbsp;<span class="ident" id="8547189">got</span><span class="op" id="8547192">,</span>&nbsp;<span class="ident" id="8547194">want</span><span class="op" id="8547198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8547204">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547258">r</span><span class="op" id="8547259">.</span><span class="ident" id="8547260">handlerHeader</span>&nbsp;<span class="op" id="8547274">=</span>&nbsp;<span class="ident" id="8547276">Header</span><span class="op" id="8547282">{</span><span class="string" id="8547283">&#34;Content-Type&#34;</span><span class="op" id="8547297">:</span>&nbsp;<span class="ident" id="8547299">nil</span><span class="op" id="8547302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8547305">if</span>&nbsp;<span class="ident" id="8547308">got</span><span class="op" id="8547311">,</span>&nbsp;<span class="ident" id="8547313">want</span>&nbsp;<span class="op" id="8547318">:=</span>&nbsp;<span class="ident" id="8547321">r</span><span class="op" id="8547322">.</span><span class="ident" id="8547323">needsSniff</span><span class="op" id="8547333">(</span><span class="op" id="8547334">)</span><span class="op" id="8547335">,</span>&nbsp;<span class="builtintype" id="8547337">false</span><span class="op" id="8547342">;</span>&nbsp;<span class="ident" id="8547344">got</span>&nbsp;<span class="op" id="8547348">!=</span>&nbsp;<span class="ident" id="8547351">want</span>&nbsp;<span class="op" id="8547356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8547360">t</span><span class="op" id="8547361">.</span><span class="ident" id="8547362">Errorf</span><span class="op" id="8547368">(</span><span class="string" id="8547369">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="8547414">,</span>&nbsp;<span class="ident" id="8547416">got</span><span class="op" id="8547419">,</span>&nbsp;<span class="ident" id="8547421">want</span><span class="op" id="8547425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8547428">}</span><br>
<span class="lineno"></span><span class="op" id="8547430">}</span>
</div>
</body>
</html>
