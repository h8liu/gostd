<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3591986">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3592041">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3592095">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3592146">package</span>&nbsp;<span class="ident" id="3592154">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592160">import</span>&nbsp;<span class="op" id="3592167">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3592170">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3592179">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3592189">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3592196">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3592204">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3592215">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3592225">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3592228">//&nbsp;FormatMediaType&nbsp;serializes&nbsp;mediatype&nbsp;t&nbsp;and&nbsp;the&nbsp;parameters</span><br>
<span class="lineno"></span><span class="comment" id="3592289">//&nbsp;param&nbsp;as&nbsp;a&nbsp;media&nbsp;type&nbsp;conforming&nbsp;to&nbsp;RFC&nbsp;2045&nbsp;and&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3592351">//&nbsp;The&nbsp;type&nbsp;and&nbsp;parameter&nbsp;names&nbsp;are&nbsp;written&nbsp;in&nbsp;lower-case.</span><br>
<span class="lineno"></span><span class="comment" id="3592410">//&nbsp;When&nbsp;any&nbsp;of&nbsp;the&nbsp;arguments&nbsp;result&nbsp;in&nbsp;a&nbsp;standard&nbsp;violation&nbsp;then</span><br>
<span class="lineno">20</span><span class="comment" id="3592475">//&nbsp;FormatMediaType&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3592520">func</span>&nbsp;<span class="ident" id="3592525">FormatMediaType</span><span class="op" id="3592540">(</span><span class="ident" id="3592541">t</span>&nbsp;<span class="builtintype" id="3592543">string</span><span class="op" id="3592549">,</span>&nbsp;<span class="ident" id="3592551">param</span>&nbsp;<span class="keyword" id="3592557">map</span><span class="op" id="3592560">[</span><span class="builtintype" id="3592561">string</span><span class="op" id="3592567">]</span><span class="builtintype" id="3592568">string</span><span class="op" id="3592574">)</span>&nbsp;<span class="builtintype" id="3592576">string</span>&nbsp;<span class="op" id="3592583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592586">slash</span>&nbsp;<span class="op" id="3592592">:=</span>&nbsp;<span class="ident" id="3592595"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3592602">.</span><span class="ident" id="3592603">Index</span><span class="op" id="3592608">(</span><span class="ident" id="3592609"><a href="/mime/mediatype.go.html#3592541">t</a></span><span class="op" id="3592610">,</span>&nbsp;<span class="string" id="3592612">&#34;/&#34;</span><span class="op" id="3592615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592618">if</span>&nbsp;<span class="ident" id="3592621"><a href="/mime/mediatype.go.html#3592586">slash</a></span>&nbsp;<span class="op" id="3592627">==</span>&nbsp;<span class="op" id="3592630">-</span><span class="num" id="3592631">1</span>&nbsp;<span class="op" id="3592633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592637">return</span>&nbsp;<span class="string" id="3592644">&#34;&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3592648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592651">major</span><span class="op" id="3592656">,</span>&nbsp;<span class="ident" id="3592658">sub</span>&nbsp;<span class="op" id="3592662">:=</span>&nbsp;<span class="ident" id="3592665"><a href="/mime/mediatype.go.html#3592541">t</a></span><span class="op" id="3592666">[</span><span class="op" id="3592667">:</span><span class="ident" id="3592668"><a href="/mime/mediatype.go.html#3592586">slash</a></span><span class="op" id="3592673">]</span><span class="op" id="3592674">,</span>&nbsp;<span class="ident" id="3592676"><a href="/mime/mediatype.go.html#3592541">t</a></span><span class="op" id="3592677">[</span><span class="ident" id="3592678"><a href="/mime/mediatype.go.html#3592586">slash</a></span><span class="op" id="3592683">+</span><span class="num" id="3592684">1</span><span class="op" id="3592685">:</span><span class="op" id="3592686">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592689">if</span>&nbsp;<span class="op" id="3592692">!</span><span class="ident" id="3592693"><a href="/mime/grammar.go.html#3591877">isToken</a></span><span class="op" id="3592700">(</span><span class="ident" id="3592701"><a href="/mime/mediatype.go.html#3592651">major</a></span><span class="op" id="3592706">)</span>&nbsp;<span class="op" id="3592708">||</span>&nbsp;<span class="op" id="3592711">!</span><span class="ident" id="3592712"><a href="/mime/grammar.go.html#3591877">isToken</a></span><span class="op" id="3592719">(</span><span class="ident" id="3592720"><a href="/mime/mediatype.go.html#3592658">sub</a></span><span class="op" id="3592723">)</span>&nbsp;<span class="op" id="3592725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592729">return</span>&nbsp;<span class="string" id="3592736">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3592740">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592743">var</span>&nbsp;<span class="ident" id="3592747">b</span>&nbsp;<span class="ident" id="3592749"><a href="/mime/mediatype.go.html#3592170">bytes</a></span><span class="op" id="3592754">.</span><span class="ident" id="3592755">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592763"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3592764">.</span><span class="ident" id="3592765">WriteString</span><span class="op" id="3592776">(</span><span class="ident" id="3592777"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3592784">.</span><span class="ident" id="3592785">ToLower</span><span class="op" id="3592792">(</span><span class="ident" id="3592793"><a href="/mime/mediatype.go.html#3592651">major</a></span><span class="op" id="3592798">)</span><span class="op" id="3592799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592802"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3592803">.</span><span class="ident" id="3592804">WriteByte</span><span class="op" id="3592813">(</span><span class="string" id="3592814">&#39;/&#39;</span><span class="op" id="3592817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592820"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3592821">.</span><span class="ident" id="3592822">WriteString</span><span class="op" id="3592833">(</span><span class="ident" id="3592834"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3592841">.</span><span class="ident" id="3592842">ToLower</span><span class="op" id="3592849">(</span><span class="ident" id="3592850"><a href="/mime/mediatype.go.html#3592658">sub</a></span><span class="op" id="3592853">)</span><span class="op" id="3592854">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592858">attrs</span>&nbsp;<span class="op" id="3592864">:=</span>&nbsp;<span class="builtinfunc" id="3592867">make</span><span class="op" id="3592871">(</span><span class="op" id="3592872">[</span><span class="op" id="3592873">]</span><span class="builtintype" id="3592874">string</span><span class="op" id="3592880">,</span>&nbsp;<span class="num" id="3592882">0</span><span class="op" id="3592883">,</span>&nbsp;<span class="builtinfunc" id="3592885">len</span><span class="op" id="3592888">(</span><span class="ident" id="3592889"><a href="/mime/mediatype.go.html#3592551">param</a></span><span class="op" id="3592894">)</span><span class="op" id="3592895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592898">for</span>&nbsp;<span class="ident" id="3592902">a</span>&nbsp;<span class="op" id="3592904">:=</span>&nbsp;<span class="keyword" id="3592907">range</span>&nbsp;<span class="ident" id="3592913"><a href="/mime/mediatype.go.html#3592551">param</a></span>&nbsp;<span class="op" id="3592919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592923"><a href="/mime/mediatype.go.html#3592858">attrs</a></span>&nbsp;<span class="op" id="3592929">=</span>&nbsp;<span class="builtinfunc" id="3592931">append</span><span class="op" id="3592937">(</span><span class="ident" id="3592938"><a href="/mime/mediatype.go.html#3592858">attrs</a></span><span class="op" id="3592943">,</span>&nbsp;<span class="ident" id="3592945"><a href="/mime/mediatype.go.html#3592902">a</a></span><span class="op" id="3592946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3592949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592952"><a href="/mime/mediatype.go.html#3592196">sort</a></span><span class="op" id="3592956">.</span><span class="ident" id="3592957">Strings</span><span class="op" id="3592964">(</span><span class="ident" id="3592965"><a href="/mime/mediatype.go.html#3592858">attrs</a></span><span class="op" id="3592970">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592974">for</span>&nbsp;<span class="ident" id="3592978">_</span><span class="op" id="3592979">,</span>&nbsp;<span class="ident" id="3592981">attribute</span>&nbsp;<span class="op" id="3592991">:=</span>&nbsp;<span class="keyword" id="3592994">range</span>&nbsp;<span class="ident" id="3593000"><a href="/mime/mediatype.go.html#3592858">attrs</a></span>&nbsp;<span class="op" id="3593006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593010">value</span>&nbsp;<span class="op" id="3593016">:=</span>&nbsp;<span class="ident" id="3593019"><a href="/mime/mediatype.go.html#3592551">param</a></span><span class="op" id="3593024">[</span><span class="ident" id="3593025"><a href="/mime/mediatype.go.html#3592981">attribute</a></span><span class="op" id="3593034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593038"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593039">.</span><span class="ident" id="3593040">WriteByte</span><span class="op" id="3593049">(</span><span class="string" id="3593050">&#39;;&#39;</span><span class="op" id="3593053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593057"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593058">.</span><span class="ident" id="3593059">WriteByte</span><span class="op" id="3593068">(</span><span class="string" id="3593069">&#39;&nbsp;&#39;</span><span class="op" id="3593072">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593076">if</span>&nbsp;<span class="op" id="3593079">!</span><span class="ident" id="3593080"><a href="/mime/grammar.go.html#3591877">isToken</a></span><span class="op" id="3593087">(</span><span class="ident" id="3593088"><a href="/mime/mediatype.go.html#3592981">attribute</a></span><span class="op" id="3593097">)</span>&nbsp;<span class="op" id="3593099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593104">return</span>&nbsp;<span class="string" id="3593111">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593120"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593121">.</span><span class="ident" id="3593122">WriteString</span><span class="op" id="3593133">(</span><span class="ident" id="3593134"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3593141">.</span><span class="ident" id="3593142">ToLower</span><span class="op" id="3593149">(</span><span class="ident" id="3593150"><a href="/mime/mediatype.go.html#3592981">attribute</a></span><span class="op" id="3593159">)</span><span class="op" id="3593160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593164"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593165">.</span><span class="ident" id="3593166">WriteByte</span><span class="op" id="3593175">(</span><span class="string" id="3593176">&#39;=&#39;</span><span class="op" id="3593179">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593183">if</span>&nbsp;<span class="ident" id="3593186"><a href="/mime/grammar.go.html#3591877">isToken</a></span><span class="op" id="3593193">(</span><span class="ident" id="3593194"><a href="/mime/mediatype.go.html#3593010">value</a></span><span class="op" id="3593199">)</span>&nbsp;<span class="op" id="3593201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593206"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593207">.</span><span class="ident" id="3593208">WriteString</span><span class="op" id="3593219">(</span><span class="ident" id="3593220"><a href="/mime/mediatype.go.html#3593010">value</a></span><span class="op" id="3593225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593230">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593246"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593247">.</span><span class="ident" id="3593248">WriteByte</span><span class="op" id="3593257">(</span><span class="string" id="3593258">&#39;&#34;&#39;</span><span class="op" id="3593261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593265">offset</span>&nbsp;<span class="op" id="3593272">:=</span>&nbsp;<span class="num" id="3593275">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593279">for</span>&nbsp;<span class="ident" id="3593283">index</span><span class="op" id="3593288">,</span>&nbsp;<span class="ident" id="3593290">character</span>&nbsp;<span class="op" id="3593300">:=</span>&nbsp;<span class="keyword" id="3593303">range</span>&nbsp;<span class="ident" id="3593309"><a href="/mime/mediatype.go.html#3593010">value</a></span>&nbsp;<span class="op" id="3593315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593320">if</span>&nbsp;<span class="ident" id="3593323"><a href="/mime/mediatype.go.html#3593290">character</a></span>&nbsp;<span class="op" id="3593333">==</span>&nbsp;<span class="string" id="3593336">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3593340">||</span>&nbsp;<span class="ident" id="3593343"><a href="/mime/mediatype.go.html#3593290">character</a></span>&nbsp;<span class="op" id="3593353">==</span>&nbsp;<span class="string" id="3593356">&#39;\\&#39;</span>&nbsp;<span class="op" id="3593361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593367"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593368">.</span><span class="ident" id="3593369">WriteString</span><span class="op" id="3593380">(</span><span class="ident" id="3593381"><a href="/mime/mediatype.go.html#3593010">value</a></span><span class="op" id="3593386">[</span><span class="ident" id="3593387"><a href="/mime/mediatype.go.html#3593265">offset</a></span><span class="op" id="3593393">:</span><span class="ident" id="3593394"><a href="/mime/mediatype.go.html#3593283">index</a></span><span class="op" id="3593399">]</span><span class="op" id="3593400">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593406"><a href="/mime/mediatype.go.html#3593265">offset</a></span>&nbsp;<span class="op" id="3593413">=</span>&nbsp;<span class="ident" id="3593415"><a href="/mime/mediatype.go.html#3593283">index</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593425"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593426">.</span><span class="ident" id="3593427">WriteByte</span><span class="op" id="3593436">(</span><span class="string" id="3593437">&#39;\\&#39;</span><span class="op" id="3593441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593451">if</span>&nbsp;<span class="ident" id="3593454"><a href="/mime/mediatype.go.html#3593290">character</a></span><span class="op" id="3593463">&amp;</span><span class="num" id="3593464">0x80</span>&nbsp;<span class="op" id="3593469">!=</span>&nbsp;<span class="num" id="3593472">0</span>&nbsp;<span class="op" id="3593474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593480">return</span>&nbsp;<span class="string" id="3593487">&#34;&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593501"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593502">.</span><span class="ident" id="3593503">WriteString</span><span class="op" id="3593514">(</span><span class="ident" id="3593515"><a href="/mime/mediatype.go.html#3593010">value</a></span><span class="op" id="3593520">[</span><span class="ident" id="3593521"><a href="/mime/mediatype.go.html#3593265">offset</a></span><span class="op" id="3593527">:</span><span class="op" id="3593528">]</span><span class="op" id="3593529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593533"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593534">.</span><span class="ident" id="3593535">WriteByte</span><span class="op" id="3593544">(</span><span class="string" id="3593545">&#39;&#34;&#39;</span><span class="op" id="3593548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593551">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593554">return</span>&nbsp;<span class="ident" id="3593561"><a href="/mime/mediatype.go.html#3592747">b</a></span><span class="op" id="3593562">.</span><span class="ident" id="3593563">String</span><span class="op" id="3593569">(</span><span class="op" id="3593570">)</span><br>
<span class="lineno"></span><span class="op" id="3593572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3593575">func</span>&nbsp;<span class="ident" id="3593580">checkMediaTypeDisposition</span><span class="op" id="3593605">(</span><span class="ident" id="3593606">s</span>&nbsp;<span class="builtintype" id="3593608">string</span><span class="op" id="3593614">)</span>&nbsp;<span class="builtintype" id="3593616">error</span>&nbsp;<span class="op" id="3593622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593625">typ</span><span class="op" id="3593628">,</span>&nbsp;<span class="ident" id="3593630">rest</span>&nbsp;<span class="op" id="3593635">:=</span>&nbsp;<span class="ident" id="3593638"><a href="/mime/mediatype.go.html#3597501">consumeToken</a></span><span class="op" id="3593650">(</span><span class="ident" id="3593651"><a href="/mime/mediatype.go.html#3593606">s</a></span><span class="op" id="3593652">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593655">if</span>&nbsp;<span class="ident" id="3593658"><a href="/mime/mediatype.go.html#3593625">typ</a></span>&nbsp;<span class="op" id="3593662">==</span>&nbsp;<span class="string" id="3593665">&#34;&#34;</span>&nbsp;<span class="op" id="3593668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593672">return</span>&nbsp;<span class="ident" id="3593679"><a href="/mime/mediatype.go.html#3592179">errors</a></span><span class="op" id="3593685">.</span><span class="ident" id="3593686">New</span><span class="op" id="3593689">(</span><span class="string" id="3593690">&#34;mime:&nbsp;no&nbsp;media&nbsp;type&#34;</span><span class="op" id="3593711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593717">if</span>&nbsp;<span class="ident" id="3593720"><a href="/mime/mediatype.go.html#3593630">rest</a></span>&nbsp;<span class="op" id="3593725">==</span>&nbsp;<span class="string" id="3593728">&#34;&#34;</span>&nbsp;<span class="op" id="3593731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593735">return</span>&nbsp;<span class="ident" id="3593742">nil</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593750">if</span>&nbsp;<span class="op" id="3593753">!</span><span class="ident" id="3593754"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3593761">.</span><span class="ident" id="3593762">HasPrefix</span><span class="op" id="3593771">(</span><span class="ident" id="3593772"><a href="/mime/mediatype.go.html#3593630">rest</a></span><span class="op" id="3593776">,</span>&nbsp;<span class="string" id="3593778">&#34;/&#34;</span><span class="op" id="3593781">)</span>&nbsp;<span class="op" id="3593783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593787">return</span>&nbsp;<span class="ident" id="3593794"><a href="/mime/mediatype.go.html#3592179">errors</a></span><span class="op" id="3593800">.</span><span class="ident" id="3593801">New</span><span class="op" id="3593804">(</span><span class="string" id="3593805">&#34;mime:&nbsp;expected&nbsp;slash&nbsp;after&nbsp;first&nbsp;token&#34;</span><span class="op" id="3593845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593851">subtype</span><span class="op" id="3593858">,</span>&nbsp;<span class="ident" id="3593860"><a href="/mime/mediatype.go.html#3593630">rest</a></span>&nbsp;<span class="op" id="3593865">:=</span>&nbsp;<span class="ident" id="3593868"><a href="/mime/mediatype.go.html#3597501">consumeToken</a></span><span class="op" id="3593880">(</span><span class="ident" id="3593881"><a href="/mime/mediatype.go.html#3593630">rest</a></span><span class="op" id="3593885">[</span><span class="num" id="3593886">1</span><span class="op" id="3593887">:</span><span class="op" id="3593888">]</span><span class="op" id="3593889">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593892">if</span>&nbsp;<span class="ident" id="3593895"><a href="/mime/mediatype.go.html#3593851">subtype</a></span>&nbsp;<span class="op" id="3593903">==</span>&nbsp;<span class="string" id="3593906">&#34;&#34;</span>&nbsp;<span class="op" id="3593909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593913">return</span>&nbsp;<span class="ident" id="3593920"><a href="/mime/mediatype.go.html#3592179">errors</a></span><span class="op" id="3593926">.</span><span class="ident" id="3593927">New</span><span class="op" id="3593930">(</span><span class="string" id="3593931">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="3593965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3593968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593971">if</span>&nbsp;<span class="ident" id="3593974"><a href="/mime/mediatype.go.html#3593630">rest</a></span>&nbsp;<span class="op" id="3593979">!=</span>&nbsp;<span class="string" id="3593982">&#34;&#34;</span>&nbsp;<span class="op" id="3593985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593989">return</span>&nbsp;<span class="ident" id="3593996"><a href="/mime/mediatype.go.html#3592179">errors</a></span><span class="op" id="3594002">.</span><span class="ident" id="3594003">New</span><span class="op" id="3594006">(</span><span class="string" id="3594007">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="3594053">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3594056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594059">return</span>&nbsp;<span class="ident" id="3594066">nil</span><br>
<span class="lineno"></span><span class="op" id="3594070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3594073">//&nbsp;ParseMediaType&nbsp;parses&nbsp;a&nbsp;media&nbsp;type&nbsp;value&nbsp;and&nbsp;any&nbsp;optional</span><br>
<span class="lineno">95</span><span class="comment" id="3594134">//&nbsp;parameters,&nbsp;per&nbsp;RFC&nbsp;1521.&nbsp;&nbsp;Media&nbsp;types&nbsp;are&nbsp;the&nbsp;values&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3594194">//&nbsp;Content-Type&nbsp;and&nbsp;Content-Disposition&nbsp;headers&nbsp;(RFC&nbsp;2183).</span><br>
<span class="lineno"></span><span class="comment" id="3594254">//&nbsp;On&nbsp;success,&nbsp;ParseMediaType&nbsp;returns&nbsp;the&nbsp;media&nbsp;type&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="3594317">//&nbsp;to&nbsp;lowercase&nbsp;and&nbsp;trimmed&nbsp;of&nbsp;white&nbsp;space&nbsp;and&nbsp;a&nbsp;non-nil&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3594379">//&nbsp;The&nbsp;returned&nbsp;map,&nbsp;params,&nbsp;maps&nbsp;from&nbsp;the&nbsp;lowercase</span><br>
<span class="lineno">100</span><span class="comment" id="3594432">//&nbsp;attribute&nbsp;to&nbsp;the&nbsp;attribute&nbsp;value&nbsp;with&nbsp;its&nbsp;case&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="keyword" id="3594493">func</span>&nbsp;<span class="ident" id="3594498">ParseMediaType</span><span class="op" id="3594512">(</span><span class="ident" id="3594513">v</span>&nbsp;<span class="builtintype" id="3594515">string</span><span class="op" id="3594521">)</span>&nbsp;<span class="op" id="3594523">(</span><span class="ident" id="3594524">mediatype</span>&nbsp;<span class="builtintype" id="3594534">string</span><span class="op" id="3594540">,</span>&nbsp;<span class="ident" id="3594542">params</span>&nbsp;<span class="keyword" id="3594549">map</span><span class="op" id="3594552">[</span><span class="builtintype" id="3594553">string</span><span class="op" id="3594559">]</span><span class="builtintype" id="3594560">string</span><span class="op" id="3594566">,</span>&nbsp;<span class="ident" id="3594568">err</span>&nbsp;<span class="builtintype" id="3594572">error</span><span class="op" id="3594577">)</span>&nbsp;<span class="op" id="3594579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594582">i</span>&nbsp;<span class="op" id="3594584">:=</span>&nbsp;<span class="ident" id="3594587"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3594594">.</span><span class="ident" id="3594595">Index</span><span class="op" id="3594600">(</span><span class="ident" id="3594601"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3594602">,</span>&nbsp;<span class="string" id="3594604">&#34;;&#34;</span><span class="op" id="3594607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594610">if</span>&nbsp;<span class="ident" id="3594613"><a href="/mime/mediatype.go.html#3594582">i</a></span>&nbsp;<span class="op" id="3594615">==</span>&nbsp;<span class="op" id="3594618">-</span><span class="num" id="3594619">1</span>&nbsp;<span class="op" id="3594621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594625"><a href="/mime/mediatype.go.html#3594582">i</a></span>&nbsp;<span class="op" id="3594627">=</span>&nbsp;<span class="builtinfunc" id="3594629">len</span><span class="op" id="3594632">(</span><span class="ident" id="3594633"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3594634">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3594637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594640"><a href="/mime/mediatype.go.html#3594524">mediatype</a></span>&nbsp;<span class="op" id="3594650">=</span>&nbsp;<span class="ident" id="3594652"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3594659">.</span><span class="ident" id="3594660">TrimSpace</span><span class="op" id="3594669">(</span><span class="ident" id="3594670"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3594677">.</span><span class="ident" id="3594678">ToLower</span><span class="op" id="3594685">(</span><span class="ident" id="3594686"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3594687">[</span><span class="num" id="3594688">0</span><span class="op" id="3594689">:</span><span class="ident" id="3594690"><a href="/mime/mediatype.go.html#3594582">i</a></span><span class="op" id="3594691">]</span><span class="op" id="3594692">)</span><span class="op" id="3594693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594697"><a href="/mime/mediatype.go.html#3594568">err</a></span>&nbsp;<span class="op" id="3594701">=</span>&nbsp;<span class="ident" id="3594703"><a href="/mime/mediatype.go.html#3593580">checkMediaTypeDisposition</a></span><span class="op" id="3594728">(</span><span class="ident" id="3594729"><a href="/mime/mediatype.go.html#3594524">mediatype</a></span><span class="op" id="3594738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594741">if</span>&nbsp;<span class="ident" id="3594744"><a href="/mime/mediatype.go.html#3594568">err</a></span>&nbsp;<span class="op" id="3594748">!=</span>&nbsp;<span class="ident" id="3594751">nil</span>&nbsp;<span class="op" id="3594755">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594759">return</span>&nbsp;<span class="string" id="3594766">&#34;&#34;</span><span class="op" id="3594768">,</span>&nbsp;<span class="ident" id="3594770">nil</span><span class="op" id="3594773">,</span>&nbsp;<span class="ident" id="3594775"><a href="/mime/mediatype.go.html#3594568">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3594780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594784"><a href="/mime/mediatype.go.html#3594542">params</a></span>&nbsp;<span class="op" id="3594791">=</span>&nbsp;<span class="builtinfunc" id="3594793">make</span><span class="op" id="3594797">(</span><span class="keyword" id="3594798">map</span><span class="op" id="3594801">[</span><span class="builtintype" id="3594802">string</span><span class="op" id="3594808">]</span><span class="builtintype" id="3594809">string</span><span class="op" id="3594815">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3594819">//&nbsp;Map&nbsp;of&nbsp;base&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3594877">//&nbsp;for&nbsp;parameters&nbsp;containing&nbsp;a&nbsp;&#39;*&#39;&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3594924">//&nbsp;Lazily&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594948">var</span>&nbsp;<span class="ident" id="3594952">continuation</span>&nbsp;<span class="keyword" id="3594965">map</span><span class="op" id="3594968">[</span><span class="builtintype" id="3594969">string</span><span class="op" id="3594975">]</span><span class="keyword" id="3594976">map</span><span class="op" id="3594979">[</span><span class="builtintype" id="3594980">string</span><span class="op" id="3594986">]</span><span class="builtintype" id="3594987">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594996"><a href="/mime/mediatype.go.html#3594513">v</a></span>&nbsp;<span class="op" id="3594998">=</span>&nbsp;<span class="ident" id="3595000"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3595001">[</span><span class="ident" id="3595002"><a href="/mime/mediatype.go.html#3594582">i</a></span><span class="op" id="3595003">:</span><span class="op" id="3595004">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595007">for</span>&nbsp;<span class="builtinfunc" id="3595011">len</span><span class="op" id="3595014">(</span><span class="ident" id="3595015"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3595016">)</span>&nbsp;<span class="op" id="3595018">&gt;</span>&nbsp;<span class="num" id="3595020">0</span>&nbsp;<span class="op" id="3595022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595026"><a href="/mime/mediatype.go.html#3594513">v</a></span>&nbsp;<span class="op" id="3595028">=</span>&nbsp;<span class="ident" id="3595030"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3595037">.</span><span class="ident" id="3595038">TrimLeftFunc</span><span class="op" id="3595050">(</span><span class="ident" id="3595051"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3595052">,</span>&nbsp;<span class="ident" id="3595054"><a href="/mime/mediatype.go.html#3592215">unicode</a></span><span class="op" id="3595061">.</span><span class="ident" id="3595062">IsSpace</span><span class="op" id="3595069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595073">if</span>&nbsp;<span class="builtinfunc" id="3595076">len</span><span class="op" id="3595079">(</span><span class="ident" id="3595080"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3595081">)</span>&nbsp;<span class="op" id="3595083">==</span>&nbsp;<span class="num" id="3595086">0</span>&nbsp;<span class="op" id="3595088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595093">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595105">key</span><span class="op" id="3595108">,</span>&nbsp;<span class="ident" id="3595110">value</span><span class="op" id="3595115">,</span>&nbsp;<span class="ident" id="3595117">rest</span>&nbsp;<span class="op" id="3595122">:=</span>&nbsp;<span class="ident" id="3595125"><a href="/mime/mediatype.go.html#3598614">consumeMediaParam</a></span><span class="op" id="3595142">(</span><span class="ident" id="3595143"><a href="/mime/mediatype.go.html#3594513">v</a></span><span class="op" id="3595144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595148">if</span>&nbsp;<span class="ident" id="3595151"><a href="/mime/mediatype.go.html#3595105">key</a></span>&nbsp;<span class="op" id="3595155">==</span>&nbsp;<span class="string" id="3595158">&#34;&#34;</span>&nbsp;<span class="op" id="3595161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595166">if</span>&nbsp;<span class="ident" id="3595169"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3595176">.</span><span class="ident" id="3595177">TrimSpace</span><span class="op" id="3595186">(</span><span class="ident" id="3595187"><a href="/mime/mediatype.go.html#3595117">rest</a></span><span class="op" id="3595191">)</span>&nbsp;<span class="op" id="3595193">==</span>&nbsp;<span class="string" id="3595196">&#34;;&#34;</span>&nbsp;<span class="op" id="3595200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3595206">//&nbsp;Ignore&nbsp;trailing&nbsp;semicolons.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3595241">//&nbsp;Not&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595262">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3595277">//&nbsp;Parse&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595296">return</span>&nbsp;<span class="string" id="3595303">&#34;&#34;</span><span class="op" id="3595305">,</span>&nbsp;<span class="ident" id="3595307">nil</span><span class="op" id="3595310">,</span>&nbsp;<span class="ident" id="3595312"><a href="/mime/mediatype.go.html#3592179">errors</a></span><span class="op" id="3595318">.</span><span class="ident" id="3595319">New</span><span class="op" id="3595322">(</span><span class="string" id="3595323">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="3595354">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595363">pmap</span>&nbsp;<span class="op" id="3595368">:=</span>&nbsp;<span class="ident" id="3595371"><a href="/mime/mediatype.go.html#3594542">params</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595380">if</span>&nbsp;<span class="ident" id="3595383">idx</span>&nbsp;<span class="op" id="3595387">:=</span>&nbsp;<span class="ident" id="3595390"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3595397">.</span><span class="ident" id="3595398">Index</span><span class="op" id="3595403">(</span><span class="ident" id="3595404"><a href="/mime/mediatype.go.html#3595105">key</a></span><span class="op" id="3595407">,</span>&nbsp;<span class="string" id="3595409">&#34;*&#34;</span><span class="op" id="3595412">)</span><span class="op" id="3595413">;</span>&nbsp;<span class="ident" id="3595415"><a href="/mime/mediatype.go.html#3595383">idx</a></span>&nbsp;<span class="op" id="3595419">!=</span>&nbsp;<span class="op" id="3595422">-</span><span class="num" id="3595423">1</span>&nbsp;<span class="op" id="3595425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595430">baseName</span>&nbsp;<span class="op" id="3595439">:=</span>&nbsp;<span class="ident" id="3595442"><a href="/mime/mediatype.go.html#3595105">key</a></span><span class="op" id="3595445">[</span><span class="op" id="3595446">:</span><span class="ident" id="3595447"><a href="/mime/mediatype.go.html#3595383">idx</a></span><span class="op" id="3595450">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595455">if</span>&nbsp;<span class="ident" id="3595458"><a href="/mime/mediatype.go.html#3594952">continuation</a></span>&nbsp;<span class="op" id="3595471">==</span>&nbsp;<span class="ident" id="3595474">nil</span>&nbsp;<span class="op" id="3595478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595484"><a href="/mime/mediatype.go.html#3594952">continuation</a></span>&nbsp;<span class="op" id="3595497">=</span>&nbsp;<span class="builtinfunc" id="3595499">make</span><span class="op" id="3595503">(</span><span class="keyword" id="3595504">map</span><span class="op" id="3595507">[</span><span class="builtintype" id="3595508">string</span><span class="op" id="3595514">]</span><span class="keyword" id="3595515">map</span><span class="op" id="3595518">[</span><span class="builtintype" id="3595519">string</span><span class="op" id="3595525">]</span><span class="builtintype" id="3595526">string</span><span class="op" id="3595532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595542">var</span>&nbsp;<span class="ident" id="3595546">ok</span>&nbsp;<span class="builtintype" id="3595549">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595557">if</span>&nbsp;<span class="ident" id="3595560"><a href="/mime/mediatype.go.html#3595363">pmap</a></span><span class="op" id="3595564">,</span>&nbsp;<span class="ident" id="3595566"><a href="/mime/mediatype.go.html#3595546">ok</a></span>&nbsp;<span class="op" id="3595569">=</span>&nbsp;<span class="ident" id="3595571"><a href="/mime/mediatype.go.html#3594952">continuation</a></span><span class="op" id="3595583">[</span><span class="ident" id="3595584"><a href="/mime/mediatype.go.html#3595430">baseName</a></span><span class="op" id="3595592">]</span><span class="op" id="3595593">;</span>&nbsp;<span class="op" id="3595595">!</span><span class="ident" id="3595596"><a href="/mime/mediatype.go.html#3595546">ok</a></span>&nbsp;<span class="op" id="3595599">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595605"><a href="/mime/mediatype.go.html#3594952">continuation</a></span><span class="op" id="3595617">[</span><span class="ident" id="3595618"><a href="/mime/mediatype.go.html#3595430">baseName</a></span><span class="op" id="3595626">]</span>&nbsp;<span class="op" id="3595628">=</span>&nbsp;<span class="builtinfunc" id="3595630">make</span><span class="op" id="3595634">(</span><span class="keyword" id="3595635">map</span><span class="op" id="3595638">[</span><span class="builtintype" id="3595639">string</span><span class="op" id="3595645">]</span><span class="builtintype" id="3595646">string</span><span class="op" id="3595652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595658"><a href="/mime/mediatype.go.html#3595363">pmap</a></span>&nbsp;<span class="op" id="3595663">=</span>&nbsp;<span class="ident" id="3595665"><a href="/mime/mediatype.go.html#3594952">continuation</a></span><span class="op" id="3595677">[</span><span class="ident" id="3595678"><a href="/mime/mediatype.go.html#3595430">baseName</a></span><span class="op" id="3595686">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595699">if</span>&nbsp;<span class="ident" id="3595702">_</span><span class="op" id="3595703">,</span>&nbsp;<span class="ident" id="3595705">exists</span>&nbsp;<span class="op" id="3595712">:=</span>&nbsp;<span class="ident" id="3595715"><a href="/mime/mediatype.go.html#3595363">pmap</a></span><span class="op" id="3595719">[</span><span class="ident" id="3595720"><a href="/mime/mediatype.go.html#3595105">key</a></span><span class="op" id="3595723">]</span><span class="op" id="3595724">;</span>&nbsp;<span class="ident" id="3595726"><a href="/mime/mediatype.go.html#3595705">exists</a></span>&nbsp;<span class="op" id="3595733">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3595738">//&nbsp;Duplicate&nbsp;parameter&nbsp;name&nbsp;is&nbsp;bogus.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595779">return</span>&nbsp;<span class="string" id="3595786">&#34;&#34;</span><span class="op" id="3595788">,</span>&nbsp;<span class="ident" id="3595790">nil</span><span class="op" id="3595793">,</span>&nbsp;<span class="ident" id="3595795"><a href="/mime/mediatype.go.html#3592179">errors</a></span><span class="op" id="3595801">.</span><span class="ident" id="3595802">New</span><span class="op" id="3595805">(</span><span class="string" id="3595806">&#34;mime:&nbsp;duplicate&nbsp;parameter&nbsp;name&#34;</span><span class="op" id="3595838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595846"><a href="/mime/mediatype.go.html#3595363">pmap</a></span><span class="op" id="3595850">[</span><span class="ident" id="3595851"><a href="/mime/mediatype.go.html#3595105">key</a></span><span class="op" id="3595854">]</span>&nbsp;<span class="op" id="3595856">=</span>&nbsp;<span class="ident" id="3595858"><a href="/mime/mediatype.go.html#3595110">value</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595866"><a href="/mime/mediatype.go.html#3594513">v</a></span>&nbsp;<span class="op" id="3595868">=</span>&nbsp;<span class="ident" id="3595870"><a href="/mime/mediatype.go.html#3595117">rest</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3595876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3595880">//&nbsp;Stitch&nbsp;together&nbsp;any&nbsp;continuations&nbsp;or&nbsp;things&nbsp;with&nbsp;stars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3595939">//&nbsp;(i.e.&nbsp;RFC&nbsp;2231&nbsp;things&nbsp;with&nbsp;stars:&nbsp;&#34;foo*0&#34;&nbsp;or&nbsp;&#34;foo*&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595996">var</span>&nbsp;<span class="ident" id="3596000">buf</span>&nbsp;<span class="ident" id="3596004"><a href="/mime/mediatype.go.html#3592170">bytes</a></span><span class="op" id="3596009">.</span><span class="ident" id="3596010">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596018">for</span>&nbsp;<span class="ident" id="3596022">key</span><span class="op" id="3596025">,</span>&nbsp;<span class="ident" id="3596027">pieceMap</span>&nbsp;<span class="op" id="3596036">:=</span>&nbsp;<span class="keyword" id="3596039">range</span>&nbsp;<span class="ident" id="3596045"><a href="/mime/mediatype.go.html#3594952">continuation</a></span>&nbsp;<span class="op" id="3596058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596062">singlePartKey</span>&nbsp;<span class="op" id="3596076">:=</span>&nbsp;<span class="ident" id="3596079"><a href="/mime/mediatype.go.html#3596022">key</a></span>&nbsp;<span class="op" id="3596083">+</span>&nbsp;<span class="string" id="3596085">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596091">if</span>&nbsp;<span class="ident" id="3596094">v</span><span class="op" id="3596095">,</span>&nbsp;<span class="ident" id="3596097">ok</span>&nbsp;<span class="op" id="3596100">:=</span>&nbsp;<span class="ident" id="3596103"><a href="/mime/mediatype.go.html#3596027">pieceMap</a></span><span class="op" id="3596111">[</span><span class="ident" id="3596112"><a href="/mime/mediatype.go.html#3596062">singlePartKey</a></span><span class="op" id="3596125">]</span><span class="op" id="3596126">;</span>&nbsp;<span class="ident" id="3596128"><a href="/mime/mediatype.go.html#3596097">ok</a></span>&nbsp;<span class="op" id="3596131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596136">decv</span>&nbsp;<span class="op" id="3596141">:=</span>&nbsp;<span class="ident" id="3596144"><a href="/mime/mediatype.go.html#3596731">decode2231Enc</a></span><span class="op" id="3596157">(</span><span class="ident" id="3596158"><a href="/mime/mediatype.go.html#3596094">v</a></span><span class="op" id="3596159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596164"><a href="/mime/mediatype.go.html#3594542">params</a></span><span class="op" id="3596170">[</span><span class="ident" id="3596171"><a href="/mime/mediatype.go.html#3596022">key</a></span><span class="op" id="3596174">]</span>&nbsp;<span class="op" id="3596176">=</span>&nbsp;<span class="ident" id="3596178"><a href="/mime/mediatype.go.html#3596136">decv</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596186">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596202"><a href="/mime/mediatype.go.html#3596000">buf</a></span><span class="op" id="3596205">.</span><span class="ident" id="3596206">Reset</span><span class="op" id="3596211">(</span><span class="op" id="3596212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596216">valid</span>&nbsp;<span class="op" id="3596222">:=</span>&nbsp;<span class="builtintype" id="3596225">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596233">for</span>&nbsp;<span class="ident" id="3596237">n</span>&nbsp;<span class="op" id="3596239">:=</span>&nbsp;<span class="num" id="3596242">0</span><span class="op" id="3596243">;</span>&nbsp;<span class="op" id="3596245">;</span>&nbsp;<span class="ident" id="3596247"><a href="/mime/mediatype.go.html#3596237">n</a></span><span class="op" id="3596248">++</span>&nbsp;<span class="op" id="3596251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596256">simplePart</span>&nbsp;<span class="op" id="3596267">:=</span>&nbsp;<span class="ident" id="3596270"><a href="/mime/mediatype.go.html#3592189">fmt</a></span><span class="op" id="3596273">.</span><span class="ident" id="3596274">Sprintf</span><span class="op" id="3596281">(</span><span class="string" id="3596282">&#34;%s*%d&#34;</span><span class="op" id="3596289">,</span>&nbsp;<span class="ident" id="3596291"><a href="/mime/mediatype.go.html#3596022">key</a></span><span class="op" id="3596294">,</span>&nbsp;<span class="ident" id="3596296"><a href="/mime/mediatype.go.html#3596237">n</a></span><span class="op" id="3596297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596302">if</span>&nbsp;<span class="ident" id="3596305">v</span><span class="op" id="3596306">,</span>&nbsp;<span class="ident" id="3596308">ok</span>&nbsp;<span class="op" id="3596311">:=</span>&nbsp;<span class="ident" id="3596314"><a href="/mime/mediatype.go.html#3596027">pieceMap</a></span><span class="op" id="3596322">[</span><span class="ident" id="3596323"><a href="/mime/mediatype.go.html#3596256">simplePart</a></span><span class="op" id="3596333">]</span><span class="op" id="3596334">;</span>&nbsp;<span class="ident" id="3596336"><a href="/mime/mediatype.go.html#3596308">ok</a></span>&nbsp;<span class="op" id="3596339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596345"><a href="/mime/mediatype.go.html#3596216">valid</a></span>&nbsp;<span class="op" id="3596351">=</span>&nbsp;<span class="builtintype" id="3596353">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596362"><a href="/mime/mediatype.go.html#3596000">buf</a></span><span class="op" id="3596365">.</span><span class="ident" id="3596366">WriteString</span><span class="op" id="3596377">(</span><span class="ident" id="3596378"><a href="/mime/mediatype.go.html#3596305">v</a></span><span class="op" id="3596379">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596385">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596402">encodedPart</span>&nbsp;<span class="op" id="3596414">:=</span>&nbsp;<span class="ident" id="3596417"><a href="/mime/mediatype.go.html#3596256">simplePart</a></span>&nbsp;<span class="op" id="3596428">+</span>&nbsp;<span class="string" id="3596430">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596437">if</span>&nbsp;<span class="ident" id="3596440">v</span><span class="op" id="3596441">,</span>&nbsp;<span class="ident" id="3596443">ok</span>&nbsp;<span class="op" id="3596446">:=</span>&nbsp;<span class="ident" id="3596449"><a href="/mime/mediatype.go.html#3596027">pieceMap</a></span><span class="op" id="3596457">[</span><span class="ident" id="3596458"><a href="/mime/mediatype.go.html#3596402">encodedPart</a></span><span class="op" id="3596469">]</span><span class="op" id="3596470">;</span>&nbsp;<span class="ident" id="3596472"><a href="/mime/mediatype.go.html#3596443">ok</a></span>&nbsp;<span class="op" id="3596475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596481"><a href="/mime/mediatype.go.html#3596216">valid</a></span>&nbsp;<span class="op" id="3596487">=</span>&nbsp;<span class="builtintype" id="3596489">true</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596498">if</span>&nbsp;<span class="ident" id="3596501"><a href="/mime/mediatype.go.html#3596237">n</a></span>&nbsp;<span class="op" id="3596503">==</span>&nbsp;<span class="num" id="3596506">0</span>&nbsp;<span class="op" id="3596508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596515"><a href="/mime/mediatype.go.html#3596000">buf</a></span><span class="op" id="3596518">.</span><span class="ident" id="3596519">WriteString</span><span class="op" id="3596530">(</span><span class="ident" id="3596531"><a href="/mime/mediatype.go.html#3596731">decode2231Enc</a></span><span class="op" id="3596544">(</span><span class="ident" id="3596545"><a href="/mime/mediatype.go.html#3596440">v</a></span><span class="op" id="3596546">)</span><span class="op" id="3596547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596553">}</span>&nbsp;<span class="keyword" id="3596555">else</span>&nbsp;<span class="op" id="3596560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596567">decv</span><span class="op" id="3596571">,</span>&nbsp;<span class="ident" id="3596573">_</span>&nbsp;<span class="op" id="3596575">:=</span>&nbsp;<span class="ident" id="3596578"><a href="/mime/mediatype.go.html#3599288">percentHexUnescape</a></span><span class="op" id="3596596">(</span><span class="ident" id="3596597"><a href="/mime/mediatype.go.html#3596440">v</a></span><span class="op" id="3596598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596605"><a href="/mime/mediatype.go.html#3596000">buf</a></span><span class="op" id="3596608">.</span><span class="ident" id="3596609">WriteString</span><span class="op" id="3596620">(</span><span class="ident" id="3596621"><a href="/mime/mediatype.go.html#3596567">decv</a></span><span class="op" id="3596625">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596636">}</span>&nbsp;<span class="keyword" id="3596638">else</span>&nbsp;<span class="op" id="3596643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596649">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596662">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596666">if</span>&nbsp;<span class="ident" id="3596669"><a href="/mime/mediatype.go.html#3596216">valid</a></span>&nbsp;<span class="op" id="3596675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596680"><a href="/mime/mediatype.go.html#3594542">params</a></span><span class="op" id="3596686">[</span><span class="ident" id="3596687"><a href="/mime/mediatype.go.html#3596022">key</a></span><span class="op" id="3596690">]</span>&nbsp;<span class="op" id="3596692">=</span>&nbsp;<span class="ident" id="3596694"><a href="/mime/mediatype.go.html#3596000">buf</a></span><span class="op" id="3596697">.</span><span class="ident" id="3596698">String</span><span class="op" id="3596704">(</span><span class="op" id="3596705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596716">return</span><br>
<span class="lineno"></span><span class="op" id="3596723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3596726">func</span>&nbsp;<span class="ident" id="3596731">decode2231Enc</span><span class="op" id="3596744">(</span><span class="ident" id="3596745">v</span>&nbsp;<span class="builtintype" id="3596747">string</span><span class="op" id="3596753">)</span>&nbsp;<span class="builtintype" id="3596755">string</span>&nbsp;<span class="op" id="3596762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596765">sv</span>&nbsp;<span class="op" id="3596768">:=</span>&nbsp;<span class="ident" id="3596771"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3596778">.</span><span class="ident" id="3596779">SplitN</span><span class="op" id="3596785">(</span><span class="ident" id="3596786"><a href="/mime/mediatype.go.html#3596745">v</a></span><span class="op" id="3596787">,</span>&nbsp;<span class="string" id="3596789">&#34;&#39;&#34;</span><span class="op" id="3596792">,</span>&nbsp;<span class="num" id="3596794">3</span><span class="op" id="3596795">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596798">if</span>&nbsp;<span class="builtinfunc" id="3596801">len</span><span class="op" id="3596804">(</span><span class="ident" id="3596805"><a href="/mime/mediatype.go.html#3596765">sv</a></span><span class="op" id="3596807">)</span>&nbsp;<span class="op" id="3596809">!=</span>&nbsp;<span class="num" id="3596812">3</span>&nbsp;<span class="op" id="3596814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596818">return</span>&nbsp;<span class="string" id="3596825">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3596829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3596832">//&nbsp;TODO:&nbsp;ignoring&nbsp;lang&nbsp;in&nbsp;sv[1]&nbsp;for&nbsp;now.&nbsp;If&nbsp;anybody&nbsp;needs&nbsp;it&nbsp;we&#39;ll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3596900">//&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;expose&nbsp;it&nbsp;in&nbsp;the&nbsp;API.&nbsp;But&nbsp;I&#39;m&nbsp;not&nbsp;sure</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3596965">//&nbsp;anybody&nbsp;uses&nbsp;it&nbsp;in&nbsp;practice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596998">charset</span>&nbsp;<span class="op" id="3597006">:=</span>&nbsp;<span class="ident" id="3597009"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3597016">.</span><span class="ident" id="3597017">ToLower</span><span class="op" id="3597024">(</span><span class="ident" id="3597025"><a href="/mime/mediatype.go.html#3596765">sv</a></span><span class="op" id="3597027">[</span><span class="num" id="3597028">0</span><span class="op" id="3597029">]</span><span class="op" id="3597030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597033">if</span>&nbsp;<span class="ident" id="3597036"><a href="/mime/mediatype.go.html#3596998">charset</a></span>&nbsp;<span class="op" id="3597044">!=</span>&nbsp;<span class="string" id="3597047">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="3597058">&amp;&amp;</span>&nbsp;<span class="ident" id="3597061"><a href="/mime/mediatype.go.html#3596998">charset</a></span>&nbsp;<span class="op" id="3597069">!=</span>&nbsp;<span class="string" id="3597072">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="3597080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3597084">//&nbsp;TODO:&nbsp;unsupported&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597116">return</span>&nbsp;<span class="string" id="3597123">&#34;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3597127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597130">encv</span><span class="op" id="3597134">,</span>&nbsp;<span class="ident" id="3597136">_</span>&nbsp;<span class="op" id="3597138">:=</span>&nbsp;<span class="ident" id="3597141"><a href="/mime/mediatype.go.html#3599288">percentHexUnescape</a></span><span class="op" id="3597159">(</span><span class="ident" id="3597160"><a href="/mime/mediatype.go.html#3596765">sv</a></span><span class="op" id="3597162">[</span><span class="num" id="3597163">2</span><span class="op" id="3597164">]</span><span class="op" id="3597165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597168">return</span>&nbsp;<span class="ident" id="3597175"><a href="/mime/mediatype.go.html#3597130">encv</a></span><br>
<span class="lineno"></span><span class="op" id="3597180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3597183">func</span>&nbsp;<span class="ident" id="3597188">isNotTokenChar</span><span class="op" id="3597202">(</span><span class="ident" id="3597203">r</span>&nbsp;<span class="builtintype" id="3597205">rune</span><span class="op" id="3597209">)</span>&nbsp;<span class="builtintype" id="3597211">bool</span>&nbsp;<span class="op" id="3597216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597219">return</span>&nbsp;<span class="op" id="3597226">!</span><span class="ident" id="3597227"><a href="/mime/grammar.go.html#3591627">isTokenChar</a></span><span class="op" id="3597238">(</span><span class="ident" id="3597239"><a href="/mime/mediatype.go.html#3597203">r</a></span><span class="op" id="3597240">)</span><br>
<span class="lineno"></span><span class="op" id="3597242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3597245">//&nbsp;consumeToken&nbsp;consumes&nbsp;a&nbsp;token&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;provided</span><br>
<span class="lineno">220</span><span class="comment" id="3597309">//&nbsp;string,&nbsp;per&nbsp;RFC&nbsp;2045&nbsp;section&nbsp;5.1&nbsp;(referenced&nbsp;from&nbsp;2183),&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3597380">//&nbsp;the&nbsp;token&nbsp;consumed&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;Returns&nbsp;(&#34;&#34;,&nbsp;v)&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3597450">//&nbsp;failure&nbsp;to&nbsp;consume&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3597496">func</span>&nbsp;<span class="ident" id="3597501">consumeToken</span><span class="op" id="3597513">(</span><span class="ident" id="3597514">v</span>&nbsp;<span class="builtintype" id="3597516">string</span><span class="op" id="3597522">)</span>&nbsp;<span class="op" id="3597524">(</span><span class="ident" id="3597525">token</span><span class="op" id="3597530">,</span>&nbsp;<span class="ident" id="3597532">rest</span>&nbsp;<span class="builtintype" id="3597537">string</span><span class="op" id="3597543">)</span>&nbsp;<span class="op" id="3597545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597548">notPos</span>&nbsp;<span class="op" id="3597555">:=</span>&nbsp;<span class="ident" id="3597558"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3597565">.</span><span class="ident" id="3597566">IndexFunc</span><span class="op" id="3597575">(</span><span class="ident" id="3597576"><a href="/mime/mediatype.go.html#3597514">v</a></span><span class="op" id="3597577">,</span>&nbsp;<span class="ident" id="3597579"><a href="/mime/mediatype.go.html#3597188">isNotTokenChar</a></span><span class="op" id="3597593">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597596">if</span>&nbsp;<span class="ident" id="3597599"><a href="/mime/mediatype.go.html#3597548">notPos</a></span>&nbsp;<span class="op" id="3597606">==</span>&nbsp;<span class="op" id="3597609">-</span><span class="num" id="3597610">1</span>&nbsp;<span class="op" id="3597612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597616">return</span>&nbsp;<span class="ident" id="3597623"><a href="/mime/mediatype.go.html#3597514">v</a></span><span class="op" id="3597624">,</span>&nbsp;<span class="string" id="3597626">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3597630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597633">if</span>&nbsp;<span class="ident" id="3597636"><a href="/mime/mediatype.go.html#3597548">notPos</a></span>&nbsp;<span class="op" id="3597643">==</span>&nbsp;<span class="num" id="3597646">0</span>&nbsp;<span class="op" id="3597648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597652">return</span>&nbsp;<span class="string" id="3597659">&#34;&#34;</span><span class="op" id="3597661">,</span>&nbsp;<span class="ident" id="3597663"><a href="/mime/mediatype.go.html#3597514">v</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3597666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597669">return</span>&nbsp;<span class="ident" id="3597676"><a href="/mime/mediatype.go.html#3597514">v</a></span><span class="op" id="3597677">[</span><span class="num" id="3597678">0</span><span class="op" id="3597679">:</span><span class="ident" id="3597680"><a href="/mime/mediatype.go.html#3597548">notPos</a></span><span class="op" id="3597686">]</span><span class="op" id="3597687">,</span>&nbsp;<span class="ident" id="3597689"><a href="/mime/mediatype.go.html#3597514">v</a></span><span class="op" id="3597690">[</span><span class="ident" id="3597691"><a href="/mime/mediatype.go.html#3597548">notPos</a></span><span class="op" id="3597697">:</span><span class="op" id="3597698">]</span><br>
<span class="lineno"></span><span class="op" id="3597700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3597703">//&nbsp;consumeValue&nbsp;consumes&nbsp;a&nbsp;&#34;value&#34;&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;where&nbsp;a&nbsp;value&nbsp;is</span><br>
<span class="lineno">235</span><span class="comment" id="3597769">//&nbsp;either&nbsp;a&nbsp;&#39;token&#39;&nbsp;or&nbsp;a&nbsp;&#39;quoted-string&#39;.&nbsp;&nbsp;On&nbsp;success,&nbsp;consumeValue</span><br>
<span class="lineno"></span><span class="comment" id="3597837">//&nbsp;returns&nbsp;the&nbsp;value&nbsp;consumed&nbsp;(and&nbsp;de-quoted/escaped,&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3597896">//&nbsp;quoted-string)&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;On&nbsp;failure,&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3597963">//&nbsp;(&#34;&#34;,&nbsp;v).</span><br>
<span class="lineno"></span><span class="keyword" id="3597975">func</span>&nbsp;<span class="ident" id="3597980">consumeValue</span><span class="op" id="3597992">(</span><span class="ident" id="3597993">v</span>&nbsp;<span class="builtintype" id="3597995">string</span><span class="op" id="3598001">)</span>&nbsp;<span class="op" id="3598003">(</span><span class="ident" id="3598004">value</span><span class="op" id="3598009">,</span>&nbsp;<span class="ident" id="3598011">rest</span>&nbsp;<span class="builtintype" id="3598016">string</span><span class="op" id="3598022">)</span>&nbsp;<span class="op" id="3598024">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598027">if</span>&nbsp;<span class="op" id="3598030">!</span><span class="ident" id="3598031"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598038">.</span><span class="ident" id="3598039">HasPrefix</span><span class="op" id="3598048">(</span><span class="ident" id="3598049"><a href="/mime/mediatype.go.html#3597993">v</a></span><span class="op" id="3598050">,</span>&nbsp;<span class="string" id="3598052">`&#34;`</span><span class="op" id="3598055">)</span>&nbsp;<span class="op" id="3598057">&amp;&amp;</span>&nbsp;<span class="op" id="3598060">!</span><span class="ident" id="3598061"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598068">.</span><span class="ident" id="3598069">HasPrefix</span><span class="op" id="3598078">(</span><span class="ident" id="3598079"><a href="/mime/mediatype.go.html#3597993">v</a></span><span class="op" id="3598080">,</span>&nbsp;<span class="string" id="3598082">`&#39;`</span><span class="op" id="3598085">)</span>&nbsp;<span class="op" id="3598087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598091">return</span>&nbsp;<span class="ident" id="3598098"><a href="/mime/mediatype.go.html#3597501">consumeToken</a></span><span class="op" id="3598110">(</span><span class="ident" id="3598111"><a href="/mime/mediatype.go.html#3597993">v</a></span><span class="op" id="3598112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598119">leadQuote</span>&nbsp;<span class="op" id="3598129">:=</span>&nbsp;<span class="builtintype" id="3598132">rune</span><span class="op" id="3598136">(</span><span class="ident" id="3598137"><a href="/mime/mediatype.go.html#3597993">v</a></span><span class="op" id="3598138">[</span><span class="num" id="3598139">0</span><span class="op" id="3598140">]</span><span class="op" id="3598141">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3598145">//&nbsp;parse&nbsp;a&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598171"><a href="/mime/mediatype.go.html#3598011">rest</a></span>&nbsp;<span class="op" id="3598176">=</span>&nbsp;<span class="ident" id="3598178"><a href="/mime/mediatype.go.html#3597993">v</a></span><span class="op" id="3598179">[</span><span class="num" id="3598180">1</span><span class="op" id="3598181">:</span><span class="op" id="3598182">]</span>&nbsp;<span class="comment" id="3598184">//&nbsp;consume&nbsp;the&nbsp;leading&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598214">buffer</span>&nbsp;<span class="op" id="3598221">:=</span>&nbsp;<span class="builtinfunc" id="3598224">new</span><span class="op" id="3598227">(</span><span class="ident" id="3598228"><a href="/mime/mediatype.go.html#3592170">bytes</a></span><span class="op" id="3598233">.</span><span class="ident" id="3598234">Buffer</span><span class="op" id="3598240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598243">var</span>&nbsp;<span class="ident" id="3598247">idx</span>&nbsp;<span class="builtintype" id="3598251">int</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598256">var</span>&nbsp;<span class="ident" id="3598260">r</span>&nbsp;<span class="builtintype" id="3598262">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598268">var</span>&nbsp;<span class="ident" id="3598272">nextIsLiteral</span>&nbsp;<span class="builtintype" id="3598286">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598292">for</span>&nbsp;<span class="ident" id="3598296"><a href="/mime/mediatype.go.html#3598247">idx</a></span><span class="op" id="3598299">,</span>&nbsp;<span class="ident" id="3598301"><a href="/mime/mediatype.go.html#3598260">r</a></span>&nbsp;<span class="op" id="3598303">=</span>&nbsp;<span class="keyword" id="3598305">range</span>&nbsp;<span class="ident" id="3598311"><a href="/mime/mediatype.go.html#3598011">rest</a></span>&nbsp;<span class="op" id="3598316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598320">switch</span>&nbsp;<span class="op" id="3598327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598331">case</span>&nbsp;<span class="ident" id="3598336"><a href="/mime/mediatype.go.html#3598272">nextIsLiteral</a></span><span class="op" id="3598349">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598354"><a href="/mime/mediatype.go.html#3598214">buffer</a></span><span class="op" id="3598360">.</span><span class="ident" id="3598361">WriteRune</span><span class="op" id="3598370">(</span><span class="ident" id="3598371"><a href="/mime/mediatype.go.html#3598260">r</a></span><span class="op" id="3598372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598377"><a href="/mime/mediatype.go.html#3598272">nextIsLiteral</a></span>&nbsp;<span class="op" id="3598391">=</span>&nbsp;<span class="builtintype" id="3598393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598401">case</span>&nbsp;<span class="ident" id="3598406"><a href="/mime/mediatype.go.html#3598260">r</a></span>&nbsp;<span class="op" id="3598408">==</span>&nbsp;<span class="ident" id="3598411"><a href="/mime/mediatype.go.html#3598119">leadQuote</a></span><span class="op" id="3598420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598425">return</span>&nbsp;<span class="ident" id="3598432"><a href="/mime/mediatype.go.html#3598214">buffer</a></span><span class="op" id="3598438">.</span><span class="ident" id="3598439">String</span><span class="op" id="3598445">(</span><span class="op" id="3598446">)</span><span class="op" id="3598447">,</span>&nbsp;<span class="ident" id="3598449"><a href="/mime/mediatype.go.html#3598011">rest</a></span><span class="op" id="3598453">[</span><span class="ident" id="3598454"><a href="/mime/mediatype.go.html#3598247">idx</a></span><span class="op" id="3598457">+</span><span class="num" id="3598458">1</span><span class="op" id="3598459">:</span><span class="op" id="3598460">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598464">case</span>&nbsp;<span class="ident" id="3598469"><a href="/mime/mediatype.go.html#3598260">r</a></span>&nbsp;<span class="op" id="3598471">==</span>&nbsp;<span class="string" id="3598474">&#39;\\&#39;</span><span class="op" id="3598478">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598483"><a href="/mime/mediatype.go.html#3598272">nextIsLiteral</a></span>&nbsp;<span class="op" id="3598497">=</span>&nbsp;<span class="builtintype" id="3598499">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598506">case</span>&nbsp;<span class="ident" id="3598511"><a href="/mime/mediatype.go.html#3598260">r</a></span>&nbsp;<span class="op" id="3598513">!=</span>&nbsp;<span class="string" id="3598516">&#39;\r&#39;</span>&nbsp;<span class="op" id="3598521">&amp;&amp;</span>&nbsp;<span class="ident" id="3598524"><a href="/mime/mediatype.go.html#3598260">r</a></span>&nbsp;<span class="op" id="3598526">!=</span>&nbsp;<span class="string" id="3598529">&#39;\n&#39;</span><span class="op" id="3598533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598538"><a href="/mime/mediatype.go.html#3598214">buffer</a></span><span class="op" id="3598544">.</span><span class="ident" id="3598545">WriteRune</span><span class="op" id="3598554">(</span><span class="ident" id="3598555"><a href="/mime/mediatype.go.html#3598260">r</a></span><span class="op" id="3598556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598560">default</span><span class="op" id="3598567">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598572">return</span>&nbsp;<span class="string" id="3598579">&#34;&#34;</span><span class="op" id="3598581">,</span>&nbsp;<span class="ident" id="3598583"><a href="/mime/mediatype.go.html#3597993">v</a></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598593">return</span>&nbsp;<span class="string" id="3598600">&#34;&#34;</span><span class="op" id="3598602">,</span>&nbsp;<span class="ident" id="3598604"><a href="/mime/mediatype.go.html#3597993">v</a></span><br>
<span class="lineno"></span><span class="op" id="3598606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3598609">func</span>&nbsp;<span class="ident" id="3598614">consumeMediaParam</span><span class="op" id="3598631">(</span><span class="ident" id="3598632">v</span>&nbsp;<span class="builtintype" id="3598634">string</span><span class="op" id="3598640">)</span>&nbsp;<span class="op" id="3598642">(</span><span class="ident" id="3598643">param</span><span class="op" id="3598648">,</span>&nbsp;<span class="ident" id="3598650">value</span><span class="op" id="3598655">,</span>&nbsp;<span class="ident" id="3598657">rest</span>&nbsp;<span class="builtintype" id="3598662">string</span><span class="op" id="3598668">)</span>&nbsp;<span class="op" id="3598670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598673"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3598678">=</span>&nbsp;<span class="ident" id="3598680"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598687">.</span><span class="ident" id="3598688">TrimLeftFunc</span><span class="op" id="3598700">(</span><span class="ident" id="3598701"><a href="/mime/mediatype.go.html#3598632">v</a></span><span class="op" id="3598702">,</span>&nbsp;<span class="ident" id="3598704"><a href="/mime/mediatype.go.html#3592215">unicode</a></span><span class="op" id="3598711">.</span><span class="ident" id="3598712">IsSpace</span><span class="op" id="3598719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598722">if</span>&nbsp;<span class="op" id="3598725">!</span><span class="ident" id="3598726"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598733">.</span><span class="ident" id="3598734">HasPrefix</span><span class="op" id="3598743">(</span><span class="ident" id="3598744"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3598748">,</span>&nbsp;<span class="string" id="3598750">&#34;;&#34;</span><span class="op" id="3598753">)</span>&nbsp;<span class="op" id="3598755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598759">return</span>&nbsp;<span class="string" id="3598766">&#34;&#34;</span><span class="op" id="3598768">,</span>&nbsp;<span class="string" id="3598770">&#34;&#34;</span><span class="op" id="3598772">,</span>&nbsp;<span class="ident" id="3598774"><a href="/mime/mediatype.go.html#3598632">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598777">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598781"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3598786">=</span>&nbsp;<span class="ident" id="3598788"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3598792">[</span><span class="num" id="3598793">1</span><span class="op" id="3598794">:</span><span class="op" id="3598795">]</span>&nbsp;<span class="comment" id="3598797">//&nbsp;consume&nbsp;semicolon</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598819"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3598824">=</span>&nbsp;<span class="ident" id="3598826"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598833">.</span><span class="ident" id="3598834">TrimLeftFunc</span><span class="op" id="3598846">(</span><span class="ident" id="3598847"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3598851">,</span>&nbsp;<span class="ident" id="3598853"><a href="/mime/mediatype.go.html#3592215">unicode</a></span><span class="op" id="3598860">.</span><span class="ident" id="3598861">IsSpace</span><span class="op" id="3598868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598871"><a href="/mime/mediatype.go.html#3598643">param</a></span><span class="op" id="3598876">,</span>&nbsp;<span class="ident" id="3598878"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3598883">=</span>&nbsp;<span class="ident" id="3598885"><a href="/mime/mediatype.go.html#3597501">consumeToken</a></span><span class="op" id="3598897">(</span><span class="ident" id="3598898"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3598902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598905"><a href="/mime/mediatype.go.html#3598643">param</a></span>&nbsp;<span class="op" id="3598911">=</span>&nbsp;<span class="ident" id="3598913"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598920">.</span><span class="ident" id="3598921">ToLower</span><span class="op" id="3598928">(</span><span class="ident" id="3598929"><a href="/mime/mediatype.go.html#3598643">param</a></span><span class="op" id="3598934">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598937">if</span>&nbsp;<span class="ident" id="3598940"><a href="/mime/mediatype.go.html#3598643">param</a></span>&nbsp;<span class="op" id="3598946">==</span>&nbsp;<span class="string" id="3598949">&#34;&#34;</span>&nbsp;<span class="op" id="3598952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598956">return</span>&nbsp;<span class="string" id="3598963">&#34;&#34;</span><span class="op" id="3598965">,</span>&nbsp;<span class="string" id="3598967">&#34;&#34;</span><span class="op" id="3598969">,</span>&nbsp;<span class="ident" id="3598971"><a href="/mime/mediatype.go.html#3598632">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598978"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3598983">=</span>&nbsp;<span class="ident" id="3598985"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3598992">.</span><span class="ident" id="3598993">TrimLeftFunc</span><span class="op" id="3599005">(</span><span class="ident" id="3599006"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3599010">,</span>&nbsp;<span class="ident" id="3599012"><a href="/mime/mediatype.go.html#3592215">unicode</a></span><span class="op" id="3599019">.</span><span class="ident" id="3599020">IsSpace</span><span class="op" id="3599027">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599030">if</span>&nbsp;<span class="op" id="3599033">!</span><span class="ident" id="3599034"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3599041">.</span><span class="ident" id="3599042">HasPrefix</span><span class="op" id="3599051">(</span><span class="ident" id="3599052"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3599056">,</span>&nbsp;<span class="string" id="3599058">&#34;=&#34;</span><span class="op" id="3599061">)</span>&nbsp;<span class="op" id="3599063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599067">return</span>&nbsp;<span class="string" id="3599074">&#34;&#34;</span><span class="op" id="3599076">,</span>&nbsp;<span class="string" id="3599078">&#34;&#34;</span><span class="op" id="3599080">,</span>&nbsp;<span class="ident" id="3599082"><a href="/mime/mediatype.go.html#3598632">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599088"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3599093">=</span>&nbsp;<span class="ident" id="3599095"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3599099">[</span><span class="num" id="3599100">1</span><span class="op" id="3599101">:</span><span class="op" id="3599102">]</span>&nbsp;<span class="comment" id="3599104">//&nbsp;consume&nbsp;equals&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599128"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3599133">=</span>&nbsp;<span class="ident" id="3599135"><a href="/mime/mediatype.go.html#3592204">strings</a></span><span class="op" id="3599142">.</span><span class="ident" id="3599143">TrimLeftFunc</span><span class="op" id="3599155">(</span><span class="ident" id="3599156"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3599160">,</span>&nbsp;<span class="ident" id="3599162"><a href="/mime/mediatype.go.html#3592215">unicode</a></span><span class="op" id="3599169">.</span><span class="ident" id="3599170">IsSpace</span><span class="op" id="3599177">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599180"><a href="/mime/mediatype.go.html#3598650">value</a></span><span class="op" id="3599185">,</span>&nbsp;<span class="ident" id="3599187"><a href="/mime/mediatype.go.html#3598657">rest</a></span>&nbsp;<span class="op" id="3599192">=</span>&nbsp;<span class="ident" id="3599194"><a href="/mime/mediatype.go.html#3597980">consumeValue</a></span><span class="op" id="3599206">(</span><span class="ident" id="3599207"><a href="/mime/mediatype.go.html#3598657">rest</a></span><span class="op" id="3599211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599214">if</span>&nbsp;<span class="ident" id="3599217"><a href="/mime/mediatype.go.html#3598650">value</a></span>&nbsp;<span class="op" id="3599223">==</span>&nbsp;<span class="string" id="3599226">&#34;&#34;</span>&nbsp;<span class="op" id="3599229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599233">return</span>&nbsp;<span class="string" id="3599240">&#34;&#34;</span><span class="op" id="3599242">,</span>&nbsp;<span class="string" id="3599244">&#34;&#34;</span><span class="op" id="3599246">,</span>&nbsp;<span class="ident" id="3599248"><a href="/mime/mediatype.go.html#3598632">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599254">return</span>&nbsp;<span class="ident" id="3599261"><a href="/mime/mediatype.go.html#3598643">param</a></span><span class="op" id="3599266">,</span>&nbsp;<span class="ident" id="3599268"><a href="/mime/mediatype.go.html#3598650">value</a></span><span class="op" id="3599273">,</span>&nbsp;<span class="ident" id="3599275"><a href="/mime/mediatype.go.html#3598657">rest</a></span><br>
<span class="lineno">295</span><span class="op" id="3599280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3599283">func</span>&nbsp;<span class="ident" id="3599288">percentHexUnescape</span><span class="op" id="3599306">(</span><span class="ident" id="3599307">s</span>&nbsp;<span class="builtintype" id="3599309">string</span><span class="op" id="3599315">)</span>&nbsp;<span class="op" id="3599317">(</span><span class="builtintype" id="3599318">string</span><span class="op" id="3599324">,</span>&nbsp;<span class="builtintype" id="3599326">error</span><span class="op" id="3599331">)</span>&nbsp;<span class="op" id="3599333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599336">//&nbsp;Count&nbsp;%,&nbsp;check&nbsp;that&nbsp;they&#39;re&nbsp;well-formed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599381">percents</span>&nbsp;<span class="op" id="3599390">:=</span>&nbsp;<span class="num" id="3599393">0</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599396">for</span>&nbsp;<span class="ident" id="3599400">i</span>&nbsp;<span class="op" id="3599402">:=</span>&nbsp;<span class="num" id="3599405">0</span><span class="op" id="3599406">;</span>&nbsp;<span class="ident" id="3599408"><a href="/mime/mediatype.go.html#3599400">i</a></span>&nbsp;<span class="op" id="3599410">&lt;</span>&nbsp;<span class="builtinfunc" id="3599412">len</span><span class="op" id="3599415">(</span><span class="ident" id="3599416"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599417">)</span><span class="op" id="3599418">;</span>&nbsp;<span class="op" id="3599420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599424">if</span>&nbsp;<span class="ident" id="3599427"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599428">[</span><span class="ident" id="3599429"><a href="/mime/mediatype.go.html#3599400">i</a></span><span class="op" id="3599430">]</span>&nbsp;<span class="op" id="3599432">!=</span>&nbsp;<span class="string" id="3599435">&#39;%&#39;</span>&nbsp;<span class="op" id="3599439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599444"><a href="/mime/mediatype.go.html#3599400">i</a></span><span class="op" id="3599445">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599451">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599462">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599466"><a href="/mime/mediatype.go.html#3599381">percents</a></span><span class="op" id="3599474">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599479">if</span>&nbsp;<span class="ident" id="3599482"><a href="/mime/mediatype.go.html#3599400">i</a></span><span class="op" id="3599483">+</span><span class="num" id="3599484">2</span>&nbsp;<span class="op" id="3599486">&gt;=</span>&nbsp;<span class="builtinfunc" id="3599489">len</span><span class="op" id="3599492">(</span><span class="ident" id="3599493"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599494">)</span>&nbsp;<span class="op" id="3599496">||</span>&nbsp;<span class="op" id="3599499">!</span><span class="ident" id="3599500"><a href="/mime/mediatype.go.html#3599948">ishex</a></span><span class="op" id="3599505">(</span><span class="ident" id="3599506"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599507">[</span><span class="ident" id="3599508"><a href="/mime/mediatype.go.html#3599400">i</a></span><span class="op" id="3599509">+</span><span class="num" id="3599510">1</span><span class="op" id="3599511">]</span><span class="op" id="3599512">)</span>&nbsp;<span class="op" id="3599514">||</span>&nbsp;<span class="op" id="3599517">!</span><span class="ident" id="3599518"><a href="/mime/mediatype.go.html#3599948">ishex</a></span><span class="op" id="3599523">(</span><span class="ident" id="3599524"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599525">[</span><span class="ident" id="3599526"><a href="/mime/mediatype.go.html#3599400">i</a></span><span class="op" id="3599527">+</span><span class="num" id="3599528">2</span><span class="op" id="3599529">]</span><span class="op" id="3599530">)</span>&nbsp;<span class="op" id="3599532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599537"><a href="/mime/mediatype.go.html#3599307">s</a></span>&nbsp;<span class="op" id="3599539">=</span>&nbsp;<span class="ident" id="3599541"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599542">[</span><span class="ident" id="3599543"><a href="/mime/mediatype.go.html#3599400">i</a></span><span class="op" id="3599544">:</span><span class="op" id="3599545">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599550">if</span>&nbsp;<span class="builtinfunc" id="3599553">len</span><span class="op" id="3599556">(</span><span class="ident" id="3599557"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599558">)</span>&nbsp;<span class="op" id="3599560">&gt;</span>&nbsp;<span class="num" id="3599562">3</span>&nbsp;<span class="op" id="3599564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599570"><a href="/mime/mediatype.go.html#3599307">s</a></span>&nbsp;<span class="op" id="3599572">=</span>&nbsp;<span class="ident" id="3599574"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599575">[</span><span class="num" id="3599576">0</span><span class="op" id="3599577">:</span><span class="num" id="3599578">3</span><span class="op" id="3599579">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599589">return</span>&nbsp;<span class="string" id="3599596">&#34;&#34;</span><span class="op" id="3599598">,</span>&nbsp;<span class="ident" id="3599600"><a href="/mime/mediatype.go.html#3592189">fmt</a></span><span class="op" id="3599603">.</span><span class="ident" id="3599604">Errorf</span><span class="op" id="3599610">(</span><span class="string" id="3599611">&#34;mime:&nbsp;bogus&nbsp;characters&nbsp;after&nbsp;%%:&nbsp;%q&#34;</span><span class="op" id="3599648">,</span>&nbsp;<span class="ident" id="3599650"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599659"><a href="/mime/mediatype.go.html#3599400">i</a></span>&nbsp;<span class="op" id="3599661">+=</span>&nbsp;<span class="num" id="3599664">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599667">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599670">if</span>&nbsp;<span class="ident" id="3599673"><a href="/mime/mediatype.go.html#3599381">percents</a></span>&nbsp;<span class="op" id="3599682">==</span>&nbsp;<span class="num" id="3599685">0</span>&nbsp;<span class="op" id="3599687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599691">return</span>&nbsp;<span class="ident" id="3599698"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599699">,</span>&nbsp;<span class="ident" id="3599701">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599710">t</span>&nbsp;<span class="op" id="3599712">:=</span>&nbsp;<span class="builtinfunc" id="3599715">make</span><span class="op" id="3599719">(</span><span class="op" id="3599720">[</span><span class="op" id="3599721">]</span><span class="builtintype" id="3599722">byte</span><span class="op" id="3599726">,</span>&nbsp;<span class="builtinfunc" id="3599728">len</span><span class="op" id="3599731">(</span><span class="ident" id="3599732"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599733">)</span><span class="op" id="3599734">-</span><span class="num" id="3599735">2</span><span class="op" id="3599736">*</span><span class="ident" id="3599737"><a href="/mime/mediatype.go.html#3599381">percents</a></span><span class="op" id="3599745">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599748">j</span>&nbsp;<span class="op" id="3599750">:=</span>&nbsp;<span class="num" id="3599753">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599756">for</span>&nbsp;<span class="ident" id="3599760">i</span>&nbsp;<span class="op" id="3599762">:=</span>&nbsp;<span class="num" id="3599765">0</span><span class="op" id="3599766">;</span>&nbsp;<span class="ident" id="3599768"><a href="/mime/mediatype.go.html#3599760">i</a></span>&nbsp;<span class="op" id="3599770">&lt;</span>&nbsp;<span class="builtinfunc" id="3599772">len</span><span class="op" id="3599775">(</span><span class="ident" id="3599776"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599777">)</span><span class="op" id="3599778">;</span>&nbsp;<span class="op" id="3599780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599784">switch</span>&nbsp;<span class="ident" id="3599791"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599792">[</span><span class="ident" id="3599793"><a href="/mime/mediatype.go.html#3599760">i</a></span><span class="op" id="3599794">]</span>&nbsp;<span class="op" id="3599796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599800">case</span>&nbsp;<span class="string" id="3599805">&#39;%&#39;</span><span class="op" id="3599808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599813"><a href="/mime/mediatype.go.html#3599710">t</a></span><span class="op" id="3599814">[</span><span class="ident" id="3599815"><a href="/mime/mediatype.go.html#3599748">j</a></span><span class="op" id="3599816">]</span>&nbsp;<span class="op" id="3599818">=</span>&nbsp;<span class="ident" id="3599820"><a href="/mime/mediatype.go.html#3600130">unhex</a></span><span class="op" id="3599825">(</span><span class="ident" id="3599826"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599827">[</span><span class="ident" id="3599828"><a href="/mime/mediatype.go.html#3599760">i</a></span><span class="op" id="3599829">+</span><span class="num" id="3599830">1</span><span class="op" id="3599831">]</span><span class="op" id="3599832">)</span><span class="op" id="3599833">&lt;&lt;</span><span class="num" id="3599835">4</span>&nbsp;<span class="op" id="3599837">|</span>&nbsp;<span class="ident" id="3599839"><a href="/mime/mediatype.go.html#3600130">unhex</a></span><span class="op" id="3599844">(</span><span class="ident" id="3599845"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599846">[</span><span class="ident" id="3599847"><a href="/mime/mediatype.go.html#3599760">i</a></span><span class="op" id="3599848">+</span><span class="num" id="3599849">2</span><span class="op" id="3599850">]</span><span class="op" id="3599851">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599856"><a href="/mime/mediatype.go.html#3599748">j</a></span><span class="op" id="3599857">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599863"><a href="/mime/mediatype.go.html#3599760">i</a></span>&nbsp;<span class="op" id="3599865">+=</span>&nbsp;<span class="num" id="3599868">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599872">default</span><span class="op" id="3599879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599884"><a href="/mime/mediatype.go.html#3599710">t</a></span><span class="op" id="3599885">[</span><span class="ident" id="3599886"><a href="/mime/mediatype.go.html#3599748">j</a></span><span class="op" id="3599887">]</span>&nbsp;<span class="op" id="3599889">=</span>&nbsp;<span class="ident" id="3599891"><a href="/mime/mediatype.go.html#3599307">s</a></span><span class="op" id="3599892">[</span><span class="ident" id="3599893"><a href="/mime/mediatype.go.html#3599760">i</a></span><span class="op" id="3599894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599899"><a href="/mime/mediatype.go.html#3599748">j</a></span><span class="op" id="3599900">++</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599906"><a href="/mime/mediatype.go.html#3599760">i</a></span><span class="op" id="3599907">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599918">return</span>&nbsp;<span class="builtintype" id="3599925">string</span><span class="op" id="3599931">(</span><span class="ident" id="3599932"><a href="/mime/mediatype.go.html#3599710">t</a></span><span class="op" id="3599933">)</span><span class="op" id="3599934">,</span>&nbsp;<span class="ident" id="3599936">nil</span><br>
<span class="lineno"></span><span class="op" id="3599940">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="keyword" id="3599943">func</span>&nbsp;<span class="ident" id="3599948">ishex</span><span class="op" id="3599953">(</span><span class="ident" id="3599954">c</span>&nbsp;<span class="builtintype" id="3599956">byte</span><span class="op" id="3599960">)</span>&nbsp;<span class="builtintype" id="3599962">bool</span>&nbsp;<span class="op" id="3599967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599970">switch</span>&nbsp;<span class="op" id="3599977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599980">case</span>&nbsp;<span class="string" id="3599985">&#39;0&#39;</span>&nbsp;<span class="op" id="3599989">&lt;=</span>&nbsp;<span class="ident" id="3599992"><a href="/mime/mediatype.go.html#3599954">c</a></span>&nbsp;<span class="op" id="3599994">&amp;&amp;</span>&nbsp;<span class="ident" id="3599997"><a href="/mime/mediatype.go.html#3599954">c</a></span>&nbsp;<span class="op" id="3599999">&lt;=</span>&nbsp;<span class="string" id="3600002">&#39;9&#39;</span><span class="op" id="3600005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600009">return</span>&nbsp;<span class="builtintype" id="3600016">true</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600022">case</span>&nbsp;<span class="string" id="3600027">&#39;a&#39;</span>&nbsp;<span class="op" id="3600031">&lt;=</span>&nbsp;<span class="ident" id="3600034"><a href="/mime/mediatype.go.html#3599954">c</a></span>&nbsp;<span class="op" id="3600036">&amp;&amp;</span>&nbsp;<span class="ident" id="3600039"><a href="/mime/mediatype.go.html#3599954">c</a></span>&nbsp;<span class="op" id="3600041">&lt;=</span>&nbsp;<span class="string" id="3600044">&#39;f&#39;</span><span class="op" id="3600047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600051">return</span>&nbsp;<span class="builtintype" id="3600058">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600064">case</span>&nbsp;<span class="string" id="3600069">&#39;A&#39;</span>&nbsp;<span class="op" id="3600073">&lt;=</span>&nbsp;<span class="ident" id="3600076"><a href="/mime/mediatype.go.html#3599954">c</a></span>&nbsp;<span class="op" id="3600078">&amp;&amp;</span>&nbsp;<span class="ident" id="3600081"><a href="/mime/mediatype.go.html#3599954">c</a></span>&nbsp;<span class="op" id="3600083">&lt;=</span>&nbsp;<span class="string" id="3600086">&#39;F&#39;</span><span class="op" id="3600089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600093">return</span>&nbsp;<span class="builtintype" id="3600100">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600106">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600109">return</span>&nbsp;<span class="builtintype" id="3600116">false</span><br>
<span class="lineno"></span><span class="op" id="3600122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3600125">func</span>&nbsp;<span class="ident" id="3600130">unhex</span><span class="op" id="3600135">(</span><span class="ident" id="3600136">c</span>&nbsp;<span class="builtintype" id="3600138">byte</span><span class="op" id="3600142">)</span>&nbsp;<span class="builtintype" id="3600144">byte</span>&nbsp;<span class="op" id="3600149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600152">switch</span>&nbsp;<span class="op" id="3600159">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600162">case</span>&nbsp;<span class="string" id="3600167">&#39;0&#39;</span>&nbsp;<span class="op" id="3600171">&lt;=</span>&nbsp;<span class="ident" id="3600174"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600176">&amp;&amp;</span>&nbsp;<span class="ident" id="3600179"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600181">&lt;=</span>&nbsp;<span class="string" id="3600184">&#39;9&#39;</span><span class="op" id="3600187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600191">return</span>&nbsp;<span class="ident" id="3600198"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600200">-</span>&nbsp;<span class="string" id="3600202">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600207">case</span>&nbsp;<span class="string" id="3600212">&#39;a&#39;</span>&nbsp;<span class="op" id="3600216">&lt;=</span>&nbsp;<span class="ident" id="3600219"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600221">&amp;&amp;</span>&nbsp;<span class="ident" id="3600224"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600226">&lt;=</span>&nbsp;<span class="string" id="3600229">&#39;f&#39;</span><span class="op" id="3600232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600236">return</span>&nbsp;<span class="ident" id="3600243"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600245">-</span>&nbsp;<span class="string" id="3600247">&#39;a&#39;</span>&nbsp;<span class="op" id="3600251">+</span>&nbsp;<span class="num" id="3600253">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600257">case</span>&nbsp;<span class="string" id="3600262">&#39;A&#39;</span>&nbsp;<span class="op" id="3600266">&lt;=</span>&nbsp;<span class="ident" id="3600269"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600271">&amp;&amp;</span>&nbsp;<span class="ident" id="3600274"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600276">&lt;=</span>&nbsp;<span class="string" id="3600279">&#39;F&#39;</span><span class="op" id="3600282">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600286">return</span>&nbsp;<span class="ident" id="3600293"><a href="/mime/mediatype.go.html#3600136">c</a></span>&nbsp;<span class="op" id="3600295">-</span>&nbsp;<span class="string" id="3600297">&#39;A&#39;</span>&nbsp;<span class="op" id="3600301">+</span>&nbsp;<span class="num" id="3600303">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600310">return</span>&nbsp;<span class="num" id="3600317">0</span><br>
<span class="lineno"></span><span class="op" id="3600319">}</span>
</div>
</body>
</html>
