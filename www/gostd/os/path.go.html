<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2353901">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2353956">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2354010">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2354061">package</span>&nbsp;<span class="ident" id="2354069">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2354073">import</span>&nbsp;<span class="op" id="2354080">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2354083">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2354089">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2354099">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2354102">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2354146">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2354200">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2354229">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2354274">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2354312">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2354369">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2354389">func</span>&nbsp;<span class="ident" id="2354394">MkdirAll</span><span class="op" id="2354402">(</span><span class="ident" id="2354403">path</span>&nbsp;<span class="builtintype" id="2354408">string</span><span class="op" id="2354414">,</span>&nbsp;<span class="ident" id="2354416">perm</span>&nbsp;<span class="ident" id="2354421">FileMode</span><span class="op" id="2354429">)</span>&nbsp;<span class="builtintype" id="2354431">error</span>&nbsp;<span class="op" id="2354437">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2354440">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354535">dir</span><span class="op" id="2354538">,</span>&nbsp;<span class="ident" id="2354540">err</span>&nbsp;<span class="op" id="2354544">:=</span>&nbsp;<span class="ident" id="2354547">Stat</span><span class="op" id="2354551">(</span><span class="ident" id="2354552">path</span><span class="op" id="2354556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354559">if</span>&nbsp;<span class="ident" id="2354562">err</span>&nbsp;<span class="op" id="2354566">==</span>&nbsp;<span class="ident" id="2354569">nil</span>&nbsp;<span class="op" id="2354573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354577">if</span>&nbsp;<span class="ident" id="2354580">dir</span><span class="op" id="2354583">.</span><span class="ident" id="2354584">IsDir</span><span class="op" id="2354589">(</span><span class="op" id="2354590">)</span>&nbsp;<span class="op" id="2354592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354597">return</span>&nbsp;<span class="ident" id="2354604">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354614">return</span>&nbsp;<span class="op" id="2354621">&amp;</span><span class="ident" id="2354622">PathError</span><span class="op" id="2354631">{</span><span class="string" id="2354632">&#34;mkdir&#34;</span><span class="op" id="2354639">,</span>&nbsp;<span class="ident" id="2354641">path</span><span class="op" id="2354645">,</span>&nbsp;<span class="ident" id="2354647">syscall</span><span class="op" id="2354654">.</span><span class="ident" id="2354655">ENOTDIR</span><span class="op" id="2354662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2354669">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354738">i</span>&nbsp;<span class="op" id="2354740">:=</span>&nbsp;<span class="builtinfunc" id="2354743">len</span><span class="op" id="2354746">(</span><span class="ident" id="2354747">path</span><span class="op" id="2354751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354754">for</span>&nbsp;<span class="ident" id="2354758">i</span>&nbsp;<span class="op" id="2354760">&gt;</span>&nbsp;<span class="num" id="2354762">0</span>&nbsp;<span class="op" id="2354764">&amp;&amp;</span>&nbsp;<span class="ident" id="2354767">IsPathSeparator</span><span class="op" id="2354782">(</span><span class="ident" id="2354783">path</span><span class="op" id="2354787">[</span><span class="ident" id="2354788">i</span><span class="op" id="2354789">-</span><span class="num" id="2354790">1</span><span class="op" id="2354791">]</span><span class="op" id="2354792">)</span>&nbsp;<span class="op" id="2354794">{</span>&nbsp;<span class="comment" id="2354796">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354831">i</span><span class="op" id="2354832">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354840">j</span>&nbsp;<span class="op" id="2354842">:=</span>&nbsp;<span class="ident" id="2354845">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354848">for</span>&nbsp;<span class="ident" id="2354852">j</span>&nbsp;<span class="op" id="2354854">&gt;</span>&nbsp;<span class="num" id="2354856">0</span>&nbsp;<span class="op" id="2354858">&amp;&amp;</span>&nbsp;<span class="op" id="2354861">!</span><span class="ident" id="2354862">IsPathSeparator</span><span class="op" id="2354877">(</span><span class="ident" id="2354878">path</span><span class="op" id="2354882">[</span><span class="ident" id="2354883">j</span><span class="op" id="2354884">-</span><span class="num" id="2354885">1</span><span class="op" id="2354886">]</span><span class="op" id="2354887">)</span>&nbsp;<span class="op" id="2354889">{</span>&nbsp;<span class="comment" id="2354891">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354924">j</span><span class="op" id="2354925">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2354929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2354933">if</span>&nbsp;<span class="ident" id="2354936">j</span>&nbsp;<span class="op" id="2354938">&gt;</span>&nbsp;<span class="num" id="2354940">1</span>&nbsp;<span class="op" id="2354942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2354946">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2354965">err</span>&nbsp;<span class="op" id="2354969">=</span>&nbsp;<span class="ident" id="2354971">MkdirAll</span><span class="op" id="2354979">(</span><span class="ident" id="2354980">path</span><span class="op" id="2354984">[</span><span class="num" id="2354985">0</span><span class="op" id="2354986">:</span><span class="ident" id="2354987">j</span><span class="op" id="2354988">-</span><span class="num" id="2354989">1</span><span class="op" id="2354990">]</span><span class="op" id="2354991">,</span>&nbsp;<span class="ident" id="2354993">perm</span><span class="op" id="2354997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355001">if</span>&nbsp;<span class="ident" id="2355004">err</span>&nbsp;<span class="op" id="2355008">!=</span>&nbsp;<span class="ident" id="2355011">nil</span>&nbsp;<span class="op" id="2355015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355020">return</span>&nbsp;<span class="ident" id="2355027">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355040">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355096">err</span>&nbsp;<span class="op" id="2355100">=</span>&nbsp;<span class="ident" id="2355102">Mkdir</span><span class="op" id="2355107">(</span><span class="ident" id="2355108">path</span><span class="op" id="2355112">,</span>&nbsp;<span class="ident" id="2355114">perm</span><span class="op" id="2355118">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355121">if</span>&nbsp;<span class="ident" id="2355124">err</span>&nbsp;<span class="op" id="2355128">!=</span>&nbsp;<span class="ident" id="2355131">nil</span>&nbsp;<span class="op" id="2355135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355139">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355177">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355228">dir</span><span class="op" id="2355231">,</span>&nbsp;<span class="ident" id="2355233">err1</span>&nbsp;<span class="op" id="2355238">:=</span>&nbsp;<span class="ident" id="2355241">Lstat</span><span class="op" id="2355246">(</span><span class="ident" id="2355247">path</span><span class="op" id="2355251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355255">if</span>&nbsp;<span class="ident" id="2355258">err1</span>&nbsp;<span class="op" id="2355263">==</span>&nbsp;<span class="ident" id="2355266">nil</span>&nbsp;<span class="op" id="2355270">&amp;&amp;</span>&nbsp;<span class="ident" id="2355273">dir</span><span class="op" id="2355276">.</span><span class="ident" id="2355277">IsDir</span><span class="op" id="2355282">(</span><span class="op" id="2355283">)</span>&nbsp;<span class="op" id="2355285">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355290">return</span>&nbsp;<span class="ident" id="2355297">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355307">return</span>&nbsp;<span class="ident" id="2355314">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355322">return</span>&nbsp;<span class="ident" id="2355329">nil</span><br>
<span class="lineno">60</span><span class="op" id="2355333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2355336">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2355392">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2355452">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2355509">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2355536">func</span>&nbsp;<span class="ident" id="2355541">RemoveAll</span><span class="op" id="2355550">(</span><span class="ident" id="2355551">path</span>&nbsp;<span class="builtintype" id="2355556">string</span><span class="op" id="2355562">)</span>&nbsp;<span class="builtintype" id="2355564">error</span>&nbsp;<span class="op" id="2355570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355573">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355619">err</span>&nbsp;<span class="op" id="2355623">:=</span>&nbsp;<span class="ident" id="2355626">Remove</span><span class="op" id="2355632">(</span><span class="ident" id="2355633">path</span><span class="op" id="2355637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355640">if</span>&nbsp;<span class="ident" id="2355643">err</span>&nbsp;<span class="op" id="2355647">==</span>&nbsp;<span class="ident" id="2355650">nil</span>&nbsp;<span class="op" id="2355654">||</span>&nbsp;<span class="ident" id="2355657">IsNotExist</span><span class="op" id="2355667">(</span><span class="ident" id="2355668">err</span><span class="op" id="2355671">)</span>&nbsp;<span class="op" id="2355673">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355677">return</span>&nbsp;<span class="ident" id="2355684">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355693">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2355753">dir</span><span class="op" id="2355756">,</span>&nbsp;<span class="ident" id="2355758">serr</span>&nbsp;<span class="op" id="2355763">:=</span>&nbsp;<span class="ident" id="2355766">Lstat</span><span class="op" id="2355771">(</span><span class="ident" id="2355772">path</span><span class="op" id="2355776">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355779">if</span>&nbsp;<span class="ident" id="2355782">serr</span>&nbsp;<span class="op" id="2355787">!=</span>&nbsp;<span class="ident" id="2355790">nil</span>&nbsp;<span class="op" id="2355794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355798">if</span>&nbsp;<span class="ident" id="2355801">serr</span><span class="op" id="2355805">,</span>&nbsp;<span class="ident" id="2355807">ok</span>&nbsp;<span class="op" id="2355810">:=</span>&nbsp;<span class="ident" id="2355813">serr</span><span class="op" id="2355817">.</span><span class="op" id="2355818">(</span><span class="op" id="2355819">*</span><span class="ident" id="2355820">PathError</span><span class="op" id="2355829">)</span><span class="op" id="2355830">;</span>&nbsp;<span class="ident" id="2355832">ok</span>&nbsp;<span class="op" id="2355835">&amp;&amp;</span>&nbsp;<span class="op" id="2355838">(</span><span class="ident" id="2355839">IsNotExist</span><span class="op" id="2355849">(</span><span class="ident" id="2355850">serr</span><span class="op" id="2355854">.</span><span class="ident" id="2355855">Err</span><span class="op" id="2355858">)</span>&nbsp;<span class="op" id="2355860">||</span>&nbsp;<span class="ident" id="2355863">serr</span><span class="op" id="2355867">.</span><span class="ident" id="2355868">Err</span>&nbsp;<span class="op" id="2355872">==</span>&nbsp;<span class="ident" id="2355875">syscall</span><span class="op" id="2355882">.</span><span class="ident" id="2355883">ENOTDIR</span><span class="op" id="2355890">)</span>&nbsp;<span class="op" id="2355892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355897">return</span>&nbsp;<span class="ident" id="2355904">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355914">return</span>&nbsp;<span class="ident" id="2355921">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2355927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2355930">if</span>&nbsp;<span class="op" id="2355933">!</span><span class="ident" id="2355934">dir</span><span class="op" id="2355937">.</span><span class="ident" id="2355938">IsDir</span><span class="op" id="2355943">(</span><span class="op" id="2355944">)</span>&nbsp;<span class="op" id="2355946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2355950">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356002">return</span>&nbsp;<span class="ident" id="2356009">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356014">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356018">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356033">fd</span><span class="op" id="2356035">,</span>&nbsp;<span class="ident" id="2356037">err</span>&nbsp;<span class="op" id="2356041">:=</span>&nbsp;<span class="ident" id="2356044">Open</span><span class="op" id="2356048">(</span><span class="ident" id="2356049">path</span><span class="op" id="2356053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356056">if</span>&nbsp;<span class="ident" id="2356059">err</span>&nbsp;<span class="op" id="2356063">!=</span>&nbsp;<span class="ident" id="2356066">nil</span>&nbsp;<span class="op" id="2356070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356074">if</span>&nbsp;<span class="ident" id="2356077">IsNotExist</span><span class="op" id="2356087">(</span><span class="ident" id="2356088">err</span><span class="op" id="2356091">)</span>&nbsp;<span class="op" id="2356093">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356098">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356153">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356192">return</span>&nbsp;<span class="ident" id="2356199">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356209">return</span>&nbsp;<span class="ident" id="2356216">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356225">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356267">err</span>&nbsp;<span class="op" id="2356271">=</span>&nbsp;<span class="ident" id="2356273">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356278">for</span>&nbsp;<span class="op" id="2356282">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356286">names</span><span class="op" id="2356291">,</span>&nbsp;<span class="ident" id="2356293">err1</span>&nbsp;<span class="op" id="2356298">:=</span>&nbsp;<span class="ident" id="2356301">fd</span><span class="op" id="2356303">.</span><span class="ident" id="2356304">Readdirnames</span><span class="op" id="2356316">(</span><span class="num" id="2356317">100</span><span class="op" id="2356320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356324">for</span>&nbsp;<span class="ident" id="2356328">_</span><span class="op" id="2356329">,</span>&nbsp;<span class="ident" id="2356331">name</span>&nbsp;<span class="op" id="2356336">:=</span>&nbsp;<span class="keyword" id="2356339">range</span>&nbsp;<span class="ident" id="2356345">names</span>&nbsp;<span class="op" id="2356351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356356">err1</span>&nbsp;<span class="op" id="2356361">:=</span>&nbsp;<span class="ident" id="2356364">RemoveAll</span><span class="op" id="2356373">(</span><span class="ident" id="2356374">path</span>&nbsp;<span class="op" id="2356379">+</span>&nbsp;<span class="builtintype" id="2356381">string</span><span class="op" id="2356387">(</span><span class="ident" id="2356388">PathSeparator</span><span class="op" id="2356401">)</span>&nbsp;<span class="op" id="2356403">+</span>&nbsp;<span class="ident" id="2356405">name</span><span class="op" id="2356409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356414">if</span>&nbsp;<span class="ident" id="2356417">err</span>&nbsp;<span class="op" id="2356421">==</span>&nbsp;<span class="ident" id="2356424">nil</span>&nbsp;<span class="op" id="2356428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356434">err</span>&nbsp;<span class="op" id="2356438">=</span>&nbsp;<span class="ident" id="2356440">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356456">if</span>&nbsp;<span class="ident" id="2356459">err1</span>&nbsp;<span class="op" id="2356464">==</span>&nbsp;<span class="ident" id="2356467">io</span><span class="op" id="2356469">.</span><span class="ident" id="2356470">EOF</span>&nbsp;<span class="op" id="2356474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356479">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356487">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356491">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356539">if</span>&nbsp;<span class="ident" id="2356542">err</span>&nbsp;<span class="op" id="2356546">==</span>&nbsp;<span class="ident" id="2356549">nil</span>&nbsp;<span class="op" id="2356553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356558">err</span>&nbsp;<span class="op" id="2356562">=</span>&nbsp;<span class="ident" id="2356564">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356575">if</span>&nbsp;<span class="builtinfunc" id="2356578">len</span><span class="op" id="2356581">(</span><span class="ident" id="2356582">names</span><span class="op" id="2356587">)</span>&nbsp;<span class="op" id="2356589">==</span>&nbsp;<span class="num" id="2356592">0</span>&nbsp;<span class="op" id="2356594">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356599">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356614">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356682">fd</span><span class="op" id="2356684">.</span><span class="ident" id="2356685">Close</span><span class="op" id="2356690">(</span><span class="op" id="2356691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2356695">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356717">err1</span>&nbsp;<span class="op" id="2356722">:=</span>&nbsp;<span class="ident" id="2356725">Remove</span><span class="op" id="2356731">(</span><span class="ident" id="2356732">path</span><span class="op" id="2356736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356739">if</span>&nbsp;<span class="ident" id="2356742">err1</span>&nbsp;<span class="op" id="2356747">==</span>&nbsp;<span class="ident" id="2356750">nil</span>&nbsp;<span class="op" id="2356754">||</span>&nbsp;<span class="ident" id="2356757">IsNotExist</span><span class="op" id="2356767">(</span><span class="ident" id="2356768">err1</span><span class="op" id="2356772">)</span>&nbsp;<span class="op" id="2356774">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356778">return</span>&nbsp;<span class="ident" id="2356785">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356793">if</span>&nbsp;<span class="ident" id="2356796">err</span>&nbsp;<span class="op" id="2356800">==</span>&nbsp;<span class="ident" id="2356803">nil</span>&nbsp;<span class="op" id="2356807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2356811">err</span>&nbsp;<span class="op" id="2356815">=</span>&nbsp;<span class="ident" id="2356817">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2356823">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2356826">return</span>&nbsp;<span class="ident" id="2356833">err</span><br>
<span class="lineno"></span><span class="op" id="2356837">}</span>
</div>
</body>
</html>
