<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html" class="current">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2168142">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2168197">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2168251">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2168302">package</span>&nbsp;<span class="ident" id="2168310">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2168316">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspBessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2168382">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2168436">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2168487">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2168542">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2168572">//</span><br>
<span class="lineno"></span><span class="comment" id="2168575">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2168631">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2168700">//</span><br>
<span class="lineno"></span><span class="comment" id="2168703">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2168762">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2168818">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2168875">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2168892">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2168948">//</span><br>
<span class="lineno">25</span><span class="comment" id="2168951">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2168993">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2169053">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2169067">//</span><br>
<span class="lineno"></span><span class="comment" id="2169070">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2169088">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2169153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2169216">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2169250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2169284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2169318">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2169370">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2169410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2169465">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2169520">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2169577">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2169630">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2169684">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2169718">//</span><br>
<span class="lineno"></span><span class="comment" id="2169721">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2169772">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2169819">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2169843">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2169904">//</span><br>
<span class="lineno">50</span><span class="comment" id="2169907">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2169929">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2169949">//&nbsp;&nbsp;&nbsp;&nbspJn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2169969">func</span>&nbsp;<span class="ident" id="2169974">Jn</span><span class="op" id="2169976">(</span><span class="ident" id="2169977">n</span>&nbsp;<span class="builtintype" id="2169979">int</span><span class="op" id="2169982">,</span>&nbsp;<span class="ident" id="2169984">x</span>&nbsp;<span class="builtintype" id="2169986">float64</span><span class="op" id="2169993">)</span>&nbsp;<span class="builtintype" id="2169995">float64</span>&nbsp;<span class="op" id="2170003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170006">const</span>&nbsp;<span class="op" id="2170012">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2170016">TwoM29</span>&nbsp;<span class="op" id="2170023">=</span>&nbsp;<span class="num" id="2170025">1.0</span>&nbsp;<span class="op" id="2170029">/</span>&nbsp;<span class="op" id="2170031">(</span><span class="num" id="2170032">1</span>&nbsp;<span class="op" id="2170034">&lt;&lt;</span>&nbsp;<span class="num" id="2170037">29</span><span class="op" id="2170039">)</span>&nbsp;<span class="comment" id="2170041">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2170072">Two302</span>&nbsp;<span class="op" id="2170079">=</span>&nbsp;<span class="num" id="2170081">1</span>&nbsp;<span class="op" id="2170083">&lt;&lt;</span>&nbsp;<span class="num" id="2170086">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2170097">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170130">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170148">switch</span>&nbsp;<span class="op" id="2170155">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170158">case</span>&nbsp;<span class="ident" id="2170163">IsNaN</span><span class="op" id="2170168">(</span><span class="ident" id="2170169">x</span><span class="op" id="2170170">)</span><span class="op" id="2170171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170175">return</span>&nbsp;<span class="ident" id="2170182">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170185">case</span>&nbsp;<span class="ident" id="2170190">IsInf</span><span class="op" id="2170195">(</span><span class="ident" id="2170196">x</span><span class="op" id="2170197">,</span>&nbsp;<span class="num" id="2170199">0</span><span class="op" id="2170200">)</span><span class="op" id="2170201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170205">return</span>&nbsp;<span class="num" id="2170212">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170215">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170218">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170281">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170312">if</span>&nbsp;<span class="ident" id="2170315">n</span>&nbsp;<span class="op" id="2170317">==</span>&nbsp;<span class="num" id="2170320">0</span>&nbsp;<span class="op" id="2170322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170326">return</span>&nbsp;<span class="ident" id="2170333">J0</span><span class="op" id="2170335">(</span><span class="ident" id="2170336">x</span><span class="op" id="2170337">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170343">if</span>&nbsp;<span class="ident" id="2170346">x</span>&nbsp;<span class="op" id="2170348">==</span>&nbsp;<span class="num" id="2170351">0</span>&nbsp;<span class="op" id="2170353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170357">return</span>&nbsp;<span class="num" id="2170364">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170370">if</span>&nbsp;<span class="ident" id="2170373">n</span>&nbsp;<span class="op" id="2170375">&lt;</span>&nbsp;<span class="num" id="2170377">0</span>&nbsp;<span class="op" id="2170379">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2170383">n</span><span class="op" id="2170384">,</span>&nbsp;<span class="ident" id="2170386">x</span>&nbsp;<span class="op" id="2170388">=</span>&nbsp;<span class="op" id="2170390">-</span><span class="ident" id="2170391">n</span><span class="op" id="2170392">,</span>&nbsp;<span class="op" id="2170394">-</span><span class="ident" id="2170395">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170401">if</span>&nbsp;<span class="ident" id="2170404">n</span>&nbsp;<span class="op" id="2170406">==</span>&nbsp;<span class="num" id="2170409">1</span>&nbsp;<span class="op" id="2170411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170415">return</span>&nbsp;<span class="ident" id="2170422">J1</span><span class="op" id="2170424">(</span><span class="ident" id="2170425">x</span><span class="op" id="2170426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170429">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2170432">sign</span>&nbsp;<span class="op" id="2170437">:=</span>&nbsp;<span class="builtintype" id="2170440">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170447">if</span>&nbsp;<span class="ident" id="2170450">x</span>&nbsp;<span class="op" id="2170452">&lt;</span>&nbsp;<span class="num" id="2170454">0</span>&nbsp;<span class="op" id="2170456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2170460">x</span>&nbsp;<span class="op" id="2170462">=</span>&nbsp;<span class="op" id="2170464">-</span><span class="ident" id="2170465">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170469">if</span>&nbsp;<span class="ident" id="2170472">n</span><span class="op" id="2170473">&amp;</span><span class="num" id="2170474">1</span>&nbsp;<span class="op" id="2170476">==</span>&nbsp;<span class="num" id="2170479">1</span>&nbsp;<span class="op" id="2170481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2170486">sign</span>&nbsp;<span class="op" id="2170491">=</span>&nbsp;<span class="builtintype" id="2170493">true</span>&nbsp;<span class="comment" id="2170498">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2170527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170530">var</span>&nbsp;<span class="ident" id="2170534">b</span>&nbsp;<span class="builtintype" id="2170536">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170545">if</span>&nbsp;<span class="builtintype" id="2170548">float64</span><span class="op" id="2170555">(</span><span class="ident" id="2170556">n</span><span class="op" id="2170557">)</span>&nbsp;<span class="op" id="2170559">&lt;=</span>&nbsp;<span class="ident" id="2170562">x</span>&nbsp;<span class="op" id="2170564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170568">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2170616">if</span>&nbsp;<span class="ident" id="2170619">x</span>&nbsp;<span class="op" id="2170621">&gt;=</span>&nbsp;<span class="ident" id="2170624">Two302</span>&nbsp;<span class="op" id="2170631">{</span>&nbsp;<span class="comment" id="2170633">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170651">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170669">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170724">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170779">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170818">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170875">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170881">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170937">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2170991">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171087">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171184">var</span>&nbsp;<span class="ident" id="2171188">temp</span>&nbsp;<span class="builtintype" id="2171193">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171204">switch</span>&nbsp;<span class="ident" id="2171211">n</span>&nbsp;<span class="op" id="2171213">&amp;</span>&nbsp;<span class="num" id="2171215">3</span>&nbsp;<span class="op" id="2171217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171222">case</span>&nbsp;<span class="num" id="2171227">0</span><span class="op" id="2171228">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171234">temp</span>&nbsp;<span class="op" id="2171239">=</span>&nbsp;<span class="ident" id="2171241">Cos</span><span class="op" id="2171244">(</span><span class="ident" id="2171245">x</span><span class="op" id="2171246">)</span>&nbsp;<span class="op" id="2171248">+</span>&nbsp;<span class="ident" id="2171250">Sin</span><span class="op" id="2171253">(</span><span class="ident" id="2171254">x</span><span class="op" id="2171255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171260">case</span>&nbsp;<span class="num" id="2171265">1</span><span class="op" id="2171266">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171272">temp</span>&nbsp;<span class="op" id="2171277">=</span>&nbsp;<span class="op" id="2171279">-</span><span class="ident" id="2171280">Cos</span><span class="op" id="2171283">(</span><span class="ident" id="2171284">x</span><span class="op" id="2171285">)</span>&nbsp;<span class="op" id="2171287">+</span>&nbsp;<span class="ident" id="2171289">Sin</span><span class="op" id="2171292">(</span><span class="ident" id="2171293">x</span><span class="op" id="2171294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171299">case</span>&nbsp;<span class="num" id="2171304">2</span><span class="op" id="2171305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171311">temp</span>&nbsp;<span class="op" id="2171316">=</span>&nbsp;<span class="op" id="2171318">-</span><span class="ident" id="2171319">Cos</span><span class="op" id="2171322">(</span><span class="ident" id="2171323">x</span><span class="op" id="2171324">)</span>&nbsp;<span class="op" id="2171326">-</span>&nbsp;<span class="ident" id="2171328">Sin</span><span class="op" id="2171331">(</span><span class="ident" id="2171332">x</span><span class="op" id="2171333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171338">case</span>&nbsp;<span class="num" id="2171343">3</span><span class="op" id="2171344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171350">temp</span>&nbsp;<span class="op" id="2171355">=</span>&nbsp;<span class="ident" id="2171357">Cos</span><span class="op" id="2171360">(</span><span class="ident" id="2171361">x</span><span class="op" id="2171362">)</span>&nbsp;<span class="op" id="2171364">-</span>&nbsp;<span class="ident" id="2171366">Sin</span><span class="op" id="2171369">(</span><span class="ident" id="2171370">x</span><span class="op" id="2171371">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171381">b</span>&nbsp;<span class="op" id="2171383">=</span>&nbsp;<span class="op" id="2171385">(</span><span class="num" id="2171386">1</span>&nbsp;<span class="op" id="2171388">/</span>&nbsp;<span class="ident" id="2171390">SqrtPi</span><span class="op" id="2171396">)</span>&nbsp;<span class="op" id="2171398">*</span>&nbsp;<span class="ident" id="2171400">temp</span>&nbsp;<span class="op" id="2171405">/</span>&nbsp;<span class="ident" id="2171407">Sqrt</span><span class="op" id="2171411">(</span><span class="ident" id="2171412">x</span><span class="op" id="2171413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171417">}</span>&nbsp;<span class="keyword" id="2171419">else</span>&nbsp;<span class="op" id="2171424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171429">b</span>&nbsp;<span class="op" id="2171431">=</span>&nbsp;<span class="ident" id="2171433">J1</span><span class="op" id="2171435">(</span><span class="ident" id="2171436">x</span><span class="op" id="2171437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171442">for</span>&nbsp;<span class="ident" id="2171446">i</span><span class="op" id="2171447">,</span>&nbsp;<span class="ident" id="2171449">a</span>&nbsp;<span class="op" id="2171451">:=</span>&nbsp;<span class="num" id="2171454">1</span><span class="op" id="2171455">,</span>&nbsp;<span class="ident" id="2171457">J0</span><span class="op" id="2171459">(</span><span class="ident" id="2171460">x</span><span class="op" id="2171461">)</span><span class="op" id="2171462">;</span>&nbsp;<span class="ident" id="2171464">i</span>&nbsp;<span class="op" id="2171466">&lt;</span>&nbsp;<span class="ident" id="2171468">n</span><span class="op" id="2171469">;</span>&nbsp;<span class="ident" id="2171471">i</span><span class="op" id="2171472">++</span>&nbsp;<span class="op" id="2171475">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171481">a</span><span class="op" id="2171482">,</span>&nbsp;<span class="ident" id="2171484">b</span>&nbsp;<span class="op" id="2171486">=</span>&nbsp;<span class="ident" id="2171488">b</span><span class="op" id="2171489">,</span>&nbsp;<span class="ident" id="2171491">b</span><span class="op" id="2171492">*</span><span class="op" id="2171493">(</span><span class="builtintype" id="2171494">float64</span><span class="op" id="2171501">(</span><span class="ident" id="2171502">i</span><span class="op" id="2171503">+</span><span class="ident" id="2171504">i</span><span class="op" id="2171505">)</span><span class="op" id="2171506">/</span><span class="ident" id="2171507">x</span><span class="op" id="2171508">)</span><span class="op" id="2171509">-</span><span class="ident" id="2171510">a</span>&nbsp;<span class="comment" id="2171512">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171541">}</span>&nbsp;<span class="keyword" id="2171543">else</span>&nbsp;<span class="op" id="2171548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171552">if</span>&nbsp;<span class="ident" id="2171555">x</span>&nbsp;<span class="op" id="2171557">&lt;</span>&nbsp;<span class="ident" id="2171559">TwoM29</span>&nbsp;<span class="op" id="2171566">{</span>&nbsp;<span class="comment" id="2171568">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171585">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171646">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171683">if</span>&nbsp;<span class="ident" id="2171686">n</span>&nbsp;<span class="op" id="2171688">&gt;</span>&nbsp;<span class="num" id="2171690">33</span>&nbsp;<span class="op" id="2171693">{</span>&nbsp;<span class="comment" id="2171695">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171712">b</span>&nbsp;<span class="op" id="2171714">=</span>&nbsp;<span class="num" id="2171716">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171721">}</span>&nbsp;<span class="keyword" id="2171723">else</span>&nbsp;<span class="op" id="2171728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171734">temp</span>&nbsp;<span class="op" id="2171739">:=</span>&nbsp;<span class="ident" id="2171742">x</span>&nbsp;<span class="op" id="2171744">*</span>&nbsp;<span class="num" id="2171746">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171754">b</span>&nbsp;<span class="op" id="2171756">=</span>&nbsp;<span class="ident" id="2171758">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171767">a</span>&nbsp;<span class="op" id="2171769">:=</span>&nbsp;<span class="num" id="2171772">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2171780">for</span>&nbsp;<span class="ident" id="2171784">i</span>&nbsp;<span class="op" id="2171786">:=</span>&nbsp;<span class="num" id="2171789">2</span><span class="op" id="2171790">;</span>&nbsp;<span class="ident" id="2171792">i</span>&nbsp;<span class="op" id="2171794">&lt;=</span>&nbsp;<span class="ident" id="2171797">n</span><span class="op" id="2171798">;</span>&nbsp;<span class="ident" id="2171800">i</span><span class="op" id="2171801">++</span>&nbsp;<span class="op" id="2171804">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171811">a</span>&nbsp;<span class="op" id="2171813">*=</span>&nbsp;<span class="builtintype" id="2171816">float64</span><span class="op" id="2171823">(</span><span class="ident" id="2171824">i</span><span class="op" id="2171825">)</span>&nbsp;<span class="comment" id="2171827">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171842">b</span>&nbsp;<span class="op" id="2171844">*=</span>&nbsp;<span class="ident" id="2171847">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2171858">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2171884">b</span>&nbsp;<span class="op" id="2171886">/=</span>&nbsp;<span class="ident" id="2171889">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171894">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2171898">}</span>&nbsp;<span class="keyword" id="2171900">else</span>&nbsp;<span class="op" id="2171905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171910">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171940">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2171989">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172046">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172095">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172101">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172146">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172202">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172250">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172346">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172352">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172406">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172510">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172538">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172574">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172605">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172640">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172677">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172683">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172729">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172764">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172802">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172840">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172878">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbspgood&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2172921">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2172939">w</span>&nbsp;<span class="op" id="2172941">:=</span>&nbsp;<span class="builtintype" id="2172944">float64</span><span class="op" id="2172951">(</span><span class="ident" id="2172952">n</span><span class="op" id="2172953">+</span><span class="ident" id="2172954">n</span><span class="op" id="2172955">)</span>&nbsp;<span class="op" id="2172957">/</span>&nbsp;<span class="ident" id="2172959">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2172964">h</span>&nbsp;<span class="op" id="2172966">:=</span>&nbsp;<span class="num" id="2172969">2</span>&nbsp;<span class="op" id="2172971">/</span>&nbsp;<span class="ident" id="2172973">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2172978">q0</span>&nbsp;<span class="op" id="2172981">:=</span>&nbsp;<span class="ident" id="2172984">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2172989">z</span>&nbsp;<span class="op" id="2172991">:=</span>&nbsp;<span class="ident" id="2172994">w</span>&nbsp;<span class="op" id="2172996">+</span>&nbsp;<span class="ident" id="2172998">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173003">q1</span>&nbsp;<span class="op" id="2173006">:=</span>&nbsp;<span class="ident" id="2173009">w</span><span class="op" id="2173010">*</span><span class="ident" id="2173011">z</span>&nbsp;<span class="op" id="2173013">-</span>&nbsp;<span class="num" id="2173015">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173020">k</span>&nbsp;<span class="op" id="2173022">:=</span>&nbsp;<span class="num" id="2173025">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2173030">for</span>&nbsp;<span class="ident" id="2173034">q1</span>&nbsp;<span class="op" id="2173037">&lt;</span>&nbsp;<span class="num" id="2173039">1e9</span>&nbsp;<span class="op" id="2173043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173049">k</span>&nbsp;<span class="op" id="2173051">+=</span>&nbsp;<span class="num" id="2173054">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173060">z</span>&nbsp;<span class="op" id="2173062">+=</span>&nbsp;<span class="ident" id="2173065">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173071">q0</span><span class="op" id="2173073">,</span>&nbsp;<span class="ident" id="2173075">q1</span>&nbsp;<span class="op" id="2173078">=</span>&nbsp;<span class="ident" id="2173080">q1</span><span class="op" id="2173082">,</span>&nbsp;<span class="ident" id="2173084">z</span><span class="op" id="2173085">*</span><span class="ident" id="2173086">q1</span><span class="op" id="2173088">-</span><span class="ident" id="2173089">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173100">m</span>&nbsp;<span class="op" id="2173102">:=</span>&nbsp;<span class="ident" id="2173105">n</span>&nbsp;<span class="op" id="2173107">+</span>&nbsp;<span class="ident" id="2173109">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173114">t</span>&nbsp;<span class="op" id="2173116">:=</span>&nbsp;<span class="num" id="2173119">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2173126">for</span>&nbsp;<span class="ident" id="2173130">i</span>&nbsp;<span class="op" id="2173132">:=</span>&nbsp;<span class="num" id="2173135">2</span>&nbsp;<span class="op" id="2173137">*</span>&nbsp;<span class="op" id="2173139">(</span><span class="ident" id="2173140">n</span>&nbsp;<span class="op" id="2173142">+</span>&nbsp;<span class="ident" id="2173144">k</span><span class="op" id="2173145">)</span><span class="op" id="2173146">;</span>&nbsp;<span class="ident" id="2173148">i</span>&nbsp;<span class="op" id="2173150">&gt;=</span>&nbsp;<span class="ident" id="2173153">m</span><span class="op" id="2173154">;</span>&nbsp;<span class="ident" id="2173156">i</span>&nbsp;<span class="op" id="2173158">-=</span>&nbsp;<span class="num" id="2173161">2</span>&nbsp;<span class="op" id="2173163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173169">t</span>&nbsp;<span class="op" id="2173171">=</span>&nbsp;<span class="num" id="2173173">1</span>&nbsp;<span class="op" id="2173175">/</span>&nbsp;<span class="op" id="2173177">(</span><span class="builtintype" id="2173178">float64</span><span class="op" id="2173185">(</span><span class="ident" id="2173186">i</span><span class="op" id="2173187">)</span><span class="op" id="2173188">/</span><span class="ident" id="2173189">x</span>&nbsp;<span class="op" id="2173191">-</span>&nbsp;<span class="ident" id="2173193">t</span><span class="op" id="2173194">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173204">a</span>&nbsp;<span class="op" id="2173206">:=</span>&nbsp;<span class="ident" id="2173209">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173214">b</span>&nbsp;<span class="op" id="2173216">=</span>&nbsp;<span class="num" id="2173218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173223">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173277">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173314">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173345">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173386">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173452">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173511">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173544">tmp</span>&nbsp;<span class="op" id="2173548">:=</span>&nbsp;<span class="builtintype" id="2173551">float64</span><span class="op" id="2173558">(</span><span class="ident" id="2173559">n</span><span class="op" id="2173560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173565">v</span>&nbsp;<span class="op" id="2173567">:=</span>&nbsp;<span class="num" id="2173570">2</span>&nbsp;<span class="op" id="2173572">/</span>&nbsp;<span class="ident" id="2173574">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173579">tmp</span>&nbsp;<span class="op" id="2173583">=</span>&nbsp;<span class="ident" id="2173585">tmp</span>&nbsp;<span class="op" id="2173589">*</span>&nbsp;<span class="ident" id="2173591">Log</span><span class="op" id="2173594">(</span><span class="ident" id="2173595">Abs</span><span class="op" id="2173598">(</span><span class="ident" id="2173599">v</span><span class="op" id="2173600">*</span><span class="ident" id="2173601">tmp</span><span class="op" id="2173604">)</span><span class="op" id="2173605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2173610">if</span>&nbsp;<span class="ident" id="2173613">tmp</span>&nbsp;<span class="op" id="2173617">&lt;</span>&nbsp;<span class="num" id="2173619">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2173646">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2173652">for</span>&nbsp;<span class="ident" id="2173656">i</span>&nbsp;<span class="op" id="2173658">:=</span>&nbsp;<span class="ident" id="2173661">n</span>&nbsp;<span class="op" id="2173663">-</span>&nbsp;<span class="num" id="2173665">1</span><span class="op" id="2173666">;</span>&nbsp;<span class="ident" id="2173668">i</span>&nbsp;<span class="op" id="2173670">&gt;</span>&nbsp;<span class="num" id="2173672">0</span><span class="op" id="2173673">;</span>&nbsp;<span class="ident" id="2173675">i</span><span class="op" id="2173676">--</span>&nbsp;<span class="op" id="2173679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173686">di</span>&nbsp;<span class="op" id="2173689">:=</span>&nbsp;<span class="builtintype" id="2173692">float64</span><span class="op" id="2173699">(</span><span class="ident" id="2173700">i</span>&nbsp;<span class="op" id="2173702">+</span>&nbsp;<span class="ident" id="2173704">i</span><span class="op" id="2173705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173712">a</span><span class="op" id="2173713">,</span>&nbsp;<span class="ident" id="2173715">b</span>&nbsp;<span class="op" id="2173717">=</span>&nbsp;<span class="ident" id="2173719">b</span><span class="op" id="2173720">,</span>&nbsp;<span class="ident" id="2173722">b</span><span class="op" id="2173723">*</span><span class="ident" id="2173724">di</span><span class="op" id="2173726">/</span><span class="ident" id="2173727">x</span><span class="op" id="2173728">-</span><span class="ident" id="2173729">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173736">di</span>&nbsp;<span class="op" id="2173739">-=</span>&nbsp;<span class="num" id="2173742">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173748">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173753">}</span>&nbsp;<span class="keyword" id="2173755">else</span>&nbsp;<span class="op" id="2173760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2173766">for</span>&nbsp;<span class="ident" id="2173770">i</span>&nbsp;<span class="op" id="2173772">:=</span>&nbsp;<span class="ident" id="2173775">n</span>&nbsp;<span class="op" id="2173777">-</span>&nbsp;<span class="num" id="2173779">1</span><span class="op" id="2173780">;</span>&nbsp;<span class="ident" id="2173782">i</span>&nbsp;<span class="op" id="2173784">&gt;</span>&nbsp;<span class="num" id="2173786">0</span><span class="op" id="2173787">;</span>&nbsp;<span class="ident" id="2173789">i</span><span class="op" id="2173790">--</span>&nbsp;<span class="op" id="2173793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173800">di</span>&nbsp;<span class="op" id="2173803">:=</span>&nbsp;<span class="builtintype" id="2173806">float64</span><span class="op" id="2173813">(</span><span class="ident" id="2173814">i</span>&nbsp;<span class="op" id="2173816">+</span>&nbsp;<span class="ident" id="2173818">i</span><span class="op" id="2173819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173826">a</span><span class="op" id="2173827">,</span>&nbsp;<span class="ident" id="2173829">b</span>&nbsp;<span class="op" id="2173831">=</span>&nbsp;<span class="ident" id="2173833">b</span><span class="op" id="2173834">,</span>&nbsp;<span class="ident" id="2173836">b</span><span class="op" id="2173837">*</span><span class="ident" id="2173838">di</span><span class="op" id="2173840">/</span><span class="ident" id="2173841">x</span><span class="op" id="2173842">-</span><span class="ident" id="2173843">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173850">di</span>&nbsp;<span class="op" id="2173853">-=</span>&nbsp;<span class="num" id="2173856">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2173863">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2173906">if</span>&nbsp;<span class="ident" id="2173909">b</span>&nbsp;<span class="op" id="2173911">&gt;</span>&nbsp;<span class="num" id="2173913">1e100</span>&nbsp;<span class="op" id="2173919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173927">a</span>&nbsp;<span class="op" id="2173929">/=</span>&nbsp;<span class="ident" id="2173932">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173940">t</span>&nbsp;<span class="op" id="2173942">/=</span>&nbsp;<span class="ident" id="2173945">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173953">b</span>&nbsp;<span class="op" id="2173955">=</span>&nbsp;<span class="num" id="2173957">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2173975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2173980">b</span>&nbsp;<span class="op" id="2173982">=</span>&nbsp;<span class="ident" id="2173984">t</span>&nbsp;<span class="op" id="2173986">*</span>&nbsp;<span class="ident" id="2173988">J0</span><span class="op" id="2173990">(</span><span class="ident" id="2173991">x</span><span class="op" id="2173992">)</span>&nbsp;<span class="op" id="2173994">/</span>&nbsp;<span class="ident" id="2173996">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174000">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174006">if</span>&nbsp;<span class="ident" id="2174009">sign</span>&nbsp;<span class="op" id="2174014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174018">return</span>&nbsp;<span class="op" id="2174025">-</span><span class="ident" id="2174026">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174032">return</span>&nbsp;<span class="ident" id="2174039">b</span><br>
<span class="lineno">225</span><span class="op" id="2174041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2174044">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2174106">//</span><br>
<span class="lineno"></span><span class="comment" id="2174109">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2174131">//&nbsp;&nbsp;&nbsp;&nbspYn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2174150">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2174173">//&nbsp;&nbsp;&nbsp;&nbspYn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2174227">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2174249">//&nbsp;&nbsp;&nbsp;&nbspY1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2174269">func</span>&nbsp;<span class="ident" id="2174274">Yn</span><span class="op" id="2174276">(</span><span class="ident" id="2174277">n</span>&nbsp;<span class="builtintype" id="2174279">int</span><span class="op" id="2174282">,</span>&nbsp;<span class="ident" id="2174284">x</span>&nbsp;<span class="builtintype" id="2174286">float64</span><span class="op" id="2174293">)</span>&nbsp;<span class="builtintype" id="2174295">float64</span>&nbsp;<span class="op" id="2174303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174306">const</span>&nbsp;<span class="ident" id="2174312">Two302</span>&nbsp;<span class="op" id="2174319">=</span>&nbsp;<span class="num" id="2174321">1</span>&nbsp;<span class="op" id="2174323">&lt;&lt;</span>&nbsp;<span class="num" id="2174326">302</span>&nbsp;<span class="comment" id="2174330">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174360">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174378">switch</span>&nbsp;<span class="op" id="2174385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174388">case</span>&nbsp;<span class="ident" id="2174393">x</span>&nbsp;<span class="op" id="2174395">&lt;</span>&nbsp;<span class="num" id="2174397">0</span>&nbsp;<span class="op" id="2174399">||</span>&nbsp;<span class="ident" id="2174402">IsNaN</span><span class="op" id="2174407">(</span><span class="ident" id="2174408">x</span><span class="op" id="2174409">)</span><span class="op" id="2174410">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174414">return</span>&nbsp;<span class="ident" id="2174421">NaN</span><span class="op" id="2174424">(</span><span class="op" id="2174425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174428">case</span>&nbsp;<span class="ident" id="2174433">IsInf</span><span class="op" id="2174438">(</span><span class="ident" id="2174439">x</span><span class="op" id="2174440">,</span>&nbsp;<span class="num" id="2174442">1</span><span class="op" id="2174443">)</span><span class="op" id="2174444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174448">return</span>&nbsp;<span class="num" id="2174455">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174462">if</span>&nbsp;<span class="ident" id="2174465">n</span>&nbsp;<span class="op" id="2174467">==</span>&nbsp;<span class="num" id="2174470">0</span>&nbsp;<span class="op" id="2174472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174476">return</span>&nbsp;<span class="ident" id="2174483">Y0</span><span class="op" id="2174485">(</span><span class="ident" id="2174486">x</span><span class="op" id="2174487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174493">if</span>&nbsp;<span class="ident" id="2174496">x</span>&nbsp;<span class="op" id="2174498">==</span>&nbsp;<span class="num" id="2174501">0</span>&nbsp;<span class="op" id="2174503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174507">if</span>&nbsp;<span class="ident" id="2174510">n</span>&nbsp;<span class="op" id="2174512">&lt;</span>&nbsp;<span class="num" id="2174514">0</span>&nbsp;<span class="op" id="2174516">&amp;&amp;</span>&nbsp;<span class="ident" id="2174519">n</span><span class="op" id="2174520">&amp;</span><span class="num" id="2174521">1</span>&nbsp;<span class="op" id="2174523">==</span>&nbsp;<span class="num" id="2174526">1</span>&nbsp;<span class="op" id="2174528">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174533">return</span>&nbsp;<span class="ident" id="2174540">Inf</span><span class="op" id="2174543">(</span><span class="num" id="2174544">1</span><span class="op" id="2174545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174553">return</span>&nbsp;<span class="ident" id="2174560">Inf</span><span class="op" id="2174563">(</span><span class="op" id="2174564">-</span><span class="num" id="2174565">1</span><span class="op" id="2174566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174572">sign</span>&nbsp;<span class="op" id="2174577">:=</span>&nbsp;<span class="builtintype" id="2174580">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174587">if</span>&nbsp;<span class="ident" id="2174590">n</span>&nbsp;<span class="op" id="2174592">&lt;</span>&nbsp;<span class="num" id="2174594">0</span>&nbsp;<span class="op" id="2174596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174600">n</span>&nbsp;<span class="op" id="2174602">=</span>&nbsp;<span class="op" id="2174604">-</span><span class="ident" id="2174605">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174609">if</span>&nbsp;<span class="ident" id="2174612">n</span><span class="op" id="2174613">&amp;</span><span class="num" id="2174614">1</span>&nbsp;<span class="op" id="2174616">==</span>&nbsp;<span class="num" id="2174619">1</span>&nbsp;<span class="op" id="2174621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2174626">sign</span>&nbsp;<span class="op" id="2174631">=</span>&nbsp;<span class="builtintype" id="2174633">true</span>&nbsp;<span class="comment" id="2174638">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174673">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174679">if</span>&nbsp;<span class="ident" id="2174682">n</span>&nbsp;<span class="op" id="2174684">==</span>&nbsp;<span class="num" id="2174687">1</span>&nbsp;<span class="op" id="2174689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174693">if</span>&nbsp;<span class="ident" id="2174696">sign</span>&nbsp;<span class="op" id="2174701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174706">return</span>&nbsp;<span class="op" id="2174713">-</span><span class="ident" id="2174714">Y1</span><span class="op" id="2174716">(</span><span class="ident" id="2174717">x</span><span class="op" id="2174718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174722">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174726">return</span>&nbsp;<span class="ident" id="2174733">Y1</span><span class="op" id="2174735">(</span><span class="ident" id="2174736">x</span><span class="op" id="2174737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2174740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174743">var</span>&nbsp;<span class="ident" id="2174747">b</span>&nbsp;<span class="builtintype" id="2174749">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2174758">if</span>&nbsp;<span class="ident" id="2174761">x</span>&nbsp;<span class="op" id="2174763">&gt;=</span>&nbsp;<span class="ident" id="2174766">Two302</span>&nbsp;<span class="op" id="2174773">{</span>&nbsp;<span class="comment" id="2174775">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174791">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174808">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174857">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174906">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174939">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspxn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174983">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2174988">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbspsin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbspcos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2175025">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2175066">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2175088">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2175111">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp-s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2175133">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175156">var</span>&nbsp;<span class="ident" id="2175160">temp</span>&nbsp;<span class="builtintype" id="2175165">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175175">switch</span>&nbsp;<span class="ident" id="2175182">n</span>&nbsp;<span class="op" id="2175184">&amp;</span>&nbsp;<span class="num" id="2175186">3</span>&nbsp;<span class="op" id="2175188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175192">case</span>&nbsp;<span class="num" id="2175197">0</span><span class="op" id="2175198">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175203">temp</span>&nbsp;<span class="op" id="2175208">=</span>&nbsp;<span class="ident" id="2175210">Sin</span><span class="op" id="2175213">(</span><span class="ident" id="2175214">x</span><span class="op" id="2175215">)</span>&nbsp;<span class="op" id="2175217">-</span>&nbsp;<span class="ident" id="2175219">Cos</span><span class="op" id="2175222">(</span><span class="ident" id="2175223">x</span><span class="op" id="2175224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175228">case</span>&nbsp;<span class="num" id="2175233">1</span><span class="op" id="2175234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175239">temp</span>&nbsp;<span class="op" id="2175244">=</span>&nbsp;<span class="op" id="2175246">-</span><span class="ident" id="2175247">Sin</span><span class="op" id="2175250">(</span><span class="ident" id="2175251">x</span><span class="op" id="2175252">)</span>&nbsp;<span class="op" id="2175254">-</span>&nbsp;<span class="ident" id="2175256">Cos</span><span class="op" id="2175259">(</span><span class="ident" id="2175260">x</span><span class="op" id="2175261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175265">case</span>&nbsp;<span class="num" id="2175270">2</span><span class="op" id="2175271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175276">temp</span>&nbsp;<span class="op" id="2175281">=</span>&nbsp;<span class="op" id="2175283">-</span><span class="ident" id="2175284">Sin</span><span class="op" id="2175287">(</span><span class="ident" id="2175288">x</span><span class="op" id="2175289">)</span>&nbsp;<span class="op" id="2175291">+</span>&nbsp;<span class="ident" id="2175293">Cos</span><span class="op" id="2175296">(</span><span class="ident" id="2175297">x</span><span class="op" id="2175298">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175302">case</span>&nbsp;<span class="num" id="2175307">3</span><span class="op" id="2175308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175313">temp</span>&nbsp;<span class="op" id="2175318">=</span>&nbsp;<span class="ident" id="2175320">Sin</span><span class="op" id="2175323">(</span><span class="ident" id="2175324">x</span><span class="op" id="2175325">)</span>&nbsp;<span class="op" id="2175327">+</span>&nbsp;<span class="ident" id="2175329">Cos</span><span class="op" id="2175332">(</span><span class="ident" id="2175333">x</span><span class="op" id="2175334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175342">b</span>&nbsp;<span class="op" id="2175344">=</span>&nbsp;<span class="op" id="2175346">(</span><span class="num" id="2175347">1</span>&nbsp;<span class="op" id="2175349">/</span>&nbsp;<span class="ident" id="2175351">SqrtPi</span><span class="op" id="2175357">)</span>&nbsp;<span class="op" id="2175359">*</span>&nbsp;<span class="ident" id="2175361">temp</span>&nbsp;<span class="op" id="2175366">/</span>&nbsp;<span class="ident" id="2175368">Sqrt</span><span class="op" id="2175372">(</span><span class="ident" id="2175373">x</span><span class="op" id="2175374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175377">}</span>&nbsp;<span class="keyword" id="2175379">else</span>&nbsp;<span class="op" id="2175384">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175388">a</span>&nbsp;<span class="op" id="2175390">:=</span>&nbsp;<span class="ident" id="2175393">Y0</span><span class="op" id="2175395">(</span><span class="ident" id="2175396">x</span><span class="op" id="2175397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175401">b</span>&nbsp;<span class="op" id="2175403">=</span>&nbsp;<span class="ident" id="2175405">Y1</span><span class="op" id="2175407">(</span><span class="ident" id="2175408">x</span><span class="op" id="2175409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2175413">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175436">for</span>&nbsp;<span class="ident" id="2175440">i</span>&nbsp;<span class="op" id="2175442">:=</span>&nbsp;<span class="num" id="2175445">1</span><span class="op" id="2175446">;</span>&nbsp;<span class="ident" id="2175448">i</span>&nbsp;<span class="op" id="2175450">&lt;</span>&nbsp;<span class="ident" id="2175452">n</span>&nbsp;<span class="op" id="2175454">&amp;&amp;</span>&nbsp;<span class="op" id="2175457">!</span><span class="ident" id="2175458">IsInf</span><span class="op" id="2175463">(</span><span class="ident" id="2175464">b</span><span class="op" id="2175465">,</span>&nbsp;<span class="op" id="2175467">-</span><span class="num" id="2175468">1</span><span class="op" id="2175469">)</span><span class="op" id="2175470">;</span>&nbsp;<span class="ident" id="2175472">i</span><span class="op" id="2175473">++</span>&nbsp;<span class="op" id="2175476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2175481">a</span><span class="op" id="2175482">,</span>&nbsp;<span class="ident" id="2175484">b</span>&nbsp;<span class="op" id="2175486">=</span>&nbsp;<span class="ident" id="2175488">b</span><span class="op" id="2175489">,</span>&nbsp;<span class="op" id="2175491">(</span><span class="builtintype" id="2175492">float64</span><span class="op" id="2175499">(</span><span class="ident" id="2175500">i</span><span class="op" id="2175501">+</span><span class="ident" id="2175502">i</span><span class="op" id="2175503">)</span><span class="op" id="2175504">/</span><span class="ident" id="2175505">x</span><span class="op" id="2175506">)</span><span class="op" id="2175507">*</span><span class="ident" id="2175508">b</span><span class="op" id="2175509">-</span><span class="ident" id="2175510">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175520">if</span>&nbsp;<span class="ident" id="2175523">sign</span>&nbsp;<span class="op" id="2175528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175532">return</span>&nbsp;<span class="op" id="2175539">-</span><span class="ident" id="2175540">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2175543">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2175546">return</span>&nbsp;<span class="ident" id="2175553">b</span><br>
<span class="lineno"></span><span class="op" id="2175555">}</span>
</div>
</body>
</html>
