<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6731218">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6731273">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6731327">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6731378">package</span>&nbsp;<span class="ident" id="6731386">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6731396">import</span>&nbsp;<span class="op" id="6731403">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6731406">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6731419">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6731431">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6731441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6731444">func</span>&nbsp;<span class="ident" id="6731449">TestServer</span><span class="op" id="6731459">(</span><span class="ident" id="6731460">t</span>&nbsp;<span class="op" id="6731462">*</span><span class="ident" id="6731463">testing</span><span class="op" id="6731470">.</span><span class="ident" id="6731471">T</span><span class="op" id="6731472">)</span>&nbsp;<span class="op" id="6731474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731477">ts</span>&nbsp;<span class="op" id="6731480">:=</span>&nbsp;<span class="ident" id="6731483">NewServer</span><span class="op" id="6731492">(</span><span class="ident" id="6731493">http</span><span class="op" id="6731497">.</span><span class="ident" id="6731498">HandlerFunc</span><span class="op" id="6731509">(</span><span class="keyword" id="6731510">func</span><span class="op" id="6731514">(</span><span class="ident" id="6731515">w</span>&nbsp;<span class="ident" id="6731517">http</span><span class="op" id="6731521">.</span><span class="ident" id="6731522">ResponseWriter</span><span class="op" id="6731536">,</span>&nbsp;<span class="ident" id="6731538">r</span>&nbsp;<span class="op" id="6731540">*</span><span class="ident" id="6731541">http</span><span class="op" id="6731545">.</span><span class="ident" id="6731546">Request</span><span class="op" id="6731553">)</span>&nbsp;<span class="op" id="6731555">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731559">w</span><span class="op" id="6731560">.</span><span class="ident" id="6731561">Write</span><span class="op" id="6731566">(</span><span class="op" id="6731567">[</span><span class="op" id="6731568">]</span><span class="builtintype" id="6731569">byte</span><span class="op" id="6731573">(</span><span class="string" id="6731574">&#34;hello&#34;</span><span class="op" id="6731581">)</span><span class="op" id="6731582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731585">}</span><span class="op" id="6731586">)</span><span class="op" id="6731587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731590">defer</span>&nbsp;<span class="ident" id="6731596">ts</span><span class="op" id="6731598">.</span><span class="ident" id="6731599">Close</span><span class="op" id="6731604">(</span><span class="op" id="6731605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731608">res</span><span class="op" id="6731611">,</span>&nbsp;<span class="ident" id="6731613">err</span>&nbsp;<span class="op" id="6731617">:=</span>&nbsp;<span class="ident" id="6731620">http</span><span class="op" id="6731624">.</span><span class="ident" id="6731625">Get</span><span class="op" id="6731628">(</span><span class="ident" id="6731629">ts</span><span class="op" id="6731631">.</span><span class="ident" id="6731632">URL</span><span class="op" id="6731635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731638">if</span>&nbsp;<span class="ident" id="6731641">err</span>&nbsp;<span class="op" id="6731645">!=</span>&nbsp;<span class="ident" id="6731648">nil</span>&nbsp;<span class="op" id="6731652">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731656">t</span><span class="op" id="6731657">.</span><span class="ident" id="6731658">Fatal</span><span class="op" id="6731663">(</span><span class="ident" id="6731664">err</span><span class="op" id="6731667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731673">got</span><span class="op" id="6731676">,</span>&nbsp;<span class="ident" id="6731678">err</span>&nbsp;<span class="op" id="6731682">:=</span>&nbsp;<span class="ident" id="6731685">ioutil</span><span class="op" id="6731691">.</span><span class="ident" id="6731692">ReadAll</span><span class="op" id="6731699">(</span><span class="ident" id="6731700">res</span><span class="op" id="6731703">.</span><span class="ident" id="6731704">Body</span><span class="op" id="6731708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731711">if</span>&nbsp;<span class="ident" id="6731714">err</span>&nbsp;<span class="op" id="6731718">!=</span>&nbsp;<span class="ident" id="6731721">nil</span>&nbsp;<span class="op" id="6731725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731729">t</span><span class="op" id="6731730">.</span><span class="ident" id="6731731">Fatal</span><span class="op" id="6731736">(</span><span class="ident" id="6731737">err</span><span class="op" id="6731740">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6731746">if</span>&nbsp;<span class="builtintype" id="6731749">string</span><span class="op" id="6731755">(</span><span class="ident" id="6731756">got</span><span class="op" id="6731759">)</span>&nbsp;<span class="op" id="6731761">!=</span>&nbsp;<span class="string" id="6731764">&#34;hello&#34;</span>&nbsp;<span class="op" id="6731772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6731776">t</span><span class="op" id="6731777">.</span><span class="ident" id="6731778">Errorf</span><span class="op" id="6731784">(</span><span class="string" id="6731785">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="6731805">,</span>&nbsp;<span class="builtintype" id="6731807">string</span><span class="op" id="6731813">(</span><span class="ident" id="6731814">got</span><span class="op" id="6731817">)</span><span class="op" id="6731818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6731821">}</span><br>
<span class="lineno"></span><span class="op" id="6731823">}</span>
</div>
</body>
</html>
