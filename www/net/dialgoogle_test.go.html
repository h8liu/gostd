<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7840902">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7840957">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7841011">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7841062">package</span>&nbsp;<span class="ident" id="7841070">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7841075">import</span>&nbsp;<span class="op" id="7841082">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841085">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841093">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841100">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841106">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841117">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841128">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7841138">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7841141">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="7841214">var</span>&nbsp;<span class="ident" id="7841218">testIPv6</span>&nbsp;<span class="op" id="7841227">=</span>&nbsp;<span class="ident" id="7841229"><a href="/net/dialgoogle_test.go.html#7841085">flag</a></span><span class="op" id="7841233">.</span><span class="ident" id="7841234">Bool</span><span class="op" id="7841238">(</span><span class="string" id="7841239">&#34;ipv6&#34;</span><span class="op" id="7841245">,</span>&nbsp;<span class="builtintype" id="7841247">false</span><span class="op" id="7841252">,</span>&nbsp;<span class="string" id="7841254">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="7841285">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7841288">func</span>&nbsp;<span class="ident" id="7841293">TestResolveGoogle</span><span class="op" id="7841310">(</span><span class="ident" id="7841311">t</span>&nbsp;<span class="op" id="7841313">*</span><span class="ident" id="7841314"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7841321">.</span><span class="ident" id="7841322">T</span><span class="op" id="7841323">)</span>&nbsp;<span class="op" id="7841325">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841328">if</span>&nbsp;<span class="ident" id="7841331"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7841338">.</span><span class="ident" id="7841339">Short</span><span class="op" id="7841344">(</span><span class="op" id="7841345">)</span>&nbsp;<span class="op" id="7841347">||</span>&nbsp;<span class="op" id="7841350">!</span><span class="op" id="7841351">*</span><span class="ident" id="7841352"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="7841365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841369"><a href="/net/dialgoogle_test.go.html#7841311">t</a></span><span class="op" id="7841370">.</span><span class="ident" id="7841371">Skip</span><span class="op" id="7841375">(</span><span class="string" id="7841376">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7841417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841424">for</span>&nbsp;<span class="ident" id="7841428">_</span><span class="op" id="7841429">,</span>&nbsp;<span class="ident" id="7841431">network</span>&nbsp;<span class="op" id="7841439">:=</span>&nbsp;<span class="keyword" id="7841442">range</span>&nbsp;<span class="op" id="7841448">[</span><span class="op" id="7841449">]</span><span class="builtintype" id="7841450">string</span><span class="op" id="7841456">{</span><span class="string" id="7841457">&#34;tcp&#34;</span><span class="op" id="7841462">,</span>&nbsp;<span class="string" id="7841464">&#34;tcp4&#34;</span><span class="op" id="7841470">,</span>&nbsp;<span class="string" id="7841472">&#34;tcp6&#34;</span><span class="op" id="7841478">}</span>&nbsp;<span class="op" id="7841480">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841484">addr</span><span class="op" id="7841488">,</span>&nbsp;<span class="ident" id="7841490">err</span>&nbsp;<span class="op" id="7841494">:=</span>&nbsp;<span class="ident" id="7841497"><a href="/net/tcpsock.go.html#1505235">ResolveTCPAddr</a></span><span class="op" id="7841511">(</span><span class="ident" id="7841512"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span><span class="op" id="7841519">,</span>&nbsp;<span class="string" id="7841521">&#34;www.google.com:http&#34;</span><span class="op" id="7841542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841546">if</span>&nbsp;<span class="ident" id="7841549"><a href="/net/dialgoogle_test.go.html#7841490">err</a></span>&nbsp;<span class="op" id="7841553">!=</span>&nbsp;<span class="ident" id="7841556">nil</span>&nbsp;<span class="op" id="7841560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841565">if</span>&nbsp;<span class="op" id="7841568">(</span><span class="ident" id="7841569"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span>&nbsp;<span class="op" id="7841577">==</span>&nbsp;<span class="string" id="7841580">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7841586">||</span>&nbsp;<span class="ident" id="7841589"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span>&nbsp;<span class="op" id="7841597">==</span>&nbsp;<span class="string" id="7841600">&#34;tcp4&#34;</span><span class="op" id="7841606">)</span>&nbsp;<span class="op" id="7841608">&amp;&amp;</span>&nbsp;<span class="op" id="7841611">!</span><span class="ident" id="7841612"><a href="/net/ipsock.go.html#1440518">supportsIPv4</a></span>&nbsp;<span class="op" id="7841625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841631"><a href="/net/dialgoogle_test.go.html#7841311">t</a></span><span class="op" id="7841632">.</span><span class="ident" id="7841633">Logf</span><span class="op" id="7841637">(</span><span class="string" id="7841638">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="7841665">,</span>&nbsp;<span class="ident" id="7841667"><a href="/net/dialgoogle_test.go.html#7841490">err</a></span><span class="op" id="7841670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841675">}</span>&nbsp;<span class="keyword" id="7841677">else</span>&nbsp;<span class="keyword" id="7841682">if</span>&nbsp;<span class="ident" id="7841685"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span>&nbsp;<span class="op" id="7841693">==</span>&nbsp;<span class="string" id="7841696">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7841703">&amp;&amp;</span>&nbsp;<span class="op" id="7841706">!</span><span class="ident" id="7841707"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7841720">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841726"><a href="/net/dialgoogle_test.go.html#7841311">t</a></span><span class="op" id="7841727">.</span><span class="ident" id="7841728">Logf</span><span class="op" id="7841732">(</span><span class="string" id="7841733">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="7841760">,</span>&nbsp;<span class="ident" id="7841762"><a href="/net/dialgoogle_test.go.html#7841490">err</a></span><span class="op" id="7841765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841770">}</span>&nbsp;<span class="keyword" id="7841772">else</span>&nbsp;<span class="op" id="7841777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841783"><a href="/net/dialgoogle_test.go.html#7841311">t</a></span><span class="op" id="7841784">.</span><span class="ident" id="7841785">Errorf</span><span class="op" id="7841791">(</span><span class="string" id="7841792">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7841819">,</span>&nbsp;<span class="ident" id="7841821"><a href="/net/dialgoogle_test.go.html#7841490">err</a></span><span class="op" id="7841824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841834">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7841849">if</span>&nbsp;<span class="op" id="7841852">(</span><span class="ident" id="7841853"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span>&nbsp;<span class="op" id="7841861">==</span>&nbsp;<span class="string" id="7841864">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7841870">||</span>&nbsp;<span class="ident" id="7841873"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span>&nbsp;<span class="op" id="7841881">==</span>&nbsp;<span class="string" id="7841884">&#34;tcp4&#34;</span><span class="op" id="7841890">)</span>&nbsp;<span class="op" id="7841892">&amp;&amp;</span>&nbsp;<span class="ident" id="7841895"><a href="/net/dialgoogle_test.go.html#7841484">addr</a></span><span class="op" id="7841899">.</span><span class="ident" id="7841900">IP</span><span class="op" id="7841902">.</span><span class="ident" id="7841903">To4</span><span class="op" id="7841906">(</span><span class="op" id="7841907">)</span>&nbsp;<span class="op" id="7841909">==</span>&nbsp;<span class="ident" id="7841912">nil</span>&nbsp;<span class="op" id="7841916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841921"><a href="/net/dialgoogle_test.go.html#7841311">t</a></span><span class="op" id="7841922">.</span><span class="ident" id="7841923">Errorf</span><span class="op" id="7841929">(</span><span class="string" id="7841930">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="7841970">,</span>&nbsp;<span class="ident" id="7841972"><a href="/net/dialgoogle_test.go.html#7841484">addr</a></span><span class="op" id="7841976">,</span>&nbsp;<span class="ident" id="7841978"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span><span class="op" id="7841985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7841989">}</span>&nbsp;<span class="keyword" id="7841991">else</span>&nbsp;<span class="keyword" id="7841996">if</span>&nbsp;<span class="ident" id="7841999"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span>&nbsp;<span class="op" id="7842007">==</span>&nbsp;<span class="string" id="7842010">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7842017">&amp;&amp;</span>&nbsp;<span class="op" id="7842020">(</span><span class="ident" id="7842021"><a href="/net/dialgoogle_test.go.html#7841484">addr</a></span><span class="op" id="7842025">.</span><span class="ident" id="7842026">IP</span><span class="op" id="7842028">.</span><span class="ident" id="7842029">To16</span><span class="op" id="7842033">(</span><span class="op" id="7842034">)</span>&nbsp;<span class="op" id="7842036">==</span>&nbsp;<span class="ident" id="7842039">nil</span>&nbsp;<span class="op" id="7842043">||</span>&nbsp;<span class="ident" id="7842046"><a href="/net/dialgoogle_test.go.html#7841484">addr</a></span><span class="op" id="7842050">.</span><span class="ident" id="7842051">IP</span><span class="op" id="7842053">.</span><span class="ident" id="7842054">To4</span><span class="op" id="7842057">(</span><span class="op" id="7842058">)</span>&nbsp;<span class="op" id="7842060">!=</span>&nbsp;<span class="ident" id="7842063">nil</span><span class="op" id="7842066">)</span>&nbsp;<span class="op" id="7842068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842073"><a href="/net/dialgoogle_test.go.html#7841311">t</a></span><span class="op" id="7842074">.</span><span class="ident" id="7842075">Errorf</span><span class="op" id="7842081">(</span><span class="string" id="7842082">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="7842122">,</span>&nbsp;<span class="ident" id="7842124"><a href="/net/dialgoogle_test.go.html#7841484">addr</a></span><span class="op" id="7842128">,</span>&nbsp;<span class="ident" id="7842130"><a href="/net/dialgoogle_test.go.html#7841431">network</a></span><span class="op" id="7842137">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842144">}</span><br>
<span class="lineno"></span><span class="op" id="7842146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7842149">func</span>&nbsp;<span class="ident" id="7842154">TestDialGoogle</span><span class="op" id="7842168">(</span><span class="ident" id="7842169">t</span>&nbsp;<span class="op" id="7842171">*</span><span class="ident" id="7842172"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7842179">.</span><span class="ident" id="7842180">T</span><span class="op" id="7842181">)</span>&nbsp;<span class="op" id="7842183">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842186">if</span>&nbsp;<span class="ident" id="7842189"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7842196">.</span><span class="ident" id="7842197">Short</span><span class="op" id="7842202">(</span><span class="op" id="7842203">)</span>&nbsp;<span class="op" id="7842205">||</span>&nbsp;<span class="op" id="7842208">!</span><span class="op" id="7842209">*</span><span class="ident" id="7842210"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="7842223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842227"><a href="/net/dialgoogle_test.go.html#7842169">t</a></span><span class="op" id="7842228">.</span><span class="ident" id="7842229">Skip</span><span class="op" id="7842233">(</span><span class="string" id="7842234">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7842275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842282">d</span>&nbsp;<span class="op" id="7842284">:=</span>&nbsp;<span class="op" id="7842287">&amp;</span><span class="ident" id="7842288"><a href="/net/dial.go.html#1330674">Dialer</a></span><span class="op" id="7842294">{</span><span class="ident" id="7842295">DualStack</span><span class="op" id="7842304">:</span>&nbsp;<span class="builtintype" id="7842306">true</span><span class="op" id="7842310">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842313">for</span>&nbsp;<span class="ident" id="7842317">_</span><span class="op" id="7842318">,</span>&nbsp;<span class="ident" id="7842320">network</span>&nbsp;<span class="op" id="7842328">:=</span>&nbsp;<span class="keyword" id="7842331">range</span>&nbsp;<span class="op" id="7842337">[</span><span class="op" id="7842338">]</span><span class="builtintype" id="7842339">string</span><span class="op" id="7842345">{</span><span class="string" id="7842346">&#34;tcp&#34;</span><span class="op" id="7842351">,</span>&nbsp;<span class="string" id="7842353">&#34;tcp4&#34;</span><span class="op" id="7842359">,</span>&nbsp;<span class="string" id="7842361">&#34;tcp6&#34;</span><span class="op" id="7842367">}</span>&nbsp;<span class="op" id="7842369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842373">if</span>&nbsp;<span class="ident" id="7842376"><a href="/net/dialgoogle_test.go.html#7842320">network</a></span>&nbsp;<span class="op" id="7842384">==</span>&nbsp;<span class="string" id="7842387">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7842393">&amp;&amp;</span>&nbsp;<span class="op" id="7842396">!</span><span class="ident" id="7842397"><a href="/net/ipsock.go.html#1440518">supportsIPv4</a></span>&nbsp;<span class="op" id="7842410">&amp;&amp;</span>&nbsp;<span class="op" id="7842413">!</span><span class="ident" id="7842414"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7842427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842432"><a href="/net/dialgoogle_test.go.html#7842169">t</a></span><span class="op" id="7842433">.</span><span class="ident" id="7842434">Logf</span><span class="op" id="7842438">(</span><span class="string" id="7842439">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7842492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842497">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842508">}</span>&nbsp;<span class="keyword" id="7842510">else</span>&nbsp;<span class="keyword" id="7842515">if</span>&nbsp;<span class="ident" id="7842518"><a href="/net/dialgoogle_test.go.html#7842320">network</a></span>&nbsp;<span class="op" id="7842526">==</span>&nbsp;<span class="string" id="7842529">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="7842536">&amp;&amp;</span>&nbsp;<span class="op" id="7842539">!</span><span class="ident" id="7842540"><a href="/net/ipsock.go.html#1440518">supportsIPv4</a></span>&nbsp;<span class="op" id="7842553">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842558"><a href="/net/dialgoogle_test.go.html#7842169">t</a></span><span class="op" id="7842559">.</span><span class="ident" id="7842560">Logf</span><span class="op" id="7842564">(</span><span class="string" id="7842565">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7842603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842608">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842619">}</span>&nbsp;<span class="keyword" id="7842621">else</span>&nbsp;<span class="keyword" id="7842626">if</span>&nbsp;<span class="ident" id="7842629"><a href="/net/dialgoogle_test.go.html#7842320">network</a></span>&nbsp;<span class="op" id="7842637">==</span>&nbsp;<span class="string" id="7842640">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7842647">&amp;&amp;</span>&nbsp;<span class="op" id="7842650">!</span><span class="ident" id="7842651"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7842664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842669"><a href="/net/dialgoogle_test.go.html#7842169">t</a></span><span class="op" id="7842670">.</span><span class="ident" id="7842671">Logf</span><span class="op" id="7842675">(</span><span class="string" id="7842676">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7842714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842719">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842730">}</span>&nbsp;<span class="keyword" id="7842732">else</span>&nbsp;<span class="keyword" id="7842737">if</span>&nbsp;<span class="ident" id="7842740"><a href="/net/dialgoogle_test.go.html#7842320">network</a></span>&nbsp;<span class="op" id="7842748">==</span>&nbsp;<span class="string" id="7842751">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7842758">&amp;&amp;</span>&nbsp;<span class="op" id="7842761">!</span><span class="op" id="7842762">*</span><span class="ident" id="7842763"><a href="/net/dialgoogle_test.go.html#7841218">testIPv6</a></span>&nbsp;<span class="op" id="7842772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842777"><a href="/net/dialgoogle_test.go.html#7842169">t</a></span><span class="op" id="7842778">.</span><span class="ident" id="7842779">Logf</span><span class="op" id="7842783">(</span><span class="string" id="7842784">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7842820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842825">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842840">if</span>&nbsp;<span class="ident" id="7842843">c</span><span class="op" id="7842844">,</span>&nbsp;<span class="ident" id="7842846">err</span>&nbsp;<span class="op" id="7842850">:=</span>&nbsp;<span class="ident" id="7842853"><a href="/net/dialgoogle_test.go.html#7842282">d</a></span><span class="op" id="7842854">.</span><span class="ident" id="7842855">Dial</span><span class="op" id="7842859">(</span><span class="ident" id="7842860"><a href="/net/dialgoogle_test.go.html#7842320">network</a></span><span class="op" id="7842867">,</span>&nbsp;<span class="string" id="7842869">&#34;www.google.com:http&#34;</span><span class="op" id="7842890">)</span><span class="op" id="7842891">;</span>&nbsp;<span class="ident" id="7842893"><a href="/net/dialgoogle_test.go.html#7842846">err</a></span>&nbsp;<span class="op" id="7842897">!=</span>&nbsp;<span class="ident" id="7842900">nil</span>&nbsp;<span class="op" id="7842904">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842909"><a href="/net/dialgoogle_test.go.html#7842169">t</a></span><span class="op" id="7842910">.</span><span class="ident" id="7842911">Errorf</span><span class="op" id="7842917">(</span><span class="string" id="7842918">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7842935">,</span>&nbsp;<span class="ident" id="7842937"><a href="/net/dialgoogle_test.go.html#7842846">err</a></span><span class="op" id="7842940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842944">}</span>&nbsp;<span class="keyword" id="7842946">else</span>&nbsp;<span class="op" id="7842951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842956"><a href="/net/dialgoogle_test.go.html#7842843">c</a></span><span class="op" id="7842957">.</span><span class="ident" id="7842958">Close</span><span class="op" id="7842963">(</span><span class="op" id="7842964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842971">}</span><br>
<span class="lineno">70</span><span class="op" id="7842973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7842976">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="7843032">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="7843086">func</span>&nbsp;<span class="ident" id="7843091">fetchGoogle</span><span class="op" id="7843102">(</span><span class="ident" id="7843103">t</span>&nbsp;<span class="op" id="7843105">*</span><span class="ident" id="7843106"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7843113">.</span><span class="ident" id="7843114">T</span><span class="op" id="7843115">,</span>&nbsp;<span class="ident" id="7843117">fd</span>&nbsp;<span class="ident" id="7843120"><a href="/net/net.go.html#1465335">Conn</a></span><span class="op" id="7843124">,</span>&nbsp;<span class="ident" id="7843126">network</span><span class="op" id="7843133">,</span>&nbsp;<span class="ident" id="7843135">addr</span>&nbsp;<span class="builtintype" id="7843140">string</span><span class="op" id="7843146">)</span>&nbsp;<span class="op" id="7843148">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843151">req</span>&nbsp;<span class="op" id="7843155">:=</span>&nbsp;<span class="op" id="7843158">[</span><span class="op" id="7843159">]</span><span class="builtintype" id="7843160">byte</span><span class="op" id="7843164">(</span><span class="string" id="7843165">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="7843223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843226">n</span><span class="op" id="7843227">,</span>&nbsp;<span class="ident" id="7843229">err</span>&nbsp;<span class="op" id="7843233">:=</span>&nbsp;<span class="ident" id="7843236"><a href="/net/dialgoogle_test.go.html#7843117">fd</a></span><span class="op" id="7843238">.</span><span class="ident" id="7843239">Write</span><span class="op" id="7843244">(</span><span class="ident" id="7843245"><a href="/net/dialgoogle_test.go.html#7843151">req</a></span><span class="op" id="7843248">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843252">buf</span>&nbsp;<span class="op" id="7843256">:=</span>&nbsp;<span class="builtinfunc" id="7843259">make</span><span class="op" id="7843263">(</span><span class="op" id="7843264">[</span><span class="op" id="7843265">]</span><span class="builtintype" id="7843266">byte</span><span class="op" id="7843270">,</span>&nbsp;<span class="num" id="7843272">1000</span><span class="op" id="7843276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843279"><a href="/net/dialgoogle_test.go.html#7843226">n</a></span><span class="op" id="7843280">,</span>&nbsp;<span class="ident" id="7843282"><a href="/net/dialgoogle_test.go.html#7843229">err</a></span>&nbsp;<span class="op" id="7843286">=</span>&nbsp;<span class="ident" id="7843288"><a href="/net/dialgoogle_test.go.html#7841100">io</a></span><span class="op" id="7843290">.</span><span class="ident" id="7843291">ReadFull</span><span class="op" id="7843299">(</span><span class="ident" id="7843300"><a href="/net/dialgoogle_test.go.html#7843117">fd</a></span><span class="op" id="7843302">,</span>&nbsp;<span class="ident" id="7843304"><a href="/net/dialgoogle_test.go.html#7843252">buf</a></span><span class="op" id="7843307">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843311">if</span>&nbsp;<span class="ident" id="7843314"><a href="/net/dialgoogle_test.go.html#7843226">n</a></span>&nbsp;<span class="op" id="7843316">&lt;</span>&nbsp;<span class="num" id="7843318">1000</span>&nbsp;<span class="op" id="7843323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843327"><a href="/net/dialgoogle_test.go.html#7843103">t</a></span><span class="op" id="7843328">.</span><span class="ident" id="7843329">Errorf</span><span class="op" id="7843335">(</span><span class="string" id="7843336">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="7843382">,</span>&nbsp;<span class="ident" id="7843384"><a href="/net/dialgoogle_test.go.html#7843126">network</a></span><span class="op" id="7843391">,</span>&nbsp;<span class="ident" id="7843393"><a href="/net/dialgoogle_test.go.html#7843135">addr</a></span><span class="op" id="7843397">,</span>&nbsp;<span class="ident" id="7843399"><a href="/net/dialgoogle_test.go.html#7843229">err</a></span><span class="op" id="7843402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843406">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843414">}</span><br>
<span class="lineno">85</span><span class="op" id="7843416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7843419">func</span>&nbsp;<span class="ident" id="7843424">doDial</span><span class="op" id="7843430">(</span><span class="ident" id="7843431">t</span>&nbsp;<span class="op" id="7843433">*</span><span class="ident" id="7843434"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7843441">.</span><span class="ident" id="7843442">T</span><span class="op" id="7843443">,</span>&nbsp;<span class="ident" id="7843445">network</span><span class="op" id="7843452">,</span>&nbsp;<span class="ident" id="7843454">addr</span>&nbsp;<span class="builtintype" id="7843459">string</span><span class="op" id="7843465">)</span>&nbsp;<span class="op" id="7843467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843470">fd</span><span class="op" id="7843472">,</span>&nbsp;<span class="ident" id="7843474">err</span>&nbsp;<span class="op" id="7843478">:=</span>&nbsp;<span class="ident" id="7843481"><a href="/net/dial.go.html#1334377">Dial</a></span><span class="op" id="7843485">(</span><span class="ident" id="7843486"><a href="/net/dialgoogle_test.go.html#7843445">network</a></span><span class="op" id="7843493">,</span>&nbsp;<span class="ident" id="7843495"><a href="/net/dialgoogle_test.go.html#7843454">addr</a></span><span class="op" id="7843499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843502">if</span>&nbsp;<span class="ident" id="7843505"><a href="/net/dialgoogle_test.go.html#7843474">err</a></span>&nbsp;<span class="op" id="7843509">!=</span>&nbsp;<span class="ident" id="7843512">nil</span>&nbsp;<span class="op" id="7843516">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843520"><a href="/net/dialgoogle_test.go.html#7843431">t</a></span><span class="op" id="7843521">.</span><span class="ident" id="7843522">Errorf</span><span class="op" id="7843528">(</span><span class="string" id="7843529">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7843555">,</span>&nbsp;<span class="ident" id="7843557"><a href="/net/dialgoogle_test.go.html#7843445">network</a></span><span class="op" id="7843564">,</span>&nbsp;<span class="string" id="7843566">&#34;&#34;</span><span class="op" id="7843568">,</span>&nbsp;<span class="ident" id="7843570"><a href="/net/dialgoogle_test.go.html#7843454">addr</a></span><span class="op" id="7843574">,</span>&nbsp;<span class="ident" id="7843576"><a href="/net/dialgoogle_test.go.html#7843474">err</a></span><span class="op" id="7843579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843583">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843594"><a href="/net/dialgoogle_test.go.html#7843091">fetchGoogle</a></span><span class="op" id="7843605">(</span><span class="ident" id="7843606"><a href="/net/dialgoogle_test.go.html#7843431">t</a></span><span class="op" id="7843607">,</span>&nbsp;<span class="ident" id="7843609"><a href="/net/dialgoogle_test.go.html#7843470">fd</a></span><span class="op" id="7843611">,</span>&nbsp;<span class="ident" id="7843613"><a href="/net/dialgoogle_test.go.html#7843445">network</a></span><span class="op" id="7843620">,</span>&nbsp;<span class="ident" id="7843622"><a href="/net/dialgoogle_test.go.html#7843454">addr</a></span><span class="op" id="7843626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843629"><a href="/net/dialgoogle_test.go.html#7843470">fd</a></span><span class="op" id="7843631">.</span><span class="ident" id="7843632">Close</span><span class="op" id="7843637">(</span><span class="op" id="7843638">)</span><br>
<span class="lineno">95</span><span class="op" id="7843640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7843643">var</span>&nbsp;<span class="ident" id="7843647">googleaddrsipv4</span>&nbsp;<span class="op" id="7843663">=</span>&nbsp;<span class="op" id="7843665">[</span><span class="op" id="7843666">]</span><span class="builtintype" id="7843667">string</span><span class="op" id="7843673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843676">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="7843692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843695">&#34;www.google.com:80&#34;</span><span class="op" id="7843714">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843717">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="7843735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843738">&#34;www.google.com:http&#34;</span><span class="op" id="7843759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843762">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="7843788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843791">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7843816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843819">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="7843850">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843853">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7843889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843892">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7843930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7843933">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7843965">,</span><br>
<span class="lineno"></span><span class="op" id="7843967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7843970">func</span>&nbsp;<span class="ident" id="7843975">TestDialGoogleIPv4</span><span class="op" id="7843993">(</span><span class="ident" id="7843994">t</span>&nbsp;<span class="op" id="7843996">*</span><span class="ident" id="7843997"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7844004">.</span><span class="ident" id="7844005">T</span><span class="op" id="7844006">)</span>&nbsp;<span class="op" id="7844008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844011">if</span>&nbsp;<span class="ident" id="7844014"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7844021">.</span><span class="ident" id="7844022">Short</span><span class="op" id="7844027">(</span><span class="op" id="7844028">)</span>&nbsp;<span class="op" id="7844030">||</span>&nbsp;<span class="op" id="7844033">!</span><span class="op" id="7844034">*</span><span class="ident" id="7844035"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="7844048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844052"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844053">.</span><span class="ident" id="7844054">Skip</span><span class="op" id="7844058">(</span><span class="string" id="7844059">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7844100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7844107">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7844156">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844176">addrs</span><span class="op" id="7844181">,</span>&nbsp;<span class="ident" id="7844183">err</span>&nbsp;<span class="op" id="7844187">:=</span>&nbsp;<span class="ident" id="7844190"><a href="/net/lookup.go.html#1454959">LookupIP</a></span><span class="op" id="7844198">(</span><span class="string" id="7844199">&#34;www.google.com&#34;</span><span class="op" id="7844215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844218">if</span>&nbsp;<span class="ident" id="7844221"><a href="/net/dialgoogle_test.go.html#7844183">err</a></span>&nbsp;<span class="op" id="7844225">!=</span>&nbsp;<span class="ident" id="7844228">nil</span>&nbsp;<span class="op" id="7844232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844236"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844237">.</span><span class="ident" id="7844238">Fatalf</span><span class="op" id="7844244">(</span><span class="string" id="7844245">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="7844272">,</span>&nbsp;<span class="ident" id="7844274"><a href="/net/dialgoogle_test.go.html#7844183">err</a></span><span class="op" id="7844277">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844283">var</span>&nbsp;<span class="ident" id="7844287">ip</span>&nbsp;<span class="ident" id="7844290"><a href="/net/ip.go.html#1417189">IP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844294">for</span>&nbsp;<span class="ident" id="7844298">_</span><span class="op" id="7844299">,</span>&nbsp;<span class="ident" id="7844301">addr</span>&nbsp;<span class="op" id="7844306">:=</span>&nbsp;<span class="keyword" id="7844309">range</span>&nbsp;<span class="ident" id="7844315"><a href="/net/dialgoogle_test.go.html#7844176">addrs</a></span>&nbsp;<span class="op" id="7844321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844325">if</span>&nbsp;<span class="ident" id="7844328">x</span>&nbsp;<span class="op" id="7844330">:=</span>&nbsp;<span class="ident" id="7844333"><a href="/net/dialgoogle_test.go.html#7844301">addr</a></span><span class="op" id="7844337">.</span><span class="ident" id="7844338">To4</span><span class="op" id="7844341">(</span><span class="op" id="7844342">)</span><span class="op" id="7844343">;</span>&nbsp;<span class="ident" id="7844345"><a href="/net/dialgoogle_test.go.html#7844328">x</a></span>&nbsp;<span class="op" id="7844347">!=</span>&nbsp;<span class="ident" id="7844350">nil</span>&nbsp;<span class="op" id="7844354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844359"><a href="/net/dialgoogle_test.go.html#7844287">ip</a></span>&nbsp;<span class="op" id="7844362">=</span>&nbsp;<span class="ident" id="7844364"><a href="/net/dialgoogle_test.go.html#7844328">x</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844369">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844383">if</span>&nbsp;<span class="ident" id="7844386"><a href="/net/dialgoogle_test.go.html#7844287">ip</a></span>&nbsp;<span class="op" id="7844389">==</span>&nbsp;<span class="ident" id="7844392">nil</span>&nbsp;<span class="op" id="7844396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844400"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844401">.</span><span class="ident" id="7844402">Fatalf</span><span class="op" id="7844408">(</span><span class="string" id="7844409">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="7844447">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844454">for</span>&nbsp;<span class="ident" id="7844458">i</span><span class="op" id="7844459">,</span>&nbsp;<span class="ident" id="7844461">s</span>&nbsp;<span class="op" id="7844463">:=</span>&nbsp;<span class="keyword" id="7844466">range</span>&nbsp;<span class="ident" id="7844472"><a href="/net/dialgoogle_test.go.html#7843647">googleaddrsipv4</a></span>&nbsp;<span class="op" id="7844488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844492">if</span>&nbsp;<span class="ident" id="7844495"><a href="/net/dialgoogle_test.go.html#7841106">strings</a></span><span class="op" id="7844502">.</span><span class="ident" id="7844503">Contains</span><span class="op" id="7844511">(</span><span class="ident" id="7844512"><a href="/net/dialgoogle_test.go.html#7844461">s</a></span><span class="op" id="7844513">,</span>&nbsp;<span class="string" id="7844515">&#34;%&#34;</span><span class="op" id="7844518">)</span>&nbsp;<span class="op" id="7844520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844525"><a href="/net/dialgoogle_test.go.html#7843647">googleaddrsipv4</a></span><span class="op" id="7844540">[</span><span class="ident" id="7844541"><a href="/net/dialgoogle_test.go.html#7844458">i</a></span><span class="op" id="7844542">]</span>&nbsp;<span class="op" id="7844544">=</span>&nbsp;<span class="ident" id="7844546"><a href="/net/dialgoogle_test.go.html#7841093">fmt</a></span><span class="op" id="7844549">.</span><span class="ident" id="7844550">Sprintf</span><span class="op" id="7844557">(</span><span class="ident" id="7844558"><a href="/net/dialgoogle_test.go.html#7844461">s</a></span><span class="op" id="7844559">,</span>&nbsp;<span class="ident" id="7844561"><a href="/net/dialgoogle_test.go.html#7844287">ip</a></span><span class="op" id="7844563">[</span><span class="num" id="7844564">0</span><span class="op" id="7844565">]</span><span class="op" id="7844566">,</span>&nbsp;<span class="ident" id="7844568"><a href="/net/dialgoogle_test.go.html#7844287">ip</a></span><span class="op" id="7844570">[</span><span class="num" id="7844571">1</span><span class="op" id="7844572">]</span><span class="op" id="7844573">,</span>&nbsp;<span class="ident" id="7844575"><a href="/net/dialgoogle_test.go.html#7844287">ip</a></span><span class="op" id="7844577">[</span><span class="num" id="7844578">2</span><span class="op" id="7844579">]</span><span class="op" id="7844580">,</span>&nbsp;<span class="ident" id="7844582"><a href="/net/dialgoogle_test.go.html#7844287">ip</a></span><span class="op" id="7844584">[</span><span class="num" id="7844585">3</span><span class="op" id="7844586">]</span><span class="op" id="7844587">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844598">for</span>&nbsp;<span class="ident" id="7844602">i</span>&nbsp;<span class="op" id="7844604">:=</span>&nbsp;<span class="num" id="7844607">0</span><span class="op" id="7844608">;</span>&nbsp;<span class="ident" id="7844610"><a href="/net/dialgoogle_test.go.html#7844602">i</a></span>&nbsp;<span class="op" id="7844612">&lt;</span>&nbsp;<span class="builtinfunc" id="7844614">len</span><span class="op" id="7844617">(</span><span class="ident" id="7844618"><a href="/net/dialgoogle_test.go.html#7843647">googleaddrsipv4</a></span><span class="op" id="7844633">)</span><span class="op" id="7844634">;</span>&nbsp;<span class="ident" id="7844636"><a href="/net/dialgoogle_test.go.html#7844602">i</a></span><span class="op" id="7844637">++</span>&nbsp;<span class="op" id="7844640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844644">addr</span>&nbsp;<span class="op" id="7844649">:=</span>&nbsp;<span class="ident" id="7844652"><a href="/net/dialgoogle_test.go.html#7843647">googleaddrsipv4</a></span><span class="op" id="7844667">[</span><span class="ident" id="7844668"><a href="/net/dialgoogle_test.go.html#7844602">i</a></span><span class="op" id="7844669">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844673">if</span>&nbsp;<span class="ident" id="7844676"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span>&nbsp;<span class="op" id="7844681">==</span>&nbsp;<span class="string" id="7844684">&#34;&#34;</span>&nbsp;<span class="op" id="7844687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844692">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844707"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844708">.</span><span class="ident" id="7844709">Logf</span><span class="op" id="7844713">(</span><span class="string" id="7844714">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="7844724">,</span>&nbsp;<span class="ident" id="7844726"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span><span class="op" id="7844730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844734"><a href="/net/dialgoogle_test.go.html#7843424">doDial</a></span><span class="op" id="7844740">(</span><span class="ident" id="7844741"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844742">,</span>&nbsp;<span class="string" id="7844744">&#34;tcp&#34;</span><span class="op" id="7844749">,</span>&nbsp;<span class="ident" id="7844751"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span><span class="op" id="7844755">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844759">if</span>&nbsp;<span class="ident" id="7844762"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span><span class="op" id="7844766">[</span><span class="num" id="7844767">0</span><span class="op" id="7844768">]</span>&nbsp;<span class="op" id="7844770">!=</span>&nbsp;<span class="string" id="7844773">&#39;[&#39;</span>&nbsp;<span class="op" id="7844777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844782"><a href="/net/dialgoogle_test.go.html#7843424">doDial</a></span><span class="op" id="7844788">(</span><span class="ident" id="7844789"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844790">,</span>&nbsp;<span class="string" id="7844792">&#34;tcp4&#34;</span><span class="op" id="7844798">,</span>&nbsp;<span class="ident" id="7844800"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span><span class="op" id="7844804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844809">if</span>&nbsp;<span class="ident" id="7844812"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7844825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7844831">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844886"><a href="/net/dialgoogle_test.go.html#7841117">syscall</a></span><span class="op" id="7844893">.</span><span class="ident" id="7844894">SocketDisableIPv6</span>&nbsp;<span class="op" id="7844912">=</span>&nbsp;<span class="builtintype" id="7844914">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844923"><a href="/net/dialgoogle_test.go.html#7843424">doDial</a></span><span class="op" id="7844929">(</span><span class="ident" id="7844930"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844931">,</span>&nbsp;<span class="string" id="7844933">&#34;tcp&#34;</span><span class="op" id="7844938">,</span>&nbsp;<span class="ident" id="7844940"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span><span class="op" id="7844944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844950"><a href="/net/dialgoogle_test.go.html#7843424">doDial</a></span><span class="op" id="7844956">(</span><span class="ident" id="7844957"><a href="/net/dialgoogle_test.go.html#7843994">t</a></span><span class="op" id="7844958">,</span>&nbsp;<span class="string" id="7844960">&#34;tcp4&#34;</span><span class="op" id="7844966">,</span>&nbsp;<span class="ident" id="7844968"><a href="/net/dialgoogle_test.go.html#7844644">addr</a></span><span class="op" id="7844972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844978"><a href="/net/dialgoogle_test.go.html#7841117">syscall</a></span><span class="op" id="7844985">.</span><span class="ident" id="7844986">SocketDisableIPv6</span>&nbsp;<span class="op" id="7845004">=</span>&nbsp;<span class="builtintype" id="7845006">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845019">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845022">}</span><br>
<span class="lineno"></span><span class="op" id="7845024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7845027">var</span>&nbsp;<span class="ident" id="7845031">googleaddrsipv6</span>&nbsp;<span class="op" id="7845047">=</span>&nbsp;<span class="op" id="7845049">[</span><span class="op" id="7845050">]</span><span class="builtintype" id="7845051">string</span><span class="op" id="7845057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7845060">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="7845138">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7845141">&#34;ipv6.google.com:80&#34;</span><span class="op" id="7845161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7845164">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="7845244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7845247">&#34;ipv6.google.com:http&#34;</span><span class="op" id="7845269">,</span><br>
<span class="lineno"></span><span class="op" id="7845271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="7845274">func</span>&nbsp;<span class="ident" id="7845279">TestDialGoogleIPv6</span><span class="op" id="7845297">(</span><span class="ident" id="7845298">t</span>&nbsp;<span class="op" id="7845300">*</span><span class="ident" id="7845301"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7845308">.</span><span class="ident" id="7845309">T</span><span class="op" id="7845310">)</span>&nbsp;<span class="op" id="7845312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845315">if</span>&nbsp;<span class="ident" id="7845318"><a href="/net/dialgoogle_test.go.html#7841128">testing</a></span><span class="op" id="7845325">.</span><span class="ident" id="7845326">Short</span><span class="op" id="7845331">(</span><span class="op" id="7845332">)</span>&nbsp;<span class="op" id="7845334">||</span>&nbsp;<span class="op" id="7845337">!</span><span class="op" id="7845338">*</span><span class="ident" id="7845339"><a href="/net/lookup_test.go.html#7913432">testExternal</a></span>&nbsp;<span class="op" id="7845352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845356"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7845357">.</span><span class="ident" id="7845358">Skip</span><span class="op" id="7845362">(</span><span class="string" id="7845363">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7845404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7845410">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845456">if</span>&nbsp;<span class="op" id="7845459">!</span><span class="ident" id="7845460"><a href="/net/ipsock.go.html#1440628">supportsIPv6</a></span>&nbsp;<span class="op" id="7845473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845477"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7845478">.</span><span class="ident" id="7845479">Skip</span><span class="op" id="7845483">(</span><span class="string" id="7845484">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7845522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845528">if</span>&nbsp;<span class="op" id="7845531">!</span><span class="op" id="7845532">*</span><span class="ident" id="7845533"><a href="/net/dialgoogle_test.go.html#7841218">testIPv6</a></span>&nbsp;<span class="op" id="7845542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845546"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7845547">.</span><span class="ident" id="7845548">Skip</span><span class="op" id="7845552">(</span><span class="string" id="7845553">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7845589">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7845596">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7845650">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845670">addrs</span><span class="op" id="7845675">,</span>&nbsp;<span class="ident" id="7845677">err</span>&nbsp;<span class="op" id="7845681">:=</span>&nbsp;<span class="ident" id="7845684"><a href="/net/lookup.go.html#1454959">LookupIP</a></span><span class="op" id="7845692">(</span><span class="string" id="7845693">&#34;ipv6.google.com&#34;</span><span class="op" id="7845710">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845713">if</span>&nbsp;<span class="ident" id="7845716"><a href="/net/dialgoogle_test.go.html#7845677">err</a></span>&nbsp;<span class="op" id="7845720">!=</span>&nbsp;<span class="ident" id="7845723">nil</span>&nbsp;<span class="op" id="7845727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845731"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7845732">.</span><span class="ident" id="7845733">Fatalf</span><span class="op" id="7845739">(</span><span class="string" id="7845740">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="7845768">,</span>&nbsp;<span class="ident" id="7845770"><a href="/net/dialgoogle_test.go.html#7845677">err</a></span><span class="op" id="7845773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845779">var</span>&nbsp;<span class="ident" id="7845783">ip</span>&nbsp;<span class="ident" id="7845786"><a href="/net/ip.go.html#1417189">IP</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845790">for</span>&nbsp;<span class="ident" id="7845794">_</span><span class="op" id="7845795">,</span>&nbsp;<span class="ident" id="7845797">addr</span>&nbsp;<span class="op" id="7845802">:=</span>&nbsp;<span class="keyword" id="7845805">range</span>&nbsp;<span class="ident" id="7845811"><a href="/net/dialgoogle_test.go.html#7845670">addrs</a></span>&nbsp;<span class="op" id="7845817">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845821">if</span>&nbsp;<span class="ident" id="7845824">x</span>&nbsp;<span class="op" id="7845826">:=</span>&nbsp;<span class="ident" id="7845829"><a href="/net/dialgoogle_test.go.html#7845797">addr</a></span><span class="op" id="7845833">.</span><span class="ident" id="7845834">To16</span><span class="op" id="7845838">(</span><span class="op" id="7845839">)</span><span class="op" id="7845840">;</span>&nbsp;<span class="ident" id="7845842"><a href="/net/dialgoogle_test.go.html#7845824">x</a></span>&nbsp;<span class="op" id="7845844">!=</span>&nbsp;<span class="ident" id="7845847">nil</span>&nbsp;<span class="op" id="7845851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845856"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span>&nbsp;<span class="op" id="7845859">=</span>&nbsp;<span class="ident" id="7845861"><a href="/net/dialgoogle_test.go.html#7845824">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845866">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845877">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845880">if</span>&nbsp;<span class="ident" id="7845883"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span>&nbsp;<span class="op" id="7845886">==</span>&nbsp;<span class="ident" id="7845889">nil</span>&nbsp;<span class="op" id="7845893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845897"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7845898">.</span><span class="ident" id="7845899">Fatalf</span><span class="op" id="7845905">(</span><span class="string" id="7845906">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="7845945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845952">for</span>&nbsp;<span class="ident" id="7845956">i</span><span class="op" id="7845957">,</span>&nbsp;<span class="ident" id="7845959">s</span>&nbsp;<span class="op" id="7845961">:=</span>&nbsp;<span class="keyword" id="7845964">range</span>&nbsp;<span class="ident" id="7845970"><a href="/net/dialgoogle_test.go.html#7845031">googleaddrsipv6</a></span>&nbsp;<span class="op" id="7845986">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845990">if</span>&nbsp;<span class="ident" id="7845993"><a href="/net/dialgoogle_test.go.html#7841106">strings</a></span><span class="op" id="7846000">.</span><span class="ident" id="7846001">Contains</span><span class="op" id="7846009">(</span><span class="ident" id="7846010"><a href="/net/dialgoogle_test.go.html#7845959">s</a></span><span class="op" id="7846011">,</span>&nbsp;<span class="string" id="7846013">&#34;%&#34;</span><span class="op" id="7846016">)</span>&nbsp;<span class="op" id="7846018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846023"><a href="/net/dialgoogle_test.go.html#7845031">googleaddrsipv6</a></span><span class="op" id="7846038">[</span><span class="ident" id="7846039"><a href="/net/dialgoogle_test.go.html#7845956">i</a></span><span class="op" id="7846040">]</span>&nbsp;<span class="op" id="7846042">=</span>&nbsp;<span class="ident" id="7846044"><a href="/net/dialgoogle_test.go.html#7841093">fmt</a></span><span class="op" id="7846047">.</span><span class="ident" id="7846048">Sprintf</span><span class="op" id="7846055">(</span><span class="ident" id="7846056"><a href="/net/dialgoogle_test.go.html#7845959">s</a></span><span class="op" id="7846057">,</span>&nbsp;<span class="ident" id="7846059"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846061">[</span><span class="num" id="7846062">0</span><span class="op" id="7846063">]</span><span class="op" id="7846064">,</span>&nbsp;<span class="ident" id="7846066"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846068">[</span><span class="num" id="7846069">1</span><span class="op" id="7846070">]</span><span class="op" id="7846071">,</span>&nbsp;<span class="ident" id="7846073"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846075">[</span><span class="num" id="7846076">2</span><span class="op" id="7846077">]</span><span class="op" id="7846078">,</span>&nbsp;<span class="ident" id="7846080"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846082">[</span><span class="num" id="7846083">3</span><span class="op" id="7846084">]</span><span class="op" id="7846085">,</span>&nbsp;<span class="ident" id="7846087"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846089">[</span><span class="num" id="7846090">4</span><span class="op" id="7846091">]</span><span class="op" id="7846092">,</span>&nbsp;<span class="ident" id="7846094"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846096">[</span><span class="num" id="7846097">5</span><span class="op" id="7846098">]</span><span class="op" id="7846099">,</span>&nbsp;<span class="ident" id="7846101"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846103">[</span><span class="num" id="7846104">6</span><span class="op" id="7846105">]</span><span class="op" id="7846106">,</span>&nbsp;<span class="ident" id="7846108"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846110">[</span><span class="num" id="7846111">7</span><span class="op" id="7846112">]</span><span class="op" id="7846113">,</span>&nbsp;<span class="ident" id="7846115"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846117">[</span><span class="num" id="7846118">8</span><span class="op" id="7846119">]</span><span class="op" id="7846120">,</span>&nbsp;<span class="ident" id="7846122"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846124">[</span><span class="num" id="7846125">9</span><span class="op" id="7846126">]</span><span class="op" id="7846127">,</span>&nbsp;<span class="ident" id="7846129"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846131">[</span><span class="num" id="7846132">10</span><span class="op" id="7846134">]</span><span class="op" id="7846135">,</span>&nbsp;<span class="ident" id="7846137"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846139">[</span><span class="num" id="7846140">11</span><span class="op" id="7846142">]</span><span class="op" id="7846143">,</span>&nbsp;<span class="ident" id="7846145"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846147">[</span><span class="num" id="7846148">12</span><span class="op" id="7846150">]</span><span class="op" id="7846151">,</span>&nbsp;<span class="ident" id="7846153"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846155">[</span><span class="num" id="7846156">13</span><span class="op" id="7846158">]</span><span class="op" id="7846159">,</span>&nbsp;<span class="ident" id="7846161"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846163">[</span><span class="num" id="7846164">14</span><span class="op" id="7846166">]</span><span class="op" id="7846167">,</span>&nbsp;<span class="ident" id="7846169"><a href="/net/dialgoogle_test.go.html#7845783">ip</a></span><span class="op" id="7846171">[</span><span class="num" id="7846172">15</span><span class="op" id="7846174">]</span><span class="op" id="7846175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7846186">for</span>&nbsp;<span class="ident" id="7846190">i</span>&nbsp;<span class="op" id="7846192">:=</span>&nbsp;<span class="num" id="7846195">0</span><span class="op" id="7846196">;</span>&nbsp;<span class="ident" id="7846198"><a href="/net/dialgoogle_test.go.html#7846190">i</a></span>&nbsp;<span class="op" id="7846200">&lt;</span>&nbsp;<span class="builtinfunc" id="7846202">len</span><span class="op" id="7846205">(</span><span class="ident" id="7846206"><a href="/net/dialgoogle_test.go.html#7845031">googleaddrsipv6</a></span><span class="op" id="7846221">)</span><span class="op" id="7846222">;</span>&nbsp;<span class="ident" id="7846224"><a href="/net/dialgoogle_test.go.html#7846190">i</a></span><span class="op" id="7846225">++</span>&nbsp;<span class="op" id="7846228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846232">addr</span>&nbsp;<span class="op" id="7846237">:=</span>&nbsp;<span class="ident" id="7846240"><a href="/net/dialgoogle_test.go.html#7845031">googleaddrsipv6</a></span><span class="op" id="7846255">[</span><span class="ident" id="7846256"><a href="/net/dialgoogle_test.go.html#7846190">i</a></span><span class="op" id="7846257">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7846261">if</span>&nbsp;<span class="ident" id="7846264"><a href="/net/dialgoogle_test.go.html#7846232">addr</a></span>&nbsp;<span class="op" id="7846269">==</span>&nbsp;<span class="string" id="7846272">&#34;&#34;</span>&nbsp;<span class="op" id="7846275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7846280">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846291">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846295"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7846296">.</span><span class="ident" id="7846297">Logf</span><span class="op" id="7846301">(</span><span class="string" id="7846302">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="7846312">,</span>&nbsp;<span class="ident" id="7846314"><a href="/net/dialgoogle_test.go.html#7846232">addr</a></span><span class="op" id="7846318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846322"><a href="/net/dialgoogle_test.go.html#7843424">doDial</a></span><span class="op" id="7846328">(</span><span class="ident" id="7846329"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7846330">,</span>&nbsp;<span class="string" id="7846332">&#34;tcp&#34;</span><span class="op" id="7846337">,</span>&nbsp;<span class="ident" id="7846339"><a href="/net/dialgoogle_test.go.html#7846232">addr</a></span><span class="op" id="7846343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846347"><a href="/net/dialgoogle_test.go.html#7843424">doDial</a></span><span class="op" id="7846353">(</span><span class="ident" id="7846354"><a href="/net/dialgoogle_test.go.html#7845298">t</a></span><span class="op" id="7846355">,</span>&nbsp;<span class="string" id="7846357">&#34;tcp6&#34;</span><span class="op" id="7846363">,</span>&nbsp;<span class="ident" id="7846365"><a href="/net/dialgoogle_test.go.html#7846232">addr</a></span><span class="op" id="7846369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846372">}</span><br>
<span class="lineno"></span><span class="op" id="7846374">}</span>
</div>
</body>
</html>
