<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3961627">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3961682">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3961736">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3961787">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3961857">package</span>&nbsp;<span class="ident" id="3961865">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3961871">import</span>&nbsp;<span class="op" id="3961878">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3961881">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3961890">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3961896">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3961906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3961909">var</span>&nbsp;<span class="ident" id="3961913">typeFiles</span>&nbsp;<span class="op" id="3961923">=</span>&nbsp;<span class="op" id="3961925">[</span><span class="op" id="3961926">]</span><span class="builtintype" id="3961927">string</span><span class="op" id="3961933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3961936">&#34;/etc/mime.types&#34;</span><span class="op" id="3961953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3961956">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3961981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3961984">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3962008">,</span><br>
<span class="lineno"></span><span class="op" id="3962010">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3962013">func</span>&nbsp;<span class="ident" id="3962018">loadMimeFile</span><span class="op" id="3962030">(</span><span class="ident" id="3962031">filename</span>&nbsp;<span class="builtintype" id="3962040">string</span><span class="op" id="3962046">)</span>&nbsp;<span class="op" id="3962048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962051">f</span><span class="op" id="3962052">,</span>&nbsp;<span class="ident" id="3962054">err</span>&nbsp;<span class="op" id="3962058">:=</span>&nbsp;<span class="ident" id="3962061"><a href="/mime/type_unix.go.html#3961890">os</a></span><span class="op" id="3962063">.</span><span class="ident" id="3962064">Open</span><span class="op" id="3962068">(</span><span class="ident" id="3962069"><a href="/mime/type_unix.go.html#3962031">filename</a></span><span class="op" id="3962077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962080">if</span>&nbsp;<span class="ident" id="3962083"><a href="/mime/type_unix.go.html#3962054">err</a></span>&nbsp;<span class="op" id="3962087">!=</span>&nbsp;<span class="ident" id="3962090">nil</span>&nbsp;<span class="op" id="3962094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962098">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962109">defer</span>&nbsp;<span class="ident" id="3962115"><a href="/mime/type_unix.go.html#3962051">f</a></span><span class="op" id="3962116">.</span><span class="ident" id="3962117">Close</span><span class="op" id="3962122">(</span><span class="op" id="3962123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962127">scanner</span>&nbsp;<span class="op" id="3962135">:=</span>&nbsp;<span class="ident" id="3962138"><a href="/mime/type_unix.go.html#3961881">bufio</a></span><span class="op" id="3962143">.</span><span class="ident" id="3962144">NewScanner</span><span class="op" id="3962154">(</span><span class="ident" id="3962155"><a href="/mime/type_unix.go.html#3962051">f</a></span><span class="op" id="3962156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962159">for</span>&nbsp;<span class="ident" id="3962163"><a href="/mime/type_unix.go.html#3962127">scanner</a></span><span class="op" id="3962170">.</span><span class="ident" id="3962171">Scan</span><span class="op" id="3962175">(</span><span class="op" id="3962176">)</span>&nbsp;<span class="op" id="3962178">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962182">fields</span>&nbsp;<span class="op" id="3962189">:=</span>&nbsp;<span class="ident" id="3962192"><a href="/mime/type_unix.go.html#3961896">strings</a></span><span class="op" id="3962199">.</span><span class="ident" id="3962200">Fields</span><span class="op" id="3962206">(</span><span class="ident" id="3962207"><a href="/mime/type_unix.go.html#3962127">scanner</a></span><span class="op" id="3962214">.</span><span class="ident" id="3962215">Text</span><span class="op" id="3962219">(</span><span class="op" id="3962220">)</span><span class="op" id="3962221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962225">if</span>&nbsp;<span class="builtinfunc" id="3962228">len</span><span class="op" id="3962231">(</span><span class="ident" id="3962232"><a href="/mime/type_unix.go.html#3962182">fields</a></span><span class="op" id="3962238">)</span>&nbsp;<span class="op" id="3962240">&lt;=</span>&nbsp;<span class="num" id="3962243">1</span>&nbsp;<span class="op" id="3962245">||</span>&nbsp;<span class="ident" id="3962248"><a href="/mime/type_unix.go.html#3962182">fields</a></span><span class="op" id="3962254">[</span><span class="num" id="3962255">0</span><span class="op" id="3962256">]</span><span class="op" id="3962257">[</span><span class="num" id="3962258">0</span><span class="op" id="3962259">]</span>&nbsp;<span class="op" id="3962261">==</span>&nbsp;<span class="string" id="3962264">&#39;#&#39;</span>&nbsp;<span class="op" id="3962268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962273">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962288">mimeType</span>&nbsp;<span class="op" id="3962297">:=</span>&nbsp;<span class="ident" id="3962300"><a href="/mime/type_unix.go.html#3962182">fields</a></span><span class="op" id="3962306">[</span><span class="num" id="3962307">0</span><span class="op" id="3962308">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962312">for</span>&nbsp;<span class="ident" id="3962316">_</span><span class="op" id="3962317">,</span>&nbsp;<span class="ident" id="3962319">ext</span>&nbsp;<span class="op" id="3962323">:=</span>&nbsp;<span class="keyword" id="3962326">range</span>&nbsp;<span class="ident" id="3962332"><a href="/mime/type_unix.go.html#3962182">fields</a></span><span class="op" id="3962338">[</span><span class="num" id="3962339">1</span><span class="op" id="3962340">:</span><span class="op" id="3962341">]</span>&nbsp;<span class="op" id="3962343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962348">if</span>&nbsp;<span class="ident" id="3962351"><a href="/mime/type_unix.go.html#3962319">ext</a></span><span class="op" id="3962354">[</span><span class="num" id="3962355">0</span><span class="op" id="3962356">]</span>&nbsp;<span class="op" id="3962358">==</span>&nbsp;<span class="string" id="3962361">&#39;#&#39;</span>&nbsp;<span class="op" id="3962365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962371">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962385"><a href="/mime/type.go.html#3961189">setExtensionType</a></span><span class="op" id="3962401">(</span><span class="string" id="3962402">&#34;.&#34;</span><span class="op" id="3962405">+</span><span class="ident" id="3962406"><a href="/mime/type_unix.go.html#3962319">ext</a></span><span class="op" id="3962409">,</span>&nbsp;<span class="ident" id="3962411"><a href="/mime/type_unix.go.html#3962288">mimeType</a></span><span class="op" id="3962419">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962429">if</span>&nbsp;<span class="ident" id="3962432">err</span>&nbsp;<span class="op" id="3962436">:=</span>&nbsp;<span class="ident" id="3962439"><a href="/mime/type_unix.go.html#3962127">scanner</a></span><span class="op" id="3962446">.</span><span class="ident" id="3962447">Err</span><span class="op" id="3962450">(</span><span class="op" id="3962451">)</span><span class="op" id="3962452">;</span>&nbsp;<span class="ident" id="3962454"><a href="/mime/type_unix.go.html#3962432">err</a></span>&nbsp;<span class="op" id="3962458">!=</span>&nbsp;<span class="ident" id="3962461">nil</span>&nbsp;<span class="op" id="3962465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3962469">panic</span><span class="op" id="3962474">(</span><span class="ident" id="3962475"><a href="/mime/type_unix.go.html#3962432">err</a></span><span class="op" id="3962478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962481">}</span><br>
<span class="lineno">45</span><span class="op" id="3962483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3962486">func</span>&nbsp;<span class="ident" id="3962491">initMime</span><span class="op" id="3962499">(</span><span class="op" id="3962500">)</span>&nbsp;<span class="op" id="3962502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962505">for</span>&nbsp;<span class="ident" id="3962509">_</span><span class="op" id="3962510">,</span>&nbsp;<span class="ident" id="3962512">filename</span>&nbsp;<span class="op" id="3962521">:=</span>&nbsp;<span class="keyword" id="3962524">range</span>&nbsp;<span class="ident" id="3962530"><a href="/mime/type_unix.go.html#3961913">typeFiles</a></span>&nbsp;<span class="op" id="3962540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962544"><a href="/mime/type_unix.go.html#3962018">loadMimeFile</a></span><span class="op" id="3962556">(</span><span class="ident" id="3962557"><a href="/mime/type_unix.go.html#3962512">filename</a></span><span class="op" id="3962565">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962568">}</span><br>
<span class="lineno"></span><span class="op" id="3962570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3962573">func</span>&nbsp;<span class="ident" id="3962578">initMimeForTests</span><span class="op" id="3962594">(</span><span class="op" id="3962595">)</span>&nbsp;<span class="keyword" id="3962597">map</span><span class="op" id="3962600">[</span><span class="builtintype" id="3962601">string</span><span class="op" id="3962607">]</span><span class="builtintype" id="3962608">string</span>&nbsp;<span class="op" id="3962615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3962618"><a href="/mime/type_unix.go.html#3961913">typeFiles</a></span>&nbsp;<span class="op" id="3962628">=</span>&nbsp;<span class="op" id="3962630">[</span><span class="op" id="3962631">]</span><span class="builtintype" id="3962632">string</span><span class="op" id="3962638">{</span><span class="string" id="3962639">&#34;testdata/test.types&#34;</span><span class="op" id="3962660">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3962663">return</span>&nbsp;<span class="keyword" id="3962670">map</span><span class="op" id="3962673">[</span><span class="builtintype" id="3962674">string</span><span class="op" id="3962680">]</span><span class="builtintype" id="3962681">string</span><span class="op" id="3962687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3962691">&#34;.T1&#34;</span><span class="op" id="3962696">:</span>&nbsp;&nbsp;<span class="string" id="3962699">&#34;application/test&#34;</span><span class="op" id="3962717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3962721">&#34;.t2&#34;</span><span class="op" id="3962726">:</span>&nbsp;&nbsp;<span class="string" id="3962729">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3962755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3962759">&#34;.png&#34;</span><span class="op" id="3962765">:</span>&nbsp;<span class="string" id="3962767">&#34;image/png&#34;</span><span class="op" id="3962778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3962781">}</span><br>
<span class="lineno">60</span><span class="op" id="3962783">}</span>
</div>
</body>
</html>
