<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4080143">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4080198">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4080252">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4080303">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4080381">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4080399">package</span>&nbsp;<span class="ident" id="4080407">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080415">import</span>&nbsp;<span class="op" id="4080422">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4080425">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4080435">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4080442">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080445">func</span>&nbsp;<span class="ident" id="4080450">init</span><span class="op" id="4080454">(</span><span class="op" id="4080455">)</span>&nbsp;<span class="op" id="4080457">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080460">crypto</span><span class="op" id="4080466">.</span><span class="ident" id="4080467">RegisterHash</span><span class="op" id="4080479">(</span><span class="ident" id="4080480">crypto</span><span class="op" id="4080486">.</span><span class="ident" id="4080487">SHA384</span><span class="op" id="4080493">,</span>&nbsp;<span class="ident" id="4080495">New384</span><span class="op" id="4080501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080504">crypto</span><span class="op" id="4080510">.</span><span class="ident" id="4080511">RegisterHash</span><span class="op" id="4080523">(</span><span class="ident" id="4080524">crypto</span><span class="op" id="4080530">.</span><span class="ident" id="4080531">SHA512</span><span class="op" id="4080537">,</span>&nbsp;<span class="ident" id="4080539">New</span><span class="op" id="4080542">)</span><br>
<span class="lineno"></span><span class="op" id="4080544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4080547">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4080590">const</span>&nbsp;<span class="ident" id="4080596">Size</span>&nbsp;<span class="op" id="4080601">=</span>&nbsp;<span class="num" id="4080603">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4080607">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4080650">const</span>&nbsp;<span class="ident" id="4080656">Size384</span>&nbsp;<span class="op" id="4080664">=</span>&nbsp;<span class="num" id="4080666">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4080670">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4080718">const</span>&nbsp;<span class="ident" id="4080724">BlockSize</span>&nbsp;<span class="op" id="4080734">=</span>&nbsp;<span class="num" id="4080736">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080741">const</span>&nbsp;<span class="op" id="4080747">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080750">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080760">=</span>&nbsp;<span class="num" id="4080762">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080767">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080777">=</span>&nbsp;<span class="num" id="4080779">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080799">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080809">=</span>&nbsp;<span class="num" id="4080811">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080831">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080841">=</span>&nbsp;<span class="num" id="4080843">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080863">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080873">=</span>&nbsp;<span class="num" id="4080875">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080895">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080905">=</span>&nbsp;<span class="num" id="4080907">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080927">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080937">=</span>&nbsp;<span class="num" id="4080939">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080959">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4080969">=</span>&nbsp;<span class="num" id="4080971">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080991">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4081001">=</span>&nbsp;<span class="num" id="4081003">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081023">init0_384</span>&nbsp;<span class="op" id="4081033">=</span>&nbsp;<span class="num" id="4081035">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081055">init1_384</span>&nbsp;<span class="op" id="4081065">=</span>&nbsp;<span class="num" id="4081067">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081087">init2_384</span>&nbsp;<span class="op" id="4081097">=</span>&nbsp;<span class="num" id="4081099">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081119">init3_384</span>&nbsp;<span class="op" id="4081129">=</span>&nbsp;<span class="num" id="4081131">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081151">init4_384</span>&nbsp;<span class="op" id="4081161">=</span>&nbsp;<span class="num" id="4081163">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081183">init5_384</span>&nbsp;<span class="op" id="4081193">=</span>&nbsp;<span class="num" id="4081195">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081215">init6_384</span>&nbsp;<span class="op" id="4081225">=</span>&nbsp;<span class="num" id="4081227">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081247">init7_384</span>&nbsp;<span class="op" id="4081257">=</span>&nbsp;<span class="num" id="4081259">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4081278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081281">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4081340">type</span>&nbsp;<span class="ident" id="4081345">digest</span>&nbsp;<span class="keyword" id="4081352">struct</span>&nbsp;<span class="op" id="4081359">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081362">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4081368">[</span><span class="num" id="4081369">8</span><span class="op" id="4081370">]</span><span class="ident" id="4081371">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081379">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4081385">[</span><span class="ident" id="4081386">chunk</span><span class="op" id="4081391">]</span><span class="builtintype" id="4081392">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081398">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4081404">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4081409">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4081415">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081423">is384</span>&nbsp;<span class="builtintype" id="4081429">bool</span>&nbsp;<span class="comment" id="4081434">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4081468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4081471">func</span>&nbsp;<span class="op" id="4081476">(</span><span class="ident" id="4081477">d</span>&nbsp;<span class="op" id="4081479">*</span><span class="ident" id="4081480">digest</span><span class="op" id="4081486">)</span>&nbsp;<span class="ident" id="4081488">Reset</span><span class="op" id="4081493">(</span><span class="op" id="4081494">)</span>&nbsp;<span class="op" id="4081496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081499">if</span>&nbsp;<span class="op" id="4081502">!</span><span class="ident" id="4081503">d</span><span class="op" id="4081504">.</span><span class="ident" id="4081505">is384</span>&nbsp;<span class="op" id="4081511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081515">d</span><span class="op" id="4081516">.</span><span class="ident" id="4081517">h</span><span class="op" id="4081518">[</span><span class="num" id="4081519">0</span><span class="op" id="4081520">]</span>&nbsp;<span class="op" id="4081522">=</span>&nbsp;<span class="ident" id="4081524">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081532">d</span><span class="op" id="4081533">.</span><span class="ident" id="4081534">h</span><span class="op" id="4081535">[</span><span class="num" id="4081536">1</span><span class="op" id="4081537">]</span>&nbsp;<span class="op" id="4081539">=</span>&nbsp;<span class="ident" id="4081541">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081549">d</span><span class="op" id="4081550">.</span><span class="ident" id="4081551">h</span><span class="op" id="4081552">[</span><span class="num" id="4081553">2</span><span class="op" id="4081554">]</span>&nbsp;<span class="op" id="4081556">=</span>&nbsp;<span class="ident" id="4081558">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081566">d</span><span class="op" id="4081567">.</span><span class="ident" id="4081568">h</span><span class="op" id="4081569">[</span><span class="num" id="4081570">3</span><span class="op" id="4081571">]</span>&nbsp;<span class="op" id="4081573">=</span>&nbsp;<span class="ident" id="4081575">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081583">d</span><span class="op" id="4081584">.</span><span class="ident" id="4081585">h</span><span class="op" id="4081586">[</span><span class="num" id="4081587">4</span><span class="op" id="4081588">]</span>&nbsp;<span class="op" id="4081590">=</span>&nbsp;<span class="ident" id="4081592">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081600">d</span><span class="op" id="4081601">.</span><span class="ident" id="4081602">h</span><span class="op" id="4081603">[</span><span class="num" id="4081604">5</span><span class="op" id="4081605">]</span>&nbsp;<span class="op" id="4081607">=</span>&nbsp;<span class="ident" id="4081609">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081617">d</span><span class="op" id="4081618">.</span><span class="ident" id="4081619">h</span><span class="op" id="4081620">[</span><span class="num" id="4081621">6</span><span class="op" id="4081622">]</span>&nbsp;<span class="op" id="4081624">=</span>&nbsp;<span class="ident" id="4081626">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081634">d</span><span class="op" id="4081635">.</span><span class="ident" id="4081636">h</span><span class="op" id="4081637">[</span><span class="num" id="4081638">7</span><span class="op" id="4081639">]</span>&nbsp;<span class="op" id="4081641">=</span>&nbsp;<span class="ident" id="4081643">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081650">}</span>&nbsp;<span class="keyword" id="4081652">else</span>&nbsp;<span class="op" id="4081657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081661">d</span><span class="op" id="4081662">.</span><span class="ident" id="4081663">h</span><span class="op" id="4081664">[</span><span class="num" id="4081665">0</span><span class="op" id="4081666">]</span>&nbsp;<span class="op" id="4081668">=</span>&nbsp;<span class="ident" id="4081670">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081682">d</span><span class="op" id="4081683">.</span><span class="ident" id="4081684">h</span><span class="op" id="4081685">[</span><span class="num" id="4081686">1</span><span class="op" id="4081687">]</span>&nbsp;<span class="op" id="4081689">=</span>&nbsp;<span class="ident" id="4081691">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081703">d</span><span class="op" id="4081704">.</span><span class="ident" id="4081705">h</span><span class="op" id="4081706">[</span><span class="num" id="4081707">2</span><span class="op" id="4081708">]</span>&nbsp;<span class="op" id="4081710">=</span>&nbsp;<span class="ident" id="4081712">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081724">d</span><span class="op" id="4081725">.</span><span class="ident" id="4081726">h</span><span class="op" id="4081727">[</span><span class="num" id="4081728">3</span><span class="op" id="4081729">]</span>&nbsp;<span class="op" id="4081731">=</span>&nbsp;<span class="ident" id="4081733">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081745">d</span><span class="op" id="4081746">.</span><span class="ident" id="4081747">h</span><span class="op" id="4081748">[</span><span class="num" id="4081749">4</span><span class="op" id="4081750">]</span>&nbsp;<span class="op" id="4081752">=</span>&nbsp;<span class="ident" id="4081754">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081766">d</span><span class="op" id="4081767">.</span><span class="ident" id="4081768">h</span><span class="op" id="4081769">[</span><span class="num" id="4081770">5</span><span class="op" id="4081771">]</span>&nbsp;<span class="op" id="4081773">=</span>&nbsp;<span class="ident" id="4081775">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081787">d</span><span class="op" id="4081788">.</span><span class="ident" id="4081789">h</span><span class="op" id="4081790">[</span><span class="num" id="4081791">6</span><span class="op" id="4081792">]</span>&nbsp;<span class="op" id="4081794">=</span>&nbsp;<span class="ident" id="4081796">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081808">d</span><span class="op" id="4081809">.</span><span class="ident" id="4081810">h</span><span class="op" id="4081811">[</span><span class="num" id="4081812">7</span><span class="op" id="4081813">]</span>&nbsp;<span class="op" id="4081815">=</span>&nbsp;<span class="ident" id="4081817">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081831">d</span><span class="op" id="4081832">.</span><span class="ident" id="4081833">nx</span>&nbsp;<span class="op" id="4081836">=</span>&nbsp;<span class="num" id="4081838">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081841">d</span><span class="op" id="4081842">.</span><span class="builtinfunc" id="4081843">len</span>&nbsp;<span class="op" id="4081847">=</span>&nbsp;<span class="num" id="4081849">0</span><br>
<span class="lineno"></span><span class="op" id="4081851">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4081854">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4081916">func</span>&nbsp;<span class="ident" id="4081921">New</span><span class="op" id="4081924">(</span><span class="op" id="4081925">)</span>&nbsp;<span class="ident" id="4081927">hash</span><span class="op" id="4081931">.</span><span class="ident" id="4081932">Hash</span>&nbsp;<span class="op" id="4081937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081940">d</span>&nbsp;<span class="op" id="4081942">:=</span>&nbsp;<span class="builtinfunc" id="4081945">new</span><span class="op" id="4081948">(</span><span class="ident" id="4081949">digest</span><span class="op" id="4081955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081958">d</span><span class="op" id="4081959">.</span><span class="ident" id="4081960">Reset</span><span class="op" id="4081965">(</span><span class="op" id="4081966">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081969">return</span>&nbsp;<span class="ident" id="4081976">d</span><br>
<span class="lineno"></span><span class="op" id="4081978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081981">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4082046">func</span>&nbsp;<span class="ident" id="4082051">New384</span><span class="op" id="4082057">(</span><span class="op" id="4082058">)</span>&nbsp;<span class="ident" id="4082060">hash</span><span class="op" id="4082064">.</span><span class="ident" id="4082065">Hash</span>&nbsp;<span class="op" id="4082070">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082073">d</span>&nbsp;<span class="op" id="4082075">:=</span>&nbsp;<span class="builtinfunc" id="4082078">new</span><span class="op" id="4082081">(</span><span class="ident" id="4082082">digest</span><span class="op" id="4082088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082091">d</span><span class="op" id="4082092">.</span><span class="ident" id="4082093">is384</span>&nbsp;<span class="op" id="4082099">=</span>&nbsp;<span class="builtintype" id="4082101">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082107">d</span><span class="op" id="4082108">.</span><span class="ident" id="4082109">Reset</span><span class="op" id="4082114">(</span><span class="op" id="4082115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082118">return</span>&nbsp;<span class="ident" id="4082125">d</span><br>
<span class="lineno"></span><span class="op" id="4082127">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4082130">func</span>&nbsp;<span class="op" id="4082135">(</span><span class="ident" id="4082136">d</span>&nbsp;<span class="op" id="4082138">*</span><span class="ident" id="4082139">digest</span><span class="op" id="4082145">)</span>&nbsp;<span class="ident" id="4082147">Size</span><span class="op" id="4082151">(</span><span class="op" id="4082152">)</span>&nbsp;<span class="builtintype" id="4082154">int</span>&nbsp;<span class="op" id="4082158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082161">if</span>&nbsp;<span class="op" id="4082164">!</span><span class="ident" id="4082165">d</span><span class="op" id="4082166">.</span><span class="ident" id="4082167">is384</span>&nbsp;<span class="op" id="4082173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082177">return</span>&nbsp;<span class="ident" id="4082184">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082190">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082193">return</span>&nbsp;<span class="ident" id="4082200">Size384</span><br>
<span class="lineno"></span><span class="op" id="4082208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082211">func</span>&nbsp;<span class="op" id="4082216">(</span><span class="ident" id="4082217">d</span>&nbsp;<span class="op" id="4082219">*</span><span class="ident" id="4082220">digest</span><span class="op" id="4082226">)</span>&nbsp;<span class="ident" id="4082228">BlockSize</span><span class="op" id="4082237">(</span><span class="op" id="4082238">)</span>&nbsp;<span class="builtintype" id="4082240">int</span>&nbsp;<span class="op" id="4082244">{</span>&nbsp;<span class="keyword" id="4082246">return</span>&nbsp;<span class="ident" id="4082253">BlockSize</span>&nbsp;<span class="op" id="4082263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4082266">func</span>&nbsp;<span class="op" id="4082271">(</span><span class="ident" id="4082272">d</span>&nbsp;<span class="op" id="4082274">*</span><span class="ident" id="4082275">digest</span><span class="op" id="4082281">)</span>&nbsp;<span class="ident" id="4082283">Write</span><span class="op" id="4082288">(</span><span class="ident" id="4082289">p</span>&nbsp;<span class="op" id="4082291">[</span><span class="op" id="4082292">]</span><span class="builtintype" id="4082293">byte</span><span class="op" id="4082297">)</span>&nbsp;<span class="op" id="4082299">(</span><span class="ident" id="4082300">nn</span>&nbsp;<span class="builtintype" id="4082303">int</span><span class="op" id="4082306">,</span>&nbsp;<span class="ident" id="4082308">err</span>&nbsp;<span class="builtintype" id="4082312">error</span><span class="op" id="4082317">)</span>&nbsp;<span class="op" id="4082319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082322">nn</span>&nbsp;<span class="op" id="4082325">=</span>&nbsp;<span class="builtinfunc" id="4082327">len</span><span class="op" id="4082330">(</span><span class="ident" id="4082331">p</span><span class="op" id="4082332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082335">d</span><span class="op" id="4082336">.</span><span class="builtinfunc" id="4082337">len</span>&nbsp;<span class="op" id="4082341">+=</span>&nbsp;<span class="ident" id="4082344">uint64</span><span class="op" id="4082350">(</span><span class="ident" id="4082351">nn</span><span class="op" id="4082353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082356">if</span>&nbsp;<span class="ident" id="4082359">d</span><span class="op" id="4082360">.</span><span class="ident" id="4082361">nx</span>&nbsp;<span class="op" id="4082364">&gt;</span>&nbsp;<span class="num" id="4082366">0</span>&nbsp;<span class="op" id="4082368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082372">n</span>&nbsp;<span class="op" id="4082374">:=</span>&nbsp;<span class="builtinfunc" id="4082377">copy</span><span class="op" id="4082381">(</span><span class="ident" id="4082382">d</span><span class="op" id="4082383">.</span><span class="ident" id="4082384">x</span><span class="op" id="4082385">[</span><span class="ident" id="4082386">d</span><span class="op" id="4082387">.</span><span class="ident" id="4082388">nx</span><span class="op" id="4082390">:</span><span class="op" id="4082391">]</span><span class="op" id="4082392">,</span>&nbsp;<span class="ident" id="4082394">p</span><span class="op" id="4082395">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082399">d</span><span class="op" id="4082400">.</span><span class="ident" id="4082401">nx</span>&nbsp;<span class="op" id="4082404">+=</span>&nbsp;<span class="ident" id="4082407">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082411">if</span>&nbsp;<span class="ident" id="4082414">d</span><span class="op" id="4082415">.</span><span class="ident" id="4082416">nx</span>&nbsp;<span class="op" id="4082419">==</span>&nbsp;<span class="ident" id="4082422">chunk</span>&nbsp;<span class="op" id="4082428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082433">block</span><span class="op" id="4082438">(</span><span class="ident" id="4082439">d</span><span class="op" id="4082440">,</span>&nbsp;<span class="ident" id="4082442">d</span><span class="op" id="4082443">.</span><span class="ident" id="4082444">x</span><span class="op" id="4082445">[</span><span class="op" id="4082446">:</span><span class="op" id="4082447">]</span><span class="op" id="4082448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082453">d</span><span class="op" id="4082454">.</span><span class="ident" id="4082455">nx</span>&nbsp;<span class="op" id="4082458">=</span>&nbsp;<span class="num" id="4082460">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082464">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082468">p</span>&nbsp;<span class="op" id="4082470">=</span>&nbsp;<span class="ident" id="4082472">p</span><span class="op" id="4082473">[</span><span class="ident" id="4082474">n</span><span class="op" id="4082475">:</span><span class="op" id="4082476">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082482">if</span>&nbsp;<span class="builtinfunc" id="4082485">len</span><span class="op" id="4082488">(</span><span class="ident" id="4082489">p</span><span class="op" id="4082490">)</span>&nbsp;<span class="op" id="4082492">&gt;=</span>&nbsp;<span class="ident" id="4082495">chunk</span>&nbsp;<span class="op" id="4082501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082505">n</span>&nbsp;<span class="op" id="4082507">:=</span>&nbsp;<span class="builtinfunc" id="4082510">len</span><span class="op" id="4082513">(</span><span class="ident" id="4082514">p</span><span class="op" id="4082515">)</span>&nbsp;<span class="op" id="4082517">&amp;^</span>&nbsp;<span class="op" id="4082520">(</span><span class="ident" id="4082521">chunk</span>&nbsp;<span class="op" id="4082527">-</span>&nbsp;<span class="num" id="4082529">1</span><span class="op" id="4082530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082534">block</span><span class="op" id="4082539">(</span><span class="ident" id="4082540">d</span><span class="op" id="4082541">,</span>&nbsp;<span class="ident" id="4082543">p</span><span class="op" id="4082544">[</span><span class="op" id="4082545">:</span><span class="ident" id="4082546">n</span><span class="op" id="4082547">]</span><span class="op" id="4082548">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082552">p</span>&nbsp;<span class="op" id="4082554">=</span>&nbsp;<span class="ident" id="4082556">p</span><span class="op" id="4082557">[</span><span class="ident" id="4082558">n</span><span class="op" id="4082559">:</span><span class="op" id="4082560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082566">if</span>&nbsp;<span class="builtinfunc" id="4082569">len</span><span class="op" id="4082572">(</span><span class="ident" id="4082573">p</span><span class="op" id="4082574">)</span>&nbsp;<span class="op" id="4082576">&gt;</span>&nbsp;<span class="num" id="4082578">0</span>&nbsp;<span class="op" id="4082580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082584">d</span><span class="op" id="4082585">.</span><span class="ident" id="4082586">nx</span>&nbsp;<span class="op" id="4082589">=</span>&nbsp;<span class="builtinfunc" id="4082591">copy</span><span class="op" id="4082595">(</span><span class="ident" id="4082596">d</span><span class="op" id="4082597">.</span><span class="ident" id="4082598">x</span><span class="op" id="4082599">[</span><span class="op" id="4082600">:</span><span class="op" id="4082601">]</span><span class="op" id="4082602">,</span>&nbsp;<span class="ident" id="4082604">p</span><span class="op" id="4082605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082608">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082611">return</span><br>
<span class="lineno"></span><span class="op" id="4082618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082621">func</span>&nbsp;<span class="op" id="4082626">(</span><span class="ident" id="4082627">d0</span>&nbsp;<span class="op" id="4082630">*</span><span class="ident" id="4082631">digest</span><span class="op" id="4082637">)</span>&nbsp;<span class="ident" id="4082639">Sum</span><span class="op" id="4082642">(</span><span class="ident" id="4082643">in</span>&nbsp;<span class="op" id="4082646">[</span><span class="op" id="4082647">]</span><span class="builtintype" id="4082648">byte</span><span class="op" id="4082652">)</span>&nbsp;<span class="op" id="4082654">[</span><span class="op" id="4082655">]</span><span class="builtintype" id="4082656">byte</span>&nbsp;<span class="op" id="4082661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082664">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082731">d</span>&nbsp;<span class="op" id="4082733">:=</span>&nbsp;<span class="builtinfunc" id="4082736">new</span><span class="op" id="4082739">(</span><span class="ident" id="4082740">digest</span><span class="op" id="4082746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082749">*</span><span class="ident" id="4082750">d</span>&nbsp;<span class="op" id="4082752">=</span>&nbsp;<span class="op" id="4082754">*</span><span class="ident" id="4082755">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082759">hash</span>&nbsp;<span class="op" id="4082764">:=</span>&nbsp;<span class="ident" id="4082767">d</span><span class="op" id="4082768">.</span><span class="ident" id="4082769">checkSum</span><span class="op" id="4082777">(</span><span class="op" id="4082778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082781">if</span>&nbsp;<span class="ident" id="4082784">d</span><span class="op" id="4082785">.</span><span class="ident" id="4082786">is384</span>&nbsp;<span class="op" id="4082792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082796">return</span>&nbsp;<span class="builtinfunc" id="4082803">append</span><span class="op" id="4082809">(</span><span class="ident" id="4082810">in</span><span class="op" id="4082812">,</span>&nbsp;<span class="ident" id="4082814">hash</span><span class="op" id="4082818">[</span><span class="op" id="4082819">:</span><span class="ident" id="4082820">Size384</span><span class="op" id="4082827">]</span><span class="op" id="4082828">...</span><span class="op" id="4082831">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082837">return</span>&nbsp;<span class="builtinfunc" id="4082844">append</span><span class="op" id="4082850">(</span><span class="ident" id="4082851">in</span><span class="op" id="4082853">,</span>&nbsp;<span class="ident" id="4082855">hash</span><span class="op" id="4082859">[</span><span class="op" id="4082860">:</span><span class="op" id="4082861">]</span><span class="op" id="4082862">...</span><span class="op" id="4082865">)</span><br>
<span class="lineno"></span><span class="op" id="4082867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082870">func</span>&nbsp;<span class="op" id="4082875">(</span><span class="ident" id="4082876">d</span>&nbsp;<span class="op" id="4082878">*</span><span class="ident" id="4082879">digest</span><span class="op" id="4082885">)</span>&nbsp;<span class="ident" id="4082887">checkSum</span><span class="op" id="4082895">(</span><span class="op" id="4082896">)</span>&nbsp;<span class="op" id="4082898">[</span><span class="ident" id="4082899">Size</span><span class="op" id="4082903">]</span><span class="builtintype" id="4082904">byte</span>&nbsp;<span class="op" id="4082909">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4082912">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4082974">len</span>&nbsp;<span class="op" id="4082978">:=</span>&nbsp;<span class="ident" id="4082981">d</span><span class="op" id="4082982">.</span><span class="builtinfunc" id="4082983">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082988">var</span>&nbsp;<span class="ident" id="4082992">tmp</span>&nbsp;<span class="op" id="4082996">[</span><span class="num" id="4082997">128</span><span class="op" id="4083000">]</span><span class="builtintype" id="4083001">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083007">tmp</span><span class="op" id="4083010">[</span><span class="num" id="4083011">0</span><span class="op" id="4083012">]</span>&nbsp;<span class="op" id="4083014">=</span>&nbsp;<span class="num" id="4083016">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083022">if</span>&nbsp;<span class="builtinfunc" id="4083025">len</span><span class="op" id="4083028">%</span><span class="num" id="4083029">128</span>&nbsp;<span class="op" id="4083033">&lt;</span>&nbsp;<span class="num" id="4083035">112</span>&nbsp;<span class="op" id="4083039">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083043">d</span><span class="op" id="4083044">.</span><span class="ident" id="4083045">Write</span><span class="op" id="4083050">(</span><span class="ident" id="4083051">tmp</span><span class="op" id="4083054">[</span><span class="num" id="4083055">0</span>&nbsp;<span class="op" id="4083057">:</span>&nbsp;<span class="num" id="4083059">112</span><span class="op" id="4083062">-</span><span class="builtinfunc" id="4083063">len</span><span class="op" id="4083066">%</span><span class="num" id="4083067">128</span><span class="op" id="4083070">]</span><span class="op" id="4083071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083074">}</span>&nbsp;<span class="keyword" id="4083076">else</span>&nbsp;<span class="op" id="4083081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083085">d</span><span class="op" id="4083086">.</span><span class="ident" id="4083087">Write</span><span class="op" id="4083092">(</span><span class="ident" id="4083093">tmp</span><span class="op" id="4083096">[</span><span class="num" id="4083097">0</span>&nbsp;<span class="op" id="4083099">:</span>&nbsp;<span class="num" id="4083101">128</span><span class="op" id="4083104">+</span><span class="num" id="4083105">112</span><span class="op" id="4083108">-</span><span class="builtinfunc" id="4083109">len</span><span class="op" id="4083112">%</span><span class="num" id="4083113">128</span><span class="op" id="4083116">]</span><span class="op" id="4083117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083124">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4083144">len</span>&nbsp;<span class="op" id="4083148">&lt;&lt;=</span>&nbsp;<span class="num" id="4083152">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083155">for</span>&nbsp;<span class="ident" id="4083159">i</span>&nbsp;<span class="op" id="4083161">:=</span>&nbsp;<span class="builtintype" id="4083164">uint</span><span class="op" id="4083168">(</span><span class="num" id="4083169">0</span><span class="op" id="4083170">)</span><span class="op" id="4083171">;</span>&nbsp;<span class="ident" id="4083173">i</span>&nbsp;<span class="op" id="4083175">&lt;</span>&nbsp;<span class="num" id="4083177">16</span><span class="op" id="4083179">;</span>&nbsp;<span class="ident" id="4083181">i</span><span class="op" id="4083182">++</span>&nbsp;<span class="op" id="4083185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083189">tmp</span><span class="op" id="4083192">[</span><span class="ident" id="4083193">i</span><span class="op" id="4083194">]</span>&nbsp;<span class="op" id="4083196">=</span>&nbsp;<span class="builtintype" id="4083198">byte</span><span class="op" id="4083202">(</span><span class="builtinfunc" id="4083203">len</span>&nbsp;<span class="op" id="4083207">&gt;&gt;</span>&nbsp;<span class="op" id="4083210">(</span><span class="num" id="4083211">120</span>&nbsp;<span class="op" id="4083215">-</span>&nbsp;<span class="num" id="4083217">8</span><span class="op" id="4083218">*</span><span class="ident" id="4083219">i</span><span class="op" id="4083220">)</span><span class="op" id="4083221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083224">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083227">d</span><span class="op" id="4083228">.</span><span class="ident" id="4083229">Write</span><span class="op" id="4083234">(</span><span class="ident" id="4083235">tmp</span><span class="op" id="4083238">[</span><span class="num" id="4083239">0</span><span class="op" id="4083240">:</span><span class="num" id="4083241">16</span><span class="op" id="4083243">]</span><span class="op" id="4083244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083248">if</span>&nbsp;<span class="ident" id="4083251">d</span><span class="op" id="4083252">.</span><span class="ident" id="4083253">nx</span>&nbsp;<span class="op" id="4083256">!=</span>&nbsp;<span class="num" id="4083259">0</span>&nbsp;<span class="op" id="4083261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4083265">panic</span><span class="op" id="4083270">(</span><span class="string" id="4083271">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4083282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083285">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083289">h</span>&nbsp;<span class="op" id="4083291">:=</span>&nbsp;<span class="ident" id="4083294">d</span><span class="op" id="4083295">.</span><span class="ident" id="4083296">h</span><span class="op" id="4083297">[</span><span class="op" id="4083298">:</span><span class="op" id="4083299">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083302">if</span>&nbsp;<span class="ident" id="4083305">d</span><span class="op" id="4083306">.</span><span class="ident" id="4083307">is384</span>&nbsp;<span class="op" id="4083313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083317">h</span>&nbsp;<span class="op" id="4083319">=</span>&nbsp;<span class="ident" id="4083321">d</span><span class="op" id="4083322">.</span><span class="ident" id="4083323">h</span><span class="op" id="4083324">[</span><span class="op" id="4083325">:</span><span class="num" id="4083326">6</span><span class="op" id="4083327">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083330">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083334">var</span>&nbsp;<span class="ident" id="4083338">digest</span>&nbsp;<span class="op" id="4083345">[</span><span class="ident" id="4083346">Size</span><span class="op" id="4083350">]</span><span class="builtintype" id="4083351">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083357">for</span>&nbsp;<span class="ident" id="4083361">i</span><span class="op" id="4083362">,</span>&nbsp;<span class="ident" id="4083364">s</span>&nbsp;<span class="op" id="4083366">:=</span>&nbsp;<span class="keyword" id="4083369">range</span>&nbsp;<span class="ident" id="4083375">h</span>&nbsp;<span class="op" id="4083377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083381">digest</span><span class="op" id="4083387">[</span><span class="ident" id="4083388">i</span><span class="op" id="4083389">*</span><span class="num" id="4083390">8</span><span class="op" id="4083391">]</span>&nbsp;<span class="op" id="4083393">=</span>&nbsp;<span class="builtintype" id="4083395">byte</span><span class="op" id="4083399">(</span><span class="ident" id="4083400">s</span>&nbsp;<span class="op" id="4083402">&gt;&gt;</span>&nbsp;<span class="num" id="4083405">56</span><span class="op" id="4083407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083411">digest</span><span class="op" id="4083417">[</span><span class="ident" id="4083418">i</span><span class="op" id="4083419">*</span><span class="num" id="4083420">8</span><span class="op" id="4083421">+</span><span class="num" id="4083422">1</span><span class="op" id="4083423">]</span>&nbsp;<span class="op" id="4083425">=</span>&nbsp;<span class="builtintype" id="4083427">byte</span><span class="op" id="4083431">(</span><span class="ident" id="4083432">s</span>&nbsp;<span class="op" id="4083434">&gt;&gt;</span>&nbsp;<span class="num" id="4083437">48</span><span class="op" id="4083439">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083443">digest</span><span class="op" id="4083449">[</span><span class="ident" id="4083450">i</span><span class="op" id="4083451">*</span><span class="num" id="4083452">8</span><span class="op" id="4083453">+</span><span class="num" id="4083454">2</span><span class="op" id="4083455">]</span>&nbsp;<span class="op" id="4083457">=</span>&nbsp;<span class="builtintype" id="4083459">byte</span><span class="op" id="4083463">(</span><span class="ident" id="4083464">s</span>&nbsp;<span class="op" id="4083466">&gt;&gt;</span>&nbsp;<span class="num" id="4083469">40</span><span class="op" id="4083471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083475">digest</span><span class="op" id="4083481">[</span><span class="ident" id="4083482">i</span><span class="op" id="4083483">*</span><span class="num" id="4083484">8</span><span class="op" id="4083485">+</span><span class="num" id="4083486">3</span><span class="op" id="4083487">]</span>&nbsp;<span class="op" id="4083489">=</span>&nbsp;<span class="builtintype" id="4083491">byte</span><span class="op" id="4083495">(</span><span class="ident" id="4083496">s</span>&nbsp;<span class="op" id="4083498">&gt;&gt;</span>&nbsp;<span class="num" id="4083501">32</span><span class="op" id="4083503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083507">digest</span><span class="op" id="4083513">[</span><span class="ident" id="4083514">i</span><span class="op" id="4083515">*</span><span class="num" id="4083516">8</span><span class="op" id="4083517">+</span><span class="num" id="4083518">4</span><span class="op" id="4083519">]</span>&nbsp;<span class="op" id="4083521">=</span>&nbsp;<span class="builtintype" id="4083523">byte</span><span class="op" id="4083527">(</span><span class="ident" id="4083528">s</span>&nbsp;<span class="op" id="4083530">&gt;&gt;</span>&nbsp;<span class="num" id="4083533">24</span><span class="op" id="4083535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083539">digest</span><span class="op" id="4083545">[</span><span class="ident" id="4083546">i</span><span class="op" id="4083547">*</span><span class="num" id="4083548">8</span><span class="op" id="4083549">+</span><span class="num" id="4083550">5</span><span class="op" id="4083551">]</span>&nbsp;<span class="op" id="4083553">=</span>&nbsp;<span class="builtintype" id="4083555">byte</span><span class="op" id="4083559">(</span><span class="ident" id="4083560">s</span>&nbsp;<span class="op" id="4083562">&gt;&gt;</span>&nbsp;<span class="num" id="4083565">16</span><span class="op" id="4083567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083571">digest</span><span class="op" id="4083577">[</span><span class="ident" id="4083578">i</span><span class="op" id="4083579">*</span><span class="num" id="4083580">8</span><span class="op" id="4083581">+</span><span class="num" id="4083582">6</span><span class="op" id="4083583">]</span>&nbsp;<span class="op" id="4083585">=</span>&nbsp;<span class="builtintype" id="4083587">byte</span><span class="op" id="4083591">(</span><span class="ident" id="4083592">s</span>&nbsp;<span class="op" id="4083594">&gt;&gt;</span>&nbsp;<span class="num" id="4083597">8</span><span class="op" id="4083598">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083602">digest</span><span class="op" id="4083608">[</span><span class="ident" id="4083609">i</span><span class="op" id="4083610">*</span><span class="num" id="4083611">8</span><span class="op" id="4083612">+</span><span class="num" id="4083613">7</span><span class="op" id="4083614">]</span>&nbsp;<span class="op" id="4083616">=</span>&nbsp;<span class="builtintype" id="4083618">byte</span><span class="op" id="4083622">(</span><span class="ident" id="4083623">s</span><span class="op" id="4083624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083631">return</span>&nbsp;<span class="ident" id="4083638">digest</span><br>
<span class="lineno"></span><span class="op" id="4083645">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4083648">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4083699">func</span>&nbsp;<span class="ident" id="4083704">Sum512</span><span class="op" id="4083710">(</span><span class="ident" id="4083711">data</span>&nbsp;<span class="op" id="4083716">[</span><span class="op" id="4083717">]</span><span class="builtintype" id="4083718">byte</span><span class="op" id="4083722">)</span>&nbsp;<span class="op" id="4083724">[</span><span class="ident" id="4083725">Size</span><span class="op" id="4083729">]</span><span class="builtintype" id="4083730">byte</span>&nbsp;<span class="op" id="4083735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083738">var</span>&nbsp;<span class="ident" id="4083742">d</span>&nbsp;<span class="ident" id="4083744">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083752">d</span><span class="op" id="4083753">.</span><span class="ident" id="4083754">Reset</span><span class="op" id="4083759">(</span><span class="op" id="4083760">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083763">d</span><span class="op" id="4083764">.</span><span class="ident" id="4083765">Write</span><span class="op" id="4083770">(</span><span class="ident" id="4083771">data</span><span class="op" id="4083775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083778">return</span>&nbsp;<span class="ident" id="4083785">d</span><span class="op" id="4083786">.</span><span class="ident" id="4083787">checkSum</span><span class="op" id="4083795">(</span><span class="op" id="4083796">)</span><br>
<span class="lineno"></span><span class="op" id="4083798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4083801">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4083852">func</span>&nbsp;<span class="ident" id="4083857">Sum384</span><span class="op" id="4083863">(</span><span class="ident" id="4083864">data</span>&nbsp;<span class="op" id="4083869">[</span><span class="op" id="4083870">]</span><span class="builtintype" id="4083871">byte</span><span class="op" id="4083875">)</span>&nbsp;<span class="op" id="4083877">(</span><span class="ident" id="4083878">sum384</span>&nbsp;<span class="op" id="4083885">[</span><span class="ident" id="4083886">Size384</span><span class="op" id="4083893">]</span><span class="builtintype" id="4083894">byte</span><span class="op" id="4083898">)</span>&nbsp;<span class="op" id="4083900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083903">var</span>&nbsp;<span class="ident" id="4083907">d</span>&nbsp;<span class="ident" id="4083909">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083917">d</span><span class="op" id="4083918">.</span><span class="ident" id="4083919">is384</span>&nbsp;<span class="op" id="4083925">=</span>&nbsp;<span class="builtintype" id="4083927">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083933">d</span><span class="op" id="4083934">.</span><span class="ident" id="4083935">Reset</span><span class="op" id="4083940">(</span><span class="op" id="4083941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083944">d</span><span class="op" id="4083945">.</span><span class="ident" id="4083946">Write</span><span class="op" id="4083951">(</span><span class="ident" id="4083952">data</span><span class="op" id="4083956">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083959">sum</span>&nbsp;<span class="op" id="4083963">:=</span>&nbsp;<span class="ident" id="4083966">d</span><span class="op" id="4083967">.</span><span class="ident" id="4083968">checkSum</span><span class="op" id="4083976">(</span><span class="op" id="4083977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4083980">copy</span><span class="op" id="4083984">(</span><span class="ident" id="4083985">sum384</span><span class="op" id="4083991">[</span><span class="op" id="4083992">:</span><span class="op" id="4083993">]</span><span class="op" id="4083994">,</span>&nbsp;<span class="ident" id="4083996">sum</span><span class="op" id="4083999">[</span><span class="op" id="4084000">:</span><span class="ident" id="4084001">Size384</span><span class="op" id="4084008">]</span><span class="op" id="4084009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084012">return</span><br>
<span class="lineno"></span><span class="op" id="4084019">}</span>
</div>
</body>
</html>
