<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html" class="current">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6377456">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6377511">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6377565">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6377616">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6377647">package</span>&nbsp;<span class="ident" id="6377655">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6377664">import</span>&nbsp;<span class="op" id="6377671">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6377674">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6377681">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6377687">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="6377701">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6377704">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="6377770">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6377849">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6377914">type</span>&nbsp;<span class="ident" id="6377919">CoverBlock</span>&nbsp;<span class="keyword" id="6377930">struct</span>&nbsp;<span class="op" id="6377937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377940">Line0</span>&nbsp;<span class="builtintype" id="6377946">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377954">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="6377960">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377968">Line1</span>&nbsp;<span class="builtintype" id="6377974">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377982">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="6377988">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6377996">Stmts</span>&nbsp;<span class="builtintype" id="6378002">uint16</span><br>
<span class="lineno"></span><span class="op" id="6378009">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6378012">var</span>&nbsp;<span class="ident" id="6378016">cover</span>&nbsp;<span class="ident" id="6378022">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6378029">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="6378088">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="6378167">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6378232">type</span>&nbsp;<span class="ident" id="6378237">Cover</span>&nbsp;<span class="keyword" id="6378243">struct</span>&nbsp;<span class="op" id="6378250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378253">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6378269">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378277">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378293">map</span><span class="op" id="6378296">[</span><span class="builtintype" id="6378297">string</span><span class="op" id="6378303">]</span><span class="op" id="6378304">[</span><span class="op" id="6378305">]</span><span class="builtintype" id="6378306">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378314">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378330">map</span><span class="op" id="6378333">[</span><span class="builtintype" id="6378334">string</span><span class="op" id="6378340">]</span><span class="op" id="6378341">[</span><span class="op" id="6378342">]</span><span class="ident" id="6378343">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378355">CoveredPackages</span>&nbsp;<span class="builtintype" id="6378371">string</span><br>
<span class="lineno"></span><span class="op" id="6378378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6378381">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="6378462">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="6378513">//</span><br>
<span class="lineno"></span><span class="comment" id="6378516">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="6378603">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="6378678">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6378755">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="6378775">func</span>&nbsp;<span class="ident" id="6378780">Coverage</span><span class="op" id="6378788">(</span><span class="op" id="6378789">)</span>&nbsp;<span class="builtintype" id="6378791">float64</span>&nbsp;<span class="op" id="6378799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378802">var</span>&nbsp;<span class="ident" id="6378806">n</span><span class="op" id="6378807">,</span>&nbsp;<span class="ident" id="6378809">d</span>&nbsp;<span class="builtintype" id="6378811">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378818">for</span>&nbsp;<span class="ident" id="6378822">_</span><span class="op" id="6378823">,</span>&nbsp;<span class="ident" id="6378825">counters</span>&nbsp;<span class="op" id="6378834">:=</span>&nbsp;<span class="keyword" id="6378837">range</span>&nbsp;<span class="ident" id="6378843">cover</span><span class="op" id="6378848">.</span><span class="ident" id="6378849">Counters</span>&nbsp;<span class="op" id="6378858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378862">for</span>&nbsp;<span class="ident" id="6378866">i</span>&nbsp;<span class="op" id="6378868">:=</span>&nbsp;<span class="keyword" id="6378871">range</span>&nbsp;<span class="ident" id="6378877">counters</span>&nbsp;<span class="op" id="6378886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378891">if</span>&nbsp;<span class="ident" id="6378894">atomic</span><span class="op" id="6378900">.</span><span class="ident" id="6378901">LoadUint32</span><span class="op" id="6378911">(</span><span class="op" id="6378912">&amp;</span><span class="ident" id="6378913">counters</span><span class="op" id="6378921">[</span><span class="ident" id="6378922">i</span><span class="op" id="6378923">]</span><span class="op" id="6378924">)</span>&nbsp;<span class="op" id="6378926">&gt;</span>&nbsp;<span class="num" id="6378928">0</span>&nbsp;<span class="op" id="6378930">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378936">n</span><span class="op" id="6378937">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378948">d</span><span class="op" id="6378949">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378957">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378960">if</span>&nbsp;<span class="ident" id="6378963">d</span>&nbsp;<span class="op" id="6378965">==</span>&nbsp;<span class="num" id="6378968">0</span>&nbsp;<span class="op" id="6378970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378974">return</span>&nbsp;<span class="num" id="6378981">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6378984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6378987">return</span>&nbsp;<span class="builtintype" id="6378994">float64</span><span class="op" id="6379001">(</span><span class="ident" id="6379002">n</span><span class="op" id="6379003">)</span>&nbsp;<span class="op" id="6379005">/</span>&nbsp;<span class="builtintype" id="6379007">float64</span><span class="op" id="6379014">(</span><span class="ident" id="6379015">d</span><span class="op" id="6379016">)</span><br>
<span class="lineno"></span><span class="op" id="6379018">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6379021">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="6379092">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6379173">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6379238">func</span>&nbsp;<span class="ident" id="6379243">RegisterCover</span><span class="op" id="6379256">(</span><span class="ident" id="6379257">c</span>&nbsp;<span class="ident" id="6379259">Cover</span><span class="op" id="6379264">)</span>&nbsp;<span class="op" id="6379266">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379269">cover</span>&nbsp;<span class="op" id="6379275">=</span>&nbsp;<span class="ident" id="6379277">c</span><br>
<span class="lineno"></span><span class="op" id="6379279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6379282">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="6379351">func</span>&nbsp;<span class="ident" id="6379356">mustBeNil</span><span class="op" id="6379365">(</span><span class="ident" id="6379366">err</span>&nbsp;<span class="builtintype" id="6379370">error</span><span class="op" id="6379375">)</span>&nbsp;<span class="op" id="6379377">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379380">if</span>&nbsp;<span class="ident" id="6379383">err</span>&nbsp;<span class="op" id="6379387">!=</span>&nbsp;<span class="builtintype" id="6379390">nil</span>&nbsp;<span class="op" id="6379394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379398">fmt</span><span class="op" id="6379401">.</span><span class="ident" id="6379402">Fprintf</span><span class="op" id="6379409">(</span><span class="ident" id="6379410">os</span><span class="op" id="6379412">.</span><span class="ident" id="6379413">Stderr</span><span class="op" id="6379419">,</span>&nbsp;<span class="string" id="6379421">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6379436">,</span>&nbsp;<span class="ident" id="6379438">err</span><span class="op" id="6379441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379445">os</span><span class="op" id="6379447">.</span><span class="ident" id="6379448">Exit</span><span class="op" id="6379452">(</span><span class="num" id="6379453">2</span><span class="op" id="6379454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6379457">}</span><br>
<span class="lineno"></span><span class="op" id="6379459">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6379462">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6379553">func</span>&nbsp;<span class="ident" id="6379558">coverReport</span><span class="op" id="6379569">(</span><span class="op" id="6379570">)</span>&nbsp;<span class="op" id="6379572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379575">var</span>&nbsp;<span class="ident" id="6379579">f</span>&nbsp;<span class="op" id="6379581">*</span><span class="ident" id="6379582">os</span><span class="op" id="6379584">.</span><span class="ident" id="6379585">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379591">var</span>&nbsp;<span class="ident" id="6379595">err</span>&nbsp;<span class="builtintype" id="6379599">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379606">if</span>&nbsp;<span class="op" id="6379609">*</span><span class="ident" id="6379610">coverProfile</span>&nbsp;<span class="op" id="6379623">!=</span>&nbsp;<span class="string" id="6379626">&#34;&#34;</span>&nbsp;<span class="op" id="6379629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379633">f</span><span class="op" id="6379634">,</span>&nbsp;<span class="ident" id="6379636">err</span>&nbsp;<span class="op" id="6379640">=</span>&nbsp;<span class="ident" id="6379642">os</span><span class="op" id="6379644">.</span><span class="ident" id="6379645">Create</span><span class="op" id="6379651">(</span><span class="ident" id="6379652">toOutputDir</span><span class="op" id="6379663">(</span><span class="op" id="6379664">*</span><span class="ident" id="6379665">coverProfile</span><span class="op" id="6379677">)</span><span class="op" id="6379678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379682">mustBeNil</span><span class="op" id="6379691">(</span><span class="ident" id="6379692">err</span><span class="op" id="6379695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379699">fmt</span><span class="op" id="6379702">.</span><span class="ident" id="6379703">Fprintf</span><span class="op" id="6379710">(</span><span class="ident" id="6379711">f</span><span class="op" id="6379712">,</span>&nbsp;<span class="string" id="6379714">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="6379726">,</span>&nbsp;<span class="ident" id="6379728">cover</span><span class="op" id="6379733">.</span><span class="ident" id="6379734">Mode</span><span class="op" id="6379738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379742">defer</span>&nbsp;<span class="keyword" id="6379748">func</span><span class="op" id="6379752">(</span><span class="op" id="6379753">)</span>&nbsp;<span class="op" id="6379755">{</span>&nbsp;<span class="ident" id="6379757">mustBeNil</span><span class="op" id="6379766">(</span><span class="ident" id="6379767">f</span><span class="op" id="6379768">.</span><span class="ident" id="6379769">Close</span><span class="op" id="6379774">(</span><span class="op" id="6379775">)</span><span class="op" id="6379776">)</span>&nbsp;<span class="op" id="6379778">}</span><span class="op" id="6379779">(</span><span class="op" id="6379780">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6379783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379787">var</span>&nbsp;<span class="ident" id="6379791">active</span><span class="op" id="6379797">,</span>&nbsp;<span class="ident" id="6379799">total</span>&nbsp;<span class="builtintype" id="6379805">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379812">var</span>&nbsp;<span class="ident" id="6379816">count</span>&nbsp;<span class="builtintype" id="6379822">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379830">for</span>&nbsp;<span class="ident" id="6379834">name</span><span class="op" id="6379838">,</span>&nbsp;<span class="ident" id="6379840">counts</span>&nbsp;<span class="op" id="6379847">:=</span>&nbsp;<span class="keyword" id="6379850">range</span>&nbsp;<span class="ident" id="6379856">cover</span><span class="op" id="6379861">.</span><span class="ident" id="6379862">Counters</span>&nbsp;<span class="op" id="6379871">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379875">blocks</span>&nbsp;<span class="op" id="6379882">:=</span>&nbsp;<span class="ident" id="6379885">cover</span><span class="op" id="6379890">.</span><span class="ident" id="6379891">Blocks</span><span class="op" id="6379897">[</span><span class="ident" id="6379898">name</span><span class="op" id="6379902">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6379906">for</span>&nbsp;<span class="ident" id="6379910">i</span>&nbsp;<span class="op" id="6379912">:=</span>&nbsp;<span class="keyword" id="6379915">range</span>&nbsp;<span class="ident" id="6379921">counts</span>&nbsp;<span class="op" id="6379928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379933">stmts</span>&nbsp;<span class="op" id="6379939">:=</span>&nbsp;<span class="builtintype" id="6379942">int64</span><span class="op" id="6379947">(</span><span class="ident" id="6379948">blocks</span><span class="op" id="6379954">[</span><span class="ident" id="6379955">i</span><span class="op" id="6379956">]</span><span class="op" id="6379957">.</span><span class="ident" id="6379958">Stmts</span><span class="op" id="6379963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379968">total</span>&nbsp;<span class="op" id="6379974">+=</span>&nbsp;<span class="ident" id="6379977">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6379986">count</span>&nbsp;<span class="op" id="6379992">=</span>&nbsp;<span class="ident" id="6379994">atomic</span><span class="op" id="6380000">.</span><span class="ident" id="6380001">LoadUint32</span><span class="op" id="6380011">(</span><span class="op" id="6380012">&amp;</span><span class="ident" id="6380013">counts</span><span class="op" id="6380019">[</span><span class="ident" id="6380020">i</span><span class="op" id="6380021">]</span><span class="op" id="6380022">)</span>&nbsp;<span class="comment" id="6380024">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6380048">if</span>&nbsp;<span class="ident" id="6380051">count</span>&nbsp;<span class="op" id="6380057">&gt;</span>&nbsp;<span class="num" id="6380059">0</span>&nbsp;<span class="op" id="6380061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380067">active</span>&nbsp;<span class="op" id="6380074">+=</span>&nbsp;<span class="ident" id="6380077">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6380086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6380091">if</span>&nbsp;<span class="ident" id="6380094">f</span>&nbsp;<span class="op" id="6380096">!=</span>&nbsp;<span class="builtintype" id="6380099">nil</span>&nbsp;<span class="op" id="6380103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380109">_</span><span class="op" id="6380110">,</span>&nbsp;<span class="ident" id="6380112">err</span>&nbsp;<span class="op" id="6380116">:=</span>&nbsp;<span class="ident" id="6380119">fmt</span><span class="op" id="6380122">.</span><span class="ident" id="6380123">Fprintf</span><span class="op" id="6380130">(</span><span class="ident" id="6380131">f</span><span class="op" id="6380132">,</span>&nbsp;<span class="string" id="6380134">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="6380158">,</span>&nbsp;<span class="ident" id="6380160">name</span><span class="op" id="6380164">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380171">blocks</span><span class="op" id="6380177">[</span><span class="ident" id="6380178">i</span><span class="op" id="6380179">]</span><span class="op" id="6380180">.</span><span class="ident" id="6380181">Line0</span><span class="op" id="6380186">,</span>&nbsp;<span class="ident" id="6380188">blocks</span><span class="op" id="6380194">[</span><span class="ident" id="6380195">i</span><span class="op" id="6380196">]</span><span class="op" id="6380197">.</span><span class="ident" id="6380198">Col0</span><span class="op" id="6380202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380209">blocks</span><span class="op" id="6380215">[</span><span class="ident" id="6380216">i</span><span class="op" id="6380217">]</span><span class="op" id="6380218">.</span><span class="ident" id="6380219">Line1</span><span class="op" id="6380224">,</span>&nbsp;<span class="ident" id="6380226">blocks</span><span class="op" id="6380232">[</span><span class="ident" id="6380233">i</span><span class="op" id="6380234">]</span><span class="op" id="6380235">.</span><span class="ident" id="6380236">Col1</span><span class="op" id="6380240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380247">stmts</span><span class="op" id="6380252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380259">count</span><span class="op" id="6380264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380270">mustBeNil</span><span class="op" id="6380279">(</span><span class="ident" id="6380280">err</span><span class="op" id="6380283">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6380288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6380292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6380295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6380298">if</span>&nbsp;<span class="ident" id="6380301">total</span>&nbsp;<span class="op" id="6380307">==</span>&nbsp;<span class="num" id="6380310">0</span>&nbsp;<span class="op" id="6380312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380316">total</span>&nbsp;<span class="op" id="6380322">=</span>&nbsp;<span class="num" id="6380324">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6380327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6380330">fmt</span><span class="op" id="6380333">.</span><span class="ident" id="6380334">Printf</span><span class="op" id="6380340">(</span><span class="string" id="6380341">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="6380377">,</span>&nbsp;<span class="num" id="6380379">100</span><span class="op" id="6380382">*</span><span class="builtintype" id="6380383">float64</span><span class="op" id="6380390">(</span><span class="ident" id="6380391">active</span><span class="op" id="6380397">)</span><span class="op" id="6380398">/</span><span class="builtintype" id="6380399">float64</span><span class="op" id="6380406">(</span><span class="ident" id="6380407">total</span><span class="op" id="6380412">)</span><span class="op" id="6380413">,</span>&nbsp;<span class="ident" id="6380415">cover</span><span class="op" id="6380420">.</span><span class="ident" id="6380421">CoveredPackages</span><span class="op" id="6380436">)</span><br>
<span class="lineno"></span><span class="op" id="6380438">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
