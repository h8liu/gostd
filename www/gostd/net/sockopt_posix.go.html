<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3727965">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3728021">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3728075">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3728126">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3728199">package</span>&nbsp;<span class="ident" id="3728207">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3728212">import</span>&nbsp;<span class="op" id="3728219">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3728222">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3728228">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3728238">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3728241">//&nbsp;Boolean&nbsp;to&nbsp;int.</span><br>
<span class="lineno">15</span><span class="keyword" id="3728260">func</span>&nbsp;<span class="ident" id="3728265">boolint</span><span class="op" id="3728272">(</span><span class="ident" id="3728273">b</span>&nbsp;<span class="builtintype" id="3728275">bool</span><span class="op" id="3728279">)</span>&nbsp;<span class="builtintype" id="3728281">int</span>&nbsp;<span class="op" id="3728285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728288">if</span>&nbsp;<span class="ident" id="3728291">b</span>&nbsp;<span class="op" id="3728293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728297">return</span>&nbsp;<span class="num" id="3728304">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728310">return</span>&nbsp;<span class="num" id="3728317">0</span><br>
<span class="lineno">20</span><span class="op" id="3728319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3728322">func</span>&nbsp;<span class="ident" id="3728327">ipv4AddrToInterface</span><span class="op" id="3728346">(</span><span class="ident" id="3728347">ip</span>&nbsp;<span class="ident" id="3728350">IP</span><span class="op" id="3728352">)</span>&nbsp;<span class="op" id="3728354">(</span><span class="op" id="3728355">*</span><span class="ident" id="3728356">Interface</span><span class="op" id="3728365">,</span>&nbsp;<span class="builtintype" id="3728367">error</span><span class="op" id="3728372">)</span>&nbsp;<span class="op" id="3728374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728377">ift</span><span class="op" id="3728380">,</span>&nbsp;<span class="ident" id="3728382">err</span>&nbsp;<span class="op" id="3728386">:=</span>&nbsp;<span class="ident" id="3728389">Interfaces</span><span class="op" id="3728399">(</span><span class="op" id="3728400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728403">if</span>&nbsp;<span class="ident" id="3728406">err</span>&nbsp;<span class="op" id="3728410">!=</span>&nbsp;<span class="ident" id="3728413">nil</span>&nbsp;<span class="op" id="3728417">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728421">return</span>&nbsp;<span class="ident" id="3728428">nil</span><span class="op" id="3728431">,</span>&nbsp;<span class="ident" id="3728433">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728441">for</span>&nbsp;<span class="ident" id="3728445">_</span><span class="op" id="3728446">,</span>&nbsp;<span class="ident" id="3728448">ifi</span>&nbsp;<span class="op" id="3728452">:=</span>&nbsp;<span class="keyword" id="3728455">range</span>&nbsp;<span class="ident" id="3728461">ift</span>&nbsp;<span class="op" id="3728465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728469">ifat</span><span class="op" id="3728473">,</span>&nbsp;<span class="ident" id="3728475">err</span>&nbsp;<span class="op" id="3728479">:=</span>&nbsp;<span class="ident" id="3728482">ifi</span><span class="op" id="3728485">.</span><span class="ident" id="3728486">Addrs</span><span class="op" id="3728491">(</span><span class="op" id="3728492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728496">if</span>&nbsp;<span class="ident" id="3728499">err</span>&nbsp;<span class="op" id="3728503">!=</span>&nbsp;<span class="ident" id="3728506">nil</span>&nbsp;<span class="op" id="3728510">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728515">return</span>&nbsp;<span class="ident" id="3728522">nil</span><span class="op" id="3728525">,</span>&nbsp;<span class="ident" id="3728527">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728537">for</span>&nbsp;<span class="ident" id="3728541">_</span><span class="op" id="3728542">,</span>&nbsp;<span class="ident" id="3728544">ifa</span>&nbsp;<span class="op" id="3728548">:=</span>&nbsp;<span class="keyword" id="3728551">range</span>&nbsp;<span class="ident" id="3728557">ifat</span>&nbsp;<span class="op" id="3728562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728567">switch</span>&nbsp;<span class="ident" id="3728574">v</span>&nbsp;<span class="op" id="3728576">:=</span>&nbsp;<span class="ident" id="3728579">ifa</span><span class="op" id="3728582">.</span><span class="op" id="3728583">(</span><span class="keyword" id="3728584">type</span><span class="op" id="3728588">)</span>&nbsp;<span class="op" id="3728590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728595">case</span>&nbsp;<span class="op" id="3728600">*</span><span class="ident" id="3728601">IPAddr</span><span class="op" id="3728607">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728613">if</span>&nbsp;<span class="ident" id="3728616">ip</span><span class="op" id="3728618">.</span><span class="ident" id="3728619">Equal</span><span class="op" id="3728624">(</span><span class="ident" id="3728625">v</span><span class="op" id="3728626">.</span><span class="ident" id="3728627">IP</span><span class="op" id="3728629">)</span>&nbsp;<span class="op" id="3728631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728638">return</span>&nbsp;<span class="op" id="3728645">&amp;</span><span class="ident" id="3728646">ifi</span><span class="op" id="3728649">,</span>&nbsp;<span class="ident" id="3728651">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728664">case</span>&nbsp;<span class="op" id="3728669">*</span><span class="ident" id="3728670">IPNet</span><span class="op" id="3728675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728681">if</span>&nbsp;<span class="ident" id="3728684">ip</span><span class="op" id="3728686">.</span><span class="ident" id="3728687">Equal</span><span class="op" id="3728692">(</span><span class="ident" id="3728693">v</span><span class="op" id="3728694">.</span><span class="ident" id="3728695">IP</span><span class="op" id="3728697">)</span>&nbsp;<span class="op" id="3728699">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728706">return</span>&nbsp;<span class="op" id="3728713">&amp;</span><span class="ident" id="3728714">ifi</span><span class="op" id="3728717">,</span>&nbsp;<span class="ident" id="3728719">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728739">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728742">if</span>&nbsp;<span class="ident" id="3728745">ip</span><span class="op" id="3728747">.</span><span class="ident" id="3728748">Equal</span><span class="op" id="3728753">(</span><span class="ident" id="3728754">IPv4zero</span><span class="op" id="3728762">)</span>&nbsp;<span class="op" id="3728764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728768">return</span>&nbsp;<span class="ident" id="3728775">nil</span><span class="op" id="3728778">,</span>&nbsp;<span class="ident" id="3728780">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728788">return</span>&nbsp;<span class="ident" id="3728795">nil</span><span class="op" id="3728798">,</span>&nbsp;<span class="ident" id="3728800">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3728819">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3728822">func</span>&nbsp;<span class="ident" id="3728827">interfaceToIPv4Addr</span><span class="op" id="3728846">(</span><span class="ident" id="3728847">ifi</span>&nbsp;<span class="op" id="3728851">*</span><span class="ident" id="3728852">Interface</span><span class="op" id="3728861">)</span>&nbsp;<span class="op" id="3728863">(</span><span class="ident" id="3728864">IP</span><span class="op" id="3728866">,</span>&nbsp;<span class="builtintype" id="3728868">error</span><span class="op" id="3728873">)</span>&nbsp;<span class="op" id="3728875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728878">if</span>&nbsp;<span class="ident" id="3728881">ifi</span>&nbsp;<span class="op" id="3728885">==</span>&nbsp;<span class="ident" id="3728888">nil</span>&nbsp;<span class="op" id="3728892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728896">return</span>&nbsp;<span class="ident" id="3728903">IPv4zero</span><span class="op" id="3728911">,</span>&nbsp;<span class="ident" id="3728913">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728918">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3728921">ifat</span><span class="op" id="3728925">,</span>&nbsp;<span class="ident" id="3728927">err</span>&nbsp;<span class="op" id="3728931">:=</span>&nbsp;<span class="ident" id="3728934">ifi</span><span class="op" id="3728937">.</span><span class="ident" id="3728938">Addrs</span><span class="op" id="3728943">(</span><span class="op" id="3728944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728947">if</span>&nbsp;<span class="ident" id="3728950">err</span>&nbsp;<span class="op" id="3728954">!=</span>&nbsp;<span class="ident" id="3728957">nil</span>&nbsp;<span class="op" id="3728961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728965">return</span>&nbsp;<span class="ident" id="3728972">nil</span><span class="op" id="3728975">,</span>&nbsp;<span class="ident" id="3728977">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3728982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3728985">for</span>&nbsp;<span class="ident" id="3728989">_</span><span class="op" id="3728990">,</span>&nbsp;<span class="ident" id="3728992">ifa</span>&nbsp;<span class="op" id="3728996">:=</span>&nbsp;<span class="keyword" id="3728999">range</span>&nbsp;<span class="ident" id="3729005">ifat</span>&nbsp;<span class="op" id="3729010">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729014">switch</span>&nbsp;<span class="ident" id="3729021">v</span>&nbsp;<span class="op" id="3729023">:=</span>&nbsp;<span class="ident" id="3729026">ifa</span><span class="op" id="3729029">.</span><span class="op" id="3729030">(</span><span class="keyword" id="3729031">type</span><span class="op" id="3729035">)</span>&nbsp;<span class="op" id="3729037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729041">case</span>&nbsp;<span class="op" id="3729046">*</span><span class="ident" id="3729047">IPAddr</span><span class="op" id="3729053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729058">if</span>&nbsp;<span class="ident" id="3729061">v</span><span class="op" id="3729062">.</span><span class="ident" id="3729063">IP</span><span class="op" id="3729065">.</span><span class="ident" id="3729066">To4</span><span class="op" id="3729069">(</span><span class="op" id="3729070">)</span>&nbsp;<span class="op" id="3729072">!=</span>&nbsp;<span class="ident" id="3729075">nil</span>&nbsp;<span class="op" id="3729079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729085">return</span>&nbsp;<span class="ident" id="3729092">v</span><span class="op" id="3729093">.</span><span class="ident" id="3729094">IP</span><span class="op" id="3729096">,</span>&nbsp;<span class="ident" id="3729098">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729105">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729109">case</span>&nbsp;<span class="op" id="3729114">*</span><span class="ident" id="3729115">IPNet</span><span class="op" id="3729120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729125">if</span>&nbsp;<span class="ident" id="3729128">v</span><span class="op" id="3729129">.</span><span class="ident" id="3729130">IP</span><span class="op" id="3729132">.</span><span class="ident" id="3729133">To4</span><span class="op" id="3729136">(</span><span class="op" id="3729137">)</span>&nbsp;<span class="op" id="3729139">!=</span>&nbsp;<span class="ident" id="3729142">nil</span>&nbsp;<span class="op" id="3729146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729152">return</span>&nbsp;<span class="ident" id="3729159">v</span><span class="op" id="3729160">.</span><span class="ident" id="3729161">IP</span><span class="op" id="3729163">,</span>&nbsp;<span class="ident" id="3729165">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729176">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729182">return</span>&nbsp;<span class="ident" id="3729189">nil</span><span class="op" id="3729192">,</span>&nbsp;<span class="ident" id="3729194">errNoSuchInterface</span><br>
<span class="lineno"></span><span class="op" id="3729213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3729216">func</span>&nbsp;<span class="ident" id="3729221">setIPv4MreqToInterface</span><span class="op" id="3729243">(</span><span class="ident" id="3729244">mreq</span>&nbsp;<span class="op" id="3729249">*</span><span class="ident" id="3729250">syscall</span><span class="op" id="3729257">.</span><span class="ident" id="3729258">IPMreq</span><span class="op" id="3729264">,</span>&nbsp;<span class="ident" id="3729266">ifi</span>&nbsp;<span class="op" id="3729270">*</span><span class="ident" id="3729271">Interface</span><span class="op" id="3729280">)</span>&nbsp;<span class="builtintype" id="3729282">error</span>&nbsp;<span class="op" id="3729288">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729291">if</span>&nbsp;<span class="ident" id="3729294">ifi</span>&nbsp;<span class="op" id="3729298">==</span>&nbsp;<span class="ident" id="3729301">nil</span>&nbsp;<span class="op" id="3729305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729309">return</span>&nbsp;<span class="ident" id="3729316">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3729324">ifat</span><span class="op" id="3729328">,</span>&nbsp;<span class="ident" id="3729330">err</span>&nbsp;<span class="op" id="3729334">:=</span>&nbsp;<span class="ident" id="3729337">ifi</span><span class="op" id="3729340">.</span><span class="ident" id="3729341">Addrs</span><span class="op" id="3729346">(</span><span class="op" id="3729347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729350">if</span>&nbsp;<span class="ident" id="3729353">err</span>&nbsp;<span class="op" id="3729357">!=</span>&nbsp;<span class="ident" id="3729360">nil</span>&nbsp;<span class="op" id="3729364">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729368">return</span>&nbsp;<span class="ident" id="3729375">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729383">for</span>&nbsp;<span class="ident" id="3729387">_</span><span class="op" id="3729388">,</span>&nbsp;<span class="ident" id="3729390">ifa</span>&nbsp;<span class="op" id="3729394">:=</span>&nbsp;<span class="keyword" id="3729397">range</span>&nbsp;<span class="ident" id="3729403">ifat</span>&nbsp;<span class="op" id="3729408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729412">switch</span>&nbsp;<span class="ident" id="3729419">v</span>&nbsp;<span class="op" id="3729421">:=</span>&nbsp;<span class="ident" id="3729424">ifa</span><span class="op" id="3729427">.</span><span class="op" id="3729428">(</span><span class="keyword" id="3729429">type</span><span class="op" id="3729433">)</span>&nbsp;<span class="op" id="3729435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729439">case</span>&nbsp;<span class="op" id="3729444">*</span><span class="ident" id="3729445">IPAddr</span><span class="op" id="3729451">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729456">if</span>&nbsp;<span class="ident" id="3729459">a</span>&nbsp;<span class="op" id="3729461">:=</span>&nbsp;<span class="ident" id="3729464">v</span><span class="op" id="3729465">.</span><span class="ident" id="3729466">IP</span><span class="op" id="3729468">.</span><span class="ident" id="3729469">To4</span><span class="op" id="3729472">(</span><span class="op" id="3729473">)</span><span class="op" id="3729474">;</span>&nbsp;<span class="ident" id="3729476">a</span>&nbsp;<span class="op" id="3729478">!=</span>&nbsp;<span class="ident" id="3729481">nil</span>&nbsp;<span class="op" id="3729485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3729491">copy</span><span class="op" id="3729495">(</span><span class="ident" id="3729496">mreq</span><span class="op" id="3729500">.</span><span class="ident" id="3729501">Interface</span><span class="op" id="3729510">[</span><span class="op" id="3729511">:</span><span class="op" id="3729512">]</span><span class="op" id="3729513">,</span>&nbsp;<span class="ident" id="3729515">a</span><span class="op" id="3729516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729522">goto</span>&nbsp;<span class="ident" id="3729527">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729539">case</span>&nbsp;<span class="op" id="3729544">*</span><span class="ident" id="3729545">IPNet</span><span class="op" id="3729550">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729555">if</span>&nbsp;<span class="ident" id="3729558">a</span>&nbsp;<span class="op" id="3729560">:=</span>&nbsp;<span class="ident" id="3729563">v</span><span class="op" id="3729564">.</span><span class="ident" id="3729565">IP</span><span class="op" id="3729567">.</span><span class="ident" id="3729568">To4</span><span class="op" id="3729571">(</span><span class="op" id="3729572">)</span><span class="op" id="3729573">;</span>&nbsp;<span class="ident" id="3729575">a</span>&nbsp;<span class="op" id="3729577">!=</span>&nbsp;<span class="ident" id="3729580">nil</span>&nbsp;<span class="op" id="3729584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3729590">copy</span><span class="op" id="3729594">(</span><span class="ident" id="3729595">mreq</span><span class="op" id="3729599">.</span><span class="ident" id="3729600">Interface</span><span class="op" id="3729609">[</span><span class="op" id="3729610">:</span><span class="op" id="3729611">]</span><span class="op" id="3729612">,</span>&nbsp;<span class="ident" id="3729614">a</span><span class="op" id="3729615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729621">goto</span>&nbsp;<span class="ident" id="3729626">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729638">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729641">}</span><br>
<span class="lineno"></span><span class="ident" id="3729643">done</span><span class="op" id="3729647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729650">if</span>&nbsp;<span class="ident" id="3729653">bytesEqual</span><span class="op" id="3729663">(</span><span class="ident" id="3729664">mreq</span><span class="op" id="3729668">.</span><span class="ident" id="3729669">Multiaddr</span><span class="op" id="3729678">[</span><span class="op" id="3729679">:</span><span class="op" id="3729680">]</span><span class="op" id="3729681">,</span>&nbsp;<span class="ident" id="3729683">IPv4zero</span><span class="op" id="3729691">.</span><span class="ident" id="3729692">To4</span><span class="op" id="3729695">(</span><span class="op" id="3729696">)</span><span class="op" id="3729697">)</span>&nbsp;<span class="op" id="3729699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729703">return</span>&nbsp;<span class="ident" id="3729710">errNoSuchMulticastInterface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729739">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729742">return</span>&nbsp;<span class="ident" id="3729749">nil</span><br>
<span class="lineno"></span><span class="op" id="3729753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3729756">func</span>&nbsp;<span class="ident" id="3729761">setReadBuffer</span><span class="op" id="3729774">(</span><span class="ident" id="3729775">fd</span>&nbsp;<span class="op" id="3729778">*</span><span class="ident" id="3729779">netFD</span><span class="op" id="3729784">,</span>&nbsp;<span class="ident" id="3729786">bytes</span>&nbsp;<span class="builtintype" id="3729792">int</span><span class="op" id="3729795">)</span>&nbsp;<span class="builtintype" id="3729797">error</span>&nbsp;<span class="op" id="3729803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729806">if</span>&nbsp;<span class="ident" id="3729809">err</span>&nbsp;<span class="op" id="3729813">:=</span>&nbsp;<span class="ident" id="3729816">fd</span><span class="op" id="3729818">.</span><span class="ident" id="3729819">incref</span><span class="op" id="3729825">(</span><span class="op" id="3729826">)</span><span class="op" id="3729827">;</span>&nbsp;<span class="ident" id="3729829">err</span>&nbsp;<span class="op" id="3729833">!=</span>&nbsp;<span class="ident" id="3729836">nil</span>&nbsp;<span class="op" id="3729840">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729844">return</span>&nbsp;<span class="ident" id="3729851">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3729856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729859">defer</span>&nbsp;<span class="ident" id="3729865">fd</span><span class="op" id="3729867">.</span><span class="ident" id="3729868">decref</span><span class="op" id="3729874">(</span><span class="op" id="3729875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3729878">return</span>&nbsp;<span class="ident" id="3729885">os</span><span class="op" id="3729887">.</span><span class="ident" id="3729888">NewSyscallError</span><span class="op" id="3729903">(</span><span class="string" id="3729904">&#34;setsockopt&#34;</span><span class="op" id="3729916">,</span>&nbsp;<span class="ident" id="3729918">syscall</span><span class="op" id="3729925">.</span><span class="ident" id="3729926">SetsockoptInt</span><span class="op" id="3729939">(</span><span class="ident" id="3729940">fd</span><span class="op" id="3729942">.</span><span class="ident" id="3729943">sysfd</span><span class="op" id="3729948">,</span>&nbsp;<span class="ident" id="3729950">syscall</span><span class="op" id="3729957">.</span><span class="ident" id="3729958">SOL_SOCKET</span><span class="op" id="3729968">,</span>&nbsp;<span class="ident" id="3729970">syscall</span><span class="op" id="3729977">.</span><span class="ident" id="3729978">SO_RCVBUF</span><span class="op" id="3729987">,</span>&nbsp;<span class="ident" id="3729989">bytes</span><span class="op" id="3729994">)</span><span class="op" id="3729995">)</span><br>
<span class="lineno"></span><span class="op" id="3729997">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="3730000">func</span>&nbsp;<span class="ident" id="3730005">setWriteBuffer</span><span class="op" id="3730019">(</span><span class="ident" id="3730020">fd</span>&nbsp;<span class="op" id="3730023">*</span><span class="ident" id="3730024">netFD</span><span class="op" id="3730029">,</span>&nbsp;<span class="ident" id="3730031">bytes</span>&nbsp;<span class="builtintype" id="3730037">int</span><span class="op" id="3730040">)</span>&nbsp;<span class="builtintype" id="3730042">error</span>&nbsp;<span class="op" id="3730048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730051">if</span>&nbsp;<span class="ident" id="3730054">err</span>&nbsp;<span class="op" id="3730058">:=</span>&nbsp;<span class="ident" id="3730061">fd</span><span class="op" id="3730063">.</span><span class="ident" id="3730064">incref</span><span class="op" id="3730070">(</span><span class="op" id="3730071">)</span><span class="op" id="3730072">;</span>&nbsp;<span class="ident" id="3730074">err</span>&nbsp;<span class="op" id="3730078">!=</span>&nbsp;<span class="ident" id="3730081">nil</span>&nbsp;<span class="op" id="3730085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730089">return</span>&nbsp;<span class="ident" id="3730096">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730101">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730104">defer</span>&nbsp;<span class="ident" id="3730110">fd</span><span class="op" id="3730112">.</span><span class="ident" id="3730113">decref</span><span class="op" id="3730119">(</span><span class="op" id="3730120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730123">return</span>&nbsp;<span class="ident" id="3730130">os</span><span class="op" id="3730132">.</span><span class="ident" id="3730133">NewSyscallError</span><span class="op" id="3730148">(</span><span class="string" id="3730149">&#34;setsockopt&#34;</span><span class="op" id="3730161">,</span>&nbsp;<span class="ident" id="3730163">syscall</span><span class="op" id="3730170">.</span><span class="ident" id="3730171">SetsockoptInt</span><span class="op" id="3730184">(</span><span class="ident" id="3730185">fd</span><span class="op" id="3730187">.</span><span class="ident" id="3730188">sysfd</span><span class="op" id="3730193">,</span>&nbsp;<span class="ident" id="3730195">syscall</span><span class="op" id="3730202">.</span><span class="ident" id="3730203">SOL_SOCKET</span><span class="op" id="3730213">,</span>&nbsp;<span class="ident" id="3730215">syscall</span><span class="op" id="3730222">.</span><span class="ident" id="3730223">SO_SNDBUF</span><span class="op" id="3730232">,</span>&nbsp;<span class="ident" id="3730234">bytes</span><span class="op" id="3730239">)</span><span class="op" id="3730240">)</span><br>
<span class="lineno"></span><span class="op" id="3730242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3730245">func</span>&nbsp;<span class="ident" id="3730250">setKeepAlive</span><span class="op" id="3730262">(</span><span class="ident" id="3730263">fd</span>&nbsp;<span class="op" id="3730266">*</span><span class="ident" id="3730267">netFD</span><span class="op" id="3730272">,</span>&nbsp;<span class="ident" id="3730274">keepalive</span>&nbsp;<span class="builtintype" id="3730284">bool</span><span class="op" id="3730288">)</span>&nbsp;<span class="builtintype" id="3730290">error</span>&nbsp;<span class="op" id="3730296">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730299">if</span>&nbsp;<span class="ident" id="3730302">err</span>&nbsp;<span class="op" id="3730306">:=</span>&nbsp;<span class="ident" id="3730309">fd</span><span class="op" id="3730311">.</span><span class="ident" id="3730312">incref</span><span class="op" id="3730318">(</span><span class="op" id="3730319">)</span><span class="op" id="3730320">;</span>&nbsp;<span class="ident" id="3730322">err</span>&nbsp;<span class="op" id="3730326">!=</span>&nbsp;<span class="ident" id="3730329">nil</span>&nbsp;<span class="op" id="3730333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730337">return</span>&nbsp;<span class="ident" id="3730344">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730352">defer</span>&nbsp;<span class="ident" id="3730358">fd</span><span class="op" id="3730360">.</span><span class="ident" id="3730361">decref</span><span class="op" id="3730367">(</span><span class="op" id="3730368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730371">return</span>&nbsp;<span class="ident" id="3730378">os</span><span class="op" id="3730380">.</span><span class="ident" id="3730381">NewSyscallError</span><span class="op" id="3730396">(</span><span class="string" id="3730397">&#34;setsockopt&#34;</span><span class="op" id="3730409">,</span>&nbsp;<span class="ident" id="3730411">syscall</span><span class="op" id="3730418">.</span><span class="ident" id="3730419">SetsockoptInt</span><span class="op" id="3730432">(</span><span class="ident" id="3730433">fd</span><span class="op" id="3730435">.</span><span class="ident" id="3730436">sysfd</span><span class="op" id="3730441">,</span>&nbsp;<span class="ident" id="3730443">syscall</span><span class="op" id="3730450">.</span><span class="ident" id="3730451">SOL_SOCKET</span><span class="op" id="3730461">,</span>&nbsp;<span class="ident" id="3730463">syscall</span><span class="op" id="3730470">.</span><span class="ident" id="3730471">SO_KEEPALIVE</span><span class="op" id="3730483">,</span>&nbsp;<span class="ident" id="3730485">boolint</span><span class="op" id="3730492">(</span><span class="ident" id="3730493">keepalive</span><span class="op" id="3730502">)</span><span class="op" id="3730503">)</span><span class="op" id="3730504">)</span><br>
<span class="lineno">125</span><span class="op" id="3730506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3730509">func</span>&nbsp;<span class="ident" id="3730514">setLinger</span><span class="op" id="3730523">(</span><span class="ident" id="3730524">fd</span>&nbsp;<span class="op" id="3730527">*</span><span class="ident" id="3730528">netFD</span><span class="op" id="3730533">,</span>&nbsp;<span class="ident" id="3730535">sec</span>&nbsp;<span class="builtintype" id="3730539">int</span><span class="op" id="3730542">)</span>&nbsp;<span class="builtintype" id="3730544">error</span>&nbsp;<span class="op" id="3730550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730553">var</span>&nbsp;<span class="ident" id="3730557">l</span>&nbsp;<span class="ident" id="3730559">syscall</span><span class="op" id="3730566">.</span><span class="ident" id="3730567">Linger</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730575">if</span>&nbsp;<span class="ident" id="3730578">sec</span>&nbsp;<span class="op" id="3730582">&gt;=</span>&nbsp;<span class="num" id="3730585">0</span>&nbsp;<span class="op" id="3730587">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730591">l</span><span class="op" id="3730592">.</span><span class="ident" id="3730593">Onoff</span>&nbsp;<span class="op" id="3730599">=</span>&nbsp;<span class="num" id="3730601">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730605">l</span><span class="op" id="3730606">.</span><span class="ident" id="3730607">Linger</span>&nbsp;<span class="op" id="3730614">=</span>&nbsp;<span class="builtintype" id="3730616">int32</span><span class="op" id="3730621">(</span><span class="ident" id="3730622">sec</span><span class="op" id="3730625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730628">}</span>&nbsp;<span class="keyword" id="3730630">else</span>&nbsp;<span class="op" id="3730635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730639">l</span><span class="op" id="3730640">.</span><span class="ident" id="3730641">Onoff</span>&nbsp;<span class="op" id="3730647">=</span>&nbsp;<span class="num" id="3730649">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3730653">l</span><span class="op" id="3730654">.</span><span class="ident" id="3730655">Linger</span>&nbsp;<span class="op" id="3730662">=</span>&nbsp;<span class="num" id="3730664">0</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730670">if</span>&nbsp;<span class="ident" id="3730673">err</span>&nbsp;<span class="op" id="3730677">:=</span>&nbsp;<span class="ident" id="3730680">fd</span><span class="op" id="3730682">.</span><span class="ident" id="3730683">incref</span><span class="op" id="3730689">(</span><span class="op" id="3730690">)</span><span class="op" id="3730691">;</span>&nbsp;<span class="ident" id="3730693">err</span>&nbsp;<span class="op" id="3730697">!=</span>&nbsp;<span class="ident" id="3730700">nil</span>&nbsp;<span class="op" id="3730704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730708">return</span>&nbsp;<span class="ident" id="3730715">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3730720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730723">defer</span>&nbsp;<span class="ident" id="3730729">fd</span><span class="op" id="3730731">.</span><span class="ident" id="3730732">decref</span><span class="op" id="3730738">(</span><span class="op" id="3730739">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3730742">return</span>&nbsp;<span class="ident" id="3730749">os</span><span class="op" id="3730751">.</span><span class="ident" id="3730752">NewSyscallError</span><span class="op" id="3730767">(</span><span class="string" id="3730768">&#34;setsockopt&#34;</span><span class="op" id="3730780">,</span>&nbsp;<span class="ident" id="3730782">syscall</span><span class="op" id="3730789">.</span><span class="ident" id="3730790">SetsockoptLinger</span><span class="op" id="3730806">(</span><span class="ident" id="3730807">fd</span><span class="op" id="3730809">.</span><span class="ident" id="3730810">sysfd</span><span class="op" id="3730815">,</span>&nbsp;<span class="ident" id="3730817">syscall</span><span class="op" id="3730824">.</span><span class="ident" id="3730825">SOL_SOCKET</span><span class="op" id="3730835">,</span>&nbsp;<span class="ident" id="3730837">syscall</span><span class="op" id="3730844">.</span><span class="ident" id="3730845">SO_LINGER</span><span class="op" id="3730854">,</span>&nbsp;<span class="op" id="3730856">&amp;</span><span class="ident" id="3730857">l</span><span class="op" id="3730858">)</span><span class="op" id="3730859">)</span><br>
<span class="lineno"></span><span class="op" id="3730861">}</span>
</div>
</body>
</html>
