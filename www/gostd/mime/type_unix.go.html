<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html" class="current">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3448434">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3448489">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3448543">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3448594">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3448664">package</span>&nbsp;<span class="ident" id="3448672">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3448678">import</span>&nbsp;<span class="op" id="3448685">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3448688">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3448697">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3448703">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3448713">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3448716">var</span>&nbsp;<span class="ident" id="3448720">typeFiles</span>&nbsp;<span class="op" id="3448730">=</span>&nbsp;<span class="op" id="3448732">[</span><span class="op" id="3448733">]</span><span class="builtintype" id="3448734">string</span><span class="op" id="3448740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3448743">&#34;/etc/mime.types&#34;</span><span class="op" id="3448760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3448763">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3448788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3448791">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3448815">,</span><br>
<span class="lineno"></span><span class="op" id="3448817">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3448820">func</span>&nbsp;<span class="ident" id="3448825">loadMimeFile</span><span class="op" id="3448837">(</span><span class="ident" id="3448838">filename</span>&nbsp;<span class="builtintype" id="3448847">string</span><span class="op" id="3448853">)</span>&nbsp;<span class="op" id="3448855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448858">f</span><span class="op" id="3448859">,</span>&nbsp;<span class="ident" id="3448861">err</span>&nbsp;<span class="op" id="3448865">:=</span>&nbsp;<span class="ident" id="3448868">os</span><span class="op" id="3448870">.</span><span class="ident" id="3448871">Open</span><span class="op" id="3448875">(</span><span class="ident" id="3448876">filename</span><span class="op" id="3448884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448887">if</span>&nbsp;<span class="ident" id="3448890">err</span>&nbsp;<span class="op" id="3448894">!=</span>&nbsp;<span class="builtintype" id="3448897">nil</span>&nbsp;<span class="op" id="3448901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448905">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3448913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448916">defer</span>&nbsp;<span class="ident" id="3448922">f</span><span class="op" id="3448923">.</span><span class="ident" id="3448924">Close</span><span class="op" id="3448929">(</span><span class="op" id="3448930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448934">scanner</span>&nbsp;<span class="op" id="3448942">:=</span>&nbsp;<span class="ident" id="3448945">bufio</span><span class="op" id="3448950">.</span><span class="ident" id="3448951">NewScanner</span><span class="op" id="3448961">(</span><span class="ident" id="3448962">f</span><span class="op" id="3448963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3448966">for</span>&nbsp;<span class="ident" id="3448970">scanner</span><span class="op" id="3448977">.</span><span class="ident" id="3448978">Scan</span><span class="op" id="3448982">(</span><span class="op" id="3448983">)</span>&nbsp;<span class="op" id="3448985">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448989">fields</span>&nbsp;<span class="op" id="3448996">:=</span>&nbsp;<span class="ident" id="3448999">strings</span><span class="op" id="3449006">.</span><span class="ident" id="3449007">Fields</span><span class="op" id="3449013">(</span><span class="ident" id="3449014">scanner</span><span class="op" id="3449021">.</span><span class="ident" id="3449022">Text</span><span class="op" id="3449026">(</span><span class="op" id="3449027">)</span><span class="op" id="3449028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449032">if</span>&nbsp;<span class="builtinfunc" id="3449035">len</span><span class="op" id="3449038">(</span><span class="ident" id="3449039">fields</span><span class="op" id="3449045">)</span>&nbsp;<span class="op" id="3449047">&lt;=</span>&nbsp;<span class="num" id="3449050">1</span>&nbsp;<span class="op" id="3449052">||</span>&nbsp;<span class="ident" id="3449055">fields</span><span class="op" id="3449061">[</span><span class="num" id="3449062">0</span><span class="op" id="3449063">]</span><span class="op" id="3449064">[</span><span class="num" id="3449065">0</span><span class="op" id="3449066">]</span>&nbsp;<span class="op" id="3449068">==</span>&nbsp;<span class="string" id="3449071">&#39;#&#39;</span>&nbsp;<span class="op" id="3449075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449080">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449095">mimeType</span>&nbsp;<span class="op" id="3449104">:=</span>&nbsp;<span class="ident" id="3449107">fields</span><span class="op" id="3449113">[</span><span class="num" id="3449114">0</span><span class="op" id="3449115">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449119">for</span>&nbsp;<span class="ident" id="3449123">_</span><span class="op" id="3449124">,</span>&nbsp;<span class="ident" id="3449126">ext</span>&nbsp;<span class="op" id="3449130">:=</span>&nbsp;<span class="keyword" id="3449133">range</span>&nbsp;<span class="ident" id="3449139">fields</span><span class="op" id="3449145">[</span><span class="num" id="3449146">1</span><span class="op" id="3449147">:</span><span class="op" id="3449148">]</span>&nbsp;<span class="op" id="3449150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449155">if</span>&nbsp;<span class="ident" id="3449158">ext</span><span class="op" id="3449161">[</span><span class="num" id="3449162">0</span><span class="op" id="3449163">]</span>&nbsp;<span class="op" id="3449165">==</span>&nbsp;<span class="string" id="3449168">&#39;#&#39;</span>&nbsp;<span class="op" id="3449172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449178">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449192">setExtensionType</span><span class="op" id="3449208">(</span><span class="string" id="3449209">&#34;.&#34;</span><span class="op" id="3449212">+</span><span class="ident" id="3449213">ext</span><span class="op" id="3449216">,</span>&nbsp;<span class="ident" id="3449218">mimeType</span><span class="op" id="3449226">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449236">if</span>&nbsp;<span class="ident" id="3449239">err</span>&nbsp;<span class="op" id="3449243">:=</span>&nbsp;<span class="ident" id="3449246">scanner</span><span class="op" id="3449253">.</span><span class="ident" id="3449254">Err</span><span class="op" id="3449257">(</span><span class="op" id="3449258">)</span><span class="op" id="3449259">;</span>&nbsp;<span class="ident" id="3449261">err</span>&nbsp;<span class="op" id="3449265">!=</span>&nbsp;<span class="builtintype" id="3449268">nil</span>&nbsp;<span class="op" id="3449272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3449276">panic</span><span class="op" id="3449281">(</span><span class="ident" id="3449282">err</span><span class="op" id="3449285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449288">}</span><br>
<span class="lineno">45</span><span class="op" id="3449290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3449293">func</span>&nbsp;<span class="ident" id="3449298">initMime</span><span class="op" id="3449306">(</span><span class="op" id="3449307">)</span>&nbsp;<span class="op" id="3449309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449312">for</span>&nbsp;<span class="ident" id="3449316">_</span><span class="op" id="3449317">,</span>&nbsp;<span class="ident" id="3449319">filename</span>&nbsp;<span class="op" id="3449328">:=</span>&nbsp;<span class="keyword" id="3449331">range</span>&nbsp;<span class="ident" id="3449337">typeFiles</span>&nbsp;<span class="op" id="3449347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449351">loadMimeFile</span><span class="op" id="3449363">(</span><span class="ident" id="3449364">filename</span><span class="op" id="3449372">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449375">}</span><br>
<span class="lineno"></span><span class="op" id="3449377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3449380">func</span>&nbsp;<span class="ident" id="3449385">initMimeForTests</span><span class="op" id="3449401">(</span><span class="op" id="3449402">)</span>&nbsp;<span class="keyword" id="3449404">map</span><span class="op" id="3449407">[</span><span class="builtintype" id="3449408">string</span><span class="op" id="3449414">]</span><span class="builtintype" id="3449415">string</span>&nbsp;<span class="op" id="3449422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3449425">typeFiles</span>&nbsp;<span class="op" id="3449435">=</span>&nbsp;<span class="op" id="3449437">[</span><span class="op" id="3449438">]</span><span class="builtintype" id="3449439">string</span><span class="op" id="3449445">{</span><span class="string" id="3449446">&#34;testdata/test.types&#34;</span><span class="op" id="3449467">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3449470">return</span>&nbsp;<span class="keyword" id="3449477">map</span><span class="op" id="3449480">[</span><span class="builtintype" id="3449481">string</span><span class="op" id="3449487">]</span><span class="builtintype" id="3449488">string</span><span class="op" id="3449494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3449498">&#34;.T1&#34;</span><span class="op" id="3449503">:</span>&nbsp;&nbsp;<span class="string" id="3449506">&#34;application/test&#34;</span><span class="op" id="3449524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3449528">&#34;.t2&#34;</span><span class="op" id="3449533">:</span>&nbsp;&nbsp;<span class="string" id="3449536">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3449562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3449566">&#34;.png&#34;</span><span class="op" id="3449572">:</span>&nbsp;<span class="string" id="3449574">&#34;image/png&#34;</span><span class="op" id="3449585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3449588">}</span><br>
<span class="lineno">60</span><span class="op" id="3449590">}</span>
</div>
</body>
</html>
