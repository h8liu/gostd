<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2785740">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2785795">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2785849">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2785900">package</span>&nbsp;<span class="ident" id="2785908">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2785914">import</span>&nbsp;<span class="op" id="2785921">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2785924">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2785932">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2785942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2785945">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2786011">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2786080">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2786155">type</span>&nbsp;<span class="ident" id="2786160">Location</span>&nbsp;<span class="keyword" id="2786169">struct</span>&nbsp;<span class="op" id="2786176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786179">name</span>&nbsp;<span class="builtintype" id="2786184">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786192">zone</span>&nbsp;<span class="op" id="2786197">[</span><span class="op" id="2786198">]</span><span class="ident" id="2786199">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786205">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2786210">[</span><span class="op" id="2786211">]</span><span class="ident" id="2786212">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786224">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786271">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786321">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786373">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786426">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786462">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786495">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786549">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2786602">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786617">cacheStart</span>&nbsp;<span class="ident" id="2786628">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786635">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2786646">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786653">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2786664">*</span><span class="ident" id="2786665">zone</span><br>
<span class="lineno"></span><span class="op" id="2786670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2786673">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2786734">type</span>&nbsp;<span class="ident" id="2786739">zone</span>&nbsp;<span class="keyword" id="2786744">struct</span>&nbsp;<span class="op" id="2786751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786754">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2786761">string</span>&nbsp;<span class="comment" id="2786768">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786796">offset</span>&nbsp;<span class="builtintype" id="2786803">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2786810">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786834">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2786841">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2786848">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2786887">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2786890">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2786947">type</span>&nbsp;<span class="ident" id="2786952">zoneTrans</span>&nbsp;<span class="keyword" id="2786962">struct</span>&nbsp;<span class="op" id="2786969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2786972">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2786985">int64</span>&nbsp;<span class="comment" id="2786991">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787038">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2787051">uint8</span>&nbsp;<span class="comment" id="2787057">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787118">isstd</span><span class="op" id="2787123">,</span>&nbsp;<span class="ident" id="2787125">isutc</span>&nbsp;<span class="builtintype" id="2787131">bool</span>&nbsp;&nbsp;<span class="comment" id="2787137">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2787174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787177">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2787239">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2787255">const</span>&nbsp;<span class="op" id="2787261">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787264">alpha</span>&nbsp;<span class="op" id="2787270">=</span>&nbsp;<span class="op" id="2787272">-</span><span class="num" id="2787273">1</span>&nbsp;<span class="op" id="2787275">&lt;&lt;</span>&nbsp;<span class="num" id="2787278">63</span>&nbsp;&nbsp;<span class="comment" id="2787282">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787300">omega</span>&nbsp;<span class="op" id="2787306">=</span>&nbsp;<span class="num" id="2787308">1</span><span class="op" id="2787309">&lt;&lt;</span><span class="num" id="2787311">63</span>&nbsp;<span class="op" id="2787314">-</span>&nbsp;<span class="num" id="2787316">1</span>&nbsp;<span class="comment" id="2787318">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2787335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2787338">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2787390">var</span>&nbsp;<span class="ident" id="2787394">UTC</span>&nbsp;<span class="op" id="2787398">*</span><span class="ident" id="2787399">Location</span>&nbsp;<span class="op" id="2787408">=</span>&nbsp;<span class="op" id="2787410">&amp;</span><span class="ident" id="2787411">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787419">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2787474">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2787527">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2787578">var</span>&nbsp;<span class="ident" id="2787582">utcLoc</span>&nbsp;<span class="op" id="2787589">=</span>&nbsp;<span class="ident" id="2787591">Location</span><span class="op" id="2787599">{</span><span class="ident" id="2787600">name</span><span class="op" id="2787604">:</span>&nbsp;<span class="string" id="2787606">&#34;UTC&#34;</span><span class="op" id="2787611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2787614">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2787664">var</span>&nbsp;<span class="ident" id="2787668">Local</span>&nbsp;<span class="op" id="2787674">*</span><span class="ident" id="2787675">Location</span>&nbsp;<span class="op" id="2787684">=</span>&nbsp;<span class="op" id="2787686">&amp;</span><span class="ident" id="2787687">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2787697">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2787754">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2787796">var</span>&nbsp;<span class="ident" id="2787800">localLoc</span>&nbsp;<span class="ident" id="2787809">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2787818">var</span>&nbsp;<span class="ident" id="2787822">localOnce</span>&nbsp;<span class="ident" id="2787832">sync</span><span class="op" id="2787836">.</span><span class="ident" id="2787837">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2787843">func</span>&nbsp;<span class="op" id="2787848">(</span><span class="ident" id="2787849">l</span>&nbsp;<span class="op" id="2787851">*</span><span class="ident" id="2787852">Location</span><span class="op" id="2787860">)</span>&nbsp;<span class="ident" id="2787862">get</span><span class="op" id="2787865">(</span><span class="op" id="2787866">)</span>&nbsp;<span class="op" id="2787868">*</span><span class="ident" id="2787869">Location</span>&nbsp;<span class="op" id="2787878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787881">if</span>&nbsp;<span class="ident" id="2787884">l</span>&nbsp;<span class="op" id="2787886">==</span>&nbsp;<span class="ident" id="2787889">nil</span>&nbsp;<span class="op" id="2787893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787897">return</span>&nbsp;<span class="op" id="2787904">&amp;</span><span class="ident" id="2787905">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787913">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787916">if</span>&nbsp;<span class="ident" id="2787919">l</span>&nbsp;<span class="op" id="2787921">==</span>&nbsp;<span class="op" id="2787924">&amp;</span><span class="ident" id="2787925">localLoc</span>&nbsp;<span class="op" id="2787934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2787938">localOnce</span><span class="op" id="2787947">.</span><span class="ident" id="2787948">Do</span><span class="op" id="2787950">(</span><span class="ident" id="2787951">initLocal</span><span class="op" id="2787960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2787963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2787966">return</span>&nbsp;<span class="ident" id="2787973">l</span><br>
<span class="lineno"></span><span class="op" id="2787975">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2787978">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2788046">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2788096">func</span>&nbsp;<span class="op" id="2788101">(</span><span class="ident" id="2788102">l</span>&nbsp;<span class="op" id="2788104">*</span><span class="ident" id="2788105">Location</span><span class="op" id="2788113">)</span>&nbsp;<span class="ident" id="2788115">String</span><span class="op" id="2788121">(</span><span class="op" id="2788122">)</span>&nbsp;<span class="builtintype" id="2788124">string</span>&nbsp;<span class="op" id="2788131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788134">return</span>&nbsp;<span class="ident" id="2788141">l</span><span class="op" id="2788142">.</span><span class="ident" id="2788143">get</span><span class="op" id="2788146">(</span><span class="op" id="2788147">)</span><span class="op" id="2788148">.</span><span class="ident" id="2788149">name</span><br>
<span class="lineno">85</span><span class="op" id="2788154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2788157">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2788206">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2788263">func</span>&nbsp;<span class="ident" id="2788268">FixedZone</span><span class="op" id="2788277">(</span><span class="ident" id="2788278">name</span>&nbsp;<span class="builtintype" id="2788283">string</span><span class="op" id="2788289">,</span>&nbsp;<span class="ident" id="2788291">offset</span>&nbsp;<span class="builtintype" id="2788298">int</span><span class="op" id="2788301">)</span>&nbsp;<span class="op" id="2788303">*</span><span class="ident" id="2788304">Location</span>&nbsp;<span class="op" id="2788313">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788316">l</span>&nbsp;<span class="op" id="2788318">:=</span>&nbsp;<span class="op" id="2788321">&amp;</span><span class="ident" id="2788322">Location</span><span class="op" id="2788330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788334">name</span><span class="op" id="2788338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2788346">name</span><span class="op" id="2788350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788354">zone</span><span class="op" id="2788358">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788366">[</span><span class="op" id="2788367">]</span><span class="ident" id="2788368">zone</span><span class="op" id="2788372">{</span><span class="op" id="2788373">{</span><span class="ident" id="2788374">name</span><span class="op" id="2788378">,</span>&nbsp;<span class="ident" id="2788380">offset</span><span class="op" id="2788386">,</span>&nbsp;<span class="builtintype" id="2788388">false</span><span class="op" id="2788393">}</span><span class="op" id="2788394">}</span><span class="op" id="2788395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788399">tx</span><span class="op" id="2788401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2788411">[</span><span class="op" id="2788412">]</span><span class="ident" id="2788413">zoneTrans</span><span class="op" id="2788422">{</span><span class="op" id="2788423">{</span><span class="ident" id="2788424">alpha</span><span class="op" id="2788429">,</span>&nbsp;<span class="num" id="2788431">0</span><span class="op" id="2788432">,</span>&nbsp;<span class="builtintype" id="2788434">false</span><span class="op" id="2788439">,</span>&nbsp;<span class="builtintype" id="2788441">false</span><span class="op" id="2788446">}</span><span class="op" id="2788447">}</span><span class="op" id="2788448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788452">cacheStart</span><span class="op" id="2788462">:</span>&nbsp;<span class="ident" id="2788464">alpha</span><span class="op" id="2788469">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788473">cacheEnd</span><span class="op" id="2788481">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2788485">omega</span><span class="op" id="2788490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2788493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2788496">l</span><span class="op" id="2788497">.</span><span class="ident" id="2788498">cacheZone</span>&nbsp;<span class="op" id="2788508">=</span>&nbsp;<span class="op" id="2788510">&amp;</span><span class="ident" id="2788511">l</span><span class="op" id="2788512">.</span><span class="ident" id="2788513">zone</span><span class="op" id="2788517">[</span><span class="num" id="2788518">0</span><span class="op" id="2788519">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2788522">return</span>&nbsp;<span class="ident" id="2788529">l</span><br>
<span class="lineno"></span><span class="op" id="2788531">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2788534">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2788597">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2788673">//</span><br>
<span class="lineno"></span><span class="comment" id="2788676">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2788748">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2788819">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2788888">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2788944">func</span>&nbsp;<span class="op" id="2788949">(</span><span class="ident" id="2788950">l</span>&nbsp;<span class="op" id="2788952">*</span><span class="ident" id="2788953">Location</span><span class="op" id="2788961">)</span>&nbsp;<span class="ident" id="2788963">lookup</span><span class="op" id="2788969">(</span><span class="ident" id="2788970">sec</span>&nbsp;<span class="ident" id="2788974">int64</span><span class="op" id="2788979">)</span>&nbsp;<span class="op" id="2788981">(</span><span class="ident" id="2788982">name</span>&nbsp;<span class="builtintype" id="2788987">string</span><span class="op" id="2788993">,</span>&nbsp;<span class="ident" id="2788995">offset</span>&nbsp;<span class="builtintype" id="2789002">int</span><span class="op" id="2789005">,</span>&nbsp;<span class="ident" id="2789007">isDST</span>&nbsp;<span class="builtintype" id="2789013">bool</span><span class="op" id="2789017">,</span>&nbsp;<span class="ident" id="2789019">start</span><span class="op" id="2789024">,</span>&nbsp;<span class="ident" id="2789026">end</span>&nbsp;<span class="ident" id="2789030">int64</span><span class="op" id="2789035">)</span>&nbsp;<span class="op" id="2789037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789040">l</span>&nbsp;<span class="op" id="2789042">=</span>&nbsp;<span class="ident" id="2789044">l</span><span class="op" id="2789045">.</span><span class="ident" id="2789046">get</span><span class="op" id="2789049">(</span><span class="op" id="2789050">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789054">if</span>&nbsp;<span class="builtinfunc" id="2789057">len</span><span class="op" id="2789060">(</span><span class="ident" id="2789061">l</span><span class="op" id="2789062">.</span><span class="ident" id="2789063">zone</span><span class="op" id="2789067">)</span>&nbsp;<span class="op" id="2789069">==</span>&nbsp;<span class="num" id="2789072">0</span>&nbsp;<span class="op" id="2789074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789078">name</span>&nbsp;<span class="op" id="2789083">=</span>&nbsp;<span class="string" id="2789085">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789093">offset</span>&nbsp;<span class="op" id="2789100">=</span>&nbsp;<span class="num" id="2789102">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789106">isDST</span>&nbsp;<span class="op" id="2789112">=</span>&nbsp;<span class="builtintype" id="2789114">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789122">start</span>&nbsp;<span class="op" id="2789128">=</span>&nbsp;<span class="ident" id="2789130">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789138">end</span>&nbsp;<span class="op" id="2789142">=</span>&nbsp;<span class="ident" id="2789144">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789152">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789164">if</span>&nbsp;<span class="ident" id="2789167">zone</span>&nbsp;<span class="op" id="2789172">:=</span>&nbsp;<span class="ident" id="2789175">l</span><span class="op" id="2789176">.</span><span class="ident" id="2789177">cacheZone</span><span class="op" id="2789186">;</span>&nbsp;<span class="ident" id="2789188">zone</span>&nbsp;<span class="op" id="2789193">!=</span>&nbsp;<span class="ident" id="2789196">nil</span>&nbsp;<span class="op" id="2789200">&amp;&amp;</span>&nbsp;<span class="ident" id="2789203">l</span><span class="op" id="2789204">.</span><span class="ident" id="2789205">cacheStart</span>&nbsp;<span class="op" id="2789216">&lt;=</span>&nbsp;<span class="ident" id="2789219">sec</span>&nbsp;<span class="op" id="2789223">&amp;&amp;</span>&nbsp;<span class="ident" id="2789226">sec</span>&nbsp;<span class="op" id="2789230">&lt;</span>&nbsp;<span class="ident" id="2789232">l</span><span class="op" id="2789233">.</span><span class="ident" id="2789234">cacheEnd</span>&nbsp;<span class="op" id="2789243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789247">name</span>&nbsp;<span class="op" id="2789252">=</span>&nbsp;<span class="ident" id="2789254">zone</span><span class="op" id="2789258">.</span><span class="ident" id="2789259">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789266">offset</span>&nbsp;<span class="op" id="2789273">=</span>&nbsp;<span class="ident" id="2789275">zone</span><span class="op" id="2789279">.</span><span class="ident" id="2789280">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789289">isDST</span>&nbsp;<span class="op" id="2789295">=</span>&nbsp;<span class="ident" id="2789297">zone</span><span class="op" id="2789301">.</span><span class="ident" id="2789302">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789310">start</span>&nbsp;<span class="op" id="2789316">=</span>&nbsp;<span class="ident" id="2789318">l</span><span class="op" id="2789319">.</span><span class="ident" id="2789320">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789333">end</span>&nbsp;<span class="op" id="2789337">=</span>&nbsp;<span class="ident" id="2789339">l</span><span class="op" id="2789340">.</span><span class="ident" id="2789341">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789352">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789364">if</span>&nbsp;<span class="builtinfunc" id="2789367">len</span><span class="op" id="2789370">(</span><span class="ident" id="2789371">l</span><span class="op" id="2789372">.</span><span class="ident" id="2789373">tx</span><span class="op" id="2789375">)</span>&nbsp;<span class="op" id="2789377">==</span>&nbsp;<span class="num" id="2789380">0</span>&nbsp;<span class="op" id="2789382">||</span>&nbsp;<span class="ident" id="2789385">sec</span>&nbsp;<span class="op" id="2789389">&lt;</span>&nbsp;<span class="ident" id="2789391">l</span><span class="op" id="2789392">.</span><span class="ident" id="2789393">tx</span><span class="op" id="2789395">[</span><span class="num" id="2789396">0</span><span class="op" id="2789397">]</span><span class="op" id="2789398">.</span><span class="ident" id="2789399">when</span>&nbsp;<span class="op" id="2789404">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789408">zone</span>&nbsp;<span class="op" id="2789413">:=</span>&nbsp;<span class="op" id="2789416">&amp;</span><span class="ident" id="2789417">l</span><span class="op" id="2789418">.</span><span class="ident" id="2789419">zone</span><span class="op" id="2789423">[</span><span class="ident" id="2789424">l</span><span class="op" id="2789425">.</span><span class="ident" id="2789426">lookupFirstZone</span><span class="op" id="2789441">(</span><span class="op" id="2789442">)</span><span class="op" id="2789443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789447">name</span>&nbsp;<span class="op" id="2789452">=</span>&nbsp;<span class="ident" id="2789454">zone</span><span class="op" id="2789458">.</span><span class="ident" id="2789459">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789466">offset</span>&nbsp;<span class="op" id="2789473">=</span>&nbsp;<span class="ident" id="2789475">zone</span><span class="op" id="2789479">.</span><span class="ident" id="2789480">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789489">isDST</span>&nbsp;<span class="op" id="2789495">=</span>&nbsp;<span class="ident" id="2789497">zone</span><span class="op" id="2789501">.</span><span class="ident" id="2789502">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789510">start</span>&nbsp;<span class="op" id="2789516">=</span>&nbsp;<span class="ident" id="2789518">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789526">if</span>&nbsp;<span class="builtinfunc" id="2789529">len</span><span class="op" id="2789532">(</span><span class="ident" id="2789533">l</span><span class="op" id="2789534">.</span><span class="ident" id="2789535">tx</span><span class="op" id="2789537">)</span>&nbsp;<span class="op" id="2789539">&gt;</span>&nbsp;<span class="num" id="2789541">0</span>&nbsp;<span class="op" id="2789543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789548">end</span>&nbsp;<span class="op" id="2789552">=</span>&nbsp;<span class="ident" id="2789554">l</span><span class="op" id="2789555">.</span><span class="ident" id="2789556">tx</span><span class="op" id="2789558">[</span><span class="num" id="2789559">0</span><span class="op" id="2789560">]</span><span class="op" id="2789561">.</span><span class="ident" id="2789562">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789569">}</span>&nbsp;<span class="keyword" id="2789571">else</span>&nbsp;<span class="op" id="2789576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789581">end</span>&nbsp;<span class="op" id="2789585">=</span>&nbsp;<span class="ident" id="2789587">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789595">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2789611">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2789665">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789714">tx</span>&nbsp;<span class="op" id="2789717">:=</span>&nbsp;<span class="ident" id="2789720">l</span><span class="op" id="2789721">.</span><span class="ident" id="2789722">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789726">end</span>&nbsp;<span class="op" id="2789730">=</span>&nbsp;<span class="ident" id="2789732">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789739">lo</span>&nbsp;<span class="op" id="2789742">:=</span>&nbsp;<span class="num" id="2789745">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789748">hi</span>&nbsp;<span class="op" id="2789751">:=</span>&nbsp;<span class="builtinfunc" id="2789754">len</span><span class="op" id="2789757">(</span><span class="ident" id="2789758">tx</span><span class="op" id="2789760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789763">for</span>&nbsp;<span class="ident" id="2789767">hi</span><span class="op" id="2789769">-</span><span class="ident" id="2789770">lo</span>&nbsp;<span class="op" id="2789773">&gt;</span>&nbsp;<span class="num" id="2789775">1</span>&nbsp;<span class="op" id="2789777">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789781">m</span>&nbsp;<span class="op" id="2789783">:=</span>&nbsp;<span class="ident" id="2789786">lo</span>&nbsp;<span class="op" id="2789789">+</span>&nbsp;<span class="op" id="2789791">(</span><span class="ident" id="2789792">hi</span><span class="op" id="2789794">-</span><span class="ident" id="2789795">lo</span><span class="op" id="2789797">)</span><span class="op" id="2789798">/</span><span class="num" id="2789799">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789803">lim</span>&nbsp;<span class="op" id="2789807">:=</span>&nbsp;<span class="ident" id="2789810">tx</span><span class="op" id="2789812">[</span><span class="ident" id="2789813">m</span><span class="op" id="2789814">]</span><span class="op" id="2789815">.</span><span class="ident" id="2789816">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2789823">if</span>&nbsp;<span class="ident" id="2789826">sec</span>&nbsp;<span class="op" id="2789830">&lt;</span>&nbsp;<span class="ident" id="2789832">lim</span>&nbsp;<span class="op" id="2789836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789841">end</span>&nbsp;<span class="op" id="2789845">=</span>&nbsp;<span class="ident" id="2789847">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789854">hi</span>&nbsp;<span class="op" id="2789857">=</span>&nbsp;<span class="ident" id="2789859">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789863">}</span>&nbsp;<span class="keyword" id="2789865">else</span>&nbsp;<span class="op" id="2789870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789875">lo</span>&nbsp;<span class="op" id="2789878">=</span>&nbsp;<span class="ident" id="2789880">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2789887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789890">zone</span>&nbsp;<span class="op" id="2789895">:=</span>&nbsp;<span class="op" id="2789898">&amp;</span><span class="ident" id="2789899">l</span><span class="op" id="2789900">.</span><span class="ident" id="2789901">zone</span><span class="op" id="2789905">[</span><span class="ident" id="2789906">tx</span><span class="op" id="2789908">[</span><span class="ident" id="2789909">lo</span><span class="op" id="2789911">]</span><span class="op" id="2789912">.</span><span class="ident" id="2789913">index</span><span class="op" id="2789918">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789921">name</span>&nbsp;<span class="op" id="2789926">=</span>&nbsp;<span class="ident" id="2789928">zone</span><span class="op" id="2789932">.</span><span class="ident" id="2789933">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789939">offset</span>&nbsp;<span class="op" id="2789946">=</span>&nbsp;<span class="ident" id="2789948">zone</span><span class="op" id="2789952">.</span><span class="ident" id="2789953">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789961">isDST</span>&nbsp;<span class="op" id="2789967">=</span>&nbsp;<span class="ident" id="2789969">zone</span><span class="op" id="2789973">.</span><span class="ident" id="2789974">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2789981">start</span>&nbsp;<span class="op" id="2789987">=</span>&nbsp;<span class="ident" id="2789989">tx</span><span class="op" id="2789991">[</span><span class="ident" id="2789992">lo</span><span class="op" id="2789994">]</span><span class="op" id="2789995">.</span><span class="ident" id="2789996">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790002">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790041">return</span><br>
<span class="lineno"></span><span class="op" id="2790048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2790051">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2790122">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2790191">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2790201">//</span><br>
<span class="lineno"></span><span class="comment" id="2790204">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2790256">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2790329">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2790384">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2790446">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2790508">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2790571">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2790643">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2790655">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2790721">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2790741">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2790778">func</span>&nbsp;<span class="op" id="2790783">(</span><span class="ident" id="2790784">l</span>&nbsp;<span class="op" id="2790786">*</span><span class="ident" id="2790787">Location</span><span class="op" id="2790795">)</span>&nbsp;<span class="ident" id="2790797">lookupFirstZone</span><span class="op" id="2790812">(</span><span class="op" id="2790813">)</span>&nbsp;<span class="builtintype" id="2790815">int</span>&nbsp;<span class="op" id="2790819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790822">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790834">if</span>&nbsp;<span class="op" id="2790837">!</span><span class="ident" id="2790838">l</span><span class="op" id="2790839">.</span><span class="ident" id="2790840">firstZoneUsed</span><span class="op" id="2790853">(</span><span class="op" id="2790854">)</span>&nbsp;<span class="op" id="2790856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790860">return</span>&nbsp;<span class="num" id="2790867">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2790870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2790874">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790886">if</span>&nbsp;<span class="builtinfunc" id="2790889">len</span><span class="op" id="2790892">(</span><span class="ident" id="2790893">l</span><span class="op" id="2790894">.</span><span class="ident" id="2790895">tx</span><span class="op" id="2790897">)</span>&nbsp;<span class="op" id="2790899">&gt;</span>&nbsp;<span class="num" id="2790901">0</span>&nbsp;<span class="op" id="2790903">&amp;&amp;</span>&nbsp;<span class="ident" id="2790906">l</span><span class="op" id="2790907">.</span><span class="ident" id="2790908">zone</span><span class="op" id="2790912">[</span><span class="ident" id="2790913">l</span><span class="op" id="2790914">.</span><span class="ident" id="2790915">tx</span><span class="op" id="2790917">[</span><span class="num" id="2790918">0</span><span class="op" id="2790919">]</span><span class="op" id="2790920">.</span><span class="ident" id="2790921">index</span><span class="op" id="2790926">]</span><span class="op" id="2790927">.</span><span class="ident" id="2790928">isDST</span>&nbsp;<span class="op" id="2790934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790938">for</span>&nbsp;<span class="ident" id="2790942">zi</span>&nbsp;<span class="op" id="2790945">:=</span>&nbsp;<span class="builtintype" id="2790948">int</span><span class="op" id="2790951">(</span><span class="ident" id="2790952">l</span><span class="op" id="2790953">.</span><span class="ident" id="2790954">tx</span><span class="op" id="2790956">[</span><span class="num" id="2790957">0</span><span class="op" id="2790958">]</span><span class="op" id="2790959">.</span><span class="ident" id="2790960">index</span><span class="op" id="2790965">)</span>&nbsp;<span class="op" id="2790967">-</span>&nbsp;<span class="num" id="2790969">1</span><span class="op" id="2790970">;</span>&nbsp;<span class="ident" id="2790972">zi</span>&nbsp;<span class="op" id="2790975">&gt;=</span>&nbsp;<span class="num" id="2790978">0</span><span class="op" id="2790979">;</span>&nbsp;<span class="ident" id="2790981">zi</span><span class="op" id="2790983">--</span>&nbsp;<span class="op" id="2790986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2790991">if</span>&nbsp;<span class="op" id="2790994">!</span><span class="ident" id="2790995">l</span><span class="op" id="2790996">.</span><span class="ident" id="2790997">zone</span><span class="op" id="2791001">[</span><span class="ident" id="2791002">zi</span><span class="op" id="2791004">]</span><span class="op" id="2791005">.</span><span class="ident" id="2791006">isDST</span>&nbsp;<span class="op" id="2791012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791018">return</span>&nbsp;<span class="ident" id="2791025">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791031">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791042">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791054">for</span>&nbsp;<span class="ident" id="2791058">zi</span>&nbsp;<span class="op" id="2791061">:=</span>&nbsp;<span class="keyword" id="2791064">range</span>&nbsp;<span class="ident" id="2791070">l</span><span class="op" id="2791071">.</span><span class="ident" id="2791072">zone</span>&nbsp;<span class="op" id="2791077">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791081">if</span>&nbsp;<span class="op" id="2791084">!</span><span class="ident" id="2791085">l</span><span class="op" id="2791086">.</span><span class="ident" id="2791087">zone</span><span class="op" id="2791091">[</span><span class="ident" id="2791092">zi</span><span class="op" id="2791094">]</span><span class="op" id="2791095">.</span><span class="ident" id="2791096">isDST</span>&nbsp;<span class="op" id="2791102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791107">return</span>&nbsp;<span class="ident" id="2791114">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791126">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791138">return</span>&nbsp;<span class="num" id="2791145">0</span><br>
<span class="lineno"></span><span class="op" id="2791147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791150">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2791214">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2791229">func</span>&nbsp;<span class="op" id="2791234">(</span><span class="ident" id="2791235">l</span>&nbsp;<span class="op" id="2791237">*</span><span class="ident" id="2791238">Location</span><span class="op" id="2791246">)</span>&nbsp;<span class="ident" id="2791248">firstZoneUsed</span><span class="op" id="2791261">(</span><span class="op" id="2791262">)</span>&nbsp;<span class="builtintype" id="2791264">bool</span>&nbsp;<span class="op" id="2791269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791272">for</span>&nbsp;<span class="ident" id="2791276">_</span><span class="op" id="2791277">,</span>&nbsp;<span class="ident" id="2791279">tx</span>&nbsp;<span class="op" id="2791282">:=</span>&nbsp;<span class="keyword" id="2791285">range</span>&nbsp;<span class="ident" id="2791291">l</span><span class="op" id="2791292">.</span><span class="ident" id="2791293">tx</span>&nbsp;<span class="op" id="2791296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791300">if</span>&nbsp;<span class="ident" id="2791303">tx</span><span class="op" id="2791305">.</span><span class="ident" id="2791306">index</span>&nbsp;<span class="op" id="2791312">==</span>&nbsp;<span class="num" id="2791315">0</span>&nbsp;<span class="op" id="2791317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791322">return</span>&nbsp;<span class="builtintype" id="2791329">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791342">return</span>&nbsp;<span class="builtintype" id="2791349">false</span><br>
<span class="lineno"></span><span class="op" id="2791355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2791358">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2791417">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2791481">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2791530">func</span>&nbsp;<span class="op" id="2791535">(</span><span class="ident" id="2791536">l</span>&nbsp;<span class="op" id="2791538">*</span><span class="ident" id="2791539">Location</span><span class="op" id="2791547">)</span>&nbsp;<span class="ident" id="2791549">lookupName</span><span class="op" id="2791559">(</span><span class="ident" id="2791560">name</span>&nbsp;<span class="builtintype" id="2791565">string</span><span class="op" id="2791571">,</span>&nbsp;<span class="ident" id="2791573">unix</span>&nbsp;<span class="ident" id="2791578">int64</span><span class="op" id="2791583">)</span>&nbsp;<span class="op" id="2791585">(</span><span class="ident" id="2791586">offset</span>&nbsp;<span class="builtintype" id="2791593">int</span><span class="op" id="2791596">,</span>&nbsp;<span class="ident" id="2791598">isDST</span>&nbsp;<span class="builtintype" id="2791604">bool</span><span class="op" id="2791608">,</span>&nbsp;<span class="ident" id="2791610">ok</span>&nbsp;<span class="builtintype" id="2791613">bool</span><span class="op" id="2791617">)</span>&nbsp;<span class="op" id="2791619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791622">l</span>&nbsp;<span class="op" id="2791624">=</span>&nbsp;<span class="ident" id="2791626">l</span><span class="op" id="2791627">.</span><span class="ident" id="2791628">get</span><span class="op" id="2791631">(</span><span class="op" id="2791632">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791636">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791699">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791769">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791832">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791891">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2791958">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791975">for</span>&nbsp;<span class="ident" id="2791979">i</span>&nbsp;<span class="op" id="2791981">:=</span>&nbsp;<span class="keyword" id="2791984">range</span>&nbsp;<span class="ident" id="2791990">l</span><span class="op" id="2791991">.</span><span class="ident" id="2791992">zone</span>&nbsp;<span class="op" id="2791997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2792001">zone</span>&nbsp;<span class="op" id="2792006">:=</span>&nbsp;<span class="op" id="2792009">&amp;</span><span class="ident" id="2792010">l</span><span class="op" id="2792011">.</span><span class="ident" id="2792012">zone</span><span class="op" id="2792016">[</span><span class="ident" id="2792017">i</span><span class="op" id="2792018">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792022">if</span>&nbsp;<span class="ident" id="2792025">zone</span><span class="op" id="2792029">.</span><span class="ident" id="2792030">name</span>&nbsp;<span class="op" id="2792035">==</span>&nbsp;<span class="ident" id="2792038">name</span>&nbsp;<span class="op" id="2792043">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2792048">nam</span><span class="op" id="2792051">,</span>&nbsp;<span class="ident" id="2792053">offset</span><span class="op" id="2792059">,</span>&nbsp;<span class="ident" id="2792061">isDST</span><span class="op" id="2792066">,</span>&nbsp;<span class="ident" id="2792068">_</span><span class="op" id="2792069">,</span>&nbsp;<span class="ident" id="2792071">_</span>&nbsp;<span class="op" id="2792073">:=</span>&nbsp;<span class="ident" id="2792076">l</span><span class="op" id="2792077">.</span><span class="ident" id="2792078">lookup</span><span class="op" id="2792084">(</span><span class="ident" id="2792085">unix</span>&nbsp;<span class="op" id="2792090">-</span>&nbsp;<span class="ident" id="2792092">int64</span><span class="op" id="2792097">(</span><span class="ident" id="2792098">zone</span><span class="op" id="2792102">.</span><span class="ident" id="2792103">offset</span><span class="op" id="2792109">)</span><span class="op" id="2792110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792115">if</span>&nbsp;<span class="ident" id="2792118">nam</span>&nbsp;<span class="op" id="2792122">==</span>&nbsp;<span class="ident" id="2792125">zone</span><span class="op" id="2792129">.</span><span class="ident" id="2792130">name</span>&nbsp;<span class="op" id="2792135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792141">return</span>&nbsp;<span class="ident" id="2792148">offset</span><span class="op" id="2792154">,</span>&nbsp;<span class="ident" id="2792156">isDST</span><span class="op" id="2792161">,</span>&nbsp;<span class="builtintype" id="2792163">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792175">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2792182">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792233">for</span>&nbsp;<span class="ident" id="2792237">i</span>&nbsp;<span class="op" id="2792239">:=</span>&nbsp;<span class="keyword" id="2792242">range</span>&nbsp;<span class="ident" id="2792248">l</span><span class="op" id="2792249">.</span><span class="ident" id="2792250">zone</span>&nbsp;<span class="op" id="2792255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2792259">zone</span>&nbsp;<span class="op" id="2792264">:=</span>&nbsp;<span class="op" id="2792267">&amp;</span><span class="ident" id="2792268">l</span><span class="op" id="2792269">.</span><span class="ident" id="2792270">zone</span><span class="op" id="2792274">[</span><span class="ident" id="2792275">i</span><span class="op" id="2792276">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792280">if</span>&nbsp;<span class="ident" id="2792283">zone</span><span class="op" id="2792287">.</span><span class="ident" id="2792288">name</span>&nbsp;<span class="op" id="2792293">==</span>&nbsp;<span class="ident" id="2792296">name</span>&nbsp;<span class="op" id="2792301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792306">return</span>&nbsp;<span class="ident" id="2792313">zone</span><span class="op" id="2792317">.</span><span class="ident" id="2792318">offset</span><span class="op" id="2792324">,</span>&nbsp;<span class="ident" id="2792326">zone</span><span class="op" id="2792330">.</span><span class="ident" id="2792331">isDST</span><span class="op" id="2792336">,</span>&nbsp;<span class="builtintype" id="2792338">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2792352">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792376">return</span><br>
<span class="lineno"></span><span class="op" id="2792383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2792386">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2792459">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2792520">var</span>&nbsp;<span class="ident" id="2792524">zoneinfo</span><span class="op" id="2792532">,</span>&nbsp;<span class="ident" id="2792534">_</span>&nbsp;<span class="op" id="2792536">=</span>&nbsp;<span class="ident" id="2792538">syscall</span><span class="op" id="2792545">.</span><span class="ident" id="2792546">Getenv</span><span class="op" id="2792552">(</span><span class="string" id="2792553">&#34;ZONEINFO&#34;</span><span class="op" id="2792563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2792566">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2792624">//</span><br>
<span class="lineno"></span><span class="comment" id="2792627">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2792684">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2792739">//</span><br>
<span class="lineno"></span><span class="comment" id="2792742">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2792820">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2792883">//</span><br>
<span class="lineno"></span><span class="comment" id="2792886">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2792946">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2793002">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2793066">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2793135">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2793184">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2793239">func</span>&nbsp;<span class="ident" id="2793244">LoadLocation</span><span class="op" id="2793256">(</span><span class="ident" id="2793257">name</span>&nbsp;<span class="builtintype" id="2793262">string</span><span class="op" id="2793268">)</span>&nbsp;<span class="op" id="2793270">(</span><span class="op" id="2793271">*</span><span class="ident" id="2793272">Location</span><span class="op" id="2793280">,</span>&nbsp;<span class="builtintype" id="2793282">error</span><span class="op" id="2793287">)</span>&nbsp;<span class="op" id="2793289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793292">if</span>&nbsp;<span class="ident" id="2793295">name</span>&nbsp;<span class="op" id="2793300">==</span>&nbsp;<span class="string" id="2793303">&#34;&#34;</span>&nbsp;<span class="op" id="2793306">||</span>&nbsp;<span class="ident" id="2793309">name</span>&nbsp;<span class="op" id="2793314">==</span>&nbsp;<span class="string" id="2793317">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2793323">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793327">return</span>&nbsp;<span class="ident" id="2793334">UTC</span><span class="op" id="2793337">,</span>&nbsp;<span class="ident" id="2793339">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793347">if</span>&nbsp;<span class="ident" id="2793350">name</span>&nbsp;<span class="op" id="2793355">==</span>&nbsp;<span class="string" id="2793358">&#34;Local&#34;</span>&nbsp;<span class="op" id="2793366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793370">return</span>&nbsp;<span class="ident" id="2793377">Local</span><span class="op" id="2793382">,</span>&nbsp;<span class="ident" id="2793384">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793389">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793392">if</span>&nbsp;<span class="ident" id="2793395">zoneinfo</span>&nbsp;<span class="op" id="2793404">!=</span>&nbsp;<span class="string" id="2793407">&#34;&#34;</span>&nbsp;<span class="op" id="2793410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793414">if</span>&nbsp;<span class="ident" id="2793417">z</span><span class="op" id="2793418">,</span>&nbsp;<span class="ident" id="2793420">err</span>&nbsp;<span class="op" id="2793424">:=</span>&nbsp;<span class="ident" id="2793427">loadZoneFile</span><span class="op" id="2793439">(</span><span class="ident" id="2793440">zoneinfo</span><span class="op" id="2793448">,</span>&nbsp;<span class="ident" id="2793450">name</span><span class="op" id="2793454">)</span><span class="op" id="2793455">;</span>&nbsp;<span class="ident" id="2793457">err</span>&nbsp;<span class="op" id="2793461">==</span>&nbsp;<span class="ident" id="2793464">nil</span>&nbsp;<span class="op" id="2793468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793473">z</span><span class="op" id="2793474">.</span><span class="ident" id="2793475">name</span>&nbsp;<span class="op" id="2793480">=</span>&nbsp;<span class="ident" id="2793482">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793490">return</span>&nbsp;<span class="ident" id="2793497">z</span><span class="op" id="2793498">,</span>&nbsp;<span class="ident" id="2793500">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793506">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793512">return</span>&nbsp;<span class="ident" id="2793519">loadLocation</span><span class="op" id="2793531">(</span><span class="ident" id="2793532">name</span><span class="op" id="2793536">)</span><br>
<span class="lineno"></span><span class="op" id="2793538">}</span>
</div>
</body>
</html>
