<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6395185">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6395241">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6395295">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6395346">package</span>&nbsp;<span class="ident" id="6395354">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6395361">import</span>&nbsp;<span class="op" id="6395368">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6395371">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6395382">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6395390">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6395397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6395400">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="6395465">type</span>&nbsp;<span class="ident" id="6395470">GCStats</span>&nbsp;<span class="keyword" id="6395478">struct</span>&nbsp;<span class="op" id="6395485">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395488">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395503">time</span><span class="op" id="6395507">.</span><span class="ident" id="6395508">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6395519">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395547">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395562">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6395578">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395612">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6395627">time</span><span class="op" id="6395631">.</span><span class="ident" id="6395632">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6395643">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395679">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6395694">[</span><span class="op" id="6395695">]</span><span class="ident" id="6395696">time</span><span class="op" id="6395700">.</span><span class="ident" id="6395701">Duration</span>&nbsp;<span class="comment" id="6395710">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395747">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6395762">[</span><span class="op" id="6395763">]</span><span class="ident" id="6395764">time</span><span class="op" id="6395768">.</span><span class="ident" id="6395769">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6395778">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6395825">PauseQuantiles</span>&nbsp;<span class="op" id="6395840">[</span><span class="op" id="6395841">]</span><span class="ident" id="6395842">time</span><span class="op" id="6395846">.</span><span class="ident" id="6395847">Duration</span><br>
<span class="lineno"></span><span class="op" id="6395856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6395859">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="6395928">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="6395995">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="6396071">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="6396138">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="6396215">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6396278">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="6396349">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="6396392">func</span>&nbsp;<span class="ident" id="6396397">ReadGCStats</span><span class="op" id="6396408">(</span><span class="ident" id="6396409">stats</span>&nbsp;<span class="op" id="6396415">*</span><span class="ident" id="6396416">GCStats</span><span class="op" id="6396423">)</span>&nbsp;<span class="op" id="6396425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396428">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396490">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396553">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396617">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396673">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396698">const</span>&nbsp;<span class="ident" id="6396704">maxPause</span>&nbsp;<span class="op" id="6396713">=</span>&nbsp;<span class="builtinfunc" id="6396715">len</span><span class="op" id="6396718">(</span><span class="op" id="6396719">(</span><span class="op" id="6396720">(</span><span class="op" id="6396721">*</span><span class="ident" id="6396722">runtime</span><span class="op" id="6396729">.</span><span class="ident" id="6396730">MemStats</span><span class="op" id="6396738">)</span><span class="op" id="6396739">(</span><span class="ident" id="6396740">nil</span><span class="op" id="6396743">)</span><span class="op" id="6396744">)</span><span class="op" id="6396745">.</span><span class="ident" id="6396746">PauseNs</span><span class="op" id="6396753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6396756">if</span>&nbsp;<span class="builtinfunc" id="6396759">cap</span><span class="op" id="6396762">(</span><span class="ident" id="6396763">stats</span><span class="op" id="6396768">.</span><span class="ident" id="6396769">Pause</span><span class="op" id="6396774">)</span>&nbsp;<span class="op" id="6396776">&lt;</span>&nbsp;<span class="num" id="6396778">2</span><span class="op" id="6396779">*</span><span class="ident" id="6396780">maxPause</span><span class="op" id="6396788">+</span><span class="num" id="6396789">3</span>&nbsp;<span class="op" id="6396791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6396795">stats</span><span class="op" id="6396800">.</span><span class="ident" id="6396801">Pause</span>&nbsp;<span class="op" id="6396807">=</span>&nbsp;<span class="builtinfunc" id="6396809">make</span><span class="op" id="6396813">(</span><span class="op" id="6396814">[</span><span class="op" id="6396815">]</span><span class="ident" id="6396816">time</span><span class="op" id="6396820">.</span><span class="ident" id="6396821">Duration</span><span class="op" id="6396829">,</span>&nbsp;<span class="num" id="6396831">2</span><span class="op" id="6396832">*</span><span class="ident" id="6396833">maxPause</span><span class="op" id="6396841">+</span><span class="num" id="6396842">3</span><span class="op" id="6396843">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6396846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396850">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396916">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6396984">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6397047">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6397106">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6397174">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397194">readGCStats</span><span class="op" id="6397205">(</span><span class="op" id="6397206">&amp;</span><span class="ident" id="6397207">stats</span><span class="op" id="6397212">.</span><span class="ident" id="6397213">Pause</span><span class="op" id="6397218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397221">n</span>&nbsp;<span class="op" id="6397223">:=</span>&nbsp;<span class="builtinfunc" id="6397226">len</span><span class="op" id="6397229">(</span><span class="ident" id="6397230">stats</span><span class="op" id="6397235">.</span><span class="ident" id="6397236">Pause</span><span class="op" id="6397241">)</span>&nbsp;<span class="op" id="6397243">-</span>&nbsp;<span class="num" id="6397245">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397248">stats</span><span class="op" id="6397253">.</span><span class="ident" id="6397254">LastGC</span>&nbsp;<span class="op" id="6397261">=</span>&nbsp;<span class="ident" id="6397263">time</span><span class="op" id="6397267">.</span><span class="ident" id="6397268">Unix</span><span class="op" id="6397272">(</span><span class="num" id="6397273">0</span><span class="op" id="6397274">,</span>&nbsp;<span class="ident" id="6397276">int64</span><span class="op" id="6397281">(</span><span class="ident" id="6397282">stats</span><span class="op" id="6397287">.</span><span class="ident" id="6397288">Pause</span><span class="op" id="6397293">[</span><span class="ident" id="6397294">n</span><span class="op" id="6397295">]</span><span class="op" id="6397296">)</span><span class="op" id="6397297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397300">stats</span><span class="op" id="6397305">.</span><span class="ident" id="6397306">NumGC</span>&nbsp;<span class="op" id="6397312">=</span>&nbsp;<span class="ident" id="6397314">int64</span><span class="op" id="6397319">(</span><span class="ident" id="6397320">stats</span><span class="op" id="6397325">.</span><span class="ident" id="6397326">Pause</span><span class="op" id="6397331">[</span><span class="ident" id="6397332">n</span><span class="op" id="6397333">+</span><span class="num" id="6397334">1</span><span class="op" id="6397335">]</span><span class="op" id="6397336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397339">stats</span><span class="op" id="6397344">.</span><span class="ident" id="6397345">PauseTotal</span>&nbsp;<span class="op" id="6397356">=</span>&nbsp;<span class="ident" id="6397358">stats</span><span class="op" id="6397363">.</span><span class="ident" id="6397364">Pause</span><span class="op" id="6397369">[</span><span class="ident" id="6397370">n</span><span class="op" id="6397371">+</span><span class="num" id="6397372">2</span><span class="op" id="6397373">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397376">n</span>&nbsp;<span class="op" id="6397378">/=</span>&nbsp;<span class="num" id="6397381">2</span>&nbsp;<span class="comment" id="6397383">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397421">stats</span><span class="op" id="6397426">.</span><span class="ident" id="6397427">Pause</span>&nbsp;<span class="op" id="6397433">=</span>&nbsp;<span class="ident" id="6397435">stats</span><span class="op" id="6397440">.</span><span class="ident" id="6397441">Pause</span><span class="op" id="6397446">[</span><span class="op" id="6397447">:</span><span class="ident" id="6397448">n</span><span class="op" id="6397449">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397453">if</span>&nbsp;<span class="builtinfunc" id="6397456">cap</span><span class="op" id="6397459">(</span><span class="ident" id="6397460">stats</span><span class="op" id="6397465">.</span><span class="ident" id="6397466">PauseEnd</span><span class="op" id="6397474">)</span>&nbsp;<span class="op" id="6397476">&lt;</span>&nbsp;<span class="ident" id="6397478">maxPause</span>&nbsp;<span class="op" id="6397487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397491">stats</span><span class="op" id="6397496">.</span><span class="ident" id="6397497">PauseEnd</span>&nbsp;<span class="op" id="6397506">=</span>&nbsp;<span class="builtinfunc" id="6397508">make</span><span class="op" id="6397512">(</span><span class="op" id="6397513">[</span><span class="op" id="6397514">]</span><span class="ident" id="6397515">time</span><span class="op" id="6397519">.</span><span class="ident" id="6397520">Time</span><span class="op" id="6397524">,</span>&nbsp;<span class="num" id="6397526">0</span><span class="op" id="6397527">,</span>&nbsp;<span class="ident" id="6397529">maxPause</span><span class="op" id="6397537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397543">stats</span><span class="op" id="6397548">.</span><span class="ident" id="6397549">PauseEnd</span>&nbsp;<span class="op" id="6397558">=</span>&nbsp;<span class="ident" id="6397560">stats</span><span class="op" id="6397565">.</span><span class="ident" id="6397566">PauseEnd</span><span class="op" id="6397574">[</span><span class="op" id="6397575">:</span><span class="num" id="6397576">0</span><span class="op" id="6397577">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397580">for</span>&nbsp;<span class="ident" id="6397584">_</span><span class="op" id="6397585">,</span>&nbsp;<span class="ident" id="6397587">ns</span>&nbsp;<span class="op" id="6397590">:=</span>&nbsp;<span class="keyword" id="6397593">range</span>&nbsp;<span class="ident" id="6397599">stats</span><span class="op" id="6397604">.</span><span class="ident" id="6397605">Pause</span><span class="op" id="6397610">[</span><span class="ident" id="6397611">n</span>&nbsp;<span class="op" id="6397613">:</span>&nbsp;<span class="ident" id="6397615">n</span><span class="op" id="6397616">+</span><span class="ident" id="6397617">n</span><span class="op" id="6397618">]</span>&nbsp;<span class="op" id="6397620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397624">stats</span><span class="op" id="6397629">.</span><span class="ident" id="6397630">PauseEnd</span>&nbsp;<span class="op" id="6397639">=</span>&nbsp;<span class="builtinfunc" id="6397641">append</span><span class="op" id="6397647">(</span><span class="ident" id="6397648">stats</span><span class="op" id="6397653">.</span><span class="ident" id="6397654">PauseEnd</span><span class="op" id="6397662">,</span>&nbsp;<span class="ident" id="6397664">time</span><span class="op" id="6397668">.</span><span class="ident" id="6397669">Unix</span><span class="op" id="6397673">(</span><span class="num" id="6397674">0</span><span class="op" id="6397675">,</span>&nbsp;<span class="ident" id="6397677">int64</span><span class="op" id="6397682">(</span><span class="ident" id="6397683">ns</span><span class="op" id="6397685">)</span><span class="op" id="6397686">)</span><span class="op" id="6397687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397694">if</span>&nbsp;<span class="builtinfunc" id="6397697">len</span><span class="op" id="6397700">(</span><span class="ident" id="6397701">stats</span><span class="op" id="6397706">.</span><span class="ident" id="6397707">PauseQuantiles</span><span class="op" id="6397721">)</span>&nbsp;<span class="op" id="6397723">&gt;</span>&nbsp;<span class="num" id="6397725">0</span>&nbsp;<span class="op" id="6397727">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397731">if</span>&nbsp;<span class="ident" id="6397734">n</span>&nbsp;<span class="op" id="6397736">==</span>&nbsp;<span class="num" id="6397739">0</span>&nbsp;<span class="op" id="6397741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6397746">for</span>&nbsp;<span class="ident" id="6397750">i</span>&nbsp;<span class="op" id="6397752">:=</span>&nbsp;<span class="keyword" id="6397755">range</span>&nbsp;<span class="ident" id="6397761">stats</span><span class="op" id="6397766">.</span><span class="ident" id="6397767">PauseQuantiles</span>&nbsp;<span class="op" id="6397782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397788">stats</span><span class="op" id="6397793">.</span><span class="ident" id="6397794">PauseQuantiles</span><span class="op" id="6397808">[</span><span class="ident" id="6397809">i</span><span class="op" id="6397810">]</span>&nbsp;<span class="op" id="6397812">=</span>&nbsp;<span class="num" id="6397814">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6397823">}</span>&nbsp;<span class="keyword" id="6397825">else</span>&nbsp;<span class="op" id="6397830">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6397835">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6397900">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6397953">sorted</span>&nbsp;<span class="op" id="6397960">:=</span>&nbsp;<span class="ident" id="6397963">stats</span><span class="op" id="6397968">.</span><span class="ident" id="6397969">Pause</span><span class="op" id="6397974">[</span><span class="ident" id="6397975">n</span>&nbsp;<span class="op" id="6397977">:</span>&nbsp;<span class="ident" id="6397979">n</span><span class="op" id="6397980">+</span><span class="ident" id="6397981">n</span><span class="op" id="6397982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6397987">copy</span><span class="op" id="6397991">(</span><span class="ident" id="6397992">sorted</span><span class="op" id="6397998">,</span>&nbsp;<span class="ident" id="6398000">stats</span><span class="op" id="6398005">.</span><span class="ident" id="6398006">Pause</span><span class="op" id="6398011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398016">sort</span><span class="op" id="6398020">.</span><span class="ident" id="6398021">Sort</span><span class="op" id="6398025">(</span><span class="ident" id="6398026">byDuration</span><span class="op" id="6398036">(</span><span class="ident" id="6398037">sorted</span><span class="op" id="6398043">)</span><span class="op" id="6398044">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398049">nq</span>&nbsp;<span class="op" id="6398052">:=</span>&nbsp;<span class="builtinfunc" id="6398055">len</span><span class="op" id="6398058">(</span><span class="ident" id="6398059">stats</span><span class="op" id="6398064">.</span><span class="ident" id="6398065">PauseQuantiles</span><span class="op" id="6398079">)</span>&nbsp;<span class="op" id="6398081">-</span>&nbsp;<span class="num" id="6398083">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398088">for</span>&nbsp;<span class="ident" id="6398092">i</span>&nbsp;<span class="op" id="6398094">:=</span>&nbsp;<span class="num" id="6398097">0</span><span class="op" id="6398098">;</span>&nbsp;<span class="ident" id="6398100">i</span>&nbsp;<span class="op" id="6398102">&lt;</span>&nbsp;<span class="ident" id="6398104">nq</span><span class="op" id="6398106">;</span>&nbsp;<span class="ident" id="6398108">i</span><span class="op" id="6398109">++</span>&nbsp;<span class="op" id="6398112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398118">stats</span><span class="op" id="6398123">.</span><span class="ident" id="6398124">PauseQuantiles</span><span class="op" id="6398138">[</span><span class="ident" id="6398139">i</span><span class="op" id="6398140">]</span>&nbsp;<span class="op" id="6398142">=</span>&nbsp;<span class="ident" id="6398144">sorted</span><span class="op" id="6398150">[</span><span class="builtinfunc" id="6398151">len</span><span class="op" id="6398154">(</span><span class="ident" id="6398155">sorted</span><span class="op" id="6398161">)</span><span class="op" id="6398162">*</span><span class="ident" id="6398163">i</span><span class="op" id="6398164">/</span><span class="ident" id="6398165">nq</span><span class="op" id="6398167">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398177">stats</span><span class="op" id="6398182">.</span><span class="ident" id="6398183">PauseQuantiles</span><span class="op" id="6398197">[</span><span class="ident" id="6398198">nq</span><span class="op" id="6398200">]</span>&nbsp;<span class="op" id="6398202">=</span>&nbsp;<span class="ident" id="6398204">sorted</span><span class="op" id="6398210">[</span><span class="builtinfunc" id="6398211">len</span><span class="op" id="6398214">(</span><span class="ident" id="6398215">sorted</span><span class="op" id="6398221">)</span><span class="op" id="6398222">-</span><span class="num" id="6398223">1</span><span class="op" id="6398224">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6398231">}</span><br>
<span class="lineno"></span><span class="op" id="6398233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6398236">type</span>&nbsp;<span class="ident" id="6398241">byDuration</span>&nbsp;<span class="op" id="6398252">[</span><span class="op" id="6398253">]</span><span class="ident" id="6398254">time</span><span class="op" id="6398258">.</span><span class="ident" id="6398259">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6398269">func</span>&nbsp;<span class="op" id="6398274">(</span><span class="ident" id="6398275">x</span>&nbsp;<span class="ident" id="6398277">byDuration</span><span class="op" id="6398287">)</span>&nbsp;<span class="ident" id="6398289">Len</span><span class="op" id="6398292">(</span><span class="op" id="6398293">)</span>&nbsp;<span class="builtintype" id="6398295">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6398309">{</span>&nbsp;<span class="keyword" id="6398311">return</span>&nbsp;<span class="builtinfunc" id="6398318">len</span><span class="op" id="6398321">(</span><span class="ident" id="6398322">x</span><span class="op" id="6398323">)</span>&nbsp;<span class="op" id="6398325">}</span><br>
<span class="lineno"></span><span class="keyword" id="6398327">func</span>&nbsp;<span class="op" id="6398332">(</span><span class="ident" id="6398333">x</span>&nbsp;<span class="ident" id="6398335">byDuration</span><span class="op" id="6398345">)</span>&nbsp;<span class="ident" id="6398347">Swap</span><span class="op" id="6398351">(</span><span class="ident" id="6398352">i</span><span class="op" id="6398353">,</span>&nbsp;<span class="ident" id="6398355">j</span>&nbsp;<span class="builtintype" id="6398357">int</span><span class="op" id="6398360">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6398367">{</span>&nbsp;<span class="ident" id="6398369">x</span><span class="op" id="6398370">[</span><span class="ident" id="6398371">i</span><span class="op" id="6398372">]</span><span class="op" id="6398373">,</span>&nbsp;<span class="ident" id="6398375">x</span><span class="op" id="6398376">[</span><span class="ident" id="6398377">j</span><span class="op" id="6398378">]</span>&nbsp;<span class="op" id="6398380">=</span>&nbsp;<span class="ident" id="6398382">x</span><span class="op" id="6398383">[</span><span class="ident" id="6398384">j</span><span class="op" id="6398385">]</span><span class="op" id="6398386">,</span>&nbsp;<span class="ident" id="6398388">x</span><span class="op" id="6398389">[</span><span class="ident" id="6398390">i</span><span class="op" id="6398391">]</span>&nbsp;<span class="op" id="6398393">}</span><br>
<span class="lineno"></span><span class="keyword" id="6398395">func</span>&nbsp;<span class="op" id="6398400">(</span><span class="ident" id="6398401">x</span>&nbsp;<span class="ident" id="6398403">byDuration</span><span class="op" id="6398413">)</span>&nbsp;<span class="ident" id="6398415">Less</span><span class="op" id="6398419">(</span><span class="ident" id="6398420">i</span><span class="op" id="6398421">,</span>&nbsp;<span class="ident" id="6398423">j</span>&nbsp;<span class="builtintype" id="6398425">int</span><span class="op" id="6398428">)</span>&nbsp;<span class="builtintype" id="6398430">bool</span>&nbsp;<span class="op" id="6398435">{</span>&nbsp;<span class="keyword" id="6398437">return</span>&nbsp;<span class="ident" id="6398444">x</span><span class="op" id="6398445">[</span><span class="ident" id="6398446">i</span><span class="op" id="6398447">]</span>&nbsp;<span class="op" id="6398449">&lt;</span>&nbsp;<span class="ident" id="6398451">x</span><span class="op" id="6398452">[</span><span class="ident" id="6398453">j</span><span class="op" id="6398454">]</span>&nbsp;<span class="op" id="6398456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="6398459">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="6398522">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6398592">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="6398673">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6398719">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="6398788">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6398838">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="6398892">func</span>&nbsp;<span class="ident" id="6398897">SetGCPercent</span><span class="op" id="6398909">(</span><span class="ident" id="6398910">percent</span>&nbsp;<span class="builtintype" id="6398918">int</span><span class="op" id="6398921">)</span>&nbsp;<span class="builtintype" id="6398923">int</span>&nbsp;<span class="op" id="6398927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398930">old</span>&nbsp;<span class="op" id="6398934">:=</span>&nbsp;<span class="ident" id="6398937">setGCPercent</span><span class="op" id="6398949">(</span><span class="builtintype" id="6398950">int32</span><span class="op" id="6398955">(</span><span class="ident" id="6398956">percent</span><span class="op" id="6398963">)</span><span class="op" id="6398964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6398967">runtime</span><span class="op" id="6398974">.</span><span class="ident" id="6398975">GC</span><span class="op" id="6398977">(</span><span class="op" id="6398978">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6398981">return</span>&nbsp;<span class="builtintype" id="6398988">int</span><span class="op" id="6398991">(</span><span class="ident" id="6398992">old</span><span class="op" id="6398995">)</span><br>
<span class="lineno"></span><span class="op" id="6398997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6399000">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="6399059">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="6399119">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="6399186">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="6399251">func</span>&nbsp;<span class="ident" id="6399256">FreeOSMemory</span><span class="op" id="6399268">(</span><span class="op" id="6399269">)</span>&nbsp;<span class="op" id="6399271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6399274">freeOSMemory</span><span class="op" id="6399286">(</span><span class="op" id="6399287">)</span><br>
<span class="lineno"></span><span class="op" id="6399289">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6399292">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="6399346">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="6399390">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="6399454">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="6399478">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6399523">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="6399599">//</span><br>
<span class="lineno"></span><span class="comment" id="6399602">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6399666">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="6399736">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="6399753">func</span>&nbsp;<span class="ident" id="6399758">SetMaxStack</span><span class="op" id="6399769">(</span><span class="ident" id="6399770">bytes</span>&nbsp;<span class="builtintype" id="6399776">int</span><span class="op" id="6399779">)</span>&nbsp;<span class="builtintype" id="6399781">int</span>&nbsp;<span class="op" id="6399785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6399788">return</span>&nbsp;<span class="ident" id="6399795">setMaxStack</span><span class="op" id="6399806">(</span><span class="ident" id="6399807">bytes</span><span class="op" id="6399812">)</span><br>
<span class="lineno"></span><span class="op" id="6399814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6399817">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="6399878">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="6399950">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="6399985">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6400032">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="6400074">//</span><br>
<span class="lineno"></span><span class="comment" id="6400077">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="6400154">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="6400228">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="6400316">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="6400389">//</span><br>
<span class="lineno"></span><span class="comment" id="6400392">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6400458">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6400526">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="6400597">func</span>&nbsp;<span class="ident" id="6400602">SetMaxThreads</span><span class="op" id="6400615">(</span><span class="ident" id="6400616">threads</span>&nbsp;<span class="builtintype" id="6400624">int</span><span class="op" id="6400627">)</span>&nbsp;<span class="builtintype" id="6400629">int</span>&nbsp;<span class="op" id="6400633">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400636">return</span>&nbsp;<span class="ident" id="6400643">setMaxThreads</span><span class="op" id="6400656">(</span><span class="ident" id="6400657">threads</span><span class="op" id="6400664">)</span><br>
<span class="lineno"></span><span class="op" id="6400666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6400669">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="6400742">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="6400817">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="6400896">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="6400964">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="6401036">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="6401108">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="6401163">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="6401221">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="6401257">func</span>&nbsp;<span class="ident" id="6401262">SetPanicOnFault</span><span class="op" id="6401277">(</span><span class="ident" id="6401278">enabled</span>&nbsp;<span class="builtintype" id="6401286">bool</span><span class="op" id="6401290">)</span>&nbsp;<span class="builtintype" id="6401292">bool</span>&nbsp;<span class="op" id="6401297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401300">return</span>&nbsp;<span class="ident" id="6401307">setPanicOnFault</span><span class="op" id="6401322">(</span><span class="ident" id="6401323">enabled</span><span class="op" id="6401330">)</span><br>
<span class="lineno"></span><span class="op" id="6401332">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="6401335">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6401404">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="6401440">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="6401512">func</span>&nbsp;<span class="ident" id="6401517">WriteHeapDump</span><span class="op" id="6401530">(</span><span class="ident" id="6401531">fd</span>&nbsp;<span class="builtintype" id="6401534">uintptr</span><span class="op" id="6401541">)</span>
</div>
</body>
</html>
