<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7292898">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7292953">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7293007">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7293058">package</span>&nbsp;<span class="ident" id="7293066">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7293072">import</span>&nbsp;<span class="op" id="7293079">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293082">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293091">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293105">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293121">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293140">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293155">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293169">_</span>&nbsp;<span class="string" id="7293171">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293188">_</span>&nbsp;<span class="string" id="7293190">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293207">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293227">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293244">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293263">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293279">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293295">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293307">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293314">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293325">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293336">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293347">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7293358">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7293365">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7293368">func</span>&nbsp;<span class="ident" id="7293373">TestParsePKCS1PrivateKey</span><span class="op" id="7293397">(</span><span class="ident" id="7293398">t</span>&nbsp;<span class="op" id="7293400">*</span><span class="ident" id="7293401"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7293408">.</span><span class="ident" id="7293409">T</span><span class="op" id="7293410">)</span>&nbsp;<span class="op" id="7293412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293415">block</span><span class="op" id="7293420">,</span>&nbsp;<span class="ident" id="7293422">_</span>&nbsp;<span class="op" id="7293424">:=</span>&nbsp;<span class="ident" id="7293427"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7293430">.</span><span class="ident" id="7293431">Decode</span><span class="op" id="7293437">(</span><span class="op" id="7293438">[</span><span class="op" id="7293439">]</span><span class="builtintype" id="7293440">byte</span><span class="op" id="7293444">(</span><span class="ident" id="7293445"><a href="/crypto/x509/x509_test.go.html#7295037">pemPrivateKey</a></span><span class="op" id="7293458">)</span><span class="op" id="7293459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293462">priv</span><span class="op" id="7293466">,</span>&nbsp;<span class="ident" id="7293468">err</span>&nbsp;<span class="op" id="7293472">:=</span>&nbsp;<span class="ident" id="7293475"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7293495">(</span><span class="ident" id="7293496"><a href="/crypto/x509/x509_test.go.html#7293415">block</a></span><span class="op" id="7293501">.</span><span class="ident" id="7293502">Bytes</span><span class="op" id="7293507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293510">if</span>&nbsp;<span class="ident" id="7293513"><a href="/crypto/x509/x509_test.go.html#7293468">err</a></span>&nbsp;<span class="op" id="7293517">!=</span>&nbsp;<span class="ident" id="7293520">nil</span>&nbsp;<span class="op" id="7293524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293528"><a href="/crypto/x509/x509_test.go.html#7293398">t</a></span><span class="op" id="7293529">.</span><span class="ident" id="7293530">Errorf</span><span class="op" id="7293536">(</span><span class="string" id="7293537">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7293570">,</span>&nbsp;<span class="ident" id="7293572"><a href="/crypto/x509/x509_test.go.html#7293468">err</a></span><span class="op" id="7293575">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293579">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293590">if</span>&nbsp;<span class="ident" id="7293593"><a href="/crypto/x509/x509_test.go.html#7293462">priv</a></span><span class="op" id="7293597">.</span><span class="ident" id="7293598">PublicKey</span><span class="op" id="7293607">.</span><span class="ident" id="7293608">N</span><span class="op" id="7293609">.</span><span class="ident" id="7293610">Cmp</span><span class="op" id="7293613">(</span><span class="ident" id="7293614"><a href="/crypto/x509/x509_test.go.html#7295852">rsaPrivateKey</a></span><span class="op" id="7293627">.</span><span class="ident" id="7293628">PublicKey</span><span class="op" id="7293637">.</span><span class="ident" id="7293638">N</span><span class="op" id="7293639">)</span>&nbsp;<span class="op" id="7293641">!=</span>&nbsp;<span class="num" id="7293644">0</span>&nbsp;<span class="op" id="7293646">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293651"><a href="/crypto/x509/x509_test.go.html#7293462">priv</a></span><span class="op" id="7293655">.</span><span class="ident" id="7293656">PublicKey</span><span class="op" id="7293665">.</span><span class="ident" id="7293666">E</span>&nbsp;<span class="op" id="7293668">!=</span>&nbsp;<span class="ident" id="7293671"><a href="/crypto/x509/x509_test.go.html#7295852">rsaPrivateKey</a></span><span class="op" id="7293684">.</span><span class="ident" id="7293685">PublicKey</span><span class="op" id="7293694">.</span><span class="ident" id="7293695">E</span>&nbsp;<span class="op" id="7293697">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293702"><a href="/crypto/x509/x509_test.go.html#7293462">priv</a></span><span class="op" id="7293706">.</span><span class="ident" id="7293707">D</span><span class="op" id="7293708">.</span><span class="ident" id="7293709">Cmp</span><span class="op" id="7293712">(</span><span class="ident" id="7293713"><a href="/crypto/x509/x509_test.go.html#7295852">rsaPrivateKey</a></span><span class="op" id="7293726">.</span><span class="ident" id="7293727">D</span><span class="op" id="7293728">)</span>&nbsp;<span class="op" id="7293730">!=</span>&nbsp;<span class="num" id="7293733">0</span>&nbsp;<span class="op" id="7293735">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293740"><a href="/crypto/x509/x509_test.go.html#7293462">priv</a></span><span class="op" id="7293744">.</span><span class="ident" id="7293745">Primes</span><span class="op" id="7293751">[</span><span class="num" id="7293752">0</span><span class="op" id="7293753">]</span><span class="op" id="7293754">.</span><span class="ident" id="7293755">Cmp</span><span class="op" id="7293758">(</span><span class="ident" id="7293759"><a href="/crypto/x509/x509_test.go.html#7295852">rsaPrivateKey</a></span><span class="op" id="7293772">.</span><span class="ident" id="7293773">Primes</span><span class="op" id="7293779">[</span><span class="num" id="7293780">0</span><span class="op" id="7293781">]</span><span class="op" id="7293782">)</span>&nbsp;<span class="op" id="7293784">!=</span>&nbsp;<span class="num" id="7293787">0</span>&nbsp;<span class="op" id="7293789">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293794"><a href="/crypto/x509/x509_test.go.html#7293462">priv</a></span><span class="op" id="7293798">.</span><span class="ident" id="7293799">Primes</span><span class="op" id="7293805">[</span><span class="num" id="7293806">1</span><span class="op" id="7293807">]</span><span class="op" id="7293808">.</span><span class="ident" id="7293809">Cmp</span><span class="op" id="7293812">(</span><span class="ident" id="7293813"><a href="/crypto/x509/x509_test.go.html#7295852">rsaPrivateKey</a></span><span class="op" id="7293826">.</span><span class="ident" id="7293827">Primes</span><span class="op" id="7293833">[</span><span class="num" id="7293834">1</span><span class="op" id="7293835">]</span><span class="op" id="7293836">)</span>&nbsp;<span class="op" id="7293838">!=</span>&nbsp;<span class="num" id="7293841">0</span>&nbsp;<span class="op" id="7293843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293847"><a href="/crypto/x509/x509_test.go.html#7293398">t</a></span><span class="op" id="7293848">.</span><span class="ident" id="7293849">Errorf</span><span class="op" id="7293855">(</span><span class="string" id="7293856">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7293874">,</span>&nbsp;<span class="ident" id="7293876"><a href="/crypto/x509/x509_test.go.html#7293462">priv</a></span><span class="op" id="7293880">,</span>&nbsp;<span class="ident" id="7293882"><a href="/crypto/x509/x509_test.go.html#7295852">rsaPrivateKey</a></span><span class="op" id="7293895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293898">}</span><br>
<span class="lineno"></span><span class="op" id="7293900">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7293903">func</span>&nbsp;<span class="ident" id="7293908">TestParsePKIXPublicKey</span><span class="op" id="7293930">(</span><span class="ident" id="7293931">t</span>&nbsp;<span class="op" id="7293933">*</span><span class="ident" id="7293934"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7293941">.</span><span class="ident" id="7293942">T</span><span class="op" id="7293943">)</span>&nbsp;<span class="op" id="7293945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293948">block</span><span class="op" id="7293953">,</span>&nbsp;<span class="ident" id="7293955">_</span>&nbsp;<span class="op" id="7293957">:=</span>&nbsp;<span class="ident" id="7293960"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7293963">.</span><span class="ident" id="7293964">Decode</span><span class="op" id="7293970">(</span><span class="op" id="7293971">[</span><span class="op" id="7293972">]</span><span class="builtintype" id="7293973">byte</span><span class="op" id="7293977">(</span><span class="ident" id="7293978"><a href="/crypto/x509/x509_test.go.html#7294563">pemPublicKey</a></span><span class="op" id="7293990">)</span><span class="op" id="7293991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293994">pub</span><span class="op" id="7293997">,</span>&nbsp;<span class="ident" id="7293999">err</span>&nbsp;<span class="op" id="7294003">:=</span>&nbsp;<span class="ident" id="7294006"><a href="/crypto/x509/x509.go.html#4030520">ParsePKIXPublicKey</a></span><span class="op" id="7294024">(</span><span class="ident" id="7294025"><a href="/crypto/x509/x509_test.go.html#7293948">block</a></span><span class="op" id="7294030">.</span><span class="ident" id="7294031">Bytes</span><span class="op" id="7294036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294039">if</span>&nbsp;<span class="ident" id="7294042"><a href="/crypto/x509/x509_test.go.html#7293999">err</a></span>&nbsp;<span class="op" id="7294046">!=</span>&nbsp;<span class="ident" id="7294049">nil</span>&nbsp;<span class="op" id="7294053">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294057"><a href="/crypto/x509/x509_test.go.html#7293931">t</a></span><span class="op" id="7294058">.</span><span class="ident" id="7294059">Errorf</span><span class="op" id="7294065">(</span><span class="string" id="7294066">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7294102">,</span>&nbsp;<span class="ident" id="7294104"><a href="/crypto/x509/x509_test.go.html#7293999">err</a></span><span class="op" id="7294107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294111">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294122">rsaPub</span><span class="op" id="7294128">,</span>&nbsp;<span class="ident" id="7294130">ok</span>&nbsp;<span class="op" id="7294133">:=</span>&nbsp;<span class="ident" id="7294136"><a href="/crypto/x509/x509_test.go.html#7293994">pub</a></span><span class="op" id="7294139">.</span><span class="op" id="7294140">(</span><span class="op" id="7294141">*</span><span class="ident" id="7294142"><a href="/crypto/x509/x509_test.go.html#7293155">rsa</a></span><span class="op" id="7294145">.</span><span class="ident" id="7294146">PublicKey</span><span class="op" id="7294155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294158">if</span>&nbsp;<span class="op" id="7294161">!</span><span class="ident" id="7294162"><a href="/crypto/x509/x509_test.go.html#7294130">ok</a></span>&nbsp;<span class="op" id="7294165">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294169"><a href="/crypto/x509/x509_test.go.html#7293931">t</a></span><span class="op" id="7294170">.</span><span class="ident" id="7294171">Errorf</span><span class="op" id="7294177">(</span><span class="string" id="7294178">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7294244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294260">pubBytes2</span><span class="op" id="7294269">,</span>&nbsp;<span class="ident" id="7294271"><a href="/crypto/x509/x509_test.go.html#7293999">err</a></span>&nbsp;<span class="op" id="7294275">:=</span>&nbsp;<span class="ident" id="7294278"><a href="/crypto/x509/x509.go.html#4032101">MarshalPKIXPublicKey</a></span><span class="op" id="7294298">(</span><span class="ident" id="7294299"><a href="/crypto/x509/x509_test.go.html#7294122">rsaPub</a></span><span class="op" id="7294305">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294308">if</span>&nbsp;<span class="ident" id="7294311"><a href="/crypto/x509/x509_test.go.html#7293999">err</a></span>&nbsp;<span class="op" id="7294315">!=</span>&nbsp;<span class="ident" id="7294318">nil</span>&nbsp;<span class="op" id="7294322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294326"><a href="/crypto/x509/x509_test.go.html#7293931">t</a></span><span class="op" id="7294327">.</span><span class="ident" id="7294328">Errorf</span><span class="op" id="7294334">(</span><span class="string" id="7294335">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7294393">,</span>&nbsp;<span class="ident" id="7294395"><a href="/crypto/x509/x509_test.go.html#7293999">err</a></span><span class="op" id="7294398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294402">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7294413">if</span>&nbsp;<span class="op" id="7294416">!</span><span class="ident" id="7294417"><a href="/crypto/x509/x509_test.go.html#7293082">bytes</a></span><span class="op" id="7294422">.</span><span class="ident" id="7294423">Equal</span><span class="op" id="7294428">(</span><span class="ident" id="7294429"><a href="/crypto/x509/x509_test.go.html#7294260">pubBytes2</a></span><span class="op" id="7294438">,</span>&nbsp;<span class="ident" id="7294440"><a href="/crypto/x509/x509_test.go.html#7293948">block</a></span><span class="op" id="7294445">.</span><span class="ident" id="7294446">Bytes</span><span class="op" id="7294451">)</span>&nbsp;<span class="op" id="7294453">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294457"><a href="/crypto/x509/x509_test.go.html#7293931">t</a></span><span class="op" id="7294458">.</span><span class="ident" id="7294459">Errorf</span><span class="op" id="7294465">(</span><span class="string" id="7294466">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7294527">,</span>&nbsp;<span class="ident" id="7294529"><a href="/crypto/x509/x509_test.go.html#7294260">pubBytes2</a></span><span class="op" id="7294538">,</span>&nbsp;<span class="ident" id="7294540"><a href="/crypto/x509/x509_test.go.html#7293948">block</a></span><span class="op" id="7294545">.</span><span class="ident" id="7294546">Bytes</span><span class="op" id="7294551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294554">}</span><br>
<span class="lineno"></span><span class="op" id="7294556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7294559">var</span>&nbsp;<span class="ident" id="7294563">pemPublicKey</span>&nbsp;<span class="op" id="7294576">=</span>&nbsp;<span class="string" id="7294578">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7295033">var</span>&nbsp;<span class="ident" id="7295037">pemPrivateKey</span>&nbsp;<span class="op" id="7295051">=</span>&nbsp;<span class="string" id="7295053">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7295550">func</span>&nbsp;<span class="ident" id="7295555">bigFromString</span><span class="op" id="7295568">(</span><span class="ident" id="7295569">s</span>&nbsp;<span class="builtintype" id="7295571">string</span><span class="op" id="7295577">)</span>&nbsp;<span class="op" id="7295579">*</span><span class="ident" id="7295580"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7295583">.</span><span class="ident" id="7295584">Int</span>&nbsp;<span class="op" id="7295588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295591">ret</span>&nbsp;<span class="op" id="7295595">:=</span>&nbsp;<span class="builtinfunc" id="7295598">new</span><span class="op" id="7295601">(</span><span class="ident" id="7295602"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7295605">.</span><span class="ident" id="7295606">Int</span><span class="op" id="7295609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295612"><a href="/crypto/x509/x509_test.go.html#7295591">ret</a></span><span class="op" id="7295615">.</span><span class="ident" id="7295616">SetString</span><span class="op" id="7295625">(</span><span class="ident" id="7295626"><a href="/crypto/x509/x509_test.go.html#7295569">s</a></span><span class="op" id="7295627">,</span>&nbsp;<span class="num" id="7295629">10</span><span class="op" id="7295631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295634">return</span>&nbsp;<span class="ident" id="7295641"><a href="/crypto/x509/x509_test.go.html#7295591">ret</a></span><br>
<span class="lineno">95</span><span class="op" id="7295645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7295648">func</span>&nbsp;<span class="ident" id="7295653">fromBase10</span><span class="op" id="7295663">(</span><span class="ident" id="7295664">base10</span>&nbsp;<span class="builtintype" id="7295671">string</span><span class="op" id="7295677">)</span>&nbsp;<span class="op" id="7295679">*</span><span class="ident" id="7295680"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7295683">.</span><span class="ident" id="7295684">Int</span>&nbsp;<span class="op" id="7295688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295691">i</span>&nbsp;<span class="op" id="7295693">:=</span>&nbsp;<span class="builtinfunc" id="7295696">new</span><span class="op" id="7295699">(</span><span class="ident" id="7295700"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7295703">.</span><span class="ident" id="7295704">Int</span><span class="op" id="7295707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295710"><a href="/crypto/x509/x509_test.go.html#7295691">i</a></span><span class="op" id="7295711">.</span><span class="ident" id="7295712">SetString</span><span class="op" id="7295721">(</span><span class="ident" id="7295722"><a href="/crypto/x509/x509_test.go.html#7295664">base10</a></span><span class="op" id="7295728">,</span>&nbsp;<span class="num" id="7295730">10</span><span class="op" id="7295732">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295735">return</span>&nbsp;<span class="ident" id="7295742"><a href="/crypto/x509/x509_test.go.html#7295691">i</a></span><br>
<span class="lineno"></span><span class="op" id="7295744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7295747">func</span>&nbsp;<span class="ident" id="7295752">bigFromHexString</span><span class="op" id="7295768">(</span><span class="ident" id="7295769">s</span>&nbsp;<span class="builtintype" id="7295771">string</span><span class="op" id="7295777">)</span>&nbsp;<span class="op" id="7295779">*</span><span class="ident" id="7295780"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7295783">.</span><span class="ident" id="7295784">Int</span>&nbsp;<span class="op" id="7295788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295791">ret</span>&nbsp;<span class="op" id="7295795">:=</span>&nbsp;<span class="builtinfunc" id="7295798">new</span><span class="op" id="7295801">(</span><span class="ident" id="7295802"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7295805">.</span><span class="ident" id="7295806">Int</span><span class="op" id="7295809">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295812"><a href="/crypto/x509/x509_test.go.html#7295791">ret</a></span><span class="op" id="7295815">.</span><span class="ident" id="7295816">SetString</span><span class="op" id="7295825">(</span><span class="ident" id="7295826"><a href="/crypto/x509/x509_test.go.html#7295769">s</a></span><span class="op" id="7295827">,</span>&nbsp;<span class="num" id="7295829">16</span><span class="op" id="7295831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7295834">return</span>&nbsp;<span class="ident" id="7295841"><a href="/crypto/x509/x509_test.go.html#7295791">ret</a></span><br>
<span class="lineno"></span><span class="op" id="7295845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7295848">var</span>&nbsp;<span class="ident" id="7295852">rsaPrivateKey</span>&nbsp;<span class="op" id="7295866">=</span>&nbsp;<span class="op" id="7295868">&amp;</span><span class="ident" id="7295869"><a href="/crypto/x509/x509_test.go.html#7293155">rsa</a></span><span class="op" id="7295872">.</span><span class="ident" id="7295873">PrivateKey</span><span class="op" id="7295883">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295886">PublicKey</span><span class="op" id="7295895">:</span>&nbsp;<span class="ident" id="7295897"><a href="/crypto/x509/x509_test.go.html#7293155">rsa</a></span><span class="op" id="7295900">.</span><span class="ident" id="7295901">PublicKey</span><span class="op" id="7295910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295914">N</span><span class="op" id="7295915">:</span>&nbsp;<span class="ident" id="7295917"><a href="/crypto/x509/x509_test.go.html#7295555">bigFromString</a></span><span class="op" id="7295930">(</span><span class="string" id="7295931">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7296087">)</span><span class="op" id="7296088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296092">E</span><span class="op" id="7296093">:</span>&nbsp;<span class="num" id="7296095">65537</span><span class="op" id="7296100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296103">}</span><span class="op" id="7296104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296107">D</span><span class="op" id="7296108">:</span>&nbsp;<span class="ident" id="7296110"><a href="/crypto/x509/x509_test.go.html#7295555">bigFromString</a></span><span class="op" id="7296123">(</span><span class="string" id="7296124">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7296280">)</span><span class="op" id="7296281">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296284">Primes</span><span class="op" id="7296290">:</span>&nbsp;<span class="op" id="7296292">[</span><span class="op" id="7296293">]</span><span class="op" id="7296294">*</span><span class="ident" id="7296295"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7296298">.</span><span class="ident" id="7296299">Int</span><span class="op" id="7296302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296306"><a href="/crypto/x509/x509_test.go.html#7295555">bigFromString</a></span><span class="op" id="7296319">(</span><span class="string" id="7296320">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7296399">)</span><span class="op" id="7296400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296404"><a href="/crypto/x509/x509_test.go.html#7295555">bigFromString</a></span><span class="op" id="7296417">(</span><span class="string" id="7296418">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7296497">)</span><span class="op" id="7296498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296501">}</span><span class="op" id="7296502">,</span><br>
<span class="lineno"></span><span class="op" id="7296504">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7296507">func</span>&nbsp;<span class="ident" id="7296512">TestMarshalRSAPrivateKey</span><span class="op" id="7296536">(</span><span class="ident" id="7296537">t</span>&nbsp;<span class="op" id="7296539">*</span><span class="ident" id="7296540"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7296547">.</span><span class="ident" id="7296548">T</span><span class="op" id="7296549">)</span>&nbsp;<span class="op" id="7296551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296554">priv</span>&nbsp;<span class="op" id="7296559">:=</span>&nbsp;<span class="op" id="7296562">&amp;</span><span class="ident" id="7296563"><a href="/crypto/x509/x509_test.go.html#7293155">rsa</a></span><span class="op" id="7296566">.</span><span class="ident" id="7296567">PrivateKey</span><span class="op" id="7296577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296581">PublicKey</span><span class="op" id="7296590">:</span>&nbsp;<span class="ident" id="7296592"><a href="/crypto/x509/x509_test.go.html#7293155">rsa</a></span><span class="op" id="7296595">.</span><span class="ident" id="7296596">PublicKey</span><span class="op" id="7296605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296610">N</span><span class="op" id="7296611">:</span>&nbsp;<span class="ident" id="7296613"><a href="/crypto/x509/x509_test.go.html#7295653">fromBase10</a></span><span class="op" id="7296623">(</span><span class="string" id="7296624">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7297243">)</span><span class="op" id="7297244">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297249">E</span><span class="op" id="7297250">:</span>&nbsp;<span class="num" id="7297252">3</span><span class="op" id="7297253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297257">}</span><span class="op" id="7297258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297262">D</span><span class="op" id="7297263">:</span>&nbsp;<span class="ident" id="7297265"><a href="/crypto/x509/x509_test.go.html#7295653">fromBase10</a></span><span class="op" id="7297275">(</span><span class="string" id="7297276">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7297895">)</span><span class="op" id="7297896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297900">Primes</span><span class="op" id="7297906">:</span>&nbsp;<span class="op" id="7297908">[</span><span class="op" id="7297909">]</span><span class="op" id="7297910">*</span><span class="ident" id="7297911"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7297914">.</span><span class="ident" id="7297915">Int</span><span class="op" id="7297918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297923"><a href="/crypto/x509/x509_test.go.html#7295653">fromBase10</a></span><span class="op" id="7297933">(</span><span class="string" id="7297934">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7298144">)</span><span class="op" id="7298145">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298150"><a href="/crypto/x509/x509_test.go.html#7295653">fromBase10</a></span><span class="op" id="7298160">(</span><span class="string" id="7298161">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7298368">)</span><span class="op" id="7298369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298374"><a href="/crypto/x509/x509_test.go.html#7295653">fromBase10</a></span><span class="op" id="7298384">(</span><span class="string" id="7298385">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7298592">)</span><span class="op" id="7298593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298597">}</span><span class="op" id="7298598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298605">derBytes</span>&nbsp;<span class="op" id="7298614">:=</span>&nbsp;<span class="ident" id="7298617"><a href="/crypto/x509/pkcs1.go.html#4008841">MarshalPKCS1PrivateKey</a></span><span class="op" id="7298639">(</span><span class="ident" id="7298640"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7298644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298648">priv2</span><span class="op" id="7298653">,</span>&nbsp;<span class="ident" id="7298655">err</span>&nbsp;<span class="op" id="7298659">:=</span>&nbsp;<span class="ident" id="7298662"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7298682">(</span><span class="ident" id="7298683"><a href="/crypto/x509/x509_test.go.html#7298605">derBytes</a></span><span class="op" id="7298691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298694">if</span>&nbsp;<span class="ident" id="7298697"><a href="/crypto/x509/x509_test.go.html#7298655">err</a></span>&nbsp;<span class="op" id="7298701">!=</span>&nbsp;<span class="ident" id="7298704">nil</span>&nbsp;<span class="op" id="7298708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298712"><a href="/crypto/x509/x509_test.go.html#7296537">t</a></span><span class="op" id="7298713">.</span><span class="ident" id="7298714">Errorf</span><span class="op" id="7298720">(</span><span class="string" id="7298721">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7298755">,</span>&nbsp;<span class="ident" id="7298757"><a href="/crypto/x509/x509_test.go.html#7298655">err</a></span><span class="op" id="7298760">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298764">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298775">if</span>&nbsp;<span class="ident" id="7298778"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7298782">.</span><span class="ident" id="7298783">PublicKey</span><span class="op" id="7298792">.</span><span class="ident" id="7298793">N</span><span class="op" id="7298794">.</span><span class="ident" id="7298795">Cmp</span><span class="op" id="7298798">(</span><span class="ident" id="7298799"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7298804">.</span><span class="ident" id="7298805">PublicKey</span><span class="op" id="7298814">.</span><span class="ident" id="7298815">N</span><span class="op" id="7298816">)</span>&nbsp;<span class="op" id="7298818">!=</span>&nbsp;<span class="num" id="7298821">0</span>&nbsp;<span class="op" id="7298823">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298828"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7298832">.</span><span class="ident" id="7298833">PublicKey</span><span class="op" id="7298842">.</span><span class="ident" id="7298843">E</span>&nbsp;<span class="op" id="7298845">!=</span>&nbsp;<span class="ident" id="7298848"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7298853">.</span><span class="ident" id="7298854">PublicKey</span><span class="op" id="7298863">.</span><span class="ident" id="7298864">E</span>&nbsp;<span class="op" id="7298866">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298871"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7298875">.</span><span class="ident" id="7298876">D</span><span class="op" id="7298877">.</span><span class="ident" id="7298878">Cmp</span><span class="op" id="7298881">(</span><span class="ident" id="7298882"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7298887">.</span><span class="ident" id="7298888">D</span><span class="op" id="7298889">)</span>&nbsp;<span class="op" id="7298891">!=</span>&nbsp;<span class="num" id="7298894">0</span>&nbsp;<span class="op" id="7298896">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7298901">len</span><span class="op" id="7298904">(</span><span class="ident" id="7298905"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7298910">.</span><span class="ident" id="7298911">Primes</span><span class="op" id="7298917">)</span>&nbsp;<span class="op" id="7298919">!=</span>&nbsp;<span class="num" id="7298922">3</span>&nbsp;<span class="op" id="7298924">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298929"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7298933">.</span><span class="ident" id="7298934">Primes</span><span class="op" id="7298940">[</span><span class="num" id="7298941">0</span><span class="op" id="7298942">]</span><span class="op" id="7298943">.</span><span class="ident" id="7298944">Cmp</span><span class="op" id="7298947">(</span><span class="ident" id="7298948"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7298953">.</span><span class="ident" id="7298954">Primes</span><span class="op" id="7298960">[</span><span class="num" id="7298961">0</span><span class="op" id="7298962">]</span><span class="op" id="7298963">)</span>&nbsp;<span class="op" id="7298965">!=</span>&nbsp;<span class="num" id="7298968">0</span>&nbsp;<span class="op" id="7298970">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298975"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7298979">.</span><span class="ident" id="7298980">Primes</span><span class="op" id="7298986">[</span><span class="num" id="7298987">1</span><span class="op" id="7298988">]</span><span class="op" id="7298989">.</span><span class="ident" id="7298990">Cmp</span><span class="op" id="7298993">(</span><span class="ident" id="7298994"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7298999">.</span><span class="ident" id="7299000">Primes</span><span class="op" id="7299006">[</span><span class="num" id="7299007">1</span><span class="op" id="7299008">]</span><span class="op" id="7299009">)</span>&nbsp;<span class="op" id="7299011">!=</span>&nbsp;<span class="num" id="7299014">0</span>&nbsp;<span class="op" id="7299016">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299021"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7299025">.</span><span class="ident" id="7299026">Primes</span><span class="op" id="7299032">[</span><span class="num" id="7299033">2</span><span class="op" id="7299034">]</span><span class="op" id="7299035">.</span><span class="ident" id="7299036">Cmp</span><span class="op" id="7299039">(</span><span class="ident" id="7299040"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7299045">.</span><span class="ident" id="7299046">Primes</span><span class="op" id="7299052">[</span><span class="num" id="7299053">2</span><span class="op" id="7299054">]</span><span class="op" id="7299055">)</span>&nbsp;<span class="op" id="7299057">!=</span>&nbsp;<span class="num" id="7299060">0</span>&nbsp;<span class="op" id="7299062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299066"><a href="/crypto/x509/x509_test.go.html#7296537">t</a></span><span class="op" id="7299067">.</span><span class="ident" id="7299068">Errorf</span><span class="op" id="7299074">(</span><span class="string" id="7299075">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7299093">,</span>&nbsp;<span class="ident" id="7299095"><a href="/crypto/x509/x509_test.go.html#7296554">priv</a></span><span class="op" id="7299099">,</span>&nbsp;<span class="ident" id="7299101"><a href="/crypto/x509/x509_test.go.html#7298648">priv2</a></span><span class="op" id="7299106">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299109">}</span><br>
<span class="lineno"></span><span class="op" id="7299111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7299114">type</span>&nbsp;<span class="ident" id="7299119">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7299138">struct</span>&nbsp;<span class="op" id="7299145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299148">pattern</span><span class="op" id="7299155">,</span>&nbsp;<span class="ident" id="7299157">host</span>&nbsp;<span class="builtintype" id="7299162">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299170">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7299184">bool</span><br>
<span class="lineno"></span><span class="op" id="7299189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7299192">var</span>&nbsp;<span class="ident" id="7299196">matchHostnamesTests</span>&nbsp;<span class="op" id="7299216">=</span>&nbsp;<span class="op" id="7299218">[</span><span class="op" id="7299219">]</span><span class="ident" id="7299220"><a href="/crypto/x509/x509_test.go.html#7299119">matchHostnamesTest</a></span><span class="op" id="7299238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299241">{</span><span class="string" id="7299242">&#34;a.b.c&#34;</span><span class="op" id="7299249">,</span>&nbsp;<span class="string" id="7299251">&#34;a.b.c&#34;</span><span class="op" id="7299258">,</span>&nbsp;<span class="builtintype" id="7299260">true</span><span class="op" id="7299264">}</span><span class="op" id="7299265">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299268">{</span><span class="string" id="7299269">&#34;a.b.c&#34;</span><span class="op" id="7299276">,</span>&nbsp;<span class="string" id="7299278">&#34;b.b.c&#34;</span><span class="op" id="7299285">,</span>&nbsp;<span class="builtintype" id="7299287">false</span><span class="op" id="7299292">}</span><span class="op" id="7299293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299296">{</span><span class="string" id="7299297">&#34;&#34;</span><span class="op" id="7299299">,</span>&nbsp;<span class="string" id="7299301">&#34;b.b.c&#34;</span><span class="op" id="7299308">,</span>&nbsp;<span class="builtintype" id="7299310">false</span><span class="op" id="7299315">}</span><span class="op" id="7299316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299319">{</span><span class="string" id="7299320">&#34;a.b.c&#34;</span><span class="op" id="7299327">,</span>&nbsp;<span class="string" id="7299329">&#34;&#34;</span><span class="op" id="7299331">,</span>&nbsp;<span class="builtintype" id="7299333">false</span><span class="op" id="7299338">}</span><span class="op" id="7299339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299342">{</span><span class="string" id="7299343">&#34;example.com&#34;</span><span class="op" id="7299356">,</span>&nbsp;<span class="string" id="7299358">&#34;example.com&#34;</span><span class="op" id="7299371">,</span>&nbsp;<span class="builtintype" id="7299373">true</span><span class="op" id="7299377">}</span><span class="op" id="7299378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299381">{</span><span class="string" id="7299382">&#34;example.com&#34;</span><span class="op" id="7299395">,</span>&nbsp;<span class="string" id="7299397">&#34;www.example.com&#34;</span><span class="op" id="7299414">,</span>&nbsp;<span class="builtintype" id="7299416">false</span><span class="op" id="7299421">}</span><span class="op" id="7299422">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299425">{</span><span class="string" id="7299426">&#34;*.example.com&#34;</span><span class="op" id="7299441">,</span>&nbsp;<span class="string" id="7299443">&#34;www.example.com&#34;</span><span class="op" id="7299460">,</span>&nbsp;<span class="builtintype" id="7299462">true</span><span class="op" id="7299466">}</span><span class="op" id="7299467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299470">{</span><span class="string" id="7299471">&#34;*.example.com&#34;</span><span class="op" id="7299486">,</span>&nbsp;<span class="string" id="7299488">&#34;xyz.www.example.com&#34;</span><span class="op" id="7299509">,</span>&nbsp;<span class="builtintype" id="7299511">false</span><span class="op" id="7299516">}</span><span class="op" id="7299517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299520">{</span><span class="string" id="7299521">&#34;*.*.example.com&#34;</span><span class="op" id="7299538">,</span>&nbsp;<span class="string" id="7299540">&#34;xyz.www.example.com&#34;</span><span class="op" id="7299561">,</span>&nbsp;<span class="builtintype" id="7299563">true</span><span class="op" id="7299567">}</span><span class="op" id="7299568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299571">{</span><span class="string" id="7299572">&#34;*.www.*.com&#34;</span><span class="op" id="7299585">,</span>&nbsp;<span class="string" id="7299587">&#34;xyz.www.example.com&#34;</span><span class="op" id="7299608">,</span>&nbsp;<span class="builtintype" id="7299610">true</span><span class="op" id="7299614">}</span><span class="op" id="7299615">,</span><br>
<span class="lineno"></span><span class="op" id="7299617">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7299620">func</span>&nbsp;<span class="ident" id="7299625">TestMatchHostnames</span><span class="op" id="7299643">(</span><span class="ident" id="7299644">t</span>&nbsp;<span class="op" id="7299646">*</span><span class="ident" id="7299647"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7299654">.</span><span class="ident" id="7299655">T</span><span class="op" id="7299656">)</span>&nbsp;<span class="op" id="7299658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299661">for</span>&nbsp;<span class="ident" id="7299665">i</span><span class="op" id="7299666">,</span>&nbsp;<span class="ident" id="7299668">test</span>&nbsp;<span class="op" id="7299673">:=</span>&nbsp;<span class="keyword" id="7299676">range</span>&nbsp;<span class="ident" id="7299682"><a href="/crypto/x509/x509_test.go.html#7299196">matchHostnamesTests</a></span>&nbsp;<span class="op" id="7299702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299706">r</span>&nbsp;<span class="op" id="7299708">:=</span>&nbsp;<span class="ident" id="7299711"><a href="/crypto/x509/verify.go.html#4025975">matchHostnames</a></span><span class="op" id="7299725">(</span><span class="ident" id="7299726"><a href="/crypto/x509/x509_test.go.html#7299668">test</a></span><span class="op" id="7299730">.</span><span class="ident" id="7299731">pattern</span><span class="op" id="7299738">,</span>&nbsp;<span class="ident" id="7299740"><a href="/crypto/x509/x509_test.go.html#7299668">test</a></span><span class="op" id="7299744">.</span><span class="ident" id="7299745">host</span><span class="op" id="7299749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299753">if</span>&nbsp;<span class="ident" id="7299756"><a href="/crypto/x509/x509_test.go.html#7299706">r</a></span>&nbsp;<span class="op" id="7299758">!=</span>&nbsp;<span class="ident" id="7299761"><a href="/crypto/x509/x509_test.go.html#7299668">test</a></span><span class="op" id="7299765">.</span><span class="ident" id="7299766">ok</span>&nbsp;<span class="op" id="7299769">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299774"><a href="/crypto/x509/x509_test.go.html#7299644">t</a></span><span class="op" id="7299775">.</span><span class="ident" id="7299776">Errorf</span><span class="op" id="7299782">(</span><span class="string" id="7299783">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7299814">,</span>&nbsp;<span class="ident" id="7299816"><a href="/crypto/x509/x509_test.go.html#7299665">i</a></span><span class="op" id="7299817">,</span>&nbsp;<span class="ident" id="7299819"><a href="/crypto/x509/x509_test.go.html#7299706">r</a></span><span class="op" id="7299820">,</span>&nbsp;<span class="ident" id="7299822"><a href="/crypto/x509/x509_test.go.html#7299668">test</a></span><span class="op" id="7299826">.</span><span class="ident" id="7299827">ok</span><span class="op" id="7299829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299836">}</span><br>
<span class="lineno"></span><span class="op" id="7299838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7299841">func</span>&nbsp;<span class="ident" id="7299846">TestMatchIP</span><span class="op" id="7299857">(</span><span class="ident" id="7299858">t</span>&nbsp;<span class="op" id="7299860">*</span><span class="ident" id="7299861"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7299868">.</span><span class="ident" id="7299869">T</span><span class="op" id="7299870">)</span>&nbsp;<span class="op" id="7299872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7299875">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299919">c</span>&nbsp;<span class="op" id="7299921">:=</span>&nbsp;<span class="op" id="7299924">&amp;</span><span class="ident" id="7299925"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="7299936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299940">DNSNames</span><span class="op" id="7299948">:</span>&nbsp;<span class="op" id="7299950">[</span><span class="op" id="7299951">]</span><span class="builtintype" id="7299952">string</span><span class="op" id="7299958">{</span><span class="string" id="7299959">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7299974">}</span><span class="op" id="7299975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299979">Subject</span><span class="op" id="7299986">:</span>&nbsp;<span class="ident" id="7299988"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7299992">.</span><span class="ident" id="7299993">Name</span><span class="op" id="7299997">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300002">CommonName</span><span class="op" id="7300012">:</span>&nbsp;<span class="string" id="7300014">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7300029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300033">}</span><span class="op" id="7300034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300040">err</span>&nbsp;<span class="op" id="7300044">:=</span>&nbsp;<span class="ident" id="7300047"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span><span class="op" id="7300048">.</span><span class="ident" id="7300049">VerifyHostname</span><span class="op" id="7300063">(</span><span class="string" id="7300064">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7300082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300085">if</span>&nbsp;<span class="ident" id="7300088"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300092">!=</span>&nbsp;<span class="ident" id="7300095">nil</span>&nbsp;<span class="op" id="7300099">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300103"><a href="/crypto/x509/x509_test.go.html#7299858">t</a></span><span class="op" id="7300104">.</span><span class="ident" id="7300105">Fatalf</span><span class="op" id="7300111">(</span><span class="string" id="7300112">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7300150">,</span>&nbsp;<span class="ident" id="7300152"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span><span class="op" id="7300155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7300162">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7300235">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300255"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span>&nbsp;<span class="op" id="7300257">=</span>&nbsp;<span class="op" id="7300259">&amp;</span><span class="ident" id="7300260"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="7300271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300275">DNSNames</span><span class="op" id="7300283">:</span>&nbsp;<span class="op" id="7300285">[</span><span class="op" id="7300286">]</span><span class="builtintype" id="7300287">string</span><span class="op" id="7300293">{</span><span class="string" id="7300294">&#34;*.2.3.4&#34;</span><span class="op" id="7300303">}</span><span class="op" id="7300304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300308">Subject</span><span class="op" id="7300315">:</span>&nbsp;<span class="ident" id="7300317"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7300321">.</span><span class="ident" id="7300322">Name</span><span class="op" id="7300326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300331">CommonName</span><span class="op" id="7300341">:</span>&nbsp;<span class="string" id="7300343">&#34;*.2.3.4&#34;</span><span class="op" id="7300352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300356">}</span><span class="op" id="7300357">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300363"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300367">=</span>&nbsp;<span class="ident" id="7300369"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span><span class="op" id="7300370">.</span><span class="ident" id="7300371">VerifyHostname</span><span class="op" id="7300385">(</span><span class="string" id="7300386">&#34;1.2.3.4&#34;</span><span class="op" id="7300395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300398">if</span>&nbsp;<span class="ident" id="7300401"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300405">==</span>&nbsp;<span class="ident" id="7300408">nil</span>&nbsp;<span class="op" id="7300412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300416"><a href="/crypto/x509/x509_test.go.html#7299858">t</a></span><span class="op" id="7300417">.</span><span class="ident" id="7300418">Fatalf</span><span class="op" id="7300424">(</span><span class="string" id="7300425">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7300478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300481">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300485"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span>&nbsp;<span class="op" id="7300487">=</span>&nbsp;<span class="op" id="7300489">&amp;</span><span class="ident" id="7300490"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="7300501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300505">IPAddresses</span><span class="op" id="7300516">:</span>&nbsp;<span class="op" id="7300518">[</span><span class="op" id="7300519">]</span><span class="ident" id="7300520"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7300523">.</span><span class="ident" id="7300524">IP</span><span class="op" id="7300526">{</span><span class="ident" id="7300527"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7300530">.</span><span class="ident" id="7300531">ParseIP</span><span class="op" id="7300538">(</span><span class="string" id="7300539">&#34;127.0.0.1&#34;</span><span class="op" id="7300550">)</span><span class="op" id="7300551">,</span>&nbsp;<span class="ident" id="7300553"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7300556">.</span><span class="ident" id="7300557">ParseIP</span><span class="op" id="7300564">(</span><span class="string" id="7300565">&#34;::1&#34;</span><span class="op" id="7300570">)</span><span class="op" id="7300571">}</span><span class="op" id="7300572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300578"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300582">=</span>&nbsp;<span class="ident" id="7300584"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span><span class="op" id="7300585">.</span><span class="ident" id="7300586">VerifyHostname</span><span class="op" id="7300600">(</span><span class="string" id="7300601">&#34;127.0.0.1&#34;</span><span class="op" id="7300612">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300615">if</span>&nbsp;<span class="ident" id="7300618"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300622">!=</span>&nbsp;<span class="ident" id="7300625">nil</span>&nbsp;<span class="op" id="7300629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300633"><a href="/crypto/x509/x509_test.go.html#7299858">t</a></span><span class="op" id="7300634">.</span><span class="ident" id="7300635">Fatalf</span><span class="op" id="7300641">(</span><span class="string" id="7300642">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7300673">,</span>&nbsp;<span class="ident" id="7300675"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span><span class="op" id="7300678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300684"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300688">=</span>&nbsp;<span class="ident" id="7300690"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span><span class="op" id="7300691">.</span><span class="ident" id="7300692">VerifyHostname</span><span class="op" id="7300706">(</span><span class="string" id="7300707">&#34;::1&#34;</span><span class="op" id="7300712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300715">if</span>&nbsp;<span class="ident" id="7300718"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300722">!=</span>&nbsp;<span class="ident" id="7300725">nil</span>&nbsp;<span class="op" id="7300729">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300733"><a href="/crypto/x509/x509_test.go.html#7299858">t</a></span><span class="op" id="7300734">.</span><span class="ident" id="7300735">Fatalf</span><span class="op" id="7300741">(</span><span class="string" id="7300742">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7300767">,</span>&nbsp;<span class="ident" id="7300769"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span><span class="op" id="7300772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300778"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300782">=</span>&nbsp;<span class="ident" id="7300784"><a href="/crypto/x509/x509_test.go.html#7299919">c</a></span><span class="op" id="7300785">.</span><span class="ident" id="7300786">VerifyHostname</span><span class="op" id="7300800">(</span><span class="string" id="7300801">&#34;[::1]&#34;</span><span class="op" id="7300808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300811">if</span>&nbsp;<span class="ident" id="7300814"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span>&nbsp;<span class="op" id="7300818">!=</span>&nbsp;<span class="ident" id="7300821">nil</span>&nbsp;<span class="op" id="7300825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300829"><a href="/crypto/x509/x509_test.go.html#7299858">t</a></span><span class="op" id="7300830">.</span><span class="ident" id="7300831">Fatalf</span><span class="op" id="7300837">(</span><span class="string" id="7300838">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7300865">,</span>&nbsp;<span class="ident" id="7300867"><a href="/crypto/x509/x509_test.go.html#7300040">err</a></span><span class="op" id="7300870">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7300873">}</span><br>
<span class="lineno"></span><span class="op" id="7300875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7300878">func</span>&nbsp;<span class="ident" id="7300883">TestCertificateParse</span><span class="op" id="7300903">(</span><span class="ident" id="7300904">t</span>&nbsp;<span class="op" id="7300906">*</span><span class="ident" id="7300907"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7300914">.</span><span class="ident" id="7300915">T</span><span class="op" id="7300916">)</span>&nbsp;<span class="op" id="7300918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300921">s</span><span class="op" id="7300922">,</span>&nbsp;<span class="ident" id="7300924">_</span>&nbsp;<span class="op" id="7300926">:=</span>&nbsp;<span class="ident" id="7300929"><a href="/crypto/x509/x509_test.go.html#7293263">hex</a></span><span class="op" id="7300932">.</span><span class="ident" id="7300933">DecodeString</span><span class="op" id="7300945">(</span><span class="ident" id="7300946"><a href="/crypto/x509/x509_test.go.html#7301459">certBytes</a></span><span class="op" id="7300955">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7300958">certs</span><span class="op" id="7300963">,</span>&nbsp;<span class="ident" id="7300965">err</span>&nbsp;<span class="op" id="7300969">:=</span>&nbsp;<span class="ident" id="7300972"><a href="/crypto/x509/x509.go.html#4064379">ParseCertificates</a></span><span class="op" id="7300989">(</span><span class="ident" id="7300990"><a href="/crypto/x509/x509_test.go.html#7300921">s</a></span><span class="op" id="7300991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7300994">if</span>&nbsp;<span class="ident" id="7300997"><a href="/crypto/x509/x509_test.go.html#7300965">err</a></span>&nbsp;<span class="op" id="7301001">!=</span>&nbsp;<span class="ident" id="7301004">nil</span>&nbsp;<span class="op" id="7301008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301012"><a href="/crypto/x509/x509_test.go.html#7300904">t</a></span><span class="op" id="7301013">.</span><span class="ident" id="7301014">Error</span><span class="op" id="7301019">(</span><span class="ident" id="7301020"><a href="/crypto/x509/x509_test.go.html#7300965">err</a></span><span class="op" id="7301023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301029">if</span>&nbsp;<span class="builtinfunc" id="7301032">len</span><span class="op" id="7301035">(</span><span class="ident" id="7301036"><a href="/crypto/x509/x509_test.go.html#7300958">certs</a></span><span class="op" id="7301041">)</span>&nbsp;<span class="op" id="7301043">!=</span>&nbsp;<span class="num" id="7301046">2</span>&nbsp;<span class="op" id="7301048">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301052"><a href="/crypto/x509/x509_test.go.html#7300904">t</a></span><span class="op" id="7301053">.</span><span class="ident" id="7301054">Errorf</span><span class="op" id="7301060">(</span><span class="string" id="7301061">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7301099">,</span>&nbsp;<span class="builtinfunc" id="7301101">len</span><span class="op" id="7301104">(</span><span class="ident" id="7301105"><a href="/crypto/x509/x509_test.go.html#7300958">certs</a></span><span class="op" id="7301110">)</span><span class="op" id="7301111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301115">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301127"><a href="/crypto/x509/x509_test.go.html#7300965">err</a></span>&nbsp;<span class="op" id="7301131">=</span>&nbsp;<span class="ident" id="7301133"><a href="/crypto/x509/x509_test.go.html#7300958">certs</a></span><span class="op" id="7301138">[</span><span class="num" id="7301139">0</span><span class="op" id="7301140">]</span><span class="op" id="7301141">.</span><span class="ident" id="7301142">CheckSignatureFrom</span><span class="op" id="7301160">(</span><span class="ident" id="7301161"><a href="/crypto/x509/x509_test.go.html#7300958">certs</a></span><span class="op" id="7301166">[</span><span class="num" id="7301167">1</span><span class="op" id="7301168">]</span><span class="op" id="7301169">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301172">if</span>&nbsp;<span class="ident" id="7301175"><a href="/crypto/x509/x509_test.go.html#7300965">err</a></span>&nbsp;<span class="op" id="7301179">!=</span>&nbsp;<span class="ident" id="7301182">nil</span>&nbsp;<span class="op" id="7301186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301190"><a href="/crypto/x509/x509_test.go.html#7300904">t</a></span><span class="op" id="7301191">.</span><span class="ident" id="7301192">Error</span><span class="op" id="7301197">(</span><span class="ident" id="7301198"><a href="/crypto/x509/x509_test.go.html#7300965">err</a></span><span class="op" id="7301201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301208">if</span>&nbsp;<span class="ident" id="7301211">err</span>&nbsp;<span class="op" id="7301215">:=</span>&nbsp;<span class="ident" id="7301218"><a href="/crypto/x509/x509_test.go.html#7300958">certs</a></span><span class="op" id="7301223">[</span><span class="num" id="7301224">0</span><span class="op" id="7301225">]</span><span class="op" id="7301226">.</span><span class="ident" id="7301227">VerifyHostname</span><span class="op" id="7301241">(</span><span class="string" id="7301242">&#34;mail.google.com&#34;</span><span class="op" id="7301259">)</span><span class="op" id="7301260">;</span>&nbsp;<span class="ident" id="7301262"><a href="/crypto/x509/x509_test.go.html#7301211">err</a></span>&nbsp;<span class="op" id="7301266">!=</span>&nbsp;<span class="ident" id="7301269">nil</span>&nbsp;<span class="op" id="7301273">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301277"><a href="/crypto/x509/x509_test.go.html#7300904">t</a></span><span class="op" id="7301278">.</span><span class="ident" id="7301279">Error</span><span class="op" id="7301284">(</span><span class="ident" id="7301285"><a href="/crypto/x509/x509_test.go.html#7301211">err</a></span><span class="op" id="7301288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301295">const</span>&nbsp;<span class="ident" id="7301301">expectedExtensions</span>&nbsp;<span class="op" id="7301320">=</span>&nbsp;<span class="num" id="7301322">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7301325">if</span>&nbsp;<span class="ident" id="7301328">n</span>&nbsp;<span class="op" id="7301330">:=</span>&nbsp;<span class="builtinfunc" id="7301333">len</span><span class="op" id="7301336">(</span><span class="ident" id="7301337"><a href="/crypto/x509/x509_test.go.html#7300958">certs</a></span><span class="op" id="7301342">[</span><span class="num" id="7301343">0</span><span class="op" id="7301344">]</span><span class="op" id="7301345">.</span><span class="ident" id="7301346">Extensions</span><span class="op" id="7301356">)</span><span class="op" id="7301357">;</span>&nbsp;<span class="ident" id="7301359"><a href="/crypto/x509/x509_test.go.html#7301328">n</a></span>&nbsp;<span class="op" id="7301361">!=</span>&nbsp;<span class="ident" id="7301364"><a href="/crypto/x509/x509_test.go.html#7301301">expectedExtensions</a></span>&nbsp;<span class="op" id="7301383">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7301387"><a href="/crypto/x509/x509_test.go.html#7300904">t</a></span><span class="op" id="7301388">.</span><span class="ident" id="7301389">Errorf</span><span class="op" id="7301395">(</span><span class="string" id="7301396">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7301424">,</span>&nbsp;<span class="ident" id="7301426"><a href="/crypto/x509/x509_test.go.html#7301301">expectedExtensions</a></span><span class="op" id="7301444">,</span>&nbsp;<span class="ident" id="7301446"><a href="/crypto/x509/x509_test.go.html#7301328">n</a></span><span class="op" id="7301447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7301450">}</span><br>
<span class="lineno"></span><span class="op" id="7301452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7301455">var</span>&nbsp;<span class="ident" id="7301459">certBytes</span>&nbsp;<span class="op" id="7301469">=</span>&nbsp;<span class="string" id="7301471">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7301552">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301555">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7301636">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301639">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7301720">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301723">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7301804">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301807">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7301888">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301891">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7301972">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7301975">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7302056">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302059">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7302140">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302143">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7302224">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302227">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7302308">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302311">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7302392">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302395">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7302476">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302479">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7302560">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302563">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7302644">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302647">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7302728">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302731">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7302812">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302815">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7302896">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302899">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7302980">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7302983">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7303064">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303067">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7303148">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303151">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7303232">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303235">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7303316">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303319">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7303400">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303403">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7303484">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303487">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7303568">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303571">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7303652">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303655">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7303736">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303739">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7303820">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303823">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7303904">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303907">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7303988">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7303991">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7304072">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304075">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7304156">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304159">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7304240">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304243">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7304324">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304327">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7304408">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304411">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7304492">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304495">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7304576">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304579">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7304660">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304663">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7304744">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304747">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7304828">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304831">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7304912">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7304915">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7304947">func</span>&nbsp;<span class="ident" id="7304952">TestCreateSelfSignedCertificate</span><span class="op" id="7304983">(</span><span class="ident" id="7304984">t</span>&nbsp;<span class="op" id="7304986">*</span><span class="ident" id="7304987"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7304994">.</span><span class="ident" id="7304995">T</span><span class="op" id="7304996">)</span>&nbsp;<span class="op" id="7304998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305001">random</span>&nbsp;<span class="op" id="7305008">:=</span>&nbsp;<span class="ident" id="7305011"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7305015">.</span><span class="ident" id="7305016">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305025">block</span><span class="op" id="7305030">,</span>&nbsp;<span class="ident" id="7305032">_</span>&nbsp;<span class="op" id="7305034">:=</span>&nbsp;<span class="ident" id="7305037"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7305040">.</span><span class="ident" id="7305041">Decode</span><span class="op" id="7305047">(</span><span class="op" id="7305048">[</span><span class="op" id="7305049">]</span><span class="builtintype" id="7305050">byte</span><span class="op" id="7305054">(</span><span class="ident" id="7305055"><a href="/crypto/x509/x509_test.go.html#7295037">pemPrivateKey</a></span><span class="op" id="7305068">)</span><span class="op" id="7305069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305072">rsaPriv</span><span class="op" id="7305079">,</span>&nbsp;<span class="ident" id="7305081">err</span>&nbsp;<span class="op" id="7305085">:=</span>&nbsp;<span class="ident" id="7305088"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7305108">(</span><span class="ident" id="7305109"><a href="/crypto/x509/x509_test.go.html#7305025">block</a></span><span class="op" id="7305114">.</span><span class="ident" id="7305115">Bytes</span><span class="op" id="7305120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305123">if</span>&nbsp;<span class="ident" id="7305126"><a href="/crypto/x509/x509_test.go.html#7305081">err</a></span>&nbsp;<span class="op" id="7305130">!=</span>&nbsp;<span class="ident" id="7305133">nil</span>&nbsp;<span class="op" id="7305137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305141"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7305142">.</span><span class="ident" id="7305143">Fatalf</span><span class="op" id="7305149">(</span><span class="string" id="7305150">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7305183">,</span>&nbsp;<span class="ident" id="7305185"><a href="/crypto/x509/x509_test.go.html#7305081">err</a></span><span class="op" id="7305188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305191">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305195">ecdsaPriv</span><span class="op" id="7305204">,</span>&nbsp;<span class="ident" id="7305206"><a href="/crypto/x509/x509_test.go.html#7305081">err</a></span>&nbsp;<span class="op" id="7305210">:=</span>&nbsp;<span class="ident" id="7305213"><a href="/crypto/x509/x509_test.go.html#7293105">ecdsa</a></span><span class="op" id="7305218">.</span><span class="ident" id="7305219">GenerateKey</span><span class="op" id="7305230">(</span><span class="ident" id="7305231"><a href="/crypto/x509/x509_test.go.html#7293121">elliptic</a></span><span class="op" id="7305239">.</span><span class="ident" id="7305240">P256</span><span class="op" id="7305244">(</span><span class="op" id="7305245">)</span><span class="op" id="7305246">,</span>&nbsp;<span class="ident" id="7305248"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7305252">.</span><span class="ident" id="7305253">Reader</span><span class="op" id="7305259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305262">if</span>&nbsp;<span class="ident" id="7305265"><a href="/crypto/x509/x509_test.go.html#7305081">err</a></span>&nbsp;<span class="op" id="7305269">!=</span>&nbsp;<span class="ident" id="7305272">nil</span>&nbsp;<span class="op" id="7305276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305280"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7305281">.</span><span class="ident" id="7305282">Fatalf</span><span class="op" id="7305288">(</span><span class="string" id="7305289">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7305323">,</span>&nbsp;<span class="ident" id="7305325"><a href="/crypto/x509/x509_test.go.html#7305081">err</a></span><span class="op" id="7305328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305331">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305335">tests</span>&nbsp;<span class="op" id="7305341">:=</span>&nbsp;<span class="op" id="7305344">[</span><span class="op" id="7305345">]</span><span class="keyword" id="7305346">struct</span>&nbsp;<span class="op" id="7305353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305357">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7305367">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305376">pub</span><span class="op" id="7305379">,</span>&nbsp;<span class="ident" id="7305381">priv</span>&nbsp;<span class="keyword" id="7305386">interface</span><span class="op" id="7305395">{</span><span class="op" id="7305396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305400">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7305410">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305417">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7305427"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305447">}</span><span class="op" id="7305448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305452">{</span><span class="string" id="7305453">&#34;RSA/RSA&#34;</span><span class="op" id="7305462">,</span>&nbsp;<span class="op" id="7305464">&amp;</span><span class="ident" id="7305465"><a href="/crypto/x509/x509_test.go.html#7305072">rsaPriv</a></span><span class="op" id="7305472">.</span><span class="ident" id="7305473">PublicKey</span><span class="op" id="7305482">,</span>&nbsp;<span class="ident" id="7305484"><a href="/crypto/x509/x509_test.go.html#7305072">rsaPriv</a></span><span class="op" id="7305491">,</span>&nbsp;<span class="builtintype" id="7305493">true</span><span class="op" id="7305497">,</span>&nbsp;<span class="ident" id="7305499"><a href="/crypto/x509/x509.go.html#4033860">SHA1WithRSA</a></span><span class="op" id="7305510">}</span><span class="op" id="7305511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305515">{</span><span class="string" id="7305516">&#34;RSA/ECDSA&#34;</span><span class="op" id="7305527">,</span>&nbsp;<span class="op" id="7305529">&amp;</span><span class="ident" id="7305530"><a href="/crypto/x509/x509_test.go.html#7305072">rsaPriv</a></span><span class="op" id="7305537">.</span><span class="ident" id="7305538">PublicKey</span><span class="op" id="7305547">,</span>&nbsp;<span class="ident" id="7305549"><a href="/crypto/x509/x509_test.go.html#7305195">ecdsaPriv</a></span><span class="op" id="7305558">,</span>&nbsp;<span class="builtintype" id="7305560">false</span><span class="op" id="7305565">,</span>&nbsp;<span class="ident" id="7305567"><a href="/crypto/x509/x509.go.html#4033978">ECDSAWithSHA384</a></span><span class="op" id="7305582">}</span><span class="op" id="7305583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305587">{</span><span class="string" id="7305588">&#34;ECDSA/RSA&#34;</span><span class="op" id="7305599">,</span>&nbsp;<span class="op" id="7305601">&amp;</span><span class="ident" id="7305602"><a href="/crypto/x509/x509_test.go.html#7305195">ecdsaPriv</a></span><span class="op" id="7305611">.</span><span class="ident" id="7305612">PublicKey</span><span class="op" id="7305621">,</span>&nbsp;<span class="ident" id="7305623"><a href="/crypto/x509/x509_test.go.html#7305072">rsaPriv</a></span><span class="op" id="7305630">,</span>&nbsp;<span class="builtintype" id="7305632">false</span><span class="op" id="7305637">,</span>&nbsp;<span class="ident" id="7305639"><a href="/crypto/x509/x509.go.html#4033873">SHA256WithRSA</a></span><span class="op" id="7305652">}</span><span class="op" id="7305653">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305657">{</span><span class="string" id="7305658">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7305671">,</span>&nbsp;<span class="op" id="7305673">&amp;</span><span class="ident" id="7305674"><a href="/crypto/x509/x509_test.go.html#7305195">ecdsaPriv</a></span><span class="op" id="7305683">.</span><span class="ident" id="7305684">PublicKey</span><span class="op" id="7305693">,</span>&nbsp;<span class="ident" id="7305695"><a href="/crypto/x509/x509_test.go.html#7305195">ecdsaPriv</a></span><span class="op" id="7305704">,</span>&nbsp;<span class="builtintype" id="7305706">true</span><span class="op" id="7305710">,</span>&nbsp;<span class="ident" id="7305712"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="7305725">}</span><span class="op" id="7305726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7305729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305733">testExtKeyUsage</span>&nbsp;<span class="op" id="7305749">:=</span>&nbsp;<span class="op" id="7305752">[</span><span class="op" id="7305753">]</span><span class="ident" id="7305754"><a href="/crypto/x509/x509.go.html#4042520">ExtKeyUsage</a></span><span class="op" id="7305765">{</span><span class="ident" id="7305766"><a href="/crypto/x509/x509.go.html#4042604">ExtKeyUsageClientAuth</a></span><span class="op" id="7305787">,</span>&nbsp;<span class="ident" id="7305789"><a href="/crypto/x509/x509.go.html#4042581">ExtKeyUsageServerAuth</a></span><span class="op" id="7305810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305813">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7305836">:=</span>&nbsp;<span class="op" id="7305839">[</span><span class="op" id="7305840">]</span><span class="ident" id="7305841"><a href="/crypto/x509/x509_test.go.html#7293227">asn1</a></span><span class="op" id="7305845">.</span><span class="ident" id="7305846">ObjectIdentifier</span><span class="op" id="7305862">{</span><span class="op" id="7305863">[</span><span class="op" id="7305864">]</span><span class="builtintype" id="7305865">int</span><span class="op" id="7305868">{</span><span class="num" id="7305869">1</span><span class="op" id="7305870">,</span>&nbsp;<span class="num" id="7305872">2</span><span class="op" id="7305873">,</span>&nbsp;<span class="num" id="7305875">3</span><span class="op" id="7305876">}</span><span class="op" id="7305877">,</span>&nbsp;<span class="op" id="7305879">[</span><span class="op" id="7305880">]</span><span class="builtintype" id="7305881">int</span><span class="op" id="7305884">{</span><span class="num" id="7305885">2</span><span class="op" id="7305886">,</span>&nbsp;<span class="num" id="7305888">59</span><span class="op" id="7305890">,</span>&nbsp;<span class="num" id="7305892">1</span><span class="op" id="7305893">}</span><span class="op" id="7305894">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305897">extraExtensionData</span>&nbsp;<span class="op" id="7305916">:=</span>&nbsp;<span class="op" id="7305919">[</span><span class="op" id="7305920">]</span><span class="builtintype" id="7305921">byte</span><span class="op" id="7305925">(</span><span class="string" id="7305926">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7305943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7305947">for</span>&nbsp;<span class="ident" id="7305951">_</span><span class="op" id="7305952">,</span>&nbsp;<span class="ident" id="7305954">test</span>&nbsp;<span class="op" id="7305959">:=</span>&nbsp;<span class="keyword" id="7305962">range</span>&nbsp;<span class="ident" id="7305968"><a href="/crypto/x509/x509_test.go.html#7305335">tests</a></span>&nbsp;<span class="op" id="7305974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7305978">commonName</span>&nbsp;<span class="op" id="7305989">:=</span>&nbsp;<span class="string" id="7305992">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306013">template</span>&nbsp;<span class="op" id="7306022">:=</span>&nbsp;<span class="ident" id="7306025"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="7306036">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306041">SerialNumber</span><span class="op" id="7306053">:</span>&nbsp;<span class="ident" id="7306055"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7306058">.</span><span class="ident" id="7306059">NewInt</span><span class="op" id="7306065">(</span><span class="num" id="7306066">1</span><span class="op" id="7306067">)</span><span class="op" id="7306068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306073">Subject</span><span class="op" id="7306080">:</span>&nbsp;<span class="ident" id="7306082"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7306086">.</span><span class="ident" id="7306087">Name</span><span class="op" id="7306091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306097">CommonName</span><span class="op" id="7306107">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7306111"><a href="/crypto/x509/x509_test.go.html#7305978">commonName</a></span><span class="op" id="7306121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306127">Organization</span><span class="op" id="7306139">:</span>&nbsp;<span class="op" id="7306141">[</span><span class="op" id="7306142">]</span><span class="builtintype" id="7306143">string</span><span class="op" id="7306149">{</span><span class="string" id="7306150">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7306162">}</span><span class="op" id="7306163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7306168">}</span><span class="op" id="7306169">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306174">NotBefore</span><span class="op" id="7306183">:</span>&nbsp;<span class="ident" id="7306185"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7306189">.</span><span class="ident" id="7306190">Unix</span><span class="op" id="7306194">(</span><span class="num" id="7306195">1000</span><span class="op" id="7306199">,</span>&nbsp;<span class="num" id="7306201">0</span><span class="op" id="7306202">)</span><span class="op" id="7306203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306208">NotAfter</span><span class="op" id="7306216">:</span>&nbsp;&nbsp;<span class="ident" id="7306219"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7306223">.</span><span class="ident" id="7306224">Unix</span><span class="op" id="7306228">(</span><span class="num" id="7306229">100000</span><span class="op" id="7306235">,</span>&nbsp;<span class="num" id="7306237">0</span><span class="op" id="7306238">)</span><span class="op" id="7306239">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306245">SignatureAlgorithm</span><span class="op" id="7306263">:</span>&nbsp;<span class="ident" id="7306265"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7306269">.</span><span class="ident" id="7306270">sigAlgo</span><span class="op" id="7306277">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306283">SubjectKeyId</span><span class="op" id="7306295">:</span>&nbsp;<span class="op" id="7306297">[</span><span class="op" id="7306298">]</span><span class="builtintype" id="7306299">byte</span><span class="op" id="7306303">{</span><span class="num" id="7306304">1</span><span class="op" id="7306305">,</span>&nbsp;<span class="num" id="7306307">2</span><span class="op" id="7306308">,</span>&nbsp;<span class="num" id="7306310">3</span><span class="op" id="7306311">,</span>&nbsp;<span class="num" id="7306313">4</span><span class="op" id="7306314">}</span><span class="op" id="7306315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306320">KeyUsage</span><span class="op" id="7306328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306334"><a href="/crypto/x509/x509.go.html#4040603">KeyUsageCertSign</a></span><span class="op" id="7306350">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306356">ExtKeyUsage</span><span class="op" id="7306367">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7306376"><a href="/crypto/x509/x509_test.go.html#7305733">testExtKeyUsage</a></span><span class="op" id="7306391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306396">UnknownExtKeyUsage</span><span class="op" id="7306414">:</span>&nbsp;<span class="ident" id="7306416"><a href="/crypto/x509/x509_test.go.html#7305813">testUnknownExtKeyUsage</a></span><span class="op" id="7306438">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306444">BasicConstraintsValid</span><span class="op" id="7306465">:</span>&nbsp;<span class="builtintype" id="7306467">true</span><span class="op" id="7306471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306476">IsCA</span><span class="op" id="7306480">:</span>&nbsp;<span class="builtintype" id="7306482">true</span><span class="op" id="7306486">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306492">OCSPServer</span><span class="op" id="7306502">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306515">[</span><span class="op" id="7306516">]</span><span class="builtintype" id="7306517">string</span><span class="op" id="7306523">{</span><span class="string" id="7306524">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7306549">}</span><span class="op" id="7306550">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306555">IssuingCertificateURL</span><span class="op" id="7306576">:</span>&nbsp;<span class="op" id="7306578">[</span><span class="op" id="7306579">]</span><span class="builtintype" id="7306580">string</span><span class="op" id="7306586">{</span><span class="string" id="7306587">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7306619">}</span><span class="op" id="7306620">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306626">DNSNames</span><span class="op" id="7306634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306642">[</span><span class="op" id="7306643">]</span><span class="builtintype" id="7306644">string</span><span class="op" id="7306650">{</span><span class="string" id="7306651">&#34;test.example.com&#34;</span><span class="op" id="7306669">}</span><span class="op" id="7306670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306675">EmailAddresses</span><span class="op" id="7306689">:</span>&nbsp;<span class="op" id="7306691">[</span><span class="op" id="7306692">]</span><span class="builtintype" id="7306693">string</span><span class="op" id="7306699">{</span><span class="string" id="7306700">&#34;gopher@golang.org&#34;</span><span class="op" id="7306719">}</span><span class="op" id="7306720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306725">IPAddresses</span><span class="op" id="7306736">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7306741">[</span><span class="op" id="7306742">]</span><span class="ident" id="7306743"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7306746">.</span><span class="ident" id="7306747">IP</span><span class="op" id="7306749">{</span><span class="ident" id="7306750"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7306753">.</span><span class="ident" id="7306754">IPv4</span><span class="op" id="7306758">(</span><span class="num" id="7306759">127</span><span class="op" id="7306762">,</span>&nbsp;<span class="num" id="7306764">0</span><span class="op" id="7306765">,</span>&nbsp;<span class="num" id="7306767">0</span><span class="op" id="7306768">,</span>&nbsp;<span class="num" id="7306770">1</span><span class="op" id="7306771">)</span><span class="op" id="7306772">.</span><span class="ident" id="7306773">To4</span><span class="op" id="7306776">(</span><span class="op" id="7306777">)</span><span class="op" id="7306778">,</span>&nbsp;<span class="ident" id="7306780"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7306783">.</span><span class="ident" id="7306784">ParseIP</span><span class="op" id="7306791">(</span><span class="string" id="7306792">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7306814">)</span><span class="op" id="7306815">}</span><span class="op" id="7306816">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306822">PolicyIdentifiers</span><span class="op" id="7306839">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7306843">[</span><span class="op" id="7306844">]</span><span class="ident" id="7306845"><a href="/crypto/x509/x509_test.go.html#7293227">asn1</a></span><span class="op" id="7306849">.</span><span class="ident" id="7306850">ObjectIdentifier</span><span class="op" id="7306866">{</span><span class="op" id="7306867">[</span><span class="op" id="7306868">]</span><span class="builtintype" id="7306869">int</span><span class="op" id="7306872">{</span><span class="num" id="7306873">1</span><span class="op" id="7306874">,</span>&nbsp;<span class="num" id="7306876">2</span><span class="op" id="7306877">,</span>&nbsp;<span class="num" id="7306879">3</span><span class="op" id="7306880">}</span><span class="op" id="7306881">}</span><span class="op" id="7306882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306887">PermittedDNSDomains</span><span class="op" id="7306906">:</span>&nbsp;<span class="op" id="7306908">[</span><span class="op" id="7306909">]</span><span class="builtintype" id="7306910">string</span><span class="op" id="7306916">{</span><span class="string" id="7306917">&#34;.example.com&#34;</span><span class="op" id="7306931">,</span>&nbsp;<span class="string" id="7306933">&#34;example.com&#34;</span><span class="op" id="7306946">}</span><span class="op" id="7306947">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7306953">CRLDistributionPoints</span><span class="op" id="7306974">:</span>&nbsp;<span class="op" id="7306976">[</span><span class="op" id="7306977">]</span><span class="builtintype" id="7306978">string</span><span class="op" id="7306984">{</span><span class="string" id="7306985">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7307018">,</span>&nbsp;<span class="string" id="7307020">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7307053">}</span><span class="op" id="7307054">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307060">ExtraExtensions</span><span class="op" id="7307075">:</span>&nbsp;<span class="op" id="7307077">[</span><span class="op" id="7307078">]</span><span class="ident" id="7307079"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7307083">.</span><span class="ident" id="7307084">Extension</span><span class="op" id="7307093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307106">Id</span><span class="op" id="7307108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7307113">[</span><span class="op" id="7307114">]</span><span class="builtintype" id="7307115">int</span><span class="op" id="7307118">{</span><span class="num" id="7307119">1</span><span class="op" id="7307120">,</span>&nbsp;<span class="num" id="7307122">2</span><span class="op" id="7307123">,</span>&nbsp;<span class="num" id="7307125">3</span><span class="op" id="7307126">,</span>&nbsp;<span class="num" id="7307128">4</span><span class="op" id="7307129">}</span><span class="op" id="7307130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307137">Value</span><span class="op" id="7307142">:</span>&nbsp;<span class="ident" id="7307144"><a href="/crypto/x509/x509_test.go.html#7305897">extraExtensionData</a></span><span class="op" id="7307162">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307168">}</span><span class="op" id="7307169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7307175">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307245">Id</span><span class="op" id="7307247">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7307255"><a href="/crypto/x509/x509.go.html#4064969">oidExtensionSubjectKeyId</a></span><span class="op" id="7307279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307286">Critical</span><span class="op" id="7307294">:</span>&nbsp;<span class="builtintype" id="7307296">false</span><span class="op" id="7307301">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307308">Value</span><span class="op" id="7307313">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7307318">[</span><span class="op" id="7307319">]</span><span class="builtintype" id="7307320">byte</span><span class="op" id="7307324">{</span><span class="num" id="7307325">0x04</span><span class="op" id="7307329">,</span>&nbsp;<span class="num" id="7307331">0x04</span><span class="op" id="7307335">,</span>&nbsp;<span class="num" id="7307337">4</span><span class="op" id="7307338">,</span>&nbsp;<span class="num" id="7307340">3</span><span class="op" id="7307341">,</span>&nbsp;<span class="num" id="7307343">2</span><span class="op" id="7307344">,</span>&nbsp;<span class="num" id="7307346">1</span><span class="op" id="7307347">}</span><span class="op" id="7307348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307354">}</span><span class="op" id="7307355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307360">}</span><span class="op" id="7307361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307370">derBytes</span><span class="op" id="7307378">,</span>&nbsp;<span class="ident" id="7307380">err</span>&nbsp;<span class="op" id="7307384">:=</span>&nbsp;<span class="ident" id="7307387"><a href="/crypto/x509/x509.go.html#4074576">CreateCertificate</a></span><span class="op" id="7307404">(</span><span class="ident" id="7307405"><a href="/crypto/x509/x509_test.go.html#7305001">random</a></span><span class="op" id="7307411">,</span>&nbsp;<span class="op" id="7307413">&amp;</span><span class="ident" id="7307414"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7307422">,</span>&nbsp;<span class="op" id="7307424">&amp;</span><span class="ident" id="7307425"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7307433">,</span>&nbsp;<span class="ident" id="7307435"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7307439">.</span><span class="ident" id="7307440">pub</span><span class="op" id="7307443">,</span>&nbsp;<span class="ident" id="7307445"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7307449">.</span><span class="ident" id="7307450">priv</span><span class="op" id="7307454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307458">if</span>&nbsp;<span class="ident" id="7307461"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span>&nbsp;<span class="op" id="7307465">!=</span>&nbsp;<span class="ident" id="7307468">nil</span>&nbsp;<span class="op" id="7307472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307477"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7307478">.</span><span class="ident" id="7307479">Errorf</span><span class="op" id="7307485">(</span><span class="string" id="7307486">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7307524">,</span>&nbsp;<span class="ident" id="7307526"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7307530">.</span><span class="ident" id="7307531">name</span><span class="op" id="7307535">,</span>&nbsp;<span class="ident" id="7307537"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span><span class="op" id="7307540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307545">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307556">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307561">cert</span><span class="op" id="7307565">,</span>&nbsp;<span class="ident" id="7307567"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span>&nbsp;<span class="op" id="7307571">:=</span>&nbsp;<span class="ident" id="7307574"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7307590">(</span><span class="ident" id="7307591"><a href="/crypto/x509/x509_test.go.html#7307370">derBytes</a></span><span class="op" id="7307599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307603">if</span>&nbsp;<span class="ident" id="7307606"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span>&nbsp;<span class="op" id="7307610">!=</span>&nbsp;<span class="ident" id="7307613">nil</span>&nbsp;<span class="op" id="7307617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307622"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7307623">.</span><span class="ident" id="7307624">Errorf</span><span class="op" id="7307630">(</span><span class="string" id="7307631">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7307668">,</span>&nbsp;<span class="ident" id="7307670"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7307674">.</span><span class="ident" id="7307675">name</span><span class="op" id="7307679">,</span>&nbsp;<span class="ident" id="7307681"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span><span class="op" id="7307684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307689">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307705">if</span>&nbsp;<span class="builtinfunc" id="7307708">len</span><span class="op" id="7307711">(</span><span class="ident" id="7307712"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7307716">.</span><span class="ident" id="7307717">PolicyIdentifiers</span><span class="op" id="7307734">)</span>&nbsp;<span class="op" id="7307736">!=</span>&nbsp;<span class="num" id="7307739">1</span>&nbsp;<span class="op" id="7307741">||</span>&nbsp;<span class="op" id="7307744">!</span><span class="ident" id="7307745"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7307749">.</span><span class="ident" id="7307750">PolicyIdentifiers</span><span class="op" id="7307767">[</span><span class="num" id="7307768">0</span><span class="op" id="7307769">]</span><span class="op" id="7307770">.</span><span class="ident" id="7307771">Equal</span><span class="op" id="7307776">(</span><span class="ident" id="7307777"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7307785">.</span><span class="ident" id="7307786">PolicyIdentifiers</span><span class="op" id="7307803">[</span><span class="num" id="7307804">0</span><span class="op" id="7307805">]</span><span class="op" id="7307806">)</span>&nbsp;<span class="op" id="7307808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7307813"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7307814">.</span><span class="ident" id="7307815">Errorf</span><span class="op" id="7307821">(</span><span class="string" id="7307822">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7307880">,</span>&nbsp;<span class="ident" id="7307882"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7307886">.</span><span class="ident" id="7307887">name</span><span class="op" id="7307891">,</span>&nbsp;<span class="ident" id="7307893"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7307897">.</span><span class="ident" id="7307898">PolicyIdentifiers</span><span class="op" id="7307915">,</span>&nbsp;<span class="ident" id="7307917"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7307925">.</span><span class="ident" id="7307926">PolicyIdentifiers</span><span class="op" id="7307943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7307947">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7307952">if</span>&nbsp;<span class="builtinfunc" id="7307955">len</span><span class="op" id="7307958">(</span><span class="ident" id="7307959"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7307963">.</span><span class="ident" id="7307964">PermittedDNSDomains</span><span class="op" id="7307983">)</span>&nbsp;<span class="op" id="7307985">!=</span>&nbsp;<span class="num" id="7307988">2</span>&nbsp;<span class="op" id="7307990">||</span>&nbsp;<span class="ident" id="7307993"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7307997">.</span><span class="ident" id="7307998">PermittedDNSDomains</span><span class="op" id="7308017">[</span><span class="num" id="7308018">0</span><span class="op" id="7308019">]</span>&nbsp;<span class="op" id="7308021">!=</span>&nbsp;<span class="string" id="7308024">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7308039">||</span>&nbsp;<span class="ident" id="7308042"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308046">.</span><span class="ident" id="7308047">PermittedDNSDomains</span><span class="op" id="7308066">[</span><span class="num" id="7308067">1</span><span class="op" id="7308068">]</span>&nbsp;<span class="op" id="7308070">!=</span>&nbsp;<span class="string" id="7308073">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7308087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308092"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7308093">.</span><span class="ident" id="7308094">Errorf</span><span class="op" id="7308100">(</span><span class="string" id="7308101">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7308144">,</span>&nbsp;<span class="ident" id="7308146"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308150">.</span><span class="ident" id="7308151">name</span><span class="op" id="7308155">,</span>&nbsp;<span class="ident" id="7308157"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308161">.</span><span class="ident" id="7308162">PermittedDNSDomains</span><span class="op" id="7308181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308190">if</span>&nbsp;<span class="ident" id="7308193"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308197">.</span><span class="ident" id="7308198">Subject</span><span class="op" id="7308205">.</span><span class="ident" id="7308206">CommonName</span>&nbsp;<span class="op" id="7308217">!=</span>&nbsp;<span class="ident" id="7308220"><a href="/crypto/x509/x509_test.go.html#7305978">commonName</a></span>&nbsp;<span class="op" id="7308231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308236"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7308237">.</span><span class="ident" id="7308238">Errorf</span><span class="op" id="7308244">(</span><span class="string" id="7308245">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7308317">,</span>&nbsp;<span class="ident" id="7308319"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308323">.</span><span class="ident" id="7308324">name</span><span class="op" id="7308328">,</span>&nbsp;<span class="ident" id="7308330"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308334">.</span><span class="ident" id="7308335">Subject</span><span class="op" id="7308342">.</span><span class="ident" id="7308343">CommonName</span><span class="op" id="7308353">,</span>&nbsp;<span class="ident" id="7308355"><a href="/crypto/x509/x509_test.go.html#7305978">commonName</a></span><span class="op" id="7308365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308374">if</span>&nbsp;<span class="ident" id="7308377"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308381">.</span><span class="ident" id="7308382">Issuer</span><span class="op" id="7308388">.</span><span class="ident" id="7308389">CommonName</span>&nbsp;<span class="op" id="7308400">!=</span>&nbsp;<span class="ident" id="7308403"><a href="/crypto/x509/x509_test.go.html#7305978">commonName</a></span>&nbsp;<span class="op" id="7308414">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308419"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7308420">.</span><span class="ident" id="7308421">Errorf</span><span class="op" id="7308427">(</span><span class="string" id="7308428">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7308499">,</span>&nbsp;<span class="ident" id="7308501"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308505">.</span><span class="ident" id="7308506">name</span><span class="op" id="7308510">,</span>&nbsp;<span class="ident" id="7308512"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308516">.</span><span class="ident" id="7308517">Issuer</span><span class="op" id="7308523">.</span><span class="ident" id="7308524">CommonName</span><span class="op" id="7308534">,</span>&nbsp;<span class="ident" id="7308536"><a href="/crypto/x509/x509_test.go.html#7305978">commonName</a></span><span class="op" id="7308546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308555">if</span>&nbsp;<span class="ident" id="7308558"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308562">.</span><span class="ident" id="7308563">SignatureAlgorithm</span>&nbsp;<span class="op" id="7308582">!=</span>&nbsp;<span class="ident" id="7308585"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308589">.</span><span class="ident" id="7308590">sigAlgo</span>&nbsp;<span class="op" id="7308598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308603"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7308604">.</span><span class="ident" id="7308605">Errorf</span><span class="op" id="7308611">(</span><span class="string" id="7308612">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7308681">,</span>&nbsp;<span class="ident" id="7308683"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308687">.</span><span class="ident" id="7308688">name</span><span class="op" id="7308692">,</span>&nbsp;<span class="ident" id="7308694"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308698">.</span><span class="ident" id="7308699">SignatureAlgorithm</span><span class="op" id="7308717">,</span>&nbsp;<span class="ident" id="7308719"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308723">.</span><span class="ident" id="7308724">sigAlgo</span><span class="op" id="7308731">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308740">if</span>&nbsp;<span class="op" id="7308743">!</span><span class="ident" id="7308744"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7308751">.</span><span class="ident" id="7308752">DeepEqual</span><span class="op" id="7308761">(</span><span class="ident" id="7308762"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308766">.</span><span class="ident" id="7308767">ExtKeyUsage</span><span class="op" id="7308778">,</span>&nbsp;<span class="ident" id="7308780"><a href="/crypto/x509/x509_test.go.html#7305733">testExtKeyUsage</a></span><span class="op" id="7308795">)</span>&nbsp;<span class="op" id="7308797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7308802"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7308803">.</span><span class="ident" id="7308804">Errorf</span><span class="op" id="7308810">(</span><span class="string" id="7308811">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7308887">,</span>&nbsp;<span class="ident" id="7308889"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7308893">.</span><span class="ident" id="7308894">name</span><span class="op" id="7308898">,</span>&nbsp;<span class="ident" id="7308900"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308904">.</span><span class="ident" id="7308905">ExtKeyUsage</span><span class="op" id="7308916">,</span>&nbsp;<span class="ident" id="7308918"><a href="/crypto/x509/x509_test.go.html#7305733">testExtKeyUsage</a></span><span class="op" id="7308933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7308937">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7308942">if</span>&nbsp;<span class="op" id="7308945">!</span><span class="ident" id="7308946"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7308953">.</span><span class="ident" id="7308954">DeepEqual</span><span class="op" id="7308963">(</span><span class="ident" id="7308964"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7308968">.</span><span class="ident" id="7308969">UnknownExtKeyUsage</span><span class="op" id="7308987">,</span>&nbsp;<span class="ident" id="7308989"><a href="/crypto/x509/x509_test.go.html#7305813">testUnknownExtKeyUsage</a></span><span class="op" id="7309011">)</span>&nbsp;<span class="op" id="7309013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309018"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7309019">.</span><span class="ident" id="7309020">Errorf</span><span class="op" id="7309026">(</span><span class="string" id="7309027">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7309111">,</span>&nbsp;<span class="ident" id="7309113"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7309117">.</span><span class="ident" id="7309118">name</span><span class="op" id="7309122">,</span>&nbsp;<span class="ident" id="7309124"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309128">.</span><span class="ident" id="7309129">UnknownExtKeyUsage</span><span class="op" id="7309147">,</span>&nbsp;<span class="ident" id="7309149"><a href="/crypto/x509/x509_test.go.html#7305813">testUnknownExtKeyUsage</a></span><span class="op" id="7309171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309180">if</span>&nbsp;<span class="op" id="7309183">!</span><span class="ident" id="7309184"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7309191">.</span><span class="ident" id="7309192">DeepEqual</span><span class="op" id="7309201">(</span><span class="ident" id="7309202"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309206">.</span><span class="ident" id="7309207">OCSPServer</span><span class="op" id="7309217">,</span>&nbsp;<span class="ident" id="7309219"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309227">.</span><span class="ident" id="7309228">OCSPServer</span><span class="op" id="7309238">)</span>&nbsp;<span class="op" id="7309240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309245"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7309246">.</span><span class="ident" id="7309247">Errorf</span><span class="op" id="7309253">(</span><span class="string" id="7309254">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7309310">,</span>&nbsp;<span class="ident" id="7309312"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7309316">.</span><span class="ident" id="7309317">name</span><span class="op" id="7309321">,</span>&nbsp;<span class="ident" id="7309323"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309327">.</span><span class="ident" id="7309328">OCSPServer</span><span class="op" id="7309338">,</span>&nbsp;<span class="ident" id="7309340"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309348">.</span><span class="ident" id="7309349">OCSPServer</span><span class="op" id="7309359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309368">if</span>&nbsp;<span class="op" id="7309371">!</span><span class="ident" id="7309372"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7309379">.</span><span class="ident" id="7309380">DeepEqual</span><span class="op" id="7309389">(</span><span class="ident" id="7309390"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309394">.</span><span class="ident" id="7309395">IssuingCertificateURL</span><span class="op" id="7309416">,</span>&nbsp;<span class="ident" id="7309418"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309426">.</span><span class="ident" id="7309427">IssuingCertificateURL</span><span class="op" id="7309448">)</span>&nbsp;<span class="op" id="7309450">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309455"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7309456">.</span><span class="ident" id="7309457">Errorf</span><span class="op" id="7309463">(</span><span class="string" id="7309464">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7309532">,</span>&nbsp;<span class="ident" id="7309534"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7309538">.</span><span class="ident" id="7309539">name</span><span class="op" id="7309543">,</span>&nbsp;<span class="ident" id="7309545"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309549">.</span><span class="ident" id="7309550">IssuingCertificateURL</span><span class="op" id="7309571">,</span>&nbsp;<span class="ident" id="7309573"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309581">.</span><span class="ident" id="7309582">IssuingCertificateURL</span><span class="op" id="7309603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309612">if</span>&nbsp;<span class="op" id="7309615">!</span><span class="ident" id="7309616"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7309623">.</span><span class="ident" id="7309624">DeepEqual</span><span class="op" id="7309633">(</span><span class="ident" id="7309634"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309638">.</span><span class="ident" id="7309639">DNSNames</span><span class="op" id="7309647">,</span>&nbsp;<span class="ident" id="7309649"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309657">.</span><span class="ident" id="7309658">DNSNames</span><span class="op" id="7309666">)</span>&nbsp;<span class="op" id="7309668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309673"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7309674">.</span><span class="ident" id="7309675">Errorf</span><span class="op" id="7309681">(</span><span class="string" id="7309682">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7309739">,</span>&nbsp;<span class="ident" id="7309741"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7309745">.</span><span class="ident" id="7309746">name</span><span class="op" id="7309750">,</span>&nbsp;<span class="ident" id="7309752"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309756">.</span><span class="ident" id="7309757">DNSNames</span><span class="op" id="7309765">,</span>&nbsp;<span class="ident" id="7309767"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309775">.</span><span class="ident" id="7309776">DNSNames</span><span class="op" id="7309784">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309793">if</span>&nbsp;<span class="op" id="7309796">!</span><span class="ident" id="7309797"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7309804">.</span><span class="ident" id="7309805">DeepEqual</span><span class="op" id="7309814">(</span><span class="ident" id="7309815"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309819">.</span><span class="ident" id="7309820">EmailAddresses</span><span class="op" id="7309834">,</span>&nbsp;<span class="ident" id="7309836"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309844">.</span><span class="ident" id="7309845">EmailAddresses</span><span class="op" id="7309859">)</span>&nbsp;<span class="op" id="7309861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7309866"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7309867">.</span><span class="ident" id="7309868">Errorf</span><span class="op" id="7309874">(</span><span class="string" id="7309875">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7309929">,</span>&nbsp;<span class="ident" id="7309931"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7309935">.</span><span class="ident" id="7309936">name</span><span class="op" id="7309940">,</span>&nbsp;<span class="ident" id="7309942"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7309946">.</span><span class="ident" id="7309947">EmailAddresses</span><span class="op" id="7309961">,</span>&nbsp;<span class="ident" id="7309963"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7309971">.</span><span class="ident" id="7309972">EmailAddresses</span><span class="op" id="7309986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7309990">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7309995">if</span>&nbsp;<span class="op" id="7309998">!</span><span class="ident" id="7309999"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7310006">.</span><span class="ident" id="7310007">DeepEqual</span><span class="op" id="7310016">(</span><span class="ident" id="7310017"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310021">.</span><span class="ident" id="7310022">IPAddresses</span><span class="op" id="7310033">,</span>&nbsp;<span class="ident" id="7310035"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7310043">.</span><span class="ident" id="7310044">IPAddresses</span><span class="op" id="7310055">)</span>&nbsp;<span class="op" id="7310057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310062"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7310063">.</span><span class="ident" id="7310064">Errorf</span><span class="op" id="7310070">(</span><span class="string" id="7310071">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7310122">,</span>&nbsp;<span class="ident" id="7310124"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7310128">.</span><span class="ident" id="7310129">name</span><span class="op" id="7310133">,</span>&nbsp;<span class="ident" id="7310135"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310139">.</span><span class="ident" id="7310140">IPAddresses</span><span class="op" id="7310151">,</span>&nbsp;<span class="ident" id="7310153"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7310161">.</span><span class="ident" id="7310162">IPAddresses</span><span class="op" id="7310173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310182">if</span>&nbsp;<span class="op" id="7310185">!</span><span class="ident" id="7310186"><a href="/crypto/x509/x509_test.go.html#7293325">reflect</a></span><span class="op" id="7310193">.</span><span class="ident" id="7310194">DeepEqual</span><span class="op" id="7310203">(</span><span class="ident" id="7310204"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310208">.</span><span class="ident" id="7310209">CRLDistributionPoints</span><span class="op" id="7310230">,</span>&nbsp;<span class="ident" id="7310232"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7310240">.</span><span class="ident" id="7310241">CRLDistributionPoints</span><span class="op" id="7310262">)</span>&nbsp;<span class="op" id="7310264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310269"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7310270">.</span><span class="ident" id="7310271">Errorf</span><span class="op" id="7310277">(</span><span class="string" id="7310278">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7310345">,</span>&nbsp;<span class="ident" id="7310347"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7310351">.</span><span class="ident" id="7310352">name</span><span class="op" id="7310356">,</span>&nbsp;<span class="ident" id="7310358"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310362">.</span><span class="ident" id="7310363">CRLDistributionPoints</span><span class="op" id="7310384">,</span>&nbsp;<span class="ident" id="7310386"><a href="/crypto/x509/x509_test.go.html#7306013">template</a></span><span class="op" id="7310394">.</span><span class="ident" id="7310395">CRLDistributionPoints</span><span class="op" id="7310416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310425">if</span>&nbsp;<span class="op" id="7310428">!</span><span class="ident" id="7310429"><a href="/crypto/x509/x509_test.go.html#7293082">bytes</a></span><span class="op" id="7310434">.</span><span class="ident" id="7310435">Equal</span><span class="op" id="7310440">(</span><span class="ident" id="7310441"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310445">.</span><span class="ident" id="7310446">SubjectKeyId</span><span class="op" id="7310458">,</span>&nbsp;<span class="op" id="7310460">[</span><span class="op" id="7310461">]</span><span class="builtintype" id="7310462">byte</span><span class="op" id="7310466">{</span><span class="num" id="7310467">4</span><span class="op" id="7310468">,</span>&nbsp;<span class="num" id="7310470">3</span><span class="op" id="7310471">,</span>&nbsp;<span class="num" id="7310473">2</span><span class="op" id="7310474">,</span>&nbsp;<span class="num" id="7310476">1</span><span class="op" id="7310477">}</span><span class="op" id="7310478">)</span>&nbsp;<span class="op" id="7310480">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310485"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7310486">.</span><span class="ident" id="7310487">Errorf</span><span class="op" id="7310493">(</span><span class="string" id="7310494">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7310544">,</span>&nbsp;<span class="ident" id="7310546"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7310550">.</span><span class="ident" id="7310551">name</span><span class="op" id="7310555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310564">if</span>&nbsp;<span class="ident" id="7310567"><a href="/crypto/x509/x509_test.go.html#7293082">bytes</a></span><span class="op" id="7310572">.</span><span class="ident" id="7310573">Index</span><span class="op" id="7310578">(</span><span class="ident" id="7310579"><a href="/crypto/x509/x509_test.go.html#7307370">derBytes</a></span><span class="op" id="7310587">,</span>&nbsp;<span class="ident" id="7310589"><a href="/crypto/x509/x509_test.go.html#7305897">extraExtensionData</a></span><span class="op" id="7310607">)</span>&nbsp;<span class="op" id="7310609">==</span>&nbsp;<span class="op" id="7310612">-</span><span class="num" id="7310613">1</span>&nbsp;<span class="op" id="7310615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310620"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7310621">.</span><span class="ident" id="7310622">Errorf</span><span class="op" id="7310628">(</span><span class="string" id="7310629">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7310676">,</span>&nbsp;<span class="ident" id="7310678"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7310682">.</span><span class="ident" id="7310683">name</span><span class="op" id="7310687">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310696">if</span>&nbsp;<span class="ident" id="7310699"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7310703">.</span><span class="ident" id="7310704">checkSig</span>&nbsp;<span class="op" id="7310713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310718"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span>&nbsp;<span class="op" id="7310722">=</span>&nbsp;<span class="ident" id="7310724"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310728">.</span><span class="ident" id="7310729">CheckSignatureFrom</span><span class="op" id="7310747">(</span><span class="ident" id="7310748"><a href="/crypto/x509/x509_test.go.html#7307561">cert</a></span><span class="op" id="7310752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7310757">if</span>&nbsp;<span class="ident" id="7310760"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span>&nbsp;<span class="op" id="7310764">!=</span>&nbsp;<span class="ident" id="7310767">nil</span>&nbsp;<span class="op" id="7310771">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7310777"><a href="/crypto/x509/x509_test.go.html#7304984">t</a></span><span class="op" id="7310778">.</span><span class="ident" id="7310779">Errorf</span><span class="op" id="7310785">(</span><span class="string" id="7310786">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7310825">,</span>&nbsp;<span class="ident" id="7310827"><a href="/crypto/x509/x509_test.go.html#7305954">test</a></span><span class="op" id="7310831">.</span><span class="ident" id="7310832">name</span><span class="op" id="7310836">,</span>&nbsp;<span class="ident" id="7310838"><a href="/crypto/x509/x509_test.go.html#7307380">err</a></span><span class="op" id="7310841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7310853">}</span><br>
<span class="lineno"></span><span class="op" id="7310855">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7310858">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7310919">var</span>&nbsp;<span class="ident" id="7310923">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7310940">=</span>&nbsp;<span class="string" id="7310942">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7311721">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7311784">var</span>&nbsp;<span class="ident" id="7311788">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7311811">=</span>&nbsp;<span class="string" id="7311813">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7312592">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7312655">var</span>&nbsp;<span class="ident" id="7312659">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7312682">=</span>&nbsp;<span class="string" id="7312684">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7313544">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7313607">var</span>&nbsp;<span class="ident" id="7313611">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7313634">=</span>&nbsp;<span class="string" id="7313636">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7314597">var</span>&nbsp;<span class="ident" id="7314601">ecdsaTests</span>&nbsp;<span class="op" id="7314612">=</span>&nbsp;<span class="op" id="7314614">[</span><span class="op" id="7314615">]</span><span class="keyword" id="7314616">struct</span>&nbsp;<span class="op" id="7314623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314626">sigAlgo</span>&nbsp;<span class="ident" id="7314634"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314654">pemCert</span>&nbsp;<span class="builtintype" id="7314662">string</span><br>
<span class="lineno"></span><span class="op" id="7314669">}</span><span class="op" id="7314670">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7314673">{</span><span class="ident" id="7314674"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="7314687">,</span>&nbsp;<span class="ident" id="7314689"><a href="/crypto/x509/x509_test.go.html#7310923">ecdsaSHA1CertPem</a></span><span class="op" id="7314705">}</span><span class="op" id="7314706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7314709">{</span><span class="ident" id="7314710"><a href="/crypto/x509/x509.go.html#4033961">ECDSAWithSHA256</a></span><span class="op" id="7314725">,</span>&nbsp;<span class="ident" id="7314727"><a href="/crypto/x509/x509_test.go.html#7311788">ecdsaSHA256p256CertPem</a></span><span class="op" id="7314749">}</span><span class="op" id="7314750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7314753">{</span><span class="ident" id="7314754"><a href="/crypto/x509/x509.go.html#4033961">ECDSAWithSHA256</a></span><span class="op" id="7314769">,</span>&nbsp;<span class="ident" id="7314771"><a href="/crypto/x509/x509_test.go.html#7312659">ecdsaSHA256p384CertPem</a></span><span class="op" id="7314793">}</span><span class="op" id="7314794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7314797">{</span><span class="ident" id="7314798"><a href="/crypto/x509/x509.go.html#4033978">ECDSAWithSHA384</a></span><span class="op" id="7314813">,</span>&nbsp;<span class="ident" id="7314815"><a href="/crypto/x509/x509_test.go.html#7313611">ecdsaSHA384p521CertPem</a></span><span class="op" id="7314837">}</span><span class="op" id="7314838">,</span><br>
<span class="lineno"></span><span class="op" id="7314840">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7314843">func</span>&nbsp;<span class="ident" id="7314848">TestECDSA</span><span class="op" id="7314857">(</span><span class="ident" id="7314858">t</span>&nbsp;<span class="op" id="7314860">*</span><span class="ident" id="7314861"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7314868">.</span><span class="ident" id="7314869">T</span><span class="op" id="7314870">)</span>&nbsp;<span class="op" id="7314872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7314875">for</span>&nbsp;<span class="ident" id="7314879">i</span><span class="op" id="7314880">,</span>&nbsp;<span class="ident" id="7314882">test</span>&nbsp;<span class="op" id="7314887">:=</span>&nbsp;<span class="keyword" id="7314890">range</span>&nbsp;<span class="ident" id="7314896"><a href="/crypto/x509/x509_test.go.html#7314601">ecdsaTests</a></span>&nbsp;<span class="op" id="7314907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314911">pemBlock</span><span class="op" id="7314919">,</span>&nbsp;<span class="ident" id="7314921">_</span>&nbsp;<span class="op" id="7314923">:=</span>&nbsp;<span class="ident" id="7314926"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7314929">.</span><span class="ident" id="7314930">Decode</span><span class="op" id="7314936">(</span><span class="op" id="7314937">[</span><span class="op" id="7314938">]</span><span class="builtintype" id="7314939">byte</span><span class="op" id="7314943">(</span><span class="ident" id="7314944"><a href="/crypto/x509/x509_test.go.html#7314882">test</a></span><span class="op" id="7314948">.</span><span class="ident" id="7314949">pemCert</span><span class="op" id="7314956">)</span><span class="op" id="7314957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7314961">cert</span><span class="op" id="7314965">,</span>&nbsp;<span class="ident" id="7314967">err</span>&nbsp;<span class="op" id="7314971">:=</span>&nbsp;<span class="ident" id="7314974"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7314990">(</span><span class="ident" id="7314991"><a href="/crypto/x509/x509_test.go.html#7314911">pemBlock</a></span><span class="op" id="7314999">.</span><span class="ident" id="7315000">Bytes</span><span class="op" id="7315005">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315009">if</span>&nbsp;<span class="ident" id="7315012"><a href="/crypto/x509/x509_test.go.html#7314967">err</a></span>&nbsp;<span class="op" id="7315016">!=</span>&nbsp;<span class="ident" id="7315019">nil</span>&nbsp;<span class="op" id="7315023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315028"><a href="/crypto/x509/x509_test.go.html#7314858">t</a></span><span class="op" id="7315029">.</span><span class="ident" id="7315030">Errorf</span><span class="op" id="7315036">(</span><span class="string" id="7315037">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7315074">,</span>&nbsp;<span class="ident" id="7315076"><a href="/crypto/x509/x509_test.go.html#7314879">i</a></span><span class="op" id="7315077">,</span>&nbsp;<span class="ident" id="7315079"><a href="/crypto/x509/x509_test.go.html#7314967">err</a></span><span class="op" id="7315082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315087">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315102">if</span>&nbsp;<span class="ident" id="7315105">sa</span>&nbsp;<span class="op" id="7315108">:=</span>&nbsp;<span class="ident" id="7315111"><a href="/crypto/x509/x509_test.go.html#7314961">cert</a></span><span class="op" id="7315115">.</span><span class="ident" id="7315116">SignatureAlgorithm</span><span class="op" id="7315134">;</span>&nbsp;<span class="ident" id="7315136"><a href="/crypto/x509/x509_test.go.html#7315105">sa</a></span>&nbsp;<span class="op" id="7315139">!=</span>&nbsp;<span class="ident" id="7315142"><a href="/crypto/x509/x509_test.go.html#7314882">test</a></span><span class="op" id="7315146">.</span><span class="ident" id="7315147">sigAlgo</span>&nbsp;<span class="op" id="7315155">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315160"><a href="/crypto/x509/x509_test.go.html#7314858">t</a></span><span class="op" id="7315161">.</span><span class="ident" id="7315162">Errorf</span><span class="op" id="7315168">(</span><span class="string" id="7315169">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7315209">,</span>&nbsp;<span class="ident" id="7315211"><a href="/crypto/x509/x509_test.go.html#7314879">i</a></span><span class="op" id="7315212">,</span>&nbsp;<span class="ident" id="7315214"><a href="/crypto/x509/x509_test.go.html#7315105">sa</a></span><span class="op" id="7315216">,</span>&nbsp;<span class="ident" id="7315218"><a href="/crypto/x509/x509_test.go.html#7314882">test</a></span><span class="op" id="7315222">.</span><span class="ident" id="7315223">sigAlgo</span><span class="op" id="7315230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315238">if</span>&nbsp;<span class="ident" id="7315241">parsedKey</span><span class="op" id="7315250">,</span>&nbsp;<span class="ident" id="7315252">ok</span>&nbsp;<span class="op" id="7315255">:=</span>&nbsp;<span class="ident" id="7315258"><a href="/crypto/x509/x509_test.go.html#7314961">cert</a></span><span class="op" id="7315262">.</span><span class="ident" id="7315263">PublicKey</span><span class="op" id="7315272">.</span><span class="op" id="7315273">(</span><span class="op" id="7315274">*</span><span class="ident" id="7315275"><a href="/crypto/x509/x509_test.go.html#7293105">ecdsa</a></span><span class="op" id="7315280">.</span><span class="ident" id="7315281">PublicKey</span><span class="op" id="7315290">)</span><span class="op" id="7315291">;</span>&nbsp;<span class="op" id="7315293">!</span><span class="ident" id="7315294"><a href="/crypto/x509/x509_test.go.html#7315252">ok</a></span>&nbsp;<span class="op" id="7315297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315302"><a href="/crypto/x509/x509_test.go.html#7314858">t</a></span><span class="op" id="7315303">.</span><span class="ident" id="7315304">Errorf</span><span class="op" id="7315310">(</span><span class="string" id="7315311">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7315358">,</span>&nbsp;<span class="ident" id="7315360"><a href="/crypto/x509/x509_test.go.html#7314879">i</a></span><span class="op" id="7315361">,</span>&nbsp;<span class="ident" id="7315363"><a href="/crypto/x509/x509_test.go.html#7315241">parsedKey</a></span><span class="op" id="7315372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315376">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315380">if</span>&nbsp;<span class="ident" id="7315383">pka</span>&nbsp;<span class="op" id="7315387">:=</span>&nbsp;<span class="ident" id="7315390"><a href="/crypto/x509/x509_test.go.html#7314961">cert</a></span><span class="op" id="7315394">.</span><span class="ident" id="7315395">PublicKeyAlgorithm</span><span class="op" id="7315413">;</span>&nbsp;<span class="ident" id="7315415"><a href="/crypto/x509/x509_test.go.html#7315383">pka</a></span>&nbsp;<span class="op" id="7315419">!=</span>&nbsp;<span class="ident" id="7315422"><a href="/crypto/x509/x509.go.html#4034115">ECDSA</a></span>&nbsp;<span class="op" id="7315428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315433"><a href="/crypto/x509/x509_test.go.html#7314858">t</a></span><span class="op" id="7315434">.</span><span class="ident" id="7315435">Errorf</span><span class="op" id="7315441">(</span><span class="string" id="7315442">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7315486">,</span>&nbsp;<span class="ident" id="7315488"><a href="/crypto/x509/x509_test.go.html#7314879">i</a></span><span class="op" id="7315489">,</span>&nbsp;<span class="ident" id="7315491"><a href="/crypto/x509/x509_test.go.html#7315383">pka</a></span><span class="op" id="7315494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7315502">if</span>&nbsp;<span class="ident" id="7315505"><a href="/crypto/x509/x509_test.go.html#7314967">err</a></span>&nbsp;<span class="op" id="7315509">=</span>&nbsp;<span class="ident" id="7315511"><a href="/crypto/x509/x509_test.go.html#7314961">cert</a></span><span class="op" id="7315515">.</span><span class="ident" id="7315516">CheckSignatureFrom</span><span class="op" id="7315534">(</span><span class="ident" id="7315535"><a href="/crypto/x509/x509_test.go.html#7314961">cert</a></span><span class="op" id="7315539">)</span><span class="op" id="7315540">;</span>&nbsp;<span class="ident" id="7315542"><a href="/crypto/x509/x509_test.go.html#7314967">err</a></span>&nbsp;<span class="op" id="7315546">!=</span>&nbsp;<span class="ident" id="7315549">nil</span>&nbsp;<span class="op" id="7315553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7315558"><a href="/crypto/x509/x509_test.go.html#7314858">t</a></span><span class="op" id="7315559">.</span><span class="ident" id="7315560">Errorf</span><span class="op" id="7315566">(</span><span class="string" id="7315567">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7315608">,</span>&nbsp;<span class="ident" id="7315610"><a href="/crypto/x509/x509_test.go.html#7314879">i</a></span><span class="op" id="7315611">,</span>&nbsp;<span class="ident" id="7315613"><a href="/crypto/x509/x509_test.go.html#7314967">err</a></span><span class="op" id="7315616">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7315623">}</span><br>
<span class="lineno"></span><span class="op" id="7315625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7315628">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7315675">var</span>&nbsp;<span class="ident" id="7315679">dsaCertPem</span>&nbsp;<span class="op" id="7315690">=</span>&nbsp;<span class="string" id="7315692">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7317160">func</span>&nbsp;<span class="ident" id="7317165">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7317201">(</span><span class="ident" id="7317202">t</span>&nbsp;<span class="op" id="7317204">*</span><span class="ident" id="7317205"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7317212">.</span><span class="ident" id="7317213">T</span><span class="op" id="7317214">)</span>&nbsp;<span class="op" id="7317216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317219">expectedKey</span>&nbsp;<span class="op" id="7317231">:=</span>&nbsp;<span class="op" id="7317234">&amp;</span><span class="ident" id="7317235"><a href="/crypto/x509/x509_test.go.html#7293091">dsa</a></span><span class="op" id="7317238">.</span><span class="ident" id="7317239">PublicKey</span><span class="op" id="7317248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317252">Parameters</span><span class="op" id="7317262">:</span>&nbsp;<span class="ident" id="7317264"><a href="/crypto/x509/x509_test.go.html#7293091">dsa</a></span><span class="op" id="7317267">.</span><span class="ident" id="7317268">Parameters</span><span class="op" id="7317278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317283">P</span><span class="op" id="7317284">:</span>&nbsp;<span class="ident" id="7317286"><a href="/crypto/x509/x509_test.go.html#7295752">bigFromHexString</a></span><span class="op" id="7317302">(</span><span class="string" id="7317303">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7317563">)</span><span class="op" id="7317564">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317569">Q</span><span class="op" id="7317570">:</span>&nbsp;<span class="ident" id="7317572"><a href="/crypto/x509/x509_test.go.html#7295752">bigFromHexString</a></span><span class="op" id="7317588">(</span><span class="string" id="7317589">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7317633">)</span><span class="op" id="7317634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317639">G</span><span class="op" id="7317640">:</span>&nbsp;<span class="ident" id="7317642"><a href="/crypto/x509/x509_test.go.html#7295752">bigFromHexString</a></span><span class="op" id="7317658">(</span><span class="string" id="7317659">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7317919">)</span><span class="op" id="7317920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7317924">}</span><span class="op" id="7317925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7317929">Y</span><span class="op" id="7317930">:</span>&nbsp;<span class="ident" id="7317932"><a href="/crypto/x509/x509_test.go.html#7295752">bigFromHexString</a></span><span class="op" id="7317948">(</span><span class="string" id="7317949">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7318207">)</span><span class="op" id="7318208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318211">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318214">pemBlock</span><span class="op" id="7318222">,</span>&nbsp;<span class="ident" id="7318224">_</span>&nbsp;<span class="op" id="7318226">:=</span>&nbsp;<span class="ident" id="7318229"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7318232">.</span><span class="ident" id="7318233">Decode</span><span class="op" id="7318239">(</span><span class="op" id="7318240">[</span><span class="op" id="7318241">]</span><span class="builtintype" id="7318242">byte</span><span class="op" id="7318246">(</span><span class="ident" id="7318247"><a href="/crypto/x509/x509_test.go.html#7315679">dsaCertPem</a></span><span class="op" id="7318257">)</span><span class="op" id="7318258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318261">cert</span><span class="op" id="7318265">,</span>&nbsp;<span class="ident" id="7318267">err</span>&nbsp;<span class="op" id="7318271">:=</span>&nbsp;<span class="ident" id="7318274"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7318290">(</span><span class="ident" id="7318291"><a href="/crypto/x509/x509_test.go.html#7318214">pemBlock</a></span><span class="op" id="7318299">.</span><span class="ident" id="7318300">Bytes</span><span class="op" id="7318305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318308">if</span>&nbsp;<span class="ident" id="7318311"><a href="/crypto/x509/x509_test.go.html#7318267">err</a></span>&nbsp;<span class="op" id="7318315">!=</span>&nbsp;<span class="ident" id="7318318">nil</span>&nbsp;<span class="op" id="7318322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318326"><a href="/crypto/x509/x509_test.go.html#7317202">t</a></span><span class="op" id="7318327">.</span><span class="ident" id="7318328">Fatalf</span><span class="op" id="7318334">(</span><span class="string" id="7318335">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7318368">,</span>&nbsp;<span class="ident" id="7318370"><a href="/crypto/x509/x509_test.go.html#7318267">err</a></span><span class="op" id="7318373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318376">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318379">if</span>&nbsp;<span class="ident" id="7318382"><a href="/crypto/x509/x509_test.go.html#7318261">cert</a></span><span class="op" id="7318386">.</span><span class="ident" id="7318387">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7318406">!=</span>&nbsp;<span class="ident" id="7318409"><a href="/crypto/x509/x509.go.html#4034110">DSA</a></span>&nbsp;<span class="op" id="7318413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318417"><a href="/crypto/x509/x509_test.go.html#7317202">t</a></span><span class="op" id="7318418">.</span><span class="ident" id="7318419">Errorf</span><span class="op" id="7318425">(</span><span class="string" id="7318426">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7318460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318466">parsedKey</span><span class="op" id="7318475">,</span>&nbsp;<span class="ident" id="7318477">ok</span>&nbsp;<span class="op" id="7318480">:=</span>&nbsp;<span class="ident" id="7318483"><a href="/crypto/x509/x509_test.go.html#7318261">cert</a></span><span class="op" id="7318487">.</span><span class="ident" id="7318488">PublicKey</span><span class="op" id="7318497">.</span><span class="op" id="7318498">(</span><span class="op" id="7318499">*</span><span class="ident" id="7318500"><a href="/crypto/x509/x509_test.go.html#7293091">dsa</a></span><span class="op" id="7318503">.</span><span class="ident" id="7318504">PublicKey</span><span class="op" id="7318513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318516">if</span>&nbsp;<span class="op" id="7318519">!</span><span class="ident" id="7318520"><a href="/crypto/x509/x509_test.go.html#7318477">ok</a></span>&nbsp;<span class="op" id="7318523">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318527"><a href="/crypto/x509/x509_test.go.html#7317202">t</a></span><span class="op" id="7318528">.</span><span class="ident" id="7318529">Fatalf</span><span class="op" id="7318535">(</span><span class="string" id="7318536">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7318570">,</span>&nbsp;<span class="ident" id="7318572"><a href="/crypto/x509/x509_test.go.html#7318267">err</a></span><span class="op" id="7318575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318581">if</span>&nbsp;<span class="ident" id="7318584"><a href="/crypto/x509/x509_test.go.html#7317219">expectedKey</a></span><span class="op" id="7318595">.</span><span class="ident" id="7318596">Y</span><span class="op" id="7318597">.</span><span class="ident" id="7318598">Cmp</span><span class="op" id="7318601">(</span><span class="ident" id="7318602"><a href="/crypto/x509/x509_test.go.html#7318466">parsedKey</a></span><span class="op" id="7318611">.</span><span class="ident" id="7318612">Y</span><span class="op" id="7318613">)</span>&nbsp;<span class="op" id="7318615">!=</span>&nbsp;<span class="num" id="7318618">0</span>&nbsp;<span class="op" id="7318620">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318625"><a href="/crypto/x509/x509_test.go.html#7317219">expectedKey</a></span><span class="op" id="7318636">.</span><span class="ident" id="7318637">P</span><span class="op" id="7318638">.</span><span class="ident" id="7318639">Cmp</span><span class="op" id="7318642">(</span><span class="ident" id="7318643"><a href="/crypto/x509/x509_test.go.html#7318466">parsedKey</a></span><span class="op" id="7318652">.</span><span class="ident" id="7318653">P</span><span class="op" id="7318654">)</span>&nbsp;<span class="op" id="7318656">!=</span>&nbsp;<span class="num" id="7318659">0</span>&nbsp;<span class="op" id="7318661">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318666"><a href="/crypto/x509/x509_test.go.html#7317219">expectedKey</a></span><span class="op" id="7318677">.</span><span class="ident" id="7318678">Q</span><span class="op" id="7318679">.</span><span class="ident" id="7318680">Cmp</span><span class="op" id="7318683">(</span><span class="ident" id="7318684"><a href="/crypto/x509/x509_test.go.html#7318466">parsedKey</a></span><span class="op" id="7318693">.</span><span class="ident" id="7318694">Q</span><span class="op" id="7318695">)</span>&nbsp;<span class="op" id="7318697">!=</span>&nbsp;<span class="num" id="7318700">0</span>&nbsp;<span class="op" id="7318702">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318707"><a href="/crypto/x509/x509_test.go.html#7317219">expectedKey</a></span><span class="op" id="7318718">.</span><span class="ident" id="7318719">G</span><span class="op" id="7318720">.</span><span class="ident" id="7318721">Cmp</span><span class="op" id="7318724">(</span><span class="ident" id="7318725"><a href="/crypto/x509/x509_test.go.html#7318466">parsedKey</a></span><span class="op" id="7318734">.</span><span class="ident" id="7318735">G</span><span class="op" id="7318736">)</span>&nbsp;<span class="op" id="7318738">!=</span>&nbsp;<span class="num" id="7318741">0</span>&nbsp;<span class="op" id="7318743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318747"><a href="/crypto/x509/x509_test.go.html#7317202">t</a></span><span class="op" id="7318748">.</span><span class="ident" id="7318749">Fatal</span><span class="op" id="7318754">(</span><span class="string" id="7318755">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7318793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7318796">}</span><br>
<span class="lineno"></span><span class="op" id="7318798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7318801">func</span>&nbsp;<span class="ident" id="7318806">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7318851">(</span><span class="ident" id="7318852">t</span>&nbsp;<span class="op" id="7318854">*</span><span class="ident" id="7318855"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7318862">.</span><span class="ident" id="7318863">T</span><span class="op" id="7318864">)</span>&nbsp;<span class="op" id="7318866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318869">pemBlock</span><span class="op" id="7318877">,</span>&nbsp;<span class="ident" id="7318879">_</span>&nbsp;<span class="op" id="7318881">:=</span>&nbsp;<span class="ident" id="7318884"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7318887">.</span><span class="ident" id="7318888">Decode</span><span class="op" id="7318894">(</span><span class="op" id="7318895">[</span><span class="op" id="7318896">]</span><span class="builtintype" id="7318897">byte</span><span class="op" id="7318901">(</span><span class="ident" id="7318902"><a href="/crypto/x509/x509_test.go.html#7315679">dsaCertPem</a></span><span class="op" id="7318912">)</span><span class="op" id="7318913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318916">cert</span><span class="op" id="7318920">,</span>&nbsp;<span class="ident" id="7318922">err</span>&nbsp;<span class="op" id="7318926">:=</span>&nbsp;<span class="ident" id="7318929"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7318945">(</span><span class="ident" id="7318946"><a href="/crypto/x509/x509_test.go.html#7318869">pemBlock</a></span><span class="op" id="7318954">.</span><span class="ident" id="7318955">Bytes</span><span class="op" id="7318960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7318963">if</span>&nbsp;<span class="ident" id="7318966"><a href="/crypto/x509/x509_test.go.html#7318922">err</a></span>&nbsp;<span class="op" id="7318970">!=</span>&nbsp;<span class="ident" id="7318973">nil</span>&nbsp;<span class="op" id="7318977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7318981"><a href="/crypto/x509/x509_test.go.html#7318852">t</a></span><span class="op" id="7318982">.</span><span class="ident" id="7318983">Fatalf</span><span class="op" id="7318989">(</span><span class="string" id="7318990">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7319023">,</span>&nbsp;<span class="ident" id="7319025"><a href="/crypto/x509/x509_test.go.html#7318922">err</a></span><span class="op" id="7319028">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319034">if</span>&nbsp;<span class="ident" id="7319037"><a href="/crypto/x509/x509_test.go.html#7318916">cert</a></span><span class="op" id="7319041">.</span><span class="ident" id="7319042">SignatureAlgorithm</span>&nbsp;<span class="op" id="7319061">!=</span>&nbsp;<span class="ident" id="7319064"><a href="/crypto/x509/x509.go.html#4033918">DSAWithSHA1</a></span>&nbsp;<span class="op" id="7319076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319080"><a href="/crypto/x509/x509_test.go.html#7318852">t</a></span><span class="op" id="7319081">.</span><span class="ident" id="7319082">Errorf</span><span class="op" id="7319088">(</span><span class="string" id="7319089">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7319137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319140">}</span><br>
<span class="lineno"></span><span class="op" id="7319142">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7319145">func</span>&nbsp;<span class="ident" id="7319150">TestVerifyCertificateWithDSASignature</span><span class="op" id="7319187">(</span><span class="ident" id="7319188">t</span>&nbsp;<span class="op" id="7319190">*</span><span class="ident" id="7319191"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7319198">.</span><span class="ident" id="7319199">T</span><span class="op" id="7319200">)</span>&nbsp;<span class="op" id="7319202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319205">pemBlock</span><span class="op" id="7319213">,</span>&nbsp;<span class="ident" id="7319215">_</span>&nbsp;<span class="op" id="7319217">:=</span>&nbsp;<span class="ident" id="7319220"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7319223">.</span><span class="ident" id="7319224">Decode</span><span class="op" id="7319230">(</span><span class="op" id="7319231">[</span><span class="op" id="7319232">]</span><span class="builtintype" id="7319233">byte</span><span class="op" id="7319237">(</span><span class="ident" id="7319238"><a href="/crypto/x509/x509_test.go.html#7315679">dsaCertPem</a></span><span class="op" id="7319248">)</span><span class="op" id="7319249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319252">cert</span><span class="op" id="7319256">,</span>&nbsp;<span class="ident" id="7319258">err</span>&nbsp;<span class="op" id="7319262">:=</span>&nbsp;<span class="ident" id="7319265"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7319281">(</span><span class="ident" id="7319282"><a href="/crypto/x509/x509_test.go.html#7319205">pemBlock</a></span><span class="op" id="7319290">.</span><span class="ident" id="7319291">Bytes</span><span class="op" id="7319296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319299">if</span>&nbsp;<span class="ident" id="7319302"><a href="/crypto/x509/x509_test.go.html#7319258">err</a></span>&nbsp;<span class="op" id="7319306">!=</span>&nbsp;<span class="ident" id="7319309">nil</span>&nbsp;<span class="op" id="7319313">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319317"><a href="/crypto/x509/x509_test.go.html#7319188">t</a></span><span class="op" id="7319318">.</span><span class="ident" id="7319319">Fatalf</span><span class="op" id="7319325">(</span><span class="string" id="7319326">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7319359">,</span>&nbsp;<span class="ident" id="7319361"><a href="/crypto/x509/x509_test.go.html#7319258">err</a></span><span class="op" id="7319364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7319370">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7319399">if</span>&nbsp;<span class="ident" id="7319402"><a href="/crypto/x509/x509_test.go.html#7319258">err</a></span>&nbsp;<span class="op" id="7319406">=</span>&nbsp;<span class="ident" id="7319408"><a href="/crypto/x509/x509_test.go.html#7319252">cert</a></span><span class="op" id="7319412">.</span><span class="ident" id="7319413">CheckSignatureFrom</span><span class="op" id="7319431">(</span><span class="ident" id="7319432"><a href="/crypto/x509/x509_test.go.html#7319252">cert</a></span><span class="op" id="7319436">)</span><span class="op" id="7319437">;</span>&nbsp;<span class="ident" id="7319439"><a href="/crypto/x509/x509_test.go.html#7319258">err</a></span>&nbsp;<span class="op" id="7319443">!=</span>&nbsp;<span class="ident" id="7319446">nil</span>&nbsp;<span class="op" id="7319450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7319454"><a href="/crypto/x509/x509_test.go.html#7319188">t</a></span><span class="op" id="7319455">.</span><span class="ident" id="7319456">Fatalf</span><span class="op" id="7319462">(</span><span class="string" id="7319463">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7319504">,</span>&nbsp;<span class="ident" id="7319506"><a href="/crypto/x509/x509_test.go.html#7319258">err</a></span><span class="op" id="7319509">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7319512">}</span><br>
<span class="lineno"></span><span class="op" id="7319514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7319517">const</span>&nbsp;<span class="ident" id="7319523">pemCertificate</span>&nbsp;<span class="op" id="7319538">=</span>&nbsp;<span class="string" id="7319540">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7320258">func</span>&nbsp;<span class="ident" id="7320263">TestCRLCreation</span><span class="op" id="7320278">(</span><span class="ident" id="7320279">t</span>&nbsp;<span class="op" id="7320281">*</span><span class="ident" id="7320282"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7320289">.</span><span class="ident" id="7320290">T</span><span class="op" id="7320291">)</span>&nbsp;<span class="op" id="7320293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320296">block</span><span class="op" id="7320301">,</span>&nbsp;<span class="ident" id="7320303">_</span>&nbsp;<span class="op" id="7320305">:=</span>&nbsp;<span class="ident" id="7320308"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7320311">.</span><span class="ident" id="7320312">Decode</span><span class="op" id="7320318">(</span><span class="op" id="7320319">[</span><span class="op" id="7320320">]</span><span class="builtintype" id="7320321">byte</span><span class="op" id="7320325">(</span><span class="ident" id="7320326"><a href="/crypto/x509/x509_test.go.html#7295037">pemPrivateKey</a></span><span class="op" id="7320339">)</span><span class="op" id="7320340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320343">priv</span><span class="op" id="7320347">,</span>&nbsp;<span class="ident" id="7320349">_</span>&nbsp;<span class="op" id="7320351">:=</span>&nbsp;<span class="ident" id="7320354"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7320374">(</span><span class="ident" id="7320375"><a href="/crypto/x509/x509_test.go.html#7320296">block</a></span><span class="op" id="7320380">.</span><span class="ident" id="7320381">Bytes</span><span class="op" id="7320386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320389"><a href="/crypto/x509/x509_test.go.html#7320296">block</a></span><span class="op" id="7320394">,</span>&nbsp;<span class="ident" id="7320396">_</span>&nbsp;<span class="op" id="7320398">=</span>&nbsp;<span class="ident" id="7320400"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7320403">.</span><span class="ident" id="7320404">Decode</span><span class="op" id="7320410">(</span><span class="op" id="7320411">[</span><span class="op" id="7320412">]</span><span class="builtintype" id="7320413">byte</span><span class="op" id="7320417">(</span><span class="ident" id="7320418"><a href="/crypto/x509/x509_test.go.html#7319523">pemCertificate</a></span><span class="op" id="7320432">)</span><span class="op" id="7320433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320436">cert</span><span class="op" id="7320440">,</span>&nbsp;<span class="ident" id="7320442">_</span>&nbsp;<span class="op" id="7320444">:=</span>&nbsp;<span class="ident" id="7320447"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7320463">(</span><span class="ident" id="7320464"><a href="/crypto/x509/x509_test.go.html#7320296">block</a></span><span class="op" id="7320469">.</span><span class="ident" id="7320470">Bytes</span><span class="op" id="7320475">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320479">now</span>&nbsp;<span class="op" id="7320483">:=</span>&nbsp;<span class="ident" id="7320486"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7320490">.</span><span class="ident" id="7320491">Unix</span><span class="op" id="7320495">(</span><span class="num" id="7320496">1000</span><span class="op" id="7320500">,</span>&nbsp;<span class="num" id="7320502">0</span><span class="op" id="7320503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320506">expiry</span>&nbsp;<span class="op" id="7320513">:=</span>&nbsp;<span class="ident" id="7320516"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7320520">.</span><span class="ident" id="7320521">Unix</span><span class="op" id="7320525">(</span><span class="num" id="7320526">10000</span><span class="op" id="7320531">,</span>&nbsp;<span class="num" id="7320533">0</span><span class="op" id="7320534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320538">revokedCerts</span>&nbsp;<span class="op" id="7320551">:=</span>&nbsp;<span class="op" id="7320554">[</span><span class="op" id="7320555">]</span><span class="ident" id="7320556"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7320560">.</span><span class="ident" id="7320561">RevokedCertificate</span><span class="op" id="7320579">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320588">SerialNumber</span><span class="op" id="7320600">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7320604"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7320607">.</span><span class="ident" id="7320608">NewInt</span><span class="op" id="7320614">(</span><span class="num" id="7320615">1</span><span class="op" id="7320616">)</span><span class="op" id="7320617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320622">RevocationTime</span><span class="op" id="7320636">:</span>&nbsp;<span class="ident" id="7320638"><a href="/crypto/x509/x509_test.go.html#7320479">now</a></span><span class="op" id="7320641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320645">}</span><span class="op" id="7320646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320650">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320655">SerialNumber</span><span class="op" id="7320667">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7320671"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7320674">.</span><span class="ident" id="7320675">NewInt</span><span class="op" id="7320681">(</span><span class="num" id="7320682">42</span><span class="op" id="7320684">)</span><span class="op" id="7320685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320690">RevocationTime</span><span class="op" id="7320704">:</span>&nbsp;<span class="ident" id="7320706"><a href="/crypto/x509/x509_test.go.html#7320479">now</a></span><span class="op" id="7320709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320713">}</span><span class="op" id="7320714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320721">crlBytes</span><span class="op" id="7320729">,</span>&nbsp;<span class="ident" id="7320731">err</span>&nbsp;<span class="op" id="7320735">:=</span>&nbsp;<span class="ident" id="7320738"><a href="/crypto/x509/x509_test.go.html#7320436">cert</a></span><span class="op" id="7320742">.</span><span class="ident" id="7320743">CreateCRL</span><span class="op" id="7320752">(</span><span class="ident" id="7320753"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7320757">.</span><span class="ident" id="7320758">Reader</span><span class="op" id="7320764">,</span>&nbsp;<span class="ident" id="7320766"><a href="/crypto/x509/x509_test.go.html#7320343">priv</a></span><span class="op" id="7320770">,</span>&nbsp;<span class="ident" id="7320772"><a href="/crypto/x509/x509_test.go.html#7320538">revokedCerts</a></span><span class="op" id="7320784">,</span>&nbsp;<span class="ident" id="7320786"><a href="/crypto/x509/x509_test.go.html#7320479">now</a></span><span class="op" id="7320789">,</span>&nbsp;<span class="ident" id="7320791"><a href="/crypto/x509/x509_test.go.html#7320506">expiry</a></span><span class="op" id="7320797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320800">if</span>&nbsp;<span class="ident" id="7320803"><a href="/crypto/x509/x509_test.go.html#7320731">err</a></span>&nbsp;<span class="op" id="7320807">!=</span>&nbsp;<span class="ident" id="7320810">nil</span>&nbsp;<span class="op" id="7320814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320818"><a href="/crypto/x509/x509_test.go.html#7320279">t</a></span><span class="op" id="7320819">.</span><span class="ident" id="7320820">Errorf</span><span class="op" id="7320826">(</span><span class="string" id="7320827">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7320851">,</span>&nbsp;<span class="ident" id="7320853"><a href="/crypto/x509/x509_test.go.html#7320731">err</a></span><span class="op" id="7320856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320863">_</span><span class="op" id="7320864">,</span>&nbsp;<span class="ident" id="7320866"><a href="/crypto/x509/x509_test.go.html#7320731">err</a></span>&nbsp;<span class="op" id="7320870">=</span>&nbsp;<span class="ident" id="7320872"><a href="/crypto/x509/x509.go.html#4077323">ParseDERCRL</a></span><span class="op" id="7320883">(</span><span class="ident" id="7320884"><a href="/crypto/x509/x509_test.go.html#7320721">crlBytes</a></span><span class="op" id="7320892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7320895">if</span>&nbsp;<span class="ident" id="7320898"><a href="/crypto/x509/x509_test.go.html#7320731">err</a></span>&nbsp;<span class="op" id="7320902">!=</span>&nbsp;<span class="ident" id="7320905">nil</span>&nbsp;<span class="op" id="7320909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320913"><a href="/crypto/x509/x509_test.go.html#7320279">t</a></span><span class="op" id="7320914">.</span><span class="ident" id="7320915">Errorf</span><span class="op" id="7320921">(</span><span class="string" id="7320922">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7320947">,</span>&nbsp;<span class="ident" id="7320949"><a href="/crypto/x509/x509_test.go.html#7320731">err</a></span><span class="op" id="7320952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7320955">}</span><br>
<span class="lineno"></span><span class="op" id="7320957">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7320960">func</span>&nbsp;<span class="ident" id="7320965">fromBase64</span><span class="op" id="7320975">(</span><span class="ident" id="7320976">in</span>&nbsp;<span class="builtintype" id="7320979">string</span><span class="op" id="7320985">)</span>&nbsp;<span class="op" id="7320987">[</span><span class="op" id="7320988">]</span><span class="builtintype" id="7320989">byte</span>&nbsp;<span class="op" id="7320994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7320997">out</span>&nbsp;<span class="op" id="7321001">:=</span>&nbsp;<span class="builtinfunc" id="7321004">make</span><span class="op" id="7321008">(</span><span class="op" id="7321009">[</span><span class="op" id="7321010">]</span><span class="builtintype" id="7321011">byte</span><span class="op" id="7321015">,</span>&nbsp;<span class="ident" id="7321017"><a href="/crypto/x509/x509_test.go.html#7293244">base64</a></span><span class="op" id="7321023">.</span><span class="ident" id="7321024">StdEncoding</span><span class="op" id="7321035">.</span><span class="ident" id="7321036">DecodedLen</span><span class="op" id="7321046">(</span><span class="builtinfunc" id="7321047">len</span><span class="op" id="7321050">(</span><span class="ident" id="7321051"><a href="/crypto/x509/x509_test.go.html#7320976">in</a></span><span class="op" id="7321053">)</span><span class="op" id="7321054">)</span><span class="op" id="7321055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321058">n</span><span class="op" id="7321059">,</span>&nbsp;<span class="ident" id="7321061">err</span>&nbsp;<span class="op" id="7321065">:=</span>&nbsp;<span class="ident" id="7321068"><a href="/crypto/x509/x509_test.go.html#7293244">base64</a></span><span class="op" id="7321074">.</span><span class="ident" id="7321075">StdEncoding</span><span class="op" id="7321086">.</span><span class="ident" id="7321087">Decode</span><span class="op" id="7321093">(</span><span class="ident" id="7321094"><a href="/crypto/x509/x509_test.go.html#7320997">out</a></span><span class="op" id="7321097">,</span>&nbsp;<span class="op" id="7321099">[</span><span class="op" id="7321100">]</span><span class="builtintype" id="7321101">byte</span><span class="op" id="7321105">(</span><span class="ident" id="7321106"><a href="/crypto/x509/x509_test.go.html#7320976">in</a></span><span class="op" id="7321108">)</span><span class="op" id="7321109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321112">if</span>&nbsp;<span class="ident" id="7321115"><a href="/crypto/x509/x509_test.go.html#7321061">err</a></span>&nbsp;<span class="op" id="7321119">!=</span>&nbsp;<span class="ident" id="7321122">nil</span>&nbsp;<span class="op" id="7321126">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7321130">panic</span><span class="op" id="7321135">(</span><span class="string" id="7321136">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7321161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321167">return</span>&nbsp;<span class="ident" id="7321174"><a href="/crypto/x509/x509_test.go.html#7320997">out</a></span><span class="op" id="7321177">[</span><span class="op" id="7321178">:</span><span class="ident" id="7321179"><a href="/crypto/x509/x509_test.go.html#7321058">n</a></span><span class="op" id="7321180">]</span><br>
<span class="lineno"></span><span class="op" id="7321182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7321185">func</span>&nbsp;<span class="ident" id="7321190">TestParseDERCRL</span><span class="op" id="7321205">(</span><span class="ident" id="7321206">t</span>&nbsp;<span class="op" id="7321208">*</span><span class="ident" id="7321209"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7321216">.</span><span class="ident" id="7321217">T</span><span class="op" id="7321218">)</span>&nbsp;<span class="op" id="7321220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321223">derBytes</span>&nbsp;<span class="op" id="7321232">:=</span>&nbsp;<span class="ident" id="7321235"><a href="/crypto/x509/x509_test.go.html#7320965">fromBase64</a></span><span class="op" id="7321245">(</span><span class="ident" id="7321246"><a href="/crypto/x509/x509_test.go.html#7323083">derCRLBase64</a></span><span class="op" id="7321258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321261">certList</span><span class="op" id="7321269">,</span>&nbsp;<span class="ident" id="7321271">err</span>&nbsp;<span class="op" id="7321275">:=</span>&nbsp;<span class="ident" id="7321278"><a href="/crypto/x509/x509.go.html#4077323">ParseDERCRL</a></span><span class="op" id="7321289">(</span><span class="ident" id="7321290"><a href="/crypto/x509/x509_test.go.html#7321223">derBytes</a></span><span class="op" id="7321298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321301">if</span>&nbsp;<span class="ident" id="7321304"><a href="/crypto/x509/x509_test.go.html#7321271">err</a></span>&nbsp;<span class="op" id="7321308">!=</span>&nbsp;<span class="ident" id="7321311">nil</span>&nbsp;<span class="op" id="7321315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321319"><a href="/crypto/x509/x509_test.go.html#7321206">t</a></span><span class="op" id="7321320">.</span><span class="ident" id="7321321">Errorf</span><span class="op" id="7321327">(</span><span class="string" id="7321328">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7321347">,</span>&nbsp;<span class="ident" id="7321349"><a href="/crypto/x509/x509_test.go.html#7321271">err</a></span><span class="op" id="7321352">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321356">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321367">numCerts</span>&nbsp;<span class="op" id="7321376">:=</span>&nbsp;<span class="builtinfunc" id="7321379">len</span><span class="op" id="7321382">(</span><span class="ident" id="7321383"><a href="/crypto/x509/x509_test.go.html#7321261">certList</a></span><span class="op" id="7321391">.</span><span class="ident" id="7321392">TBSCertList</span><span class="op" id="7321403">.</span><span class="ident" id="7321404">RevokedCertificates</span><span class="op" id="7321423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321426">expected</span>&nbsp;<span class="op" id="7321435">:=</span>&nbsp;<span class="num" id="7321438">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321442">if</span>&nbsp;<span class="ident" id="7321445"><a href="/crypto/x509/x509_test.go.html#7321367">numCerts</a></span>&nbsp;<span class="op" id="7321454">!=</span>&nbsp;<span class="ident" id="7321457"><a href="/crypto/x509/x509_test.go.html#7321426">expected</a></span>&nbsp;<span class="op" id="7321466">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321470"><a href="/crypto/x509/x509_test.go.html#7321206">t</a></span><span class="op" id="7321471">.</span><span class="ident" id="7321472">Errorf</span><span class="op" id="7321478">(</span><span class="string" id="7321479">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7321533">,</span>&nbsp;<span class="ident" id="7321535"><a href="/crypto/x509/x509_test.go.html#7321367">numCerts</a></span><span class="op" id="7321543">,</span>&nbsp;<span class="ident" id="7321545"><a href="/crypto/x509/x509_test.go.html#7321426">expected</a></span><span class="op" id="7321553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7321560">if</span>&nbsp;<span class="ident" id="7321563"><a href="/crypto/x509/x509_test.go.html#7321261">certList</a></span><span class="op" id="7321571">.</span><span class="ident" id="7321572">HasExpired</span><span class="op" id="7321582">(</span><span class="ident" id="7321583"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7321587">.</span><span class="ident" id="7321588">Unix</span><span class="op" id="7321592">(</span><span class="num" id="7321593">1302517272</span><span class="op" id="7321603">,</span>&nbsp;<span class="num" id="7321605">0</span><span class="op" id="7321606">)</span><span class="op" id="7321607">)</span>&nbsp;<span class="op" id="7321609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321613"><a href="/crypto/x509/x509_test.go.html#7321206">t</a></span><span class="op" id="7321614">.</span><span class="ident" id="7321615">Errorf</span><span class="op" id="7321621">(</span><span class="string" id="7321622">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7321660">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7321663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7321667">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7321726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7321729">func</span>&nbsp;<span class="ident" id="7321734">TestCRLWithoutExpiry</span><span class="op" id="7321754">(</span><span class="ident" id="7321755">t</span>&nbsp;<span class="op" id="7321757">*</span><span class="ident" id="7321758"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7321765">.</span><span class="ident" id="7321766">T</span><span class="op" id="7321767">)</span>&nbsp;<span class="op" id="7321769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7321772">derBytes</span>&nbsp;<span class="op" id="7321781">:=</span>&nbsp;<span class="ident" id="7321784"><a href="/crypto/x509/x509_test.go.html#7320965">fromBase64</a></span><span class="op" id="7321794">(</span><span class="string" id="7321795">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7322089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322092">certList</span><span class="op" id="7322100">,</span>&nbsp;<span class="ident" id="7322102">err</span>&nbsp;<span class="op" id="7322106">:=</span>&nbsp;<span class="ident" id="7322109"><a href="/crypto/x509/x509.go.html#4077323">ParseDERCRL</a></span><span class="op" id="7322120">(</span><span class="ident" id="7322121"><a href="/crypto/x509/x509_test.go.html#7321772">derBytes</a></span><span class="op" id="7322129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322132">if</span>&nbsp;<span class="ident" id="7322135"><a href="/crypto/x509/x509_test.go.html#7322102">err</a></span>&nbsp;<span class="op" id="7322139">!=</span>&nbsp;<span class="ident" id="7322142">nil</span>&nbsp;<span class="op" id="7322146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322150"><a href="/crypto/x509/x509_test.go.html#7321755">t</a></span><span class="op" id="7322151">.</span><span class="ident" id="7322152">Fatal</span><span class="op" id="7322157">(</span><span class="ident" id="7322158"><a href="/crypto/x509/x509_test.go.html#7322102">err</a></span><span class="op" id="7322161">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322167">if</span>&nbsp;<span class="op" id="7322170">!</span><span class="ident" id="7322171"><a href="/crypto/x509/x509_test.go.html#7322092">certList</a></span><span class="op" id="7322179">.</span><span class="ident" id="7322180">TBSCertList</span><span class="op" id="7322191">.</span><span class="ident" id="7322192">NextUpdate</span><span class="op" id="7322202">.</span><span class="ident" id="7322203">IsZero</span><span class="op" id="7322209">(</span><span class="op" id="7322210">)</span>&nbsp;<span class="op" id="7322212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322216"><a href="/crypto/x509/x509_test.go.html#7321755">t</a></span><span class="op" id="7322217">.</span><span class="ident" id="7322218">Errorf</span><span class="op" id="7322224">(</span><span class="string" id="7322225">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7322259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322262">}</span><br>
<span class="lineno"></span><span class="op" id="7322264">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7322267">func</span>&nbsp;<span class="ident" id="7322272">TestParsePEMCRL</span><span class="op" id="7322287">(</span><span class="ident" id="7322288">t</span>&nbsp;<span class="op" id="7322290">*</span><span class="ident" id="7322291"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7322298">.</span><span class="ident" id="7322299">T</span><span class="op" id="7322300">)</span>&nbsp;<span class="op" id="7322302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322305">pemBytes</span>&nbsp;<span class="op" id="7322314">:=</span>&nbsp;<span class="ident" id="7322317"><a href="/crypto/x509/x509_test.go.html#7320965">fromBase64</a></span><span class="op" id="7322327">(</span><span class="ident" id="7322328"><a href="/crypto/x509/x509_test.go.html#7327780">pemCRLBase64</a></span><span class="op" id="7322340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322343">certList</span><span class="op" id="7322351">,</span>&nbsp;<span class="ident" id="7322353">err</span>&nbsp;<span class="op" id="7322357">:=</span>&nbsp;<span class="ident" id="7322360"><a href="/crypto/x509/x509.go.html#4076992">ParseCRL</a></span><span class="op" id="7322368">(</span><span class="ident" id="7322369"><a href="/crypto/x509/x509_test.go.html#7322305">pemBytes</a></span><span class="op" id="7322377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322380">if</span>&nbsp;<span class="ident" id="7322383"><a href="/crypto/x509/x509_test.go.html#7322353">err</a></span>&nbsp;<span class="op" id="7322387">!=</span>&nbsp;<span class="ident" id="7322390">nil</span>&nbsp;<span class="op" id="7322394">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322398"><a href="/crypto/x509/x509_test.go.html#7322288">t</a></span><span class="op" id="7322399">.</span><span class="ident" id="7322400">Errorf</span><span class="op" id="7322406">(</span><span class="string" id="7322407">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7322426">,</span>&nbsp;<span class="ident" id="7322428"><a href="/crypto/x509/x509_test.go.html#7322353">err</a></span><span class="op" id="7322431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322435">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322446">numCerts</span>&nbsp;<span class="op" id="7322455">:=</span>&nbsp;<span class="builtinfunc" id="7322458">len</span><span class="op" id="7322461">(</span><span class="ident" id="7322462"><a href="/crypto/x509/x509_test.go.html#7322343">certList</a></span><span class="op" id="7322470">.</span><span class="ident" id="7322471">TBSCertList</span><span class="op" id="7322482">.</span><span class="ident" id="7322483">RevokedCertificates</span><span class="op" id="7322502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322505">expected</span>&nbsp;<span class="op" id="7322514">:=</span>&nbsp;<span class="num" id="7322517">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322520">if</span>&nbsp;<span class="ident" id="7322523"><a href="/crypto/x509/x509_test.go.html#7322446">numCerts</a></span>&nbsp;<span class="op" id="7322532">!=</span>&nbsp;<span class="ident" id="7322535"><a href="/crypto/x509/x509_test.go.html#7322505">expected</a></span>&nbsp;<span class="op" id="7322544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322548"><a href="/crypto/x509/x509_test.go.html#7322288">t</a></span><span class="op" id="7322549">.</span><span class="ident" id="7322550">Errorf</span><span class="op" id="7322556">(</span><span class="string" id="7322557">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7322611">,</span>&nbsp;<span class="ident" id="7322613"><a href="/crypto/x509/x509_test.go.html#7322446">numCerts</a></span><span class="op" id="7322621">,</span>&nbsp;<span class="ident" id="7322623"><a href="/crypto/x509/x509_test.go.html#7322505">expected</a></span><span class="op" id="7322631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322638">if</span>&nbsp;<span class="ident" id="7322641"><a href="/crypto/x509/x509_test.go.html#7322343">certList</a></span><span class="op" id="7322649">.</span><span class="ident" id="7322650">HasExpired</span><span class="op" id="7322660">(</span><span class="ident" id="7322661"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7322665">.</span><span class="ident" id="7322666">Unix</span><span class="op" id="7322670">(</span><span class="num" id="7322671">1302517272</span><span class="op" id="7322681">,</span>&nbsp;<span class="num" id="7322683">0</span><span class="op" id="7322684">)</span><span class="op" id="7322685">)</span>&nbsp;<span class="op" id="7322687">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322691"><a href="/crypto/x509/x509_test.go.html#7322288">t</a></span><span class="op" id="7322692">.</span><span class="ident" id="7322693">Errorf</span><span class="op" id="7322699">(</span><span class="string" id="7322700">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7322738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7322745">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7322804">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7322807">func</span>&nbsp;<span class="ident" id="7322812">TestImports</span><span class="op" id="7322823">(</span><span class="ident" id="7322824">t</span>&nbsp;<span class="op" id="7322826">*</span><span class="ident" id="7322827"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7322834">.</span><span class="ident" id="7322835">T</span><span class="op" id="7322836">)</span>&nbsp;<span class="op" id="7322838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322841">switch</span>&nbsp;<span class="ident" id="7322848"><a href="/crypto/x509/x509_test.go.html#7293336">runtime</a></span><span class="op" id="7322855">.</span><span class="ident" id="7322856">GOOS</span>&nbsp;<span class="op" id="7322861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322864">case</span>&nbsp;<span class="string" id="7322869">&#34;android&#34;</span><span class="op" id="7322878">,</span>&nbsp;<span class="string" id="7322880">&#34;nacl&#34;</span><span class="op" id="7322886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7322890"><a href="/crypto/x509/x509_test.go.html#7322824">t</a></span><span class="op" id="7322891">.</span><span class="ident" id="7322892">Skipf</span><span class="op" id="7322897">(</span><span class="string" id="7322898">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7322914">,</span>&nbsp;<span class="ident" id="7322916"><a href="/crypto/x509/x509_test.go.html#7293336">runtime</a></span><span class="op" id="7322923">.</span><span class="ident" id="7322924">GOOS</span><span class="op" id="7322928">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7322931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7322935">if</span>&nbsp;<span class="ident" id="7322938">err</span>&nbsp;<span class="op" id="7322942">:=</span>&nbsp;<span class="ident" id="7322945"><a href="/crypto/x509/x509_test.go.html#7293314">exec</a></span><span class="op" id="7322949">.</span><span class="ident" id="7322950">Command</span><span class="op" id="7322957">(</span><span class="string" id="7322958">&#34;go&#34;</span><span class="op" id="7322962">,</span>&nbsp;<span class="string" id="7322964">&#34;run&#34;</span><span class="op" id="7322969">,</span>&nbsp;<span class="string" id="7322971">&#34;x509_test_import.go&#34;</span><span class="op" id="7322992">)</span><span class="op" id="7322993">.</span><span class="ident" id="7322994">Run</span><span class="op" id="7322997">(</span><span class="op" id="7322998">)</span><span class="op" id="7322999">;</span>&nbsp;<span class="ident" id="7323001"><a href="/crypto/x509/x509_test.go.html#7322938">err</a></span>&nbsp;<span class="op" id="7323005">!=</span>&nbsp;<span class="ident" id="7323008">nil</span>&nbsp;<span class="op" id="7323012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7323016"><a href="/crypto/x509/x509_test.go.html#7322824">t</a></span><span class="op" id="7323017">.</span><span class="ident" id="7323018">Errorf</span><span class="op" id="7323024">(</span><span class="string" id="7323025">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7323064">,</span>&nbsp;<span class="ident" id="7323066"><a href="/crypto/x509/x509_test.go.html#7322938">err</a></span><span class="op" id="7323069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7323072">}</span><br>
<span class="lineno">750</span><span class="op" id="7323074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7323077">const</span>&nbsp;<span class="ident" id="7323083">derCRLBase64</span>&nbsp;<span class="op" id="7323096">=</span>&nbsp;<span class="string" id="7323098">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7327774">const</span>&nbsp;<span class="ident" id="7327780">pemCRLBase64</span>&nbsp;<span class="op" id="7327793">=</span>&nbsp;<span class="string" id="7327795">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7328799">func</span>&nbsp;<span class="ident" id="7328804">TestCreateCertificateRequest</span><span class="op" id="7328832">(</span><span class="ident" id="7328833">t</span>&nbsp;<span class="op" id="7328835">*</span><span class="ident" id="7328836"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7328843">.</span><span class="ident" id="7328844">T</span><span class="op" id="7328845">)</span>&nbsp;<span class="op" id="7328847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328850">random</span>&nbsp;<span class="op" id="7328857">:=</span>&nbsp;<span class="ident" id="7328860"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7328864">.</span><span class="ident" id="7328865">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328874">block</span><span class="op" id="7328879">,</span>&nbsp;<span class="ident" id="7328881">_</span>&nbsp;<span class="op" id="7328883">:=</span>&nbsp;<span class="ident" id="7328886"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7328889">.</span><span class="ident" id="7328890">Decode</span><span class="op" id="7328896">(</span><span class="op" id="7328897">[</span><span class="op" id="7328898">]</span><span class="builtintype" id="7328899">byte</span><span class="op" id="7328903">(</span><span class="ident" id="7328904"><a href="/crypto/x509/x509_test.go.html#7295037">pemPrivateKey</a></span><span class="op" id="7328917">)</span><span class="op" id="7328918">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328921">rsaPriv</span><span class="op" id="7328928">,</span>&nbsp;<span class="ident" id="7328930">err</span>&nbsp;<span class="op" id="7328934">:=</span>&nbsp;<span class="ident" id="7328937"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7328957">(</span><span class="ident" id="7328958"><a href="/crypto/x509/x509_test.go.html#7328874">block</a></span><span class="op" id="7328963">.</span><span class="ident" id="7328964">Bytes</span><span class="op" id="7328969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7328972">if</span>&nbsp;<span class="ident" id="7328975"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7328979">!=</span>&nbsp;<span class="ident" id="7328982">nil</span>&nbsp;<span class="op" id="7328986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7328990"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7328991">.</span><span class="ident" id="7328992">Fatalf</span><span class="op" id="7328998">(</span><span class="string" id="7328999">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7329032">,</span>&nbsp;<span class="ident" id="7329034"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span><span class="op" id="7329037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329044">ecdsa256Priv</span><span class="op" id="7329056">,</span>&nbsp;<span class="ident" id="7329058"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7329062">:=</span>&nbsp;<span class="ident" id="7329065"><a href="/crypto/x509/x509_test.go.html#7293105">ecdsa</a></span><span class="op" id="7329070">.</span><span class="ident" id="7329071">GenerateKey</span><span class="op" id="7329082">(</span><span class="ident" id="7329083"><a href="/crypto/x509/x509_test.go.html#7293121">elliptic</a></span><span class="op" id="7329091">.</span><span class="ident" id="7329092">P256</span><span class="op" id="7329096">(</span><span class="op" id="7329097">)</span><span class="op" id="7329098">,</span>&nbsp;<span class="ident" id="7329100"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7329104">.</span><span class="ident" id="7329105">Reader</span><span class="op" id="7329111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329114">if</span>&nbsp;<span class="ident" id="7329117"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7329121">!=</span>&nbsp;<span class="ident" id="7329124">nil</span>&nbsp;<span class="op" id="7329128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329132"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7329133">.</span><span class="ident" id="7329134">Fatalf</span><span class="op" id="7329140">(</span><span class="string" id="7329141">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7329175">,</span>&nbsp;<span class="ident" id="7329177"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span><span class="op" id="7329180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329187">ecdsa384Priv</span><span class="op" id="7329199">,</span>&nbsp;<span class="ident" id="7329201"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7329205">:=</span>&nbsp;<span class="ident" id="7329208"><a href="/crypto/x509/x509_test.go.html#7293105">ecdsa</a></span><span class="op" id="7329213">.</span><span class="ident" id="7329214">GenerateKey</span><span class="op" id="7329225">(</span><span class="ident" id="7329226"><a href="/crypto/x509/x509_test.go.html#7293121">elliptic</a></span><span class="op" id="7329234">.</span><span class="ident" id="7329235">P384</span><span class="op" id="7329239">(</span><span class="op" id="7329240">)</span><span class="op" id="7329241">,</span>&nbsp;<span class="ident" id="7329243"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7329247">.</span><span class="ident" id="7329248">Reader</span><span class="op" id="7329254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329257">if</span>&nbsp;<span class="ident" id="7329260"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7329264">!=</span>&nbsp;<span class="ident" id="7329267">nil</span>&nbsp;<span class="op" id="7329271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329275"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7329276">.</span><span class="ident" id="7329277">Fatalf</span><span class="op" id="7329283">(</span><span class="string" id="7329284">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7329318">,</span>&nbsp;<span class="ident" id="7329320"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span><span class="op" id="7329323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329330">ecdsa521Priv</span><span class="op" id="7329342">,</span>&nbsp;<span class="ident" id="7329344"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7329348">:=</span>&nbsp;<span class="ident" id="7329351"><a href="/crypto/x509/x509_test.go.html#7293105">ecdsa</a></span><span class="op" id="7329356">.</span><span class="ident" id="7329357">GenerateKey</span><span class="op" id="7329368">(</span><span class="ident" id="7329369"><a href="/crypto/x509/x509_test.go.html#7293121">elliptic</a></span><span class="op" id="7329377">.</span><span class="ident" id="7329378">P521</span><span class="op" id="7329382">(</span><span class="op" id="7329383">)</span><span class="op" id="7329384">,</span>&nbsp;<span class="ident" id="7329386"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7329390">.</span><span class="ident" id="7329391">Reader</span><span class="op" id="7329397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329400">if</span>&nbsp;<span class="ident" id="7329403"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span>&nbsp;<span class="op" id="7329407">!=</span>&nbsp;<span class="ident" id="7329410">nil</span>&nbsp;<span class="op" id="7329414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329418"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7329419">.</span><span class="ident" id="7329420">Fatalf</span><span class="op" id="7329426">(</span><span class="string" id="7329427">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7329461">,</span>&nbsp;<span class="ident" id="7329463"><a href="/crypto/x509/x509_test.go.html#7328930">err</a></span><span class="op" id="7329466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329473">tests</span>&nbsp;<span class="op" id="7329479">:=</span>&nbsp;<span class="op" id="7329482">[</span><span class="op" id="7329483">]</span><span class="keyword" id="7329484">struct</span>&nbsp;<span class="op" id="7329491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329495">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7329503">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329512">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7329520">interface</span><span class="op" id="7329529">{</span><span class="op" id="7329530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329534">sigAlgo</span>&nbsp;<span class="ident" id="7329542"><a href="/crypto/x509/x509.go.html#4033750">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329562">}</span><span class="op" id="7329563">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329567">{</span><span class="string" id="7329568">&#34;RSA&#34;</span><span class="op" id="7329573">,</span>&nbsp;<span class="ident" id="7329575"><a href="/crypto/x509/x509_test.go.html#7328921">rsaPriv</a></span><span class="op" id="7329582">,</span>&nbsp;<span class="ident" id="7329584"><a href="/crypto/x509/x509.go.html#4033860">SHA1WithRSA</a></span><span class="op" id="7329595">}</span><span class="op" id="7329596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329600">{</span><span class="string" id="7329601">&#34;ECDSA-256&#34;</span><span class="op" id="7329612">,</span>&nbsp;<span class="ident" id="7329614"><a href="/crypto/x509/x509_test.go.html#7329044">ecdsa256Priv</a></span><span class="op" id="7329626">,</span>&nbsp;<span class="ident" id="7329628"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="7329641">}</span><span class="op" id="7329642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329646">{</span><span class="string" id="7329647">&#34;ECDSA-384&#34;</span><span class="op" id="7329658">,</span>&nbsp;<span class="ident" id="7329660"><a href="/crypto/x509/x509_test.go.html#7329187">ecdsa384Priv</a></span><span class="op" id="7329672">,</span>&nbsp;<span class="ident" id="7329674"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="7329687">}</span><span class="op" id="7329688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329692">{</span><span class="string" id="7329693">&#34;ECDSA-521&#34;</span><span class="op" id="7329704">,</span>&nbsp;<span class="ident" id="7329706"><a href="/crypto/x509/x509_test.go.html#7329330">ecdsa521Priv</a></span><span class="op" id="7329718">,</span>&nbsp;<span class="ident" id="7329720"><a href="/crypto/x509/x509.go.html#4033946">ECDSAWithSHA1</a></span><span class="op" id="7329733">}</span><span class="op" id="7329734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329737">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7329741">for</span>&nbsp;<span class="ident" id="7329745">_</span><span class="op" id="7329746">,</span>&nbsp;<span class="ident" id="7329748">test</span>&nbsp;<span class="op" id="7329753">:=</span>&nbsp;<span class="keyword" id="7329756">range</span>&nbsp;<span class="ident" id="7329762"><a href="/crypto/x509/x509_test.go.html#7329473">tests</a></span>&nbsp;<span class="op" id="7329768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329772">template</span>&nbsp;<span class="op" id="7329781">:=</span>&nbsp;<span class="ident" id="7329784"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="7329802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329807">Subject</span><span class="op" id="7329814">:</span>&nbsp;<span class="ident" id="7329816"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7329820">.</span><span class="ident" id="7329821">Name</span><span class="op" id="7329825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329831">CommonName</span><span class="op" id="7329841">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7329845">&#34;test.example.com&#34;</span><span class="op" id="7329863">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329869">Organization</span><span class="op" id="7329881">:</span>&nbsp;<span class="op" id="7329883">[</span><span class="op" id="7329884">]</span><span class="builtintype" id="7329885">string</span><span class="op" id="7329891">{</span><span class="string" id="7329892">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7329904">}</span><span class="op" id="7329905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7329910">}</span><span class="op" id="7329911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329916">SignatureAlgorithm</span><span class="op" id="7329934">:</span>&nbsp;<span class="ident" id="7329936"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7329940">.</span><span class="ident" id="7329941">sigAlgo</span><span class="op" id="7329948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7329953">DNSNames</span><span class="op" id="7329961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7329973">[</span><span class="op" id="7329974">]</span><span class="builtintype" id="7329975">string</span><span class="op" id="7329981">{</span><span class="string" id="7329982">&#34;test.example.com&#34;</span><span class="op" id="7330000">}</span><span class="op" id="7330001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330006">EmailAddresses</span><span class="op" id="7330020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7330026">[</span><span class="op" id="7330027">]</span><span class="builtintype" id="7330028">string</span><span class="op" id="7330034">{</span><span class="string" id="7330035">&#34;gopher@golang.org&#34;</span><span class="op" id="7330054">}</span><span class="op" id="7330055">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330060">IPAddresses</span><span class="op" id="7330071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7330080">[</span><span class="op" id="7330081">]</span><span class="ident" id="7330082"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7330085">.</span><span class="ident" id="7330086">IP</span><span class="op" id="7330088">{</span><span class="ident" id="7330089"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7330092">.</span><span class="ident" id="7330093">IPv4</span><span class="op" id="7330097">(</span><span class="num" id="7330098">127</span><span class="op" id="7330101">,</span>&nbsp;<span class="num" id="7330103">0</span><span class="op" id="7330104">,</span>&nbsp;<span class="num" id="7330106">0</span><span class="op" id="7330107">,</span>&nbsp;<span class="num" id="7330109">1</span><span class="op" id="7330110">)</span><span class="op" id="7330111">.</span><span class="ident" id="7330112">To4</span><span class="op" id="7330115">(</span><span class="op" id="7330116">)</span><span class="op" id="7330117">,</span>&nbsp;<span class="ident" id="7330119"><a href="/crypto/x509/x509_test.go.html#7293307">net</a></span><span class="op" id="7330122">.</span><span class="ident" id="7330123">ParseIP</span><span class="op" id="7330130">(</span><span class="string" id="7330131">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7330153">)</span><span class="op" id="7330154">}</span><span class="op" id="7330155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330164">derBytes</span><span class="op" id="7330172">,</span>&nbsp;<span class="ident" id="7330174">err</span>&nbsp;<span class="op" id="7330178">:=</span>&nbsp;<span class="ident" id="7330181"><a href="/crypto/x509/x509.go.html#4081409">CreateCertificateRequest</a></span><span class="op" id="7330205">(</span><span class="ident" id="7330206"><a href="/crypto/x509/x509_test.go.html#7328850">random</a></span><span class="op" id="7330212">,</span>&nbsp;<span class="op" id="7330214">&amp;</span><span class="ident" id="7330215"><a href="/crypto/x509/x509_test.go.html#7329772">template</a></span><span class="op" id="7330223">,</span>&nbsp;<span class="ident" id="7330225"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7330229">.</span><span class="ident" id="7330230">priv</span><span class="op" id="7330234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330238">if</span>&nbsp;<span class="ident" id="7330241"><a href="/crypto/x509/x509_test.go.html#7330174">err</a></span>&nbsp;<span class="op" id="7330245">!=</span>&nbsp;<span class="ident" id="7330248">nil</span>&nbsp;<span class="op" id="7330252">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330257"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7330258">.</span><span class="ident" id="7330259">Errorf</span><span class="op" id="7330265">(</span><span class="string" id="7330266">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7330312">,</span>&nbsp;<span class="ident" id="7330314"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7330318">.</span><span class="ident" id="7330319">name</span><span class="op" id="7330323">,</span>&nbsp;<span class="ident" id="7330325"><a href="/crypto/x509/x509_test.go.html#7330174">err</a></span><span class="op" id="7330328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330333">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330349">out</span><span class="op" id="7330352">,</span>&nbsp;<span class="ident" id="7330354"><a href="/crypto/x509/x509_test.go.html#7330174">err</a></span>&nbsp;<span class="op" id="7330358">:=</span>&nbsp;<span class="ident" id="7330361"><a href="/crypto/x509/x509.go.html#4085421">ParseCertificateRequest</a></span><span class="op" id="7330384">(</span><span class="ident" id="7330385"><a href="/crypto/x509/x509_test.go.html#7330164">derBytes</a></span><span class="op" id="7330393">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330397">if</span>&nbsp;<span class="ident" id="7330400"><a href="/crypto/x509/x509_test.go.html#7330174">err</a></span>&nbsp;<span class="op" id="7330404">!=</span>&nbsp;<span class="ident" id="7330407">nil</span>&nbsp;<span class="op" id="7330411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330416"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7330417">.</span><span class="ident" id="7330418">Errorf</span><span class="op" id="7330424">(</span><span class="string" id="7330425">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7330471">,</span>&nbsp;<span class="ident" id="7330473"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7330477">.</span><span class="ident" id="7330478">name</span><span class="op" id="7330482">,</span>&nbsp;<span class="ident" id="7330484"><a href="/crypto/x509/x509_test.go.html#7330174">err</a></span><span class="op" id="7330487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330492">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7330508">if</span>&nbsp;<span class="ident" id="7330511"><a href="/crypto/x509/x509_test.go.html#7330349">out</a></span><span class="op" id="7330514">.</span><span class="ident" id="7330515">Subject</span><span class="op" id="7330522">.</span><span class="ident" id="7330523">CommonName</span>&nbsp;<span class="op" id="7330534">!=</span>&nbsp;<span class="ident" id="7330537"><a href="/crypto/x509/x509_test.go.html#7329772">template</a></span><span class="op" id="7330545">.</span><span class="ident" id="7330546">Subject</span><span class="op" id="7330553">.</span><span class="ident" id="7330554">CommonName</span>&nbsp;<span class="op" id="7330565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330570"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7330571">.</span><span class="ident" id="7330572">Errorf</span><span class="op" id="7330578">(</span><span class="string" id="7330579">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7330656">,</span>&nbsp;<span class="ident" id="7330658"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7330662">.</span><span class="ident" id="7330663">name</span><span class="op" id="7330667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330671">}</span>&nbsp;<span class="keyword" id="7330673">else</span>&nbsp;<span class="keyword" id="7330678">if</span>&nbsp;<span class="builtinfunc" id="7330681">len</span><span class="op" id="7330684">(</span><span class="ident" id="7330685"><a href="/crypto/x509/x509_test.go.html#7330349">out</a></span><span class="op" id="7330688">.</span><span class="ident" id="7330689">Subject</span><span class="op" id="7330696">.</span><span class="ident" id="7330697">Organization</span><span class="op" id="7330709">)</span>&nbsp;<span class="op" id="7330711">!=</span>&nbsp;<span class="builtinfunc" id="7330714">len</span><span class="op" id="7330717">(</span><span class="ident" id="7330718"><a href="/crypto/x509/x509_test.go.html#7329772">template</a></span><span class="op" id="7330726">.</span><span class="ident" id="7330727">Subject</span><span class="op" id="7330734">.</span><span class="ident" id="7330735">Organization</span><span class="op" id="7330747">)</span>&nbsp;<span class="op" id="7330749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330754"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7330755">.</span><span class="ident" id="7330756">Errorf</span><span class="op" id="7330762">(</span><span class="string" id="7330763">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7330842">,</span>&nbsp;<span class="ident" id="7330844"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7330848">.</span><span class="ident" id="7330849">name</span><span class="op" id="7330853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330857">}</span>&nbsp;<span class="keyword" id="7330859">else</span>&nbsp;<span class="keyword" id="7330864">if</span>&nbsp;<span class="builtinfunc" id="7330867">len</span><span class="op" id="7330870">(</span><span class="ident" id="7330871"><a href="/crypto/x509/x509_test.go.html#7330349">out</a></span><span class="op" id="7330874">.</span><span class="ident" id="7330875">DNSNames</span><span class="op" id="7330883">)</span>&nbsp;<span class="op" id="7330885">!=</span>&nbsp;<span class="builtinfunc" id="7330888">len</span><span class="op" id="7330891">(</span><span class="ident" id="7330892"><a href="/crypto/x509/x509_test.go.html#7329772">template</a></span><span class="op" id="7330900">.</span><span class="ident" id="7330901">DNSNames</span><span class="op" id="7330909">)</span>&nbsp;<span class="op" id="7330911">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7330916"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7330917">.</span><span class="ident" id="7330918">Errorf</span><span class="op" id="7330924">(</span><span class="string" id="7330925">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7330982">,</span>&nbsp;<span class="ident" id="7330984"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7330988">.</span><span class="ident" id="7330989">name</span><span class="op" id="7330993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7330997">}</span>&nbsp;<span class="keyword" id="7330999">else</span>&nbsp;<span class="keyword" id="7331004">if</span>&nbsp;<span class="builtinfunc" id="7331007">len</span><span class="op" id="7331010">(</span><span class="ident" id="7331011"><a href="/crypto/x509/x509_test.go.html#7330349">out</a></span><span class="op" id="7331014">.</span><span class="ident" id="7331015">EmailAddresses</span><span class="op" id="7331029">)</span>&nbsp;<span class="op" id="7331031">!=</span>&nbsp;<span class="builtinfunc" id="7331034">len</span><span class="op" id="7331037">(</span><span class="ident" id="7331038"><a href="/crypto/x509/x509_test.go.html#7329772">template</a></span><span class="op" id="7331046">.</span><span class="ident" id="7331047">EmailAddresses</span><span class="op" id="7331061">)</span>&nbsp;<span class="op" id="7331063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331068"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7331069">.</span><span class="ident" id="7331070">Errorf</span><span class="op" id="7331076">(</span><span class="string" id="7331077">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7331146">,</span>&nbsp;<span class="ident" id="7331148"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7331152">.</span><span class="ident" id="7331153">name</span><span class="op" id="7331157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331161">}</span>&nbsp;<span class="keyword" id="7331163">else</span>&nbsp;<span class="keyword" id="7331168">if</span>&nbsp;<span class="builtinfunc" id="7331171">len</span><span class="op" id="7331174">(</span><span class="ident" id="7331175"><a href="/crypto/x509/x509_test.go.html#7330349">out</a></span><span class="op" id="7331178">.</span><span class="ident" id="7331179">IPAddresses</span><span class="op" id="7331190">)</span>&nbsp;<span class="op" id="7331192">!=</span>&nbsp;<span class="builtinfunc" id="7331195">len</span><span class="op" id="7331198">(</span><span class="ident" id="7331199"><a href="/crypto/x509/x509_test.go.html#7329772">template</a></span><span class="op" id="7331207">.</span><span class="ident" id="7331208">IPAddresses</span><span class="op" id="7331219">)</span>&nbsp;<span class="op" id="7331221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331226"><a href="/crypto/x509/x509_test.go.html#7328833">t</a></span><span class="op" id="7331227">.</span><span class="ident" id="7331228">Errorf</span><span class="op" id="7331234">(</span><span class="string" id="7331235">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7331304">,</span>&nbsp;<span class="ident" id="7331306"><a href="/crypto/x509/x509_test.go.html#7329748">test</a></span><span class="op" id="7331310">.</span><span class="ident" id="7331311">name</span><span class="op" id="7331315">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331322">}</span><br>
<span class="lineno"></span><span class="op" id="7331324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7331327">func</span>&nbsp;<span class="ident" id="7331332">marshalAndParseCSR</span><span class="op" id="7331350">(</span><span class="ident" id="7331351">t</span>&nbsp;<span class="op" id="7331353">*</span><span class="ident" id="7331354"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7331361">.</span><span class="ident" id="7331362">T</span><span class="op" id="7331363">,</span>&nbsp;<span class="ident" id="7331365">template</span>&nbsp;<span class="op" id="7331374">*</span><span class="ident" id="7331375"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="7331393">)</span>&nbsp;<span class="op" id="7331395">*</span><span class="ident" id="7331396"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span>&nbsp;<span class="op" id="7331415">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331418">block</span><span class="op" id="7331423">,</span>&nbsp;<span class="ident" id="7331425">_</span>&nbsp;<span class="op" id="7331427">:=</span>&nbsp;<span class="ident" id="7331430"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7331433">.</span><span class="ident" id="7331434">Decode</span><span class="op" id="7331440">(</span><span class="op" id="7331441">[</span><span class="op" id="7331442">]</span><span class="builtintype" id="7331443">byte</span><span class="op" id="7331447">(</span><span class="ident" id="7331448"><a href="/crypto/x509/x509_test.go.html#7295037">pemPrivateKey</a></span><span class="op" id="7331461">)</span><span class="op" id="7331462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331465">rsaPriv</span><span class="op" id="7331472">,</span>&nbsp;<span class="ident" id="7331474">err</span>&nbsp;<span class="op" id="7331478">:=</span>&nbsp;<span class="ident" id="7331481"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7331501">(</span><span class="ident" id="7331502"><a href="/crypto/x509/x509_test.go.html#7331418">block</a></span><span class="op" id="7331507">.</span><span class="ident" id="7331508">Bytes</span><span class="op" id="7331513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331516">if</span>&nbsp;<span class="ident" id="7331519"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span>&nbsp;<span class="op" id="7331523">!=</span>&nbsp;<span class="ident" id="7331526">nil</span>&nbsp;<span class="op" id="7331530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331534"><a href="/crypto/x509/x509_test.go.html#7331351">t</a></span><span class="op" id="7331535">.</span><span class="ident" id="7331536">Fatal</span><span class="op" id="7331541">(</span><span class="ident" id="7331542"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span><span class="op" id="7331545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331548">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331552">derBytes</span><span class="op" id="7331560">,</span>&nbsp;<span class="ident" id="7331562"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span>&nbsp;<span class="op" id="7331566">:=</span>&nbsp;<span class="ident" id="7331569"><a href="/crypto/x509/x509.go.html#4081409">CreateCertificateRequest</a></span><span class="op" id="7331593">(</span><span class="ident" id="7331594"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7331598">.</span><span class="ident" id="7331599">Reader</span><span class="op" id="7331605">,</span>&nbsp;<span class="ident" id="7331607"><a href="/crypto/x509/x509_test.go.html#7331365">template</a></span><span class="op" id="7331615">,</span>&nbsp;<span class="ident" id="7331617"><a href="/crypto/x509/x509_test.go.html#7331465">rsaPriv</a></span><span class="op" id="7331624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331627">if</span>&nbsp;<span class="ident" id="7331630"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span>&nbsp;<span class="op" id="7331634">!=</span>&nbsp;<span class="ident" id="7331637">nil</span>&nbsp;<span class="op" id="7331641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331645"><a href="/crypto/x509/x509_test.go.html#7331351">t</a></span><span class="op" id="7331646">.</span><span class="ident" id="7331647">Fatal</span><span class="op" id="7331652">(</span><span class="ident" id="7331653"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span><span class="op" id="7331656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331659">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331663">csr</span><span class="op" id="7331666">,</span>&nbsp;<span class="ident" id="7331668"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span>&nbsp;<span class="op" id="7331672">:=</span>&nbsp;<span class="ident" id="7331675"><a href="/crypto/x509/x509.go.html#4085421">ParseCertificateRequest</a></span><span class="op" id="7331698">(</span><span class="ident" id="7331699"><a href="/crypto/x509/x509_test.go.html#7331552">derBytes</a></span><span class="op" id="7331707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331710">if</span>&nbsp;<span class="ident" id="7331713"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span>&nbsp;<span class="op" id="7331717">!=</span>&nbsp;<span class="ident" id="7331720">nil</span>&nbsp;<span class="op" id="7331724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331728"><a href="/crypto/x509/x509_test.go.html#7331351">t</a></span><span class="op" id="7331729">.</span><span class="ident" id="7331730">Fatal</span><span class="op" id="7331735">(</span><span class="ident" id="7331736"><a href="/crypto/x509/x509_test.go.html#7331474">err</a></span><span class="op" id="7331739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331742">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331746">return</span>&nbsp;<span class="ident" id="7331753"><a href="/crypto/x509/x509_test.go.html#7331663">csr</a></span><br>
<span class="lineno"></span><span class="op" id="7331757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7331760">func</span>&nbsp;<span class="ident" id="7331765">TestCertificateRequestOverrides</span><span class="op" id="7331796">(</span><span class="ident" id="7331797">t</span>&nbsp;<span class="op" id="7331799">*</span><span class="ident" id="7331800"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7331807">.</span><span class="ident" id="7331808">T</span><span class="op" id="7331809">)</span>&nbsp;<span class="op" id="7331811">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331814">sanContents</span><span class="op" id="7331825">,</span>&nbsp;<span class="ident" id="7331827">err</span>&nbsp;<span class="op" id="7331831">:=</span>&nbsp;<span class="ident" id="7331834"><a href="/crypto/x509/x509.go.html#4066120">marshalSANs</a></span><span class="op" id="7331845">(</span><span class="op" id="7331846">[</span><span class="op" id="7331847">]</span><span class="builtintype" id="7331848">string</span><span class="op" id="7331854">{</span><span class="string" id="7331855">&#34;foo.example.com&#34;</span><span class="op" id="7331872">}</span><span class="op" id="7331873">,</span>&nbsp;<span class="ident" id="7331875">nil</span><span class="op" id="7331878">,</span>&nbsp;<span class="ident" id="7331880">nil</span><span class="op" id="7331883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7331886">if</span>&nbsp;<span class="ident" id="7331889"><a href="/crypto/x509/x509_test.go.html#7331827">err</a></span>&nbsp;<span class="op" id="7331893">!=</span>&nbsp;<span class="ident" id="7331896">nil</span>&nbsp;<span class="op" id="7331900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331904"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7331905">.</span><span class="ident" id="7331906">Fatal</span><span class="op" id="7331911">(</span><span class="ident" id="7331912"><a href="/crypto/x509/x509_test.go.html#7331827">err</a></span><span class="op" id="7331915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7331918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331922">template</span>&nbsp;<span class="op" id="7331931">:=</span>&nbsp;<span class="ident" id="7331934"><a href="/crypto/x509/x509.go.html#4078895">CertificateRequest</a></span><span class="op" id="7331952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331956">Subject</span><span class="op" id="7331963">:</span>&nbsp;<span class="ident" id="7331965"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7331969">.</span><span class="ident" id="7331970">Name</span><span class="op" id="7331974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7331979">CommonName</span><span class="op" id="7331989">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7331993">&#34;test.example.com&#34;</span><span class="op" id="7332011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332016">Organization</span><span class="op" id="7332028">:</span>&nbsp;<span class="op" id="7332030">[</span><span class="op" id="7332031">]</span><span class="builtintype" id="7332032">string</span><span class="op" id="7332038">{</span><span class="string" id="7332039">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7332051">}</span><span class="op" id="7332052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332056">}</span><span class="op" id="7332057">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332061">DNSNames</span><span class="op" id="7332069">:</span>&nbsp;<span class="op" id="7332071">[</span><span class="op" id="7332072">]</span><span class="builtintype" id="7332073">string</span><span class="op" id="7332079">{</span><span class="string" id="7332080">&#34;test.example.com&#34;</span><span class="op" id="7332098">}</span><span class="op" id="7332099">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7332104">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7332169">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332184">ExtraExtensions</span><span class="op" id="7332199">:</span>&nbsp;<span class="op" id="7332201">[</span><span class="op" id="7332202">]</span><span class="ident" id="7332203"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7332207">.</span><span class="ident" id="7332208">Extension</span><span class="op" id="7332217">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332228">Id</span><span class="op" id="7332230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7332235"><a href="/crypto/x509/x509.go.html#4065254">oidExtensionSubjectAltName</a></span><span class="op" id="7332261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332267">Value</span><span class="op" id="7332272">:</span>&nbsp;<span class="ident" id="7332274"><a href="/crypto/x509/x509_test.go.html#7331814">sanContents</a></span><span class="op" id="7332285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332290">}</span><span class="op" id="7332291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332295">}</span><span class="op" id="7332296">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332303">csr</span>&nbsp;<span class="op" id="7332307">:=</span>&nbsp;<span class="ident" id="7332310"><a href="/crypto/x509/x509_test.go.html#7331332">marshalAndParseCSR</a></span><span class="op" id="7332328">(</span><span class="ident" id="7332329"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7332330">,</span>&nbsp;<span class="op" id="7332332">&amp;</span><span class="ident" id="7332333"><a href="/crypto/x509/x509_test.go.html#7331922">template</a></span><span class="op" id="7332341">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332345">if</span>&nbsp;<span class="builtinfunc" id="7332348">len</span><span class="op" id="7332351">(</span><span class="ident" id="7332352"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7332355">.</span><span class="ident" id="7332356">DNSNames</span><span class="op" id="7332364">)</span>&nbsp;<span class="op" id="7332366">!=</span>&nbsp;<span class="num" id="7332369">1</span>&nbsp;<span class="op" id="7332371">||</span>&nbsp;<span class="ident" id="7332374"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7332377">.</span><span class="ident" id="7332378">DNSNames</span><span class="op" id="7332386">[</span><span class="num" id="7332387">0</span><span class="op" id="7332388">]</span>&nbsp;<span class="op" id="7332390">!=</span>&nbsp;<span class="string" id="7332393">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7332411">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332415"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7332416">.</span><span class="ident" id="7332417">Errorf</span><span class="op" id="7332423">(</span><span class="string" id="7332424">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7332471">,</span>&nbsp;<span class="ident" id="7332473"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7332476">.</span><span class="ident" id="7332477">DNSNames</span><span class="op" id="7332485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7332492">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7332560">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7332630">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332666"><a href="/crypto/x509/x509_test.go.html#7331922">template</a></span><span class="op" id="7332674">.</span><span class="ident" id="7332675">Attributes</span>&nbsp;<span class="op" id="7332686">=</span>&nbsp;<span class="op" id="7332688">[</span><span class="op" id="7332689">]</span><span class="ident" id="7332690"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7332694">.</span><span class="ident" id="7332695">AttributeTypeAndValueSET</span><span class="op" id="7332719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332728">Type</span><span class="op" id="7332732">:</span>&nbsp;<span class="ident" id="7332734"><a href="/crypto/x509/x509.go.html#4080892">oidExtensionRequest</a></span><span class="op" id="7332753">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332758">Value</span><span class="op" id="7332763">:</span>&nbsp;<span class="op" id="7332765">[</span><span class="op" id="7332766">]</span><span class="op" id="7332767">[</span><span class="op" id="7332768">]</span><span class="ident" id="7332769"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7332773">.</span><span class="ident" id="7332774">AttributeTypeAndValue</span><span class="op" id="7332795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332816">Type</span><span class="op" id="7332820">:</span>&nbsp;&nbsp;<span class="ident" id="7332823"><a href="/crypto/x509/x509.go.html#4065482">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="7332854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332862">Value</span><span class="op" id="7332867">:</span>&nbsp;<span class="op" id="7332869">[</span><span class="op" id="7332870">]</span><span class="builtintype" id="7332871">byte</span><span class="op" id="7332875">(</span><span class="string" id="7332876">&#34;foo&#34;</span><span class="op" id="7332881">)</span><span class="op" id="7332882">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332889">}</span><span class="op" id="7332890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332896">}</span><span class="op" id="7332897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332902">}</span><span class="op" id="7332903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332907">}</span><span class="op" id="7332908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7332911">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332915"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span>&nbsp;<span class="op" id="7332919">=</span>&nbsp;<span class="ident" id="7332921"><a href="/crypto/x509/x509_test.go.html#7331332">marshalAndParseCSR</a></span><span class="op" id="7332939">(</span><span class="ident" id="7332940"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7332941">,</span>&nbsp;<span class="op" id="7332943">&amp;</span><span class="ident" id="7332944"><a href="/crypto/x509/x509_test.go.html#7331922">template</a></span><span class="op" id="7332952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7332955">if</span>&nbsp;<span class="ident" id="7332958">l</span>&nbsp;<span class="op" id="7332960">:=</span>&nbsp;<span class="builtinfunc" id="7332963">len</span><span class="op" id="7332966">(</span><span class="ident" id="7332967"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7332970">.</span><span class="ident" id="7332971">Attributes</span><span class="op" id="7332981">)</span><span class="op" id="7332982">;</span>&nbsp;<span class="ident" id="7332984"><a href="/crypto/x509/x509_test.go.html#7332958">l</a></span>&nbsp;<span class="op" id="7332986">!=</span>&nbsp;<span class="num" id="7332989">1</span>&nbsp;<span class="op" id="7332991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7332995"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7332996">.</span><span class="ident" id="7332997">Errorf</span><span class="op" id="7333003">(</span><span class="string" id="7333004">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7333042">,</span>&nbsp;<span class="ident" id="7333044"><a href="/crypto/x509/x509_test.go.html#7332958">l</a></span><span class="op" id="7333045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333048">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333052">if</span>&nbsp;<span class="op" id="7333055">!</span><span class="ident" id="7333056"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333059">.</span><span class="ident" id="7333060">Attributes</span><span class="op" id="7333070">[</span><span class="num" id="7333071">0</span><span class="op" id="7333072">]</span><span class="op" id="7333073">.</span><span class="ident" id="7333074">Type</span><span class="op" id="7333078">.</span><span class="ident" id="7333079">Equal</span><span class="op" id="7333084">(</span><span class="ident" id="7333085"><a href="/crypto/x509/x509.go.html#4080892">oidExtensionRequest</a></span><span class="op" id="7333104">)</span>&nbsp;<span class="op" id="7333106">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7333111">len</span><span class="op" id="7333114">(</span><span class="ident" id="7333115"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333118">.</span><span class="ident" id="7333119">Attributes</span><span class="op" id="7333129">[</span><span class="num" id="7333130">0</span><span class="op" id="7333131">]</span><span class="op" id="7333132">.</span><span class="ident" id="7333133">Value</span><span class="op" id="7333138">)</span>&nbsp;<span class="op" id="7333140">!=</span>&nbsp;<span class="num" id="7333143">1</span>&nbsp;<span class="op" id="7333145">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7333150">len</span><span class="op" id="7333153">(</span><span class="ident" id="7333154"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333157">.</span><span class="ident" id="7333158">Attributes</span><span class="op" id="7333168">[</span><span class="num" id="7333169">0</span><span class="op" id="7333170">]</span><span class="op" id="7333171">.</span><span class="ident" id="7333172">Value</span><span class="op" id="7333177">[</span><span class="num" id="7333178">0</span><span class="op" id="7333179">]</span><span class="op" id="7333180">)</span>&nbsp;<span class="op" id="7333182">!=</span>&nbsp;<span class="num" id="7333185">2</span>&nbsp;<span class="op" id="7333187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333191"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7333192">.</span><span class="ident" id="7333193">Errorf</span><span class="op" id="7333199">(</span><span class="string" id="7333200">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7333223">,</span>&nbsp;<span class="ident" id="7333225"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333228">.</span><span class="ident" id="7333229">Attributes</span><span class="op" id="7333239">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333246">sanContents2</span><span class="op" id="7333258">,</span>&nbsp;<span class="ident" id="7333260"><a href="/crypto/x509/x509_test.go.html#7331827">err</a></span>&nbsp;<span class="op" id="7333264">:=</span>&nbsp;<span class="ident" id="7333267"><a href="/crypto/x509/x509.go.html#4066120">marshalSANs</a></span><span class="op" id="7333278">(</span><span class="op" id="7333279">[</span><span class="op" id="7333280">]</span><span class="builtintype" id="7333281">string</span><span class="op" id="7333287">{</span><span class="string" id="7333288">&#34;foo2.example.com&#34;</span><span class="op" id="7333306">}</span><span class="op" id="7333307">,</span>&nbsp;<span class="ident" id="7333309">nil</span><span class="op" id="7333312">,</span>&nbsp;<span class="ident" id="7333314">nil</span><span class="op" id="7333317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333320">if</span>&nbsp;<span class="ident" id="7333323"><a href="/crypto/x509/x509_test.go.html#7331827">err</a></span>&nbsp;<span class="op" id="7333327">!=</span>&nbsp;<span class="ident" id="7333330">nil</span>&nbsp;<span class="op" id="7333334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333338"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7333339">.</span><span class="ident" id="7333340">Fatal</span><span class="op" id="7333345">(</span><span class="ident" id="7333346"><a href="/crypto/x509/x509_test.go.html#7331827">err</a></span><span class="op" id="7333349">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7333356">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333427"><a href="/crypto/x509/x509_test.go.html#7331922">template</a></span><span class="op" id="7333435">.</span><span class="ident" id="7333436">Attributes</span><span class="op" id="7333446">[</span><span class="num" id="7333447">0</span><span class="op" id="7333448">]</span><span class="op" id="7333449">.</span><span class="ident" id="7333450">Value</span><span class="op" id="7333455">[</span><span class="num" id="7333456">0</span><span class="op" id="7333457">]</span>&nbsp;<span class="op" id="7333459">=</span>&nbsp;<span class="builtinfunc" id="7333461">append</span><span class="op" id="7333467">(</span><span class="ident" id="7333468"><a href="/crypto/x509/x509_test.go.html#7331922">template</a></span><span class="op" id="7333476">.</span><span class="ident" id="7333477">Attributes</span><span class="op" id="7333487">[</span><span class="num" id="7333488">0</span><span class="op" id="7333489">]</span><span class="op" id="7333490">.</span><span class="ident" id="7333491">Value</span><span class="op" id="7333496">[</span><span class="num" id="7333497">0</span><span class="op" id="7333498">]</span><span class="op" id="7333499">,</span>&nbsp;<span class="ident" id="7333501"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7333505">.</span><span class="ident" id="7333506">AttributeTypeAndValue</span><span class="op" id="7333527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333531">Type</span><span class="op" id="7333535">:</span>&nbsp;&nbsp;<span class="ident" id="7333538"><a href="/crypto/x509/x509.go.html#4065254">oidExtensionSubjectAltName</a></span><span class="op" id="7333564">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333568">Value</span><span class="op" id="7333573">:</span>&nbsp;<span class="ident" id="7333575"><a href="/crypto/x509/x509_test.go.html#7333246">sanContents2</a></span><span class="op" id="7333587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333590">}</span><span class="op" id="7333591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333595"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span>&nbsp;<span class="op" id="7333599">=</span>&nbsp;<span class="ident" id="7333601"><a href="/crypto/x509/x509_test.go.html#7331332">marshalAndParseCSR</a></span><span class="op" id="7333619">(</span><span class="ident" id="7333620"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7333621">,</span>&nbsp;<span class="op" id="7333623">&amp;</span><span class="ident" id="7333624"><a href="/crypto/x509/x509_test.go.html#7331922">template</a></span><span class="op" id="7333632">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333636">if</span>&nbsp;<span class="builtinfunc" id="7333639">len</span><span class="op" id="7333642">(</span><span class="ident" id="7333643"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333646">.</span><span class="ident" id="7333647">DNSNames</span><span class="op" id="7333655">)</span>&nbsp;<span class="op" id="7333657">!=</span>&nbsp;<span class="num" id="7333660">1</span>&nbsp;<span class="op" id="7333662">||</span>&nbsp;<span class="ident" id="7333665"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333668">.</span><span class="ident" id="7333669">DNSNames</span><span class="op" id="7333677">[</span><span class="num" id="7333678">0</span><span class="op" id="7333679">]</span>&nbsp;<span class="op" id="7333681">!=</span>&nbsp;<span class="string" id="7333684">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7333703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333707"><a href="/crypto/x509/x509_test.go.html#7331797">t</a></span><span class="op" id="7333708">.</span><span class="ident" id="7333709">Errorf</span><span class="op" id="7333715">(</span><span class="string" id="7333716">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7333771">,</span>&nbsp;<span class="ident" id="7333773"><a href="/crypto/x509/x509_test.go.html#7332303">csr</a></span><span class="op" id="7333776">.</span><span class="ident" id="7333777">DNSNames</span><span class="op" id="7333785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333788">}</span><br>
<span class="lineno"></span><span class="op" id="7333790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7333793">func</span>&nbsp;<span class="ident" id="7333798">TestParseCertificateRequest</span><span class="op" id="7333825">(</span><span class="ident" id="7333826">t</span>&nbsp;<span class="op" id="7333828">*</span><span class="ident" id="7333829"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7333836">.</span><span class="ident" id="7333837">T</span><span class="op" id="7333838">)</span>&nbsp;<span class="op" id="7333840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333843">csrBytes</span>&nbsp;<span class="op" id="7333852">:=</span>&nbsp;<span class="ident" id="7333855"><a href="/crypto/x509/x509_test.go.html#7320965">fromBase64</a></span><span class="op" id="7333865">(</span><span class="ident" id="7333866"><a href="/crypto/x509/x509_test.go.html#7336633">csrBase64</a></span><span class="op" id="7333875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333878">csr</span><span class="op" id="7333881">,</span>&nbsp;<span class="ident" id="7333883">err</span>&nbsp;<span class="op" id="7333887">:=</span>&nbsp;<span class="ident" id="7333890"><a href="/crypto/x509/x509.go.html#4085421">ParseCertificateRequest</a></span><span class="op" id="7333913">(</span><span class="ident" id="7333914"><a href="/crypto/x509/x509_test.go.html#7333843">csrBytes</a></span><span class="op" id="7333922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333925">if</span>&nbsp;<span class="ident" id="7333928"><a href="/crypto/x509/x509_test.go.html#7333883">err</a></span>&nbsp;<span class="op" id="7333932">!=</span>&nbsp;<span class="ident" id="7333935">nil</span>&nbsp;<span class="op" id="7333939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7333943"><a href="/crypto/x509/x509_test.go.html#7333826">t</a></span><span class="op" id="7333944">.</span><span class="ident" id="7333945">Fatalf</span><span class="op" id="7333951">(</span><span class="string" id="7333952">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7333977">,</span>&nbsp;<span class="ident" id="7333979"><a href="/crypto/x509/x509_test.go.html#7333883">err</a></span><span class="op" id="7333982">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7333985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7333989">if</span>&nbsp;<span class="builtinfunc" id="7333992">len</span><span class="op" id="7333995">(</span><span class="ident" id="7333996"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7333999">.</span><span class="ident" id="7334000">EmailAddresses</span><span class="op" id="7334014">)</span>&nbsp;<span class="op" id="7334016">!=</span>&nbsp;<span class="num" id="7334019">1</span>&nbsp;<span class="op" id="7334021">||</span>&nbsp;<span class="ident" id="7334024"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334027">.</span><span class="ident" id="7334028">EmailAddresses</span><span class="op" id="7334042">[</span><span class="num" id="7334043">0</span><span class="op" id="7334044">]</span>&nbsp;<span class="op" id="7334046">!=</span>&nbsp;<span class="string" id="7334049">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7334069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334073"><a href="/crypto/x509/x509_test.go.html#7333826">t</a></span><span class="op" id="7334074">.</span><span class="ident" id="7334075">Errorf</span><span class="op" id="7334081">(</span><span class="string" id="7334082">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7334119">,</span>&nbsp;<span class="ident" id="7334121"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334124">.</span><span class="ident" id="7334125">EmailAddresses</span><span class="op" id="7334139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334142">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334146">if</span>&nbsp;<span class="builtinfunc" id="7334149">len</span><span class="op" id="7334152">(</span><span class="ident" id="7334153"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334156">.</span><span class="ident" id="7334157">DNSNames</span><span class="op" id="7334165">)</span>&nbsp;<span class="op" id="7334167">!=</span>&nbsp;<span class="num" id="7334170">1</span>&nbsp;<span class="op" id="7334172">||</span>&nbsp;<span class="ident" id="7334175"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334178">.</span><span class="ident" id="7334179">DNSNames</span><span class="op" id="7334187">[</span><span class="num" id="7334188">0</span><span class="op" id="7334189">]</span>&nbsp;<span class="op" id="7334191">!=</span>&nbsp;<span class="string" id="7334194">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7334213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334217"><a href="/crypto/x509/x509_test.go.html#7333826">t</a></span><span class="op" id="7334218">.</span><span class="ident" id="7334219">Errorf</span><span class="op" id="7334225">(</span><span class="string" id="7334226">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7334257">,</span>&nbsp;<span class="ident" id="7334259"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334262">.</span><span class="ident" id="7334263">DNSNames</span><span class="op" id="7334271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334278">if</span>&nbsp;<span class="builtinfunc" id="7334281">len</span><span class="op" id="7334284">(</span><span class="ident" id="7334285"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334288">.</span><span class="ident" id="7334289">Subject</span><span class="op" id="7334296">.</span><span class="ident" id="7334297">Country</span><span class="op" id="7334304">)</span>&nbsp;<span class="op" id="7334306">!=</span>&nbsp;<span class="num" id="7334309">1</span>&nbsp;<span class="op" id="7334311">||</span>&nbsp;<span class="ident" id="7334314"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334317">.</span><span class="ident" id="7334318">Subject</span><span class="op" id="7334325">.</span><span class="ident" id="7334326">Country</span><span class="op" id="7334333">[</span><span class="num" id="7334334">0</span><span class="op" id="7334335">]</span>&nbsp;<span class="op" id="7334337">!=</span>&nbsp;<span class="string" id="7334340">&#34;AU&#34;</span>&nbsp;<span class="op" id="7334345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334349"><a href="/crypto/x509/x509_test.go.html#7333826">t</a></span><span class="op" id="7334350">.</span><span class="ident" id="7334351">Errorf</span><span class="op" id="7334357">(</span><span class="string" id="7334358">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7334386">,</span>&nbsp;<span class="ident" id="7334388"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334391">.</span><span class="ident" id="7334392">Subject</span><span class="op" id="7334399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334406">found</span>&nbsp;<span class="op" id="7334412">:=</span>&nbsp;<span class="builtintype" id="7334415">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334422">for</span>&nbsp;<span class="ident" id="7334426">_</span><span class="op" id="7334427">,</span>&nbsp;<span class="ident" id="7334429">e</span>&nbsp;<span class="op" id="7334431">:=</span>&nbsp;<span class="keyword" id="7334434">range</span>&nbsp;<span class="ident" id="7334440"><a href="/crypto/x509/x509_test.go.html#7333878">csr</a></span><span class="op" id="7334443">.</span><span class="ident" id="7334444">Extensions</span>&nbsp;<span class="op" id="7334455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334459">if</span>&nbsp;<span class="ident" id="7334462"><a href="/crypto/x509/x509_test.go.html#7334429">e</a></span><span class="op" id="7334463">.</span><span class="ident" id="7334464">Id</span><span class="op" id="7334466">.</span><span class="ident" id="7334467">Equal</span><span class="op" id="7334472">(</span><span class="ident" id="7334473"><a href="/crypto/x509/x509.go.html#4065197">oidExtensionBasicConstraints</a></span><span class="op" id="7334501">)</span>&nbsp;<span class="op" id="7334503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334508"><a href="/crypto/x509/x509_test.go.html#7334406">found</a></span>&nbsp;<span class="op" id="7334514">=</span>&nbsp;<span class="builtintype" id="7334516">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334524">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334532">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334538">if</span>&nbsp;<span class="op" id="7334541">!</span><span class="ident" id="7334542"><a href="/crypto/x509/x509_test.go.html#7334406">found</a></span>&nbsp;<span class="op" id="7334548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334552"><a href="/crypto/x509/x509_test.go.html#7333826">t</a></span><span class="op" id="7334553">.</span><span class="ident" id="7334554">Errorf</span><span class="op" id="7334560">(</span><span class="string" id="7334561">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7334607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334610">}</span><br>
<span class="lineno"></span><span class="op" id="7334612">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7334615">func</span>&nbsp;<span class="ident" id="7334620">TestMaxPathLen</span><span class="op" id="7334634">(</span><span class="ident" id="7334635">t</span>&nbsp;<span class="op" id="7334637">*</span><span class="ident" id="7334638"><a href="/crypto/x509/x509_test.go.html#7293347">testing</a></span><span class="op" id="7334645">.</span><span class="ident" id="7334646">T</span><span class="op" id="7334647">)</span>&nbsp;<span class="op" id="7334649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334652">block</span><span class="op" id="7334657">,</span>&nbsp;<span class="ident" id="7334659">_</span>&nbsp;<span class="op" id="7334661">:=</span>&nbsp;<span class="ident" id="7334664"><a href="/crypto/x509/x509_test.go.html#7293279">pem</a></span><span class="op" id="7334667">.</span><span class="ident" id="7334668">Decode</span><span class="op" id="7334674">(</span><span class="op" id="7334675">[</span><span class="op" id="7334676">]</span><span class="builtintype" id="7334677">byte</span><span class="op" id="7334681">(</span><span class="ident" id="7334682"><a href="/crypto/x509/x509_test.go.html#7295037">pemPrivateKey</a></span><span class="op" id="7334695">)</span><span class="op" id="7334696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334699">rsaPriv</span><span class="op" id="7334706">,</span>&nbsp;<span class="ident" id="7334708">err</span>&nbsp;<span class="op" id="7334712">:=</span>&nbsp;<span class="ident" id="7334715"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="7334735">(</span><span class="ident" id="7334736"><a href="/crypto/x509/x509_test.go.html#7334652">block</a></span><span class="op" id="7334741">.</span><span class="ident" id="7334742">Bytes</span><span class="op" id="7334747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7334750">if</span>&nbsp;<span class="ident" id="7334753"><a href="/crypto/x509/x509_test.go.html#7334708">err</a></span>&nbsp;<span class="op" id="7334757">!=</span>&nbsp;<span class="ident" id="7334760">nil</span>&nbsp;<span class="op" id="7334764">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334768"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7334769">.</span><span class="ident" id="7334770">Fatalf</span><span class="op" id="7334776">(</span><span class="string" id="7334777">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7334810">,</span>&nbsp;<span class="ident" id="7334812"><a href="/crypto/x509/x509_test.go.html#7334708">err</a></span><span class="op" id="7334815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334822">template</span>&nbsp;<span class="op" id="7334831">:=</span>&nbsp;<span class="op" id="7334834">&amp;</span><span class="ident" id="7334835"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="7334846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334850">SerialNumber</span><span class="op" id="7334862">:</span>&nbsp;<span class="ident" id="7334864"><a href="/crypto/x509/x509_test.go.html#7293295">big</a></span><span class="op" id="7334867">.</span><span class="ident" id="7334868">NewInt</span><span class="op" id="7334874">(</span><span class="num" id="7334875">1</span><span class="op" id="7334876">)</span><span class="op" id="7334877">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334881">Subject</span><span class="op" id="7334888">:</span>&nbsp;<span class="ident" id="7334890"><a href="/crypto/x509/x509_test.go.html#7293207">pkix</a></span><span class="op" id="7334894">.</span><span class="ident" id="7334895">Name</span><span class="op" id="7334899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334904">CommonName</span><span class="op" id="7334914">:</span>&nbsp;<span class="string" id="7334916">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7334928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7334932">}</span><span class="op" id="7334933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334937">NotBefore</span><span class="op" id="7334946">:</span>&nbsp;<span class="ident" id="7334948"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7334952">.</span><span class="ident" id="7334953">Unix</span><span class="op" id="7334957">(</span><span class="num" id="7334958">1000</span><span class="op" id="7334962">,</span>&nbsp;<span class="num" id="7334964">0</span><span class="op" id="7334965">)</span><span class="op" id="7334966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7334970">NotAfter</span><span class="op" id="7334978">:</span>&nbsp;&nbsp;<span class="ident" id="7334981"><a href="/crypto/x509/x509_test.go.html#7293358">time</a></span><span class="op" id="7334985">.</span><span class="ident" id="7334986">Unix</span><span class="op" id="7334990">(</span><span class="num" id="7334991">100000</span><span class="op" id="7334997">,</span>&nbsp;<span class="num" id="7334999">0</span><span class="op" id="7335000">)</span><span class="op" id="7335001">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335006">BasicConstraintsValid</span><span class="op" id="7335027">:</span>&nbsp;<span class="builtintype" id="7335029">true</span><span class="op" id="7335033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335037">IsCA</span><span class="op" id="7335041">:</span>&nbsp;<span class="builtintype" id="7335043">true</span><span class="op" id="7335047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335054">serialiseAndParse</span>&nbsp;<span class="op" id="7335072">:=</span>&nbsp;<span class="keyword" id="7335075">func</span><span class="op" id="7335079">(</span><span class="ident" id="7335080">template</span>&nbsp;<span class="op" id="7335089">*</span><span class="ident" id="7335090"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="7335101">)</span>&nbsp;<span class="op" id="7335103">*</span><span class="ident" id="7335104"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span>&nbsp;<span class="op" id="7335116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335120">derBytes</span><span class="op" id="7335128">,</span>&nbsp;<span class="ident" id="7335130">err</span>&nbsp;<span class="op" id="7335134">:=</span>&nbsp;<span class="ident" id="7335137"><a href="/crypto/x509/x509.go.html#4074576">CreateCertificate</a></span><span class="op" id="7335154">(</span><span class="ident" id="7335155"><a href="/crypto/x509/x509_test.go.html#7293140">rand</a></span><span class="op" id="7335159">.</span><span class="ident" id="7335160">Reader</span><span class="op" id="7335166">,</span>&nbsp;<span class="ident" id="7335168"><a href="/crypto/x509/x509_test.go.html#7335080">template</a></span><span class="op" id="7335176">,</span>&nbsp;<span class="ident" id="7335178"><a href="/crypto/x509/x509_test.go.html#7335080">template</a></span><span class="op" id="7335186">,</span>&nbsp;<span class="op" id="7335188">&amp;</span><span class="ident" id="7335189"><a href="/crypto/x509/x509_test.go.html#7334699">rsaPriv</a></span><span class="op" id="7335196">.</span><span class="ident" id="7335197">PublicKey</span><span class="op" id="7335206">,</span>&nbsp;<span class="ident" id="7335208"><a href="/crypto/x509/x509_test.go.html#7334699">rsaPriv</a></span><span class="op" id="7335215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335219">if</span>&nbsp;<span class="ident" id="7335222"><a href="/crypto/x509/x509_test.go.html#7335130">err</a></span>&nbsp;<span class="op" id="7335226">!=</span>&nbsp;<span class="ident" id="7335229">nil</span>&nbsp;<span class="op" id="7335233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335238"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7335239">.</span><span class="ident" id="7335240">Fatalf</span><span class="op" id="7335246">(</span><span class="string" id="7335247">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7335281">,</span>&nbsp;<span class="ident" id="7335283"><a href="/crypto/x509/x509_test.go.html#7335130">err</a></span><span class="op" id="7335286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335291">return</span>&nbsp;<span class="ident" id="7335298">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335309">cert</span><span class="op" id="7335313">,</span>&nbsp;<span class="ident" id="7335315"><a href="/crypto/x509/x509_test.go.html#7335130">err</a></span>&nbsp;<span class="op" id="7335319">:=</span>&nbsp;<span class="ident" id="7335322"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="7335338">(</span><span class="ident" id="7335339"><a href="/crypto/x509/x509_test.go.html#7335120">derBytes</a></span><span class="op" id="7335347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335351">if</span>&nbsp;<span class="ident" id="7335354"><a href="/crypto/x509/x509_test.go.html#7335130">err</a></span>&nbsp;<span class="op" id="7335358">!=</span>&nbsp;<span class="ident" id="7335361">nil</span>&nbsp;<span class="op" id="7335365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335370"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7335371">.</span><span class="ident" id="7335372">Fatalf</span><span class="op" id="7335378">(</span><span class="string" id="7335379">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7335412">,</span>&nbsp;<span class="ident" id="7335414"><a href="/crypto/x509/x509_test.go.html#7335130">err</a></span><span class="op" id="7335417">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335422">return</span>&nbsp;<span class="ident" id="7335429">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335440">return</span>&nbsp;<span class="ident" id="7335447"><a href="/crypto/x509/x509_test.go.html#7335309">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335453">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335457">cert1</span>&nbsp;<span class="op" id="7335463">:=</span>&nbsp;<span class="ident" id="7335466"><a href="/crypto/x509/x509_test.go.html#7335054">serialiseAndParse</a></span><span class="op" id="7335483">(</span><span class="ident" id="7335484"><a href="/crypto/x509/x509_test.go.html#7334822">template</a></span><span class="op" id="7335492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335495">if</span>&nbsp;<span class="ident" id="7335498">m</span>&nbsp;<span class="op" id="7335500">:=</span>&nbsp;<span class="ident" id="7335503"><a href="/crypto/x509/x509_test.go.html#7335457">cert1</a></span><span class="op" id="7335508">.</span><span class="ident" id="7335509">MaxPathLen</span><span class="op" id="7335519">;</span>&nbsp;<span class="ident" id="7335521"><a href="/crypto/x509/x509_test.go.html#7335498">m</a></span>&nbsp;<span class="op" id="7335523">!=</span>&nbsp;<span class="op" id="7335526">-</span><span class="num" id="7335527">1</span>&nbsp;<span class="op" id="7335529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335533"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7335534">.</span><span class="ident" id="7335535">Errorf</span><span class="op" id="7335541">(</span><span class="string" id="7335542">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7335591">,</span>&nbsp;<span class="ident" id="7335593"><a href="/crypto/x509/x509_test.go.html#7335498">m</a></span><span class="op" id="7335594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335597">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335600">if</span>&nbsp;<span class="ident" id="7335603"><a href="/crypto/x509/x509_test.go.html#7335457">cert1</a></span><span class="op" id="7335608">.</span><span class="ident" id="7335609">MaxPathLenZero</span>&nbsp;<span class="op" id="7335624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335628"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7335629">.</span><span class="ident" id="7335630">Errorf</span><span class="op" id="7335636">(</span><span class="string" id="7335637">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7335685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335692"><a href="/crypto/x509/x509_test.go.html#7334822">template</a></span><span class="op" id="7335700">.</span><span class="ident" id="7335701">MaxPathLen</span>&nbsp;<span class="op" id="7335712">=</span>&nbsp;<span class="num" id="7335714">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335717">cert2</span>&nbsp;<span class="op" id="7335723">:=</span>&nbsp;<span class="ident" id="7335726"><a href="/crypto/x509/x509_test.go.html#7335054">serialiseAndParse</a></span><span class="op" id="7335743">(</span><span class="ident" id="7335744"><a href="/crypto/x509/x509_test.go.html#7334822">template</a></span><span class="op" id="7335752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335755">if</span>&nbsp;<span class="ident" id="7335758">m</span>&nbsp;<span class="op" id="7335760">:=</span>&nbsp;<span class="ident" id="7335763"><a href="/crypto/x509/x509_test.go.html#7335717">cert2</a></span><span class="op" id="7335768">.</span><span class="ident" id="7335769">MaxPathLen</span><span class="op" id="7335779">;</span>&nbsp;<span class="ident" id="7335781"><a href="/crypto/x509/x509_test.go.html#7335758">m</a></span>&nbsp;<span class="op" id="7335783">!=</span>&nbsp;<span class="num" id="7335786">1</span>&nbsp;<span class="op" id="7335788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335792"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7335793">.</span><span class="ident" id="7335794">Errorf</span><span class="op" id="7335800">(</span><span class="string" id="7335801">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7335851">,</span>&nbsp;<span class="ident" id="7335853"><a href="/crypto/x509/x509_test.go.html#7335758">m</a></span><span class="op" id="7335854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7335860">if</span>&nbsp;<span class="ident" id="7335863"><a href="/crypto/x509/x509_test.go.html#7335717">cert2</a></span><span class="op" id="7335868">.</span><span class="ident" id="7335869">MaxPathLenZero</span>&nbsp;<span class="op" id="7335884">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335888"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7335889">.</span><span class="ident" id="7335890">Errorf</span><span class="op" id="7335896">(</span><span class="string" id="7335897">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7335944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7335947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335951"><a href="/crypto/x509/x509_test.go.html#7334822">template</a></span><span class="op" id="7335959">.</span><span class="ident" id="7335960">MaxPathLen</span>&nbsp;<span class="op" id="7335971">=</span>&nbsp;<span class="num" id="7335973">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7335976"><a href="/crypto/x509/x509_test.go.html#7334822">template</a></span><span class="op" id="7335984">.</span><span class="ident" id="7335985">MaxPathLenZero</span>&nbsp;<span class="op" id="7336000">=</span>&nbsp;<span class="builtintype" id="7336002">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336008">cert3</span>&nbsp;<span class="op" id="7336014">:=</span>&nbsp;<span class="ident" id="7336017"><a href="/crypto/x509/x509_test.go.html#7335054">serialiseAndParse</a></span><span class="op" id="7336034">(</span><span class="ident" id="7336035"><a href="/crypto/x509/x509_test.go.html#7334822">template</a></span><span class="op" id="7336043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7336046">if</span>&nbsp;<span class="ident" id="7336049">m</span>&nbsp;<span class="op" id="7336051">:=</span>&nbsp;<span class="ident" id="7336054"><a href="/crypto/x509/x509_test.go.html#7336008">cert3</a></span><span class="op" id="7336059">.</span><span class="ident" id="7336060">MaxPathLen</span><span class="op" id="7336070">;</span>&nbsp;<span class="ident" id="7336072"><a href="/crypto/x509/x509_test.go.html#7336049">m</a></span>&nbsp;<span class="op" id="7336074">!=</span>&nbsp;<span class="num" id="7336077">0</span>&nbsp;<span class="op" id="7336079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336083"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7336084">.</span><span class="ident" id="7336085">Errorf</span><span class="op" id="7336091">(</span><span class="string" id="7336092">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7336136">,</span>&nbsp;<span class="ident" id="7336138"><a href="/crypto/x509/x509_test.go.html#7336049">m</a></span><span class="op" id="7336139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7336145">if</span>&nbsp;<span class="op" id="7336148">!</span><span class="ident" id="7336149"><a href="/crypto/x509/x509_test.go.html#7336008">cert3</a></span><span class="op" id="7336154">.</span><span class="ident" id="7336155">MaxPathLenZero</span>&nbsp;<span class="op" id="7336170">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7336174"><a href="/crypto/x509/x509_test.go.html#7334635">t</a></span><span class="op" id="7336175">.</span><span class="ident" id="7336176">Errorf</span><span class="op" id="7336182">(</span><span class="string" id="7336183">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7336243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7336246">}</span><br>
<span class="lineno"></span><span class="op" id="7336248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7336251">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7336291">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7336392">//</span><br>
<span class="lineno"></span><span class="comment" id="7336395">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7336445">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7336461">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7336494">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7336560">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7336627">const</span>&nbsp;<span class="ident" id="7336633">csrBase64</span>&nbsp;<span class="op" id="7336643">=</span>&nbsp;<span class="string" id="7336645">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
